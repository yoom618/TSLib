Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4877671
	speed: 0.0916s/iter; left time: 4285.9851s
	iters: 200, epoch: 1 | loss: 0.0867212
	speed: 0.0746s/iter; left time: 3485.9901s
	iters: 300, epoch: 1 | loss: 0.1694275
	speed: 0.0784s/iter; left time: 3652.4696s
	iters: 400, epoch: 1 | loss: 0.0032025
	speed: 0.0840s/iter; left time: 3906.3964s
Epoch: 1 cost time: 38.67195749282837
Epoch: 1, Steps: 469 | Train Loss: 0.334 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (inf --> -0.947968).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0638001
	speed: 0.4202s/iter; left time: 19468.5991s
	iters: 200, epoch: 2 | loss: 0.0561291
	speed: 0.0621s/iter; left time: 2868.7999s
	iters: 300, epoch: 2 | loss: 0.0143441
	speed: 0.0599s/iter; left time: 2764.6345s
	iters: 400, epoch: 2 | loss: 0.1109719
	speed: 0.0763s/iter; left time: 3514.4613s
Epoch: 2 cost time: 32.147540807724
Epoch: 2, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.947968 --> -0.966551).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0852288
	speed: 0.3803s/iter; left time: 17440.9469s
	iters: 200, epoch: 3 | loss: 0.0122136
	speed: 0.0744s/iter; left time: 3405.8894s
	iters: 300, epoch: 3 | loss: 0.0149482
	speed: 0.0765s/iter; left time: 3494.3712s
	iters: 400, epoch: 3 | loss: 0.1436991
	speed: 0.0815s/iter; left time: 3711.5569s
Epoch: 3 cost time: 36.51307010650635
Epoch: 3, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0028507
	speed: 0.3942s/iter; left time: 17895.8237s
	iters: 200, epoch: 4 | loss: 0.2592470
	speed: 0.0704s/iter; left time: 3190.7605s
	iters: 300, epoch: 4 | loss: 0.0523808
	speed: 0.0703s/iter; left time: 3177.6014s
	iters: 400, epoch: 4 | loss: 0.0151468
	speed: 0.0907s/iter; left time: 4092.1687s
Epoch: 4 cost time: 37.37921905517578
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0460910
	speed: 0.5211s/iter; left time: 23409.6474s
	iters: 200, epoch: 5 | loss: 0.0088686
	speed: 0.0882s/iter; left time: 3954.4025s
	iters: 300, epoch: 5 | loss: 0.0094892
	speed: 0.0961s/iter; left time: 4297.9843s
	iters: 400, epoch: 5 | loss: 0.1367665
	speed: 0.0900s/iter; left time: 4015.9690s
Epoch: 5 cost time: 43.35098385810852
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4704240
	speed: 0.5022s/iter; left time: 22325.8924s
	iters: 200, epoch: 6 | loss: 0.0083428
	speed: 0.1007s/iter; left time: 4468.7372s
	iters: 300, epoch: 6 | loss: 0.0098695
	speed: 0.0976s/iter; left time: 4318.1622s
	iters: 400, epoch: 6 | loss: 0.0012758
	speed: 0.0868s/iter; left time: 3833.6986s
Epoch: 6 cost time: 44.564064741134644
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0136115
	speed: 0.5255s/iter; left time: 23115.9888s
	iters: 200, epoch: 7 | loss: 0.0227438
	speed: 0.0852s/iter; left time: 3738.3331s
	iters: 300, epoch: 7 | loss: 0.0013641
	speed: 0.0942s/iter; left time: 4126.6219s
	iters: 400, epoch: 7 | loss: 0.0254410
	speed: 0.0949s/iter; left time: 4146.1160s
Epoch: 7 cost time: 45.43011474609375
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0392171
	speed: 0.5780s/iter; left time: 25154.5011s
	iters: 200, epoch: 8 | loss: 0.0586424
	speed: 0.0989s/iter; left time: 4295.2671s
	iters: 300, epoch: 8 | loss: 0.0008006
	speed: 0.1035s/iter; left time: 4483.3673s
	iters: 400, epoch: 8 | loss: 0.0005409
	speed: 0.0929s/iter; left time: 4012.8045s
Epoch: 8 cost time: 47.89021682739258
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0798059
	speed: 0.5033s/iter; left time: 21667.9395s
	iters: 200, epoch: 9 | loss: 0.0369018
	speed: 0.0900s/iter; left time: 3865.4672s
	iters: 300, epoch: 9 | loss: 0.0246672
	speed: 0.0871s/iter; left time: 3733.6402s
	iters: 400, epoch: 9 | loss: 0.0073260
	speed: 0.0815s/iter; left time: 3482.3500s
Epoch: 9 cost time: 42.94137001037598
Epoch: 9, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
Validation loss decreased (-0.966551 --> -0.967980).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0020951
	speed: 0.5205s/iter; left time: 22162.5037s
	iters: 200, epoch: 10 | loss: 0.0085972
	speed: 0.0958s/iter; left time: 4070.7335s
	iters: 300, epoch: 10 | loss: 0.0023673
	speed: 0.0969s/iter; left time: 4108.3989s
	iters: 400, epoch: 10 | loss: 0.0111289
	speed: 0.1087s/iter; left time: 4594.8513s
Epoch: 10 cost time: 46.589510917663574
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.967980 --> -0.969981).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0182447
	speed: 0.4852s/iter; left time: 20431.5353s
	iters: 200, epoch: 11 | loss: 0.0002692
	speed: 0.0878s/iter; left time: 3687.5851s
	iters: 300, epoch: 11 | loss: 0.0062678
	speed: 0.0891s/iter; left time: 3733.4202s
	iters: 400, epoch: 11 | loss: 0.2452565
	speed: 0.0931s/iter; left time: 3893.7798s
Epoch: 11 cost time: 43.088305950164795
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
Validation loss decreased (-0.969981 --> -0.970839).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0043861
	speed: 0.4976s/iter; left time: 20723.0797s
	iters: 200, epoch: 12 | loss: 0.1485057
	speed: 0.0948s/iter; left time: 3938.0504s
	iters: 300, epoch: 12 | loss: 0.0000170
	speed: 0.1023s/iter; left time: 4240.0180s
	iters: 400, epoch: 12 | loss: 0.0025256
	speed: 0.1135s/iter; left time: 4693.0641s
Epoch: 12 cost time: 48.2479567527771
Epoch: 12, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.300 Vali Acc: 0.939 Test Loss: 0.300 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0363392
	speed: 0.5462s/iter; left time: 22486.9999s
	iters: 200, epoch: 13 | loss: 0.0029365
	speed: 0.0888s/iter; left time: 3647.8204s
	iters: 300, epoch: 13 | loss: 0.0013700
	speed: 0.0856s/iter; left time: 3505.8374s
	iters: 400, epoch: 13 | loss: 0.0027150
	speed: 0.0919s/iter; left time: 3756.0039s
Epoch: 13 cost time: 44.06940174102783
Epoch: 13, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.241 Vali Acc: 0.945 Test Loss: 0.241 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 1.3065019
	speed: 0.5311s/iter; left time: 21617.5565s
	iters: 200, epoch: 14 | loss: 0.0006649
	speed: 0.0885s/iter; left time: 3594.7494s
	iters: 300, epoch: 14 | loss: 0.0030639
	speed: 0.0802s/iter; left time: 3249.6961s
	iters: 400, epoch: 14 | loss: 0.0004871
	speed: 0.0947s/iter; left time: 3826.7370s
Epoch: 14 cost time: 43.017075300216675
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0009090
	speed: 0.5274s/iter; left time: 21219.3226s
	iters: 200, epoch: 15 | loss: 0.0005109
	speed: 0.0835s/iter; left time: 3349.8440s
	iters: 300, epoch: 15 | loss: 0.0624238
	speed: 0.0811s/iter; left time: 3246.9709s
	iters: 400, epoch: 15 | loss: 0.0310218
	speed: 0.0811s/iter; left time: 3237.1611s
Epoch: 15 cost time: 40.3345844745636
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972840).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1421462
	speed: 0.5279s/iter; left time: 20992.4301s
	iters: 200, epoch: 16 | loss: 0.0009054
	speed: 0.0977s/iter; left time: 3875.7939s
	iters: 300, epoch: 16 | loss: 0.0000005
	speed: 0.0809s/iter; left time: 3202.1150s
	iters: 400, epoch: 16 | loss: 0.0665397
	speed: 0.0814s/iter; left time: 3211.8986s
Epoch: 16 cost time: 42.68139410018921
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0004060
	speed: 0.5028s/iter; left time: 19756.9167s
	iters: 200, epoch: 17 | loss: 0.0021442
	speed: 0.1009s/iter; left time: 3955.0631s
	iters: 300, epoch: 17 | loss: 0.1601277
	speed: 0.0892s/iter; left time: 3487.6985s
	iters: 400, epoch: 17 | loss: 0.0002487
	speed: 0.0911s/iter; left time: 3553.9055s
Epoch: 17 cost time: 44.50460147857666
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973983).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0002163
	speed: 0.5027s/iter; left time: 19519.8953s
	iters: 200, epoch: 18 | loss: 0.0330141
	speed: 0.1081s/iter; left time: 4188.2519s
	iters: 300, epoch: 18 | loss: 0.0031370
	speed: 0.1097s/iter; left time: 4237.5377s
	iters: 400, epoch: 18 | loss: 0.0228312
	speed: 0.1084s/iter; left time: 4177.8680s
Epoch: 18 cost time: 49.96708917617798
Epoch: 18, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0002331
	speed: 0.5302s/iter; left time: 20337.8545s
	iters: 200, epoch: 19 | loss: 0.0001945
	speed: 0.1019s/iter; left time: 3898.7302s
	iters: 300, epoch: 19 | loss: 0.0090361
	speed: 0.1120s/iter; left time: 4273.4545s
	iters: 400, epoch: 19 | loss: 0.0000136
	speed: 0.1121s/iter; left time: 4266.4338s
Epoch: 19 cost time: 49.86106777191162
Epoch: 19, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.962 Test Loss: 0.248 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2001885
	speed: 0.5157s/iter; left time: 19541.0362s
	iters: 200, epoch: 20 | loss: 0.0001553
	speed: 0.0814s/iter; left time: 3077.9232s
	iters: 300, epoch: 20 | loss: 0.0181438
	speed: 0.0796s/iter; left time: 3000.8828s
	iters: 400, epoch: 20 | loss: 0.0003375
	speed: 0.0800s/iter; left time: 3005.6456s
Epoch: 20 cost time: 40.1476993560791
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000484
	speed: 0.4934s/iter; left time: 18462.4977s
	iters: 200, epoch: 21 | loss: 0.0129364
	speed: 0.0706s/iter; left time: 2635.7510s
	iters: 300, epoch: 21 | loss: 0.0002267
	speed: 0.0786s/iter; left time: 2925.5235s
	iters: 400, epoch: 21 | loss: 0.0000120
	speed: 0.0906s/iter; left time: 3361.7633s
Epoch: 21 cost time: 39.258063077926636
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.973983 --> -0.975127).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0015258
	speed: 0.5349s/iter; left time: 19764.1411s
	iters: 200, epoch: 22 | loss: 0.0042543
	speed: 0.0960s/iter; left time: 3539.3730s
	iters: 300, epoch: 22 | loss: 0.0267235
	speed: 0.0881s/iter; left time: 3239.6814s
	iters: 400, epoch: 22 | loss: 0.0117323
	speed: 0.0965s/iter; left time: 3535.3720s
Epoch: 22 cost time: 44.280696392059326
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.282 Vali Acc: 0.959 Test Loss: 0.282 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000502
	speed: 0.4804s/iter; left time: 17524.8841s
	iters: 200, epoch: 23 | loss: 0.1745535
	speed: 0.0682s/iter; left time: 2481.1818s
	iters: 300, epoch: 23 | loss: 0.0000042
	speed: 0.0740s/iter; left time: 2683.8208s
	iters: 400, epoch: 23 | loss: 0.0984528
	speed: 0.1070s/iter; left time: 3872.1116s
Epoch: 23 cost time: 40.34734797477722
Epoch: 23, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0045075
	speed: 0.5328s/iter; left time: 19186.9419s
	iters: 200, epoch: 24 | loss: 0.1278314
	speed: 0.1075s/iter; left time: 3859.2541s
	iters: 300, epoch: 24 | loss: 0.0001050
	speed: 0.0844s/iter; left time: 3021.4851s
	iters: 400, epoch: 24 | loss: 0.0021105
	speed: 0.0887s/iter; left time: 3166.7133s
Epoch: 24 cost time: 44.44109225273132
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.975127 --> -0.975127).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0130918
	speed: 0.4639s/iter; left time: 16488.4255s
	iters: 200, epoch: 25 | loss: 0.3009827
	speed: 0.0745s/iter; left time: 2641.5635s
	iters: 300, epoch: 25 | loss: 0.1747640
	speed: 0.0759s/iter; left time: 2683.3782s
	iters: 400, epoch: 25 | loss: 0.0003546
	speed: 0.0803s/iter; left time: 2828.5614s
Epoch: 25 cost time: 37.26901817321777
Epoch: 25, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000856
	speed: 0.5043s/iter; left time: 17688.2536s
	iters: 200, epoch: 26 | loss: 0.0017382
	speed: 0.0870s/iter; left time: 3043.4017s
	iters: 300, epoch: 26 | loss: 0.0060649
	speed: 0.0874s/iter; left time: 3049.6530s
	iters: 400, epoch: 26 | loss: 0.0041978
	speed: 0.0753s/iter; left time: 2618.9479s
Epoch: 26 cost time: 40.086278676986694
Epoch: 26, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.961 Test Loss: 0.228 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000004
	speed: 0.4878s/iter; left time: 16881.8032s
	iters: 200, epoch: 27 | loss: 0.0004700
	speed: 0.0824s/iter; left time: 2842.9237s
	iters: 300, epoch: 27 | loss: 0.0233363
	speed: 0.0842s/iter; left time: 2898.1405s
	iters: 400, epoch: 27 | loss: 0.0002711
	speed: 0.0777s/iter; left time: 2664.8484s
Epoch: 27 cost time: 39.24857425689697
Epoch: 27, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.184 Vali Acc: 0.966 Test Loss: 0.184 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000179
	speed: 0.4632s/iter; left time: 15812.7811s
	iters: 200, epoch: 28 | loss: 0.0001183
	speed: 0.0938s/iter; left time: 3191.8927s
	iters: 300, epoch: 28 | loss: 0.0010279
	speed: 0.0836s/iter; left time: 2836.5977s
	iters: 400, epoch: 28 | loss: 0.0021875
	speed: 0.0857s/iter; left time: 2898.3652s
Epoch: 28 cost time: 42.70389747619629
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.2955611
	speed: 0.4884s/iter; left time: 16444.9111s
	iters: 200, epoch: 29 | loss: 0.0000031
	speed: 0.0951s/iter; left time: 3191.9876s
	iters: 300, epoch: 29 | loss: 0.0004705
	speed: 0.0964s/iter; left time: 3226.5684s
	iters: 400, epoch: 29 | loss: 0.0023512
	speed: 0.0903s/iter; left time: 3014.2771s
Epoch: 29 cost time: 44.60826349258423
Epoch: 29, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0956263
	speed: 0.4852s/iter; left time: 16109.6828s
	iters: 200, epoch: 30 | loss: 0.0000864
	speed: 0.1039s/iter; left time: 3438.2445s
	iters: 300, epoch: 30 | loss: 0.0033482
	speed: 0.1025s/iter; left time: 3382.3843s
	iters: 400, epoch: 30 | loss: 0.0000218
	speed: 0.0876s/iter; left time: 2882.2990s
Epoch: 30 cost time: 44.822088956832886
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.975127 --> -0.977986).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0001785
	speed: 0.4846s/iter; left time: 15862.0032s
	iters: 200, epoch: 31 | loss: 0.0006310
	speed: 0.0905s/iter; left time: 2954.1559s
	iters: 300, epoch: 31 | loss: 0.0000828
	speed: 0.0957s/iter; left time: 3112.5041s
	iters: 400, epoch: 31 | loss: 0.0178409
	speed: 0.0923s/iter; left time: 2993.4892s
Epoch: 31 cost time: 45.20055031776428
Epoch: 31, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000112
	speed: 0.5151s/iter; left time: 16618.3356s
	iters: 200, epoch: 32 | loss: 0.0023873
	speed: 0.0934s/iter; left time: 3002.8174s
	iters: 300, epoch: 32 | loss: 0.0000630
	speed: 0.0997s/iter; left time: 3197.7326s
	iters: 400, epoch: 32 | loss: 0.0684430
	speed: 0.1030s/iter; left time: 3293.1870s
Epoch: 32 cost time: 46.54864764213562
Epoch: 32, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.247 Vali Acc: 0.952 Test Loss: 0.247 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0540105
	speed: 0.5125s/iter; left time: 16293.6201s
	iters: 200, epoch: 33 | loss: 0.0000614
	speed: 0.0842s/iter; left time: 2667.1697s
	iters: 300, epoch: 33 | loss: 0.0005433
	speed: 0.0867s/iter; left time: 2738.7724s
	iters: 400, epoch: 33 | loss: 0.0000098
	speed: 0.0980s/iter; left time: 3085.4193s
Epoch: 33 cost time: 42.79994297027588
Epoch: 33, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000246
	speed: 0.4667s/iter; left time: 14617.5087s
	iters: 200, epoch: 34 | loss: 0.0000699
	speed: 0.0713s/iter; left time: 2226.9237s
	iters: 300, epoch: 34 | loss: 0.0273751
	speed: 0.0768s/iter; left time: 2389.1391s
	iters: 400, epoch: 34 | loss: 0.2596986
	speed: 0.0867s/iter; left time: 2689.0924s
Epoch: 34 cost time: 37.08347225189209
Epoch: 34, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0006423
	speed: 0.4661s/iter; left time: 14381.5069s
	iters: 200, epoch: 35 | loss: 0.0063164
	speed: 0.0937s/iter; left time: 2881.3611s
	iters: 300, epoch: 35 | loss: 0.0010151
	speed: 0.0882s/iter; left time: 2703.7537s
	iters: 400, epoch: 35 | loss: 0.0146834
	speed: 0.0832s/iter; left time: 2542.6418s
Epoch: 35 cost time: 41.924957275390625
Epoch: 35, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0000028
	speed: 0.5040s/iter; left time: 15314.7071s
	iters: 200, epoch: 36 | loss: 0.1837746
	speed: 0.0849s/iter; left time: 2570.1963s
	iters: 300, epoch: 36 | loss: 0.0015135
	speed: 0.0758s/iter; left time: 2287.0606s
	iters: 400, epoch: 36 | loss: 0.0000296
	speed: 0.0729s/iter; left time: 2193.1835s
Epoch: 36 cost time: 39.58385896682739
Epoch: 36, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0000114
	speed: 0.4967s/iter; left time: 14859.1728s
	iters: 200, epoch: 37 | loss: 0.0000044
	speed: 0.0910s/iter; left time: 2713.2169s
	iters: 300, epoch: 37 | loss: 0.0066551
	speed: 0.0794s/iter; left time: 2358.0665s
	iters: 400, epoch: 37 | loss: 0.0486042
	speed: 0.0737s/iter; left time: 2183.3335s
Epoch: 37 cost time: 39.354368686676025
Epoch: 37, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0000080
	speed: 0.4063s/iter; left time: 11965.3834s
	iters: 200, epoch: 38 | loss: 0.0043531
	speed: 0.0901s/iter; left time: 2643.7264s
	iters: 300, epoch: 38 | loss: 0.0006402
	speed: 0.0910s/iter; left time: 2660.9272s
	iters: 400, epoch: 38 | loss: 0.1785870
	speed: 0.0823s/iter; left time: 2399.8905s
Epoch: 38 cost time: 40.83474326133728
Epoch: 38, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0650562
	speed: 0.4339s/iter; left time: 12573.9235s
	iters: 200, epoch: 39 | loss: 0.0000077
	speed: 0.0871s/iter; left time: 2514.2273s
	iters: 300, epoch: 39 | loss: 0.0005815
	speed: 0.0797s/iter; left time: 2292.5003s
	iters: 400, epoch: 39 | loss: 0.0004777
	speed: 0.0916s/iter; left time: 2627.5962s
Epoch: 39 cost time: 40.528085470199585
Epoch: 39, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0000077
	speed: 0.4661s/iter; left time: 13288.0782s
	iters: 200, epoch: 40 | loss: 0.0000728
	speed: 0.0886s/iter; left time: 2517.0133s
	iters: 300, epoch: 40 | loss: 0.0000238
	speed: 0.0964s/iter; left time: 2729.6576s
	iters: 400, epoch: 40 | loss: 0.0003541
	speed: 0.0984s/iter; left time: 2775.5530s
Epoch: 40 cost time: 43.10777568817139
Epoch: 40, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
Validation loss decreased (-0.977986 --> -0.981417).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0000041
	speed: 0.4494s/iter; left time: 12601.9561s
	iters: 200, epoch: 41 | loss: 0.1110860
	speed: 0.0797s/iter; left time: 2226.7507s
	iters: 300, epoch: 41 | loss: 0.0000099
	speed: 0.0748s/iter; left time: 2082.9326s
	iters: 400, epoch: 41 | loss: 0.0609409
	speed: 0.0796s/iter; left time: 2208.5974s
Epoch: 41 cost time: 38.380794286727905
Epoch: 41, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0000960
	speed: 0.4652s/iter; left time: 12826.6792s
	iters: 200, epoch: 42 | loss: 0.0000349
	speed: 0.0910s/iter; left time: 2500.8347s
	iters: 300, epoch: 42 | loss: 0.0065275
	speed: 0.0870s/iter; left time: 2381.8559s
	iters: 400, epoch: 42 | loss: 0.0000536
	speed: 0.0866s/iter; left time: 2362.9830s
Epoch: 42 cost time: 41.55048894882202
Epoch: 42, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.1420428
	speed: 0.4808s/iter; left time: 13030.0752s
	iters: 200, epoch: 43 | loss: 0.3337278
	speed: 0.0720s/iter; left time: 1944.0608s
	iters: 300, epoch: 43 | loss: 0.0000430
	speed: 0.0775s/iter; left time: 2085.6872s
	iters: 400, epoch: 43 | loss: 0.0000131
	speed: 0.0746s/iter; left time: 2000.2238s
Epoch: 43 cost time: 36.75781774520874
Epoch: 43, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0063341
	speed: 0.4775s/iter; left time: 12717.9767s
	iters: 200, epoch: 44 | loss: 0.0332574
	speed: 0.0776s/iter; left time: 2058.3240s
	iters: 300, epoch: 44 | loss: 0.0091126
	speed: 0.0777s/iter; left time: 2054.6069s
	iters: 400, epoch: 44 | loss: 0.2171669
	speed: 0.0808s/iter; left time: 2128.7364s
Epoch: 44 cost time: 38.214494705200195
Epoch: 44, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0114800
	speed: 0.4316s/iter; left time: 11291.9245s
	iters: 200, epoch: 45 | loss: 0.0001239
	speed: 0.0835s/iter; left time: 2177.2475s
	iters: 300, epoch: 45 | loss: 0.0000033
	speed: 0.0770s/iter; left time: 1999.7024s
	iters: 400, epoch: 45 | loss: 0.0303933
	speed: 0.0781s/iter; left time: 2020.1762s
Epoch: 45 cost time: 37.20996880531311
Epoch: 45, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0604745
	speed: 0.4601s/iter; left time: 11821.4639s
	iters: 200, epoch: 46 | loss: 0.0700667
	speed: 0.0861s/iter; left time: 2204.7094s
	iters: 300, epoch: 46 | loss: 0.1153516
	speed: 0.0851s/iter; left time: 2170.0160s
	iters: 400, epoch: 46 | loss: 0.0004113
	speed: 0.0793s/iter; left time: 2014.7901s
Epoch: 46 cost time: 40.79181671142578
Epoch: 46, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.1021297
	speed: 0.4490s/iter; left time: 11327.7663s
	iters: 200, epoch: 47 | loss: 0.0012050
	speed: 0.0955s/iter; left time: 2400.1466s
	iters: 300, epoch: 47 | loss: 0.0032081
	speed: 0.0964s/iter; left time: 2413.2926s
	iters: 400, epoch: 47 | loss: 0.0005226
	speed: 0.0972s/iter; left time: 2422.8175s
Epoch: 47 cost time: 43.70668435096741
Epoch: 47, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.1756398
	speed: 0.4292s/iter; left time: 10626.5064s
	iters: 200, epoch: 48 | loss: 0.0024499
	speed: 0.0729s/iter; left time: 1798.6186s
	iters: 300, epoch: 48 | loss: 0.0019148
	speed: 0.0820s/iter; left time: 2013.8498s
	iters: 400, epoch: 48 | loss: 0.0001061
	speed: 0.0947s/iter; left time: 2317.2429s
Epoch: 48 cost time: 39.6940758228302
Epoch: 48, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.279 Vali Acc: 0.951 Test Loss: 0.279 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0002057
	speed: 0.4727s/iter; left time: 11480.9011s
	iters: 200, epoch: 49 | loss: 0.0000001
	speed: 0.0768s/iter; left time: 1856.5975s
	iters: 300, epoch: 49 | loss: 0.0368537
	speed: 0.0836s/iter; left time: 2013.6124s
	iters: 400, epoch: 49 | loss: 0.0002275
	speed: 0.0899s/iter; left time: 2156.4054s
Epoch: 49 cost time: 39.67701721191406
Epoch: 49, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.976 Test Loss: 0.236 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0024100
	speed: 0.4455s/iter; left time: 10611.0232s
	iters: 200, epoch: 50 | loss: 0.0000017
	speed: 0.0824s/iter; left time: 1955.1116s
	iters: 300, epoch: 50 | loss: 0.0032322
	speed: 0.0769s/iter; left time: 1817.4484s
	iters: 400, epoch: 50 | loss: 0.0266876
	speed: 0.0688s/iter; left time: 1618.7246s
Epoch: 50 cost time: 36.95928382873535
Epoch: 50, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.217 Vali Acc: 0.968 Test Loss: 0.217 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 5301306
model size : 30.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4509315
	speed: 0.0992s/iter; left time: 4640.7730s
	iters: 200, epoch: 1 | loss: 0.0373109
	speed: 0.0721s/iter; left time: 3367.0110s
	iters: 300, epoch: 1 | loss: 0.0474202
	speed: 0.0883s/iter; left time: 4114.9941s
	iters: 400, epoch: 1 | loss: 0.0064295
	speed: 0.0804s/iter; left time: 3738.8089s
Epoch: 1 cost time: 40.739803314208984
Epoch: 1, Steps: 469 | Train Loss: 0.304 Vali Loss: 0.201 Vali Acc: 0.947 Test Loss: 0.201 Test Acc: 0.947
Validation loss decreased (inf --> -0.947111).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0371198
	speed: 0.3823s/iter; left time: 17710.4678s
	iters: 200, epoch: 2 | loss: 0.0062055
	speed: 0.0646s/iter; left time: 2986.9051s
	iters: 300, epoch: 2 | loss: 0.0045267
	speed: 0.0658s/iter; left time: 3036.7059s
	iters: 400, epoch: 2 | loss: 0.0811804
	speed: 0.0709s/iter; left time: 3264.7095s
Epoch: 2 cost time: 31.882213830947876
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.947111 --> -0.964264).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0316806
	speed: 0.4073s/iter; left time: 18680.2977s
	iters: 200, epoch: 3 | loss: 0.0038864
	speed: 0.0745s/iter; left time: 3410.5181s
	iters: 300, epoch: 3 | loss: 0.0220945
	speed: 0.0683s/iter; left time: 3120.1604s
	iters: 400, epoch: 3 | loss: 0.2979326
	speed: 0.0691s/iter; left time: 3146.6609s
Epoch: 3 cost time: 33.74881315231323
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0061106
	speed: 0.4270s/iter; left time: 19384.6598s
	iters: 200, epoch: 4 | loss: 0.0011058
	speed: 0.0752s/iter; left time: 3405.3461s
	iters: 300, epoch: 4 | loss: 0.0079004
	speed: 0.0703s/iter; left time: 3177.5608s
	iters: 400, epoch: 4 | loss: 0.0104520
	speed: 0.0676s/iter; left time: 3049.4387s
Epoch: 4 cost time: 35.6039674282074
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.261 Vali Acc: 0.959 Test Loss: 0.261 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1443570
	speed: 0.3793s/iter; left time: 17038.3961s
	iters: 200, epoch: 5 | loss: 0.0038260
	speed: 0.0841s/iter; left time: 3771.5188s
	iters: 300, epoch: 5 | loss: 0.1114874
	speed: 0.0809s/iter; left time: 3617.1715s
	iters: 400, epoch: 5 | loss: 0.2846292
	speed: 0.0747s/iter; left time: 3331.5734s
Epoch: 5 cost time: 37.699615716934204
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.258 Vali Acc: 0.953 Test Loss: 0.258 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.3522969
	speed: 0.4004s/iter; left time: 17799.4348s
	iters: 200, epoch: 6 | loss: 0.2093441
	speed: 0.0809s/iter; left time: 3588.6184s
	iters: 300, epoch: 6 | loss: 0.0557488
	speed: 0.0858s/iter; left time: 3797.5564s
	iters: 400, epoch: 6 | loss: 0.0105028
	speed: 0.0830s/iter; left time: 3666.9176s
Epoch: 6 cost time: 38.474942207336426
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
Validation loss decreased (-0.964264 --> -0.967980).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0123159
	speed: 0.3995s/iter; left time: 17574.6259s
	iters: 200, epoch: 7 | loss: 0.0141698
	speed: 0.0782s/iter; left time: 3431.8812s
	iters: 300, epoch: 7 | loss: 0.0001671
	speed: 0.0849s/iter; left time: 3716.7256s
	iters: 400, epoch: 7 | loss: 0.0164319
	speed: 0.0906s/iter; left time: 3958.1229s
Epoch: 7 cost time: 40.44197344779968
Epoch: 7, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0219388
	speed: 0.4388s/iter; left time: 19097.2295s
	iters: 200, epoch: 8 | loss: 0.3830990
	speed: 0.0755s/iter; left time: 3279.3913s
	iters: 300, epoch: 8 | loss: 0.0000090
	speed: 0.0745s/iter; left time: 3229.3272s
	iters: 400, epoch: 8 | loss: 0.0002731
	speed: 0.0808s/iter; left time: 3494.1080s
Epoch: 8 cost time: 37.478946924209595
Epoch: 8, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000214
	speed: 0.4324s/iter; left time: 18615.4472s
	iters: 200, epoch: 9 | loss: 0.0002538
	speed: 0.0733s/iter; left time: 3148.9902s
	iters: 300, epoch: 9 | loss: 0.0036041
	speed: 0.0705s/iter; left time: 3022.1389s
	iters: 400, epoch: 9 | loss: 0.0166544
	speed: 0.0657s/iter; left time: 2810.1016s
Epoch: 9 cost time: 35.042156457901
Epoch: 9, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.961 Test Loss: 0.248 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0011520
	speed: 0.4045s/iter; left time: 17224.3707s
	iters: 200, epoch: 10 | loss: 0.0000933
	speed: 0.0820s/iter; left time: 3484.2205s
	iters: 300, epoch: 10 | loss: 0.0000454
	speed: 0.0776s/iter; left time: 3290.6950s
	iters: 400, epoch: 10 | loss: 0.3070327
	speed: 0.0728s/iter; left time: 3079.1903s
Epoch: 10 cost time: 36.53115105628967
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.959 Test Loss: 0.275 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0066170
	speed: 0.3966s/iter; left time: 16699.8539s
	iters: 200, epoch: 11 | loss: 0.0001945
	speed: 0.0608s/iter; left time: 2556.0436s
	iters: 300, epoch: 11 | loss: 0.0543117
	speed: 0.0668s/iter; left time: 2799.3133s
	iters: 400, epoch: 11 | loss: 0.5826417
	speed: 0.0803s/iter; left time: 3356.2261s
Epoch: 11 cost time: 33.375192403793335
Epoch: 11, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0026793
	speed: 0.4377s/iter; left time: 18227.3731s
	iters: 200, epoch: 12 | loss: 0.0087801
	speed: 0.0717s/iter; left time: 2978.4234s
	iters: 300, epoch: 12 | loss: 0.0015436
	speed: 0.0742s/iter; left time: 3074.2979s
	iters: 400, epoch: 12 | loss: 0.0005010
	speed: 0.0855s/iter; left time: 3536.2921s
Epoch: 12 cost time: 37.28535842895508
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0345089
	speed: 0.4013s/iter; left time: 16520.7300s
	iters: 200, epoch: 13 | loss: 0.0013304
	speed: 0.0668s/iter; left time: 2742.0275s
	iters: 300, epoch: 13 | loss: 0.0327738
	speed: 0.0715s/iter; left time: 2928.5626s
	iters: 400, epoch: 13 | loss: 0.0000299
	speed: 0.0716s/iter; left time: 2924.9604s
Epoch: 13 cost time: 32.9106810092926
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.212 Vali Acc: 0.959 Test Loss: 0.212 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.6585605
	speed: 0.4435s/iter; left time: 18050.4354s
	iters: 200, epoch: 14 | loss: 0.3880202
	speed: 0.0698s/iter; left time: 2834.5867s
	iters: 300, epoch: 14 | loss: 0.0242255
	speed: 0.0730s/iter; left time: 2955.2057s
	iters: 400, epoch: 14 | loss: 0.0000136
	speed: 0.0722s/iter; left time: 2915.1497s
Epoch: 14 cost time: 34.67815661430359
Epoch: 14, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.367 Vali Acc: 0.958 Test Loss: 0.367 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0013928
	speed: 0.4426s/iter; left time: 17808.0635s
	iters: 200, epoch: 15 | loss: 0.0004235
	speed: 0.0716s/iter; left time: 2874.1796s
	iters: 300, epoch: 15 | loss: 0.0171369
	speed: 0.0733s/iter; left time: 2936.1763s
	iters: 400, epoch: 15 | loss: 0.0045024
	speed: 0.0757s/iter; left time: 3023.5057s
Epoch: 15 cost time: 36.293596506118774
Epoch: 15, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3477842
	speed: 0.4393s/iter; left time: 17470.0254s
	iters: 200, epoch: 16 | loss: 0.0191506
	speed: 0.0751s/iter; left time: 2979.6748s
	iters: 300, epoch: 16 | loss: 0.0000014
	speed: 0.0669s/iter; left time: 2647.3967s
	iters: 400, epoch: 16 | loss: 0.2924982
	speed: 0.0770s/iter; left time: 3037.9381s
Epoch: 16 cost time: 36.68466663360596
Epoch: 16, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.230 Vali Acc: 0.955 Test Loss: 0.230 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9679817038307604
model parameter : 5301306
model size : 30.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4147886
	speed: 0.1011s/iter; left time: 4733.3356s
	iters: 200, epoch: 1 | loss: 0.0465493
	speed: 0.0793s/iter; left time: 3705.0086s
	iters: 300, epoch: 1 | loss: 0.0912985
	speed: 0.0766s/iter; left time: 3568.8551s
	iters: 400, epoch: 1 | loss: 0.0030229
	speed: 0.0754s/iter; left time: 3504.7271s
Epoch: 1 cost time: 39.009233713150024
Epoch: 1, Steps: 469 | Train Loss: 0.291 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (inf --> -0.941393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0482027
	speed: 0.4625s/iter; left time: 21428.7929s
	iters: 200, epoch: 2 | loss: 0.0344628
	speed: 0.0770s/iter; left time: 3559.4271s
	iters: 300, epoch: 2 | loss: 0.0070016
	speed: 0.0751s/iter; left time: 3464.5045s
	iters: 400, epoch: 2 | loss: 0.2187694
	speed: 0.0713s/iter; left time: 3283.2543s
Epoch: 2 cost time: 36.24206900596619
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.941393 --> -0.965121).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0009128
	speed: 0.4278s/iter; left time: 19619.7837s
	iters: 200, epoch: 3 | loss: 0.0005679
	speed: 0.0869s/iter; left time: 3976.3118s
	iters: 300, epoch: 3 | loss: 0.0008677
	speed: 0.0815s/iter; left time: 3721.9597s
	iters: 400, epoch: 3 | loss: 0.1078453
	speed: 0.0733s/iter; left time: 3341.0513s
Epoch: 3 cost time: 38.0144898891449
Epoch: 3, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.940 Test Loss: 0.257 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000447
	speed: 0.4310s/iter; left time: 19565.8642s
	iters: 200, epoch: 4 | loss: 0.0005855
	speed: 0.0880s/iter; left time: 3987.4916s
	iters: 300, epoch: 4 | loss: 0.0000671
	speed: 0.0717s/iter; left time: 3241.7383s
	iters: 400, epoch: 4 | loss: 0.0316348
	speed: 0.0763s/iter; left time: 3442.3099s
Epoch: 4 cost time: 37.38043165206909
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0136959
	speed: 0.4150s/iter; left time: 18644.2369s
	iters: 200, epoch: 5 | loss: 0.0011254
	speed: 0.0810s/iter; left time: 3629.2120s
	iters: 300, epoch: 5 | loss: 0.2574685
	speed: 0.0831s/iter; left time: 3715.4514s
	iters: 400, epoch: 5 | loss: 0.1184771
	speed: 0.0727s/iter; left time: 3243.4277s
Epoch: 5 cost time: 38.46515369415283
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0077000
	speed: 0.4223s/iter; left time: 18775.4631s
	iters: 200, epoch: 6 | loss: 0.0594497
	speed: 0.0731s/iter; left time: 3240.4458s
	iters: 300, epoch: 6 | loss: 0.0002310
	speed: 0.0878s/iter; left time: 3884.9556s
	iters: 400, epoch: 6 | loss: 0.0006239
	speed: 0.0847s/iter; left time: 3741.1361s
Epoch: 6 cost time: 38.60229563713074
Epoch: 6, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.306 Vali Acc: 0.945 Test Loss: 0.306 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0001069
	speed: 0.4061s/iter; left time: 17862.9826s
	iters: 200, epoch: 7 | loss: 0.1032932
	speed: 0.0757s/iter; left time: 3321.5327s
	iters: 300, epoch: 7 | loss: 0.0097750
	speed: 0.0765s/iter; left time: 3351.2088s
	iters: 400, epoch: 7 | loss: 0.0023696
	speed: 0.0798s/iter; left time: 3485.5768s
Epoch: 7 cost time: 37.263245582580566
Epoch: 7, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.965121 --> -0.966551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3724461
	speed: 0.4269s/iter; left time: 18579.9981s
	iters: 200, epoch: 8 | loss: 1.1341178
	speed: 0.0811s/iter; left time: 3522.5741s
	iters: 300, epoch: 8 | loss: 0.0000031
	speed: 0.0766s/iter; left time: 3316.6454s
	iters: 400, epoch: 8 | loss: 0.0000036
	speed: 0.0852s/iter; left time: 3683.2983s
Epoch: 8 cost time: 38.343528270721436
Epoch: 8, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.968837).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000090
	speed: 0.4525s/iter; left time: 19480.4238s
	iters: 200, epoch: 9 | loss: 0.0311942
	speed: 0.0831s/iter; left time: 3569.0911s
	iters: 300, epoch: 9 | loss: 0.0778984
	speed: 0.0784s/iter; left time: 3361.0273s
	iters: 400, epoch: 9 | loss: 0.0002040
	speed: 0.0748s/iter; left time: 3195.6553s
Epoch: 9 cost time: 37.33775806427002
Epoch: 9, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
Validation loss decreased (-0.968837 --> -0.970553).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.4703s/iter; left time: 20024.1857s
	iters: 200, epoch: 10 | loss: 0.0000784
	speed: 0.0749s/iter; left time: 3182.6107s
	iters: 300, epoch: 10 | loss: 0.0003412
	speed: 0.0721s/iter; left time: 3056.6746s
	iters: 400, epoch: 10 | loss: 0.0000002
	speed: 0.0725s/iter; left time: 3067.1569s
Epoch: 10 cost time: 36.44668507575989
Epoch: 10, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.970553 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000402
	speed: 0.4118s/iter; left time: 17339.9039s
	iters: 200, epoch: 11 | loss: 0.0534283
	speed: 0.0673s/iter; left time: 2827.9436s
	iters: 300, epoch: 11 | loss: 0.0061498
	speed: 0.0712s/iter; left time: 2983.2538s
	iters: 400, epoch: 11 | loss: 0.0031549
	speed: 0.0738s/iter; left time: 3086.9740s
Epoch: 11 cost time: 33.844714403152466
Epoch: 11, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
Validation loss decreased (-0.975413 --> -0.981988).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0132876
	speed: 0.4202s/iter; left time: 17496.1607s
	iters: 200, epoch: 12 | loss: 0.0043240
	speed: 0.0740s/iter; left time: 3075.7205s
	iters: 300, epoch: 12 | loss: 0.0000000
	speed: 0.0741s/iter; left time: 3069.3558s
	iters: 400, epoch: 12 | loss: 0.0164485
	speed: 0.0711s/iter; left time: 2939.1183s
Epoch: 12 cost time: 34.77028703689575
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0019133
	speed: 0.4126s/iter; left time: 16987.4857s
	iters: 200, epoch: 13 | loss: 0.1442431
	speed: 0.0795s/iter; left time: 3267.3072s
	iters: 300, epoch: 13 | loss: 0.0004176
	speed: 0.0799s/iter; left time: 3272.0437s
	iters: 400, epoch: 13 | loss: 0.0005492
	speed: 0.0783s/iter; left time: 3201.4932s
Epoch: 13 cost time: 37.72938251495361
Epoch: 13, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.300 Vali Acc: 0.955 Test Loss: 0.300 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 2.3862493
	speed: 0.3954s/iter; left time: 16094.0330s
	iters: 200, epoch: 14 | loss: 0.0000000
	speed: 0.0761s/iter; left time: 3088.4638s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.0844s/iter; left time: 3417.2063s
	iters: 400, epoch: 14 | loss: 0.0033996
	speed: 0.0876s/iter; left time: 3540.8364s
Epoch: 14 cost time: 36.95927929878235
Epoch: 14, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.285 Vali Acc: 0.971 Test Loss: 0.285 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000095
	speed: 0.4045s/iter; left time: 16273.4783s
	iters: 200, epoch: 15 | loss: 0.0000335
	speed: 0.0740s/iter; left time: 2969.4359s
	iters: 300, epoch: 15 | loss: 0.2022800
	speed: 0.0823s/iter; left time: 3293.4425s
	iters: 400, epoch: 15 | loss: 0.0000818
	speed: 0.0768s/iter; left time: 3065.4314s
Epoch: 15 cost time: 35.61929249763489
Epoch: 15, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.308 Vali Acc: 0.971 Test Loss: 0.308 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000185
	speed: 0.3724s/iter; left time: 14810.5931s
	iters: 200, epoch: 16 | loss: 0.0000017
	speed: 0.0841s/iter; left time: 3335.2729s
	iters: 300, epoch: 16 | loss: 0.0019155
	speed: 0.0715s/iter; left time: 2829.8372s
	iters: 400, epoch: 16 | loss: 0.0007362
	speed: 0.0718s/iter; left time: 2832.2281s
Epoch: 16 cost time: 36.55399417877197
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.242 Vali Acc: 0.977 Test Loss: 0.242 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0926163
	speed: 0.4162s/iter; left time: 16353.8804s
	iters: 200, epoch: 17 | loss: 0.0041715
	speed: 0.0844s/iter; left time: 3309.1342s
	iters: 300, epoch: 17 | loss: 0.0011164
	speed: 0.0887s/iter; left time: 3469.1381s
	iters: 400, epoch: 17 | loss: 0.0059331
	speed: 0.0695s/iter; left time: 2711.5775s
Epoch: 17 cost time: 38.74687075614929
Epoch: 17, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.979 Test Loss: 0.238 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000060
	speed: 0.4067s/iter; left time: 15791.0298s
	iters: 200, epoch: 18 | loss: 0.0005403
	speed: 0.0839s/iter; left time: 3248.6390s
	iters: 300, epoch: 18 | loss: 0.1118058
	speed: 0.0845s/iter; left time: 3265.3262s
	iters: 400, epoch: 18 | loss: 0.0049870
	speed: 0.0818s/iter; left time: 3150.3776s
Epoch: 18 cost time: 38.11033296585083
Epoch: 18, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.3824s/iter; left time: 14668.9886s
	iters: 200, epoch: 19 | loss: 0.0000000
	speed: 0.0639s/iter; left time: 2444.2948s
	iters: 300, epoch: 19 | loss: 0.0002647
	speed: 0.0745s/iter; left time: 2842.7984s
	iters: 400, epoch: 19 | loss: 0.0001274
	speed: 0.0813s/iter; left time: 3094.9593s
Epoch: 19 cost time: 35.04623055458069
Epoch: 19, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000044
	speed: 0.4010s/iter; left time: 15192.9272s
	iters: 200, epoch: 20 | loss: 0.0000315
	speed: 0.0777s/iter; left time: 2934.4115s
	iters: 300, epoch: 20 | loss: 0.0001201
	speed: 0.0757s/iter; left time: 2851.6201s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0812s/iter; left time: 3052.2805s
Epoch: 20 cost time: 36.47482204437256
Epoch: 20, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.361 Vali Acc: 0.967 Test Loss: 0.361 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001221
	speed: 0.4209s/iter; left time: 15751.4904s
	iters: 200, epoch: 21 | loss: 0.0148495
	speed: 0.0733s/iter; left time: 2737.2429s
	iters: 300, epoch: 21 | loss: 0.0000000
	speed: 0.0694s/iter; left time: 2583.3138s
	iters: 400, epoch: 21 | loss: 0.0004186
	speed: 0.0697s/iter; left time: 2588.6683s
Epoch: 21 cost time: 35.203874349594116
Epoch: 21, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.211 Vali Acc: 0.978 Test Loss: 0.211 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 5301306
model size : 30.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3358440
	speed: 0.1076s/iter; left time: 5035.6423s
	iters: 200, epoch: 1 | loss: 0.0449004
	speed: 0.0718s/iter; left time: 3353.5993s
	iters: 300, epoch: 1 | loss: 0.0311358
	speed: 0.0693s/iter; left time: 3228.1182s
	iters: 400, epoch: 1 | loss: 0.0048398
	speed: 0.0661s/iter; left time: 3073.8235s
Epoch: 1 cost time: 36.149959087371826
Epoch: 1, Steps: 469 | Train Loss: 0.339 Vali Loss: 0.234 Vali Acc: 0.927 Test Loss: 0.234 Test Acc: 0.927
Validation loss decreased (inf --> -0.926813).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0235552
	speed: 0.3810s/iter; left time: 17650.6099s
	iters: 200, epoch: 2 | loss: 0.1374049
	speed: 0.0731s/iter; left time: 3380.5503s
	iters: 300, epoch: 2 | loss: 0.0997478
	speed: 0.0788s/iter; left time: 3634.9686s
	iters: 400, epoch: 2 | loss: 0.0416732
	speed: 0.0790s/iter; left time: 3634.4405s
Epoch: 2 cost time: 36.277076959609985
Epoch: 2, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
Validation loss decreased (-0.926813 --> -0.955115).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0071267
	speed: 0.3681s/iter; left time: 16883.5074s
	iters: 200, epoch: 3 | loss: 0.0317103
	speed: 0.0685s/iter; left time: 3136.8333s
	iters: 300, epoch: 3 | loss: 0.3589231
	speed: 0.0711s/iter; left time: 3247.1771s
	iters: 400, epoch: 3 | loss: 0.0758050
	speed: 0.0758s/iter; left time: 3455.4756s
Epoch: 3 cost time: 34.080655097961426
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.955115 --> -0.968838).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0047230
	speed: 0.3621s/iter; left time: 16439.3873s
	iters: 200, epoch: 4 | loss: 0.0071341
	speed: 0.0638s/iter; left time: 2888.5920s
	iters: 300, epoch: 4 | loss: 0.2110385
	speed: 0.0626s/iter; left time: 2829.9636s
	iters: 400, epoch: 4 | loss: 0.0504065
	speed: 0.0562s/iter; left time: 2532.6117s
Epoch: 4 cost time: 30.27550435066223
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1399161
	speed: 0.3719s/iter; left time: 16708.8081s
	iters: 200, epoch: 5 | loss: 0.1373579
	speed: 0.0644s/iter; left time: 2888.4018s
	iters: 300, epoch: 5 | loss: 0.0002066
	speed: 0.0681s/iter; left time: 3047.2200s
	iters: 400, epoch: 5 | loss: 0.0073508
	speed: 0.0654s/iter; left time: 2918.5362s
Epoch: 5 cost time: 30.809423446655273
Epoch: 5, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0029744
	speed: 0.3789s/iter; left time: 16842.2515s
	iters: 200, epoch: 6 | loss: 0.0141030
	speed: 0.0701s/iter; left time: 3109.8751s
	iters: 300, epoch: 6 | loss: 0.0344221
	speed: 0.0683s/iter; left time: 3023.4542s
	iters: 400, epoch: 6 | loss: 0.0492407
	speed: 0.0652s/iter; left time: 2878.1518s
Epoch: 6 cost time: 33.341471672058105
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0125627
	speed: 0.3935s/iter; left time: 17307.8403s
	iters: 200, epoch: 7 | loss: 0.0989997
	speed: 0.0733s/iter; left time: 3216.2626s
	iters: 300, epoch: 7 | loss: 0.0381057
	speed: 0.0716s/iter; left time: 3136.7414s
	iters: 400, epoch: 7 | loss: 0.0002348
	speed: 0.0704s/iter; left time: 3074.6312s
Epoch: 7 cost time: 34.9961199760437
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.1602518
	speed: 0.3856s/iter; left time: 16780.8953s
	iters: 200, epoch: 8 | loss: 0.0011516
	speed: 0.0739s/iter; left time: 3209.3271s
	iters: 300, epoch: 8 | loss: 0.0036634
	speed: 0.0673s/iter; left time: 2914.8486s
	iters: 400, epoch: 8 | loss: 0.0083352
	speed: 0.0612s/iter; left time: 2645.4012s
Epoch: 8 cost time: 33.07658576965332
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0390689
	speed: 0.3333s/iter; left time: 14348.4501s
	iters: 200, epoch: 9 | loss: 0.1633710
	speed: 0.0656s/iter; left time: 2819.4310s
	iters: 300, epoch: 9 | loss: 0.0022083
	speed: 0.0784s/iter; left time: 3360.0383s
	iters: 400, epoch: 9 | loss: 0.0041305
	speed: 0.0787s/iter; left time: 3362.5756s
Epoch: 9 cost time: 34.41303563117981
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0005466
	speed: 0.3682s/iter; left time: 15677.2224s
	iters: 200, epoch: 10 | loss: 0.0261543
	speed: 0.0769s/iter; left time: 3266.9822s
	iters: 300, epoch: 10 | loss: 0.0073773
	speed: 0.0702s/iter; left time: 2974.2045s
	iters: 400, epoch: 10 | loss: 0.0050899
	speed: 0.0704s/iter; left time: 2976.3845s
Epoch: 10 cost time: 34.69370222091675
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.961 Test Loss: 0.208 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.1688119
	speed: 0.3858s/iter; left time: 16246.7460s
	iters: 200, epoch: 11 | loss: 0.0001588
	speed: 0.0579s/iter; left time: 2431.6261s
	iters: 300, epoch: 11 | loss: 0.1536258
	speed: 0.0646s/iter; left time: 2708.6426s
	iters: 400, epoch: 11 | loss: 0.0005078
	speed: 0.0639s/iter; left time: 2671.7992s
Epoch: 11 cost time: 30.357468843460083
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000608
	speed: 0.3626s/iter; left time: 15098.1631s
	iters: 200, epoch: 12 | loss: 0.0000050
	speed: 0.0577s/iter; left time: 2396.0967s
	iters: 300, epoch: 12 | loss: 0.2388964
	speed: 0.0611s/iter; left time: 2531.4408s
	iters: 400, epoch: 12 | loss: 0.0009121
	speed: 0.0686s/iter; left time: 2834.2540s
Epoch: 12 cost time: 30.11204767227173
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.968838 --> -0.975413).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0393922
	speed: 0.3628s/iter; left time: 14936.4196s
	iters: 200, epoch: 13 | loss: 0.0694774
	speed: 0.0592s/iter; left time: 2431.3098s
	iters: 300, epoch: 13 | loss: 0.0101605
	speed: 0.0556s/iter; left time: 2277.5224s
	iters: 400, epoch: 13 | loss: 0.1047601
	speed: 0.0566s/iter; left time: 2312.3523s
Epoch: 13 cost time: 28.591041564941406
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0172112
	speed: 0.3958s/iter; left time: 16111.6757s
	iters: 200, epoch: 14 | loss: 0.0007012
	speed: 0.0629s/iter; left time: 2552.6396s
	iters: 300, epoch: 14 | loss: 0.0002252
	speed: 0.0673s/iter; left time: 2726.6980s
	iters: 400, epoch: 14 | loss: 0.0013198
	speed: 0.0661s/iter; left time: 2670.7074s
Epoch: 14 cost time: 32.10019516944885
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0298601
	speed: 0.3825s/iter; left time: 15387.9628s
	iters: 200, epoch: 15 | loss: 0.0006191
	speed: 0.0718s/iter; left time: 2883.3898s
	iters: 300, epoch: 15 | loss: 0.8394887
	speed: 0.0720s/iter; left time: 2880.6889s
	iters: 400, epoch: 15 | loss: 0.0118008
	speed: 0.0724s/iter; left time: 2890.0485s
Epoch: 15 cost time: 34.55740809440613
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2642016
	speed: 0.3655s/iter; left time: 14532.6953s
	iters: 200, epoch: 16 | loss: 0.0001957
	speed: 0.0743s/iter; left time: 2945.7019s
	iters: 300, epoch: 16 | loss: 0.0022081
	speed: 0.0746s/iter; left time: 2953.3665s
	iters: 400, epoch: 16 | loss: 0.0026144
	speed: 0.0769s/iter; left time: 3035.6192s
Epoch: 16 cost time: 34.851717472076416
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0043646
	speed: 0.3547s/iter; left time: 13940.1107s
	iters: 200, epoch: 17 | loss: 0.0019291
	speed: 0.0632s/iter; left time: 2478.5602s
	iters: 300, epoch: 17 | loss: 0.0488291
	speed: 0.0648s/iter; left time: 2531.8629s
	iters: 400, epoch: 17 | loss: 0.0005135
	speed: 0.0765s/iter; left time: 2983.8723s
Epoch: 17 cost time: 32.96982526779175
Epoch: 17, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.2412305
	speed: 0.4073s/iter; left time: 15812.9975s
	iters: 200, epoch: 18 | loss: 0.0048373
	speed: 0.0733s/iter; left time: 2840.3510s
	iters: 300, epoch: 18 | loss: 0.0066475
	speed: 0.0664s/iter; left time: 2564.8917s
	iters: 400, epoch: 18 | loss: 0.0000136
	speed: 0.0645s/iter; left time: 2483.6417s
Epoch: 18 cost time: 32.58706259727478
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.239 Vali Acc: 0.958 Test Loss: 0.239 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0092907
	speed: 0.3740s/iter; left time: 14345.9413s
	iters: 200, epoch: 19 | loss: 0.2997889
	speed: 0.0626s/iter; left time: 2394.0137s
	iters: 300, epoch: 19 | loss: 0.0002874
	speed: 0.0665s/iter; left time: 2537.6407s
	iters: 400, epoch: 19 | loss: 0.0021643
	speed: 0.0685s/iter; left time: 2605.6598s
Epoch: 19 cost time: 31.20279359817505
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000118
	speed: 0.3783s/iter; left time: 14335.1634s
	iters: 200, epoch: 20 | loss: 0.0406479
	speed: 0.0750s/iter; left time: 2834.8082s
	iters: 300, epoch: 20 | loss: 0.0480298
	speed: 0.0775s/iter; left time: 2919.3776s
	iters: 400, epoch: 20 | loss: 0.0006504
	speed: 0.0730s/iter; left time: 2745.7480s
Epoch: 20 cost time: 35.367706537246704
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0011063
	speed: 0.3526s/iter; left time: 13194.6632s
	iters: 200, epoch: 21 | loss: 0.0046070
	speed: 0.0704s/iter; left time: 2629.1855s
	iters: 300, epoch: 21 | loss: 0.0049769
	speed: 0.0752s/iter; left time: 2799.0788s
	iters: 400, epoch: 21 | loss: 0.0013036
	speed: 0.0704s/iter; left time: 2614.8003s
Epoch: 21 cost time: 34.236205101013184
Epoch: 21, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0029391
	speed: 0.3611s/iter; left time: 13344.6414s
	iters: 200, epoch: 22 | loss: 0.0253698
	speed: 0.0624s/iter; left time: 2300.6632s
	iters: 300, epoch: 22 | loss: 0.1792722
	speed: 0.0613s/iter; left time: 2251.2570s
	iters: 400, epoch: 22 | loss: 0.0001570
	speed: 0.0603s/iter; left time: 2210.2660s
Epoch: 22 cost time: 30.262163877487183
Epoch: 22, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 3204154
model size : 22.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2775144
	speed: 0.0971s/iter; left time: 4543.1620s
	iters: 200, epoch: 1 | loss: 0.0191702
	speed: 0.0621s/iter; left time: 2901.9148s
	iters: 300, epoch: 1 | loss: 0.0088892
	speed: 0.0670s/iter; left time: 3123.2238s
	iters: 400, epoch: 1 | loss: 0.0030496
	speed: 0.0716s/iter; left time: 3331.3018s
Epoch: 1 cost time: 35.47744607925415
Epoch: 1, Steps: 469 | Train Loss: 0.317 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (inf --> -0.936533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0420612
	speed: 0.4224s/iter; left time: 19570.8808s
	iters: 200, epoch: 2 | loss: 0.0288467
	speed: 0.0762s/iter; left time: 3522.0691s
	iters: 300, epoch: 2 | loss: 0.0070750
	speed: 0.0769s/iter; left time: 3546.9878s
	iters: 400, epoch: 2 | loss: 0.0435006
	speed: 0.0733s/iter; left time: 3373.8693s
Epoch: 2 cost time: 35.498093366622925
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.936533 --> -0.958832).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0499791
	speed: 0.4043s/iter; left time: 18542.0206s
	iters: 200, epoch: 3 | loss: 0.0441381
	speed: 0.0746s/iter; left time: 3416.1250s
	iters: 300, epoch: 3 | loss: 0.0777487
	speed: 0.0718s/iter; left time: 3280.3198s
	iters: 400, epoch: 3 | loss: 0.0495388
	speed: 0.0775s/iter; left time: 3532.5783s
Epoch: 3 cost time: 35.417789936065674
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0010606
	speed: 0.4276s/iter; left time: 19412.2821s
	iters: 200, epoch: 4 | loss: 0.0104479
	speed: 0.0741s/iter; left time: 3357.3256s
	iters: 300, epoch: 4 | loss: 0.3982539
	speed: 0.0671s/iter; left time: 3031.4381s
	iters: 400, epoch: 4 | loss: 0.0037300
	speed: 0.0705s/iter; left time: 3180.4193s
Epoch: 4 cost time: 34.4341356754303
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
Validation loss decreased (-0.958832 --> -0.964263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0311178
	speed: 0.4216s/iter; left time: 18941.2558s
	iters: 200, epoch: 5 | loss: 0.0111913
	speed: 0.0697s/iter; left time: 3125.7811s
	iters: 300, epoch: 5 | loss: 0.0012853
	speed: 0.0723s/iter; left time: 3233.4484s
	iters: 400, epoch: 5 | loss: 0.0169217
	speed: 0.0730s/iter; left time: 3257.1993s
Epoch: 5 cost time: 34.77199459075928
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0003554
	speed: 0.3890s/iter; left time: 17294.7394s
	iters: 200, epoch: 6 | loss: 0.0010534
	speed: 0.0794s/iter; left time: 3520.4266s
	iters: 300, epoch: 6 | loss: 0.0182994
	speed: 0.0696s/iter; left time: 3081.6022s
	iters: 400, epoch: 6 | loss: 0.1175671
	speed: 0.0670s/iter; left time: 2958.7373s
Epoch: 6 cost time: 34.5931441783905
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1200254
	speed: 0.3886s/iter; left time: 17091.1683s
	iters: 200, epoch: 7 | loss: 0.1525167
	speed: 0.0803s/iter; left time: 3524.1022s
	iters: 300, epoch: 7 | loss: 0.0035639
	speed: 0.0793s/iter; left time: 3474.3812s
	iters: 400, epoch: 7 | loss: 0.0000316
	speed: 0.0732s/iter; left time: 3197.1003s
Epoch: 7 cost time: 36.999496936798096
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.259 Vali Acc: 0.957 Test Loss: 0.259 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0063696
	speed: 0.3938s/iter; left time: 17137.2075s
	iters: 200, epoch: 8 | loss: 0.0000402
	speed: 0.0755s/iter; left time: 3277.7487s
	iters: 300, epoch: 8 | loss: 0.0050029
	speed: 0.0803s/iter; left time: 3478.5656s
	iters: 400, epoch: 8 | loss: 0.1921646
	speed: 0.0772s/iter; left time: 3337.2029s
Epoch: 8 cost time: 36.25599646568298
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
Validation loss decreased (-0.964263 --> -0.971696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020129
	speed: 0.3803s/iter; left time: 16372.1389s
	iters: 200, epoch: 9 | loss: 0.1970953
	speed: 0.0703s/iter; left time: 3020.1122s
	iters: 300, epoch: 9 | loss: 0.0022111
	speed: 0.0723s/iter; left time: 3096.6919s
	iters: 400, epoch: 9 | loss: 0.0959765
	speed: 0.0827s/iter; left time: 3536.1147s
Epoch: 9 cost time: 35.99216294288635
Epoch: 9, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000881
	speed: 0.4146s/iter; left time: 17654.7172s
	iters: 200, epoch: 10 | loss: 0.0000069
	speed: 0.0747s/iter; left time: 3174.5533s
	iters: 300, epoch: 10 | loss: 0.0001625
	speed: 0.0723s/iter; left time: 3062.4548s
	iters: 400, epoch: 10 | loss: 0.0873934
	speed: 0.0761s/iter; left time: 3218.2041s
Epoch: 10 cost time: 35.74214792251587
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.221 Vali Acc: 0.964 Test Loss: 0.221 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001428
	speed: 0.4283s/iter; left time: 18036.7647s
	iters: 200, epoch: 11 | loss: 0.0045756
	speed: 0.0702s/iter; left time: 2948.5478s
	iters: 300, epoch: 11 | loss: 0.2201113
	speed: 0.0728s/iter; left time: 3052.0855s
	iters: 400, epoch: 11 | loss: 0.1500290
	speed: 0.0699s/iter; left time: 2921.9659s
Epoch: 11 cost time: 34.23281288146973
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000116
	speed: 0.3954s/iter; left time: 16465.6166s
	iters: 200, epoch: 12 | loss: 0.0000836
	speed: 0.0709s/iter; left time: 2946.2294s
	iters: 300, epoch: 12 | loss: 0.1051805
	speed: 0.0650s/iter; left time: 2695.3837s
	iters: 400, epoch: 12 | loss: 0.3497945
	speed: 0.0640s/iter; left time: 2647.4121s
Epoch: 12 cost time: 32.87121796607971
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0261945
	speed: 0.4146s/iter; left time: 17068.8148s
	iters: 200, epoch: 13 | loss: 0.0045563
	speed: 0.0781s/iter; left time: 3207.0977s
	iters: 300, epoch: 13 | loss: 0.0180862
	speed: 0.0771s/iter; left time: 3160.0083s
	iters: 400, epoch: 13 | loss: 0.0000275
	speed: 0.0751s/iter; left time: 3070.0945s
Epoch: 13 cost time: 37.33599376678467
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.297 Vali Acc: 0.966 Test Loss: 0.297 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0004345
	speed: 0.4198s/iter; left time: 17087.0692s
	iters: 200, epoch: 14 | loss: 0.0003857
	speed: 0.0774s/iter; left time: 3143.7366s
	iters: 300, epoch: 14 | loss: 0.0055162
	speed: 0.0768s/iter; left time: 3111.7167s
	iters: 400, epoch: 14 | loss: 0.0000285
	speed: 0.0720s/iter; left time: 2910.6386s
Epoch: 14 cost time: 36.48360872268677
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.324 Vali Acc: 0.957 Test Loss: 0.324 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000022
	speed: 0.3926s/iter; left time: 15794.4070s
	iters: 200, epoch: 15 | loss: 0.0530655
	speed: 0.0803s/iter; left time: 3222.4357s
	iters: 300, epoch: 15 | loss: 0.5513121
	speed: 0.0845s/iter; left time: 3383.6584s
	iters: 400, epoch: 15 | loss: 0.0002921
	speed: 0.0866s/iter; left time: 3458.7578s
Epoch: 15 cost time: 38.60646462440491
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.339 Vali Acc: 0.958 Test Loss: 0.339 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000355
	speed: 0.4059s/iter; left time: 16140.6138s
	iters: 200, epoch: 16 | loss: 0.1567236
	speed: 0.0738s/iter; left time: 2926.0329s
	iters: 300, epoch: 16 | loss: 0.0077667
	speed: 0.0804s/iter; left time: 3180.7941s
	iters: 400, epoch: 16 | loss: 0.0009696
	speed: 0.0785s/iter; left time: 3100.0234s
Epoch: 16 cost time: 36.65005874633789
Epoch: 16, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.240 Vali Acc: 0.961 Test Loss: 0.240 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0001063
	speed: 0.3819s/iter; left time: 15009.2626s
	iters: 200, epoch: 17 | loss: 0.0170991
	speed: 0.0734s/iter; left time: 2875.5928s
	iters: 300, epoch: 17 | loss: 0.0006775
	speed: 0.0676s/iter; left time: 2644.2573s
	iters: 400, epoch: 17 | loss: 0.0016818
	speed: 0.0661s/iter; left time: 2576.4031s
Epoch: 17 cost time: 33.27412700653076
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.284 Vali Acc: 0.965 Test Loss: 0.284 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0033853
	speed: 0.4074s/iter; left time: 15819.9884s
	iters: 200, epoch: 18 | loss: 0.0004877
	speed: 0.0707s/iter; left time: 2737.7248s
	iters: 300, epoch: 18 | loss: 0.0461825
	speed: 0.0691s/iter; left time: 2668.1308s
	iters: 400, epoch: 18 | loss: 0.0005174
	speed: 0.0717s/iter; left time: 2763.6641s
Epoch: 18 cost time: 33.3409264087677
Epoch: 18, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9716981132075472
model parameter : 3204154
model size : 22.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2273810
	speed: 0.0946s/iter; left time: 4428.0622s
	iters: 200, epoch: 1 | loss: 0.0249890
	speed: 0.0713s/iter; left time: 3328.7587s
	iters: 300, epoch: 1 | loss: 0.0052917
	speed: 0.0688s/iter; left time: 3204.1871s
	iters: 400, epoch: 1 | loss: 0.0058912
	speed: 0.0685s/iter; left time: 3183.5135s
Epoch: 1 cost time: 35.2410831451416
Epoch: 1, Steps: 469 | Train Loss: 0.306 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (inf --> -0.932530).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0374872
	speed: 0.3579s/iter; left time: 16580.7881s
	iters: 200, epoch: 2 | loss: 0.2719651
	speed: 0.0676s/iter; left time: 3123.8087s
	iters: 300, epoch: 2 | loss: 0.0092169
	speed: 0.0684s/iter; left time: 3154.0128s
	iters: 400, epoch: 2 | loss: 0.1416403
	speed: 0.0623s/iter; left time: 2867.6052s
Epoch: 2 cost time: 31.554319381713867
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.297 Vali Acc: 0.947 Test Loss: 0.297 Test Acc: 0.947
Validation loss decreased (-0.932530 --> -0.946824).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0107575
	speed: 0.3306s/iter; left time: 15160.1528s
	iters: 200, epoch: 3 | loss: 0.0007504
	speed: 0.0699s/iter; left time: 3199.4953s
	iters: 300, epoch: 3 | loss: 0.0341342
	speed: 0.0678s/iter; left time: 3095.3917s
	iters: 400, epoch: 3 | loss: 0.0578653
	speed: 0.0718s/iter; left time: 3270.0984s
Epoch: 3 cost time: 31.975684642791748
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.946824 --> -0.956831).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0464624
	speed: 0.3895s/iter; left time: 17681.0820s
	iters: 200, epoch: 4 | loss: 0.0017457
	speed: 0.0769s/iter; left time: 3481.8460s
	iters: 300, epoch: 4 | loss: 0.5756556
	speed: 0.0758s/iter; left time: 3425.3867s
	iters: 400, epoch: 4 | loss: 0.0052084
	speed: 0.0825s/iter; left time: 3719.3236s
Epoch: 4 cost time: 36.76197791099548
Epoch: 4, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.297 Vali Acc: 0.947 Test Loss: 0.297 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.8638632
	speed: 0.3831s/iter; left time: 17212.8457s
	iters: 200, epoch: 5 | loss: 0.0047146
	speed: 0.0620s/iter; left time: 2778.0050s
	iters: 300, epoch: 5 | loss: 0.0041401
	speed: 0.0589s/iter; left time: 2633.2951s
	iters: 400, epoch: 5 | loss: 0.0000034
	speed: 0.0594s/iter; left time: 2650.0008s
Epoch: 5 cost time: 28.86679482460022
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.207 Vali Acc: 0.965 Test Loss: 0.207 Test Acc: 0.965
Validation loss decreased (-0.956831 --> -0.964835).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2272955
	speed: 0.3763s/iter; left time: 16728.2788s
	iters: 200, epoch: 6 | loss: 0.0001729
	speed: 0.0642s/iter; left time: 2847.8261s
	iters: 300, epoch: 6 | loss: 0.0028850
	speed: 0.0641s/iter; left time: 2836.6239s
	iters: 400, epoch: 6 | loss: 0.0000470
	speed: 0.0649s/iter; left time: 2866.7744s
Epoch: 6 cost time: 31.202176332473755
Epoch: 6, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.964835 --> -0.967694).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0252019
	speed: 0.3935s/iter; left time: 17310.1785s
	iters: 200, epoch: 7 | loss: 0.0014037
	speed: 0.0657s/iter; left time: 2884.5175s
	iters: 300, epoch: 7 | loss: 0.0225886
	speed: 0.0679s/iter; left time: 2971.7641s
	iters: 400, epoch: 7 | loss: 0.0000594
	speed: 0.0644s/iter; left time: 2812.0533s
Epoch: 7 cost time: 32.37211608886719
Epoch: 7, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.413 Vali Acc: 0.933 Test Loss: 0.413 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0014262
	speed: 0.3485s/iter; left time: 15165.2609s
	iters: 200, epoch: 8 | loss: 0.0003743
	speed: 0.0916s/iter; left time: 3979.1169s
	iters: 300, epoch: 8 | loss: 0.0001357
	speed: 0.0819s/iter; left time: 3548.5845s
	iters: 400, epoch: 8 | loss: 0.0000005
	speed: 0.0841s/iter; left time: 3636.4509s
Epoch: 8 cost time: 38.87418580055237
Epoch: 8, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
Validation loss decreased (-0.967694 --> -0.976842).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000051
	speed: 0.4256s/iter; left time: 18319.7853s
	iters: 200, epoch: 9 | loss: 0.1575726
	speed: 0.0929s/iter; left time: 3991.9559s
	iters: 300, epoch: 9 | loss: 0.0294151
	speed: 0.0788s/iter; left time: 3376.2337s
	iters: 400, epoch: 9 | loss: 0.1948424
	speed: 0.0577s/iter; left time: 2466.9655s
Epoch: 9 cost time: 36.716521978378296
Epoch: 9, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0002079
	speed: 0.4009s/iter; left time: 17070.5004s
	iters: 200, epoch: 10 | loss: 0.0000000
	speed: 0.0863s/iter; left time: 3667.0809s
	iters: 300, epoch: 10 | loss: 0.0009275
	speed: 0.0944s/iter; left time: 3999.1252s
	iters: 400, epoch: 10 | loss: 0.0001179
	speed: 0.0950s/iter; left time: 4015.1777s
Epoch: 10 cost time: 41.95249795913696
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0046619
	speed: 0.3880s/iter; left time: 16339.2722s
	iters: 200, epoch: 11 | loss: 0.0001604
	speed: 0.0729s/iter; left time: 3062.6133s
	iters: 300, epoch: 11 | loss: 0.0006290
	speed: 0.0831s/iter; left time: 3482.8259s
	iters: 400, epoch: 11 | loss: 0.1268240
	speed: 0.0811s/iter; left time: 3389.7481s
Epoch: 11 cost time: 37.31377959251404
Epoch: 11, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.284 Vali Acc: 0.959 Test Loss: 0.284 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0782523
	speed: 0.4348s/iter; left time: 18105.4409s
	iters: 200, epoch: 12 | loss: 0.0000011
	speed: 0.0684s/iter; left time: 2841.3752s
	iters: 300, epoch: 12 | loss: 0.9293873
	speed: 0.0632s/iter; left time: 2620.4825s
	iters: 400, epoch: 12 | loss: 0.0000825
	speed: 0.0711s/iter; left time: 2939.4909s
Epoch: 12 cost time: 34.397332429885864
Epoch: 12, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.257 Vali Acc: 0.976 Test Loss: 0.257 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.1629387
	speed: 0.4055s/iter; left time: 16695.5756s
	iters: 200, epoch: 13 | loss: 0.0000051
	speed: 0.0745s/iter; left time: 3059.9251s
	iters: 300, epoch: 13 | loss: 0.0000045
	speed: 0.0709s/iter; left time: 2905.2862s
	iters: 400, epoch: 13 | loss: 0.0000053
	speed: 0.0677s/iter; left time: 2765.5857s
Epoch: 13 cost time: 34.042617082595825
Epoch: 13, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000201
	speed: 0.3872s/iter; left time: 15762.2815s
	iters: 200, epoch: 14 | loss: 0.0000076
	speed: 0.0702s/iter; left time: 2850.1903s
	iters: 300, epoch: 14 | loss: 0.0007394
	speed: 0.0661s/iter; left time: 2678.5781s
	iters: 400, epoch: 14 | loss: 0.0000003
	speed: 0.0722s/iter; left time: 2918.5345s
Epoch: 14 cost time: 32.79098844528198
Epoch: 14, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.386 Vali Acc: 0.965 Test Loss: 0.386 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000001
	speed: 0.4459s/iter; left time: 17939.0683s
	iters: 200, epoch: 15 | loss: 0.0086424
	speed: 0.0771s/iter; left time: 3093.3343s
	iters: 300, epoch: 15 | loss: 0.0264552
	speed: 0.0663s/iter; left time: 2653.2915s
	iters: 400, epoch: 15 | loss: 0.0000070
	speed: 0.0684s/iter; left time: 2730.7489s
Epoch: 15 cost time: 36.49174737930298
Epoch: 15, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.964 Test Loss: 0.260 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000037
	speed: 0.4623s/iter; left time: 18385.1965s
	iters: 200, epoch: 16 | loss: 0.0000052
	speed: 0.0839s/iter; left time: 3328.3030s
	iters: 300, epoch: 16 | loss: 0.2843895
	speed: 0.0787s/iter; left time: 3114.6563s
	iters: 400, epoch: 16 | loss: 0.0002670
	speed: 0.0828s/iter; left time: 3267.9975s
Epoch: 16 cost time: 39.038535356521606
Epoch: 16, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000038
	speed: 0.4267s/iter; left time: 16768.8454s
	iters: 200, epoch: 17 | loss: 0.0000011
	speed: 0.0905s/iter; left time: 3546.0486s
	iters: 300, epoch: 17 | loss: 0.0000485
	speed: 0.0809s/iter; left time: 3163.1890s
	iters: 400, epoch: 17 | loss: 0.0190448
	speed: 0.0841s/iter; left time: 3279.7841s
Epoch: 17 cost time: 41.270918130874634
Epoch: 17, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0015576
	speed: 0.4474s/iter; left time: 17370.9086s
	iters: 200, epoch: 18 | loss: 0.0000117
	speed: 0.0749s/iter; left time: 2902.4352s
	iters: 300, epoch: 18 | loss: 0.0000213
	speed: 0.0709s/iter; left time: 2739.7941s
	iters: 400, epoch: 18 | loss: 0.0000007
	speed: 0.0804s/iter; left time: 3097.0559s
Epoch: 18 cost time: 37.219491481781006
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9768439108061749
model parameter : 3204154
model size : 22.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2786000
	speed: 0.1044s/iter; left time: 4886.5043s
	iters: 200, epoch: 1 | loss: 0.1184632
	speed: 0.0726s/iter; left time: 3389.0494s
	iters: 300, epoch: 1 | loss: 0.4878404
	speed: 0.0843s/iter; left time: 3928.5889s
	iters: 400, epoch: 1 | loss: 0.0634896
	speed: 0.0940s/iter; left time: 4372.2098s
Epoch: 1 cost time: 42.268747329711914
Epoch: 1, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (inf --> -0.935389).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0185328
	speed: 0.4164s/iter; left time: 19292.1098s
	iters: 200, epoch: 2 | loss: 0.0414318
	speed: 0.0657s/iter; left time: 3038.6888s
	iters: 300, epoch: 2 | loss: 0.0534227
	speed: 0.0773s/iter; left time: 3567.8744s
	iters: 400, epoch: 2 | loss: 0.1595224
	speed: 0.0834s/iter; left time: 3840.8490s
Epoch: 2 cost time: 35.62288999557495
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0035143
	speed: 0.4585s/iter; left time: 21028.4493s
	iters: 200, epoch: 3 | loss: 0.0036366
	speed: 0.0821s/iter; left time: 3759.0106s
	iters: 300, epoch: 3 | loss: 0.3421892
	speed: 0.0808s/iter; left time: 3689.1428s
	iters: 400, epoch: 3 | loss: 0.0415973
	speed: 0.0808s/iter; left time: 3683.2363s
Epoch: 3 cost time: 38.6468186378479
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.935389 --> -0.964836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0009235
	speed: 0.3883s/iter; left time: 17626.2839s
	iters: 200, epoch: 4 | loss: 0.0154000
	speed: 0.0780s/iter; left time: 3531.2255s
	iters: 300, epoch: 4 | loss: 0.1305540
	speed: 0.0837s/iter; left time: 3784.5194s
	iters: 400, epoch: 4 | loss: 0.0032248
	speed: 0.0851s/iter; left time: 3837.0626s
Epoch: 4 cost time: 38.724326610565186
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0289195
	speed: 0.4628s/iter; left time: 20792.1914s
	iters: 200, epoch: 5 | loss: 0.0226357
	speed: 0.0759s/iter; left time: 3403.1981s
	iters: 300, epoch: 5 | loss: 0.0137214
	speed: 0.0796s/iter; left time: 3559.0352s
	iters: 400, epoch: 5 | loss: 0.1646172
	speed: 0.0802s/iter; left time: 3577.8971s
Epoch: 5 cost time: 38.28593063354492
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.5324476
	speed: 0.4246s/iter; left time: 18875.4995s
	iters: 200, epoch: 6 | loss: 0.0595278
	speed: 0.0761s/iter; left time: 3377.3244s
	iters: 300, epoch: 6 | loss: 0.0543828
	speed: 0.0782s/iter; left time: 3461.2833s
	iters: 400, epoch: 6 | loss: 0.1953644
	speed: 0.0813s/iter; left time: 3590.0463s
Epoch: 6 cost time: 37.48418164253235
Epoch: 6, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0083405
	speed: 0.4404s/iter; left time: 19373.2295s
	iters: 200, epoch: 7 | loss: 0.0009903
	speed: 0.0687s/iter; left time: 3015.0358s
	iters: 300, epoch: 7 | loss: 0.0857458
	speed: 0.0675s/iter; left time: 2956.2662s
	iters: 400, epoch: 7 | loss: 0.0000187
	speed: 0.0804s/iter; left time: 3514.2846s
Epoch: 7 cost time: 35.348490476608276
Epoch: 7, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.964836 --> -0.966551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0023051
	speed: 0.4578s/iter; left time: 19924.4718s
	iters: 200, epoch: 8 | loss: 0.0004365
	speed: 0.0770s/iter; left time: 3343.4369s
	iters: 300, epoch: 8 | loss: 0.0031117
	speed: 0.0672s/iter; left time: 2912.1258s
	iters: 400, epoch: 8 | loss: 0.0420452
	speed: 0.0636s/iter; left time: 2747.4083s
Epoch: 8 cost time: 34.15747594833374
Epoch: 8, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.966551 --> -0.970267).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4879773
	speed: 0.4421s/iter; left time: 19032.0720s
	iters: 200, epoch: 9 | loss: 0.0403358
	speed: 0.0838s/iter; left time: 3598.8826s
	iters: 300, epoch: 9 | loss: 0.0138417
	speed: 0.0858s/iter; left time: 3675.6430s
	iters: 400, epoch: 9 | loss: 0.1830253
	speed: 0.0751s/iter; left time: 3209.2709s
Epoch: 9 cost time: 38.29495120048523
Epoch: 9, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.970267 --> -0.975413).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0026668
	speed: 0.4112s/iter; left time: 17508.7508s
	iters: 200, epoch: 10 | loss: 0.0707570
	speed: 0.0849s/iter; left time: 3604.5393s
	iters: 300, epoch: 10 | loss: 0.0573793
	speed: 0.0877s/iter; left time: 3717.1404s
	iters: 400, epoch: 10 | loss: 0.0050019
	speed: 0.0769s/iter; left time: 3249.9043s
Epoch: 10 cost time: 38.92101716995239
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001749
	speed: 0.4096s/iter; left time: 17248.6659s
	iters: 200, epoch: 11 | loss: 0.0077899
	speed: 0.0918s/iter; left time: 3855.2949s
	iters: 300, epoch: 11 | loss: 0.0701009
	speed: 0.0844s/iter; left time: 3536.2148s
	iters: 400, epoch: 11 | loss: 0.0000744
	speed: 0.0804s/iter; left time: 3362.2393s
Epoch: 11 cost time: 40.78474164009094
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.1052286
	speed: 0.4096s/iter; left time: 17056.2354s
	iters: 200, epoch: 12 | loss: 0.1417797
	speed: 0.0924s/iter; left time: 3838.9746s
	iters: 300, epoch: 12 | loss: 0.0235567
	speed: 0.0954s/iter; left time: 3953.7620s
	iters: 400, epoch: 12 | loss: 0.0001103
	speed: 0.0906s/iter; left time: 3744.7481s
Epoch: 12 cost time: 42.809988021850586
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1037550
	speed: 0.4245s/iter; left time: 17476.2178s
	iters: 200, epoch: 13 | loss: 0.0073147
	speed: 0.0671s/iter; left time: 2755.9965s
	iters: 300, epoch: 13 | loss: 0.0050680
	speed: 0.0619s/iter; left time: 2535.6358s
	iters: 400, epoch: 13 | loss: 0.0036701
	speed: 0.0654s/iter; left time: 2675.0496s
Epoch: 13 cost time: 31.8426456451416
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0061765
	speed: 0.4006s/iter; left time: 16305.4763s
	iters: 200, epoch: 14 | loss: 0.1793137
	speed: 0.0830s/iter; left time: 3370.8297s
	iters: 300, epoch: 14 | loss: 0.0004312
	speed: 0.0726s/iter; left time: 2941.0561s
	iters: 400, epoch: 14 | loss: 0.0067515
	speed: 0.0816s/iter; left time: 3296.1424s
Epoch: 14 cost time: 37.50831151008606
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0001819
	speed: 0.4037s/iter; left time: 16240.9259s
	iters: 200, epoch: 15 | loss: 0.0079350
	speed: 0.0885s/iter; left time: 3552.2705s
	iters: 300, epoch: 15 | loss: 0.0006766
	speed: 0.0746s/iter; left time: 2988.4818s
	iters: 400, epoch: 15 | loss: 0.1274408
	speed: 0.0786s/iter; left time: 3139.2979s
Epoch: 15 cost time: 38.67949843406677
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1684101
	speed: 0.4077s/iter; left time: 16211.7951s
	iters: 200, epoch: 16 | loss: 0.0001959
	speed: 0.0700s/iter; left time: 2775.5750s
	iters: 300, epoch: 16 | loss: 0.0359313
	speed: 0.0633s/iter; left time: 2503.8338s
	iters: 400, epoch: 16 | loss: 0.0653729
	speed: 0.0710s/iter; left time: 2800.6374s
Epoch: 16 cost time: 33.83070969581604
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.1034644
	speed: 0.4217s/iter; left time: 16569.5950s
	iters: 200, epoch: 17 | loss: 0.0201319
	speed: 0.0915s/iter; left time: 3585.5000s
	iters: 300, epoch: 17 | loss: 0.0000093
	speed: 0.0900s/iter; left time: 3519.3338s
	iters: 400, epoch: 17 | loss: 0.0004271
	speed: 0.0786s/iter; left time: 3063.3804s
Epoch: 17 cost time: 40.834869623184204
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0091691
	speed: 0.4145s/iter; left time: 16095.3295s
	iters: 200, epoch: 18 | loss: 0.1852436
	speed: 0.0859s/iter; left time: 3328.0099s
	iters: 300, epoch: 18 | loss: 0.4244954
	speed: 0.0897s/iter; left time: 3464.7005s
	iters: 400, epoch: 18 | loss: 0.0003472
	speed: 0.0861s/iter; left time: 3316.9246s
Epoch: 18 cost time: 40.28937101364136
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0045165
	speed: 0.4584s/iter; left time: 17585.5950s
	iters: 200, epoch: 19 | loss: 0.0010228
	speed: 0.0739s/iter; left time: 2828.1747s
	iters: 300, epoch: 19 | loss: 0.2212700
	speed: 0.0684s/iter; left time: 2608.8213s
	iters: 400, epoch: 19 | loss: 0.0037858
	speed: 0.0744s/iter; left time: 2830.6618s
Epoch: 19 cost time: 36.16736817359924
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 2155578
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2333569
	speed: 0.1053s/iter; left time: 4929.3445s
	iters: 200, epoch: 1 | loss: 0.1380985
	speed: 0.0800s/iter; left time: 3736.0725s
	iters: 300, epoch: 1 | loss: 0.3161602
	speed: 0.0762s/iter; left time: 3550.2443s
	iters: 400, epoch: 1 | loss: 0.0496309
	speed: 0.0687s/iter; left time: 3194.8617s
Epoch: 1 cost time: 38.24130320549011
Epoch: 1, Steps: 469 | Train Loss: 0.320 Vali Loss: 0.260 Vali Acc: 0.940 Test Loss: 0.260 Test Acc: 0.940
Validation loss decreased (inf --> -0.939963).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0025076
	speed: 0.4290s/iter; left time: 19878.5710s
	iters: 200, epoch: 2 | loss: 0.0188866
	speed: 0.0772s/iter; left time: 3569.1958s
	iters: 300, epoch: 2 | loss: 0.0385334
	speed: 0.0607s/iter; left time: 2802.1085s
	iters: 400, epoch: 2 | loss: 0.0841606
	speed: 0.0613s/iter; left time: 2820.0393s
Epoch: 2 cost time: 32.98721122741699
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.262 Vali Acc: 0.939 Test Loss: 0.262 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0005551
	speed: 0.3689s/iter; left time: 16921.0224s
	iters: 200, epoch: 3 | loss: 0.0071235
	speed: 0.0794s/iter; left time: 3632.9125s
	iters: 300, epoch: 3 | loss: 0.3114239
	speed: 0.0796s/iter; left time: 3636.1565s
	iters: 400, epoch: 3 | loss: 0.0067814
	speed: 0.0753s/iter; left time: 3429.6780s
Epoch: 3 cost time: 36.45858979225159
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
Validation loss decreased (-0.939963 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0004116
	speed: 0.4173s/iter; left time: 18942.4655s
	iters: 200, epoch: 4 | loss: 0.0684650
	speed: 0.0879s/iter; left time: 3981.4969s
	iters: 300, epoch: 4 | loss: 0.2681522
	speed: 0.0853s/iter; left time: 3856.2395s
	iters: 400, epoch: 4 | loss: 0.0327727
	speed: 0.0816s/iter; left time: 3678.0828s
Epoch: 4 cost time: 40.2404248714447
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.305 Vali Acc: 0.946 Test Loss: 0.305 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1311396
	speed: 0.4284s/iter; left time: 19244.0052s
	iters: 200, epoch: 5 | loss: 0.1793260
	speed: 0.0758s/iter; left time: 3398.8201s
	iters: 300, epoch: 5 | loss: 0.0274177
	speed: 0.0793s/iter; left time: 3545.5460s
	iters: 400, epoch: 5 | loss: 0.0118659
	speed: 0.0799s/iter; left time: 3565.3181s
Epoch: 5 cost time: 37.86229610443115
Epoch: 5, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.961119 --> -0.967408).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5055458
	speed: 0.4293s/iter; left time: 19085.6022s
	iters: 200, epoch: 6 | loss: 0.0206701
	speed: 0.0867s/iter; left time: 3847.7951s
	iters: 300, epoch: 6 | loss: 0.1272113
	speed: 0.0867s/iter; left time: 3837.1675s
	iters: 400, epoch: 6 | loss: 0.0028498
	speed: 0.0760s/iter; left time: 3354.2854s
Epoch: 6 cost time: 38.902891397476196
Epoch: 6, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0083384
	speed: 0.4022s/iter; left time: 17693.0036s
	iters: 200, epoch: 7 | loss: 0.0010601
	speed: 0.0838s/iter; left time: 3676.0632s
	iters: 300, epoch: 7 | loss: 0.0003015
	speed: 0.0852s/iter; left time: 3731.3647s
	iters: 400, epoch: 7 | loss: 0.0061861
	speed: 0.0869s/iter; left time: 3796.1941s
Epoch: 7 cost time: 38.667314767837524
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0026832
	speed: 0.3908s/iter; left time: 17006.5421s
	iters: 200, epoch: 8 | loss: 0.1312439
	speed: 0.0826s/iter; left time: 3586.7235s
	iters: 300, epoch: 8 | loss: 0.0110212
	speed: 0.0825s/iter; left time: 3575.8666s
	iters: 400, epoch: 8 | loss: 0.3055369
	speed: 0.0842s/iter; left time: 3637.8782s
Epoch: 8 cost time: 38.75214385986328
Epoch: 8, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0517384
	speed: 0.3765s/iter; left time: 16206.9306s
	iters: 200, epoch: 9 | loss: 0.0063574
	speed: 0.0624s/iter; left time: 2681.1575s
	iters: 300, epoch: 9 | loss: 0.0000277
	speed: 0.0708s/iter; left time: 3033.2940s
	iters: 400, epoch: 9 | loss: 0.0163009
	speed: 0.0757s/iter; left time: 3238.2187s
Epoch: 9 cost time: 33.29893779754639
Epoch: 9, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.284 Vali Acc: 0.954 Test Loss: 0.284 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0019762
	speed: 0.3941s/iter; left time: 16780.4339s
	iters: 200, epoch: 10 | loss: 0.9481267
	speed: 0.0627s/iter; left time: 2664.3200s
	iters: 300, epoch: 10 | loss: 0.0272175
	speed: 0.0705s/iter; left time: 2988.2978s
	iters: 400, epoch: 10 | loss: 0.0019969
	speed: 0.0841s/iter; left time: 3556.7336s
Epoch: 10 cost time: 34.72419452667236
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0096974
	speed: 0.4239s/iter; left time: 17849.5978s
	iters: 200, epoch: 11 | loss: 0.0011286
	speed: 0.0758s/iter; left time: 3183.6003s
	iters: 300, epoch: 11 | loss: 0.0000105
	speed: 0.0761s/iter; left time: 3190.0540s
	iters: 400, epoch: 11 | loss: 0.0631827
	speed: 0.0790s/iter; left time: 3304.1038s
Epoch: 11 cost time: 36.52860736846924
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.312 Vali Acc: 0.961 Test Loss: 0.312 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0047969
	speed: 0.4051s/iter; left time: 16869.4999s
	iters: 200, epoch: 12 | loss: 0.0017024
	speed: 0.0800s/iter; left time: 3321.7619s
	iters: 300, epoch: 12 | loss: 0.0401196
	speed: 0.0810s/iter; left time: 3357.9252s
	iters: 400, epoch: 12 | loss: 0.5275193
	speed: 0.0844s/iter; left time: 3490.5422s
Epoch: 12 cost time: 37.95096755027771
Epoch: 12, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.230 Vali Acc: 0.955 Test Loss: 0.230 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.1602909
	speed: 0.4049s/iter; left time: 16671.7373s
	iters: 200, epoch: 13 | loss: 0.0010740
	speed: 0.0743s/iter; left time: 3052.0822s
	iters: 300, epoch: 13 | loss: 0.1439976
	speed: 0.0746s/iter; left time: 3058.0119s
	iters: 400, epoch: 13 | loss: 0.0056539
	speed: 0.0775s/iter; left time: 3166.0264s
Epoch: 13 cost time: 36.421836853027344
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000122
	speed: 0.4169s/iter; left time: 16969.0172s
	iters: 200, epoch: 14 | loss: 0.0279446
	speed: 0.0641s/iter; left time: 2603.2220s
	iters: 300, epoch: 14 | loss: 0.0000744
	speed: 0.0601s/iter; left time: 2432.8608s
	iters: 400, epoch: 14 | loss: 0.0117810
	speed: 0.0599s/iter; left time: 2422.0921s
Epoch: 14 cost time: 30.152746438980103
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.967408 --> -0.970267).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0059467
	speed: 0.3625s/iter; left time: 14586.1332s
	iters: 200, epoch: 15 | loss: 0.0083128
	speed: 0.0661s/iter; left time: 2653.8317s
	iters: 300, epoch: 15 | loss: 0.0004014
	speed: 0.0747s/iter; left time: 2990.3024s
	iters: 400, epoch: 15 | loss: 0.4961076
	speed: 0.0730s/iter; left time: 2915.2555s
Epoch: 15 cost time: 32.8188214302063
Epoch: 15, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.958 Test Loss: 0.236 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0005842
	speed: 0.3896s/iter; left time: 15491.8423s
	iters: 200, epoch: 16 | loss: 0.2590478
	speed: 0.0773s/iter; left time: 3066.1371s
	iters: 300, epoch: 16 | loss: 0.0462108
	speed: 0.0769s/iter; left time: 3042.2673s
	iters: 400, epoch: 16 | loss: 0.1623731
	speed: 0.0793s/iter; left time: 3128.5429s
Epoch: 16 cost time: 36.13983511924744
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.320 Vali Acc: 0.956 Test Loss: 0.320 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0011211
	speed: 0.3750s/iter; left time: 14736.7992s
	iters: 200, epoch: 17 | loss: 0.0580684
	speed: 0.0852s/iter; left time: 3341.4232s
	iters: 300, epoch: 17 | loss: 0.0000024
	speed: 0.0841s/iter; left time: 3288.3893s
	iters: 400, epoch: 17 | loss: 0.0000619
	speed: 0.0886s/iter; left time: 3456.2916s
Epoch: 17 cost time: 38.676783084869385
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.440 Vali Acc: 0.946 Test Loss: 0.440 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0003841
	speed: 0.3757s/iter; left time: 14587.6510s
	iters: 200, epoch: 18 | loss: 0.0159821
	speed: 0.0861s/iter; left time: 3336.1274s
	iters: 300, epoch: 18 | loss: 0.0175213
	speed: 0.0884s/iter; left time: 3416.1694s
	iters: 400, epoch: 18 | loss: 0.0088466
	speed: 0.0799s/iter; left time: 3079.8988s
Epoch: 18 cost time: 38.136831283569336
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0058751
	speed: 0.3901s/iter; left time: 14962.7699s
	iters: 200, epoch: 19 | loss: 0.0003731
	speed: 0.0764s/iter; left time: 2923.4219s
	iters: 300, epoch: 19 | loss: 0.0002852
	speed: 0.0774s/iter; left time: 2952.1861s
	iters: 400, epoch: 19 | loss: 0.0003920
	speed: 0.0834s/iter; left time: 3172.8667s
Epoch: 19 cost time: 36.56002640724182
Epoch: 19, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0000376
	speed: 0.3972s/iter; left time: 15050.1309s
	iters: 200, epoch: 20 | loss: 0.0001544
	speed: 0.0647s/iter; left time: 2443.7318s
	iters: 300, epoch: 20 | loss: 0.0001334
	speed: 0.0669s/iter; left time: 2520.8663s
	iters: 400, epoch: 20 | loss: 0.0066026
	speed: 0.0722s/iter; left time: 2715.4814s
Epoch: 20 cost time: 33.127259969711304
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
Validation loss decreased (-0.970267 --> -0.972840).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000293
	speed: 0.3957s/iter; left time: 14806.7064s
	iters: 200, epoch: 21 | loss: 0.0000717
	speed: 0.0661s/iter; left time: 2467.1620s
	iters: 300, epoch: 21 | loss: 0.0207842
	speed: 0.0700s/iter; left time: 2605.0216s
	iters: 400, epoch: 21 | loss: 0.0002322
	speed: 0.0781s/iter; left time: 2899.7914s
Epoch: 21 cost time: 34.70637321472168
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.266 Vali Acc: 0.964 Test Loss: 0.266 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0000025
	speed: 0.3973s/iter; left time: 14682.7218s
	iters: 200, epoch: 22 | loss: 0.0000070
	speed: 0.0742s/iter; left time: 2732.6558s
	iters: 300, epoch: 22 | loss: 0.0000970
	speed: 0.0683s/iter; left time: 2509.9700s
	iters: 400, epoch: 22 | loss: 0.0197794
	speed: 0.0775s/iter; left time: 2840.2541s
Epoch: 22 cost time: 34.60378551483154
Epoch: 22, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.258 Vali Acc: 0.960 Test Loss: 0.258 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000998
	speed: 0.3589s/iter; left time: 13092.2683s
	iters: 200, epoch: 23 | loss: 0.0009454
	speed: 0.0692s/iter; left time: 2518.8926s
	iters: 300, epoch: 23 | loss: 0.0000245
	speed: 0.0712s/iter; left time: 2583.6267s
	iters: 400, epoch: 23 | loss: 0.0096468
	speed: 0.0774s/iter; left time: 2799.1545s
Epoch: 23 cost time: 35.34247183799744
Epoch: 23, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.961 Test Loss: 0.319 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.1109873
	speed: 0.4233s/iter; left time: 15243.4287s
	iters: 200, epoch: 24 | loss: 0.0011346
	speed: 0.0696s/iter; left time: 2498.8970s
	iters: 300, epoch: 24 | loss: 0.0000205
	speed: 0.0667s/iter; left time: 2389.6771s
	iters: 400, epoch: 24 | loss: 0.0100312
	speed: 0.0746s/iter; left time: 2663.7880s
Epoch: 24 cost time: 34.81710958480835
Epoch: 24, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0000003
	speed: 0.4152s/iter; left time: 14758.7903s
	iters: 200, epoch: 25 | loss: 0.0036210
	speed: 0.0746s/iter; left time: 2645.6250s
	iters: 300, epoch: 25 | loss: 0.0014127
	speed: 0.0675s/iter; left time: 2385.0735s
	iters: 400, epoch: 25 | loss: 0.0001869
	speed: 0.0811s/iter; left time: 2857.2510s
Epoch: 25 cost time: 35.78277564048767
Epoch: 25, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.216 Vali Acc: 0.966 Test Loss: 0.216 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0000088
	speed: 0.4096s/iter; left time: 14365.4362s
	iters: 200, epoch: 26 | loss: 0.0009911
	speed: 0.0709s/iter; left time: 2480.5234s
	iters: 300, epoch: 26 | loss: 0.0005199
	speed: 0.0717s/iter; left time: 2499.4712s
	iters: 400, epoch: 26 | loss: 0.0000323
	speed: 0.0647s/iter; left time: 2249.8109s
Epoch: 26 cost time: 33.49216151237488
Epoch: 26, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.319 Vali Acc: 0.961 Test Loss: 0.319 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.4719627
	speed: 0.4014s/iter; left time: 13891.6448s
	iters: 200, epoch: 27 | loss: 0.0041202
	speed: 0.0700s/iter; left time: 2415.3381s
	iters: 300, epoch: 27 | loss: 0.3046702
	speed: 0.0724s/iter; left time: 2491.8290s
	iters: 400, epoch: 27 | loss: 1.4007490
	speed: 0.0649s/iter; left time: 2227.9418s
Epoch: 27 cost time: 33.12030029296875
Epoch: 27, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.218 Vali Acc: 0.974 Test Loss: 0.218 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973697).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0035517
	speed: 0.3919s/iter; left time: 13378.3761s
	iters: 200, epoch: 28 | loss: 0.0006970
	speed: 0.0663s/iter; left time: 2258.1906s
	iters: 300, epoch: 28 | loss: 0.2340610
	speed: 0.0663s/iter; left time: 2248.8590s
	iters: 400, epoch: 28 | loss: 0.3169734
	speed: 0.0678s/iter; left time: 2293.3027s
Epoch: 28 cost time: 32.156869888305664
Epoch: 28, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.973697 --> -0.974555).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0003280
	speed: 0.3804s/iter; left time: 12808.7228s
	iters: 200, epoch: 29 | loss: 0.0000047
	speed: 0.0689s/iter; left time: 2313.0247s
	iters: 300, epoch: 29 | loss: 0.0015444
	speed: 0.0686s/iter; left time: 2294.6126s
	iters: 400, epoch: 29 | loss: 0.0016133
	speed: 0.0753s/iter; left time: 2511.3192s
Epoch: 29 cost time: 33.38154482841492
Epoch: 29, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0036868
	speed: 0.3973s/iter; left time: 13190.9247s
	iters: 200, epoch: 30 | loss: 0.0084421
	speed: 0.0661s/iter; left time: 2186.3118s
	iters: 300, epoch: 30 | loss: 0.3335137
	speed: 0.0635s/iter; left time: 2095.5921s
	iters: 400, epoch: 30 | loss: 0.0049481
	speed: 0.0694s/iter; left time: 2281.6899s
Epoch: 30 cost time: 31.758731603622437
Epoch: 30, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0005891
	speed: 0.4048s/iter; left time: 13248.3352s
	iters: 200, epoch: 31 | loss: 0.3861267
	speed: 0.0699s/iter; left time: 2280.6404s
	iters: 300, epoch: 31 | loss: 0.0031845
	speed: 0.0609s/iter; left time: 1982.0292s
	iters: 400, epoch: 31 | loss: 0.0000579
	speed: 0.0647s/iter; left time: 2099.0607s
Epoch: 31 cost time: 32.431604862213135
Epoch: 31, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.221 Vali Acc: 0.971 Test Loss: 0.221 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0057702
	speed: 0.4174s/iter; left time: 13466.8740s
	iters: 200, epoch: 32 | loss: 0.0094111
	speed: 0.0775s/iter; left time: 2492.0400s
	iters: 300, epoch: 32 | loss: 0.0000000
	speed: 0.0750s/iter; left time: 2403.8071s
	iters: 400, epoch: 32 | loss: 0.0000112
	speed: 0.0690s/iter; left time: 2204.7766s
Epoch: 32 cost time: 34.99481725692749
Epoch: 32, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.422 Vali Acc: 0.959 Test Loss: 0.422 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0108335
	speed: 0.3908s/iter; left time: 12425.9188s
	iters: 200, epoch: 33 | loss: 0.0003834
	speed: 0.0746s/iter; left time: 2364.5451s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0700s/iter; left time: 2212.6246s
	iters: 400, epoch: 33 | loss: 0.0001396
	speed: 0.0692s/iter; left time: 2180.3897s
Epoch: 33 cost time: 34.28762936592102
Epoch: 33, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0000921
	speed: 0.3932s/iter; left time: 12317.8144s
	iters: 200, epoch: 34 | loss: 0.0003735
	speed: 0.0754s/iter; left time: 2355.4867s
	iters: 300, epoch: 34 | loss: 0.0001166
	speed: 0.0762s/iter; left time: 2371.7182s
	iters: 400, epoch: 34 | loss: 0.2630811
	speed: 0.0742s/iter; left time: 2301.4943s
Epoch: 34 cost time: 35.99579977989197
Epoch: 34, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.394 Vali Acc: 0.964 Test Loss: 0.394 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.1481586
	speed: 0.4117s/iter; left time: 12703.3461s
	iters: 200, epoch: 35 | loss: 0.0007980
	speed: 0.0728s/iter; left time: 2239.5642s
	iters: 300, epoch: 35 | loss: 0.0039229
	speed: 0.0715s/iter; left time: 2192.6682s
	iters: 400, epoch: 35 | loss: 0.2959011
	speed: 0.0626s/iter; left time: 1912.5239s
Epoch: 35 cost time: 33.84146761894226
Epoch: 35, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.373 Vali Acc: 0.964 Test Loss: 0.373 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0000038
	speed: 0.3742s/iter; left time: 11369.3679s
	iters: 200, epoch: 36 | loss: 0.0220813
	speed: 0.0802s/iter; left time: 2428.7077s
	iters: 300, epoch: 36 | loss: 0.0057121
	speed: 0.0654s/iter; left time: 1973.9449s
	iters: 400, epoch: 36 | loss: 0.0014347
	speed: 0.0736s/iter; left time: 2215.0787s
Epoch: 36 cost time: 35.779855251312256
Epoch: 36, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.273 Vali Acc: 0.962 Test Loss: 0.273 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0000004
	speed: 0.3868s/iter; left time: 11571.2097s
	iters: 200, epoch: 37 | loss: 0.0012685
	speed: 0.0780s/iter; left time: 2325.8323s
	iters: 300, epoch: 37 | loss: 0.0001637
	speed: 0.0752s/iter; left time: 2235.6725s
	iters: 400, epoch: 37 | loss: 0.0000051
	speed: 0.0733s/iter; left time: 2171.5908s
Epoch: 37 cost time: 35.8722927570343
Epoch: 37, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.353 Vali Acc: 0.970 Test Loss: 0.353 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000019
	speed: 0.4005s/iter; left time: 11793.2946s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0746s/iter; left time: 2189.8143s
	iters: 300, epoch: 38 | loss: 0.0002128
	speed: 0.0713s/iter; left time: 2085.7269s
	iters: 400, epoch: 38 | loss: 0.0005763
	speed: 0.0733s/iter; left time: 2136.3571s
Epoch: 38 cost time: 35.5864782333374
Epoch: 38, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.320 Vali Acc: 0.968 Test Loss: 0.320 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 2155578
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2240209
	speed: 0.0880s/iter; left time: 4116.5684s
	iters: 200, epoch: 1 | loss: 0.1640510
	speed: 0.0625s/iter; left time: 2919.9850s
	iters: 300, epoch: 1 | loss: 0.0793538
	speed: 0.0629s/iter; left time: 2931.4351s
	iters: 400, epoch: 1 | loss: 0.0112325
	speed: 0.0645s/iter; left time: 2999.4438s
Epoch: 1 cost time: 32.492286682128906
Epoch: 1, Steps: 469 | Train Loss: 0.303 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (inf --> -0.936532).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0013406
	speed: 0.3422s/iter; left time: 15854.5647s
	iters: 200, epoch: 2 | loss: 0.0166106
	speed: 0.0634s/iter; left time: 2930.5483s
	iters: 300, epoch: 2 | loss: 0.4683003
	speed: 0.0746s/iter; left time: 3439.9106s
	iters: 400, epoch: 2 | loss: 0.2733599
	speed: 0.0733s/iter; left time: 3374.3164s
Epoch: 2 cost time: 33.34924840927124
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
Validation loss decreased (-0.936532 --> -0.951113).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0022131
	speed: 0.3864s/iter; left time: 17720.2356s
	iters: 200, epoch: 3 | loss: 0.0323485
	speed: 0.0725s/iter; left time: 3319.2447s
	iters: 300, epoch: 3 | loss: 0.5624229
	speed: 0.0728s/iter; left time: 3322.2083s
	iters: 400, epoch: 3 | loss: 0.0579827
	speed: 0.0729s/iter; left time: 3321.3095s
Epoch: 3 cost time: 34.95365810394287
Epoch: 3, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
Validation loss decreased (-0.951113 --> -0.971696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0114755
	speed: 0.3601s/iter; left time: 16347.7103s
	iters: 200, epoch: 4 | loss: 0.2588640
	speed: 0.0631s/iter; left time: 2857.3399s
	iters: 300, epoch: 4 | loss: 0.0471503
	speed: 0.0704s/iter; left time: 3181.5610s
	iters: 400, epoch: 4 | loss: 0.0005319
	speed: 0.0720s/iter; left time: 3248.0706s
Epoch: 4 cost time: 32.92548990249634
Epoch: 4, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.287 Vali Acc: 0.949 Test Loss: 0.287 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001449
	speed: 0.3716s/iter; left time: 16695.3180s
	iters: 200, epoch: 5 | loss: 0.0013705
	speed: 0.0652s/iter; left time: 2922.8939s
	iters: 300, epoch: 5 | loss: 0.0454525
	speed: 0.0663s/iter; left time: 2966.8295s
	iters: 400, epoch: 5 | loss: 0.0496054
	speed: 0.0671s/iter; left time: 2992.6557s
Epoch: 5 cost time: 31.644588232040405
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.251 Vali Acc: 0.956 Test Loss: 0.251 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.7980562
	speed: 0.3955s/iter; left time: 17582.1045s
	iters: 200, epoch: 6 | loss: 0.0028637
	speed: 0.0670s/iter; left time: 2973.4906s
	iters: 300, epoch: 6 | loss: 0.2304226
	speed: 0.0692s/iter; left time: 3061.6236s
	iters: 400, epoch: 6 | loss: 0.6104264
	speed: 0.0676s/iter; left time: 2986.6218s
Epoch: 6 cost time: 32.293023109436035
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.250 Vali Acc: 0.970 Test Loss: 0.250 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000015
	speed: 0.4046s/iter; left time: 17796.6154s
	iters: 200, epoch: 7 | loss: 0.0010074
	speed: 0.0728s/iter; left time: 3196.4103s
	iters: 300, epoch: 7 | loss: 0.0005308
	speed: 0.0679s/iter; left time: 2972.9156s
	iters: 400, epoch: 7 | loss: 0.0004744
	speed: 0.0631s/iter; left time: 2755.5248s
Epoch: 7 cost time: 33.01990222930908
Epoch: 7, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.7251569
	speed: 0.3504s/iter; left time: 15246.6684s
	iters: 200, epoch: 8 | loss: 0.0000502
	speed: 0.0788s/iter; left time: 3422.6407s
	iters: 300, epoch: 8 | loss: 0.2547838
	speed: 0.0702s/iter; left time: 3040.0783s
	iters: 400, epoch: 8 | loss: 0.0002250
	speed: 0.0585s/iter; left time: 2528.4160s
Epoch: 8 cost time: 33.23451113700867
Epoch: 8, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.242 Vali Acc: 0.962 Test Loss: 0.242 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0200315
	speed: 0.3290s/iter; left time: 14162.9768s
	iters: 200, epoch: 9 | loss: 1.7071445
	speed: 0.0703s/iter; left time: 3017.2841s
	iters: 300, epoch: 9 | loss: 0.0000256
	speed: 0.0755s/iter; left time: 3236.7060s
	iters: 400, epoch: 9 | loss: 0.4124576
	speed: 0.0739s/iter; left time: 3159.0419s
Epoch: 9 cost time: 33.80763244628906
Epoch: 9, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.236 Vali Acc: 0.964 Test Loss: 0.236 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0005965
	speed: 0.3621s/iter; left time: 15418.3515s
	iters: 200, epoch: 10 | loss: 0.1892955
	speed: 0.0639s/iter; left time: 2716.4564s
	iters: 300, epoch: 10 | loss: 0.0000096
	speed: 0.0621s/iter; left time: 2633.6401s
	iters: 400, epoch: 10 | loss: 0.0000001
	speed: 0.0651s/iter; left time: 2751.3123s
Epoch: 10 cost time: 30.784594774246216
Epoch: 10, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.346 Vali Acc: 0.957 Test Loss: 0.346 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000256
	speed: 0.3630s/iter; left time: 15287.2439s
	iters: 200, epoch: 11 | loss: 0.0000604
	speed: 0.0656s/iter; left time: 2755.6494s
	iters: 300, epoch: 11 | loss: 0.0019587
	speed: 0.0642s/iter; left time: 2688.7923s
	iters: 400, epoch: 11 | loss: 0.0002255
	speed: 0.0642s/iter; left time: 2682.4901s
Epoch: 11 cost time: 31.08069133758545
Epoch: 11, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.283 Vali Acc: 0.969 Test Loss: 0.283 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000106
	speed: 0.3621s/iter; left time: 15077.6582s
	iters: 200, epoch: 12 | loss: 0.0000776
	speed: 0.0771s/iter; left time: 3203.2227s
	iters: 300, epoch: 12 | loss: 0.0111145
	speed: 0.0783s/iter; left time: 3243.7587s
	iters: 400, epoch: 12 | loss: 0.0437472
	speed: 0.0725s/iter; left time: 2999.3060s
Epoch: 12 cost time: 35.99648833274841
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.329 Vali Acc: 0.964 Test Loss: 0.329 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0131698
	speed: 0.4117s/iter; left time: 16952.5559s
	iters: 200, epoch: 13 | loss: 0.0050579
	speed: 0.0750s/iter; left time: 3080.8723s
	iters: 300, epoch: 13 | loss: 0.0000219
	speed: 0.0758s/iter; left time: 3105.2380s
	iters: 400, epoch: 13 | loss: 0.0000139
	speed: 0.0779s/iter; left time: 3183.1327s
Epoch: 13 cost time: 36.61003565788269
Epoch: 13, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9716981132075472
model parameter : 2155578
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1824073
	speed: 0.0946s/iter; left time: 4428.5747s
	iters: 200, epoch: 1 | loss: 0.1725718
	speed: 0.0673s/iter; left time: 3144.3081s
	iters: 300, epoch: 1 | loss: 0.0946471
	speed: 0.0771s/iter; left time: 3592.7601s
	iters: 400, epoch: 1 | loss: 0.0165022
	speed: 0.0716s/iter; left time: 3328.1793s
Epoch: 1 cost time: 36.12338089942932
Epoch: 1, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
Validation loss decreased (inf --> -0.953114).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1153178
	speed: 0.3696s/iter; left time: 17123.5192s
	iters: 200, epoch: 2 | loss: 0.0133751
	speed: 0.0669s/iter; left time: 3090.7537s
	iters: 300, epoch: 2 | loss: 0.8012237
	speed: 0.0684s/iter; left time: 3155.0061s
	iters: 400, epoch: 2 | loss: 0.1327306
	speed: 0.0724s/iter; left time: 3333.6392s
Epoch: 2 cost time: 33.61753511428833
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.953114 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4826449
	speed: 0.3801s/iter; left time: 17431.2806s
	iters: 200, epoch: 3 | loss: 0.0095113
	speed: 0.0687s/iter; left time: 3145.1813s
	iters: 300, epoch: 3 | loss: 0.0006946
	speed: 0.0719s/iter; left time: 3284.6303s
	iters: 400, epoch: 3 | loss: 0.0218822
	speed: 0.0729s/iter; left time: 3322.2175s
Epoch: 3 cost time: 32.92910575866699
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.959118 --> -0.962549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0446123
	speed: 0.4132s/iter; left time: 18756.0393s
	iters: 200, epoch: 4 | loss: 0.0076094
	speed: 0.0652s/iter; left time: 2951.1743s
	iters: 300, epoch: 4 | loss: 0.0091247
	speed: 0.0643s/iter; left time: 2906.5376s
	iters: 400, epoch: 4 | loss: 0.0050400
	speed: 0.0642s/iter; left time: 2896.9968s
Epoch: 4 cost time: 31.080629587173462
Epoch: 4, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0430979
	speed: 0.3873s/iter; left time: 17398.4144s
	iters: 200, epoch: 5 | loss: 0.0082464
	speed: 0.0709s/iter; left time: 3176.3241s
	iters: 300, epoch: 5 | loss: 0.0168575
	speed: 0.0714s/iter; left time: 3191.5921s
	iters: 400, epoch: 5 | loss: 0.1905763
	speed: 0.0697s/iter; left time: 3108.1390s
Epoch: 5 cost time: 34.39401602745056
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
Validation loss decreased (-0.962549 --> -0.969409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1554724
	speed: 0.4007s/iter; left time: 17813.2118s
	iters: 200, epoch: 6 | loss: 0.1961971
	speed: 0.0840s/iter; left time: 3724.5741s
	iters: 300, epoch: 6 | loss: 0.1651996
	speed: 0.0774s/iter; left time: 3427.4503s
	iters: 400, epoch: 6 | loss: 0.0000460
	speed: 0.0720s/iter; left time: 3181.3834s
Epoch: 6 cost time: 37.0412712097168
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0741733
	speed: 0.3849s/iter; left time: 16931.7321s
	iters: 200, epoch: 7 | loss: 0.0006217
	speed: 0.0769s/iter; left time: 3376.6648s
	iters: 300, epoch: 7 | loss: 0.0178717
	speed: 0.0761s/iter; left time: 3330.2657s
	iters: 400, epoch: 7 | loss: 0.3396598
	speed: 0.0721s/iter; left time: 3150.7601s
Epoch: 7 cost time: 35.140074253082275
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0093440
	speed: 0.3687s/iter; left time: 16045.2159s
	iters: 200, epoch: 8 | loss: 0.0367088
	speed: 0.0705s/iter; left time: 3059.4659s
	iters: 300, epoch: 8 | loss: 0.0314490
	speed: 0.0743s/iter; left time: 3217.4847s
	iters: 400, epoch: 8 | loss: 0.0165653
	speed: 0.0702s/iter; left time: 3034.9680s
Epoch: 8 cost time: 32.86916637420654
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0007784
	speed: 0.3327s/iter; left time: 14322.3880s
	iters: 200, epoch: 9 | loss: 0.4691980
	speed: 0.0718s/iter; left time: 3085.4077s
	iters: 300, epoch: 9 | loss: 0.0026604
	speed: 0.0697s/iter; left time: 2986.3422s
	iters: 400, epoch: 9 | loss: 0.0064916
	speed: 0.0688s/iter; left time: 2942.8958s
Epoch: 9 cost time: 33.77826809883118
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.332 Vali Acc: 0.959 Test Loss: 0.332 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0035822
	speed: 0.3679s/iter; left time: 15665.8452s
	iters: 200, epoch: 10 | loss: 0.0014112
	speed: 0.0727s/iter; left time: 3088.4374s
	iters: 300, epoch: 10 | loss: 0.0155320
	speed: 0.0746s/iter; left time: 3161.0977s
	iters: 400, epoch: 10 | loss: 0.0013604
	speed: 0.0709s/iter; left time: 2998.5545s
Epoch: 10 cost time: 34.00447201728821
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0108546
	speed: 0.3499s/iter; left time: 14735.9361s
	iters: 200, epoch: 11 | loss: 0.0000199
	speed: 0.0783s/iter; left time: 3289.4172s
	iters: 300, epoch: 11 | loss: 0.0225209
	speed: 0.0738s/iter; left time: 3092.1789s
	iters: 400, epoch: 11 | loss: 0.0003011
	speed: 0.0731s/iter; left time: 3055.8182s
Epoch: 11 cost time: 34.53598141670227
Epoch: 11, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0046464
	speed: 0.3712s/iter; left time: 15455.5472s
	iters: 200, epoch: 12 | loss: 0.1033802
	speed: 0.0719s/iter; left time: 2988.5362s
	iters: 300, epoch: 12 | loss: 0.2770366
	speed: 0.0772s/iter; left time: 3199.4031s
	iters: 400, epoch: 12 | loss: 0.5241784
	speed: 0.0794s/iter; left time: 3281.0840s
Epoch: 12 cost time: 36.81543946266174
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.257 Vali Acc: 0.938 Test Loss: 0.257 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0829053
	speed: 0.3807s/iter; left time: 15675.6365s
	iters: 200, epoch: 13 | loss: 0.3960529
	speed: 0.0733s/iter; left time: 3010.1183s
	iters: 300, epoch: 13 | loss: 0.4653576
	speed: 0.0797s/iter; left time: 3264.5320s
	iters: 400, epoch: 13 | loss: 0.0006863
	speed: 0.0770s/iter; left time: 3145.4879s
Epoch: 13 cost time: 36.31995129585266
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000575
	speed: 0.3838s/iter; left time: 15623.7288s
	iters: 200, epoch: 14 | loss: 0.4190155
	speed: 0.0631s/iter; left time: 2562.8343s
	iters: 300, epoch: 14 | loss: 0.0011029
	speed: 0.0610s/iter; left time: 2469.8914s
	iters: 400, epoch: 14 | loss: 0.2972164
	speed: 0.0701s/iter; left time: 2833.2124s
Epoch: 14 cost time: 31.44080090522766
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0471399
	speed: 0.4035s/iter; left time: 16235.8941s
	iters: 200, epoch: 15 | loss: 0.2066340
	speed: 0.0652s/iter; left time: 2615.7997s
	iters: 300, epoch: 15 | loss: 0.0147423
	speed: 0.0695s/iter; left time: 2784.1017s
	iters: 400, epoch: 15 | loss: 0.5643842
	speed: 0.0628s/iter; left time: 2507.3738s
Epoch: 15 cost time: 32.022143840789795
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9694110920526015
model parameter : 1631290
model size : 16.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1889213
	speed: 0.0930s/iter; left time: 4354.6039s
	iters: 200, epoch: 1 | loss: 0.1273653
	speed: 0.0713s/iter; left time: 3328.0595s
	iters: 300, epoch: 1 | loss: 0.1009084
	speed: 0.0738s/iter; left time: 3440.4421s
	iters: 400, epoch: 1 | loss: 0.0152579
	speed: 0.0636s/iter; left time: 2955.1963s
Epoch: 1 cost time: 34.70636439323425
Epoch: 1, Steps: 469 | Train Loss: 0.333 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (inf --> -0.954258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1206147
	speed: 0.3506s/iter; left time: 16246.1314s
	iters: 200, epoch: 2 | loss: 0.0060473
	speed: 0.0693s/iter; left time: 3205.2366s
	iters: 300, epoch: 2 | loss: 0.3520521
	speed: 0.0749s/iter; left time: 3457.4876s
	iters: 400, epoch: 2 | loss: 0.2256441
	speed: 0.0752s/iter; left time: 3460.4266s
Epoch: 2 cost time: 34.58842349052429
Epoch: 2, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.954 Test Loss: 0.226 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1082092
	speed: 0.3556s/iter; left time: 16306.7421s
	iters: 200, epoch: 3 | loss: 0.0036464
	speed: 0.0722s/iter; left time: 3303.2476s
	iters: 300, epoch: 3 | loss: 0.0226734
	speed: 0.0707s/iter; left time: 3228.9206s
	iters: 400, epoch: 3 | loss: 0.0011980
	speed: 0.0774s/iter; left time: 3526.5606s
Epoch: 3 cost time: 34.8670608997345
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.954258 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0030154
	speed: 0.3954s/iter; left time: 17949.2939s
	iters: 200, epoch: 4 | loss: 0.0035706
	speed: 0.0661s/iter; left time: 2995.6314s
	iters: 300, epoch: 4 | loss: 0.2392244
	speed: 0.0698s/iter; left time: 3156.5656s
	iters: 400, epoch: 4 | loss: 0.0024563
	speed: 0.0717s/iter; left time: 3233.7864s
Epoch: 4 cost time: 33.29812955856323
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.222 Vali Acc: 0.958 Test Loss: 0.222 Test Acc: 0.958
Validation loss decreased (-0.957117 --> -0.957974).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0850191
	speed: 0.4111s/iter; left time: 18467.9717s
	iters: 200, epoch: 5 | loss: 0.0162549
	speed: 0.0721s/iter; left time: 3234.0704s
	iters: 300, epoch: 5 | loss: 0.0286885
	speed: 0.0643s/iter; left time: 2876.3995s
	iters: 400, epoch: 5 | loss: 0.0123251
	speed: 0.0633s/iter; left time: 2823.3990s
Epoch: 5 cost time: 32.59773898124695
Epoch: 5, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0160454
	speed: 0.3816s/iter; left time: 16964.5045s
	iters: 200, epoch: 6 | loss: 0.1383866
	speed: 0.0675s/iter; left time: 2993.9716s
	iters: 300, epoch: 6 | loss: 0.0143793
	speed: 0.0671s/iter; left time: 2968.4598s
	iters: 400, epoch: 6 | loss: 0.0000186
	speed: 0.0695s/iter; left time: 3070.0010s
Epoch: 6 cost time: 32.2308509349823
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.957974 --> -0.958546).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0194663
	speed: 0.3924s/iter; left time: 17262.3548s
	iters: 200, epoch: 7 | loss: 0.0002005
	speed: 0.0742s/iter; left time: 3256.2468s
	iters: 300, epoch: 7 | loss: 0.2119217
	speed: 0.0645s/iter; left time: 2824.4760s
	iters: 400, epoch: 7 | loss: 0.0507608
	speed: 0.0687s/iter; left time: 3000.9568s
Epoch: 7 cost time: 33.10337805747986
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.958546 --> -0.963406).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1422686
	speed: 0.3867s/iter; left time: 16828.0357s
	iters: 200, epoch: 8 | loss: 0.0001360
	speed: 0.0678s/iter; left time: 2942.3653s
	iters: 300, epoch: 8 | loss: 0.0105951
	speed: 0.0637s/iter; left time: 2759.1494s
	iters: 400, epoch: 8 | loss: 0.0972178
	speed: 0.0664s/iter; left time: 2871.6509s
Epoch: 8 cost time: 32.85608458518982
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.963406 --> -0.971982).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0008448
	speed: 0.3980s/iter; left time: 17133.5725s
	iters: 200, epoch: 9 | loss: 0.0273628
	speed: 0.0664s/iter; left time: 2850.1684s
	iters: 300, epoch: 9 | loss: 0.0001587
	speed: 0.0678s/iter; left time: 2903.5979s
	iters: 400, epoch: 9 | loss: 0.0209788
	speed: 0.0588s/iter; left time: 2515.2966s
Epoch: 9 cost time: 31.304543495178223
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1146110
	speed: 0.3836s/iter; left time: 16332.0376s
	iters: 200, epoch: 10 | loss: 0.0003888
	speed: 0.0700s/iter; left time: 2972.9074s
	iters: 300, epoch: 10 | loss: 0.0001165
	speed: 0.0717s/iter; left time: 3038.4861s
	iters: 400, epoch: 10 | loss: 0.0032119
	speed: 0.0646s/iter; left time: 2732.9647s
Epoch: 10 cost time: 33.30279850959778
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001434
	speed: 0.3984s/iter; left time: 16776.2248s
	iters: 200, epoch: 11 | loss: 0.0002176
	speed: 0.0771s/iter; left time: 3237.9622s
	iters: 300, epoch: 11 | loss: 0.4307385
	speed: 0.0723s/iter; left time: 3029.8524s
	iters: 400, epoch: 11 | loss: 0.0096709
	speed: 0.0705s/iter; left time: 2947.2030s
Epoch: 11 cost time: 35.96521282196045
Epoch: 11, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0054640
	speed: 0.3897s/iter; left time: 16226.9507s
	iters: 200, epoch: 12 | loss: 0.4235643
	speed: 0.0818s/iter; left time: 3397.3109s
	iters: 300, epoch: 12 | loss: 0.0290930
	speed: 0.0838s/iter; left time: 3473.7846s
	iters: 400, epoch: 12 | loss: 0.0085586
	speed: 0.0553s/iter; left time: 2285.7788s
Epoch: 12 cost time: 35.37648010253906
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0004520
	speed: 0.3441s/iter; left time: 14167.6972s
	iters: 200, epoch: 13 | loss: 0.0023241
	speed: 0.0714s/iter; left time: 2934.0390s
	iters: 300, epoch: 13 | loss: 0.0000859
	speed: 0.0679s/iter; left time: 2781.2476s
	iters: 400, epoch: 13 | loss: 0.0027357
	speed: 0.0693s/iter; left time: 2832.6543s
Epoch: 13 cost time: 32.931076526641846
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.183 Vali Acc: 0.968 Test Loss: 0.183 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000039
	speed: 0.3484s/iter; left time: 14181.6322s
	iters: 200, epoch: 14 | loss: 0.0277114
	speed: 0.0710s/iter; left time: 2881.1141s
	iters: 300, epoch: 14 | loss: 0.0011319
	speed: 0.0726s/iter; left time: 2939.6704s
	iters: 400, epoch: 14 | loss: 0.1985541
	speed: 0.0741s/iter; left time: 2992.7001s
Epoch: 14 cost time: 34.06849479675293
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.234 Vali Acc: 0.968 Test Loss: 0.234 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.2090249
	speed: 0.3659s/iter; left time: 14721.5222s
	iters: 200, epoch: 15 | loss: 0.1976970
	speed: 0.0671s/iter; left time: 2691.5401s
	iters: 300, epoch: 15 | loss: 0.0012099
	speed: 0.0724s/iter; left time: 2896.9359s
	iters: 400, epoch: 15 | loss: 0.3163978
	speed: 0.0743s/iter; left time: 2965.7661s
Epoch: 15 cost time: 33.72479009628296
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.209 Vali Acc: 0.971 Test Loss: 0.209 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000746
	speed: 0.3506s/iter; left time: 13942.1187s
	iters: 200, epoch: 16 | loss: 0.0032873
	speed: 0.0719s/iter; left time: 2851.3854s
	iters: 300, epoch: 16 | loss: 0.0051122
	speed: 0.0730s/iter; left time: 2887.4881s
	iters: 400, epoch: 16 | loss: 0.0377667
	speed: 0.0770s/iter; left time: 3038.4434s
Epoch: 16 cost time: 34.538933992385864
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.218 Vali Acc: 0.964 Test Loss: 0.218 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0031502
	speed: 0.3899s/iter; left time: 15323.0960s
	iters: 200, epoch: 17 | loss: 0.0115259
	speed: 0.0708s/iter; left time: 2773.6598s
	iters: 300, epoch: 17 | loss: 0.3055827
	speed: 0.0742s/iter; left time: 2902.1718s
	iters: 400, epoch: 17 | loss: 0.0003833
	speed: 0.0723s/iter; left time: 2820.0806s
Epoch: 17 cost time: 34.70585775375366
Epoch: 17, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0002945
	speed: 0.3944s/iter; left time: 15312.5235s
	iters: 200, epoch: 18 | loss: 0.0000365
	speed: 0.0682s/iter; left time: 2641.8320s
	iters: 300, epoch: 18 | loss: 0.0000954
	speed: 0.0709s/iter; left time: 2736.9952s
	iters: 400, epoch: 18 | loss: 0.0006231
	speed: 0.0676s/iter; left time: 2603.9323s
Epoch: 18 cost time: 33.40822124481201
Epoch: 18, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.260 Vali Acc: 0.969 Test Loss: 0.260 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1631290
model size : 16.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1915689
	speed: 0.0857s/iter; left time: 4008.8122s
	iters: 200, epoch: 1 | loss: 0.1210655
	speed: 0.0642s/iter; left time: 2997.1128s
	iters: 300, epoch: 1 | loss: 0.1551495
	speed: 0.0639s/iter; left time: 2977.4103s
	iters: 400, epoch: 1 | loss: 0.0219219
	speed: 0.0497s/iter; left time: 2312.0130s
Epoch: 1 cost time: 30.009904861450195
Epoch: 1, Steps: 469 | Train Loss: 0.321 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (inf --> -0.964264).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0060827
	speed: 0.3301s/iter; left time: 15292.0507s
	iters: 200, epoch: 2 | loss: 0.1262675
	speed: 0.0731s/iter; left time: 3378.5954s
	iters: 300, epoch: 2 | loss: 0.7554834
	speed: 0.0604s/iter; left time: 2787.5571s
	iters: 400, epoch: 2 | loss: 0.0419056
	speed: 0.0641s/iter; left time: 2949.2980s
Epoch: 2 cost time: 31.832258462905884
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2468150
	speed: 0.3558s/iter; left time: 16319.6027s
	iters: 200, epoch: 3 | loss: 0.0012792
	speed: 0.0727s/iter; left time: 3326.9499s
	iters: 300, epoch: 3 | loss: 0.0028649
	speed: 0.0695s/iter; left time: 3174.5915s
	iters: 400, epoch: 3 | loss: 0.0028666
	speed: 0.0588s/iter; left time: 2681.2682s
Epoch: 3 cost time: 32.29095959663391
Epoch: 3, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0684108
	speed: 0.3422s/iter; left time: 15532.8301s
	iters: 200, epoch: 4 | loss: 0.0018305
	speed: 0.0689s/iter; left time: 3120.1922s
	iters: 300, epoch: 4 | loss: 0.0779771
	speed: 0.0663s/iter; left time: 2997.4836s
	iters: 400, epoch: 4 | loss: 0.0007141
	speed: 0.0667s/iter; left time: 3009.7176s
Epoch: 4 cost time: 31.798154830932617
Epoch: 4, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
Validation loss decreased (-0.964264 --> -0.970553).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0128462
	speed: 0.3409s/iter; left time: 15312.7198s
	iters: 200, epoch: 5 | loss: 0.0188811
	speed: 0.0655s/iter; left time: 2936.4438s
	iters: 300, epoch: 5 | loss: 0.0001330
	speed: 0.0715s/iter; left time: 3196.5910s
	iters: 400, epoch: 5 | loss: 0.0142439
	speed: 0.0750s/iter; left time: 3348.7027s
Epoch: 5 cost time: 33.66512417793274
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0011987
	speed: 0.3687s/iter; left time: 16389.1648s
	iters: 200, epoch: 6 | loss: 0.8719500
	speed: 0.0661s/iter; left time: 2929.7334s
	iters: 300, epoch: 6 | loss: 0.4219440
	speed: 0.0706s/iter; left time: 3124.9277s
	iters: 400, epoch: 6 | loss: 0.0001104
	speed: 0.0733s/iter; left time: 3235.4629s
Epoch: 6 cost time: 33.300944328308105
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0031013
	speed: 0.3634s/iter; left time: 15985.7381s
	iters: 200, epoch: 7 | loss: 0.0000012
	speed: 0.0659s/iter; left time: 2890.6578s
	iters: 300, epoch: 7 | loss: 0.2503884
	speed: 0.0657s/iter; left time: 2878.4528s
	iters: 400, epoch: 7 | loss: 0.0008067
	speed: 0.0726s/iter; left time: 3171.7137s
Epoch: 7 cost time: 32.774439573287964
Epoch: 7, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0003517
	speed: 0.3404s/iter; left time: 14813.7157s
	iters: 200, epoch: 8 | loss: 0.0001946
	speed: 0.0630s/iter; left time: 2735.4612s
	iters: 300, epoch: 8 | loss: 0.0225183
	speed: 0.0604s/iter; left time: 2617.3787s
	iters: 400, epoch: 8 | loss: 0.0050448
	speed: 0.0640s/iter; left time: 2766.6070s
Epoch: 8 cost time: 30.21627688407898
Epoch: 8, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.262 Vali Acc: 0.963 Test Loss: 0.262 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0005365
	speed: 0.3560s/iter; left time: 15324.6037s
	iters: 200, epoch: 9 | loss: 0.0190030
	speed: 0.0593s/iter; left time: 2546.9584s
	iters: 300, epoch: 9 | loss: 0.0004299
	speed: 0.0614s/iter; left time: 2628.8732s
	iters: 400, epoch: 9 | loss: 0.0001820
	speed: 0.0664s/iter; left time: 2837.2363s
Epoch: 9 cost time: 30.14956498146057
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.264 Vali Acc: 0.966 Test Loss: 0.264 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000006
	speed: 0.3502s/iter; left time: 14912.4285s
	iters: 200, epoch: 10 | loss: 0.0000002
	speed: 0.0615s/iter; left time: 2613.3057s
	iters: 300, epoch: 10 | loss: 0.0000001
	speed: 0.0621s/iter; left time: 2630.3221s
	iters: 400, epoch: 10 | loss: 0.0039217
	speed: 0.0616s/iter; left time: 2605.6670s
Epoch: 10 cost time: 28.97886896133423
Epoch: 10, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.321 Vali Acc: 0.963 Test Loss: 0.321 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000072
	speed: 0.3428s/iter; left time: 14436.0354s
	iters: 200, epoch: 11 | loss: 0.0057847
	speed: 0.0571s/iter; left time: 2400.4509s
	iters: 300, epoch: 11 | loss: 0.1819797
	speed: 0.0581s/iter; left time: 2434.5612s
	iters: 400, epoch: 11 | loss: 0.0000047
	speed: 0.0613s/iter; left time: 2561.5525s
Epoch: 11 cost time: 28.089314699172974
Epoch: 11, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.202 Vali Acc: 0.966 Test Loss: 0.202 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0000095
	speed: 0.3512s/iter; left time: 14622.9664s
	iters: 200, epoch: 12 | loss: 0.0008382
	speed: 0.0651s/iter; left time: 2704.7949s
	iters: 300, epoch: 12 | loss: 0.0000174
	speed: 0.0623s/iter; left time: 2582.5049s
	iters: 400, epoch: 12 | loss: 0.0247665
	speed: 0.0611s/iter; left time: 2525.2204s
Epoch: 12 cost time: 30.21783685684204
Epoch: 12, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.252 Vali Acc: 0.969 Test Loss: 0.252 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0001091
	speed: 0.3427s/iter; left time: 14108.9147s
	iters: 200, epoch: 13 | loss: 0.0961340
	speed: 0.0538s/iter; left time: 2208.4306s
	iters: 300, epoch: 13 | loss: 0.2381082
	speed: 0.0574s/iter; left time: 2351.5327s
	iters: 400, epoch: 13 | loss: 0.0231951
	speed: 0.0610s/iter; left time: 2491.7894s
Epoch: 13 cost time: 28.18546986579895
Epoch: 13, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.254 Vali Acc: 0.964 Test Loss: 0.254 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000009
	speed: 0.3682s/iter; left time: 14987.2348s
	iters: 200, epoch: 14 | loss: 0.2197398
	speed: 0.0684s/iter; left time: 2777.6752s
	iters: 300, epoch: 14 | loss: 0.9462472
	speed: 0.0645s/iter; left time: 2612.1147s
	iters: 400, epoch: 14 | loss: 0.0007202
	speed: 0.0623s/iter; left time: 2515.8746s
Epoch: 14 cost time: 31.190016984939575
Epoch: 14, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.970553 --> -0.971696).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001367
	speed: 0.3458s/iter; left time: 13912.9572s
	iters: 200, epoch: 15 | loss: 0.1049380
	speed: 0.0666s/iter; left time: 2671.4057s
	iters: 300, epoch: 15 | loss: 0.0002917
	speed: 0.0646s/iter; left time: 2586.9214s
	iters: 400, epoch: 15 | loss: 1.3177798
	speed: 0.0640s/iter; left time: 2554.2189s
Epoch: 15 cost time: 31.798213005065918
Epoch: 15, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.339 Vali Acc: 0.960 Test Loss: 0.339 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000015
	speed: 0.3524s/iter; left time: 14015.3427s
	iters: 200, epoch: 16 | loss: 0.0001645
	speed: 0.0613s/iter; left time: 2433.1340s
	iters: 300, epoch: 16 | loss: 0.0000902
	speed: 0.0576s/iter; left time: 2278.1814s
	iters: 400, epoch: 16 | loss: 0.0703171
	speed: 0.0611s/iter; left time: 2411.1700s
Epoch: 16 cost time: 30.079901218414307
Epoch: 16, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.971696 --> -0.975126).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.3533s/iter; left time: 13883.3479s
	iters: 200, epoch: 17 | loss: 0.0000051
	speed: 0.0679s/iter; left time: 2661.6865s
	iters: 300, epoch: 17 | loss: 0.0002069
	speed: 0.0589s/iter; left time: 2303.9560s
	iters: 400, epoch: 17 | loss: 0.0000014
	speed: 0.0585s/iter; left time: 2279.4301s
Epoch: 17 cost time: 30.10304594039917
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002018
	speed: 0.3204s/iter; left time: 12438.9404s
	iters: 200, epoch: 18 | loss: 0.0007096
	speed: 0.0705s/iter; left time: 2728.8785s
	iters: 300, epoch: 18 | loss: 0.0000001
	speed: 0.0690s/iter; left time: 2665.5486s
	iters: 400, epoch: 18 | loss: 0.0000003
	speed: 0.0609s/iter; left time: 2345.9826s
Epoch: 18 cost time: 31.721418142318726
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.307 Vali Acc: 0.973 Test Loss: 0.307 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.6500387
	speed: 0.3316s/iter; left time: 12718.2784s
	iters: 200, epoch: 19 | loss: 0.0000006
	speed: 0.0652s/iter; left time: 2493.4348s
	iters: 300, epoch: 19 | loss: 0.3159863
	speed: 0.0661s/iter; left time: 2523.1690s
	iters: 400, epoch: 19 | loss: 1.0810231
	speed: 0.0701s/iter; left time: 2669.7503s
Epoch: 19 cost time: 30.949766874313354
Epoch: 19, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.276 Vali Acc: 0.970 Test Loss: 0.276 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0057780
	speed: 0.3333s/iter; left time: 12630.4858s
	iters: 200, epoch: 20 | loss: 0.0003501
	speed: 0.0668s/iter; left time: 2523.3143s
	iters: 300, epoch: 20 | loss: 0.0010861
	speed: 0.0658s/iter; left time: 2478.4591s
	iters: 400, epoch: 20 | loss: 0.0000206
	speed: 0.0636s/iter; left time: 2391.3928s
Epoch: 20 cost time: 31.521546363830566
Epoch: 20, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.975126 --> -0.975412).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000107
	speed: 0.3189s/iter; left time: 11932.4845s
	iters: 200, epoch: 21 | loss: 0.0001343
	speed: 0.0622s/iter; left time: 2321.6644s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0693s/iter; left time: 2577.9353s
	iters: 400, epoch: 21 | loss: 0.0000020
	speed: 0.0716s/iter; left time: 2658.6544s
Epoch: 21 cost time: 31.526731491088867
Epoch: 21, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.250 Vali Acc: 0.978 Test Loss: 0.250 Test Acc: 0.978
Validation loss decreased (-0.975412 --> -0.977699).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000929
	speed: 0.3514s/iter; left time: 12986.1662s
	iters: 200, epoch: 22 | loss: 0.0000927
	speed: 0.0620s/iter; left time: 2283.3873s
	iters: 300, epoch: 22 | loss: 0.0024687
	speed: 0.0609s/iter; left time: 2238.2148s
	iters: 400, epoch: 22 | loss: 0.0017814
	speed: 0.0686s/iter; left time: 2513.6477s
Epoch: 22 cost time: 30.801865577697754
Epoch: 22, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.515 Vali Acc: 0.964 Test Loss: 0.515 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.3379s/iter; left time: 12327.5105s
	iters: 200, epoch: 23 | loss: 0.0000001
	speed: 0.0604s/iter; left time: 2196.5430s
	iters: 300, epoch: 23 | loss: 0.0057004
	speed: 0.0598s/iter; left time: 2169.6034s
	iters: 400, epoch: 23 | loss: 0.0000066
	speed: 0.0666s/iter; left time: 2409.6393s
Epoch: 23 cost time: 30.27758812904358
Epoch: 23, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.262 Vali Acc: 0.977 Test Loss: 0.262 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.3432s/iter; left time: 12360.8458s
	iters: 200, epoch: 24 | loss: 0.0000031
	speed: 0.0608s/iter; left time: 2184.3121s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0600s/iter; left time: 2147.4415s
	iters: 400, epoch: 24 | loss: 0.0026424
	speed: 0.0616s/iter; left time: 2200.6804s
Epoch: 24 cost time: 29.284728527069092
Epoch: 24, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.359 Vali Acc: 0.970 Test Loss: 0.359 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0115216
	speed: 0.3461s/iter; left time: 12300.8489s
	iters: 200, epoch: 25 | loss: 0.0269780
	speed: 0.0607s/iter; left time: 2151.3147s
	iters: 300, epoch: 25 | loss: 0.0003347
	speed: 0.0654s/iter; left time: 2309.8561s
	iters: 400, epoch: 25 | loss: 0.0000006
	speed: 0.0621s/iter; left time: 2189.0596s
Epoch: 25 cost time: 30.04708242416382
Epoch: 25, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.974 Test Loss: 0.253 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.3897046
	speed: 0.3482s/iter; left time: 12211.9509s
	iters: 200, epoch: 26 | loss: 0.0191462
	speed: 0.0609s/iter; left time: 2129.5242s
	iters: 300, epoch: 26 | loss: 0.0024443
	speed: 0.0626s/iter; left time: 2183.4762s
	iters: 400, epoch: 26 | loss: 0.0000003
	speed: 0.0632s/iter; left time: 2196.3056s
Epoch: 26 cost time: 29.672475337982178
Epoch: 26, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.979 Test Loss: 0.309 Test Acc: 0.979
Validation loss decreased (-0.977699 --> -0.978842).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.1803789
	speed: 0.3630s/iter; left time: 12563.4259s
	iters: 200, epoch: 27 | loss: 0.2127478
	speed: 0.0675s/iter; left time: 2329.9073s
	iters: 300, epoch: 27 | loss: 0.0000001
	speed: 0.0651s/iter; left time: 2239.8683s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0645s/iter; left time: 2214.3976s
Epoch: 27 cost time: 31.83266854286194
Epoch: 27, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.330 Vali Acc: 0.977 Test Loss: 0.330 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000385
	speed: 0.3544s/iter; left time: 12097.9029s
	iters: 200, epoch: 28 | loss: 0.0672558
	speed: 0.0627s/iter; left time: 2135.5615s
	iters: 300, epoch: 28 | loss: 0.0000017
	speed: 0.0632s/iter; left time: 2144.4253s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0609s/iter; left time: 2060.3041s
Epoch: 28 cost time: 30.265838861465454
Epoch: 28, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000631
	speed: 0.3393s/iter; left time: 11424.5692s
	iters: 200, epoch: 29 | loss: 0.0001035
	speed: 0.0576s/iter; left time: 1934.9550s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0579s/iter; left time: 1938.5686s
	iters: 400, epoch: 29 | loss: 0.0000012
	speed: 0.0582s/iter; left time: 1941.0771s
Epoch: 29 cost time: 28.55758833885193
Epoch: 29, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.337 Vali Acc: 0.979 Test Loss: 0.337 Test Acc: 0.979
Validation loss decreased (-0.978842 --> -0.979413).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.3301s/iter; left time: 10959.1437s
	iters: 200, epoch: 30 | loss: 0.0000009
	speed: 0.0613s/iter; left time: 2029.3008s
	iters: 300, epoch: 30 | loss: 0.2459250
	speed: 0.0538s/iter; left time: 1774.4037s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.0524s/iter; left time: 1723.5163s
Epoch: 30 cost time: 27.257871627807617
Epoch: 30, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.534 Vali Acc: 0.973 Test Loss: 0.534 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000012
	speed: 0.3024s/iter; left time: 9896.5822s
	iters: 200, epoch: 31 | loss: 0.0000009
	speed: 0.0633s/iter; left time: 2065.5416s
	iters: 300, epoch: 31 | loss: 4.1996789
	speed: 0.0607s/iter; left time: 1974.8471s
	iters: 400, epoch: 31 | loss: 0.0000004
	speed: 0.0622s/iter; left time: 2018.2114s
Epoch: 31 cost time: 29.737838983535767
Epoch: 31, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.366 Vali Acc: 0.973 Test Loss: 0.366 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.3090s/iter; left time: 9970.3581s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0651s/iter; left time: 2092.7483s
	iters: 300, epoch: 32 | loss: 0.0000019
	speed: 0.0688s/iter; left time: 2204.5387s
	iters: 400, epoch: 32 | loss: 0.0000029
	speed: 0.0663s/iter; left time: 2118.2281s
Epoch: 32 cost time: 31.017033100128174
Epoch: 32, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.349 Vali Acc: 0.983 Test Loss: 0.349 Test Acc: 0.983
Validation loss decreased (-0.979413 --> -0.982844).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000004
	speed: 0.3321s/iter; left time: 10559.9262s
	iters: 200, epoch: 33 | loss: 0.0000390
	speed: 0.0652s/iter; left time: 2065.9221s
	iters: 300, epoch: 33 | loss: 0.0000000
	speed: 0.0672s/iter; left time: 2121.5859s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0680s/iter; left time: 2140.8579s
Epoch: 33 cost time: 32.04675245285034
Epoch: 33, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.418 Vali Acc: 0.974 Test Loss: 0.418 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000489
	speed: 0.3264s/iter; left time: 10222.9037s
	iters: 200, epoch: 34 | loss: 0.0000000
	speed: 0.0624s/iter; left time: 1948.1452s
	iters: 300, epoch: 34 | loss: 0.0058504
	speed: 0.0557s/iter; left time: 1732.6298s
	iters: 400, epoch: 34 | loss: 0.0007918
	speed: 0.0575s/iter; left time: 1783.8531s
Epoch: 34 cost time: 28.895684957504272
Epoch: 34, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.337 Vali Acc: 0.980 Test Loss: 0.337 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0419482
	speed: 0.2901s/iter; left time: 8950.6678s
	iters: 200, epoch: 35 | loss: 0.0041694
	speed: 0.0662s/iter; left time: 2034.7159s
	iters: 300, epoch: 35 | loss: 0.0000000
	speed: 0.0653s/iter; left time: 2000.9715s
	iters: 400, epoch: 35 | loss: 0.5573096
	speed: 0.0588s/iter; left time: 1797.8812s
Epoch: 35 cost time: 30.124088764190674
Epoch: 35, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.365 Vali Acc: 0.977 Test Loss: 0.365 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0000962
	speed: 0.3128s/iter; left time: 9504.4404s
	iters: 200, epoch: 36 | loss: 0.0000002
	speed: 0.0662s/iter; left time: 2005.8379s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0680s/iter; left time: 2054.0533s
	iters: 400, epoch: 36 | loss: 0.0000000
	speed: 0.0616s/iter; left time: 1854.5788s
Epoch: 36 cost time: 30.410460233688354
Epoch: 36, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.690 Vali Acc: 0.965 Test Loss: 0.690 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.3233s/iter; left time: 9672.3863s
	iters: 200, epoch: 37 | loss: 0.6672379
	speed: 0.0659s/iter; left time: 1965.1417s
	iters: 300, epoch: 37 | loss: 0.0000000
	speed: 0.0641s/iter; left time: 1906.1641s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0613s/iter; left time: 1815.4626s
Epoch: 37 cost time: 29.937623500823975
Epoch: 37, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.645 Vali Acc: 0.970 Test Loss: 0.645 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.3189s/iter; left time: 9389.9804s
	iters: 200, epoch: 38 | loss: 0.0000014
	speed: 0.0664s/iter; left time: 1948.9783s
	iters: 300, epoch: 38 | loss: 0.0005388
	speed: 0.0631s/iter; left time: 1845.4968s
	iters: 400, epoch: 38 | loss: 0.0000023
	speed: 0.0623s/iter; left time: 1816.6698s
Epoch: 38 cost time: 29.722573280334473
Epoch: 38, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.585 Vali Acc: 0.967 Test Loss: 0.585 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.3181s/iter; left time: 9218.9963s
	iters: 200, epoch: 39 | loss: 0.0000000
	speed: 0.0586s/iter; left time: 1692.9165s
	iters: 300, epoch: 39 | loss: 0.0000000
	speed: 0.0717s/iter; left time: 2062.9873s
	iters: 400, epoch: 39 | loss: 0.0000000
	speed: 0.0695s/iter; left time: 1994.4749s
Epoch: 39 cost time: 31.82977318763733
Epoch: 39, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.379 Vali Acc: 0.977 Test Loss: 0.379 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.1996306
	speed: 0.3461s/iter; left time: 9866.4574s
	iters: 200, epoch: 40 | loss: 0.1301403
	speed: 0.0623s/iter; left time: 1769.7750s
	iters: 300, epoch: 40 | loss: 0.0000001
	speed: 0.0592s/iter; left time: 1677.0169s
	iters: 400, epoch: 40 | loss: 0.0000073
	speed: 0.0692s/iter; left time: 1950.9136s
Epoch: 40 cost time: 30.541012287139893
Epoch: 40, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.541 Vali Acc: 0.974 Test Loss: 0.541 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.3369s/iter; left time: 9446.3765s
	iters: 200, epoch: 41 | loss: 1.0992205
	speed: 0.0581s/iter; left time: 1622.7585s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0553s/iter; left time: 1539.7776s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0615s/iter; left time: 1705.5969s
Epoch: 41 cost time: 27.59361958503723
Epoch: 41, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.595 Vali Acc: 0.968 Test Loss: 0.595 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0000003
	speed: 0.3386s/iter; left time: 9335.5674s
	iters: 200, epoch: 42 | loss: 0.0000001
	speed: 0.0620s/iter; left time: 1703.1698s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0648s/iter; left time: 1772.9236s
	iters: 400, epoch: 42 | loss: 0.0000000
	speed: 0.0588s/iter; left time: 1604.2099s
Epoch: 42 cost time: 29.479974508285522
Epoch: 42, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.600 Vali Acc: 0.971 Test Loss: 0.600 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 1631290
model size : 16.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3408505
	speed: 0.0917s/iter; left time: 4291.6572s
	iters: 200, epoch: 1 | loss: 0.2075088
	speed: 0.0617s/iter; left time: 2882.3312s
	iters: 300, epoch: 1 | loss: 0.0475294
	speed: 0.0609s/iter; left time: 2839.7039s
	iters: 400, epoch: 1 | loss: 0.5085698
	speed: 0.0595s/iter; left time: 2765.6677s
Epoch: 1 cost time: 31.541927099227905
Epoch: 1, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (inf --> -0.952543).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0839900
	speed: 0.3123s/iter; left time: 14469.6279s
	iters: 200, epoch: 2 | loss: 0.1039594
	speed: 0.0723s/iter; left time: 3344.0542s
	iters: 300, epoch: 2 | loss: 0.1611347
	speed: 0.0619s/iter; left time: 2857.8140s
	iters: 400, epoch: 2 | loss: 0.0177982
	speed: 0.0579s/iter; left time: 2667.4648s
Epoch: 2 cost time: 30.78783369064331
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.2516980
	speed: 0.3363s/iter; left time: 15424.8853s
	iters: 200, epoch: 3 | loss: 0.0297357
	speed: 0.0706s/iter; left time: 3232.0874s
	iters: 300, epoch: 3 | loss: 0.0481343
	speed: 0.0657s/iter; left time: 2997.9669s
	iters: 400, epoch: 3 | loss: 0.0140038
	speed: 0.0584s/iter; left time: 2659.9503s
Epoch: 3 cost time: 31.430428504943848
Epoch: 3, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.335 Vali Acc: 0.910 Test Loss: 0.335 Test Acc: 0.910
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0587718
	speed: 0.3383s/iter; left time: 15357.4488s
	iters: 200, epoch: 4 | loss: 0.3121378
	speed: 0.0672s/iter; left time: 3044.6704s
	iters: 300, epoch: 4 | loss: 0.0037700
	speed: 0.0677s/iter; left time: 3058.8966s
	iters: 400, epoch: 4 | loss: 0.0030290
	speed: 0.0635s/iter; left time: 2863.3775s
Epoch: 4 cost time: 32.117677450180054
Epoch: 4, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
Validation loss decreased (-0.952543 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0005671
	speed: 0.3239s/iter; left time: 14551.6395s
	iters: 200, epoch: 5 | loss: 0.1722656
	speed: 0.0650s/iter; left time: 2912.0356s
	iters: 300, epoch: 5 | loss: 0.0077257
	speed: 0.0631s/iter; left time: 2822.2482s
	iters: 400, epoch: 5 | loss: 0.1688378
	speed: 0.0642s/iter; left time: 2866.7833s
Epoch: 5 cost time: 29.89073920249939
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1375965
	speed: 0.3238s/iter; left time: 14396.7809s
	iters: 200, epoch: 6 | loss: 0.0277296
	speed: 0.0628s/iter; left time: 2785.6312s
	iters: 300, epoch: 6 | loss: 0.0003558
	speed: 0.0656s/iter; left time: 2903.4083s
	iters: 400, epoch: 6 | loss: 0.3807312
	speed: 0.0660s/iter; left time: 2913.3215s
Epoch: 6 cost time: 30.481974363327026
Epoch: 6, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0009058
	speed: 0.3067s/iter; left time: 13492.5935s
	iters: 200, epoch: 7 | loss: 0.0024968
	speed: 0.0565s/iter; left time: 2481.6799s
	iters: 300, epoch: 7 | loss: 0.1353437
	speed: 0.0656s/iter; left time: 2873.3829s
	iters: 400, epoch: 7 | loss: 0.0011471
	speed: 0.0635s/iter; left time: 2773.8869s
Epoch: 7 cost time: 29.79636836051941
Epoch: 7, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0034219
	speed: 0.3222s/iter; left time: 14021.3987s
	iters: 200, epoch: 8 | loss: 0.0003426
	speed: 0.0572s/iter; left time: 2482.5607s
	iters: 300, epoch: 8 | loss: 0.0009417
	speed: 0.0550s/iter; left time: 2384.1371s
	iters: 400, epoch: 8 | loss: 0.1336345
	speed: 0.0638s/iter; left time: 2757.1196s
Epoch: 8 cost time: 28.23226022720337
Epoch: 8, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0090262
	speed: 0.3452s/iter; left time: 14862.6644s
	iters: 200, epoch: 9 | loss: 0.0010264
	speed: 0.0645s/iter; left time: 2771.4180s
	iters: 300, epoch: 9 | loss: 0.0038484
	speed: 0.0618s/iter; left time: 2646.8800s
	iters: 400, epoch: 9 | loss: 0.0135153
	speed: 0.0659s/iter; left time: 2817.8981s
Epoch: 9 cost time: 30.776463508605957
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0176559
	speed: 0.3415s/iter; left time: 14541.6576s
	iters: 200, epoch: 10 | loss: 0.1018033
	speed: 0.0572s/iter; left time: 2429.0727s
	iters: 300, epoch: 10 | loss: 0.0237867
	speed: 0.0597s/iter; left time: 2532.1553s
	iters: 400, epoch: 10 | loss: 0.0002852
	speed: 0.0643s/iter; left time: 2719.8497s
Epoch: 10 cost time: 29.79746675491333
Epoch: 10, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
Validation loss decreased (-0.966551 --> -0.971411).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0001088
	speed: 0.3482s/iter; left time: 14663.2316s
	iters: 200, epoch: 11 | loss: 0.0029452
	speed: 0.0588s/iter; left time: 2469.4472s
	iters: 300, epoch: 11 | loss: 0.0150363
	speed: 0.0597s/iter; left time: 2501.1664s
	iters: 400, epoch: 11 | loss: 0.0260228
	speed: 0.0558s/iter; left time: 2331.1964s
Epoch: 11 cost time: 27.9411838054657
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000578
	speed: 0.3341s/iter; left time: 13914.4699s
	iters: 200, epoch: 12 | loss: 0.0067517
	speed: 0.0562s/iter; left time: 2334.2638s
	iters: 300, epoch: 12 | loss: 0.0009017
	speed: 0.0603s/iter; left time: 2500.9485s
	iters: 400, epoch: 12 | loss: 0.0000655
	speed: 0.0603s/iter; left time: 2492.1030s
Epoch: 12 cost time: 28.3590304851532
Epoch: 12, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0830056
	speed: 0.3402s/iter; left time: 14005.9399s
	iters: 200, epoch: 13 | loss: 0.6755266
	speed: 0.0584s/iter; left time: 2400.4183s
	iters: 300, epoch: 13 | loss: 0.0000755
	speed: 0.0582s/iter; left time: 2383.1453s
	iters: 400, epoch: 13 | loss: 0.0000404
	speed: 0.0588s/iter; left time: 2404.6408s
Epoch: 13 cost time: 27.880571126937866
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0252942
	speed: 0.3421s/iter; left time: 13925.3420s
	iters: 200, epoch: 14 | loss: 0.0622230
	speed: 0.0603s/iter; left time: 2448.6249s
	iters: 300, epoch: 14 | loss: 0.0001009
	speed: 0.0590s/iter; left time: 2387.8342s
	iters: 400, epoch: 14 | loss: 0.0620537
	speed: 0.0564s/iter; left time: 2276.9027s
Epoch: 14 cost time: 28.00810480117798
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.2521640
	speed: 0.3295s/iter; left time: 13259.1791s
	iters: 200, epoch: 15 | loss: 0.4066027
	speed: 0.0597s/iter; left time: 2396.5362s
	iters: 300, epoch: 15 | loss: 0.0005700
	speed: 0.0598s/iter; left time: 2392.1105s
	iters: 400, epoch: 15 | loss: 0.0004526
	speed: 0.0601s/iter; left time: 2399.7823s
Epoch: 15 cost time: 29.48383593559265
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0004184
	speed: 0.3351s/iter; left time: 13325.8181s
	iters: 200, epoch: 16 | loss: 0.0002284
	speed: 0.0580s/iter; left time: 2299.8486s
	iters: 300, epoch: 16 | loss: 0.0489287
	speed: 0.0586s/iter; left time: 2318.9722s
	iters: 400, epoch: 16 | loss: 0.0847271
	speed: 0.0547s/iter; left time: 2157.1915s
Epoch: 16 cost time: 28.708290338516235
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0183750
	speed: 0.3533s/iter; left time: 13885.2548s
	iters: 200, epoch: 17 | loss: 0.0001413
	speed: 0.0580s/iter; left time: 2272.4489s
	iters: 300, epoch: 17 | loss: 0.0002173
	speed: 0.0578s/iter; left time: 2261.1259s
	iters: 400, epoch: 17 | loss: 0.0000026
	speed: 0.0552s/iter; left time: 2153.9935s
Epoch: 17 cost time: 28.48370051383972
Epoch: 17, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.971411 --> -0.975413).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0005982
	speed: 0.3231s/iter; left time: 12546.3242s
	iters: 200, epoch: 18 | loss: 0.6500765
	speed: 0.0703s/iter; left time: 2723.7561s
	iters: 300, epoch: 18 | loss: 0.0001177
	speed: 0.0569s/iter; left time: 2198.4876s
	iters: 400, epoch: 18 | loss: 0.0001996
	speed: 0.0519s/iter; left time: 2000.6152s
Epoch: 18 cost time: 28.9224636554718
Epoch: 18, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.214 Vali Acc: 0.966 Test Loss: 0.214 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0400017
	speed: 0.2951s/iter; left time: 11319.7094s
	iters: 200, epoch: 19 | loss: 0.2260385
	speed: 0.0603s/iter; left time: 2308.5644s
	iters: 300, epoch: 19 | loss: 0.7268971
	speed: 0.0629s/iter; left time: 2399.5258s
	iters: 400, epoch: 19 | loss: 0.1674023
	speed: 0.0513s/iter; left time: 1951.2792s
Epoch: 19 cost time: 27.905173301696777
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0163924
	speed: 0.2936s/iter; left time: 11123.1494s
	iters: 200, epoch: 20 | loss: 0.0462665
	speed: 0.0654s/iter; left time: 2472.8103s
	iters: 300, epoch: 20 | loss: 0.0092661
	speed: 0.0648s/iter; left time: 2443.4663s
	iters: 400, epoch: 20 | loss: 0.0233240
	speed: 0.0627s/iter; left time: 2357.9972s
Epoch: 20 cost time: 29.874343156814575
Epoch: 20, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0058249
	speed: 0.3311s/iter; left time: 12389.1238s
	iters: 200, epoch: 21 | loss: 0.0002830
	speed: 0.0636s/iter; left time: 2374.8037s
	iters: 300, epoch: 21 | loss: 0.0104103
	speed: 0.1004s/iter; left time: 3737.2408s
	iters: 400, epoch: 21 | loss: 0.0717296
	speed: 0.0846s/iter; left time: 3140.5851s
Epoch: 21 cost time: 37.785747051239014
Epoch: 21, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000683
	speed: 0.4958s/iter; left time: 18320.9519s
	iters: 200, epoch: 22 | loss: 0.0034227
	speed: 0.0781s/iter; left time: 2879.2984s
	iters: 300, epoch: 22 | loss: 0.1044496
	speed: 0.0907s/iter; left time: 3331.6883s
	iters: 400, epoch: 22 | loss: 0.2344914
	speed: 0.0874s/iter; left time: 3202.1149s
Epoch: 22 cost time: 40.00720930099487
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000124
	speed: 0.3779s/iter; left time: 13785.8302s
	iters: 200, epoch: 23 | loss: 0.0160511
	speed: 0.0700s/iter; left time: 2548.5014s
	iters: 300, epoch: 23 | loss: 0.0316470
	speed: 0.0792s/iter; left time: 2872.5770s
	iters: 400, epoch: 23 | loss: 0.0000598
	speed: 0.0769s/iter; left time: 2784.0609s
Epoch: 23 cost time: 34.79643893241882
Epoch: 23, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.198 Vali Acc: 0.965 Test Loss: 0.198 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0005552
	speed: 0.4224s/iter; left time: 15211.4495s
	iters: 200, epoch: 24 | loss: 0.3061139
	speed: 0.0846s/iter; left time: 3040.1201s
	iters: 300, epoch: 24 | loss: 0.1034253
	speed: 0.0792s/iter; left time: 2834.9372s
	iters: 400, epoch: 24 | loss: 0.2271820
	speed: 0.0769s/iter; left time: 2746.7139s
Epoch: 24 cost time: 39.0997474193573
Epoch: 24, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0003650
	speed: 0.3694s/iter; left time: 13131.1897s
	iters: 200, epoch: 25 | loss: 0.0003361
	speed: 0.0606s/iter; left time: 2149.3941s
	iters: 300, epoch: 25 | loss: 0.0015779
	speed: 0.0586s/iter; left time: 2071.3440s
	iters: 400, epoch: 25 | loss: 0.0048543
	speed: 0.0630s/iter; left time: 2218.7587s
Epoch: 25 cost time: 29.077470302581787
Epoch: 25, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.224 Vali Acc: 0.969 Test Loss: 0.224 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000055
	speed: 0.3321s/iter; left time: 11648.9974s
	iters: 200, epoch: 26 | loss: 0.0005659
	speed: 0.0600s/iter; left time: 2098.1478s
	iters: 300, epoch: 26 | loss: 0.0037304
	speed: 0.0569s/iter; left time: 1985.6864s
	iters: 400, epoch: 26 | loss: 0.0000020
	speed: 0.0652s/iter; left time: 2266.5404s
Epoch: 26 cost time: 29.10711646080017
Epoch: 26, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0008885
	speed: 0.3121s/iter; left time: 10800.9813s
	iters: 200, epoch: 27 | loss: 0.0000531
	speed: 0.0554s/iter; left time: 1912.2524s
	iters: 300, epoch: 27 | loss: 0.0000010
	speed: 0.0584s/iter; left time: 2008.2932s
	iters: 400, epoch: 27 | loss: 0.0020310
	speed: 0.0570s/iter; left time: 1955.1540s
Epoch: 27 cost time: 27.75006079673767
Epoch: 27, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.202 Vali Acc: 0.961 Test Loss: 0.202 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9754145225843339
model parameter : 1369146
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3358364
	speed: 0.0851s/iter; left time: 3982.0022s
	iters: 200, epoch: 1 | loss: 0.2153220
	speed: 0.0639s/iter; left time: 2984.4764s
	iters: 300, epoch: 1 | loss: 0.1007842
	speed: 0.0653s/iter; left time: 3041.0243s
	iters: 400, epoch: 1 | loss: 0.4785226
	speed: 0.0586s/iter; left time: 2726.3068s
Epoch: 1 cost time: 31.340527296066284
Epoch: 1, Steps: 469 | Train Loss: 0.327 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (inf --> -0.957402).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0988471
	speed: 0.3038s/iter; left time: 14076.9235s
	iters: 200, epoch: 2 | loss: 0.0334123
	speed: 0.0536s/iter; left time: 2479.4344s
	iters: 300, epoch: 2 | loss: 0.1029468
	speed: 0.0587s/iter; left time: 2706.1123s
	iters: 400, epoch: 2 | loss: 0.0086057
	speed: 0.0514s/iter; left time: 2364.6464s
Epoch: 2 cost time: 25.532982349395752
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1225371
	speed: 0.2864s/iter; left time: 13134.3301s
	iters: 200, epoch: 3 | loss: 0.0030503
	speed: 0.0679s/iter; left time: 3109.4142s
	iters: 300, epoch: 3 | loss: 0.0006984
	speed: 0.0652s/iter; left time: 2977.6973s
	iters: 400, epoch: 3 | loss: 0.0085481
	speed: 0.0662s/iter; left time: 3016.8597s
Epoch: 3 cost time: 31.440672159194946
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.957402 --> -0.963120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0130866
	speed: 0.3288s/iter; left time: 14923.3552s
	iters: 200, epoch: 4 | loss: 0.2195029
	speed: 0.0685s/iter; left time: 3101.2856s
	iters: 300, epoch: 4 | loss: 0.0025552
	speed: 0.0697s/iter; left time: 3149.2490s
	iters: 400, epoch: 4 | loss: 0.0207232
	speed: 0.0653s/iter; left time: 2946.3263s
Epoch: 4 cost time: 31.8484308719635
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.249 Vali Acc: 0.959 Test Loss: 0.249 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0004468
	speed: 0.3262s/iter; left time: 14654.4294s
	iters: 200, epoch: 5 | loss: 0.0443444
	speed: 0.0727s/iter; left time: 3256.7118s
	iters: 300, epoch: 5 | loss: 0.0031320
	speed: 0.0723s/iter; left time: 3231.4692s
	iters: 400, epoch: 5 | loss: 0.0497441
	speed: 0.0699s/iter; left time: 3119.3533s
Epoch: 5 cost time: 32.71717929840088
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.963120 --> -0.972840).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0387531
	speed: 0.3302s/iter; left time: 14680.3768s
	iters: 200, epoch: 6 | loss: 0.0015473
	speed: 0.0628s/iter; left time: 2783.8728s
	iters: 300, epoch: 6 | loss: 0.0003530
	speed: 0.0657s/iter; left time: 2909.6843s
	iters: 400, epoch: 6 | loss: 0.1405729
	speed: 0.0693s/iter; left time: 3061.6557s
Epoch: 6 cost time: 31.62728977203369
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.243 Vali Acc: 0.953 Test Loss: 0.243 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0165189
	speed: 0.3466s/iter; left time: 15248.0058s
	iters: 200, epoch: 7 | loss: 0.0059376
	speed: 0.0652s/iter; left time: 2860.3557s
	iters: 300, epoch: 7 | loss: 0.3556881
	speed: 0.0644s/iter; left time: 2819.5329s
	iters: 400, epoch: 7 | loss: 0.3755561
	speed: 0.0734s/iter; left time: 3205.7252s
Epoch: 7 cost time: 32.34145212173462
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.222 Vali Acc: 0.964 Test Loss: 0.222 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000175
	speed: 0.3822s/iter; left time: 16632.3374s
	iters: 200, epoch: 8 | loss: 0.0064806
	speed: 0.0643s/iter; left time: 2792.2186s
	iters: 300, epoch: 8 | loss: 0.0011093
	speed: 0.0575s/iter; left time: 2490.0307s
	iters: 400, epoch: 8 | loss: 0.0192265
	speed: 0.0600s/iter; left time: 2594.9392s
Epoch: 8 cost time: 30.04134202003479
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.1169781
	speed: 0.3476s/iter; left time: 14962.4743s
	iters: 200, epoch: 9 | loss: 0.0000500
	speed: 0.0616s/iter; left time: 2646.7857s
	iters: 300, epoch: 9 | loss: 0.0000977
	speed: 0.0625s/iter; left time: 2679.6684s
	iters: 400, epoch: 9 | loss: 0.0465952
	speed: 0.0612s/iter; left time: 2615.7796s
Epoch: 9 cost time: 30.235121965408325
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0008711
	speed: 0.3515s/iter; left time: 14965.9047s
	iters: 200, epoch: 10 | loss: 0.1713363
	speed: 0.0583s/iter; left time: 2477.4278s
	iters: 300, epoch: 10 | loss: 0.0011728
	speed: 0.0614s/iter; left time: 2601.5641s
	iters: 400, epoch: 10 | loss: 0.0002303
	speed: 0.0625s/iter; left time: 2644.5227s
Epoch: 10 cost time: 29.17800736427307
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0004682
	speed: 0.3409s/iter; left time: 14355.4813s
	iters: 200, epoch: 11 | loss: 0.0851139
	speed: 0.0646s/iter; left time: 2712.4028s
	iters: 300, epoch: 11 | loss: 0.3684627
	speed: 0.0638s/iter; left time: 2672.4983s
	iters: 400, epoch: 11 | loss: 0.0001945
	speed: 0.0606s/iter; left time: 2532.4021s
Epoch: 11 cost time: 29.593615770339966
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.218 Vali Acc: 0.966 Test Loss: 0.218 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0015340
	speed: 0.3648s/iter; left time: 15189.8278s
	iters: 200, epoch: 12 | loss: 0.1618344
	speed: 0.0618s/iter; left time: 2565.6394s
	iters: 300, epoch: 12 | loss: 0.4226546
	speed: 0.0654s/iter; left time: 2709.5863s
	iters: 400, epoch: 12 | loss: 0.0000135
	speed: 0.0628s/iter; left time: 2597.5793s
Epoch: 12 cost time: 30.156893253326416
Epoch: 12, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.300 Vali Acc: 0.958 Test Loss: 0.300 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0131458
	speed: 0.3638s/iter; left time: 14978.5929s
	iters: 200, epoch: 13 | loss: 0.1025880
	speed: 0.0687s/iter; left time: 2820.6459s
	iters: 300, epoch: 13 | loss: 0.0000759
	speed: 0.0669s/iter; left time: 2741.5605s
	iters: 400, epoch: 13 | loss: 0.0000002
	speed: 0.0592s/iter; left time: 2421.6768s
Epoch: 13 cost time: 31.89055371284485
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0071869
	speed: 0.3495s/iter; left time: 14227.1740s
	iters: 200, epoch: 14 | loss: 0.0030396
	speed: 0.0728s/iter; left time: 2955.0089s
	iters: 300, epoch: 14 | loss: 0.0021290
	speed: 0.0661s/iter; left time: 2678.1310s
	iters: 400, epoch: 14 | loss: 0.0015328
	speed: 0.0658s/iter; left time: 2659.0244s
Epoch: 14 cost time: 31.994232654571533
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000006
	speed: 0.3424s/iter; left time: 13774.9800s
	iters: 200, epoch: 15 | loss: 0.0014904
	speed: 0.0684s/iter; left time: 2745.5219s
	iters: 300, epoch: 15 | loss: 0.0007328
	speed: 0.0627s/iter; left time: 2508.6469s
	iters: 400, epoch: 15 | loss: 0.0019690
	speed: 0.0625s/iter; left time: 2496.8948s
Epoch: 15 cost time: 30.780239820480347
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 1369146
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3648395
	speed: 0.0821s/iter; left time: 3844.5723s
	iters: 200, epoch: 1 | loss: 0.3282613
	speed: 0.0595s/iter; left time: 2777.1575s
	iters: 300, epoch: 1 | loss: 0.0775903
	speed: 0.0581s/iter; left time: 2705.5916s
	iters: 400, epoch: 1 | loss: 0.4680890
	speed: 0.0627s/iter; left time: 2916.7797s
Epoch: 1 cost time: 30.60554575920105
Epoch: 1, Steps: 469 | Train Loss: 0.315 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (inf --> -0.961405).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0312283
	speed: 0.3404s/iter; left time: 15773.5823s
	iters: 200, epoch: 2 | loss: 0.0250922
	speed: 0.0615s/iter; left time: 2843.1529s
	iters: 300, epoch: 2 | loss: 0.0392149
	speed: 0.0552s/iter; left time: 2548.0334s
	iters: 400, epoch: 2 | loss: 0.0007000
	speed: 0.0507s/iter; left time: 2334.8070s
Epoch: 2 cost time: 27.07778573036194
Epoch: 2, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0399807
	speed: 0.3115s/iter; left time: 14286.7942s
	iters: 200, epoch: 3 | loss: 0.0033218
	speed: 0.0657s/iter; left time: 3008.1517s
	iters: 300, epoch: 3 | loss: 0.0030706
	speed: 0.0600s/iter; left time: 2738.6060s
	iters: 400, epoch: 3 | loss: 0.0008582
	speed: 0.0629s/iter; left time: 2866.0147s
Epoch: 3 cost time: 30.11158847808838
Epoch: 3, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.313 Vali Acc: 0.942 Test Loss: 0.313 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0643711
	speed: 0.3336s/iter; left time: 15143.1916s
	iters: 200, epoch: 4 | loss: 0.0087980
	speed: 0.0715s/iter; left time: 3237.0823s
	iters: 300, epoch: 4 | loss: 0.0139106
	speed: 0.0735s/iter; left time: 3323.8523s
	iters: 400, epoch: 4 | loss: 0.2868049
	speed: 0.0586s/iter; left time: 2641.2683s
Epoch: 4 cost time: 31.36195421218872
Epoch: 4, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
Validation loss decreased (-0.961405 --> -0.966550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0832863
	speed: 0.3091s/iter; left time: 13887.2460s
	iters: 200, epoch: 5 | loss: 0.0494995
	speed: 0.0571s/iter; left time: 2559.0731s
	iters: 300, epoch: 5 | loss: 0.0001912
	speed: 0.0593s/iter; left time: 2653.9689s
	iters: 400, epoch: 5 | loss: 0.0044736
	speed: 0.0569s/iter; left time: 2540.4637s
Epoch: 5 cost time: 26.973032474517822
Epoch: 5, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.5237336
	speed: 0.3106s/iter; left time: 13805.8251s
	iters: 200, epoch: 6 | loss: 0.0039365
	speed: 0.0866s/iter; left time: 3839.5982s
	iters: 300, epoch: 6 | loss: 0.0032772
	speed: 0.0860s/iter; left time: 3804.8868s
	iters: 400, epoch: 6 | loss: 0.0000695
	speed: 0.0784s/iter; left time: 3463.1266s
Epoch: 6 cost time: 39.456385135650635
Epoch: 6, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0017052
	speed: 0.4272s/iter; left time: 18791.7092s
	iters: 200, epoch: 7 | loss: 0.0000303
	speed: 0.0985s/iter; left time: 4322.8363s
	iters: 300, epoch: 7 | loss: 0.0343748
	speed: 0.1180s/iter; left time: 5166.9680s
	iters: 400, epoch: 7 | loss: 0.0002624
	speed: 0.1023s/iter; left time: 4469.3588s
Epoch: 7 cost time: 48.18737196922302
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.239 Vali Acc: 0.969 Test Loss: 0.239 Test Acc: 0.969
Validation loss decreased (-0.966550 --> -0.968551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0001889
	speed: 0.6170s/iter; left time: 26850.9082s
	iters: 200, epoch: 8 | loss: 0.0186413
	speed: 0.1200s/iter; left time: 5212.1150s
	iters: 300, epoch: 8 | loss: 0.0004953
	speed: 0.1261s/iter; left time: 5460.7160s
	iters: 400, epoch: 8 | loss: 0.0004663
	speed: 0.1115s/iter; left time: 4820.3852s
Epoch: 8 cost time: 56.68864631652832
Epoch: 8, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.255 Vali Acc: 0.965 Test Loss: 0.255 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000201
	speed: 0.6235s/iter; left time: 26839.5539s
	iters: 200, epoch: 9 | loss: 0.0000220
	speed: 0.1279s/iter; left time: 5495.0626s
	iters: 300, epoch: 9 | loss: 0.0000016
	speed: 0.1128s/iter; left time: 4833.7252s
	iters: 400, epoch: 9 | loss: 0.2361930
	speed: 0.1269s/iter; left time: 5424.3558s
Epoch: 9 cost time: 56.95676922798157
Epoch: 9, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.362 Vali Acc: 0.965 Test Loss: 0.362 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001383
	speed: 0.5486s/iter; left time: 23359.1107s
	iters: 200, epoch: 10 | loss: 0.0000401
	speed: 0.1173s/iter; left time: 4982.8537s
	iters: 300, epoch: 10 | loss: 0.0035981
	speed: 0.1090s/iter; left time: 4618.6737s
	iters: 400, epoch: 10 | loss: 0.0000011
	speed: 0.0858s/iter; left time: 3625.6403s
Epoch: 10 cost time: 51.24338626861572
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
Validation loss decreased (-0.968551 --> -0.971410).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000850
	speed: 0.6002s/iter; left time: 25274.2337s
	iters: 200, epoch: 11 | loss: 0.0584578
	speed: 0.1159s/iter; left time: 4870.6229s
	iters: 300, epoch: 11 | loss: 0.0561571
	speed: 0.0920s/iter; left time: 3854.8759s
	iters: 400, epoch: 11 | loss: 0.1393578
	speed: 0.1108s/iter; left time: 4633.7824s
Epoch: 11 cost time: 50.52294206619263
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.968 Test Loss: 0.292 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.6287625
	speed: 0.6111s/iter; left time: 25446.8156s
	iters: 200, epoch: 12 | loss: 0.5404128
	speed: 0.1007s/iter; left time: 4184.7571s
	iters: 300, epoch: 12 | loss: 0.0001610
	speed: 0.1061s/iter; left time: 4396.4560s
	iters: 400, epoch: 12 | loss: 0.0001686
	speed: 0.1042s/iter; left time: 4306.9716s
Epoch: 12 cost time: 51.56657028198242
Epoch: 12, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.370 Vali Acc: 0.958 Test Loss: 0.370 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0799768
	speed: 0.6071s/iter; left time: 24995.8681s
	iters: 200, epoch: 13 | loss: 0.2617482
	speed: 0.1007s/iter; left time: 4136.4684s
	iters: 300, epoch: 13 | loss: 0.0001878
	speed: 0.1097s/iter; left time: 4494.2239s
	iters: 400, epoch: 13 | loss: 0.0000000
	speed: 0.1026s/iter; left time: 4192.9615s
Epoch: 13 cost time: 49.75663924217224
Epoch: 13, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.379 Vali Acc: 0.970 Test Loss: 0.379 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000006
	speed: 0.5592s/iter; left time: 22762.7752s
	iters: 200, epoch: 14 | loss: 0.0014487
	speed: 0.1116s/iter; left time: 4531.6009s
	iters: 300, epoch: 14 | loss: 0.0014147
	speed: 0.1122s/iter; left time: 4545.4663s
	iters: 400, epoch: 14 | loss: 0.0025534
	speed: 0.1168s/iter; left time: 4720.6774s
Epoch: 14 cost time: 52.58257699012756
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.345 Vali Acc: 0.967 Test Loss: 0.345 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0002172
	speed: 0.6151s/iter; left time: 24749.2131s
	iters: 200, epoch: 15 | loss: 0.0018669
	speed: 0.1085s/iter; left time: 4355.5803s
	iters: 300, epoch: 15 | loss: 0.0000002
	speed: 0.0910s/iter; left time: 3642.4908s
	iters: 400, epoch: 15 | loss: 0.0010640
	speed: 0.0932s/iter; left time: 3722.8540s
Epoch: 15 cost time: 49.84467339515686
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.450 Vali Acc: 0.964 Test Loss: 0.450 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000043
	speed: 0.5643s/iter; left time: 22441.8600s
	iters: 200, epoch: 16 | loss: 0.0000192
	speed: 0.0944s/iter; left time: 3746.2759s
	iters: 300, epoch: 16 | loss: 0.0429400
	speed: 0.1142s/iter; left time: 4520.3634s
	iters: 400, epoch: 16 | loss: 0.1337510
	speed: 0.1142s/iter; left time: 4505.9900s
Epoch: 16 cost time: 47.90937614440918
Epoch: 16, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0012484
	speed: 0.5855s/iter; left time: 23009.8808s
	iters: 200, epoch: 17 | loss: 0.0117970
	speed: 0.0969s/iter; left time: 3798.5775s
	iters: 300, epoch: 17 | loss: 0.0000006
	speed: 0.0977s/iter; left time: 3818.8813s
	iters: 400, epoch: 17 | loss: 0.0000000
	speed: 0.1130s/iter; left time: 4407.8104s
Epoch: 17 cost time: 47.78263068199158
Epoch: 17, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.524 Vali Acc: 0.959 Test Loss: 0.524 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0000002
	speed: 0.5617s/iter; left time: 21810.0052s
	iters: 200, epoch: 18 | loss: 0.5473710
	speed: 0.0985s/iter; left time: 3813.0615s
	iters: 300, epoch: 18 | loss: 0.0084255
	speed: 0.1128s/iter; left time: 4357.0312s
	iters: 400, epoch: 18 | loss: 0.0001270
	speed: 0.1053s/iter; left time: 4056.0716s
Epoch: 18 cost time: 49.92050337791443
Epoch: 18, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.341 Vali Acc: 0.970 Test Loss: 0.341 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.5515s/iter; left time: 21156.5921s
	iters: 200, epoch: 19 | loss: 0.4086665
	speed: 0.0727s/iter; left time: 2782.2397s
	iters: 300, epoch: 19 | loss: 1.5899429
	speed: 0.0798s/iter; left time: 3044.2870s
	iters: 400, epoch: 19 | loss: 0.0000000
	speed: 0.1016s/iter; left time: 3868.6502s
Epoch: 19 cost time: 42.997008085250854
Epoch: 19, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.266 Vali Acc: 0.976 Test Loss: 0.266 Test Acc: 0.976
Validation loss decreased (-0.971410 --> -0.975984).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.5093419
	speed: 0.6191s/iter; left time: 23456.7160s
	iters: 200, epoch: 20 | loss: 0.0055326
	speed: 0.1029s/iter; left time: 3889.8706s
	iters: 300, epoch: 20 | loss: 0.2856749
	speed: 0.1078s/iter; left time: 4063.0235s
	iters: 400, epoch: 20 | loss: 0.0019944
	speed: 0.1067s/iter; left time: 4010.6346s
Epoch: 20 cost time: 51.902909994125366
Epoch: 20, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.283 Vali Acc: 0.970 Test Loss: 0.283 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0025390
	speed: 0.5871s/iter; left time: 21971.3368s
	iters: 200, epoch: 21 | loss: 0.0000326
	speed: 0.1139s/iter; left time: 4250.1942s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.1076s/iter; left time: 4006.4499s
	iters: 400, epoch: 21 | loss: 0.6795958
	speed: 0.1124s/iter; left time: 4172.1535s
Epoch: 21 cost time: 53.54637265205383
Epoch: 21, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.332 Vali Acc: 0.971 Test Loss: 0.332 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000368
	speed: 0.5860s/iter; left time: 21654.4919s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.1005s/iter; left time: 3702.7845s
	iters: 300, epoch: 22 | loss: 0.0002550
	speed: 0.1114s/iter; left time: 4094.7758s
	iters: 400, epoch: 22 | loss: 0.0004800
	speed: 0.1125s/iter; left time: 4122.5964s
Epoch: 22 cost time: 50.06330060958862
Epoch: 22, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.235 Vali Acc: 0.983 Test Loss: 0.235 Test Acc: 0.983
Validation loss decreased (-0.975984 --> -0.982845).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000019
	speed: 0.5304s/iter; left time: 19350.0575s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.1047s/iter; left time: 3808.8562s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0875s/iter; left time: 3175.1075s
	iters: 400, epoch: 23 | loss: 0.0018260
	speed: 0.0900s/iter; left time: 3256.7241s
Epoch: 23 cost time: 47.13207983970642
Epoch: 23, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.542 Vali Acc: 0.961 Test Loss: 0.542 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0000001
	speed: 0.5895s/iter; left time: 21230.1611s
	iters: 200, epoch: 24 | loss: 0.0000244
	speed: 0.1122s/iter; left time: 4031.1278s
	iters: 300, epoch: 24 | loss: 0.0000104
	speed: 0.0951s/iter; left time: 3405.0437s
	iters: 400, epoch: 24 | loss: 0.0000000
	speed: 0.1225s/iter; left time: 4373.7394s
Epoch: 24 cost time: 51.24830865859985
Epoch: 24, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.261 Vali Acc: 0.979 Test Loss: 0.261 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0000004
	speed: 0.5821s/iter; left time: 20689.9216s
	iters: 200, epoch: 25 | loss: 0.0000002
	speed: 0.1041s/iter; left time: 3689.8166s
	iters: 300, epoch: 25 | loss: 0.0000080
	speed: 0.1044s/iter; left time: 3690.4261s
	iters: 400, epoch: 25 | loss: 0.0003340
	speed: 0.1151s/iter; left time: 4055.7985s
Epoch: 25 cost time: 52.05345821380615
Epoch: 25, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.367 Vali Acc: 0.968 Test Loss: 0.367 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0000686
	speed: 0.6239s/iter; left time: 21884.8008s
	iters: 200, epoch: 26 | loss: 0.0012142
	speed: 0.1078s/iter; left time: 3769.5202s
	iters: 300, epoch: 26 | loss: 0.0001635
	speed: 0.1132s/iter; left time: 3946.2290s
	iters: 400, epoch: 26 | loss: 0.0000000
	speed: 0.0902s/iter; left time: 3138.2534s
Epoch: 26 cost time: 51.08187937736511
Epoch: 26, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0000008
	speed: 0.6232s/iter; left time: 21565.6569s
	iters: 200, epoch: 27 | loss: 0.0000138
	speed: 0.1225s/iter; left time: 4225.7560s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.1131s/iter; left time: 3892.8281s
	iters: 400, epoch: 27 | loss: 0.0000087
	speed: 0.0898s/iter; left time: 3079.4105s
Epoch: 27 cost time: 51.22261595726013
Epoch: 27, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.5556s/iter; left time: 18968.2195s
	iters: 200, epoch: 28 | loss: 1.1303358
	speed: 0.1123s/iter; left time: 3823.0168s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0972s/iter; left time: 3299.6158s
	iters: 400, epoch: 28 | loss: 0.0000409
	speed: 0.0920s/iter; left time: 3112.3459s
Epoch: 28 cost time: 50.98382067680359
Epoch: 28, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.381 Vali Acc: 0.967 Test Loss: 0.381 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0005512
	speed: 0.6224s/iter; left time: 20956.2707s
	iters: 200, epoch: 29 | loss: 0.0000001
	speed: 0.0996s/iter; left time: 3343.7641s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.1110s/iter; left time: 3716.5303s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.1122s/iter; left time: 3742.7695s
Epoch: 29 cost time: 50.93387222290039
Epoch: 29, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.364 Vali Acc: 0.971 Test Loss: 0.364 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.5786s/iter; left time: 19208.0781s
	iters: 200, epoch: 30 | loss: 0.0000011
	speed: 0.0979s/iter; left time: 3241.3528s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0998s/iter; left time: 3295.0300s
	iters: 400, epoch: 30 | loss: 0.0000000
	speed: 0.1035s/iter; left time: 3405.6663s
Epoch: 30 cost time: 49.87491321563721
Epoch: 30, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.313 Vali Acc: 0.972 Test Loss: 0.313 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0000065
	speed: 0.6017s/iter; left time: 19692.8111s
	iters: 200, epoch: 31 | loss: 0.0000085
	speed: 0.1055s/iter; left time: 3441.4923s
	iters: 300, epoch: 31 | loss: 0.0000039
	speed: 0.0765s/iter; left time: 2488.4379s
	iters: 400, epoch: 31 | loss: 0.0000261
	speed: 0.0733s/iter; left time: 2376.4256s
Epoch: 31 cost time: 44.82184815406799
Epoch: 31, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.380 Vali Acc: 0.970 Test Loss: 0.380 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.1202542
	speed: 0.5952s/iter; left time: 19201.4291s
	iters: 200, epoch: 32 | loss: 0.0000004
	speed: 0.1117s/iter; left time: 3593.7830s
	iters: 300, epoch: 32 | loss: 0.0000004
	speed: 0.1129s/iter; left time: 3619.6592s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.1170s/iter; left time: 3741.1012s
Epoch: 32 cost time: 53.239978075027466
Epoch: 32, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.394 Vali Acc: 0.974 Test Loss: 0.394 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 1369146
model size : 15.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2596858
	speed: 0.1437s/iter; left time: 6727.3446s
	iters: 200, epoch: 1 | loss: 0.2095108
	speed: 0.1127s/iter; left time: 5263.2758s
	iters: 300, epoch: 1 | loss: 0.3129131
	speed: 0.1093s/iter; left time: 5092.6444s
	iters: 400, epoch: 1 | loss: 0.0667479
	speed: 0.1033s/iter; left time: 4801.8240s
Epoch: 1 cost time: 54.60733985900879
Epoch: 1, Steps: 469 | Train Loss: 0.354 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (inf --> -0.942251).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0515898
	speed: 0.5673s/iter; left time: 26286.3798s
	iters: 200, epoch: 2 | loss: 0.0170133
	speed: 0.1046s/iter; left time: 4834.8721s
	iters: 300, epoch: 2 | loss: 0.0194403
	speed: 0.1007s/iter; left time: 4647.0054s
	iters: 400, epoch: 2 | loss: 0.0014706
	speed: 0.1057s/iter; left time: 4866.9574s
Epoch: 2 cost time: 49.497785806655884
Epoch: 2, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.942251 --> -0.956831).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0136019
	speed: 0.5794s/iter; left time: 26573.4467s
	iters: 200, epoch: 3 | loss: 0.0063119
	speed: 0.0984s/iter; left time: 4501.2073s
	iters: 300, epoch: 3 | loss: 0.0036139
	speed: 0.0691s/iter; left time: 3154.4671s
	iters: 400, epoch: 3 | loss: 0.0310151
	speed: 0.0798s/iter; left time: 3635.7519s
Epoch: 3 cost time: 43.21272134780884
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1146670
	speed: 0.4593s/iter; left time: 20849.4400s
	iters: 200, epoch: 4 | loss: 0.0041944
	speed: 0.1169s/iter; left time: 5296.6604s
	iters: 300, epoch: 4 | loss: 0.0028224
	speed: 0.1129s/iter; left time: 5103.3406s
	iters: 400, epoch: 4 | loss: 0.1460928
	speed: 0.1067s/iter; left time: 4811.6079s
Epoch: 4 cost time: 53.49327373504639
Epoch: 4, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0194575
	speed: 0.5697s/iter; left time: 25595.2606s
	iters: 200, epoch: 5 | loss: 0.0031148
	speed: 0.0996s/iter; left time: 4465.6469s
	iters: 300, epoch: 5 | loss: 0.1848203
	speed: 0.1031s/iter; left time: 4612.0276s
	iters: 400, epoch: 5 | loss: 0.0034501
	speed: 0.1048s/iter; left time: 4675.2351s
Epoch: 5 cost time: 49.45385003089905
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0040362
	speed: 0.5890s/iter; left time: 26185.5046s
	iters: 200, epoch: 6 | loss: 0.0739161
	speed: 0.1048s/iter; left time: 4649.3345s
	iters: 300, epoch: 6 | loss: 0.0005145
	speed: 0.1091s/iter; left time: 4828.1000s
	iters: 400, epoch: 6 | loss: 0.0003073
	speed: 0.1029s/iter; left time: 4543.6990s
Epoch: 6 cost time: 50.34961438179016
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0336544
	speed: 0.5635s/iter; left time: 24786.3221s
	iters: 200, epoch: 7 | loss: 0.0019055
	speed: 0.1090s/iter; left time: 4784.3459s
	iters: 300, epoch: 7 | loss: 0.0054761
	speed: 0.1074s/iter; left time: 4703.5326s
	iters: 400, epoch: 7 | loss: 0.0012768
	speed: 0.1030s/iter; left time: 4497.8333s
Epoch: 7 cost time: 51.89221453666687
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
Validation loss decreased (-0.956831 --> -0.965121).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0004419
	speed: 0.5487s/iter; left time: 23880.1317s
	iters: 200, epoch: 8 | loss: 0.0003328
	speed: 0.1189s/iter; left time: 5160.8037s
	iters: 300, epoch: 8 | loss: 0.0153427
	speed: 0.1040s/iter; left time: 4505.3884s
	iters: 400, epoch: 8 | loss: 0.1182247
	speed: 0.0951s/iter; left time: 4112.0631s
Epoch: 8 cost time: 51.00158214569092
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0032416
	speed: 0.6113s/iter; left time: 26316.8201s
	iters: 200, epoch: 9 | loss: 0.0191217
	speed: 0.1095s/iter; left time: 4701.6506s
	iters: 300, epoch: 9 | loss: 0.0013948
	speed: 0.1118s/iter; left time: 4791.6446s
	iters: 400, epoch: 9 | loss: 0.0094738
	speed: 0.1112s/iter; left time: 4754.2574s
Epoch: 9 cost time: 52.868929386138916
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
Validation loss decreased (-0.965121 --> -0.968838).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0062997
	speed: 0.6000s/iter; left time: 25548.4480s
	iters: 200, epoch: 10 | loss: 0.0000570
	speed: 0.1065s/iter; left time: 4523.3335s
	iters: 300, epoch: 10 | loss: 0.1127699
	speed: 0.1159s/iter; left time: 4912.4924s
	iters: 400, epoch: 10 | loss: 0.0010410
	speed: 0.1135s/iter; left time: 4798.1072s
Epoch: 10 cost time: 54.357521772384644
Epoch: 10, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1304051
	speed: 0.6156s/iter; left time: 25924.9668s
	iters: 200, epoch: 11 | loss: 0.0171726
	speed: 0.0987s/iter; left time: 4146.5086s
	iters: 300, epoch: 11 | loss: 0.0002216
	speed: 0.1090s/iter; left time: 4568.5794s
	iters: 400, epoch: 11 | loss: 0.0150108
	speed: 0.1169s/iter; left time: 4886.0384s
Epoch: 11 cost time: 51.483490228652954
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.968838 --> -0.974841).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0016675
	speed: 0.6102s/iter; left time: 25410.3955s
	iters: 200, epoch: 12 | loss: 0.0025561
	speed: 0.0947s/iter; left time: 3935.8999s
	iters: 300, epoch: 12 | loss: 0.0005139
	speed: 0.1027s/iter; left time: 4255.1246s
	iters: 400, epoch: 12 | loss: 0.0340198
	speed: 0.1102s/iter; left time: 4554.8051s
Epoch: 12 cost time: 49.19881820678711
Epoch: 12, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0432726
	speed: 0.5749s/iter; left time: 23668.6734s
	iters: 200, epoch: 13 | loss: 0.0000265
	speed: 0.1059s/iter; left time: 4348.3941s
	iters: 300, epoch: 13 | loss: 0.2623965
	speed: 0.1080s/iter; left time: 4424.1391s
	iters: 400, epoch: 13 | loss: 0.0052949
	speed: 0.1120s/iter; left time: 4576.5844s
Epoch: 13 cost time: 50.4527382850647
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.279 Vali Acc: 0.945 Test Loss: 0.279 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0211847
	speed: 0.4460s/iter; left time: 18152.9469s
	iters: 200, epoch: 14 | loss: 0.0008689
	speed: 0.0837s/iter; left time: 3397.9681s
	iters: 300, epoch: 14 | loss: 0.0041958
	speed: 0.0952s/iter; left time: 3855.2408s
	iters: 400, epoch: 14 | loss: 0.1258386
	speed: 0.0950s/iter; left time: 3840.2912s
Epoch: 14 cost time: 41.10845756530762
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0008699
	speed: 0.5689s/iter; left time: 22888.5317s
	iters: 200, epoch: 15 | loss: 0.0118322
	speed: 0.1076s/iter; left time: 4317.6168s
	iters: 300, epoch: 15 | loss: 0.0043487
	speed: 0.1024s/iter; left time: 4099.6711s
	iters: 400, epoch: 15 | loss: 0.0000906
	speed: 0.1119s/iter; left time: 4468.3999s
Epoch: 15 cost time: 50.58123779296875
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.232 Vali Acc: 0.958 Test Loss: 0.232 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0018982
	speed: 0.5617s/iter; left time: 22337.8382s
	iters: 200, epoch: 16 | loss: 0.0005609
	speed: 0.0982s/iter; left time: 3895.6506s
	iters: 300, epoch: 16 | loss: 0.0006654
	speed: 0.1065s/iter; left time: 4211.9512s
	iters: 400, epoch: 16 | loss: 0.0320272
	speed: 0.1180s/iter; left time: 4656.4537s
Epoch: 16 cost time: 49.40066123008728
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.961 Test Loss: 0.244 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.3681811
	speed: 0.5797s/iter; left time: 22782.0882s
	iters: 200, epoch: 17 | loss: 0.8351465
	speed: 0.0930s/iter; left time: 3646.8789s
	iters: 300, epoch: 17 | loss: 0.0006987
	speed: 0.0881s/iter; left time: 3444.8089s
	iters: 400, epoch: 17 | loss: 0.0000702
	speed: 0.1012s/iter; left time: 3947.8894s
Epoch: 17 cost time: 46.52140283584595
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0026668
	speed: 0.5481s/iter; left time: 21282.0705s
	iters: 200, epoch: 18 | loss: 0.0000325
	speed: 0.0960s/iter; left time: 3719.3710s
	iters: 300, epoch: 18 | loss: 0.9131412
	speed: 0.0938s/iter; left time: 3623.4788s
	iters: 400, epoch: 18 | loss: 0.0458746
	speed: 0.0909s/iter; left time: 3503.4028s
Epoch: 18 cost time: 44.18039345741272
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.2850580
	speed: 0.4858s/iter; left time: 18635.3317s
	iters: 200, epoch: 19 | loss: 0.0006740
	speed: 0.0765s/iter; left time: 2926.0406s
	iters: 300, epoch: 19 | loss: 0.0000369
	speed: 0.0976s/iter; left time: 3726.1385s
	iters: 400, epoch: 19 | loss: 0.0114092
	speed: 0.1100s/iter; left time: 4188.3630s
Epoch: 19 cost time: 43.26649188995361
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.974 Test Loss: 0.209 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000496
	speed: 0.5415s/iter; left time: 20517.1352s
	iters: 200, epoch: 20 | loss: 0.0000319
	speed: 0.1011s/iter; left time: 3819.5213s
	iters: 300, epoch: 20 | loss: 0.2367422
	speed: 0.0943s/iter; left time: 3552.6652s
	iters: 400, epoch: 20 | loss: 0.0668005
	speed: 0.1074s/iter; left time: 4038.5602s
Epoch: 20 cost time: 47.14280295372009
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0009621
	speed: 0.5364s/iter; left time: 20074.1307s
	iters: 200, epoch: 21 | loss: 0.0788299
	speed: 0.0909s/iter; left time: 3393.6584s
	iters: 300, epoch: 21 | loss: 0.0000025
	speed: 0.1111s/iter; left time: 4135.1570s
	iters: 400, epoch: 21 | loss: 0.0000066
	speed: 0.1099s/iter; left time: 4078.5152s
Epoch: 21 cost time: 48.86146903038025
Epoch: 21, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9748427672955975
model parameter : 1238074
model size : 14.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2462900
	speed: 0.1326s/iter; left time: 6205.4648s
	iters: 200, epoch: 1 | loss: 0.1654325
	speed: 0.1120s/iter; left time: 5232.3961s
	iters: 300, epoch: 1 | loss: 0.1960442
	speed: 0.0891s/iter; left time: 4150.4170s
	iters: 400, epoch: 1 | loss: 0.0468979
	speed: 0.0839s/iter; left time: 3902.7037s
Epoch: 1 cost time: 47.94218826293945
Epoch: 1, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.195 Vali Acc: 0.947 Test Loss: 0.195 Test Acc: 0.947
Validation loss decreased (inf --> -0.947111).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0183541
	speed: 0.5433s/iter; left time: 25174.1219s
	iters: 200, epoch: 2 | loss: 0.0112617
	speed: 0.1067s/iter; left time: 4932.2296s
	iters: 300, epoch: 2 | loss: 0.0015541
	speed: 0.0686s/iter; left time: 3165.2786s
	iters: 400, epoch: 2 | loss: 0.0007449
	speed: 0.0791s/iter; left time: 3643.1232s
Epoch: 2 cost time: 42.9014527797699
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.219 Vali Acc: 0.958 Test Loss: 0.219 Test Acc: 0.958
Validation loss decreased (-0.947111 --> -0.957688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0168839
	speed: 0.5096s/iter; left time: 23371.9433s
	iters: 200, epoch: 3 | loss: 0.0006176
	speed: 0.1009s/iter; left time: 4616.7312s
	iters: 300, epoch: 3 | loss: 0.0268385
	speed: 0.0839s/iter; left time: 3832.9309s
	iters: 400, epoch: 3 | loss: 0.0745979
	speed: 0.0875s/iter; left time: 3986.4807s
Epoch: 3 cost time: 43.93785262107849
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.239 Vali Acc: 0.942 Test Loss: 0.239 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2787121
	speed: 0.4781s/iter; left time: 21703.7480s
	iters: 200, epoch: 4 | loss: 0.0082765
	speed: 0.0901s/iter; left time: 4083.0604s
	iters: 300, epoch: 4 | loss: 0.0025646
	speed: 0.0885s/iter; left time: 3999.6882s
	iters: 400, epoch: 4 | loss: 0.0153825
	speed: 0.0892s/iter; left time: 4021.9644s
Epoch: 4 cost time: 42.774428367614746
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0023801
	speed: 0.5411s/iter; left time: 24307.1204s
	iters: 200, epoch: 5 | loss: 0.0548271
	speed: 0.1058s/iter; left time: 4744.0585s
	iters: 300, epoch: 5 | loss: 0.0421267
	speed: 0.1018s/iter; left time: 4553.5534s
	iters: 400, epoch: 5 | loss: 0.0002330
	speed: 0.1045s/iter; left time: 4661.9800s
Epoch: 5 cost time: 49.43625020980835
Epoch: 5, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0013381
	speed: 0.4818s/iter; left time: 21417.1918s
	iters: 200, epoch: 6 | loss: 0.0004069
	speed: 0.1208s/iter; left time: 5359.8537s
	iters: 300, epoch: 6 | loss: 0.0328927
	speed: 0.1148s/iter; left time: 5079.6825s
	iters: 400, epoch: 6 | loss: 0.0000368
	speed: 0.1157s/iter; left time: 5108.5229s
Epoch: 6 cost time: 54.84194493293762
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.303 Vali Acc: 0.951 Test Loss: 0.303 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0006132
	speed: 0.5807s/iter; left time: 25541.6959s
	iters: 200, epoch: 7 | loss: 0.0000263
	speed: 0.0826s/iter; left time: 3623.3374s
	iters: 300, epoch: 7 | loss: 0.0002057
	speed: 0.0902s/iter; left time: 3947.6239s
	iters: 400, epoch: 7 | loss: 0.0692145
	speed: 0.0893s/iter; left time: 3900.3828s
Epoch: 7 cost time: 43.5006160736084
Epoch: 7, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
Validation loss decreased (-0.957688 --> -0.962262).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0007195
	speed: 0.5724s/iter; left time: 24907.9925s
	iters: 200, epoch: 8 | loss: 0.0022408
	speed: 0.1010s/iter; left time: 4386.1395s
	iters: 300, epoch: 8 | loss: 0.0789016
	speed: 0.1043s/iter; left time: 4517.9463s
	iters: 400, epoch: 8 | loss: 0.9290354
	speed: 0.0945s/iter; left time: 4083.6714s
Epoch: 8 cost time: 47.768327474594116
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.241 Vali Acc: 0.959 Test Loss: 0.241 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0020322
	speed: 0.5163s/iter; left time: 22224.2180s
	iters: 200, epoch: 9 | loss: 0.0402378
	speed: 0.0964s/iter; left time: 4142.4104s
	iters: 300, epoch: 9 | loss: 0.0000426
	speed: 0.1004s/iter; left time: 4300.6252s
	iters: 400, epoch: 9 | loss: 0.0078397
	speed: 0.0934s/iter; left time: 3991.9056s
Epoch: 9 cost time: 45.2490918636322
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.958 Test Loss: 0.252 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0003172
	speed: 0.5522s/iter; left time: 23511.6710s
	iters: 200, epoch: 10 | loss: 0.1278332
	speed: 0.1051s/iter; left time: 4465.9939s
	iters: 300, epoch: 10 | loss: 0.2157899
	speed: 0.0869s/iter; left time: 3682.2757s
	iters: 400, epoch: 10 | loss: 0.0117456
	speed: 0.0809s/iter; left time: 3420.3337s
Epoch: 10 cost time: 41.35561203956604
Epoch: 10, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.302 Vali Acc: 0.961 Test Loss: 0.302 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000256
	speed: 0.4752s/iter; left time: 20010.1561s
	iters: 200, epoch: 11 | loss: 0.0170226
	speed: 0.0983s/iter; left time: 4128.6613s
	iters: 300, epoch: 11 | loss: 0.0177593
	speed: 0.0851s/iter; left time: 3567.5498s
	iters: 400, epoch: 11 | loss: 0.1355513
	speed: 0.0883s/iter; left time: 3692.0145s
Epoch: 11 cost time: 42.7205650806427
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
Validation loss decreased (-0.962262 --> -0.972840).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0235284
	speed: 0.5432s/iter; left time: 22619.9455s
	iters: 200, epoch: 12 | loss: 0.0571519
	speed: 0.1026s/iter; left time: 4261.1903s
	iters: 300, epoch: 12 | loss: 0.0253561
	speed: 0.0944s/iter; left time: 3910.1070s
	iters: 400, epoch: 12 | loss: 0.2087122
	speed: 0.1025s/iter; left time: 4239.5121s
Epoch: 12 cost time: 46.17929553985596
Epoch: 12, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0185678
	speed: 0.5002s/iter; left time: 20595.9078s
	iters: 200, epoch: 13 | loss: 0.0004563
	speed: 0.0880s/iter; left time: 3612.5386s
	iters: 300, epoch: 13 | loss: 0.1257009
	speed: 0.0881s/iter; left time: 3610.8833s
	iters: 400, epoch: 13 | loss: 0.0402043
	speed: 0.1117s/iter; left time: 4564.9359s
Epoch: 13 cost time: 44.32307481765747
Epoch: 13, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.966 Test Loss: 0.282 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0731401
	speed: 0.5692s/iter; left time: 23168.1662s
	iters: 200, epoch: 14 | loss: 0.0001587
	speed: 0.1001s/iter; left time: 4063.6986s
	iters: 300, epoch: 14 | loss: 0.0004181
	speed: 0.0928s/iter; left time: 3758.2918s
	iters: 400, epoch: 14 | loss: 0.0075955
	speed: 0.0766s/iter; left time: 3095.2023s
Epoch: 14 cost time: 42.63607168197632
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0388823
	speed: 0.5210s/iter; left time: 20961.7536s
	iters: 200, epoch: 15 | loss: 0.0038517
	speed: 0.0754s/iter; left time: 3027.9028s
	iters: 300, epoch: 15 | loss: 0.2510402
	speed: 0.0776s/iter; left time: 3106.1399s
	iters: 400, epoch: 15 | loss: 0.0000282
	speed: 0.0715s/iter; left time: 2855.5407s
Epoch: 15 cost time: 39.8179931640625
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0053079
	speed: 0.4911s/iter; left time: 19530.1611s
	iters: 200, epoch: 16 | loss: 0.0045459
	speed: 0.1120s/iter; left time: 4444.1462s
	iters: 300, epoch: 16 | loss: 0.0223398
	speed: 0.1114s/iter; left time: 4408.1662s
	iters: 400, epoch: 16 | loss: 0.1345369
	speed: 0.1151s/iter; left time: 4541.5662s
Epoch: 16 cost time: 51.952301025390625
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.964 Test Loss: 0.247 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0014169
	speed: 0.5244s/iter; left time: 20608.3822s
	iters: 200, epoch: 17 | loss: 1.9666020
	speed: 0.1078s/iter; left time: 4223.8046s
	iters: 300, epoch: 17 | loss: 0.0008061
	speed: 0.0920s/iter; left time: 3596.6758s
	iters: 400, epoch: 17 | loss: 0.0000119
	speed: 0.0774s/iter; left time: 3018.7840s
Epoch: 17 cost time: 42.83671021461487
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.321 Vali Acc: 0.948 Test Loss: 0.321 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000108
	speed: 0.5094s/iter; left time: 19777.9413s
	iters: 200, epoch: 18 | loss: 0.0000238
	speed: 0.1105s/iter; left time: 4280.9905s
	iters: 300, epoch: 18 | loss: 1.0393943
	speed: 0.1074s/iter; left time: 4148.5453s
	iters: 400, epoch: 18 | loss: 0.0151096
	speed: 0.0918s/iter; left time: 3537.0290s
Epoch: 18 cost time: 47.71968388557434
Epoch: 18, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.194 Vali Acc: 0.968 Test Loss: 0.194 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.3538238
	speed: 0.4976s/iter; left time: 19088.4855s
	iters: 200, epoch: 19 | loss: 0.0382725
	speed: 0.0851s/iter; left time: 3256.3730s
	iters: 300, epoch: 19 | loss: 0.0000255
	speed: 0.0993s/iter; left time: 3790.8652s
	iters: 400, epoch: 19 | loss: 0.0046238
	speed: 0.1067s/iter; left time: 4061.4432s
Epoch: 19 cost time: 45.613099575042725
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.962 Test Loss: 0.255 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0243826
	speed: 0.5138s/iter; left time: 19466.5412s
	iters: 200, epoch: 20 | loss: 0.0062220
	speed: 0.1006s/iter; left time: 3802.5392s
	iters: 300, epoch: 20 | loss: 0.0000092
	speed: 0.1057s/iter; left time: 3983.7209s
	iters: 400, epoch: 20 | loss: 0.0001823
	speed: 0.1023s/iter; left time: 3846.3627s
Epoch: 20 cost time: 47.7865846157074
Epoch: 20, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001168
	speed: 0.5290s/iter; left time: 19795.5620s
	iters: 200, epoch: 21 | loss: 0.1190040
	speed: 0.0889s/iter; left time: 3318.3649s
	iters: 300, epoch: 21 | loss: 0.0001882
	speed: 0.0989s/iter; left time: 3682.5436s
	iters: 400, epoch: 21 | loss: 0.0010386
	speed: 0.0988s/iter; left time: 3666.3773s
Epoch: 21 cost time: 43.71088194847107
Epoch: 21, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.360 Vali Acc: 0.952 Test Loss: 0.360 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.97284162378502
model parameter : 1238074
model size : 14.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2166331
	speed: 0.1438s/iter; left time: 6731.7564s
	iters: 200, epoch: 1 | loss: 0.1150088
	speed: 0.1147s/iter; left time: 5355.8996s
	iters: 300, epoch: 1 | loss: 0.0892826
	speed: 0.1189s/iter; left time: 5540.1405s
	iters: 400, epoch: 1 | loss: 0.0115492
	speed: 0.1104s/iter; left time: 5134.6299s
Epoch: 1 cost time: 56.110382080078125
Epoch: 1, Steps: 469 | Train Loss: 0.329 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (inf --> -0.959975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0042724
	speed: 0.5699s/iter; left time: 26404.5177s
	iters: 200, epoch: 2 | loss: 0.0009907
	speed: 0.0981s/iter; left time: 4533.8464s
	iters: 300, epoch: 2 | loss: 0.0035136
	speed: 0.1151s/iter; left time: 5308.2577s
	iters: 400, epoch: 2 | loss: 0.0046955
	speed: 0.1026s/iter; left time: 4724.5861s
Epoch: 2 cost time: 50.05399703979492
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
Validation loss decreased (-0.959975 --> -0.971982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0034296
	speed: 0.5336s/iter; left time: 24471.0639s
	iters: 200, epoch: 3 | loss: 0.0001424
	speed: 0.1042s/iter; left time: 4767.7060s
	iters: 300, epoch: 3 | loss: 0.0040700
	speed: 0.1133s/iter; left time: 5172.3974s
	iters: 400, epoch: 3 | loss: 0.0064383
	speed: 0.1099s/iter; left time: 5008.7117s
Epoch: 3 cost time: 51.33196425437927
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2423389
	speed: 0.4985s/iter; left time: 22628.5431s
	iters: 200, epoch: 4 | loss: 0.0001645
	speed: 0.1116s/iter; left time: 5053.2319s
	iters: 300, epoch: 4 | loss: 0.0005486
	speed: 0.1139s/iter; left time: 5146.3165s
	iters: 400, epoch: 4 | loss: 0.7407287
	speed: 0.1080s/iter; left time: 4872.3531s
Epoch: 4 cost time: 50.39462161064148
Epoch: 4, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.337 Vali Acc: 0.943 Test Loss: 0.337 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0852332
	speed: 0.5057s/iter; left time: 22719.5056s
	iters: 200, epoch: 5 | loss: 0.0028040
	speed: 0.0753s/iter; left time: 3374.7676s
	iters: 300, epoch: 5 | loss: 0.0503431
	speed: 0.0791s/iter; left time: 3536.9366s
	iters: 400, epoch: 5 | loss: 0.0056556
	speed: 0.1137s/iter; left time: 5073.6552s
Epoch: 5 cost time: 43.8180730342865
Epoch: 5, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0273803
	speed: 0.5273s/iter; left time: 23442.3889s
	iters: 200, epoch: 6 | loss: 0.0029795
	speed: 0.1072s/iter; left time: 4754.6704s
	iters: 300, epoch: 6 | loss: 0.0002392
	speed: 0.0967s/iter; left time: 4277.8692s
	iters: 400, epoch: 6 | loss: 0.0064167
	speed: 0.1027s/iter; left time: 4533.4102s
Epoch: 6 cost time: 48.63263440132141
Epoch: 6, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0045280
	speed: 0.5293s/iter; left time: 23280.2058s
	iters: 200, epoch: 7 | loss: 0.0050598
	speed: 0.1143s/iter; left time: 5014.7225s
	iters: 300, epoch: 7 | loss: 0.0000963
	speed: 0.1154s/iter; left time: 5052.7491s
	iters: 400, epoch: 7 | loss: 0.3091123
	speed: 0.1086s/iter; left time: 4743.8186s
Epoch: 7 cost time: 52.404433488845825
Epoch: 7, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000176
	speed: 0.5312s/iter; left time: 23116.9575s
	iters: 200, epoch: 8 | loss: 0.0000108
	speed: 0.0914s/iter; left time: 3968.3028s
	iters: 300, epoch: 8 | loss: 0.0484495
	speed: 0.1041s/iter; left time: 4510.3641s
	iters: 400, epoch: 8 | loss: 0.4206363
	speed: 0.1094s/iter; left time: 4728.8182s
Epoch: 8 cost time: 47.23657250404358
Epoch: 8, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.230 Vali Acc: 0.967 Test Loss: 0.230 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0015773
	speed: 0.5490s/iter; left time: 23634.6302s
	iters: 200, epoch: 9 | loss: 0.0000001
	speed: 0.1076s/iter; left time: 4622.0672s
	iters: 300, epoch: 9 | loss: 0.1050259
	speed: 0.1035s/iter; left time: 4434.1365s
	iters: 400, epoch: 9 | loss: 0.0016170
	speed: 0.1106s/iter; left time: 4728.8001s
Epoch: 9 cost time: 50.550657987594604
Epoch: 9, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.964 Test Loss: 0.227 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0000464
	speed: 0.4298s/iter; left time: 18300.5784s
	iters: 200, epoch: 10 | loss: 0.3975244
	speed: 0.0899s/iter; left time: 3819.6116s
	iters: 300, epoch: 10 | loss: 0.0002746
	speed: 0.1053s/iter; left time: 4464.6614s
	iters: 400, epoch: 10 | loss: 0.0000862
	speed: 0.1039s/iter; left time: 4393.4700s
Epoch: 10 cost time: 45.73910999298096
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0757487
	speed: 0.5194s/iter; left time: 21871.6251s
	iters: 200, epoch: 11 | loss: 0.0003130
	speed: 0.1012s/iter; left time: 4250.8892s
	iters: 300, epoch: 11 | loss: 0.0449692
	speed: 0.0998s/iter; left time: 4180.8057s
	iters: 400, epoch: 11 | loss: 0.0031340
	speed: 0.1065s/iter; left time: 4454.9182s
Epoch: 11 cost time: 48.0996880531311
Epoch: 11, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.310 Vali Acc: 0.967 Test Loss: 0.310 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0001397
	speed: 0.5049s/iter; left time: 21024.5265s
	iters: 200, epoch: 12 | loss: 0.0000017
	speed: 0.0962s/iter; left time: 3994.5024s
	iters: 300, epoch: 12 | loss: 0.0004728
	speed: 0.1046s/iter; left time: 4332.8640s
	iters: 400, epoch: 12 | loss: 0.0824571
	speed: 0.1101s/iter; left time: 4553.2458s
Epoch: 12 cost time: 47.70931434631348
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.279 Vali Acc: 0.969 Test Loss: 0.279 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9719839908519153
model parameter : 1238074
model size : 14.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2559216
	speed: 0.1280s/iter; left time: 5990.4873s
	iters: 200, epoch: 1 | loss: 0.3834830
	speed: 0.1076s/iter; left time: 5022.7872s
	iters: 300, epoch: 1 | loss: 0.1129306
	speed: 0.0926s/iter; left time: 4315.2394s
	iters: 400, epoch: 1 | loss: 0.1730829
	speed: 0.0913s/iter; left time: 4245.0880s
Epoch: 1 cost time: 48.484302282333374
Epoch: 1, Steps: 469 | Train Loss: 0.422 Vali Loss: 0.226 Vali Acc: 0.936 Test Loss: 0.226 Test Acc: 0.936
Validation loss decreased (inf --> -0.935675).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0177817
	speed: 0.5068s/iter; left time: 23481.6405s
	iters: 200, epoch: 2 | loss: 0.0121946
	speed: 0.0986s/iter; left time: 4558.8863s
	iters: 300, epoch: 2 | loss: 0.0448838
	speed: 0.0931s/iter; left time: 4293.3816s
	iters: 400, epoch: 2 | loss: 0.0964707
	speed: 0.0941s/iter; left time: 4330.6955s
Epoch: 2 cost time: 45.18264031410217
Epoch: 2, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.5240750
	speed: 0.5001s/iter; left time: 22933.9091s
	iters: 200, epoch: 3 | loss: 0.0024826
	speed: 0.1073s/iter; left time: 4909.3717s
	iters: 300, epoch: 3 | loss: 0.0058284
	speed: 0.0836s/iter; left time: 3819.1382s
	iters: 400, epoch: 3 | loss: 0.0122332
	speed: 0.0653s/iter; left time: 2974.9964s
Epoch: 3 cost time: 39.63626313209534
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.935675 --> -0.943680).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0278780
	speed: 0.4710s/iter; left time: 21380.7339s
	iters: 200, epoch: 4 | loss: 0.0323096
	speed: 0.1051s/iter; left time: 4762.1273s
	iters: 300, epoch: 4 | loss: 0.0484992
	speed: 0.0998s/iter; left time: 4512.5607s
	iters: 400, epoch: 4 | loss: 0.1513115
	speed: 0.0839s/iter; left time: 3785.3137s
Epoch: 4 cost time: 45.752211809158325
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
Validation loss decreased (-0.943680 --> -0.959690).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008724
	speed: 0.5031s/iter; left time: 22600.0559s
	iters: 200, epoch: 5 | loss: 0.0066656
	speed: 0.1144s/iter; left time: 5129.9534s
	iters: 300, epoch: 5 | loss: 0.0295703
	speed: 0.1084s/iter; left time: 4848.9335s
	iters: 400, epoch: 5 | loss: 0.1061478
	speed: 0.0984s/iter; left time: 4389.5872s
Epoch: 5 cost time: 50.45008826255798
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.959690 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0150072
	speed: 0.4961s/iter; left time: 22052.6645s
	iters: 200, epoch: 6 | loss: 0.1434920
	speed: 0.0941s/iter; left time: 4172.7036s
	iters: 300, epoch: 6 | loss: 0.0304109
	speed: 0.1062s/iter; left time: 4700.9409s
	iters: 400, epoch: 6 | loss: 0.0059802
	speed: 0.0978s/iter; left time: 4320.1825s
Epoch: 6 cost time: 45.937339067459106
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0336366
	speed: 0.4942s/iter; left time: 21738.6863s
	iters: 200, epoch: 7 | loss: 0.0009385
	speed: 0.0959s/iter; left time: 4210.8115s
	iters: 300, epoch: 7 | loss: 0.0386219
	speed: 0.0927s/iter; left time: 4058.6628s
	iters: 400, epoch: 7 | loss: 0.0002172
	speed: 0.0907s/iter; left time: 3961.4812s
Epoch: 7 cost time: 45.45137000083923
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0003255
	speed: 0.4171s/iter; left time: 18153.2647s
	iters: 200, epoch: 8 | loss: 0.0041002
	speed: 0.0938s/iter; left time: 4072.8800s
	iters: 300, epoch: 8 | loss: 0.0045648
	speed: 0.1066s/iter; left time: 4618.4770s
	iters: 400, epoch: 8 | loss: 0.0407487
	speed: 0.1140s/iter; left time: 4924.8879s
Epoch: 8 cost time: 45.21230125427246
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0024571
	speed: 0.5076s/iter; left time: 21852.6674s
	iters: 200, epoch: 9 | loss: 0.0005357
	speed: 0.0874s/iter; left time: 3755.0829s
	iters: 300, epoch: 9 | loss: 0.0088404
	speed: 0.1026s/iter; left time: 4395.6734s
	iters: 400, epoch: 9 | loss: 0.0481925
	speed: 0.1013s/iter; left time: 4332.5309s
Epoch: 9 cost time: 46.49238610267639
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0081739
	speed: 0.4997s/iter; left time: 21277.7039s
	iters: 200, epoch: 10 | loss: 0.0047568
	speed: 0.0925s/iter; left time: 3929.0190s
	iters: 300, epoch: 10 | loss: 0.0008086
	speed: 0.1036s/iter; left time: 4390.3723s
	iters: 400, epoch: 10 | loss: 0.0847323
	speed: 0.1074s/iter; left time: 4542.0173s
Epoch: 10 cost time: 47.94026470184326
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0234527
	speed: 0.5409s/iter; left time: 22777.7745s
	iters: 200, epoch: 11 | loss: 0.1907518
	speed: 0.0942s/iter; left time: 3956.3025s
	iters: 300, epoch: 11 | loss: 0.0006671
	speed: 0.1073s/iter; left time: 4496.3813s
	iters: 400, epoch: 11 | loss: 0.0016139
	speed: 0.1116s/iter; left time: 4665.2278s
Epoch: 11 cost time: 49.449007749557495
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0022434
	speed: 0.5237s/iter; left time: 21808.1370s
	iters: 200, epoch: 12 | loss: 0.0080680
	speed: 0.0955s/iter; left time: 3967.7192s
	iters: 300, epoch: 12 | loss: 0.0007373
	speed: 0.0981s/iter; left time: 4064.9789s
	iters: 400, epoch: 12 | loss: 0.2386898
	speed: 0.0857s/iter; left time: 3544.6532s
Epoch: 12 cost time: 43.65265464782715
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0943711
	speed: 0.4840s/iter; left time: 19927.0955s
	iters: 200, epoch: 13 | loss: 0.1010615
	speed: 0.0911s/iter; left time: 3742.0518s
	iters: 300, epoch: 13 | loss: 0.0001301
	speed: 0.0924s/iter; left time: 3784.3432s
	iters: 400, epoch: 13 | loss: 0.0071285
	speed: 0.0994s/iter; left time: 4063.3989s
Epoch: 13 cost time: 45.64299774169922
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0011693
	speed: 0.4958s/iter; left time: 20183.0203s
	iters: 200, epoch: 14 | loss: 0.0002129
	speed: 0.0943s/iter; left time: 3829.2735s
	iters: 300, epoch: 14 | loss: 0.0012073
	speed: 0.0939s/iter; left time: 3801.3516s
	iters: 400, epoch: 14 | loss: 0.0007278
	speed: 0.1063s/iter; left time: 4295.9111s
Epoch: 14 cost time: 45.75377058982849
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0170480
	speed: 0.5052s/iter; left time: 20327.5336s
	iters: 200, epoch: 15 | loss: 0.0143324
	speed: 0.0906s/iter; left time: 3636.9551s
	iters: 300, epoch: 15 | loss: 0.0009870
	speed: 0.0927s/iter; left time: 3709.5271s
	iters: 400, epoch: 15 | loss: 0.0012203
	speed: 0.1015s/iter; left time: 4051.6149s
Epoch: 15 cost time: 44.089386224746704
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0011918
	speed: 0.5286s/iter; left time: 21021.7935s
	iters: 200, epoch: 16 | loss: 0.0000612
	speed: 0.0955s/iter; left time: 3788.4697s
	iters: 300, epoch: 16 | loss: 0.0085699
	speed: 0.0789s/iter; left time: 3123.1027s
	iters: 400, epoch: 16 | loss: 0.0115459
	speed: 0.0690s/iter; left time: 2723.1446s
Epoch: 16 cost time: 40.02727770805359
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0025502
	speed: 0.5146s/iter; left time: 20221.5774s
	iters: 200, epoch: 17 | loss: 0.1651350
	speed: 0.1032s/iter; left time: 4043.1737s
	iters: 300, epoch: 17 | loss: 0.0043022
	speed: 0.1011s/iter; left time: 3951.9212s
	iters: 400, epoch: 17 | loss: 0.0006195
	speed: 0.0913s/iter; left time: 3558.9588s
Epoch: 17 cost time: 46.14697456359863
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0035530
	speed: 0.5043s/iter; left time: 19579.5259s
	iters: 200, epoch: 18 | loss: 0.0022764
	speed: 0.0898s/iter; left time: 3479.5254s
	iters: 300, epoch: 18 | loss: 0.0001982
	speed: 0.0917s/iter; left time: 3540.8485s
	iters: 400, epoch: 18 | loss: 0.0119746
	speed: 0.0966s/iter; left time: 3722.1666s
Epoch: 18 cost time: 43.883737087249756
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000437
	speed: 0.5007s/iter; left time: 19207.6202s
	iters: 200, epoch: 19 | loss: 0.0006505
	speed: 0.0981s/iter; left time: 3753.5945s
	iters: 300, epoch: 19 | loss: 0.0478076
	speed: 0.0885s/iter; left time: 3376.5707s
	iters: 400, epoch: 19 | loss: 0.0007161
	speed: 0.0910s/iter; left time: 3464.2435s
Epoch: 19 cost time: 43.21139430999756
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
Validation loss decreased (-0.979130 --> -0.984276).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001856
	speed: 0.4986s/iter; left time: 18890.3561s
	iters: 200, epoch: 20 | loss: 0.2681299
	speed: 0.0874s/iter; left time: 3303.2504s
	iters: 300, epoch: 20 | loss: 0.0015882
	speed: 0.0950s/iter; left time: 3579.9088s
	iters: 400, epoch: 20 | loss: 0.0077735
	speed: 0.0937s/iter; left time: 3522.0055s
Epoch: 20 cost time: 43.769378900527954
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0399392
	speed: 0.4081s/iter; left time: 15272.6370s
	iters: 200, epoch: 21 | loss: 0.0713399
	speed: 0.0843s/iter; left time: 3146.9119s
	iters: 300, epoch: 21 | loss: 0.0001559
	speed: 0.0963s/iter; left time: 3585.4204s
	iters: 400, epoch: 21 | loss: 0.0022365
	speed: 0.0951s/iter; left time: 3530.2688s
Epoch: 21 cost time: 41.0237250328064
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0008874
	speed: 0.4846s/iter; left time: 17906.6034s
	iters: 200, epoch: 22 | loss: 0.0001880
	speed: 0.0991s/iter; left time: 3650.6225s
	iters: 300, epoch: 22 | loss: 0.0014425
	speed: 0.0997s/iter; left time: 3663.7437s
	iters: 400, epoch: 22 | loss: 0.0000087
	speed: 0.0984s/iter; left time: 3607.9388s
Epoch: 22 cost time: 45.785382986068726
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0016631
	speed: 0.4797s/iter; left time: 17502.0548s
	iters: 200, epoch: 23 | loss: 0.0419581
	speed: 0.0898s/iter; left time: 3265.6276s
	iters: 300, epoch: 23 | loss: 0.0033995
	speed: 0.0920s/iter; left time: 3336.9863s
	iters: 400, epoch: 23 | loss: 0.0738337
	speed: 0.0934s/iter; left time: 3381.2002s
Epoch: 23 cost time: 42.87334752082825
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0079110
	speed: 0.4737s/iter; left time: 17058.2832s
	iters: 200, epoch: 24 | loss: 0.0001827
	speed: 0.1030s/iter; left time: 3697.6047s
	iters: 300, epoch: 24 | loss: 0.0005140
	speed: 0.0943s/iter; left time: 3377.7024s
	iters: 400, epoch: 24 | loss: 0.0002016
	speed: 0.0713s/iter; left time: 2547.6990s
Epoch: 24 cost time: 40.59207725524902
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.965 Test Loss: 0.186 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000182
	speed: 0.4533s/iter; left time: 16113.3881s
	iters: 200, epoch: 25 | loss: 0.0036407
	speed: 0.1042s/iter; left time: 3693.7387s
	iters: 300, epoch: 25 | loss: 0.0027582
	speed: 0.1021s/iter; left time: 3607.7944s
	iters: 400, epoch: 25 | loss: 0.0364603
	speed: 0.1008s/iter; left time: 3553.2776s
Epoch: 25 cost time: 46.97184419631958
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0009091
	speed: 0.4670s/iter; left time: 16381.9762s
	iters: 200, epoch: 26 | loss: 0.0075677
	speed: 0.0945s/iter; left time: 3306.2895s
	iters: 300, epoch: 26 | loss: 0.0008063
	speed: 0.0900s/iter; left time: 3138.0205s
	iters: 400, epoch: 26 | loss: 0.0004042
	speed: 0.0783s/iter; left time: 2721.7996s
Epoch: 26 cost time: 43.06520318984985
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0001812
	speed: 0.4752s/iter; left time: 16445.6617s
	iters: 200, epoch: 27 | loss: 0.0036237
	speed: 0.0809s/iter; left time: 2792.0029s
	iters: 300, epoch: 27 | loss: 0.0000122
	speed: 0.0748s/iter; left time: 2574.5487s
	iters: 400, epoch: 27 | loss: 0.0012937
	speed: 0.0910s/iter; left time: 3120.5020s
Epoch: 27 cost time: 40.4805064201355
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0013406
	speed: 0.4779s/iter; left time: 16313.7176s
	iters: 200, epoch: 28 | loss: 0.0001466
	speed: 0.1030s/iter; left time: 3506.6106s
	iters: 300, epoch: 28 | loss: 0.0003257
	speed: 0.1017s/iter; left time: 3450.7138s
	iters: 400, epoch: 28 | loss: 0.0000983
	speed: 0.0866s/iter; left time: 2931.3671s
Epoch: 28 cost time: 46.907941818237305
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0005522
	speed: 0.4835s/iter; left time: 16280.2552s
	iters: 200, epoch: 29 | loss: 0.0228637
	speed: 0.0999s/iter; left time: 3354.2928s
	iters: 300, epoch: 29 | loss: 0.0000777
	speed: 0.1004s/iter; left time: 3360.2181s
	iters: 400, epoch: 29 | loss: 0.0001337
	speed: 0.0782s/iter; left time: 2610.2430s
Epoch: 29 cost time: 43.85966873168945
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 2388538
model size : 14.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2307080
	speed: 0.0906s/iter; left time: 4238.8981s
	iters: 200, epoch: 1 | loss: 0.3667161
	speed: 0.0837s/iter; left time: 3908.5715s
	iters: 300, epoch: 1 | loss: 0.0958621
	speed: 0.0837s/iter; left time: 3900.7044s
	iters: 400, epoch: 1 | loss: 0.1760766
	speed: 0.0798s/iter; left time: 3711.3609s
Epoch: 1 cost time: 39.08383822441101
Epoch: 1, Steps: 469 | Train Loss: 0.393 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0063478
	speed: 0.4345s/iter; left time: 20129.3367s
	iters: 200, epoch: 2 | loss: 0.0124358
	speed: 0.0831s/iter; left time: 3842.2358s
	iters: 300, epoch: 2 | loss: 0.0179197
	speed: 0.0805s/iter; left time: 3713.6571s
	iters: 400, epoch: 2 | loss: 0.0765402
	speed: 0.0795s/iter; left time: 3658.6615s
Epoch: 2 cost time: 38.880202531814575
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.951685 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7283625
	speed: 0.4841s/iter; left time: 22202.9698s
	iters: 200, epoch: 3 | loss: 0.0014258
	speed: 0.0811s/iter; left time: 3710.3425s
	iters: 300, epoch: 3 | loss: 0.0040655
	speed: 0.0846s/iter; left time: 3864.6337s
	iters: 400, epoch: 3 | loss: 0.0090358
	speed: 0.0929s/iter; left time: 4233.0325s
Epoch: 3 cost time: 40.986629247665405
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0212750
	speed: 0.4914s/iter; left time: 22305.3587s
	iters: 200, epoch: 4 | loss: 0.0153788
	speed: 0.0898s/iter; left time: 4067.4982s
	iters: 300, epoch: 4 | loss: 0.0048364
	speed: 0.0761s/iter; left time: 3437.4907s
	iters: 400, epoch: 4 | loss: 0.1084633
	speed: 0.0653s/iter; left time: 2946.8915s
Epoch: 4 cost time: 37.03526425361633
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0008666
	speed: 0.4405s/iter; left time: 19789.9544s
	iters: 200, epoch: 5 | loss: 0.0040942
	speed: 0.0834s/iter; left time: 3739.4552s
	iters: 300, epoch: 5 | loss: 0.0035223
	speed: 0.0893s/iter; left time: 3993.1816s
	iters: 400, epoch: 5 | loss: 0.0462340
	speed: 0.0833s/iter; left time: 3717.5613s
Epoch: 5 cost time: 40.48694467544556
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0031344
	speed: 0.4634s/iter; left time: 20602.9531s
	iters: 200, epoch: 6 | loss: 0.3056819
	speed: 0.0817s/iter; left time: 3624.3507s
	iters: 300, epoch: 6 | loss: 0.0014978
	speed: 0.0741s/iter; left time: 3279.5693s
	iters: 400, epoch: 6 | loss: 0.0055203
	speed: 0.0851s/iter; left time: 3759.7931s
Epoch: 6 cost time: 38.78688597679138
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0410377
	speed: 0.4791s/iter; left time: 21073.5582s
	iters: 200, epoch: 7 | loss: 0.0148824
	speed: 0.0795s/iter; left time: 3487.0833s
	iters: 300, epoch: 7 | loss: 0.0459699
	speed: 0.0800s/iter; left time: 3500.9559s
	iters: 400, epoch: 7 | loss: 0.0001974
	speed: 0.0769s/iter; left time: 3359.7478s
Epoch: 7 cost time: 37.89844107627869
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.957974 --> -0.969696).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0005636
	speed: 0.4419s/iter; left time: 19229.0264s
	iters: 200, epoch: 8 | loss: 0.0012784
	speed: 0.0639s/iter; left time: 2775.7569s
	iters: 300, epoch: 8 | loss: 0.2105331
	speed: 0.0798s/iter; left time: 3457.5026s
	iters: 400, epoch: 8 | loss: 0.0071926
	speed: 0.0888s/iter; left time: 3839.4402s
Epoch: 8 cost time: 35.95840287208557
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0048076
	speed: 0.4757s/iter; left time: 20478.3905s
	iters: 200, epoch: 9 | loss: 0.0096073
	speed: 0.0893s/iter; left time: 3834.1731s
	iters: 300, epoch: 9 | loss: 0.0024818
	speed: 0.0848s/iter; left time: 3634.4667s
	iters: 400, epoch: 9 | loss: 0.0341047
	speed: 0.0897s/iter; left time: 3835.5308s
Epoch: 9 cost time: 41.992393493652344
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0139924
	speed: 0.4792s/iter; left time: 20405.3987s
	iters: 200, epoch: 10 | loss: 0.0042374
	speed: 0.0857s/iter; left time: 3641.4507s
	iters: 300, epoch: 10 | loss: 0.0108355
	speed: 0.0898s/iter; left time: 3803.8552s
	iters: 400, epoch: 10 | loss: 0.0086596
	speed: 0.0879s/iter; left time: 3718.3972s
Epoch: 10 cost time: 40.535428047180176
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0007441
	speed: 0.4341s/iter; left time: 18282.3262s
	iters: 200, epoch: 11 | loss: 0.6406540
	speed: 0.0822s/iter; left time: 3451.7457s
	iters: 300, epoch: 11 | loss: 0.0004580
	speed: 0.0869s/iter; left time: 3643.4576s
	iters: 400, epoch: 11 | loss: 0.0704320
	speed: 0.0857s/iter; left time: 3581.2308s
Epoch: 11 cost time: 39.194422483444214
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
Validation loss decreased (-0.969696 --> -0.974270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0015296
	speed: 0.4429s/iter; left time: 18442.9222s
	iters: 200, epoch: 12 | loss: 0.0002696
	speed: 0.0835s/iter; left time: 3468.4734s
	iters: 300, epoch: 12 | loss: 0.0000460
	speed: 0.0788s/iter; left time: 3265.2118s
	iters: 400, epoch: 12 | loss: 0.0085232
	speed: 0.0859s/iter; left time: 3551.6749s
Epoch: 12 cost time: 39.63794732093811
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0548993
	speed: 0.4535s/iter; left time: 18672.9042s
	iters: 200, epoch: 13 | loss: 0.1944159
	speed: 0.0832s/iter; left time: 3419.0848s
	iters: 300, epoch: 13 | loss: 0.0017957
	speed: 0.0809s/iter; left time: 3314.3375s
	iters: 400, epoch: 13 | loss: 0.0203170
	speed: 0.0747s/iter; left time: 3054.3459s
Epoch: 13 cost time: 38.87670874595642
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.974841).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0711455
	speed: 0.4709s/iter; left time: 19167.0366s
	iters: 200, epoch: 14 | loss: 0.0022160
	speed: 0.0833s/iter; left time: 3383.0616s
	iters: 300, epoch: 14 | loss: 0.0004281
	speed: 0.0844s/iter; left time: 3418.5431s
	iters: 400, epoch: 14 | loss: 0.0016918
	speed: 0.0775s/iter; left time: 3132.6891s
Epoch: 14 cost time: 37.823957681655884
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.1402692
	speed: 0.4089s/iter; left time: 16453.2197s
	iters: 200, epoch: 15 | loss: 0.0027377
	speed: 0.0879s/iter; left time: 3526.3511s
	iters: 300, epoch: 15 | loss: 0.0040630
	speed: 0.0849s/iter; left time: 3398.6798s
	iters: 400, epoch: 15 | loss: 0.0370853
	speed: 0.0861s/iter; left time: 3438.9684s
Epoch: 15 cost time: 42.17159366607666
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.974841 --> -0.977129).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0282647
	speed: 0.4583s/iter; left time: 18225.2274s
	iters: 200, epoch: 16 | loss: 0.0001033
	speed: 0.0880s/iter; left time: 3490.6685s
	iters: 300, epoch: 16 | loss: 0.0022545
	speed: 0.0871s/iter; left time: 3447.3024s
	iters: 400, epoch: 16 | loss: 0.0156620
	speed: 0.0854s/iter; left time: 3369.4678s
Epoch: 16 cost time: 41.384429693222046
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000234
	speed: 0.4609s/iter; left time: 18111.6272s
	iters: 200, epoch: 17 | loss: 0.0273549
	speed: 0.0580s/iter; left time: 2275.2747s
	iters: 300, epoch: 17 | loss: 0.0046667
	speed: 0.0580s/iter; left time: 2267.3233s
	iters: 400, epoch: 17 | loss: 0.0000907
	speed: 0.0689s/iter; left time: 2685.4220s
Epoch: 17 cost time: 32.42569851875305
Epoch: 17, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0008356
	speed: 0.4343s/iter; left time: 16864.7275s
	iters: 200, epoch: 18 | loss: 0.0171835
	speed: 0.0839s/iter; left time: 3247.4679s
	iters: 300, epoch: 18 | loss: 0.0025034
	speed: 0.0822s/iter; left time: 3176.4749s
	iters: 400, epoch: 18 | loss: 0.0007120
	speed: 0.0833s/iter; left time: 3209.9885s
Epoch: 18 cost time: 39.06783747673035
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0029316
	speed: 0.4349s/iter; left time: 16683.0604s
	iters: 200, epoch: 19 | loss: 0.0063724
	speed: 0.0872s/iter; left time: 3338.0496s
	iters: 300, epoch: 19 | loss: 0.0041326
	speed: 0.0837s/iter; left time: 3194.7272s
	iters: 400, epoch: 19 | loss: 0.0215063
	speed: 0.0794s/iter; left time: 3021.7945s
Epoch: 19 cost time: 40.2051215171814
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.977129 --> -0.981131).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0038900
	speed: 0.4067s/iter; left time: 15410.9376s
	iters: 200, epoch: 20 | loss: 0.0151764
	speed: 0.0830s/iter; left time: 3136.5071s
	iters: 300, epoch: 20 | loss: 0.0007910
	speed: 0.0805s/iter; left time: 3033.4803s
	iters: 400, epoch: 20 | loss: 0.2834358
	speed: 0.0740s/iter; left time: 2780.4406s
Epoch: 20 cost time: 37.77761197090149
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1134814
	speed: 0.4217s/iter; left time: 15782.3058s
	iters: 200, epoch: 21 | loss: 0.0003705
	speed: 0.0738s/iter; left time: 2752.8646s
	iters: 300, epoch: 21 | loss: 0.0091943
	speed: 0.0736s/iter; left time: 2739.9539s
	iters: 400, epoch: 21 | loss: 0.0035097
	speed: 0.0887s/iter; left time: 3291.8549s
Epoch: 21 cost time: 38.58486557006836
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0003704
	speed: 0.4540s/iter; left time: 16774.8985s
	iters: 200, epoch: 22 | loss: 0.0021934
	speed: 0.0989s/iter; left time: 3645.6505s
	iters: 300, epoch: 22 | loss: 0.0000865
	speed: 0.0978s/iter; left time: 3593.7044s
	iters: 400, epoch: 22 | loss: 0.4510726
	speed: 0.0890s/iter; left time: 3261.2401s
Epoch: 22 cost time: 43.8664813041687
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0026384
	speed: 0.4601s/iter; left time: 16787.4994s
	iters: 200, epoch: 23 | loss: 0.0384634
	speed: 0.0874s/iter; left time: 3180.6552s
	iters: 300, epoch: 23 | loss: 0.0000497
	speed: 0.0694s/iter; left time: 2516.9652s
	iters: 400, epoch: 23 | loss: 0.2108039
	speed: 0.0619s/iter; left time: 2241.2658s
Epoch: 23 cost time: 35.56536149978638
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0016786
	speed: 0.4178s/iter; left time: 15045.0085s
	iters: 200, epoch: 24 | loss: 0.0015546
	speed: 0.0878s/iter; left time: 3154.3372s
	iters: 300, epoch: 24 | loss: 0.0000107
	speed: 0.0930s/iter; left time: 3331.0727s
	iters: 400, epoch: 24 | loss: 0.0004272
	speed: 0.0894s/iter; left time: 3193.5988s
Epoch: 24 cost time: 41.46517372131348
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000037
	speed: 0.4320s/iter; left time: 15357.2043s
	iters: 200, epoch: 25 | loss: 0.0011343
	speed: 0.0813s/iter; left time: 2883.0691s
	iters: 300, epoch: 25 | loss: 0.0290599
	speed: 0.0768s/iter; left time: 2713.9394s
	iters: 400, epoch: 25 | loss: 0.0000576
	speed: 0.0478s/iter; left time: 1684.1397s
Epoch: 25 cost time: 32.547117471694946
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0019930
	speed: 0.3822s/iter; left time: 13406.5058s
	iters: 200, epoch: 26 | loss: 0.0020583
	speed: 0.0705s/iter; left time: 2464.2594s
	iters: 300, epoch: 26 | loss: 0.1080536
	speed: 0.0773s/iter; left time: 2694.5228s
	iters: 400, epoch: 26 | loss: 0.0004059
	speed: 0.0757s/iter; left time: 2631.9218s
Epoch: 26 cost time: 36.806074380874634
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0116029
	speed: 0.4535s/iter; left time: 15695.3732s
	iters: 200, epoch: 27 | loss: 0.0064207
	speed: 0.0869s/iter; left time: 2999.3047s
	iters: 300, epoch: 27 | loss: 0.0146285
	speed: 0.0843s/iter; left time: 2898.8446s
	iters: 400, epoch: 27 | loss: 0.0002222
	speed: 0.0738s/iter; left time: 2532.5957s
Epoch: 27 cost time: 38.33039379119873
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0004692
	speed: 0.4012s/iter; left time: 13697.8371s
	iters: 200, epoch: 28 | loss: 0.0000362
	speed: 0.0795s/iter; left time: 2704.4445s
	iters: 300, epoch: 28 | loss: 0.0005681
	speed: 0.0785s/iter; left time: 2664.9375s
	iters: 400, epoch: 28 | loss: 0.0009815
	speed: 0.0790s/iter; left time: 2673.4482s
Epoch: 28 cost time: 38.38238763809204
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0043400
	speed: 0.4187s/iter; left time: 14097.2352s
	iters: 200, epoch: 29 | loss: 0.0054677
	speed: 0.0761s/iter; left time: 2553.1719s
	iters: 300, epoch: 29 | loss: 0.0002493
	speed: 0.0704s/iter; left time: 2354.6305s
	iters: 400, epoch: 29 | loss: 0.0000219
	speed: 0.0717s/iter; left time: 2393.9334s
Epoch: 29 cost time: 34.887428522109985
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 2388538
model size : 14.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1951392
	speed: 0.0931s/iter; left time: 4355.1341s
	iters: 200, epoch: 1 | loss: 0.3138204
	speed: 0.0716s/iter; left time: 3342.6829s
	iters: 300, epoch: 1 | loss: 0.0529990
	speed: 0.0681s/iter; left time: 3172.1215s
	iters: 400, epoch: 1 | loss: 0.1901215
	speed: 0.0723s/iter; left time: 3360.7261s
Epoch: 1 cost time: 36.23862314224243
Epoch: 1, Steps: 469 | Train Loss: 0.376 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
Validation loss decreased (inf --> -0.959975).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0119607
	speed: 0.3895s/iter; left time: 18045.3033s
	iters: 200, epoch: 2 | loss: 0.0188813
	speed: 0.0545s/iter; left time: 2518.9431s
	iters: 300, epoch: 2 | loss: 0.0089826
	speed: 0.0497s/iter; left time: 2294.5560s
	iters: 400, epoch: 2 | loss: 0.0728905
	speed: 0.0517s/iter; left time: 2378.8345s
Epoch: 2 cost time: 26.29070520401001
Epoch: 2, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.959975 --> -0.964836).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6478905
	speed: 0.4505s/iter; left time: 20659.9383s
	iters: 200, epoch: 3 | loss: 0.0009195
	speed: 0.0743s/iter; left time: 3401.4012s
	iters: 300, epoch: 3 | loss: 0.0129889
	speed: 0.0716s/iter; left time: 3271.5220s
	iters: 400, epoch: 3 | loss: 0.0036251
	speed: 0.0752s/iter; left time: 3425.2489s
Epoch: 3 cost time: 37.685224533081055
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.964836 --> -0.971125).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008194
	speed: 0.4602s/iter; left time: 20889.0454s
	iters: 200, epoch: 4 | loss: 0.0099882
	speed: 0.0787s/iter; left time: 3564.1084s
	iters: 300, epoch: 4 | loss: 0.0004525
	speed: 0.0806s/iter; left time: 3641.0247s
	iters: 400, epoch: 4 | loss: 0.0021886
	speed: 0.0877s/iter; left time: 3956.1303s
Epoch: 4 cost time: 38.8573272228241
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0003628
	speed: 0.4658s/iter; left time: 20927.6834s
	iters: 200, epoch: 5 | loss: 0.0025336
	speed: 0.0845s/iter; left time: 3789.2922s
	iters: 300, epoch: 5 | loss: 0.0041765
	speed: 0.0825s/iter; left time: 3689.6416s
	iters: 400, epoch: 5 | loss: 0.0030368
	speed: 0.0793s/iter; left time: 3536.6825s
Epoch: 5 cost time: 39.68572640419006
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0019725
	speed: 0.4653s/iter; left time: 20683.2457s
	iters: 200, epoch: 6 | loss: 0.0094837
	speed: 0.0723s/iter; left time: 3207.9053s
	iters: 300, epoch: 6 | loss: 0.0002645
	speed: 0.0618s/iter; left time: 2734.7806s
	iters: 400, epoch: 6 | loss: 0.0012124
	speed: 0.0578s/iter; left time: 2553.0349s
Epoch: 6 cost time: 31.981773138046265
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0072884
	speed: 0.4469s/iter; left time: 19656.5340s
	iters: 200, epoch: 7 | loss: 0.0001977
	speed: 0.0820s/iter; left time: 3600.7361s
	iters: 300, epoch: 7 | loss: 0.0534153
	speed: 0.0768s/iter; left time: 3363.0610s
	iters: 400, epoch: 7 | loss: 0.0016063
	speed: 0.0734s/iter; left time: 3205.8687s
Epoch: 7 cost time: 37.79923105239868
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.966 Test Loss: 0.166 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000134
	speed: 0.4396s/iter; left time: 19132.1490s
	iters: 200, epoch: 8 | loss: 0.1836101
	speed: 0.0762s/iter; left time: 3307.3274s
	iters: 300, epoch: 8 | loss: 0.0027003
	speed: 0.0708s/iter; left time: 3067.9414s
	iters: 400, epoch: 8 | loss: 0.0040400
	speed: 0.0805s/iter; left time: 3478.6392s
Epoch: 8 cost time: 36.78266668319702
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000800
	speed: 0.4449s/iter; left time: 19151.1268s
	iters: 200, epoch: 9 | loss: 0.0000651
	speed: 0.0801s/iter; left time: 3439.6829s
	iters: 300, epoch: 9 | loss: 0.0011787
	speed: 0.0755s/iter; left time: 3236.7784s
	iters: 400, epoch: 9 | loss: 0.0073845
	speed: 0.0657s/iter; left time: 2807.4056s
Epoch: 9 cost time: 34.70125341415405
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000686
	speed: 0.4190s/iter; left time: 17840.0666s
	iters: 200, epoch: 10 | loss: 0.0355305
	speed: 0.0822s/iter; left time: 3492.0283s
	iters: 300, epoch: 10 | loss: 0.0000613
	speed: 0.0765s/iter; left time: 3242.3459s
	iters: 400, epoch: 10 | loss: 0.1254012
	speed: 0.0831s/iter; left time: 3512.6185s
Epoch: 10 cost time: 37.875017166137695
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1262729
	speed: 0.4534s/iter; left time: 19093.5987s
	iters: 200, epoch: 11 | loss: 0.6067539
	speed: 0.0771s/iter; left time: 3237.2919s
	iters: 300, epoch: 11 | loss: 0.0009518
	speed: 0.0790s/iter; left time: 3312.5346s
	iters: 400, epoch: 11 | loss: 0.0012735
	speed: 0.0584s/iter; left time: 2443.0823s
Epoch: 11 cost time: 34.00279784202576
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.984 Test Loss: 0.103 Test Acc: 0.984
Validation loss decreased (-0.975413 --> -0.983990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006016
	speed: 0.4132s/iter; left time: 17206.0036s
	iters: 200, epoch: 12 | loss: 0.0050348
	speed: 0.0767s/iter; left time: 3185.0561s
	iters: 300, epoch: 12 | loss: 0.0000960
	speed: 0.0768s/iter; left time: 3182.0947s
	iters: 400, epoch: 12 | loss: 0.0005851
	speed: 0.0702s/iter; left time: 2902.5216s
Epoch: 12 cost time: 36.229706048965454
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0009531
	speed: 0.4138s/iter; left time: 17038.5630s
	iters: 200, epoch: 13 | loss: 0.0020868
	speed: 0.0796s/iter; left time: 3270.2617s
	iters: 300, epoch: 13 | loss: 0.0001112
	speed: 0.0680s/iter; left time: 2785.6051s
	iters: 400, epoch: 13 | loss: 0.0041385
	speed: 0.0574s/iter; left time: 2346.3667s
Epoch: 13 cost time: 32.80531692504883
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001693
	speed: 0.4519s/iter; left time: 18394.6831s
	iters: 200, epoch: 14 | loss: 0.0013440
	speed: 0.0802s/iter; left time: 3256.3113s
	iters: 300, epoch: 14 | loss: 0.1991216
	speed: 0.0785s/iter; left time: 3179.7208s
	iters: 400, epoch: 14 | loss: 0.0000465
	speed: 0.0792s/iter; left time: 3200.7167s
Epoch: 14 cost time: 39.25677037239075
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0640902
	speed: 0.4845s/iter; left time: 19494.8607s
	iters: 200, epoch: 15 | loss: 0.0000275
	speed: 0.0722s/iter; left time: 2895.7659s
	iters: 300, epoch: 15 | loss: 0.0004970
	speed: 0.0753s/iter; left time: 3014.0932s
	iters: 400, epoch: 15 | loss: 0.0000624
	speed: 0.0774s/iter; left time: 3089.2633s
Epoch: 15 cost time: 37.23448872566223
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0380309
	speed: 0.4524s/iter; left time: 17992.0128s
	iters: 200, epoch: 16 | loss: 0.0000554
	speed: 0.0822s/iter; left time: 3259.9244s
	iters: 300, epoch: 16 | loss: 0.0056605
	speed: 0.0795s/iter; left time: 3143.6143s
	iters: 400, epoch: 16 | loss: 0.0000760
	speed: 0.0764s/iter; left time: 3014.6848s
Epoch: 16 cost time: 38.045926570892334
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000012
	speed: 0.4588s/iter; left time: 18028.3691s
	iters: 200, epoch: 17 | loss: 0.0671724
	speed: 0.0938s/iter; left time: 3675.8977s
	iters: 300, epoch: 17 | loss: 0.0473972
	speed: 0.0858s/iter; left time: 3353.1367s
	iters: 400, epoch: 17 | loss: 0.0000432
	speed: 0.0844s/iter; left time: 3292.7253s
Epoch: 17 cost time: 42.805859327316284
Epoch: 17, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0183482
	speed: 0.4824s/iter; left time: 18728.9204s
	iters: 200, epoch: 18 | loss: 0.0024137
	speed: 0.0733s/iter; left time: 2839.0458s
	iters: 300, epoch: 18 | loss: 0.0002520
	speed: 0.0661s/iter; left time: 2554.7213s
	iters: 400, epoch: 18 | loss: 0.3422716
	speed: 0.0724s/iter; left time: 2790.2923s
Epoch: 18 cost time: 37.45823121070862
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.982 Test Loss: 0.135 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0001703
	speed: 0.4921s/iter; left time: 18877.1386s
	iters: 200, epoch: 19 | loss: 0.0018100
	speed: 0.0999s/iter; left time: 3820.5095s
	iters: 300, epoch: 19 | loss: 0.0105803
	speed: 0.0844s/iter; left time: 3221.9726s
	iters: 400, epoch: 19 | loss: 0.0005202
	speed: 0.0799s/iter; left time: 3042.1148s
Epoch: 19 cost time: 41.3489305973053
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000242
	speed: 0.4352s/iter; left time: 16490.9668s
	iters: 200, epoch: 20 | loss: 0.2655308
	speed: 0.0907s/iter; left time: 3427.3899s
	iters: 300, epoch: 20 | loss: 0.0004039
	speed: 0.0841s/iter; left time: 3171.0751s
	iters: 400, epoch: 20 | loss: 0.0006858
	speed: 0.0853s/iter; left time: 3207.8332s
Epoch: 20 cost time: 41.19594049453735
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0011050
	speed: 0.4682s/iter; left time: 17518.7804s
	iters: 200, epoch: 21 | loss: 0.0236543
	speed: 0.0850s/iter; left time: 3170.7518s
	iters: 300, epoch: 21 | loss: 0.0000057
	speed: 0.0818s/iter; left time: 3043.4934s
	iters: 400, epoch: 21 | loss: 0.0125712
	speed: 0.0801s/iter; left time: 2974.6146s
Epoch: 21 cost time: 39.57853388786316
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.971 Test Loss: 0.194 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 2388538
model size : 14.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2593693
	speed: 0.0693s/iter; left time: 3241.0691s
	iters: 200, epoch: 1 | loss: 0.1458694
	speed: 0.0419s/iter; left time: 1954.9292s
	iters: 300, epoch: 1 | loss: 0.1233845
	speed: 0.0430s/iter; left time: 2003.5321s
	iters: 400, epoch: 1 | loss: 0.1116833
	speed: 0.0391s/iter; left time: 1819.7123s
Epoch: 1 cost time: 22.29450559616089
Epoch: 1, Steps: 469 | Train Loss: 0.450 Vali Loss: 0.274 Vali Acc: 0.928 Test Loss: 0.274 Test Acc: 0.928
Validation loss decreased (inf --> -0.927670).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0535914
	speed: 0.2371s/iter; left time: 10985.3551s
	iters: 200, epoch: 2 | loss: 0.2050032
	speed: 0.0428s/iter; left time: 1980.8766s
	iters: 300, epoch: 2 | loss: 0.0884386
	speed: 0.0393s/iter; left time: 1812.8950s
	iters: 400, epoch: 2 | loss: 0.0392578
	speed: 0.0464s/iter; left time: 2135.4448s
Epoch: 2 cost time: 20.32331943511963
Epoch: 2, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.210 Vali Acc: 0.947 Test Loss: 0.210 Test Acc: 0.947
Validation loss decreased (-0.927670 --> -0.947111).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0166894
	speed: 0.2443s/iter; left time: 11205.5682s
	iters: 200, epoch: 3 | loss: 0.0062060
	speed: 0.0466s/iter; left time: 2131.6006s
	iters: 300, epoch: 3 | loss: 0.0053290
	speed: 0.0454s/iter; left time: 2074.3941s
	iters: 400, epoch: 3 | loss: 0.0441127
	speed: 0.0456s/iter; left time: 2077.0367s
Epoch: 3 cost time: 21.93918490409851
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.947111 --> -0.947682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0232141
	speed: 0.2585s/iter; left time: 11733.4180s
	iters: 200, epoch: 4 | loss: 0.0083654
	speed: 0.0437s/iter; left time: 1979.9127s
	iters: 300, epoch: 4 | loss: 0.0238976
	speed: 0.0440s/iter; left time: 1990.1841s
	iters: 400, epoch: 4 | loss: 0.0453535
	speed: 0.0430s/iter; left time: 1939.0140s
Epoch: 4 cost time: 20.843764781951904
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
Validation loss decreased (-0.947682 --> -0.971411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0008012
	speed: 0.2335s/iter; left time: 10489.5601s
	iters: 200, epoch: 5 | loss: 0.0031734
	speed: 0.0403s/iter; left time: 1804.4462s
	iters: 300, epoch: 5 | loss: 0.0096951
	speed: 0.0436s/iter; left time: 1949.8526s
	iters: 400, epoch: 5 | loss: 0.0255293
	speed: 0.0421s/iter; left time: 1878.2136s
Epoch: 5 cost time: 20.310600757598877
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0543079
	speed: 0.2365s/iter; left time: 10514.4780s
	iters: 200, epoch: 6 | loss: 0.0296419
	speed: 0.0417s/iter; left time: 1848.0810s
	iters: 300, epoch: 6 | loss: 0.0020243
	speed: 0.0394s/iter; left time: 1743.7203s
	iters: 400, epoch: 6 | loss: 0.0032737
	speed: 0.0409s/iter; left time: 1806.1612s
Epoch: 6 cost time: 19.803896188735962
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0018986
	speed: 0.2133s/iter; left time: 9384.4370s
	iters: 200, epoch: 7 | loss: 0.0084829
	speed: 0.0447s/iter; left time: 1960.3276s
	iters: 300, epoch: 7 | loss: 0.2037117
	speed: 0.0435s/iter; left time: 1902.9131s
	iters: 400, epoch: 7 | loss: 0.1577155
	speed: 0.0398s/iter; left time: 1738.2825s
Epoch: 7 cost time: 20.628814697265625
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0299546
	speed: 0.2393s/iter; left time: 10413.7095s
	iters: 200, epoch: 8 | loss: 0.0215602
	speed: 0.0411s/iter; left time: 1786.5859s
	iters: 300, epoch: 8 | loss: 0.0043141
	speed: 0.0415s/iter; left time: 1797.6619s
	iters: 400, epoch: 8 | loss: 0.0076917
	speed: 0.0391s/iter; left time: 1691.4068s
Epoch: 8 cost time: 19.876593112945557
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0148833
	speed: 0.2392s/iter; left time: 10298.4916s
	iters: 200, epoch: 9 | loss: 0.0210092
	speed: 0.0416s/iter; left time: 1787.8092s
	iters: 300, epoch: 9 | loss: 0.1262139
	speed: 0.0425s/iter; left time: 1819.0105s
	iters: 400, epoch: 9 | loss: 0.0726739
	speed: 0.0440s/iter; left time: 1880.1209s
Epoch: 9 cost time: 20.599573612213135
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0040978
	speed: 0.2454s/iter; left time: 10448.4918s
	iters: 200, epoch: 10 | loss: 0.0281737
	speed: 0.0414s/iter; left time: 1758.8051s
	iters: 300, epoch: 10 | loss: 0.0010915
	speed: 0.0428s/iter; left time: 1812.8675s
	iters: 400, epoch: 10 | loss: 0.0241582
	speed: 0.0452s/iter; left time: 1912.0342s
Epoch: 10 cost time: 20.94406223297119
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0383733
	speed: 0.2406s/iter; left time: 10130.2128s
	iters: 200, epoch: 11 | loss: 0.1253149
	speed: 0.0414s/iter; left time: 1737.7309s
	iters: 300, epoch: 11 | loss: 0.0044965
	speed: 0.0384s/iter; left time: 1610.0650s
	iters: 400, epoch: 11 | loss: 0.0035204
	speed: 0.0433s/iter; left time: 1811.3657s
Epoch: 11 cost time: 19.995609760284424
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.973412 --> -0.977986).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1858928
	speed: 0.2469s/iter; left time: 10282.5799s
	iters: 200, epoch: 12 | loss: 0.1249890
	speed: 0.0480s/iter; left time: 1992.3939s
	iters: 300, epoch: 12 | loss: 0.0010068
	speed: 0.0479s/iter; left time: 1983.9730s
	iters: 400, epoch: 12 | loss: 0.0054349
	speed: 0.0486s/iter; left time: 2007.4768s
Epoch: 12 cost time: 23.197229146957397
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.1075111
	speed: 0.2665s/iter; left time: 10973.4688s
	iters: 200, epoch: 13 | loss: 0.0028937
	speed: 0.0451s/iter; left time: 1851.9534s
	iters: 300, epoch: 13 | loss: 0.0215298
	speed: 0.0469s/iter; left time: 1923.0002s
	iters: 400, epoch: 13 | loss: 0.0010010
	speed: 0.0457s/iter; left time: 1867.6361s
Epoch: 13 cost time: 22.37943124771118
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0056057
	speed: 0.2419s/iter; left time: 9846.5793s
	iters: 200, epoch: 14 | loss: 0.0024059
	speed: 0.0421s/iter; left time: 1708.9913s
	iters: 300, epoch: 14 | loss: 0.0297645
	speed: 0.0439s/iter; left time: 1779.4446s
	iters: 400, epoch: 14 | loss: 0.0240833
	speed: 0.0445s/iter; left time: 1799.3578s
Epoch: 14 cost time: 20.591227531433105
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0001764
	speed: 0.2596s/iter; left time: 10443.4557s
	iters: 200, epoch: 15 | loss: 0.0063005
	speed: 0.0455s/iter; left time: 1826.3173s
	iters: 300, epoch: 15 | loss: 0.0144867
	speed: 0.0471s/iter; left time: 1887.3977s
	iters: 400, epoch: 15 | loss: 0.0004100
	speed: 0.0493s/iter; left time: 1969.6974s
Epoch: 15 cost time: 22.728935956954956
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0049234
	speed: 0.2474s/iter; left time: 9836.7888s
	iters: 200, epoch: 16 | loss: 0.0273858
	speed: 0.0402s/iter; left time: 1592.9726s
	iters: 300, epoch: 16 | loss: 0.0003119
	speed: 0.0434s/iter; left time: 1715.2417s
	iters: 400, epoch: 16 | loss: 0.0002396
	speed: 0.0416s/iter; left time: 1643.3251s
Epoch: 16 cost time: 20.827784061431885
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0323380
	speed: 0.2295s/iter; left time: 9016.9637s
	iters: 200, epoch: 17 | loss: 0.0046071
	speed: 0.0431s/iter; left time: 1690.1574s
	iters: 300, epoch: 17 | loss: 0.0009569
	speed: 0.0475s/iter; left time: 1855.3777s
	iters: 400, epoch: 17 | loss: 0.0007819
	speed: 0.0402s/iter; left time: 1567.4743s
Epoch: 17 cost time: 20.177205324172974
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0037248
	speed: 0.2521s/iter; left time: 9788.1389s
	iters: 200, epoch: 18 | loss: 0.0003581
	speed: 0.0596s/iter; left time: 2309.3062s
	iters: 300, epoch: 18 | loss: 0.0004430
	speed: 0.0619s/iter; left time: 2391.7490s
	iters: 400, epoch: 18 | loss: 0.4261816
	speed: 0.0587s/iter; left time: 2261.0782s
Epoch: 18 cost time: 28.046773433685303
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0095611
	speed: 0.3116s/iter; left time: 11950.9967s
	iters: 200, epoch: 19 | loss: 0.1235866
	speed: 0.0655s/iter; left time: 2504.9962s
	iters: 300, epoch: 19 | loss: 0.0976425
	speed: 0.0630s/iter; left time: 2403.2655s
	iters: 400, epoch: 19 | loss: 0.0004441
	speed: 0.0610s/iter; left time: 2323.3830s
Epoch: 19 cost time: 28.866755962371826
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0141672
	speed: 0.2966s/iter; left time: 11238.6722s
	iters: 200, epoch: 20 | loss: 0.0771252
	speed: 0.0522s/iter; left time: 1971.5162s
	iters: 300, epoch: 20 | loss: 0.0690663
	speed: 0.0448s/iter; left time: 1688.7292s
	iters: 400, epoch: 20 | loss: 0.0001725
	speed: 0.0530s/iter; left time: 1991.5080s
Epoch: 20 cost time: 24.61592411994934
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980273).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0334937
	speed: 0.3002s/iter; left time: 11234.4128s
	iters: 200, epoch: 21 | loss: 0.1138723
	speed: 0.0512s/iter; left time: 1909.6848s
	iters: 300, epoch: 21 | loss: 0.0062766
	speed: 0.0504s/iter; left time: 1877.3222s
	iters: 400, epoch: 21 | loss: 0.0023991
	speed: 0.0552s/iter; left time: 2049.0722s
Epoch: 21 cost time: 26.0278058052063
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0052002
	speed: 0.3019s/iter; left time: 11156.0085s
	iters: 200, epoch: 22 | loss: 0.0349571
	speed: 0.0528s/iter; left time: 1947.5355s
	iters: 300, epoch: 22 | loss: 0.0043131
	speed: 0.0523s/iter; left time: 1921.1297s
	iters: 400, epoch: 22 | loss: 0.0005291
	speed: 0.0574s/iter; left time: 2103.9699s
Epoch: 22 cost time: 25.912216424942017
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0006022
	speed: 0.3028s/iter; left time: 11046.8108s
	iters: 200, epoch: 23 | loss: 0.6420258
	speed: 0.0576s/iter; left time: 2095.0290s
	iters: 300, epoch: 23 | loss: 0.1515127
	speed: 0.0538s/iter; left time: 1950.7154s
	iters: 400, epoch: 23 | loss: 0.0028935
	speed: 0.0517s/iter; left time: 1871.2510s
Epoch: 23 cost time: 26.223835468292236
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.965 Test Loss: 0.184 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0001789
	speed: 0.3065s/iter; left time: 11038.6149s
	iters: 200, epoch: 24 | loss: 0.0019741
	speed: 0.0489s/iter; left time: 1756.0478s
	iters: 300, epoch: 24 | loss: 0.0000603
	speed: 0.0467s/iter; left time: 1672.3304s
	iters: 400, epoch: 24 | loss: 0.0003817
	speed: 0.0503s/iter; left time: 1798.0567s
Epoch: 24 cost time: 23.80749201774597
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0068991
	speed: 0.2933s/iter; left time: 10427.0732s
	iters: 200, epoch: 25 | loss: 0.0007065
	speed: 0.0539s/iter; left time: 1910.5536s
	iters: 300, epoch: 25 | loss: 0.0000696
	speed: 0.0554s/iter; left time: 1956.6747s
	iters: 400, epoch: 25 | loss: 0.0004457
	speed: 0.0517s/iter; left time: 1822.7679s
Epoch: 25 cost time: 25.637666702270508
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0041204
	speed: 0.2906s/iter; left time: 10192.6078s
	iters: 200, epoch: 26 | loss: 0.0002620
	speed: 0.0546s/iter; left time: 1908.3244s
	iters: 300, epoch: 26 | loss: 0.0066389
	speed: 0.0443s/iter; left time: 1543.7744s
	iters: 400, epoch: 26 | loss: 0.0305018
	speed: 0.0445s/iter; left time: 1546.4864s
Epoch: 26 cost time: 23.403473138809204
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0006518
	speed: 0.2617s/iter; left time: 9058.3652s
	iters: 200, epoch: 27 | loss: 0.0014210
	speed: 0.0450s/iter; left time: 1552.2156s
	iters: 300, epoch: 27 | loss: 0.0055947
	speed: 0.0421s/iter; left time: 1447.7829s
	iters: 400, epoch: 27 | loss: 0.0004564
	speed: 0.0437s/iter; left time: 1498.9629s
Epoch: 27 cost time: 21.042715549468994
Epoch: 27, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0488991
	speed: 0.2602s/iter; left time: 8881.1577s
	iters: 200, epoch: 28 | loss: 0.0008705
	speed: 0.0519s/iter; left time: 1766.1983s
	iters: 300, epoch: 28 | loss: 0.0161287
	speed: 0.0483s/iter; left time: 1640.0913s
	iters: 400, epoch: 28 | loss: 0.0548731
	speed: 0.0540s/iter; left time: 1828.3781s
Epoch: 28 cost time: 24.33613133430481
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0004822
	speed: 0.2723s/iter; left time: 9168.9011s
	iters: 200, epoch: 29 | loss: 0.0008264
	speed: 0.0477s/iter; left time: 1601.4038s
	iters: 300, epoch: 29 | loss: 0.0012514
	speed: 0.0460s/iter; left time: 1539.5803s
	iters: 400, epoch: 29 | loss: 0.0000022
	speed: 0.0458s/iter; left time: 1528.2135s
Epoch: 29 cost time: 22.708450317382812
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
Validation loss decreased (-0.980273 --> -0.983704).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0012616
	speed: 0.2780s/iter; left time: 9230.9825s
	iters: 200, epoch: 30 | loss: 0.0003987
	speed: 0.0483s/iter; left time: 1598.5216s
	iters: 300, epoch: 30 | loss: 0.0707372
	speed: 0.0515s/iter; left time: 1699.9369s
	iters: 400, epoch: 30 | loss: 0.1295230
	speed: 0.0504s/iter; left time: 1657.9197s
Epoch: 30 cost time: 24.44859004020691
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0000267
	speed: 0.2881s/iter; left time: 9430.6614s
	iters: 200, epoch: 31 | loss: 0.0007677
	speed: 0.0549s/iter; left time: 1790.0819s
	iters: 300, epoch: 31 | loss: 0.9030901
	speed: 0.0530s/iter; left time: 1723.3556s
	iters: 400, epoch: 31 | loss: 0.0000009
	speed: 0.0506s/iter; left time: 1641.1210s
Epoch: 31 cost time: 25.264086484909058
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000775
	speed: 0.3028s/iter; left time: 9767.5665s
	iters: 200, epoch: 32 | loss: 0.0001931
	speed: 0.0492s/iter; left time: 1581.4373s
	iters: 300, epoch: 32 | loss: 0.0163668
	speed: 0.0558s/iter; left time: 1788.9769s
	iters: 400, epoch: 32 | loss: 0.0000514
	speed: 0.0498s/iter; left time: 1592.6800s
Epoch: 32 cost time: 24.751132249832153
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0001444
	speed: 0.3022s/iter; left time: 9608.2457s
	iters: 200, epoch: 33 | loss: 0.0002231
	speed: 0.0602s/iter; left time: 1907.0962s
	iters: 300, epoch: 33 | loss: 0.0031798
	speed: 0.0554s/iter; left time: 1751.2322s
	iters: 400, epoch: 33 | loss: 0.0003701
	speed: 0.0535s/iter; left time: 1685.2378s
Epoch: 33 cost time: 27.073607206344604
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.1008658
	speed: 0.2948s/iter; left time: 9234.3124s
	iters: 200, epoch: 34 | loss: 0.0064532
	speed: 0.0501s/iter; left time: 1564.3539s
	iters: 300, epoch: 34 | loss: 0.0009357
	speed: 0.0509s/iter; left time: 1584.1388s
	iters: 400, epoch: 34 | loss: 0.0000427
	speed: 0.0514s/iter; left time: 1594.6299s
Epoch: 34 cost time: 24.396788120269775
Epoch: 34, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0489647
	speed: 0.2943s/iter; left time: 9082.1633s
	iters: 200, epoch: 35 | loss: 0.0402154
	speed: 0.0559s/iter; left time: 1719.7626s
	iters: 300, epoch: 35 | loss: 0.0051714
	speed: 0.0568s/iter; left time: 1741.2396s
	iters: 400, epoch: 35 | loss: 0.0140365
	speed: 0.0532s/iter; left time: 1626.5462s
Epoch: 35 cost time: 27.04698157310486
Epoch: 35, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0185287
	speed: 0.3015s/iter; left time: 9161.2762s
	iters: 200, epoch: 36 | loss: 0.0019093
	speed: 0.0515s/iter; left time: 1560.9740s
	iters: 300, epoch: 36 | loss: 0.0000160
	speed: 0.0557s/iter; left time: 1680.4865s
	iters: 400, epoch: 36 | loss: 0.0171591
	speed: 0.0541s/iter; left time: 1628.7373s
Epoch: 36 cost time: 26.070833444595337
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000390
	speed: 0.2989s/iter; left time: 8942.3853s
	iters: 200, epoch: 37 | loss: 0.0046158
	speed: 0.0490s/iter; left time: 1460.0926s
	iters: 300, epoch: 37 | loss: 0.0062315
	speed: 0.0496s/iter; left time: 1472.8926s
	iters: 400, epoch: 37 | loss: 0.0001694
	speed: 0.0509s/iter; left time: 1506.1451s
Epoch: 37 cost time: 24.281745433807373
Epoch: 37, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0043106
	speed: 0.2909s/iter; left time: 8565.0079s
	iters: 200, epoch: 38 | loss: 0.0058683
	speed: 0.0462s/iter; left time: 1356.6319s
	iters: 300, epoch: 38 | loss: 0.0000174
	speed: 0.0486s/iter; left time: 1422.8755s
	iters: 400, epoch: 38 | loss: 0.0000074
	speed: 0.0505s/iter; left time: 1472.6650s
Epoch: 38 cost time: 23.804763078689575
Epoch: 38, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0001347
	speed: 0.2907s/iter; left time: 8422.9636s
	iters: 200, epoch: 39 | loss: 0.0024810
	speed: 0.0523s/iter; left time: 1511.2459s
	iters: 300, epoch: 39 | loss: 0.0094368
	speed: 0.0433s/iter; left time: 1245.0553s
	iters: 400, epoch: 39 | loss: 0.0002776
	speed: 0.0496s/iter; left time: 1423.1216s
Epoch: 39 cost time: 23.439526557922363
Epoch: 39, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 1339962
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2659763
	speed: 0.1086s/iter; left time: 5083.6990s
	iters: 200, epoch: 1 | loss: 0.1365916
	speed: 0.0828s/iter; left time: 3864.9155s
	iters: 300, epoch: 1 | loss: 0.0696677
	speed: 0.0786s/iter; left time: 3665.0627s
	iters: 400, epoch: 1 | loss: 0.1175786
	speed: 0.0841s/iter; left time: 3912.1867s
Epoch: 1 cost time: 41.069324016571045
Epoch: 1, Steps: 469 | Train Loss: 0.430 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (inf --> -0.937390).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0498824
	speed: 0.4254s/iter; left time: 19708.5232s
	iters: 200, epoch: 2 | loss: 0.2364162
	speed: 0.0780s/iter; left time: 3606.1726s
	iters: 300, epoch: 2 | loss: 0.1277054
	speed: 0.0717s/iter; left time: 3309.3638s
	iters: 400, epoch: 2 | loss: 0.0137677
	speed: 0.0719s/iter; left time: 3310.1124s
Epoch: 2 cost time: 35.83548331260681
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.219 Vali Acc: 0.945 Test Loss: 0.219 Test Acc: 0.945
Validation loss decreased (-0.937390 --> -0.945109).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0030318
	speed: 0.4353s/iter; left time: 19965.1379s
	iters: 200, epoch: 3 | loss: 0.0160190
	speed: 0.0746s/iter; left time: 3412.9263s
	iters: 300, epoch: 3 | loss: 0.0169784
	speed: 0.0763s/iter; left time: 3484.4866s
	iters: 400, epoch: 3 | loss: 0.0760161
	speed: 0.0768s/iter; left time: 3501.0683s
Epoch: 3 cost time: 37.36125731468201
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.945109 --> -0.954258).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0335907
	speed: 0.3914s/iter; left time: 17765.7830s
	iters: 200, epoch: 4 | loss: 0.0037489
	speed: 0.0739s/iter; left time: 3348.7211s
	iters: 300, epoch: 4 | loss: 0.0693871
	speed: 0.0732s/iter; left time: 3308.9916s
	iters: 400, epoch: 4 | loss: 0.0063297
	speed: 0.0808s/iter; left time: 3643.8385s
Epoch: 4 cost time: 35.47718358039856
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.954258 --> -0.959118).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0009349
	speed: 0.4241s/iter; left time: 19054.4721s
	iters: 200, epoch: 5 | loss: 0.0126451
	speed: 0.0872s/iter; left time: 3908.5034s
	iters: 300, epoch: 5 | loss: 0.0774947
	speed: 0.0772s/iter; left time: 3451.4888s
	iters: 400, epoch: 5 | loss: 0.1805558
	speed: 0.0723s/iter; left time: 3228.5353s
Epoch: 5 cost time: 37.40044546127319
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1147456
	speed: 0.3598s/iter; left time: 15997.2007s
	iters: 200, epoch: 6 | loss: 0.0046289
	speed: 0.0834s/iter; left time: 3697.2306s
	iters: 300, epoch: 6 | loss: 0.0037709
	speed: 0.0834s/iter; left time: 3692.7805s
	iters: 400, epoch: 6 | loss: 0.0041711
	speed: 0.0846s/iter; left time: 3734.9941s
Epoch: 6 cost time: 39.41346836090088
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.959118 --> -0.964550).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005211
	speed: 0.4171s/iter; left time: 18347.8023s
	iters: 200, epoch: 7 | loss: 0.0269821
	speed: 0.0862s/iter; left time: 3781.0091s
	iters: 300, epoch: 7 | loss: 0.2828276
	speed: 0.0836s/iter; left time: 3660.4557s
	iters: 400, epoch: 7 | loss: 0.3957187
	speed: 0.0860s/iter; left time: 3757.5328s
Epoch: 7 cost time: 38.81408357620239
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0285534
	speed: 0.3646s/iter; left time: 15865.2936s
	iters: 200, epoch: 8 | loss: 0.0589756
	speed: 0.0833s/iter; left time: 3615.1672s
	iters: 300, epoch: 8 | loss: 0.0342998
	speed: 0.0871s/iter; left time: 3771.6396s
	iters: 400, epoch: 8 | loss: 0.0006508
	speed: 0.0877s/iter; left time: 3790.0667s
Epoch: 8 cost time: 40.05005240440369
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.964550 --> -0.967123).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0247764
	speed: 0.3953s/iter; left time: 17016.2079s
	iters: 200, epoch: 9 | loss: 0.0136386
	speed: 0.0701s/iter; left time: 3012.6133s
	iters: 300, epoch: 9 | loss: 0.0625599
	speed: 0.0756s/iter; left time: 3240.2254s
	iters: 400, epoch: 9 | loss: 0.0014467
	speed: 0.0703s/iter; left time: 3007.2786s
Epoch: 9 cost time: 34.565979957580566
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.967123 --> -0.979416).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0133447
	speed: 0.3986s/iter; left time: 16974.0410s
	iters: 200, epoch: 10 | loss: 0.2188974
	speed: 0.0761s/iter; left time: 3231.4398s
	iters: 300, epoch: 10 | loss: 0.0123949
	speed: 0.0843s/iter; left time: 3573.1538s
	iters: 400, epoch: 10 | loss: 0.0101969
	speed: 0.0861s/iter; left time: 3638.3175s
Epoch: 10 cost time: 37.378902435302734
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0001201
	speed: 0.3992s/iter; left time: 16812.7908s
	iters: 200, epoch: 11 | loss: 0.0620080
	speed: 0.0737s/iter; left time: 3095.9509s
	iters: 300, epoch: 11 | loss: 0.0127909
	speed: 0.0713s/iter; left time: 2988.0407s
	iters: 400, epoch: 11 | loss: 0.0011457
	speed: 0.0713s/iter; left time: 2981.1273s
Epoch: 11 cost time: 35.368640422821045
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.4162234
	speed: 0.4211s/iter; left time: 17534.1798s
	iters: 200, epoch: 12 | loss: 0.0028492
	speed: 0.0695s/iter; left time: 2888.8858s
	iters: 300, epoch: 12 | loss: 0.0003921
	speed: 0.0744s/iter; left time: 3084.6673s
	iters: 400, epoch: 12 | loss: 0.0267479
	speed: 0.0694s/iter; left time: 2870.6554s
Epoch: 12 cost time: 33.75272011756897
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2258822
	speed: 0.3981s/iter; left time: 16389.7342s
	iters: 200, epoch: 13 | loss: 0.0017434
	speed: 0.0797s/iter; left time: 3273.1658s
	iters: 300, epoch: 13 | loss: 0.0165067
	speed: 0.0725s/iter; left time: 2971.3950s
	iters: 400, epoch: 13 | loss: 0.0000160
	speed: 0.0756s/iter; left time: 3089.5738s
Epoch: 13 cost time: 36.560617446899414
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0134696
	speed: 0.4128s/iter; left time: 16803.8129s
	iters: 200, epoch: 14 | loss: 0.0012951
	speed: 0.0743s/iter; left time: 3015.5609s
	iters: 300, epoch: 14 | loss: 0.0005373
	speed: 0.0759s/iter; left time: 3074.5987s
	iters: 400, epoch: 14 | loss: 0.0355686
	speed: 0.0697s/iter; left time: 2814.6385s
Epoch: 14 cost time: 35.36074614524841
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000472
	speed: 0.4171s/iter; left time: 16780.7943s
	iters: 200, epoch: 15 | loss: 0.0770919
	speed: 0.0688s/iter; left time: 2760.2352s
	iters: 300, epoch: 15 | loss: 0.0008375
	speed: 0.0738s/iter; left time: 2956.4791s
	iters: 400, epoch: 15 | loss: 0.0006934
	speed: 0.0713s/iter; left time: 2846.3463s
Epoch: 15 cost time: 34.535561323165894
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0006544
	speed: 0.3975s/iter; left time: 15807.4770s
	iters: 200, epoch: 16 | loss: 0.0312257
	speed: 0.0723s/iter; left time: 2868.8728s
	iters: 300, epoch: 16 | loss: 0.0003924
	speed: 0.0547s/iter; left time: 2162.5530s
	iters: 400, epoch: 16 | loss: 0.0000048
	speed: 0.0566s/iter; left time: 2232.5060s
Epoch: 16 cost time: 31.716999769210815
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0271326
	speed: 0.4002s/iter; left time: 15725.6040s
	iters: 200, epoch: 17 | loss: 0.0016830
	speed: 0.0825s/iter; left time: 3233.5946s
	iters: 300, epoch: 17 | loss: 0.0032753
	speed: 0.0757s/iter; left time: 2957.7487s
	iters: 400, epoch: 17 | loss: 0.0008632
	speed: 0.0690s/iter; left time: 2689.7776s
Epoch: 17 cost time: 36.8365204334259
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0011953
	speed: 0.4352s/iter; left time: 16896.2958s
	iters: 200, epoch: 18 | loss: 0.0036277
	speed: 0.0975s/iter; left time: 3777.3496s
	iters: 300, epoch: 18 | loss: 0.0139110
	speed: 0.1006s/iter; left time: 3886.9759s
	iters: 400, epoch: 18 | loss: 0.1491221
	speed: 0.0890s/iter; left time: 3429.8012s
Epoch: 18 cost time: 42.312559604644775
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.4376632
	speed: 0.3884s/iter; left time: 14897.7939s
	iters: 200, epoch: 19 | loss: 0.2350642
	speed: 0.1032s/iter; left time: 3948.2709s
	iters: 300, epoch: 19 | loss: 0.0006260
	speed: 0.0953s/iter; left time: 3638.2426s
	iters: 400, epoch: 19 | loss: 0.0022169
	speed: 0.0966s/iter; left time: 3676.8530s
Epoch: 19 cost time: 44.48896241188049
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 1339962
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2282964
	speed: 0.0987s/iter; left time: 4619.4795s
	iters: 200, epoch: 1 | loss: 0.1091002
	speed: 0.0757s/iter; left time: 3537.0098s
	iters: 300, epoch: 1 | loss: 0.0539493
	speed: 0.0842s/iter; left time: 3925.7152s
	iters: 400, epoch: 1 | loss: 0.2049789
	speed: 0.0777s/iter; left time: 3614.4892s
Epoch: 1 cost time: 39.43817353248596
Epoch: 1, Steps: 469 | Train Loss: 0.405 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1215065
	speed: 0.4190s/iter; left time: 19414.7500s
	iters: 200, epoch: 2 | loss: 0.1764092
	speed: 0.0632s/iter; left time: 2922.7074s
	iters: 300, epoch: 2 | loss: 0.0600250
	speed: 0.0737s/iter; left time: 3398.5821s
	iters: 400, epoch: 2 | loss: 0.0065824
	speed: 0.0924s/iter; left time: 4254.0205s
Epoch: 2 cost time: 36.43241500854492
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.951685 --> -0.970554).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0026422
	speed: 0.4300s/iter; left time: 19720.5476s
	iters: 200, epoch: 3 | loss: 0.0008289
	speed: 0.0800s/iter; left time: 3659.5739s
	iters: 300, epoch: 3 | loss: 0.0010118
	speed: 0.0873s/iter; left time: 3987.9501s
	iters: 400, epoch: 3 | loss: 0.1550424
	speed: 0.0939s/iter; left time: 4277.1127s
Epoch: 3 cost time: 41.262879848480225
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0029463
	speed: 0.3792s/iter; left time: 17213.3105s
	iters: 200, epoch: 4 | loss: 0.0008519
	speed: 0.0808s/iter; left time: 3659.3756s
	iters: 300, epoch: 4 | loss: 0.0213417
	speed: 0.0791s/iter; left time: 3575.9347s
	iters: 400, epoch: 4 | loss: 0.0804880
	speed: 0.0866s/iter; left time: 3903.8902s
Epoch: 4 cost time: 38.48848843574524
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0032234
	speed: 0.4463s/iter; left time: 20052.2076s
	iters: 200, epoch: 5 | loss: 0.2739750
	speed: 0.0781s/iter; left time: 3499.0418s
	iters: 300, epoch: 5 | loss: 0.0132602
	speed: 0.0629s/iter; left time: 2811.9333s
	iters: 400, epoch: 5 | loss: 0.0013175
	speed: 0.0658s/iter; left time: 2935.0391s
Epoch: 5 cost time: 33.90684914588928
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0055331
	speed: 0.4422s/iter; left time: 19656.3441s
	iters: 200, epoch: 6 | loss: 0.0011532
	speed: 0.0914s/iter; left time: 4055.8280s
	iters: 300, epoch: 6 | loss: 0.0067611
	speed: 0.0864s/iter; left time: 3823.2672s
	iters: 400, epoch: 6 | loss: 0.0091911
	speed: 0.0889s/iter; left time: 3923.4577s
Epoch: 6 cost time: 41.17689490318298
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0003988
	speed: 0.4195s/iter; left time: 18452.3966s
	iters: 200, epoch: 7 | loss: 0.0030195
	speed: 0.0815s/iter; left time: 3578.3621s
	iters: 300, epoch: 7 | loss: 0.3165485
	speed: 0.0856s/iter; left time: 3746.4064s
	iters: 400, epoch: 7 | loss: 0.0194010
	speed: 0.0940s/iter; left time: 4107.0721s
Epoch: 7 cost time: 40.923609018325806
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0521897
	speed: 0.4573s/iter; left time: 19898.9269s
	iters: 200, epoch: 8 | loss: 0.0633383
	speed: 0.0838s/iter; left time: 3637.7581s
	iters: 300, epoch: 8 | loss: 0.0041292
	speed: 0.0858s/iter; left time: 3718.3935s
	iters: 400, epoch: 8 | loss: 0.0012061
	speed: 0.0907s/iter; left time: 3920.9230s
Epoch: 8 cost time: 39.788450717926025
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.192 Vali Acc: 0.969 Test Loss: 0.192 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0001164
	speed: 0.3806s/iter; left time: 16384.9423s
	iters: 200, epoch: 9 | loss: 0.0016130
	speed: 0.0793s/iter; left time: 3407.8152s
	iters: 300, epoch: 9 | loss: 0.0564891
	speed: 0.0806s/iter; left time: 3455.1625s
	iters: 400, epoch: 9 | loss: 0.0402579
	speed: 0.0875s/iter; left time: 3741.1116s
Epoch: 9 cost time: 39.16158485412598
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.970554 --> -0.978558).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0370014
	speed: 0.4369s/iter; left time: 18604.5431s
	iters: 200, epoch: 10 | loss: 0.0016364
	speed: 0.0801s/iter; left time: 3401.2014s
	iters: 300, epoch: 10 | loss: 0.0266459
	speed: 0.0834s/iter; left time: 3534.7071s
	iters: 400, epoch: 10 | loss: 0.0000110
	speed: 0.0928s/iter; left time: 3923.3866s
Epoch: 10 cost time: 40.720014572143555
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0000168
	speed: 0.4193s/iter; left time: 17656.2895s
	iters: 200, epoch: 11 | loss: 0.5193062
	speed: 0.0848s/iter; left time: 3561.0453s
	iters: 300, epoch: 11 | loss: 0.0219294
	speed: 0.0734s/iter; left time: 3076.0146s
	iters: 400, epoch: 11 | loss: 0.0034983
	speed: 0.0749s/iter; left time: 3130.8866s
Epoch: 11 cost time: 37.78647828102112
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1385130
	speed: 0.4439s/iter; left time: 18482.8466s
	iters: 200, epoch: 12 | loss: 0.0155590
	speed: 0.0809s/iter; left time: 3362.4069s
	iters: 300, epoch: 12 | loss: 0.0000138
	speed: 0.0819s/iter; left time: 3392.4915s
	iters: 400, epoch: 12 | loss: 0.0304984
	speed: 0.0884s/iter; left time: 3655.3766s
Epoch: 12 cost time: 40.629154205322266
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1133888
	speed: 0.4074s/iter; left time: 16772.7130s
	iters: 200, epoch: 13 | loss: 0.0000774
	speed: 0.0818s/iter; left time: 3358.1197s
	iters: 300, epoch: 13 | loss: 0.0610626
	speed: 0.0816s/iter; left time: 3341.8692s
	iters: 400, epoch: 13 | loss: 0.0000051
	speed: 0.0856s/iter; left time: 3497.1222s
Epoch: 13 cost time: 39.37195706367493
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979987).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0361160
	speed: 0.4710s/iter; left time: 19170.9857s
	iters: 200, epoch: 14 | loss: 0.0646393
	speed: 0.0683s/iter; left time: 2774.6270s
	iters: 300, epoch: 14 | loss: 0.0001217
	speed: 0.0861s/iter; left time: 3486.9490s
	iters: 400, epoch: 14 | loss: 0.0024622
	speed: 0.0850s/iter; left time: 3433.9765s
Epoch: 14 cost time: 39.13093090057373
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0002444
	speed: 0.3684s/iter; left time: 14821.6872s
	iters: 200, epoch: 15 | loss: 0.0087871
	speed: 0.0736s/iter; left time: 2953.8996s
	iters: 300, epoch: 15 | loss: 0.1295455
	speed: 0.0821s/iter; left time: 3285.3088s
	iters: 400, epoch: 15 | loss: 0.0533818
	speed: 0.0889s/iter; left time: 3549.8774s
Epoch: 15 cost time: 37.40011405944824
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000385
	speed: 0.4897s/iter; left time: 19472.1504s
	iters: 200, epoch: 16 | loss: 0.0326106
	speed: 0.0790s/iter; left time: 3133.2951s
	iters: 300, epoch: 16 | loss: 0.0001652
	speed: 0.0840s/iter; left time: 3322.6499s
	iters: 400, epoch: 16 | loss: 0.0034390
	speed: 0.0733s/iter; left time: 2892.1712s
Epoch: 16 cost time: 37.96592926979065
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.981703).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0011589
	speed: 0.4529s/iter; left time: 17797.5994s
	iters: 200, epoch: 17 | loss: 0.0122730
	speed: 0.0792s/iter; left time: 3104.6303s
	iters: 300, epoch: 17 | loss: 0.0007108
	speed: 0.0837s/iter; left time: 3270.8936s
	iters: 400, epoch: 17 | loss: 0.0093481
	speed: 0.0741s/iter; left time: 2888.2863s
Epoch: 17 cost time: 36.939637660980225
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.6929620
	speed: 0.4237s/iter; left time: 16449.9690s
	iters: 200, epoch: 18 | loss: 0.0005957
	speed: 0.0782s/iter; left time: 3030.0795s
	iters: 300, epoch: 18 | loss: 0.0000806
	speed: 0.0806s/iter; left time: 3111.9011s
	iters: 400, epoch: 18 | loss: 0.0134170
	speed: 0.0887s/iter; left time: 3416.7795s
Epoch: 18 cost time: 38.21645736694336
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000394
	speed: 0.4738s/iter; left time: 18172.6657s
	iters: 200, epoch: 19 | loss: 0.0000123
	speed: 0.0899s/iter; left time: 3437.8056s
	iters: 300, epoch: 19 | loss: 0.0269679
	speed: 0.0864s/iter; left time: 3295.8961s
	iters: 400, epoch: 19 | loss: 0.0000063
	speed: 0.0816s/iter; left time: 3106.1695s
Epoch: 19 cost time: 40.598382234573364
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000090
	speed: 0.4305s/iter; left time: 16310.2887s
	iters: 200, epoch: 20 | loss: 0.0630884
	speed: 0.0614s/iter; left time: 2318.7353s
	iters: 300, epoch: 20 | loss: 0.0005099
	speed: 0.0695s/iter; left time: 2619.9649s
	iters: 400, epoch: 20 | loss: 0.0007618
	speed: 0.0742s/iter; left time: 2788.6797s
Epoch: 20 cost time: 31.484176874160767
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000161
	speed: 0.4214s/iter; left time: 15769.8570s
	iters: 200, epoch: 21 | loss: 0.0537347
	speed: 0.0728s/iter; left time: 2717.0702s
	iters: 300, epoch: 21 | loss: 0.0086163
	speed: 0.0775s/iter; left time: 2883.5595s
	iters: 400, epoch: 21 | loss: 0.0000092
	speed: 0.0731s/iter; left time: 2713.9922s
Epoch: 21 cost time: 35.896950006484985
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000457
	speed: 0.4476s/iter; left time: 16540.8108s
	iters: 200, epoch: 22 | loss: 0.0124172
	speed: 0.0810s/iter; left time: 2984.0531s
	iters: 300, epoch: 22 | loss: 0.0000805
	speed: 0.0883s/iter; left time: 3244.9996s
	iters: 400, epoch: 22 | loss: 0.0005109
	speed: 0.0887s/iter; left time: 3252.6300s
Epoch: 22 cost time: 41.45566964149475
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0021385
	speed: 0.4379s/iter; left time: 15976.7506s
	iters: 200, epoch: 23 | loss: 0.8736283
	speed: 0.0850s/iter; left time: 3094.1507s
	iters: 300, epoch: 23 | loss: 0.0007158
	speed: 0.0832s/iter; left time: 3018.0872s
	iters: 400, epoch: 23 | loss: 0.0013761
	speed: 0.0740s/iter; left time: 2678.9472s
Epoch: 23 cost time: 39.45309114456177
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000085
	speed: 0.4380s/iter; left time: 15773.3783s
	iters: 200, epoch: 24 | loss: 0.0114367
	speed: 0.0564s/iter; left time: 2025.2315s
	iters: 300, epoch: 24 | loss: 0.0000599
	speed: 0.0614s/iter; left time: 2199.2605s
	iters: 400, epoch: 24 | loss: 0.0001192
	speed: 0.0689s/iter; left time: 2461.8871s
Epoch: 24 cost time: 32.87606239318848
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0589797
	speed: 0.4730s/iter; left time: 16812.7914s
	iters: 200, epoch: 25 | loss: 0.0002299
	speed: 0.0867s/iter; left time: 3072.2430s
	iters: 300, epoch: 25 | loss: 0.0000389
	speed: 0.0914s/iter; left time: 3229.4167s
	iters: 400, epoch: 25 | loss: 0.0003593
	speed: 0.0898s/iter; left time: 3165.3101s
Epoch: 25 cost time: 42.34795951843262
Epoch: 25, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
Validation loss decreased (-0.981703 --> -0.983704).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0607229
	speed: 0.4637s/iter; left time: 16265.5825s
	iters: 200, epoch: 26 | loss: 0.0000023
	speed: 0.0895s/iter; left time: 3130.7291s
	iters: 300, epoch: 26 | loss: 0.0000038
	speed: 0.0770s/iter; left time: 2686.2457s
	iters: 400, epoch: 26 | loss: 0.0001299
	speed: 0.0730s/iter; left time: 2539.2082s
Epoch: 26 cost time: 39.6054482460022
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0033776
	speed: 0.4095s/iter; left time: 14171.1402s
	iters: 200, epoch: 27 | loss: 0.0002536
	speed: 0.0762s/iter; left time: 2631.0539s
	iters: 300, epoch: 27 | loss: 0.0727386
	speed: 0.0730s/iter; left time: 2510.3921s
	iters: 400, epoch: 27 | loss: 0.0000061
	speed: 0.0771s/iter; left time: 2643.5063s
Epoch: 27 cost time: 37.56211876869202
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.983 Test Loss: 0.166 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.4246034
	speed: 0.4365s/iter; left time: 14901.7441s
	iters: 200, epoch: 28 | loss: 0.0000781
	speed: 0.0945s/iter; left time: 3217.0706s
	iters: 300, epoch: 28 | loss: 0.1429906
	speed: 0.0880s/iter; left time: 2986.3111s
	iters: 400, epoch: 28 | loss: 0.0003618
	speed: 0.0936s/iter; left time: 3166.4103s
Epoch: 28 cost time: 42.306644678115845
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.979 Test Loss: 0.170 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0017185
	speed: 0.4072s/iter; left time: 13711.5853s
	iters: 200, epoch: 29 | loss: 0.0000053
	speed: 0.1006s/iter; left time: 3376.9773s
	iters: 300, epoch: 29 | loss: 0.0000104
	speed: 0.0797s/iter; left time: 2667.9522s
	iters: 400, epoch: 29 | loss: 0.0030334
	speed: 0.0759s/iter; left time: 2531.2849s
Epoch: 29 cost time: 41.406862020492554
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.187 Vali Acc: 0.974 Test Loss: 0.187 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0002700
	speed: 0.4445s/iter; left time: 14757.6218s
	iters: 200, epoch: 30 | loss: 0.0000044
	speed: 0.0733s/iter; left time: 2426.3719s
	iters: 300, epoch: 30 | loss: 0.0007975
	speed: 0.0669s/iter; left time: 2207.6785s
	iters: 400, epoch: 30 | loss: 0.0000431
	speed: 0.0768s/iter; left time: 2526.1702s
Epoch: 30 cost time: 37.159515142440796
Epoch: 30, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0616377
	speed: 0.4247s/iter; left time: 13900.2032s
	iters: 200, epoch: 31 | loss: 0.0000322
	speed: 0.0753s/iter; left time: 2457.1319s
	iters: 300, epoch: 31 | loss: 0.6882840
	speed: 0.0781s/iter; left time: 2540.2443s
	iters: 400, epoch: 31 | loss: 0.0000443
	speed: 0.0919s/iter; left time: 2981.1389s
Epoch: 31 cost time: 38.77218794822693
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.243 Vali Acc: 0.971 Test Loss: 0.243 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000009
	speed: 0.4221s/iter; left time: 13616.9894s
	iters: 200, epoch: 32 | loss: 0.0000448
	speed: 0.0951s/iter; left time: 3057.8258s
	iters: 300, epoch: 32 | loss: 0.0295482
	speed: 0.0804s/iter; left time: 2578.3352s
	iters: 400, epoch: 32 | loss: 0.0528157
	speed: 0.0734s/iter; left time: 2346.4894s
Epoch: 32 cost time: 40.595396280288696
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.205 Vali Acc: 0.974 Test Loss: 0.205 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0007475
	speed: 0.4337s/iter; left time: 13790.0675s
	iters: 200, epoch: 33 | loss: 0.0001532
	speed: 0.0805s/iter; left time: 2550.3057s
	iters: 300, epoch: 33 | loss: 0.0000417
	speed: 0.0675s/iter; left time: 2132.1230s
	iters: 400, epoch: 33 | loss: 0.0000013
	speed: 0.0649s/iter; left time: 2043.5325s
Epoch: 33 cost time: 35.13475060462952
Epoch: 33, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.293 Vali Acc: 0.973 Test Loss: 0.293 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0000010
	speed: 0.3898s/iter; left time: 12208.8351s
	iters: 200, epoch: 34 | loss: 0.0026721
	speed: 0.0776s/iter; left time: 2421.6755s
	iters: 300, epoch: 34 | loss: 0.0000077
	speed: 0.0821s/iter; left time: 2553.9226s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.0690s/iter; left time: 2141.4157s
Epoch: 34 cost time: 36.14044523239136
Epoch: 34, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0006973
	speed: 0.3782s/iter; left time: 11669.4435s
	iters: 200, epoch: 35 | loss: 0.0033023
	speed: 0.0878s/iter; left time: 2701.2097s
	iters: 300, epoch: 35 | loss: 0.0001553
	speed: 0.0758s/iter; left time: 2324.5833s
	iters: 400, epoch: 35 | loss: 0.2943220
	speed: 0.0742s/iter; left time: 2267.9857s
Epoch: 35 cost time: 37.76111578941345
Epoch: 35, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 1339962
model size : 10.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3413586
	speed: 0.0907s/iter; left time: 4243.6166s
	iters: 200, epoch: 1 | loss: 0.1912709
	speed: 0.0683s/iter; left time: 3189.2653s
	iters: 300, epoch: 1 | loss: 0.0654237
	speed: 0.0694s/iter; left time: 3234.3759s
	iters: 400, epoch: 1 | loss: 0.2013667
	speed: 0.0638s/iter; left time: 2966.8664s
Epoch: 1 cost time: 34.265056133270264
Epoch: 1, Steps: 469 | Train Loss: 0.436 Vali Loss: 0.253 Vali Acc: 0.923 Test Loss: 0.253 Test Acc: 0.923
Validation loss decreased (inf --> -0.923382).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1181396
	speed: 0.4035s/iter; left time: 18693.4665s
	iters: 200, epoch: 2 | loss: 0.0471077
	speed: 0.0663s/iter; left time: 3065.1732s
	iters: 300, epoch: 2 | loss: 0.0565772
	speed: 0.0762s/iter; left time: 3515.2949s
	iters: 400, epoch: 2 | loss: 0.0717190
	speed: 0.0728s/iter; left time: 3351.1217s
Epoch: 2 cost time: 34.468966484069824
Epoch: 2, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.923382 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0485262
	speed: 0.4042s/iter; left time: 18536.5509s
	iters: 200, epoch: 3 | loss: 0.0929263
	speed: 0.0777s/iter; left time: 3557.7474s
	iters: 300, epoch: 3 | loss: 0.0279025
	speed: 0.0769s/iter; left time: 3510.2410s
	iters: 400, epoch: 3 | loss: 0.0866760
	speed: 0.0651s/iter; left time: 2964.2278s
Epoch: 3 cost time: 35.337730407714844
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.957974 --> -0.967123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0083037
	speed: 0.4098s/iter; left time: 18603.7221s
	iters: 200, epoch: 4 | loss: 0.0079400
	speed: 0.0689s/iter; left time: 3121.8395s
	iters: 300, epoch: 4 | loss: 0.0524270
	speed: 0.0577s/iter; left time: 2608.0521s
	iters: 400, epoch: 4 | loss: 0.0009406
	speed: 0.0607s/iter; left time: 2735.3378s
Epoch: 4 cost time: 32.44464683532715
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0855545
	speed: 0.3751s/iter; left time: 16852.5222s
	iters: 200, epoch: 5 | loss: 0.0040286
	speed: 0.0659s/iter; left time: 2954.3460s
	iters: 300, epoch: 5 | loss: 0.0083426
	speed: 0.0714s/iter; left time: 3192.5737s
	iters: 400, epoch: 5 | loss: 0.0749479
	speed: 0.0662s/iter; left time: 2952.5989s
Epoch: 5 cost time: 32.303558349609375
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.967123 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0159680
	speed: 0.3386s/iter; left time: 15052.8826s
	iters: 200, epoch: 6 | loss: 0.0409170
	speed: 0.0742s/iter; left time: 3290.8066s
	iters: 300, epoch: 6 | loss: 0.0059664
	speed: 0.0684s/iter; left time: 3026.7072s
	iters: 400, epoch: 6 | loss: 0.0686802
	speed: 0.0616s/iter; left time: 2721.9224s
Epoch: 6 cost time: 31.96242117881775
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0540750
	speed: 0.3794s/iter; left time: 16687.6019s
	iters: 200, epoch: 7 | loss: 0.0019711
	speed: 0.0790s/iter; left time: 3465.6878s
	iters: 300, epoch: 7 | loss: 0.0019580
	speed: 0.0712s/iter; left time: 3117.8207s
	iters: 400, epoch: 7 | loss: 0.0676319
	speed: 0.0658s/iter; left time: 2875.2752s
Epoch: 7 cost time: 33.66586661338806
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.974270).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0015375
	speed: 0.4283s/iter; left time: 18640.8491s
	iters: 200, epoch: 8 | loss: 0.3074138
	speed: 0.0740s/iter; left time: 3214.0808s
	iters: 300, epoch: 8 | loss: 0.0009706
	speed: 0.0715s/iter; left time: 3096.9430s
	iters: 400, epoch: 8 | loss: 0.0878105
	speed: 0.0743s/iter; left time: 3210.2381s
Epoch: 8 cost time: 35.856481313705444
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0130165
	speed: 0.4118s/iter; left time: 17727.2622s
	iters: 200, epoch: 9 | loss: 0.0019854
	speed: 0.0765s/iter; left time: 3283.6044s
	iters: 300, epoch: 9 | loss: 0.0480257
	speed: 0.0814s/iter; left time: 3486.4045s
	iters: 400, epoch: 9 | loss: 0.0025107
	speed: 0.0813s/iter; left time: 3474.6333s
Epoch: 9 cost time: 36.90687870979309
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.974842).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009566
	speed: 0.4141s/iter; left time: 17632.1476s
	iters: 200, epoch: 10 | loss: 0.0012050
	speed: 0.0684s/iter; left time: 2906.7084s
	iters: 300, epoch: 10 | loss: 0.0133566
	speed: 0.0669s/iter; left time: 2834.4377s
	iters: 400, epoch: 10 | loss: 0.0006341
	speed: 0.0719s/iter; left time: 3041.9935s
Epoch: 10 cost time: 34.55619406700134
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1499893
	speed: 0.4169s/iter; left time: 17554.2197s
	iters: 200, epoch: 11 | loss: 0.0039614
	speed: 0.0696s/iter; left time: 2924.5684s
	iters: 300, epoch: 11 | loss: 0.0034222
	speed: 0.0596s/iter; left time: 2499.0417s
	iters: 400, epoch: 11 | loss: 0.0055023
	speed: 0.0601s/iter; left time: 2514.0122s
Epoch: 11 cost time: 31.21116328239441
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.974842 --> -0.977700).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002360
	speed: 0.3902s/iter; left time: 16249.7192s
	iters: 200, epoch: 12 | loss: 0.0012995
	speed: 0.0750s/iter; left time: 3116.7210s
	iters: 300, epoch: 12 | loss: 0.0007251
	speed: 0.0741s/iter; left time: 3070.3303s
	iters: 400, epoch: 12 | loss: 0.2101471
	speed: 0.0696s/iter; left time: 2879.0445s
Epoch: 12 cost time: 34.982686042785645
Epoch: 12, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.977700 --> -0.977986).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0031762
	speed: 0.4136s/iter; left time: 17029.9612s
	iters: 200, epoch: 13 | loss: 0.0127744
	speed: 0.0735s/iter; left time: 3020.3210s
	iters: 300, epoch: 13 | loss: 0.2802987
	speed: 0.0648s/iter; left time: 2655.0495s
	iters: 400, epoch: 13 | loss: 0.0002752
	speed: 0.0707s/iter; left time: 2889.2845s
Epoch: 13 cost time: 34.993834495544434
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0055580
	speed: 0.4122s/iter; left time: 16778.1781s
	iters: 200, epoch: 14 | loss: 0.0211416
	speed: 0.0722s/iter; left time: 2931.9310s
	iters: 300, epoch: 14 | loss: 0.0274877
	speed: 0.0739s/iter; left time: 2992.6795s
	iters: 400, epoch: 14 | loss: 0.0029132
	speed: 0.0682s/iter; left time: 2755.7972s
Epoch: 14 cost time: 34.39433813095093
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0105113
	speed: 0.4007s/iter; left time: 16123.4126s
	iters: 200, epoch: 15 | loss: 0.0178306
	speed: 0.0614s/iter; left time: 2463.9278s
	iters: 300, epoch: 15 | loss: 0.1376543
	speed: 0.0663s/iter; left time: 2654.3733s
	iters: 400, epoch: 15 | loss: 0.0391191
	speed: 0.0662s/iter; left time: 2645.5111s
Epoch: 15 cost time: 31.669914484024048
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0059875
	speed: 0.4210s/iter; left time: 16743.2386s
	iters: 200, epoch: 16 | loss: 0.0462804
	speed: 0.0798s/iter; left time: 3165.5439s
	iters: 300, epoch: 16 | loss: 0.0010116
	speed: 0.0691s/iter; left time: 2733.6796s
	iters: 400, epoch: 16 | loss: 0.0029611
	speed: 0.0695s/iter; left time: 2742.4793s
Epoch: 16 cost time: 35.39403247833252
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1980754
	speed: 0.3976s/iter; left time: 15625.0589s
	iters: 200, epoch: 17 | loss: 0.0353009
	speed: 0.0737s/iter; left time: 2889.8573s
	iters: 300, epoch: 17 | loss: 0.0000650
	speed: 0.0739s/iter; left time: 2887.6516s
	iters: 400, epoch: 17 | loss: 0.0011659
	speed: 0.0631s/iter; left time: 2460.7035s
Epoch: 17 cost time: 34.38341403007507
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978844).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0077373
	speed: 0.3777s/iter; left time: 14664.1719s
	iters: 200, epoch: 18 | loss: 0.6024640
	speed: 0.0641s/iter; left time: 2480.7824s
	iters: 300, epoch: 18 | loss: 0.0213605
	speed: 0.0676s/iter; left time: 2610.0089s
	iters: 400, epoch: 18 | loss: 0.1169981
	speed: 0.0694s/iter; left time: 2672.6593s
Epoch: 18 cost time: 33.132025718688965
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0058523
	speed: 0.3860s/iter; left time: 14806.0345s
	iters: 200, epoch: 19 | loss: 0.0001280
	speed: 0.0693s/iter; left time: 2651.9612s
	iters: 300, epoch: 19 | loss: 0.0001185
	speed: 0.0755s/iter; left time: 2879.3978s
	iters: 400, epoch: 19 | loss: 0.2003458
	speed: 0.0716s/iter; left time: 2726.5157s
Epoch: 19 cost time: 34.81663632392883
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.984 Test Loss: 0.115 Test Acc: 0.984
Validation loss decreased (-0.978844 --> -0.983704).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0096825
	speed: 0.4243s/iter; left time: 16076.1267s
	iters: 200, epoch: 20 | loss: 0.0030848
	speed: 0.0662s/iter; left time: 2500.7920s
	iters: 300, epoch: 20 | loss: 0.0055259
	speed: 0.0737s/iter; left time: 2776.6399s
	iters: 400, epoch: 20 | loss: 0.0048183
	speed: 0.0674s/iter; left time: 2535.3669s
Epoch: 20 cost time: 34.966179847717285
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.974 Test Loss: 0.170 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0011337
	speed: 0.4312s/iter; left time: 16137.3221s
	iters: 200, epoch: 21 | loss: 0.0033329
	speed: 0.0711s/iter; left time: 2655.0705s
	iters: 300, epoch: 21 | loss: 0.0000037
	speed: 0.0768s/iter; left time: 2858.2960s
	iters: 400, epoch: 21 | loss: 0.2100558
	speed: 0.0684s/iter; left time: 2537.3705s
Epoch: 21 cost time: 35.13521146774292
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000277
	speed: 0.3870s/iter; left time: 14299.2590s
	iters: 200, epoch: 22 | loss: 0.0004646
	speed: 0.0727s/iter; left time: 2679.4658s
	iters: 300, epoch: 22 | loss: 0.0015123
	speed: 0.0749s/iter; left time: 2752.6608s
	iters: 400, epoch: 22 | loss: 0.0017074
	speed: 0.0666s/iter; left time: 2441.9358s
Epoch: 22 cost time: 34.872546911239624
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0706140
	speed: 0.3817s/iter; left time: 13926.8926s
	iters: 200, epoch: 23 | loss: 0.0506576
	speed: 0.0731s/iter; left time: 2659.8209s
	iters: 300, epoch: 23 | loss: 0.0001272
	speed: 0.0710s/iter; left time: 2574.5275s
	iters: 400, epoch: 23 | loss: 0.0008130
	speed: 0.0679s/iter; left time: 2458.0456s
Epoch: 23 cost time: 35.471803188323975
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0241358
	speed: 0.4051s/iter; left time: 14587.5770s
	iters: 200, epoch: 24 | loss: 0.0010672
	speed: 0.0692s/iter; left time: 2485.6365s
	iters: 300, epoch: 24 | loss: 0.0024817
	speed: 0.0735s/iter; left time: 2632.4873s
	iters: 400, epoch: 24 | loss: 0.5640761
	speed: 0.0692s/iter; left time: 2472.0875s
Epoch: 24 cost time: 34.15192103385925
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0006086
	speed: 0.3535s/iter; left time: 12565.0838s
	iters: 200, epoch: 25 | loss: 0.0002937
	speed: 0.0719s/iter; left time: 2548.2398s
	iters: 300, epoch: 25 | loss: 0.0011214
	speed: 0.0671s/iter; left time: 2370.6835s
	iters: 400, epoch: 25 | loss: 0.0008203
	speed: 0.0623s/iter; left time: 2195.0513s
Epoch: 25 cost time: 32.898168325424194
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0031286
	speed: 0.4016s/iter; left time: 14085.8268s
	iters: 200, epoch: 26 | loss: 0.0001578
	speed: 0.0750s/iter; left time: 2622.0764s
	iters: 300, epoch: 26 | loss: 0.0006060
	speed: 0.0774s/iter; left time: 2697.7375s
	iters: 400, epoch: 26 | loss: 0.0000355
	speed: 0.0787s/iter; left time: 2736.1269s
Epoch: 26 cost time: 37.28040933609009
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0007972
	speed: 0.3794s/iter; left time: 13130.2738s
	iters: 200, epoch: 27 | loss: 0.0134456
	speed: 0.0612s/iter; left time: 2112.1073s
	iters: 300, epoch: 27 | loss: 0.0008342
	speed: 0.0721s/iter; left time: 2481.4972s
	iters: 400, epoch: 27 | loss: 0.0147861
	speed: 0.0900s/iter; left time: 3086.5628s
Epoch: 27 cost time: 34.94888520240784
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0002093
	speed: 0.3610s/iter; left time: 12323.3558s
	iters: 200, epoch: 28 | loss: 0.0106342
	speed: 0.0695s/iter; left time: 2367.0334s
	iters: 300, epoch: 28 | loss: 0.0000431
	speed: 0.0699s/iter; left time: 2371.1741s
	iters: 400, epoch: 28 | loss: 0.0002008
	speed: 0.0782s/iter; left time: 2647.6443s
Epoch: 28 cost time: 33.98430848121643
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0020885
	speed: 0.3615s/iter; left time: 12169.7941s
	iters: 200, epoch: 29 | loss: 0.0003259
	speed: 0.0668s/iter; left time: 2241.5969s
	iters: 300, epoch: 29 | loss: 0.0176110
	speed: 0.0725s/iter; left time: 2426.2086s
	iters: 400, epoch: 29 | loss: 0.0015787
	speed: 0.0791s/iter; left time: 2638.2248s
Epoch: 29 cost time: 34.807469606399536
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 815674
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3139362
	speed: 0.0912s/iter; left time: 4266.6856s
	iters: 200, epoch: 1 | loss: 0.1720963
	speed: 0.0676s/iter; left time: 3155.1758s
	iters: 300, epoch: 1 | loss: 0.0397015
	speed: 0.0579s/iter; left time: 2699.3715s
	iters: 400, epoch: 1 | loss: 0.1478035
	speed: 0.0548s/iter; left time: 2547.7506s
Epoch: 1 cost time: 31.37433624267578
Epoch: 1, Steps: 469 | Train Loss: 0.418 Vali Loss: 0.240 Vali Acc: 0.934 Test Loss: 0.240 Test Acc: 0.934
Validation loss decreased (inf --> -0.934246).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1185187
	speed: 0.3588s/iter; left time: 16621.8999s
	iters: 200, epoch: 2 | loss: 0.0317086
	speed: 0.0624s/iter; left time: 2883.6276s
	iters: 300, epoch: 2 | loss: 0.0116877
	speed: 0.0641s/iter; left time: 2955.6603s
	iters: 400, epoch: 2 | loss: 0.0377287
	speed: 0.0636s/iter; left time: 2927.1265s
Epoch: 2 cost time: 30.46704125404358
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
Validation loss decreased (-0.934246 --> -0.952828).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0023605
	speed: 0.3523s/iter; left time: 16155.6813s
	iters: 200, epoch: 3 | loss: 0.1418844
	speed: 0.0750s/iter; left time: 3431.6263s
	iters: 300, epoch: 3 | loss: 0.0125685
	speed: 0.0588s/iter; left time: 2684.1144s
	iters: 400, epoch: 3 | loss: 0.0213654
	speed: 0.0637s/iter; left time: 2900.2902s
Epoch: 3 cost time: 32.57623505592346
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.952828 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0076826
	speed: 0.3375s/iter; left time: 15319.0359s
	iters: 200, epoch: 4 | loss: 0.0098523
	speed: 0.0752s/iter; left time: 3407.8658s
	iters: 300, epoch: 4 | loss: 0.0695076
	speed: 0.0656s/iter; left time: 2962.5057s
	iters: 400, epoch: 4 | loss: 0.0028621
	speed: 0.0693s/iter; left time: 3126.2119s
Epoch: 4 cost time: 33.56172728538513
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.965407 --> -0.970553).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2386478
	speed: 0.3775s/iter; left time: 16959.2454s
	iters: 200, epoch: 5 | loss: 0.0048723
	speed: 0.0755s/iter; left time: 3384.0363s
	iters: 300, epoch: 5 | loss: 0.0017021
	speed: 0.0592s/iter; left time: 2647.9376s
	iters: 400, epoch: 5 | loss: 0.0512747
	speed: 0.0643s/iter; left time: 2868.8973s
Epoch: 5 cost time: 32.4156756401062
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.970553 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0167025
	speed: 0.3570s/iter; left time: 15869.6172s
	iters: 200, epoch: 6 | loss: 0.0055516
	speed: 0.0713s/iter; left time: 3164.0509s
	iters: 300, epoch: 6 | loss: 0.0074072
	speed: 0.0615s/iter; left time: 2723.4889s
	iters: 400, epoch: 6 | loss: 0.2892950
	speed: 0.0629s/iter; left time: 2779.0185s
Epoch: 6 cost time: 31.811866760253906
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0113764
	speed: 0.3302s/iter; left time: 14526.1775s
	iters: 200, epoch: 7 | loss: 0.0211548
	speed: 0.0692s/iter; left time: 3038.4668s
	iters: 300, epoch: 7 | loss: 0.0084748
	speed: 0.0705s/iter; left time: 3085.7469s
	iters: 400, epoch: 7 | loss: 0.2426450
	speed: 0.0697s/iter; left time: 3045.2602s
Epoch: 7 cost time: 32.86432480812073
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0327647
	speed: 0.3616s/iter; left time: 15737.8751s
	iters: 200, epoch: 8 | loss: 0.3057827
	speed: 0.0840s/iter; left time: 3645.9304s
	iters: 300, epoch: 8 | loss: 0.0004177
	speed: 0.0791s/iter; left time: 3426.5695s
	iters: 400, epoch: 8 | loss: 0.0021048
	speed: 0.0686s/iter; left time: 2963.8980s
Epoch: 8 cost time: 36.36210584640503
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0055360
	speed: 0.3684s/iter; left time: 15859.9649s
	iters: 200, epoch: 9 | loss: 0.0001334
	speed: 0.0709s/iter; left time: 3043.3866s
	iters: 300, epoch: 9 | loss: 0.0028930
	speed: 0.0709s/iter; left time: 3037.8822s
	iters: 400, epoch: 9 | loss: 0.0003168
	speed: 0.0640s/iter; left time: 2737.7152s
Epoch: 9 cost time: 33.39970660209656
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0022511
	speed: 0.3531s/iter; left time: 15033.7989s
	iters: 200, epoch: 10 | loss: 0.0002424
	speed: 0.0692s/iter; left time: 2940.0222s
	iters: 300, epoch: 10 | loss: 0.0086829
	speed: 0.0740s/iter; left time: 3138.1655s
	iters: 400, epoch: 10 | loss: 0.0575988
	speed: 0.0700s/iter; left time: 2957.8042s
Epoch: 10 cost time: 33.548781394958496
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0111868
	speed: 0.3898s/iter; left time: 16414.0861s
	iters: 200, epoch: 11 | loss: 0.0003824
	speed: 0.0783s/iter; left time: 3289.0353s
	iters: 300, epoch: 11 | loss: 0.0038133
	speed: 0.0716s/iter; left time: 3000.6853s
	iters: 400, epoch: 11 | loss: 0.0205308
	speed: 0.0628s/iter; left time: 2625.6857s
Epoch: 11 cost time: 34.59765386581421
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0003154
	speed: 0.3677s/iter; left time: 15309.6923s
	iters: 200, epoch: 12 | loss: 0.0046562
	speed: 0.0676s/iter; left time: 2808.4276s
	iters: 300, epoch: 12 | loss: 0.0002015
	speed: 0.0620s/iter; left time: 2567.7004s
	iters: 400, epoch: 12 | loss: 0.2904648
	speed: 0.0634s/iter; left time: 2621.1903s
Epoch: 12 cost time: 31.59513211250305
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974841).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0008752
	speed: 0.3436s/iter; left time: 14148.0153s
	iters: 200, epoch: 13 | loss: 0.0001898
	speed: 0.0661s/iter; left time: 2715.8958s
	iters: 300, epoch: 13 | loss: 0.4019904
	speed: 0.0551s/iter; left time: 2258.6833s
	iters: 400, epoch: 13 | loss: 0.0001860
	speed: 0.0571s/iter; left time: 2333.1637s
Epoch: 13 cost time: 29.202916860580444
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0007188
	speed: 0.3425s/iter; left time: 13942.9560s
	iters: 200, epoch: 14 | loss: 0.0048718
	speed: 0.0601s/iter; left time: 2441.4523s
	iters: 300, epoch: 14 | loss: 0.0056227
	speed: 0.0641s/iter; left time: 2597.9722s
	iters: 400, epoch: 14 | loss: 0.0020497
	speed: 0.0627s/iter; left time: 2533.7932s
Epoch: 14 cost time: 29.578848123550415
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0012098
	speed: 0.3483s/iter; left time: 14015.3542s
	iters: 200, epoch: 15 | loss: 0.0040005
	speed: 0.0581s/iter; left time: 2332.2927s
	iters: 300, epoch: 15 | loss: 0.0023417
	speed: 0.0600s/iter; left time: 2402.7506s
	iters: 400, epoch: 15 | loss: 0.0060533
	speed: 0.0641s/iter; left time: 2559.0847s
Epoch: 15 cost time: 30.303201913833618
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0016238
	speed: 0.3812s/iter; left time: 15157.2639s
	iters: 200, epoch: 16 | loss: 0.0186234
	speed: 0.0623s/iter; left time: 2469.7831s
	iters: 300, epoch: 16 | loss: 0.0104504
	speed: 0.0662s/iter; left time: 2618.1240s
	iters: 400, epoch: 16 | loss: 0.0318375
	speed: 0.0655s/iter; left time: 2585.6257s
Epoch: 16 cost time: 30.60146474838257
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0621449
	speed: 0.3437s/iter; left time: 13507.0751s
	iters: 200, epoch: 17 | loss: 0.0353712
	speed: 0.0646s/iter; left time: 2533.6879s
	iters: 300, epoch: 17 | loss: 0.0023572
	speed: 0.0571s/iter; left time: 2230.6413s
	iters: 400, epoch: 17 | loss: 0.1306641
	speed: 0.0583s/iter; left time: 2273.6794s
Epoch: 17 cost time: 29.85162329673767
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0003525
	speed: 0.3752s/iter; left time: 14569.3595s
	iters: 200, epoch: 18 | loss: 0.0015533
	speed: 0.0626s/iter; left time: 2423.5976s
	iters: 300, epoch: 18 | loss: 0.0624724
	speed: 0.0657s/iter; left time: 2537.2534s
	iters: 400, epoch: 18 | loss: 0.1258059
	speed: 0.0668s/iter; left time: 2572.4437s
Epoch: 18 cost time: 32.65245342254639
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.974841 --> -0.976271).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0016248
	speed: 0.3769s/iter; left time: 14459.1409s
	iters: 200, epoch: 19 | loss: 0.0002477
	speed: 0.0671s/iter; left time: 2566.9194s
	iters: 300, epoch: 19 | loss: 0.0001739
	speed: 0.0724s/iter; left time: 2761.0674s
	iters: 400, epoch: 19 | loss: 0.0101554
	speed: 0.0666s/iter; left time: 2534.1938s
Epoch: 19 cost time: 31.885721921920776
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977129).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000832
	speed: 0.3339s/iter; left time: 12651.3875s
	iters: 200, epoch: 20 | loss: 0.0237447
	speed: 0.0647s/iter; left time: 2445.0201s
	iters: 300, epoch: 20 | loss: 0.0136375
	speed: 0.0614s/iter; left time: 2313.3635s
	iters: 400, epoch: 20 | loss: 0.2474847
	speed: 0.0595s/iter; left time: 2235.6372s
Epoch: 20 cost time: 29.65037202835083
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0008032
	speed: 0.3635s/iter; left time: 13601.7628s
	iters: 200, epoch: 21 | loss: 0.0023772
	speed: 0.0665s/iter; left time: 2480.5991s
	iters: 300, epoch: 21 | loss: 0.0000706
	speed: 0.0684s/iter; left time: 2544.7865s
	iters: 400, epoch: 21 | loss: 0.2665398
	speed: 0.0699s/iter; left time: 2595.3850s
Epoch: 21 cost time: 32.8370156288147
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0224249
	speed: 0.3871s/iter; left time: 14305.4560s
	iters: 200, epoch: 22 | loss: 0.0097010
	speed: 0.0603s/iter; left time: 2221.1750s
	iters: 300, epoch: 22 | loss: 0.2935306
	speed: 0.0647s/iter; left time: 2377.2284s
	iters: 400, epoch: 22 | loss: 0.1707311
	speed: 0.0826s/iter; left time: 3027.7301s
Epoch: 22 cost time: 33.704716205596924
Epoch: 22, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978844).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0092331
	speed: 0.3478s/iter; left time: 12687.6251s
	iters: 200, epoch: 23 | loss: 0.1499128
	speed: 0.0711s/iter; left time: 2585.5346s
	iters: 300, epoch: 23 | loss: 0.0003453
	speed: 0.0652s/iter; left time: 2364.8036s
	iters: 400, epoch: 23 | loss: 0.0008000
	speed: 0.0681s/iter; left time: 2462.2895s
Epoch: 23 cost time: 32.2175931930542
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0010299
	speed: 0.3318s/iter; left time: 11948.4792s
	iters: 200, epoch: 24 | loss: 0.0040547
	speed: 0.0584s/iter; left time: 2098.4855s
	iters: 300, epoch: 24 | loss: 0.0002735
	speed: 0.0609s/iter; left time: 2179.6213s
	iters: 400, epoch: 24 | loss: 0.2969375
	speed: 0.0585s/iter; left time: 2090.6989s
Epoch: 24 cost time: 28.426221132278442
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.980559).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0048560
	speed: 0.3251s/iter; left time: 11556.6485s
	iters: 200, epoch: 25 | loss: 0.0007241
	speed: 0.0617s/iter; left time: 2187.8060s
	iters: 300, epoch: 25 | loss: 0.0009104
	speed: 0.0713s/iter; left time: 2518.4100s
	iters: 400, epoch: 25 | loss: 0.0004551
	speed: 0.0722s/iter; left time: 2543.7385s
Epoch: 25 cost time: 32.055823802948
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0036915
	speed: 0.3344s/iter; left time: 11728.3998s
	iters: 200, epoch: 26 | loss: 0.0070224
	speed: 0.0626s/iter; left time: 2190.9417s
	iters: 300, epoch: 26 | loss: 0.0008453
	speed: 0.0644s/iter; left time: 2246.9327s
	iters: 400, epoch: 26 | loss: 0.0244357
	speed: 0.0689s/iter; left time: 2395.3242s
Epoch: 26 cost time: 30.843364477157593
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0008002
	speed: 0.3263s/iter; left time: 11291.6907s
	iters: 200, epoch: 27 | loss: 0.0361529
	speed: 0.0618s/iter; left time: 2131.7593s
	iters: 300, epoch: 27 | loss: 0.1062950
	speed: 0.0628s/iter; left time: 2161.9454s
	iters: 400, epoch: 27 | loss: 0.0153157
	speed: 0.0619s/iter; left time: 2123.8807s
Epoch: 27 cost time: 29.968940258026123
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0063290
	speed: 0.3258s/iter; left time: 11123.1735s
	iters: 200, epoch: 28 | loss: 0.0068783
	speed: 0.0625s/iter; left time: 2128.5108s
	iters: 300, epoch: 28 | loss: 0.0000027
	speed: 0.0739s/iter; left time: 2507.2701s
	iters: 400, epoch: 28 | loss: 0.0003337
	speed: 0.0753s/iter; left time: 2549.1849s
Epoch: 28 cost time: 32.34738612174988
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0263541
	speed: 0.3002s/iter; left time: 10108.0675s
	iters: 200, epoch: 29 | loss: 0.0040415
	speed: 0.0670s/iter; left time: 2248.9701s
	iters: 300, epoch: 29 | loss: 0.0002966
	speed: 0.0735s/iter; left time: 2458.9669s
	iters: 400, epoch: 29 | loss: 0.0001298
	speed: 0.0727s/iter; left time: 2427.4087s
Epoch: 29 cost time: 31.989547729492188
Epoch: 29, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0220161
	speed: 0.3472s/iter; left time: 11525.8597s
	iters: 200, epoch: 30 | loss: 0.0212259
	speed: 0.0725s/iter; left time: 2400.1090s
	iters: 300, epoch: 30 | loss: 0.0005297
	speed: 0.0749s/iter; left time: 2473.3020s
	iters: 400, epoch: 30 | loss: 0.0000580
	speed: 0.0652s/iter; left time: 2146.5893s
Epoch: 30 cost time: 31.802201986312866
Epoch: 30, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000467
	speed: 0.3002s/iter; left time: 9824.4129s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.0698s/iter; left time: 2276.7813s
	iters: 300, epoch: 31 | loss: 0.0003518
	speed: 0.0664s/iter; left time: 2159.4764s
	iters: 400, epoch: 31 | loss: 0.0054743
	speed: 0.0609s/iter; left time: 1975.8823s
Epoch: 31 cost time: 30.163490533828735
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000019
	speed: 0.2950s/iter; left time: 9518.0980s
	iters: 200, epoch: 32 | loss: 0.0014778
	speed: 0.0572s/iter; left time: 1838.6663s
	iters: 300, epoch: 32 | loss: 0.0001999
	speed: 0.0547s/iter; left time: 1752.5573s
	iters: 400, epoch: 32 | loss: 0.2109780
	speed: 0.0503s/iter; left time: 1606.3677s
Epoch: 32 cost time: 25.622101545333862
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0007688
	speed: 0.3096s/iter; left time: 9843.0500s
	iters: 200, epoch: 33 | loss: 0.1387435
	speed: 0.0558s/iter; left time: 1768.0462s
	iters: 300, epoch: 33 | loss: 0.0002515
	speed: 0.0534s/iter; left time: 1688.3634s
	iters: 400, epoch: 33 | loss: 0.0000306
	speed: 0.0626s/iter; left time: 1971.8549s
Epoch: 33 cost time: 28.113203048706055
Epoch: 33, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.1860508
	speed: 0.3345s/iter; left time: 10477.5396s
	iters: 200, epoch: 34 | loss: 0.0008083
	speed: 0.0672s/iter; left time: 2099.3760s
	iters: 300, epoch: 34 | loss: 0.0173982
	speed: 0.0595s/iter; left time: 1850.9349s
	iters: 400, epoch: 34 | loss: 0.0000001
	speed: 0.0605s/iter; left time: 1876.9276s
Epoch: 34 cost time: 30.712913274765015
Epoch: 34, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 815674
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2887917
	speed: 0.0848s/iter; left time: 3968.6054s
	iters: 200, epoch: 1 | loss: 0.1994568
	speed: 0.0637s/iter; left time: 2974.5413s
	iters: 300, epoch: 1 | loss: 0.0360880
	speed: 0.0541s/iter; left time: 2521.2767s
	iters: 400, epoch: 1 | loss: 0.0663530
	speed: 0.0512s/iter; left time: 2380.1685s
Epoch: 1 cost time: 29.141054153442383
Epoch: 1, Steps: 469 | Train Loss: 0.401 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (inf --> -0.958546).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0745861
	speed: 0.3105s/iter; left time: 14388.0394s
	iters: 200, epoch: 2 | loss: 0.0223941
	speed: 0.0704s/iter; left time: 3254.9900s
	iters: 300, epoch: 2 | loss: 0.0043339
	speed: 0.0567s/iter; left time: 2614.8690s
	iters: 400, epoch: 2 | loss: 0.0828451
	speed: 0.0612s/iter; left time: 2819.1406s
Epoch: 2 cost time: 29.90139365196228
Epoch: 2, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.958546 --> -0.968838).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0010970
	speed: 0.3258s/iter; left time: 14943.2846s
	iters: 200, epoch: 3 | loss: 0.0119721
	speed: 0.0613s/iter; left time: 2804.9895s
	iters: 300, epoch: 3 | loss: 0.0204219
	speed: 0.0609s/iter; left time: 2780.4115s
	iters: 400, epoch: 3 | loss: 0.0030687
	speed: 0.0554s/iter; left time: 2526.4632s
Epoch: 3 cost time: 29.252349138259888
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0038701
	speed: 0.2921s/iter; left time: 13258.8861s
	iters: 200, epoch: 4 | loss: 0.0246963
	speed: 0.0517s/iter; left time: 2340.2374s
	iters: 300, epoch: 4 | loss: 0.1346310
	speed: 0.0532s/iter; left time: 2406.0168s
	iters: 400, epoch: 4 | loss: 0.0024027
	speed: 0.0546s/iter; left time: 2462.1516s
Epoch: 4 cost time: 25.805182933807373
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.970553).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1017924
	speed: 0.3185s/iter; left time: 14309.6950s
	iters: 200, epoch: 5 | loss: 0.0006260
	speed: 0.0577s/iter; left time: 2585.2327s
	iters: 300, epoch: 5 | loss: 0.0011429
	speed: 0.0531s/iter; left time: 2374.6452s
	iters: 400, epoch: 5 | loss: 0.0184774
	speed: 0.0544s/iter; left time: 2427.3132s
Epoch: 5 cost time: 27.611536741256714
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
Validation loss decreased (-0.970553 --> -0.975985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0030269
	speed: 0.3236s/iter; left time: 14385.0054s
	iters: 200, epoch: 6 | loss: 0.0040961
	speed: 0.0601s/iter; left time: 2663.6725s
	iters: 300, epoch: 6 | loss: 0.0005691
	speed: 0.0638s/iter; left time: 2824.9311s
	iters: 400, epoch: 6 | loss: 0.0035054
	speed: 0.0675s/iter; left time: 2979.2152s
Epoch: 6 cost time: 29.715190887451172
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977129).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0086197
	speed: 0.3344s/iter; left time: 14710.7142s
	iters: 200, epoch: 7 | loss: 0.0006176
	speed: 0.0606s/iter; left time: 2660.7019s
	iters: 300, epoch: 7 | loss: 0.0006688
	speed: 0.0581s/iter; left time: 2543.7516s
	iters: 400, epoch: 7 | loss: 0.1111475
	speed: 0.0600s/iter; left time: 2620.6613s
Epoch: 7 cost time: 29.09372067451477
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2043587
	speed: 0.2873s/iter; left time: 12503.3924s
	iters: 200, epoch: 8 | loss: 0.2017288
	speed: 0.0526s/iter; left time: 2285.6300s
	iters: 300, epoch: 8 | loss: 0.0057551
	speed: 0.0523s/iter; left time: 2266.0782s
	iters: 400, epoch: 8 | loss: 0.0002867
	speed: 0.0593s/iter; left time: 2561.8635s
Epoch: 8 cost time: 26.984171867370605
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0018057
	speed: 0.2968s/iter; left time: 12776.1488s
	iters: 200, epoch: 9 | loss: 0.0004768
	speed: 0.0522s/iter; left time: 2243.8283s
	iters: 300, epoch: 9 | loss: 0.0285286
	speed: 0.0504s/iter; left time: 2161.1499s
	iters: 400, epoch: 9 | loss: 0.3432390
	speed: 0.0616s/iter; left time: 2634.1396s
Epoch: 9 cost time: 26.575838088989258
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.196 Vali Acc: 0.971 Test Loss: 0.196 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0604386
	speed: 0.3027s/iter; left time: 12888.8765s
	iters: 200, epoch: 10 | loss: 0.0020140
	speed: 0.0559s/iter; left time: 2374.4893s
	iters: 300, epoch: 10 | loss: 0.0699751
	speed: 0.0515s/iter; left time: 2183.7640s
	iters: 400, epoch: 10 | loss: 0.1097293
	speed: 0.0530s/iter; left time: 2239.7857s
Epoch: 10 cost time: 25.636220455169678
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0007458
	speed: 0.2917s/iter; left time: 12284.9412s
	iters: 200, epoch: 11 | loss: 0.0001088
	speed: 0.0569s/iter; left time: 2388.4167s
	iters: 300, epoch: 11 | loss: 0.0000210
	speed: 0.0551s/iter; left time: 2311.2849s
	iters: 400, epoch: 11 | loss: 0.0001462
	speed: 0.0569s/iter; left time: 2378.5463s
Epoch: 11 cost time: 27.038681983947754
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.969 Test Loss: 0.223 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000076
	speed: 0.2758s/iter; left time: 11483.1998s
	iters: 200, epoch: 12 | loss: 0.0023130
	speed: 0.0508s/iter; left time: 2112.2607s
	iters: 300, epoch: 12 | loss: 0.0003020
	speed: 0.0506s/iter; left time: 2095.9413s
	iters: 400, epoch: 12 | loss: 0.0000466
	speed: 0.0594s/iter; left time: 2456.2343s
Epoch: 12 cost time: 25.83761215209961
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0004906
	speed: 0.2754s/iter; left time: 11339.3396s
	iters: 200, epoch: 13 | loss: 0.0033636
	speed: 0.0498s/iter; left time: 2045.8723s
	iters: 300, epoch: 13 | loss: 0.0505909
	speed: 0.0569s/iter; left time: 2331.6521s
	iters: 400, epoch: 13 | loss: 0.0103499
	speed: 0.0666s/iter; left time: 2721.1251s
Epoch: 13 cost time: 26.81699514389038
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0001356
	speed: 0.3249s/iter; left time: 13224.2015s
	iters: 200, epoch: 14 | loss: 0.0007615
	speed: 0.0614s/iter; left time: 2491.7081s
	iters: 300, epoch: 14 | loss: 0.0001083
	speed: 0.0692s/iter; left time: 2802.6668s
	iters: 400, epoch: 14 | loss: 0.0001047
	speed: 0.0685s/iter; left time: 2768.9591s
Epoch: 14 cost time: 31.316069841384888
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.970 Test Loss: 0.231 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000938
	speed: 0.3243s/iter; left time: 13046.2867s
	iters: 200, epoch: 15 | loss: 0.2390959
	speed: 0.0632s/iter; left time: 2537.4675s
	iters: 300, epoch: 15 | loss: 0.0001330
	speed: 0.0648s/iter; left time: 2593.1851s
	iters: 400, epoch: 15 | loss: 0.0000632
	speed: 0.0517s/iter; left time: 2063.8012s
Epoch: 15 cost time: 28.360353469848633
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0100773
	speed: 0.2821s/iter; left time: 11216.5310s
	iters: 200, epoch: 16 | loss: 0.0905550
	speed: 0.0601s/iter; left time: 2383.3851s
	iters: 300, epoch: 16 | loss: 0.0017409
	speed: 0.0584s/iter; left time: 2308.9319s
	iters: 400, epoch: 16 | loss: 0.0016724
	speed: 0.0543s/iter; left time: 2143.2238s
Epoch: 16 cost time: 27.512524366378784
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979701).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0063013
	speed: 0.3008s/iter; left time: 11821.3560s
	iters: 200, epoch: 17 | loss: 0.0184554
	speed: 0.0612s/iter; left time: 2400.3024s
	iters: 300, epoch: 17 | loss: 0.0000874
	speed: 0.0541s/iter; left time: 2115.3038s
	iters: 400, epoch: 17 | loss: 0.0001968
	speed: 0.0536s/iter; left time: 2091.2800s
Epoch: 17 cost time: 27.511446952819824
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0004498
	speed: 0.3006s/iter; left time: 11672.8933s
	iters: 200, epoch: 18 | loss: 0.0000493
	speed: 0.0676s/iter; left time: 2618.0808s
	iters: 300, epoch: 18 | loss: 0.0124957
	speed: 0.0599s/iter; left time: 2315.0543s
	iters: 400, epoch: 18 | loss: 0.0001650
	speed: 0.0568s/iter; left time: 2186.5103s
Epoch: 18 cost time: 29.1690993309021
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0004478
	speed: 0.3018s/iter; left time: 11578.1805s
	iters: 200, epoch: 19 | loss: 0.0691299
	speed: 0.0547s/iter; left time: 2093.6110s
	iters: 300, epoch: 19 | loss: 0.0000010
	speed: 0.0530s/iter; left time: 2023.1435s
	iters: 400, epoch: 19 | loss: 0.0672879
	speed: 0.0543s/iter; left time: 2066.4852s
Epoch: 19 cost time: 26.84057378768921
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0008407
	speed: 0.2609s/iter; left time: 9883.9665s
	iters: 200, epoch: 20 | loss: 0.0099336
	speed: 0.0420s/iter; left time: 1585.9541s
	iters: 300, epoch: 20 | loss: 0.0256379
	speed: 0.0441s/iter; left time: 1662.9669s
	iters: 400, epoch: 20 | loss: 0.4007579
	speed: 0.0577s/iter; left time: 2168.2052s
Epoch: 20 cost time: 23.7055561542511
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000355
	speed: 0.3024s/iter; left time: 11317.5066s
	iters: 200, epoch: 21 | loss: 0.1088943
	speed: 0.0635s/iter; left time: 2370.0184s
	iters: 300, epoch: 21 | loss: 0.0000566
	speed: 0.0673s/iter; left time: 2503.3253s
	iters: 400, epoch: 21 | loss: 0.8852973
	speed: 0.0619s/iter; left time: 2298.2398s
Epoch: 21 cost time: 30.097850561141968
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0046239
	speed: 0.2954s/iter; left time: 10914.1635s
	iters: 200, epoch: 22 | loss: 0.0000863
	speed: 0.0530s/iter; left time: 1952.0921s
	iters: 300, epoch: 22 | loss: 0.0090260
	speed: 0.0591s/iter; left time: 2171.6498s
	iters: 400, epoch: 22 | loss: 0.0016297
	speed: 0.0627s/iter; left time: 2297.2781s
Epoch: 22 cost time: 27.473546266555786
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0302079
	speed: 0.2866s/iter; left time: 10455.4823s
	iters: 200, epoch: 23 | loss: 0.0000211
	speed: 0.0537s/iter; left time: 1955.3908s
	iters: 300, epoch: 23 | loss: 0.0000671
	speed: 0.0536s/iter; left time: 1946.2494s
	iters: 400, epoch: 23 | loss: 0.1039867
	speed: 0.0589s/iter; left time: 2129.4520s
Epoch: 23 cost time: 25.736348867416382
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
Validation loss decreased (-0.979701 --> -0.983132).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0025532
	speed: 0.2769s/iter; left time: 9973.6829s
	iters: 200, epoch: 24 | loss: 0.0001307
	speed: 0.0568s/iter; left time: 2039.9591s
	iters: 300, epoch: 24 | loss: 0.0898519
	speed: 0.0595s/iter; left time: 2129.9709s
	iters: 400, epoch: 24 | loss: 0.0722875
	speed: 0.0620s/iter; left time: 2214.4750s
Epoch: 24 cost time: 27.31653881072998
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000020
	speed: 0.2928s/iter; left time: 10409.3003s
	iters: 200, epoch: 25 | loss: 0.0029205
	speed: 0.0577s/iter; left time: 2045.6218s
	iters: 300, epoch: 25 | loss: 0.0003328
	speed: 0.0606s/iter; left time: 2141.7726s
	iters: 400, epoch: 25 | loss: 0.0000438
	speed: 0.0546s/iter; left time: 1925.7557s
Epoch: 25 cost time: 27.135318994522095
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002787
	speed: 0.3125s/iter; left time: 10962.5562s
	iters: 200, epoch: 26 | loss: 0.0000019
	speed: 0.0681s/iter; left time: 2382.1096s
	iters: 300, epoch: 26 | loss: 0.0666230
	speed: 0.0579s/iter; left time: 2020.4655s
	iters: 400, epoch: 26 | loss: 0.0000051
	speed: 0.0586s/iter; left time: 2036.3821s
Epoch: 26 cost time: 29.350473165512085
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.259 Vali Acc: 0.961 Test Loss: 0.259 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0010134
	speed: 0.2886s/iter; left time: 9988.8025s
	iters: 200, epoch: 27 | loss: 0.0000001
	speed: 0.0622s/iter; left time: 2144.9956s
	iters: 300, epoch: 27 | loss: 0.0009914
	speed: 0.0525s/iter; left time: 1805.0815s
	iters: 400, epoch: 27 | loss: 0.0823326
	speed: 0.0506s/iter; left time: 1735.6257s
Epoch: 27 cost time: 27.1118061542511
Epoch: 27, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000028
	speed: 0.2947s/iter; left time: 10060.8973s
	iters: 200, epoch: 28 | loss: 0.0647709
	speed: 0.0471s/iter; left time: 1602.7541s
	iters: 300, epoch: 28 | loss: 0.0000018
	speed: 0.0494s/iter; left time: 1676.3481s
	iters: 400, epoch: 28 | loss: 0.0000013
	speed: 0.0526s/iter; left time: 1779.2109s
Epoch: 28 cost time: 25.110422134399414
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.979 Test Loss: 0.211 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000107
	speed: 0.2994s/iter; left time: 10081.4455s
	iters: 200, epoch: 29 | loss: 0.0000051
	speed: 0.0585s/iter; left time: 1963.7278s
	iters: 300, epoch: 29 | loss: 0.0000028
	speed: 0.0546s/iter; left time: 1828.8907s
	iters: 400, epoch: 29 | loss: 0.0026153
	speed: 0.0525s/iter; left time: 1750.5802s
Epoch: 29 cost time: 26.318129301071167
Epoch: 29, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000855
	speed: 0.3009s/iter; left time: 9988.3778s
	iters: 200, epoch: 30 | loss: 0.0018891
	speed: 0.0514s/iter; left time: 1699.8888s
	iters: 300, epoch: 30 | loss: 0.0110612
	speed: 0.0521s/iter; left time: 1717.7825s
	iters: 400, epoch: 30 | loss: 0.0000248
	speed: 0.0471s/iter; left time: 1551.0450s
Epoch: 30 cost time: 24.592883586883545
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0002379
	speed: 0.2915s/iter; left time: 9541.6763s
	iters: 200, epoch: 31 | loss: 0.0111997
	speed: 0.0522s/iter; left time: 1704.9076s
	iters: 300, epoch: 31 | loss: 0.0010202
	speed: 0.0521s/iter; left time: 1696.1161s
	iters: 400, epoch: 31 | loss: 0.0158718
	speed: 0.0597s/iter; left time: 1934.6705s
Epoch: 31 cost time: 26.622188091278076
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0293256
	speed: 0.2841s/iter; left time: 9165.6142s
	iters: 200, epoch: 32 | loss: 0.0000261
	speed: 0.0563s/iter; left time: 1811.5469s
	iters: 300, epoch: 32 | loss: 0.0095674
	speed: 0.0648s/iter; left time: 2077.5290s
	iters: 400, epoch: 32 | loss: 0.0174892
	speed: 0.0673s/iter; left time: 2152.3634s
Epoch: 32 cost time: 28.623998403549194
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.979 Test Loss: 0.223 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000388
	speed: 0.3094s/iter; left time: 9837.2127s
	iters: 200, epoch: 33 | loss: 0.0000049
	speed: 0.0612s/iter; left time: 1940.4634s
	iters: 300, epoch: 33 | loss: 0.0004186
	speed: 0.0616s/iter; left time: 1946.2223s
	iters: 400, epoch: 33 | loss: 0.0000027
	speed: 0.0553s/iter; left time: 1740.7433s
Epoch: 33 cost time: 29.05735158920288
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.980 Test Loss: 0.180 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 815674
model size : 8.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5785128
	speed: 0.0692s/iter; left time: 3237.9054s
	iters: 200, epoch: 1 | loss: 0.3713352
	speed: 0.0561s/iter; left time: 2620.1003s
	iters: 300, epoch: 1 | loss: 0.0212457
	speed: 0.0589s/iter; left time: 2743.0657s
	iters: 400, epoch: 1 | loss: 0.1544968
	speed: 0.0534s/iter; left time: 2483.1822s
Epoch: 1 cost time: 27.318511962890625
Epoch: 1, Steps: 469 | Train Loss: 0.446 Vali Loss: 0.269 Vali Acc: 0.918 Test Loss: 0.269 Test Acc: 0.918
Validation loss decreased (inf --> -0.917665).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0353126
	speed: 0.2799s/iter; left time: 12967.3506s
	iters: 200, epoch: 2 | loss: 0.0428104
	speed: 0.0558s/iter; left time: 2580.4578s
	iters: 300, epoch: 2 | loss: 0.0088333
	speed: 0.0439s/iter; left time: 2025.6845s
	iters: 400, epoch: 2 | loss: 0.0128413
	speed: 0.0466s/iter; left time: 2147.2570s
Epoch: 2 cost time: 24.491942167282104
Epoch: 2, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
Validation loss decreased (-0.917665 --> -0.949684).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0083649
	speed: 0.2577s/iter; left time: 11818.5629s
	iters: 200, epoch: 3 | loss: 0.2383913
	speed: 0.0491s/iter; left time: 2246.6656s
	iters: 300, epoch: 3 | loss: 0.0184873
	speed: 0.0495s/iter; left time: 2261.6815s
	iters: 400, epoch: 3 | loss: 0.0257563
	speed: 0.0572s/iter; left time: 2606.0872s
Epoch: 3 cost time: 25.042866706848145
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.949684 --> -0.965693).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0639449
	speed: 0.2874s/iter; left time: 13044.9015s
	iters: 200, epoch: 4 | loss: 0.2269003
	speed: 0.0510s/iter; left time: 2308.0088s
	iters: 300, epoch: 4 | loss: 0.5098509
	speed: 0.0533s/iter; left time: 2409.4609s
	iters: 400, epoch: 4 | loss: 0.2608185
	speed: 0.0508s/iter; left time: 2290.9488s
Epoch: 4 cost time: 24.212165117263794
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0020119
	speed: 0.2942s/iter; left time: 13216.2026s
	iters: 200, epoch: 5 | loss: 0.0401743
	speed: 0.0573s/iter; left time: 2566.5392s
	iters: 300, epoch: 5 | loss: 0.0728240
	speed: 0.0546s/iter; left time: 2444.0901s
	iters: 400, epoch: 5 | loss: 0.0861207
	speed: 0.0542s/iter; left time: 2417.4781s
Epoch: 5 cost time: 27.53104519844055
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0095328
	speed: 0.2859s/iter; left time: 12710.5008s
	iters: 200, epoch: 6 | loss: 0.0040131
	speed: 0.0575s/iter; left time: 2549.1686s
	iters: 300, epoch: 6 | loss: 0.2400667
	speed: 0.0558s/iter; left time: 2470.9306s
	iters: 400, epoch: 6 | loss: 0.0111926
	speed: 0.0636s/iter; left time: 2809.9667s
Epoch: 6 cost time: 28.35524821281433
Epoch: 6, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0001078
	speed: 0.3167s/iter; left time: 13931.0544s
	iters: 200, epoch: 7 | loss: 0.0007729
	speed: 0.0578s/iter; left time: 2537.5283s
	iters: 300, epoch: 7 | loss: 0.0836700
	speed: 0.0644s/iter; left time: 2818.6441s
	iters: 400, epoch: 7 | loss: 0.6129065
	speed: 0.0643s/iter; left time: 2809.4372s
Epoch: 7 cost time: 29.182230949401855
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0017989
	speed: 0.2848s/iter; left time: 12394.5892s
	iters: 200, epoch: 8 | loss: 0.0067013
	speed: 0.0488s/iter; left time: 2117.1887s
	iters: 300, epoch: 8 | loss: 0.0002828
	speed: 0.0527s/iter; left time: 2281.6596s
	iters: 400, epoch: 8 | loss: 0.0013643
	speed: 0.0527s/iter; left time: 2276.4294s
Epoch: 8 cost time: 24.98366117477417
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967123).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0056944
	speed: 0.2700s/iter; left time: 11623.6626s
	iters: 200, epoch: 9 | loss: 0.0076290
	speed: 0.0516s/iter; left time: 2216.1180s
	iters: 300, epoch: 9 | loss: 0.0017632
	speed: 0.0652s/iter; left time: 2793.2380s
	iters: 400, epoch: 9 | loss: 0.0012682
	speed: 0.0627s/iter; left time: 2682.4155s
Epoch: 9 cost time: 27.52268075942993
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001443
	speed: 0.2821s/iter; left time: 12013.3169s
	iters: 200, epoch: 10 | loss: 0.0462214
	speed: 0.0632s/iter; left time: 2686.5185s
	iters: 300, epoch: 10 | loss: 0.0908604
	speed: 0.0566s/iter; left time: 2397.4452s
	iters: 400, epoch: 10 | loss: 0.1515562
	speed: 0.0539s/iter; left time: 2277.9346s
Epoch: 10 cost time: 27.17062735557556
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.967123 --> -0.973984).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.2515500
	speed: 0.3337s/iter; left time: 14053.0383s
	iters: 200, epoch: 11 | loss: 0.0010711
	speed: 0.0890s/iter; left time: 3739.6644s
	iters: 300, epoch: 11 | loss: 0.0029236
	speed: 0.0822s/iter; left time: 3446.5266s
	iters: 400, epoch: 11 | loss: 0.0305545
	speed: 0.0813s/iter; left time: 3400.4271s
Epoch: 11 cost time: 40.32304906845093
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.978844).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0032625
	speed: 0.4393s/iter; left time: 18292.9487s
	iters: 200, epoch: 12 | loss: 0.0087113
	speed: 0.0913s/iter; left time: 3791.2229s
	iters: 300, epoch: 12 | loss: 0.0023517
	speed: 0.0832s/iter; left time: 3448.7843s
	iters: 400, epoch: 12 | loss: 0.0000968
	speed: 0.0749s/iter; left time: 3097.2500s
Epoch: 12 cost time: 39.78619956970215
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.978844 --> -0.982560).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0067842
	speed: 0.3538s/iter; left time: 14566.0002s
	iters: 200, epoch: 13 | loss: 0.0564189
	speed: 0.0745s/iter; left time: 3059.6280s
	iters: 300, epoch: 13 | loss: 0.0022111
	speed: 0.0710s/iter; left time: 2908.8546s
	iters: 400, epoch: 13 | loss: 0.0336651
	speed: 0.0846s/iter; left time: 3456.7877s
Epoch: 13 cost time: 37.53334069252014
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0010127
	speed: 0.4105s/iter; left time: 16708.5408s
	iters: 200, epoch: 14 | loss: 0.1173213
	speed: 0.0844s/iter; left time: 3425.8586s
	iters: 300, epoch: 14 | loss: 0.0258653
	speed: 0.0806s/iter; left time: 3264.6876s
	iters: 400, epoch: 14 | loss: 0.0004831
	speed: 0.0840s/iter; left time: 3392.7885s
Epoch: 14 cost time: 38.28351163864136
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0011940
	speed: 0.3212s/iter; left time: 12923.7798s
	iters: 200, epoch: 15 | loss: 0.0002973
	speed: 0.0707s/iter; left time: 2836.9746s
	iters: 300, epoch: 15 | loss: 0.0264024
	speed: 0.0709s/iter; left time: 2838.4268s
	iters: 400, epoch: 15 | loss: 0.0685256
	speed: 0.0690s/iter; left time: 2757.2675s
Epoch: 15 cost time: 32.32935452461243
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0396932
	speed: 0.3669s/iter; left time: 14590.4676s
	iters: 200, epoch: 16 | loss: 0.0055899
	speed: 0.0800s/iter; left time: 3171.4648s
	iters: 300, epoch: 16 | loss: 0.0001876
	speed: 0.0810s/iter; left time: 3205.9141s
	iters: 400, epoch: 16 | loss: 0.0090206
	speed: 0.0783s/iter; left time: 3088.3071s
Epoch: 16 cost time: 37.11917161941528
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0440255
	speed: 0.4017s/iter; left time: 15785.6260s
	iters: 200, epoch: 17 | loss: 0.0000066
	speed: 0.0536s/iter; left time: 2099.8680s
	iters: 300, epoch: 17 | loss: 0.0605507
	speed: 0.0526s/iter; left time: 2056.8507s
	iters: 400, epoch: 17 | loss: 0.0079830
	speed: 0.0697s/iter; left time: 2719.5175s
Epoch: 17 cost time: 31.458774089813232
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0116902
	speed: 0.4338s/iter; left time: 16845.2243s
	iters: 200, epoch: 18 | loss: 0.0069239
	speed: 0.0752s/iter; left time: 2913.2761s
	iters: 300, epoch: 18 | loss: 0.0000252
	speed: 0.0754s/iter; left time: 2911.0688s
	iters: 400, epoch: 18 | loss: 0.0010081
	speed: 0.0732s/iter; left time: 2820.2251s
Epoch: 18 cost time: 36.15582060813904
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.1118510
	speed: 0.4056s/iter; left time: 15557.4787s
	iters: 200, epoch: 19 | loss: 0.0347049
	speed: 0.0731s/iter; left time: 2798.1980s
	iters: 300, epoch: 19 | loss: 0.1394787
	speed: 0.0755s/iter; left time: 2882.2397s
	iters: 400, epoch: 19 | loss: 0.0608114
	speed: 0.0861s/iter; left time: 3277.3087s
Epoch: 19 cost time: 37.58163619041443
Epoch: 19, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0011008
	speed: 0.3882s/iter; left time: 14710.6812s
	iters: 200, epoch: 20 | loss: 0.0003451
	speed: 0.0561s/iter; left time: 2118.9701s
	iters: 300, epoch: 20 | loss: 0.0004646
	speed: 0.0604s/iter; left time: 2276.4338s
	iters: 400, epoch: 20 | loss: 0.0016091
	speed: 0.0825s/iter; left time: 3102.2429s
Epoch: 20 cost time: 33.39457654953003
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.984 Test Loss: 0.108 Test Acc: 0.984
Validation loss decreased (-0.982560 --> -0.983704).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000947
	speed: 0.4162s/iter; left time: 15576.2726s
	iters: 200, epoch: 21 | loss: 0.0076246
	speed: 0.0871s/iter; left time: 3249.2508s
	iters: 300, epoch: 21 | loss: 0.0107352
	speed: 0.0919s/iter; left time: 3422.2550s
	iters: 400, epoch: 21 | loss: 0.0279509
	speed: 0.0877s/iter; left time: 3256.0628s
Epoch: 21 cost time: 40.16797971725464
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.978 Test Loss: 0.164 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1116312
	speed: 0.4017s/iter; left time: 14845.2841s
	iters: 200, epoch: 22 | loss: 0.0461889
	speed: 0.0879s/iter; left time: 3240.2266s
	iters: 300, epoch: 22 | loss: 0.0047494
	speed: 0.0828s/iter; left time: 3042.2939s
	iters: 400, epoch: 22 | loss: 0.0731662
	speed: 0.0749s/iter; left time: 2746.4531s
Epoch: 22 cost time: 39.127530097961426
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0204563
	speed: 0.4100s/iter; left time: 14959.2626s
	iters: 200, epoch: 23 | loss: 0.0013551
	speed: 0.0643s/iter; left time: 2340.6435s
	iters: 300, epoch: 23 | loss: 0.0074295
	speed: 0.0840s/iter; left time: 3047.1922s
	iters: 400, epoch: 23 | loss: 0.0001271
	speed: 0.0846s/iter; left time: 3062.1942s
Epoch: 23 cost time: 35.892800092697144
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0008591
	speed: 0.4468s/iter; left time: 16090.4745s
	iters: 200, epoch: 24 | loss: 0.0004251
	speed: 0.0825s/iter; left time: 2964.3808s
	iters: 300, epoch: 24 | loss: 0.0026951
	speed: 0.0771s/iter; left time: 2762.3239s
	iters: 400, epoch: 24 | loss: 0.0000242
	speed: 0.0743s/iter; left time: 2654.5635s
Epoch: 24 cost time: 38.036548137664795
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1673721
	speed: 0.3833s/iter; left time: 13625.8570s
	iters: 200, epoch: 25 | loss: 0.0001282
	speed: 0.0486s/iter; left time: 1723.8752s
	iters: 300, epoch: 25 | loss: 0.0103327
	speed: 0.0585s/iter; left time: 2069.1804s
	iters: 400, epoch: 25 | loss: 0.0000442
	speed: 0.0766s/iter; left time: 2700.9916s
Epoch: 25 cost time: 29.20747995376587
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0736750
	speed: 0.3990s/iter; left time: 13995.6145s
	iters: 200, epoch: 26 | loss: 0.2233730
	speed: 0.0748s/iter; left time: 2617.5108s
	iters: 300, epoch: 26 | loss: 0.2166136
	speed: 0.0731s/iter; left time: 2549.3351s
	iters: 400, epoch: 26 | loss: 0.0014423
	speed: 0.0788s/iter; left time: 2741.5850s
Epoch: 26 cost time: 36.85271763801575
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0004094
	speed: 0.3561s/iter; left time: 12323.7355s
	iters: 200, epoch: 27 | loss: 0.0479202
	speed: 0.0628s/iter; left time: 2165.4891s
	iters: 300, epoch: 27 | loss: 0.0158960
	speed: 0.0801s/iter; left time: 2757.6404s
	iters: 400, epoch: 27 | loss: 0.0004192
	speed: 0.0857s/iter; left time: 2939.4842s
Epoch: 27 cost time: 34.07735872268677
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0009681
	speed: 0.3844s/iter; left time: 13122.3045s
	iters: 200, epoch: 28 | loss: 0.0002468
	speed: 0.0715s/iter; left time: 2433.7500s
	iters: 300, epoch: 28 | loss: 0.0001928
	speed: 0.0787s/iter; left time: 2671.8253s
	iters: 400, epoch: 28 | loss: 0.0029876
	speed: 0.0839s/iter; left time: 2838.6818s
Epoch: 28 cost time: 37.03704643249512
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0563883
	speed: 0.3948s/iter; left time: 13292.9062s
	iters: 200, epoch: 29 | loss: 0.0010797
	speed: 0.0837s/iter; left time: 2809.7630s
	iters: 300, epoch: 29 | loss: 0.0000374
	speed: 0.0893s/iter; left time: 2989.5251s
	iters: 400, epoch: 29 | loss: 0.0116958
	speed: 0.0686s/iter; left time: 2287.7353s
Epoch: 29 cost time: 35.92855191230774
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0000079
	speed: 0.3761s/iter; left time: 12486.2674s
	iters: 200, epoch: 30 | loss: 0.0000051
	speed: 0.0933s/iter; left time: 3089.4750s
	iters: 300, epoch: 30 | loss: 0.0038696
	speed: 0.0827s/iter; left time: 2727.4833s
	iters: 400, epoch: 30 | loss: 0.0032557
	speed: 0.0803s/iter; left time: 2640.7074s
Epoch: 30 cost time: 41.35090923309326
Epoch: 30, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 553530
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5010556
	speed: 0.1000s/iter; left time: 4680.0178s
	iters: 200, epoch: 1 | loss: 0.3414514
	speed: 0.0695s/iter; left time: 3246.9961s
	iters: 300, epoch: 1 | loss: 0.0200545
	speed: 0.0735s/iter; left time: 3425.5853s
	iters: 400, epoch: 1 | loss: 0.0649643
	speed: 0.0839s/iter; left time: 3899.4707s
Epoch: 1 cost time: 39.228371381759644
Epoch: 1, Steps: 469 | Train Loss: 0.430 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (inf --> -0.933102).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0436619
	speed: 0.3992s/iter; left time: 18496.8412s
	iters: 200, epoch: 2 | loss: 0.0454309
	speed: 0.0521s/iter; left time: 2410.4137s
	iters: 300, epoch: 2 | loss: 0.0176491
	speed: 0.0573s/iter; left time: 2641.6752s
	iters: 400, epoch: 2 | loss: 0.0099697
	speed: 0.0801s/iter; left time: 3688.0401s
Epoch: 2 cost time: 32.30828142166138
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
Validation loss decreased (-0.933102 --> -0.959403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0021771
	speed: 0.4001s/iter; left time: 18351.9193s
	iters: 200, epoch: 3 | loss: 0.2518319
	speed: 0.0774s/iter; left time: 3540.9973s
	iters: 300, epoch: 3 | loss: 0.0038771
	speed: 0.0703s/iter; left time: 3211.6020s
	iters: 400, epoch: 3 | loss: 0.0045921
	speed: 0.0614s/iter; left time: 2798.3341s
Epoch: 3 cost time: 34.210646629333496
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.959403 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0282179
	speed: 0.4029s/iter; left time: 18287.9297s
	iters: 200, epoch: 4 | loss: 0.2827354
	speed: 0.0794s/iter; left time: 3596.9320s
	iters: 300, epoch: 4 | loss: 0.6148803
	speed: 0.0828s/iter; left time: 3742.3259s
	iters: 400, epoch: 4 | loss: 0.1137999
	speed: 0.0802s/iter; left time: 3618.6766s
Epoch: 4 cost time: 37.21550154685974
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0016897
	speed: 0.4010s/iter; left time: 18014.0515s
	iters: 200, epoch: 5 | loss: 0.2753453
	speed: 0.0763s/iter; left time: 3419.6015s
	iters: 300, epoch: 5 | loss: 0.1539193
	speed: 0.0841s/iter; left time: 3762.8329s
	iters: 400, epoch: 5 | loss: 0.0880680
	speed: 0.0883s/iter; left time: 3939.8493s
Epoch: 5 cost time: 39.46168398857117
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
Validation loss decreased (-0.965407 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0143102
	speed: 0.3995s/iter; left time: 17759.5240s
	iters: 200, epoch: 6 | loss: 0.0069249
	speed: 0.0846s/iter; left time: 3751.3551s
	iters: 300, epoch: 6 | loss: 0.0994091
	speed: 0.0854s/iter; left time: 3781.4360s
	iters: 400, epoch: 6 | loss: 0.1211222
	speed: 0.0576s/iter; left time: 2544.3068s
Epoch: 6 cost time: 34.155627965927124
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001877
	speed: 0.3398s/iter; left time: 14947.8204s
	iters: 200, epoch: 7 | loss: 0.0005399
	speed: 0.0819s/iter; left time: 3593.3541s
	iters: 300, epoch: 7 | loss: 0.0065634
	speed: 0.0734s/iter; left time: 3214.3816s
	iters: 400, epoch: 7 | loss: 0.5992492
	speed: 0.0654s/iter; left time: 2855.4153s
Epoch: 7 cost time: 35.229511737823486
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.245 Vali Acc: 0.951 Test Loss: 0.245 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0208426
	speed: 0.3808s/iter; left time: 16572.9272s
	iters: 200, epoch: 8 | loss: 0.0645092
	speed: 0.0652s/iter; left time: 2830.4946s
	iters: 300, epoch: 8 | loss: 0.0002432
	speed: 0.0466s/iter; left time: 2017.7815s
	iters: 400, epoch: 8 | loss: 0.0040903
	speed: 0.0523s/iter; left time: 2260.1327s
Epoch: 8 cost time: 28.640586137771606
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.966265 --> -0.969695).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0062175
	speed: 0.3768s/iter; left time: 16219.4507s
	iters: 200, epoch: 9 | loss: 0.0823339
	speed: 0.0750s/iter; left time: 3219.8786s
	iters: 300, epoch: 9 | loss: 0.0040081
	speed: 0.0721s/iter; left time: 3088.0405s
	iters: 400, epoch: 9 | loss: 0.0091276
	speed: 0.0661s/iter; left time: 2823.7711s
Epoch: 9 cost time: 34.030210733413696
Epoch: 9, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.969695 --> -0.973412).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0032476
	speed: 0.3882s/iter; left time: 16530.4502s
	iters: 200, epoch: 10 | loss: 0.0546301
	speed: 0.0670s/iter; left time: 2845.4661s
	iters: 300, epoch: 10 | loss: 0.0236098
	speed: 0.0681s/iter; left time: 2887.4249s
	iters: 400, epoch: 10 | loss: 0.0185567
	speed: 0.0638s/iter; left time: 2698.3868s
Epoch: 10 cost time: 32.97303652763367
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.209 Vali Acc: 0.961 Test Loss: 0.209 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0033309
	speed: 0.2934s/iter; left time: 12353.7890s
	iters: 200, epoch: 11 | loss: 0.0001701
	speed: 0.0520s/iter; left time: 2183.2925s
	iters: 300, epoch: 11 | loss: 0.0022498
	speed: 0.0636s/iter; left time: 2666.7508s
	iters: 400, epoch: 11 | loss: 0.0291305
	speed: 0.0826s/iter; left time: 3453.4320s
Epoch: 11 cost time: 31.042012929916382
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007945
	speed: 0.4149s/iter; left time: 17276.8035s
	iters: 200, epoch: 12 | loss: 0.0459361
	speed: 0.0888s/iter; left time: 3690.8498s
	iters: 300, epoch: 12 | loss: 0.0024213
	speed: 0.0864s/iter; left time: 3581.9203s
	iters: 400, epoch: 12 | loss: 0.0001239
	speed: 0.0862s/iter; left time: 3564.4944s
Epoch: 12 cost time: 40.88356876373291
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.974556).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0351531
	speed: 0.4235s/iter; left time: 17438.7544s
	iters: 200, epoch: 13 | loss: 0.0022503
	speed: 0.0915s/iter; left time: 3759.5237s
	iters: 300, epoch: 13 | loss: 0.0107435
	speed: 0.0920s/iter; left time: 3771.3567s
	iters: 400, epoch: 13 | loss: 0.0013985
	speed: 0.0811s/iter; left time: 3313.8356s
Epoch: 13 cost time: 40.91303849220276
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0097786
	speed: 0.3978s/iter; left time: 16191.7480s
	iters: 200, epoch: 14 | loss: 0.0510264
	speed: 0.0749s/iter; left time: 3041.8242s
	iters: 300, epoch: 14 | loss: 0.1190252
	speed: 0.0673s/iter; left time: 2726.1803s
	iters: 400, epoch: 14 | loss: 0.0026449
	speed: 0.0726s/iter; left time: 2931.7277s
Epoch: 14 cost time: 35.357293367385864
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0008981
	speed: 0.3961s/iter; left time: 15938.9548s
	iters: 200, epoch: 15 | loss: 0.0035437
	speed: 0.0628s/iter; left time: 2520.5070s
	iters: 300, epoch: 15 | loss: 0.0011869
	speed: 0.0496s/iter; left time: 1984.9949s
	iters: 400, epoch: 15 | loss: 0.0330039
	speed: 0.0513s/iter; left time: 2050.6144s
Epoch: 15 cost time: 29.279863357543945
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2137651
	speed: 0.3893s/iter; left time: 15479.0785s
	iters: 200, epoch: 16 | loss: 0.0009483
	speed: 0.0743s/iter; left time: 2946.6173s
	iters: 300, epoch: 16 | loss: 0.0008043
	speed: 0.0735s/iter; left time: 2906.6876s
	iters: 400, epoch: 16 | loss: 0.0006236
	speed: 0.0705s/iter; left time: 2781.4688s
Epoch: 16 cost time: 35.40609049797058
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0015841
	speed: 0.3910s/iter; left time: 15364.1196s
	iters: 200, epoch: 17 | loss: 0.0003834
	speed: 0.0714s/iter; left time: 2799.3706s
	iters: 300, epoch: 17 | loss: 0.0007952
	speed: 0.0726s/iter; left time: 2839.2400s
	iters: 400, epoch: 17 | loss: 0.0141256
	speed: 0.0822s/iter; left time: 3205.3645s
Epoch: 17 cost time: 35.96966862678528
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0001224
	speed: 0.3882s/iter; left time: 15072.9326s
	iters: 200, epoch: 18 | loss: 0.0625438
	speed: 0.0804s/iter; left time: 3113.3638s
	iters: 300, epoch: 18 | loss: 0.0055012
	speed: 0.0607s/iter; left time: 2345.1300s
	iters: 400, epoch: 18 | loss: 0.0021747
	speed: 0.0527s/iter; left time: 2030.9033s
Epoch: 18 cost time: 31.689364671707153
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.1244470
	speed: 0.3817s/iter; left time: 14642.6607s
	iters: 200, epoch: 19 | loss: 0.2624203
	speed: 0.0835s/iter; left time: 3192.8073s
	iters: 300, epoch: 19 | loss: 0.4971386
	speed: 0.0838s/iter; left time: 3196.1873s
	iters: 400, epoch: 19 | loss: 0.0008689
	speed: 0.0768s/iter; left time: 2922.0153s
Epoch: 19 cost time: 37.12489128112793
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3087644
	speed: 0.3692s/iter; left time: 13989.4200s
	iters: 200, epoch: 20 | loss: 0.0000750
	speed: 0.0721s/iter; left time: 2724.0903s
	iters: 300, epoch: 20 | loss: 0.0021818
	speed: 0.0666s/iter; left time: 2510.4699s
	iters: 400, epoch: 20 | loss: 0.0206561
	speed: 0.0700s/iter; left time: 2632.3552s
Epoch: 20 cost time: 33.66461110115051
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0003458
	speed: 0.3674s/iter; left time: 13749.0404s
	iters: 200, epoch: 21 | loss: 0.0065574
	speed: 0.0725s/iter; left time: 2706.9340s
	iters: 300, epoch: 21 | loss: 0.0006766
	speed: 0.0635s/iter; left time: 2363.1681s
	iters: 400, epoch: 21 | loss: 0.0012787
	speed: 0.0446s/iter; left time: 1655.7688s
Epoch: 21 cost time: 28.86967968940735
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976843).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0016552
	speed: 0.3282s/iter; left time: 12127.1979s
	iters: 200, epoch: 22 | loss: 0.0006990
	speed: 0.0691s/iter; left time: 2545.6037s
	iters: 300, epoch: 22 | loss: 0.0003325
	speed: 0.0652s/iter; left time: 2397.4806s
	iters: 400, epoch: 22 | loss: 0.0029782
	speed: 0.0700s/iter; left time: 2564.4731s
Epoch: 22 cost time: 33.597530126571655
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0241545
	speed: 0.3882s/iter; left time: 14163.1099s
	iters: 200, epoch: 23 | loss: 0.0004589
	speed: 0.0722s/iter; left time: 2627.8034s
	iters: 300, epoch: 23 | loss: 0.0405960
	speed: 0.0583s/iter; left time: 2114.6916s
	iters: 400, epoch: 23 | loss: 0.0002431
	speed: 0.0573s/iter; left time: 2073.4194s
Epoch: 23 cost time: 32.45039629936218
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0171675
	speed: 0.3790s/iter; left time: 13648.9805s
	iters: 200, epoch: 24 | loss: 0.0000968
	speed: 0.0807s/iter; left time: 2897.1657s
	iters: 300, epoch: 24 | loss: 0.2021765
	speed: 0.0789s/iter; left time: 2826.5441s
	iters: 400, epoch: 24 | loss: 0.0295833
	speed: 0.0798s/iter; left time: 2851.0593s
Epoch: 24 cost time: 36.51180124282837
Epoch: 24, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0059336
	speed: 0.3856s/iter; left time: 13705.1174s
	iters: 200, epoch: 25 | loss: 0.0000194
	speed: 0.0858s/iter; left time: 3040.0119s
	iters: 300, epoch: 25 | loss: 0.0026526
	speed: 0.0594s/iter; left time: 2101.1508s
	iters: 400, epoch: 25 | loss: 0.0002292
	speed: 0.0470s/iter; left time: 1657.6981s
Epoch: 25 cost time: 31.61896848678589
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0180848
	speed: 0.3784s/iter; left time: 13273.3470s
	iters: 200, epoch: 26 | loss: 0.0000251
	speed: 0.0764s/iter; left time: 2672.4657s
	iters: 300, epoch: 26 | loss: 0.0182570
	speed: 0.0749s/iter; left time: 2613.4702s
	iters: 400, epoch: 26 | loss: 0.0001901
	speed: 0.0742s/iter; left time: 2579.7336s
Epoch: 26 cost time: 36.63878679275513
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000473
	speed: 0.3389s/iter; left time: 11729.5678s
	iters: 200, epoch: 27 | loss: 0.2020536
	speed: 0.0733s/iter; left time: 2530.9007s
	iters: 300, epoch: 27 | loss: 0.0016431
	speed: 0.0836s/iter; left time: 2878.0130s
	iters: 400, epoch: 27 | loss: 0.0893156
	speed: 0.0743s/iter; left time: 2550.1464s
Epoch: 27 cost time: 33.80381464958191
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.2667242
	speed: 0.3522s/iter; left time: 12023.9816s
	iters: 200, epoch: 28 | loss: 0.0001401
	speed: 0.0742s/iter; left time: 2524.0216s
	iters: 300, epoch: 28 | loss: 0.0017699
	speed: 0.0717s/iter; left time: 2433.4456s
	iters: 400, epoch: 28 | loss: 0.0022075
	speed: 0.0773s/iter; left time: 2614.2959s
Epoch: 28 cost time: 36.60422730445862
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1415051
	speed: 0.3470s/iter; left time: 11684.5370s
	iters: 200, epoch: 29 | loss: 0.0054288
	speed: 0.0695s/iter; left time: 2332.6329s
	iters: 300, epoch: 29 | loss: 0.0007059
	speed: 0.0701s/iter; left time: 2346.4871s
	iters: 400, epoch: 29 | loss: 0.0000879
	speed: 0.0680s/iter; left time: 2269.0656s
Epoch: 29 cost time: 32.36723709106445
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977128).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000676
	speed: 0.3943s/iter; left time: 13091.5101s
	iters: 200, epoch: 30 | loss: 0.0021686
	speed: 0.0765s/iter; left time: 2532.3951s
	iters: 300, epoch: 30 | loss: 0.0010091
	speed: 0.0817s/iter; left time: 2697.2778s
	iters: 400, epoch: 30 | loss: 0.0001164
	speed: 0.0872s/iter; left time: 2869.5385s
Epoch: 30 cost time: 38.58028483390808
Epoch: 30, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0001079
	speed: 0.3421s/iter; left time: 11196.0454s
	iters: 200, epoch: 31 | loss: 0.0025172
	speed: 0.0547s/iter; left time: 1786.0275s
	iters: 300, epoch: 31 | loss: 0.0263883
	speed: 0.0709s/iter; left time: 2307.4102s
	iters: 400, epoch: 31 | loss: 1.0786363
	speed: 0.0721s/iter; left time: 2338.5502s
Epoch: 31 cost time: 30.003384590148926
Epoch: 31, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0962771
	speed: 0.3612s/iter; left time: 11652.3574s
	iters: 200, epoch: 32 | loss: 0.0000020
	speed: 0.0740s/iter; left time: 2379.9883s
	iters: 300, epoch: 32 | loss: 0.0003829
	speed: 0.0679s/iter; left time: 2175.8317s
	iters: 400, epoch: 32 | loss: 0.0007811
	speed: 0.0717s/iter; left time: 2291.1067s
Epoch: 32 cost time: 34.94456362724304
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
Validation loss decreased (-0.977128 --> -0.978558).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0004482
	speed: 0.3898s/iter; left time: 12392.8346s
	iters: 200, epoch: 33 | loss: 0.0007737
	speed: 0.0710s/iter; left time: 2251.5636s
	iters: 300, epoch: 33 | loss: 0.0000004
	speed: 0.0490s/iter; left time: 1549.3177s
	iters: 400, epoch: 33 | loss: 0.0000331
	speed: 0.0472s/iter; left time: 1486.0619s
Epoch: 33 cost time: 28.62676477432251
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0008695
	speed: 0.3646s/iter; left time: 11421.2191s
	iters: 200, epoch: 34 | loss: 0.0001180
	speed: 0.0708s/iter; left time: 2209.1439s
	iters: 300, epoch: 34 | loss: 0.0005736
	speed: 0.0753s/iter; left time: 2345.1780s
	iters: 400, epoch: 34 | loss: 0.0002812
	speed: 0.0846s/iter; left time: 2623.2313s
Epoch: 34 cost time: 35.967857122421265
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981417).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000474
	speed: 0.3663s/iter; left time: 11301.9996s
	iters: 200, epoch: 35 | loss: 0.0000134
	speed: 0.0743s/iter; left time: 2285.0726s
	iters: 300, epoch: 35 | loss: 0.0006359
	speed: 0.0778s/iter; left time: 2383.5719s
	iters: 400, epoch: 35 | loss: 0.0022481
	speed: 0.0551s/iter; left time: 1683.1872s
Epoch: 35 cost time: 32.01375889778137
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0079540
	speed: 0.3576s/iter; left time: 10866.1508s
	iters: 200, epoch: 36 | loss: 0.0320372
	speed: 0.0869s/iter; left time: 2631.8357s
	iters: 300, epoch: 36 | loss: 0.0000432
	speed: 0.0797s/iter; left time: 2406.7096s
	iters: 400, epoch: 36 | loss: 0.0000072
	speed: 0.0820s/iter; left time: 2465.7475s
Epoch: 36 cost time: 38.67664051055908
Epoch: 36, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.982846).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000469
	speed: 0.4078s/iter; left time: 12199.5265s
	iters: 200, epoch: 37 | loss: 0.0004445
	speed: 0.0788s/iter; left time: 2349.8830s
	iters: 300, epoch: 37 | loss: 0.0017305
	speed: 0.0734s/iter; left time: 2182.2470s
	iters: 400, epoch: 37 | loss: 0.0000259
	speed: 0.0719s/iter; left time: 2128.3423s
Epoch: 37 cost time: 36.67364716529846
Epoch: 37, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.1968444
	speed: 0.3792s/iter; left time: 11166.8463s
	iters: 200, epoch: 38 | loss: 0.0000177
	speed: 0.0680s/iter; left time: 1996.8598s
	iters: 300, epoch: 38 | loss: 0.0000112
	speed: 0.0528s/iter; left time: 1543.9597s
	iters: 400, epoch: 38 | loss: 0.0000074
	speed: 0.0516s/iter; left time: 1502.6282s
Epoch: 38 cost time: 27.928187370300293
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0000007
	speed: 0.3516s/iter; left time: 10190.3977s
	iters: 200, epoch: 39 | loss: 0.0001606
	speed: 0.0709s/iter; left time: 2048.5608s
	iters: 300, epoch: 39 | loss: 0.0019442
	speed: 0.0775s/iter; left time: 2229.5475s
	iters: 400, epoch: 39 | loss: 0.0002573
	speed: 0.0766s/iter; left time: 2196.0070s
Epoch: 39 cost time: 36.12747073173523
Epoch: 39, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0011573
	speed: 0.3941s/iter; left time: 11235.3561s
	iters: 200, epoch: 40 | loss: 0.0000509
	speed: 0.0899s/iter; left time: 2555.3064s
	iters: 300, epoch: 40 | loss: 0.0027939
	speed: 0.0870s/iter; left time: 2461.7207s
	iters: 400, epoch: 40 | loss: 0.0000117
	speed: 0.0792s/iter; left time: 2235.1512s
Epoch: 40 cost time: 39.24753451347351
Epoch: 40, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0000288
	speed: 0.3867s/iter; left time: 10843.2936s
	iters: 200, epoch: 41 | loss: 0.0002932
	speed: 0.0483s/iter; left time: 1350.5161s
	iters: 300, epoch: 41 | loss: 0.0014075
	speed: 0.0477s/iter; left time: 1328.2228s
	iters: 400, epoch: 41 | loss: 0.0000016
	speed: 0.0645s/iter; left time: 1790.6078s
Epoch: 41 cost time: 28.551438093185425
Epoch: 41, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0000114
	speed: 0.3742s/iter; left time: 10317.4610s
	iters: 200, epoch: 42 | loss: 0.0000960
	speed: 0.0701s/iter; left time: 1926.1932s
	iters: 300, epoch: 42 | loss: 0.0000005
	speed: 0.0689s/iter; left time: 1886.2375s
	iters: 400, epoch: 42 | loss: 0.0000746
	speed: 0.0737s/iter; left time: 2009.3239s
Epoch: 42 cost time: 33.38065505027771
Epoch: 42, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0021130
	speed: 0.3130s/iter; left time: 8483.9443s
	iters: 200, epoch: 43 | loss: 0.0000094
	speed: 0.0673s/iter; left time: 1817.9641s
	iters: 300, epoch: 43 | loss: 0.0003009
	speed: 0.0678s/iter; left time: 1824.7596s
	iters: 400, epoch: 43 | loss: 0.0012889
	speed: 0.0696s/iter; left time: 1864.1636s
Epoch: 43 cost time: 31.410338163375854
Epoch: 43, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0012256
	speed: 0.2894s/iter; left time: 7707.2198s
	iters: 200, epoch: 44 | loss: 0.0000373
	speed: 0.0758s/iter; left time: 2012.5415s
	iters: 300, epoch: 44 | loss: 0.0013265
	speed: 0.0719s/iter; left time: 1899.5703s
	iters: 400, epoch: 44 | loss: 0.0003413
	speed: 0.0601s/iter; left time: 1581.9272s
Epoch: 44 cost time: 30.92833423614502
Epoch: 44, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.4317970
	speed: 0.3453s/iter; left time: 9035.9924s
	iters: 200, epoch: 45 | loss: 0.0030659
	speed: 0.0617s/iter; left time: 1608.7509s
	iters: 300, epoch: 45 | loss: 0.0000391
	speed: 0.0588s/iter; left time: 1527.4244s
	iters: 400, epoch: 45 | loss: 0.0000089
	speed: 0.0618s/iter; left time: 1597.4270s
Epoch: 45 cost time: 30.30614471435547
Epoch: 45, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.972 Test Loss: 0.208 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0001111
	speed: 0.3707s/iter; left time: 9526.0051s
	iters: 200, epoch: 46 | loss: 0.3068013
	speed: 0.0738s/iter; left time: 1890.0713s
	iters: 300, epoch: 46 | loss: 0.0026994
	speed: 0.0748s/iter; left time: 1907.6910s
	iters: 400, epoch: 46 | loss: 0.0001074
	speed: 0.0799s/iter; left time: 2028.3944s
Epoch: 46 cost time: 35.06955337524414
Epoch: 46, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.163 Vali Acc: 0.979 Test Loss: 0.163 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 553530
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4723372
	speed: 0.0944s/iter; left time: 4419.4862s
	iters: 200, epoch: 1 | loss: 0.2668367
	speed: 0.0707s/iter; left time: 3303.2747s
	iters: 300, epoch: 1 | loss: 0.0221326
	speed: 0.0619s/iter; left time: 2884.8475s
	iters: 400, epoch: 1 | loss: 0.0502851
	speed: 0.0593s/iter; left time: 2758.3610s
Epoch: 1 cost time: 32.855449199676514
Epoch: 1, Steps: 469 | Train Loss: 0.415 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (inf --> -0.943394).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0372695
	speed: 0.3185s/iter; left time: 14758.2118s
	iters: 200, epoch: 2 | loss: 0.0927627
	speed: 0.0595s/iter; left time: 2749.6189s
	iters: 300, epoch: 2 | loss: 0.0024856
	speed: 0.0569s/iter; left time: 2626.0823s
	iters: 400, epoch: 2 | loss: 0.0029206
	speed: 0.0568s/iter; left time: 2613.1472s
Epoch: 2 cost time: 28.130898237228394
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.943394 --> -0.967980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0075689
	speed: 0.3298s/iter; left time: 15125.6070s
	iters: 200, epoch: 3 | loss: 0.2198043
	speed: 0.0571s/iter; left time: 2611.2076s
	iters: 300, epoch: 3 | loss: 0.0082506
	speed: 0.0602s/iter; left time: 2751.1520s
	iters: 400, epoch: 3 | loss: 0.0016512
	speed: 0.0547s/iter; left time: 2490.6457s
Epoch: 3 cost time: 27.469043016433716
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0604710
	speed: 0.3070s/iter; left time: 13937.0019s
	iters: 200, epoch: 4 | loss: 0.1614162
	speed: 0.0658s/iter; left time: 2979.2421s
	iters: 300, epoch: 4 | loss: 0.8326601
	speed: 0.0749s/iter; left time: 3385.1934s
	iters: 400, epoch: 4 | loss: 0.1651476
	speed: 0.0687s/iter; left time: 3096.1596s
Epoch: 4 cost time: 32.72400379180908
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0048965
	speed: 0.3139s/iter; left time: 14099.8520s
	iters: 200, epoch: 5 | loss: 0.0203744
	speed: 0.0531s/iter; left time: 2378.0092s
	iters: 300, epoch: 5 | loss: 0.0182530
	speed: 0.0488s/iter; left time: 2182.4373s
	iters: 400, epoch: 5 | loss: 0.1404462
	speed: 0.0560s/iter; left time: 2501.1560s
Epoch: 5 cost time: 26.08832311630249
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0123992
	speed: 0.3243s/iter; left time: 14414.9241s
	iters: 200, epoch: 6 | loss: 0.0005900
	speed: 0.0710s/iter; left time: 3149.2923s
	iters: 300, epoch: 6 | loss: 0.2216664
	speed: 0.0696s/iter; left time: 3079.0892s
	iters: 400, epoch: 6 | loss: 0.0042514
	speed: 0.0707s/iter; left time: 3119.8099s
Epoch: 6 cost time: 33.198570251464844
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.967980 --> -0.974555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0005814
	speed: 0.3046s/iter; left time: 13399.5800s
	iters: 200, epoch: 7 | loss: 0.0056762
	speed: 0.0671s/iter; left time: 2942.6990s
	iters: 300, epoch: 7 | loss: 0.4741522
	speed: 0.0614s/iter; left time: 2689.2188s
	iters: 400, epoch: 7 | loss: 0.5440578
	speed: 0.0570s/iter; left time: 2491.8934s
Epoch: 7 cost time: 30.4893536567688
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0111246
	speed: 0.3375s/iter; left time: 14689.3674s
	iters: 200, epoch: 8 | loss: 0.0825691
	speed: 0.0574s/iter; left time: 2491.3665s
	iters: 300, epoch: 8 | loss: 0.0002888
	speed: 0.0430s/iter; left time: 1863.0812s
	iters: 400, epoch: 8 | loss: 0.0012028
	speed: 0.0451s/iter; left time: 1949.4017s
Epoch: 8 cost time: 24.288309335708618
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0011554
	speed: 0.3096s/iter; left time: 13329.7964s
	iters: 200, epoch: 9 | loss: 0.0013268
	speed: 0.0605s/iter; left time: 2599.4700s
	iters: 300, epoch: 9 | loss: 0.0005350
	speed: 0.0541s/iter; left time: 2317.3251s
	iters: 400, epoch: 9 | loss: 0.0001905
	speed: 0.0584s/iter; left time: 2496.5091s
Epoch: 9 cost time: 28.189217567443848
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0506849
	speed: 0.3223s/iter; left time: 13723.5945s
	iters: 200, epoch: 10 | loss: 0.0338223
	speed: 0.0633s/iter; left time: 2687.5413s
	iters: 300, epoch: 10 | loss: 0.1397646
	speed: 0.0644s/iter; left time: 2727.5626s
	iters: 400, epoch: 10 | loss: 0.0036271
	speed: 0.0689s/iter; left time: 2913.9003s
Epoch: 10 cost time: 30.258108377456665
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001110
	speed: 0.2836s/iter; left time: 11942.5713s
	iters: 200, epoch: 11 | loss: 0.0002420
	speed: 0.0771s/iter; left time: 3238.2063s
	iters: 300, epoch: 11 | loss: 0.0060325
	speed: 0.0785s/iter; left time: 3291.2054s
	iters: 400, epoch: 11 | loss: 0.0053355
	speed: 0.0705s/iter; left time: 2949.1579s
Epoch: 11 cost time: 34.51938486099243
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0118076
	speed: 0.3499s/iter; left time: 14568.7759s
	iters: 200, epoch: 12 | loss: 0.0065549
	speed: 0.0660s/iter; left time: 2742.7365s
	iters: 300, epoch: 12 | loss: 0.0003475
	speed: 0.0648s/iter; left time: 2685.8427s
	iters: 400, epoch: 12 | loss: 0.0059398
	speed: 0.0687s/iter; left time: 2840.4526s
Epoch: 12 cost time: 32.12614965438843
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.982 Test Loss: 0.151 Test Acc: 0.982
Validation loss decreased (-0.974555 --> -0.982274).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0610581
	speed: 0.2934s/iter; left time: 12081.6048s
	iters: 200, epoch: 13 | loss: 0.0284104
	speed: 0.0648s/iter; left time: 2659.7987s
	iters: 300, epoch: 13 | loss: 0.1672103
	speed: 0.0699s/iter; left time: 2862.5595s
	iters: 400, epoch: 13 | loss: 0.0424257
	speed: 0.0616s/iter; left time: 2516.1086s
Epoch: 13 cost time: 29.454455375671387
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001546
	speed: 0.3365s/iter; left time: 13695.5728s
	iters: 200, epoch: 14 | loss: 0.0010128
	speed: 0.0604s/iter; left time: 2453.8299s
	iters: 300, epoch: 14 | loss: 0.1384572
	speed: 0.0624s/iter; left time: 2528.1538s
	iters: 400, epoch: 14 | loss: 0.0000984
	speed: 0.0708s/iter; left time: 2860.5059s
Epoch: 14 cost time: 31.075486183166504
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002946
	speed: 0.3279s/iter; left time: 13191.5988s
	iters: 200, epoch: 15 | loss: 0.0003947
	speed: 0.0596s/iter; left time: 2391.2357s
	iters: 300, epoch: 15 | loss: 0.0006009
	speed: 0.0653s/iter; left time: 2614.9146s
	iters: 400, epoch: 15 | loss: 0.5240762
	speed: 0.0581s/iter; left time: 2321.3012s
Epoch: 15 cost time: 28.3479483127594
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002914
	speed: 0.2683s/iter; left time: 10669.1392s
	iters: 200, epoch: 16 | loss: 0.0000238
	speed: 0.0615s/iter; left time: 2437.8349s
	iters: 300, epoch: 16 | loss: 0.0000353
	speed: 0.0583s/iter; left time: 2307.5748s
	iters: 400, epoch: 16 | loss: 0.0000077
	speed: 0.0553s/iter; left time: 2184.2214s
Epoch: 16 cost time: 28.540666103363037
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.969 Test Loss: 0.218 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0004113
	speed: 0.3373s/iter; left time: 13253.1585s
	iters: 200, epoch: 17 | loss: 0.0000280
	speed: 0.0647s/iter; left time: 2535.2974s
	iters: 300, epoch: 17 | loss: 0.0027000
	speed: 0.0691s/iter; left time: 2699.8468s
	iters: 400, epoch: 17 | loss: 0.2183308
	speed: 0.0707s/iter; left time: 2758.3856s
Epoch: 17 cost time: 31.98723864555359
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0131798
	speed: 0.3238s/iter; left time: 12572.4734s
	iters: 200, epoch: 18 | loss: 0.0140866
	speed: 0.0733s/iter; left time: 2836.9744s
	iters: 300, epoch: 18 | loss: 0.0097326
	speed: 0.0727s/iter; left time: 2808.4480s
	iters: 400, epoch: 18 | loss: 0.0004944
	speed: 0.0772s/iter; left time: 2975.0085s
Epoch: 18 cost time: 35.7117702960968
Epoch: 18, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.982274 --> -0.982560).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0021707
	speed: 0.3562s/iter; left time: 13664.3720s
	iters: 200, epoch: 19 | loss: 0.0011596
	speed: 0.0615s/iter; left time: 2351.7688s
	iters: 300, epoch: 19 | loss: 0.2567655
	speed: 0.0700s/iter; left time: 2672.4672s
	iters: 400, epoch: 19 | loss: 0.0000012
	speed: 0.0749s/iter; left time: 2851.9236s
Epoch: 19 cost time: 32.34937620162964
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1989270
	speed: 0.3176s/iter; left time: 12032.7819s
	iters: 200, epoch: 20 | loss: 0.0006077
	speed: 0.0654s/iter; left time: 2469.6850s
	iters: 300, epoch: 20 | loss: 0.0000532
	speed: 0.0798s/iter; left time: 3008.3006s
	iters: 400, epoch: 20 | loss: 0.0019806
	speed: 0.0748s/iter; left time: 2812.7050s
Epoch: 20 cost time: 33.101091623306274
Epoch: 20, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.981 Test Loss: 0.142 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000476
	speed: 0.2837s/iter; left time: 10616.7808s
	iters: 200, epoch: 21 | loss: 0.0101668
	speed: 0.0741s/iter; left time: 2765.9294s
	iters: 300, epoch: 21 | loss: 0.0082624
	speed: 0.0690s/iter; left time: 2569.3303s
	iters: 400, epoch: 21 | loss: 0.0098875
	speed: 0.0693s/iter; left time: 2574.1357s
Epoch: 21 cost time: 33.25386595726013
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.984 Test Loss: 0.130 Test Acc: 0.984
Validation loss decreased (-0.982560 --> -0.983990).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2675717
	speed: 0.3319s/iter; left time: 12262.6914s
	iters: 200, epoch: 22 | loss: 0.0868737
	speed: 0.0688s/iter; left time: 2536.2801s
	iters: 300, epoch: 22 | loss: 0.0000024
	speed: 0.0708s/iter; left time: 2603.3024s
	iters: 400, epoch: 22 | loss: 0.0092707
	speed: 0.0589s/iter; left time: 2157.1819s
Epoch: 22 cost time: 30.953423023223877
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0011206
	speed: 0.3213s/iter; left time: 11722.7502s
	iters: 200, epoch: 23 | loss: 0.0000940
	speed: 0.0718s/iter; left time: 2610.6557s
	iters: 300, epoch: 23 | loss: 0.0105057
	speed: 0.0666s/iter; left time: 2416.9021s
	iters: 400, epoch: 23 | loss: 0.0004527
	speed: 0.0675s/iter; left time: 2443.3218s
Epoch: 23 cost time: 33.48535680770874
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.4442114
	speed: 0.3227s/iter; left time: 11620.3782s
	iters: 200, epoch: 24 | loss: 0.0031711
	speed: 0.0680s/iter; left time: 2443.0370s
	iters: 300, epoch: 24 | loss: 0.0000388
	speed: 0.0696s/iter; left time: 2492.2977s
	iters: 400, epoch: 24 | loss: 0.0091273
	speed: 0.0691s/iter; left time: 2466.5785s
Epoch: 24 cost time: 32.63661861419678
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0140927
	speed: 0.3475s/iter; left time: 12353.5475s
	iters: 200, epoch: 25 | loss: 0.0000007
	speed: 0.0509s/iter; left time: 1804.0409s
	iters: 300, epoch: 25 | loss: 0.0001120
	speed: 0.0449s/iter; left time: 1586.9361s
	iters: 400, epoch: 25 | loss: 0.0002228
	speed: 0.0491s/iter; left time: 1731.0897s
Epoch: 25 cost time: 25.455172061920166
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0036692
	speed: 0.3205s/iter; left time: 11242.0991s
	iters: 200, epoch: 26 | loss: 0.3134338
	speed: 0.0540s/iter; left time: 1888.0169s
	iters: 300, epoch: 26 | loss: 0.0985779
	speed: 0.0560s/iter; left time: 1954.3053s
	iters: 400, epoch: 26 | loss: 0.0000010
	speed: 0.0576s/iter; left time: 2003.2666s
Epoch: 26 cost time: 27.12447237968445
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000620
	speed: 0.3269s/iter; left time: 11314.2806s
	iters: 200, epoch: 27 | loss: 0.0181103
	speed: 0.0618s/iter; left time: 2133.0657s
	iters: 300, epoch: 27 | loss: 0.0000288
	speed: 0.0638s/iter; left time: 2193.5764s
	iters: 400, epoch: 27 | loss: 0.0000084
	speed: 0.0682s/iter; left time: 2339.9523s
Epoch: 27 cost time: 31.12458324432373
Epoch: 27, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0002898
	speed: 0.2984s/iter; left time: 10186.4744s
	iters: 200, epoch: 28 | loss: 0.0000332
	speed: 0.0675s/iter; left time: 2297.4037s
	iters: 300, epoch: 28 | loss: 0.0000329
	speed: 0.0676s/iter; left time: 2294.4706s
	iters: 400, epoch: 28 | loss: 0.0321793
	speed: 0.0705s/iter; left time: 2386.0035s
Epoch: 28 cost time: 30.799805879592896
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.984 Test Loss: 0.166 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984275).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0060272
	speed: 0.3439s/iter; left time: 11579.6908s
	iters: 200, epoch: 29 | loss: 0.0000027
	speed: 0.0606s/iter; left time: 2035.8768s
	iters: 300, epoch: 29 | loss: 0.0005510
	speed: 0.0771s/iter; left time: 2581.6514s
	iters: 400, epoch: 29 | loss: 0.0000001
	speed: 0.0761s/iter; left time: 2541.0111s
Epoch: 29 cost time: 33.25897145271301
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.983 Test Loss: 0.142 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0000034
	speed: 0.2782s/iter; left time: 9235.8269s
	iters: 200, epoch: 30 | loss: 0.0000169
	speed: 0.0655s/iter; left time: 2169.6117s
	iters: 300, epoch: 30 | loss: 0.0003157
	speed: 0.0776s/iter; left time: 2562.3124s
	iters: 400, epoch: 30 | loss: 0.0127277
	speed: 0.0739s/iter; left time: 2432.5782s
Epoch: 30 cost time: 32.298851013183594
Epoch: 30, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000108
	speed: 0.3518s/iter; left time: 11513.8952s
	iters: 200, epoch: 31 | loss: 0.0001681
	speed: 0.0710s/iter; left time: 2316.9013s
	iters: 300, epoch: 31 | loss: 0.0002740
	speed: 0.0750s/iter; left time: 2438.2214s
	iters: 400, epoch: 31 | loss: 0.3480054
	speed: 0.0652s/iter; left time: 2115.3349s
Epoch: 31 cost time: 32.800376892089844
Epoch: 31, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.984 Test Loss: 0.134 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000235
	speed: 0.3354s/iter; left time: 10821.3069s
	iters: 200, epoch: 32 | loss: 0.0000001
	speed: 0.0458s/iter; left time: 1472.7972s
	iters: 300, epoch: 32 | loss: 0.3759274
	speed: 0.0397s/iter; left time: 1271.9949s
	iters: 400, epoch: 32 | loss: 0.0399293
	speed: 0.0410s/iter; left time: 1311.5817s
Epoch: 32 cost time: 22.902104139328003
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0000029
	speed: 0.3147s/iter; left time: 10006.3747s
	iters: 200, epoch: 33 | loss: 0.0046261
	speed: 0.0570s/iter; left time: 1806.9371s
	iters: 300, epoch: 33 | loss: 0.0000386
	speed: 0.0588s/iter; left time: 1858.2767s
	iters: 400, epoch: 33 | loss: 0.0003575
	speed: 0.0553s/iter; left time: 1742.4059s
Epoch: 33 cost time: 28.418973922729492
Epoch: 33, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.984 Test Loss: 0.104 Test Acc: 0.984
Validation loss decreased (-0.984275 --> -0.984276).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.4930371
	speed: 0.3328s/iter; left time: 10424.9725s
	iters: 200, epoch: 34 | loss: 0.0161900
	speed: 0.0612s/iter; left time: 1909.5808s
	iters: 300, epoch: 34 | loss: 0.0004570
	speed: 0.0670s/iter; left time: 2086.0313s
	iters: 400, epoch: 34 | loss: 0.0666330
	speed: 0.0735s/iter; left time: 2280.6778s
Epoch: 34 cost time: 31.49363660812378
Epoch: 34, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000017
	speed: 0.3416s/iter; left time: 10538.7236s
	iters: 200, epoch: 35 | loss: 0.0002256
	speed: 0.0600s/iter; left time: 1846.8027s
	iters: 300, epoch: 35 | loss: 0.0007135
	speed: 0.0554s/iter; left time: 1698.4449s
	iters: 400, epoch: 35 | loss: 0.0000365
	speed: 0.0597s/iter; left time: 1824.4421s
Epoch: 35 cost time: 29.39166569709778
Epoch: 35, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0002417
	speed: 0.3275s/iter; left time: 9951.4456s
	iters: 200, epoch: 36 | loss: 0.0001131
	speed: 0.0686s/iter; left time: 2077.7717s
	iters: 300, epoch: 36 | loss: 0.0006951
	speed: 0.0628s/iter; left time: 1894.4736s
	iters: 400, epoch: 36 | loss: 0.0000003
	speed: 0.0648s/iter; left time: 1948.7524s
Epoch: 36 cost time: 31.441048622131348
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.981 Test Loss: 0.168 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0000003
	speed: 0.2833s/iter; left time: 8475.6585s
	iters: 200, epoch: 37 | loss: 0.1755141
	speed: 0.0684s/iter; left time: 2038.1919s
	iters: 300, epoch: 37 | loss: 0.0081369
	speed: 0.0737s/iter; left time: 2190.1194s
	iters: 400, epoch: 37 | loss: 0.0000339
	speed: 0.0651s/iter; left time: 1928.0429s
Epoch: 37 cost time: 32.365169048309326
Epoch: 37, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.981 Test Loss: 0.173 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.1897987
	speed: 0.3540s/iter; left time: 10425.5631s
	iters: 200, epoch: 38 | loss: 0.0000017
	speed: 0.0611s/iter; left time: 1793.5277s
	iters: 300, epoch: 38 | loss: 0.0001064
	speed: 0.0600s/iter; left time: 1754.2470s
	iters: 400, epoch: 38 | loss: 0.0000000
	speed: 0.0666s/iter; left time: 1940.1894s
Epoch: 38 cost time: 31.07147455215454
Epoch: 38, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.978 Test Loss: 0.222 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0000001
	speed: 0.2992s/iter; left time: 8670.7283s
	iters: 200, epoch: 39 | loss: 0.0008443
	speed: 0.0557s/iter; left time: 1609.1621s
	iters: 300, epoch: 39 | loss: 0.0497873
	speed: 0.0569s/iter; left time: 1638.1050s
	iters: 400, epoch: 39 | loss: 0.0444188
	speed: 0.0645s/iter; left time: 1849.6528s
Epoch: 39 cost time: 28.801427841186523
Epoch: 39, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0024562
	speed: 0.3187s/iter; left time: 9086.2454s
	iters: 200, epoch: 40 | loss: 0.0000055
	speed: 0.0605s/iter; left time: 1718.4765s
	iters: 300, epoch: 40 | loss: 0.0000012
	speed: 0.0621s/iter; left time: 1758.7430s
	iters: 400, epoch: 40 | loss: 0.0001474
	speed: 0.0580s/iter; left time: 1634.8809s
Epoch: 40 cost time: 27.861482858657837
Epoch: 40, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.980 Test Loss: 0.193 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0000003
	speed: 0.2865s/iter; left time: 8034.7165s
	iters: 200, epoch: 41 | loss: 0.0000002
	speed: 0.0634s/iter; left time: 1770.2994s
	iters: 300, epoch: 41 | loss: 0.0000001
	speed: 0.0694s/iter; left time: 1933.0974s
	iters: 400, epoch: 41 | loss: 0.0000011
	speed: 0.0656s/iter; left time: 1820.5680s
Epoch: 41 cost time: 30.702268838882446
Epoch: 41, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.169 Vali Acc: 0.981 Test Loss: 0.169 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0001742
	speed: 0.3487s/iter; left time: 9615.2272s
	iters: 200, epoch: 42 | loss: 0.0013549
	speed: 0.0742s/iter; left time: 2037.1083s
	iters: 300, epoch: 42 | loss: 0.0000000
	speed: 0.0707s/iter; left time: 1934.1171s
	iters: 400, epoch: 42 | loss: 0.0000127
	speed: 0.0676s/iter; left time: 1844.5420s
Epoch: 42 cost time: 33.118855476379395
Epoch: 42, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.984 Test Loss: 0.137 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0234213
	speed: 0.2787s/iter; left time: 7553.6985s
	iters: 200, epoch: 43 | loss: 0.0016519
	speed: 0.0546s/iter; left time: 1474.6121s
	iters: 300, epoch: 43 | loss: 0.0000242
	speed: 0.0536s/iter; left time: 1443.1100s
	iters: 400, epoch: 43 | loss: 0.0027950
	speed: 0.0517s/iter; left time: 1386.4267s
Epoch: 43 cost time: 25.927711009979248
Epoch: 43, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 553530
model size : 7.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5610166
	speed: 0.0827s/iter; left time: 3869.2328s
	iters: 200, epoch: 1 | loss: 0.0518268
	speed: 0.0522s/iter; left time: 2435.9346s
	iters: 300, epoch: 1 | loss: 0.3230026
	speed: 0.0470s/iter; left time: 2191.2031s
	iters: 400, epoch: 1 | loss: 0.1298802
	speed: 0.0620s/iter; left time: 2883.8314s
Epoch: 1 cost time: 28.97650671005249
Epoch: 1, Steps: 469 | Train Loss: 0.450 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (inf --> -0.936533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1442779
	speed: 0.3479s/iter; left time: 16118.9867s
	iters: 200, epoch: 2 | loss: 0.1809780
	speed: 0.0724s/iter; left time: 3346.7085s
	iters: 300, epoch: 2 | loss: 0.0148768
	speed: 0.0670s/iter; left time: 3092.0989s
	iters: 400, epoch: 2 | loss: 0.0150315
	speed: 0.0616s/iter; left time: 2836.8319s
Epoch: 2 cost time: 31.734130382537842
Epoch: 2, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.936533 --> -0.951399).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0125023
	speed: 0.3376s/iter; left time: 15481.8918s
	iters: 200, epoch: 3 | loss: 0.0674165
	speed: 0.0582s/iter; left time: 2663.0165s
	iters: 300, epoch: 3 | loss: 0.0335711
	speed: 0.0583s/iter; left time: 2663.5213s
	iters: 400, epoch: 3 | loss: 0.0247171
	speed: 0.0620s/iter; left time: 2826.6171s
Epoch: 3 cost time: 29.721818685531616
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.951399 --> -0.960547).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0892961
	speed: 0.3118s/iter; left time: 14152.9976s
	iters: 200, epoch: 4 | loss: 0.0394652
	speed: 0.0658s/iter; left time: 2981.4517s
	iters: 300, epoch: 4 | loss: 0.0036377
	speed: 0.0694s/iter; left time: 3138.0475s
	iters: 400, epoch: 4 | loss: 0.0062435
	speed: 0.0688s/iter; left time: 3100.6003s
Epoch: 4 cost time: 31.249001026153564
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.960547 --> -0.970839).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0226578
	speed: 0.3146s/iter; left time: 14131.8434s
	iters: 200, epoch: 5 | loss: 0.0514010
	speed: 0.0701s/iter; left time: 3141.9541s
	iters: 300, epoch: 5 | loss: 0.0898961
	speed: 0.0636s/iter; left time: 2846.0759s
	iters: 400, epoch: 5 | loss: 0.0188371
	speed: 0.0605s/iter; left time: 2701.5902s
Epoch: 5 cost time: 31.692827701568604
Epoch: 5, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0040240
	speed: 0.3268s/iter; left time: 14527.4721s
	iters: 200, epoch: 6 | loss: 0.0767915
	speed: 0.0553s/iter; left time: 2453.9905s
	iters: 300, epoch: 6 | loss: 0.0032619
	speed: 0.0604s/iter; left time: 2672.7454s
	iters: 400, epoch: 6 | loss: 0.0095499
	speed: 0.0529s/iter; left time: 2334.0626s
Epoch: 6 cost time: 26.685641527175903
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0144031
	speed: 0.2647s/iter; left time: 11641.3354s
	iters: 200, epoch: 7 | loss: 0.0308838
	speed: 0.0576s/iter; left time: 2529.8603s
	iters: 300, epoch: 7 | loss: 0.0017013
	speed: 0.0621s/iter; left time: 2717.0778s
	iters: 400, epoch: 7 | loss: 0.1369609
	speed: 0.0551s/iter; left time: 2407.9419s
Epoch: 7 cost time: 27.4614577293396
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0147663
	speed: 0.3233s/iter; left time: 14070.5977s
	iters: 200, epoch: 8 | loss: 0.0017780
	speed: 0.0593s/iter; left time: 2573.2504s
	iters: 300, epoch: 8 | loss: 0.0137260
	speed: 0.0590s/iter; left time: 2555.6564s
	iters: 400, epoch: 8 | loss: 0.0982317
	speed: 0.0612s/iter; left time: 2645.7335s
Epoch: 8 cost time: 28.42909336090088
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.1105730
	speed: 0.2847s/iter; left time: 12253.9242s
	iters: 200, epoch: 9 | loss: 0.0008486
	speed: 0.0656s/iter; left time: 2815.3490s
	iters: 300, epoch: 9 | loss: 0.0076114
	speed: 0.0611s/iter; left time: 2617.5861s
	iters: 400, epoch: 9 | loss: 0.0553875
	speed: 0.0637s/iter; left time: 2723.9039s
Epoch: 9 cost time: 29.360368728637695
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.970839 --> -0.971697).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0043929
	speed: 0.3006s/iter; left time: 12797.7630s
	iters: 200, epoch: 10 | loss: 0.0100751
	speed: 0.0569s/iter; left time: 2415.5558s
	iters: 300, epoch: 10 | loss: 0.0152170
	speed: 0.0499s/iter; left time: 2114.1603s
	iters: 400, epoch: 10 | loss: 0.0040841
	speed: 0.0491s/iter; left time: 2075.2644s
Epoch: 10 cost time: 26.639198541641235
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.971697 --> -0.972269).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0068655
	speed: 0.3367s/iter; left time: 14176.7077s
	iters: 200, epoch: 11 | loss: 0.0101655
	speed: 0.0673s/iter; left time: 2825.8731s
	iters: 300, epoch: 11 | loss: 0.0886283
	speed: 0.0678s/iter; left time: 2840.2494s
	iters: 400, epoch: 11 | loss: 0.2095152
	speed: 0.0586s/iter; left time: 2451.7146s
Epoch: 11 cost time: 30.833096981048584
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
Validation loss decreased (-0.972269 --> -0.973698).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0068274
	speed: 0.3045s/iter; left time: 12680.8279s
	iters: 200, epoch: 12 | loss: 0.0022190
	speed: 0.0667s/iter; left time: 2772.3376s
	iters: 300, epoch: 12 | loss: 0.0056269
	speed: 0.0626s/iter; left time: 2595.5363s
	iters: 400, epoch: 12 | loss: 0.0040987
	speed: 0.0586s/iter; left time: 2422.1392s
Epoch: 12 cost time: 30.38125467300415
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0002346
	speed: 0.3233s/iter; left time: 13310.2901s
	iters: 200, epoch: 13 | loss: 0.1082338
	speed: 0.0544s/iter; left time: 2234.2934s
	iters: 300, epoch: 13 | loss: 0.0129799
	speed: 0.0570s/iter; left time: 2335.8182s
	iters: 400, epoch: 13 | loss: 0.0034823
	speed: 0.0613s/iter; left time: 2505.5973s
Epoch: 13 cost time: 27.833969831466675
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974842).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000238
	speed: 0.2756s/iter; left time: 11219.7973s
	iters: 200, epoch: 14 | loss: 0.0045979
	speed: 0.0591s/iter; left time: 2399.8318s
	iters: 300, epoch: 14 | loss: 0.0003052
	speed: 0.0583s/iter; left time: 2359.9309s
	iters: 400, epoch: 14 | loss: 0.1093044
	speed: 0.0575s/iter; left time: 2324.9240s
Epoch: 14 cost time: 27.113781690597534
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977415).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0271015
	speed: 0.3196s/iter; left time: 12858.9199s
	iters: 200, epoch: 15 | loss: 0.1040349
	speed: 0.0651s/iter; left time: 2613.1296s
	iters: 300, epoch: 15 | loss: 0.0658032
	speed: 0.0628s/iter; left time: 2516.1015s
	iters: 400, epoch: 15 | loss: 0.0373945
	speed: 0.0532s/iter; left time: 2126.3678s
Epoch: 15 cost time: 29.018808126449585
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0000285
	speed: 0.3087s/iter; left time: 12277.2212s
	iters: 200, epoch: 16 | loss: 0.0235043
	speed: 0.0731s/iter; left time: 2901.5462s
	iters: 300, epoch: 16 | loss: 0.0003591
	speed: 0.0679s/iter; left time: 2686.6978s
	iters: 400, epoch: 16 | loss: 0.1207887
	speed: 0.0609s/iter; left time: 2402.3983s
Epoch: 16 cost time: 30.72740340232849
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0074542
	speed: 0.2986s/iter; left time: 11732.4141s
	iters: 200, epoch: 17 | loss: 0.0023971
	speed: 0.0551s/iter; left time: 2159.6493s
	iters: 300, epoch: 17 | loss: 0.0001004
	speed: 0.0505s/iter; left time: 1975.2791s
	iters: 400, epoch: 17 | loss: 0.0244426
	speed: 0.0494s/iter; left time: 1926.9154s
Epoch: 17 cost time: 26.193175554275513
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
Validation loss decreased (-0.977415 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0002954
	speed: 0.2492s/iter; left time: 9674.9090s
	iters: 200, epoch: 18 | loss: 0.0005852
	speed: 0.0482s/iter; left time: 1865.0559s
	iters: 300, epoch: 18 | loss: 0.0001792
	speed: 0.0510s/iter; left time: 1970.2786s
	iters: 400, epoch: 18 | loss: 0.0077305
	speed: 0.0600s/iter; left time: 2310.5526s
Epoch: 18 cost time: 25.941442489624023
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0002235
	speed: 0.2775s/iter; left time: 10644.2668s
	iters: 200, epoch: 19 | loss: 0.0001199
	speed: 0.0533s/iter; left time: 2038.9551s
	iters: 300, epoch: 19 | loss: 0.3521003
	speed: 0.0664s/iter; left time: 2532.8151s
	iters: 400, epoch: 19 | loss: 0.0061219
	speed: 0.0687s/iter; left time: 2614.7200s
Epoch: 19 cost time: 29.137810707092285
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0042881
	speed: 0.3072s/iter; left time: 11639.0990s
	iters: 200, epoch: 20 | loss: 0.0165114
	speed: 0.0681s/iter; left time: 2573.0315s
	iters: 300, epoch: 20 | loss: 0.0000539
	speed: 0.0542s/iter; left time: 2041.1274s
	iters: 400, epoch: 20 | loss: 0.0110066
	speed: 0.0543s/iter; left time: 2040.3599s
Epoch: 20 cost time: 28.671757459640503
Epoch: 20, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0112484
	speed: 0.2765s/iter; left time: 10348.7664s
	iters: 200, epoch: 21 | loss: 0.0336340
	speed: 0.0557s/iter; left time: 2080.1446s
	iters: 300, epoch: 21 | loss: 0.0023781
	speed: 0.0555s/iter; left time: 2064.0596s
	iters: 400, epoch: 21 | loss: 0.0007846
	speed: 0.0618s/iter; left time: 2292.6548s
Epoch: 21 cost time: 28.550707817077637
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0007594
	speed: 0.3250s/iter; left time: 12008.5174s
	iters: 200, epoch: 22 | loss: 0.0266000
	speed: 0.0674s/iter; left time: 2483.8381s
	iters: 300, epoch: 22 | loss: 0.1835449
	speed: 0.0666s/iter; left time: 2447.1946s
	iters: 400, epoch: 22 | loss: 0.0005147
	speed: 0.0575s/iter; left time: 2106.9886s
Epoch: 22 cost time: 29.904258012771606
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0015100
	speed: 0.2994s/iter; left time: 10924.6609s
	iters: 200, epoch: 23 | loss: 0.0033824
	speed: 0.0588s/iter; left time: 2138.5791s
	iters: 300, epoch: 23 | loss: 0.0079420
	speed: 0.0624s/iter; left time: 2265.7293s
	iters: 400, epoch: 23 | loss: 0.0000373
	speed: 0.0643s/iter; left time: 2325.1102s
Epoch: 23 cost time: 28.860371589660645
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000342
	speed: 0.2647s/iter; left time: 9533.9502s
	iters: 200, epoch: 24 | loss: 0.0355633
	speed: 0.0592s/iter; left time: 2125.2660s
	iters: 300, epoch: 24 | loss: 0.0013669
	speed: 0.0618s/iter; left time: 2212.1085s
	iters: 400, epoch: 24 | loss: 0.0815054
	speed: 0.0557s/iter; left time: 1987.6559s
Epoch: 24 cost time: 26.604015111923218
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0559732
	speed: 0.2953s/iter; left time: 10494.7576s
	iters: 200, epoch: 25 | loss: 0.0104102
	speed: 0.0556s/iter; left time: 1969.3796s
	iters: 300, epoch: 25 | loss: 0.0045617
	speed: 0.0514s/iter; left time: 1815.1264s
	iters: 400, epoch: 25 | loss: 0.0063585
	speed: 0.0504s/iter; left time: 1774.7508s
Epoch: 25 cost time: 26.275503158569336
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0018978
	speed: 0.2646s/iter; left time: 9281.1458s
	iters: 200, epoch: 26 | loss: 0.0050958
	speed: 0.0382s/iter; left time: 1337.8176s
	iters: 300, epoch: 26 | loss: 0.0031586
	speed: 0.0391s/iter; left time: 1362.9249s
	iters: 400, epoch: 26 | loss: 0.1309808
	speed: 0.0407s/iter; left time: 1413.9153s
Epoch: 26 cost time: 19.79469895362854
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
Validation loss decreased (-0.981703 --> -0.981989).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0007225
	speed: 0.3022s/iter; left time: 10459.4295s
	iters: 200, epoch: 27 | loss: 0.0002431
	speed: 0.0628s/iter; left time: 2168.4909s
	iters: 300, epoch: 27 | loss: 0.0989204
	speed: 0.0634s/iter; left time: 2179.9045s
	iters: 400, epoch: 27 | loss: 0.0016359
	speed: 0.0682s/iter; left time: 2340.4574s
Epoch: 27 cost time: 30.785756826400757
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0002250
	speed: 0.3034s/iter; left time: 10356.0226s
	iters: 200, epoch: 28 | loss: 0.0007316
	speed: 0.0569s/iter; left time: 1937.3527s
	iters: 300, epoch: 28 | loss: 0.0730197
	speed: 0.0641s/iter; left time: 2174.6364s
	iters: 400, epoch: 28 | loss: 0.0048111
	speed: 0.0641s/iter; left time: 2170.1826s
Epoch: 28 cost time: 28.304853200912476
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000372
	speed: 0.2792s/iter; left time: 9400.1827s
	iters: 200, epoch: 29 | loss: 0.0309408
	speed: 0.0553s/iter; left time: 1856.8578s
	iters: 300, epoch: 29 | loss: 0.0000406
	speed: 0.0568s/iter; left time: 1902.0040s
	iters: 400, epoch: 29 | loss: 0.1048421
	speed: 0.0558s/iter; left time: 1863.4914s
Epoch: 29 cost time: 26.091290950775146
Epoch: 29, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0012063
	speed: 0.2655s/iter; left time: 8816.0261s
	iters: 200, epoch: 30 | loss: 0.0229316
	speed: 0.0504s/iter; left time: 1667.5462s
	iters: 300, epoch: 30 | loss: 0.0000316
	speed: 0.0456s/iter; left time: 1505.6123s
	iters: 400, epoch: 30 | loss: 0.0153138
	speed: 0.0482s/iter; left time: 1584.2004s
Epoch: 30 cost time: 24.219760179519653
Epoch: 30, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0046318
	speed: 0.2985s/iter; left time: 9769.7459s
	iters: 200, epoch: 31 | loss: 0.0522578
	speed: 0.0539s/iter; left time: 1758.2031s
	iters: 300, epoch: 31 | loss: 0.0351482
	speed: 0.0511s/iter; left time: 1663.0740s
	iters: 400, epoch: 31 | loss: 0.0277610
	speed: 0.0531s/iter; left time: 1721.9699s
Epoch: 31 cost time: 26.3098886013031
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0003051
	speed: 0.2659s/iter; left time: 8579.0698s
	iters: 200, epoch: 32 | loss: 0.0066299
	speed: 0.0499s/iter; left time: 1605.3198s
	iters: 300, epoch: 32 | loss: 0.0000027
	speed: 0.0522s/iter; left time: 1672.1502s
	iters: 400, epoch: 32 | loss: 0.0001509
	speed: 0.0505s/iter; left time: 1613.0714s
Epoch: 32 cost time: 24.97936487197876
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0029071
	speed: 0.2630s/iter; left time: 8361.7671s
	iters: 200, epoch: 33 | loss: 0.1352670
	speed: 0.0556s/iter; left time: 1763.5703s
	iters: 300, epoch: 33 | loss: 0.0022262
	speed: 0.0588s/iter; left time: 1857.8326s
	iters: 400, epoch: 33 | loss: 0.0001063
	speed: 0.0582s/iter; left time: 1834.4593s
Epoch: 33 cost time: 26.89367985725403
Epoch: 33, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000038
	speed: 0.2928s/iter; left time: 9170.3841s
	iters: 200, epoch: 34 | loss: 0.0000935
	speed: 0.0545s/iter; left time: 1700.7785s
	iters: 300, epoch: 34 | loss: 0.0009663
	speed: 0.0549s/iter; left time: 1708.9672s
	iters: 400, epoch: 34 | loss: 0.0005333
	speed: 0.0578s/iter; left time: 1794.1532s
Epoch: 34 cost time: 27.743025541305542
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.2182969
	speed: 0.3164s/iter; left time: 9763.1475s
	iters: 200, epoch: 35 | loss: 0.1707924
	speed: 0.0691s/iter; left time: 2124.9534s
	iters: 300, epoch: 35 | loss: 0.0005224
	speed: 0.0608s/iter; left time: 1863.4727s
	iters: 400, epoch: 35 | loss: 0.0009197
	speed: 0.0557s/iter; left time: 1700.5916s
Epoch: 35 cost time: 29.78574824333191
Epoch: 35, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.1395976
	speed: 0.2731s/iter; left time: 8299.5132s
	iters: 200, epoch: 36 | loss: 0.0090061
	speed: 0.0551s/iter; left time: 1667.8206s
	iters: 300, epoch: 36 | loss: 0.0003531
	speed: 0.0538s/iter; left time: 1624.1570s
	iters: 400, epoch: 36 | loss: 0.0075469
	speed: 0.0527s/iter; left time: 1584.2424s
Epoch: 36 cost time: 25.037519454956055
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 422458
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5223475
	speed: 0.0742s/iter; left time: 3471.3807s
	iters: 200, epoch: 1 | loss: 0.0594640
	speed: 0.0467s/iter; left time: 2181.9942s
	iters: 300, epoch: 1 | loss: 0.2888293
	speed: 0.0429s/iter; left time: 1997.5200s
	iters: 400, epoch: 1 | loss: 0.1335838
	speed: 0.0498s/iter; left time: 2315.8885s
Epoch: 1 cost time: 24.988801956176758
Epoch: 1, Steps: 469 | Train Loss: 0.441 Vali Loss: 0.190 Vali Acc: 0.951 Test Loss: 0.190 Test Acc: 0.951
Validation loss decreased (inf --> -0.951399).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0504996
	speed: 0.2841s/iter; left time: 13162.5313s
	iters: 200, epoch: 2 | loss: 0.1093047
	speed: 0.0497s/iter; left time: 2299.7539s
	iters: 300, epoch: 2 | loss: 0.0794113
	speed: 0.0533s/iter; left time: 2459.4845s
	iters: 400, epoch: 2 | loss: 0.0171808
	speed: 0.0518s/iter; left time: 2385.0609s
Epoch: 2 cost time: 25.40654730796814
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
Validation loss decreased (-0.951399 --> -0.954258).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0105545
	speed: 0.2708s/iter; left time: 12419.7419s
	iters: 200, epoch: 3 | loss: 0.1029806
	speed: 0.0569s/iter; left time: 2606.0517s
	iters: 300, epoch: 3 | loss: 0.0593368
	speed: 0.0556s/iter; left time: 2539.6707s
	iters: 400, epoch: 3 | loss: 0.0306857
	speed: 0.0510s/iter; left time: 2323.3282s
Epoch: 3 cost time: 25.972301483154297
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.954258 --> -0.955687).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0680578
	speed: 0.2652s/iter; left time: 12038.0317s
	iters: 200, epoch: 4 | loss: 0.0139680
	speed: 0.0432s/iter; left time: 1956.2947s
	iters: 300, epoch: 4 | loss: 0.0367346
	speed: 0.0450s/iter; left time: 2033.1327s
	iters: 400, epoch: 4 | loss: 0.0033682
	speed: 0.0443s/iter; left time: 1997.1877s
Epoch: 4 cost time: 21.552567958831787
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.186 Vali Acc: 0.953 Test Loss: 0.186 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0106644
	speed: 0.2505s/iter; left time: 11251.9408s
	iters: 200, epoch: 5 | loss: 0.1155754
	speed: 0.0540s/iter; left time: 2419.7027s
	iters: 300, epoch: 5 | loss: 0.0197129
	speed: 0.0592s/iter; left time: 2648.6706s
	iters: 400, epoch: 5 | loss: 0.0063524
	speed: 0.0593s/iter; left time: 2647.8124s
Epoch: 5 cost time: 27.44830322265625
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
Validation loss decreased (-0.955687 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014124
	speed: 0.2797s/iter; left time: 12435.8627s
	iters: 200, epoch: 6 | loss: 0.2483624
	speed: 0.0474s/iter; left time: 2101.6132s
	iters: 300, epoch: 6 | loss: 0.0069230
	speed: 0.0497s/iter; left time: 2201.1927s
	iters: 400, epoch: 6 | loss: 0.0017968
	speed: 0.0544s/iter; left time: 2403.2137s
Epoch: 6 cost time: 24.71586298942566
Epoch: 6, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0100435
	speed: 0.2741s/iter; left time: 12057.7689s
	iters: 200, epoch: 7 | loss: 0.0086434
	speed: 0.0594s/iter; left time: 2606.2726s
	iters: 300, epoch: 7 | loss: 0.0227570
	speed: 0.0552s/iter; left time: 2415.9645s
	iters: 400, epoch: 7 | loss: 0.0037858
	speed: 0.0488s/iter; left time: 2132.8968s
Epoch: 7 cost time: 26.480623245239258
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0228665
	speed: 0.2469s/iter; left time: 10745.8741s
	iters: 200, epoch: 8 | loss: 0.0000889
	speed: 0.0382s/iter; left time: 1656.4469s
	iters: 300, epoch: 8 | loss: 0.0015077
	speed: 0.0415s/iter; left time: 1796.5902s
	iters: 400, epoch: 8 | loss: 0.0035583
	speed: 0.0430s/iter; left time: 1858.8540s
Epoch: 8 cost time: 20.163304090499878
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
Validation loss decreased (-0.966265 --> -0.972268).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2389554
	speed: 0.2774s/iter; left time: 11941.5257s
	iters: 200, epoch: 9 | loss: 0.0077830
	speed: 0.0560s/iter; left time: 2404.4884s
	iters: 300, epoch: 9 | loss: 0.0111987
	speed: 0.0563s/iter; left time: 2414.0628s
	iters: 400, epoch: 9 | loss: 0.0016048
	speed: 0.0548s/iter; left time: 2344.0725s
Epoch: 9 cost time: 26.85704278945923
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0030712
	speed: 0.3091s/iter; left time: 13161.9672s
	iters: 200, epoch: 10 | loss: 0.0015340
	speed: 0.0505s/iter; left time: 2146.8185s
	iters: 300, epoch: 10 | loss: 0.0144077
	speed: 0.0523s/iter; left time: 2217.4248s
	iters: 400, epoch: 10 | loss: 0.0015687
	speed: 0.0620s/iter; left time: 2622.1950s
Epoch: 10 cost time: 26.703148365020752
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.215 Vali Acc: 0.961 Test Loss: 0.215 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1727597
	speed: 0.3132s/iter; left time: 13190.5104s
	iters: 200, epoch: 11 | loss: 0.1400421
	speed: 0.0566s/iter; left time: 2378.4622s
	iters: 300, epoch: 11 | loss: 0.0010337
	speed: 0.0589s/iter; left time: 2466.9540s
	iters: 400, epoch: 11 | loss: 0.4245977
	speed: 0.0594s/iter; left time: 2483.3459s
Epoch: 11 cost time: 28.4474515914917
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0062543
	speed: 0.2859s/iter; left time: 11904.1599s
	iters: 200, epoch: 12 | loss: 0.0237253
	speed: 0.0547s/iter; left time: 2273.8373s
	iters: 300, epoch: 12 | loss: 0.0246345
	speed: 0.0546s/iter; left time: 2264.3460s
	iters: 400, epoch: 12 | loss: 0.0002347
	speed: 0.0567s/iter; left time: 2343.4711s
Epoch: 12 cost time: 26.368725776672363
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.972268 --> -0.977128).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0005201
	speed: 0.2678s/iter; left time: 11025.0781s
	iters: 200, epoch: 13 | loss: 0.0090951
	speed: 0.0478s/iter; left time: 1961.7244s
	iters: 300, epoch: 13 | loss: 0.0011568
	speed: 0.0539s/iter; left time: 2208.6894s
	iters: 400, epoch: 13 | loss: 0.0014930
	speed: 0.0549s/iter; left time: 2242.7720s
Epoch: 13 cost time: 25.35375142097473
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001974
	speed: 0.2844s/iter; left time: 11575.9796s
	iters: 200, epoch: 14 | loss: 0.0018704
	speed: 0.0599s/iter; left time: 2430.9552s
	iters: 300, epoch: 14 | loss: 0.3944883
	speed: 0.0637s/iter; left time: 2579.5796s
	iters: 400, epoch: 14 | loss: 0.5984365
	speed: 0.0600s/iter; left time: 2423.5297s
Epoch: 14 cost time: 29.027260303497314
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0983912
	speed: 0.2889s/iter; left time: 11623.1349s
	iters: 200, epoch: 15 | loss: 0.0115020
	speed: 0.0545s/iter; left time: 2187.6561s
	iters: 300, epoch: 15 | loss: 0.2143377
	speed: 0.0606s/iter; left time: 2426.5249s
	iters: 400, epoch: 15 | loss: 0.0034436
	speed: 0.0609s/iter; left time: 2430.0789s
Epoch: 15 cost time: 28.142929792404175
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0219653
	speed: 0.2746s/iter; left time: 10920.3535s
	iters: 200, epoch: 16 | loss: 0.0008523
	speed: 0.0478s/iter; left time: 1897.0544s
	iters: 300, epoch: 16 | loss: 0.0002835
	speed: 0.0602s/iter; left time: 2380.2128s
	iters: 400, epoch: 16 | loss: 0.0870253
	speed: 0.0662s/iter; left time: 2613.7837s
Epoch: 16 cost time: 26.39144515991211
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.955 Test Loss: 0.217 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0272174
	speed: 0.2980s/iter; left time: 11712.0318s
	iters: 200, epoch: 17 | loss: 0.0000008
	speed: 0.0701s/iter; left time: 2748.3483s
	iters: 300, epoch: 17 | loss: 0.0016488
	speed: 0.0659s/iter; left time: 2577.3593s
	iters: 400, epoch: 17 | loss: 0.0352789
	speed: 0.0600s/iter; left time: 2339.6581s
Epoch: 17 cost time: 29.706824779510498
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0002138
	speed: 0.2809s/iter; left time: 10907.1857s
	iters: 200, epoch: 18 | loss: 0.0004509
	speed: 0.0507s/iter; left time: 1961.8656s
	iters: 300, epoch: 18 | loss: 0.0242481
	speed: 0.0503s/iter; left time: 1941.4938s
	iters: 400, epoch: 18 | loss: 0.0042746
	speed: 0.0558s/iter; left time: 2150.9864s
Epoch: 18 cost time: 25.378826141357422
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0034795
	speed: 0.2639s/iter; left time: 10123.3373s
	iters: 200, epoch: 19 | loss: 0.0001415
	speed: 0.0544s/iter; left time: 2079.9719s
	iters: 300, epoch: 19 | loss: 0.0008831
	speed: 0.0562s/iter; left time: 2146.3358s
	iters: 400, epoch: 19 | loss: 0.0073893
	speed: 0.0487s/iter; left time: 1853.8534s
Epoch: 19 cost time: 24.67160964012146
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0002138
	speed: 0.2363s/iter; left time: 8955.1945s
	iters: 200, epoch: 20 | loss: 0.0135057
	speed: 0.0560s/iter; left time: 2118.0373s
	iters: 300, epoch: 20 | loss: 0.0001757
	speed: 0.0562s/iter; left time: 2117.9821s
	iters: 400, epoch: 20 | loss: 0.0212776
	speed: 0.0594s/iter; left time: 2233.2074s
Epoch: 20 cost time: 26.55798101425171
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0037210
	speed: 0.2598s/iter; left time: 9721.8799s
	iters: 200, epoch: 21 | loss: 0.0307937
	speed: 0.0695s/iter; left time: 2594.8952s
	iters: 300, epoch: 21 | loss: 0.0003370
	speed: 0.0633s/iter; left time: 2355.1288s
	iters: 400, epoch: 21 | loss: 0.0008357
	speed: 0.0579s/iter; left time: 2149.0486s
Epoch: 21 cost time: 29.537949800491333
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.977128 --> -0.978558).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000668
	speed: 0.3104s/iter; left time: 11470.8735s
	iters: 200, epoch: 22 | loss: 0.0049884
	speed: 0.0581s/iter; left time: 2142.3042s
	iters: 300, epoch: 22 | loss: 0.0499810
	speed: 0.0560s/iter; left time: 2058.2193s
	iters: 400, epoch: 22 | loss: 0.0008694
	speed: 0.0589s/iter; left time: 2157.9499s
Epoch: 22 cost time: 28.367530345916748
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0067177
	speed: 0.2795s/iter; left time: 10197.8184s
	iters: 200, epoch: 23 | loss: 0.4275029
	speed: 0.0462s/iter; left time: 1679.2829s
	iters: 300, epoch: 23 | loss: 0.0001541
	speed: 0.0493s/iter; left time: 1790.1407s
	iters: 400, epoch: 23 | loss: 0.0026800
	speed: 0.0467s/iter; left time: 1689.0301s
Epoch: 23 cost time: 23.137622594833374
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0034134
	speed: 0.2772s/iter; left time: 9983.8445s
	iters: 200, epoch: 24 | loss: 0.0237237
	speed: 0.0530s/iter; left time: 1904.1645s
	iters: 300, epoch: 24 | loss: 0.0011976
	speed: 0.0513s/iter; left time: 1837.4068s
	iters: 400, epoch: 24 | loss: 0.0012266
	speed: 0.0533s/iter; left time: 1903.8942s
Epoch: 24 cost time: 26.136415481567383
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000806
	speed: 0.2910s/iter; left time: 10342.8540s
	iters: 200, epoch: 25 | loss: 0.0210235
	speed: 0.0539s/iter; left time: 1909.9351s
	iters: 300, epoch: 25 | loss: 0.0016229
	speed: 0.0541s/iter; left time: 1912.1022s
	iters: 400, epoch: 25 | loss: 0.1124362
	speed: 0.0592s/iter; left time: 2087.8108s
Epoch: 25 cost time: 26.57441544532776
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0014462
	speed: 0.2878s/iter; left time: 10094.7397s
	iters: 200, epoch: 26 | loss: 0.0002298
	speed: 0.0486s/iter; left time: 1699.4166s
	iters: 300, epoch: 26 | loss: 0.0001182
	speed: 0.0481s/iter; left time: 1677.6083s
	iters: 400, epoch: 26 | loss: 0.0020517
	speed: 0.0528s/iter; left time: 1835.8489s
Epoch: 26 cost time: 24.37109065055847
Epoch: 26, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0000022
	speed: 0.2915s/iter; left time: 10088.5509s
	iters: 200, epoch: 27 | loss: 0.0267938
	speed: 0.0518s/iter; left time: 1789.0209s
	iters: 300, epoch: 27 | loss: 0.0501876
	speed: 0.0571s/iter; left time: 1963.1223s
	iters: 400, epoch: 27 | loss: 0.0016143
	speed: 0.0634s/iter; left time: 2175.4390s
Epoch: 27 cost time: 27.990437030792236
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0218768
	speed: 0.2987s/iter; left time: 10197.3298s
	iters: 200, epoch: 28 | loss: 0.0024754
	speed: 0.0625s/iter; left time: 2125.8992s
	iters: 300, epoch: 28 | loss: 0.0001783
	speed: 0.0650s/iter; left time: 2206.7380s
	iters: 400, epoch: 28 | loss: 0.0001090
	speed: 0.0643s/iter; left time: 2175.6885s
Epoch: 28 cost time: 30.431747436523438
Epoch: 28, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0005003
	speed: 0.2970s/iter; left time: 9998.5186s
	iters: 200, epoch: 29 | loss: 0.0001163
	speed: 0.0494s/iter; left time: 1659.8063s
	iters: 300, epoch: 29 | loss: 0.0000324
	speed: 0.0507s/iter; left time: 1697.1118s
	iters: 400, epoch: 29 | loss: 0.0001873
	speed: 0.0554s/iter; left time: 1850.1302s
Epoch: 29 cost time: 25.03943634033203
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000545
	speed: 0.2458s/iter; left time: 8159.9442s
	iters: 200, epoch: 30 | loss: 0.0006217
	speed: 0.0504s/iter; left time: 1666.8589s
	iters: 300, epoch: 30 | loss: 0.0002259
	speed: 0.0568s/iter; left time: 1873.0582s
	iters: 400, epoch: 30 | loss: 0.0207474
	speed: 0.0592s/iter; left time: 1948.0467s
Epoch: 30 cost time: 25.478008031845093
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.982 Test Loss: 0.124 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981988).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0004349
	speed: 0.2481s/iter; left time: 8119.6026s
	iters: 200, epoch: 31 | loss: 0.1462004
	speed: 0.0642s/iter; left time: 2093.8719s
	iters: 300, epoch: 31 | loss: 0.0123045
	speed: 0.0611s/iter; left time: 1987.9739s
	iters: 400, epoch: 31 | loss: 0.0013171
	speed: 0.0563s/iter; left time: 1825.4193s
Epoch: 31 cost time: 27.82813310623169
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0000276
	speed: 0.2739s/iter; left time: 8836.1329s
	iters: 200, epoch: 32 | loss: 0.0004486
	speed: 0.0540s/iter; left time: 1737.0188s
	iters: 300, epoch: 32 | loss: 0.0000227
	speed: 0.0427s/iter; left time: 1368.7412s
	iters: 400, epoch: 32 | loss: 0.0719202
	speed: 0.0378s/iter; left time: 1207.1957s
Epoch: 32 cost time: 21.38949227333069
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0046782
	speed: 0.2662s/iter; left time: 8462.6023s
	iters: 200, epoch: 33 | loss: 0.0004282
	speed: 0.0565s/iter; left time: 1789.9100s
	iters: 300, epoch: 33 | loss: 0.0001593
	speed: 0.0522s/iter; left time: 1647.6405s
	iters: 400, epoch: 33 | loss: 0.0059883
	speed: 0.0522s/iter; left time: 1643.7256s
Epoch: 33 cost time: 25.818613529205322
Epoch: 33, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.981 Test Loss: 0.149 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0000258
	speed: 0.2656s/iter; left time: 8320.4356s
	iters: 200, epoch: 34 | loss: 0.0010712
	speed: 0.0437s/iter; left time: 1364.2080s
	iters: 300, epoch: 34 | loss: 0.0000731
	speed: 0.0470s/iter; left time: 1464.0613s
	iters: 400, epoch: 34 | loss: 0.0004874
	speed: 0.0489s/iter; left time: 1515.6447s
Epoch: 34 cost time: 22.500459909439087
Epoch: 34, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.981988 --> -0.983132).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0392855
	speed: 0.2851s/iter; left time: 8795.9265s
	iters: 200, epoch: 35 | loss: 0.0487323
	speed: 0.0496s/iter; left time: 1525.8645s
	iters: 300, epoch: 35 | loss: 0.0003697
	speed: 0.0541s/iter; left time: 1659.7627s
	iters: 400, epoch: 35 | loss: 0.0001309
	speed: 0.0604s/iter; left time: 1845.3683s
Epoch: 35 cost time: 26.24250292778015
Epoch: 35, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0002000
	speed: 0.2507s/iter; left time: 7617.8019s
	iters: 200, epoch: 36 | loss: 0.0471324
	speed: 0.0567s/iter; left time: 1716.2086s
	iters: 300, epoch: 36 | loss: 0.2197809
	speed: 0.0583s/iter; left time: 1760.4007s
	iters: 400, epoch: 36 | loss: 0.0068984
	speed: 0.0558s/iter; left time: 1680.1008s
Epoch: 36 cost time: 25.92892861366272
Epoch: 36, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0002094
	speed: 0.2582s/iter; left time: 7723.6510s
	iters: 200, epoch: 37 | loss: 0.0350546
	speed: 0.0536s/iter; left time: 1597.5394s
	iters: 300, epoch: 37 | loss: 0.5238199
	speed: 0.0547s/iter; left time: 1625.8031s
	iters: 400, epoch: 37 | loss: 0.0023651
	speed: 0.0505s/iter; left time: 1494.5611s
Epoch: 37 cost time: 24.98656702041626
Epoch: 37, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.981 Test Loss: 0.164 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0058395
	speed: 0.2466s/iter; left time: 7261.4850s
	iters: 200, epoch: 38 | loss: 0.0001569
	speed: 0.0510s/iter; left time: 1498.1323s
	iters: 300, epoch: 38 | loss: 0.0027755
	speed: 0.0496s/iter; left time: 1451.6794s
	iters: 400, epoch: 38 | loss: 0.8237815
	speed: 0.0506s/iter; left time: 1473.6650s
Epoch: 38 cost time: 24.10774040222168
Epoch: 38, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0000661
	speed: 0.3049s/iter; left time: 8835.2439s
	iters: 200, epoch: 39 | loss: 0.0000053
	speed: 0.0556s/iter; left time: 1606.3002s
	iters: 300, epoch: 39 | loss: 0.0050375
	speed: 0.0589s/iter; left time: 1695.2971s
	iters: 400, epoch: 39 | loss: 0.0000002
	speed: 0.0593s/iter; left time: 1701.4334s
Epoch: 39 cost time: 28.863049745559692
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.1428673
	speed: 0.2945s/iter; left time: 8396.7196s
	iters: 200, epoch: 40 | loss: 0.0000032
	speed: 0.0555s/iter; left time: 1576.9014s
	iters: 300, epoch: 40 | loss: 0.1629235
	speed: 0.0556s/iter; left time: 1573.9565s
	iters: 400, epoch: 40 | loss: 0.0004041
	speed: 0.0592s/iter; left time: 1671.1441s
Epoch: 40 cost time: 27.591485738754272
Epoch: 40, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0011013
	speed: 0.2750s/iter; left time: 7710.5268s
	iters: 200, epoch: 41 | loss: 0.0027942
	speed: 0.0512s/iter; left time: 1429.5888s
	iters: 300, epoch: 41 | loss: 0.2388739
	speed: 0.0546s/iter; left time: 1518.9644s
	iters: 400, epoch: 41 | loss: 0.0000187
	speed: 0.0580s/iter; left time: 1609.0561s
Epoch: 41 cost time: 25.782366275787354
Epoch: 41, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000169
	speed: 0.2414s/iter; left time: 6656.5709s
	iters: 200, epoch: 42 | loss: 0.0084373
	speed: 0.0555s/iter; left time: 1524.5064s
	iters: 300, epoch: 42 | loss: 0.0000101
	speed: 0.0575s/iter; left time: 1573.8056s
	iters: 400, epoch: 42 | loss: 0.0006841
	speed: 0.0541s/iter; left time: 1474.2715s
Epoch: 42 cost time: 26.00052762031555
Epoch: 42, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0051371
	speed: 0.2591s/iter; left time: 7021.4392s
	iters: 200, epoch: 43 | loss: 0.0000965
	speed: 0.0616s/iter; left time: 1664.6864s
	iters: 300, epoch: 43 | loss: 0.0489990
	speed: 0.0543s/iter; left time: 1460.6510s
	iters: 400, epoch: 43 | loss: 0.0000513
	speed: 0.0509s/iter; left time: 1365.3378s
Epoch: 43 cost time: 26.980064392089844
Epoch: 43, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.0000240
	speed: 0.2680s/iter; left time: 7137.9226s
	iters: 200, epoch: 44 | loss: 0.0001232
	speed: 0.0488s/iter; left time: 1295.1569s
	iters: 300, epoch: 44 | loss: 0.0008486
	speed: 0.0510s/iter; left time: 1347.7575s
	iters: 400, epoch: 44 | loss: 0.0001282
	speed: 0.0495s/iter; left time: 1302.5421s
Epoch: 44 cost time: 24.18060302734375
Epoch: 44, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.979 Test Loss: 0.156 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 422458
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5236433
	speed: 0.0767s/iter; left time: 3588.3784s
	iters: 200, epoch: 1 | loss: 0.0862594
	speed: 0.0531s/iter; left time: 2477.6030s
	iters: 300, epoch: 1 | loss: 0.1842932
	speed: 0.0537s/iter; left time: 2502.9224s
	iters: 400, epoch: 1 | loss: 0.2659351
	speed: 0.0534s/iter; left time: 2483.8924s
Epoch: 1 cost time: 27.46078896522522
Epoch: 1, Steps: 469 | Train Loss: 0.437 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
Validation loss decreased (inf --> -0.963692).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0119648
	speed: 0.2695s/iter; left time: 12486.2968s
	iters: 200, epoch: 2 | loss: 0.2631562
	speed: 0.0539s/iter; left time: 2491.4363s
	iters: 300, epoch: 2 | loss: 0.0091321
	speed: 0.0495s/iter; left time: 2281.9258s
	iters: 400, epoch: 2 | loss: 0.0073463
	speed: 0.0493s/iter; left time: 2271.6562s
Epoch: 2 cost time: 25.342421770095825
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.970553).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0305698
	speed: 0.2730s/iter; left time: 12520.9527s
	iters: 200, epoch: 3 | loss: 0.0635836
	speed: 0.0468s/iter; left time: 2143.5390s
	iters: 300, epoch: 3 | loss: 0.0253836
	speed: 0.0490s/iter; left time: 2235.8543s
	iters: 400, epoch: 3 | loss: 0.0253722
	speed: 0.0538s/iter; left time: 2450.0478s
Epoch: 3 cost time: 23.901928186416626
Epoch: 3, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0414909
	speed: 0.2417s/iter; left time: 10970.3381s
	iters: 200, epoch: 4 | loss: 0.0483038
	speed: 0.0492s/iter; left time: 2230.2949s
	iters: 300, epoch: 4 | loss: 0.0059112
	speed: 0.0483s/iter; left time: 2181.9263s
	iters: 400, epoch: 4 | loss: 0.0019411
	speed: 0.0459s/iter; left time: 2070.1456s
Epoch: 4 cost time: 22.63468599319458
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.973126).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0949867
	speed: 0.2421s/iter; left time: 10877.2658s
	iters: 200, epoch: 5 | loss: 0.0023920
	speed: 0.0526s/iter; left time: 2356.1323s
	iters: 300, epoch: 5 | loss: 0.0038418
	speed: 0.0565s/iter; left time: 2527.8876s
	iters: 400, epoch: 5 | loss: 0.0006165
	speed: 0.0585s/iter; left time: 2610.4413s
Epoch: 5 cost time: 26.265979051589966
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0006893
	speed: 0.2672s/iter; left time: 11878.5400s
	iters: 200, epoch: 6 | loss: 0.2619651
	speed: 0.0608s/iter; left time: 2694.8722s
	iters: 300, epoch: 6 | loss: 0.0004768
	speed: 0.0532s/iter; left time: 2352.9194s
	iters: 400, epoch: 6 | loss: 0.0026521
	speed: 0.0470s/iter; left time: 2076.6721s
Epoch: 6 cost time: 26.164000034332275
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.974555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0006560
	speed: 0.2724s/iter; left time: 11983.4804s
	iters: 200, epoch: 7 | loss: 0.0058625
	speed: 0.0529s/iter; left time: 2319.7869s
	iters: 300, epoch: 7 | loss: 0.1310418
	speed: 0.0508s/iter; left time: 2225.4647s
	iters: 400, epoch: 7 | loss: 0.0087043
	speed: 0.0474s/iter; left time: 2069.4437s
Epoch: 7 cost time: 24.63703989982605
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.974555 --> -0.977128).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1347649
	speed: 0.2713s/iter; left time: 11805.3910s
	iters: 200, epoch: 8 | loss: 0.0018029
	speed: 0.0514s/iter; left time: 2233.0344s
	iters: 300, epoch: 8 | loss: 0.0004271
	speed: 0.0499s/iter; left time: 2163.4910s
	iters: 400, epoch: 8 | loss: 0.0003411
	speed: 0.0528s/iter; left time: 2283.9677s
Epoch: 8 cost time: 24.82039523124695
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.961 Test Loss: 0.211 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0369624
	speed: 0.2775s/iter; left time: 11945.1240s
	iters: 200, epoch: 9 | loss: 0.0024727
	speed: 0.0475s/iter; left time: 2042.0066s
	iters: 300, epoch: 9 | loss: 0.1245775
	speed: 0.0447s/iter; left time: 1915.0787s
	iters: 400, epoch: 9 | loss: 0.0031222
	speed: 0.0479s/iter; left time: 2047.8858s
Epoch: 9 cost time: 23.979296445846558
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0247152
	speed: 0.2652s/iter; left time: 11292.2713s
	iters: 200, epoch: 10 | loss: 0.0006854
	speed: 0.0485s/iter; left time: 2058.2727s
	iters: 300, epoch: 10 | loss: 0.0004231
	speed: 0.0584s/iter; left time: 2476.3841s
	iters: 400, epoch: 10 | loss: 0.0000640
	speed: 0.0553s/iter; left time: 2337.2940s
Epoch: 10 cost time: 24.819132566452026
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0484260
	speed: 0.2457s/iter; left time: 10346.7574s
	iters: 200, epoch: 11 | loss: 0.1163840
	speed: 0.0511s/iter; left time: 2146.4264s
	iters: 300, epoch: 11 | loss: 0.0238756
	speed: 0.0484s/iter; left time: 2028.0957s
	iters: 400, epoch: 11 | loss: 0.0296374
	speed: 0.0485s/iter; left time: 2027.2951s
Epoch: 11 cost time: 23.52811551094055
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0005386
	speed: 0.2183s/iter; left time: 9092.4297s
	iters: 200, epoch: 12 | loss: 0.0089385
	speed: 0.0563s/iter; left time: 2340.0548s
	iters: 300, epoch: 12 | loss: 0.0797247
	speed: 0.0604s/iter; left time: 2501.7259s
	iters: 400, epoch: 12 | loss: 0.0979943
	speed: 0.0594s/iter; left time: 2454.2490s
Epoch: 12 cost time: 26.033689498901367
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.966 Test Loss: 0.193 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000086
	speed: 0.2745s/iter; left time: 11302.2584s
	iters: 200, epoch: 13 | loss: 0.0002377
	speed: 0.0610s/iter; left time: 2506.6829s
	iters: 300, epoch: 13 | loss: 0.0066216
	speed: 0.0482s/iter; left time: 1975.1685s
	iters: 400, epoch: 13 | loss: 0.0001127
	speed: 0.0462s/iter; left time: 1887.3011s
Epoch: 13 cost time: 25.33376121520996
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.977128 --> -0.977414).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000414
	speed: 0.2795s/iter; left time: 11377.7853s
	iters: 200, epoch: 14 | loss: 0.0002665
	speed: 0.0492s/iter; left time: 1999.1090s
	iters: 300, epoch: 14 | loss: 0.0432589
	speed: 0.0480s/iter; left time: 1943.3439s
	iters: 400, epoch: 14 | loss: 0.0023079
	speed: 0.0452s/iter; left time: 1827.1372s
Epoch: 14 cost time: 23.66597032546997
Epoch: 14, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0302662
	speed: 0.2501s/iter; left time: 10064.4947s
	iters: 200, epoch: 15 | loss: 0.0003699
	speed: 0.0456s/iter; left time: 1828.9733s
	iters: 300, epoch: 15 | loss: 0.0104696
	speed: 0.0473s/iter; left time: 1891.8365s
	iters: 400, epoch: 15 | loss: 0.0012399
	speed: 0.0499s/iter; left time: 1992.5386s
Epoch: 15 cost time: 22.707284927368164
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0001644
	speed: 0.2257s/iter; left time: 8975.0348s
	iters: 200, epoch: 16 | loss: 0.0002531
	speed: 0.0458s/iter; left time: 1815.8996s
	iters: 300, epoch: 16 | loss: 0.0034137
	speed: 0.0463s/iter; left time: 1833.4058s
	iters: 400, epoch: 16 | loss: 0.0010233
	speed: 0.0448s/iter; left time: 1768.3716s
Epoch: 16 cost time: 22.302186250686646
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000265
	speed: 0.2652s/iter; left time: 10422.9314s
	iters: 200, epoch: 17 | loss: 0.0000594
	speed: 0.0467s/iter; left time: 1832.2152s
	iters: 300, epoch: 17 | loss: 0.0000594
	speed: 0.0504s/iter; left time: 1969.0001s
	iters: 400, epoch: 17 | loss: 0.0324188
	speed: 0.0585s/iter; left time: 2280.3319s
Epoch: 17 cost time: 24.4779155254364
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
Validation loss decreased (-0.977414 --> -0.979701).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0070792
	speed: 0.2342s/iter; left time: 9093.3478s
	iters: 200, epoch: 18 | loss: 0.0410418
	speed: 0.0424s/iter; left time: 1642.7687s
	iters: 300, epoch: 18 | loss: 0.0015025
	speed: 0.0473s/iter; left time: 1828.6454s
	iters: 400, epoch: 18 | loss: 0.0002661
	speed: 0.0485s/iter; left time: 1870.2101s
Epoch: 18 cost time: 21.980664014816284
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000159
	speed: 0.2358s/iter; left time: 9046.0865s
	iters: 200, epoch: 19 | loss: 0.0000058
	speed: 0.0431s/iter; left time: 1648.2293s
	iters: 300, epoch: 19 | loss: 0.0348187
	speed: 0.0493s/iter; left time: 1882.8864s
	iters: 400, epoch: 19 | loss: 0.0000019
	speed: 0.0510s/iter; left time: 1940.2096s
Epoch: 19 cost time: 22.534541368484497
Epoch: 19, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000314
	speed: 0.2355s/iter; left time: 8921.4080s
	iters: 200, epoch: 20 | loss: 0.0020233
	speed: 0.0502s/iter; left time: 1897.1509s
	iters: 300, epoch: 20 | loss: 0.0000055
	speed: 0.0469s/iter; left time: 1765.8757s
	iters: 400, epoch: 20 | loss: 0.0057937
	speed: 0.0459s/iter; left time: 1723.8000s
Epoch: 20 cost time: 22.218579053878784
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0005979
	speed: 0.2736s/iter; left time: 10238.2766s
	iters: 200, epoch: 21 | loss: 0.0001609
	speed: 0.0623s/iter; left time: 2324.0974s
	iters: 300, epoch: 21 | loss: 0.0001138
	speed: 0.0564s/iter; left time: 2100.8440s
	iters: 400, epoch: 21 | loss: 0.0255493
	speed: 0.0539s/iter; left time: 2001.7726s
Epoch: 21 cost time: 27.863837242126465
Epoch: 21, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.260 Vali Acc: 0.971 Test Loss: 0.260 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0005497
	speed: 0.2758s/iter; left time: 10192.6349s
	iters: 200, epoch: 22 | loss: 0.0731798
	speed: 0.0514s/iter; left time: 1896.0328s
	iters: 300, epoch: 22 | loss: 0.0004289
	speed: 0.0520s/iter; left time: 1911.6180s
	iters: 400, epoch: 22 | loss: 0.0054706
	speed: 0.0532s/iter; left time: 1948.4031s
Epoch: 22 cost time: 25.015983819961548
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0520320
	speed: 0.2462s/iter; left time: 8983.3903s
	iters: 200, epoch: 23 | loss: 0.0379860
	speed: 0.0475s/iter; left time: 1728.4167s
	iters: 300, epoch: 23 | loss: 0.0000192
	speed: 0.0458s/iter; left time: 1661.6604s
	iters: 400, epoch: 23 | loss: 0.0000121
	speed: 0.0460s/iter; left time: 1665.2503s
Epoch: 23 cost time: 22.826355457305908
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0002019
	speed: 0.2663s/iter; left time: 9592.1237s
	iters: 200, epoch: 24 | loss: 0.0263640
	speed: 0.0434s/iter; left time: 1559.3327s
	iters: 300, epoch: 24 | loss: 0.0001179
	speed: 0.0457s/iter; left time: 1638.1075s
	iters: 400, epoch: 24 | loss: 0.1421530
	speed: 0.0493s/iter; left time: 1761.5545s
Epoch: 24 cost time: 22.371058702468872
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0005102
	speed: 0.2412s/iter; left time: 8574.9442s
	iters: 200, epoch: 25 | loss: 0.0023210
	speed: 0.0443s/iter; left time: 1571.3824s
	iters: 300, epoch: 25 | loss: 0.0011387
	speed: 0.0429s/iter; left time: 1514.8143s
	iters: 400, epoch: 25 | loss: 0.0834104
	speed: 0.0471s/iter; left time: 1661.7046s
Epoch: 25 cost time: 21.55990982055664
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.1861350
	speed: 0.2116s/iter; left time: 7420.3921s
	iters: 200, epoch: 26 | loss: 0.0007606
	speed: 0.0518s/iter; left time: 1810.2051s
	iters: 300, epoch: 26 | loss: 0.0000050
	speed: 0.0544s/iter; left time: 1895.5716s
	iters: 400, epoch: 26 | loss: 0.0000404
	speed: 0.0497s/iter; left time: 1728.5803s
Epoch: 26 cost time: 24.113904237747192
Epoch: 26, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.979701 --> -0.980273).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0024917
	speed: 0.2408s/iter; left time: 8332.3066s
	iters: 200, epoch: 27 | loss: 0.0000096
	speed: 0.0507s/iter; left time: 1751.1991s
	iters: 300, epoch: 27 | loss: 0.0000828
	speed: 0.0495s/iter; left time: 1704.2051s
	iters: 400, epoch: 27 | loss: 0.0009413
	speed: 0.0439s/iter; left time: 1505.6043s
Epoch: 27 cost time: 22.608946084976196
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.979 Test Loss: 0.181 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000622
	speed: 0.2231s/iter; left time: 7614.6553s
	iters: 200, epoch: 28 | loss: 0.0000122
	speed: 0.0533s/iter; left time: 1815.2038s
	iters: 300, epoch: 28 | loss: 0.0000004
	speed: 0.0455s/iter; left time: 1543.6313s
	iters: 400, epoch: 28 | loss: 0.4033488
	speed: 0.0450s/iter; left time: 1521.5540s
Epoch: 28 cost time: 23.280319213867188
Epoch: 28, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0001283
	speed: 0.2477s/iter; left time: 8339.1707s
	iters: 200, epoch: 29 | loss: 0.0250882
	speed: 0.0445s/iter; left time: 1493.9430s
	iters: 300, epoch: 29 | loss: 0.0000001
	speed: 0.0453s/iter; left time: 1516.4332s
	iters: 400, epoch: 29 | loss: 0.0000159
	speed: 0.0460s/iter; left time: 1535.6617s
Epoch: 29 cost time: 22.605237245559692
Epoch: 29, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.983 Test Loss: 0.163 Test Acc: 0.983
Validation loss decreased (-0.980273 --> -0.982846).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000095
	speed: 0.2469s/iter; left time: 8196.5767s
	iters: 200, epoch: 30 | loss: 0.0011150
	speed: 0.0479s/iter; left time: 1586.0250s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0490s/iter; left time: 1616.3120s
	iters: 400, epoch: 30 | loss: 0.0044051
	speed: 0.0464s/iter; left time: 1525.2382s
Epoch: 30 cost time: 22.51988124847412
Epoch: 30, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0004625
	speed: 0.2249s/iter; left time: 7360.5280s
	iters: 200, epoch: 31 | loss: 0.0000000
	speed: 0.0419s/iter; left time: 1368.3090s
	iters: 300, epoch: 31 | loss: 0.0001841
	speed: 0.0434s/iter; left time: 1412.0231s
	iters: 400, epoch: 31 | loss: 0.0004697
	speed: 0.0423s/iter; left time: 1371.7064s
Epoch: 31 cost time: 20.345149755477905
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.979 Test Loss: 0.219 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0000109
	speed: 0.2334s/iter; left time: 7530.4737s
	iters: 200, epoch: 32 | loss: 0.0000599
	speed: 0.0440s/iter; left time: 1413.9198s
	iters: 300, epoch: 32 | loss: 0.0000006
	speed: 0.0417s/iter; left time: 1336.2209s
	iters: 400, epoch: 32 | loss: 0.0057379
	speed: 0.0444s/iter; left time: 1418.5912s
Epoch: 32 cost time: 21.02197504043579
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.978 Test Loss: 0.202 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0000031
	speed: 0.2558s/iter; left time: 8131.5786s
	iters: 200, epoch: 33 | loss: 0.0056095
	speed: 0.0486s/iter; left time: 1540.3764s
	iters: 300, epoch: 33 | loss: 0.0041511
	speed: 0.0515s/iter; left time: 1627.0362s
	iters: 400, epoch: 33 | loss: 0.0006703
	speed: 0.0533s/iter; left time: 1678.4095s
Epoch: 33 cost time: 24.272016286849976
Epoch: 33, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0000139
	speed: 0.2441s/iter; left time: 7644.8433s
	iters: 200, epoch: 34 | loss: 0.0000004
	speed: 0.0500s/iter; left time: 1561.6505s
	iters: 300, epoch: 34 | loss: 0.0000409
	speed: 0.0548s/iter; left time: 1705.4814s
	iters: 400, epoch: 34 | loss: 0.0000764
	speed: 0.0533s/iter; left time: 1653.7202s
Epoch: 34 cost time: 24.723355531692505
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.979 Test Loss: 0.222 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0000001
	speed: 0.2117s/iter; left time: 6531.9806s
	iters: 200, epoch: 35 | loss: 0.0947800
	speed: 0.0407s/iter; left time: 1252.9617s
	iters: 300, epoch: 35 | loss: 0.0000016
	speed: 0.0447s/iter; left time: 1370.8745s
	iters: 400, epoch: 35 | loss: 0.0000084
	speed: 0.0446s/iter; left time: 1361.9821s
Epoch: 35 cost time: 20.316070556640625
Epoch: 35, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.249 Vali Acc: 0.976 Test Loss: 0.249 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.1318912
	speed: 0.2188s/iter; left time: 6648.2227s
	iters: 200, epoch: 36 | loss: 0.5694205
	speed: 0.0425s/iter; left time: 1286.9613s
	iters: 300, epoch: 36 | loss: 0.0080930
	speed: 0.0431s/iter; left time: 1301.5643s
	iters: 400, epoch: 36 | loss: 0.2029655
	speed: 0.0447s/iter; left time: 1344.8982s
Epoch: 36 cost time: 20.720901489257812
Epoch: 36, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0000012
	speed: 0.2191s/iter; left time: 6554.7500s
	iters: 200, epoch: 37 | loss: 0.0272352
	speed: 0.0466s/iter; left time: 1389.2422s
	iters: 300, epoch: 37 | loss: 0.1805812
	speed: 0.0524s/iter; left time: 1555.7106s
	iters: 400, epoch: 37 | loss: 0.0000000
	speed: 0.0525s/iter; left time: 1555.1554s
Epoch: 37 cost time: 22.93249773979187
Epoch: 37, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.978 Test Loss: 0.268 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0705053
	speed: 0.2204s/iter; left time: 6490.5706s
	iters: 200, epoch: 38 | loss: 0.0000000
	speed: 0.0530s/iter; left time: 1555.9565s
	iters: 300, epoch: 38 | loss: 0.0041999
	speed: 0.0495s/iter; left time: 1449.2015s
	iters: 400, epoch: 38 | loss: 0.0004662
	speed: 0.0456s/iter; left time: 1327.7193s
Epoch: 38 cost time: 22.828243732452393
Epoch: 38, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.971 Test Loss: 0.229 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000306
	speed: 0.2239s/iter; left time: 6488.0670s
	iters: 200, epoch: 39 | loss: 0.0000028
	speed: 0.0425s/iter; left time: 1228.1484s
	iters: 300, epoch: 39 | loss: 0.0699114
	speed: 0.0381s/iter; left time: 1097.2802s
	iters: 400, epoch: 39 | loss: 0.0000384
	speed: 0.0399s/iter; left time: 1144.2481s
Epoch: 39 cost time: 19.362637519836426
Epoch: 39, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 422458
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6526562
	speed: 0.0756s/iter; left time: 3537.6984s
	iters: 200, epoch: 1 | loss: 0.4563957
	speed: 0.0524s/iter; left time: 2446.3343s
	iters: 300, epoch: 1 | loss: 0.0688637
	speed: 0.0483s/iter; left time: 2252.5228s
	iters: 400, epoch: 1 | loss: 0.0193206
	speed: 0.0493s/iter; left time: 2294.5666s
Epoch: 1 cost time: 25.65153980255127
Epoch: 1, Steps: 469 | Train Loss: 0.453 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
Validation loss decreased (inf --> -0.946253).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0235292
	speed: 0.2511s/iter; left time: 11635.2806s
	iters: 200, epoch: 2 | loss: 0.0402713
	speed: 0.0493s/iter; left time: 2280.8292s
	iters: 300, epoch: 2 | loss: 0.1293472
	speed: 0.0425s/iter; left time: 1960.2713s
	iters: 400, epoch: 2 | loss: 0.1144945
	speed: 0.0443s/iter; left time: 2041.2242s
Epoch: 2 cost time: 22.941352128982544
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.946253 --> -0.962263).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1598950
	speed: 0.2714s/iter; left time: 12448.9140s
	iters: 200, epoch: 3 | loss: 0.0792683
	speed: 0.0501s/iter; left time: 2290.6701s
	iters: 300, epoch: 3 | loss: 0.0514196
	speed: 0.0506s/iter; left time: 2312.5770s
	iters: 400, epoch: 3 | loss: 0.0190488
	speed: 0.0494s/iter; left time: 2249.1752s
Epoch: 3 cost time: 24.52439546585083
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0338105
	speed: 0.2619s/iter; left time: 11890.1822s
	iters: 200, epoch: 4 | loss: 0.0023899
	speed: 0.0528s/iter; left time: 2389.4691s
	iters: 300, epoch: 4 | loss: 0.1117261
	speed: 0.0514s/iter; left time: 2322.3439s
	iters: 400, epoch: 4 | loss: 0.1148901
	speed: 0.0498s/iter; left time: 2247.4037s
Epoch: 4 cost time: 24.130985498428345
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0650468
	speed: 0.2647s/iter; left time: 11893.2540s
	iters: 200, epoch: 5 | loss: 0.0177359
	speed: 0.0492s/iter; left time: 2207.5950s
	iters: 300, epoch: 5 | loss: 0.0044823
	speed: 0.0517s/iter; left time: 2311.4551s
	iters: 400, epoch: 5 | loss: 0.0417504
	speed: 0.0507s/iter; left time: 2263.3984s
Epoch: 5 cost time: 24.962783813476562
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0047179
	speed: 0.2890s/iter; left time: 12847.7371s
	iters: 200, epoch: 6 | loss: 0.0138367
	speed: 0.0554s/iter; left time: 2458.1174s
	iters: 300, epoch: 6 | loss: 0.2049971
	speed: 0.0551s/iter; left time: 2439.3070s
	iters: 400, epoch: 6 | loss: 0.0030665
	speed: 0.0608s/iter; left time: 2683.6983s
Epoch: 6 cost time: 27.282561779022217
Epoch: 6, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.962263 --> -0.965407).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0522382
	speed: 0.2646s/iter; left time: 11637.0130s
	iters: 200, epoch: 7 | loss: 0.0151943
	speed: 0.0494s/iter; left time: 2167.4574s
	iters: 300, epoch: 7 | loss: 0.0081536
	speed: 0.0524s/iter; left time: 2293.3680s
	iters: 400, epoch: 7 | loss: 0.1343684
	speed: 0.0534s/iter; left time: 2333.1901s
Epoch: 7 cost time: 24.716482162475586
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.965407 --> -0.973984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3953113
	speed: 0.2373s/iter; left time: 10328.3315s
	iters: 200, epoch: 8 | loss: 0.0365168
	speed: 0.0480s/iter; left time: 2082.3918s
	iters: 300, epoch: 8 | loss: 0.0082559
	speed: 0.0508s/iter; left time: 2198.8610s
	iters: 400, epoch: 8 | loss: 0.2381578
	speed: 0.0547s/iter; left time: 2365.1165s
Epoch: 8 cost time: 23.86023259162903
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0019423
	speed: 0.3838s/iter; left time: 16522.5344s
	iters: 200, epoch: 9 | loss: 0.0237103
	speed: 0.0907s/iter; left time: 3896.4597s
	iters: 300, epoch: 9 | loss: 0.1097922
	speed: 0.0930s/iter; left time: 3983.4527s
	iters: 400, epoch: 9 | loss: 0.0019354
	speed: 0.0868s/iter; left time: 3709.8471s
Epoch: 9 cost time: 42.20586800575256
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.975985).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0042862
	speed: 0.4470s/iter; left time: 19031.9826s
	iters: 200, epoch: 10 | loss: 0.0052416
	speed: 0.0945s/iter; left time: 4014.4384s
	iters: 300, epoch: 10 | loss: 0.1538125
	speed: 0.0959s/iter; left time: 4063.4706s
	iters: 400, epoch: 10 | loss: 0.0018162
	speed: 0.0834s/iter; left time: 3527.7559s
Epoch: 10 cost time: 42.76931619644165
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0328608
	speed: 0.4588s/iter; left time: 19319.4508s
	iters: 200, epoch: 11 | loss: 0.2721143
	speed: 0.0849s/iter; left time: 3568.5830s
	iters: 300, epoch: 11 | loss: 0.0023932
	speed: 0.0811s/iter; left time: 3399.8197s
	iters: 400, epoch: 11 | loss: 0.0724335
	speed: 0.0940s/iter; left time: 3931.6074s
Epoch: 11 cost time: 42.53231954574585
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0021495
	speed: 0.3983s/iter; left time: 16586.3577s
	iters: 200, epoch: 12 | loss: 0.0001226
	speed: 0.0580s/iter; left time: 2408.3612s
	iters: 300, epoch: 12 | loss: 0.0076990
	speed: 0.0815s/iter; left time: 3378.4642s
	iters: 400, epoch: 12 | loss: 0.0162009
	speed: 0.0903s/iter; left time: 3732.2392s
Epoch: 12 cost time: 34.81277680397034
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000667
	speed: 0.4264s/iter; left time: 17555.1351s
	iters: 200, epoch: 13 | loss: 0.0296219
	speed: 0.0904s/iter; left time: 3713.2388s
	iters: 300, epoch: 13 | loss: 0.0001855
	speed: 0.0938s/iter; left time: 3843.2806s
	iters: 400, epoch: 13 | loss: 0.0155796
	speed: 0.0904s/iter; left time: 3696.7825s
Epoch: 13 cost time: 41.54151964187622
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0010071
	speed: 0.4105s/iter; left time: 16709.6513s
	iters: 200, epoch: 14 | loss: 0.0012558
	speed: 0.0836s/iter; left time: 3392.5210s
	iters: 300, epoch: 14 | loss: 0.0486939
	speed: 0.0679s/iter; left time: 2749.4259s
	iters: 400, epoch: 14 | loss: 0.0981641
	speed: 0.0738s/iter; left time: 2982.7273s
Epoch: 14 cost time: 37.95991539955139
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0009612
	speed: 0.4187s/iter; left time: 16845.9539s
	iters: 200, epoch: 15 | loss: 0.3410963
	speed: 0.0802s/iter; left time: 3217.3744s
	iters: 300, epoch: 15 | loss: 0.0120915
	speed: 0.0929s/iter; left time: 3720.5784s
	iters: 400, epoch: 15 | loss: 0.0025995
	speed: 0.0803s/iter; left time: 3208.2059s
Epoch: 15 cost time: 37.25443172454834
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.976271).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0035935
	speed: 0.3634s/iter; left time: 14452.8640s
	iters: 200, epoch: 16 | loss: 0.0070675
	speed: 0.0895s/iter; left time: 3549.3269s
	iters: 300, epoch: 16 | loss: 0.0082725
	speed: 0.0904s/iter; left time: 3576.6566s
	iters: 400, epoch: 16 | loss: 0.0145104
	speed: 0.0868s/iter; left time: 3425.4959s
Epoch: 16 cost time: 41.186065435409546
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0004953
	speed: 0.4323s/iter; left time: 16986.2902s
	iters: 200, epoch: 17 | loss: 0.0172501
	speed: 0.0784s/iter; left time: 3074.2329s
	iters: 300, epoch: 17 | loss: 0.0005337
	speed: 0.0793s/iter; left time: 3099.2240s
	iters: 400, epoch: 17 | loss: 0.0042333
	speed: 0.0834s/iter; left time: 3252.6759s
Epoch: 17 cost time: 38.826534032821655
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.981417).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0001927
	speed: 0.3974s/iter; left time: 15429.2768s
	iters: 200, epoch: 18 | loss: 0.0401786
	speed: 0.0804s/iter; left time: 3113.4281s
	iters: 300, epoch: 18 | loss: 0.0001043
	speed: 0.0829s/iter; left time: 3200.6510s
	iters: 400, epoch: 18 | loss: 0.0001059
	speed: 0.0892s/iter; left time: 3437.1024s
Epoch: 18 cost time: 38.93102765083313
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0004991
	speed: 0.3978s/iter; left time: 15260.0273s
	iters: 200, epoch: 19 | loss: 0.0007422
	speed: 0.0887s/iter; left time: 3393.8978s
	iters: 300, epoch: 19 | loss: 0.0027909
	speed: 0.0872s/iter; left time: 3328.6624s
	iters: 400, epoch: 19 | loss: 0.0018360
	speed: 0.0806s/iter; left time: 3067.7673s
Epoch: 19 cost time: 39.20804810523987
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0502978
	speed: 0.2922s/iter; left time: 11073.0487s
	iters: 200, epoch: 20 | loss: 0.0011403
	speed: 0.0872s/iter; left time: 3294.7914s
	iters: 300, epoch: 20 | loss: 0.0103719
	speed: 0.0773s/iter; left time: 2911.6729s
	iters: 400, epoch: 20 | loss: 0.0000825
	speed: 0.0753s/iter; left time: 2831.5567s
Epoch: 20 cost time: 37.14334177970886
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0482308
	speed: 0.4045s/iter; left time: 15138.2850s
	iters: 200, epoch: 21 | loss: 0.0014078
	speed: 0.0828s/iter; left time: 3088.3695s
	iters: 300, epoch: 21 | loss: 0.0001981
	speed: 0.0800s/iter; left time: 2979.3596s
	iters: 400, epoch: 21 | loss: 0.0048433
	speed: 0.0814s/iter; left time: 3019.9600s
Epoch: 21 cost time: 39.33752250671387
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0010942
	speed: 0.4467s/iter; left time: 16505.7920s
	iters: 200, epoch: 22 | loss: 0.0008792
	speed: 0.0827s/iter; left time: 3049.4001s
	iters: 300, epoch: 22 | loss: 0.0002579
	speed: 0.0842s/iter; left time: 3095.1802s
	iters: 400, epoch: 22 | loss: 0.0002643
	speed: 0.0899s/iter; left time: 3296.6816s
Epoch: 22 cost time: 41.3907425403595
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.3927126
	speed: 0.3751s/iter; left time: 13685.4624s
	iters: 200, epoch: 23 | loss: 0.0000826
	speed: 0.0534s/iter; left time: 1941.9752s
	iters: 300, epoch: 23 | loss: 0.1552364
	speed: 0.0785s/iter; left time: 2848.8912s
	iters: 400, epoch: 23 | loss: 0.0004618
	speed: 0.0778s/iter; left time: 2814.1324s
Epoch: 23 cost time: 32.519646406173706
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0083659
	speed: 0.4163s/iter; left time: 14992.0625s
	iters: 200, epoch: 24 | loss: 0.0001026
	speed: 0.0868s/iter; left time: 3117.3313s
	iters: 300, epoch: 24 | loss: 0.0023855
	speed: 0.0730s/iter; left time: 2615.9721s
	iters: 400, epoch: 24 | loss: 0.0001664
	speed: 0.0734s/iter; left time: 2622.6773s
Epoch: 24 cost time: 37.68492937088013
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0083188
	speed: 0.4074s/iter; left time: 14479.8092s
	iters: 200, epoch: 25 | loss: 0.0089054
	speed: 0.0824s/iter; left time: 2922.3918s
	iters: 300, epoch: 25 | loss: 0.0006976
	speed: 0.0702s/iter; left time: 2480.9321s
	iters: 400, epoch: 25 | loss: 0.0040541
	speed: 0.0491s/iter; left time: 1729.3455s
Epoch: 25 cost time: 31.368781805038452
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0045429
	speed: 0.3802s/iter; left time: 13334.2008s
	iters: 200, epoch: 26 | loss: 0.0002110
	speed: 0.0781s/iter; left time: 2733.1838s
	iters: 300, epoch: 26 | loss: 0.0295734
	speed: 0.0780s/iter; left time: 2718.7537s
	iters: 400, epoch: 26 | loss: 0.0004786
	speed: 0.0857s/iter; left time: 2980.0065s
Epoch: 26 cost time: 38.67675733566284
Epoch: 26, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.982846).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000330
	speed: 0.3980s/iter; left time: 13773.4017s
	iters: 200, epoch: 27 | loss: 0.0078531
	speed: 0.0775s/iter; left time: 2674.9619s
	iters: 300, epoch: 27 | loss: 0.0018008
	speed: 0.0748s/iter; left time: 2575.1294s
	iters: 400, epoch: 27 | loss: 0.0000040
	speed: 0.0723s/iter; left time: 2482.0090s
Epoch: 27 cost time: 36.718634366989136
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.6193758
	speed: 0.4021s/iter; left time: 13725.3210s
	iters: 200, epoch: 28 | loss: 1.0178360
	speed: 0.0801s/iter; left time: 2726.0030s
	iters: 300, epoch: 28 | loss: 0.0002610
	speed: 0.0816s/iter; left time: 2767.7830s
	iters: 400, epoch: 28 | loss: 0.0004399
	speed: 0.0808s/iter; left time: 2734.3113s
Epoch: 28 cost time: 38.25917911529541
Epoch: 28, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0003043
	speed: 0.4054s/iter; left time: 13650.0931s
	iters: 200, epoch: 29 | loss: 0.0006343
	speed: 0.0832s/iter; left time: 2793.3851s
	iters: 300, epoch: 29 | loss: 0.0000152
	speed: 0.0788s/iter; left time: 2636.1226s
	iters: 400, epoch: 29 | loss: 0.0003176
	speed: 0.0748s/iter; left time: 2494.8829s
Epoch: 29 cost time: 38.377256870269775
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0007381
	speed: 0.4000s/iter; left time: 13280.7985s
	iters: 200, epoch: 30 | loss: 0.0031594
	speed: 0.0724s/iter; left time: 2395.1750s
	iters: 300, epoch: 30 | loss: 0.0010733
	speed: 0.0574s/iter; left time: 1895.1200s
	iters: 400, epoch: 30 | loss: 0.0001163
	speed: 0.0462s/iter; left time: 1521.2483s
Epoch: 30 cost time: 29.01655602455139
Epoch: 30, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0638102
	speed: 0.3513s/iter; left time: 11497.1493s
	iters: 200, epoch: 31 | loss: 0.0000957
	speed: 0.0774s/iter; left time: 2524.7033s
	iters: 300, epoch: 31 | loss: 0.0018711
	speed: 0.0802s/iter; left time: 2607.8511s
	iters: 400, epoch: 31 | loss: 0.0000247
	speed: 0.0832s/iter; left time: 2697.7654s
Epoch: 31 cost time: 38.53674030303955
Epoch: 31, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0028835
	speed: 0.4284s/iter; left time: 13822.0377s
	iters: 200, epoch: 32 | loss: 0.0000568
	speed: 0.0752s/iter; left time: 2417.0624s
	iters: 300, epoch: 32 | loss: 0.0552799
	speed: 0.0859s/iter; left time: 2754.8079s
	iters: 400, epoch: 32 | loss: 0.0001984
	speed: 0.0893s/iter; left time: 2855.7331s
Epoch: 32 cost time: 39.21686840057373
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0048397
	speed: 0.4151s/iter; left time: 13196.7119s
	iters: 200, epoch: 33 | loss: 0.0000063
	speed: 0.0814s/iter; left time: 2579.5395s
	iters: 300, epoch: 33 | loss: 0.0000138
	speed: 0.0763s/iter; left time: 2411.2652s
	iters: 400, epoch: 33 | loss: 0.0000291
	speed: 0.0717s/iter; left time: 2257.6641s
Epoch: 33 cost time: 37.85553216934204
Epoch: 33, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0063734
	speed: 0.3849s/iter; left time: 12056.2605s
	iters: 200, epoch: 34 | loss: 0.0001452
	speed: 0.0816s/iter; left time: 2549.2848s
	iters: 300, epoch: 34 | loss: 0.0028954
	speed: 0.0745s/iter; left time: 2320.1132s
	iters: 400, epoch: 34 | loss: 0.0362446
	speed: 0.0658s/iter; left time: 2040.9191s
Epoch: 34 cost time: 33.14647078514099
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0203969
	speed: 0.3292s/iter; left time: 10156.3002s
	iters: 200, epoch: 35 | loss: 0.0010514
	speed: 0.0731s/iter; left time: 2247.1473s
	iters: 300, epoch: 35 | loss: 0.0098342
	speed: 0.0777s/iter; left time: 2382.2876s
	iters: 400, epoch: 35 | loss: 0.0211572
	speed: 0.0870s/iter; left time: 2658.0391s
Epoch: 35 cost time: 36.42385387420654
Epoch: 35, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0004198
	speed: 0.3736s/iter; left time: 11351.3414s
	iters: 200, epoch: 36 | loss: 0.0000301
	speed: 0.0831s/iter; left time: 2517.4591s
	iters: 300, epoch: 36 | loss: 0.0000163
	speed: 0.0776s/iter; left time: 2343.6721s
	iters: 400, epoch: 36 | loss: 0.1755661
	speed: 0.0670s/iter; left time: 2014.2966s
Epoch: 36 cost time: 36.4591429233551
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 356922
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6274936
	speed: 0.0906s/iter; left time: 4237.9783s
	iters: 200, epoch: 1 | loss: 0.4595055
	speed: 0.0703s/iter; left time: 3281.3964s
	iters: 300, epoch: 1 | loss: 0.0580929
	speed: 0.0658s/iter; left time: 3064.6936s
	iters: 400, epoch: 1 | loss: 0.0179916
	speed: 0.0779s/iter; left time: 3622.3312s
Epoch: 1 cost time: 35.68391227722168
Epoch: 1, Steps: 469 | Train Loss: 0.445 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (inf --> -0.955973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0177225
	speed: 0.3524s/iter; left time: 16329.0646s
	iters: 200, epoch: 2 | loss: 0.0232585
	speed: 0.0469s/iter; left time: 2169.5137s
	iters: 300, epoch: 2 | loss: 0.0703694
	speed: 0.0603s/iter; left time: 2783.0597s
	iters: 400, epoch: 2 | loss: 0.1488478
	speed: 0.0682s/iter; left time: 3139.0783s
Epoch: 2 cost time: 28.641693115234375
Epoch: 2, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0740307
	speed: 0.4046s/iter; left time: 18557.7030s
	iters: 200, epoch: 3 | loss: 0.0486897
	speed: 0.0761s/iter; left time: 3482.1284s
	iters: 300, epoch: 3 | loss: 0.0330517
	speed: 0.0726s/iter; left time: 3314.9050s
	iters: 400, epoch: 3 | loss: 0.0818376
	speed: 0.0831s/iter; left time: 3785.2258s
Epoch: 3 cost time: 36.5312614440918
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0193829
	speed: 0.3699s/iter; left time: 16792.7148s
	iters: 200, epoch: 4 | loss: 0.0056164
	speed: 0.0825s/iter; left time: 3737.8317s
	iters: 300, epoch: 4 | loss: 0.0008268
	speed: 0.0811s/iter; left time: 3663.2182s
	iters: 400, epoch: 4 | loss: 0.2095673
	speed: 0.0758s/iter; left time: 3417.3173s
Epoch: 4 cost time: 36.6333441734314
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.955973 --> -0.958546).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0131590
	speed: 0.3905s/iter; left time: 17543.0545s
	iters: 200, epoch: 5 | loss: 0.0613029
	speed: 0.0688s/iter; left time: 3083.5758s
	iters: 300, epoch: 5 | loss: 0.0030233
	speed: 0.0470s/iter; left time: 2103.9727s
	iters: 400, epoch: 5 | loss: 0.0250870
	speed: 0.0442s/iter; left time: 1973.8009s
Epoch: 5 cost time: 28.375078916549683
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.958546 --> -0.965121).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0103072
	speed: 0.3790s/iter; left time: 16850.7395s
	iters: 200, epoch: 6 | loss: 0.1324408
	speed: 0.0710s/iter; left time: 3150.1172s
	iters: 300, epoch: 6 | loss: 0.0360797
	speed: 0.0723s/iter; left time: 3200.5154s
	iters: 400, epoch: 6 | loss: 0.0026695
	speed: 0.0808s/iter; left time: 3566.8950s
Epoch: 6 cost time: 35.90959405899048
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0382694
	speed: 0.3735s/iter; left time: 16430.8798s
	iters: 200, epoch: 7 | loss: 0.0564818
	speed: 0.0717s/iter; left time: 3145.2008s
	iters: 300, epoch: 7 | loss: 0.0817018
	speed: 0.0834s/iter; left time: 3650.9993s
	iters: 400, epoch: 7 | loss: 0.0066313
	speed: 0.0813s/iter; left time: 3551.1053s
Epoch: 7 cost time: 36.64855337142944
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
Validation loss decreased (-0.965121 --> -0.965693).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0923626
	speed: 0.3541s/iter; left time: 15408.5984s
	iters: 200, epoch: 8 | loss: 0.0250009
	speed: 0.0708s/iter; left time: 3076.1327s
	iters: 300, epoch: 8 | loss: 0.0011521
	speed: 0.0498s/iter; left time: 2156.8145s
	iters: 400, epoch: 8 | loss: 0.0034062
	speed: 0.0429s/iter; left time: 1854.3766s
Epoch: 8 cost time: 27.61283540725708
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967122).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0020384
	speed: 0.3217s/iter; left time: 13849.1761s
	iters: 200, epoch: 9 | loss: 0.1797420
	speed: 0.0692s/iter; left time: 2973.1935s
	iters: 300, epoch: 9 | loss: 0.0712823
	speed: 0.0649s/iter; left time: 2782.8467s
	iters: 400, epoch: 9 | loss: 0.0145808
	speed: 0.0655s/iter; left time: 2800.9663s
Epoch: 9 cost time: 32.304983615875244
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
Validation loss decreased (-0.967122 --> -0.970839).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0211568
	speed: 0.3565s/iter; left time: 15178.0492s
	iters: 200, epoch: 10 | loss: 0.0093696
	speed: 0.0651s/iter; left time: 2763.8681s
	iters: 300, epoch: 10 | loss: 0.0441790
	speed: 0.0751s/iter; left time: 3181.8753s
	iters: 400, epoch: 10 | loss: 0.0012047
	speed: 0.0557s/iter; left time: 2356.3984s
Epoch: 10 cost time: 29.32285237312317
Epoch: 10, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0052095
	speed: 0.2679s/iter; left time: 11279.8144s
	iters: 200, epoch: 11 | loss: 0.6010729
	speed: 0.0685s/iter; left time: 2876.1754s
	iters: 300, epoch: 11 | loss: 0.0008202
	speed: 0.0772s/iter; left time: 3237.4550s
	iters: 400, epoch: 11 | loss: 0.0016881
	speed: 0.0781s/iter; left time: 3267.1032s
Epoch: 11 cost time: 34.356194734573364
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
Validation loss decreased (-0.970839 --> -0.973698).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001449
	speed: 0.3688s/iter; left time: 15356.4071s
	iters: 200, epoch: 12 | loss: 0.0022692
	speed: 0.0775s/iter; left time: 3217.7905s
	iters: 300, epoch: 12 | loss: 0.0026984
	speed: 0.0759s/iter; left time: 3147.1349s
	iters: 400, epoch: 12 | loss: 0.0081908
	speed: 0.0731s/iter; left time: 3021.6107s
Epoch: 12 cost time: 35.874223709106445
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.972 Test Loss: 0.162 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0006610
	speed: 0.3467s/iter; left time: 14276.6619s
	iters: 200, epoch: 13 | loss: 0.0154172
	speed: 0.0395s/iter; left time: 1621.5767s
	iters: 300, epoch: 13 | loss: 0.0064824
	speed: 0.0418s/iter; left time: 1713.1937s
	iters: 400, epoch: 13 | loss: 0.0001447
	speed: 0.0652s/iter; left time: 2664.9084s
Epoch: 13 cost time: 25.078269481658936
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0002409
	speed: 0.3638s/iter; left time: 14808.6163s
	iters: 200, epoch: 14 | loss: 0.0158254
	speed: 0.0766s/iter; left time: 3111.7426s
	iters: 300, epoch: 14 | loss: 0.0117853
	speed: 0.0801s/iter; left time: 3246.2953s
	iters: 400, epoch: 14 | loss: 0.1959164
	speed: 0.0786s/iter; left time: 3177.5253s
Epoch: 14 cost time: 36.097426891326904
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
Validation loss decreased (-0.973698 --> -0.978272).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0100307
	speed: 0.3743s/iter; left time: 15059.7308s
	iters: 200, epoch: 15 | loss: 0.1977774
	speed: 0.0821s/iter; left time: 3293.5003s
	iters: 300, epoch: 15 | loss: 0.0002016
	speed: 0.0826s/iter; left time: 3306.6943s
	iters: 400, epoch: 15 | loss: 0.0070931
	speed: 0.0696s/iter; left time: 2777.5840s
Epoch: 15 cost time: 34.20635747909546
Epoch: 15, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.980559).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1001759
	speed: 0.2848s/iter; left time: 11323.9494s
	iters: 200, epoch: 16 | loss: 0.0125653
	speed: 0.0731s/iter; left time: 2899.2362s
	iters: 300, epoch: 16 | loss: 0.0445444
	speed: 0.0635s/iter; left time: 2510.4858s
	iters: 400, epoch: 16 | loss: 0.0038674
	speed: 0.0748s/iter; left time: 2952.0685s
Epoch: 16 cost time: 34.85098052024841
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0012273
	speed: 0.3738s/iter; left time: 14690.1485s
	iters: 200, epoch: 17 | loss: 0.0170737
	speed: 0.0682s/iter; left time: 2673.9112s
	iters: 300, epoch: 17 | loss: 0.0022399
	speed: 0.0683s/iter; left time: 2669.6358s
	iters: 400, epoch: 17 | loss: 0.0013941
	speed: 0.0757s/iter; left time: 2953.4972s
Epoch: 17 cost time: 33.525822162628174
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000085
	speed: 0.3550s/iter; left time: 13785.7920s
	iters: 200, epoch: 18 | loss: 0.0011696
	speed: 0.0709s/iter; left time: 2744.6372s
	iters: 300, epoch: 18 | loss: 0.0002204
	speed: 0.0837s/iter; left time: 3233.7116s
	iters: 400, epoch: 18 | loss: 0.0000280
	speed: 0.0794s/iter; left time: 3057.8887s
Epoch: 18 cost time: 35.81669521331787
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0077266
	speed: 0.3563s/iter; left time: 13667.6526s
	iters: 200, epoch: 19 | loss: 0.0565422
	speed: 0.0731s/iter; left time: 2796.4468s
	iters: 300, epoch: 19 | loss: 0.0131035
	speed: 0.0747s/iter; left time: 2851.8972s
	iters: 400, epoch: 19 | loss: 0.0008371
	speed: 0.0740s/iter; left time: 2816.6067s
Epoch: 19 cost time: 34.7330105304718
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3407688
	speed: 0.3536s/iter; left time: 13396.5254s
	iters: 200, epoch: 20 | loss: 0.0001096
	speed: 0.0661s/iter; left time: 2499.6286s
	iters: 300, epoch: 20 | loss: 0.0035852
	speed: 0.0700s/iter; left time: 2639.1383s
	iters: 400, epoch: 20 | loss: 0.0014262
	speed: 0.0685s/iter; left time: 2574.1227s
Epoch: 20 cost time: 32.36918663978577
Epoch: 20, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0017821
	speed: 0.3507s/iter; left time: 13124.5525s
	iters: 200, epoch: 21 | loss: 0.0215078
	speed: 0.0571s/iter; left time: 2131.3921s
	iters: 300, epoch: 21 | loss: 0.0024173
	speed: 0.0448s/iter; left time: 1667.2572s
	iters: 400, epoch: 21 | loss: 0.0020819
	speed: 0.0466s/iter; left time: 1728.1450s
Epoch: 21 cost time: 25.767006874084473
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0019473
	speed: 0.3514s/iter; left time: 12984.4642s
	iters: 200, epoch: 22 | loss: 0.0000916
	speed: 0.0774s/iter; left time: 2850.8336s
	iters: 300, epoch: 22 | loss: 0.0001914
	speed: 0.0782s/iter; left time: 2875.0380s
	iters: 400, epoch: 22 | loss: 0.0145559
	speed: 0.0732s/iter; left time: 2682.7574s
Epoch: 22 cost time: 36.092583894729614
Epoch: 22, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0510788
	speed: 0.3531s/iter; left time: 12881.1252s
	iters: 200, epoch: 23 | loss: 0.0000799
	speed: 0.0629s/iter; left time: 2287.5650s
	iters: 300, epoch: 23 | loss: 0.0000794
	speed: 0.0808s/iter; left time: 2932.7518s
	iters: 400, epoch: 23 | loss: 0.0000764
	speed: 0.0777s/iter; left time: 2810.4134s
Epoch: 23 cost time: 33.36573386192322
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.1667850
	speed: 0.3588s/iter; left time: 12920.1222s
	iters: 200, epoch: 24 | loss: 0.0000367
	speed: 0.0760s/iter; left time: 2728.3836s
	iters: 300, epoch: 24 | loss: 0.0027618
	speed: 0.0759s/iter; left time: 2716.7575s
	iters: 400, epoch: 24 | loss: 0.0004040
	speed: 0.0766s/iter; left time: 2735.0192s
Epoch: 24 cost time: 35.35886740684509
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.4510563
	speed: 0.2904s/iter; left time: 10322.4114s
	iters: 200, epoch: 25 | loss: 0.0001670
	speed: 0.0765s/iter; left time: 2712.8453s
	iters: 300, epoch: 25 | loss: 0.0000316
	speed: 0.0649s/iter; left time: 2293.5319s
	iters: 400, epoch: 25 | loss: 0.0448073
	speed: 0.0646s/iter; left time: 2277.7362s
Epoch: 25 cost time: 33.63482475280762
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 356922
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6145594
	speed: 0.0833s/iter; left time: 3900.7373s
	iters: 200, epoch: 1 | loss: 0.3747203
	speed: 0.0709s/iter; left time: 3312.6351s
	iters: 300, epoch: 1 | loss: 0.0537669
	speed: 0.0764s/iter; left time: 3561.5324s
	iters: 400, epoch: 1 | loss: 0.0139792
	speed: 0.0777s/iter; left time: 3611.0206s
Epoch: 1 cost time: 35.513038635253906
Epoch: 1, Steps: 469 | Train Loss: 0.433 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
Validation loss decreased (inf --> -0.954544).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0097036
	speed: 0.3486s/iter; left time: 16151.6242s
	iters: 200, epoch: 2 | loss: 0.0663267
	speed: 0.0764s/iter; left time: 3533.5284s
	iters: 300, epoch: 2 | loss: 0.0087435
	speed: 0.0785s/iter; left time: 3621.0335s
	iters: 400, epoch: 2 | loss: 0.1465341
	speed: 0.0592s/iter; left time: 2727.2089s
Epoch: 2 cost time: 32.750263929367065
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.954544 --> -0.969696).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0382242
	speed: 0.3249s/iter; left time: 14901.8784s
	iters: 200, epoch: 3 | loss: 0.2219477
	speed: 0.0814s/iter; left time: 3724.3282s
	iters: 300, epoch: 3 | loss: 0.1049166
	speed: 0.0838s/iter; left time: 3825.0538s
	iters: 400, epoch: 3 | loss: 0.0388191
	speed: 0.0783s/iter; left time: 3565.7706s
Epoch: 3 cost time: 38.91960859298706
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0067862
	speed: 0.4001s/iter; left time: 18163.2101s
	iters: 200, epoch: 4 | loss: 0.0012418
	speed: 0.0728s/iter; left time: 3299.0124s
	iters: 300, epoch: 4 | loss: 0.0054457
	speed: 0.0759s/iter; left time: 3430.3791s
	iters: 400, epoch: 4 | loss: 0.2579625
	speed: 0.0773s/iter; left time: 3483.7347s
Epoch: 4 cost time: 36.58916354179382
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.970267).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0165500
	speed: 0.3761s/iter; left time: 16898.2211s
	iters: 200, epoch: 5 | loss: 0.0067661
	speed: 0.0758s/iter; left time: 3398.5769s
	iters: 300, epoch: 5 | loss: 0.0023133
	speed: 0.0770s/iter; left time: 3441.9688s
	iters: 400, epoch: 5 | loss: 0.1247455
	speed: 0.0734s/iter; left time: 3276.8610s
Epoch: 5 cost time: 36.67972421646118
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0029862
	speed: 0.3791s/iter; left time: 16852.1139s
	iters: 200, epoch: 6 | loss: 0.0179847
	speed: 0.0703s/iter; left time: 3119.5347s
	iters: 300, epoch: 6 | loss: 0.0082149
	speed: 0.0718s/iter; left time: 3175.9112s
	iters: 400, epoch: 6 | loss: 0.0005399
	speed: 0.0791s/iter; left time: 3492.3460s
Epoch: 6 cost time: 34.82656741142273
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.202 Vali Acc: 0.965 Test Loss: 0.202 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3132630
	speed: 0.3929s/iter; left time: 17283.2480s
	iters: 200, epoch: 7 | loss: 0.0087949
	speed: 0.0867s/iter; left time: 3805.6054s
	iters: 300, epoch: 7 | loss: 0.1913464
	speed: 0.0752s/iter; left time: 3293.3483s
	iters: 400, epoch: 7 | loss: 0.0003140
	speed: 0.0791s/iter; left time: 3456.3213s
Epoch: 7 cost time: 37.901041746139526
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0161495
	speed: 0.3174s/iter; left time: 13812.7493s
	iters: 200, epoch: 8 | loss: 0.1268392
	speed: 0.0793s/iter; left time: 3445.0310s
	iters: 300, epoch: 8 | loss: 0.0150055
	speed: 0.0708s/iter; left time: 3065.4027s
	iters: 400, epoch: 8 | loss: 0.0899397
	speed: 0.0771s/iter; left time: 3329.9571s
Epoch: 8 cost time: 36.458640336990356
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0021212
	speed: 0.3832s/iter; left time: 16496.6243s
	iters: 200, epoch: 9 | loss: 0.0000326
	speed: 0.0700s/iter; left time: 3006.2527s
	iters: 300, epoch: 9 | loss: 0.2449323
	speed: 0.0725s/iter; left time: 3105.6195s
	iters: 400, epoch: 9 | loss: 0.3173705
	speed: 0.0746s/iter; left time: 3189.3904s
Epoch: 9 cost time: 35.72293162345886
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.970267 --> -0.975985).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001304
	speed: 0.3722s/iter; left time: 15847.9338s
	iters: 200, epoch: 10 | loss: 0.1489037
	speed: 0.0773s/iter; left time: 3281.7830s
	iters: 300, epoch: 10 | loss: 0.0050088
	speed: 0.0803s/iter; left time: 3404.9963s
	iters: 400, epoch: 10 | loss: 0.0010309
	speed: 0.0794s/iter; left time: 3357.3988s
Epoch: 10 cost time: 36.741631507873535
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0078828
	speed: 0.3591s/iter; left time: 15122.9886s
	iters: 200, epoch: 11 | loss: 0.4347040
	speed: 0.0495s/iter; left time: 2081.0715s
	iters: 300, epoch: 11 | loss: 0.1045113
	speed: 0.0429s/iter; left time: 1798.1393s
	iters: 400, epoch: 11 | loss: 0.0009736
	speed: 0.0568s/iter; left time: 2375.9584s
Epoch: 11 cost time: 24.867796659469604
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0246712
	speed: 0.3490s/iter; left time: 14534.2627s
	iters: 200, epoch: 12 | loss: 0.0000131
	speed: 0.0689s/iter; left time: 2862.1244s
	iters: 300, epoch: 12 | loss: 0.0000096
	speed: 0.0670s/iter; left time: 2777.2663s
	iters: 400, epoch: 12 | loss: 0.0031394
	speed: 0.0793s/iter; left time: 3279.0565s
Epoch: 12 cost time: 34.58680486679077
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000726
	speed: 0.3687s/iter; left time: 15181.6659s
	iters: 200, epoch: 13 | loss: 0.0121279
	speed: 0.0793s/iter; left time: 3255.6224s
	iters: 300, epoch: 13 | loss: 0.0268477
	speed: 0.0815s/iter; left time: 3338.8013s
	iters: 400, epoch: 13 | loss: 0.0010298
	speed: 0.0801s/iter; left time: 3273.6152s
Epoch: 13 cost time: 36.46910071372986
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000402
	speed: 0.3246s/iter; left time: 13212.6038s
	iters: 200, epoch: 14 | loss: 0.0029578
	speed: 0.0597s/iter; left time: 2422.6942s
	iters: 300, epoch: 14 | loss: 0.2108205
	speed: 0.0682s/iter; left time: 2762.0028s
	iters: 400, epoch: 14 | loss: 0.0074337
	speed: 0.0714s/iter; left time: 2885.2163s
Epoch: 14 cost time: 30.267842531204224
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0002326
	speed: 0.3378s/iter; left time: 13590.2075s
	iters: 200, epoch: 15 | loss: 0.0303071
	speed: 0.0628s/iter; left time: 2521.6385s
	iters: 300, epoch: 15 | loss: 0.0030388
	speed: 0.0660s/iter; left time: 2642.1836s
	iters: 400, epoch: 15 | loss: 0.2054118
	speed: 0.0669s/iter; left time: 2671.0293s
Epoch: 15 cost time: 31.434752225875854
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000140
	speed: 0.3406s/iter; left time: 13543.0396s
	iters: 200, epoch: 16 | loss: 0.0005944
	speed: 0.0698s/iter; left time: 2768.3265s
	iters: 300, epoch: 16 | loss: 0.3010263
	speed: 0.0721s/iter; left time: 2850.9776s
	iters: 400, epoch: 16 | loss: 0.0403029
	speed: 0.0752s/iter; left time: 2967.4417s
Epoch: 16 cost time: 33.83699059486389
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.978272 --> -0.982846).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0363204
	speed: 0.3538s/iter; left time: 13902.6913s
	iters: 200, epoch: 17 | loss: 0.0615595
	speed: 0.0706s/iter; left time: 2768.3153s
	iters: 300, epoch: 17 | loss: 0.0000764
	speed: 0.0735s/iter; left time: 2873.0397s
	iters: 400, epoch: 17 | loss: 0.0448450
	speed: 0.0790s/iter; left time: 3081.1025s
Epoch: 17 cost time: 35.116394996643066
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.974 Test Loss: 0.200 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001315
	speed: 0.2848s/iter; left time: 11058.3843s
	iters: 200, epoch: 18 | loss: 0.1419976
	speed: 0.0653s/iter; left time: 2528.5517s
	iters: 300, epoch: 18 | loss: 0.0016218
	speed: 0.0799s/iter; left time: 3084.6724s
	iters: 400, epoch: 18 | loss: 0.0000270
	speed: 0.0783s/iter; left time: 3016.0249s
Epoch: 18 cost time: 31.985545873641968
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000708
	speed: 0.3900s/iter; left time: 14958.7358s
	iters: 200, epoch: 19 | loss: 0.0035225
	speed: 0.0738s/iter; left time: 2821.6287s
	iters: 300, epoch: 19 | loss: 0.2740864
	speed: 0.0837s/iter; left time: 3192.9546s
	iters: 400, epoch: 19 | loss: 0.0000665
	speed: 0.0849s/iter; left time: 3232.6025s
Epoch: 19 cost time: 37.953129291534424
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0245042
	speed: 0.3962s/iter; left time: 15012.1248s
	iters: 200, epoch: 20 | loss: 0.0014405
	speed: 0.0700s/iter; left time: 2646.1211s
	iters: 300, epoch: 20 | loss: 0.0000433
	speed: 0.0743s/iter; left time: 2798.7266s
	iters: 400, epoch: 20 | loss: 0.0124031
	speed: 0.0859s/iter; left time: 3229.2969s
Epoch: 20 cost time: 37.03082203865051
Epoch: 20, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0005925
	speed: 0.2849s/iter; left time: 10662.9229s
	iters: 200, epoch: 21 | loss: 0.0000615
	speed: 0.0717s/iter; left time: 2676.2591s
	iters: 300, epoch: 21 | loss: 0.0005301
	speed: 0.0808s/iter; left time: 3006.5324s
	iters: 400, epoch: 21 | loss: 0.0000027
	speed: 0.0806s/iter; left time: 2992.2922s
Epoch: 21 cost time: 32.817017793655396
Epoch: 21, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.203 Vali Acc: 0.973 Test Loss: 0.203 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0078947
	speed: 0.3516s/iter; left time: 12993.5314s
	iters: 200, epoch: 22 | loss: 0.0108976
	speed: 0.0787s/iter; left time: 2898.9803s
	iters: 300, epoch: 22 | loss: 0.0004641
	speed: 0.0772s/iter; left time: 2835.9787s
	iters: 400, epoch: 22 | loss: 0.0001724
	speed: 0.0745s/iter; left time: 2729.6982s
Epoch: 22 cost time: 35.46889328956604
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000765
	speed: 0.3919s/iter; left time: 14298.5771s
	iters: 200, epoch: 23 | loss: 0.0009475
	speed: 0.0800s/iter; left time: 2909.6490s
	iters: 300, epoch: 23 | loss: 0.0000005
	speed: 0.0718s/iter; left time: 2605.4786s
	iters: 400, epoch: 23 | loss: 0.0003041
	speed: 0.0487s/iter; left time: 1763.5371s
Epoch: 23 cost time: 32.39238786697388
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.982 Test Loss: 0.158 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.1696223
	speed: 0.3443s/iter; left time: 12399.6194s
	iters: 200, epoch: 24 | loss: 0.0000144
	speed: 0.0772s/iter; left time: 2773.9033s
	iters: 300, epoch: 24 | loss: 0.0200202
	speed: 0.0808s/iter; left time: 2893.5294s
	iters: 400, epoch: 24 | loss: 0.0015701
	speed: 0.0769s/iter; left time: 2746.1143s
Epoch: 24 cost time: 36.392898082733154
Epoch: 24, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.982 Test Loss: 0.150 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0115626
	speed: 0.3614s/iter; left time: 12845.7294s
	iters: 200, epoch: 25 | loss: 0.0868294
	speed: 0.0648s/iter; left time: 2295.2803s
	iters: 300, epoch: 25 | loss: 0.0021708
	speed: 0.0703s/iter; left time: 2483.9384s
	iters: 400, epoch: 25 | loss: 0.0000261
	speed: 0.0806s/iter; left time: 2841.1322s
Epoch: 25 cost time: 34.15954518318176
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.4561072
	speed: 0.3629s/iter; left time: 12728.2935s
	iters: 200, epoch: 26 | loss: 0.0000272
	speed: 0.0763s/iter; left time: 2667.2742s
	iters: 300, epoch: 26 | loss: 0.0000073
	speed: 0.0784s/iter; left time: 2734.7986s
	iters: 400, epoch: 26 | loss: 0.0012706
	speed: 0.0696s/iter; left time: 2418.7949s
Epoch: 26 cost time: 35.417884349823
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.981 Test Loss: 0.148 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 356922
model size : 6.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0805377
	speed: 0.0888s/iter; left time: 4158.1135s
	iters: 200, epoch: 1 | loss: 0.3536524
	speed: 0.0705s/iter; left time: 3294.6223s
	iters: 300, epoch: 1 | loss: 0.1788165
	speed: 0.0689s/iter; left time: 3211.2991s
	iters: 400, epoch: 1 | loss: 0.0310809
	speed: 0.0625s/iter; left time: 2906.6144s
Epoch: 1 cost time: 33.209765911102295
Epoch: 1, Steps: 469 | Train Loss: 0.593 Vali Loss: 0.307 Vali Acc: 0.899 Test Loss: 0.307 Test Acc: 0.899
Validation loss decreased (inf --> -0.899082).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0771977
	speed: 0.3472s/iter; left time: 16086.8876s
	iters: 200, epoch: 2 | loss: 0.0752127
	speed: 0.0668s/iter; left time: 3089.3579s
	iters: 300, epoch: 2 | loss: 0.0524381
	speed: 0.0687s/iter; left time: 3167.5222s
	iters: 400, epoch: 2 | loss: 0.0984166
	speed: 0.0712s/iter; left time: 3278.8866s
Epoch: 2 cost time: 34.157854318618774
Epoch: 2, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
Validation loss decreased (-0.899082 --> -0.954544).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0887484
	speed: 0.3330s/iter; left time: 15273.5208s
	iters: 200, epoch: 3 | loss: 0.1188508
	speed: 0.0592s/iter; left time: 2710.0978s
	iters: 300, epoch: 3 | loss: 0.0348259
	speed: 0.0720s/iter; left time: 3287.7812s
	iters: 400, epoch: 3 | loss: 0.0721530
	speed: 0.0693s/iter; left time: 3156.3155s
Epoch: 3 cost time: 30.76020336151123
Epoch: 3, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.954544 --> -0.967408).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0759630
	speed: 0.3426s/iter; left time: 15553.1767s
	iters: 200, epoch: 4 | loss: 0.0288244
	speed: 0.0704s/iter; left time: 3188.5123s
	iters: 300, epoch: 4 | loss: 0.1543143
	speed: 0.0663s/iter; left time: 2997.3550s
	iters: 400, epoch: 4 | loss: 0.0924581
	speed: 0.0676s/iter; left time: 3046.1998s
Epoch: 4 cost time: 33.20605683326721
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.967408 --> -0.972269).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0338307
	speed: 0.3505s/iter; left time: 15745.6149s
	iters: 200, epoch: 5 | loss: 0.0866357
	speed: 0.0660s/iter; left time: 2960.1552s
	iters: 300, epoch: 5 | loss: 0.0054110
	speed: 0.0675s/iter; left time: 3020.7313s
	iters: 400, epoch: 5 | loss: 0.0793316
	speed: 0.0614s/iter; left time: 2742.1251s
Epoch: 5 cost time: 31.788567543029785
Epoch: 5, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0925712
	speed: 0.3574s/iter; left time: 15889.5962s
	iters: 200, epoch: 6 | loss: 0.0909145
	speed: 0.0710s/iter; left time: 3148.5950s
	iters: 300, epoch: 6 | loss: 0.0092783
	speed: 0.0778s/iter; left time: 3443.5249s
	iters: 400, epoch: 6 | loss: 0.0192928
	speed: 0.0569s/iter; left time: 2513.7787s
Epoch: 6 cost time: 30.785131692886353
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0124966
	speed: 0.2924s/iter; left time: 12861.5433s
	iters: 200, epoch: 7 | loss: 0.0411086
	speed: 0.0787s/iter; left time: 3454.7194s
	iters: 300, epoch: 7 | loss: 0.2190861
	speed: 0.0754s/iter; left time: 3302.5810s
	iters: 400, epoch: 7 | loss: 0.0199253
	speed: 0.0674s/iter; left time: 2944.5749s
Epoch: 7 cost time: 34.99012994766235
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0419426
	speed: 0.3498s/iter; left time: 15223.8827s
	iters: 200, epoch: 8 | loss: 0.0229139
	speed: 0.0674s/iter; left time: 2924.6249s
	iters: 300, epoch: 8 | loss: 0.0037508
	speed: 0.0663s/iter; left time: 2872.3175s
	iters: 400, epoch: 8 | loss: 0.0322174
	speed: 0.0658s/iter; left time: 2843.3628s
Epoch: 8 cost time: 32.37842035293579
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0097232
	speed: 0.3513s/iter; left time: 15124.9767s
	iters: 200, epoch: 9 | loss: 0.1187041
	speed: 0.0664s/iter; left time: 2850.1315s
	iters: 300, epoch: 9 | loss: 0.0170423
	speed: 0.0531s/iter; left time: 2276.1919s
	iters: 400, epoch: 9 | loss: 0.0004037
	speed: 0.0425s/iter; left time: 1816.4203s
Epoch: 9 cost time: 27.258589029312134
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.974842).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0181005
	speed: 0.3150s/iter; left time: 13412.1412s
	iters: 200, epoch: 10 | loss: 0.0038570
	speed: 0.0689s/iter; left time: 2925.0076s
	iters: 300, epoch: 10 | loss: 0.0046855
	speed: 0.0741s/iter; left time: 3139.7788s
	iters: 400, epoch: 10 | loss: 0.0172363
	speed: 0.0728s/iter; left time: 3076.5512s
Epoch: 10 cost time: 33.278627157211304
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0095977
	speed: 0.3231s/iter; left time: 13607.1173s
	iters: 200, epoch: 11 | loss: 0.0141247
	speed: 0.0669s/iter; left time: 2812.5997s
	iters: 300, epoch: 11 | loss: 0.0485013
	speed: 0.0669s/iter; left time: 2803.1477s
	iters: 400, epoch: 11 | loss: 0.0036647
	speed: 0.0662s/iter; left time: 2768.4875s
Epoch: 11 cost time: 31.491857767105103
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.974842 --> -0.977700).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005884
	speed: 0.2715s/iter; left time: 11306.4731s
	iters: 200, epoch: 12 | loss: 0.0146957
	speed: 0.0633s/iter; left time: 2630.6547s
	iters: 300, epoch: 12 | loss: 0.0238081
	speed: 0.0655s/iter; left time: 2715.6944s
	iters: 400, epoch: 12 | loss: 0.0127258
	speed: 0.0682s/iter; left time: 2818.3035s
Epoch: 12 cost time: 29.48699426651001
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0270714
	speed: 0.3452s/iter; left time: 14213.6127s
	iters: 200, epoch: 13 | loss: 0.0027129
	speed: 0.0681s/iter; left time: 2795.9856s
	iters: 300, epoch: 13 | loss: 0.0108654
	speed: 0.0705s/iter; left time: 2888.5286s
	iters: 400, epoch: 13 | loss: 0.0058649
	speed: 0.0720s/iter; left time: 2944.0824s
Epoch: 13 cost time: 33.49640154838562
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0041774
	speed: 0.3469s/iter; left time: 14122.1215s
	iters: 200, epoch: 14 | loss: 0.0031379
	speed: 0.0649s/iter; left time: 2636.2431s
	iters: 300, epoch: 14 | loss: 0.0237341
	speed: 0.0585s/iter; left time: 2371.5063s
	iters: 400, epoch: 14 | loss: 0.0018374
	speed: 0.0486s/iter; left time: 1965.0997s
Epoch: 14 cost time: 27.13438391685486
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.2265926
	speed: 0.2998s/iter; left time: 12061.4356s
	iters: 200, epoch: 15 | loss: 0.0014935
	speed: 0.0722s/iter; left time: 2895.7741s
	iters: 300, epoch: 15 | loss: 0.0071333
	speed: 0.0714s/iter; left time: 2858.0809s
	iters: 400, epoch: 15 | loss: 0.0029868
	speed: 0.0720s/iter; left time: 2873.3297s
Epoch: 15 cost time: 32.52777600288391
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0011308
	speed: 0.3335s/iter; left time: 13260.8372s
	iters: 200, epoch: 16 | loss: 0.0068216
	speed: 0.0724s/iter; left time: 2873.1907s
	iters: 300, epoch: 16 | loss: 0.0155025
	speed: 0.0680s/iter; left time: 2689.8083s
	iters: 400, epoch: 16 | loss: 0.0342247
	speed: 0.0665s/iter; left time: 2625.7583s
Epoch: 16 cost time: 33.86490488052368
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0054163
	speed: 0.3602s/iter; left time: 14154.3487s
	iters: 200, epoch: 17 | loss: 0.0668407
	speed: 0.0614s/iter; left time: 2406.6044s
	iters: 300, epoch: 17 | loss: 0.0202567
	speed: 0.0693s/iter; left time: 2707.8748s
	iters: 400, epoch: 17 | loss: 0.1152514
	speed: 0.0677s/iter; left time: 2641.5118s
Epoch: 17 cost time: 31.673892498016357
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.977700 --> -0.978272).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0362718
	speed: 0.2670s/iter; left time: 10367.6200s
	iters: 200, epoch: 18 | loss: 0.0167228
	speed: 0.0621s/iter; left time: 2404.7202s
	iters: 300, epoch: 18 | loss: 0.1787288
	speed: 0.0634s/iter; left time: 2447.1743s
	iters: 400, epoch: 18 | loss: 0.0926053
	speed: 0.0708s/iter; left time: 2727.0290s
Epoch: 18 cost time: 30.52039623260498
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.980273).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0135391
	speed: 0.3480s/iter; left time: 13350.6165s
	iters: 200, epoch: 19 | loss: 0.0008910
	speed: 0.0798s/iter; left time: 3054.0912s
	iters: 300, epoch: 19 | loss: 0.0033805
	speed: 0.0786s/iter; left time: 3000.1277s
	iters: 400, epoch: 19 | loss: 0.0001077
	speed: 0.0709s/iter; left time: 2697.8512s
Epoch: 19 cost time: 34.77411603927612
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1476826
	speed: 0.3522s/iter; left time: 13343.5156s
	iters: 200, epoch: 20 | loss: 0.0002280
	speed: 0.0682s/iter; left time: 2578.0016s
	iters: 300, epoch: 20 | loss: 0.0058070
	speed: 0.0561s/iter; left time: 2114.0714s
	iters: 400, epoch: 20 | loss: 0.0011986
	speed: 0.0408s/iter; left time: 1532.6644s
Epoch: 20 cost time: 27.104772806167603
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0001255
	speed: 0.2595s/iter; left time: 9710.1337s
	iters: 200, epoch: 21 | loss: 0.0751284
	speed: 0.0549s/iter; left time: 2050.4902s
	iters: 300, epoch: 21 | loss: 0.0006789
	speed: 0.0630s/iter; left time: 2344.0456s
	iters: 400, epoch: 21 | loss: 0.0002278
	speed: 0.0667s/iter; left time: 2474.1277s
Epoch: 21 cost time: 28.715248346328735
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0555302
	speed: 0.2984s/iter; left time: 11027.7844s
	iters: 200, epoch: 22 | loss: 0.0003559
	speed: 0.0704s/iter; left time: 2594.2927s
	iters: 300, epoch: 22 | loss: 0.1927989
	speed: 0.0670s/iter; left time: 2460.8663s
	iters: 400, epoch: 22 | loss: 0.0561370
	speed: 0.0627s/iter; left time: 2297.1226s
Epoch: 22 cost time: 31.402161836624146
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0183193
	speed: 0.3263s/iter; left time: 11904.2496s
	iters: 200, epoch: 23 | loss: 0.0003855
	speed: 0.0470s/iter; left time: 1710.8535s
	iters: 300, epoch: 23 | loss: 0.0010392
	speed: 0.0448s/iter; left time: 1624.4794s
	iters: 400, epoch: 23 | loss: 0.0317066
	speed: 0.0468s/iter; left time: 1693.5152s
Epoch: 23 cost time: 25.465070247650146
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0936962
	speed: 0.3339s/iter; left time: 12023.4083s
	iters: 200, epoch: 24 | loss: 0.0002478
	speed: 0.0598s/iter; left time: 2148.2282s
	iters: 300, epoch: 24 | loss: 0.0004706
	speed: 0.0592s/iter; left time: 2120.2426s
	iters: 400, epoch: 24 | loss: 0.0004665
	speed: 0.0613s/iter; left time: 2189.2601s
Epoch: 24 cost time: 29.378227949142456
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.1021771
	speed: 0.3134s/iter; left time: 11139.3525s
	iters: 200, epoch: 25 | loss: 0.0017410
	speed: 0.0624s/iter; left time: 2210.6927s
	iters: 300, epoch: 25 | loss: 0.0122325
	speed: 0.0693s/iter; left time: 2449.6384s
	iters: 400, epoch: 25 | loss: 0.0524052
	speed: 0.0679s/iter; left time: 2391.6829s
Epoch: 25 cost time: 29.64403223991394
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0013486
	speed: 0.2572s/iter; left time: 9021.5454s
	iters: 200, epoch: 26 | loss: 0.0000964
	speed: 0.0694s/iter; left time: 2427.4000s
	iters: 300, epoch: 26 | loss: 0.0071504
	speed: 0.0685s/iter; left time: 2387.8150s
	iters: 400, epoch: 26 | loss: 0.0033448
	speed: 0.0678s/iter; left time: 2357.9503s
Epoch: 26 cost time: 32.69088864326477
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000221
	speed: 0.3495s/iter; left time: 12096.2037s
	iters: 200, epoch: 27 | loss: 0.0005175
	speed: 0.0689s/iter; left time: 2377.9133s
	iters: 300, epoch: 27 | loss: 0.0014548
	speed: 0.0646s/iter; left time: 2224.3549s
	iters: 400, epoch: 27 | loss: 0.0273479
	speed: 0.0564s/iter; left time: 1935.8543s
Epoch: 27 cost time: 29.610264539718628
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000490
	speed: 0.2592s/iter; left time: 8848.3101s
	iters: 200, epoch: 28 | loss: 0.0009414
	speed: 0.0610s/iter; left time: 2077.2487s
	iters: 300, epoch: 28 | loss: 0.0053579
	speed: 0.0604s/iter; left time: 2049.0507s
	iters: 400, epoch: 28 | loss: 0.0066140
	speed: 0.0606s/iter; left time: 2051.4009s
Epoch: 28 cost time: 29.612905979156494
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.981131).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0010880
	speed: 0.3383s/iter; left time: 11389.0457s
	iters: 200, epoch: 29 | loss: 0.0032765
	speed: 0.0713s/iter; left time: 2391.8073s
	iters: 300, epoch: 29 | loss: 0.0007406
	speed: 0.0790s/iter; left time: 2643.4485s
	iters: 400, epoch: 29 | loss: 0.0033721
	speed: 0.0778s/iter; left time: 2596.9000s
Epoch: 29 cost time: 34.30331993103027
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0033746
	speed: 0.3499s/iter; left time: 11615.0548s
	iters: 200, epoch: 30 | loss: 0.0009385
	speed: 0.0612s/iter; left time: 2025.3221s
	iters: 300, epoch: 30 | loss: 0.0001354
	speed: 0.0448s/iter; left time: 1477.6565s
	iters: 400, epoch: 30 | loss: 0.0002500
	speed: 0.0475s/iter; left time: 1561.5199s
Epoch: 30 cost time: 28.0389883518219
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1015909
	speed: 0.3150s/iter; left time: 10310.6673s
	iters: 200, epoch: 31 | loss: 0.0106450
	speed: 0.0603s/iter; left time: 1967.2086s
	iters: 300, epoch: 31 | loss: 0.1769083
	speed: 0.0563s/iter; left time: 1830.8906s
	iters: 400, epoch: 31 | loss: 0.0017109
	speed: 0.0575s/iter; left time: 1864.2855s
Epoch: 31 cost time: 28.314623594284058
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0071738
	speed: 0.3111s/iter; left time: 10036.3556s
	iters: 200, epoch: 32 | loss: 0.0059224
	speed: 0.0648s/iter; left time: 2084.5323s
	iters: 300, epoch: 32 | loss: 0.0000781
	speed: 0.0634s/iter; left time: 2033.1036s
	iters: 400, epoch: 32 | loss: 0.0003428
	speed: 0.0686s/iter; left time: 2192.6001s
Epoch: 32 cost time: 31.014779090881348
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0003291
	speed: 0.2840s/iter; left time: 9028.9366s
	iters: 200, epoch: 33 | loss: 0.2441530
	speed: 0.0446s/iter; left time: 1414.9617s
	iters: 300, epoch: 33 | loss: 0.0701255
	speed: 0.0623s/iter; left time: 1966.9244s
	iters: 400, epoch: 33 | loss: 0.0223979
	speed: 0.0636s/iter; left time: 2002.9578s
Epoch: 33 cost time: 26.000823974609375
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.984276).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0002028
	speed: 0.2928s/iter; left time: 9171.2670s
	iters: 200, epoch: 34 | loss: 0.0005198
	speed: 0.0588s/iter; left time: 1836.3459s
	iters: 300, epoch: 34 | loss: 0.0003293
	speed: 0.0555s/iter; left time: 1726.6655s
	iters: 400, epoch: 34 | loss: 0.0006880
	speed: 0.0548s/iter; left time: 1701.6329s
Epoch: 34 cost time: 27.107178688049316
Epoch: 34, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0001503
	speed: 0.3083s/iter; left time: 9512.1608s
	iters: 200, epoch: 35 | loss: 0.0002754
	speed: 0.0605s/iter; left time: 1859.6658s
	iters: 300, epoch: 35 | loss: 0.0001281
	speed: 0.0584s/iter; left time: 1788.7489s
	iters: 400, epoch: 35 | loss: 0.0372761
	speed: 0.0679s/iter; left time: 2074.3300s
Epoch: 35 cost time: 30.218056201934814
Epoch: 35, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0005384
	speed: 0.3269s/iter; left time: 9933.0985s
	iters: 200, epoch: 36 | loss: 0.0298403
	speed: 0.0682s/iter; left time: 2064.3457s
	iters: 300, epoch: 36 | loss: 0.0000786
	speed: 0.0664s/iter; left time: 2003.5129s
	iters: 400, epoch: 36 | loss: 0.0005758
	speed: 0.0447s/iter; left time: 1345.9113s
Epoch: 36 cost time: 27.958705186843872
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0029002
	speed: 0.2940s/iter; left time: 8795.7205s
	iters: 200, epoch: 37 | loss: 0.0000984
	speed: 0.0664s/iter; left time: 1981.2811s
	iters: 300, epoch: 37 | loss: 0.0871740
	speed: 0.0631s/iter; left time: 1875.1701s
	iters: 400, epoch: 37 | loss: 0.0233233
	speed: 0.0611s/iter; left time: 1808.1561s
Epoch: 37 cost time: 31.2286376953125
Epoch: 37, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0004522
	speed: 0.3256s/iter; left time: 9588.2448s
	iters: 200, epoch: 38 | loss: 0.0369210
	speed: 0.0648s/iter; left time: 1900.5646s
	iters: 300, epoch: 38 | loss: 0.0000551
	speed: 0.0623s/iter; left time: 1822.4601s
	iters: 400, epoch: 38 | loss: 0.0217162
	speed: 0.0612s/iter; left time: 1784.8572s
Epoch: 38 cost time: 29.625168085098267
Epoch: 38, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0027643
	speed: 0.3345s/iter; left time: 9694.8594s
	iters: 200, epoch: 39 | loss: 0.4658074
	speed: 0.0621s/iter; left time: 1793.2105s
	iters: 300, epoch: 39 | loss: 0.0000441
	speed: 0.0475s/iter; left time: 1367.1058s
	iters: 400, epoch: 39 | loss: 0.0005438
	speed: 0.0461s/iter; left time: 1323.4250s
Epoch: 39 cost time: 25.56469202041626
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0003389
	speed: 0.3112s/iter; left time: 8873.1155s
	iters: 200, epoch: 40 | loss: 0.0001869
	speed: 0.0756s/iter; left time: 2146.6780s
	iters: 300, epoch: 40 | loss: 0.0064528
	speed: 0.0709s/iter; left time: 2005.9013s
	iters: 400, epoch: 40 | loss: 0.0000681
	speed: 0.0706s/iter; left time: 1992.3092s
Epoch: 40 cost time: 34.018747329711914
Epoch: 40, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0001605
	speed: 0.3253s/iter; left time: 9121.9016s
	iters: 200, epoch: 41 | loss: 0.0003225
	speed: 0.0699s/iter; left time: 1953.2229s
	iters: 300, epoch: 41 | loss: 0.0001722
	speed: 0.0639s/iter; left time: 1779.2138s
	iters: 400, epoch: 41 | loss: 0.1849530
	speed: 0.0620s/iter; left time: 1718.8903s
Epoch: 41 cost time: 30.984724044799805
Epoch: 41, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0002813
	speed: 0.3178s/iter; left time: 8761.3003s
	iters: 200, epoch: 42 | loss: 0.0004996
	speed: 0.0658s/iter; left time: 1808.4785s
	iters: 300, epoch: 42 | loss: 0.3273958
	speed: 0.0665s/iter; left time: 1819.4755s
	iters: 400, epoch: 42 | loss: 0.0004767
	speed: 0.0646s/iter; left time: 1762.5304s
Epoch: 42 cost time: 31.816678524017334
Epoch: 42, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0018464
	speed: 0.2987s/iter; left time: 8095.7739s
	iters: 200, epoch: 43 | loss: 0.0003356
	speed: 0.0439s/iter; left time: 1186.7459s
	iters: 300, epoch: 43 | loss: 0.0005567
	speed: 0.0596s/iter; left time: 1603.0647s
	iters: 400, epoch: 43 | loss: 0.0000553
	speed: 0.0690s/iter; left time: 1850.6344s
Epoch: 43 cost time: 26.39092445373535
Epoch: 43, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 1128762
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9912236
	speed: 0.0777s/iter; left time: 3638.7772s
	iters: 200, epoch: 1 | loss: 0.2538486
	speed: 0.0580s/iter; left time: 2707.8433s
	iters: 300, epoch: 1 | loss: 0.1968680
	speed: 0.0540s/iter; left time: 2515.5495s
	iters: 400, epoch: 1 | loss: 0.0552752
	speed: 0.0519s/iter; left time: 2411.3038s
Epoch: 1 cost time: 28.37921714782715
Epoch: 1, Steps: 469 | Train Loss: 0.558 Vali Loss: 0.239 Vali Acc: 0.927 Test Loss: 0.239 Test Acc: 0.927
Validation loss decreased (inf --> -0.926813).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0565157
	speed: 0.2573s/iter; left time: 11920.6269s
	iters: 200, epoch: 2 | loss: 0.0685522
	speed: 0.0585s/iter; left time: 2703.3971s
	iters: 300, epoch: 2 | loss: 0.1755008
	speed: 0.0608s/iter; left time: 2804.0383s
	iters: 400, epoch: 2 | loss: 0.0750965
	speed: 0.0671s/iter; left time: 3088.9718s
Epoch: 2 cost time: 29.917314767837524
Epoch: 2, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.926813 --> -0.955687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0225427
	speed: 0.3227s/iter; left time: 14799.0020s
	iters: 200, epoch: 3 | loss: 0.1564004
	speed: 0.0654s/iter; left time: 2992.3135s
	iters: 300, epoch: 3 | loss: 0.0486869
	speed: 0.0650s/iter; left time: 2968.2734s
	iters: 400, epoch: 3 | loss: 0.1117392
	speed: 0.0685s/iter; left time: 3122.1021s
Epoch: 3 cost time: 30.957948207855225
Epoch: 3, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.955687 --> -0.967980).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1325241
	speed: 0.2531s/iter; left time: 11488.5177s
	iters: 200, epoch: 4 | loss: 0.0159657
	speed: 0.0419s/iter; left time: 1899.5772s
	iters: 300, epoch: 4 | loss: 0.0543593
	speed: 0.0581s/iter; left time: 2625.4843s
	iters: 400, epoch: 4 | loss: 0.0313475
	speed: 0.0571s/iter; left time: 2576.9212s
Epoch: 4 cost time: 23.4692645072937
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.967980 --> -0.969982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0683790
	speed: 0.2934s/iter; left time: 13181.0390s
	iters: 200, epoch: 5 | loss: 0.0046125
	speed: 0.0676s/iter; left time: 3028.3310s
	iters: 300, epoch: 5 | loss: 0.0207526
	speed: 0.0535s/iter; left time: 2394.6672s
	iters: 400, epoch: 5 | loss: 0.0148145
	speed: 0.0641s/iter; left time: 2861.5503s
Epoch: 5 cost time: 29.843353748321533
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0194640
	speed: 0.3055s/iter; left time: 13579.5669s
	iters: 200, epoch: 6 | loss: 0.0439266
	speed: 0.0501s/iter; left time: 2222.7247s
	iters: 300, epoch: 6 | loss: 0.0023458
	speed: 0.0620s/iter; left time: 2743.8206s
	iters: 400, epoch: 6 | loss: 0.0208105
	speed: 0.0479s/iter; left time: 2114.8741s
Epoch: 6 cost time: 24.741672039031982
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0110048
	speed: 0.2775s/iter; left time: 12205.6778s
	iters: 200, epoch: 7 | loss: 0.0049015
	speed: 0.0708s/iter; left time: 3105.9777s
	iters: 300, epoch: 7 | loss: 0.2904803
	speed: 0.0701s/iter; left time: 3068.2802s
	iters: 400, epoch: 7 | loss: 0.1401917
	speed: 0.0780s/iter; left time: 3405.6474s
Epoch: 7 cost time: 34.073214054107666
Epoch: 7, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0485584
	speed: 0.3453s/iter; left time: 15027.2237s
	iters: 200, epoch: 8 | loss: 0.0436953
	speed: 0.0698s/iter; left time: 3031.2971s
	iters: 300, epoch: 8 | loss: 0.0194923
	speed: 0.0699s/iter; left time: 3029.8364s
	iters: 400, epoch: 8 | loss: 0.0201570
	speed: 0.0673s/iter; left time: 2906.8152s
Epoch: 8 cost time: 32.63473105430603
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.969982 --> -0.970839).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0034504
	speed: 0.2546s/iter; left time: 10961.0352s
	iters: 200, epoch: 9 | loss: 0.0595344
	speed: 0.0607s/iter; left time: 2606.0867s
	iters: 300, epoch: 9 | loss: 0.0088113
	speed: 0.0523s/iter; left time: 2239.1902s
	iters: 400, epoch: 9 | loss: 0.0006202
	speed: 0.0517s/iter; left time: 2211.3716s
Epoch: 9 cost time: 26.90660858154297
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.970839 --> -0.975128).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0479609
	speed: 0.3135s/iter; left time: 13348.9086s
	iters: 200, epoch: 10 | loss: 0.0049783
	speed: 0.0610s/iter; left time: 2591.7402s
	iters: 300, epoch: 10 | loss: 0.0022252
	speed: 0.0660s/iter; left time: 2798.1945s
	iters: 400, epoch: 10 | loss: 0.0033677
	speed: 0.0709s/iter; left time: 2998.0461s
Epoch: 10 cost time: 30.609352111816406
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0029909
	speed: 0.3134s/iter; left time: 13198.4105s
	iters: 200, epoch: 11 | loss: 0.0976154
	speed: 0.0667s/iter; left time: 2800.7401s
	iters: 300, epoch: 11 | loss: 0.0277605
	speed: 0.0644s/iter; left time: 2700.8029s
	iters: 400, epoch: 11 | loss: 0.0388240
	speed: 0.0626s/iter; left time: 2618.5378s
Epoch: 11 cost time: 30.642756462097168
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0003884
	speed: 0.2905s/iter; left time: 12096.8963s
	iters: 200, epoch: 12 | loss: 0.0059198
	speed: 0.0640s/iter; left time: 2659.5678s
	iters: 300, epoch: 12 | loss: 0.0181843
	speed: 0.0494s/iter; left time: 2045.5016s
	iters: 400, epoch: 12 | loss: 0.0002367
	speed: 0.0451s/iter; left time: 1862.4657s
Epoch: 12 cost time: 25.115071296691895
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.1351707
	speed: 0.2857s/iter; left time: 11764.4799s
	iters: 200, epoch: 13 | loss: 0.0013484
	speed: 0.0611s/iter; left time: 2510.7858s
	iters: 300, epoch: 13 | loss: 0.0080024
	speed: 0.0626s/iter; left time: 2566.1289s
	iters: 400, epoch: 13 | loss: 0.0023454
	speed: 0.0605s/iter; left time: 2474.2296s
Epoch: 13 cost time: 30.19408893585205
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0018146
	speed: 0.3107s/iter; left time: 12645.0878s
	iters: 200, epoch: 14 | loss: 0.0000546
	speed: 0.0624s/iter; left time: 2532.6245s
	iters: 300, epoch: 14 | loss: 0.0008767
	speed: 0.0679s/iter; left time: 2749.4850s
	iters: 400, epoch: 14 | loss: 0.0072742
	speed: 0.0636s/iter; left time: 2568.7950s
Epoch: 14 cost time: 30.253217935562134
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0021028
	speed: 0.2950s/iter; left time: 11867.5937s
	iters: 200, epoch: 15 | loss: 0.0030132
	speed: 0.0591s/iter; left time: 2370.6443s
	iters: 300, epoch: 15 | loss: 0.0049377
	speed: 0.0542s/iter; left time: 2169.9930s
	iters: 400, epoch: 15 | loss: 0.0137728
	speed: 0.0425s/iter; left time: 1697.1270s
Epoch: 15 cost time: 24.615174055099487
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0018414
	speed: 0.2632s/iter; left time: 10465.7820s
	iters: 200, epoch: 16 | loss: 0.0014056
	speed: 0.0658s/iter; left time: 2611.5056s
	iters: 300, epoch: 16 | loss: 0.0003685
	speed: 0.0600s/iter; left time: 2374.6043s
	iters: 400, epoch: 16 | loss: 0.0007900
	speed: 0.0581s/iter; left time: 2293.9603s
Epoch: 16 cost time: 29.23944664001465
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0048982
	speed: 0.3175s/iter; left time: 12475.3678s
	iters: 200, epoch: 17 | loss: 0.0248807
	speed: 0.0663s/iter; left time: 2600.1595s
	iters: 300, epoch: 17 | loss: 0.0101408
	speed: 0.0612s/iter; left time: 2391.5541s
	iters: 400, epoch: 17 | loss: 0.0585323
	speed: 0.0640s/iter; left time: 2495.6445s
Epoch: 17 cost time: 30.972143173217773
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0022968
	speed: 0.3425s/iter; left time: 13297.7991s
	iters: 200, epoch: 18 | loss: 0.0059840
	speed: 0.0721s/iter; left time: 2793.3271s
	iters: 300, epoch: 18 | loss: 0.1906851
	speed: 0.0708s/iter; left time: 2735.1506s
	iters: 400, epoch: 18 | loss: 0.0241610
	speed: 0.0714s/iter; left time: 2752.4043s
Epoch: 18 cost time: 33.11518931388855
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0224630
	speed: 0.3161s/iter; left time: 12123.6794s
	iters: 200, epoch: 19 | loss: 0.0004852
	speed: 0.0658s/iter; left time: 2515.6416s
	iters: 300, epoch: 19 | loss: 0.0027179
	speed: 0.0686s/iter; left time: 2618.7179s
	iters: 400, epoch: 19 | loss: 0.0008806
	speed: 0.0664s/iter; left time: 2528.2273s
Epoch: 19 cost time: 30.867115259170532
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0675022
	speed: 0.2404s/iter; left time: 9107.4254s
	iters: 200, epoch: 20 | loss: 0.0001407
	speed: 0.0675s/iter; left time: 2550.3223s
	iters: 300, epoch: 20 | loss: 0.0015475
	speed: 0.0660s/iter; left time: 2489.1299s
	iters: 400, epoch: 20 | loss: 0.0009731
	speed: 0.0635s/iter; left time: 2386.0109s
Epoch: 20 cost time: 30.84276270866394
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0012522
	speed: 0.3322s/iter; left time: 12431.6748s
	iters: 200, epoch: 21 | loss: 0.0004851
	speed: 0.0628s/iter; left time: 2344.8523s
	iters: 300, epoch: 21 | loss: 0.0019820
	speed: 0.0565s/iter; left time: 2103.3741s
	iters: 400, epoch: 21 | loss: 0.0080598
	speed: 0.0436s/iter; left time: 1619.8846s
Epoch: 21 cost time: 26.44166922569275
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0065883
	speed: 0.2792s/iter; left time: 10318.7896s
	iters: 200, epoch: 22 | loss: 0.0061325
	speed: 0.0573s/iter; left time: 2111.2848s
	iters: 300, epoch: 22 | loss: 0.0748581
	speed: 0.0561s/iter; left time: 2060.0311s
	iters: 400, epoch: 22 | loss: 0.0129792
	speed: 0.0594s/iter; left time: 2176.4676s
Epoch: 22 cost time: 27.959937810897827
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0002477
	speed: 0.2916s/iter; left time: 10637.8233s
	iters: 200, epoch: 23 | loss: 0.0017068
	speed: 0.0477s/iter; left time: 1736.1127s
	iters: 300, epoch: 23 | loss: 0.0003194
	speed: 0.0447s/iter; left time: 1622.2268s
	iters: 400, epoch: 23 | loss: 0.0005511
	speed: 0.0484s/iter; left time: 1749.4836s
Epoch: 23 cost time: 24.718833923339844
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.1292455
	speed: 0.3186s/iter; left time: 11474.6293s
	iters: 200, epoch: 24 | loss: 0.0005506
	speed: 0.0699s/iter; left time: 2511.9997s
	iters: 300, epoch: 24 | loss: 0.0015024
	speed: 0.0687s/iter; left time: 2458.6471s
	iters: 400, epoch: 24 | loss: 0.0011446
	speed: 0.0618s/iter; left time: 2205.5575s
Epoch: 24 cost time: 31.578256368637085
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0364794
	speed: 0.2594s/iter; left time: 9222.0142s
	iters: 200, epoch: 25 | loss: 0.0014396
	speed: 0.0502s/iter; left time: 1779.5675s
	iters: 300, epoch: 25 | loss: 0.0365873
	speed: 0.0583s/iter; left time: 2059.3306s
	iters: 400, epoch: 25 | loss: 0.1753547
	speed: 0.0635s/iter; left time: 2238.6116s
Epoch: 25 cost time: 25.65813398361206
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0551972
	speed: 0.2836s/iter; left time: 9948.1783s
	iters: 200, epoch: 26 | loss: 0.0002789
	speed: 0.0535s/iter; left time: 1872.8520s
	iters: 300, epoch: 26 | loss: 0.0048548
	speed: 0.0569s/iter; left time: 1982.8403s
	iters: 400, epoch: 26 | loss: 0.0779223
	speed: 0.0613s/iter; left time: 2130.1782s
Epoch: 26 cost time: 27.339970350265503
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000227
	speed: 0.2808s/iter; left time: 9718.0649s
	iters: 200, epoch: 27 | loss: 0.0086317
	speed: 0.0652s/iter; left time: 2248.3383s
	iters: 300, epoch: 27 | loss: 0.0026753
	speed: 0.0521s/iter; left time: 1793.7811s
	iters: 400, epoch: 27 | loss: 0.0414393
	speed: 0.0420s/iter; left time: 1439.8952s
Epoch: 27 cost time: 24.957702159881592
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.2121774
	speed: 0.2857s/iter; left time: 9753.9141s
	iters: 200, epoch: 28 | loss: 0.0003106
	speed: 0.0576s/iter; left time: 1960.7899s
	iters: 300, epoch: 28 | loss: 0.0003478
	speed: 0.0594s/iter; left time: 2016.7747s
	iters: 400, epoch: 28 | loss: 0.0008426
	speed: 0.0580s/iter; left time: 1960.9772s
Epoch: 28 cost time: 29.022473096847534
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 1128762
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8952347
	speed: 0.0755s/iter; left time: 3531.2351s
	iters: 200, epoch: 1 | loss: 0.2112322
	speed: 0.0550s/iter; left time: 2569.7653s
	iters: 300, epoch: 1 | loss: 0.1610997
	speed: 0.0538s/iter; left time: 2507.0629s
	iters: 400, epoch: 1 | loss: 0.0298789
	speed: 0.0522s/iter; left time: 2428.8552s
Epoch: 1 cost time: 27.641809225082397
Epoch: 1, Steps: 469 | Train Loss: 0.522 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (inf --> -0.954258).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0179851
	speed: 0.2849s/iter; left time: 13198.8928s
	iters: 200, epoch: 2 | loss: 0.0446281
	speed: 0.0579s/iter; left time: 2676.3653s
	iters: 300, epoch: 2 | loss: 0.0726839
	speed: 0.0563s/iter; left time: 2598.3160s
	iters: 400, epoch: 2 | loss: 0.0304598
	speed: 0.0525s/iter; left time: 2418.4786s
Epoch: 2 cost time: 26.585216283798218
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
Validation loss decreased (-0.954258 --> -0.959976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0251662
	speed: 0.2580s/iter; left time: 11834.5415s
	iters: 200, epoch: 3 | loss: 0.2226425
	speed: 0.0378s/iter; left time: 1731.4660s
	iters: 300, epoch: 3 | loss: 0.0281546
	speed: 0.0410s/iter; left time: 1869.9980s
	iters: 400, epoch: 3 | loss: 0.1307370
	speed: 0.0518s/iter; left time: 2360.6985s
Epoch: 3 cost time: 21.68231225013733
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.959976 --> -0.972554).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0607470
	speed: 0.2786s/iter; left time: 12647.9765s
	iters: 200, epoch: 4 | loss: 0.0054556
	speed: 0.0503s/iter; left time: 2276.5050s
	iters: 300, epoch: 4 | loss: 0.1991750
	speed: 0.0511s/iter; left time: 2309.5201s
	iters: 400, epoch: 4 | loss: 0.0161752
	speed: 0.0536s/iter; left time: 2417.7617s
Epoch: 4 cost time: 25.02557349205017
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0039932
	speed: 0.2643s/iter; left time: 11875.9152s
	iters: 200, epoch: 5 | loss: 0.0006586
	speed: 0.0526s/iter; left time: 2358.6681s
	iters: 300, epoch: 5 | loss: 0.0151560
	speed: 0.0450s/iter; left time: 2014.2430s
	iters: 400, epoch: 5 | loss: 0.0146500
	speed: 0.0413s/iter; left time: 1843.3000s
Epoch: 5 cost time: 22.54995822906494
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.972554 --> -0.973984).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1719886
	speed: 0.2584s/iter; left time: 11487.2870s
	iters: 200, epoch: 6 | loss: 0.1904639
	speed: 0.0630s/iter; left time: 2795.4811s
	iters: 300, epoch: 6 | loss: 0.0003734
	speed: 0.0638s/iter; left time: 2822.2782s
	iters: 400, epoch: 6 | loss: 0.0402104
	speed: 0.0575s/iter; left time: 2541.1591s
Epoch: 6 cost time: 28.66233539581299
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.976843).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0221518
	speed: 0.3091s/iter; left time: 13595.3116s
	iters: 200, epoch: 7 | loss: 0.0022295
	speed: 0.0604s/iter; left time: 2651.1751s
	iters: 300, epoch: 7 | loss: 0.0409391
	speed: 0.0581s/iter; left time: 2543.2862s
	iters: 400, epoch: 7 | loss: 0.0026465
	speed: 0.0516s/iter; left time: 2255.9442s
Epoch: 7 cost time: 27.015270233154297
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0055864
	speed: 0.2575s/iter; left time: 11206.7564s
	iters: 200, epoch: 8 | loss: 0.0006353
	speed: 0.0530s/iter; left time: 2299.5148s
	iters: 300, epoch: 8 | loss: 0.0004996
	speed: 0.0531s/iter; left time: 2298.8029s
	iters: 400, epoch: 8 | loss: 0.0673613
	speed: 0.0517s/iter; left time: 2235.1064s
Epoch: 8 cost time: 25.06705403327942
Epoch: 8, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0051330
	speed: 0.2674s/iter; left time: 11509.6312s
	iters: 200, epoch: 9 | loss: 0.0048092
	speed: 0.0507s/iter; left time: 2176.1034s
	iters: 300, epoch: 9 | loss: 0.0019444
	speed: 0.0526s/iter; left time: 2254.0187s
	iters: 400, epoch: 9 | loss: 0.0010905
	speed: 0.0527s/iter; left time: 2253.7812s
Epoch: 9 cost time: 24.98846459388733
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978558).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0089169
	speed: 0.2785s/iter; left time: 11856.6599s
	iters: 200, epoch: 10 | loss: 0.0652589
	speed: 0.0547s/iter; left time: 2323.9643s
	iters: 300, epoch: 10 | loss: 0.1638079
	speed: 0.0606s/iter; left time: 2567.7865s
	iters: 400, epoch: 10 | loss: 0.0072882
	speed: 0.0616s/iter; left time: 2603.5319s
Epoch: 10 cost time: 26.8545663356781
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1852961
	speed: 0.2258s/iter; left time: 9510.5052s
	iters: 200, epoch: 11 | loss: 0.2018044
	speed: 0.0594s/iter; left time: 2495.1116s
	iters: 300, epoch: 11 | loss: 0.0081311
	speed: 0.0565s/iter; left time: 2366.6731s
	iters: 400, epoch: 11 | loss: 0.0207088
	speed: 0.0516s/iter; left time: 2156.4139s
Epoch: 11 cost time: 26.083585500717163
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0003223
	speed: 0.2773s/iter; left time: 11546.7160s
	iters: 200, epoch: 12 | loss: 0.0012530
	speed: 0.0539s/iter; left time: 2238.4394s
	iters: 300, epoch: 12 | loss: 0.0110513
	speed: 0.0444s/iter; left time: 1839.7180s
	iters: 400, epoch: 12 | loss: 0.1307359
	speed: 0.0419s/iter; left time: 1730.3614s
Epoch: 12 cost time: 22.371578454971313
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0001902
	speed: 0.2566s/iter; left time: 10564.4301s
	iters: 200, epoch: 13 | loss: 0.0043043
	speed: 0.0527s/iter; left time: 2164.8292s
	iters: 300, epoch: 13 | loss: 0.0064006
	speed: 0.0488s/iter; left time: 1997.9248s
	iters: 400, epoch: 13 | loss: 0.0424255
	speed: 0.0509s/iter; left time: 2078.4899s
Epoch: 13 cost time: 24.985029935836792
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979988).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0005696
	speed: 0.2787s/iter; left time: 11344.8071s
	iters: 200, epoch: 14 | loss: 0.0105633
	speed: 0.0407s/iter; left time: 1653.4424s
	iters: 300, epoch: 14 | loss: 0.0007528
	speed: 0.0411s/iter; left time: 1664.6760s
	iters: 400, epoch: 14 | loss: 0.0011462
	speed: 0.0478s/iter; left time: 1931.6372s
Epoch: 14 cost time: 21.499444484710693
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0027001
	speed: 0.2840s/iter; left time: 11427.2343s
	iters: 200, epoch: 15 | loss: 0.0004136
	speed: 0.0556s/iter; left time: 2229.5253s
	iters: 300, epoch: 15 | loss: 0.0001676
	speed: 0.0584s/iter; left time: 2338.9927s
	iters: 400, epoch: 15 | loss: 0.0052365
	speed: 0.0570s/iter; left time: 2274.7629s
Epoch: 15 cost time: 26.66447162628174
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0031497
	speed: 0.2617s/iter; left time: 10406.8228s
	iters: 200, epoch: 16 | loss: 0.0015481
	speed: 0.0498s/iter; left time: 1974.2535s
	iters: 300, epoch: 16 | loss: 0.0004643
	speed: 0.0499s/iter; left time: 1973.0941s
	iters: 400, epoch: 16 | loss: 0.0305437
	speed: 0.0528s/iter; left time: 2082.8339s
Epoch: 16 cost time: 24.488020181655884
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0040125
	speed: 0.2602s/iter; left time: 10226.9587s
	iters: 200, epoch: 17 | loss: 0.0194156
	speed: 0.0550s/iter; left time: 2154.0497s
	iters: 300, epoch: 17 | loss: 0.0284863
	speed: 0.0515s/iter; left time: 2014.4505s
	iters: 400, epoch: 17 | loss: 0.0009614
	speed: 0.0510s/iter; left time: 1987.1063s
Epoch: 17 cost time: 24.64125680923462
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0333646
	speed: 0.2731s/iter; left time: 10602.1874s
	iters: 200, epoch: 18 | loss: 0.1478471
	speed: 0.0433s/iter; left time: 1675.4662s
	iters: 300, epoch: 18 | loss: 0.0243044
	speed: 0.0506s/iter; left time: 1954.8606s
	iters: 400, epoch: 18 | loss: 0.0383084
	speed: 0.0609s/iter; left time: 2347.3947s
Epoch: 18 cost time: 24.560094594955444
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0006456
	speed: 0.2922s/iter; left time: 11207.5748s
	iters: 200, epoch: 19 | loss: 0.0027942
	speed: 0.0564s/iter; left time: 2158.6170s
	iters: 300, epoch: 19 | loss: 0.1036331
	speed: 0.0574s/iter; left time: 2189.4254s
	iters: 400, epoch: 19 | loss: 0.0007236
	speed: 0.0500s/iter; left time: 1904.1053s
Epoch: 19 cost time: 25.7752845287323
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0765698
	speed: 0.2545s/iter; left time: 9641.8502s
	iters: 200, epoch: 20 | loss: 0.0002625
	speed: 0.0537s/iter; left time: 2027.8244s
	iters: 300, epoch: 20 | loss: 0.0008783
	speed: 0.0489s/iter; left time: 1843.5825s
	iters: 400, epoch: 20 | loss: 0.0002083
	speed: 0.0417s/iter; left time: 1567.6153s
Epoch: 20 cost time: 22.92084050178528
Epoch: 20, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0001760
	speed: 0.2278s/iter; left time: 8523.0490s
	iters: 200, epoch: 21 | loss: 0.0044310
	speed: 0.0521s/iter; left time: 1945.2036s
	iters: 300, epoch: 21 | loss: 0.0224888
	speed: 0.0503s/iter; left time: 1872.1887s
	iters: 400, epoch: 21 | loss: 0.0003756
	speed: 0.0485s/iter; left time: 1800.1111s
Epoch: 21 cost time: 24.36431884765625
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0007031
	speed: 0.2749s/iter; left time: 10157.9344s
	iters: 200, epoch: 22 | loss: 0.0001107
	speed: 0.0512s/iter; left time: 1887.6704s
	iters: 300, epoch: 22 | loss: 0.0148836
	speed: 0.0483s/iter; left time: 1775.3508s
	iters: 400, epoch: 22 | loss: 0.0342655
	speed: 0.0558s/iter; left time: 2046.9551s
Epoch: 22 cost time: 25.074086904525757
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0001467
	speed: 0.2702s/iter; left time: 9856.0775s
	iters: 200, epoch: 23 | loss: 0.0004757
	speed: 0.0515s/iter; left time: 1875.1196s
	iters: 300, epoch: 23 | loss: 0.0571045
	speed: 0.0518s/iter; left time: 1879.1772s
	iters: 400, epoch: 23 | loss: 0.0000594
	speed: 0.0526s/iter; left time: 1902.1073s
Epoch: 23 cost time: 24.7119882106781
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 1128762
model size : 6.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7774869
	speed: 0.0727s/iter; left time: 3401.6704s
	iters: 200, epoch: 1 | loss: 0.2850716
	speed: 0.0631s/iter; left time: 2945.3214s
	iters: 300, epoch: 1 | loss: 0.2291681
	speed: 0.0546s/iter; left time: 2543.9915s
	iters: 400, epoch: 1 | loss: 0.0692611
	speed: 0.0508s/iter; left time: 2360.0405s
Epoch: 1 cost time: 27.7373309135437
Epoch: 1, Steps: 469 | Train Loss: 0.602 Vali Loss: 0.278 Vali Acc: 0.918 Test Loss: 0.278 Test Acc: 0.918
Validation loss decreased (inf --> -0.917664).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1124379
	speed: 0.2459s/iter; left time: 11392.8194s
	iters: 200, epoch: 2 | loss: 0.1108984
	speed: 0.0381s/iter; left time: 1759.5102s
	iters: 300, epoch: 2 | loss: 0.0860124
	speed: 0.0498s/iter; left time: 2299.3528s
	iters: 400, epoch: 2 | loss: 0.0288223
	speed: 0.0540s/iter; left time: 2486.2904s
Epoch: 2 cost time: 22.731507539749146
Epoch: 2, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.917664 --> -0.947111).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0716580
	speed: 0.2817s/iter; left time: 12917.8759s
	iters: 200, epoch: 3 | loss: 0.0104273
	speed: 0.0533s/iter; left time: 2437.6339s
	iters: 300, epoch: 3 | loss: 0.1539547
	speed: 0.0499s/iter; left time: 2276.6427s
	iters: 400, epoch: 3 | loss: 0.0061006
	speed: 0.0534s/iter; left time: 2431.5730s
Epoch: 3 cost time: 25.469979286193848
Epoch: 3, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.947111 --> -0.957403).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0966172
	speed: 0.2676s/iter; left time: 12149.6449s
	iters: 200, epoch: 4 | loss: 0.0843599
	speed: 0.0547s/iter; left time: 2477.9092s
	iters: 300, epoch: 4 | loss: 0.0170445
	speed: 0.0563s/iter; left time: 2544.0414s
	iters: 400, epoch: 4 | loss: 0.0138508
	speed: 0.0589s/iter; left time: 2657.5949s
Epoch: 4 cost time: 26.627140045166016
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.957403 --> -0.962263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0319002
	speed: 0.2590s/iter; left time: 11634.3705s
	iters: 200, epoch: 5 | loss: 0.0043711
	speed: 0.0491s/iter; left time: 2200.7996s
	iters: 300, epoch: 5 | loss: 0.0681899
	speed: 0.0512s/iter; left time: 2291.8937s
	iters: 400, epoch: 5 | loss: 0.0141949
	speed: 0.0576s/iter; left time: 2569.6776s
Epoch: 5 cost time: 24.74409532546997
Epoch: 5, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
Validation loss decreased (-0.962263 --> -0.965693).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0114713
	speed: 0.2957s/iter; left time: 13143.5421s
	iters: 200, epoch: 6 | loss: 0.0681884
	speed: 0.0561s/iter; left time: 2486.7686s
	iters: 300, epoch: 6 | loss: 0.0039667
	speed: 0.0561s/iter; left time: 2480.7975s
	iters: 400, epoch: 6 | loss: 0.0031420
	speed: 0.0562s/iter; left time: 2481.6497s
Epoch: 6 cost time: 27.646383047103882
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.965693 --> -0.971697).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0245846
	speed: 0.2808s/iter; left time: 12352.0792s
	iters: 200, epoch: 7 | loss: 0.0472702
	speed: 0.0563s/iter; left time: 2468.8411s
	iters: 300, epoch: 7 | loss: 0.0212484
	speed: 0.0590s/iter; left time: 2584.4404s
	iters: 400, epoch: 7 | loss: 0.0010224
	speed: 0.0543s/iter; left time: 2373.2847s
Epoch: 7 cost time: 26.661704540252686
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0548560
	speed: 0.2648s/iter; left time: 11523.3921s
	iters: 200, epoch: 8 | loss: 0.0007746
	speed: 0.0546s/iter; left time: 2369.2924s
	iters: 300, epoch: 8 | loss: 0.0164331
	speed: 0.0538s/iter; left time: 2330.1872s
	iters: 400, epoch: 8 | loss: 0.0076058
	speed: 0.0522s/iter; left time: 2254.5803s
Epoch: 8 cost time: 24.92854142189026
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972840).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0219884
	speed: 0.2372s/iter; left time: 10211.2654s
	iters: 200, epoch: 9 | loss: 0.0103901
	speed: 0.0546s/iter; left time: 2344.8062s
	iters: 300, epoch: 9 | loss: 0.0288709
	speed: 0.0537s/iter; left time: 2301.7584s
	iters: 400, epoch: 9 | loss: 0.0196591
	speed: 0.0549s/iter; left time: 2348.7886s
Epoch: 9 cost time: 26.05345058441162
Epoch: 9, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1323734
	speed: 0.2788s/iter; left time: 11873.0859s
	iters: 200, epoch: 10 | loss: 0.2549847
	speed: 0.0440s/iter; left time: 1869.4683s
	iters: 300, epoch: 10 | loss: 0.0037661
	speed: 0.0432s/iter; left time: 1828.9561s
	iters: 400, epoch: 10 | loss: 0.0412696
	speed: 0.0482s/iter; left time: 2036.3636s
Epoch: 10 cost time: 23.36902403831482
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973698).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0143547
	speed: 0.2701s/iter; left time: 11375.6851s
	iters: 200, epoch: 11 | loss: 0.0045787
	speed: 0.0570s/iter; left time: 2396.2188s
	iters: 300, epoch: 11 | loss: 0.0015272
	speed: 0.0589s/iter; left time: 2470.4466s
	iters: 400, epoch: 11 | loss: 0.0149027
	speed: 0.0568s/iter; left time: 2373.9546s
Epoch: 11 cost time: 26.617545127868652
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0430991
	speed: 0.2619s/iter; left time: 10904.5435s
	iters: 200, epoch: 12 | loss: 0.0011891
	speed: 0.0582s/iter; left time: 2415.9789s
	iters: 300, epoch: 12 | loss: 0.0041755
	speed: 0.0526s/iter; left time: 2180.2623s
	iters: 400, epoch: 12 | loss: 0.0010630
	speed: 0.0594s/iter; left time: 2455.6495s
Epoch: 12 cost time: 26.5597403049469
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.973698 --> -0.980559).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0631112
	speed: 0.2449s/iter; left time: 10081.5445s
	iters: 200, epoch: 13 | loss: 0.0099251
	speed: 0.0601s/iter; left time: 2469.8361s
	iters: 300, epoch: 13 | loss: 0.0008662
	speed: 0.0579s/iter; left time: 2373.5369s
	iters: 400, epoch: 13 | loss: 0.0004062
	speed: 0.0548s/iter; left time: 2241.3151s
Epoch: 13 cost time: 27.524726390838623
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0007625
	speed: 0.2974s/iter; left time: 12104.3421s
	iters: 200, epoch: 14 | loss: 0.0038738
	speed: 0.0528s/iter; left time: 2144.5775s
	iters: 300, epoch: 14 | loss: 0.0796311
	speed: 0.0540s/iter; left time: 2185.9209s
	iters: 400, epoch: 14 | loss: 0.0276287
	speed: 0.0502s/iter; left time: 2029.3122s
Epoch: 14 cost time: 25.20223617553711
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0299877
	speed: 0.2528s/iter; left time: 10172.9118s
	iters: 200, epoch: 15 | loss: 0.1067866
	speed: 0.0577s/iter; left time: 2314.0590s
	iters: 300, epoch: 15 | loss: 0.0438155
	speed: 0.0517s/iter; left time: 2069.1910s
	iters: 400, epoch: 15 | loss: 0.1264508
	speed: 0.0513s/iter; left time: 2048.1726s
Epoch: 15 cost time: 26.299909591674805
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0029362
	speed: 0.2797s/iter; left time: 11124.4783s
	iters: 200, epoch: 16 | loss: 0.0024000
	speed: 0.0552s/iter; left time: 2190.4176s
	iters: 300, epoch: 16 | loss: 0.0876890
	speed: 0.0648s/iter; left time: 2563.3437s
	iters: 400, epoch: 16 | loss: 0.0022803
	speed: 0.0538s/iter; left time: 2121.3699s
Epoch: 16 cost time: 26.36304211616516
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0029434
	speed: 0.2725s/iter; left time: 10709.4310s
	iters: 200, epoch: 17 | loss: 0.0924265
	speed: 0.0583s/iter; left time: 2287.0844s
	iters: 300, epoch: 17 | loss: 0.0410242
	speed: 0.0638s/iter; left time: 2494.5781s
	iters: 400, epoch: 17 | loss: 0.0052276
	speed: 0.0616s/iter; left time: 2403.4165s
Epoch: 17 cost time: 29.118735313415527
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1598185
	speed: 0.2988s/iter; left time: 11601.9376s
	iters: 200, epoch: 18 | loss: 0.0004731
	speed: 0.0605s/iter; left time: 2343.7205s
	iters: 300, epoch: 18 | loss: 0.0003886
	speed: 0.0606s/iter; left time: 2342.6026s
	iters: 400, epoch: 18 | loss: 0.2181869
	speed: 0.0532s/iter; left time: 2050.1937s
Epoch: 18 cost time: 27.158790588378906
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0016205
	speed: 0.2769s/iter; left time: 10619.7505s
	iters: 200, epoch: 19 | loss: 0.0004078
	speed: 0.0543s/iter; left time: 2078.3050s
	iters: 300, epoch: 19 | loss: 0.0720697
	speed: 0.0510s/iter; left time: 1944.8089s
	iters: 400, epoch: 19 | loss: 0.0003524
	speed: 0.0515s/iter; left time: 1960.6649s
Epoch: 19 cost time: 25.387277603149414
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.1367572
	speed: 0.2390s/iter; left time: 9057.5503s
	iters: 200, epoch: 20 | loss: 0.0109798
	speed: 0.0543s/iter; left time: 2050.8122s
	iters: 300, epoch: 20 | loss: 0.0042108
	speed: 0.0566s/iter; left time: 2132.9207s
	iters: 400, epoch: 20 | loss: 0.0370536
	speed: 0.0554s/iter; left time: 2081.0210s
Epoch: 20 cost time: 26.091796875
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0010965
	speed: 0.2713s/iter; left time: 10151.8087s
	iters: 200, epoch: 21 | loss: 0.0003528
	speed: 0.0517s/iter; left time: 1929.0427s
	iters: 300, epoch: 21 | loss: 0.0000742
	speed: 0.0582s/iter; left time: 2164.9214s
	iters: 400, epoch: 21 | loss: 0.0006820
	speed: 0.0585s/iter; left time: 2171.4947s
Epoch: 21 cost time: 26.622260570526123
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.980559 --> -0.982846).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0002766
	speed: 0.2285s/iter; left time: 8442.3590s
	iters: 200, epoch: 22 | loss: 0.0002074
	speed: 0.0571s/iter; left time: 2105.0401s
	iters: 300, epoch: 22 | loss: 0.0020327
	speed: 0.0596s/iter; left time: 2191.0437s
	iters: 400, epoch: 22 | loss: 0.2682790
	speed: 0.0511s/iter; left time: 1871.2589s
Epoch: 22 cost time: 26.291091680526733
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0283198
	speed: 0.2646s/iter; left time: 9652.8208s
	iters: 200, epoch: 23 | loss: 0.0004799
	speed: 0.0553s/iter; left time: 2010.5431s
	iters: 300, epoch: 23 | loss: 0.0135983
	speed: 0.0416s/iter; left time: 1508.6573s
	iters: 400, epoch: 23 | loss: 0.0021530
	speed: 0.0405s/iter; left time: 1464.8856s
Epoch: 23 cost time: 22.757296085357666
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0047690
	speed: 0.2822s/iter; left time: 10162.9173s
	iters: 200, epoch: 24 | loss: 0.0056903
	speed: 0.0530s/iter; left time: 1903.5178s
	iters: 300, epoch: 24 | loss: 0.0001332
	speed: 0.0593s/iter; left time: 2122.1282s
	iters: 400, epoch: 24 | loss: 0.0000320
	speed: 0.0584s/iter; left time: 2084.7933s
Epoch: 24 cost time: 27.110576629638672
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0011903
	speed: 0.2984s/iter; left time: 10607.2678s
	iters: 200, epoch: 25 | loss: 0.0007588
	speed: 0.0574s/iter; left time: 2036.0634s
	iters: 300, epoch: 25 | loss: 0.0024975
	speed: 0.0558s/iter; left time: 1973.9337s
	iters: 400, epoch: 25 | loss: 0.0020510
	speed: 0.0587s/iter; left time: 2069.2280s
Epoch: 25 cost time: 27.865972757339478
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0232309
	speed: 0.2773s/iter; left time: 9726.9714s
	iters: 200, epoch: 26 | loss: 0.0002630
	speed: 0.0538s/iter; left time: 1880.5459s
	iters: 300, epoch: 26 | loss: 0.0003404
	speed: 0.0601s/iter; left time: 2096.6636s
	iters: 400, epoch: 26 | loss: 0.0007711
	speed: 0.0593s/iter; left time: 2062.9695s
Epoch: 26 cost time: 27.467053651809692
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.982846 --> -0.982846).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000610
	speed: 0.2599s/iter; left time: 8996.0278s
	iters: 200, epoch: 27 | loss: 0.0000476
	speed: 0.0462s/iter; left time: 1593.0391s
	iters: 300, epoch: 27 | loss: 0.0012526
	speed: 0.0521s/iter; left time: 1792.4191s
	iters: 400, epoch: 27 | loss: 0.0007920
	speed: 0.0562s/iter; left time: 1929.1091s
Epoch: 27 cost time: 24.206996202468872
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0144585
	speed: 0.2582s/iter; left time: 8815.8043s
	iters: 200, epoch: 28 | loss: 0.0011214
	speed: 0.0573s/iter; left time: 1949.8747s
	iters: 300, epoch: 28 | loss: 0.0008988
	speed: 0.0612s/iter; left time: 2076.5134s
	iters: 400, epoch: 28 | loss: 0.0001366
	speed: 0.0545s/iter; left time: 1844.3308s
Epoch: 28 cost time: 27.54366946220398
Epoch: 28, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
Validation loss decreased (-0.982846 --> -0.984847).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0098064
	speed: 0.2534s/iter; left time: 8531.8480s
	iters: 200, epoch: 29 | loss: 0.0000593
	speed: 0.0535s/iter; left time: 1795.8337s
	iters: 300, epoch: 29 | loss: 0.0051410
	speed: 0.0587s/iter; left time: 1966.2166s
	iters: 400, epoch: 29 | loss: 0.0083372
	speed: 0.0556s/iter; left time: 1854.9180s
Epoch: 29 cost time: 26.072445392608643
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0183147
	speed: 0.2782s/iter; left time: 9237.1719s
	iters: 200, epoch: 30 | loss: 0.0408224
	speed: 0.0514s/iter; left time: 1701.5870s
	iters: 300, epoch: 30 | loss: 0.0467657
	speed: 0.0556s/iter; left time: 1835.2985s
	iters: 400, epoch: 30 | loss: 0.0018074
	speed: 0.0561s/iter; left time: 1844.2198s
Epoch: 30 cost time: 25.60566020011902
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0279450
	speed: 0.2316s/iter; left time: 7581.3387s
	iters: 200, epoch: 31 | loss: 0.0000899
	speed: 0.0469s/iter; left time: 1529.2452s
	iters: 300, epoch: 31 | loss: 0.2440739
	speed: 0.0550s/iter; left time: 1789.8083s
	iters: 400, epoch: 31 | loss: 0.0004608
	speed: 0.0518s/iter; left time: 1678.9029s
Epoch: 31 cost time: 23.428181886672974
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0003353
	speed: 0.2631s/iter; left time: 8489.1504s
	iters: 200, epoch: 32 | loss: 0.0002033
	speed: 0.0553s/iter; left time: 1779.3677s
	iters: 300, epoch: 32 | loss: 0.0319861
	speed: 0.0551s/iter; left time: 1765.5190s
	iters: 400, epoch: 32 | loss: 0.0329706
	speed: 0.0518s/iter; left time: 1655.7243s
Epoch: 32 cost time: 25.177845001220703
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0001971
	speed: 0.2548s/iter; left time: 8099.5288s
	iters: 200, epoch: 33 | loss: 0.0009202
	speed: 0.0559s/iter; left time: 1772.0241s
	iters: 300, epoch: 33 | loss: 0.0169072
	speed: 0.0534s/iter; left time: 1685.5898s
	iters: 400, epoch: 33 | loss: 0.0004821
	speed: 0.0591s/iter; left time: 1860.6872s
Epoch: 33 cost time: 27.34771990776062
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0005254
	speed: 0.2830s/iter; left time: 8864.3559s
	iters: 200, epoch: 34 | loss: 0.0004706
	speed: 0.0545s/iter; left time: 1703.0651s
	iters: 300, epoch: 34 | loss: 0.0312374
	speed: 0.0537s/iter; left time: 1671.1717s
	iters: 400, epoch: 34 | loss: 0.0057699
	speed: 0.0583s/iter; left time: 1809.6045s
Epoch: 34 cost time: 26.702472448349
Epoch: 34, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0012153
	speed: 0.2685s/iter; left time: 8284.7612s
	iters: 200, epoch: 35 | loss: 0.0020330
	speed: 0.0581s/iter; left time: 1787.8574s
	iters: 300, epoch: 35 | loss: 0.0664562
	speed: 0.0480s/iter; left time: 1472.2061s
	iters: 400, epoch: 35 | loss: 0.0002161
	speed: 0.0446s/iter; left time: 1364.0268s
Epoch: 35 cost time: 23.88732624053955
Epoch: 35, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0049103
	speed: 0.2622s/iter; left time: 7967.2654s
	iters: 200, epoch: 36 | loss: 0.0612605
	speed: 0.0579s/iter; left time: 1753.8252s
	iters: 300, epoch: 36 | loss: 0.0007516
	speed: 0.0562s/iter; left time: 1697.2874s
	iters: 400, epoch: 36 | loss: 0.0013806
	speed: 0.0564s/iter; left time: 1696.7793s
Epoch: 36 cost time: 26.63849902153015
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0085681
	speed: 0.2544s/iter; left time: 7609.4374s
	iters: 200, epoch: 37 | loss: 0.0010885
	speed: 0.0377s/iter; left time: 1122.6415s
	iters: 300, epoch: 37 | loss: 0.0011833
	speed: 0.0357s/iter; left time: 1060.0500s
	iters: 400, epoch: 37 | loss: 0.0012906
	speed: 0.0386s/iter; left time: 1141.8151s
Epoch: 37 cost time: 19.415672302246094
Epoch: 37, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000461
	speed: 0.2385s/iter; left time: 7021.9854s
	iters: 200, epoch: 38 | loss: 0.0000082
	speed: 0.0469s/iter; left time: 1375.4752s
	iters: 300, epoch: 38 | loss: 0.0020207
	speed: 0.0522s/iter; left time: 1525.9548s
	iters: 400, epoch: 38 | loss: 0.0014711
	speed: 0.0543s/iter; left time: 1583.8308s
Epoch: 38 cost time: 24.420801162719727
Epoch: 38, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 604474
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7635863
	speed: 0.0605s/iter; left time: 2830.8178s
	iters: 200, epoch: 1 | loss: 0.3455070
	speed: 0.0421s/iter; left time: 1964.0229s
	iters: 300, epoch: 1 | loss: 0.2280292
	speed: 0.0547s/iter; left time: 2550.5130s
	iters: 400, epoch: 1 | loss: 0.0706136
	speed: 0.0569s/iter; left time: 2647.6503s
Epoch: 1 cost time: 25.594479084014893
Epoch: 1, Steps: 469 | Train Loss: 0.569 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
Validation loss decreased (inf --> -0.943108).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0943193
	speed: 0.2685s/iter; left time: 12438.7982s
	iters: 200, epoch: 2 | loss: 0.0931550
	speed: 0.0457s/iter; left time: 2114.3043s
	iters: 300, epoch: 2 | loss: 0.0385612
	speed: 0.0492s/iter; left time: 2271.5039s
	iters: 400, epoch: 2 | loss: 0.0214107
	speed: 0.0500s/iter; left time: 2301.0161s
Epoch: 2 cost time: 23.745239734649658
Epoch: 2, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.943108 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0674125
	speed: 0.2419s/iter; left time: 11096.4271s
	iters: 200, epoch: 3 | loss: 0.0412287
	speed: 0.0467s/iter; left time: 2135.3016s
	iters: 300, epoch: 3 | loss: 0.1682474
	speed: 0.0438s/iter; left time: 2001.7036s
	iters: 400, epoch: 3 | loss: 0.0031283
	speed: 0.0434s/iter; left time: 1975.3996s
Epoch: 3 cost time: 21.46582269668579
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.958260 --> -0.959118).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1067600
	speed: 0.2464s/iter; left time: 11185.5527s
	iters: 200, epoch: 4 | loss: 0.0225325
	speed: 0.0568s/iter; left time: 2570.4511s
	iters: 300, epoch: 4 | loss: 0.0055163
	speed: 0.0557s/iter; left time: 2518.1413s
	iters: 400, epoch: 4 | loss: 0.0075607
	speed: 0.0525s/iter; left time: 2368.8013s
Epoch: 4 cost time: 25.996845960617065
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.959118 --> -0.959404).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0089670
	speed: 0.2672s/iter; left time: 12002.8496s
	iters: 200, epoch: 5 | loss: 0.0038442
	speed: 0.0498s/iter; left time: 2231.7001s
	iters: 300, epoch: 5 | loss: 0.0761659
	speed: 0.0512s/iter; left time: 2291.9015s
	iters: 400, epoch: 5 | loss: 0.0127056
	speed: 0.0511s/iter; left time: 2278.7340s
Epoch: 5 cost time: 25.035319805145264
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0075259
	speed: 0.2592s/iter; left time: 11524.5549s
	iters: 200, epoch: 6 | loss: 0.1677684
	speed: 0.0416s/iter; left time: 1844.8651s
	iters: 300, epoch: 6 | loss: 0.0115547
	speed: 0.0417s/iter; left time: 1846.7430s
	iters: 400, epoch: 6 | loss: 0.0036130
	speed: 0.0406s/iter; left time: 1791.2264s
Epoch: 6 cost time: 20.851569652557373
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.959404 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0728287
	speed: 0.2388s/iter; left time: 10503.1629s
	iters: 200, epoch: 7 | loss: 0.0593443
	speed: 0.0438s/iter; left time: 1924.2838s
	iters: 300, epoch: 7 | loss: 0.0432322
	speed: 0.0460s/iter; left time: 2013.1422s
	iters: 400, epoch: 7 | loss: 0.0009556
	speed: 0.0547s/iter; left time: 2388.3099s
Epoch: 7 cost time: 23.1528058052063
Epoch: 7, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0177029
	speed: 0.2554s/iter; left time: 11115.1377s
	iters: 200, epoch: 8 | loss: 0.0017013
	speed: 0.0570s/iter; left time: 2476.1484s
	iters: 300, epoch: 8 | loss: 0.0067920
	speed: 0.0568s/iter; left time: 2458.9718s
	iters: 400, epoch: 8 | loss: 0.0043059
	speed: 0.0436s/iter; left time: 1885.4667s
Epoch: 8 cost time: 24.777751684188843
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
Validation loss decreased (-0.963406 --> -0.971697).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0124294
	speed: 0.2436s/iter; left time: 10487.0238s
	iters: 200, epoch: 9 | loss: 0.0140929
	speed: 0.0484s/iter; left time: 2077.9939s
	iters: 300, epoch: 9 | loss: 0.0046083
	speed: 0.0488s/iter; left time: 2089.3337s
	iters: 400, epoch: 9 | loss: 0.0030487
	speed: 0.0460s/iter; left time: 1965.6256s
Epoch: 9 cost time: 23.45123863220215
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0078233
	speed: 0.2399s/iter; left time: 10215.7605s
	iters: 200, epoch: 10 | loss: 0.3419728
	speed: 0.0454s/iter; left time: 1927.3100s
	iters: 300, epoch: 10 | loss: 0.0073439
	speed: 0.0428s/iter; left time: 1815.4715s
	iters: 400, epoch: 10 | loss: 0.0106058
	speed: 0.0401s/iter; left time: 1693.4525s
Epoch: 10 cost time: 20.31031036376953
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0393674
	speed: 0.2075s/iter; left time: 8738.1625s
	iters: 200, epoch: 11 | loss: 0.0090118
	speed: 0.0449s/iter; left time: 1888.0868s
	iters: 300, epoch: 11 | loss: 0.0020544
	speed: 0.0502s/iter; left time: 2105.9360s
	iters: 400, epoch: 11 | loss: 0.0034970
	speed: 0.0463s/iter; left time: 1937.4115s
Epoch: 11 cost time: 22.2230064868927
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0293825
	speed: 0.2385s/iter; left time: 9931.1690s
	iters: 200, epoch: 12 | loss: 0.0014478
	speed: 0.0467s/iter; left time: 1938.9931s
	iters: 300, epoch: 12 | loss: 0.0333405
	speed: 0.0422s/iter; left time: 1750.6377s
	iters: 400, epoch: 12 | loss: 0.0020993
	speed: 0.0404s/iter; left time: 1668.6822s
Epoch: 12 cost time: 21.22877073287964
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.971697 --> -0.972269).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0030111
	speed: 0.2500s/iter; left time: 10291.7805s
	iters: 200, epoch: 13 | loss: 0.0030606
	speed: 0.0538s/iter; left time: 2211.4221s
	iters: 300, epoch: 13 | loss: 0.0015144
	speed: 0.0526s/iter; left time: 2153.7603s
	iters: 400, epoch: 13 | loss: 0.0001303
	speed: 0.0520s/iter; left time: 2127.1280s
Epoch: 13 cost time: 25.251692533493042
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0030546
	speed: 0.2529s/iter; left time: 10294.4385s
	iters: 200, epoch: 14 | loss: 0.0287674
	speed: 0.0470s/iter; left time: 1908.4358s
	iters: 300, epoch: 14 | loss: 0.0814373
	speed: 0.0452s/iter; left time: 1832.3234s
	iters: 400, epoch: 14 | loss: 0.0008760
	speed: 0.0516s/iter; left time: 2084.0056s
Epoch: 14 cost time: 22.670987844467163
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0486335
	speed: 0.2180s/iter; left time: 8770.5262s
	iters: 200, epoch: 15 | loss: 0.0089744
	speed: 0.0497s/iter; left time: 1995.7736s
	iters: 300, epoch: 15 | loss: 0.0118595
	speed: 0.0508s/iter; left time: 2032.7950s
	iters: 400, epoch: 15 | loss: 0.0840086
	speed: 0.0513s/iter; left time: 2049.6426s
Epoch: 15 cost time: 23.95274591445923
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
Validation loss decreased (-0.972269 --> -0.972269).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002553
	speed: 0.2431s/iter; left time: 9666.9051s
	iters: 200, epoch: 16 | loss: 0.0068033
	speed: 0.0511s/iter; left time: 2026.8969s
	iters: 300, epoch: 16 | loss: 0.0907979
	speed: 0.0495s/iter; left time: 1960.0613s
	iters: 400, epoch: 16 | loss: 0.0012047
	speed: 0.0492s/iter; left time: 1942.4818s
Epoch: 16 cost time: 23.61030340194702
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.972269 --> -0.977986).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0014955
	speed: 0.2198s/iter; left time: 8638.3385s
	iters: 200, epoch: 17 | loss: 0.1072823
	speed: 0.0472s/iter; left time: 1849.4962s
	iters: 300, epoch: 17 | loss: 0.0132621
	speed: 0.0463s/iter; left time: 1809.8998s
	iters: 400, epoch: 17 | loss: 0.0103857
	speed: 0.0449s/iter; left time: 1751.9553s
Epoch: 17 cost time: 21.590034246444702
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.977986 --> -0.982846).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0777600
	speed: 0.2293s/iter; left time: 8901.7781s
	iters: 200, epoch: 18 | loss: 0.0032942
	speed: 0.0450s/iter; left time: 1741.9416s
	iters: 300, epoch: 18 | loss: 0.0005948
	speed: 0.0461s/iter; left time: 1781.7420s
	iters: 400, epoch: 18 | loss: 0.0989873
	speed: 0.0430s/iter; left time: 1656.1693s
Epoch: 18 cost time: 21.948790311813354
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0084366
	speed: 0.2317s/iter; left time: 8886.5156s
	iters: 200, epoch: 19 | loss: 0.0101555
	speed: 0.0415s/iter; left time: 1588.7286s
	iters: 300, epoch: 19 | loss: 0.2014867
	speed: 0.0397s/iter; left time: 1513.4068s
	iters: 400, epoch: 19 | loss: 0.0002786
	speed: 0.0497s/iter; left time: 1892.2031s
Epoch: 19 cost time: 21.301923751831055
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1331641
	speed: 0.2365s/iter; left time: 8961.5217s
	iters: 200, epoch: 20 | loss: 0.1581081
	speed: 0.0514s/iter; left time: 1941.0852s
	iters: 300, epoch: 20 | loss: 0.0034047
	speed: 0.0513s/iter; left time: 1932.4639s
	iters: 400, epoch: 20 | loss: 0.0033776
	speed: 0.0528s/iter; left time: 1984.0467s
Epoch: 20 cost time: 24.525527715682983
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000192
	speed: 0.2270s/iter; left time: 8492.9717s
	iters: 200, epoch: 21 | loss: 0.0064983
	speed: 0.0409s/iter; left time: 1526.6788s
	iters: 300, epoch: 21 | loss: 0.0002729
	speed: 0.0424s/iter; left time: 1576.7853s
	iters: 400, epoch: 21 | loss: 0.0614698
	speed: 0.0473s/iter; left time: 1757.1551s
Epoch: 21 cost time: 20.87791347503662
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0015663
	speed: 0.2403s/iter; left time: 8878.7359s
	iters: 200, epoch: 22 | loss: 0.0006996
	speed: 0.0507s/iter; left time: 1869.3880s
	iters: 300, epoch: 22 | loss: 0.0103618
	speed: 0.0501s/iter; left time: 1841.6564s
	iters: 400, epoch: 22 | loss: 0.0710692
	speed: 0.0439s/iter; left time: 1608.2644s
Epoch: 22 cost time: 22.4867205619812
Epoch: 22, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000229
	speed: 0.2167s/iter; left time: 7905.7263s
	iters: 200, epoch: 23 | loss: 0.0008185
	speed: 0.0470s/iter; left time: 1708.7942s
	iters: 300, epoch: 23 | loss: 0.0410242
	speed: 0.0474s/iter; left time: 1719.2086s
	iters: 400, epoch: 23 | loss: 0.0511470
	speed: 0.0488s/iter; left time: 1764.6182s
Epoch: 23 cost time: 23.53068494796753
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0026007
	speed: 0.2478s/iter; left time: 8924.2587s
	iters: 200, epoch: 24 | loss: 0.0621527
	speed: 0.0479s/iter; left time: 1718.6409s
	iters: 300, epoch: 24 | loss: 0.0011890
	speed: 0.0495s/iter; left time: 1771.6847s
	iters: 400, epoch: 24 | loss: 0.0001590
	speed: 0.0462s/iter; left time: 1651.7540s
Epoch: 24 cost time: 23.005317449569702
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0123250
	speed: 0.2351s/iter; left time: 8355.4816s
	iters: 200, epoch: 25 | loss: 0.0000665
	speed: 0.0512s/iter; left time: 1815.8997s
	iters: 300, epoch: 25 | loss: 0.0051082
	speed: 0.0495s/iter; left time: 1749.5524s
	iters: 400, epoch: 25 | loss: 0.0003756
	speed: 0.0463s/iter; left time: 1632.2173s
Epoch: 25 cost time: 22.93548345565796
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0421869
	speed: 0.2354s/iter; left time: 8257.3550s
	iters: 200, epoch: 26 | loss: 0.0001107
	speed: 0.0493s/iter; left time: 1724.9789s
	iters: 300, epoch: 26 | loss: 0.0005138
	speed: 0.0408s/iter; left time: 1424.0385s
	iters: 400, epoch: 26 | loss: 0.0000389
	speed: 0.0399s/iter; left time: 1388.7883s
Epoch: 26 cost time: 21.276201009750366
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0002893
	speed: 0.2418s/iter; left time: 8367.6699s
	iters: 200, epoch: 27 | loss: 0.0004587
	speed: 0.0476s/iter; left time: 1642.3565s
	iters: 300, epoch: 27 | loss: 0.0321152
	speed: 0.0456s/iter; left time: 1568.7127s
	iters: 400, epoch: 27 | loss: 0.0000932
	speed: 0.0473s/iter; left time: 1621.8776s
Epoch: 27 cost time: 23.20615243911743
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 604474
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7528456
	speed: 0.0612s/iter; left time: 2862.6310s
	iters: 200, epoch: 1 | loss: 0.2970825
	speed: 0.0426s/iter; left time: 1988.7090s
	iters: 300, epoch: 1 | loss: 0.2011372
	speed: 0.0414s/iter; left time: 1929.8191s
	iters: 400, epoch: 1 | loss: 0.0443173
	speed: 0.0430s/iter; left time: 2000.2061s
Epoch: 1 cost time: 21.91886329650879
Epoch: 1, Steps: 469 | Train Loss: 0.545 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (inf --> -0.948540).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0842458
	speed: 0.2195s/iter; left time: 10171.7429s
	iters: 200, epoch: 2 | loss: 0.1543973
	speed: 0.0433s/iter; left time: 2003.9492s
	iters: 300, epoch: 2 | loss: 0.0225804
	speed: 0.0465s/iter; left time: 2145.1988s
	iters: 400, epoch: 2 | loss: 0.0530912
	speed: 0.0447s/iter; left time: 2055.6279s
Epoch: 2 cost time: 21.250471830368042
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
Validation loss decreased (-0.948540 --> -0.965693).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0119298
	speed: 0.2162s/iter; left time: 9915.2492s
	iters: 200, epoch: 3 | loss: 0.0071575
	speed: 0.0493s/iter; left time: 2255.1138s
	iters: 300, epoch: 3 | loss: 0.0983268
	speed: 0.0535s/iter; left time: 2442.8117s
	iters: 400, epoch: 3 | loss: 0.0027749
	speed: 0.0544s/iter; left time: 2476.8933s
Epoch: 3 cost time: 24.646121740341187
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
Validation loss decreased (-0.965693 --> -0.975985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0775082
	speed: 0.2560s/iter; left time: 11622.2928s
	iters: 200, epoch: 4 | loss: 0.0278852
	speed: 0.0483s/iter; left time: 2189.0701s
	iters: 300, epoch: 4 | loss: 0.0172775
	speed: 0.0428s/iter; left time: 1932.5371s
	iters: 400, epoch: 4 | loss: 0.0055391
	speed: 0.0407s/iter; left time: 1834.2013s
Epoch: 4 cost time: 21.61056661605835
Epoch: 4, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0154570
	speed: 0.2438s/iter; left time: 10951.4484s
	iters: 200, epoch: 5 | loss: 0.0037703
	speed: 0.0435s/iter; left time: 1952.0098s
	iters: 300, epoch: 5 | loss: 0.0582904
	speed: 0.0446s/iter; left time: 1996.0510s
	iters: 400, epoch: 5 | loss: 0.0272114
	speed: 0.0425s/iter; left time: 1896.6795s
Epoch: 5 cost time: 21.47978377342224
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0331858
	speed: 0.2302s/iter; left time: 10233.6091s
	iters: 200, epoch: 6 | loss: 0.0790563
	speed: 0.0429s/iter; left time: 1904.2510s
	iters: 300, epoch: 6 | loss: 0.0026025
	speed: 0.0460s/iter; left time: 2034.6845s
	iters: 400, epoch: 6 | loss: 0.0009257
	speed: 0.0452s/iter; left time: 1995.6596s
Epoch: 6 cost time: 21.245992183685303
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0151782
	speed: 0.2313s/iter; left time: 10175.6838s
	iters: 200, epoch: 7 | loss: 0.3348500
	speed: 0.0463s/iter; left time: 2032.3250s
	iters: 300, epoch: 7 | loss: 0.0656222
	speed: 0.0409s/iter; left time: 1791.4313s
	iters: 400, epoch: 7 | loss: 0.0006294
	speed: 0.0412s/iter; left time: 1801.6149s
Epoch: 7 cost time: 20.890865564346313
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0161779
	speed: 0.2206s/iter; left time: 9600.5078s
	iters: 200, epoch: 8 | loss: 0.0029605
	speed: 0.0505s/iter; left time: 2192.1119s
	iters: 300, epoch: 8 | loss: 0.0117948
	speed: 0.0522s/iter; left time: 2260.3537s
	iters: 400, epoch: 8 | loss: 0.0027920
	speed: 0.0473s/iter; left time: 2044.0887s
Epoch: 8 cost time: 23.030107975006104
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1749444
	speed: 0.2468s/iter; left time: 10622.8237s
	iters: 200, epoch: 9 | loss: 0.0004137
	speed: 0.0474s/iter; left time: 2033.8363s
	iters: 300, epoch: 9 | loss: 0.0185825
	speed: 0.0443s/iter; left time: 1898.3096s
	iters: 400, epoch: 9 | loss: 0.0038224
	speed: 0.0452s/iter; left time: 1930.7140s
Epoch: 9 cost time: 22.29966115951538
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0161639
	speed: 0.2099s/iter; left time: 8935.7603s
	iters: 200, epoch: 10 | loss: 0.1140951
	speed: 0.0422s/iter; left time: 1793.4668s
	iters: 300, epoch: 10 | loss: 0.0079954
	speed: 0.0421s/iter; left time: 1783.7469s
	iters: 400, epoch: 10 | loss: 0.0141786
	speed: 0.0431s/iter; left time: 1821.3700s
Epoch: 10 cost time: 20.56884217262268
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.975985).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0222320
	speed: 0.2143s/iter; left time: 9026.1580s
	iters: 200, epoch: 11 | loss: 0.0042339
	speed: 0.0468s/iter; left time: 1965.4285s
	iters: 300, epoch: 11 | loss: 0.0020022
	speed: 0.0491s/iter; left time: 2055.9974s
	iters: 400, epoch: 11 | loss: 0.0001709
	speed: 0.0474s/iter; left time: 1981.1950s
Epoch: 11 cost time: 21.983938455581665
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0001631
	speed: 0.2127s/iter; left time: 8856.3946s
	iters: 200, epoch: 12 | loss: 0.0005678
	speed: 0.0499s/iter; left time: 2073.9651s
	iters: 300, epoch: 12 | loss: 0.0476373
	speed: 0.0482s/iter; left time: 1999.1508s
	iters: 400, epoch: 12 | loss: 0.0135707
	speed: 0.0476s/iter; left time: 1966.9755s
Epoch: 12 cost time: 23.03149914741516
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0375801
	speed: 0.2417s/iter; left time: 9950.1783s
	iters: 200, epoch: 13 | loss: 0.0328881
	speed: 0.0398s/iter; left time: 1635.6158s
	iters: 300, epoch: 13 | loss: 0.0001093
	speed: 0.0397s/iter; left time: 1627.9818s
	iters: 400, epoch: 13 | loss: 0.0001519
	speed: 0.0433s/iter; left time: 1770.8482s
Epoch: 13 cost time: 20.61580181121826
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0020683
	speed: 0.2409s/iter; left time: 9807.1652s
	iters: 200, epoch: 14 | loss: 0.0016111
	speed: 0.0464s/iter; left time: 1885.6900s
	iters: 300, epoch: 14 | loss: 0.0074720
	speed: 0.0452s/iter; left time: 1831.2912s
	iters: 400, epoch: 14 | loss: 0.0193627
	speed: 0.0472s/iter; left time: 1905.3857s
Epoch: 14 cost time: 22.294978380203247
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0012153
	speed: 0.2364s/iter; left time: 9510.2292s
	iters: 200, epoch: 15 | loss: 0.0518040
	speed: 0.0436s/iter; left time: 1750.2687s
	iters: 300, epoch: 15 | loss: 0.0022943
	speed: 0.0490s/iter; left time: 1963.4818s
	iters: 400, epoch: 15 | loss: 0.0017588
	speed: 0.0541s/iter; left time: 2160.1940s
Epoch: 15 cost time: 22.99785351753235
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0092273
	speed: 0.2542s/iter; left time: 10106.7049s
	iters: 200, epoch: 16 | loss: 0.0189237
	speed: 0.0516s/iter; left time: 2046.5426s
	iters: 300, epoch: 16 | loss: 0.0251479
	speed: 0.0502s/iter; left time: 1987.2200s
	iters: 400, epoch: 16 | loss: 0.0087266
	speed: 0.0502s/iter; left time: 1980.6835s
Epoch: 16 cost time: 23.79246950149536
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.979701).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0016689
	speed: 0.2062s/iter; left time: 8101.6102s
	iters: 200, epoch: 17 | loss: 0.0274757
	speed: 0.0450s/iter; left time: 1763.8601s
	iters: 300, epoch: 17 | loss: 0.0002563
	speed: 0.0478s/iter; left time: 1870.1526s
	iters: 400, epoch: 17 | loss: 0.0023347
	speed: 0.0440s/iter; left time: 1714.4532s
Epoch: 17 cost time: 21.774356603622437
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979701 --> -0.979987).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0153447
	speed: 0.2332s/iter; left time: 9056.6178s
	iters: 200, epoch: 18 | loss: 0.0001694
	speed: 0.0459s/iter; left time: 1775.6843s
	iters: 300, epoch: 18 | loss: 0.0001710
	speed: 0.0425s/iter; left time: 1642.0916s
	iters: 400, epoch: 18 | loss: 0.0094651
	speed: 0.0461s/iter; left time: 1777.6381s
Epoch: 18 cost time: 22.06792640686035
Epoch: 18, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0517457
	speed: 0.2307s/iter; left time: 8847.7145s
	iters: 200, epoch: 19 | loss: 0.1845012
	speed: 0.0391s/iter; left time: 1497.3246s
	iters: 300, epoch: 19 | loss: 0.0910665
	speed: 0.0443s/iter; left time: 1691.5609s
	iters: 400, epoch: 19 | loss: 0.0055661
	speed: 0.0473s/iter; left time: 1801.7753s
Epoch: 19 cost time: 20.954381942749023
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0031439
	speed: 0.2455s/iter; left time: 9303.1438s
	iters: 200, epoch: 20 | loss: 0.0000955
	speed: 0.0491s/iter; left time: 1853.9231s
	iters: 300, epoch: 20 | loss: 0.0503221
	speed: 0.0496s/iter; left time: 1870.2192s
	iters: 400, epoch: 20 | loss: 0.0006765
	speed: 0.0510s/iter; left time: 1917.8828s
Epoch: 20 cost time: 23.534724235534668
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.966 Test Loss: 0.176 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0007174
	speed: 0.2164s/iter; left time: 8096.0914s
	iters: 200, epoch: 21 | loss: 0.0000365
	speed: 0.0440s/iter; left time: 1642.9950s
	iters: 300, epoch: 21 | loss: 0.0009929
	speed: 0.0489s/iter; left time: 1820.1008s
	iters: 400, epoch: 21 | loss: 0.0004114
	speed: 0.0490s/iter; left time: 1818.3982s
Epoch: 21 cost time: 22.198195219039917
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000529
	speed: 0.2276s/iter; left time: 8409.8620s
	iters: 200, epoch: 22 | loss: 0.0192601
	speed: 0.0504s/iter; left time: 1858.9676s
	iters: 300, epoch: 22 | loss: 0.0008424
	speed: 0.0509s/iter; left time: 1869.8880s
	iters: 400, epoch: 22 | loss: 0.0073312
	speed: 0.0442s/iter; left time: 1621.2466s
Epoch: 22 cost time: 22.840970993041992
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0025048
	speed: 0.2326s/iter; left time: 8485.7285s
	iters: 200, epoch: 23 | loss: 0.0000190
	speed: 0.0471s/iter; left time: 1713.1228s
	iters: 300, epoch: 23 | loss: 0.1471716
	speed: 0.0404s/iter; left time: 1466.3676s
	iters: 400, epoch: 23 | loss: 0.0001547
	speed: 0.0411s/iter; left time: 1485.7193s
Epoch: 23 cost time: 20.66226601600647
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0038823
	speed: 0.2306s/iter; left time: 8303.4443s
	iters: 200, epoch: 24 | loss: 0.0035435
	speed: 0.0456s/iter; left time: 1636.9977s
	iters: 300, epoch: 24 | loss: 0.0019953
	speed: 0.0436s/iter; left time: 1561.6070s
	iters: 400, epoch: 24 | loss: 0.0128191
	speed: 0.0435s/iter; left time: 1554.6180s
Epoch: 24 cost time: 21.57736873626709
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
Validation loss decreased (-0.979987 --> -0.980845).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000253
	speed: 0.2258s/iter; left time: 8026.0756s
	iters: 200, epoch: 25 | loss: 0.0019100
	speed: 0.0370s/iter; left time: 1312.4745s
	iters: 300, epoch: 25 | loss: 0.0000097
	speed: 0.0378s/iter; left time: 1334.9805s
	iters: 400, epoch: 25 | loss: 0.0000759
	speed: 0.0402s/iter; left time: 1416.9518s
Epoch: 25 cost time: 19.162850856781006
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0041287
	speed: 0.2295s/iter; left time: 8050.8960s
	iters: 200, epoch: 26 | loss: 0.0025012
	speed: 0.0463s/iter; left time: 1617.7296s
	iters: 300, epoch: 26 | loss: 0.0004511
	speed: 0.0457s/iter; left time: 1594.5456s
	iters: 400, epoch: 26 | loss: 0.0000209
	speed: 0.0493s/iter; left time: 1715.7997s
Epoch: 26 cost time: 22.177570819854736
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000189
	speed: 0.1954s/iter; left time: 6763.7044s
	iters: 200, epoch: 27 | loss: 0.0000025
	speed: 0.0524s/iter; left time: 1807.8970s
	iters: 300, epoch: 27 | loss: 0.0073115
	speed: 0.0475s/iter; left time: 1633.0078s
	iters: 400, epoch: 27 | loss: 0.0001861
	speed: 0.0472s/iter; left time: 1617.6946s
Epoch: 27 cost time: 23.226928234100342
Epoch: 27, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000398
	speed: 0.2477s/iter; left time: 8456.7662s
	iters: 200, epoch: 28 | loss: 0.0002123
	speed: 0.0401s/iter; left time: 1364.7873s
	iters: 300, epoch: 28 | loss: 0.0000088
	speed: 0.0390s/iter; left time: 1323.6461s
	iters: 400, epoch: 28 | loss: 0.0000198
	speed: 0.0428s/iter; left time: 1449.9438s
Epoch: 28 cost time: 20.42083168029785
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0004787
	speed: 0.2255s/iter; left time: 7591.4103s
	iters: 200, epoch: 29 | loss: 0.0004321
	speed: 0.0401s/iter; left time: 1346.2380s
	iters: 300, epoch: 29 | loss: 0.0266812
	speed: 0.0413s/iter; left time: 1380.6021s
	iters: 400, epoch: 29 | loss: 0.0099924
	speed: 0.0415s/iter; left time: 1383.5941s
Epoch: 29 cost time: 19.82712411880493
Epoch: 29, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0033571
	speed: 0.2011s/iter; left time: 6677.2557s
	iters: 200, epoch: 30 | loss: 0.2247557
	speed: 0.0411s/iter; left time: 1360.2074s
	iters: 300, epoch: 30 | loss: 0.0114848
	speed: 0.0445s/iter; left time: 1469.4350s
	iters: 400, epoch: 30 | loss: 0.0006965
	speed: 0.0462s/iter; left time: 1518.4289s
Epoch: 30 cost time: 20.572315454483032
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.979 Test Loss: 0.152 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1697014
	speed: 0.2256s/iter; left time: 7382.9467s
	iters: 200, epoch: 31 | loss: 0.0000067
	speed: 0.0447s/iter; left time: 1459.9557s
	iters: 300, epoch: 31 | loss: 0.0936693
	speed: 0.0429s/iter; left time: 1394.6477s
	iters: 400, epoch: 31 | loss: 0.0001247
	speed: 0.0442s/iter; left time: 1433.3867s
Epoch: 31 cost time: 20.825377464294434
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000428
	speed: 0.2248s/iter; left time: 7250.9893s
	iters: 200, epoch: 32 | loss: 0.0000158
	speed: 0.0480s/iter; left time: 1542.6091s
	iters: 300, epoch: 32 | loss: 0.0021816
	speed: 0.0455s/iter; left time: 1458.0412s
	iters: 400, epoch: 32 | loss: 0.0137955
	speed: 0.0430s/iter; left time: 1373.3029s
Epoch: 32 cost time: 21.80094051361084
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0010927
	speed: 0.2221s/iter; left time: 7060.1232s
	iters: 200, epoch: 33 | loss: 0.0565636
	speed: 0.0431s/iter; left time: 1366.0759s
	iters: 300, epoch: 33 | loss: 0.0080574
	speed: 0.0401s/iter; left time: 1268.0562s
	iters: 400, epoch: 33 | loss: 0.0622170
	speed: 0.0386s/iter; left time: 1216.8684s
Epoch: 33 cost time: 20.12213945388794
Epoch: 33, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0001549
	speed: 0.2209s/iter; left time: 6920.6703s
	iters: 200, epoch: 34 | loss: 0.0004686
	speed: 0.0438s/iter; left time: 1367.8305s
	iters: 300, epoch: 34 | loss: 0.0040843
	speed: 0.0422s/iter; left time: 1312.1772s
	iters: 400, epoch: 34 | loss: 0.0688574
	speed: 0.0439s/iter; left time: 1360.4057s
Epoch: 34 cost time: 21.021981477737427
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 604474
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0921139
	speed: 0.0664s/iter; left time: 3106.5474s
	iters: 200, epoch: 1 | loss: 0.5130429
	speed: 0.0434s/iter; left time: 2026.5618s
	iters: 300, epoch: 1 | loss: 0.1147339
	speed: 0.0457s/iter; left time: 2130.6053s
	iters: 400, epoch: 1 | loss: 0.2338802
	speed: 0.0450s/iter; left time: 2093.2524s
Epoch: 1 cost time: 23.38050651550293
Epoch: 1, Steps: 469 | Train Loss: 0.618 Vali Loss: 0.324 Vali Acc: 0.910 Test Loss: 0.324 Test Acc: 0.910
Validation loss decreased (inf --> -0.910231).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2313985
	speed: 0.2204s/iter; left time: 10209.7433s
	iters: 200, epoch: 2 | loss: 0.1907402
	speed: 0.0426s/iter; left time: 1971.4321s
	iters: 300, epoch: 2 | loss: 0.0961816
	speed: 0.0420s/iter; left time: 1935.3686s
	iters: 400, epoch: 2 | loss: 0.1076568
	speed: 0.0426s/iter; left time: 1958.8507s
Epoch: 2 cost time: 20.28485083580017
Epoch: 2, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.173 Vali Acc: 0.953 Test Loss: 0.173 Test Acc: 0.953
Validation loss decreased (-0.910231 --> -0.953400).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0220008
	speed: 0.2047s/iter; left time: 9387.0987s
	iters: 200, epoch: 3 | loss: 0.1071041
	speed: 0.0417s/iter; left time: 1909.6549s
	iters: 300, epoch: 3 | loss: 0.0507963
	speed: 0.0494s/iter; left time: 2257.6561s
	iters: 400, epoch: 3 | loss: 0.0218924
	speed: 0.0495s/iter; left time: 2257.2239s
Epoch: 3 cost time: 22.035126447677612
Epoch: 3, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
Validation loss decreased (-0.953400 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0060532
	speed: 0.2252s/iter; left time: 10224.3001s
	iters: 200, epoch: 4 | loss: 0.0647660
	speed: 0.0503s/iter; left time: 2279.2280s
	iters: 300, epoch: 4 | loss: 0.0333196
	speed: 0.0477s/iter; left time: 2155.9596s
	iters: 400, epoch: 4 | loss: 0.0130401
	speed: 0.0466s/iter; left time: 2102.9692s
Epoch: 4 cost time: 22.898759126663208
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.961119 --> -0.962834).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0127895
	speed: 0.2174s/iter; left time: 9767.3362s
	iters: 200, epoch: 5 | loss: 0.0202178
	speed: 0.0388s/iter; left time: 1741.3445s
	iters: 300, epoch: 5 | loss: 0.0007575
	speed: 0.0386s/iter; left time: 1724.1662s
	iters: 400, epoch: 5 | loss: 0.3550774
	speed: 0.0375s/iter; left time: 1674.8265s
Epoch: 5 cost time: 18.938390493392944
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.962834 --> -0.964836).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0150029
	speed: 0.2103s/iter; left time: 9351.1863s
	iters: 200, epoch: 6 | loss: 0.0466257
	speed: 0.0440s/iter; left time: 1951.7565s
	iters: 300, epoch: 6 | loss: 0.0277470
	speed: 0.0425s/iter; left time: 1880.6312s
	iters: 400, epoch: 6 | loss: 0.0340479
	speed: 0.0419s/iter; left time: 1850.2738s
Epoch: 6 cost time: 20.54127287864685
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.964836 --> -0.972841).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0037378
	speed: 0.2139s/iter; left time: 9408.7819s
	iters: 200, epoch: 7 | loss: 0.0478638
	speed: 0.0429s/iter; left time: 1882.1587s
	iters: 300, epoch: 7 | loss: 0.0121093
	speed: 0.0456s/iter; left time: 1997.0338s
	iters: 400, epoch: 7 | loss: 0.0157267
	speed: 0.0477s/iter; left time: 2082.6404s
Epoch: 7 cost time: 21.330929279327393
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0192831
	speed: 0.2160s/iter; left time: 9401.1229s
	iters: 200, epoch: 8 | loss: 0.0730202
	speed: 0.0471s/iter; left time: 2043.9463s
	iters: 300, epoch: 8 | loss: 0.1741836
	speed: 0.0487s/iter; left time: 2110.9111s
	iters: 400, epoch: 8 | loss: 0.0072434
	speed: 0.0460s/iter; left time: 1989.9745s
Epoch: 8 cost time: 21.977976083755493
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0138656
	speed: 0.2225s/iter; left time: 9578.1375s
	iters: 200, epoch: 9 | loss: 0.1455057
	speed: 0.0481s/iter; left time: 2063.9446s
	iters: 300, epoch: 9 | loss: 0.0036084
	speed: 0.0485s/iter; left time: 2076.6612s
	iters: 400, epoch: 9 | loss: 0.1753040
	speed: 0.0461s/iter; left time: 1968.7835s
Epoch: 9 cost time: 22.95246434211731
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1300523
	speed: 0.2328s/iter; left time: 9911.4957s
	iters: 200, epoch: 10 | loss: 0.0168510
	speed: 0.0438s/iter; left time: 1858.8755s
	iters: 300, epoch: 10 | loss: 0.0134725
	speed: 0.0408s/iter; left time: 1729.9949s
	iters: 400, epoch: 10 | loss: 0.0058140
	speed: 0.0398s/iter; left time: 1681.0474s
Epoch: 10 cost time: 20.69601011276245
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.972841 --> -0.977986).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0282600
	speed: 0.2220s/iter; left time: 9349.0400s
	iters: 200, epoch: 11 | loss: 0.0109303
	speed: 0.0418s/iter; left time: 1756.2255s
	iters: 300, epoch: 11 | loss: 0.0741076
	speed: 0.0432s/iter; left time: 1811.8653s
	iters: 400, epoch: 11 | loss: 0.1606693
	speed: 0.0472s/iter; left time: 1973.0233s
Epoch: 11 cost time: 21.26879048347473
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0037465
	speed: 0.2258s/iter; left time: 9401.2151s
	iters: 200, epoch: 12 | loss: 0.0176881
	speed: 0.0458s/iter; left time: 1904.4286s
	iters: 300, epoch: 12 | loss: 0.0047664
	speed: 0.0466s/iter; left time: 1930.8383s
	iters: 400, epoch: 12 | loss: 0.0217410
	speed: 0.0471s/iter; left time: 1947.5924s
Epoch: 12 cost time: 22.102991819381714
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0004855
	speed: 0.2232s/iter; left time: 9190.2508s
	iters: 200, epoch: 13 | loss: 0.0003494
	speed: 0.0412s/iter; left time: 1693.5397s
	iters: 300, epoch: 13 | loss: 0.0004375
	speed: 0.0409s/iter; left time: 1675.0618s
	iters: 400, epoch: 13 | loss: 0.0404481
	speed: 0.0393s/iter; left time: 1607.8454s
Epoch: 13 cost time: 19.976439476013184
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0004995
	speed: 0.2106s/iter; left time: 8572.2688s
	iters: 200, epoch: 14 | loss: 0.3064289
	speed: 0.0466s/iter; left time: 1891.5339s
	iters: 300, epoch: 14 | loss: 0.0005208
	speed: 0.0445s/iter; left time: 1801.9366s
	iters: 400, epoch: 14 | loss: 0.0001499
	speed: 0.0405s/iter; left time: 1636.6172s
Epoch: 14 cost time: 20.76818537712097
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0006981
	speed: 0.2143s/iter; left time: 8623.1349s
	iters: 200, epoch: 15 | loss: 0.0018858
	speed: 0.0441s/iter; left time: 1768.3200s
	iters: 300, epoch: 15 | loss: 0.0046143
	speed: 0.0431s/iter; left time: 1725.4941s
	iters: 400, epoch: 15 | loss: 0.0031117
	speed: 0.0413s/iter; left time: 1647.5651s
Epoch: 15 cost time: 20.45906352996826
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0171106
	speed: 0.2183s/iter; left time: 8679.3925s
	iters: 200, epoch: 16 | loss: 0.0084266
	speed: 0.0419s/iter; left time: 1662.2171s
	iters: 300, epoch: 16 | loss: 0.0800041
	speed: 0.0441s/iter; left time: 1745.6365s
	iters: 400, epoch: 16 | loss: 0.1662513
	speed: 0.0488s/iter; left time: 1926.2210s
Epoch: 16 cost time: 21.45017695426941
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0471121
	speed: 0.2196s/iter; left time: 8630.1425s
	iters: 200, epoch: 17 | loss: 0.0036182
	speed: 0.0478s/iter; left time: 1874.5136s
	iters: 300, epoch: 17 | loss: 0.1200298
	speed: 0.0448s/iter; left time: 1750.6940s
	iters: 400, epoch: 17 | loss: 0.0004423
	speed: 0.0438s/iter; left time: 1707.2283s
Epoch: 17 cost time: 21.38543391227722
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978844).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0001349
	speed: 0.2038s/iter; left time: 7912.7749s
	iters: 200, epoch: 18 | loss: 0.0003166
	speed: 0.0407s/iter; left time: 1576.9190s
	iters: 300, epoch: 18 | loss: 0.0000564
	speed: 0.0398s/iter; left time: 1537.9786s
	iters: 400, epoch: 18 | loss: 0.0005465
	speed: 0.0389s/iter; left time: 1496.9093s
Epoch: 18 cost time: 19.115999221801758
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979987).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0345849
	speed: 0.2211s/iter; left time: 8480.2071s
	iters: 200, epoch: 19 | loss: 0.0113951
	speed: 0.0422s/iter; left time: 1614.1156s
	iters: 300, epoch: 19 | loss: 0.0006192
	speed: 0.0459s/iter; left time: 1749.8394s
	iters: 400, epoch: 19 | loss: 0.6241248
	speed: 0.0450s/iter; left time: 1714.2654s
Epoch: 19 cost time: 21.527089595794678
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0063564
	speed: 0.2211s/iter; left time: 8376.8324s
	iters: 200, epoch: 20 | loss: 0.0077273
	speed: 0.0454s/iter; left time: 1716.4055s
	iters: 300, epoch: 20 | loss: 0.0330311
	speed: 0.0502s/iter; left time: 1892.1753s
	iters: 400, epoch: 20 | loss: 0.0065516
	speed: 0.0485s/iter; left time: 1823.5783s
Epoch: 20 cost time: 22.509942770004272
Epoch: 20, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0004445
	speed: 0.2313s/iter; left time: 8654.5225s
	iters: 200, epoch: 21 | loss: 0.0470848
	speed: 0.0528s/iter; left time: 1970.0146s
	iters: 300, epoch: 21 | loss: 0.0001398
	speed: 0.0442s/iter; left time: 1644.6234s
	iters: 400, epoch: 21 | loss: 0.5385630
	speed: 0.0417s/iter; left time: 1549.2404s
Epoch: 21 cost time: 21.76165795326233
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000987
	speed: 0.2133s/iter; left time: 7882.5311s
	iters: 200, epoch: 22 | loss: 0.0030090
	speed: 0.0394s/iter; left time: 1452.4653s
	iters: 300, epoch: 22 | loss: 0.0000212
	speed: 0.0403s/iter; left time: 1480.6942s
	iters: 400, epoch: 22 | loss: 0.2850745
	speed: 0.0391s/iter; left time: 1433.6588s
Epoch: 22 cost time: 19.94415855407715
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0451219
	speed: 0.2138s/iter; left time: 7799.4896s
	iters: 200, epoch: 23 | loss: 0.0354457
	speed: 0.0384s/iter; left time: 1398.3282s
	iters: 300, epoch: 23 | loss: 0.0016799
	speed: 0.0392s/iter; left time: 1423.0296s
	iters: 400, epoch: 23 | loss: 0.0706071
	speed: 0.0407s/iter; left time: 1473.7552s
Epoch: 23 cost time: 19.465883016586304
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0595261
	speed: 0.2022s/iter; left time: 7283.7173s
	iters: 200, epoch: 24 | loss: 0.0004700
	speed: 0.0385s/iter; left time: 1381.2101s
	iters: 300, epoch: 24 | loss: 0.0039662
	speed: 0.0379s/iter; left time: 1358.9584s
	iters: 400, epoch: 24 | loss: 0.1497311
	speed: 0.0386s/iter; left time: 1377.3871s
Epoch: 24 cost time: 18.988003969192505
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0013023
	speed: 0.2186s/iter; left time: 7771.7287s
	iters: 200, epoch: 25 | loss: 0.0331889
	speed: 0.0445s/iter; left time: 1576.8012s
	iters: 300, epoch: 25 | loss: 0.0013841
	speed: 0.0506s/iter; left time: 1786.7359s
	iters: 400, epoch: 25 | loss: 0.0012373
	speed: 0.0489s/iter; left time: 1724.9312s
Epoch: 25 cost time: 22.211912393569946
Epoch: 25, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0012828
	speed: 0.2165s/iter; left time: 7593.1581s
	iters: 200, epoch: 26 | loss: 0.0000968
	speed: 0.0450s/iter; left time: 1573.2364s
	iters: 300, epoch: 26 | loss: 0.0049579
	speed: 0.0433s/iter; left time: 1509.7544s
	iters: 400, epoch: 26 | loss: 0.1678034
	speed: 0.0463s/iter; left time: 1611.2684s
Epoch: 26 cost time: 21.4426429271698
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0019238
	speed: 0.2300s/iter; left time: 7960.0753s
	iters: 200, epoch: 27 | loss: 0.0002059
	speed: 0.0424s/iter; left time: 1464.8219s
	iters: 300, epoch: 27 | loss: 0.0000753
	speed: 0.0439s/iter; left time: 1511.8319s
	iters: 400, epoch: 27 | loss: 0.3353616
	speed: 0.0441s/iter; left time: 1514.1261s
Epoch: 27 cost time: 21.276286125183105
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.979987 --> -0.983132).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0005045
	speed: 0.2017s/iter; left time: 6886.3235s
	iters: 200, epoch: 28 | loss: 0.0505832
	speed: 0.0438s/iter; left time: 1491.8885s
	iters: 300, epoch: 28 | loss: 0.0020195
	speed: 0.0419s/iter; left time: 1422.6794s
	iters: 400, epoch: 28 | loss: 0.0010746
	speed: 0.0405s/iter; left time: 1371.0392s
Epoch: 28 cost time: 20.125874996185303
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0261205
	speed: 0.2150s/iter; left time: 7238.6705s
	iters: 200, epoch: 29 | loss: 0.0002844
	speed: 0.0437s/iter; left time: 1466.9565s
	iters: 300, epoch: 29 | loss: 0.0002642
	speed: 0.0410s/iter; left time: 1371.7274s
	iters: 400, epoch: 29 | loss: 0.0016163
	speed: 0.0433s/iter; left time: 1444.0447s
Epoch: 29 cost time: 20.911552906036377
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0260989
	speed: 0.2047s/iter; left time: 6795.6373s
	iters: 200, epoch: 30 | loss: 0.0025819
	speed: 0.0412s/iter; left time: 1364.9620s
	iters: 300, epoch: 30 | loss: 0.0005250
	speed: 0.0439s/iter; left time: 1448.4771s
	iters: 400, epoch: 30 | loss: 0.0022613
	speed: 0.0472s/iter; left time: 1553.7972s
Epoch: 30 cost time: 21.174377918243408
Epoch: 30, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0013476
	speed: 0.2122s/iter; left time: 6946.6856s
	iters: 200, epoch: 31 | loss: 0.0002151
	speed: 0.0387s/iter; left time: 1261.2037s
	iters: 300, epoch: 31 | loss: 0.0042923
	speed: 0.0418s/iter; left time: 1358.5034s
	iters: 400, epoch: 31 | loss: 0.0005442
	speed: 0.0405s/iter; left time: 1314.7306s
Epoch: 31 cost time: 19.11006736755371
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0009492
	speed: 0.2053s/iter; left time: 6622.1073s
	iters: 200, epoch: 32 | loss: 0.0044654
	speed: 0.0436s/iter; left time: 1403.7645s
	iters: 300, epoch: 32 | loss: 0.0006285
	speed: 0.0429s/iter; left time: 1376.6139s
	iters: 400, epoch: 32 | loss: 0.0000065
	speed: 0.0459s/iter; left time: 1468.5993s
Epoch: 32 cost time: 21.154402017593384
Epoch: 32, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0026753
	speed: 0.2310s/iter; left time: 7344.6212s
	iters: 200, epoch: 33 | loss: 0.0228753
	speed: 0.0645s/iter; left time: 2045.1904s
	iters: 300, epoch: 33 | loss: 0.1181229
	speed: 0.0650s/iter; left time: 2052.2070s
	iters: 400, epoch: 33 | loss: 0.0008189
	speed: 0.0642s/iter; left time: 2022.7876s
Epoch: 33 cost time: 31.43444037437439
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0010318
	speed: 0.3266s/iter; left time: 10230.5551s
	iters: 200, epoch: 34 | loss: 0.0064878
	speed: 0.0695s/iter; left time: 2168.8678s
	iters: 300, epoch: 34 | loss: 0.0095747
	speed: 0.0747s/iter; left time: 2323.9663s
	iters: 400, epoch: 34 | loss: 0.0011477
	speed: 0.0762s/iter; left time: 2364.8031s
Epoch: 34 cost time: 33.66739296913147
Epoch: 34, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0004374
	speed: 0.3378s/iter; left time: 10421.7733s
	iters: 200, epoch: 35 | loss: 0.0039130
	speed: 0.0673s/iter; left time: 2069.3575s
	iters: 300, epoch: 35 | loss: 0.0058822
	speed: 0.0659s/iter; left time: 2021.2941s
	iters: 400, epoch: 35 | loss: 0.0020231
	speed: 0.0654s/iter; left time: 1996.8110s
Epoch: 35 cost time: 32.23617219924927
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0658093
	speed: 0.2874s/iter; left time: 8732.3775s
	iters: 200, epoch: 36 | loss: 0.0000157
	speed: 0.0429s/iter; left time: 1300.5330s
	iters: 300, epoch: 36 | loss: 0.0025888
	speed: 0.0661s/iter; left time: 1996.5309s
	iters: 400, epoch: 36 | loss: 0.0144008
	speed: 0.0718s/iter; left time: 2160.8864s
Epoch: 36 cost time: 27.137001991271973
Epoch: 36, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0016296
	speed: 0.3483s/iter; left time: 10418.8469s
	iters: 200, epoch: 37 | loss: 0.0005267
	speed: 0.0661s/iter; left time: 1971.9546s
	iters: 300, epoch: 37 | loss: 0.0344042
	speed: 0.0808s/iter; left time: 2402.5607s
	iters: 400, epoch: 37 | loss: 0.0000396
	speed: 0.0770s/iter; left time: 2281.1457s
Epoch: 37 cost time: 34.86333703994751
Epoch: 37, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 342330
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9695896
	speed: 0.0812s/iter; left time: 3800.5523s
	iters: 200, epoch: 1 | loss: 0.5310622
	speed: 0.0624s/iter; left time: 2915.2334s
	iters: 300, epoch: 1 | loss: 0.0997901
	speed: 0.0648s/iter; left time: 3019.3598s
	iters: 400, epoch: 1 | loss: 0.3006770
	speed: 0.0677s/iter; left time: 3149.0321s
Epoch: 1 cost time: 31.826818704605103
Epoch: 1, Steps: 469 | Train Loss: 0.592 Vali Loss: 0.283 Vali Acc: 0.924 Test Loss: 0.283 Test Acc: 0.924
Validation loss decreased (inf --> -0.923668).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1310996
	speed: 0.2997s/iter; left time: 13887.6901s
	iters: 200, epoch: 2 | loss: 0.2223826
	speed: 0.0656s/iter; left time: 3030.6743s
	iters: 300, epoch: 2 | loss: 0.0864121
	speed: 0.0660s/iter; left time: 3044.1477s
	iters: 400, epoch: 2 | loss: 0.0821370
	speed: 0.0685s/iter; left time: 3152.9294s
Epoch: 2 cost time: 30.709153175354004
Epoch: 2, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
Validation loss decreased (-0.923668 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0248256
	speed: 0.2904s/iter; left time: 13318.0680s
	iters: 200, epoch: 3 | loss: 0.0802938
	speed: 0.0416s/iter; left time: 1904.7082s
	iters: 300, epoch: 3 | loss: 0.0610730
	speed: 0.0473s/iter; left time: 2158.0065s
	iters: 400, epoch: 3 | loss: 0.0112158
	speed: 0.0602s/iter; left time: 2741.9289s
Epoch: 3 cost time: 24.03149151802063
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0057132
	speed: 0.3076s/iter; left time: 13963.4160s
	iters: 200, epoch: 4 | loss: 0.0546801
	speed: 0.0643s/iter; left time: 2912.9721s
	iters: 300, epoch: 4 | loss: 0.0534286
	speed: 0.0657s/iter; left time: 2970.5697s
	iters: 400, epoch: 4 | loss: 0.0038372
	speed: 0.0647s/iter; left time: 2918.5152s
Epoch: 4 cost time: 30.833961725234985
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0126125
	speed: 0.2479s/iter; left time: 11136.6788s
	iters: 200, epoch: 5 | loss: 0.0049374
	speed: 0.0583s/iter; left time: 2612.9205s
	iters: 300, epoch: 5 | loss: 0.0012520
	speed: 0.0690s/iter; left time: 3088.2551s
	iters: 400, epoch: 5 | loss: 0.0920095
	speed: 0.0721s/iter; left time: 3219.5961s
Epoch: 5 cost time: 29.217284679412842
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.959118 --> -0.967695).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035485
	speed: 0.3193s/iter; left time: 14192.6966s
	iters: 200, epoch: 6 | loss: 0.0457324
	speed: 0.0731s/iter; left time: 3240.4968s
	iters: 300, epoch: 6 | loss: 0.0515861
	speed: 0.0698s/iter; left time: 3088.7927s
	iters: 400, epoch: 6 | loss: 0.0603025
	speed: 0.0648s/iter; left time: 2862.0701s
Epoch: 6 cost time: 32.52468776702881
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967695 --> -0.968266).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0030581
	speed: 0.3175s/iter; left time: 13964.8899s
	iters: 200, epoch: 7 | loss: 0.0985583
	speed: 0.0415s/iter; left time: 1819.4532s
	iters: 300, epoch: 7 | loss: 0.0011464
	speed: 0.0420s/iter; left time: 1840.9243s
	iters: 400, epoch: 7 | loss: 0.0072414
	speed: 0.0605s/iter; left time: 2641.0702s
Epoch: 7 cost time: 24.29557704925537
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0214767
	speed: 0.3258s/iter; left time: 14179.8438s
	iters: 200, epoch: 8 | loss: 0.0773084
	speed: 0.0631s/iter; left time: 2741.2780s
	iters: 300, epoch: 8 | loss: 0.1251370
	speed: 0.0621s/iter; left time: 2689.5776s
	iters: 400, epoch: 8 | loss: 0.1202818
	speed: 0.0692s/iter; left time: 2992.6584s
Epoch: 8 cost time: 30.682738065719604
Epoch: 8, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0310413
	speed: 0.2480s/iter; left time: 10675.2226s
	iters: 200, epoch: 9 | loss: 0.0075298
	speed: 0.0629s/iter; left time: 2702.6486s
	iters: 300, epoch: 9 | loss: 0.0496030
	speed: 0.0666s/iter; left time: 2855.2250s
	iters: 400, epoch: 9 | loss: 0.0547266
	speed: 0.0636s/iter; left time: 2718.9125s
Epoch: 9 cost time: 28.14278745651245
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0473645
	speed: 0.3199s/iter; left time: 13623.3065s
	iters: 200, epoch: 10 | loss: 0.0010224
	speed: 0.0721s/iter; left time: 3062.7355s
	iters: 300, epoch: 10 | loss: 0.0091277
	speed: 0.0671s/iter; left time: 2843.1250s
	iters: 400, epoch: 10 | loss: 0.0034341
	speed: 0.0638s/iter; left time: 2697.1813s
Epoch: 10 cost time: 32.22699785232544
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.968266 --> -0.975699).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0053150
	speed: 0.3192s/iter; left time: 13443.7702s
	iters: 200, epoch: 11 | loss: 0.0357483
	speed: 0.0397s/iter; left time: 1668.6402s
	iters: 300, epoch: 11 | loss: 0.0010636
	speed: 0.0396s/iter; left time: 1658.0281s
	iters: 400, epoch: 11 | loss: 0.0302327
	speed: 0.0616s/iter; left time: 2573.8468s
Epoch: 11 cost time: 24.152876615524292
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0028824
	speed: 0.2949s/iter; left time: 12279.4220s
	iters: 200, epoch: 12 | loss: 0.0017752
	speed: 0.0619s/iter; left time: 2569.4928s
	iters: 300, epoch: 12 | loss: 0.0131740
	speed: 0.0594s/iter; left time: 2459.6993s
	iters: 400, epoch: 12 | loss: 0.0034489
	speed: 0.0639s/iter; left time: 2640.5768s
Epoch: 12 cost time: 28.69999051094055
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979416).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0006892
	speed: 0.2868s/iter; left time: 11807.0684s
	iters: 200, epoch: 13 | loss: 0.0006512
	speed: 0.0671s/iter; left time: 2754.0800s
	iters: 300, epoch: 13 | loss: 0.0013578
	speed: 0.0520s/iter; left time: 2130.7096s
	iters: 400, epoch: 13 | loss: 0.0211298
	speed: 0.0388s/iter; left time: 1585.6986s
Epoch: 13 cost time: 24.909698963165283
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0011849
	speed: 0.2554s/iter; left time: 10394.0831s
	iters: 200, epoch: 14 | loss: 0.0790541
	speed: 0.0665s/iter; left time: 2699.1287s
	iters: 300, epoch: 14 | loss: 0.0051370
	speed: 0.0699s/iter; left time: 2830.2580s
	iters: 400, epoch: 14 | loss: 0.0001117
	speed: 0.0701s/iter; left time: 2833.1287s
Epoch: 14 cost time: 32.54795289039612
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0010003
	speed: 0.3319s/iter; left time: 13355.4802s
	iters: 200, epoch: 15 | loss: 0.0003628
	speed: 0.0498s/iter; left time: 1997.4879s
	iters: 300, epoch: 15 | loss: 0.0042467
	speed: 0.0405s/iter; left time: 1620.6154s
	iters: 400, epoch: 15 | loss: 0.0077785
	speed: 0.0400s/iter; left time: 1596.5409s
Epoch: 15 cost time: 24.724992275238037
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0270545
	speed: 0.3114s/iter; left time: 12384.6047s
	iters: 200, epoch: 16 | loss: 0.0167628
	speed: 0.0605s/iter; left time: 2400.5869s
	iters: 300, epoch: 16 | loss: 0.0122641
	speed: 0.0598s/iter; left time: 2366.9220s
	iters: 400, epoch: 16 | loss: 0.2562730
	speed: 0.0607s/iter; left time: 2395.6399s
Epoch: 16 cost time: 29.32198452949524
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0134845
	speed: 0.2730s/iter; left time: 10727.9661s
	iters: 200, epoch: 17 | loss: 0.0006067
	speed: 0.0397s/iter; left time: 1554.4432s
	iters: 300, epoch: 17 | loss: 0.3443268
	speed: 0.0414s/iter; left time: 1620.0375s
	iters: 400, epoch: 17 | loss: 0.0000444
	speed: 0.0680s/iter; left time: 2651.7540s
Epoch: 17 cost time: 23.98181676864624
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0020924
	speed: 0.3042s/iter; left time: 11813.3520s
	iters: 200, epoch: 18 | loss: 0.0000715
	speed: 0.0691s/iter; left time: 2674.7627s
	iters: 300, epoch: 18 | loss: 0.0015537
	speed: 0.0663s/iter; left time: 2559.9298s
	iters: 400, epoch: 18 | loss: 0.0012704
	speed: 0.0592s/iter; left time: 2279.5387s
Epoch: 18 cost time: 30.662596940994263
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0130372
	speed: 0.3105s/iter; left time: 11911.8344s
	iters: 200, epoch: 19 | loss: 0.0146573
	speed: 0.0591s/iter; left time: 2261.0535s
	iters: 300, epoch: 19 | loss: 0.0031479
	speed: 0.0667s/iter; left time: 2546.7744s
	iters: 400, epoch: 19 | loss: 0.8093972
	speed: 0.0542s/iter; left time: 2064.1728s
Epoch: 19 cost time: 27.62185025215149
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0149107
	speed: 0.2489s/iter; left time: 9431.8852s
	iters: 200, epoch: 20 | loss: 0.0058489
	speed: 0.0584s/iter; left time: 2205.6295s
	iters: 300, epoch: 20 | loss: 0.0070321
	speed: 0.0573s/iter; left time: 2161.3162s
	iters: 400, epoch: 20 | loss: 0.1557861
	speed: 0.0668s/iter; left time: 2510.2633s
Epoch: 20 cost time: 29.375749588012695
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005949
	speed: 0.3095s/iter; left time: 11581.3027s
	iters: 200, epoch: 21 | loss: 0.2468987
	speed: 0.0525s/iter; left time: 1958.1888s
	iters: 300, epoch: 21 | loss: 0.0005052
	speed: 0.0464s/iter; left time: 1728.5901s
	iters: 400, epoch: 21 | loss: 0.3497470
	speed: 0.0422s/iter; left time: 1566.0964s
Epoch: 21 cost time: 24.819053411483765
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0031885
	speed: 0.3128s/iter; left time: 11560.2791s
	iters: 200, epoch: 22 | loss: 0.0004367
	speed: 0.0688s/iter; left time: 2537.0817s
	iters: 300, epoch: 22 | loss: 0.0002533
	speed: 0.0658s/iter; left time: 2416.5515s
	iters: 400, epoch: 22 | loss: 0.0315523
	speed: 0.0663s/iter; left time: 2428.6605s
Epoch: 22 cost time: 31.993135929107666
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 342330
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9325457
	speed: 0.0759s/iter; left time: 3552.5430s
	iters: 200, epoch: 1 | loss: 0.4417441
	speed: 0.0560s/iter; left time: 2613.2069s
	iters: 300, epoch: 1 | loss: 0.0981702
	speed: 0.0550s/iter; left time: 2563.0502s
	iters: 400, epoch: 1 | loss: 0.1663366
	speed: 0.0523s/iter; left time: 2430.1810s
Epoch: 1 cost time: 27.09161138534546
Epoch: 1, Steps: 469 | Train Loss: 0.577 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (inf --> -0.943680).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0762172
	speed: 0.2890s/iter; left time: 13391.3894s
	iters: 200, epoch: 2 | loss: 0.1970855
	speed: 0.0587s/iter; left time: 2715.7697s
	iters: 300, epoch: 2 | loss: 0.0494184
	speed: 0.0549s/iter; left time: 2534.2130s
	iters: 400, epoch: 2 | loss: 0.0855406
	speed: 0.0604s/iter; left time: 2780.7965s
Epoch: 2 cost time: 28.111308813095093
Epoch: 2, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.943680 --> -0.968838).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0066168
	speed: 0.2700s/iter; left time: 12383.4752s
	iters: 200, epoch: 3 | loss: 0.0715399
	speed: 0.0413s/iter; left time: 1889.7182s
	iters: 300, epoch: 3 | loss: 0.0116073
	speed: 0.0560s/iter; left time: 2557.9649s
	iters: 400, epoch: 3 | loss: 0.0105621
	speed: 0.0555s/iter; left time: 2528.9248s
Epoch: 3 cost time: 23.70439648628235
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0455596
	speed: 0.2763s/iter; left time: 12543.7334s
	iters: 200, epoch: 4 | loss: 0.0844955
	speed: 0.0561s/iter; left time: 2542.1033s
	iters: 300, epoch: 4 | loss: 0.0096533
	speed: 0.0498s/iter; left time: 2249.8842s
	iters: 400, epoch: 4 | loss: 0.0193216
	speed: 0.0527s/iter; left time: 2378.1868s
Epoch: 4 cost time: 25.406440496444702
Epoch: 4, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.970839).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032663
	speed: 0.2678s/iter; left time: 12032.4351s
	iters: 200, epoch: 5 | loss: 0.0038936
	speed: 0.0426s/iter; left time: 1909.4191s
	iters: 300, epoch: 5 | loss: 0.0029592
	speed: 0.0398s/iter; left time: 1781.1314s
	iters: 400, epoch: 5 | loss: 0.1551080
	speed: 0.0474s/iter; left time: 2113.3512s
Epoch: 5 cost time: 21.71108317375183
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.970839 --> -0.970839).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0117956
	speed: 0.2860s/iter; left time: 12713.9738s
	iters: 200, epoch: 6 | loss: 0.0196375
	speed: 0.0574s/iter; left time: 2546.1195s
	iters: 300, epoch: 6 | loss: 0.0627799
	speed: 0.0547s/iter; left time: 2420.6582s
	iters: 400, epoch: 6 | loss: 0.0208295
	speed: 0.0585s/iter; left time: 2581.1407s
Epoch: 6 cost time: 27.53604793548584
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.970839 --> -0.975699).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0477269
	speed: 0.2827s/iter; left time: 12434.2260s
	iters: 200, epoch: 7 | loss: 0.0279659
	speed: 0.0441s/iter; left time: 1936.2045s
	iters: 300, epoch: 7 | loss: 0.0028130
	speed: 0.0427s/iter; left time: 1870.2373s
	iters: 400, epoch: 7 | loss: 0.0780754
	speed: 0.0554s/iter; left time: 2420.6536s
Epoch: 7 cost time: 24.107166528701782
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0018303
	speed: 0.3120s/iter; left time: 13578.4431s
	iters: 200, epoch: 8 | loss: 0.3505589
	speed: 0.0623s/iter; left time: 2706.1604s
	iters: 300, epoch: 8 | loss: 0.0161362
	speed: 0.0599s/iter; left time: 2596.5018s
	iters: 400, epoch: 8 | loss: 0.0040537
	speed: 0.0609s/iter; left time: 2631.5685s
Epoch: 8 cost time: 29.216171741485596
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0070925
	speed: 0.3146s/iter; left time: 13542.4063s
	iters: 200, epoch: 9 | loss: 0.0004005
	speed: 0.0407s/iter; left time: 1747.9426s
	iters: 300, epoch: 9 | loss: 0.0023004
	speed: 0.0406s/iter; left time: 1738.4829s
	iters: 400, epoch: 9 | loss: 0.1148064
	speed: 0.0489s/iter; left time: 2090.1974s
Epoch: 9 cost time: 22.928248167037964
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1254172
	speed: 0.3080s/iter; left time: 13112.8177s
	iters: 200, epoch: 10 | loss: 0.0005646
	speed: 0.0583s/iter; left time: 2474.6147s
	iters: 300, epoch: 10 | loss: 0.0095276
	speed: 0.0632s/iter; left time: 2678.2922s
	iters: 400, epoch: 10 | loss: 0.0017680
	speed: 0.0631s/iter; left time: 2669.1936s
Epoch: 10 cost time: 28.507176876068115
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0025137
	speed: 0.3033s/iter; left time: 12773.1590s
	iters: 200, epoch: 11 | loss: 0.0012484
	speed: 0.0595s/iter; left time: 2499.2223s
	iters: 300, epoch: 11 | loss: 0.0082384
	speed: 0.0596s/iter; left time: 2496.7301s
	iters: 400, epoch: 11 | loss: 0.0090248
	speed: 0.0582s/iter; left time: 2431.6939s
Epoch: 11 cost time: 27.978739023208618
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0003145
	speed: 0.2979s/iter; left time: 12403.8133s
	iters: 200, epoch: 12 | loss: 0.0002586
	speed: 0.0599s/iter; left time: 2488.8842s
	iters: 300, epoch: 12 | loss: 0.0159181
	speed: 0.0574s/iter; left time: 2379.3241s
	iters: 400, epoch: 12 | loss: 0.0009355
	speed: 0.0536s/iter; left time: 2217.7519s
Epoch: 12 cost time: 27.679314613342285
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0004038
	speed: 0.2370s/iter; left time: 9759.2218s
	iters: 200, epoch: 13 | loss: 0.0007804
	speed: 0.0576s/iter; left time: 2366.5637s
	iters: 300, epoch: 13 | loss: 0.0041536
	speed: 0.0592s/iter; left time: 2425.9387s
	iters: 400, epoch: 13 | loss: 0.0007116
	speed: 0.0604s/iter; left time: 2469.4861s
Epoch: 13 cost time: 26.81163740158081
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0030048
	speed: 0.3079s/iter; left time: 12532.0763s
	iters: 200, epoch: 14 | loss: 0.0079921
	speed: 0.0598s/iter; left time: 2426.6836s
	iters: 300, epoch: 14 | loss: 0.0025805
	speed: 0.0623s/iter; left time: 2523.3232s
	iters: 400, epoch: 14 | loss: 0.0011653
	speed: 0.0627s/iter; left time: 2533.0961s
Epoch: 14 cost time: 29.222018718719482
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0380560
	speed: 0.2986s/iter; left time: 12012.1807s
	iters: 200, epoch: 15 | loss: 0.0019988
	speed: 0.0533s/iter; left time: 2139.6491s
	iters: 300, epoch: 15 | loss: 0.0000933
	speed: 0.0536s/iter; left time: 2147.4618s
	iters: 400, epoch: 15 | loss: 0.0025599
	speed: 0.0407s/iter; left time: 1624.0842s
Epoch: 15 cost time: 23.015284538269043
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0010518
	speed: 0.2333s/iter; left time: 9278.7194s
	iters: 200, epoch: 16 | loss: 0.0001782
	speed: 0.0531s/iter; left time: 2105.1075s
	iters: 300, epoch: 16 | loss: 0.0004868
	speed: 0.0529s/iter; left time: 2093.9119s
	iters: 400, epoch: 16 | loss: 0.4532947
	speed: 0.0556s/iter; left time: 2194.7440s
Epoch: 16 cost time: 25.796674251556396
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9757004002287021
model parameter : 342330
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6683617
	speed: 0.0849s/iter; left time: 3975.1931s
	iters: 200, epoch: 1 | loss: 0.5494238
	speed: 0.0637s/iter; left time: 2973.0019s
	iters: 300, epoch: 1 | loss: 0.4725602
	speed: 0.0659s/iter; left time: 3070.0544s
	iters: 400, epoch: 1 | loss: 0.1733969
	speed: 0.0714s/iter; left time: 3319.2110s
Epoch: 1 cost time: 33.606844425201416
Epoch: 1, Steps: 469 | Train Loss: 0.609 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
Validation loss decreased (inf --> -0.911089).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2051020
	speed: 0.3162s/iter; left time: 14652.1085s
	iters: 200, epoch: 2 | loss: 0.1701167
	speed: 0.0427s/iter; left time: 1973.3753s
	iters: 300, epoch: 2 | loss: 0.0452893
	speed: 0.0410s/iter; left time: 1890.1959s
	iters: 400, epoch: 2 | loss: 0.0806335
	speed: 0.0598s/iter; left time: 2751.5805s
Epoch: 2 cost time: 24.483595609664917
Epoch: 2, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
Validation loss decreased (-0.911089 --> -0.955401).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1792407
	speed: 0.3114s/iter; left time: 14279.9301s
	iters: 200, epoch: 3 | loss: 0.0048543
	speed: 0.0629s/iter; left time: 2877.7355s
	iters: 300, epoch: 3 | loss: 0.0868886
	speed: 0.0587s/iter; left time: 2680.4797s
	iters: 400, epoch: 3 | loss: 0.0284515
	speed: 0.0636s/iter; left time: 2897.9443s
Epoch: 3 cost time: 29.530189037322998
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.955401 --> -0.960261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0149094
	speed: 0.2797s/iter; left time: 12694.7321s
	iters: 200, epoch: 4 | loss: 0.0901784
	speed: 0.0398s/iter; left time: 1802.8381s
	iters: 300, epoch: 4 | loss: 0.0060653
	speed: 0.0500s/iter; left time: 2258.2477s
	iters: 400, epoch: 4 | loss: 0.0089331
	speed: 0.0619s/iter; left time: 2790.1447s
Epoch: 4 cost time: 23.79025673866272
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
Validation loss decreased (-0.960261 --> -0.965693).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0042950
	speed: 0.2817s/iter; left time: 12654.7711s
	iters: 200, epoch: 5 | loss: 0.0655449
	speed: 0.0611s/iter; left time: 2738.8755s
	iters: 300, epoch: 5 | loss: 0.0757250
	speed: 0.0612s/iter; left time: 2735.0048s
	iters: 400, epoch: 5 | loss: 0.2105213
	speed: 0.0608s/iter; left time: 2712.1133s
Epoch: 5 cost time: 28.958972930908203
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
Validation loss decreased (-0.965693 --> -0.971697).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1305523
	speed: 0.2300s/iter; left time: 10223.3314s
	iters: 200, epoch: 6 | loss: 0.0359001
	speed: 0.0511s/iter; left time: 2266.9958s
	iters: 300, epoch: 6 | loss: 0.0195240
	speed: 0.0527s/iter; left time: 2332.5137s
	iters: 400, epoch: 6 | loss: 0.0340211
	speed: 0.0535s/iter; left time: 2361.6840s
Epoch: 6 cost time: 23.580328464508057
Epoch: 6, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2094096
	speed: 0.2736s/iter; left time: 12034.2924s
	iters: 200, epoch: 7 | loss: 0.2856416
	speed: 0.0553s/iter; left time: 2426.6371s
	iters: 300, epoch: 7 | loss: 0.0105471
	speed: 0.0530s/iter; left time: 2321.9661s
	iters: 400, epoch: 7 | loss: 0.0037312
	speed: 0.0432s/iter; left time: 1888.7982s
Epoch: 7 cost time: 23.808818340301514
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0097307
	speed: 0.2503s/iter; left time: 10893.7687s
	iters: 200, epoch: 8 | loss: 0.0019092
	speed: 0.0597s/iter; left time: 2592.4518s
	iters: 300, epoch: 8 | loss: 0.0460157
	speed: 0.0627s/iter; left time: 2717.6657s
	iters: 400, epoch: 8 | loss: 0.0074492
	speed: 0.0584s/iter; left time: 2522.3494s
Epoch: 8 cost time: 28.604133129119873
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0284000
	speed: 0.2397s/iter; left time: 10319.5517s
	iters: 200, epoch: 9 | loss: 0.0030922
	speed: 0.0584s/iter; left time: 2506.3710s
	iters: 300, epoch: 9 | loss: 0.0040493
	speed: 0.0618s/iter; left time: 2646.3775s
	iters: 400, epoch: 9 | loss: 0.0010137
	speed: 0.0586s/iter; left time: 2503.7166s
Epoch: 9 cost time: 27.077782154083252
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.976843).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0016302
	speed: 0.2796s/iter; left time: 11905.9945s
	iters: 200, epoch: 10 | loss: 0.4447823
	speed: 0.0521s/iter; left time: 2213.6385s
	iters: 300, epoch: 10 | loss: 0.0392020
	speed: 0.0569s/iter; left time: 2410.6438s
	iters: 400, epoch: 10 | loss: 0.0036855
	speed: 0.0578s/iter; left time: 2444.8449s
Epoch: 10 cost time: 26.22061038017273
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3878930
	speed: 0.2663s/iter; left time: 11215.4037s
	iters: 200, epoch: 11 | loss: 0.0052259
	speed: 0.0598s/iter; left time: 2513.0074s
	iters: 300, epoch: 11 | loss: 0.0087983
	speed: 0.0438s/iter; left time: 1833.7083s
	iters: 400, epoch: 11 | loss: 0.0011989
	speed: 0.0395s/iter; left time: 1650.1603s
Epoch: 11 cost time: 23.142844200134277
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0007671
	speed: 0.2470s/iter; left time: 10287.0330s
	iters: 200, epoch: 12 | loss: 0.0167725
	speed: 0.0540s/iter; left time: 2243.9387s
	iters: 300, epoch: 12 | loss: 0.0109627
	speed: 0.0514s/iter; left time: 2129.8189s
	iters: 400, epoch: 12 | loss: 0.0067244
	speed: 0.0544s/iter; left time: 2249.1778s
Epoch: 12 cost time: 25.932929039001465
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0096990
	speed: 0.2663s/iter; left time: 10963.3313s
	iters: 200, epoch: 13 | loss: 0.0126320
	speed: 0.0556s/iter; left time: 2283.6890s
	iters: 300, epoch: 13 | loss: 0.0026622
	speed: 0.0492s/iter; left time: 2016.5309s
	iters: 400, epoch: 13 | loss: 0.0272811
	speed: 0.0535s/iter; left time: 2188.6517s
Epoch: 13 cost time: 25.175671577453613
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0100094
	speed: 0.2603s/iter; left time: 10596.0468s
	iters: 200, epoch: 14 | loss: 0.0009775
	speed: 0.0493s/iter; left time: 2000.0818s
	iters: 300, epoch: 14 | loss: 0.1634166
	speed: 0.0534s/iter; left time: 2163.8592s
	iters: 400, epoch: 14 | loss: 0.0073082
	speed: 0.0490s/iter; left time: 1979.1486s
Epoch: 14 cost time: 24.413748502731323
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0007001
	speed: 0.2241s/iter; left time: 9014.6693s
	iters: 200, epoch: 15 | loss: 0.0352513
	speed: 0.0572s/iter; left time: 2295.4114s
	iters: 300, epoch: 15 | loss: 0.0023861
	speed: 0.0591s/iter; left time: 2364.0695s
	iters: 400, epoch: 15 | loss: 0.0003154
	speed: 0.0607s/iter; left time: 2424.8497s
Epoch: 15 cost time: 27.37383532524109
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978844).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0022719
	speed: 0.2807s/iter; left time: 11163.2543s
	iters: 200, epoch: 16 | loss: 0.0026349
	speed: 0.0550s/iter; left time: 2180.3411s
	iters: 300, epoch: 16 | loss: 0.0014229
	speed: 0.0618s/iter; left time: 2446.1830s
	iters: 400, epoch: 16 | loss: 0.0298288
	speed: 0.0629s/iter; left time: 2481.8006s
Epoch: 16 cost time: 27.57900905609131
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0008802
	speed: 0.2181s/iter; left time: 8571.6787s
	iters: 200, epoch: 17 | loss: 0.0018340
	speed: 0.0599s/iter; left time: 2348.7933s
	iters: 300, epoch: 17 | loss: 0.0018604
	speed: 0.0558s/iter; left time: 2183.1268s
	iters: 400, epoch: 17 | loss: 0.0476571
	speed: 0.0540s/iter; left time: 2105.9135s
Epoch: 17 cost time: 26.544838666915894
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1757772
	speed: 0.2797s/iter; left time: 10860.5057s
	iters: 200, epoch: 18 | loss: 0.0415642
	speed: 0.0520s/iter; left time: 2014.0685s
	iters: 300, epoch: 18 | loss: 0.0005109
	speed: 0.0544s/iter; left time: 2100.4267s
	iters: 400, epoch: 18 | loss: 0.0121763
	speed: 0.0432s/iter; left time: 1664.0386s
Epoch: 18 cost time: 23.595320224761963
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.980273).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0156287
	speed: 0.2452s/iter; left time: 9405.1766s
	iters: 200, epoch: 19 | loss: 0.0015288
	speed: 0.0590s/iter; left time: 2255.6082s
	iters: 300, epoch: 19 | loss: 0.0934685
	speed: 0.0560s/iter; left time: 2138.5153s
	iters: 400, epoch: 19 | loss: 0.0014123
	speed: 0.0657s/iter; left time: 2501.6772s
Epoch: 19 cost time: 28.741772174835205
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001132
	speed: 0.2931s/iter; left time: 11104.0477s
	iters: 200, epoch: 20 | loss: 0.0007483
	speed: 0.0628s/iter; left time: 2372.6447s
	iters: 300, epoch: 20 | loss: 0.0030939
	speed: 0.0643s/iter; left time: 2424.5537s
	iters: 400, epoch: 20 | loss: 0.2506082
	speed: 0.0591s/iter; left time: 2220.2314s
Epoch: 20 cost time: 27.917413234710693
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0007532
	speed: 0.2259s/iter; left time: 8454.4627s
	iters: 200, epoch: 21 | loss: 0.0002271
	speed: 0.0534s/iter; left time: 1992.5562s
	iters: 300, epoch: 21 | loss: 0.0047464
	speed: 0.0531s/iter; left time: 1976.3705s
	iters: 400, epoch: 21 | loss: 0.0135713
	speed: 0.0484s/iter; left time: 1797.8248s
Epoch: 21 cost time: 25.586997985839844
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0002323
	speed: 0.2490s/iter; left time: 9200.8478s
	iters: 200, epoch: 22 | loss: 0.0096387
	speed: 0.0522s/iter; left time: 1924.5015s
	iters: 300, epoch: 22 | loss: 0.5147289
	speed: 0.0514s/iter; left time: 1889.6740s
	iters: 400, epoch: 22 | loss: 0.0251993
	speed: 0.0528s/iter; left time: 1934.5588s
Epoch: 22 cost time: 24.88273310661316
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.980273 --> -0.983418).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0050260
	speed: 0.2620s/iter; left time: 9558.4147s
	iters: 200, epoch: 23 | loss: 0.0025101
	speed: 0.0531s/iter; left time: 1931.7712s
	iters: 300, epoch: 23 | loss: 0.0000818
	speed: 0.0590s/iter; left time: 2142.1476s
	iters: 400, epoch: 23 | loss: 0.2791200
	speed: 0.0560s/iter; left time: 2026.8487s
Epoch: 23 cost time: 25.93097972869873
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0098584
	speed: 0.2105s/iter; left time: 7580.0832s
	iters: 200, epoch: 24 | loss: 0.0071557
	speed: 0.0564s/iter; left time: 2024.5054s
	iters: 300, epoch: 24 | loss: 0.0000560
	speed: 0.0499s/iter; left time: 1785.7053s
	iters: 400, epoch: 24 | loss: 0.0001031
	speed: 0.0475s/iter; left time: 1698.0724s
Epoch: 24 cost time: 23.272008657455444
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0299198
	speed: 0.2606s/iter; left time: 9263.6813s
	iters: 200, epoch: 25 | loss: 0.0000677
	speed: 0.0510s/iter; left time: 1807.6974s
	iters: 300, epoch: 25 | loss: 0.2682147
	speed: 0.0463s/iter; left time: 1637.8202s
	iters: 400, epoch: 25 | loss: 0.0411338
	speed: 0.0422s/iter; left time: 1488.1392s
Epoch: 25 cost time: 22.499786615371704
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0005409
	speed: 0.2575s/iter; left time: 9031.9716s
	iters: 200, epoch: 26 | loss: 0.1414865
	speed: 0.0581s/iter; left time: 2033.2239s
	iters: 300, epoch: 26 | loss: 0.0848364
	speed: 0.0593s/iter; left time: 2067.3211s
	iters: 400, epoch: 26 | loss: 0.1592867
	speed: 0.0591s/iter; left time: 2055.8675s
Epoch: 26 cost time: 27.29261541366577
Epoch: 26, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0262288
	speed: 0.2212s/iter; left time: 7656.1657s
	iters: 200, epoch: 27 | loss: 0.0000205
	speed: 0.0523s/iter; left time: 1804.6634s
	iters: 300, epoch: 27 | loss: 0.0554745
	speed: 0.0411s/iter; left time: 1415.7760s
	iters: 400, epoch: 27 | loss: 0.0026488
	speed: 0.0394s/iter; left time: 1352.6616s
Epoch: 27 cost time: 22.175974369049072
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0008630
	speed: 0.2704s/iter; left time: 9232.3185s
	iters: 200, epoch: 28 | loss: 0.0006179
	speed: 0.0530s/iter; left time: 1803.8530s
	iters: 300, epoch: 28 | loss: 0.0000199
	speed: 0.0560s/iter; left time: 1900.1151s
	iters: 400, epoch: 28 | loss: 0.0029075
	speed: 0.0561s/iter; left time: 1897.1560s
Epoch: 28 cost time: 26.887378692626953
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0026327
	speed: 0.2771s/iter; left time: 9331.2760s
	iters: 200, epoch: 29 | loss: 0.0048740
	speed: 0.0572s/iter; left time: 1920.8936s
	iters: 300, epoch: 29 | loss: 0.0097844
	speed: 0.0544s/iter; left time: 1822.2210s
	iters: 400, epoch: 29 | loss: 0.0058080
	speed: 0.0561s/iter; left time: 1873.6075s
Epoch: 29 cost time: 26.29307770729065
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0092153
	speed: 0.2075s/iter; left time: 6887.8386s
	iters: 200, epoch: 30 | loss: 0.0003592
	speed: 0.0561s/iter; left time: 1856.6133s
	iters: 300, epoch: 30 | loss: 0.0022509
	speed: 0.0588s/iter; left time: 1941.9702s
	iters: 400, epoch: 30 | loss: 0.0077517
	speed: 0.0534s/iter; left time: 1756.1248s
Epoch: 30 cost time: 25.915059804916382
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0001579
	speed: 0.2709s/iter; left time: 8868.3523s
	iters: 200, epoch: 31 | loss: 0.0032034
	speed: 0.0562s/iter; left time: 1832.8092s
	iters: 300, epoch: 31 | loss: 0.0232947
	speed: 0.0400s/iter; left time: 1300.1406s
	iters: 400, epoch: 31 | loss: 0.0026938
	speed: 0.0395s/iter; left time: 1282.2525s
Epoch: 31 cost time: 23.048898696899414
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0000058
	speed: 0.2654s/iter; left time: 8561.6781s
	iters: 200, epoch: 32 | loss: 0.0000349
	speed: 0.0508s/iter; left time: 1634.1921s
	iters: 300, epoch: 32 | loss: 0.0084916
	speed: 0.0502s/iter; left time: 1608.5878s
	iters: 400, epoch: 32 | loss: 0.0203597
	speed: 0.0539s/iter; left time: 1723.2645s
Epoch: 32 cost time: 24.994219541549683
Epoch: 32, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 211258
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6833398
	speed: 0.0772s/iter; left time: 3615.3139s
	iters: 200, epoch: 1 | loss: 0.5042530
	speed: 0.0534s/iter; left time: 2493.2527s
	iters: 300, epoch: 1 | loss: 0.3755279
	speed: 0.0518s/iter; left time: 2414.0560s
	iters: 400, epoch: 1 | loss: 0.1122169
	speed: 0.0562s/iter; left time: 2614.8631s
Epoch: 1 cost time: 28.005485773086548
Epoch: 1, Steps: 469 | Train Loss: 0.592 Vali Loss: 0.284 Vali Acc: 0.927 Test Loss: 0.284 Test Acc: 0.927
Validation loss decreased (inf --> -0.926527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1353867
	speed: 0.2702s/iter; left time: 12519.0709s
	iters: 200, epoch: 2 | loss: 0.1203134
	speed: 0.0606s/iter; left time: 2800.2636s
	iters: 300, epoch: 2 | loss: 0.0875806
	speed: 0.0522s/iter; left time: 2408.7831s
	iters: 400, epoch: 2 | loss: 0.0478877
	speed: 0.0418s/iter; left time: 1922.7426s
Epoch: 2 cost time: 23.981422662734985
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
Validation loss decreased (-0.926527 --> -0.960833).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1794480
	speed: 0.2532s/iter; left time: 11613.8658s
	iters: 200, epoch: 3 | loss: 0.0049240
	speed: 0.0648s/iter; left time: 2964.5917s
	iters: 300, epoch: 3 | loss: 0.1472468
	speed: 0.0631s/iter; left time: 2883.0422s
	iters: 400, epoch: 3 | loss: 0.0341433
	speed: 0.0564s/iter; left time: 2570.0842s
Epoch: 3 cost time: 28.583898067474365
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.960833 --> -0.968838).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0134243
	speed: 0.2636s/iter; left time: 11965.3976s
	iters: 200, epoch: 4 | loss: 0.0933030
	speed: 0.0386s/iter; left time: 1749.9213s
	iters: 300, epoch: 4 | loss: 0.0202706
	speed: 0.0479s/iter; left time: 2166.6233s
	iters: 400, epoch: 4 | loss: 0.0056367
	speed: 0.0567s/iter; left time: 2555.9457s
Epoch: 4 cost time: 22.839571714401245
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0100427
	speed: 0.2670s/iter; left time: 11995.1914s
	iters: 200, epoch: 5 | loss: 0.0182433
	speed: 0.0493s/iter; left time: 2210.5582s
	iters: 300, epoch: 5 | loss: 0.0873512
	speed: 0.0529s/iter; left time: 2365.7925s
	iters: 400, epoch: 5 | loss: 0.1904079
	speed: 0.0535s/iter; left time: 2388.3902s
Epoch: 5 cost time: 24.55899739265442
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.971697).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0888748
	speed: 0.2130s/iter; left time: 9469.4761s
	iters: 200, epoch: 6 | loss: 0.0192357
	speed: 0.0523s/iter; left time: 2320.2305s
	iters: 300, epoch: 6 | loss: 0.0279351
	speed: 0.0525s/iter; left time: 2323.6426s
	iters: 400, epoch: 6 | loss: 0.0201295
	speed: 0.0485s/iter; left time: 2141.1135s
Epoch: 6 cost time: 24.250701904296875
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0564205
	speed: 0.2550s/iter; left time: 11216.7983s
	iters: 200, epoch: 7 | loss: 0.2890031
	speed: 0.0478s/iter; left time: 2095.6841s
	iters: 300, epoch: 7 | loss: 0.0066315
	speed: 0.0513s/iter; left time: 2248.1337s
	iters: 400, epoch: 7 | loss: 0.0007719
	speed: 0.0433s/iter; left time: 1889.6074s
Epoch: 7 cost time: 22.53491520881653
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.971697 --> -0.980274).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0123960
	speed: 0.2306s/iter; left time: 10034.5428s
	iters: 200, epoch: 8 | loss: 0.0002244
	speed: 0.0530s/iter; left time: 2300.2645s
	iters: 300, epoch: 8 | loss: 0.1021025
	speed: 0.0585s/iter; left time: 2536.1641s
	iters: 400, epoch: 8 | loss: 0.0038943
	speed: 0.0586s/iter; left time: 2534.5378s
Epoch: 8 cost time: 26.53423833847046
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1599027
	speed: 0.2646s/iter; left time: 11392.3709s
	iters: 200, epoch: 9 | loss: 0.0034324
	speed: 0.0439s/iter; left time: 1887.2195s
	iters: 300, epoch: 9 | loss: 0.0020144
	speed: 0.0406s/iter; left time: 1740.5654s
	iters: 400, epoch: 9 | loss: 0.0042494
	speed: 0.0440s/iter; left time: 1880.5170s
Epoch: 9 cost time: 22.355114459991455
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0004345
	speed: 0.2805s/iter; left time: 11944.1900s
	iters: 200, epoch: 10 | loss: 0.4925542
	speed: 0.0597s/iter; left time: 2535.6611s
	iters: 300, epoch: 10 | loss: 0.0012245
	speed: 0.0568s/iter; left time: 2405.5655s
	iters: 400, epoch: 10 | loss: 0.0033327
	speed: 0.0584s/iter; left time: 2467.5188s
Epoch: 10 cost time: 27.08438515663147
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0042619
	speed: 0.2215s/iter; left time: 9327.9609s
	iters: 200, epoch: 11 | loss: 0.0047383
	speed: 0.0510s/iter; left time: 2141.5186s
	iters: 300, epoch: 11 | loss: 0.0003342
	speed: 0.0518s/iter; left time: 2172.0287s
	iters: 400, epoch: 11 | loss: 0.0007824
	speed: 0.0542s/iter; left time: 2265.3193s
Epoch: 11 cost time: 25.355520009994507
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0038220
	speed: 0.2328s/iter; left time: 9695.1363s
	iters: 200, epoch: 12 | loss: 0.0050646
	speed: 0.0384s/iter; left time: 1594.0631s
	iters: 300, epoch: 12 | loss: 0.0129698
	speed: 0.0459s/iter; left time: 1903.6160s
	iters: 400, epoch: 12 | loss: 0.1369030
	speed: 0.0478s/iter; left time: 1977.3541s
Epoch: 12 cost time: 20.633264780044556
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0017228
	speed: 0.2397s/iter; left time: 9869.5402s
	iters: 200, epoch: 13 | loss: 0.1745069
	speed: 0.0504s/iter; left time: 2071.4392s
	iters: 300, epoch: 13 | loss: 0.0027314
	speed: 0.0521s/iter; left time: 2132.8973s
	iters: 400, epoch: 13 | loss: 0.0150035
	speed: 0.0496s/iter; left time: 2027.2700s
Epoch: 13 cost time: 24.576452255249023
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0430170
	speed: 0.2277s/iter; left time: 9269.6548s
	iters: 200, epoch: 14 | loss: 0.0003306
	speed: 0.0562s/iter; left time: 2281.3185s
	iters: 300, epoch: 14 | loss: 0.1938642
	speed: 0.0590s/iter; left time: 2389.9840s
	iters: 400, epoch: 14 | loss: 0.0011533
	speed: 0.0571s/iter; left time: 2308.9014s
Epoch: 14 cost time: 25.902451515197754
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0021624
	speed: 0.2883s/iter; left time: 11598.9175s
	iters: 200, epoch: 15 | loss: 0.0142435
	speed: 0.0532s/iter; left time: 2134.8865s
	iters: 300, epoch: 15 | loss: 0.0005929
	speed: 0.0397s/iter; left time: 1588.9062s
	iters: 400, epoch: 15 | loss: 0.0010576
	speed: 0.0431s/iter; left time: 1720.8536s
Epoch: 15 cost time: 21.950042247772217
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0026652
	speed: 0.2480s/iter; left time: 9862.6293s
	iters: 200, epoch: 16 | loss: 0.0024638
	speed: 0.0533s/iter; left time: 2114.9006s
	iters: 300, epoch: 16 | loss: 0.0039125
	speed: 0.0551s/iter; left time: 2178.9098s
	iters: 400, epoch: 16 | loss: 0.0025781
	speed: 0.0491s/iter; left time: 1939.4498s
Epoch: 16 cost time: 24.968268394470215
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0220297
	speed: 0.2140s/iter; left time: 8410.6501s
	iters: 200, epoch: 17 | loss: 0.0015557
	speed: 0.0546s/iter; left time: 2139.8792s
	iters: 300, epoch: 17 | loss: 0.0101028
	speed: 0.0563s/iter; left time: 2200.0991s
	iters: 400, epoch: 17 | loss: 0.0958005
	speed: 0.0538s/iter; left time: 2097.1717s
Epoch: 17 cost time: 25.164395809173584
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 211258
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5877672
	speed: 0.0697s/iter; left time: 3263.4352s
	iters: 200, epoch: 1 | loss: 0.4680672
	speed: 0.0481s/iter; left time: 2247.1730s
	iters: 300, epoch: 1 | loss: 0.3282310
	speed: 0.0439s/iter; left time: 2047.9898s
	iters: 400, epoch: 1 | loss: 0.0476580
	speed: 0.0455s/iter; left time: 2116.7397s
Epoch: 1 cost time: 23.926229000091553
Epoch: 1, Steps: 469 | Train Loss: 0.569 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
Validation loss decreased (inf --> -0.929672).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1834658
	speed: 0.2283s/iter; left time: 10578.1810s
	iters: 200, epoch: 2 | loss: 0.0861370
	speed: 0.0398s/iter; left time: 1838.9221s
	iters: 300, epoch: 2 | loss: 0.0421473
	speed: 0.0358s/iter; left time: 1652.2345s
	iters: 400, epoch: 2 | loss: 0.1742876
	speed: 0.0369s/iter; left time: 1699.6893s
Epoch: 2 cost time: 19.079952716827393
Epoch: 2, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
Validation loss decreased (-0.929672 --> -0.957116).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1704246
	speed: 0.2354s/iter; left time: 10797.6176s
	iters: 200, epoch: 3 | loss: 0.0035822
	speed: 0.0508s/iter; left time: 2324.2850s
	iters: 300, epoch: 3 | loss: 0.1649274
	speed: 0.0479s/iter; left time: 2186.4014s
	iters: 400, epoch: 3 | loss: 0.0015442
	speed: 0.0528s/iter; left time: 2405.3631s
Epoch: 3 cost time: 23.815614700317383
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.957116 --> -0.969982).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0209764
	speed: 0.2190s/iter; left time: 9940.7537s
	iters: 200, epoch: 4 | loss: 0.0408013
	speed: 0.0506s/iter; left time: 2290.9053s
	iters: 300, epoch: 4 | loss: 0.1218592
	speed: 0.0507s/iter; left time: 2290.3643s
	iters: 400, epoch: 4 | loss: 0.0011423
	speed: 0.0520s/iter; left time: 2346.9172s
Epoch: 4 cost time: 24.441101789474487
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0076722
	speed: 0.2457s/iter; left time: 11038.4471s
	iters: 200, epoch: 5 | loss: 0.0170000
	speed: 0.0410s/iter; left time: 1839.2037s
	iters: 300, epoch: 5 | loss: 0.0150526
	speed: 0.0388s/iter; left time: 1735.5330s
	iters: 400, epoch: 5 | loss: 0.3152094
	speed: 0.0436s/iter; left time: 1944.4439s
Epoch: 5 cost time: 20.522331953048706
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.969982 --> -0.975127).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0237689
	speed: 0.2359s/iter; left time: 10484.9870s
	iters: 200, epoch: 6 | loss: 0.0100265
	speed: 0.0464s/iter; left time: 2059.0815s
	iters: 300, epoch: 6 | loss: 0.0006617
	speed: 0.0429s/iter; left time: 1900.4866s
	iters: 400, epoch: 6 | loss: 0.0022038
	speed: 0.0438s/iter; left time: 1933.4576s
Epoch: 6 cost time: 21.654027223587036
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2110214
	speed: 0.2306s/iter; left time: 10143.0976s
	iters: 200, epoch: 7 | loss: 0.4458360
	speed: 0.0363s/iter; left time: 1594.0634s
	iters: 300, epoch: 7 | loss: 0.0013982
	speed: 0.0364s/iter; left time: 1594.7937s
	iters: 400, epoch: 7 | loss: 0.0002776
	speed: 0.0394s/iter; left time: 1719.5986s
Epoch: 7 cost time: 19.464346170425415
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.975985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0268436
	speed: 0.2479s/iter; left time: 10786.3749s
	iters: 200, epoch: 8 | loss: 0.0003337
	speed: 0.0515s/iter; left time: 2235.9495s
	iters: 300, epoch: 8 | loss: 0.0102668
	speed: 0.0513s/iter; left time: 2223.7421s
	iters: 400, epoch: 8 | loss: 0.0016875
	speed: 0.0444s/iter; left time: 1917.9826s
Epoch: 8 cost time: 22.895480632781982
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0028757
	speed: 0.2279s/iter; left time: 9809.5983s
	iters: 200, epoch: 9 | loss: 0.0010751
	speed: 0.0549s/iter; left time: 2357.5435s
	iters: 300, epoch: 9 | loss: 0.0008747
	speed: 0.0494s/iter; left time: 2114.6783s
	iters: 400, epoch: 9 | loss: 0.0103693
	speed: 0.0513s/iter; left time: 2193.7998s
Epoch: 9 cost time: 24.53785490989685
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0184436
	speed: 0.2164s/iter; left time: 9216.0549s
	iters: 200, epoch: 10 | loss: 0.2056970
	speed: 0.0378s/iter; left time: 1604.2486s
	iters: 300, epoch: 10 | loss: 0.0048789
	speed: 0.0436s/iter; left time: 1847.6418s
	iters: 400, epoch: 10 | loss: 0.0001605
	speed: 0.0442s/iter; left time: 1870.4821s
Epoch: 10 cost time: 19.92675495147705
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.975985).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0062078
	speed: 0.2337s/iter; left time: 9840.7092s
	iters: 200, epoch: 11 | loss: 0.0010307
	speed: 0.0435s/iter; left time: 1825.6515s
	iters: 300, epoch: 11 | loss: 0.0013947
	speed: 0.0430s/iter; left time: 1801.9558s
	iters: 400, epoch: 11 | loss: 0.0000925
	speed: 0.0400s/iter; left time: 1673.3868s
Epoch: 11 cost time: 20.669963598251343
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.976271).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0007146
	speed: 0.2230s/iter; left time: 9286.9083s
	iters: 200, epoch: 12 | loss: 0.0009539
	speed: 0.0456s/iter; left time: 1894.0997s
	iters: 300, epoch: 12 | loss: 0.0004584
	speed: 0.0460s/iter; left time: 1907.3172s
	iters: 400, epoch: 12 | loss: 0.0010716
	speed: 0.0474s/iter; left time: 1960.0510s
Epoch: 12 cost time: 21.96812868118286
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2452271
	speed: 0.1989s/iter; left time: 8189.8466s
	iters: 200, epoch: 13 | loss: 0.1416026
	speed: 0.0470s/iter; left time: 1928.4297s
	iters: 300, epoch: 13 | loss: 0.0033649
	speed: 0.0478s/iter; left time: 1960.4572s
	iters: 400, epoch: 13 | loss: 0.0834839
	speed: 0.0487s/iter; left time: 1990.8611s
Epoch: 13 cost time: 22.963630437850952
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0005594
	speed: 0.2170s/iter; left time: 8833.6009s
	iters: 200, epoch: 14 | loss: 0.0175101
	speed: 0.0417s/iter; left time: 1693.2564s
	iters: 300, epoch: 14 | loss: 0.1505277
	speed: 0.0479s/iter; left time: 1941.9374s
	iters: 400, epoch: 14 | loss: 0.0076966
	speed: 0.0476s/iter; left time: 1924.8953s
Epoch: 14 cost time: 21.79999041557312
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0932132
	speed: 0.2340s/iter; left time: 9416.0977s
	iters: 200, epoch: 15 | loss: 0.1075909
	speed: 0.0447s/iter; left time: 1794.1623s
	iters: 300, epoch: 15 | loss: 0.0001830
	speed: 0.0491s/iter; left time: 1966.1417s
	iters: 400, epoch: 15 | loss: 0.0011419
	speed: 0.0528s/iter; left time: 2109.1064s
Epoch: 15 cost time: 23.329057693481445
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
Validation loss decreased (-0.976271 --> -0.980559).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0004369
	speed: 0.2100s/iter; left time: 8350.4215s
	iters: 200, epoch: 16 | loss: 0.0009165
	speed: 0.0459s/iter; left time: 1819.5315s
	iters: 300, epoch: 16 | loss: 0.0030784
	speed: 0.0482s/iter; left time: 1906.6684s
	iters: 400, epoch: 16 | loss: 0.1038448
	speed: 0.0469s/iter; left time: 1852.6308s
Epoch: 16 cost time: 21.83640146255493
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1380192
	speed: 0.2407s/iter; left time: 9457.8752s
	iters: 200, epoch: 17 | loss: 0.0007670
	speed: 0.0479s/iter; left time: 1879.4849s
	iters: 300, epoch: 17 | loss: 0.0028024
	speed: 0.0472s/iter; left time: 1845.5878s
	iters: 400, epoch: 17 | loss: 0.1409813
	speed: 0.0452s/iter; left time: 1762.1201s
Epoch: 17 cost time: 22.591240406036377
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.981417).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0051531
	speed: 0.2040s/iter; left time: 7920.0895s
	iters: 200, epoch: 18 | loss: 0.4141733
	speed: 0.0447s/iter; left time: 1732.6560s
	iters: 300, epoch: 18 | loss: 0.0000131
	speed: 0.0425s/iter; left time: 1642.2598s
	iters: 400, epoch: 18 | loss: 0.0611149
	speed: 0.0446s/iter; left time: 1719.4640s
Epoch: 18 cost time: 20.818207263946533
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0020689
	speed: 0.2259s/iter; left time: 8664.3622s
	iters: 200, epoch: 19 | loss: 0.0003190
	speed: 0.0463s/iter; left time: 1771.6199s
	iters: 300, epoch: 19 | loss: 0.0072271
	speed: 0.0499s/iter; left time: 1904.2818s
	iters: 400, epoch: 19 | loss: 0.0612274
	speed: 0.0517s/iter; left time: 1965.9580s
Epoch: 19 cost time: 23.144948959350586
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0005426
	speed: 0.2165s/iter; left time: 8202.0241s
	iters: 200, epoch: 20 | loss: 0.0001114
	speed: 0.0501s/iter; left time: 1893.9637s
	iters: 300, epoch: 20 | loss: 0.0034934
	speed: 0.0485s/iter; left time: 1826.7253s
	iters: 400, epoch: 20 | loss: 0.0003451
	speed: 0.0475s/iter; left time: 1786.4763s
Epoch: 20 cost time: 23.03438115119934
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000708
	speed: 0.2424s/iter; left time: 9071.5369s
	iters: 200, epoch: 21 | loss: 0.0000657
	speed: 0.0475s/iter; left time: 1771.1675s
	iters: 300, epoch: 21 | loss: 0.0000376
	speed: 0.0480s/iter; left time: 1788.0007s
	iters: 400, epoch: 21 | loss: 0.0001559
	speed: 0.0370s/iter; left time: 1372.8033s
Epoch: 21 cost time: 21.457942962646484
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000456
	speed: 0.2098s/iter; left time: 7752.7847s
	iters: 200, epoch: 22 | loss: 0.0007214
	speed: 0.0461s/iter; left time: 1698.0833s
	iters: 300, epoch: 22 | loss: 0.5642892
	speed: 0.0449s/iter; left time: 1650.7837s
	iters: 400, epoch: 22 | loss: 0.0001213
	speed: 0.0511s/iter; left time: 1871.0998s
Epoch: 22 cost time: 22.52473521232605
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0010364
	speed: 0.2146s/iter; left time: 7831.0022s
	iters: 200, epoch: 23 | loss: 0.0624207
	speed: 0.0374s/iter; left time: 1360.4871s
	iters: 300, epoch: 23 | loss: 0.0001047
	speed: 0.0488s/iter; left time: 1770.5424s
	iters: 400, epoch: 23 | loss: 0.0700562
	speed: 0.0482s/iter; left time: 1742.8047s
Epoch: 23 cost time: 20.8802490234375
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0022506
	speed: 0.2313s/iter; left time: 8329.7723s
	iters: 200, epoch: 24 | loss: 0.0001811
	speed: 0.0500s/iter; left time: 1797.2654s
	iters: 300, epoch: 24 | loss: 0.0039532
	speed: 0.0465s/iter; left time: 1664.1797s
	iters: 400, epoch: 24 | loss: 0.0005440
	speed: 0.0466s/iter; left time: 1665.6736s
Epoch: 24 cost time: 22.851059675216675
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0008024
	speed: 0.2081s/iter; left time: 7398.6310s
	iters: 200, epoch: 25 | loss: 0.0000225
	speed: 0.0431s/iter; left time: 1526.4933s
	iters: 300, epoch: 25 | loss: 0.0000076
	speed: 0.0463s/iter; left time: 1635.8191s
	iters: 400, epoch: 25 | loss: 0.0001589
	speed: 0.0454s/iter; left time: 1599.5883s
Epoch: 25 cost time: 21.493862628936768
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0454746
	speed: 0.2328s/iter; left time: 8165.3803s
	iters: 200, epoch: 26 | loss: 0.1832967
	speed: 0.0452s/iter; left time: 1582.1608s
	iters: 300, epoch: 26 | loss: 0.0001820
	speed: 0.0468s/iter; left time: 1632.0659s
	iters: 400, epoch: 26 | loss: 0.0044094
	speed: 0.0496s/iter; left time: 1724.6831s
Epoch: 26 cost time: 22.30744194984436
Epoch: 26, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0260493
	speed: 0.2014s/iter; left time: 6970.6707s
	iters: 200, epoch: 27 | loss: 0.0000004
	speed: 0.0465s/iter; left time: 1605.6126s
	iters: 300, epoch: 27 | loss: 0.0001031
	speed: 0.0412s/iter; left time: 1416.3882s
	iters: 400, epoch: 27 | loss: 0.0000068
	speed: 0.0435s/iter; left time: 1492.5085s
Epoch: 27 cost time: 20.54568338394165
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 211258
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7000742
	speed: 0.0688s/iter; left time: 3221.0239s
	iters: 200, epoch: 1 | loss: 0.3497815
	speed: 0.0498s/iter; left time: 2325.5621s
	iters: 300, epoch: 1 | loss: 0.2648685
	speed: 0.0494s/iter; left time: 2301.3367s
	iters: 400, epoch: 1 | loss: 0.2920030
	speed: 0.0464s/iter; left time: 2158.0915s
Epoch: 1 cost time: 25.03917622566223
Epoch: 1, Steps: 469 | Train Loss: 0.594 Vali Loss: 0.293 Vali Acc: 0.914 Test Loss: 0.293 Test Acc: 0.914
Validation loss decreased (inf --> -0.913662).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0498380
	speed: 0.2118s/iter; left time: 9811.1595s
	iters: 200, epoch: 2 | loss: 0.1329595
	speed: 0.0368s/iter; left time: 1700.7315s
	iters: 300, epoch: 2 | loss: 0.3596631
	speed: 0.0437s/iter; left time: 2016.6693s
	iters: 400, epoch: 2 | loss: 0.4041480
	speed: 0.0499s/iter; left time: 2296.5176s
Epoch: 2 cost time: 20.572048902511597
Epoch: 2, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
Validation loss decreased (-0.913662 --> -0.953400).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0460875
	speed: 0.2329s/iter; left time: 10682.9181s
	iters: 200, epoch: 3 | loss: 0.2753009
	speed: 0.0562s/iter; left time: 2573.3376s
	iters: 300, epoch: 3 | loss: 0.0730514
	speed: 0.0572s/iter; left time: 2610.4878s
	iters: 400, epoch: 3 | loss: 0.1030515
	speed: 0.0443s/iter; left time: 2017.6474s
Epoch: 3 cost time: 23.88517928123474
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
Validation loss decreased (-0.953400 --> -0.960261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0391677
	speed: 0.2359s/iter; left time: 10709.7436s
	iters: 200, epoch: 4 | loss: 0.0122973
	speed: 0.0502s/iter; left time: 2273.2360s
	iters: 300, epoch: 4 | loss: 0.0181246
	speed: 0.0507s/iter; left time: 2289.9063s
	iters: 400, epoch: 4 | loss: 0.0010516
	speed: 0.0516s/iter; left time: 2325.7746s
Epoch: 4 cost time: 24.852092504501343
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.960261 --> -0.964836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0387448
	speed: 0.2528s/iter; left time: 11356.2628s
	iters: 200, epoch: 5 | loss: 0.0093928
	speed: 0.0464s/iter; left time: 2077.6625s
	iters: 300, epoch: 5 | loss: 0.5340742
	speed: 0.0460s/iter; left time: 2058.7891s
	iters: 400, epoch: 5 | loss: 1.1608510
	speed: 0.0477s/iter; left time: 2127.7703s
Epoch: 5 cost time: 22.640011310577393
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.967695).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0369689
	speed: 0.2037s/iter; left time: 9056.6504s
	iters: 200, epoch: 6 | loss: 0.1114907
	speed: 0.0440s/iter; left time: 1951.4309s
	iters: 300, epoch: 6 | loss: 0.0023239
	speed: 0.0467s/iter; left time: 2064.9835s
	iters: 400, epoch: 6 | loss: 0.0109734
	speed: 0.0491s/iter; left time: 2170.0215s
Epoch: 6 cost time: 21.45692801475525
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.967695 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0028171
	speed: 0.2231s/iter; left time: 9813.5456s
	iters: 200, epoch: 7 | loss: 0.0093253
	speed: 0.0456s/iter; left time: 1999.9542s
	iters: 300, epoch: 7 | loss: 0.0209044
	speed: 0.0428s/iter; left time: 1874.8148s
	iters: 400, epoch: 7 | loss: 0.0073505
	speed: 0.0408s/iter; left time: 1780.6619s
Epoch: 7 cost time: 21.01974654197693
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971411).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0045822
	speed: 0.2424s/iter; left time: 10547.5185s
	iters: 200, epoch: 8 | loss: 0.0270064
	speed: 0.0537s/iter; left time: 2332.0629s
	iters: 300, epoch: 8 | loss: 0.0156310
	speed: 0.0482s/iter; left time: 2087.4570s
	iters: 400, epoch: 8 | loss: 0.0532017
	speed: 0.0518s/iter; left time: 2240.6018s
Epoch: 8 cost time: 24.722645044326782
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0016743
	speed: 0.2280s/iter; left time: 9816.1695s
	iters: 200, epoch: 9 | loss: 0.1173655
	speed: 0.0501s/iter; left time: 2153.2464s
	iters: 300, epoch: 9 | loss: 0.2631639
	speed: 0.0492s/iter; left time: 2109.6179s
	iters: 400, epoch: 9 | loss: 0.0050893
	speed: 0.0493s/iter; left time: 2107.3601s
Epoch: 9 cost time: 23.329508304595947
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.971411 --> -0.974270).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1524177
	speed: 0.2334s/iter; left time: 9936.1471s
	iters: 200, epoch: 10 | loss: 0.0156423
	speed: 0.0391s/iter; left time: 1659.2540s
	iters: 300, epoch: 10 | loss: 0.0059124
	speed: 0.0429s/iter; left time: 1817.1471s
	iters: 400, epoch: 10 | loss: 0.0110480
	speed: 0.0541s/iter; left time: 2289.0557s
Epoch: 10 cost time: 21.727806329727173
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009851
	speed: 0.2382s/iter; left time: 10029.9290s
	iters: 200, epoch: 11 | loss: 0.0000345
	speed: 0.0521s/iter; left time: 2189.8631s
	iters: 300, epoch: 11 | loss: 0.0008842
	speed: 0.0512s/iter; left time: 2145.6280s
	iters: 400, epoch: 11 | loss: 0.0119705
	speed: 0.0413s/iter; left time: 1728.6598s
Epoch: 11 cost time: 22.404599905014038
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0010084
	speed: 0.2102s/iter; left time: 8752.5070s
	iters: 200, epoch: 12 | loss: 0.0031841
	speed: 0.0495s/iter; left time: 2056.8117s
	iters: 300, epoch: 12 | loss: 0.0006220
	speed: 0.0478s/iter; left time: 1982.9307s
	iters: 400, epoch: 12 | loss: 0.0028626
	speed: 0.0488s/iter; left time: 2018.3830s
Epoch: 12 cost time: 23.0096116065979
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977700).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.3762333
	speed: 0.2051s/iter; left time: 8445.5742s
	iters: 200, epoch: 13 | loss: 0.0050505
	speed: 0.0469s/iter; left time: 1925.9608s
	iters: 300, epoch: 13 | loss: 0.0321418
	speed: 0.0440s/iter; left time: 1803.8841s
	iters: 400, epoch: 13 | loss: 0.0077797
	speed: 0.0450s/iter; left time: 1840.6507s
Epoch: 13 cost time: 21.738500833511353
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0018244
	speed: 0.2143s/iter; left time: 8721.0935s
	iters: 200, epoch: 14 | loss: 0.0010808
	speed: 0.0409s/iter; left time: 1662.1250s
	iters: 300, epoch: 14 | loss: 0.0015222
	speed: 0.0402s/iter; left time: 1626.3677s
	iters: 400, epoch: 14 | loss: 0.0026195
	speed: 0.0436s/iter; left time: 1761.0111s
Epoch: 14 cost time: 19.984473943710327
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0115560
	speed: 0.2355s/iter; left time: 9477.3078s
	iters: 200, epoch: 15 | loss: 0.0006379
	speed: 0.0542s/iter; left time: 2175.9805s
	iters: 300, epoch: 15 | loss: 0.0003245
	speed: 0.0565s/iter; left time: 2262.6382s
	iters: 400, epoch: 15 | loss: 0.0064684
	speed: 0.0501s/iter; left time: 1999.1043s
Epoch: 15 cost time: 24.87272024154663
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.3381768
	speed: 0.2348s/iter; left time: 9335.8645s
	iters: 200, epoch: 16 | loss: 0.0084631
	speed: 0.0401s/iter; left time: 1591.4216s
	iters: 300, epoch: 16 | loss: 0.0001902
	speed: 0.0395s/iter; left time: 1562.1795s
	iters: 400, epoch: 16 | loss: 0.0456988
	speed: 0.0420s/iter; left time: 1658.1626s
Epoch: 16 cost time: 20.522523641586304
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1035874
	speed: 0.2226s/iter; left time: 8748.2140s
	iters: 200, epoch: 17 | loss: 0.0466907
	speed: 0.0431s/iter; left time: 1690.6101s
	iters: 300, epoch: 17 | loss: 0.0004073
	speed: 0.0439s/iter; left time: 1714.9355s
	iters: 400, epoch: 17 | loss: 0.0043141
	speed: 0.0456s/iter; left time: 1776.8458s
Epoch: 17 cost time: 21.293991565704346
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.1809126
	speed: 0.2190s/iter; left time: 8504.9029s
	iters: 200, epoch: 18 | loss: 0.0005948
	speed: 0.0445s/iter; left time: 1723.9979s
	iters: 300, epoch: 18 | loss: 0.0000517
	speed: 0.0443s/iter; left time: 1711.9507s
	iters: 400, epoch: 18 | loss: 0.0067445
	speed: 0.0438s/iter; left time: 1687.9904s
Epoch: 18 cost time: 20.870246171951294
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.977700 --> -0.979987).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0010394
	speed: 0.2099s/iter; left time: 8051.3502s
	iters: 200, epoch: 19 | loss: 0.0220754
	speed: 0.0487s/iter; left time: 1862.0537s
	iters: 300, epoch: 19 | loss: 0.0016164
	speed: 0.0500s/iter; left time: 1906.5030s
	iters: 400, epoch: 19 | loss: 0.0002402
	speed: 0.0485s/iter; left time: 1846.6131s
Epoch: 19 cost time: 22.540867567062378
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0006229
	speed: 0.2241s/iter; left time: 8489.5095s
	iters: 200, epoch: 20 | loss: 0.2551876
	speed: 0.0422s/iter; left time: 1593.9654s
	iters: 300, epoch: 20 | loss: 0.0003415
	speed: 0.0450s/iter; left time: 1696.5802s
	iters: 400, epoch: 20 | loss: 0.0010689
	speed: 0.0483s/iter; left time: 1815.0427s
Epoch: 20 cost time: 22.004812955856323
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0037056
	speed: 0.2332s/iter; left time: 8728.0621s
	iters: 200, epoch: 21 | loss: 0.0001826
	speed: 0.0474s/iter; left time: 1769.4816s
	iters: 300, epoch: 21 | loss: 0.0003619
	speed: 0.0477s/iter; left time: 1775.9197s
	iters: 400, epoch: 21 | loss: 0.0042712
	speed: 0.0449s/iter; left time: 1665.9642s
Epoch: 21 cost time: 21.77696657180786
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0187493
	speed: 0.2053s/iter; left time: 7587.2046s
	iters: 200, epoch: 22 | loss: 0.0074213
	speed: 0.0439s/iter; left time: 1617.4133s
	iters: 300, epoch: 22 | loss: 0.0108624
	speed: 0.0445s/iter; left time: 1634.0497s
	iters: 400, epoch: 22 | loss: 0.0002920
	speed: 0.0502s/iter; left time: 1839.2620s
Epoch: 22 cost time: 21.924606561660767
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979987 --> -0.982846).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0028565
	speed: 0.2084s/iter; left time: 7602.8214s
	iters: 200, epoch: 23 | loss: 0.0021549
	speed: 0.0459s/iter; left time: 1670.7660s
	iters: 300, epoch: 23 | loss: 0.0069192
	speed: 0.0480s/iter; left time: 1741.0667s
	iters: 400, epoch: 23 | loss: 0.0673845
	speed: 0.0452s/iter; left time: 1635.2038s
Epoch: 23 cost time: 21.19466781616211
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0081355
	speed: 0.2244s/iter; left time: 8082.7600s
	iters: 200, epoch: 24 | loss: 0.0007339
	speed: 0.0482s/iter; left time: 1729.4358s
	iters: 300, epoch: 24 | loss: 0.0022323
	speed: 0.0442s/iter; left time: 1584.6300s
	iters: 400, epoch: 24 | loss: 0.0004905
	speed: 0.0466s/iter; left time: 1663.3678s
Epoch: 24 cost time: 22.259760856628418
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0003358
	speed: 0.2061s/iter; left time: 7324.3276s
	iters: 200, epoch: 25 | loss: 0.0009939
	speed: 0.0442s/iter; left time: 1567.4215s
	iters: 300, epoch: 25 | loss: 0.0004587
	speed: 0.0436s/iter; left time: 1540.0005s
	iters: 400, epoch: 25 | loss: 0.0012837
	speed: 0.0438s/iter; left time: 1542.1733s
Epoch: 25 cost time: 20.59312677383423
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0001540
	speed: 0.2129s/iter; left time: 7466.6388s
	iters: 200, epoch: 26 | loss: 0.0018194
	speed: 0.0408s/iter; left time: 1427.3357s
	iters: 300, epoch: 26 | loss: 0.0001133
	speed: 0.0404s/iter; left time: 1409.2394s
	iters: 400, epoch: 26 | loss: 0.0053092
	speed: 0.0403s/iter; left time: 1402.2510s
Epoch: 26 cost time: 20.004602909088135
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0077892
	speed: 0.2274s/iter; left time: 7870.2077s
	iters: 200, epoch: 27 | loss: 0.0018480
	speed: 0.0432s/iter; left time: 1490.6661s
	iters: 300, epoch: 27 | loss: 0.0014110
	speed: 0.0380s/iter; left time: 1306.5881s
	iters: 400, epoch: 27 | loss: 0.0001917
	speed: 0.0348s/iter; left time: 1193.8174s
Epoch: 27 cost time: 18.968224048614502
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0000474
	speed: 0.1831s/iter; left time: 6251.9240s
	iters: 200, epoch: 28 | loss: 0.0018943
	speed: 0.0461s/iter; left time: 1569.6348s
	iters: 300, epoch: 28 | loss: 0.0040113
	speed: 0.0436s/iter; left time: 1480.5383s
	iters: 400, epoch: 28 | loss: 0.0014437
	speed: 0.0438s/iter; left time: 1482.5865s
Epoch: 28 cost time: 21.891435384750366
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0655078
	speed: 0.2181s/iter; left time: 7343.9682s
	iters: 200, epoch: 29 | loss: 0.0000779
	speed: 0.0396s/iter; left time: 1329.1181s
	iters: 300, epoch: 29 | loss: 0.0021996
	speed: 0.0421s/iter; left time: 1410.3666s
	iters: 400, epoch: 29 | loss: 0.0041347
	speed: 0.0453s/iter; left time: 1513.1933s
Epoch: 29 cost time: 20.225420713424683
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0423597
	speed: 0.2186s/iter; left time: 7256.2317s
	iters: 200, epoch: 30 | loss: 0.3732950
	speed: 0.0423s/iter; left time: 1400.5670s
	iters: 300, epoch: 30 | loss: 0.0054106
	speed: 0.0431s/iter; left time: 1421.8174s
	iters: 400, epoch: 30 | loss: 0.2394231
	speed: 0.0445s/iter; left time: 1464.7967s
Epoch: 30 cost time: 20.743947982788086
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.3394714
	speed: 0.2053s/iter; left time: 6718.6222s
	iters: 200, epoch: 31 | loss: 0.0001652
	speed: 0.0409s/iter; left time: 1336.0920s
	iters: 300, epoch: 31 | loss: 0.0003776
	speed: 0.0423s/iter; left time: 1376.8365s
	iters: 400, epoch: 31 | loss: 0.0012248
	speed: 0.0420s/iter; left time: 1360.8728s
Epoch: 31 cost time: 19.81299090385437
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0003350
	speed: 0.2130s/iter; left time: 6872.7009s
	iters: 200, epoch: 32 | loss: 0.2424765
	speed: 0.0464s/iter; left time: 1493.4568s
	iters: 300, epoch: 32 | loss: 0.0020618
	speed: 0.0448s/iter; left time: 1436.1370s
	iters: 400, epoch: 32 | loss: 0.0019925
	speed: 0.0450s/iter; left time: 1439.2016s
Epoch: 32 cost time: 21.790770769119263
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
Validation loss decreased (-0.982846 --> -0.984276).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0013086
	speed: 0.2143s/iter; left time: 6812.2898s
	iters: 200, epoch: 33 | loss: 0.0105502
	speed: 0.0392s/iter; left time: 1241.9017s
	iters: 300, epoch: 33 | loss: 0.0204483
	speed: 0.0456s/iter; left time: 1439.2260s
	iters: 400, epoch: 33 | loss: 0.0444946
	speed: 0.0461s/iter; left time: 1452.5160s
Epoch: 33 cost time: 20.66666865348816
Epoch: 33, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0000423
	speed: 0.2293s/iter; left time: 7184.0848s
	iters: 200, epoch: 34 | loss: 0.0003232
	speed: 0.0465s/iter; left time: 1450.5044s
	iters: 300, epoch: 34 | loss: 0.0083848
	speed: 0.0443s/iter; left time: 1379.6107s
	iters: 400, epoch: 34 | loss: 0.0010951
	speed: 0.0431s/iter; left time: 1336.9469s
Epoch: 34 cost time: 21.189831733703613
Epoch: 34, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
Validation loss decreased (-0.984276 --> -0.984562).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0006336
	speed: 0.1951s/iter; left time: 6019.2329s
	iters: 200, epoch: 35 | loss: 0.0057973
	speed: 0.0444s/iter; left time: 1364.8380s
	iters: 300, epoch: 35 | loss: 0.0003879
	speed: 0.0444s/iter; left time: 1361.6413s
	iters: 400, epoch: 35 | loss: 0.0000230
	speed: 0.0414s/iter; left time: 1264.0285s
Epoch: 35 cost time: 20.874117374420166
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0005329
	speed: 0.2056s/iter; left time: 6248.5886s
	iters: 200, epoch: 36 | loss: 0.0096459
	speed: 0.0397s/iter; left time: 1203.7835s
	iters: 300, epoch: 36 | loss: 0.0009689
	speed: 0.0391s/iter; left time: 1179.9670s
	iters: 400, epoch: 36 | loss: 0.0007654
	speed: 0.0462s/iter; left time: 1389.4579s
Epoch: 36 cost time: 20.12758755683899
Epoch: 36, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0003303
	speed: 0.2172s/iter; left time: 6497.5945s
	iters: 200, epoch: 37 | loss: 0.0000736
	speed: 0.0436s/iter; left time: 1301.3847s
	iters: 300, epoch: 37 | loss: 0.0045389
	speed: 0.0480s/iter; left time: 1425.0119s
	iters: 400, epoch: 37 | loss: 0.0000795
	speed: 0.0497s/iter; left time: 1470.8314s
Epoch: 37 cost time: 22.211650371551514
Epoch: 37, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0009211
	speed: 0.2099s/iter; left time: 6180.1320s
	iters: 200, epoch: 38 | loss: 0.0001222
	speed: 0.0431s/iter; left time: 1266.0590s
	iters: 300, epoch: 38 | loss: 0.0001640
	speed: 0.0462s/iter; left time: 1352.1307s
	iters: 400, epoch: 38 | loss: 0.0002872
	speed: 0.0421s/iter; left time: 1228.4621s
Epoch: 38 cost time: 20.7131929397583
Epoch: 38, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0259473
	speed: 0.2096s/iter; left time: 6075.0770s
	iters: 200, epoch: 39 | loss: 0.0007725
	speed: 0.0412s/iter; left time: 1190.0076s
	iters: 300, epoch: 39 | loss: 0.1695184
	speed: 0.0371s/iter; left time: 1068.2107s
	iters: 400, epoch: 39 | loss: 0.0037395
	speed: 0.0412s/iter; left time: 1182.9048s
Epoch: 39 cost time: 19.41150212287903
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0029821
	speed: 0.2167s/iter; left time: 6177.6097s
	iters: 200, epoch: 40 | loss: 0.0086857
	speed: 0.0443s/iter; left time: 1257.7629s
	iters: 300, epoch: 40 | loss: 0.1568840
	speed: 0.0390s/iter; left time: 1104.3796s
	iters: 400, epoch: 40 | loss: 0.0001317
	speed: 0.0383s/iter; left time: 1081.7891s
Epoch: 40 cost time: 19.798003673553467
Epoch: 40, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 41 | loss: 0.0040227
	speed: 0.2162s/iter; left time: 6062.5197s
	iters: 200, epoch: 41 | loss: 0.0687885
	speed: 0.0440s/iter; left time: 1229.9452s
	iters: 300, epoch: 41 | loss: 0.0001089
	speed: 0.0444s/iter; left time: 1237.1461s
	iters: 400, epoch: 41 | loss: 0.0140939
	speed: 0.0435s/iter; left time: 1205.9216s
Epoch: 41 cost time: 21.508843660354614
Epoch: 41, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 42 | loss: 0.0000619
	speed: 0.2256s/iter; left time: 6219.5540s
	iters: 200, epoch: 42 | loss: 0.4734384
	speed: 0.0460s/iter; left time: 1262.3820s
	iters: 300, epoch: 42 | loss: 0.0021484
	speed: 0.0450s/iter; left time: 1231.4601s
	iters: 400, epoch: 42 | loss: 0.0002206
	speed: 0.0450s/iter; left time: 1226.9503s
Epoch: 42 cost time: 21.307507038116455
Epoch: 42, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 43 | loss: 0.0105148
	speed: 0.2054s/iter; left time: 5565.8672s
	iters: 200, epoch: 43 | loss: 0.0160671
	speed: 0.0480s/iter; left time: 1297.3491s
	iters: 300, epoch: 43 | loss: 0.0002417
	speed: 0.0443s/iter; left time: 1192.5876s
	iters: 400, epoch: 43 | loss: 0.3596670
	speed: 0.0411s/iter; left time: 1102.6024s
Epoch: 43 cost time: 21.020597219467163
Epoch: 43, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 44 | loss: 0.2229338
	speed: 0.2015s/iter; left time: 5365.5810s
	iters: 200, epoch: 44 | loss: 0.0000664
	speed: 0.0403s/iter; left time: 1069.9539s
	iters: 300, epoch: 44 | loss: 0.0001266
	speed: 0.0416s/iter; left time: 1100.0150s
	iters: 400, epoch: 44 | loss: 0.0133590
	speed: 0.0447s/iter; left time: 1177.4213s
Epoch: 44 cost time: 20.452542543411255
Epoch: 44, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 145722
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6438158
	speed: 0.0685s/iter; left time: 3203.8641s
	iters: 200, epoch: 1 | loss: 0.3486501
	speed: 0.0467s/iter; left time: 2179.3943s
	iters: 300, epoch: 1 | loss: 0.2691101
	speed: 0.0472s/iter; left time: 2198.5369s
	iters: 400, epoch: 1 | loss: 0.2427672
	speed: 0.0464s/iter; left time: 2156.6411s
Epoch: 1 cost time: 24.159013032913208
Epoch: 1, Steps: 469 | Train Loss: 0.585 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
Validation loss decreased (inf --> -0.918808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0448473
	speed: 0.2067s/iter; left time: 9576.7386s
	iters: 200, epoch: 2 | loss: 0.0659729
	speed: 0.0426s/iter; left time: 1969.9991s
	iters: 300, epoch: 2 | loss: 0.2972593
	speed: 0.0438s/iter; left time: 2020.8699s
	iters: 400, epoch: 2 | loss: 0.4479728
	speed: 0.0435s/iter; left time: 2002.4860s
Epoch: 2 cost time: 20.293259859085083
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.918808 --> -0.956830).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0288438
	speed: 0.2182s/iter; left time: 10005.9624s
	iters: 200, epoch: 3 | loss: 0.1556341
	speed: 0.0431s/iter; left time: 1973.0047s
	iters: 300, epoch: 3 | loss: 0.0728427
	speed: 0.0459s/iter; left time: 2095.6270s
	iters: 400, epoch: 3 | loss: 0.0563881
	speed: 0.0450s/iter; left time: 2048.2265s
Epoch: 3 cost time: 21.27218794822693
Epoch: 3, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.956830 --> -0.961977).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0305784
	speed: 0.2093s/iter; left time: 9501.1908s
	iters: 200, epoch: 4 | loss: 0.0129333
	speed: 0.0496s/iter; left time: 2246.4857s
	iters: 300, epoch: 4 | loss: 0.0122107
	speed: 0.0480s/iter; left time: 2169.5935s
	iters: 400, epoch: 4 | loss: 0.0015491
	speed: 0.0461s/iter; left time: 2077.1593s
Epoch: 4 cost time: 22.48011827468872
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0247255
	speed: 0.2249s/iter; left time: 10103.2178s
	iters: 200, epoch: 5 | loss: 0.0109799
	speed: 0.0448s/iter; left time: 2007.8350s
	iters: 300, epoch: 5 | loss: 0.3102752
	speed: 0.0449s/iter; left time: 2009.6671s
	iters: 400, epoch: 5 | loss: 1.2638674
	speed: 0.0401s/iter; left time: 1791.5744s
Epoch: 5 cost time: 21.12160348892212
Epoch: 5, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
Validation loss decreased (-0.961977 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0149836
	speed: 0.2064s/iter; left time: 9174.7558s
	iters: 200, epoch: 6 | loss: 0.0606605
	speed: 0.0413s/iter; left time: 1832.4242s
	iters: 300, epoch: 6 | loss: 0.0532504
	speed: 0.0417s/iter; left time: 1843.2881s
	iters: 400, epoch: 6 | loss: 0.0112949
	speed: 0.0397s/iter; left time: 1754.5094s
Epoch: 6 cost time: 19.7902090549469
Epoch: 6, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.965407 --> -0.967695).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0006170
	speed: 0.1963s/iter; left time: 8636.1689s
	iters: 200, epoch: 7 | loss: 0.0030803
	speed: 0.0419s/iter; left time: 1840.6601s
	iters: 300, epoch: 7 | loss: 0.0591161
	speed: 0.0408s/iter; left time: 1786.9527s
	iters: 400, epoch: 7 | loss: 0.0188342
	speed: 0.0399s/iter; left time: 1744.7186s
Epoch: 7 cost time: 19.44229483604431
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.967695 --> -0.973984).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0015300
	speed: 0.1842s/iter; left time: 8015.0111s
	iters: 200, epoch: 8 | loss: 0.0083378
	speed: 0.0443s/iter; left time: 1922.3941s
	iters: 300, epoch: 8 | loss: 0.0158208
	speed: 0.0447s/iter; left time: 1937.0621s
	iters: 400, epoch: 8 | loss: 0.0380606
	speed: 0.0441s/iter; left time: 1905.1178s
Epoch: 8 cost time: 21.44059109687805
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0025565
	speed: 0.2293s/iter; left time: 9870.1106s
	iters: 200, epoch: 9 | loss: 0.1180756
	speed: 0.0463s/iter; left time: 1989.8300s
	iters: 300, epoch: 9 | loss: 0.1607371
	speed: 0.0466s/iter; left time: 1995.4955s
	iters: 400, epoch: 9 | loss: 0.0062173
	speed: 0.0464s/iter; left time: 1984.9960s
Epoch: 9 cost time: 22.186236143112183
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974556).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4411662
	speed: 0.2066s/iter; left time: 8797.5819s
	iters: 200, epoch: 10 | loss: 0.0053394
	speed: 0.0417s/iter; left time: 1770.9040s
	iters: 300, epoch: 10 | loss: 0.0069549
	speed: 0.0450s/iter; left time: 1905.6673s
	iters: 400, epoch: 10 | loss: 0.0105669
	speed: 0.0442s/iter; left time: 1869.0836s
Epoch: 10 cost time: 20.75542974472046
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0005750
	speed: 0.2050s/iter; left time: 8631.3466s
	iters: 200, epoch: 11 | loss: 0.0003450
	speed: 0.0453s/iter; left time: 1901.1749s
	iters: 300, epoch: 11 | loss: 0.0002348
	speed: 0.0401s/iter; left time: 1681.7350s
	iters: 400, epoch: 11 | loss: 0.0055793
	speed: 0.0401s/iter; left time: 1676.3998s
Epoch: 11 cost time: 19.9494571685791
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0024575
	speed: 0.2077s/iter; left time: 8650.4058s
	iters: 200, epoch: 12 | loss: 0.0020819
	speed: 0.0432s/iter; left time: 1794.0852s
	iters: 300, epoch: 12 | loss: 0.0012835
	speed: 0.0413s/iter; left time: 1712.0014s
	iters: 400, epoch: 12 | loss: 0.0028409
	speed: 0.0440s/iter; left time: 1818.0173s
Epoch: 12 cost time: 20.67022132873535
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0432345
	speed: 0.2038s/iter; left time: 8389.6858s
	iters: 200, epoch: 13 | loss: 0.1108498
	speed: 0.0438s/iter; left time: 1798.1519s
	iters: 300, epoch: 13 | loss: 0.0030879
	speed: 0.0451s/iter; left time: 1846.2029s
	iters: 400, epoch: 13 | loss: 0.0033401
	speed: 0.0465s/iter; left time: 1899.9459s
Epoch: 13 cost time: 21.199267625808716
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0294488
	speed: 0.2134s/iter; left time: 8684.6671s
	iters: 200, epoch: 14 | loss: 0.0016458
	speed: 0.0457s/iter; left time: 1857.0516s
	iters: 300, epoch: 14 | loss: 0.0031745
	speed: 0.0420s/iter; left time: 1702.2802s
	iters: 400, epoch: 14 | loss: 0.0003984
	speed: 0.0415s/iter; left time: 1677.4333s
Epoch: 14 cost time: 21.027655601501465
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0938449
	speed: 0.2010s/iter; left time: 8086.0571s
	iters: 200, epoch: 15 | loss: 0.0005631
	speed: 0.0425s/iter; left time: 1707.5960s
	iters: 300, epoch: 15 | loss: 0.0032257
	speed: 0.0446s/iter; left time: 1783.7429s
	iters: 400, epoch: 15 | loss: 0.0028945
	speed: 0.0427s/iter; left time: 1704.0511s
Epoch: 15 cost time: 20.468194723129272
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1804300
	speed: 0.2100s/iter; left time: 8351.0643s
	iters: 200, epoch: 16 | loss: 0.0005078
	speed: 0.0399s/iter; left time: 1583.4250s
	iters: 300, epoch: 16 | loss: 0.0000835
	speed: 0.0385s/iter; left time: 1525.0161s
	iters: 400, epoch: 16 | loss: 0.0020295
	speed: 0.0417s/iter; left time: 1644.4366s
Epoch: 16 cost time: 19.74515151977539
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.974841).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1083166
	speed: 0.1989s/iter; left time: 7817.5325s
	iters: 200, epoch: 17 | loss: 0.1531164
	speed: 0.0395s/iter; left time: 1550.0760s
	iters: 300, epoch: 17 | loss: 0.0000447
	speed: 0.0418s/iter; left time: 1632.7181s
	iters: 400, epoch: 17 | loss: 0.0002009
	speed: 0.0416s/iter; left time: 1621.4010s
Epoch: 17 cost time: 19.32166838645935
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1230475
	speed: 0.1994s/iter; left time: 7741.1985s
	iters: 200, epoch: 18 | loss: 0.0019614
	speed: 0.0454s/iter; left time: 1758.8876s
	iters: 300, epoch: 18 | loss: 0.0102777
	speed: 0.0409s/iter; left time: 1579.1742s
	iters: 400, epoch: 18 | loss: 0.0003982
	speed: 0.0425s/iter; left time: 1636.3442s
Epoch: 18 cost time: 20.659149169921875
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.974841 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0016116
	speed: 0.2039s/iter; left time: 7822.1497s
	iters: 200, epoch: 19 | loss: 0.0438210
	speed: 0.0393s/iter; left time: 1502.3423s
	iters: 300, epoch: 19 | loss: 0.0214508
	speed: 0.0387s/iter; left time: 1475.0989s
	iters: 400, epoch: 19 | loss: 0.0387252
	speed: 0.0397s/iter; left time: 1509.5668s
Epoch: 19 cost time: 19.321035623550415
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000348
	speed: 0.2080s/iter; left time: 7879.7965s
	iters: 200, epoch: 20 | loss: 0.1854423
	speed: 0.0449s/iter; left time: 1697.1603s
	iters: 300, epoch: 20 | loss: 0.0048539
	speed: 0.0460s/iter; left time: 1732.2041s
	iters: 400, epoch: 20 | loss: 0.0001393
	speed: 0.0471s/iter; left time: 1769.9858s
Epoch: 20 cost time: 21.924175024032593
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0014407
	speed: 0.2162s/iter; left time: 8088.6386s
	iters: 200, epoch: 21 | loss: 0.0001456
	speed: 0.0455s/iter; left time: 1698.3867s
	iters: 300, epoch: 21 | loss: 0.0015593
	speed: 0.0455s/iter; left time: 1693.6789s
	iters: 400, epoch: 21 | loss: 0.0649910
	speed: 0.0433s/iter; left time: 1605.5122s
Epoch: 21 cost time: 21.263972520828247
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0079211
	speed: 0.2109s/iter; left time: 7794.9263s
	iters: 200, epoch: 22 | loss: 0.0034269
	speed: 0.0396s/iter; left time: 1459.4818s
	iters: 300, epoch: 22 | loss: 0.0077741
	speed: 0.0394s/iter; left time: 1449.7257s
	iters: 400, epoch: 22 | loss: 0.0183645
	speed: 0.0387s/iter; left time: 1417.7064s
Epoch: 22 cost time: 19.112699508666992
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977700).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0005493
	speed: 0.1933s/iter; left time: 7050.6323s
	iters: 200, epoch: 23 | loss: 0.0004646
	speed: 0.0403s/iter; left time: 1466.5218s
	iters: 300, epoch: 23 | loss: 0.0036870
	speed: 0.0424s/iter; left time: 1538.0708s
	iters: 400, epoch: 23 | loss: 0.0021034
	speed: 0.0435s/iter; left time: 1574.7555s
Epoch: 23 cost time: 19.83521866798401
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0007866
	speed: 0.2013s/iter; left time: 7250.8978s
	iters: 200, epoch: 24 | loss: 0.0132569
	speed: 0.0383s/iter; left time: 1375.9230s
	iters: 300, epoch: 24 | loss: 0.0055769
	speed: 0.0403s/iter; left time: 1441.5693s
	iters: 400, epoch: 24 | loss: 0.0021968
	speed: 0.0407s/iter; left time: 1453.6821s
Epoch: 24 cost time: 19.407853841781616
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
Validation loss decreased (-0.977700 --> -0.982275).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0010841
	speed: 0.2065s/iter; left time: 7340.3630s
	iters: 200, epoch: 25 | loss: 0.0479792
	speed: 0.0458s/iter; left time: 1624.9787s
	iters: 300, epoch: 25 | loss: 0.0268291
	speed: 0.0461s/iter; left time: 1628.8400s
	iters: 400, epoch: 25 | loss: 0.0035067
	speed: 0.0448s/iter; left time: 1577.8019s
Epoch: 25 cost time: 21.259849786758423
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0003361
	speed: 0.2057s/iter; left time: 7214.4203s
	iters: 200, epoch: 26 | loss: 0.0020583
	speed: 0.0418s/iter; left time: 1461.3302s
	iters: 300, epoch: 26 | loss: 0.0870732
	speed: 0.0418s/iter; left time: 1456.4675s
	iters: 400, epoch: 26 | loss: 0.0029620
	speed: 0.0406s/iter; left time: 1411.7092s
Epoch: 26 cost time: 20.53124713897705
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.1309229
	speed: 0.1975s/iter; left time: 6835.7945s
	iters: 200, epoch: 27 | loss: 0.0078763
	speed: 0.0393s/iter; left time: 1355.6257s
	iters: 300, epoch: 27 | loss: 0.0017801
	speed: 0.0407s/iter; left time: 1400.4915s
	iters: 400, epoch: 27 | loss: 0.0000450
	speed: 0.0425s/iter; left time: 1458.2873s
Epoch: 27 cost time: 19.80510973930359
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000993
	speed: 0.1914s/iter; left time: 6534.2585s
	iters: 200, epoch: 28 | loss: 0.0009932
	speed: 0.0409s/iter; left time: 1391.6152s
	iters: 300, epoch: 28 | loss: 0.0190346
	speed: 0.0434s/iter; left time: 1472.5264s
	iters: 400, epoch: 28 | loss: 0.0013274
	speed: 0.0419s/iter; left time: 1416.6879s
Epoch: 28 cost time: 19.77993941307068
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0097477
	speed: 0.2011s/iter; left time: 6771.9047s
	iters: 200, epoch: 29 | loss: 0.0000573
	speed: 0.0452s/iter; left time: 1518.3431s
	iters: 300, epoch: 29 | loss: 0.0013472
	speed: 0.0439s/iter; left time: 1470.1536s
	iters: 400, epoch: 29 | loss: 0.0007344
	speed: 0.0443s/iter; left time: 1477.9441s
Epoch: 29 cost time: 21.168816328048706
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0029605
	speed: 0.2119s/iter; left time: 7034.5333s
	iters: 200, epoch: 30 | loss: 0.0048961
	speed: 0.0388s/iter; left time: 1284.3997s
	iters: 300, epoch: 30 | loss: 0.0003649
	speed: 0.0397s/iter; left time: 1311.4702s
	iters: 400, epoch: 30 | loss: 0.1283550
	speed: 0.0390s/iter; left time: 1281.8046s
Epoch: 30 cost time: 19.43347668647766
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.1368806
	speed: 0.2109s/iter; left time: 6904.5607s
	iters: 200, epoch: 31 | loss: 0.0017314
	speed: 0.0420s/iter; left time: 1370.5299s
	iters: 300, epoch: 31 | loss: 0.0029991
	speed: 0.0409s/iter; left time: 1332.0764s
	iters: 400, epoch: 31 | loss: 0.0078689
	speed: 0.0432s/iter; left time: 1401.6671s
Epoch: 31 cost time: 20.46228313446045
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0067319
	speed: 0.1976s/iter; left time: 6373.4065s
	iters: 200, epoch: 32 | loss: 0.3903456
	speed: 0.0431s/iter; left time: 1385.2909s
	iters: 300, epoch: 32 | loss: 0.0001326
	speed: 0.0436s/iter; left time: 1397.2305s
	iters: 400, epoch: 32 | loss: 0.0071401
	speed: 0.0459s/iter; left time: 1465.7805s
Epoch: 32 cost time: 20.937732934951782
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0075120
	speed: 0.2049s/iter; left time: 6515.6597s
	iters: 200, epoch: 33 | loss: 0.0034045
	speed: 0.0401s/iter; left time: 1270.3153s
	iters: 300, epoch: 33 | loss: 0.0000977
	speed: 0.0437s/iter; left time: 1381.1604s
	iters: 400, epoch: 33 | loss: 0.0085046
	speed: 0.0412s/iter; left time: 1298.4413s
Epoch: 33 cost time: 19.46859622001648
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0005510
	speed: 0.1986s/iter; left time: 6222.3352s
	iters: 200, epoch: 34 | loss: 0.0000685
	speed: 0.0371s/iter; left time: 1157.5102s
	iters: 300, epoch: 34 | loss: 0.0005497
	speed: 0.0383s/iter; left time: 1193.2762s
	iters: 400, epoch: 34 | loss: 0.0231673
	speed: 0.0374s/iter; left time: 1158.8049s
Epoch: 34 cost time: 18.343055963516235
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 145722
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6477298
	speed: 0.0586s/iter; left time: 2744.8594s
	iters: 200, epoch: 1 | loss: 0.3924734
	speed: 0.0391s/iter; left time: 1824.3910s
	iters: 300, epoch: 1 | loss: 0.1877914
	speed: 0.0381s/iter; left time: 1774.1834s
	iters: 400, epoch: 1 | loss: 0.1534317
	speed: 0.0390s/iter; left time: 1812.8286s
Epoch: 1 cost time: 20.167794704437256
Epoch: 1, Steps: 469 | Train Loss: 0.573 Vali Loss: 0.205 Vali Acc: 0.947 Test Loss: 0.205 Test Acc: 0.947
Validation loss decreased (inf --> -0.946825).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0470479
	speed: 0.1978s/iter; left time: 9162.8299s
	iters: 200, epoch: 2 | loss: 0.0211239
	speed: 0.0433s/iter; left time: 2001.5787s
	iters: 300, epoch: 2 | loss: 0.4576445
	speed: 0.0443s/iter; left time: 2041.9820s
	iters: 400, epoch: 2 | loss: 0.5148644
	speed: 0.0399s/iter; left time: 1835.5208s
Epoch: 2 cost time: 20.170252799987793
Epoch: 2, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.946825 --> -0.967980).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0191774
	speed: 0.2019s/iter; left time: 9259.7017s
	iters: 200, epoch: 3 | loss: 0.2749752
	speed: 0.0413s/iter; left time: 1891.2942s
	iters: 300, epoch: 3 | loss: 0.0555475
	speed: 0.0429s/iter; left time: 1957.2205s
	iters: 400, epoch: 3 | loss: 0.0186430
	speed: 0.0453s/iter; left time: 2065.0621s
Epoch: 3 cost time: 20.514126777648926
Epoch: 3, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.967980 --> -0.974556).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0416033
	speed: 0.1943s/iter; left time: 8819.1090s
	iters: 200, epoch: 4 | loss: 0.0292066
	speed: 0.0410s/iter; left time: 1855.4554s
	iters: 300, epoch: 4 | loss: 0.0173310
	speed: 0.0411s/iter; left time: 1857.3327s
	iters: 400, epoch: 4 | loss: 0.0012590
	speed: 0.0411s/iter; left time: 1855.4428s
Epoch: 4 cost time: 19.54895305633545
Epoch: 4, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0087305
	speed: 0.1945s/iter; left time: 8735.9042s
	iters: 200, epoch: 5 | loss: 0.0894301
	speed: 0.0397s/iter; left time: 1778.5966s
	iters: 300, epoch: 5 | loss: 0.3187481
	speed: 0.0386s/iter; left time: 1727.0882s
	iters: 400, epoch: 5 | loss: 1.1049907
	speed: 0.0388s/iter; left time: 1729.4987s
Epoch: 5 cost time: 18.754927158355713
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.977415).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0072650
	speed: 0.1898s/iter; left time: 8438.8612s
	iters: 200, epoch: 6 | loss: 0.0027106
	speed: 0.0409s/iter; left time: 1816.2814s
	iters: 300, epoch: 6 | loss: 0.0076067
	speed: 0.0401s/iter; left time: 1773.7883s
	iters: 400, epoch: 6 | loss: 0.0042472
	speed: 0.0385s/iter; left time: 1699.6300s
Epoch: 6 cost time: 19.12288999557495
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0039093
	speed: 0.2004s/iter; left time: 8813.3438s
	iters: 200, epoch: 7 | loss: 0.0047434
	speed: 0.0411s/iter; left time: 1804.4382s
	iters: 300, epoch: 7 | loss: 0.0031796
	speed: 0.0407s/iter; left time: 1782.6272s
	iters: 400, epoch: 7 | loss: 0.0514044
	speed: 0.0405s/iter; left time: 1768.0732s
Epoch: 7 cost time: 19.75220489501953
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0009193
	speed: 0.1987s/iter; left time: 8647.2896s
	iters: 200, epoch: 8 | loss: 0.0293656
	speed: 0.0402s/iter; left time: 1744.2098s
	iters: 300, epoch: 8 | loss: 0.0009799
	speed: 0.0394s/iter; left time: 1707.9165s
	iters: 400, epoch: 8 | loss: 0.0026305
	speed: 0.0418s/iter; left time: 1805.4100s
Epoch: 8 cost time: 19.028541088104248
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0005022
	speed: 0.1852s/iter; left time: 7970.6315s
	iters: 200, epoch: 9 | loss: 0.0092401
	speed: 0.0397s/iter; left time: 1706.7046s
	iters: 300, epoch: 9 | loss: 0.0073281
	speed: 0.0422s/iter; left time: 1806.1245s
	iters: 400, epoch: 9 | loss: 0.0002777
	speed: 0.0401s/iter; left time: 1715.0224s
Epoch: 9 cost time: 19.135491371154785
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0271015
	speed: 0.1889s/iter; left time: 8043.2399s
	iters: 200, epoch: 10 | loss: 0.0525892
	speed: 0.0440s/iter; left time: 1867.7749s
	iters: 300, epoch: 10 | loss: 0.0231220
	speed: 0.0415s/iter; left time: 1760.7761s
	iters: 400, epoch: 10 | loss: 0.0072950
	speed: 0.0405s/iter; left time: 1713.8363s
Epoch: 10 cost time: 19.67096447944641
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978844).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0009674
	speed: 0.2014s/iter; left time: 8479.9017s
	iters: 200, epoch: 11 | loss: 0.0412732
	speed: 0.0401s/iter; left time: 1684.4530s
	iters: 300, epoch: 11 | loss: 0.0002161
	speed: 0.0379s/iter; left time: 1590.2764s
	iters: 400, epoch: 11 | loss: 0.0055948
	speed: 0.0385s/iter; left time: 1609.1662s
Epoch: 11 cost time: 18.95617914199829
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0134672
	speed: 0.1922s/iter; left time: 8005.5768s
	iters: 200, epoch: 12 | loss: 0.1010697
	speed: 0.0391s/iter; left time: 1625.9726s
	iters: 300, epoch: 12 | loss: 0.0120862
	speed: 0.0407s/iter; left time: 1688.2240s
	iters: 400, epoch: 12 | loss: 0.0115081
	speed: 0.0411s/iter; left time: 1697.3095s
Epoch: 12 cost time: 18.94064235687256
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0031292
	speed: 0.1886s/iter; left time: 7764.6262s
	iters: 200, epoch: 13 | loss: 0.0024719
	speed: 0.0381s/iter; left time: 1563.6746s
	iters: 300, epoch: 13 | loss: 0.0000501
	speed: 0.0393s/iter; left time: 1612.2680s
	iters: 400, epoch: 13 | loss: 0.0032635
	speed: 0.0401s/iter; left time: 1639.9594s
Epoch: 13 cost time: 18.591485738754272
Epoch: 13, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0821789
	speed: 0.1748s/iter; left time: 7113.2742s
	iters: 200, epoch: 14 | loss: 0.0004006
	speed: 0.0390s/iter; left time: 1585.2515s
	iters: 300, epoch: 14 | loss: 0.0013219
	speed: 0.0403s/iter; left time: 1631.1509s
	iters: 400, epoch: 14 | loss: 0.0012594
	speed: 0.0369s/iter; left time: 1490.4344s
Epoch: 14 cost time: 18.52596616744995
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979987).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0135337
	speed: 0.1924s/iter; left time: 7741.9042s
	iters: 200, epoch: 15 | loss: 0.0015579
	speed: 0.0386s/iter; left time: 1548.8565s
	iters: 300, epoch: 15 | loss: 0.0000789
	speed: 0.0378s/iter; left time: 1512.9479s
	iters: 400, epoch: 15 | loss: 0.0406141
	speed: 0.0389s/iter; left time: 1552.6537s
Epoch: 15 cost time: 19.183504343032837
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0301481
	speed: 0.1909s/iter; left time: 7589.5845s
	iters: 200, epoch: 16 | loss: 0.0004731
	speed: 0.0369s/iter; left time: 1463.5635s
	iters: 300, epoch: 16 | loss: 0.0001571
	speed: 0.0385s/iter; left time: 1521.9430s
	iters: 400, epoch: 16 | loss: 0.0003105
	speed: 0.0393s/iter; left time: 1550.4013s
Epoch: 16 cost time: 18.432145357131958
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0005163
	speed: 0.1753s/iter; left time: 6887.8700s
	iters: 200, epoch: 17 | loss: 0.0001972
	speed: 0.0346s/iter; left time: 1354.3166s
	iters: 300, epoch: 17 | loss: 0.0002931
	speed: 0.0357s/iter; left time: 1395.0468s
	iters: 400, epoch: 17 | loss: 0.0064376
	speed: 0.0343s/iter; left time: 1338.9907s
Epoch: 17 cost time: 16.89536476135254
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0010202
	speed: 0.1660s/iter; left time: 6443.8751s
	iters: 200, epoch: 18 | loss: 0.0009065
	speed: 0.0366s/iter; left time: 1416.2670s
	iters: 300, epoch: 18 | loss: 0.0064386
	speed: 0.0368s/iter; left time: 1420.0287s
	iters: 400, epoch: 18 | loss: 0.0003821
	speed: 0.0369s/iter; left time: 1420.0157s
Epoch: 18 cost time: 17.81565523147583
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0001992
	speed: 0.1859s/iter; left time: 7132.0476s
	iters: 200, epoch: 19 | loss: 0.0002954
	speed: 0.0385s/iter; left time: 1474.5988s
	iters: 300, epoch: 19 | loss: 0.0008818
	speed: 0.0376s/iter; left time: 1434.6049s
	iters: 400, epoch: 19 | loss: 0.0004309
	speed: 0.0370s/iter; left time: 1407.9328s
Epoch: 19 cost time: 18.496138095855713
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.981989).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0001582
	speed: 0.1936s/iter; left time: 7334.9160s
	iters: 200, epoch: 20 | loss: 0.0915493
	speed: 0.0387s/iter; left time: 1461.4053s
	iters: 300, epoch: 20 | loss: 0.0012348
	speed: 0.0405s/iter; left time: 1525.3529s
	iters: 400, epoch: 20 | loss: 0.0005822
	speed: 0.0398s/iter; left time: 1494.7422s
Epoch: 20 cost time: 18.730664253234863
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0232322
	speed: 0.1758s/iter; left time: 6578.5042s
	iters: 200, epoch: 21 | loss: 0.0000186
	speed: 0.0389s/iter; left time: 1452.1792s
	iters: 300, epoch: 21 | loss: 0.0009074
	speed: 0.0379s/iter; left time: 1408.8967s
	iters: 400, epoch: 21 | loss: 0.0005258
	speed: 0.0355s/iter; left time: 1317.6379s
Epoch: 21 cost time: 18.292506217956543
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0296467
	speed: 0.1745s/iter; left time: 6449.0605s
	iters: 200, epoch: 22 | loss: 0.0013687
	speed: 0.0351s/iter; left time: 1295.0067s
	iters: 300, epoch: 22 | loss: 0.0004581
	speed: 0.0351s/iter; left time: 1288.9601s
	iters: 400, epoch: 22 | loss: 0.0058164
	speed: 0.0352s/iter; left time: 1289.0600s
Epoch: 22 cost time: 17.069778203964233
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0361030
	speed: 0.1788s/iter; left time: 6524.8744s
	iters: 200, epoch: 23 | loss: 0.0001030
	speed: 0.0377s/iter; left time: 1371.5248s
	iters: 300, epoch: 23 | loss: 0.0012156
	speed: 0.0362s/iter; left time: 1312.1225s
	iters: 400, epoch: 23 | loss: 0.0000406
	speed: 0.0396s/iter; left time: 1431.6715s
Epoch: 23 cost time: 18.2516508102417
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0000172
	speed: 0.1829s/iter; left time: 6585.7491s
	iters: 200, epoch: 24 | loss: 0.0000670
	speed: 0.0375s/iter; left time: 1346.5460s
	iters: 300, epoch: 24 | loss: 0.0003285
	speed: 0.0359s/iter; left time: 1286.9312s
	iters: 400, epoch: 24 | loss: 0.0107281
	speed: 0.0370s/iter; left time: 1322.3495s
Epoch: 24 cost time: 18.033015251159668
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.984 Test Loss: 0.120 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983704).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0115371
	speed: 0.1826s/iter; left time: 6490.7010s
	iters: 200, epoch: 25 | loss: 0.1392034
	speed: 0.0393s/iter; left time: 1393.0522s
	iters: 300, epoch: 25 | loss: 0.0005991
	speed: 0.0387s/iter; left time: 1368.9588s
	iters: 400, epoch: 25 | loss: 0.0017842
	speed: 0.0392s/iter; left time: 1382.4311s
Epoch: 25 cost time: 18.754709243774414
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000683
	speed: 0.1794s/iter; left time: 6290.8848s
	iters: 200, epoch: 26 | loss: 0.0553813
	speed: 0.0396s/iter; left time: 1385.6014s
	iters: 300, epoch: 26 | loss: 0.0005097
	speed: 0.0379s/iter; left time: 1322.8678s
	iters: 400, epoch: 26 | loss: 0.0003600
	speed: 0.0380s/iter; left time: 1321.8921s
Epoch: 26 cost time: 18.23738956451416
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0035132
	speed: 0.1841s/iter; left time: 6370.8162s
	iters: 200, epoch: 27 | loss: 0.0000901
	speed: 0.0381s/iter; left time: 1315.9428s
	iters: 300, epoch: 27 | loss: 0.0000421
	speed: 0.0372s/iter; left time: 1281.0533s
	iters: 400, epoch: 27 | loss: 0.0001468
	speed: 0.0368s/iter; left time: 1263.6845s
Epoch: 27 cost time: 18.431416273117065
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0005252
	speed: 0.1829s/iter; left time: 6243.6827s
	iters: 200, epoch: 28 | loss: 0.0005213
	speed: 0.0356s/iter; left time: 1212.0776s
	iters: 300, epoch: 28 | loss: 0.1865074
	speed: 0.0375s/iter; left time: 1271.7588s
	iters: 400, epoch: 28 | loss: 0.0214968
	speed: 0.0393s/iter; left time: 1329.3560s
Epoch: 28 cost time: 17.97540521621704
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0000644
	speed: 0.1706s/iter; left time: 5744.7124s
	iters: 200, epoch: 29 | loss: 0.0001086
	speed: 0.0421s/iter; left time: 1413.8434s
	iters: 300, epoch: 29 | loss: 0.0024396
	speed: 0.0386s/iter; left time: 1290.8889s
	iters: 400, epoch: 29 | loss: 0.0000518
	speed: 0.0367s/iter; left time: 1225.8038s
Epoch: 29 cost time: 18.564272165298462
Epoch: 29, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.2261738
	speed: 0.1712s/iter; left time: 5683.4132s
	iters: 200, epoch: 30 | loss: 0.0003010
	speed: 0.0325s/iter; left time: 1075.0647s
	iters: 300, epoch: 30 | loss: 0.0125130
	speed: 0.0337s/iter; left time: 1111.6576s
	iters: 400, epoch: 30 | loss: 0.0000035
	speed: 0.0359s/iter; left time: 1182.1241s
Epoch: 30 cost time: 16.859460830688477
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0750433
	speed: 0.1808s/iter; left time: 5918.2842s
	iters: 200, epoch: 31 | loss: 0.0000906
	speed: 0.0401s/iter; left time: 1307.5587s
	iters: 300, epoch: 31 | loss: 0.0000125
	speed: 0.0389s/iter; left time: 1266.2909s
	iters: 400, epoch: 31 | loss: 0.0007598
	speed: 0.0380s/iter; left time: 1233.8511s
Epoch: 31 cost time: 18.712614059448242
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0015705
	speed: 0.1937s/iter; left time: 6250.3501s
	iters: 200, epoch: 32 | loss: 0.1694709
	speed: 0.0413s/iter; left time: 1327.7203s
	iters: 300, epoch: 32 | loss: 0.0006645
	speed: 0.0393s/iter; left time: 1259.1023s
	iters: 400, epoch: 32 | loss: 0.4643595
	speed: 0.0377s/iter; left time: 1203.6168s
Epoch: 32 cost time: 19.143435955047607
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0007565
	speed: 0.1832s/iter; left time: 5823.5551s
	iters: 200, epoch: 33 | loss: 0.0003601
	speed: 0.0384s/iter; left time: 1217.7830s
	iters: 300, epoch: 33 | loss: 0.0001232
	speed: 0.0397s/iter; left time: 1253.1814s
	iters: 400, epoch: 33 | loss: 0.0162942
	speed: 0.0383s/iter; left time: 1206.2506s
Epoch: 33 cost time: 18.327393054962158
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0002936
	speed: 0.1742s/iter; left time: 5455.9558s
	iters: 200, epoch: 34 | loss: 0.0024840
	speed: 0.0383s/iter; left time: 1195.4403s
	iters: 300, epoch: 34 | loss: 0.0016297
	speed: 0.0374s/iter; left time: 1163.7710s
	iters: 400, epoch: 34 | loss: 0.0272202
	speed: 0.0365s/iter; left time: 1133.6474s
Epoch: 34 cost time: 17.68048071861267
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 145722
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7691038
	speed: 0.0531s/iter; left time: 2485.9019s
	iters: 200, epoch: 1 | loss: 0.5246531
	speed: 0.0351s/iter; left time: 1640.8090s
	iters: 300, epoch: 1 | loss: 0.4120337
	speed: 0.0350s/iter; left time: 1629.4151s
	iters: 400, epoch: 1 | loss: 0.2737999
	speed: 0.0372s/iter; left time: 1731.3202s
Epoch: 1 cost time: 18.73074960708618
Epoch: 1, Steps: 469 | Train Loss: 0.599 Vali Loss: 0.308 Vali Acc: 0.901 Test Loss: 0.308 Test Acc: 0.901
Validation loss decreased (inf --> -0.901083).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0462408
	speed: 0.1838s/iter; left time: 8517.4423s
	iters: 200, epoch: 2 | loss: 0.0903381
	speed: 0.0424s/iter; left time: 1959.3539s
	iters: 300, epoch: 2 | loss: 0.3522286
	speed: 0.0391s/iter; left time: 1803.6239s
	iters: 400, epoch: 2 | loss: 0.0754317
	speed: 0.0381s/iter; left time: 1754.7625s
Epoch: 2 cost time: 19.298611640930176
Epoch: 2, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.901083 --> -0.947682).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0234166
	speed: 0.1862s/iter; left time: 8538.0699s
	iters: 200, epoch: 3 | loss: 0.1375629
	speed: 0.0365s/iter; left time: 1670.8007s
	iters: 300, epoch: 3 | loss: 0.0249963
	speed: 0.0401s/iter; left time: 1829.4527s
	iters: 400, epoch: 3 | loss: 0.0865605
	speed: 0.0398s/iter; left time: 1814.8923s
Epoch: 3 cost time: 18.46486258506775
Epoch: 3, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1612909
	speed: 0.1797s/iter; left time: 8156.3006s
	iters: 200, epoch: 4 | loss: 0.1124563
	speed: 0.0375s/iter; left time: 1700.7403s
	iters: 300, epoch: 4 | loss: 0.3764077
	speed: 0.0355s/iter; left time: 1606.0318s
	iters: 400, epoch: 4 | loss: 0.0109382
	speed: 0.0347s/iter; left time: 1564.6686s
Epoch: 4 cost time: 17.59167504310608
Epoch: 4, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.947682 --> -0.961691).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0269726
	speed: 0.1750s/iter; left time: 7862.3502s
	iters: 200, epoch: 5 | loss: 0.0256935
	speed: 0.0361s/iter; left time: 1619.3797s
	iters: 300, epoch: 5 | loss: 0.0056591
	speed: 0.0366s/iter; left time: 1637.5937s
	iters: 400, epoch: 5 | loss: 0.0014294
	speed: 0.0366s/iter; left time: 1632.0185s
Epoch: 5 cost time: 17.42465829849243
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.967409).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0046677
	speed: 0.1675s/iter; left time: 7445.0714s
	iters: 200, epoch: 6 | loss: 0.3522719
	speed: 0.0371s/iter; left time: 1644.5308s
	iters: 300, epoch: 6 | loss: 0.1070130
	speed: 0.0401s/iter; left time: 1775.4611s
	iters: 400, epoch: 6 | loss: 0.0272649
	speed: 0.0418s/iter; left time: 1845.6644s
Epoch: 6 cost time: 18.606086254119873
Epoch: 6, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.967409 --> -0.973698).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1112501
	speed: 0.1914s/iter; left time: 8419.0833s
	iters: 200, epoch: 7 | loss: 0.0384541
	speed: 0.0381s/iter; left time: 1674.2568s
	iters: 300, epoch: 7 | loss: 0.0049942
	speed: 0.0391s/iter; left time: 1712.2451s
	iters: 400, epoch: 7 | loss: 0.1528615
	speed: 0.0405s/iter; left time: 1770.5388s
Epoch: 7 cost time: 19.302242279052734
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0711302
	speed: 0.1915s/iter; left time: 8334.2276s
	iters: 200, epoch: 8 | loss: 0.0079747
	speed: 0.0389s/iter; left time: 1688.2088s
	iters: 300, epoch: 8 | loss: 0.0088855
	speed: 0.0390s/iter; left time: 1688.2960s
	iters: 400, epoch: 8 | loss: 0.0074915
	speed: 0.0377s/iter; left time: 1628.4349s
Epoch: 8 cost time: 18.349822759628296
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.973698 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2276894
	speed: 0.1777s/iter; left time: 7651.2265s
	iters: 200, epoch: 9 | loss: 0.0111003
	speed: 0.0364s/iter; left time: 1562.3183s
	iters: 300, epoch: 9 | loss: 0.0020970
	speed: 0.0360s/iter; left time: 1544.5620s
	iters: 400, epoch: 9 | loss: 0.0059482
	speed: 0.0363s/iter; left time: 1550.9292s
Epoch: 9 cost time: 17.590714693069458
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979130).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0142558
	speed: 0.1822s/iter; left time: 7756.9767s
	iters: 200, epoch: 10 | loss: 0.0095145
	speed: 0.0355s/iter; left time: 1507.2383s
	iters: 300, epoch: 10 | loss: 0.0136762
	speed: 0.0381s/iter; left time: 1615.5420s
	iters: 400, epoch: 10 | loss: 0.0492038
	speed: 0.0391s/iter; left time: 1653.2290s
Epoch: 10 cost time: 18.213804244995117
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0101186
	speed: 0.1857s/iter; left time: 7820.7134s
	iters: 200, epoch: 11 | loss: 0.0110920
	speed: 0.0372s/iter; left time: 1564.7918s
	iters: 300, epoch: 11 | loss: 0.0024744
	speed: 0.0387s/iter; left time: 1622.6791s
	iters: 400, epoch: 11 | loss: 0.0052879
	speed: 0.0374s/iter; left time: 1564.7862s
Epoch: 11 cost time: 18.35343313217163
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0028583
	speed: 0.1870s/iter; left time: 7787.0689s
	iters: 200, epoch: 12 | loss: 0.0205567
	speed: 0.0373s/iter; left time: 1548.0144s
	iters: 300, epoch: 12 | loss: 0.6814393
	speed: 0.0391s/iter; left time: 1619.2519s
	iters: 400, epoch: 12 | loss: 0.0035126
	speed: 0.0405s/iter; left time: 1675.9318s
Epoch: 12 cost time: 18.839749813079834
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0020392
	speed: 0.1818s/iter; left time: 7486.6421s
	iters: 200, epoch: 13 | loss: 0.0026614
	speed: 0.0383s/iter; left time: 1571.7026s
	iters: 300, epoch: 13 | loss: 0.0004469
	speed: 0.0405s/iter; left time: 1661.0156s
	iters: 400, epoch: 13 | loss: 0.1307086
	speed: 0.0391s/iter; left time: 1597.1086s
Epoch: 13 cost time: 18.62525725364685
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980845).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0045092
	speed: 0.1731s/iter; left time: 7046.6581s
	iters: 200, epoch: 14 | loss: 0.0097499
	speed: 0.0345s/iter; left time: 1401.9520s
	iters: 300, epoch: 14 | loss: 0.1144416
	speed: 0.0351s/iter; left time: 1420.4600s
	iters: 400, epoch: 14 | loss: 0.0600232
	speed: 0.0348s/iter; left time: 1407.7777s
Epoch: 14 cost time: 16.910588264465332
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0013728
	speed: 0.1834s/iter; left time: 7377.8957s
	iters: 200, epoch: 15 | loss: 0.0067696
	speed: 0.0361s/iter; left time: 1448.8667s
	iters: 300, epoch: 15 | loss: 0.0051888
	speed: 0.0395s/iter; left time: 1582.7795s
	iters: 400, epoch: 15 | loss: 0.0098733
	speed: 0.0360s/iter; left time: 1438.2923s
Epoch: 15 cost time: 18.135433435440063
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0009403
	speed: 0.1762s/iter; left time: 7008.4546s
	iters: 200, epoch: 16 | loss: 0.0005554
	speed: 0.0351s/iter; left time: 1392.3109s
	iters: 300, epoch: 16 | loss: 0.0003993
	speed: 0.0379s/iter; left time: 1498.7830s
	iters: 400, epoch: 16 | loss: 0.0784653
	speed: 0.0417s/iter; left time: 1646.6047s
Epoch: 16 cost time: 18.125030755996704
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0012307
	speed: 0.1796s/iter; left time: 7057.1163s
	iters: 200, epoch: 17 | loss: 0.0012429
	speed: 0.0401s/iter; left time: 1572.6219s
	iters: 300, epoch: 17 | loss: 0.0038815
	speed: 0.0387s/iter; left time: 1511.2478s
	iters: 400, epoch: 17 | loss: 0.0430234
	speed: 0.0361s/iter; left time: 1408.4621s
Epoch: 17 cost time: 18.42285418510437
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0061054
	speed: 0.1789s/iter; left time: 6946.5154s
	iters: 200, epoch: 18 | loss: 0.0083875
	speed: 0.0384s/iter; left time: 1487.7581s
	iters: 300, epoch: 18 | loss: 0.0043715
	speed: 0.0380s/iter; left time: 1469.1629s
	iters: 400, epoch: 18 | loss: 0.0055159
	speed: 0.0399s/iter; left time: 1538.5793s
Epoch: 18 cost time: 18.7592933177948
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0006356
	speed: 0.1867s/iter; left time: 7161.7616s
	iters: 200, epoch: 19 | loss: 0.0702660
	speed: 0.0389s/iter; left time: 1489.6749s
	iters: 300, epoch: 19 | loss: 0.0385243
	speed: 0.0418s/iter; left time: 1595.7788s
	iters: 400, epoch: 19 | loss: 0.0907117
	speed: 0.0420s/iter; left time: 1599.5406s
Epoch: 19 cost time: 19.086717128753662
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.2610212
	speed: 0.1822s/iter; left time: 6905.1884s
	iters: 200, epoch: 20 | loss: 0.0003231
	speed: 0.0376s/iter; left time: 1421.1033s
	iters: 300, epoch: 20 | loss: 0.0062671
	speed: 0.0392s/iter; left time: 1478.6684s
	iters: 400, epoch: 20 | loss: 0.0022452
	speed: 0.0397s/iter; left time: 1493.1235s
Epoch: 20 cost time: 18.5163516998291
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000685
	speed: 0.1762s/iter; left time: 6591.9400s
	iters: 200, epoch: 21 | loss: 0.0005560
	speed: 0.0370s/iter; left time: 1382.0981s
	iters: 300, epoch: 21 | loss: 0.0031991
	speed: 0.0361s/iter; left time: 1342.6109s
	iters: 400, epoch: 21 | loss: 0.0001355
	speed: 0.0362s/iter; left time: 1342.2012s
Epoch: 21 cost time: 17.62788414955139
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0002819
	speed: 0.1793s/iter; left time: 6626.9445s
	iters: 200, epoch: 22 | loss: 0.0034623
	speed: 0.0370s/iter; left time: 1365.1079s
	iters: 300, epoch: 22 | loss: 0.0051947
	speed: 0.0388s/iter; left time: 1425.8342s
	iters: 400, epoch: 22 | loss: 0.0020493
	speed: 0.0420s/iter; left time: 1539.2549s
Epoch: 22 cost time: 18.81692671775818
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0019008
	speed: 0.1814s/iter; left time: 6616.8680s
	iters: 200, epoch: 23 | loss: 0.0009194
	speed: 0.0418s/iter; left time: 1520.9535s
	iters: 300, epoch: 23 | loss: 0.0132430
	speed: 0.0420s/iter; left time: 1522.4990s
	iters: 400, epoch: 23 | loss: 0.0002988
	speed: 0.0393s/iter; left time: 1420.5350s
Epoch: 23 cost time: 19.23756241798401
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 112954
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7992944
	speed: 0.0564s/iter; left time: 2640.8911s
	iters: 200, epoch: 1 | loss: 0.5040734
	speed: 0.0376s/iter; left time: 1754.5715s
	iters: 300, epoch: 1 | loss: 0.4014862
	speed: 0.0380s/iter; left time: 1773.0993s
	iters: 400, epoch: 1 | loss: 0.2727496
	speed: 0.0377s/iter; left time: 1753.7674s
Epoch: 1 cost time: 19.72774863243103
Epoch: 1, Steps: 469 | Train Loss: 0.592 Vali Loss: 0.281 Vali Acc: 0.924 Test Loss: 0.281 Test Acc: 0.924
Validation loss decreased (inf --> -0.923668).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0425084
	speed: 0.1773s/iter; left time: 8215.7508s
	iters: 200, epoch: 2 | loss: 0.0644200
	speed: 0.0369s/iter; left time: 1706.3111s
	iters: 300, epoch: 2 | loss: 0.2498813
	speed: 0.0375s/iter; left time: 1729.8742s
	iters: 400, epoch: 2 | loss: 0.0896280
	speed: 0.0374s/iter; left time: 1720.8416s
Epoch: 2 cost time: 17.854260206222534
Epoch: 2, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.923668 --> -0.954258).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0199942
	speed: 0.1807s/iter; left time: 8289.1870s
	iters: 200, epoch: 3 | loss: 0.0254020
	speed: 0.0385s/iter; left time: 1761.2148s
	iters: 300, epoch: 3 | loss: 0.0109014
	speed: 0.0411s/iter; left time: 1877.6533s
	iters: 400, epoch: 3 | loss: 0.0236571
	speed: 0.0431s/iter; left time: 1961.7849s
Epoch: 3 cost time: 19.445417165756226
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1105403
	speed: 0.1896s/iter; left time: 8608.0202s
	iters: 200, epoch: 4 | loss: 0.1066622
	speed: 0.0428s/iter; left time: 1936.3725s
	iters: 300, epoch: 4 | loss: 0.4987637
	speed: 0.0401s/iter; left time: 1812.2964s
	iters: 400, epoch: 4 | loss: 0.0176963
	speed: 0.0411s/iter; left time: 1855.0557s
Epoch: 4 cost time: 19.71886920928955
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.954258 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0207996
	speed: 0.1883s/iter; left time: 8458.5867s
	iters: 200, epoch: 5 | loss: 0.0367823
	speed: 0.0375s/iter; left time: 1679.3523s
	iters: 300, epoch: 5 | loss: 0.0015561
	speed: 0.0373s/iter; left time: 1666.1192s
	iters: 400, epoch: 5 | loss: 0.0013552
	speed: 0.0383s/iter; left time: 1707.3154s
Epoch: 5 cost time: 18.11112380027771
Epoch: 5, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0314364
	speed: 0.1754s/iter; left time: 7799.1143s
	iters: 200, epoch: 6 | loss: 0.1963975
	speed: 0.0377s/iter; left time: 1672.8752s
	iters: 300, epoch: 6 | loss: 0.0996786
	speed: 0.0378s/iter; left time: 1670.9371s
	iters: 400, epoch: 6 | loss: 0.0369196
	speed: 0.0369s/iter; left time: 1630.4757s
Epoch: 6 cost time: 18.069977045059204
Epoch: 6, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.963120 --> -0.967695).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0554188
	speed: 0.1827s/iter; left time: 8038.1102s
	iters: 200, epoch: 7 | loss: 0.0108096
	speed: 0.0398s/iter; left time: 1748.4831s
	iters: 300, epoch: 7 | loss: 0.0178313
	speed: 0.0377s/iter; left time: 1650.1517s
	iters: 400, epoch: 7 | loss: 0.0692627
	speed: 0.0383s/iter; left time: 1674.8071s
Epoch: 7 cost time: 18.64200496673584
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0559075
	speed: 0.1829s/iter; left time: 7958.9893s
	iters: 200, epoch: 8 | loss: 0.0065879
	speed: 0.0389s/iter; left time: 1690.2111s
	iters: 300, epoch: 8 | loss: 0.0059239
	speed: 0.0391s/iter; left time: 1695.1058s
	iters: 400, epoch: 8 | loss: 0.0030298
	speed: 0.0428s/iter; left time: 1849.4701s
Epoch: 8 cost time: 19.25106191635132
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.967695 --> -0.971697).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0377006
	speed: 0.1893s/iter; left time: 8148.3206s
	iters: 200, epoch: 9 | loss: 0.0129146
	speed: 0.0406s/iter; left time: 1745.4273s
	iters: 300, epoch: 9 | loss: 0.0023077
	speed: 0.0388s/iter; left time: 1663.8675s
	iters: 400, epoch: 9 | loss: 0.0196019
	speed: 0.0376s/iter; left time: 1606.8531s
Epoch: 9 cost time: 18.555559158325195
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0211173
	speed: 0.1753s/iter; left time: 7462.9098s
	iters: 200, epoch: 10 | loss: 0.0111372
	speed: 0.0381s/iter; left time: 1618.5452s
	iters: 300, epoch: 10 | loss: 0.0166625
	speed: 0.0376s/iter; left time: 1591.9582s
	iters: 400, epoch: 10 | loss: 0.0217194
	speed: 0.0379s/iter; left time: 1602.6468s
Epoch: 10 cost time: 18.16493010520935
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0187636
	speed: 0.1792s/iter; left time: 7545.6312s
	iters: 200, epoch: 11 | loss: 0.0034877
	speed: 0.0383s/iter; left time: 1607.4406s
	iters: 300, epoch: 11 | loss: 0.0003527
	speed: 0.0402s/iter; left time: 1683.3198s
	iters: 400, epoch: 11 | loss: 0.0007789
	speed: 0.0387s/iter; left time: 1616.3247s
Epoch: 11 cost time: 18.365864992141724
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.971697 --> -0.976557).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0069792
	speed: 0.1809s/iter; left time: 7531.7128s
	iters: 200, epoch: 12 | loss: 0.0048962
	speed: 0.0371s/iter; left time: 1540.6811s
	iters: 300, epoch: 12 | loss: 0.7463648
	speed: 0.0376s/iter; left time: 1557.4179s
	iters: 400, epoch: 12 | loss: 0.0189186
	speed: 0.0387s/iter; left time: 1600.0318s
Epoch: 12 cost time: 18.375314712524414
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0005465
	speed: 0.1825s/iter; left time: 7512.5125s
	iters: 200, epoch: 13 | loss: 0.0044082
	speed: 0.0369s/iter; left time: 1517.4219s
	iters: 300, epoch: 13 | loss: 0.0026605
	speed: 0.0379s/iter; left time: 1551.9842s
	iters: 400, epoch: 13 | loss: 0.1022673
	speed: 0.0362s/iter; left time: 1478.8486s
Epoch: 13 cost time: 17.97145438194275
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.978272).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0182985
	speed: 0.1786s/iter; left time: 7267.7392s
	iters: 200, epoch: 14 | loss: 0.0015511
	speed: 0.0392s/iter; left time: 1592.8844s
	iters: 300, epoch: 14 | loss: 0.0387776
	speed: 0.0377s/iter; left time: 1526.4624s
	iters: 400, epoch: 14 | loss: 0.0052604
	speed: 0.0380s/iter; left time: 1534.8431s
Epoch: 14 cost time: 18.412058115005493
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0007239
	speed: 0.1735s/iter; left time: 6981.7114s
	iters: 200, epoch: 15 | loss: 0.0473543
	speed: 0.0366s/iter; left time: 1468.8071s
	iters: 300, epoch: 15 | loss: 0.0907441
	speed: 0.0367s/iter; left time: 1469.3280s
	iters: 400, epoch: 15 | loss: 0.0168198
	speed: 0.0425s/iter; left time: 1696.0364s
Epoch: 15 cost time: 18.59995436668396
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0513208
	speed: 0.1953s/iter; left time: 7765.1817s
	iters: 200, epoch: 16 | loss: 0.0029231
	speed: 0.0410s/iter; left time: 1627.5914s
	iters: 300, epoch: 16 | loss: 0.0010339
	speed: 0.0439s/iter; left time: 1736.4552s
	iters: 400, epoch: 16 | loss: 0.2087373
	speed: 0.0426s/iter; left time: 1679.3739s
Epoch: 16 cost time: 19.96523666381836
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0004316
	speed: 0.1887s/iter; left time: 7417.2058s
	iters: 200, epoch: 17 | loss: 0.0027330
	speed: 0.0393s/iter; left time: 1538.9932s
	iters: 300, epoch: 17 | loss: 0.0013589
	speed: 0.0379s/iter; left time: 1481.6156s
	iters: 400, epoch: 17 | loss: 0.0508902
	speed: 0.0377s/iter; left time: 1472.0064s
Epoch: 17 cost time: 18.31822156906128
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001378
	speed: 0.1755s/iter; left time: 6815.0082s
	iters: 200, epoch: 18 | loss: 0.0266165
	speed: 0.0376s/iter; left time: 1457.0844s
	iters: 300, epoch: 18 | loss: 0.0060358
	speed: 0.0365s/iter; left time: 1409.0347s
	iters: 400, epoch: 18 | loss: 0.0105583
	speed: 0.0377s/iter; left time: 1451.7366s
Epoch: 18 cost time: 17.894742488861084
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0015964
	speed: 0.1810s/iter; left time: 6943.4404s
	iters: 200, epoch: 19 | loss: 0.3188142
	speed: 0.0396s/iter; left time: 1515.2338s
	iters: 300, epoch: 19 | loss: 0.0065319
	speed: 0.0410s/iter; left time: 1563.6888s
	iters: 400, epoch: 19 | loss: 0.0016751
	speed: 0.0398s/iter; left time: 1515.1019s
Epoch: 19 cost time: 18.899084329605103
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.979701).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2826826
	speed: 0.1831s/iter; left time: 6937.6767s
	iters: 200, epoch: 20 | loss: 0.0013133
	speed: 0.0388s/iter; left time: 1467.7795s
	iters: 300, epoch: 20 | loss: 0.0085636
	speed: 0.0397s/iter; left time: 1497.5853s
	iters: 400, epoch: 20 | loss: 0.0123933
	speed: 0.0415s/iter; left time: 1558.1228s
Epoch: 20 cost time: 19.056716680526733
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001979
	speed: 0.1875s/iter; left time: 7015.0396s
	iters: 200, epoch: 21 | loss: 0.0001149
	speed: 0.0382s/iter; left time: 1427.1741s
	iters: 300, epoch: 21 | loss: 0.0006775
	speed: 0.0403s/iter; left time: 1498.9645s
	iters: 400, epoch: 21 | loss: 0.0004860
	speed: 0.0397s/iter; left time: 1474.7284s
Epoch: 21 cost time: 18.677898168563843
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0021398
	speed: 0.1718s/iter; left time: 6349.2211s
	iters: 200, epoch: 22 | loss: 0.0310141
	speed: 0.0372s/iter; left time: 1369.6236s
	iters: 300, epoch: 22 | loss: 0.0101919
	speed: 0.0369s/iter; left time: 1355.6216s
	iters: 400, epoch: 22 | loss: 0.0042160
	speed: 0.0377s/iter; left time: 1381.7309s
Epoch: 22 cost time: 17.838425397872925
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0167978
	speed: 0.1833s/iter; left time: 6685.8293s
	iters: 200, epoch: 23 | loss: 0.0002966
	speed: 0.0377s/iter; left time: 1370.1277s
	iters: 300, epoch: 23 | loss: 0.0069823
	speed: 0.0384s/iter; left time: 1392.4715s
	iters: 400, epoch: 23 | loss: 0.0061915
	speed: 0.0420s/iter; left time: 1519.6456s
Epoch: 23 cost time: 18.879798412322998
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0034934
	speed: 0.1841s/iter; left time: 6630.8870s
	iters: 200, epoch: 24 | loss: 0.0334475
	speed: 0.0398s/iter; left time: 1429.1641s
	iters: 300, epoch: 24 | loss: 0.0017188
	speed: 0.0413s/iter; left time: 1479.9823s
	iters: 400, epoch: 24 | loss: 0.0654896
	speed: 0.0379s/iter; left time: 1354.5865s
Epoch: 24 cost time: 18.723020553588867
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
Validation loss decreased (-0.979701 --> -0.980559).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0002410
	speed: 0.1794s/iter; left time: 6375.3945s
	iters: 200, epoch: 25 | loss: 0.0002320
	speed: 0.0364s/iter; left time: 1289.1228s
	iters: 300, epoch: 25 | loss: 0.0001263
	speed: 0.0364s/iter; left time: 1286.8509s
	iters: 400, epoch: 25 | loss: 0.0116698
	speed: 0.0364s/iter; left time: 1281.9554s
Epoch: 25 cost time: 17.639445543289185
Epoch: 25, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0966282
	speed: 0.1812s/iter; left time: 6355.5216s
	iters: 200, epoch: 26 | loss: 0.0004500
	speed: 0.0370s/iter; left time: 1293.3889s
	iters: 300, epoch: 26 | loss: 0.0045733
	speed: 0.0403s/iter; left time: 1406.6288s
	iters: 400, epoch: 26 | loss: 0.0022942
	speed: 0.0398s/iter; left time: 1383.5242s
Epoch: 26 cost time: 18.81592893600464
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0108605
	speed: 0.1888s/iter; left time: 6533.7014s
	iters: 200, epoch: 27 | loss: 0.0007350
	speed: 0.0421s/iter; left time: 1452.0202s
	iters: 300, epoch: 27 | loss: 0.0065170
	speed: 0.0415s/iter; left time: 1429.1700s
	iters: 400, epoch: 27 | loss: 0.0011233
	speed: 0.0404s/iter; left time: 1385.5859s
Epoch: 27 cost time: 19.603098392486572
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0076627
	speed: 0.1831s/iter; left time: 6250.9497s
	iters: 200, epoch: 28 | loss: 0.0000131
	speed: 0.0371s/iter; left time: 1264.4793s
	iters: 300, epoch: 28 | loss: 0.0016489
	speed: 0.0380s/iter; left time: 1290.2534s
	iters: 400, epoch: 28 | loss: 0.0006767
	speed: 0.0398s/iter; left time: 1347.6388s
Epoch: 28 cost time: 18.362736225128174
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0029966
	speed: 0.1734s/iter; left time: 5838.4918s
	iters: 200, epoch: 29 | loss: 0.0052043
	speed: 0.0338s/iter; left time: 1134.7060s
	iters: 300, epoch: 29 | loss: 0.0001642
	speed: 0.0354s/iter; left time: 1184.0508s
	iters: 400, epoch: 29 | loss: 0.0019047
	speed: 0.0350s/iter; left time: 1168.9543s
Epoch: 29 cost time: 16.823397874832153
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0014618
	speed: 0.1747s/iter; left time: 5800.4750s
	iters: 200, epoch: 30 | loss: 0.0000787
	speed: 0.0388s/iter; left time: 1283.8039s
	iters: 300, epoch: 30 | loss: 0.0270323
	speed: 0.0369s/iter; left time: 1217.6822s
	iters: 400, epoch: 30 | loss: 0.0000039
	speed: 0.0366s/iter; left time: 1205.6480s
Epoch: 30 cost time: 18.05353546142578
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0000114
	speed: 0.1894s/iter; left time: 6198.4125s
	iters: 200, epoch: 31 | loss: 0.0000724
	speed: 0.0398s/iter; left time: 1300.2102s
	iters: 300, epoch: 31 | loss: 0.0002835
	speed: 0.0379s/iter; left time: 1233.7471s
	iters: 400, epoch: 31 | loss: 0.0006580
	speed: 0.0389s/iter; left time: 1260.1735s
Epoch: 31 cost time: 19.183029174804688
Epoch: 31, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0008786
	speed: 0.1954s/iter; left time: 6305.5531s
	iters: 200, epoch: 32 | loss: 0.0005704
	speed: 0.0417s/iter; left time: 1341.7495s
	iters: 300, epoch: 32 | loss: 0.0434087
	speed: 0.0426s/iter; left time: 1366.0843s
	iters: 400, epoch: 32 | loss: 0.0001274
	speed: 0.0421s/iter; left time: 1347.1744s
Epoch: 32 cost time: 19.89353036880493
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0001947
	speed: 0.1846s/iter; left time: 5869.0758s
	iters: 200, epoch: 33 | loss: 0.0000366
	speed: 0.0381s/iter; left time: 1208.8268s
	iters: 300, epoch: 33 | loss: 0.0001110
	speed: 0.0366s/iter; left time: 1156.0053s
	iters: 400, epoch: 33 | loss: 0.0004829
	speed: 0.0370s/iter; left time: 1165.0976s
Epoch: 33 cost time: 18.056904792785645
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0001263
	speed: 0.1778s/iter; left time: 5568.6985s
	iters: 200, epoch: 34 | loss: 0.0587104
	speed: 0.0369s/iter; left time: 1153.0667s
	iters: 300, epoch: 34 | loss: 0.0001010
	speed: 0.0382s/iter; left time: 1187.6099s
	iters: 400, epoch: 34 | loss: 0.1008135
	speed: 0.0378s/iter; left time: 1171.2731s
Epoch: 34 cost time: 18.178719997406006
Epoch: 34, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 112954
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7006918
	speed: 0.0562s/iter; left time: 2630.5666s
	iters: 200, epoch: 1 | loss: 0.5350803
	speed: 0.0377s/iter; left time: 1759.3961s
	iters: 300, epoch: 1 | loss: 0.3535407
	speed: 0.0372s/iter; left time: 1733.1653s
	iters: 400, epoch: 1 | loss: 0.1801971
	speed: 0.0389s/iter; left time: 1810.4485s
Epoch: 1 cost time: 19.863828420639038
Epoch: 1, Steps: 469 | Train Loss: 0.578 Vali Loss: 0.268 Vali Acc: 0.924 Test Loss: 0.268 Test Acc: 0.924
Validation loss decreased (inf --> -0.923954).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0245368
	speed: 0.1858s/iter; left time: 8607.5625s
	iters: 200, epoch: 2 | loss: 0.0420603
	speed: 0.0416s/iter; left time: 1925.0706s
	iters: 300, epoch: 2 | loss: 0.1060535
	speed: 0.0391s/iter; left time: 1805.0696s
	iters: 400, epoch: 2 | loss: 0.0531281
	speed: 0.0379s/iter; left time: 1745.2960s
Epoch: 2 cost time: 18.955809354782104
Epoch: 2, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.923954 --> -0.962834).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0185368
	speed: 0.1691s/iter; left time: 7753.8703s
	iters: 200, epoch: 3 | loss: 0.0326518
	speed: 0.0330s/iter; left time: 1511.5292s
	iters: 300, epoch: 3 | loss: 0.0049099
	speed: 0.0349s/iter; left time: 1593.0409s
	iters: 400, epoch: 3 | loss: 0.0044948
	speed: 0.0342s/iter; left time: 1556.3707s
Epoch: 3 cost time: 16.463087558746338
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0169903
	speed: 0.1737s/iter; left time: 7883.3184s
	iters: 200, epoch: 4 | loss: 0.0118088
	speed: 0.0352s/iter; left time: 1592.9318s
	iters: 300, epoch: 4 | loss: 0.5285823
	speed: 0.0353s/iter; left time: 1596.3883s
	iters: 400, epoch: 4 | loss: 0.0054586
	speed: 0.0363s/iter; left time: 1635.6191s
Epoch: 4 cost time: 17.313339233398438
Epoch: 4, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.962834 --> -0.965121).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0475542
	speed: 0.1767s/iter; left time: 7940.2524s
	iters: 200, epoch: 5 | loss: 0.1770133
	speed: 0.0379s/iter; left time: 1697.9791s
	iters: 300, epoch: 5 | loss: 0.0019700
	speed: 0.0394s/iter; left time: 1762.0689s
	iters: 400, epoch: 5 | loss: 0.0192382
	speed: 0.0368s/iter; left time: 1642.0962s
Epoch: 5 cost time: 18.036405324935913
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
Validation loss decreased (-0.965121 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0029904
	speed: 0.1800s/iter; left time: 8004.0075s
	iters: 200, epoch: 6 | loss: 0.0984002
	speed: 0.0367s/iter; left time: 1627.0564s
	iters: 300, epoch: 6 | loss: 0.0961838
	speed: 0.0366s/iter; left time: 1621.9709s
	iters: 400, epoch: 6 | loss: 0.0011010
	speed: 0.0394s/iter; left time: 1740.7890s
Epoch: 6 cost time: 18.39557909965515
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.966265 --> -0.977986).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2043633
	speed: 0.1754s/iter; left time: 7716.9048s
	iters: 200, epoch: 7 | loss: 0.0486439
	speed: 0.0385s/iter; left time: 1690.6698s
	iters: 300, epoch: 7 | loss: 0.0009577
	speed: 0.0383s/iter; left time: 1678.0400s
	iters: 400, epoch: 7 | loss: 0.0048670
	speed: 0.0384s/iter; left time: 1679.5356s
Epoch: 7 cost time: 17.98737645149231
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0162469
	speed: 0.1737s/iter; left time: 7560.7964s
	iters: 200, epoch: 8 | loss: 0.0098821
	speed: 0.0393s/iter; left time: 1707.7144s
	iters: 300, epoch: 8 | loss: 0.0316456
	speed: 0.0391s/iter; left time: 1693.6075s
	iters: 400, epoch: 8 | loss: 0.0025412
	speed: 0.0375s/iter; left time: 1622.6816s
Epoch: 8 cost time: 18.021793127059937
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0225514
	speed: 0.1727s/iter; left time: 7434.2770s
	iters: 200, epoch: 9 | loss: 0.0179178
	speed: 0.0367s/iter; left time: 1574.1005s
	iters: 300, epoch: 9 | loss: 0.0005893
	speed: 0.0376s/iter; left time: 1610.0726s
	iters: 400, epoch: 9 | loss: 0.0003003
	speed: 0.0372s/iter; left time: 1589.1290s
Epoch: 9 cost time: 17.691322088241577
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1596488
	speed: 0.1790s/iter; left time: 7623.1935s
	iters: 200, epoch: 10 | loss: 0.0007682
	speed: 0.0365s/iter; left time: 1551.0901s
	iters: 300, epoch: 10 | loss: 0.0027079
	speed: 0.0391s/iter; left time: 1658.5263s
	iters: 400, epoch: 10 | loss: 0.0319988
	speed: 0.0369s/iter; left time: 1560.0039s
Epoch: 10 cost time: 17.85615301132202
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.979416).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0162446
	speed: 0.1640s/iter; left time: 6907.8108s
	iters: 200, epoch: 11 | loss: 0.0014420
	speed: 0.0351s/iter; left time: 1473.1303s
	iters: 300, epoch: 11 | loss: 0.0000376
	speed: 0.0345s/iter; left time: 1444.5456s
	iters: 400, epoch: 11 | loss: 0.0008989
	speed: 0.0343s/iter; left time: 1434.6691s
Epoch: 11 cost time: 16.781769037246704
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980559).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0162896
	speed: 0.1721s/iter; left time: 7165.1284s
	iters: 200, epoch: 12 | loss: 0.0055294
	speed: 0.0358s/iter; left time: 1485.6845s
	iters: 300, epoch: 12 | loss: 1.0428051
	speed: 0.0346s/iter; left time: 1433.4151s
	iters: 400, epoch: 12 | loss: 0.0018365
	speed: 0.0346s/iter; left time: 1429.6080s
Epoch: 12 cost time: 17.151023626327515
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001336
	speed: 0.1861s/iter; left time: 7662.7246s
	iters: 200, epoch: 13 | loss: 0.0034568
	speed: 0.0416s/iter; left time: 1707.8769s
	iters: 300, epoch: 13 | loss: 0.0001009
	speed: 0.0419s/iter; left time: 1718.5205s
	iters: 400, epoch: 13 | loss: 0.0688870
	speed: 0.0411s/iter; left time: 1678.8233s
Epoch: 13 cost time: 19.714920043945312
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0006888
	speed: 0.1811s/iter; left time: 7372.5310s
	iters: 200, epoch: 14 | loss: 0.0005874
	speed: 0.0405s/iter; left time: 1645.1746s
	iters: 300, epoch: 14 | loss: 0.3717894
	speed: 0.0381s/iter; left time: 1541.7226s
	iters: 400, epoch: 14 | loss: 0.0006100
	speed: 0.0359s/iter; left time: 1450.7500s
Epoch: 14 cost time: 18.171815872192383
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0004627
	speed: 0.1797s/iter; left time: 7228.9847s
	iters: 200, epoch: 15 | loss: 0.0912349
	speed: 0.0360s/iter; left time: 1446.3568s
	iters: 300, epoch: 15 | loss: 0.0612560
	speed: 0.0345s/iter; left time: 1380.5527s
	iters: 400, epoch: 15 | loss: 0.0208580
	speed: 0.0351s/iter; left time: 1403.4062s
Epoch: 15 cost time: 17.16105341911316
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0017357
	speed: 0.1709s/iter; left time: 6795.6116s
	iters: 200, epoch: 16 | loss: 0.0008332
	speed: 0.0343s/iter; left time: 1361.1787s
	iters: 300, epoch: 16 | loss: 0.0000688
	speed: 0.0354s/iter; left time: 1399.8608s
	iters: 400, epoch: 16 | loss: 0.1767557
	speed: 0.0381s/iter; left time: 1502.3521s
Epoch: 16 cost time: 17.111236095428467
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0035264
	speed: 0.1739s/iter; left time: 6831.8837s
	iters: 200, epoch: 17 | loss: 0.0009391
	speed: 0.0419s/iter; left time: 1644.1568s
	iters: 300, epoch: 17 | loss: 0.0000033
	speed: 0.0403s/iter; left time: 1574.7263s
	iters: 400, epoch: 17 | loss: 0.0116542
	speed: 0.0393s/iter; left time: 1533.4311s
Epoch: 17 cost time: 18.92025375366211
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0002348
	speed: 0.1878s/iter; left time: 7292.5325s
	iters: 200, epoch: 18 | loss: 0.0054371
	speed: 0.0400s/iter; left time: 1548.9605s
	iters: 300, epoch: 18 | loss: 0.0006079
	speed: 0.0392s/iter; left time: 1515.9897s
	iters: 400, epoch: 18 | loss: 0.0012175
	speed: 0.0372s/iter; left time: 1434.5783s
Epoch: 18 cost time: 18.6690411567688
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002043
	speed: 0.1787s/iter; left time: 6854.2422s
	iters: 200, epoch: 19 | loss: 0.0163110
	speed: 0.0387s/iter; left time: 1481.2745s
	iters: 300, epoch: 19 | loss: 0.0201518
	speed: 0.0382s/iter; left time: 1455.9154s
	iters: 400, epoch: 19 | loss: 0.0187264
	speed: 0.0354s/iter; left time: 1349.1025s
Epoch: 19 cost time: 17.940791368484497
Epoch: 19, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0002704
	speed: 0.1733s/iter; left time: 6567.4064s
	iters: 200, epoch: 20 | loss: 0.0058174
	speed: 0.0383s/iter; left time: 1445.5492s
	iters: 300, epoch: 20 | loss: 0.0037056
	speed: 0.0359s/iter; left time: 1354.3523s
	iters: 400, epoch: 20 | loss: 0.0010169
	speed: 0.0368s/iter; left time: 1384.9464s
Epoch: 20 cost time: 17.629196882247925
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0001486
	speed: 0.1748s/iter; left time: 6539.6895s
	iters: 200, epoch: 21 | loss: 0.0744488
	speed: 0.0356s/iter; left time: 1329.3194s
	iters: 300, epoch: 21 | loss: 0.0034648
	speed: 0.0372s/iter; left time: 1383.9473s
	iters: 400, epoch: 21 | loss: 0.0002004
	speed: 0.0372s/iter; left time: 1380.4248s
Epoch: 21 cost time: 17.68091654777527
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 112954
model size : 2.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1375908
	speed: 0.0589s/iter; left time: 2758.3189s
	iters: 200, epoch: 1 | loss: 0.6093659
	speed: 0.0424s/iter; left time: 1980.9410s
	iters: 300, epoch: 1 | loss: 0.3288054
	speed: 0.0409s/iter; left time: 1905.7824s
	iters: 400, epoch: 1 | loss: 0.3584311
	speed: 0.0415s/iter; left time: 1931.7425s
Epoch: 1 cost time: 21.116864442825317
Epoch: 1, Steps: 469 | Train Loss: 0.801 Vali Loss: 0.364 Vali Acc: 0.883 Test Loss: 0.364 Test Acc: 0.883
Validation loss decreased (inf --> -0.883358).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3551054
	speed: 0.1823s/iter; left time: 8444.5450s
	iters: 200, epoch: 2 | loss: 0.4008700
	speed: 0.0375s/iter; left time: 1732.9302s
	iters: 300, epoch: 2 | loss: 0.1935591
	speed: 0.0360s/iter; left time: 1661.4355s
	iters: 400, epoch: 2 | loss: 0.0356771
	speed: 0.0368s/iter; left time: 1694.6385s
Epoch: 2 cost time: 18.128258228302002
Epoch: 2, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.244 Vali Acc: 0.925 Test Loss: 0.244 Test Acc: 0.925
Validation loss decreased (-0.883358 --> -0.924812).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1966972
	speed: 0.1785s/iter; left time: 8187.0825s
	iters: 200, epoch: 3 | loss: 0.0196406
	speed: 0.0365s/iter; left time: 1669.5466s
	iters: 300, epoch: 3 | loss: 0.1648280
	speed: 0.0384s/iter; left time: 1755.5550s
	iters: 400, epoch: 3 | loss: 0.0517932
	speed: 0.0402s/iter; left time: 1829.3998s
Epoch: 3 cost time: 18.18870210647583
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.201 Vali Acc: 0.940 Test Loss: 0.201 Test Acc: 0.940
Validation loss decreased (-0.924812 --> -0.940250).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2933744
	speed: 0.1792s/iter; left time: 8132.6937s
	iters: 200, epoch: 4 | loss: 0.1835645
	speed: 0.0345s/iter; left time: 1560.4067s
	iters: 300, epoch: 4 | loss: 0.0723405
	speed: 0.0379s/iter; left time: 1713.5739s
	iters: 400, epoch: 4 | loss: 0.0418538
	speed: 0.0371s/iter; left time: 1672.1529s
Epoch: 4 cost time: 17.595823049545288
Epoch: 4, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.955 Test Loss: 0.173 Test Acc: 0.955
Validation loss decreased (-0.940250 --> -0.954544).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0390662
	speed: 0.1785s/iter; left time: 8016.9963s
	iters: 200, epoch: 5 | loss: 0.0394744
	speed: 0.0373s/iter; left time: 1672.8460s
	iters: 300, epoch: 5 | loss: 0.0096635
	speed: 0.0374s/iter; left time: 1673.0012s
	iters: 400, epoch: 5 | loss: 0.0502523
	speed: 0.0399s/iter; left time: 1782.1660s
Epoch: 5 cost time: 18.370694637298584
Epoch: 5, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.954544 --> -0.959118).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0654034
	speed: 0.1806s/iter; left time: 8030.8279s
	iters: 200, epoch: 6 | loss: 0.0050249
	speed: 0.0384s/iter; left time: 1702.8562s
	iters: 300, epoch: 6 | loss: 0.0357860
	speed: 0.0389s/iter; left time: 1722.8746s
	iters: 400, epoch: 6 | loss: 0.1528048
	speed: 0.0378s/iter; left time: 1671.2664s
Epoch: 6 cost time: 18.334684133529663
Epoch: 6, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.959118 --> -0.961691).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0879315
	speed: 0.1819s/iter; left time: 8002.7406s
	iters: 200, epoch: 7 | loss: 0.0519239
	speed: 0.0372s/iter; left time: 1634.3167s
	iters: 300, epoch: 7 | loss: 0.0240829
	speed: 0.0354s/iter; left time: 1549.8187s
	iters: 400, epoch: 7 | loss: 0.0129014
	speed: 0.0369s/iter; left time: 1610.3650s
Epoch: 7 cost time: 17.664557695388794
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.961691 --> -0.963406).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0315179
	speed: 0.1759s/iter; left time: 7653.6319s
	iters: 200, epoch: 8 | loss: 0.0127164
	speed: 0.0378s/iter; left time: 1641.4088s
	iters: 300, epoch: 8 | loss: 0.1311157
	speed: 0.0380s/iter; left time: 1648.1410s
	iters: 400, epoch: 8 | loss: 0.0155364
	speed: 0.0405s/iter; left time: 1752.4181s
Epoch: 8 cost time: 18.603902101516724
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.963406 --> -0.968266).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0197314
	speed: 0.1782s/iter; left time: 7669.5375s
	iters: 200, epoch: 9 | loss: 0.1380277
	speed: 0.0368s/iter; left time: 1580.1517s
	iters: 300, epoch: 9 | loss: 0.0611104
	speed: 0.0379s/iter; left time: 1624.9477s
	iters: 400, epoch: 9 | loss: 0.0126041
	speed: 0.0377s/iter; left time: 1613.5024s
Epoch: 9 cost time: 17.942079782485962
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.968266 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0121894
	speed: 0.1743s/iter; left time: 7421.8221s
	iters: 200, epoch: 10 | loss: 0.1433935
	speed: 0.0370s/iter; left time: 1570.6563s
	iters: 300, epoch: 10 | loss: 0.0059630
	speed: 0.0368s/iter; left time: 1561.2439s
	iters: 400, epoch: 10 | loss: 0.0146630
	speed: 0.0377s/iter; left time: 1592.8941s
Epoch: 10 cost time: 17.710041522979736
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0090231
	speed: 0.1761s/iter; left time: 7417.6563s
	iters: 200, epoch: 11 | loss: 0.0087129
	speed: 0.0375s/iter; left time: 1573.5460s
	iters: 300, epoch: 11 | loss: 0.0300165
	speed: 0.0392s/iter; left time: 1642.6410s
	iters: 400, epoch: 11 | loss: 0.0111980
	speed: 0.0385s/iter; left time: 1611.7434s
Epoch: 11 cost time: 18.396998643875122
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0036286
	speed: 0.1854s/iter; left time: 7721.2951s
	iters: 200, epoch: 12 | loss: 0.0059507
	speed: 0.0394s/iter; left time: 1637.5332s
	iters: 300, epoch: 12 | loss: 0.0131409
	speed: 0.0422s/iter; left time: 1748.4323s
	iters: 400, epoch: 12 | loss: 0.0131534
	speed: 0.0416s/iter; left time: 1719.8354s
Epoch: 12 cost time: 19.371675491333008
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0107097
	speed: 0.1844s/iter; left time: 7593.2155s
	iters: 200, epoch: 13 | loss: 0.0402440
	speed: 0.0378s/iter; left time: 1551.9662s
	iters: 300, epoch: 13 | loss: 0.1556944
	speed: 0.0382s/iter; left time: 1563.7027s
	iters: 400, epoch: 13 | loss: 0.0426175
	speed: 0.0371s/iter; left time: 1516.1768s
Epoch: 13 cost time: 18.256499528884888
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0067343
	speed: 0.1777s/iter; left time: 7234.7591s
	iters: 200, epoch: 14 | loss: 0.0012398
	speed: 0.0353s/iter; left time: 1432.7841s
	iters: 300, epoch: 14 | loss: 0.0481294
	speed: 0.0354s/iter; left time: 1433.4644s
	iters: 400, epoch: 14 | loss: 0.0033857
	speed: 0.0354s/iter; left time: 1428.5805s
Epoch: 14 cost time: 17.063509702682495
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1157860
	speed: 0.1776s/iter; left time: 7147.5878s
	iters: 200, epoch: 15 | loss: 0.0047420
	speed: 0.0369s/iter; left time: 1481.7534s
	iters: 300, epoch: 15 | loss: 0.0089506
	speed: 0.0366s/iter; left time: 1464.5057s
	iters: 400, epoch: 15 | loss: 0.1264103
	speed: 0.0375s/iter; left time: 1498.1263s
Epoch: 15 cost time: 17.992635250091553
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.974842).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0128972
	speed: 0.1735s/iter; left time: 6898.8750s
	iters: 200, epoch: 16 | loss: 0.0020331
	speed: 0.0396s/iter; left time: 1570.0453s
	iters: 300, epoch: 16 | loss: 0.0417888
	speed: 0.0387s/iter; left time: 1532.5102s
	iters: 400, epoch: 16 | loss: 0.1651318
	speed: 0.0355s/iter; left time: 1402.3739s
Epoch: 16 cost time: 18.11292791366577
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975985).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0315125
	speed: 0.1599s/iter; left time: 6282.7721s
	iters: 200, epoch: 17 | loss: 0.0008413
	speed: 0.0380s/iter; left time: 1490.0745s
	iters: 300, epoch: 17 | loss: 0.0193065
	speed: 0.0377s/iter; left time: 1475.1203s
	iters: 400, epoch: 17 | loss: 0.0042235
	speed: 0.0382s/iter; left time: 1489.0739s
Epoch: 17 cost time: 18.367681980133057
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0131528
	speed: 0.1842s/iter; left time: 7150.7128s
	iters: 200, epoch: 18 | loss: 0.0018566
	speed: 0.0387s/iter; left time: 1497.1022s
	iters: 300, epoch: 18 | loss: 0.0011615
	speed: 0.0404s/iter; left time: 1560.6561s
	iters: 400, epoch: 18 | loss: 0.0002547
	speed: 0.0384s/iter; left time: 1478.6402s
Epoch: 18 cost time: 18.54672384262085
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0178059
	speed: 0.1754s/iter; left time: 6728.4298s
	iters: 200, epoch: 19 | loss: 0.0050830
	speed: 0.0393s/iter; left time: 1505.3543s
	iters: 300, epoch: 19 | loss: 0.0133046
	speed: 0.0393s/iter; left time: 1498.7782s
	iters: 400, epoch: 19 | loss: 0.0068999
	speed: 0.0372s/iter; left time: 1415.4955s
Epoch: 19 cost time: 18.1521213054657
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0049149
	speed: 0.1778s/iter; left time: 6737.0882s
	iters: 200, epoch: 20 | loss: 0.0015072
	speed: 0.0357s/iter; left time: 1349.7069s
	iters: 300, epoch: 20 | loss: 0.0002170
	speed: 0.0369s/iter; left time: 1392.2721s
	iters: 400, epoch: 20 | loss: 0.0045872
	speed: 0.0364s/iter; left time: 1368.8657s
Epoch: 20 cost time: 17.617680311203003
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.979130).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0494436
	speed: 0.1786s/iter; left time: 6681.5713s
	iters: 200, epoch: 21 | loss: 0.0013202
	speed: 0.0384s/iter; left time: 1431.5213s
	iters: 300, epoch: 21 | loss: 0.0102586
	speed: 0.0378s/iter; left time: 1408.4279s
	iters: 400, epoch: 21 | loss: 0.0342037
	speed: 0.0387s/iter; left time: 1436.0438s
Epoch: 21 cost time: 18.337584972381592
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0003874
	speed: 0.1755s/iter; left time: 6484.2931s
	iters: 200, epoch: 22 | loss: 0.0858770
	speed: 0.0415s/iter; left time: 1531.1741s
	iters: 300, epoch: 22 | loss: 0.0011106
	speed: 0.0407s/iter; left time: 1495.4191s
	iters: 400, epoch: 22 | loss: 0.0001840
	speed: 0.0401s/iter; left time: 1468.5674s
Epoch: 22 cost time: 19.14956831932068
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0023554
	speed: 0.1905s/iter; left time: 6950.0034s
	iters: 200, epoch: 23 | loss: 0.0260246
	speed: 0.0384s/iter; left time: 1397.6390s
	iters: 300, epoch: 23 | loss: 0.0041585
	speed: 0.0380s/iter; left time: 1377.2675s
	iters: 400, epoch: 23 | loss: 0.3967187
	speed: 0.0409s/iter; left time: 1480.5465s
Epoch: 23 cost time: 18.978522539138794
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0037671
	speed: 0.1812s/iter; left time: 6527.0588s
	iters: 200, epoch: 24 | loss: 0.0024104
	speed: 0.0368s/iter; left time: 1321.5362s
	iters: 300, epoch: 24 | loss: 0.0025622
	speed: 0.0380s/iter; left time: 1362.4549s
	iters: 400, epoch: 24 | loss: 0.0018093
	speed: 0.0371s/iter; left time: 1325.7747s
Epoch: 24 cost time: 17.857243299484253
Epoch: 24, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0405282
	speed: 0.1742s/iter; left time: 6191.8906s
	iters: 200, epoch: 25 | loss: 0.0623315
	speed: 0.0378s/iter; left time: 1341.0615s
	iters: 300, epoch: 25 | loss: 0.0146762
	speed: 0.0354s/iter; left time: 1250.4378s
	iters: 400, epoch: 25 | loss: 0.0110743
	speed: 0.0358s/iter; left time: 1262.6529s
Epoch: 25 cost time: 17.467915773391724
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0005461
	speed: 0.1764s/iter; left time: 6186.3833s
	iters: 200, epoch: 26 | loss: 0.0002411
	speed: 0.0363s/iter; left time: 1271.0761s
	iters: 300, epoch: 26 | loss: 0.0101126
	speed: 0.0355s/iter; left time: 1239.4342s
	iters: 400, epoch: 26 | loss: 0.0003811
	speed: 0.0418s/iter; left time: 1452.5833s
Epoch: 26 cost time: 18.415282249450684
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980845).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0495351
	speed: 0.1913s/iter; left time: 6621.9077s
	iters: 200, epoch: 27 | loss: 0.0276939
	speed: 0.0426s/iter; left time: 1471.2009s
	iters: 300, epoch: 27 | loss: 0.0090838
	speed: 0.0411s/iter; left time: 1412.7298s
	iters: 400, epoch: 27 | loss: 0.0962504
	speed: 0.0381s/iter; left time: 1306.0569s
Epoch: 27 cost time: 19.7271831035614
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0449239
	speed: 0.1866s/iter; left time: 6371.0045s
	iters: 200, epoch: 28 | loss: 0.0045139
	speed: 0.0371s/iter; left time: 1262.4278s
	iters: 300, epoch: 28 | loss: 0.0130747
	speed: 0.0355s/iter; left time: 1204.8649s
	iters: 400, epoch: 28 | loss: 0.0004749
	speed: 0.0365s/iter; left time: 1234.0795s
Epoch: 28 cost time: 17.319705486297607
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981131).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0085252
	speed: 0.1749s/iter; left time: 5888.7833s
	iters: 200, epoch: 29 | loss: 0.0157935
	speed: 0.0364s/iter; left time: 1221.0859s
	iters: 300, epoch: 29 | loss: 0.0342849
	speed: 0.0358s/iter; left time: 1198.2199s
	iters: 400, epoch: 29 | loss: 0.0006971
	speed: 0.0365s/iter; left time: 1217.1854s
Epoch: 29 cost time: 17.461945056915283
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
Validation loss decreased (-0.981131 --> -0.985419).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0001624
	speed: 0.1792s/iter; left time: 5949.2710s
	iters: 200, epoch: 30 | loss: 0.1216218
	speed: 0.0382s/iter; left time: 1263.0995s
	iters: 300, epoch: 30 | loss: 0.0015667
	speed: 0.0372s/iter; left time: 1229.0992s
	iters: 400, epoch: 30 | loss: 0.0003129
	speed: 0.0375s/iter; left time: 1233.1149s
Epoch: 30 cost time: 18.193790674209595
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0018504
	speed: 0.1849s/iter; left time: 6052.3644s
	iters: 200, epoch: 31 | loss: 0.0130998
	speed: 0.0394s/iter; left time: 1284.4941s
	iters: 300, epoch: 31 | loss: 0.0005637
	speed: 0.0377s/iter; left time: 1226.0734s
	iters: 400, epoch: 31 | loss: 0.0033157
	speed: 0.0378s/iter; left time: 1225.5573s
Epoch: 31 cost time: 18.43995952606201
Epoch: 31, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0001410
	speed: 0.1871s/iter; left time: 6036.8404s
	iters: 200, epoch: 32 | loss: 0.0000538
	speed: 0.0389s/iter; left time: 1249.5984s
	iters: 300, epoch: 32 | loss: 0.0324352
	speed: 0.0409s/iter; left time: 1312.4591s
	iters: 400, epoch: 32 | loss: 0.0027067
	speed: 0.0399s/iter; left time: 1274.4805s
Epoch: 32 cost time: 18.971778631210327
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0009046
	speed: 0.1749s/iter; left time: 5560.9492s
	iters: 200, epoch: 33 | loss: 0.0017606
	speed: 0.0377s/iter; left time: 1195.9494s
	iters: 300, epoch: 33 | loss: 0.0040288
	speed: 0.0348s/iter; left time: 1100.1060s
	iters: 400, epoch: 33 | loss: 0.0003846
	speed: 0.0366s/iter; left time: 1151.9375s
Epoch: 33 cost time: 17.843780994415283
Epoch: 33, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0120041
	speed: 0.1768s/iter; left time: 5537.6314s
	iters: 200, epoch: 34 | loss: 0.0183497
	speed: 0.0347s/iter; left time: 1082.9495s
	iters: 300, epoch: 34 | loss: 0.0180619
	speed: 0.0347s/iter; left time: 1079.0968s
	iters: 400, epoch: 34 | loss: 0.0010163
	speed: 0.0368s/iter; left time: 1142.5613s
Epoch: 34 cost time: 17.24678945541382
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0041745
	speed: 0.1778s/iter; left time: 5486.6402s
	iters: 200, epoch: 35 | loss: 0.1017102
	speed: 0.0373s/iter; left time: 1148.1722s
	iters: 300, epoch: 35 | loss: 0.0065069
	speed: 0.0386s/iter; left time: 1182.2377s
	iters: 400, epoch: 35 | loss: 0.3137265
	speed: 0.0387s/iter; left time: 1181.7975s
Epoch: 35 cost time: 18.313344955444336
Epoch: 35, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0009029
	speed: 0.1883s/iter; left time: 5721.8472s
	iters: 200, epoch: 36 | loss: 0.0073467
	speed: 0.0365s/iter; left time: 1105.3124s
	iters: 300, epoch: 36 | loss: 0.0018041
	speed: 0.0356s/iter; left time: 1075.4663s
	iters: 400, epoch: 36 | loss: 0.0545869
	speed: 0.0352s/iter; left time: 1057.5861s
Epoch: 36 cost time: 17.595494031906128
Epoch: 36, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0012528
	speed: 0.1756s/iter; left time: 5253.2661s
	iters: 200, epoch: 37 | loss: 0.0003738
	speed: 0.0363s/iter; left time: 1082.9279s
	iters: 300, epoch: 37 | loss: 0.0034614
	speed: 0.0359s/iter; left time: 1067.1174s
	iters: 400, epoch: 37 | loss: 0.0014073
	speed: 0.0389s/iter; left time: 1152.3344s
Epoch: 37 cost time: 17.77474594116211
Epoch: 37, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0599801
	speed: 0.1816s/iter; left time: 5349.1826s
	iters: 200, epoch: 38 | loss: 0.0013404
	speed: 0.0403s/iter; left time: 1182.2687s
	iters: 300, epoch: 38 | loss: 0.0040026
	speed: 0.0404s/iter; left time: 1180.2274s
	iters: 400, epoch: 38 | loss: 0.0081705
	speed: 0.0417s/iter; left time: 1216.2028s
Epoch: 38 cost time: 19.15409541130066
Epoch: 38, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0131594
	speed: 0.1920s/iter; left time: 5564.9951s
	iters: 200, epoch: 39 | loss: 0.0006614
	speed: 0.0373s/iter; left time: 1076.4551s
	iters: 300, epoch: 39 | loss: 0.0134153
	speed: 0.0363s/iter; left time: 1044.1638s
	iters: 400, epoch: 39 | loss: 0.0009815
	speed: 0.0364s/iter; left time: 1042.6438s
Epoch: 39 cost time: 18.3237886428833
Epoch: 39, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9854202401372213
model parameter : 548026
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9923272
	speed: 0.0487s/iter; left time: 2279.5224s
	iters: 200, epoch: 1 | loss: 0.5479374
	speed: 0.0322s/iter; left time: 1502.2785s
	iters: 300, epoch: 1 | loss: 0.3112954
	speed: 0.0338s/iter; left time: 1574.1601s
	iters: 400, epoch: 1 | loss: 0.3670000
	speed: 0.0331s/iter; left time: 1539.9570s
Epoch: 1 cost time: 17.30085515975952
Epoch: 1, Steps: 469 | Train Loss: 0.764 Vali Loss: 0.336 Vali Acc: 0.901 Test Loss: 0.336 Test Acc: 0.901
Validation loss decreased (inf --> -0.900797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3273304
	speed: 0.1688s/iter; left time: 7822.1805s
	iters: 200, epoch: 2 | loss: 0.4008468
	speed: 0.0336s/iter; left time: 1553.6425s
	iters: 300, epoch: 2 | loss: 0.2417658
	speed: 0.0340s/iter; left time: 1568.6444s
	iters: 400, epoch: 2 | loss: 0.0424955
	speed: 0.0368s/iter; left time: 1695.8504s
Epoch: 2 cost time: 16.569037675857544
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.229 Vali Acc: 0.940 Test Loss: 0.229 Test Acc: 0.940
Validation loss decreased (-0.900797 --> -0.939678).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1905443
	speed: 0.1719s/iter; left time: 7882.6053s
	iters: 200, epoch: 3 | loss: 0.0247204
	speed: 0.0418s/iter; left time: 1910.9594s
	iters: 300, epoch: 3 | loss: 0.2519409
	speed: 0.0388s/iter; left time: 1770.4502s
	iters: 400, epoch: 3 | loss: 0.0312426
	speed: 0.0388s/iter; left time: 1766.3012s
Epoch: 3 cost time: 18.758042573928833
Epoch: 3, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.939678 --> -0.947682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2962024
	speed: 0.1840s/iter; left time: 8354.5932s
	iters: 200, epoch: 4 | loss: 0.2144992
	speed: 0.0367s/iter; left time: 1663.3720s
	iters: 300, epoch: 4 | loss: 0.0701235
	speed: 0.0394s/iter; left time: 1781.9969s
	iters: 400, epoch: 4 | loss: 0.0644814
	speed: 0.0408s/iter; left time: 1837.6264s
Epoch: 4 cost time: 18.947092294692993
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.947682 --> -0.957403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0596213
	speed: 0.1826s/iter; left time: 8201.2817s
	iters: 200, epoch: 5 | loss: 0.0299348
	speed: 0.0353s/iter; left time: 1582.4321s
	iters: 300, epoch: 5 | loss: 0.0065929
	speed: 0.0356s/iter; left time: 1593.3318s
	iters: 400, epoch: 5 | loss: 0.0287995
	speed: 0.0364s/iter; left time: 1624.4883s
Epoch: 5 cost time: 17.19845485687256
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.957403 --> -0.959404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0767545
	speed: 0.1716s/iter; left time: 7628.6082s
	iters: 200, epoch: 6 | loss: 0.0051827
	speed: 0.0349s/iter; left time: 1549.6391s
	iters: 300, epoch: 6 | loss: 0.0306026
	speed: 0.0344s/iter; left time: 1521.5561s
	iters: 400, epoch: 6 | loss: 0.0520317
	speed: 0.0357s/iter; left time: 1576.9207s
Epoch: 6 cost time: 16.83484411239624
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0898634
	speed: 0.1751s/iter; left time: 7702.6493s
	iters: 200, epoch: 7 | loss: 0.1970376
	speed: 0.0347s/iter; left time: 1524.4001s
	iters: 300, epoch: 7 | loss: 0.1014983
	speed: 0.0337s/iter; left time: 1473.8337s
	iters: 400, epoch: 7 | loss: 0.0077071
	speed: 0.0352s/iter; left time: 1538.9307s
Epoch: 7 cost time: 16.8379123210907
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.959404 --> -0.969124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0785828
	speed: 0.1713s/iter; left time: 7455.8847s
	iters: 200, epoch: 8 | loss: 0.0987498
	speed: 0.0367s/iter; left time: 1594.3496s
	iters: 300, epoch: 8 | loss: 0.0347788
	speed: 0.0399s/iter; left time: 1727.9751s
	iters: 400, epoch: 8 | loss: 0.0117699
	speed: 0.0415s/iter; left time: 1792.4819s
Epoch: 8 cost time: 18.99717664718628
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0673475
	speed: 0.1933s/iter; left time: 8320.2799s
	iters: 200, epoch: 9 | loss: 0.2285445
	speed: 0.0403s/iter; left time: 1732.9653s
	iters: 300, epoch: 9 | loss: 0.0199734
	speed: 0.0442s/iter; left time: 1892.0514s
	iters: 400, epoch: 9 | loss: 0.0120998
	speed: 0.0412s/iter; left time: 1761.6819s
Epoch: 9 cost time: 19.800929069519043
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.969124 --> -0.969124).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0244389
	speed: 0.1874s/iter; left time: 7981.3362s
	iters: 200, epoch: 10 | loss: 0.1387624
	speed: 0.0381s/iter; left time: 1619.4369s
	iters: 300, epoch: 10 | loss: 0.0031434
	speed: 0.0381s/iter; left time: 1615.6581s
	iters: 400, epoch: 10 | loss: 0.0353589
	speed: 0.0363s/iter; left time: 1536.6323s
Epoch: 10 cost time: 18.22425150871277
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0338455
	speed: 0.1787s/iter; left time: 7525.3446s
	iters: 200, epoch: 11 | loss: 0.0271290
	speed: 0.0374s/iter; left time: 1570.7388s
	iters: 300, epoch: 11 | loss: 0.0163496
	speed: 0.0367s/iter; left time: 1537.7482s
	iters: 400, epoch: 11 | loss: 0.0278855
	speed: 0.0375s/iter; left time: 1566.1706s
Epoch: 11 cost time: 18.06151032447815
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.970267).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0157038
	speed: 0.1771s/iter; left time: 7376.5213s
	iters: 200, epoch: 12 | loss: 0.0029258
	speed: 0.0414s/iter; left time: 1719.9501s
	iters: 300, epoch: 12 | loss: 0.0069685
	speed: 0.0405s/iter; left time: 1679.9389s
	iters: 400, epoch: 12 | loss: 0.0040358
	speed: 0.0363s/iter; left time: 1499.5803s
Epoch: 12 cost time: 18.3735933303833
Epoch: 12, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971697).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0331686
	speed: 0.1780s/iter; left time: 7327.1063s
	iters: 200, epoch: 13 | loss: 0.0527804
	speed: 0.0358s/iter; left time: 1468.8285s
	iters: 300, epoch: 13 | loss: 0.1760641
	speed: 0.0353s/iter; left time: 1448.0000s
	iters: 400, epoch: 13 | loss: 0.0197977
	speed: 0.0347s/iter; left time: 1417.8110s
Epoch: 13 cost time: 17.267765998840332
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0021502
	speed: 0.1811s/iter; left time: 7372.9918s
	iters: 200, epoch: 14 | loss: 0.0003624
	speed: 0.0353s/iter; left time: 1434.5990s
	iters: 300, epoch: 14 | loss: 0.0302923
	speed: 0.0351s/iter; left time: 1423.6465s
	iters: 400, epoch: 14 | loss: 0.0027543
	speed: 0.0353s/iter; left time: 1425.4816s
Epoch: 14 cost time: 17.32488989830017
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.971697 --> -0.975413).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1307915
	speed: 0.1789s/iter; left time: 7197.2561s
	iters: 200, epoch: 15 | loss: 0.0030291
	speed: 0.0358s/iter; left time: 1438.0494s
	iters: 300, epoch: 15 | loss: 0.0571723
	speed: 0.0402s/iter; left time: 1611.1788s
	iters: 400, epoch: 15 | loss: 0.0055652
	speed: 0.0381s/iter; left time: 1520.6021s
Epoch: 15 cost time: 17.847959280014038
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0003779
	speed: 0.1720s/iter; left time: 6838.6845s
	iters: 200, epoch: 16 | loss: 0.0295719
	speed: 0.0366s/iter; left time: 1451.4044s
	iters: 300, epoch: 16 | loss: 0.0100538
	speed: 0.0357s/iter; left time: 1412.8761s
	iters: 400, epoch: 16 | loss: 0.0577423
	speed: 0.0354s/iter; left time: 1397.2002s
Epoch: 16 cost time: 17.24318027496338
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.978558).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0018818
	speed: 0.1738s/iter; left time: 6831.0868s
	iters: 200, epoch: 17 | loss: 0.0008826
	speed: 0.0380s/iter; left time: 1489.6878s
	iters: 300, epoch: 17 | loss: 0.0162681
	speed: 0.0345s/iter; left time: 1348.5369s
	iters: 400, epoch: 17 | loss: 0.0022010
	speed: 0.0352s/iter; left time: 1372.4181s
Epoch: 17 cost time: 17.27225375175476
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0138931
	speed: 0.1783s/iter; left time: 6921.3257s
	iters: 200, epoch: 18 | loss: 0.0001442
	speed: 0.0373s/iter; left time: 1445.6029s
	iters: 300, epoch: 18 | loss: 0.0093811
	speed: 0.0398s/iter; left time: 1537.5688s
	iters: 400, epoch: 18 | loss: 0.0003314
	speed: 0.0379s/iter; left time: 1458.9740s
Epoch: 18 cost time: 17.998197317123413
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0336761
	speed: 0.1646s/iter; left time: 6313.6998s
	iters: 200, epoch: 19 | loss: 0.0126233
	speed: 0.0387s/iter; left time: 1480.0953s
	iters: 300, epoch: 19 | loss: 0.0044457
	speed: 0.0387s/iter; left time: 1475.0670s
	iters: 400, epoch: 19 | loss: 0.0046120
	speed: 0.0353s/iter; left time: 1342.3362s
Epoch: 19 cost time: 17.880876302719116
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0094037
	speed: 0.1760s/iter; left time: 6669.1330s
	iters: 200, epoch: 20 | loss: 0.0017754
	speed: 0.0357s/iter; left time: 1350.9251s
	iters: 300, epoch: 20 | loss: 0.0045327
	speed: 0.0356s/iter; left time: 1342.6268s
	iters: 400, epoch: 20 | loss: 0.0082011
	speed: 0.0376s/iter; left time: 1411.6449s
Epoch: 20 cost time: 17.82496166229248
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0244925
	speed: 0.1796s/iter; left time: 6720.1809s
	iters: 200, epoch: 21 | loss: 0.0012286
	speed: 0.0370s/iter; left time: 1382.4599s
	iters: 300, epoch: 21 | loss: 0.0022005
	speed: 0.0379s/iter; left time: 1411.5905s
	iters: 400, epoch: 21 | loss: 0.0115465
	speed: 0.0386s/iter; left time: 1431.2317s
Epoch: 21 cost time: 17.7427237033844
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0007272
	speed: 0.1741s/iter; left time: 6433.0813s
	iters: 200, epoch: 22 | loss: 0.0431350
	speed: 0.0374s/iter; left time: 1379.5638s
	iters: 300, epoch: 22 | loss: 0.0027443
	speed: 0.0378s/iter; left time: 1390.3539s
	iters: 400, epoch: 22 | loss: 0.0007132
	speed: 0.0369s/iter; left time: 1353.9534s
Epoch: 22 cost time: 17.69545578956604
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980273).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0037178
	speed: 0.1692s/iter; left time: 6173.4409s
	iters: 200, epoch: 23 | loss: 0.0271522
	speed: 0.0321s/iter; left time: 1168.5083s
	iters: 300, epoch: 23 | loss: 0.0013811
	speed: 0.0330s/iter; left time: 1198.1591s
	iters: 400, epoch: 23 | loss: 0.1432991
	speed: 0.0328s/iter; left time: 1185.4263s
Epoch: 23 cost time: 16.031216382980347
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0010925
	speed: 0.1689s/iter; left time: 6082.1202s
	iters: 200, epoch: 24 | loss: 0.0279348
	speed: 0.0349s/iter; left time: 1254.6925s
	iters: 300, epoch: 24 | loss: 0.0013046
	speed: 0.0342s/iter; left time: 1223.8584s
	iters: 400, epoch: 24 | loss: 0.0023274
	speed: 0.0330s/iter; left time: 1179.1076s
Epoch: 24 cost time: 16.631415128707886
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0072185
	speed: 0.1768s/iter; left time: 6284.4996s
	iters: 200, epoch: 25 | loss: 0.0114422
	speed: 0.0363s/iter; left time: 1288.3891s
	iters: 300, epoch: 25 | loss: 0.0061272
	speed: 0.0390s/iter; left time: 1380.0033s
	iters: 400, epoch: 25 | loss: 0.1387898
	speed: 0.0428s/iter; left time: 1509.6800s
Epoch: 25 cost time: 19.006139039993286
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
Validation loss decreased (-0.980273 --> -0.982275).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0112747
	speed: 0.1860s/iter; left time: 6525.4731s
	iters: 200, epoch: 26 | loss: 0.0013452
	speed: 0.0414s/iter; left time: 1448.7875s
	iters: 300, epoch: 26 | loss: 0.0012493
	speed: 0.0355s/iter; left time: 1236.8657s
	iters: 400, epoch: 26 | loss: 0.1147676
	speed: 0.0369s/iter; left time: 1283.6308s
Epoch: 26 cost time: 18.5128915309906
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0103968
	speed: 0.1756s/iter; left time: 6077.7358s
	iters: 200, epoch: 27 | loss: 0.0443333
	speed: 0.0343s/iter; left time: 1182.2390s
	iters: 300, epoch: 27 | loss: 0.0459726
	speed: 0.0344s/iter; left time: 1184.2860s
	iters: 400, epoch: 27 | loss: 0.2166988
	speed: 0.0338s/iter; left time: 1160.6277s
Epoch: 27 cost time: 16.551682472229004
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.2178072
	speed: 0.1670s/iter; left time: 5699.9711s
	iters: 200, epoch: 28 | loss: 0.0138608
	speed: 0.0331s/iter; left time: 1127.4291s
	iters: 300, epoch: 28 | loss: 0.0019299
	speed: 0.0326s/iter; left time: 1105.2805s
	iters: 400, epoch: 28 | loss: 0.0003086
	speed: 0.0334s/iter; left time: 1131.1479s
Epoch: 28 cost time: 15.989174842834473
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0026480
	speed: 0.1662s/iter; left time: 5594.9418s
	iters: 200, epoch: 29 | loss: 0.1198574
	speed: 0.0354s/iter; left time: 1189.4645s
	iters: 300, epoch: 29 | loss: 0.0026508
	speed: 0.0353s/iter; left time: 1182.5988s
	iters: 400, epoch: 29 | loss: 0.0030428
	speed: 0.0373s/iter; left time: 1243.5743s
Epoch: 29 cost time: 17.313257455825806
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000799
	speed: 0.1756s/iter; left time: 5828.3748s
	iters: 200, epoch: 30 | loss: 0.1410908
	speed: 0.0396s/iter; left time: 1311.7297s
	iters: 300, epoch: 30 | loss: 0.0035118
	speed: 0.0402s/iter; left time: 1325.1149s
	iters: 400, epoch: 30 | loss: 0.0009584
	speed: 0.0374s/iter; left time: 1229.1181s
Epoch: 30 cost time: 18.154032945632935
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0018556
	speed: 0.1831s/iter; left time: 5994.6323s
	iters: 200, epoch: 31 | loss: 0.0016911
	speed: 0.0390s/iter; left time: 1271.4434s
	iters: 300, epoch: 31 | loss: 0.0023888
	speed: 0.0407s/iter; left time: 1324.0478s
	iters: 400, epoch: 31 | loss: 0.0030453
	speed: 0.0417s/iter; left time: 1351.7086s
Epoch: 31 cost time: 19.318949699401855
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000347
	speed: 0.1884s/iter; left time: 6078.5434s
	iters: 200, epoch: 32 | loss: 0.0001793
	speed: 0.0380s/iter; left time: 1220.9549s
	iters: 300, epoch: 32 | loss: 0.0886265
	speed: 0.0404s/iter; left time: 1296.6950s
	iters: 400, epoch: 32 | loss: 0.0060105
	speed: 0.0364s/iter; left time: 1164.2039s
Epoch: 32 cost time: 18.153554916381836
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0001276
	speed: 0.1702s/iter; left time: 5410.3292s
	iters: 200, epoch: 33 | loss: 0.0027209
	speed: 0.0360s/iter; left time: 1140.5881s
	iters: 300, epoch: 33 | loss: 0.0136842
	speed: 0.0362s/iter; left time: 1143.6106s
	iters: 400, epoch: 33 | loss: 0.0000761
	speed: 0.0350s/iter; left time: 1102.3034s
Epoch: 33 cost time: 17.00949716567993
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0010568
	speed: 0.1751s/iter; left time: 5484.5442s
	iters: 200, epoch: 34 | loss: 0.0010696
	speed: 0.0352s/iter; left time: 1098.1368s
	iters: 300, epoch: 34 | loss: 0.0437718
	speed: 0.0362s/iter; left time: 1125.7843s
	iters: 400, epoch: 34 | loss: 0.0002770
	speed: 0.0354s/iter; left time: 1098.1496s
Epoch: 34 cost time: 17.107560873031616
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0050752
	speed: 0.1749s/iter; left time: 5397.5380s
	iters: 200, epoch: 35 | loss: 0.0320518
	speed: 0.0356s/iter; left time: 1093.4534s
	iters: 300, epoch: 35 | loss: 0.0348103
	speed: 0.0358s/iter; left time: 1097.8698s
	iters: 400, epoch: 35 | loss: 0.0236701
	speed: 0.0372s/iter; left time: 1137.4547s
Epoch: 35 cost time: 17.504538536071777
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 548026
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0231379
	speed: 0.0553s/iter; left time: 2589.7506s
	iters: 200, epoch: 1 | loss: 0.6629417
	speed: 0.0377s/iter; left time: 1760.0621s
	iters: 300, epoch: 1 | loss: 0.3443929
	speed: 0.0364s/iter; left time: 1695.6291s
	iters: 400, epoch: 1 | loss: 0.3304230
	speed: 0.0391s/iter; left time: 1817.2711s
Epoch: 1 cost time: 19.507861137390137
Epoch: 1, Steps: 469 | Train Loss: 0.736 Vali Loss: 0.271 Vali Acc: 0.932 Test Loss: 0.271 Test Acc: 0.932
Validation loss decreased (inf --> -0.931958).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2188818
	speed: 0.1744s/iter; left time: 8078.8921s
	iters: 200, epoch: 2 | loss: 0.3151992
	speed: 0.0388s/iter; left time: 1791.6924s
	iters: 300, epoch: 2 | loss: 0.0640836
	speed: 0.0378s/iter; left time: 1746.0173s
	iters: 400, epoch: 2 | loss: 0.0508326
	speed: 0.0377s/iter; left time: 1735.3466s
Epoch: 2 cost time: 18.076483726501465
Epoch: 2, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.931958 --> -0.957117).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1633202
	speed: 0.1737s/iter; left time: 7968.6779s
	iters: 200, epoch: 3 | loss: 0.0121390
	speed: 0.0347s/iter; left time: 1588.5731s
	iters: 300, epoch: 3 | loss: 0.1267814
	speed: 0.0351s/iter; left time: 1604.0159s
	iters: 400, epoch: 3 | loss: 0.0173450
	speed: 0.0348s/iter; left time: 1583.7670s
Epoch: 3 cost time: 16.916210174560547
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.4206119
	speed: 0.1782s/iter; left time: 8090.5134s
	iters: 200, epoch: 4 | loss: 0.0493224
	speed: 0.0362s/iter; left time: 1638.5461s
	iters: 300, epoch: 4 | loss: 0.0391022
	speed: 0.0389s/iter; left time: 1757.8692s
	iters: 400, epoch: 4 | loss: 0.0326028
	speed: 0.0405s/iter; left time: 1826.6943s
Epoch: 4 cost time: 18.2652370929718
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.957117 --> -0.972555).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0667838
	speed: 0.1774s/iter; left time: 7967.6173s
	iters: 200, epoch: 5 | loss: 0.0257273
	speed: 0.0379s/iter; left time: 1696.9548s
	iters: 300, epoch: 5 | loss: 0.0063432
	speed: 0.0368s/iter; left time: 1647.4733s
	iters: 400, epoch: 5 | loss: 0.0298115
	speed: 0.0383s/iter; left time: 1710.9018s
Epoch: 5 cost time: 18.103203773498535
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1203200
	speed: 0.1815s/iter; left time: 8067.8945s
	iters: 200, epoch: 6 | loss: 0.0097265
	speed: 0.0389s/iter; left time: 1726.7235s
	iters: 300, epoch: 6 | loss: 0.0047896
	speed: 0.0378s/iter; left time: 1670.9078s
	iters: 400, epoch: 6 | loss: 0.0215457
	speed: 0.0384s/iter; left time: 1696.2396s
Epoch: 6 cost time: 18.18175768852234
Epoch: 6, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.963 Test Loss: 0.131 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0968233
	speed: 0.1824s/iter; left time: 8023.6583s
	iters: 200, epoch: 7 | loss: 0.2612620
	speed: 0.0391s/iter; left time: 1714.8312s
	iters: 300, epoch: 7 | loss: 0.0092194
	speed: 0.0424s/iter; left time: 1858.0468s
	iters: 400, epoch: 7 | loss: 0.0038459
	speed: 0.0427s/iter; left time: 1865.1703s
Epoch: 7 cost time: 19.205175399780273
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.1114176
	speed: 0.1793s/iter; left time: 7803.6517s
	iters: 200, epoch: 8 | loss: 0.0516887
	speed: 0.0396s/iter; left time: 1718.2879s
	iters: 300, epoch: 8 | loss: 0.0756286
	speed: 0.0376s/iter; left time: 1629.6839s
	iters: 400, epoch: 8 | loss: 0.1185905
	speed: 0.0373s/iter; left time: 1610.4610s
Epoch: 8 cost time: 18.450527667999268
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0350263
	speed: 0.1802s/iter; left time: 7758.3162s
	iters: 200, epoch: 9 | loss: 0.2196098
	speed: 0.0363s/iter; left time: 1557.4346s
	iters: 300, epoch: 9 | loss: 0.0057812
	speed: 0.0375s/iter; left time: 1607.2443s
	iters: 400, epoch: 9 | loss: 0.0099753
	speed: 0.0363s/iter; left time: 1551.0141s
Epoch: 9 cost time: 17.77995491027832
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0005559
	speed: 0.1737s/iter; left time: 7395.8727s
	iters: 200, epoch: 10 | loss: 0.0049994
	speed: 0.0367s/iter; left time: 1560.2411s
	iters: 300, epoch: 10 | loss: 0.0104633
	speed: 0.0372s/iter; left time: 1578.4887s
	iters: 400, epoch: 10 | loss: 0.0594223
	speed: 0.0376s/iter; left time: 1590.1214s
Epoch: 10 cost time: 17.792492389678955
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0203948
	speed: 0.1812s/iter; left time: 7629.5547s
	iters: 200, epoch: 11 | loss: 0.0086015
	speed: 0.0414s/iter; left time: 1737.9147s
	iters: 300, epoch: 11 | loss: 0.0107557
	speed: 0.0403s/iter; left time: 1690.5695s
	iters: 400, epoch: 11 | loss: 0.0727078
	speed: 0.0389s/iter; left time: 1626.6241s
Epoch: 11 cost time: 19.241504907608032
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.974270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0047651
	speed: 0.1914s/iter; left time: 7970.1881s
	iters: 200, epoch: 12 | loss: 0.0054972
	speed: 0.0399s/iter; left time: 1658.1732s
	iters: 300, epoch: 12 | loss: 0.0381468
	speed: 0.0384s/iter; left time: 1591.0687s
	iters: 400, epoch: 12 | loss: 0.0027976
	speed: 0.0391s/iter; left time: 1615.8828s
Epoch: 12 cost time: 19.069143295288086
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.974270 --> -0.978272).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0912531
	speed: 0.1778s/iter; left time: 7320.0342s
	iters: 200, epoch: 13 | loss: 0.0087596
	speed: 0.0364s/iter; left time: 1494.9876s
	iters: 300, epoch: 13 | loss: 0.0277386
	speed: 0.0379s/iter; left time: 1553.0275s
	iters: 400, epoch: 13 | loss: 0.0009497
	speed: 0.0380s/iter; left time: 1553.7470s
Epoch: 13 cost time: 17.636273860931396
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0116981
	speed: 0.1707s/iter; left time: 6947.3358s
	iters: 200, epoch: 14 | loss: 0.0020469
	speed: 0.0380s/iter; left time: 1541.8581s
	iters: 300, epoch: 14 | loss: 0.0035832
	speed: 0.0377s/iter; left time: 1528.2602s
	iters: 400, epoch: 14 | loss: 0.0066298
	speed: 0.0338s/iter; left time: 1366.1502s
Epoch: 14 cost time: 17.25624704360962
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0633427
	speed: 0.1670s/iter; left time: 6719.8777s
	iters: 200, epoch: 15 | loss: 0.0013571
	speed: 0.0363s/iter; left time: 1455.8913s
	iters: 300, epoch: 15 | loss: 0.0238058
	speed: 0.0372s/iter; left time: 1490.2687s
	iters: 400, epoch: 15 | loss: 0.0239316
	speed: 0.0360s/iter; left time: 1435.9229s
Epoch: 15 cost time: 17.40930438041687
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.979987).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0019249
	speed: 0.1869s/iter; left time: 7432.7664s
	iters: 200, epoch: 16 | loss: 0.0007161
	speed: 0.0378s/iter; left time: 1497.5549s
	iters: 300, epoch: 16 | loss: 0.0072023
	speed: 0.0387s/iter; left time: 1529.4643s
	iters: 400, epoch: 16 | loss: 0.0347853
	speed: 0.0417s/iter; left time: 1646.8965s
Epoch: 16 cost time: 19.14363956451416
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1526582
	speed: 0.1882s/iter; left time: 7394.7169s
	iters: 200, epoch: 17 | loss: 0.0004483
	speed: 0.0416s/iter; left time: 1630.6251s
	iters: 300, epoch: 17 | loss: 0.0808915
	speed: 0.0422s/iter; left time: 1651.3349s
	iters: 400, epoch: 17 | loss: 0.0102535
	speed: 0.0391s/iter; left time: 1523.1299s
Epoch: 17 cost time: 19.490233898162842
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0155327
	speed: 0.1763s/iter; left time: 6847.3098s
	iters: 200, epoch: 18 | loss: 0.0007090
	speed: 0.0336s/iter; left time: 1303.0288s
	iters: 300, epoch: 18 | loss: 0.0004996
	speed: 0.0347s/iter; left time: 1340.8496s
	iters: 400, epoch: 18 | loss: 0.0005151
	speed: 0.0336s/iter; left time: 1292.9534s
Epoch: 18 cost time: 16.559754848480225
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.979987 --> -0.982560).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0654391
	speed: 0.1696s/iter; left time: 6506.3903s
	iters: 200, epoch: 19 | loss: 0.0033258
	speed: 0.0366s/iter; left time: 1400.8752s
	iters: 300, epoch: 19 | loss: 0.0048295
	speed: 0.0361s/iter; left time: 1378.9084s
	iters: 400, epoch: 19 | loss: 0.0256313
	speed: 0.0371s/iter; left time: 1413.4937s
Epoch: 19 cost time: 17.373085498809814
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0009913
	speed: 0.1746s/iter; left time: 6613.9156s
	iters: 200, epoch: 20 | loss: 0.0002481
	speed: 0.0381s/iter; left time: 1438.1357s
	iters: 300, epoch: 20 | loss: 0.0001615
	speed: 0.0361s/iter; left time: 1358.7993s
	iters: 400, epoch: 20 | loss: 0.0040857
	speed: 0.0367s/iter; left time: 1378.4557s
Epoch: 20 cost time: 17.822399616241455
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0063360
	speed: 0.1803s/iter; left time: 6748.3885s
	iters: 200, epoch: 21 | loss: 0.0076005
	speed: 0.0403s/iter; left time: 1502.5880s
	iters: 300, epoch: 21 | loss: 0.0019270
	speed: 0.0389s/iter; left time: 1446.6574s
	iters: 400, epoch: 21 | loss: 0.0721770
	speed: 0.0383s/iter; left time: 1423.2174s
Epoch: 21 cost time: 19.129917860031128
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001437
	speed: 0.1871s/iter; left time: 6912.3823s
	iters: 200, epoch: 22 | loss: 0.1469157
	speed: 0.0394s/iter; left time: 1451.9469s
	iters: 300, epoch: 22 | loss: 0.0015180
	speed: 0.0391s/iter; left time: 1436.8917s
	iters: 400, epoch: 22 | loss: 0.0003249
	speed: 0.0376s/iter; left time: 1377.1076s
Epoch: 22 cost time: 18.5357723236084
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0752663
	speed: 0.1796s/iter; left time: 6552.5645s
	iters: 200, epoch: 23 | loss: 0.0004313
	speed: 0.0350s/iter; left time: 1271.8021s
	iters: 300, epoch: 23 | loss: 0.0155828
	speed: 0.0350s/iter; left time: 1270.2474s
	iters: 400, epoch: 23 | loss: 0.3146487
	speed: 0.0349s/iter; left time: 1263.9316s
Epoch: 23 cost time: 17.23287558555603
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0029201
	speed: 0.1641s/iter; left time: 5910.9012s
	iters: 200, epoch: 24 | loss: 0.0041561
	speed: 0.0373s/iter; left time: 1340.7390s
	iters: 300, epoch: 24 | loss: 0.0011909
	speed: 0.0364s/iter; left time: 1303.5030s
	iters: 400, epoch: 24 | loss: 0.0489061
	speed: 0.0371s/iter; left time: 1323.8115s
Epoch: 24 cost time: 17.72295641899109
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0274738
	speed: 0.1766s/iter; left time: 6278.7302s
	iters: 200, epoch: 25 | loss: 0.0018019
	speed: 0.0363s/iter; left time: 1287.6211s
	iters: 300, epoch: 25 | loss: 0.0317154
	speed: 0.0389s/iter; left time: 1375.2302s
	iters: 400, epoch: 25 | loss: 0.0035983
	speed: 0.0387s/iter; left time: 1362.9778s
Epoch: 25 cost time: 18.016462326049805
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0028365
	speed: 0.1756s/iter; left time: 6160.9815s
	iters: 200, epoch: 26 | loss: 0.0000907
	speed: 0.0393s/iter; left time: 1374.5522s
	iters: 300, epoch: 26 | loss: 0.0005276
	speed: 0.0393s/iter; left time: 1371.1404s
	iters: 400, epoch: 26 | loss: 0.0001154
	speed: 0.0399s/iter; left time: 1387.9720s
Epoch: 26 cost time: 18.537785530090332
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0031898
	speed: 0.1820s/iter; left time: 6299.1720s
	iters: 200, epoch: 27 | loss: 0.0146121
	speed: 0.0379s/iter; left time: 1309.1113s
	iters: 300, epoch: 27 | loss: 0.0065654
	speed: 0.0367s/iter; left time: 1261.5918s
	iters: 400, epoch: 27 | loss: 0.0090946
	speed: 0.0366s/iter; left time: 1254.9091s
Epoch: 27 cost time: 18.050639390945435
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.1590498
	speed: 0.1792s/iter; left time: 6119.2204s
	iters: 200, epoch: 28 | loss: 0.0019832
	speed: 0.0382s/iter; left time: 1299.0860s
	iters: 300, epoch: 28 | loss: 0.0045737
	speed: 0.0374s/iter; left time: 1268.8275s
	iters: 400, epoch: 28 | loss: 0.0032365
	speed: 0.0373s/iter; left time: 1262.8316s
Epoch: 28 cost time: 18.00332283973694
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 548026
model size : 3.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2866154
	speed: 0.0553s/iter; left time: 2588.2639s
	iters: 200, epoch: 1 | loss: 0.3514565
	speed: 0.0359s/iter; left time: 1677.7549s
	iters: 300, epoch: 1 | loss: 0.5560733
	speed: 0.0361s/iter; left time: 1683.0875s
	iters: 400, epoch: 1 | loss: 0.4553681
	speed: 0.0391s/iter; left time: 1817.6043s
Epoch: 1 cost time: 19.26198434829712
Epoch: 1, Steps: 469 | Train Loss: 0.809 Vali Loss: 0.359 Vali Acc: 0.884 Test Loss: 0.359 Test Acc: 0.884
Validation loss decreased (inf --> -0.883930).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2461725
	speed: 0.1732s/iter; left time: 8025.9860s
	iters: 200, epoch: 2 | loss: 0.0915143
	speed: 0.0360s/iter; left time: 1662.9383s
	iters: 300, epoch: 2 | loss: 0.1967657
	speed: 0.0360s/iter; left time: 1661.2514s
	iters: 400, epoch: 2 | loss: 0.1489025
	speed: 0.0363s/iter; left time: 1669.1815s
Epoch: 2 cost time: 17.330132961273193
Epoch: 2, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.218 Vali Acc: 0.934 Test Loss: 0.218 Test Acc: 0.934
Validation loss decreased (-0.883930 --> -0.933960).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1065896
	speed: 0.1800s/iter; left time: 8257.2663s
	iters: 200, epoch: 3 | loss: 0.0898093
	speed: 0.0375s/iter; left time: 1716.5919s
	iters: 300, epoch: 3 | loss: 0.2381321
	speed: 0.0374s/iter; left time: 1708.0141s
	iters: 400, epoch: 3 | loss: 0.0172281
	speed: 0.0376s/iter; left time: 1711.0711s
Epoch: 3 cost time: 18.218846321105957
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
Validation loss decreased (-0.933960 --> -0.945681).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1673758
	speed: 0.1755s/iter; left time: 7964.9467s
	iters: 200, epoch: 4 | loss: 0.0745308
	speed: 0.0381s/iter; left time: 1726.8790s
	iters: 300, epoch: 4 | loss: 0.0960643
	speed: 0.0408s/iter; left time: 1846.0261s
	iters: 400, epoch: 4 | loss: 0.0236237
	speed: 0.0428s/iter; left time: 1930.2183s
Epoch: 4 cost time: 19.20732855796814
Epoch: 4, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
Validation loss decreased (-0.945681 --> -0.953114).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0486592
	speed: 0.1785s/iter; left time: 8017.8358s
	iters: 200, epoch: 5 | loss: 0.1401896
	speed: 0.0372s/iter; left time: 1667.7829s
	iters: 300, epoch: 5 | loss: 0.0802219
	speed: 0.0384s/iter; left time: 1718.9739s
	iters: 400, epoch: 5 | loss: 0.0585466
	speed: 0.0367s/iter; left time: 1637.1910s
Epoch: 5 cost time: 18.03062343597412
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.953114 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0295482
	speed: 0.1830s/iter; left time: 8136.3842s
	iters: 200, epoch: 6 | loss: 0.0380471
	speed: 0.0377s/iter; left time: 1673.2732s
	iters: 300, epoch: 6 | loss: 0.0309688
	speed: 0.0364s/iter; left time: 1610.1594s
	iters: 400, epoch: 6 | loss: 0.0407308
	speed: 0.0376s/iter; left time: 1659.5833s
Epoch: 6 cost time: 18.066632747650146
Epoch: 6, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.963692 --> -0.965122).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0448044
	speed: 0.1810s/iter; left time: 7963.0814s
	iters: 200, epoch: 7 | loss: 0.0160044
	speed: 0.0363s/iter; left time: 1592.8514s
	iters: 300, epoch: 7 | loss: 0.0071617
	speed: 0.0358s/iter; left time: 1569.2100s
	iters: 400, epoch: 7 | loss: 0.0461149
	speed: 0.0371s/iter; left time: 1618.9355s
Epoch: 7 cost time: 17.455374240875244
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.965122 --> -0.970553).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0549471
	speed: 0.1651s/iter; left time: 7184.9195s
	iters: 200, epoch: 8 | loss: 0.0501566
	speed: 0.0415s/iter; left time: 1800.3730s
	iters: 300, epoch: 8 | loss: 0.1033334
	speed: 0.0414s/iter; left time: 1793.3418s
	iters: 400, epoch: 8 | loss: 0.0008657
	speed: 0.0400s/iter; left time: 1728.9968s
Epoch: 8 cost time: 19.078332662582397
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
Validation loss decreased (-0.970553 --> -0.972269).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0116334
	speed: 0.1915s/iter; left time: 8242.3913s
	iters: 200, epoch: 9 | loss: 0.0023263
	speed: 0.0386s/iter; left time: 1655.7991s
	iters: 300, epoch: 9 | loss: 0.1269429
	speed: 0.0384s/iter; left time: 1646.1731s
	iters: 400, epoch: 9 | loss: 0.4024525
	speed: 0.0398s/iter; left time: 1703.5126s
Epoch: 9 cost time: 19.163446187973022
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0079457
	speed: 0.1908s/iter; left time: 8122.1568s
	iters: 200, epoch: 10 | loss: 0.0476824
	speed: 0.0396s/iter; left time: 1681.2342s
	iters: 300, epoch: 10 | loss: 0.0833387
	speed: 0.0396s/iter; left time: 1679.5392s
	iters: 400, epoch: 10 | loss: 0.0701948
	speed: 0.0387s/iter; left time: 1634.3667s
Epoch: 10 cost time: 18.698862552642822
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0514839
	speed: 0.1807s/iter; left time: 7611.3505s
	iters: 200, epoch: 11 | loss: 0.0255550
	speed: 0.0391s/iter; left time: 1640.9244s
	iters: 300, epoch: 11 | loss: 0.0195909
	speed: 0.0363s/iter; left time: 1522.9258s
	iters: 400, epoch: 11 | loss: 0.0006729
	speed: 0.0351s/iter; left time: 1467.0471s
Epoch: 11 cost time: 17.915039777755737
Epoch: 11, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0273569
	speed: 0.1758s/iter; left time: 7319.0891s
	iters: 200, epoch: 12 | loss: 0.0364475
	speed: 0.0371s/iter; left time: 1540.3075s
	iters: 300, epoch: 12 | loss: 0.0030864
	speed: 0.0345s/iter; left time: 1429.9238s
	iters: 400, epoch: 12 | loss: 0.0029487
	speed: 0.0363s/iter; left time: 1499.8615s
Epoch: 12 cost time: 17.588018655776978
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.972840).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0024959
	speed: 0.1776s/iter; left time: 7312.5349s
	iters: 200, epoch: 13 | loss: 0.0091062
	speed: 0.0436s/iter; left time: 1792.1389s
	iters: 300, epoch: 13 | loss: 0.0009290
	speed: 0.0426s/iter; left time: 1747.1701s
	iters: 400, epoch: 13 | loss: 0.0442029
	speed: 0.0428s/iter; left time: 1748.9331s
Epoch: 13 cost time: 20.301127195358276
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.972840 --> -0.979130).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0170391
	speed: 0.1913s/iter; left time: 7787.7921s
	iters: 200, epoch: 14 | loss: 0.0183434
	speed: 0.0409s/iter; left time: 1659.6344s
	iters: 300, epoch: 14 | loss: 0.0078287
	speed: 0.0410s/iter; left time: 1661.7854s
	iters: 400, epoch: 14 | loss: 0.0007042
	speed: 0.0414s/iter; left time: 1673.0350s
Epoch: 14 cost time: 19.707124948501587
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0236306
	speed: 0.1848s/iter; left time: 7436.4219s
	iters: 200, epoch: 15 | loss: 0.0059838
	speed: 0.0373s/iter; left time: 1495.5508s
	iters: 300, epoch: 15 | loss: 0.1724699
	speed: 0.0373s/iter; left time: 1493.9773s
	iters: 400, epoch: 15 | loss: 0.0213680
	speed: 0.0388s/iter; left time: 1551.0725s
Epoch: 15 cost time: 18.16166377067566
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0373670
	speed: 0.1771s/iter; left time: 7041.8938s
	iters: 200, epoch: 16 | loss: 0.0063656
	speed: 0.0367s/iter; left time: 1455.5508s
	iters: 300, epoch: 16 | loss: 0.0010259
	speed: 0.0382s/iter; left time: 1510.6411s
	iters: 400, epoch: 16 | loss: 0.0043365
	speed: 0.0366s/iter; left time: 1444.9133s
Epoch: 16 cost time: 17.534006357192993
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0019582
	speed: 0.1748s/iter; left time: 6870.7420s
	iters: 200, epoch: 17 | loss: 0.0019408
	speed: 0.0397s/iter; left time: 1555.7878s
	iters: 300, epoch: 17 | loss: 0.1390965
	speed: 0.0337s/iter; left time: 1317.6273s
	iters: 400, epoch: 17 | loss: 0.0413550
	speed: 0.0343s/iter; left time: 1336.1926s
Epoch: 17 cost time: 17.668185710906982
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0034649
	speed: 0.1621s/iter; left time: 6295.2641s
	iters: 200, epoch: 18 | loss: 0.0053411
	speed: 0.0370s/iter; left time: 1433.1283s
	iters: 300, epoch: 18 | loss: 0.0177719
	speed: 0.0424s/iter; left time: 1639.2481s
	iters: 400, epoch: 18 | loss: 0.0002391
	speed: 0.0422s/iter; left time: 1626.5422s
Epoch: 18 cost time: 19.22074556350708
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0034452
	speed: 0.1889s/iter; left time: 7245.0635s
	iters: 200, epoch: 19 | loss: 0.0067342
	speed: 0.0413s/iter; left time: 1578.4739s
	iters: 300, epoch: 19 | loss: 0.0252634
	speed: 0.0434s/iter; left time: 1655.2485s
	iters: 400, epoch: 19 | loss: 0.0401334
	speed: 0.0402s/iter; left time: 1530.4318s
Epoch: 19 cost time: 19.46768569946289
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980845).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0051237
	speed: 0.1908s/iter; left time: 7229.6632s
	iters: 200, epoch: 20 | loss: 0.0280792
	speed: 0.0403s/iter; left time: 1522.3331s
	iters: 300, epoch: 20 | loss: 0.0008365
	speed: 0.0396s/iter; left time: 1490.7485s
	iters: 400, epoch: 20 | loss: 0.0048612
	speed: 0.0369s/iter; left time: 1386.0485s
Epoch: 20 cost time: 18.718229293823242
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0051200
	speed: 0.1754s/iter; left time: 6564.1537s
	iters: 200, epoch: 21 | loss: 0.0011460
	speed: 0.0346s/iter; left time: 1291.7793s
	iters: 300, epoch: 21 | loss: 0.0030146
	speed: 0.0353s/iter; left time: 1315.5764s
	iters: 400, epoch: 21 | loss: 0.0041809
	speed: 0.0358s/iter; left time: 1328.2025s
Epoch: 21 cost time: 17.067649841308594
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981131).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0078482
	speed: 0.1738s/iter; left time: 6422.8893s
	iters: 200, epoch: 22 | loss: 0.0001327
	speed: 0.0375s/iter; left time: 1381.5968s
	iters: 300, epoch: 22 | loss: 0.5569292
	speed: 0.0378s/iter; left time: 1389.1835s
	iters: 400, epoch: 22 | loss: 0.0028499
	speed: 0.0405s/iter; left time: 1483.4665s
Epoch: 22 cost time: 18.26641035079956
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0017619
	speed: 0.1787s/iter; left time: 6518.7628s
	iters: 200, epoch: 23 | loss: 0.0003921
	speed: 0.0380s/iter; left time: 1382.0415s
	iters: 300, epoch: 23 | loss: 0.2195772
	speed: 0.0378s/iter; left time: 1370.6981s
	iters: 400, epoch: 23 | loss: 0.0119202
	speed: 0.0364s/iter; left time: 1315.9614s
Epoch: 23 cost time: 18.515920639038086
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0047137
	speed: 0.1927s/iter; left time: 6939.3062s
	iters: 200, epoch: 24 | loss: 0.2606977
	speed: 0.0405s/iter; left time: 1455.5131s
	iters: 300, epoch: 24 | loss: 0.0094785
	speed: 0.0405s/iter; left time: 1449.7460s
	iters: 400, epoch: 24 | loss: 0.0049360
	speed: 0.0428s/iter; left time: 1528.0474s
Epoch: 24 cost time: 20.00011444091797
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0024515
	speed: 0.1833s/iter; left time: 6515.7458s
	iters: 200, epoch: 25 | loss: 0.1686857
	speed: 0.0421s/iter; left time: 1493.8554s
	iters: 300, epoch: 25 | loss: 0.1971600
	speed: 0.0407s/iter; left time: 1439.5409s
	iters: 400, epoch: 25 | loss: 0.0048301
	speed: 0.0380s/iter; left time: 1339.4368s
Epoch: 25 cost time: 18.809504747390747
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0037794
	speed: 0.1770s/iter; left time: 6207.7015s
	iters: 200, epoch: 26 | loss: 0.0012847
	speed: 0.0375s/iter; left time: 1310.5853s
	iters: 300, epoch: 26 | loss: 0.0022950
	speed: 0.0366s/iter; left time: 1275.3910s
	iters: 400, epoch: 26 | loss: 0.2527781
	speed: 0.0363s/iter; left time: 1263.1275s
Epoch: 26 cost time: 17.902151346206665
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0011446
	speed: 0.1757s/iter; left time: 6079.1127s
	iters: 200, epoch: 27 | loss: 0.0018739
	speed: 0.0369s/iter; left time: 1271.9745s
	iters: 300, epoch: 27 | loss: 0.0014474
	speed: 0.0374s/iter; left time: 1288.2890s
	iters: 400, epoch: 27 | loss: 0.0256663
	speed: 0.0390s/iter; left time: 1339.0182s
Epoch: 27 cost time: 18.01634979248047
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0079743
	speed: 0.1813s/iter; left time: 6189.0483s
	iters: 200, epoch: 28 | loss: 0.0010614
	speed: 0.0407s/iter; left time: 1383.8379s
	iters: 300, epoch: 28 | loss: 0.0033301
	speed: 0.0399s/iter; left time: 1354.0005s
	iters: 400, epoch: 28 | loss: 0.0440391
	speed: 0.0366s/iter; left time: 1239.3410s
Epoch: 28 cost time: 18.476748943328857
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1204911
	speed: 0.1715s/iter; left time: 5773.2880s
	iters: 200, epoch: 29 | loss: 0.0001312
	speed: 0.0364s/iter; left time: 1222.0613s
	iters: 300, epoch: 29 | loss: 0.0015772
	speed: 0.0362s/iter; left time: 1212.3084s
	iters: 400, epoch: 29 | loss: 0.0052509
	speed: 0.0360s/iter; left time: 1200.2212s
Epoch: 29 cost time: 17.466440677642822
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0082587
	speed: 0.1699s/iter; left time: 5641.5519s
	iters: 200, epoch: 30 | loss: 0.0102258
	speed: 0.0356s/iter; left time: 1176.8958s
	iters: 300, epoch: 30 | loss: 0.0095618
	speed: 0.0352s/iter; left time: 1162.7493s
	iters: 400, epoch: 30 | loss: 0.0483905
	speed: 0.0364s/iter; left time: 1196.6518s
Epoch: 30 cost time: 17.32536792755127
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0032771
	speed: 0.1758s/iter; left time: 5754.1036s
	iters: 200, epoch: 31 | loss: 0.0630356
	speed: 0.0423s/iter; left time: 1380.7066s
	iters: 300, epoch: 31 | loss: 0.0004242
	speed: 0.0396s/iter; left time: 1288.0806s
	iters: 400, epoch: 31 | loss: 0.0037054
	speed: 0.0395s/iter; left time: 1280.4274s
Epoch: 31 cost time: 19.49718403816223
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0047956
	speed: 0.1890s/iter; left time: 6096.2157s
	iters: 200, epoch: 32 | loss: 0.0007130
	speed: 0.0401s/iter; left time: 1290.0375s
	iters: 300, epoch: 32 | loss: 0.0005634
	speed: 0.0391s/iter; left time: 1252.1650s
	iters: 400, epoch: 32 | loss: 0.0059427
	speed: 0.0396s/iter; left time: 1266.8774s
Epoch: 32 cost time: 19.297953128814697
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0015697
	speed: 0.1848s/iter; left time: 5876.4902s
	iters: 200, epoch: 33 | loss: 0.0208773
	speed: 0.0365s/iter; left time: 1157.0921s
	iters: 300, epoch: 33 | loss: 0.0034501
	speed: 0.0379s/iter; left time: 1197.3175s
	iters: 400, epoch: 33 | loss: 0.0012639
	speed: 0.0375s/iter; left time: 1182.1376s
Epoch: 33 cost time: 17.921001195907593
Epoch: 33, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0355536
	speed: 0.1763s/iter; left time: 5522.6879s
	iters: 200, epoch: 34 | loss: 0.0025679
	speed: 0.0376s/iter; left time: 1175.2285s
	iters: 300, epoch: 34 | loss: 0.0000977
	speed: 0.0377s/iter; left time: 1172.8165s
	iters: 400, epoch: 34 | loss: 0.0009196
	speed: 0.0365s/iter; left time: 1131.7532s
Epoch: 34 cost time: 17.722821950912476
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0182696
	speed: 0.1802s/iter; left time: 5559.9228s
	iters: 200, epoch: 35 | loss: 0.0003242
	speed: 0.0366s/iter; left time: 1124.7726s
	iters: 300, epoch: 35 | loss: 0.0205168
	speed: 0.0369s/iter; left time: 1130.2201s
	iters: 400, epoch: 35 | loss: 0.0000120
	speed: 0.0372s/iter; left time: 1135.4726s
Epoch: 35 cost time: 18.16636562347412
Epoch: 35, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0178710
	speed: 0.1802s/iter; left time: 5474.3879s
	iters: 200, epoch: 36 | loss: 0.0000643
	speed: 0.0404s/iter; left time: 1222.4505s
	iters: 300, epoch: 36 | loss: 0.0005455
	speed: 0.0406s/iter; left time: 1225.4333s
	iters: 400, epoch: 36 | loss: 0.0012539
	speed: 0.0407s/iter; left time: 1225.5899s
Epoch: 36 cost time: 19.554869890213013
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0018270
	speed: 0.1846s/iter; left time: 5521.3087s
	iters: 200, epoch: 37 | loss: 0.0001484
	speed: 0.0397s/iter; left time: 1185.1123s
	iters: 300, epoch: 37 | loss: 0.0099927
	speed: 0.0379s/iter; left time: 1125.5817s
	iters: 400, epoch: 37 | loss: 0.0010290
	speed: 0.0374s/iter; left time: 1108.9690s
Epoch: 37 cost time: 18.70062565803528
Epoch: 37, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.1256339
	speed: 0.1812s/iter; left time: 5335.2803s
	iters: 200, epoch: 38 | loss: 0.0006806
	speed: 0.0382s/iter; left time: 1122.1550s
	iters: 300, epoch: 38 | loss: 0.3385250
	speed: 0.0369s/iter; left time: 1079.5972s
	iters: 400, epoch: 38 | loss: 0.0000509
	speed: 0.0368s/iter; left time: 1073.1843s
Epoch: 38 cost time: 17.76290988922119
Epoch: 38, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0978402
	speed: 0.1695s/iter; left time: 4911.8462s
	iters: 200, epoch: 39 | loss: 0.0026972
	speed: 0.0396s/iter; left time: 1142.9498s
	iters: 300, epoch: 39 | loss: 0.0018859
	speed: 0.0374s/iter; left time: 1077.1939s
	iters: 400, epoch: 39 | loss: 0.0383567
	speed: 0.0380s/iter; left time: 1089.2771s
Epoch: 39 cost time: 18.149815559387207
Epoch: 39, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.983418).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0002026
	speed: 0.1662s/iter; left time: 4737.4182s
	iters: 200, epoch: 40 | loss: 0.0014558
	speed: 0.0383s/iter; left time: 1087.3681s
	iters: 300, epoch: 40 | loss: 0.0428941
	speed: 0.0377s/iter; left time: 1066.6905s
	iters: 400, epoch: 40 | loss: 0.0000898
	speed: 0.0375s/iter; left time: 1058.9489s
Epoch: 40 cost time: 18.318422555923462
Epoch: 40, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0012252
	speed: 0.1782s/iter; left time: 4998.0156s
	iters: 200, epoch: 41 | loss: 0.0386326
	speed: 0.0379s/iter; left time: 1058.3312s
	iters: 300, epoch: 41 | loss: 0.0076963
	speed: 0.0383s/iter; left time: 1065.6195s
	iters: 400, epoch: 41 | loss: 0.0338327
	speed: 0.0404s/iter; left time: 1119.7603s
Epoch: 41 cost time: 18.832151174545288
Epoch: 41, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.984 Test Loss: 0.108 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983990).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0140102
	speed: 0.1786s/iter; left time: 4924.5586s
	iters: 200, epoch: 42 | loss: 0.0547250
	speed: 0.0375s/iter; left time: 1029.3266s
	iters: 300, epoch: 42 | loss: 0.0493278
	speed: 0.0380s/iter; left time: 1039.8613s
	iters: 400, epoch: 42 | loss: 0.0005333
	speed: 0.0381s/iter; left time: 1038.7213s
Epoch: 42 cost time: 17.97083020210266
Epoch: 42, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0002982
	speed: 0.1778s/iter; left time: 4819.3119s
	iters: 200, epoch: 43 | loss: 0.0000519
	speed: 0.0378s/iter; left time: 1020.3058s
	iters: 300, epoch: 43 | loss: 0.0001914
	speed: 0.0385s/iter; left time: 1034.6889s
	iters: 400, epoch: 43 | loss: 0.0042170
	speed: 0.0380s/iter; left time: 1017.3477s
Epoch: 43 cost time: 18.38296914100647
Epoch: 43, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.983990).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0972251
	speed: 0.1824s/iter; left time: 4856.8892s
	iters: 200, epoch: 44 | loss: 0.0071114
	speed: 0.0372s/iter; left time: 988.2496s
	iters: 300, epoch: 44 | loss: 0.0155020
	speed: 0.0382s/iter; left time: 1008.8765s
	iters: 400, epoch: 44 | loss: 0.0000477
	speed: 0.0388s/iter; left time: 1022.2594s
Epoch: 44 cost time: 18.24976086616516
Epoch: 44, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0016321
	speed: 0.1793s/iter; left time: 4692.4790s
	iters: 200, epoch: 45 | loss: 0.0161129
	speed: 0.0374s/iter; left time: 975.9899s
	iters: 300, epoch: 45 | loss: 0.0027264
	speed: 0.0380s/iter; left time: 986.8538s
	iters: 400, epoch: 45 | loss: 0.0029916
	speed: 0.0376s/iter; left time: 972.3482s
Epoch: 45 cost time: 17.911049842834473
Epoch: 45, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0058913
	speed: 0.1752s/iter; left time: 4502.0984s
	iters: 200, epoch: 46 | loss: 0.0053515
	speed: 0.0391s/iter; left time: 1001.6789s
	iters: 300, epoch: 46 | loss: 0.0131037
	speed: 0.0378s/iter; left time: 964.9692s
	iters: 400, epoch: 46 | loss: 0.0048284
	speed: 0.0372s/iter; left time: 945.4148s
Epoch: 46 cost time: 18.228686332702637
Epoch: 46, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 47 | loss: 0.0002159
	speed: 0.1796s/iter; left time: 4531.0883s
	iters: 200, epoch: 47 | loss: 0.1773484
	speed: 0.0359s/iter; left time: 902.1754s
	iters: 300, epoch: 47 | loss: 0.0178172
	speed: 0.0369s/iter; left time: 924.2115s
	iters: 400, epoch: 47 | loss: 0.0003086
	speed: 0.0390s/iter; left time: 971.1199s
Epoch: 47 cost time: 17.99643301963806
Epoch: 47, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 48 | loss: 0.0077615
	speed: 0.1840s/iter; left time: 4554.8231s
	iters: 200, epoch: 48 | loss: 0.0090793
	speed: 0.0364s/iter; left time: 896.4466s
	iters: 300, epoch: 48 | loss: 0.0016841
	speed: 0.0386s/iter; left time: 948.7081s
	iters: 400, epoch: 48 | loss: 0.0018910
	speed: 0.0377s/iter; left time: 922.8265s
Epoch: 48 cost time: 18.360716104507446
Epoch: 48, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 49 | loss: 0.0000393
	speed: 0.1798s/iter; left time: 4368.0296s
	iters: 200, epoch: 49 | loss: 0.0109156
	speed: 0.0384s/iter; left time: 929.6428s
	iters: 300, epoch: 49 | loss: 0.0000201
	speed: 0.0369s/iter; left time: 888.9226s
	iters: 400, epoch: 49 | loss: 0.0019281
	speed: 0.0366s/iter; left time: 877.8925s
Epoch: 49 cost time: 18.044870615005493
Epoch: 49, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 50 | loss: 0.0209182
	speed: 0.1765s/iter; left time: 4204.4231s
	iters: 200, epoch: 50 | loss: 0.0014937
	speed: 0.0349s/iter; left time: 826.9125s
	iters: 300, epoch: 50 | loss: 0.0001088
	speed: 0.0365s/iter; left time: 862.4925s
	iters: 400, epoch: 50 | loss: 0.0000180
	speed: 0.0374s/iter; left time: 878.7058s
Epoch: 50 cost time: 17.496981143951416
Epoch: 50, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 51 | loss: 0.0007923
	speed: 0.1668s/iter; left time: 3895.4101s
	iters: 200, epoch: 51 | loss: 0.2166543
	speed: 0.0359s/iter; left time: 834.0207s
	iters: 300, epoch: 51 | loss: 0.0199306
	speed: 0.0369s/iter; left time: 854.3176s
	iters: 400, epoch: 51 | loss: 0.0001179
	speed: 0.0391s/iter; left time: 901.4283s
Epoch: 51 cost time: 17.687520503997803
Epoch: 51, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 52 | loss: 0.0028667
	speed: 0.1786s/iter; left time: 4086.7853s
	iters: 200, epoch: 52 | loss: 0.0010071
	speed: 0.0403s/iter; left time: 918.9476s
	iters: 300, epoch: 52 | loss: 0.0021175
	speed: 0.0408s/iter; left time: 924.8526s
	iters: 400, epoch: 52 | loss: 0.0003666
	speed: 0.0395s/iter; left time: 891.3341s
Epoch: 52 cost time: 19.22312903404236
Epoch: 52, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.984 Test Loss: 0.105 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 53 | loss: 0.0011092
	speed: 0.1846s/iter; left time: 4138.4536s
	iters: 200, epoch: 53 | loss: 0.0411217
	speed: 0.0386s/iter; left time: 860.6999s
	iters: 300, epoch: 53 | loss: 0.0007502
	speed: 0.0378s/iter; left time: 840.2702s
	iters: 400, epoch: 53 | loss: 0.0130934
	speed: 0.0413s/iter; left time: 913.7752s
Epoch: 53 cost time: 18.957552671432495
Epoch: 53, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 285882
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2660687
	speed: 0.0566s/iter; left time: 2651.1314s
	iters: 200, epoch: 1 | loss: 0.3139241
	speed: 0.0374s/iter; left time: 1747.2933s
	iters: 300, epoch: 1 | loss: 0.5601467
	speed: 0.0360s/iter; left time: 1675.7198s
	iters: 400, epoch: 1 | loss: 0.4531864
	speed: 0.0363s/iter; left time: 1689.3975s
Epoch: 1 cost time: 19.331984519958496
Epoch: 1, Steps: 469 | Train Loss: 0.784 Vali Loss: 0.300 Vali Acc: 0.907 Test Loss: 0.300 Test Acc: 0.907
Validation loss decreased (inf --> -0.907087).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2267668
	speed: 0.1736s/iter; left time: 8041.9773s
	iters: 200, epoch: 2 | loss: 0.0749352
	speed: 0.0363s/iter; left time: 1679.9676s
	iters: 300, epoch: 2 | loss: 0.0692455
	speed: 0.0352s/iter; left time: 1624.3117s
	iters: 400, epoch: 2 | loss: 0.0857318
	speed: 0.0357s/iter; left time: 1644.6675s
Epoch: 2 cost time: 17.275256395339966
Epoch: 2, Steps: 469 | Train Loss: 0.175 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.907087 --> -0.953686).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0741137
	speed: 0.1679s/iter; left time: 7698.9611s
	iters: 200, epoch: 3 | loss: 0.0633043
	speed: 0.0368s/iter; left time: 1683.0668s
	iters: 300, epoch: 3 | loss: 0.2659340
	speed: 0.0373s/iter; left time: 1704.5348s
	iters: 400, epoch: 3 | loss: 0.0204377
	speed: 0.0392s/iter; left time: 1785.1721s
Epoch: 3 cost time: 18.165815830230713
Epoch: 3, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.953686 --> -0.955401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3027522
	speed: 0.1840s/iter; left time: 8350.2641s
	iters: 200, epoch: 4 | loss: 0.0475172
	speed: 0.0395s/iter; left time: 1789.0843s
	iters: 300, epoch: 4 | loss: 0.1085395
	speed: 0.0418s/iter; left time: 1887.3071s
	iters: 400, epoch: 4 | loss: 0.0235681
	speed: 0.0400s/iter; left time: 1802.7339s
Epoch: 4 cost time: 19.165406465530396
Epoch: 4, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.955401 --> -0.957974).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0292575
	speed: 0.1821s/iter; left time: 8180.8405s
	iters: 200, epoch: 5 | loss: 0.2278392
	speed: 0.0381s/iter; left time: 1709.5634s
	iters: 300, epoch: 5 | loss: 0.0867163
	speed: 0.0384s/iter; left time: 1715.7945s
	iters: 400, epoch: 5 | loss: 0.1242326
	speed: 0.0365s/iter; left time: 1628.7646s
Epoch: 5 cost time: 17.839346885681152
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.957974 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0137786
	speed: 0.1723s/iter; left time: 7658.9747s
	iters: 200, epoch: 6 | loss: 0.0441597
	speed: 0.0354s/iter; left time: 1568.1799s
	iters: 300, epoch: 6 | loss: 0.0866321
	speed: 0.0358s/iter; left time: 1585.3710s
	iters: 400, epoch: 6 | loss: 0.0523345
	speed: 0.0368s/iter; left time: 1626.5358s
Epoch: 6 cost time: 17.476386308670044
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
Validation loss decreased (-0.965407 --> -0.965979).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0552669
	speed: 0.1747s/iter; left time: 7683.0523s
	iters: 200, epoch: 7 | loss: 0.0149641
	speed: 0.0356s/iter; left time: 1562.7763s
	iters: 300, epoch: 7 | loss: 0.0043400
	speed: 0.0368s/iter; left time: 1612.6404s
	iters: 400, epoch: 7 | loss: 0.0117204
	speed: 0.0371s/iter; left time: 1622.3069s
Epoch: 7 cost time: 17.56608557701111
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0477471
	speed: 0.1776s/iter; left time: 7727.4004s
	iters: 200, epoch: 8 | loss: 0.0214539
	speed: 0.0365s/iter; left time: 1584.2876s
	iters: 300, epoch: 8 | loss: 0.1020495
	speed: 0.0364s/iter; left time: 1576.7427s
	iters: 400, epoch: 8 | loss: 0.0009155
	speed: 0.0373s/iter; left time: 1611.1489s
Epoch: 8 cost time: 17.845344305038452
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0786841
	speed: 0.1835s/iter; left time: 7900.2122s
	iters: 200, epoch: 9 | loss: 0.0028122
	speed: 0.0405s/iter; left time: 1737.9789s
	iters: 300, epoch: 9 | loss: 0.1600592
	speed: 0.0381s/iter; left time: 1632.8842s
	iters: 400, epoch: 9 | loss: 0.0864884
	speed: 0.0381s/iter; left time: 1628.4791s
Epoch: 9 cost time: 18.482974767684937
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0134577
	speed: 0.1757s/iter; left time: 7480.0885s
	iters: 200, epoch: 10 | loss: 0.0255657
	speed: 0.0381s/iter; left time: 1618.7457s
	iters: 300, epoch: 10 | loss: 0.0736090
	speed: 0.0384s/iter; left time: 1628.6137s
	iters: 400, epoch: 10 | loss: 0.0555127
	speed: 0.0366s/iter; left time: 1548.2565s
Epoch: 10 cost time: 17.86458730697632
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.969410 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0043082
	speed: 0.1748s/iter; left time: 7360.9521s
	iters: 200, epoch: 11 | loss: 0.0249458
	speed: 0.0356s/iter; left time: 1494.3764s
	iters: 300, epoch: 11 | loss: 0.0047187
	speed: 0.0365s/iter; left time: 1529.8130s
	iters: 400, epoch: 11 | loss: 0.0017477
	speed: 0.0393s/iter; left time: 1641.3479s
Epoch: 11 cost time: 17.72016930580139
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0086057
	speed: 0.1732s/iter; left time: 7212.9783s
	iters: 200, epoch: 12 | loss: 0.0057545
	speed: 0.0381s/iter; left time: 1584.7300s
	iters: 300, epoch: 12 | loss: 0.0011350
	speed: 0.0376s/iter; left time: 1556.7248s
	iters: 400, epoch: 12 | loss: 0.0007228
	speed: 0.0368s/iter; left time: 1519.8798s
Epoch: 12 cost time: 17.80587077140808
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0022313
	speed: 0.1755s/iter; left time: 7224.9996s
	iters: 200, epoch: 13 | loss: 0.0015586
	speed: 0.0369s/iter; left time: 1516.6519s
	iters: 300, epoch: 13 | loss: 0.0010846
	speed: 0.0380s/iter; left time: 1556.5231s
	iters: 400, epoch: 13 | loss: 0.0091805
	speed: 0.0359s/iter; left time: 1466.4221s
Epoch: 13 cost time: 17.84299635887146
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0048057
	speed: 0.1750s/iter; left time: 7124.6498s
	iters: 200, epoch: 14 | loss: 0.0355179
	speed: 0.0367s/iter; left time: 1491.4118s
	iters: 300, epoch: 14 | loss: 0.0164223
	speed: 0.0362s/iter; left time: 1467.2434s
	iters: 400, epoch: 14 | loss: 0.0013733
	speed: 0.0375s/iter; left time: 1515.9156s
Epoch: 14 cost time: 17.718042135238647
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0673681
	speed: 0.1766s/iter; left time: 7105.9574s
	iters: 200, epoch: 15 | loss: 0.0046762
	speed: 0.0362s/iter; left time: 1452.7256s
	iters: 300, epoch: 15 | loss: 0.3261994
	speed: 0.0399s/iter; left time: 1595.7342s
	iters: 400, epoch: 15 | loss: 0.0092727
	speed: 0.0394s/iter; left time: 1574.4382s
Epoch: 15 cost time: 18.262729167938232
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0204109
	speed: 0.1813s/iter; left time: 7207.9911s
	iters: 200, epoch: 16 | loss: 0.0053040
	speed: 0.0409s/iter; left time: 1620.6233s
	iters: 300, epoch: 16 | loss: 0.0012502
	speed: 0.0380s/iter; left time: 1501.9551s
	iters: 400, epoch: 16 | loss: 0.0028334
	speed: 0.0365s/iter; left time: 1440.2036s
Epoch: 16 cost time: 18.360790729522705
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0290261
	speed: 0.1755s/iter; left time: 6894.8879s
	iters: 200, epoch: 17 | loss: 0.1267414
	speed: 0.0361s/iter; left time: 1413.0765s
	iters: 300, epoch: 17 | loss: 0.0267562
	speed: 0.0381s/iter; left time: 1488.6733s
	iters: 400, epoch: 17 | loss: 0.0164173
	speed: 0.0366s/iter; left time: 1426.4141s
Epoch: 17 cost time: 17.685860872268677
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0017277
	speed: 0.1701s/iter; left time: 6606.5751s
	iters: 200, epoch: 18 | loss: 0.0096181
	speed: 0.0348s/iter; left time: 1346.8671s
	iters: 300, epoch: 18 | loss: 0.0264557
	speed: 0.0362s/iter; left time: 1399.7919s
	iters: 400, epoch: 18 | loss: 0.0034633
	speed: 0.0373s/iter; left time: 1438.1451s
Epoch: 18 cost time: 17.20812177658081
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0165160
	speed: 0.1720s/iter; left time: 6599.1865s
	iters: 200, epoch: 19 | loss: 0.0050197
	speed: 0.0357s/iter; left time: 1364.5865s
	iters: 300, epoch: 19 | loss: 0.0110217
	speed: 0.0353s/iter; left time: 1348.2092s
	iters: 400, epoch: 19 | loss: 0.0218031
	speed: 0.0344s/iter; left time: 1310.6737s
Epoch: 19 cost time: 16.96752381324768
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0046310
	speed: 0.1705s/iter; left time: 6459.5952s
	iters: 200, epoch: 20 | loss: 0.0167195
	speed: 0.0385s/iter; left time: 1454.8415s
	iters: 300, epoch: 20 | loss: 0.0055629
	speed: 0.0384s/iter; left time: 1448.9677s
	iters: 400, epoch: 20 | loss: 0.0276242
	speed: 0.0381s/iter; left time: 1431.4547s
Epoch: 20 cost time: 18.44211459159851
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0282443
	speed: 0.1826s/iter; left time: 6833.5003s
	iters: 200, epoch: 21 | loss: 0.0184934
	speed: 0.0387s/iter; left time: 1446.1312s
	iters: 300, epoch: 21 | loss: 0.0057586
	speed: 0.0391s/iter; left time: 1454.3646s
	iters: 400, epoch: 21 | loss: 0.0018963
	speed: 0.0397s/iter; left time: 1473.7949s
Epoch: 21 cost time: 18.583266735076904
Epoch: 21, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0063629
	speed: 0.1773s/iter; left time: 6549.9194s
	iters: 200, epoch: 22 | loss: 0.0085637
	speed: 0.0354s/iter; left time: 1302.8607s
	iters: 300, epoch: 22 | loss: 0.3032726
	speed: 0.0357s/iter; left time: 1313.0637s
	iters: 400, epoch: 22 | loss: 0.0024099
	speed: 0.0360s/iter; left time: 1320.1837s
Epoch: 22 cost time: 17.2514808177948
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981703).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0011176
	speed: 0.1713s/iter; left time: 6251.2974s
	iters: 200, epoch: 23 | loss: 0.0026936
	speed: 0.0364s/iter; left time: 1323.5644s
	iters: 300, epoch: 23 | loss: 0.0330381
	speed: 0.0353s/iter; left time: 1280.1211s
	iters: 400, epoch: 23 | loss: 0.0064101
	speed: 0.0344s/iter; left time: 1245.5483s
Epoch: 23 cost time: 16.948750495910645
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0073057
	speed: 0.1681s/iter; left time: 6053.0722s
	iters: 200, epoch: 24 | loss: 0.0849286
	speed: 0.0373s/iter; left time: 1338.1677s
	iters: 300, epoch: 24 | loss: 0.0233156
	speed: 0.0363s/iter; left time: 1298.7703s
	iters: 400, epoch: 24 | loss: 0.0017380
	speed: 0.0364s/iter; left time: 1299.3774s
Epoch: 24 cost time: 17.24777841567993
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0007019
	speed: 0.1687s/iter; left time: 5997.1410s
	iters: 200, epoch: 25 | loss: 0.0409798
	speed: 0.0405s/iter; left time: 1436.1637s
	iters: 300, epoch: 25 | loss: 0.0032351
	speed: 0.0394s/iter; left time: 1392.6671s
	iters: 400, epoch: 25 | loss: 0.0021447
	speed: 0.0385s/iter; left time: 1357.6763s
Epoch: 25 cost time: 18.951004028320312
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0296068
	speed: 0.1860s/iter; left time: 6522.5994s
	iters: 200, epoch: 26 | loss: 0.0012679
	speed: 0.0389s/iter; left time: 1360.8938s
	iters: 300, epoch: 26 | loss: 0.0021286
	speed: 0.0393s/iter; left time: 1371.5653s
	iters: 400, epoch: 26 | loss: 0.0156430
	speed: 0.0381s/iter; left time: 1324.9290s
Epoch: 26 cost time: 18.547359943389893
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0004556
	speed: 0.1784s/iter; left time: 6172.4473s
	iters: 200, epoch: 27 | loss: 0.0008396
	speed: 0.0359s/iter; left time: 1238.7099s
	iters: 300, epoch: 27 | loss: 0.0043372
	speed: 0.0369s/iter; left time: 1268.0946s
	iters: 400, epoch: 27 | loss: 0.0013001
	speed: 0.0370s/iter; left time: 1269.6089s
Epoch: 27 cost time: 17.610150575637817
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0011297
	speed: 0.1717s/iter; left time: 5862.9616s
	iters: 200, epoch: 28 | loss: 0.0003737
	speed: 0.0361s/iter; left time: 1229.6242s
	iters: 300, epoch: 28 | loss: 0.0007488
	speed: 0.0369s/iter; left time: 1251.1165s
	iters: 400, epoch: 28 | loss: 0.0115364
	speed: 0.0371s/iter; left time: 1254.0652s
Epoch: 28 cost time: 17.593804836273193
Epoch: 28, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0244160
	speed: 0.1768s/iter; left time: 5953.1479s
	iters: 200, epoch: 29 | loss: 0.0014965
	speed: 0.0361s/iter; left time: 1210.8835s
	iters: 300, epoch: 29 | loss: 0.0011540
	speed: 0.0361s/iter; left time: 1209.0765s
	iters: 400, epoch: 29 | loss: 0.0009487
	speed: 0.0363s/iter; left time: 1212.1837s
Epoch: 29 cost time: 17.8821017742157
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0306349
	speed: 0.1758s/iter; left time: 5835.3651s
	iters: 200, epoch: 30 | loss: 0.0102510
	speed: 0.0361s/iter; left time: 1195.1267s
	iters: 300, epoch: 30 | loss: 0.0080614
	speed: 0.0339s/iter; left time: 1119.3929s
	iters: 400, epoch: 30 | loss: 0.0008328
	speed: 0.0397s/iter; left time: 1304.5717s
Epoch: 30 cost time: 17.74895691871643
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0030001
	speed: 0.1852s/iter; left time: 6062.5925s
	iters: 200, epoch: 31 | loss: 0.2156594
	speed: 0.0400s/iter; left time: 1306.6589s
	iters: 300, epoch: 31 | loss: 0.0004966
	speed: 0.0385s/iter; left time: 1253.0833s
	iters: 400, epoch: 31 | loss: 0.0018537
	speed: 0.0386s/iter; left time: 1251.9594s
Epoch: 31 cost time: 18.594900131225586
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0020541
	speed: 0.1816s/iter; left time: 5858.5576s
	iters: 200, epoch: 32 | loss: 0.0021433
	speed: 0.0376s/iter; left time: 1207.8512s
	iters: 300, epoch: 32 | loss: 0.0034920
	speed: 0.0362s/iter; left time: 1161.3956s
	iters: 400, epoch: 32 | loss: 0.0030716
	speed: 0.0366s/iter; left time: 1171.0766s
Epoch: 32 cost time: 17.9175865650177
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 285882
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2052866
	speed: 0.0563s/iter; left time: 2633.8869s
	iters: 200, epoch: 1 | loss: 0.3892194
	speed: 0.0352s/iter; left time: 1642.9450s
	iters: 300, epoch: 1 | loss: 0.5291362
	speed: 0.0363s/iter; left time: 1692.1026s
	iters: 400, epoch: 1 | loss: 0.5429356
	speed: 0.0366s/iter; left time: 1703.2021s
Epoch: 1 cost time: 19.245887279510498
Epoch: 1, Steps: 469 | Train Loss: 0.778 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
Validation loss decreased (inf --> -0.928242).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2213577
	speed: 0.1782s/iter; left time: 8256.6608s
	iters: 200, epoch: 2 | loss: 0.0989460
	speed: 0.0368s/iter; left time: 1700.3753s
	iters: 300, epoch: 2 | loss: 0.1093560
	speed: 0.0384s/iter; left time: 1769.9905s
	iters: 400, epoch: 2 | loss: 0.0498405
	speed: 0.0347s/iter; left time: 1596.3144s
Epoch: 2 cost time: 17.57543706893921
Epoch: 2, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.928242 --> -0.957403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2184671
	speed: 0.1717s/iter; left time: 7872.5923s
	iters: 200, epoch: 3 | loss: 0.0519069
	speed: 0.0394s/iter; left time: 1803.8457s
	iters: 300, epoch: 3 | loss: 0.1621172
	speed: 0.0375s/iter; left time: 1711.3521s
	iters: 400, epoch: 3 | loss: 0.0230086
	speed: 0.0382s/iter; left time: 1740.6145s
Epoch: 3 cost time: 18.094974517822266
Epoch: 3, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.957403 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1806700
	speed: 0.1830s/iter; left time: 8309.0206s
	iters: 200, epoch: 4 | loss: 0.1327717
	speed: 0.0369s/iter; left time: 1672.6269s
	iters: 300, epoch: 4 | loss: 0.0237438
	speed: 0.0384s/iter; left time: 1733.9484s
	iters: 400, epoch: 4 | loss: 0.0048135
	speed: 0.0411s/iter; left time: 1855.5493s
Epoch: 4 cost time: 18.63391900062561
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
Validation loss decreased (-0.961119 --> -0.963692).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0235595
	speed: 0.1854s/iter; left time: 8329.6036s
	iters: 200, epoch: 5 | loss: 0.3473969
	speed: 0.0386s/iter; left time: 1729.1881s
	iters: 300, epoch: 5 | loss: 0.0972928
	speed: 0.0363s/iter; left time: 1624.5519s
	iters: 400, epoch: 5 | loss: 0.0167420
	speed: 0.0388s/iter; left time: 1733.0007s
Epoch: 5 cost time: 18.294793844223022
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.963692 --> -0.972269).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0102831
	speed: 0.1765s/iter; left time: 7844.4339s
	iters: 200, epoch: 6 | loss: 0.0151891
	speed: 0.0400s/iter; left time: 1774.5935s
	iters: 300, epoch: 6 | loss: 0.0114926
	speed: 0.0392s/iter; left time: 1735.9541s
	iters: 400, epoch: 6 | loss: 0.0856972
	speed: 0.0371s/iter; left time: 1640.2242s
Epoch: 6 cost time: 18.27927041053772
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0574057
	speed: 0.1690s/iter; left time: 7434.7111s
	iters: 200, epoch: 7 | loss: 0.0046963
	speed: 0.0363s/iter; left time: 1594.9342s
	iters: 300, epoch: 7 | loss: 0.0091352
	speed: 0.0359s/iter; left time: 1573.7922s
	iters: 400, epoch: 7 | loss: 0.0269761
	speed: 0.0354s/iter; left time: 1544.3962s
Epoch: 7 cost time: 17.235873222351074
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0039952
	speed: 0.1680s/iter; left time: 7311.6768s
	iters: 200, epoch: 8 | loss: 0.0487521
	speed: 0.0347s/iter; left time: 1506.9784s
	iters: 300, epoch: 8 | loss: 0.0344403
	speed: 0.0369s/iter; left time: 1597.0478s
	iters: 400, epoch: 8 | loss: 0.0026471
	speed: 0.0363s/iter; left time: 1569.1872s
Epoch: 8 cost time: 17.271231412887573
Epoch: 8, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0059592
	speed: 0.1674s/iter; left time: 7205.3341s
	iters: 200, epoch: 9 | loss: 0.0038400
	speed: 0.0406s/iter; left time: 1745.8248s
	iters: 300, epoch: 9 | loss: 0.2380874
	speed: 0.0408s/iter; left time: 1746.2711s
	iters: 400, epoch: 9 | loss: 0.0619946
	speed: 0.0382s/iter; left time: 1632.6564s
Epoch: 9 cost time: 18.645061016082764
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0022328
	speed: 0.1806s/iter; left time: 7688.6153s
	iters: 200, epoch: 10 | loss: 0.0590597
	speed: 0.0388s/iter; left time: 1650.0472s
	iters: 300, epoch: 10 | loss: 0.0370530
	speed: 0.0366s/iter; left time: 1550.6320s
	iters: 400, epoch: 10 | loss: 0.0259950
	speed: 0.0357s/iter; left time: 1508.7393s
Epoch: 10 cost time: 17.983692407608032
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0479124
	speed: 0.1792s/iter; left time: 7548.2229s
	iters: 200, epoch: 11 | loss: 0.0086568
	speed: 0.0345s/iter; left time: 1449.7612s
	iters: 300, epoch: 11 | loss: 0.2186666
	speed: 0.0347s/iter; left time: 1452.8335s
	iters: 400, epoch: 11 | loss: 0.0033512
	speed: 0.0359s/iter; left time: 1500.5371s
Epoch: 11 cost time: 17.20015859603882
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.978844).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0289595
	speed: 0.1720s/iter; left time: 7162.3607s
	iters: 200, epoch: 12 | loss: 0.0064124
	speed: 0.0345s/iter; left time: 1432.2261s
	iters: 300, epoch: 12 | loss: 0.0233647
	speed: 0.0357s/iter; left time: 1480.1609s
	iters: 400, epoch: 12 | loss: 0.0076358
	speed: 0.0362s/iter; left time: 1497.0742s
Epoch: 12 cost time: 16.91436004638672
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0078485
	speed: 0.1777s/iter; left time: 7318.4595s
	iters: 200, epoch: 13 | loss: 0.0031524
	speed: 0.0402s/iter; left time: 1651.7410s
	iters: 300, epoch: 13 | loss: 0.0090738
	speed: 0.0362s/iter; left time: 1485.0904s
	iters: 400, epoch: 13 | loss: 0.0036022
	speed: 0.0357s/iter; left time: 1458.0266s
Epoch: 13 cost time: 18.114471912384033
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0038781
	speed: 0.1824s/iter; left time: 7425.5786s
	iters: 200, epoch: 14 | loss: 0.0166211
	speed: 0.0384s/iter; left time: 1560.8428s
	iters: 300, epoch: 14 | loss: 0.0039270
	speed: 0.0393s/iter; left time: 1591.9843s
	iters: 400, epoch: 14 | loss: 0.0013573
	speed: 0.0413s/iter; left time: 1670.0349s
Epoch: 14 cost time: 19.04114818572998
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.4345854
	speed: 0.1811s/iter; left time: 7287.4227s
	iters: 200, epoch: 15 | loss: 0.0041124
	speed: 0.0399s/iter; left time: 1602.8001s
	iters: 300, epoch: 15 | loss: 0.0704275
	speed: 0.0432s/iter; left time: 1729.7276s
	iters: 400, epoch: 15 | loss: 0.0034745
	speed: 0.0398s/iter; left time: 1590.6417s
Epoch: 15 cost time: 19.054831504821777
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0087914
	speed: 0.1753s/iter; left time: 6971.2659s
	iters: 200, epoch: 16 | loss: 0.0271820
	speed: 0.0369s/iter; left time: 1462.0267s
	iters: 300, epoch: 16 | loss: 0.0005519
	speed: 0.0375s/iter; left time: 1481.9907s
	iters: 400, epoch: 16 | loss: 0.0040794
	speed: 0.0353s/iter; left time: 1391.5952s
Epoch: 16 cost time: 17.595853567123413
Epoch: 16, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0485479
	speed: 0.1747s/iter; left time: 6863.5687s
	iters: 200, epoch: 17 | loss: 0.0148502
	speed: 0.0366s/iter; left time: 1435.3386s
	iters: 300, epoch: 17 | loss: 0.0011994
	speed: 0.0355s/iter; left time: 1386.6120s
	iters: 400, epoch: 17 | loss: 0.0560562
	speed: 0.0369s/iter; left time: 1437.7579s
Epoch: 17 cost time: 17.72736883163452
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0342355
	speed: 0.1770s/iter; left time: 6872.3482s
	iters: 200, epoch: 18 | loss: 0.0189684
	speed: 0.0393s/iter; left time: 1522.1986s
	iters: 300, epoch: 18 | loss: 0.0012512
	speed: 0.0415s/iter; left time: 1602.6162s
	iters: 400, epoch: 18 | loss: 0.0004151
	speed: 0.0383s/iter; left time: 1474.3580s
Epoch: 18 cost time: 18.468746662139893
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0003353
	speed: 0.1776s/iter; left time: 6812.0717s
	iters: 200, epoch: 19 | loss: 0.0007957
	speed: 0.0393s/iter; left time: 1502.2197s
	iters: 300, epoch: 19 | loss: 0.0271100
	speed: 0.0401s/iter; left time: 1530.6755s
	iters: 400, epoch: 19 | loss: 0.0106446
	speed: 0.0405s/iter; left time: 1543.2618s
Epoch: 19 cost time: 19.404387950897217
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0015326
	speed: 0.1756s/iter; left time: 6655.0981s
	iters: 200, epoch: 20 | loss: 0.0551076
	speed: 0.0351s/iter; left time: 1325.8199s
	iters: 300, epoch: 20 | loss: 0.0002492
	speed: 0.0373s/iter; left time: 1405.6428s
	iters: 400, epoch: 20 | loss: 0.0680192
	speed: 0.0377s/iter; left time: 1415.4195s
Epoch: 20 cost time: 17.553850889205933
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.982275).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0006761
	speed: 0.1772s/iter; left time: 6632.4991s
	iters: 200, epoch: 21 | loss: 0.0430221
	speed: 0.0369s/iter; left time: 1376.7944s
	iters: 300, epoch: 21 | loss: 0.0021814
	speed: 0.0369s/iter; left time: 1373.4503s
	iters: 400, epoch: 21 | loss: 0.0037033
	speed: 0.0360s/iter; left time: 1336.0503s
Epoch: 21 cost time: 17.72394871711731
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0017412
	speed: 0.1784s/iter; left time: 6593.4006s
	iters: 200, epoch: 22 | loss: 0.0001638
	speed: 0.0375s/iter; left time: 1382.6432s
	iters: 300, epoch: 22 | loss: 0.2972286
	speed: 0.0372s/iter; left time: 1368.1398s
	iters: 400, epoch: 22 | loss: 0.0027436
	speed: 0.0364s/iter; left time: 1333.8466s
Epoch: 22 cost time: 17.93130660057068
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0001207
	speed: 0.1753s/iter; left time: 6397.2134s
	iters: 200, epoch: 23 | loss: 0.0034246
	speed: 0.0363s/iter; left time: 1320.5367s
	iters: 300, epoch: 23 | loss: 0.0095881
	speed: 0.0381s/iter; left time: 1380.8037s
	iters: 400, epoch: 23 | loss: 0.0010491
	speed: 0.0380s/iter; left time: 1376.4850s
Epoch: 23 cost time: 17.88726043701172
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.2456507
	speed: 0.1780s/iter; left time: 6410.2283s
	iters: 200, epoch: 24 | loss: 0.0051403
	speed: 0.0359s/iter; left time: 1290.4171s
	iters: 300, epoch: 24 | loss: 0.0499237
	speed: 0.0406s/iter; left time: 1452.5509s
	iters: 400, epoch: 24 | loss: 0.0153877
	speed: 0.0365s/iter; left time: 1305.1069s
Epoch: 24 cost time: 17.800166845321655
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0005547
	speed: 0.1754s/iter; left time: 6235.6869s
	iters: 200, epoch: 25 | loss: 0.1408743
	speed: 0.0355s/iter; left time: 1257.9925s
	iters: 300, epoch: 25 | loss: 0.0656969
	speed: 0.0350s/iter; left time: 1236.9106s
	iters: 400, epoch: 25 | loss: 0.0171703
	speed: 0.0354s/iter; left time: 1246.7597s
Epoch: 25 cost time: 17.228869438171387
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0008020
	speed: 0.1753s/iter; left time: 6149.5182s
	iters: 200, epoch: 26 | loss: 0.0050236
	speed: 0.0387s/iter; left time: 1355.1902s
	iters: 300, epoch: 26 | loss: 0.0003922
	speed: 0.0399s/iter; left time: 1389.8393s
	iters: 400, epoch: 26 | loss: 0.0206677
	speed: 0.0405s/iter; left time: 1406.8225s
Epoch: 26 cost time: 18.6931893825531
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0022913
	speed: 0.1790s/iter; left time: 6194.0458s
	iters: 200, epoch: 27 | loss: 0.0028091
	speed: 0.0386s/iter; left time: 1333.2579s
	iters: 300, epoch: 27 | loss: 0.0001708
	speed: 0.0399s/iter; left time: 1371.1356s
	iters: 400, epoch: 27 | loss: 0.1206777
	speed: 0.0386s/iter; left time: 1325.4123s
Epoch: 27 cost time: 18.50003957748413
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0006184
	speed: 0.1787s/iter; left time: 6101.7704s
	iters: 200, epoch: 28 | loss: 0.0002717
	speed: 0.0356s/iter; left time: 1211.2463s
	iters: 300, epoch: 28 | loss: 0.0003941
	speed: 0.0357s/iter; left time: 1210.2358s
	iters: 400, epoch: 28 | loss: 0.0540182
	speed: 0.0351s/iter; left time: 1186.2322s
Epoch: 28 cost time: 17.20293116569519
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0007972
	speed: 0.1582s/iter; left time: 5327.8776s
	iters: 200, epoch: 29 | loss: 0.3452032
	speed: 0.0350s/iter; left time: 1175.8564s
	iters: 300, epoch: 29 | loss: 0.0099292
	speed: 0.0342s/iter; left time: 1143.2129s
	iters: 400, epoch: 29 | loss: 0.0002833
	speed: 0.0360s/iter; left time: 1200.5905s
Epoch: 29 cost time: 16.716890573501587
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0361342
	speed: 0.1703s/iter; left time: 5653.1305s
	iters: 200, epoch: 30 | loss: 0.0023225
	speed: 0.0399s/iter; left time: 1320.4774s
	iters: 300, epoch: 30 | loss: 0.0666339
	speed: 0.0381s/iter; left time: 1258.0183s
	iters: 400, epoch: 30 | loss: 0.0003000
	speed: 0.0373s/iter; left time: 1226.4095s
Epoch: 30 cost time: 18.33886170387268
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 285882
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 263, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6454066
	speed: 0.0582s/iter; left time: 2723.1519s
	iters: 200, epoch: 1 | loss: 0.3883894
	speed: 0.0366s/iter; left time: 1710.2799s
	iters: 300, epoch: 1 | loss: 0.3918705
	speed: 0.0370s/iter; left time: 1722.9512s
	iters: 400, epoch: 1 | loss: 0.3073972
	speed: 0.0374s/iter; left time: 1740.6341s
Epoch: 1 cost time: 19.645456314086914
Epoch: 1, Steps: 469 | Train Loss: 0.800 Vali Loss: 0.372 Vali Acc: 0.889 Test Loss: 0.372 Test Acc: 0.889
Validation loss decreased (inf --> -0.889362).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0644548
	speed: 0.1782s/iter; left time: 8255.7987s
	iters: 200, epoch: 2 | loss: 0.1471322
	speed: 0.0362s/iter; left time: 1675.9020s
	iters: 300, epoch: 2 | loss: 0.4932340
	speed: 0.0367s/iter; left time: 1692.2509s
	iters: 400, epoch: 2 | loss: 0.0452530
	speed: 0.0375s/iter; left time: 1728.2481s
Epoch: 2 cost time: 17.858708381652832
Epoch: 2, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.889362 --> -0.927099).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1152027
	speed: 0.1754s/iter; left time: 8046.3841s
	iters: 200, epoch: 3 | loss: 0.2193483
	speed: 0.0378s/iter; left time: 1728.7004s
	iters: 300, epoch: 3 | loss: 0.0769051
	speed: 0.0367s/iter; left time: 1676.5060s
	iters: 400, epoch: 3 | loss: 0.1319005
	speed: 0.0386s/iter; left time: 1759.8789s
Epoch: 3 cost time: 17.98286271095276
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.209 Vali Acc: 0.943 Test Loss: 0.209 Test Acc: 0.943
Validation loss decreased (-0.927099 --> -0.942822).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0631455
	speed: 0.1754s/iter; left time: 7960.2381s
	iters: 200, epoch: 4 | loss: 0.0471455
	speed: 0.0371s/iter; left time: 1682.2179s
	iters: 300, epoch: 4 | loss: 0.2634851
	speed: 0.0395s/iter; left time: 1785.2043s
	iters: 400, epoch: 4 | loss: 0.0169110
	speed: 0.0403s/iter; left time: 1815.9848s
Epoch: 4 cost time: 18.581189155578613
Epoch: 4, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.942822 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0092095
	speed: 0.1860s/iter; left time: 8354.0574s
	iters: 200, epoch: 5 | loss: 0.2619062
	speed: 0.0391s/iter; left time: 1752.1384s
	iters: 300, epoch: 5 | loss: 0.0599703
	speed: 0.0407s/iter; left time: 1820.9563s
	iters: 400, epoch: 5 | loss: 0.0687399
	speed: 0.0401s/iter; left time: 1789.2402s
Epoch: 5 cost time: 19.22618293762207
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0442834
	speed: 0.1795s/iter; left time: 7979.7648s
	iters: 200, epoch: 6 | loss: 0.0516218
	speed: 0.0374s/iter; left time: 1660.1468s
	iters: 300, epoch: 6 | loss: 0.0160844
	speed: 0.0389s/iter; left time: 1719.8026s
	iters: 400, epoch: 6 | loss: 0.0039656
	speed: 0.0375s/iter; left time: 1657.3097s
Epoch: 6 cost time: 18.232467651367188
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0058170
	speed: 0.1745s/iter; left time: 7675.0921s
	iters: 200, epoch: 7 | loss: 0.2026819
	speed: 0.0361s/iter; left time: 1582.4446s
	iters: 300, epoch: 7 | loss: 0.0068644
	speed: 0.0369s/iter; left time: 1614.9242s
	iters: 400, epoch: 7 | loss: 0.1636478
	speed: 0.0367s/iter; left time: 1602.3843s
Epoch: 7 cost time: 17.63451623916626
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
Validation loss decreased (-0.964264 --> -0.964550).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0018696
	speed: 0.1778s/iter; left time: 7737.5654s
	iters: 200, epoch: 8 | loss: 0.0313872
	speed: 0.0368s/iter; left time: 1599.4193s
	iters: 300, epoch: 8 | loss: 0.0383656
	speed: 0.0378s/iter; left time: 1637.0464s
	iters: 400, epoch: 8 | loss: 0.0709818
	speed: 0.0390s/iter; left time: 1685.2084s
Epoch: 8 cost time: 18.113285303115845
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.964550 --> -0.968838).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0212695
	speed: 0.1770s/iter; left time: 7618.3860s
	iters: 200, epoch: 9 | loss: 0.0153290
	speed: 0.0403s/iter; left time: 1729.1763s
	iters: 300, epoch: 9 | loss: 0.0738514
	speed: 0.0363s/iter; left time: 1554.9072s
	iters: 400, epoch: 9 | loss: 0.1075259
	speed: 0.0363s/iter; left time: 1551.6013s
Epoch: 9 cost time: 18.076993703842163
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2249260
	speed: 0.1769s/iter; left time: 7533.2109s
	iters: 200, epoch: 10 | loss: 0.0149129
	speed: 0.0359s/iter; left time: 1526.2371s
	iters: 300, epoch: 10 | loss: 0.6006225
	speed: 0.0381s/iter; left time: 1613.8036s
	iters: 400, epoch: 10 | loss: 0.0072008
	speed: 0.0379s/iter; left time: 1603.2097s
Epoch: 10 cost time: 17.794605016708374
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.968838 --> -0.977415).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0095827
	speed: 0.1704s/iter; left time: 7174.4393s
	iters: 200, epoch: 11 | loss: 0.0089479
	speed: 0.0375s/iter; left time: 1574.9646s
	iters: 300, epoch: 11 | loss: 0.0260018
	speed: 0.0382s/iter; left time: 1600.7116s
	iters: 400, epoch: 11 | loss: 0.0089340
	speed: 0.0379s/iter; left time: 1584.0251s
Epoch: 11 cost time: 17.920663356781006
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0108235
	speed: 0.1750s/iter; left time: 7286.8518s
	iters: 200, epoch: 12 | loss: 0.0149898
	speed: 0.0381s/iter; left time: 1583.5883s
	iters: 300, epoch: 12 | loss: 0.0246774
	speed: 0.0380s/iter; left time: 1575.2754s
	iters: 400, epoch: 12 | loss: 0.0293998
	speed: 0.0365s/iter; left time: 1508.4726s
Epoch: 12 cost time: 17.90270733833313
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0081710
	speed: 0.1801s/iter; left time: 7414.2113s
	iters: 200, epoch: 13 | loss: 0.0045877
	speed: 0.0369s/iter; left time: 1517.1789s
	iters: 300, epoch: 13 | loss: 0.0774627
	speed: 0.0375s/iter; left time: 1537.9019s
	iters: 400, epoch: 13 | loss: 0.0105014
	speed: 0.0384s/iter; left time: 1570.9858s
Epoch: 13 cost time: 18.198147773742676
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0587909
	speed: 0.1758s/iter; left time: 7154.4853s
	iters: 200, epoch: 14 | loss: 0.0018870
	speed: 0.0359s/iter; left time: 1455.6712s
	iters: 300, epoch: 14 | loss: 0.0294581
	speed: 0.0363s/iter; left time: 1469.6748s
	iters: 400, epoch: 14 | loss: 0.0289213
	speed: 0.0376s/iter; left time: 1518.0352s
Epoch: 14 cost time: 17.312045574188232
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0014664
	speed: 0.1701s/iter; left time: 6843.0889s
	iters: 200, epoch: 15 | loss: 0.0129075
	speed: 0.0377s/iter; left time: 1511.9637s
	iters: 300, epoch: 15 | loss: 0.0281364
	speed: 0.0390s/iter; left time: 1562.4923s
	iters: 400, epoch: 15 | loss: 0.0454627
	speed: 0.0357s/iter; left time: 1426.1672s
Epoch: 15 cost time: 17.799708604812622
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.977415 --> -0.979702).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0221492
	speed: 0.1742s/iter; left time: 6925.6231s
	iters: 200, epoch: 16 | loss: 0.0077131
	speed: 0.0385s/iter; left time: 1528.7805s
	iters: 300, epoch: 16 | loss: 0.0054535
	speed: 0.0409s/iter; left time: 1616.5255s
	iters: 400, epoch: 16 | loss: 0.2658725
	speed: 0.0390s/iter; left time: 1540.1999s
Epoch: 16 cost time: 18.46521234512329
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0251802
	speed: 0.1597s/iter; left time: 6277.3362s
	iters: 200, epoch: 17 | loss: 0.0018635
	speed: 0.0372s/iter; left time: 1456.8960s
	iters: 300, epoch: 17 | loss: 0.0132805
	speed: 0.0388s/iter; left time: 1516.3430s
	iters: 400, epoch: 17 | loss: 0.0295138
	speed: 0.0379s/iter; left time: 1479.5426s
Epoch: 17 cost time: 17.84730863571167
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0007202
	speed: 0.1803s/iter; left time: 7002.1361s
	iters: 200, epoch: 18 | loss: 0.0098802
	speed: 0.0388s/iter; left time: 1501.2811s
	iters: 300, epoch: 18 | loss: 0.0266359
	speed: 0.0357s/iter; left time: 1378.5580s
	iters: 400, epoch: 18 | loss: 0.0058965
	speed: 0.0357s/iter; left time: 1377.0947s
Epoch: 18 cost time: 17.86978244781494
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0014205
	speed: 0.1720s/iter; left time: 6599.2210s
	iters: 200, epoch: 19 | loss: 0.0235238
	speed: 0.0380s/iter; left time: 1455.0240s
	iters: 300, epoch: 19 | loss: 0.0217348
	speed: 0.0372s/iter; left time: 1420.3097s
	iters: 400, epoch: 19 | loss: 0.0065634
	speed: 0.0378s/iter; left time: 1438.4930s
Epoch: 19 cost time: 17.806535959243774
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0009560
	speed: 0.1683s/iter; left time: 6378.4353s
	iters: 200, epoch: 20 | loss: 0.0037810
	speed: 0.0367s/iter; left time: 1386.1282s
	iters: 300, epoch: 20 | loss: 0.0063315
	speed: 0.0349s/iter; left time: 1315.0685s
	iters: 400, epoch: 20 | loss: 0.0325182
	speed: 0.0378s/iter; left time: 1419.4066s
Epoch: 20 cost time: 17.495274305343628
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1832462
	speed: 0.1770s/iter; left time: 6624.2638s
	iters: 200, epoch: 21 | loss: 0.0932169
	speed: 0.0381s/iter; left time: 1421.8762s
	iters: 300, epoch: 21 | loss: 0.0031038
	speed: 0.0372s/iter; left time: 1386.4804s
	iters: 400, epoch: 21 | loss: 0.0018149
	speed: 0.0376s/iter; left time: 1394.9401s
Epoch: 21 cost time: 18.17725658416748
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0007544
	speed: 0.1836s/iter; left time: 6783.5174s
	iters: 200, epoch: 22 | loss: 0.0082482
	speed: 0.0396s/iter; left time: 1458.0351s
	iters: 300, epoch: 22 | loss: 0.0081815
	speed: 0.0398s/iter; left time: 1461.8204s
	iters: 400, epoch: 22 | loss: 0.0035867
	speed: 0.0404s/iter; left time: 1480.8828s
Epoch: 22 cost time: 19.199425220489502
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0109162
	speed: 0.1733s/iter; left time: 6323.2469s
	iters: 200, epoch: 23 | loss: 0.0035682
	speed: 0.0389s/iter; left time: 1416.6466s
	iters: 300, epoch: 23 | loss: 0.0083924
	speed: 0.0352s/iter; left time: 1278.6683s
	iters: 400, epoch: 23 | loss: 0.0009626
	speed: 0.0349s/iter; left time: 1261.7956s
Epoch: 23 cost time: 17.444212675094604
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0008478
	speed: 0.1639s/iter; left time: 5903.4744s
	iters: 200, epoch: 24 | loss: 0.0739627
	speed: 0.0352s/iter; left time: 1265.0876s
	iters: 300, epoch: 24 | loss: 0.0060640
	speed: 0.0367s/iter; left time: 1314.1978s
	iters: 400, epoch: 24 | loss: 0.2245136
	speed: 0.0366s/iter; left time: 1306.2694s
Epoch: 24 cost time: 17.2620689868927
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0778901
	speed: 0.1748s/iter; left time: 6211.5450s
	iters: 200, epoch: 25 | loss: 0.0039305
	speed: 0.0366s/iter; left time: 1298.3873s
	iters: 300, epoch: 25 | loss: 0.0094978
	speed: 0.0361s/iter; left time: 1277.3826s
	iters: 400, epoch: 25 | loss: 0.0009570
	speed: 0.0360s/iter; left time: 1269.2083s
Epoch: 25 cost time: 17.25035285949707
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0497695
	speed: 0.1680s/iter; left time: 5893.6401s
	iters: 200, epoch: 26 | loss: 0.0118137
	speed: 0.0421s/iter; left time: 1471.9739s
	iters: 300, epoch: 26 | loss: 0.0117592
	speed: 0.0400s/iter; left time: 1396.6815s
	iters: 400, epoch: 26 | loss: 0.0643013
	speed: 0.0378s/iter; left time: 1315.4399s
Epoch: 26 cost time: 19.223004817962646
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0308694
	speed: 0.1858s/iter; left time: 6430.3932s
	iters: 200, epoch: 27 | loss: 0.0045725
	speed: 0.0417s/iter; left time: 1438.0349s
	iters: 300, epoch: 27 | loss: 0.0022667
	speed: 0.0394s/iter; left time: 1356.1979s
	iters: 400, epoch: 27 | loss: 0.0173777
	speed: 0.0418s/iter; left time: 1434.1754s
Epoch: 27 cost time: 19.302316665649414
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
Validation loss decreased (-0.981131 --> -0.982275).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0124257
	speed: 0.1832s/iter; left time: 6254.6442s
	iters: 200, epoch: 28 | loss: 0.0041437
	speed: 0.0394s/iter; left time: 1341.2511s
	iters: 300, epoch: 28 | loss: 0.0002518
	speed: 0.0374s/iter; left time: 1267.7726s
	iters: 400, epoch: 28 | loss: 0.0018169
	speed: 0.0359s/iter; left time: 1215.1323s
Epoch: 28 cost time: 18.102903604507446
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0171549
	speed: 0.1820s/iter; left time: 6126.8612s
	iters: 200, epoch: 29 | loss: 0.0013724
	speed: 0.0369s/iter; left time: 1238.4639s
	iters: 300, epoch: 29 | loss: 0.0048377
	speed: 0.0373s/iter; left time: 1248.6734s
	iters: 400, epoch: 29 | loss: 0.0010557
	speed: 0.0366s/iter; left time: 1222.7406s
Epoch: 29 cost time: 17.87967610359192
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0027717
	speed: 0.1783s/iter; left time: 5919.8127s
	iters: 200, epoch: 30 | loss: 0.0013946
	speed: 0.0351s/iter; left time: 1162.4522s
	iters: 300, epoch: 30 | loss: 0.0017366
	speed: 0.0373s/iter; left time: 1229.7831s
	iters: 400, epoch: 30 | loss: 0.0135414
	speed: 0.0393s/iter; left time: 1291.6711s
Epoch: 30 cost time: 18.09615421295166
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0003149
	speed: 0.1773s/iter; left time: 5804.2104s
	iters: 200, epoch: 31 | loss: 0.0805857
	speed: 0.0385s/iter; left time: 1255.4548s
	iters: 300, epoch: 31 | loss: 0.0140562
	speed: 0.0431s/iter; left time: 1401.3482s
	iters: 400, epoch: 31 | loss: 0.0019607
	speed: 0.0408s/iter; left time: 1324.1628s
Epoch: 31 cost time: 18.945210695266724
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0036994
	speed: 0.1893s/iter; left time: 6107.6048s
	iters: 200, epoch: 32 | loss: 0.0237747
	speed: 0.0393s/iter; left time: 1264.0517s
	iters: 300, epoch: 32 | loss: 0.0019837
	speed: 0.0392s/iter; left time: 1256.8531s
	iters: 400, epoch: 32 | loss: 0.0000861
	speed: 0.0405s/iter; left time: 1293.3365s
Epoch: 32 cost time: 19.11954164505005
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0070665
	speed: 0.1857s/iter; left time: 5903.1075s
	iters: 200, epoch: 33 | loss: 0.2489931
	speed: 0.0377s/iter; left time: 1193.6077s
	iters: 300, epoch: 33 | loss: 0.0003582
	speed: 0.0378s/iter; left time: 1193.7603s
	iters: 400, epoch: 33 | loss: 0.0011705
	speed: 0.0365s/iter; left time: 1149.4545s
Epoch: 33 cost time: 17.8190655708313
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.1157162
	speed: 0.1663s/iter; left time: 5207.9059s
	iters: 200, epoch: 34 | loss: 0.0263305
	speed: 0.0355s/iter; left time: 1107.1435s
	iters: 300, epoch: 34 | loss: 0.0147065
	speed: 0.0350s/iter; left time: 1088.5974s
	iters: 400, epoch: 34 | loss: 0.0018816
	speed: 0.0381s/iter; left time: 1183.4214s
Epoch: 34 cost time: 17.38781189918518
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.1948671
	speed: 0.1788s/iter; left time: 5516.1335s
	iters: 200, epoch: 35 | loss: 0.0041653
	speed: 0.0378s/iter; left time: 1162.1741s
	iters: 300, epoch: 35 | loss: 0.0090543
	speed: 0.0368s/iter; left time: 1128.2845s
	iters: 400, epoch: 35 | loss: 0.0006858
	speed: 0.0375s/iter; left time: 1145.1962s
Epoch: 35 cost time: 18.06147789955139
Epoch: 35, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0088492
	speed: 0.1820s/iter; left time: 5530.7436s
	iters: 200, epoch: 36 | loss: 0.0003065
	speed: 0.0374s/iter; left time: 1134.1602s
	iters: 300, epoch: 36 | loss: 0.0004551
	speed: 0.0386s/iter; left time: 1165.0917s
	iters: 400, epoch: 36 | loss: 0.0043645
	speed: 0.0386s/iter; left time: 1159.8433s
Epoch: 36 cost time: 18.09969925880432
Epoch: 36, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0037345
	speed: 0.1762s/iter; left time: 5272.1496s
	iters: 200, epoch: 37 | loss: 0.0003846
	speed: 0.0382s/iter; left time: 1139.9001s
	iters: 300, epoch: 37 | loss: 0.0019974
	speed: 0.0373s/iter; left time: 1107.0388s
	iters: 400, epoch: 37 | loss: 0.0025755
	speed: 0.0374s/iter; left time: 1108.6298s
Epoch: 37 cost time: 18.067289352416992
Epoch: 37, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 154810
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6566185
	speed: 0.0573s/iter; left time: 2681.0001s
	iters: 200, epoch: 1 | loss: 0.3923386
	speed: 0.0368s/iter; left time: 1716.4149s
	iters: 300, epoch: 1 | loss: 0.3640952
	speed: 0.0345s/iter; left time: 1608.2372s
	iters: 400, epoch: 1 | loss: 0.2716568
	speed: 0.0373s/iter; left time: 1735.1421s
Epoch: 1 cost time: 19.351160764694214
Epoch: 1, Steps: 469 | Train Loss: 0.780 Vali Loss: 0.348 Vali Acc: 0.899 Test Loss: 0.348 Test Acc: 0.899
Validation loss decreased (inf --> -0.899368).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0760249
	speed: 0.1852s/iter; left time: 8582.5912s
	iters: 200, epoch: 2 | loss: 0.1813734
	speed: 0.0379s/iter; left time: 1750.8227s
	iters: 300, epoch: 2 | loss: 0.4649283
	speed: 0.0374s/iter; left time: 1726.5848s
	iters: 400, epoch: 2 | loss: 0.0644675
	speed: 0.0384s/iter; left time: 1766.4720s
Epoch: 2 cost time: 18.229827404022217
Epoch: 2, Steps: 469 | Train Loss: 0.188 Vali Loss: 0.252 Vali Acc: 0.929 Test Loss: 0.252 Test Acc: 0.929
Validation loss decreased (-0.899368 --> -0.928814).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0931792
	speed: 0.1843s/iter; left time: 8452.7493s
	iters: 200, epoch: 3 | loss: 0.1948789
	speed: 0.0394s/iter; left time: 1801.0718s
	iters: 300, epoch: 3 | loss: 0.0883366
	speed: 0.0361s/iter; left time: 1648.8310s
	iters: 400, epoch: 3 | loss: 0.1327342
	speed: 0.0378s/iter; left time: 1721.1938s
Epoch: 3 cost time: 18.221760272979736
Epoch: 3, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.928814 --> -0.950827).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0547707
	speed: 0.1749s/iter; left time: 7939.8688s
	iters: 200, epoch: 4 | loss: 0.0598578
	speed: 0.0368s/iter; left time: 1665.4247s
	iters: 300, epoch: 4 | loss: 0.1403496
	speed: 0.0358s/iter; left time: 1616.9527s
	iters: 400, epoch: 4 | loss: 0.0066815
	speed: 0.0358s/iter; left time: 1615.1981s
Epoch: 4 cost time: 17.674077033996582
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.950827 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0296526
	speed: 0.1817s/iter; left time: 8163.8785s
	iters: 200, epoch: 5 | loss: 0.2581299
	speed: 0.0379s/iter; left time: 1697.7363s
	iters: 300, epoch: 5 | loss: 0.0514476
	speed: 0.0428s/iter; left time: 1913.5844s
	iters: 400, epoch: 5 | loss: 0.1299488
	speed: 0.0395s/iter; left time: 1761.2414s
Epoch: 5 cost time: 19.22861933708191
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0263249
	speed: 0.1877s/iter; left time: 8345.6503s
	iters: 200, epoch: 6 | loss: 0.0190943
	speed: 0.0385s/iter; left time: 1706.7456s
	iters: 300, epoch: 6 | loss: 0.0275625
	speed: 0.0373s/iter; left time: 1649.5750s
	iters: 400, epoch: 6 | loss: 0.0030931
	speed: 0.0364s/iter; left time: 1609.4321s
Epoch: 6 cost time: 18.351699113845825
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0135999
	speed: 0.1778s/iter; left time: 7818.8990s
	iters: 200, epoch: 7 | loss: 0.0468835
	speed: 0.0367s/iter; left time: 1611.6802s
	iters: 300, epoch: 7 | loss: 0.0205027
	speed: 0.0395s/iter; left time: 1728.8215s
	iters: 400, epoch: 7 | loss: 0.1508941
	speed: 0.0396s/iter; left time: 1731.6712s
Epoch: 7 cost time: 18.271632432937622
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0032951
	speed: 0.1942s/iter; left time: 8452.4468s
	iters: 200, epoch: 8 | loss: 0.0134881
	speed: 0.0586s/iter; left time: 2544.1967s
	iters: 300, epoch: 8 | loss: 0.0452306
	speed: 0.0600s/iter; left time: 2597.0539s
	iters: 400, epoch: 8 | loss: 0.3128621
	speed: 0.0591s/iter; left time: 2552.5366s
Epoch: 8 cost time: 26.29971146583557
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0019261
	speed: 0.2834s/iter; left time: 12200.6439s
	iters: 200, epoch: 9 | loss: 0.0051917
	speed: 0.0494s/iter; left time: 2120.8177s
	iters: 300, epoch: 9 | loss: 0.0852806
	speed: 0.0586s/iter; left time: 2511.7006s
	iters: 400, epoch: 9 | loss: 0.0407476
	speed: 0.0633s/iter; left time: 2705.2934s
Epoch: 9 cost time: 26.33915114402771
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.964550 --> -0.970267).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0226694
	speed: 0.2866s/iter; left time: 12201.7433s
	iters: 200, epoch: 10 | loss: 0.0143778
	speed: 0.0520s/iter; left time: 2207.4638s
	iters: 300, epoch: 10 | loss: 0.4660241
	speed: 0.0634s/iter; left time: 2688.0562s
	iters: 400, epoch: 10 | loss: 0.0036983
	speed: 0.0662s/iter; left time: 2799.7803s
Epoch: 10 cost time: 27.888959646224976
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.970267 --> -0.974842).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0052283
	speed: 0.2776s/iter; left time: 11690.4344s
	iters: 200, epoch: 11 | loss: 0.0302012
	speed: 0.0492s/iter; left time: 2066.9065s
	iters: 300, epoch: 11 | loss: 0.0179973
	speed: 0.0644s/iter; left time: 2697.2558s
	iters: 400, epoch: 11 | loss: 0.0067371
	speed: 0.0553s/iter; left time: 2313.8769s
Epoch: 11 cost time: 25.367438793182373
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0455625
	speed: 0.2328s/iter; left time: 9694.5514s
	iters: 200, epoch: 12 | loss: 0.0048625
	speed: 0.0381s/iter; left time: 1583.9461s
	iters: 300, epoch: 12 | loss: 0.0113868
	speed: 0.0378s/iter; left time: 1567.3149s
	iters: 400, epoch: 12 | loss: 0.0096427
	speed: 0.0383s/iter; left time: 1582.6015s
Epoch: 12 cost time: 18.45317769050598
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0123142
	speed: 0.1791s/iter; left time: 7375.7411s
	iters: 200, epoch: 13 | loss: 0.0032440
	speed: 0.0373s/iter; left time: 1530.2890s
	iters: 300, epoch: 13 | loss: 0.0932443
	speed: 0.0377s/iter; left time: 1545.2208s
	iters: 400, epoch: 13 | loss: 0.0090822
	speed: 0.0390s/iter; left time: 1594.3034s
Epoch: 13 cost time: 18.293538808822632
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975128).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0310806
	speed: 0.1791s/iter; left time: 7290.8065s
	iters: 200, epoch: 14 | loss: 0.0017498
	speed: 0.0389s/iter; left time: 1579.4982s
	iters: 300, epoch: 14 | loss: 0.0302811
	speed: 0.0373s/iter; left time: 1512.2396s
	iters: 400, epoch: 14 | loss: 0.0119593
	speed: 0.0378s/iter; left time: 1527.1979s
Epoch: 14 cost time: 18.20288848876953
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976557).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0003403
	speed: 0.1920s/iter; left time: 7723.6039s
	iters: 200, epoch: 15 | loss: 0.0032940
	speed: 0.0365s/iter; left time: 1465.4237s
	iters: 300, epoch: 15 | loss: 0.0092544
	speed: 0.0366s/iter; left time: 1466.1743s
	iters: 400, epoch: 15 | loss: 0.0546244
	speed: 0.0374s/iter; left time: 1493.8695s
Epoch: 15 cost time: 17.958232164382935
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0339479
	speed: 0.1845s/iter; left time: 7335.8553s
	iters: 200, epoch: 16 | loss: 0.0255517
	speed: 0.0429s/iter; left time: 1700.7101s
	iters: 300, epoch: 16 | loss: 0.0006995
	speed: 0.0511s/iter; left time: 2020.9855s
	iters: 400, epoch: 16 | loss: 0.2150873
	speed: 0.0493s/iter; left time: 1944.9460s
Epoch: 16 cost time: 21.939565181732178
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.978272).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0004044
	speed: 0.2459s/iter; left time: 9663.7721s
	iters: 200, epoch: 17 | loss: 0.0008715
	speed: 0.0492s/iter; left time: 1927.9566s
	iters: 300, epoch: 17 | loss: 0.0012772
	speed: 0.0518s/iter; left time: 2026.9194s
	iters: 400, epoch: 17 | loss: 0.0167192
	speed: 0.0520s/iter; left time: 2029.6198s
Epoch: 17 cost time: 24.198617696762085
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0476828
	speed: 0.2496s/iter; left time: 9691.4359s
	iters: 200, epoch: 18 | loss: 0.0085344
	speed: 0.0444s/iter; left time: 1717.5942s
	iters: 300, epoch: 18 | loss: 0.0036542
	speed: 0.0494s/iter; left time: 1909.0957s
	iters: 400, epoch: 18 | loss: 0.0105461
	speed: 0.0522s/iter; left time: 2009.4416s
Epoch: 18 cost time: 23.152837991714478
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0007350
	speed: 0.2345s/iter; left time: 8996.4636s
	iters: 200, epoch: 19 | loss: 0.0017590
	speed: 0.0436s/iter; left time: 1668.8556s
	iters: 300, epoch: 19 | loss: 0.0089191
	speed: 0.0441s/iter; left time: 1683.8213s
	iters: 400, epoch: 19 | loss: 0.0031827
	speed: 0.0451s/iter; left time: 1717.5431s
Epoch: 19 cost time: 20.984168529510498
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0001917
	speed: 0.2208s/iter; left time: 8366.0109s
	iters: 200, epoch: 20 | loss: 0.0044104
	speed: 0.0448s/iter; left time: 1694.6456s
	iters: 300, epoch: 20 | loss: 0.0921815
	speed: 0.0458s/iter; left time: 1725.4389s
	iters: 400, epoch: 20 | loss: 0.0352998
	speed: 0.0471s/iter; left time: 1770.4671s
Epoch: 20 cost time: 22.020604372024536
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.1656383
	speed: 0.2488s/iter; left time: 9308.7348s
	iters: 200, epoch: 21 | loss: 0.0406600
	speed: 0.0437s/iter; left time: 1631.7539s
	iters: 300, epoch: 21 | loss: 0.0273552
	speed: 0.0497s/iter; left time: 1851.4066s
	iters: 400, epoch: 21 | loss: 0.0065613
	speed: 0.0551s/iter; left time: 2044.1729s
Epoch: 21 cost time: 23.326194524765015
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0014549
	speed: 0.2757s/iter; left time: 10188.9862s
	iters: 200, epoch: 22 | loss: 0.0016623
	speed: 0.0655s/iter; left time: 2412.7603s
	iters: 300, epoch: 22 | loss: 0.0019938
	speed: 0.0620s/iter; left time: 2278.3953s
	iters: 400, epoch: 22 | loss: 0.0021558
	speed: 0.0650s/iter; left time: 2383.7657s
Epoch: 22 cost time: 30.751123189926147
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.979416).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0026129
	speed: 0.2957s/iter; left time: 10788.0256s
	iters: 200, epoch: 23 | loss: 0.0005773
	speed: 0.0552s/iter; left time: 2009.5732s
	iters: 300, epoch: 23 | loss: 0.0669079
	speed: 0.0570s/iter; left time: 2068.2999s
	iters: 400, epoch: 23 | loss: 0.0009031
	speed: 0.0606s/iter; left time: 2190.9848s
Epoch: 23 cost time: 28.125404119491577
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0012800
	speed: 0.2771s/iter; left time: 9980.6379s
	iters: 200, epoch: 24 | loss: 0.0155095
	speed: 0.0547s/iter; left time: 1965.1556s
	iters: 300, epoch: 24 | loss: 0.0009291
	speed: 0.0572s/iter; left time: 2047.3861s
	iters: 400, epoch: 24 | loss: 0.1201564
	speed: 0.0637s/iter; left time: 2275.9352s
Epoch: 24 cost time: 28.5058753490448
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.980273).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.2320414
	speed: 0.2831s/iter; left time: 10061.7085s
	iters: 200, epoch: 25 | loss: 0.0122323
	speed: 0.0604s/iter; left time: 2140.7336s
	iters: 300, epoch: 25 | loss: 0.0053108
	speed: 0.0574s/iter; left time: 2027.8340s
	iters: 400, epoch: 25 | loss: 0.0005124
	speed: 0.0538s/iter; left time: 1897.2861s
Epoch: 25 cost time: 27.38071584701538
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0021745
	speed: 0.2904s/iter; left time: 10187.8001s
	iters: 200, epoch: 26 | loss: 0.0132593
	speed: 0.0623s/iter; left time: 2177.5387s
	iters: 300, epoch: 26 | loss: 0.0071438
	speed: 0.0589s/iter; left time: 2053.2773s
	iters: 400, epoch: 26 | loss: 0.0006098
	speed: 0.0569s/iter; left time: 1979.1919s
Epoch: 26 cost time: 28.832491636276245
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.3685983
	speed: 0.2684s/iter; left time: 9287.6051s
	iters: 200, epoch: 27 | loss: 0.0048223
	speed: 0.0592s/iter; left time: 2042.3540s
	iters: 300, epoch: 27 | loss: 0.0086024
	speed: 0.0614s/iter; left time: 2112.0708s
	iters: 400, epoch: 27 | loss: 0.0091289
	speed: 0.0553s/iter; left time: 1896.0006s
Epoch: 27 cost time: 27.843341827392578
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0056475
	speed: 0.2956s/iter; left time: 10089.9930s
	iters: 200, epoch: 28 | loss: 0.0018685
	speed: 0.0634s/iter; left time: 2158.0195s
	iters: 300, epoch: 28 | loss: 0.0037666
	speed: 0.0697s/iter; left time: 2364.4215s
	iters: 400, epoch: 28 | loss: 0.0007789
	speed: 0.0671s/iter; left time: 2272.0667s
Epoch: 28 cost time: 31.162174701690674
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0014471
	speed: 0.2707s/iter; left time: 9114.6942s
	iters: 200, epoch: 29 | loss: 0.0003532
	speed: 0.0653s/iter; left time: 2192.8217s
	iters: 300, epoch: 29 | loss: 0.0043047
	speed: 0.0636s/iter; left time: 2129.9737s
	iters: 400, epoch: 29 | loss: 0.0014139
	speed: 0.0603s/iter; left time: 2011.5514s
Epoch: 29 cost time: 30.148470163345337
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.981131).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0120425
	speed: 0.2502s/iter; left time: 8305.0641s
	iters: 200, epoch: 30 | loss: 0.0036510
	speed: 0.0482s/iter; left time: 1595.8433s
	iters: 300, epoch: 30 | loss: 0.0205594
	speed: 0.0477s/iter; left time: 1575.3352s
	iters: 400, epoch: 30 | loss: 0.0462830
	speed: 0.0503s/iter; left time: 1654.6526s
Epoch: 30 cost time: 24.524443864822388
Epoch: 30, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0062450
	speed: 0.2659s/iter; left time: 8703.6347s
	iters: 200, epoch: 31 | loss: 0.2507136
	speed: 0.0521s/iter; left time: 1698.4781s
	iters: 300, epoch: 31 | loss: 0.0010978
	speed: 0.0507s/iter; left time: 1650.5508s
	iters: 400, epoch: 31 | loss: 0.0003784
	speed: 0.0617s/iter; left time: 2001.6114s
Epoch: 31 cost time: 26.462092638015747
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0057121
	speed: 0.3105s/iter; left time: 10018.1806s
	iters: 200, epoch: 32 | loss: 0.0164093
	speed: 0.0484s/iter; left time: 1556.5834s
	iters: 300, epoch: 32 | loss: 0.0014599
	speed: 0.0474s/iter; left time: 1518.4749s
	iters: 400, epoch: 32 | loss: 0.0002072
	speed: 0.0552s/iter; left time: 1765.7418s
Epoch: 32 cost time: 24.233867168426514
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0012473
	speed: 0.3066s/iter; left time: 9749.2079s
	iters: 200, epoch: 33 | loss: 0.0024539
	speed: 0.0510s/iter; left time: 1614.9672s
	iters: 300, epoch: 33 | loss: 0.0036159
	speed: 0.0472s/iter; left time: 1491.0870s
	iters: 400, epoch: 33 | loss: 0.0040774
	speed: 0.0537s/iter; left time: 1690.1073s
Epoch: 33 cost time: 25.036218643188477
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.2677024
	speed: 0.2947s/iter; left time: 9232.5009s
	iters: 200, epoch: 34 | loss: 0.0037505
	speed: 0.0482s/iter; left time: 1504.7783s
	iters: 300, epoch: 34 | loss: 0.0040890
	speed: 0.0533s/iter; left time: 1659.7626s
	iters: 400, epoch: 34 | loss: 0.0024098
	speed: 0.0597s/iter; left time: 1851.8014s
Epoch: 34 cost time: 25.35990571975708
Epoch: 34, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0117994
	speed: 0.3096s/iter; left time: 9552.2588s
	iters: 200, epoch: 35 | loss: 0.0001987
	speed: 0.0529s/iter; left time: 1626.7832s
	iters: 300, epoch: 35 | loss: 0.0173710
	speed: 0.0600s/iter; left time: 1838.1702s
	iters: 400, epoch: 35 | loss: 0.0012915
	speed: 0.0547s/iter; left time: 1670.7599s
Epoch: 35 cost time: 25.877482891082764
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.983990).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0065653
	speed: 0.2815s/iter; left time: 8552.7914s
	iters: 200, epoch: 36 | loss: 0.0001598
	speed: 0.0471s/iter; left time: 1427.1035s
	iters: 300, epoch: 36 | loss: 0.0027653
	speed: 0.0538s/iter; left time: 1625.1204s
	iters: 400, epoch: 36 | loss: 0.0006870
	speed: 0.0550s/iter; left time: 1655.9666s
Epoch: 36 cost time: 24.59521198272705
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0015093
	speed: 0.2875s/iter; left time: 8601.6496s
	iters: 200, epoch: 37 | loss: 0.0003389
	speed: 0.0488s/iter; left time: 1454.5402s
	iters: 300, epoch: 37 | loss: 0.0005754
	speed: 0.0481s/iter; left time: 1429.0155s
	iters: 400, epoch: 37 | loss: 0.0015515
	speed: 0.0509s/iter; left time: 1507.0427s
Epoch: 37 cost time: 23.967886447906494
Epoch: 37, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0063655
	speed: 0.2710s/iter; left time: 7979.9641s
	iters: 200, epoch: 38 | loss: 0.0066014
	speed: 0.0505s/iter; left time: 1481.9506s
	iters: 300, epoch: 38 | loss: 0.0189099
	speed: 0.0455s/iter; left time: 1330.2051s
	iters: 400, epoch: 38 | loss: 0.0029956
	speed: 0.0440s/iter; left time: 1283.1412s
Epoch: 38 cost time: 23.787392377853394
Epoch: 38, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0000747
	speed: 0.3165s/iter; left time: 9173.1361s
	iters: 200, epoch: 39 | loss: 0.0053284
	speed: 0.0493s/iter; left time: 1423.9127s
	iters: 300, epoch: 39 | loss: 0.0054900
	speed: 0.0512s/iter; left time: 1472.1950s
	iters: 400, epoch: 39 | loss: 0.0056331
	speed: 0.0611s/iter; left time: 1753.6708s
Epoch: 39 cost time: 26.30479073524475
Epoch: 39, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.1346807
	speed: 0.3150s/iter; left time: 8982.0278s
	iters: 200, epoch: 40 | loss: 0.0483316
	speed: 0.0514s/iter; left time: 1460.7464s
	iters: 300, epoch: 40 | loss: 0.0011284
	speed: 0.0518s/iter; left time: 1466.6788s
	iters: 400, epoch: 40 | loss: 0.0009879
	speed: 0.0521s/iter; left time: 1469.3860s
Epoch: 40 cost time: 25.819008827209473
Epoch: 40, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0171771
	speed: 0.2828s/iter; left time: 7931.2483s
	iters: 200, epoch: 41 | loss: 0.0064148
	speed: 0.0588s/iter; left time: 1643.9780s
	iters: 300, epoch: 41 | loss: 0.0014427
	speed: 0.0485s/iter; left time: 1349.3967s
	iters: 400, epoch: 41 | loss: 0.0006611
	speed: 0.0457s/iter; left time: 1268.3050s
Epoch: 41 cost time: 25.021321773529053
Epoch: 41, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.1819078
	speed: 0.2725s/iter; left time: 7513.1331s
	iters: 200, epoch: 42 | loss: 0.0005068
	speed: 0.0541s/iter; left time: 1485.2527s
	iters: 300, epoch: 42 | loss: 0.0002090
	speed: 0.0494s/iter; left time: 1353.3097s
	iters: 400, epoch: 42 | loss: 0.0183433
	speed: 0.0476s/iter; left time: 1298.3804s
Epoch: 42 cost time: 25.604082822799683
Epoch: 42, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0010260
	speed: 0.3068s/iter; left time: 8314.8787s
	iters: 200, epoch: 43 | loss: 0.0002278
	speed: 0.0519s/iter; left time: 1401.3801s
	iters: 300, epoch: 43 | loss: 0.0215924
	speed: 0.0505s/iter; left time: 1359.2598s
	iters: 400, epoch: 43 | loss: 0.0552923
	speed: 0.0529s/iter; left time: 1417.0117s
Epoch: 43 cost time: 26.124430894851685
Epoch: 43, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0261090
	speed: 0.3005s/iter; left time: 8004.5907s
	iters: 200, epoch: 44 | loss: 0.0302272
	speed: 0.0618s/iter; left time: 1641.0955s
	iters: 300, epoch: 44 | loss: 0.0032184
	speed: 0.0573s/iter; left time: 1515.3785s
	iters: 400, epoch: 44 | loss: 0.0039773
	speed: 0.0577s/iter; left time: 1520.0508s
Epoch: 44 cost time: 27.526132106781006
Epoch: 44, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0004283
	speed: 0.2588s/iter; left time: 6771.7606s
	iters: 200, epoch: 45 | loss: 0.0799809
	speed: 0.0579s/iter; left time: 1510.0710s
	iters: 300, epoch: 45 | loss: 0.0011492
	speed: 0.0592s/iter; left time: 1537.8952s
	iters: 400, epoch: 45 | loss: 0.0002785
	speed: 0.0584s/iter; left time: 1511.0955s
Epoch: 45 cost time: 27.540836334228516
Epoch: 45, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.984 Test Loss: 0.105 Test Acc: 0.984
Validation loss decreased (-0.983990 --> -0.984276).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0486364
	speed: 0.2862s/iter; left time: 7354.2069s
	iters: 200, epoch: 46 | loss: 0.0009635
	speed: 0.0492s/iter; left time: 1258.2434s
	iters: 300, epoch: 46 | loss: 0.0567821
	speed: 0.0615s/iter; left time: 1567.2346s
	iters: 400, epoch: 46 | loss: 0.0015910
	speed: 0.0624s/iter; left time: 1585.2526s
Epoch: 46 cost time: 26.44033980369568
Epoch: 46, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 47 | loss: 0.0000683
	speed: 0.2787s/iter; left time: 7030.0548s
	iters: 200, epoch: 47 | loss: 0.0003965
	speed: 0.0541s/iter; left time: 1359.1026s
	iters: 300, epoch: 47 | loss: 0.0042172
	speed: 0.0546s/iter; left time: 1365.2750s
	iters: 400, epoch: 47 | loss: 0.0003021
	speed: 0.0570s/iter; left time: 1421.3159s
Epoch: 47 cost time: 25.885929584503174
Epoch: 47, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 48 | loss: 0.0670799
	speed: 0.2684s/iter; left time: 6645.8000s
	iters: 200, epoch: 48 | loss: 0.0247056
	speed: 0.0409s/iter; left time: 1007.7773s
	iters: 300, epoch: 48 | loss: 0.0011991
	speed: 0.0484s/iter; left time: 1188.1673s
	iters: 400, epoch: 48 | loss: 0.0052990
	speed: 0.0517s/iter; left time: 1263.8824s
Epoch: 48 cost time: 22.562095880508423
Epoch: 48, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 49 | loss: 0.0174027
	speed: 0.2836s/iter; left time: 6888.8730s
	iters: 200, epoch: 49 | loss: 0.0001894
	speed: 0.0424s/iter; left time: 1026.6350s
	iters: 300, epoch: 49 | loss: 0.0008831
	speed: 0.0421s/iter; left time: 1014.7396s
	iters: 400, epoch: 49 | loss: 0.0024234
	speed: 0.0523s/iter; left time: 1254.0797s
Epoch: 49 cost time: 23.304206132888794
Epoch: 49, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 50 | loss: 0.0017866
	speed: 0.2905s/iter; left time: 6920.2673s
	iters: 200, epoch: 50 | loss: 0.0002311
	speed: 0.0443s/iter; left time: 1051.2588s
	iters: 300, epoch: 50 | loss: 0.0869827
	speed: 0.0449s/iter; left time: 1060.7098s
	iters: 400, epoch: 50 | loss: 0.0021385
	speed: 0.0549s/iter; left time: 1292.3878s
Epoch: 50 cost time: 23.995508432388306
Epoch: 50, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 51 | loss: 0.2238353
	speed: 0.2936s/iter; left time: 6856.6265s
	iters: 200, epoch: 51 | loss: 0.0000158
	speed: 0.0471s/iter; left time: 1094.4469s
	iters: 300, epoch: 51 | loss: 0.1492926
	speed: 0.0514s/iter; left time: 1190.4800s
	iters: 400, epoch: 51 | loss: 0.0026405
	speed: 0.0549s/iter; left time: 1266.4753s
Epoch: 51 cost time: 24.517712593078613
Epoch: 51, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 52 | loss: 0.0007299
	speed: 0.2750s/iter; left time: 6291.4289s
	iters: 200, epoch: 52 | loss: 0.0153251
	speed: 0.0464s/iter; left time: 1057.7710s
	iters: 300, epoch: 52 | loss: 0.0007909
	speed: 0.0544s/iter; left time: 1233.6381s
	iters: 400, epoch: 52 | loss: 0.0053867
	speed: 0.0556s/iter; left time: 1256.4866s
Epoch: 52 cost time: 24.3315908908844
Epoch: 52, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 53 | loss: 0.1726671
	speed: 0.2638s/iter; left time: 5912.2175s
	iters: 200, epoch: 53 | loss: 0.0440495
	speed: 0.0477s/iter; left time: 1064.4838s
	iters: 300, epoch: 53 | loss: 0.0031939
	speed: 0.0503s/iter; left time: 1117.4882s
	iters: 400, epoch: 53 | loss: 0.0088968
	speed: 0.0495s/iter; left time: 1095.3384s
Epoch: 53 cost time: 23.205321311950684
Epoch: 53, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 54 | loss: 0.0351786
	speed: 0.2369s/iter; left time: 5198.4191s
	iters: 200, epoch: 54 | loss: 0.0002643
	speed: 0.0498s/iter; left time: 1088.1871s
	iters: 300, epoch: 54 | loss: 0.5009744
	speed: 0.0489s/iter; left time: 1064.0867s
	iters: 400, epoch: 54 | loss: 0.0007289
	speed: 0.0500s/iter; left time: 1081.9995s
Epoch: 54 cost time: 23.907236576080322
Epoch: 54, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 55 | loss: 0.0687807
	speed: 0.2700s/iter; left time: 5797.5886s
	iters: 200, epoch: 55 | loss: 0.0064239
	speed: 0.0532s/iter; left time: 1137.1126s
	iters: 300, epoch: 55 | loss: 0.0000560
	speed: 0.0519s/iter; left time: 1105.0596s
	iters: 400, epoch: 55 | loss: 0.0006386
	speed: 0.0521s/iter; left time: 1102.5213s
Epoch: 55 cost time: 25.35469388961792
Epoch: 55, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 154810
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6169527
	speed: 0.0640s/iter; left time: 2993.9178s
	iters: 200, epoch: 1 | loss: 0.3572570
	speed: 0.0458s/iter; left time: 2136.8586s
	iters: 300, epoch: 1 | loss: 0.4324214
	speed: 0.0495s/iter; left time: 2305.8020s
	iters: 400, epoch: 1 | loss: 0.3519020
	speed: 0.0533s/iter; left time: 2479.6351s
Epoch: 1 cost time: 24.948063135147095
Epoch: 1, Steps: 469 | Train Loss: 0.776 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
Validation loss decreased (inf --> -0.925383).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0462710
	speed: 0.2396s/iter; left time: 11101.4013s
	iters: 200, epoch: 2 | loss: 0.1862194
	speed: 0.0412s/iter; left time: 1906.8976s
	iters: 300, epoch: 2 | loss: 0.3278458
	speed: 0.0530s/iter; left time: 2446.5901s
	iters: 400, epoch: 2 | loss: 0.0412132
	speed: 0.0506s/iter; left time: 2330.8108s
Epoch: 2 cost time: 22.569549560546875
Epoch: 2, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
Validation loss decreased (-0.925383 --> -0.959975).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0379159
	speed: 0.2565s/iter; left time: 11762.3711s
	iters: 200, epoch: 3 | loss: 0.1073949
	speed: 0.0499s/iter; left time: 2285.0767s
	iters: 300, epoch: 3 | loss: 0.1887289
	speed: 0.0575s/iter; left time: 2624.1781s
	iters: 400, epoch: 3 | loss: 0.0562405
	speed: 0.0580s/iter; left time: 2643.4258s
Epoch: 3 cost time: 25.722612380981445
Epoch: 3, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.959975 --> -0.961691).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0215338
	speed: 0.2602s/iter; left time: 11809.8882s
	iters: 200, epoch: 4 | loss: 0.0378450
	speed: 0.0526s/iter; left time: 2383.9145s
	iters: 300, epoch: 4 | loss: 0.1221601
	speed: 0.0530s/iter; left time: 2394.3082s
	iters: 400, epoch: 4 | loss: 0.0040034
	speed: 0.0536s/iter; left time: 2414.9881s
Epoch: 4 cost time: 24.931718587875366
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.966551).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0304211
	speed: 0.2460s/iter; left time: 11050.5554s
	iters: 200, epoch: 5 | loss: 0.2800994
	speed: 0.0483s/iter; left time: 2164.4602s
	iters: 300, epoch: 5 | loss: 0.0315278
	speed: 0.0487s/iter; left time: 2179.5462s
	iters: 400, epoch: 5 | loss: 0.0339042
	speed: 0.0479s/iter; left time: 2135.9802s
Epoch: 5 cost time: 22.644877910614014
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.968838).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0639193
	speed: 0.2039s/iter; left time: 9063.7396s
	iters: 200, epoch: 6 | loss: 0.0320580
	speed: 0.0523s/iter; left time: 2317.7297s
	iters: 300, epoch: 6 | loss: 0.0073650
	speed: 0.0521s/iter; left time: 2307.6481s
	iters: 400, epoch: 6 | loss: 0.0091360
	speed: 0.0515s/iter; left time: 2273.7950s
Epoch: 6 cost time: 24.97177243232727
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.968838 --> -0.970267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0036762
	speed: 0.2466s/iter; left time: 10848.3528s
	iters: 200, epoch: 7 | loss: 0.0259417
	speed: 0.0579s/iter; left time: 2542.2665s
	iters: 300, epoch: 7 | loss: 0.0329721
	speed: 0.0574s/iter; left time: 2515.1849s
	iters: 400, epoch: 7 | loss: 0.0424294
	speed: 0.0582s/iter; left time: 2542.8050s
Epoch: 7 cost time: 27.11606764793396
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.970267 --> -0.974556).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0012009
	speed: 0.2340s/iter; left time: 10185.0289s
	iters: 200, epoch: 8 | loss: 0.0092787
	speed: 0.0541s/iter; left time: 2348.7421s
	iters: 300, epoch: 8 | loss: 0.0597978
	speed: 0.0530s/iter; left time: 2294.6545s
	iters: 400, epoch: 8 | loss: 0.1243732
	speed: 0.0496s/iter; left time: 2144.7324s
Epoch: 8 cost time: 24.35696005821228
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0066769
	speed: 0.2186s/iter; left time: 9409.2425s
	iters: 200, epoch: 9 | loss: 0.0005070
	speed: 0.0461s/iter; left time: 1980.3586s
	iters: 300, epoch: 9 | loss: 0.0043716
	speed: 0.0475s/iter; left time: 2034.9608s
	iters: 400, epoch: 9 | loss: 0.0114608
	speed: 0.0487s/iter; left time: 2079.8510s
Epoch: 9 cost time: 22.13373589515686
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.977129).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0515939
	speed: 0.2351s/iter; left time: 10010.6356s
	iters: 200, epoch: 10 | loss: 0.1262081
	speed: 0.0479s/iter; left time: 2033.6348s
	iters: 300, epoch: 10 | loss: 0.3350091
	speed: 0.0485s/iter; left time: 2053.7098s
	iters: 400, epoch: 10 | loss: 0.0025926
	speed: 0.0512s/iter; left time: 2162.8600s
Epoch: 10 cost time: 23.251484870910645
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977415).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0248744
	speed: 0.2463s/iter; left time: 10370.5948s
	iters: 200, epoch: 11 | loss: 0.0217356
	speed: 0.0484s/iter; left time: 2033.7422s
	iters: 300, epoch: 11 | loss: 0.1449480
	speed: 0.0475s/iter; left time: 1988.7766s
	iters: 400, epoch: 11 | loss: 0.0055284
	speed: 0.0539s/iter; left time: 2252.5172s
Epoch: 11 cost time: 23.478582620620728
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0019295
	speed: 0.2433s/iter; left time: 10130.5195s
	iters: 200, epoch: 12 | loss: 0.0879294
	speed: 0.0453s/iter; left time: 1883.4560s
	iters: 300, epoch: 12 | loss: 0.0615069
	speed: 0.0476s/iter; left time: 1973.1731s
	iters: 400, epoch: 12 | loss: 0.0056012
	speed: 0.0464s/iter; left time: 1917.7370s
Epoch: 12 cost time: 21.79598879814148
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0070889
	speed: 0.2433s/iter; left time: 10015.4839s
	iters: 200, epoch: 13 | loss: 0.0012143
	speed: 0.0440s/iter; left time: 1807.3148s
	iters: 300, epoch: 13 | loss: 0.1853127
	speed: 0.0466s/iter; left time: 1907.8395s
	iters: 400, epoch: 13 | loss: 0.0009098
	speed: 0.0468s/iter; left time: 1913.3834s
Epoch: 13 cost time: 22.096916913986206
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978844).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0048728
	speed: 0.2866s/iter; left time: 11665.3351s
	iters: 200, epoch: 14 | loss: 0.0007275
	speed: 0.0508s/iter; left time: 2061.4288s
	iters: 300, epoch: 14 | loss: 0.0663347
	speed: 0.0440s/iter; left time: 1783.6494s
	iters: 400, epoch: 14 | loss: 0.0299676
	speed: 0.0428s/iter; left time: 1728.6898s
Epoch: 14 cost time: 23.372694492340088
Epoch: 14, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0004191
	speed: 0.2594s/iter; left time: 10437.3443s
	iters: 200, epoch: 15 | loss: 0.0008788
	speed: 0.0488s/iter; left time: 1960.1608s
	iters: 300, epoch: 15 | loss: 0.0479219
	speed: 0.0495s/iter; left time: 1981.6638s
	iters: 400, epoch: 15 | loss: 0.0819465
	speed: 0.0488s/iter; left time: 1947.8259s
Epoch: 15 cost time: 23.148559093475342
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0043724
	speed: 0.2572s/iter; left time: 10226.7403s
	iters: 200, epoch: 16 | loss: 0.0092821
	speed: 0.0452s/iter; left time: 1791.6544s
	iters: 300, epoch: 16 | loss: 0.0008263
	speed: 0.0401s/iter; left time: 1588.2552s
	iters: 400, epoch: 16 | loss: 0.2326768
	speed: 0.0404s/iter; left time: 1593.8756s
Epoch: 16 cost time: 21.23314595222473
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0020391
	speed: 0.2432s/iter; left time: 9556.8679s
	iters: 200, epoch: 17 | loss: 0.0008702
	speed: 0.0429s/iter; left time: 1681.1716s
	iters: 300, epoch: 17 | loss: 0.0003075
	speed: 0.0420s/iter; left time: 1643.3347s
	iters: 400, epoch: 17 | loss: 0.0089914
	speed: 0.0464s/iter; left time: 1808.7643s
Epoch: 17 cost time: 21.72295331954956
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0069538
	speed: 0.2574s/iter; left time: 9993.3119s
	iters: 200, epoch: 18 | loss: 0.0022935
	speed: 0.0478s/iter; left time: 1850.1538s
	iters: 300, epoch: 18 | loss: 0.0004079
	speed: 0.0468s/iter; left time: 1806.6482s
	iters: 400, epoch: 18 | loss: 0.0309326
	speed: 0.0509s/iter; left time: 1962.7995s
Epoch: 18 cost time: 23.164445638656616
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0068946
	speed: 0.2489s/iter; left time: 9545.7310s
	iters: 200, epoch: 19 | loss: 0.0012948
	speed: 0.0510s/iter; left time: 1951.6327s
	iters: 300, epoch: 19 | loss: 0.0095437
	speed: 0.0524s/iter; left time: 2000.7869s
	iters: 400, epoch: 19 | loss: 0.0009266
	speed: 0.0467s/iter; left time: 1776.7175s
Epoch: 19 cost time: 23.633238554000854
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0008777
	speed: 0.2427s/iter; left time: 9197.2869s
	iters: 200, epoch: 20 | loss: 0.0017357
	speed: 0.0473s/iter; left time: 1786.9986s
	iters: 300, epoch: 20 | loss: 0.0202332
	speed: 0.0452s/iter; left time: 1705.0792s
	iters: 400, epoch: 20 | loss: 0.0018638
	speed: 0.0457s/iter; left time: 1716.4561s
Epoch: 20 cost time: 22.043127059936523
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.1112827
	speed: 0.2367s/iter; left time: 8855.9608s
	iters: 200, epoch: 21 | loss: 0.0017659
	speed: 0.0436s/iter; left time: 1627.2245s
	iters: 300, epoch: 21 | loss: 0.0314955
	speed: 0.0413s/iter; left time: 1537.3273s
	iters: 400, epoch: 21 | loss: 0.0000183
	speed: 0.0443s/iter; left time: 1643.9702s
Epoch: 21 cost time: 20.83981680870056
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
Validation loss decreased (-0.979988 --> -0.982275).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0001292
	speed: 0.2177s/iter; left time: 8044.2775s
	iters: 200, epoch: 22 | loss: 0.0012110
	speed: 0.0474s/iter; left time: 1745.5946s
	iters: 300, epoch: 22 | loss: 0.0056740
	speed: 0.0445s/iter; left time: 1633.9844s
	iters: 400, epoch: 22 | loss: 0.0045377
	speed: 0.0445s/iter; left time: 1630.6713s
Epoch: 22 cost time: 21.4214084148407
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4631064
	speed: 0.2151s/iter; left time: 7845.9065s
	iters: 200, epoch: 23 | loss: 0.0015257
	speed: 0.0462s/iter; left time: 1682.5615s
	iters: 300, epoch: 23 | loss: 0.0262790
	speed: 0.0491s/iter; left time: 1781.8013s
	iters: 400, epoch: 23 | loss: 0.0020485
	speed: 0.0456s/iter; left time: 1650.7894s
Epoch: 23 cost time: 21.536037921905518
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0002354
	speed: 0.2068s/iter; left time: 7447.1116s
	iters: 200, epoch: 24 | loss: 0.0633330
	speed: 0.0409s/iter; left time: 1469.4990s
	iters: 300, epoch: 24 | loss: 0.0002589
	speed: 0.0432s/iter; left time: 1546.2870s
	iters: 400, epoch: 24 | loss: 0.0295868
	speed: 0.0417s/iter; left time: 1489.4944s
Epoch: 24 cost time: 19.964239835739136
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0935282
	speed: 0.2303s/iter; left time: 8185.6089s
	iters: 200, epoch: 25 | loss: 0.0150455
	speed: 0.0422s/iter; left time: 1494.8587s
	iters: 300, epoch: 25 | loss: 0.0036259
	speed: 0.0430s/iter; left time: 1520.3462s
	iters: 400, epoch: 25 | loss: 0.0003414
	speed: 0.0442s/iter; left time: 1557.3602s
Epoch: 25 cost time: 20.782275676727295
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0908368
	speed: 0.2253s/iter; left time: 7901.4110s
	iters: 200, epoch: 26 | loss: 0.0001224
	speed: 0.0388s/iter; left time: 1356.7611s
	iters: 300, epoch: 26 | loss: 0.0015586
	speed: 0.0416s/iter; left time: 1450.8250s
	iters: 400, epoch: 26 | loss: 0.0138069
	speed: 0.0458s/iter; left time: 1591.5997s
Epoch: 26 cost time: 20.369873523712158
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0026471
	speed: 0.2156s/iter; left time: 7460.4011s
	iters: 200, epoch: 27 | loss: 0.0026186
	speed: 0.0400s/iter; left time: 1381.5017s
	iters: 300, epoch: 27 | loss: 0.0019115
	speed: 0.0394s/iter; left time: 1354.2553s
	iters: 400, epoch: 27 | loss: 0.0012234
	speed: 0.0405s/iter; left time: 1391.1449s
Epoch: 27 cost time: 19.373284578323364
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0022661
	speed: 0.1950s/iter; left time: 6657.3307s
	iters: 200, epoch: 28 | loss: 0.0005384
	speed: 0.0364s/iter; left time: 1238.1223s
	iters: 300, epoch: 28 | loss: 0.0002657
	speed: 0.0361s/iter; left time: 1226.5330s
	iters: 400, epoch: 28 | loss: 0.0013759
	speed: 0.0388s/iter; left time: 1312.7385s
Epoch: 28 cost time: 17.927871465682983
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000415
	speed: 0.1914s/iter; left time: 6442.8582s
	iters: 200, epoch: 29 | loss: 0.0049820
	speed: 0.0346s/iter; left time: 1160.8287s
	iters: 300, epoch: 29 | loss: 0.0002207
	speed: 0.0349s/iter; left time: 1166.7635s
	iters: 400, epoch: 29 | loss: 0.0001474
	speed: 0.0379s/iter; left time: 1265.8408s
Epoch: 29 cost time: 17.92555022239685
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.982275 --> -0.982560).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0007095
	speed: 0.2101s/iter; left time: 6974.7392s
	iters: 200, epoch: 30 | loss: 0.0021082
	speed: 0.0405s/iter; left time: 1341.6399s
	iters: 300, epoch: 30 | loss: 0.0083775
	speed: 0.0436s/iter; left time: 1440.0482s
	iters: 400, epoch: 30 | loss: 0.4161812
	speed: 0.0461s/iter; left time: 1517.2001s
Epoch: 30 cost time: 20.68427610397339
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0006775
	speed: 0.2138s/iter; left time: 6997.9127s
	iters: 200, epoch: 31 | loss: 0.0142384
	speed: 0.0409s/iter; left time: 1333.8947s
	iters: 300, epoch: 31 | loss: 0.0000922
	speed: 0.0409s/iter; left time: 1331.4852s
	iters: 400, epoch: 31 | loss: 0.0004854
	speed: 0.0362s/iter; left time: 1173.4940s
Epoch: 31 cost time: 18.85855484008789
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0011875
	speed: 0.1857s/iter; left time: 5989.8933s
	iters: 200, epoch: 32 | loss: 0.0002947
	speed: 0.0350s/iter; left time: 1126.4106s
	iters: 300, epoch: 32 | loss: 0.0004938
	speed: 0.0365s/iter; left time: 1171.5931s
	iters: 400, epoch: 32 | loss: 0.0228142
	speed: 0.0353s/iter; left time: 1127.4577s
Epoch: 32 cost time: 17.25695824623108
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0002021
	speed: 0.1867s/iter; left time: 5937.2205s
	iters: 200, epoch: 33 | loss: 0.0085763
	speed: 0.0317s/iter; left time: 1004.1371s
	iters: 300, epoch: 33 | loss: 0.1198878
	speed: 0.0316s/iter; left time: 998.7857s
	iters: 400, epoch: 33 | loss: 0.0000866
	speed: 0.0310s/iter; left time: 976.6447s
Epoch: 33 cost time: 15.733928203582764
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0148596
	speed: 0.1597s/iter; left time: 5001.1746s
	iters: 200, epoch: 34 | loss: 0.2750974
	speed: 0.0331s/iter; left time: 1034.6004s
	iters: 300, epoch: 34 | loss: 0.0004275
	speed: 0.0332s/iter; left time: 1033.5686s
	iters: 400, epoch: 34 | loss: 0.0075733
	speed: 0.0336s/iter; left time: 1042.4831s
Epoch: 34 cost time: 16.414799451828003
Epoch: 34, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0220764
	speed: 0.1564s/iter; left time: 4825.5066s
	iters: 200, epoch: 35 | loss: 0.0005127
	speed: 0.0360s/iter; left time: 1107.6846s
	iters: 300, epoch: 35 | loss: 0.0018071
	speed: 0.0348s/iter; left time: 1067.3731s
	iters: 400, epoch: 35 | loss: 0.1898291
	speed: 0.0346s/iter; left time: 1058.4742s
Epoch: 35 cost time: 16.435615062713623
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0103425
	speed: 0.1423s/iter; left time: 4323.6278s
	iters: 200, epoch: 36 | loss: 0.0001198
	speed: 0.0354s/iter; left time: 1071.2016s
	iters: 300, epoch: 36 | loss: 0.2374105
	speed: 0.0351s/iter; left time: 1060.1663s
	iters: 400, epoch: 36 | loss: 0.0948451
	speed: 0.0350s/iter; left time: 1051.8434s
Epoch: 36 cost time: 16.971116304397583
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0019467
	speed: 0.1385s/iter; left time: 4144.3123s
	iters: 200, epoch: 37 | loss: 0.0003612
	speed: 0.0323s/iter; left time: 962.5192s
	iters: 300, epoch: 37 | loss: 0.0010836
	speed: 0.0324s/iter; left time: 961.8635s
	iters: 400, epoch: 37 | loss: 0.0103900
	speed: 0.0330s/iter; left time: 976.6592s
Epoch: 37 cost time: 15.729945659637451
Epoch: 37, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0020338
	speed: 0.1328s/iter; left time: 3909.3010s
	iters: 200, epoch: 38 | loss: 0.0019023
	speed: 0.0304s/iter; left time: 893.4129s
	iters: 300, epoch: 38 | loss: 0.0167009
	speed: 0.0316s/iter; left time: 922.9105s
	iters: 400, epoch: 38 | loss: 0.0014299
	speed: 0.0321s/iter; left time: 935.5454s
Epoch: 38 cost time: 14.991530418395996
Epoch: 38, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0001972
	speed: 0.1412s/iter; left time: 4093.0080s
	iters: 200, epoch: 39 | loss: 0.0668811
	speed: 0.0318s/iter; left time: 918.0407s
	iters: 300, epoch: 39 | loss: 0.0000929
	speed: 0.0267s/iter; left time: 767.1230s
	iters: 400, epoch: 39 | loss: 0.0000923
	speed: 0.0286s/iter; left time: 819.3687s
Epoch: 39 cost time: 14.93559455871582
Epoch: 39, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 154810
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4813261
	speed: 0.0468s/iter; left time: 2190.9482s
	iters: 200, epoch: 1 | loss: 0.8546917
	speed: 0.0333s/iter; left time: 1553.7384s
	iters: 300, epoch: 1 | loss: 0.8716431
	speed: 0.0301s/iter; left time: 1404.2319s
	iters: 400, epoch: 1 | loss: 0.1424176
	speed: 0.0322s/iter; left time: 1499.6382s
Epoch: 1 cost time: 16.414284229278564
Epoch: 1, Steps: 469 | Train Loss: 0.792 Vali Loss: 0.401 Vali Acc: 0.880 Test Loss: 0.401 Test Acc: 0.880
Validation loss decreased (inf --> -0.879642).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2375116
	speed: 0.1356s/iter; left time: 6282.7674s
	iters: 200, epoch: 2 | loss: 0.1924914
	speed: 0.0375s/iter; left time: 1732.7295s
	iters: 300, epoch: 2 | loss: 0.1680227
	speed: 0.0314s/iter; left time: 1446.7774s
	iters: 400, epoch: 2 | loss: 0.1911307
	speed: 0.0296s/iter; left time: 1363.4331s
Epoch: 2 cost time: 15.624065399169922
Epoch: 2, Steps: 469 | Train Loss: 0.206 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
Validation loss decreased (-0.879642 --> -0.925098).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1932714
	speed: 0.1337s/iter; left time: 6129.8795s
	iters: 200, epoch: 3 | loss: 0.1562992
	speed: 0.0321s/iter; left time: 1466.9438s
	iters: 300, epoch: 3 | loss: 0.1061659
	speed: 0.0339s/iter; left time: 1547.1758s
	iters: 400, epoch: 3 | loss: 0.1528224
	speed: 0.0323s/iter; left time: 1470.2092s
Epoch: 3 cost time: 15.641963005065918
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.925098 --> -0.940535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1438628
	speed: 0.1331s/iter; left time: 6041.3762s
	iters: 200, epoch: 4 | loss: 0.0389909
	speed: 0.0327s/iter; left time: 1481.5762s
	iters: 300, epoch: 4 | loss: 0.1412554
	speed: 0.0329s/iter; left time: 1487.2294s
	iters: 400, epoch: 4 | loss: 0.0200641
	speed: 0.0328s/iter; left time: 1477.3660s
Epoch: 4 cost time: 15.371089696884155
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
Validation loss decreased (-0.940535 --> -0.965693).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0474641
	speed: 0.1370s/iter; left time: 6155.3119s
	iters: 200, epoch: 5 | loss: 0.0217560
	speed: 0.0320s/iter; left time: 1436.1143s
	iters: 300, epoch: 5 | loss: 0.1779850
	speed: 0.0316s/iter; left time: 1415.4306s
	iters: 400, epoch: 5 | loss: 0.0751929
	speed: 0.0339s/iter; left time: 1514.5790s
Epoch: 5 cost time: 15.673820495605469
Epoch: 5, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0562505
	speed: 0.1392s/iter; left time: 6188.2460s
	iters: 200, epoch: 6 | loss: 0.0609352
	speed: 0.0356s/iter; left time: 1579.3720s
	iters: 300, epoch: 6 | loss: 0.0213365
	speed: 0.0321s/iter; left time: 1421.5669s
	iters: 400, epoch: 6 | loss: 0.0166961
	speed: 0.0298s/iter; left time: 1316.4984s
Epoch: 6 cost time: 15.79496955871582
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967409).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0036879
	speed: 0.1348s/iter; left time: 5927.7825s
	iters: 200, epoch: 7 | loss: 0.0811439
	speed: 0.0334s/iter; left time: 1466.3894s
	iters: 300, epoch: 7 | loss: 0.0405224
	speed: 0.0343s/iter; left time: 1502.0234s
	iters: 400, epoch: 7 | loss: 0.0019530
	speed: 0.0321s/iter; left time: 1402.8643s
Epoch: 7 cost time: 15.794298887252808
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0576340
	speed: 0.1346s/iter; left time: 5859.4620s
	iters: 200, epoch: 8 | loss: 0.0411363
	speed: 0.0339s/iter; left time: 1470.8958s
	iters: 300, epoch: 8 | loss: 0.0484273
	speed: 0.0355s/iter; left time: 1536.5908s
	iters: 400, epoch: 8 | loss: 0.1405816
	speed: 0.0416s/iter; left time: 1796.0092s
Epoch: 8 cost time: 17.602694272994995
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968838).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0051173
	speed: 0.1881s/iter; left time: 8095.5611s
	iters: 200, epoch: 9 | loss: 0.1284947
	speed: 0.0439s/iter; left time: 1884.5726s
	iters: 300, epoch: 9 | loss: 0.0019027
	speed: 0.0346s/iter; left time: 1482.3086s
	iters: 400, epoch: 9 | loss: 0.1281871
	speed: 0.0372s/iter; left time: 1591.3394s
Epoch: 9 cost time: 18.406635284423828
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.968838 --> -0.972840).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0435055
	speed: 0.1775s/iter; left time: 7557.1778s
	iters: 200, epoch: 10 | loss: 0.0322604
	speed: 0.0428s/iter; left time: 1817.7816s
	iters: 300, epoch: 10 | loss: 0.0127313
	speed: 0.0424s/iter; left time: 1795.0822s
	iters: 400, epoch: 10 | loss: 0.1040509
	speed: 0.0400s/iter; left time: 1690.1728s
Epoch: 10 cost time: 19.486918687820435
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.976843).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0061989
	speed: 0.1494s/iter; left time: 6289.8907s
	iters: 200, epoch: 11 | loss: 0.0032425
	speed: 0.0403s/iter; left time: 1692.2388s
	iters: 300, epoch: 11 | loss: 0.0066795
	speed: 0.0404s/iter; left time: 1695.0412s
	iters: 400, epoch: 11 | loss: 0.0084202
	speed: 0.0410s/iter; left time: 1715.4796s
Epoch: 11 cost time: 19.48672366142273
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0098939
	speed: 0.1615s/iter; left time: 6725.8315s
	iters: 200, epoch: 12 | loss: 0.0045522
	speed: 0.0357s/iter; left time: 1481.3661s
	iters: 300, epoch: 12 | loss: 0.2565971
	speed: 0.0389s/iter; left time: 1610.4276s
	iters: 400, epoch: 12 | loss: 0.0145499
	speed: 0.0392s/iter; left time: 1620.9660s
Epoch: 12 cost time: 17.857419729232788
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0024056
	speed: 0.1694s/iter; left time: 6973.6840s
	iters: 200, epoch: 13 | loss: 0.0276408
	speed: 0.0334s/iter; left time: 1373.1413s
	iters: 300, epoch: 13 | loss: 0.1006968
	speed: 0.0319s/iter; left time: 1309.0171s
	iters: 400, epoch: 13 | loss: 0.0056410
	speed: 0.0334s/iter; left time: 1366.5129s
Epoch: 13 cost time: 16.99238896369934
Epoch: 13, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977701).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0071847
	speed: 0.1801s/iter; left time: 7331.2044s
	iters: 200, epoch: 14 | loss: 0.1092337
	speed: 0.0426s/iter; left time: 1729.4763s
	iters: 300, epoch: 14 | loss: 0.0209672
	speed: 0.0408s/iter; left time: 1652.7911s
	iters: 400, epoch: 14 | loss: 0.0015627
	speed: 0.0381s/iter; left time: 1540.5337s
Epoch: 14 cost time: 19.03082799911499
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0323433
	speed: 0.1444s/iter; left time: 5809.9403s
	iters: 200, epoch: 15 | loss: 0.0353037
	speed: 0.0404s/iter; left time: 1619.9590s
	iters: 300, epoch: 15 | loss: 0.0022992
	speed: 0.0376s/iter; left time: 1503.9840s
	iters: 400, epoch: 15 | loss: 0.0028375
	speed: 0.0405s/iter; left time: 1617.8307s
Epoch: 15 cost time: 18.830941438674927
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
Validation loss decreased (-0.977701 --> -0.983704).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0420995
	speed: 0.1559s/iter; left time: 6199.0959s
	iters: 200, epoch: 16 | loss: 0.0026770
	speed: 0.0259s/iter; left time: 1027.6925s
	iters: 300, epoch: 16 | loss: 0.0140541
	speed: 0.0320s/iter; left time: 1266.5959s
	iters: 400, epoch: 16 | loss: 0.0057985
	speed: 0.0366s/iter; left time: 1444.2087s
Epoch: 16 cost time: 15.308166027069092
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.1303186
	speed: 0.1605s/iter; left time: 6308.6454s
	iters: 200, epoch: 17 | loss: 0.1033625
	speed: 0.0391s/iter; left time: 1534.2235s
	iters: 300, epoch: 17 | loss: 0.0029940
	speed: 0.0329s/iter; left time: 1287.0727s
	iters: 400, epoch: 17 | loss: 0.0022985
	speed: 0.0339s/iter; left time: 1323.5936s
Epoch: 17 cost time: 17.218172550201416
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0012441
	speed: 0.1604s/iter; left time: 6226.9343s
	iters: 200, epoch: 18 | loss: 0.0075843
	speed: 0.0390s/iter; left time: 1510.9568s
	iters: 300, epoch: 18 | loss: 0.0482794
	speed: 0.0386s/iter; left time: 1492.8390s
	iters: 400, epoch: 18 | loss: 0.0331541
	speed: 0.0377s/iter; left time: 1454.4303s
Epoch: 18 cost time: 18.383307933807373
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0245206
	speed: 0.1389s/iter; left time: 5328.4008s
	iters: 200, epoch: 19 | loss: 0.0101107
	speed: 0.0379s/iter; left time: 1448.3004s
	iters: 300, epoch: 19 | loss: 0.0000792
	speed: 0.0391s/iter; left time: 1490.8928s
	iters: 400, epoch: 19 | loss: 0.0295927
	speed: 0.0396s/iter; left time: 1506.6517s
Epoch: 19 cost time: 17.718879461288452
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0411286
	speed: 0.1732s/iter; left time: 6561.7313s
	iters: 200, epoch: 20 | loss: 0.0903152
	speed: 0.0304s/iter; left time: 1148.2958s
	iters: 300, epoch: 20 | loss: 0.0086423
	speed: 0.0316s/iter; left time: 1190.4833s
	iters: 400, epoch: 20 | loss: 0.0425248
	speed: 0.0310s/iter; left time: 1167.1475s
Epoch: 20 cost time: 16.01803731918335
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0012802
	speed: 0.1718s/iter; left time: 6427.4356s
	iters: 200, epoch: 21 | loss: 0.0076388
	speed: 0.0395s/iter; left time: 1472.5375s
	iters: 300, epoch: 21 | loss: 0.0120326
	speed: 0.0390s/iter; left time: 1451.2755s
	iters: 400, epoch: 21 | loss: 0.0017301
	speed: 0.0384s/iter; left time: 1426.2039s
Epoch: 21 cost time: 18.832111120224
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0099094
	speed: 0.1564s/iter; left time: 5780.7570s
	iters: 200, epoch: 22 | loss: 0.0903605
	speed: 0.0308s/iter; left time: 1136.3248s
	iters: 300, epoch: 22 | loss: 0.0023532
	speed: 0.0341s/iter; left time: 1255.0322s
	iters: 400, epoch: 22 | loss: 0.3251495
	speed: 0.0395s/iter; left time: 1447.5657s
Epoch: 22 cost time: 16.485856771469116
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0008669
	speed: 0.1709s/iter; left time: 6234.4390s
	iters: 200, epoch: 23 | loss: 0.0026302
	speed: 0.0390s/iter; left time: 1417.9941s
	iters: 300, epoch: 23 | loss: 0.0026658
	speed: 0.0316s/iter; left time: 1147.1249s
	iters: 400, epoch: 23 | loss: 0.0036771
	speed: 0.0316s/iter; left time: 1144.1942s
Epoch: 23 cost time: 16.60178804397583
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0011569
	speed: 0.1564s/iter; left time: 5630.8832s
	iters: 200, epoch: 24 | loss: 0.0110583
	speed: 0.0392s/iter; left time: 1408.3113s
	iters: 300, epoch: 24 | loss: 0.0005582
	speed: 0.0400s/iter; left time: 1431.7895s
	iters: 400, epoch: 24 | loss: 0.0037252
	speed: 0.0368s/iter; left time: 1312.5879s
Epoch: 24 cost time: 17.67573881149292
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0072986
	speed: 0.1382s/iter; left time: 4912.5296s
	iters: 200, epoch: 25 | loss: 0.0223246
	speed: 0.0380s/iter; left time: 1346.1084s
	iters: 300, epoch: 25 | loss: 0.0313068
	speed: 0.0394s/iter; left time: 1391.6721s
	iters: 400, epoch: 25 | loss: 0.0014916
	speed: 0.0383s/iter; left time: 1348.4525s
Epoch: 25 cost time: 18.146121740341187
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 89274
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4348363
	speed: 0.0521s/iter; left time: 2437.1108s
	iters: 200, epoch: 1 | loss: 0.8134134
	speed: 0.0378s/iter; left time: 1763.9719s
	iters: 300, epoch: 1 | loss: 0.8448881
	speed: 0.0372s/iter; left time: 1731.7362s
	iters: 400, epoch: 1 | loss: 0.1701287
	speed: 0.0384s/iter; left time: 1786.9302s
Epoch: 1 cost time: 19.331084966659546
Epoch: 1, Steps: 469 | Train Loss: 0.784 Vali Loss: 0.364 Vali Acc: 0.892 Test Loss: 0.364 Test Acc: 0.892
Validation loss decreased (inf --> -0.891649).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2156140
	speed: 0.1383s/iter; left time: 6406.1875s
	iters: 200, epoch: 2 | loss: 0.2382857
	speed: 0.0335s/iter; left time: 1548.6515s
	iters: 300, epoch: 2 | loss: 0.1298079
	speed: 0.0395s/iter; left time: 1821.5874s
	iters: 400, epoch: 2 | loss: 0.1293750
	speed: 0.0387s/iter; left time: 1779.1495s
Epoch: 2 cost time: 16.986511707305908
Epoch: 2, Steps: 469 | Train Loss: 0.194 Vali Loss: 0.233 Vali Acc: 0.929 Test Loss: 0.233 Test Acc: 0.929
Validation loss decreased (-0.891649 --> -0.928814).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0874924
	speed: 0.1736s/iter; left time: 7962.7832s
	iters: 200, epoch: 3 | loss: 0.1225640
	speed: 0.0378s/iter; left time: 1731.8411s
	iters: 300, epoch: 3 | loss: 0.0871147
	speed: 0.0338s/iter; left time: 1544.4041s
	iters: 400, epoch: 3 | loss: 0.0943300
	speed: 0.0316s/iter; left time: 1440.9446s
Epoch: 3 cost time: 16.657790184020996
Epoch: 3, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.928814 --> -0.953400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1137145
	speed: 0.1574s/iter; left time: 7145.4566s
	iters: 200, epoch: 4 | loss: 0.0439412
	speed: 0.0366s/iter; left time: 1658.9431s
	iters: 300, epoch: 4 | loss: 0.1002310
	speed: 0.0375s/iter; left time: 1693.8381s
	iters: 400, epoch: 4 | loss: 0.0109672
	speed: 0.0384s/iter; left time: 1729.9091s
Epoch: 4 cost time: 17.67827820777893
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.953400 --> -0.964836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0361243
	speed: 0.1472s/iter; left time: 6613.0002s
	iters: 200, epoch: 5 | loss: 0.0228357
	speed: 0.0402s/iter; left time: 1801.5637s
	iters: 300, epoch: 5 | loss: 0.0877143
	speed: 0.0398s/iter; left time: 1778.4911s
	iters: 400, epoch: 5 | loss: 0.1101152
	speed: 0.0396s/iter; left time: 1767.1795s
Epoch: 5 cost time: 18.77879023551941
Epoch: 5, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.968266).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0814267
	speed: 0.1587s/iter; left time: 7054.4432s
	iters: 200, epoch: 6 | loss: 0.0187007
	speed: 0.0318s/iter; left time: 1409.4860s
	iters: 300, epoch: 6 | loss: 0.0223739
	speed: 0.0395s/iter; left time: 1746.8492s
	iters: 400, epoch: 6 | loss: 0.0064357
	speed: 0.0402s/iter; left time: 1776.7885s
Epoch: 6 cost time: 17.24320340156555
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0190059
	speed: 0.1700s/iter; left time: 7479.3754s
	iters: 200, epoch: 7 | loss: 0.0779334
	speed: 0.0389s/iter; left time: 1707.2572s
	iters: 300, epoch: 7 | loss: 0.0323895
	speed: 0.0410s/iter; left time: 1796.1701s
	iters: 400, epoch: 7 | loss: 0.0024326
	speed: 0.0335s/iter; left time: 1462.4604s
Epoch: 7 cost time: 17.5700204372406
Epoch: 7, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0537972
	speed: 0.1453s/iter; left time: 6324.8481s
	iters: 200, epoch: 8 | loss: 0.0210116
	speed: 0.0370s/iter; left time: 1605.0469s
	iters: 300, epoch: 8 | loss: 0.0276290
	speed: 0.0366s/iter; left time: 1583.5050s
	iters: 400, epoch: 8 | loss: 0.0111246
	speed: 0.0376s/iter; left time: 1623.7240s
Epoch: 8 cost time: 17.776426076889038
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0074313
	speed: 0.1587s/iter; left time: 6832.9345s
	iters: 200, epoch: 9 | loss: 0.1004351
	speed: 0.0341s/iter; left time: 1466.5700s
	iters: 300, epoch: 9 | loss: 0.0057140
	speed: 0.0315s/iter; left time: 1349.7420s
	iters: 400, epoch: 9 | loss: 0.2430896
	speed: 0.0361s/iter; left time: 1541.4824s
Epoch: 9 cost time: 15.90010690689087
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.968266 --> -0.974842).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0019718
	speed: 0.1653s/iter; left time: 7037.7460s
	iters: 200, epoch: 10 | loss: 0.0651386
	speed: 0.0313s/iter; left time: 1331.3325s
	iters: 300, epoch: 10 | loss: 0.0365848
	speed: 0.0354s/iter; left time: 1501.7304s
	iters: 400, epoch: 10 | loss: 0.0207113
	speed: 0.0332s/iter; left time: 1401.9966s
Epoch: 10 cost time: 16.37069034576416
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0048455
	speed: 0.1721s/iter; left time: 7247.5490s
	iters: 200, epoch: 11 | loss: 0.0018797
	speed: 0.0397s/iter; left time: 1667.2705s
	iters: 300, epoch: 11 | loss: 0.0141628
	speed: 0.0367s/iter; left time: 1537.0751s
	iters: 400, epoch: 11 | loss: 0.0100625
	speed: 0.0357s/iter; left time: 1493.9048s
Epoch: 11 cost time: 17.666592597961426
Epoch: 11, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0085918
	speed: 0.1423s/iter; left time: 5923.5870s
	iters: 200, epoch: 12 | loss: 0.0012674
	speed: 0.0373s/iter; left time: 1548.5356s
	iters: 300, epoch: 12 | loss: 0.0463708
	speed: 0.0383s/iter; left time: 1587.7279s
	iters: 400, epoch: 12 | loss: 0.0927342
	speed: 0.0380s/iter; left time: 1571.2659s
Epoch: 12 cost time: 18.1787850856781
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0021619
	speed: 0.1736s/iter; left time: 7147.2324s
	iters: 200, epoch: 13 | loss: 0.0042523
	speed: 0.0377s/iter; left time: 1547.7738s
	iters: 300, epoch: 13 | loss: 0.0077866
	speed: 0.0371s/iter; left time: 1519.7375s
	iters: 400, epoch: 13 | loss: 0.0807128
	speed: 0.0321s/iter; left time: 1312.5980s
Epoch: 13 cost time: 17.21324634552002
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.977415).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0194781
	speed: 0.1489s/iter; left time: 6059.2966s
	iters: 200, epoch: 14 | loss: 0.1493813
	speed: 0.0379s/iter; left time: 1539.3992s
	iters: 300, epoch: 14 | loss: 0.0243546
	speed: 0.0383s/iter; left time: 1551.5280s
	iters: 400, epoch: 14 | loss: 0.0025582
	speed: 0.0371s/iter; left time: 1499.5778s
Epoch: 14 cost time: 18.362948179244995
Epoch: 14, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0032805
	speed: 0.1679s/iter; left time: 6757.3620s
	iters: 200, epoch: 15 | loss: 0.0063830
	speed: 0.0363s/iter; left time: 1455.8455s
	iters: 300, epoch: 15 | loss: 0.0032897
	speed: 0.0305s/iter; left time: 1220.1514s
	iters: 400, epoch: 15 | loss: 0.0194543
	speed: 0.0313s/iter; left time: 1249.3128s
Epoch: 15 cost time: 15.927150249481201
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0128963
	speed: 0.1428s/iter; left time: 5678.1481s
	iters: 200, epoch: 16 | loss: 0.0026009
	speed: 0.0384s/iter; left time: 1523.9184s
	iters: 300, epoch: 16 | loss: 0.0164475
	speed: 0.0350s/iter; left time: 1383.7557s
	iters: 400, epoch: 16 | loss: 0.0056817
	speed: 0.0362s/iter; left time: 1430.0955s
Epoch: 16 cost time: 17.401498079299927
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0705752
	speed: 0.1386s/iter; left time: 5445.4903s
	iters: 200, epoch: 17 | loss: 0.0446703
	speed: 0.0357s/iter; left time: 1400.4186s
	iters: 300, epoch: 17 | loss: 0.0078489
	speed: 0.0362s/iter; left time: 1414.1820s
	iters: 400, epoch: 17 | loss: 0.0016235
	speed: 0.0365s/iter; left time: 1422.6918s
Epoch: 17 cost time: 16.619893550872803
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0013662
	speed: 0.1627s/iter; left time: 6316.5627s
	iters: 200, epoch: 18 | loss: 0.0018730
	speed: 0.0371s/iter; left time: 1435.7957s
	iters: 300, epoch: 18 | loss: 0.0861138
	speed: 0.0308s/iter; left time: 1190.4131s
	iters: 400, epoch: 18 | loss: 0.0085600
	speed: 0.0333s/iter; left time: 1284.3431s
Epoch: 18 cost time: 16.656925916671753
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0038140
	speed: 0.1528s/iter; left time: 5861.2333s
	iters: 200, epoch: 19 | loss: 0.0325946
	speed: 0.0346s/iter; left time: 1324.8976s
	iters: 300, epoch: 19 | loss: 0.0003474
	speed: 0.0343s/iter; left time: 1310.3525s
	iters: 400, epoch: 19 | loss: 0.0019573
	speed: 0.0364s/iter; left time: 1385.4860s
Epoch: 19 cost time: 17.08704376220703
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.1095300
	speed: 0.1451s/iter; left time: 5497.1148s
	iters: 200, epoch: 20 | loss: 0.0709205
	speed: 0.0373s/iter; left time: 1410.9697s
	iters: 300, epoch: 20 | loss: 0.0062156
	speed: 0.0354s/iter; left time: 1335.6757s
	iters: 400, epoch: 20 | loss: 0.0168845
	speed: 0.0347s/iter; left time: 1302.6757s
Epoch: 20 cost time: 16.491222858428955
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0003857
	speed: 0.1525s/iter; left time: 5706.9313s
	iters: 200, epoch: 21 | loss: 0.0005653
	speed: 0.0302s/iter; left time: 1125.3813s
	iters: 300, epoch: 21 | loss: 0.0374197
	speed: 0.0299s/iter; left time: 1111.8073s
	iters: 400, epoch: 21 | loss: 0.0057807
	speed: 0.0313s/iter; left time: 1160.4593s
Epoch: 21 cost time: 15.162020921707153
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0026075
	speed: 0.1501s/iter; left time: 5544.7897s
	iters: 200, epoch: 22 | loss: 0.1311886
	speed: 0.0373s/iter; left time: 1374.0897s
	iters: 300, epoch: 22 | loss: 0.0034675
	speed: 0.0351s/iter; left time: 1290.3412s
	iters: 400, epoch: 22 | loss: 0.1348552
	speed: 0.0310s/iter; left time: 1135.7055s
Epoch: 22 cost time: 16.494094610214233
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0014834
	speed: 0.1477s/iter; left time: 5389.3525s
	iters: 200, epoch: 23 | loss: 0.0007898
	speed: 0.0365s/iter; left time: 1328.8935s
	iters: 300, epoch: 23 | loss: 0.0019193
	speed: 0.0355s/iter; left time: 1289.2481s
	iters: 400, epoch: 23 | loss: 0.0040659
	speed: 0.0347s/iter; left time: 1254.0018s
Epoch: 23 cost time: 17.233784914016724
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0008085
	speed: 0.1409s/iter; left time: 5075.1687s
	iters: 200, epoch: 24 | loss: 0.0021101
	speed: 0.0349s/iter; left time: 1253.4515s
	iters: 300, epoch: 24 | loss: 0.0019271
	speed: 0.0373s/iter; left time: 1336.7417s
	iters: 400, epoch: 24 | loss: 0.0056981
	speed: 0.0398s/iter; left time: 1421.3539s
Epoch: 24 cost time: 17.057090044021606
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979130).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0055950
	speed: 0.1548s/iter; left time: 5501.1663s
	iters: 200, epoch: 25 | loss: 0.0044944
	speed: 0.0341s/iter; left time: 1209.3145s
	iters: 300, epoch: 25 | loss: 0.0050625
	speed: 0.0334s/iter; left time: 1181.4279s
	iters: 400, epoch: 25 | loss: 0.0020835
	speed: 0.0354s/iter; left time: 1249.4235s
Epoch: 25 cost time: 16.39103102684021
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0043215
	speed: 0.1540s/iter; left time: 5400.5521s
	iters: 200, epoch: 26 | loss: 0.0038873
	speed: 0.0328s/iter; left time: 1145.7125s
	iters: 300, epoch: 26 | loss: 0.0030298
	speed: 0.0327s/iter; left time: 1140.4783s
	iters: 400, epoch: 26 | loss: 0.0004719
	speed: 0.0341s/iter; left time: 1186.3100s
Epoch: 26 cost time: 16.083874702453613
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979130 --> -0.982846).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0004866
	speed: 0.1525s/iter; left time: 5278.8955s
	iters: 200, epoch: 27 | loss: 0.3490332
	speed: 0.0343s/iter; left time: 1183.8413s
	iters: 300, epoch: 27 | loss: 0.0154602
	speed: 0.0329s/iter; left time: 1132.8664s
	iters: 400, epoch: 27 | loss: 0.0036470
	speed: 0.0293s/iter; left time: 1006.8472s
Epoch: 27 cost time: 15.557147979736328
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0059330
	speed: 0.1547s/iter; left time: 5282.8385s
	iters: 200, epoch: 28 | loss: 0.0005195
	speed: 0.0463s/iter; left time: 1576.6216s
	iters: 300, epoch: 28 | loss: 0.1790867
	speed: 0.0454s/iter; left time: 1542.4322s
	iters: 400, epoch: 28 | loss: 0.0022133
	speed: 0.0461s/iter; left time: 1558.5919s
Epoch: 28 cost time: 21.22530508041382
Epoch: 28, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0168181
	speed: 0.1862s/iter; left time: 6270.7996s
	iters: 200, epoch: 29 | loss: 0.0443760
	speed: 0.0443s/iter; left time: 1487.6530s
	iters: 300, epoch: 29 | loss: 0.0852602
	speed: 0.0442s/iter; left time: 1480.9627s
	iters: 400, epoch: 29 | loss: 0.0001901
	speed: 0.0445s/iter; left time: 1483.4800s
Epoch: 29 cost time: 21.06523370742798
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0060580
	speed: 0.1799s/iter; left time: 5972.3370s
	iters: 200, epoch: 30 | loss: 0.0015697
	speed: 0.0465s/iter; left time: 1539.0495s
	iters: 300, epoch: 30 | loss: 0.0124278
	speed: 0.0449s/iter; left time: 1482.6913s
	iters: 400, epoch: 30 | loss: 0.0103320
	speed: 0.0426s/iter; left time: 1402.8488s
Epoch: 30 cost time: 21.052257537841797
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0765639
	speed: 0.1764s/iter; left time: 5774.0392s
	iters: 200, epoch: 31 | loss: 0.0104059
	speed: 0.0421s/iter; left time: 1375.0040s
	iters: 300, epoch: 31 | loss: 0.0204326
	speed: 0.0425s/iter; left time: 1383.9210s
	iters: 400, epoch: 31 | loss: 0.0245401
	speed: 0.0430s/iter; left time: 1395.0690s
Epoch: 31 cost time: 20.070334911346436
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0011532
	speed: 0.1830s/iter; left time: 5904.0452s
	iters: 200, epoch: 32 | loss: 0.0044449
	speed: 0.0432s/iter; left time: 1390.8315s
	iters: 300, epoch: 32 | loss: 0.0243559
	speed: 0.0443s/iter; left time: 1420.3553s
	iters: 400, epoch: 32 | loss: 0.0006877
	speed: 0.0440s/iter; left time: 1405.8137s
Epoch: 32 cost time: 20.96570062637329
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0319068
	speed: 0.1897s/iter; left time: 6031.9182s
	iters: 200, epoch: 33 | loss: 0.0004016
	speed: 0.0452s/iter; left time: 1433.6226s
	iters: 300, epoch: 33 | loss: 0.0001952
	speed: 0.0482s/iter; left time: 1521.3389s
	iters: 400, epoch: 33 | loss: 0.0287335
	speed: 0.0463s/iter; left time: 1458.6929s
Epoch: 33 cost time: 21.263306140899658
Epoch: 33, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0250135
	speed: 0.1852s/iter; left time: 5799.9450s
	iters: 200, epoch: 34 | loss: 0.0037275
	speed: 0.0454s/iter; left time: 1418.4447s
	iters: 300, epoch: 34 | loss: 0.0029787
	speed: 0.0436s/iter; left time: 1357.7287s
	iters: 400, epoch: 34 | loss: 0.0081966
	speed: 0.0443s/iter; left time: 1373.0130s
Epoch: 34 cost time: 20.740997076034546
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0016270
	speed: 0.1862s/iter; left time: 5744.2126s
	iters: 200, epoch: 35 | loss: 0.0000638
	speed: 0.0422s/iter; left time: 1299.1585s
	iters: 300, epoch: 35 | loss: 0.0001960
	speed: 0.0420s/iter; left time: 1287.7866s
	iters: 400, epoch: 35 | loss: 0.0009912
	speed: 0.0419s/iter; left time: 1279.1107s
Epoch: 35 cost time: 19.678537607192993
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0001379
	speed: 0.1966s/iter; left time: 5972.9249s
	iters: 200, epoch: 36 | loss: 0.0142250
	speed: 0.0389s/iter; left time: 1177.5205s
	iters: 300, epoch: 36 | loss: 0.0048816
	speed: 0.0404s/iter; left time: 1219.8093s
	iters: 400, epoch: 36 | loss: 0.0014658
	speed: 0.0467s/iter; left time: 1403.5277s
Epoch: 36 cost time: 19.56562876701355
Epoch: 36, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 89274
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4611675
	speed: 0.0620s/iter; left time: 2902.5749s
	iters: 200, epoch: 1 | loss: 0.7427929
	speed: 0.0401s/iter; left time: 1873.8204s
	iters: 300, epoch: 1 | loss: 0.7250037
	speed: 0.0421s/iter; left time: 1961.7925s
	iters: 400, epoch: 1 | loss: 0.1677106
	speed: 0.0452s/iter; left time: 2103.1954s
Epoch: 1 cost time: 21.96971297264099
Epoch: 1, Steps: 469 | Train Loss: 0.786 Vali Loss: 0.315 Vali Acc: 0.909 Test Loss: 0.315 Test Acc: 0.909
Validation loss decreased (inf --> -0.908516).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1390207
	speed: 0.1934s/iter; left time: 8962.3247s
	iters: 200, epoch: 2 | loss: 0.2458642
	speed: 0.0363s/iter; left time: 1676.5565s
	iters: 300, epoch: 2 | loss: 0.1562864
	speed: 0.0372s/iter; left time: 1716.0802s
	iters: 400, epoch: 2 | loss: 0.1121249
	speed: 0.0401s/iter; left time: 1847.8011s
Epoch: 2 cost time: 18.17789363861084
Epoch: 2, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.908516 --> -0.952256).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0467498
	speed: 0.1934s/iter; left time: 8868.2501s
	iters: 200, epoch: 3 | loss: 0.1540401
	speed: 0.0336s/iter; left time: 1538.1072s
	iters: 300, epoch: 3 | loss: 0.0497870
	speed: 0.0380s/iter; left time: 1737.3509s
	iters: 400, epoch: 3 | loss: 0.1252697
	speed: 0.0421s/iter; left time: 1920.3471s
Epoch: 3 cost time: 18.36079168319702
Epoch: 3, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.952256 --> -0.963120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1016306
	speed: 0.2058s/iter; left time: 9342.7844s
	iters: 200, epoch: 4 | loss: 0.0228406
	speed: 0.0347s/iter; left time: 1570.0765s
	iters: 300, epoch: 4 | loss: 0.1681397
	speed: 0.0359s/iter; left time: 1622.3437s
	iters: 400, epoch: 4 | loss: 0.0093356
	speed: 0.0396s/iter; left time: 1784.4046s
Epoch: 4 cost time: 18.27409291267395
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.963120 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0092928
	speed: 0.2205s/iter; left time: 9906.0650s
	iters: 200, epoch: 5 | loss: 0.0654510
	speed: 0.0378s/iter; left time: 1692.8670s
	iters: 300, epoch: 5 | loss: 0.2522247
	speed: 0.0357s/iter; left time: 1596.5770s
	iters: 400, epoch: 5 | loss: 0.2028197
	speed: 0.0374s/iter; left time: 1669.5301s
Epoch: 5 cost time: 18.321948051452637
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.963120 --> -0.970553).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0260451
	speed: 0.2087s/iter; left time: 9278.9016s
	iters: 200, epoch: 6 | loss: 0.0533772
	speed: 0.0384s/iter; left time: 1702.1689s
	iters: 300, epoch: 6 | loss: 0.0444340
	speed: 0.0412s/iter; left time: 1824.7878s
	iters: 400, epoch: 6 | loss: 0.0177050
	speed: 0.0364s/iter; left time: 1608.1619s
Epoch: 6 cost time: 18.62124538421631
Epoch: 6, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.970839).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0023049
	speed: 0.2005s/iter; left time: 8819.1316s
	iters: 200, epoch: 7 | loss: 0.0707016
	speed: 0.0403s/iter; left time: 1770.2175s
	iters: 300, epoch: 7 | loss: 0.0100539
	speed: 0.0414s/iter; left time: 1812.8708s
	iters: 400, epoch: 7 | loss: 0.0055611
	speed: 0.0443s/iter; left time: 1936.0193s
Epoch: 7 cost time: 20.177626609802246
Epoch: 7, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0690373
	speed: 0.2078s/iter; left time: 9041.3215s
	iters: 200, epoch: 8 | loss: 0.0457936
	speed: 0.0383s/iter; left time: 1662.8082s
	iters: 300, epoch: 8 | loss: 0.0744160
	speed: 0.0417s/iter; left time: 1807.5078s
	iters: 400, epoch: 8 | loss: 0.0428762
	speed: 0.0436s/iter; left time: 1884.7470s
Epoch: 8 cost time: 19.484824180603027
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0032512
	speed: 0.1994s/iter; left time: 8582.1094s
	iters: 200, epoch: 9 | loss: 0.2314597
	speed: 0.0383s/iter; left time: 1646.2428s
	iters: 300, epoch: 9 | loss: 0.0057268
	speed: 0.0437s/iter; left time: 1871.6539s
	iters: 400, epoch: 9 | loss: 0.1761841
	speed: 0.0433s/iter; left time: 1850.0511s
Epoch: 9 cost time: 19.582505226135254
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0165982
	speed: 0.2076s/iter; left time: 8838.2358s
	iters: 200, epoch: 10 | loss: 0.0109352
	speed: 0.0372s/iter; left time: 1580.0918s
	iters: 300, epoch: 10 | loss: 0.2220569
	speed: 0.0396s/iter; left time: 1676.3310s
	iters: 400, epoch: 10 | loss: 0.0343838
	speed: 0.0402s/iter; left time: 1697.5508s
Epoch: 10 cost time: 18.670336484909058
Epoch: 10, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0089587
	speed: 0.1983s/iter; left time: 8350.1933s
	iters: 200, epoch: 11 | loss: 0.0011302
	speed: 0.0394s/iter; left time: 1657.2598s
	iters: 300, epoch: 11 | loss: 0.0228330
	speed: 0.0404s/iter; left time: 1692.7335s
	iters: 400, epoch: 11 | loss: 0.0599778
	speed: 0.0391s/iter; left time: 1634.9922s
Epoch: 11 cost time: 19.070413827896118
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.973126 --> -0.976557).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0093688
	speed: 0.1929s/iter; left time: 8032.4363s
	iters: 200, epoch: 12 | loss: 0.0018501
	speed: 0.0378s/iter; left time: 1571.9069s
	iters: 300, epoch: 12 | loss: 0.1067574
	speed: 0.0396s/iter; left time: 1642.5530s
	iters: 400, epoch: 12 | loss: 0.0022003
	speed: 0.0388s/iter; left time: 1604.5154s
Epoch: 12 cost time: 18.515483379364014
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0032709
	speed: 0.1868s/iter; left time: 7691.4855s
	iters: 200, epoch: 13 | loss: 0.0027202
	speed: 0.0377s/iter; left time: 1546.6864s
	iters: 300, epoch: 13 | loss: 0.0095432
	speed: 0.0411s/iter; left time: 1682.6058s
	iters: 400, epoch: 13 | loss: 0.0382692
	speed: 0.0405s/iter; left time: 1655.0592s
Epoch: 13 cost time: 18.81208610534668
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978558).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0146905
	speed: 0.1938s/iter; left time: 7889.8209s
	iters: 200, epoch: 14 | loss: 0.1683822
	speed: 0.0423s/iter; left time: 1718.3697s
	iters: 300, epoch: 14 | loss: 0.1928954
	speed: 0.0429s/iter; left time: 1737.9922s
	iters: 400, epoch: 14 | loss: 0.0015520
	speed: 0.0419s/iter; left time: 1693.6114s
Epoch: 14 cost time: 19.727511644363403
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0324184
	speed: 0.1832s/iter; left time: 7372.2236s
	iters: 200, epoch: 15 | loss: 0.0873514
	speed: 0.0405s/iter; left time: 1624.2808s
	iters: 300, epoch: 15 | loss: 0.0165414
	speed: 0.0409s/iter; left time: 1638.7122s
	iters: 400, epoch: 15 | loss: 0.0016881
	speed: 0.0396s/iter; left time: 1582.7643s
Epoch: 15 cost time: 19.170515775680542
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0259396
	speed: 0.1813s/iter; left time: 7211.5637s
	iters: 200, epoch: 16 | loss: 0.0008918
	speed: 0.0381s/iter; left time: 1510.0644s
	iters: 300, epoch: 16 | loss: 0.0039737
	speed: 0.0394s/iter; left time: 1559.3222s
	iters: 400, epoch: 16 | loss: 0.0044308
	speed: 0.0406s/iter; left time: 1603.4389s
Epoch: 16 cost time: 18.68319272994995
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0102974
	speed: 0.1824s/iter; left time: 7168.6358s
	iters: 200, epoch: 17 | loss: 0.0252150
	speed: 0.0356s/iter; left time: 1395.5648s
	iters: 300, epoch: 17 | loss: 0.0505284
	speed: 0.0382s/iter; left time: 1491.8853s
	iters: 400, epoch: 17 | loss: 0.0006979
	speed: 0.0411s/iter; left time: 1601.1527s
Epoch: 17 cost time: 18.316762685775757
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0006258
	speed: 0.1844s/iter; left time: 7158.4313s
	iters: 200, epoch: 18 | loss: 0.0224210
	speed: 0.0378s/iter; left time: 1462.3971s
	iters: 300, epoch: 18 | loss: 0.0032460
	speed: 0.0403s/iter; left time: 1555.3349s
	iters: 400, epoch: 18 | loss: 0.0071898
	speed: 0.0416s/iter; left time: 1602.7556s
Epoch: 18 cost time: 18.789045810699463
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979988).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0154253
	speed: 0.1942s/iter; left time: 7450.3107s
	iters: 200, epoch: 19 | loss: 0.0128842
	speed: 0.0343s/iter; left time: 1312.0371s
	iters: 300, epoch: 19 | loss: 0.0000709
	speed: 0.0372s/iter; left time: 1420.2929s
	iters: 400, epoch: 19 | loss: 0.0001678
	speed: 0.0326s/iter; left time: 1239.1080s
Epoch: 19 cost time: 16.672444581985474
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.982846).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2854917
	speed: 0.1631s/iter; left time: 6178.5453s
	iters: 200, epoch: 20 | loss: 0.0173383
	speed: 0.0363s/iter; left time: 1371.3628s
	iters: 300, epoch: 20 | loss: 0.0222671
	speed: 0.0371s/iter; left time: 1399.7210s
	iters: 400, epoch: 20 | loss: 0.2711480
	speed: 0.0398s/iter; left time: 1497.9322s
Epoch: 20 cost time: 18.283292770385742
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001527
	speed: 0.1836s/iter; left time: 6870.3256s
	iters: 200, epoch: 21 | loss: 0.0001049
	speed: 0.0394s/iter; left time: 1472.2423s
	iters: 300, epoch: 21 | loss: 0.1183403
	speed: 0.0382s/iter; left time: 1423.3191s
	iters: 400, epoch: 21 | loss: 0.0047757
	speed: 0.0372s/iter; left time: 1382.1913s
Epoch: 21 cost time: 18.31994104385376
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0139377
	speed: 0.1764s/iter; left time: 6517.5067s
	iters: 200, epoch: 22 | loss: 0.0333005
	speed: 0.0425s/iter; left time: 1564.5701s
	iters: 300, epoch: 22 | loss: 0.0024642
	speed: 0.0390s/iter; left time: 1434.4147s
	iters: 400, epoch: 22 | loss: 0.1317312
	speed: 0.0368s/iter; left time: 1349.2928s
Epoch: 22 cost time: 18.559908151626587
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0029384
	speed: 0.1641s/iter; left time: 5987.6265s
	iters: 200, epoch: 23 | loss: 0.0024895
	speed: 0.0375s/iter; left time: 1365.4533s
	iters: 300, epoch: 23 | loss: 0.0005603
	speed: 0.0397s/iter; left time: 1441.8332s
	iters: 400, epoch: 23 | loss: 0.0371067
	speed: 0.0387s/iter; left time: 1399.4565s
Epoch: 23 cost time: 18.468790531158447
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0326282
	speed: 0.1682s/iter; left time: 6057.8119s
	iters: 200, epoch: 24 | loss: 0.0031975
	speed: 0.0375s/iter; left time: 1346.8402s
	iters: 300, epoch: 24 | loss: 0.0000500
	speed: 0.0386s/iter; left time: 1380.8825s
	iters: 400, epoch: 24 | loss: 0.0031231
	speed: 0.0389s/iter; left time: 1389.3164s
Epoch: 24 cost time: 17.798171758651733
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0019359
	speed: 0.1593s/iter; left time: 5662.1106s
	iters: 200, epoch: 25 | loss: 0.0016732
	speed: 0.0364s/iter; left time: 1289.9991s
	iters: 300, epoch: 25 | loss: 0.0190627
	speed: 0.0352s/iter; left time: 1245.8565s
	iters: 400, epoch: 25 | loss: 0.0019644
	speed: 0.0372s/iter; left time: 1312.7820s
Epoch: 25 cost time: 17.454580068588257
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0045804
	speed: 0.1721s/iter; left time: 6036.0850s
	iters: 200, epoch: 26 | loss: 0.0439617
	speed: 0.0358s/iter; left time: 1251.1101s
	iters: 300, epoch: 26 | loss: 0.0002586
	speed: 0.0364s/iter; left time: 1271.0306s
	iters: 400, epoch: 26 | loss: 0.0032155
	speed: 0.0368s/iter; left time: 1281.2161s
Epoch: 26 cost time: 17.67567753791809
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0000455
	speed: 0.1694s/iter; left time: 5863.4470s
	iters: 200, epoch: 27 | loss: 0.1811865
	speed: 0.0368s/iter; left time: 1269.6801s
	iters: 300, epoch: 27 | loss: 0.0000989
	speed: 0.0359s/iter; left time: 1234.5403s
	iters: 400, epoch: 27 | loss: 0.0010308
	speed: 0.0389s/iter; left time: 1333.9456s
Epoch: 27 cost time: 17.793168306350708
Epoch: 27, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.1751989
	speed: 0.1765s/iter; left time: 6026.9261s
	iters: 200, epoch: 28 | loss: 0.0000589
	speed: 0.0401s/iter; left time: 1366.3237s
	iters: 300, epoch: 28 | loss: 0.0044584
	speed: 0.0398s/iter; left time: 1352.0995s
	iters: 400, epoch: 28 | loss: 0.0005135
	speed: 0.0366s/iter; left time: 1239.4530s
Epoch: 28 cost time: 18.249335289001465
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0084224
	speed: 0.1643s/iter; left time: 5533.1322s
	iters: 200, epoch: 29 | loss: 0.0053131
	speed: 0.0367s/iter; left time: 1231.6790s
	iters: 300, epoch: 29 | loss: 0.0528088
	speed: 0.0359s/iter; left time: 1200.3712s
	iters: 400, epoch: 29 | loss: 0.0000245
	speed: 0.0390s/iter; left time: 1300.4316s
Epoch: 29 cost time: 17.896456956863403
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 89274
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2298228
	speed: 0.0820s/iter; left time: 3836.2558s
	iters: 200, epoch: 1 | loss: 0.6252852
	speed: 0.0631s/iter; left time: 2946.8768s
	iters: 300, epoch: 1 | loss: 0.2560787
	speed: 0.0683s/iter; left time: 3183.7137s
	iters: 400, epoch: 1 | loss: 0.3314508
	speed: 0.0677s/iter; left time: 3146.6541s
Epoch: 1 cost time: 32.87750315666199
Epoch: 1, Steps: 469 | Train Loss: 0.859 Vali Loss: 0.390 Vali Acc: 0.866 Test Loss: 0.390 Test Acc: 0.866
Validation loss decreased (inf --> -0.865919).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2931099
	speed: 0.3199s/iter; left time: 14823.1037s
	iters: 200, epoch: 2 | loss: 0.4116206
	speed: 0.0698s/iter; left time: 3226.4576s
	iters: 300, epoch: 2 | loss: 0.1974278
	speed: 0.0661s/iter; left time: 3049.9023s
	iters: 400, epoch: 2 | loss: 0.1195914
	speed: 0.0643s/iter; left time: 2957.8930s
Epoch: 2 cost time: 31.708940505981445
Epoch: 2, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.240 Vali Acc: 0.934 Test Loss: 0.240 Test Acc: 0.934
Validation loss decreased (-0.865919 --> -0.933674).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0873841
	speed: 0.3006s/iter; left time: 13786.2967s
	iters: 200, epoch: 3 | loss: 0.5331813
	speed: 0.0658s/iter; left time: 3011.8478s
	iters: 300, epoch: 3 | loss: 0.0440172
	speed: 0.0624s/iter; left time: 2851.0132s
	iters: 400, epoch: 3 | loss: 0.0614431
	speed: 0.0595s/iter; left time: 2713.1470s
Epoch: 3 cost time: 29.274574041366577
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.933674 --> -0.952257).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0893414
	speed: 0.2980s/iter; left time: 13527.2808s
	iters: 200, epoch: 4 | loss: 0.0475294
	speed: 0.0597s/iter; left time: 2702.7605s
	iters: 300, epoch: 4 | loss: 0.4045932
	speed: 0.0589s/iter; left time: 2663.8933s
	iters: 400, epoch: 4 | loss: 0.0084129
	speed: 0.0639s/iter; left time: 2879.9235s
Epoch: 4 cost time: 28.826732635498047
Epoch: 4, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.952257 --> -0.958546).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0801491
	speed: 0.3015s/iter; left time: 13543.8704s
	iters: 200, epoch: 5 | loss: 0.0371997
	speed: 0.0640s/iter; left time: 2869.2516s
	iters: 300, epoch: 5 | loss: 0.0125006
	speed: 0.0631s/iter; left time: 2822.7901s
	iters: 400, epoch: 5 | loss: 0.0985088
	speed: 0.0604s/iter; left time: 2697.5223s
Epoch: 5 cost time: 29.079121828079224
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
Validation loss decreased (-0.958546 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1160213
	speed: 0.3143s/iter; left time: 13970.6112s
	iters: 200, epoch: 6 | loss: 0.0133840
	speed: 0.0616s/iter; left time: 2732.7742s
	iters: 300, epoch: 6 | loss: 0.0383752
	speed: 0.0630s/iter; left time: 2789.9845s
	iters: 400, epoch: 6 | loss: 0.2869676
	speed: 0.0684s/iter; left time: 3019.1144s
Epoch: 6 cost time: 30.5480375289917
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0170664
	speed: 0.3117s/iter; left time: 13710.9586s
	iters: 200, epoch: 7 | loss: 0.3568189
	speed: 0.0635s/iter; left time: 2784.6740s
	iters: 300, epoch: 7 | loss: 0.0265796
	speed: 0.0669s/iter; left time: 2928.1227s
	iters: 400, epoch: 7 | loss: 0.0468042
	speed: 0.0658s/iter; left time: 2874.5042s
Epoch: 7 cost time: 30.008421897888184
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.960547 --> -0.966551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0443510
	speed: 0.3069s/iter; left time: 13355.5896s
	iters: 200, epoch: 8 | loss: 0.0049843
	speed: 0.0601s/iter; left time: 2610.3321s
	iters: 300, epoch: 8 | loss: 0.0114465
	speed: 0.0639s/iter; left time: 2766.3693s
	iters: 400, epoch: 8 | loss: 0.0542593
	speed: 0.0605s/iter; left time: 2613.5707s
Epoch: 8 cost time: 28.917086839675903
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
Validation loss decreased (-0.966551 --> -0.966837).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0038976
	speed: 0.3098s/iter; left time: 13334.5717s
	iters: 200, epoch: 9 | loss: 0.0031009
	speed: 0.0594s/iter; left time: 2550.2750s
	iters: 300, epoch: 9 | loss: 0.0296026
	speed: 0.0604s/iter; left time: 2588.7900s
	iters: 400, epoch: 9 | loss: 0.0160062
	speed: 0.0584s/iter; left time: 2496.5544s
Epoch: 9 cost time: 27.972352504730225
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0295946
	speed: 0.3108s/iter; left time: 13234.3375s
	iters: 200, epoch: 10 | loss: 0.0080199
	speed: 0.0530s/iter; left time: 2253.1403s
	iters: 300, epoch: 10 | loss: 0.0847898
	speed: 0.0520s/iter; left time: 2205.0266s
	iters: 400, epoch: 10 | loss: 0.0581039
	speed: 0.0603s/iter; left time: 2550.7456s
Epoch: 10 cost time: 27.23791217803955
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.966837 --> -0.976557).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1193419
	speed: 0.3074s/iter; left time: 12943.6293s
	iters: 200, epoch: 11 | loss: 0.0064392
	speed: 0.0578s/iter; left time: 2428.3291s
	iters: 300, epoch: 11 | loss: 0.2898228
	speed: 0.0625s/iter; left time: 2617.6871s
	iters: 400, epoch: 11 | loss: 0.0091362
	speed: 0.0685s/iter; left time: 2863.9488s
Epoch: 11 cost time: 29.59469199180603
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0856059
	speed: 0.3240s/iter; left time: 13491.8770s
	iters: 200, epoch: 12 | loss: 0.0048819
	speed: 0.0617s/iter; left time: 2564.1766s
	iters: 300, epoch: 12 | loss: 0.0043882
	speed: 0.0626s/iter; left time: 2595.8222s
	iters: 400, epoch: 12 | loss: 0.0500021
	speed: 0.0633s/iter; left time: 2616.1004s
Epoch: 12 cost time: 29.956616640090942
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977700).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0070774
	speed: 0.3117s/iter; left time: 12834.3347s
	iters: 200, epoch: 13 | loss: 0.0019378
	speed: 0.0539s/iter; left time: 2212.7287s
	iters: 300, epoch: 13 | loss: 0.1208647
	speed: 0.0531s/iter; left time: 2174.6136s
	iters: 400, epoch: 13 | loss: 0.0053104
	speed: 0.0610s/iter; left time: 2495.2076s
Epoch: 13 cost time: 26.981529712677002
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
Validation loss decreased (-0.977700 --> -0.978558).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0013259
	speed: 0.2975s/iter; left time: 12111.4313s
	iters: 200, epoch: 14 | loss: 0.0592432
	speed: 0.0558s/iter; left time: 2266.4342s
	iters: 300, epoch: 14 | loss: 0.0020991
	speed: 0.0569s/iter; left time: 2303.1522s
	iters: 400, epoch: 14 | loss: 0.0012403
	speed: 0.0563s/iter; left time: 2274.3069s
Epoch: 14 cost time: 27.703901767730713
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0025952
	speed: 0.3190s/iter; left time: 12835.8980s
	iters: 200, epoch: 15 | loss: 0.0207272
	speed: 0.0553s/iter; left time: 2218.6895s
	iters: 300, epoch: 15 | loss: 0.0002815
	speed: 0.0588s/iter; left time: 2352.1213s
	iters: 400, epoch: 15 | loss: 0.0093093
	speed: 0.0616s/iter; left time: 2458.5235s
Epoch: 15 cost time: 28.35138440132141
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0022284
	speed: 0.3117s/iter; left time: 12396.5264s
	iters: 200, epoch: 16 | loss: 0.0289601
	speed: 0.0583s/iter; left time: 2312.8871s
	iters: 300, epoch: 16 | loss: 0.0136960
	speed: 0.0546s/iter; left time: 2159.2515s
	iters: 400, epoch: 16 | loss: 0.0054719
	speed: 0.0557s/iter; left time: 2197.5726s
Epoch: 16 cost time: 26.839436531066895
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1632023
	speed: 0.2876s/iter; left time: 11301.3123s
	iters: 200, epoch: 17 | loss: 0.0250252
	speed: 0.0655s/iter; left time: 2568.7574s
	iters: 300, epoch: 17 | loss: 0.0164131
	speed: 0.0620s/iter; left time: 2422.8212s
	iters: 400, epoch: 17 | loss: 0.0136942
	speed: 0.0628s/iter; left time: 2447.4006s
Epoch: 17 cost time: 30.59285283088684
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979702).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0077992
	speed: 0.3260s/iter; left time: 12658.3760s
	iters: 200, epoch: 18 | loss: 0.0009745
	speed: 0.0632s/iter; left time: 2447.8607s
	iters: 300, epoch: 18 | loss: 0.0027219
	speed: 0.0704s/iter; left time: 2718.6379s
	iters: 400, epoch: 18 | loss: 0.1387724
	speed: 0.0682s/iter; left time: 2627.8457s
Epoch: 18 cost time: 31.562525272369385
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0041060
	speed: 0.3219s/iter; left time: 12346.0341s
	iters: 200, epoch: 19 | loss: 0.0044728
	speed: 0.0643s/iter; left time: 2461.0110s
	iters: 300, epoch: 19 | loss: 0.1102740
	speed: 0.0629s/iter; left time: 2401.0154s
	iters: 400, epoch: 19 | loss: 0.0033952
	speed: 0.0623s/iter; left time: 2372.9250s
Epoch: 19 cost time: 30.544424057006836
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980845).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0074184
	speed: 0.3006s/iter; left time: 11390.0200s
	iters: 200, epoch: 20 | loss: 0.0102222
	speed: 0.0613s/iter; left time: 2314.7178s
	iters: 300, epoch: 20 | loss: 0.0002272
	speed: 0.0612s/iter; left time: 2305.7680s
	iters: 400, epoch: 20 | loss: 0.0312896
	speed: 0.0605s/iter; left time: 2275.9224s
Epoch: 20 cost time: 28.77396583557129
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0172575
	speed: 0.3099s/iter; left time: 11598.2136s
	iters: 200, epoch: 21 | loss: 0.0073214
	speed: 0.0643s/iter; left time: 2398.2420s
	iters: 300, epoch: 21 | loss: 0.0233555
	speed: 0.0647s/iter; left time: 2407.4694s
	iters: 400, epoch: 21 | loss: 0.0555001
	speed: 0.0661s/iter; left time: 2455.0496s
Epoch: 21 cost time: 29.54023814201355
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0460930
	speed: 0.3092s/iter; left time: 11426.7496s
	iters: 200, epoch: 22 | loss: 0.0080189
	speed: 0.0623s/iter; left time: 2295.3430s
	iters: 300, epoch: 22 | loss: 0.0071423
	speed: 0.0616s/iter; left time: 2263.9831s
	iters: 400, epoch: 22 | loss: 0.0001788
	speed: 0.0622s/iter; left time: 2280.4647s
Epoch: 22 cost time: 29.617160320281982
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0149427
	speed: 0.3206s/iter; left time: 11698.2004s
	iters: 200, epoch: 23 | loss: 0.0394073
	speed: 0.0604s/iter; left time: 2197.7902s
	iters: 300, epoch: 23 | loss: 0.0048451
	speed: 0.0666s/iter; left time: 2416.4695s
	iters: 400, epoch: 23 | loss: 0.0651889
	speed: 0.0739s/iter; left time: 2674.7277s
Epoch: 23 cost time: 30.7658429145813
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0262682
	speed: 0.3151s/iter; left time: 11347.5075s
	iters: 200, epoch: 24 | loss: 0.1030285
	speed: 0.0659s/iter; left time: 2365.2231s
	iters: 300, epoch: 24 | loss: 0.0039081
	speed: 0.0675s/iter; left time: 2418.2805s
	iters: 400, epoch: 24 | loss: 0.0097823
	speed: 0.0600s/iter; left time: 2143.4412s
Epoch: 24 cost time: 29.74114418029785
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0034220
	speed: 0.3168s/iter; left time: 11260.0804s
	iters: 200, epoch: 25 | loss: 0.0059322
	speed: 0.0562s/iter; left time: 1992.9732s
	iters: 300, epoch: 25 | loss: 0.0010910
	speed: 0.0616s/iter; left time: 2175.8880s
	iters: 400, epoch: 25 | loss: 0.1053552
	speed: 0.0624s/iter; left time: 2199.7519s
Epoch: 25 cost time: 28.7586669921875
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0010433
	speed: 0.3175s/iter; left time: 11135.4908s
	iters: 200, epoch: 26 | loss: 0.0025349
	speed: 0.0564s/iter; left time: 1973.1449s
	iters: 300, epoch: 26 | loss: 0.0035915
	speed: 0.0562s/iter; left time: 1958.9263s
	iters: 400, epoch: 26 | loss: 0.0010068
	speed: 0.0669s/iter; left time: 2327.8414s
Epoch: 26 cost time: 28.958789587020874
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0026696
	speed: 0.3082s/iter; left time: 10664.7057s
	iters: 200, epoch: 27 | loss: 0.0013836
	speed: 0.0565s/iter; left time: 1948.7368s
	iters: 300, epoch: 27 | loss: 0.0085420
	speed: 0.0586s/iter; left time: 2016.8996s
	iters: 400, epoch: 27 | loss: 0.0030917
	speed: 0.0565s/iter; left time: 1938.8546s
Epoch: 27 cost time: 26.89636540412903
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0244325
	speed: 0.3157s/iter; left time: 10777.0388s
	iters: 200, epoch: 28 | loss: 0.0444935
	speed: 0.0628s/iter; left time: 2138.0821s
	iters: 300, epoch: 28 | loss: 0.0002577
	speed: 0.0556s/iter; left time: 1888.5809s
	iters: 400, epoch: 28 | loss: 0.0004067
	speed: 0.0600s/iter; left time: 2030.5488s
Epoch: 28 cost time: 29.361326217651367
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0332533
	speed: 0.3305s/iter; left time: 11128.6036s
	iters: 200, epoch: 29 | loss: 0.0042313
	speed: 0.0603s/iter; left time: 2025.4889s
	iters: 300, epoch: 29 | loss: 0.0180441
	speed: 0.0618s/iter; left time: 2068.8053s
	iters: 400, epoch: 29 | loss: 0.0042651
	speed: 0.0627s/iter; left time: 2091.7753s
Epoch: 29 cost time: 29.35822820663452
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 56506
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2173738
	speed: 0.0746s/iter; left time: 3491.6050s
	iters: 200, epoch: 1 | loss: 0.6093720
	speed: 0.0509s/iter; left time: 2378.4915s
	iters: 300, epoch: 1 | loss: 0.2518427
	speed: 0.0533s/iter; left time: 2482.9029s
	iters: 400, epoch: 1 | loss: 0.3747242
	speed: 0.0539s/iter; left time: 2506.0916s
Epoch: 1 cost time: 27.005662202835083
Epoch: 1, Steps: 469 | Train Loss: 0.857 Vali Loss: 0.368 Vali Acc: 0.885 Test Loss: 0.368 Test Acc: 0.885
Validation loss decreased (inf --> -0.885359).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3208797
	speed: 0.2863s/iter; left time: 13266.9166s
	iters: 200, epoch: 2 | loss: 0.3313245
	speed: 0.0548s/iter; left time: 2533.9392s
	iters: 300, epoch: 2 | loss: 0.2419135
	speed: 0.0545s/iter; left time: 2513.3021s
	iters: 400, epoch: 2 | loss: 0.1498195
	speed: 0.0552s/iter; left time: 2540.8598s
Epoch: 2 cost time: 25.777165412902832
Epoch: 2, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
Validation loss decreased (-0.885359 --> -0.938820).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0650838
	speed: 0.3031s/iter; left time: 13902.1228s
	iters: 200, epoch: 3 | loss: 0.5308331
	speed: 0.0584s/iter; left time: 2670.2959s
	iters: 300, epoch: 3 | loss: 0.0647704
	speed: 0.0546s/iter; left time: 2493.4738s
	iters: 400, epoch: 3 | loss: 0.0408839
	speed: 0.0545s/iter; left time: 2482.4794s
Epoch: 3 cost time: 26.952506065368652
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.938820 --> -0.955973).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0504588
	speed: 0.3015s/iter; left time: 13686.8561s
	iters: 200, epoch: 4 | loss: 0.0446079
	speed: 0.0564s/iter; left time: 2553.9285s
	iters: 300, epoch: 4 | loss: 0.2687282
	speed: 0.0609s/iter; left time: 2753.2311s
	iters: 400, epoch: 4 | loss: 0.0108519
	speed: 0.0564s/iter; left time: 2544.7266s
Epoch: 4 cost time: 27.404643058776855
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
Validation loss decreased (-0.955973 --> -0.957403).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0621361
	speed: 0.3003s/iter; left time: 13489.9692s
	iters: 200, epoch: 5 | loss: 0.0170737
	speed: 0.0589s/iter; left time: 2638.9938s
	iters: 300, epoch: 5 | loss: 0.0046203
	speed: 0.0594s/iter; left time: 2657.5958s
	iters: 400, epoch: 5 | loss: 0.0282431
	speed: 0.0537s/iter; left time: 2395.6082s
Epoch: 5 cost time: 27.265480995178223
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
Validation loss decreased (-0.957403 --> -0.958546).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0654841
	speed: 0.3044s/iter; left time: 13530.3423s
	iters: 200, epoch: 6 | loss: 0.0111298
	speed: 0.0594s/iter; left time: 2634.1020s
	iters: 300, epoch: 6 | loss: 0.0374139
	speed: 0.0598s/iter; left time: 2645.0231s
	iters: 400, epoch: 6 | loss: 0.3495576
	speed: 0.0606s/iter; left time: 2674.3150s
Epoch: 6 cost time: 28.24004864692688
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.958546 --> -0.959118).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0066738
	speed: 0.3093s/iter; left time: 13607.0166s
	iters: 200, epoch: 7 | loss: 0.1914587
	speed: 0.0585s/iter; left time: 2567.4375s
	iters: 300, epoch: 7 | loss: 0.0094524
	speed: 0.0556s/iter; left time: 2433.1963s
	iters: 400, epoch: 7 | loss: 0.1194595
	speed: 0.0627s/iter; left time: 2740.4288s
Epoch: 7 cost time: 28.08327317237854
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.959118 --> -0.963978).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0749514
	speed: 0.2907s/iter; left time: 12648.7373s
	iters: 200, epoch: 8 | loss: 0.0057604
	speed: 0.0536s/iter; left time: 2328.2310s
	iters: 300, epoch: 8 | loss: 0.0588441
	speed: 0.0593s/iter; left time: 2569.2528s
	iters: 400, epoch: 8 | loss: 0.0309858
	speed: 0.0568s/iter; left time: 2453.7523s
Epoch: 8 cost time: 26.92620301246643
Epoch: 8, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.963978 --> -0.965121).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0062656
	speed: 0.2826s/iter; left time: 12167.4290s
	iters: 200, epoch: 9 | loss: 0.0080043
	speed: 0.0598s/iter; left time: 2566.5544s
	iters: 300, epoch: 9 | loss: 0.0026232
	speed: 0.0570s/iter; left time: 2441.1948s
	iters: 400, epoch: 9 | loss: 0.0113408
	speed: 0.0581s/iter; left time: 2482.7397s
Epoch: 9 cost time: 27.561938285827637
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.965121 --> -0.969981).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0185422
	speed: 0.3009s/iter; left time: 12813.6941s
	iters: 200, epoch: 10 | loss: 0.0093478
	speed: 0.0589s/iter; left time: 2500.4305s
	iters: 300, epoch: 10 | loss: 0.1152111
	speed: 0.0587s/iter; left time: 2486.3636s
	iters: 400, epoch: 10 | loss: 0.0064727
	speed: 0.0562s/iter; left time: 2376.6917s
Epoch: 10 cost time: 27.32493567466736
Epoch: 10, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.969981 --> -0.970839).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1763427
	speed: 0.3029s/iter; left time: 12753.8337s
	iters: 200, epoch: 11 | loss: 0.0056640
	speed: 0.0532s/iter; left time: 2235.4068s
	iters: 300, epoch: 11 | loss: 0.2160341
	speed: 0.0584s/iter; left time: 2448.5818s
	iters: 400, epoch: 11 | loss: 0.0035306
	speed: 0.0619s/iter; left time: 2587.5127s
Epoch: 11 cost time: 27.6694655418396
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0912662
	speed: 0.2954s/iter; left time: 12302.0111s
	iters: 200, epoch: 12 | loss: 0.0023302
	speed: 0.0543s/iter; left time: 2254.5423s
	iters: 300, epoch: 12 | loss: 0.0151052
	speed: 0.0572s/iter; left time: 2370.5890s
	iters: 400, epoch: 12 | loss: 0.2197597
	speed: 0.0507s/iter; left time: 2094.0349s
Epoch: 12 cost time: 25.82476258277893
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0234569
	speed: 0.3496s/iter; left time: 14392.2622s
	iters: 200, epoch: 13 | loss: 0.0022430
	speed: 0.0422s/iter; left time: 1733.5867s
	iters: 300, epoch: 13 | loss: 0.0754252
	speed: 0.0389s/iter; left time: 1595.0766s
	iters: 400, epoch: 13 | loss: 0.0019405
	speed: 0.0369s/iter; left time: 1509.8397s
Epoch: 13 cost time: 19.703420400619507
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0010274
	speed: 0.3172s/iter; left time: 12910.6428s
	iters: 200, epoch: 14 | loss: 0.0393561
	speed: 0.0618s/iter; left time: 2510.3132s
	iters: 300, epoch: 14 | loss: 0.0019825
	speed: 0.0533s/iter; left time: 2158.8243s
	iters: 400, epoch: 14 | loss: 0.0030213
	speed: 0.0539s/iter; left time: 2179.3386s
Epoch: 14 cost time: 28.24110436439514
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.970839 --> -0.975699).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0032121
	speed: 0.3444s/iter; left time: 13858.6689s
	iters: 200, epoch: 15 | loss: 0.0264186
	speed: 0.0583s/iter; left time: 2338.2860s
	iters: 300, epoch: 15 | loss: 0.0002267
	speed: 0.0590s/iter; left time: 2361.2790s
	iters: 400, epoch: 15 | loss: 0.0027432
	speed: 0.0622s/iter; left time: 2485.3475s
Epoch: 15 cost time: 28.87479567527771
Epoch: 15, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0028504
	speed: 0.3357s/iter; left time: 13348.1365s
	iters: 200, epoch: 16 | loss: 0.0235115
	speed: 0.0698s/iter; left time: 2768.2161s
	iters: 300, epoch: 16 | loss: 0.0135098
	speed: 0.0608s/iter; left time: 2403.9533s
	iters: 400, epoch: 16 | loss: 0.0040518
	speed: 0.0600s/iter; left time: 2369.4625s
Epoch: 16 cost time: 30.039291858673096
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0115652
	speed: 0.3461s/iter; left time: 13600.7227s
	iters: 200, epoch: 17 | loss: 0.0124717
	speed: 0.0548s/iter; left time: 2146.8271s
	iters: 300, epoch: 17 | loss: 0.0252743
	speed: 0.0564s/iter; left time: 2206.7261s
	iters: 400, epoch: 17 | loss: 0.0027597
	speed: 0.0629s/iter; left time: 2454.5012s
Epoch: 17 cost time: 28.480749130249023
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0004536
	speed: 0.3255s/iter; left time: 12639.6825s
	iters: 200, epoch: 18 | loss: 0.0002374
	speed: 0.0652s/iter; left time: 2526.7737s
	iters: 300, epoch: 18 | loss: 0.0037458
	speed: 0.0616s/iter; left time: 2380.2027s
	iters: 400, epoch: 18 | loss: 0.0903903
	speed: 0.0607s/iter; left time: 2338.0144s
Epoch: 18 cost time: 29.258134126663208
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0134619
	speed: 0.3274s/iter; left time: 12559.2702s
	iters: 200, epoch: 19 | loss: 0.0008250
	speed: 0.0647s/iter; left time: 2476.9931s
	iters: 300, epoch: 19 | loss: 0.0125917
	speed: 0.0562s/iter; left time: 2144.5315s
	iters: 400, epoch: 19 | loss: 0.0119705
	speed: 0.0509s/iter; left time: 1937.6041s
Epoch: 19 cost time: 27.631574630737305
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0099559
	speed: 0.3228s/iter; left time: 12230.7359s
	iters: 200, epoch: 20 | loss: 0.0094554
	speed: 0.0558s/iter; left time: 2107.6685s
	iters: 300, epoch: 20 | loss: 0.0094640
	speed: 0.0610s/iter; left time: 2298.7423s
	iters: 400, epoch: 20 | loss: 0.0171719
	speed: 0.0567s/iter; left time: 2131.7806s
Epoch: 20 cost time: 27.491397619247437
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0035734
	speed: 0.3050s/iter; left time: 11412.5723s
	iters: 200, epoch: 21 | loss: 0.0032577
	speed: 0.0619s/iter; left time: 2309.1163s
	iters: 300, epoch: 21 | loss: 0.0012819
	speed: 0.0622s/iter; left time: 2313.6811s
	iters: 400, epoch: 21 | loss: 0.0078013
	speed: 0.0605s/iter; left time: 2245.1246s
Epoch: 21 cost time: 28.797593116760254
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979130).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0196476
	speed: 0.3084s/iter; left time: 11394.3459s
	iters: 200, epoch: 22 | loss: 0.0749400
	speed: 0.0650s/iter; left time: 2397.0830s
	iters: 300, epoch: 22 | loss: 0.0072248
	speed: 0.0632s/iter; left time: 2321.8051s
	iters: 400, epoch: 22 | loss: 0.0046771
	speed: 0.0584s/iter; left time: 2140.7730s
Epoch: 22 cost time: 29.99402403831482
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0011688
	speed: 0.3360s/iter; left time: 12256.6410s
	iters: 200, epoch: 23 | loss: 0.0552489
	speed: 0.0532s/iter; left time: 1935.0316s
	iters: 300, epoch: 23 | loss: 0.0012809
	speed: 0.0640s/iter; left time: 2323.0623s
	iters: 400, epoch: 23 | loss: 0.0040582
	speed: 0.0663s/iter; left time: 2400.4062s
Epoch: 23 cost time: 30.13411235809326
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0468932
	speed: 0.3142s/iter; left time: 11315.7667s
	iters: 200, epoch: 24 | loss: 0.0024896
	speed: 0.0637s/iter; left time: 2287.1741s
	iters: 300, epoch: 24 | loss: 0.0015678
	speed: 0.0638s/iter; left time: 2285.2286s
	iters: 400, epoch: 24 | loss: 0.0193207
	speed: 0.0637s/iter; left time: 2274.3455s
Epoch: 24 cost time: 29.54857110977173
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0064779
	speed: 0.3139s/iter; left time: 11158.3505s
	iters: 200, epoch: 25 | loss: 0.0116611
	speed: 0.0615s/iter; left time: 2178.3565s
	iters: 300, epoch: 25 | loss: 0.0158203
	speed: 0.0643s/iter; left time: 2273.5923s
	iters: 400, epoch: 25 | loss: 0.0507409
	speed: 0.0631s/iter; left time: 2223.0931s
Epoch: 25 cost time: 29.4836208820343
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0016617
	speed: 0.3083s/iter; left time: 10813.5698s
	iters: 200, epoch: 26 | loss: 0.0033002
	speed: 0.0607s/iter; left time: 2124.1807s
	iters: 300, epoch: 26 | loss: 0.0003840
	speed: 0.0653s/iter; left time: 2277.2652s
	iters: 400, epoch: 26 | loss: 0.0008117
	speed: 0.0562s/iter; left time: 1955.7105s
Epoch: 26 cost time: 28.700352430343628
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0014818
	speed: 0.3130s/iter; left time: 10833.6411s
	iters: 200, epoch: 27 | loss: 0.0002993
	speed: 0.0518s/iter; left time: 1787.8096s
	iters: 300, epoch: 27 | loss: 0.0048991
	speed: 0.0520s/iter; left time: 1788.5662s
	iters: 400, epoch: 27 | loss: 0.0007194
	speed: 0.0597s/iter; left time: 2048.4114s
Epoch: 27 cost time: 27.01205849647522
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0052961
	speed: 0.3372s/iter; left time: 11510.1844s
	iters: 200, epoch: 28 | loss: 0.0011660
	speed: 0.0569s/iter; left time: 1935.5005s
	iters: 300, epoch: 28 | loss: 0.0017682
	speed: 0.0607s/iter; left time: 2059.0795s
	iters: 400, epoch: 28 | loss: 0.0005282
	speed: 0.0626s/iter; left time: 2119.9396s
Epoch: 28 cost time: 28.520461797714233
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0014954
	speed: 0.3285s/iter; left time: 11058.6155s
	iters: 200, epoch: 29 | loss: 0.0010560
	speed: 0.0605s/iter; left time: 2030.9113s
	iters: 300, epoch: 29 | loss: 0.0704069
	speed: 0.0626s/iter; left time: 2094.9316s
	iters: 400, epoch: 29 | loss: 0.0129560
	speed: 0.0568s/iter; left time: 1894.7302s
Epoch: 29 cost time: 28.128907680511475
Epoch: 29, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.1098805
	speed: 0.3225s/iter; left time: 10708.5839s
	iters: 200, epoch: 30 | loss: 0.0323885
	speed: 0.0540s/iter; left time: 1788.2328s
	iters: 300, epoch: 30 | loss: 0.0028311
	speed: 0.0491s/iter; left time: 1620.9754s
	iters: 400, epoch: 30 | loss: 0.0019874
	speed: 0.0560s/iter; left time: 1843.2549s
Epoch: 30 cost time: 26.608375310897827
Epoch: 30, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0000342
	speed: 0.3283s/iter; left time: 10746.5268s
	iters: 200, epoch: 31 | loss: 0.0277193
	speed: 0.0566s/iter; left time: 1846.7316s
	iters: 300, epoch: 31 | loss: 0.0002962
	speed: 0.0536s/iter; left time: 1745.1741s
	iters: 400, epoch: 31 | loss: 0.0134265
	speed: 0.0549s/iter; left time: 1779.4502s
Epoch: 31 cost time: 26.923317432403564
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0005295
	speed: 0.3073s/iter; left time: 9913.7849s
	iters: 200, epoch: 32 | loss: 0.0005910
	speed: 0.0599s/iter; left time: 1925.1017s
	iters: 300, epoch: 32 | loss: 0.0010528
	speed: 0.0599s/iter; left time: 1920.6275s
	iters: 400, epoch: 32 | loss: 0.0115908
	speed: 0.0570s/iter; left time: 1822.1243s
Epoch: 32 cost time: 27.7268385887146
Epoch: 32, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0292236
	speed: 0.2963s/iter; left time: 9419.4891s
	iters: 200, epoch: 33 | loss: 0.0853085
	speed: 0.0618s/iter; left time: 1960.1677s
	iters: 300, epoch: 33 | loss: 0.0001682
	speed: 0.0664s/iter; left time: 2098.3630s
	iters: 400, epoch: 33 | loss: 0.0001156
	speed: 0.0637s/iter; left time: 2004.6721s
Epoch: 33 cost time: 29.419296264648438
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0049268
	speed: 0.3095s/iter; left time: 9694.3810s
	iters: 200, epoch: 34 | loss: 0.0004725
	speed: 0.0675s/iter; left time: 2107.7578s
	iters: 300, epoch: 34 | loss: 0.0157964
	speed: 0.0650s/iter; left time: 2022.8030s
	iters: 400, epoch: 34 | loss: 0.0068141
	speed: 0.0526s/iter; left time: 1632.8459s
Epoch: 34 cost time: 29.504215240478516
Epoch: 34, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.3250597
	speed: 0.3162s/iter; left time: 9756.5497s
	iters: 200, epoch: 35 | loss: 0.0061347
	speed: 0.0546s/iter; left time: 1678.8493s
	iters: 300, epoch: 35 | loss: 0.0009207
	speed: 0.0588s/iter; left time: 1802.0444s
	iters: 400, epoch: 35 | loss: 0.0014135
	speed: 0.0612s/iter; left time: 1869.0304s
Epoch: 35 cost time: 27.937124729156494
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0001192
	speed: 0.3008s/iter; left time: 9140.3954s
	iters: 200, epoch: 36 | loss: 0.0000813
	speed: 0.0611s/iter; left time: 1851.7339s
	iters: 300, epoch: 36 | loss: 0.0512180
	speed: 0.0597s/iter; left time: 1803.0623s
	iters: 400, epoch: 36 | loss: 0.5633311
	speed: 0.0556s/iter; left time: 1671.6625s
Epoch: 36 cost time: 28.34685778617859
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0018546
	speed: 0.2988s/iter; left time: 8938.5538s
	iters: 200, epoch: 37 | loss: 0.0763713
	speed: 0.0571s/iter; left time: 1702.9659s
	iters: 300, epoch: 37 | loss: 0.0013390
	speed: 0.0630s/iter; left time: 1870.7220s
	iters: 400, epoch: 37 | loss: 0.0000694
	speed: 0.0552s/iter; left time: 1635.4236s
Epoch: 37 cost time: 27.394108057022095
Epoch: 37, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0144532
	speed: 0.3109s/iter; left time: 9154.6019s
	iters: 200, epoch: 38 | loss: 0.0004164
	speed: 0.0593s/iter; left time: 1739.7165s
	iters: 300, epoch: 38 | loss: 0.0056404
	speed: 0.0574s/iter; left time: 1678.5927s
	iters: 400, epoch: 38 | loss: 0.0053653
	speed: 0.0566s/iter; left time: 1649.4923s
Epoch: 38 cost time: 27.968178272247314
Epoch: 38, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.1195511
	speed: 0.3107s/iter; left time: 9002.7361s
	iters: 200, epoch: 39 | loss: 0.0009076
	speed: 0.0530s/iter; left time: 1531.2166s
	iters: 300, epoch: 39 | loss: 0.0181116
	speed: 0.0575s/iter; left time: 1655.5414s
	iters: 400, epoch: 39 | loss: 0.0420806
	speed: 0.0505s/iter; left time: 1448.3297s
Epoch: 39 cost time: 25.16311287879944
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0635224
	speed: 0.3065s/iter; left time: 8739.1128s
	iters: 200, epoch: 40 | loss: 0.0007639
	speed: 0.0664s/iter; left time: 1885.8197s
	iters: 300, epoch: 40 | loss: 0.1939684
	speed: 0.0644s/iter; left time: 1824.0187s
	iters: 400, epoch: 40 | loss: 0.0256854
	speed: 0.0610s/iter; left time: 1720.8246s
Epoch: 40 cost time: 29.67188835144043
Epoch: 40, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0002754
	speed: 0.3144s/iter; left time: 8816.3321s
	iters: 200, epoch: 41 | loss: 0.0255519
	speed: 0.0567s/iter; left time: 1584.7800s
	iters: 300, epoch: 41 | loss: 0.1909111
	speed: 0.0555s/iter; left time: 1545.8869s
	iters: 400, epoch: 41 | loss: 0.0591350
	speed: 0.0561s/iter; left time: 1555.7650s
Epoch: 41 cost time: 27.734357595443726
Epoch: 41, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982561).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0000965
	speed: 0.3119s/iter; left time: 8600.8611s
	iters: 200, epoch: 42 | loss: 0.0010036
	speed: 0.0599s/iter; left time: 1646.7494s
	iters: 300, epoch: 42 | loss: 0.0047351
	speed: 0.0623s/iter; left time: 1704.9255s
	iters: 400, epoch: 42 | loss: 0.0070836
	speed: 0.0602s/iter; left time: 1643.0800s
Epoch: 42 cost time: 28.734087467193604
Epoch: 42, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 43 | loss: 0.0000418
	speed: 0.3169s/iter; left time: 8588.8349s
	iters: 200, epoch: 43 | loss: 0.0008876
	speed: 0.0651s/iter; left time: 1756.6060s
	iters: 300, epoch: 43 | loss: 0.0015966
	speed: 0.0584s/iter; left time: 1571.4928s
	iters: 400, epoch: 43 | loss: 0.0258770
	speed: 0.0522s/iter; left time: 1398.9053s
Epoch: 43 cost time: 28.17867159843445
Epoch: 43, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 44 | loss: 0.0150657
	speed: 0.3243s/iter; left time: 8636.2637s
	iters: 200, epoch: 44 | loss: 0.0060004
	speed: 0.0623s/iter; left time: 1654.2170s
	iters: 300, epoch: 44 | loss: 0.0009893
	speed: 0.0586s/iter; left time: 1548.0251s
	iters: 400, epoch: 44 | loss: 0.0170163
	speed: 0.0573s/iter; left time: 1509.5177s
Epoch: 44 cost time: 28.770308256149292
Epoch: 44, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 45 | loss: 0.0003527
	speed: 0.3183s/iter; left time: 8327.8966s
	iters: 200, epoch: 45 | loss: 0.0004548
	speed: 0.0602s/iter; left time: 1567.9307s
	iters: 300, epoch: 45 | loss: 0.0001478
	speed: 0.0648s/iter; left time: 1683.5722s
	iters: 400, epoch: 45 | loss: 0.0206376
	speed: 0.0624s/iter; left time: 1614.8512s
Epoch: 45 cost time: 29.205673456192017
Epoch: 45, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 46 | loss: 0.0138631
	speed: 0.3241s/iter; left time: 8328.5813s
	iters: 200, epoch: 46 | loss: 0.1175618
	speed: 0.0641s/iter; left time: 1640.9430s
	iters: 300, epoch: 46 | loss: 0.0214996
	speed: 0.0592s/iter; left time: 1508.8355s
	iters: 400, epoch: 46 | loss: 0.0001290
	speed: 0.0606s/iter; left time: 1539.6942s
Epoch: 46 cost time: 29.62197971343994
Epoch: 46, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 47 | loss: 0.0002108
	speed: 0.3125s/iter; left time: 7883.8967s
	iters: 200, epoch: 47 | loss: 0.0002637
	speed: 0.0596s/iter; left time: 1497.9170s
	iters: 300, epoch: 47 | loss: 0.0011300
	speed: 0.0624s/iter; left time: 1562.8868s
	iters: 400, epoch: 47 | loss: 0.0302998
	speed: 0.0622s/iter; left time: 1551.2961s
Epoch: 47 cost time: 28.406448364257812
Epoch: 47, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
Validation loss decreased (-0.982561 --> -0.984847).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0001651
	speed: 0.3149s/iter; left time: 7795.1788s
	iters: 200, epoch: 48 | loss: 0.0008259
	speed: 0.0541s/iter; left time: 1333.6316s
	iters: 300, epoch: 48 | loss: 0.0015577
	speed: 0.0509s/iter; left time: 1249.6652s
	iters: 400, epoch: 48 | loss: 0.0005921
	speed: 0.0599s/iter; left time: 1466.0847s
Epoch: 48 cost time: 26.87062907218933
Epoch: 48, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 49 | loss: 0.0000590
	speed: 0.3169s/iter; left time: 7697.0949s
	iters: 200, epoch: 49 | loss: 0.0003473
	speed: 0.0587s/iter; left time: 1420.8062s
	iters: 300, epoch: 49 | loss: 0.0003995
	speed: 0.0548s/iter; left time: 1320.9777s
	iters: 400, epoch: 49 | loss: 0.1358378
	speed: 0.0585s/iter; left time: 1402.6044s
Epoch: 49 cost time: 27.44559383392334
Epoch: 49, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 50 | loss: 0.0003771
	speed: 0.3192s/iter; left time: 7602.9620s
	iters: 200, epoch: 50 | loss: 0.0021302
	speed: 0.0561s/iter; left time: 1330.9753s
	iters: 300, epoch: 50 | loss: 0.0013611
	speed: 0.0524s/iter; left time: 1237.2823s
	iters: 400, epoch: 50 | loss: 0.0003739
	speed: 0.0577s/iter; left time: 1356.6277s
Epoch: 50 cost time: 27.49000334739685
Epoch: 50, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 51 | loss: 0.0024575
	speed: 0.3352s/iter; left time: 7826.5768s
	iters: 200, epoch: 51 | loss: 0.0001379
	speed: 0.0625s/iter; left time: 1454.0353s
	iters: 300, epoch: 51 | loss: 0.0001341
	speed: 0.0612s/iter; left time: 1416.5016s
	iters: 400, epoch: 51 | loss: 0.0021234
	speed: 0.0595s/iter; left time: 1371.3488s
Epoch: 51 cost time: 29.258320808410645
Epoch: 51, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 52 | loss: 0.0051037
	speed: 0.3258s/iter; left time: 7455.2120s
	iters: 200, epoch: 52 | loss: 0.0004952
	speed: 0.0615s/iter; left time: 1400.3467s
	iters: 300, epoch: 52 | loss: 0.0006152
	speed: 0.0590s/iter; left time: 1339.1286s
	iters: 400, epoch: 52 | loss: 0.0001808
	speed: 0.0582s/iter; left time: 1313.3458s
Epoch: 52 cost time: 28.46023678779602
Epoch: 52, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 53 | loss: 0.0120035
	speed: 0.3229s/iter; left time: 7236.9641s
	iters: 200, epoch: 53 | loss: 0.0001173
	speed: 0.0575s/iter; left time: 1283.8247s
	iters: 300, epoch: 53 | loss: 0.0001315
	speed: 0.0566s/iter; left time: 1257.7452s
	iters: 400, epoch: 53 | loss: 0.0088170
	speed: 0.0599s/iter; left time: 1325.2337s
Epoch: 53 cost time: 28.034213542938232
Epoch: 53, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 54 | loss: 0.0000991
	speed: 0.3106s/iter; left time: 6816.5224s
	iters: 200, epoch: 54 | loss: 0.0041652
	speed: 0.0629s/iter; left time: 1374.3189s
	iters: 300, epoch: 54 | loss: 0.0076733
	speed: 0.0610s/iter; left time: 1326.8627s
	iters: 400, epoch: 54 | loss: 0.0004309
	speed: 0.0514s/iter; left time: 1113.3728s
Epoch: 54 cost time: 27.560983896255493
Epoch: 54, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 55 | loss: 0.0275981
	speed: 0.3140s/iter; left time: 6743.9866s
	iters: 200, epoch: 55 | loss: 0.0234134
	speed: 0.0592s/iter; left time: 1265.2849s
	iters: 300, epoch: 55 | loss: 0.0003103
	speed: 0.0576s/iter; left time: 1224.7547s
	iters: 400, epoch: 55 | loss: 0.0007025
	speed: 0.0581s/iter; left time: 1229.6625s
Epoch: 55 cost time: 28.168374061584473
Epoch: 55, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 56 | loss: 0.0000919
	speed: 0.3086s/iter; left time: 6482.4022s
	iters: 200, epoch: 56 | loss: 0.0048516
	speed: 0.0638s/iter; left time: 1333.9004s
	iters: 300, epoch: 56 | loss: 0.0075745
	speed: 0.0624s/iter; left time: 1298.7754s
	iters: 400, epoch: 56 | loss: 0.0004355
	speed: 0.0624s/iter; left time: 1291.0876s
Epoch: 56 cost time: 29.287776947021484
Epoch: 56, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 57 | loss: 0.0044422
	speed: 0.3192s/iter; left time: 6556.0366s
	iters: 200, epoch: 57 | loss: 0.0046882
	speed: 0.0625s/iter; left time: 1276.6731s
	iters: 300, epoch: 57 | loss: 0.0049432
	speed: 0.0657s/iter; left time: 1336.2338s
	iters: 400, epoch: 57 | loss: 0.0066945
	speed: 0.0630s/iter; left time: 1275.0373s
Epoch: 57 cost time: 29.866167783737183
Epoch: 57, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9848484848484849
model parameter : 56506
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3143158
	speed: 0.0775s/iter; left time: 3625.6105s
	iters: 200, epoch: 1 | loss: 0.6658694
	speed: 0.0583s/iter; left time: 2720.5462s
	iters: 300, epoch: 1 | loss: 0.2490511
	speed: 0.0531s/iter; left time: 2474.5945s
	iters: 400, epoch: 1 | loss: 0.4370357
	speed: 0.0536s/iter; left time: 2491.0533s
Epoch: 1 cost time: 28.204225540161133
Epoch: 1, Steps: 469 | Train Loss: 0.867 Vali Loss: 0.320 Vali Acc: 0.903 Test Loss: 0.320 Test Acc: 0.903
Validation loss decreased (inf --> -0.902798).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3455673
	speed: 0.3074s/iter; left time: 14243.7155s
	iters: 200, epoch: 2 | loss: 0.2409261
	speed: 0.0591s/iter; left time: 2730.9239s
	iters: 300, epoch: 2 | loss: 0.2778125
	speed: 0.0585s/iter; left time: 2699.1750s
	iters: 400, epoch: 2 | loss: 0.1142483
	speed: 0.0542s/iter; left time: 2495.6028s
Epoch: 2 cost time: 27.051930904388428
Epoch: 2, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.902798 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0386944
	speed: 0.3000s/iter; left time: 13758.7273s
	iters: 200, epoch: 3 | loss: 0.2611812
	speed: 0.0567s/iter; left time: 2592.5317s
	iters: 300, epoch: 3 | loss: 0.0765137
	speed: 0.0600s/iter; left time: 2741.8610s
	iters: 400, epoch: 3 | loss: 0.0209172
	speed: 0.0586s/iter; left time: 2670.8893s
Epoch: 3 cost time: 27.47980308532715
Epoch: 3, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.948826 --> -0.956545).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1645397
	speed: 0.2927s/iter; left time: 13287.2142s
	iters: 200, epoch: 4 | loss: 0.0377504
	speed: 0.0575s/iter; left time: 2603.8658s
	iters: 300, epoch: 4 | loss: 0.1427408
	speed: 0.0569s/iter; left time: 2571.6070s
	iters: 400, epoch: 4 | loss: 0.0188823
	speed: 0.0590s/iter; left time: 2661.3373s
Epoch: 4 cost time: 28.05014991760254
Epoch: 4, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.956545 --> -0.966837).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0409487
	speed: 0.3088s/iter; left time: 13871.3778s
	iters: 200, epoch: 5 | loss: 0.0244983
	speed: 0.0618s/iter; left time: 2768.5595s
	iters: 300, epoch: 5 | loss: 0.0096135
	speed: 0.0594s/iter; left time: 2658.6765s
	iters: 400, epoch: 5 | loss: 0.0366126
	speed: 0.0602s/iter; left time: 2686.0989s
Epoch: 5 cost time: 28.64246392250061
Epoch: 5, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
Validation loss decreased (-0.966837 --> -0.968266).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0514807
	speed: 0.2988s/iter; left time: 13281.5260s
	iters: 200, epoch: 6 | loss: 0.0136871
	speed: 0.0607s/iter; left time: 2692.9130s
	iters: 300, epoch: 6 | loss: 0.0290837
	speed: 0.0609s/iter; left time: 2697.3828s
	iters: 400, epoch: 6 | loss: 0.3591686
	speed: 0.0597s/iter; left time: 2634.3570s
Epoch: 6 cost time: 28.140315055847168
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0061048
	speed: 0.2985s/iter; left time: 13132.2093s
	iters: 200, epoch: 7 | loss: 0.0416221
	speed: 0.0525s/iter; left time: 2303.8445s
	iters: 300, epoch: 7 | loss: 0.0132730
	speed: 0.0541s/iter; left time: 2367.1432s
	iters: 400, epoch: 7 | loss: 0.0241577
	speed: 0.0611s/iter; left time: 2670.3336s
Epoch: 7 cost time: 26.210150241851807
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.968266 --> -0.973126).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0207114
	speed: 0.3055s/iter; left time: 13295.6342s
	iters: 200, epoch: 8 | loss: 0.0042484
	speed: 0.0524s/iter; left time: 2274.2257s
	iters: 300, epoch: 8 | loss: 0.0083173
	speed: 0.0529s/iter; left time: 2292.2691s
	iters: 400, epoch: 8 | loss: 0.0100884
	speed: 0.0558s/iter; left time: 2412.3201s
Epoch: 8 cost time: 25.80349326133728
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0032905
	speed: 0.3058s/iter; left time: 13164.6189s
	iters: 200, epoch: 9 | loss: 0.0058686
	speed: 0.0535s/iter; left time: 2297.0323s
	iters: 300, epoch: 9 | loss: 0.0032090
	speed: 0.0538s/iter; left time: 2303.9084s
	iters: 400, epoch: 9 | loss: 0.0248689
	speed: 0.0567s/iter; left time: 2422.3924s
Epoch: 9 cost time: 26.449959993362427
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973126 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0089213
	speed: 0.3177s/iter; left time: 13529.1840s
	iters: 200, epoch: 10 | loss: 0.0051653
	speed: 0.0599s/iter; left time: 2543.9323s
	iters: 300, epoch: 10 | loss: 0.1157002
	speed: 0.0542s/iter; left time: 2295.2663s
	iters: 400, epoch: 10 | loss: 0.0238850
	speed: 0.0561s/iter; left time: 2372.4270s
Epoch: 10 cost time: 27.174622297286987
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.973126 --> -0.975699).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0254845
	speed: 0.3182s/iter; left time: 13398.0768s
	iters: 200, epoch: 11 | loss: 0.0104766
	speed: 0.0607s/iter; left time: 2549.4644s
	iters: 300, epoch: 11 | loss: 0.1742039
	speed: 0.0599s/iter; left time: 2508.7404s
	iters: 400, epoch: 11 | loss: 0.0425016
	speed: 0.0546s/iter; left time: 2284.0903s
Epoch: 11 cost time: 27.940306663513184
Epoch: 11, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0058879
	speed: 0.3232s/iter; left time: 13460.3840s
	iters: 200, epoch: 12 | loss: 0.0021804
	speed: 0.0696s/iter; left time: 2889.8874s
	iters: 300, epoch: 12 | loss: 0.0007611
	speed: 0.0548s/iter; left time: 2269.7097s
	iters: 400, epoch: 12 | loss: 0.0935997
	speed: 0.0401s/iter; left time: 1655.7647s
Epoch: 12 cost time: 26.494542121887207
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0082361
	speed: 0.2266s/iter; left time: 9330.9882s
	iters: 200, epoch: 13 | loss: 0.0005790
	speed: 0.0481s/iter; left time: 1976.1835s
	iters: 300, epoch: 13 | loss: 0.0321610
	speed: 0.0479s/iter; left time: 1961.3529s
	iters: 400, epoch: 13 | loss: 0.0690812
	speed: 0.0563s/iter; left time: 2299.4337s
Epoch: 13 cost time: 24.84890103340149
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977986).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0010857
	speed: 0.3071s/iter; left time: 12500.9469s
	iters: 200, epoch: 14 | loss: 0.0396341
	speed: 0.0535s/iter; left time: 2170.6164s
	iters: 300, epoch: 14 | loss: 0.0009737
	speed: 0.0548s/iter; left time: 2220.5971s
	iters: 400, epoch: 14 | loss: 0.0030878
	speed: 0.0549s/iter; left time: 2218.4237s
Epoch: 14 cost time: 26.225719928741455
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0006029
	speed: 0.3034s/iter; left time: 12205.6907s
	iters: 200, epoch: 15 | loss: 0.0065695
	speed: 0.0518s/iter; left time: 2078.6931s
	iters: 300, epoch: 15 | loss: 0.0001160
	speed: 0.0538s/iter; left time: 2153.7353s
	iters: 400, epoch: 15 | loss: 0.0139793
	speed: 0.0547s/iter; left time: 2186.3068s
Epoch: 15 cost time: 26.23901104927063
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0029027
	speed: 0.3042s/iter; left time: 12096.9090s
	iters: 200, epoch: 16 | loss: 0.0027355
	speed: 0.0583s/iter; left time: 2312.6780s
	iters: 300, epoch: 16 | loss: 0.0061742
	speed: 0.0550s/iter; left time: 2176.5402s
	iters: 400, epoch: 16 | loss: 0.0016518
	speed: 0.0530s/iter; left time: 2092.7573s
Epoch: 16 cost time: 26.84140944480896
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0119794
	speed: 0.3056s/iter; left time: 12009.5408s
	iters: 200, epoch: 17 | loss: 0.0019327
	speed: 0.0561s/iter; left time: 2198.2521s
	iters: 300, epoch: 17 | loss: 0.0088890
	speed: 0.0550s/iter; left time: 2148.9930s
	iters: 400, epoch: 17 | loss: 0.0057382
	speed: 0.0556s/iter; left time: 2166.3560s
Epoch: 17 cost time: 26.488438367843628
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0007831
	speed: 0.3086s/iter; left time: 11981.5713s
	iters: 200, epoch: 18 | loss: 0.0007756
	speed: 0.0563s/iter; left time: 2182.2458s
	iters: 300, epoch: 18 | loss: 0.0047455
	speed: 0.0550s/iter; left time: 2122.9667s
	iters: 400, epoch: 18 | loss: 0.3490351
	speed: 0.0503s/iter; left time: 1936.0935s
Epoch: 18 cost time: 26.145260095596313
Epoch: 18, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0120448
	speed: 0.2999s/iter; left time: 11504.6918s
	iters: 200, epoch: 19 | loss: 0.0049426
	speed: 0.0533s/iter; left time: 2038.6661s
	iters: 300, epoch: 19 | loss: 0.0103097
	speed: 0.0541s/iter; left time: 2065.6245s
	iters: 400, epoch: 19 | loss: 0.0022667
	speed: 0.0523s/iter; left time: 1990.4753s
Epoch: 19 cost time: 25.76668691635132
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0004018
	speed: 0.2888s/iter; left time: 10941.1643s
	iters: 200, epoch: 20 | loss: 0.0045409
	speed: 0.0552s/iter; left time: 2087.7384s
	iters: 300, epoch: 20 | loss: 0.0003733
	speed: 0.0558s/iter; left time: 2102.2798s
	iters: 400, epoch: 20 | loss: 0.3275114
	speed: 0.0558s/iter; left time: 2099.1990s
Epoch: 20 cost time: 26.39333963394165
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0154019
	speed: 0.2947s/iter; left time: 11028.2787s
	iters: 200, epoch: 21 | loss: 0.0089496
	speed: 0.0586s/iter; left time: 2187.5118s
	iters: 300, epoch: 21 | loss: 0.0024186
	speed: 0.0568s/iter; left time: 2114.8700s
	iters: 400, epoch: 21 | loss: 0.0367071
	speed: 0.0569s/iter; left time: 2112.8845s
Epoch: 21 cost time: 27.336156129837036
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.979130).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0022700
	speed: 0.2970s/iter; left time: 10975.6709s
	iters: 200, epoch: 22 | loss: 0.0090658
	speed: 0.0563s/iter; left time: 2076.2315s
	iters: 300, epoch: 22 | loss: 0.0125275
	speed: 0.0564s/iter; left time: 2071.3083s
	iters: 400, epoch: 22 | loss: 0.0007855
	speed: 0.0565s/iter; left time: 2072.3444s
Epoch: 22 cost time: 27.23603057861328
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0150516
	speed: 0.3005s/iter; left time: 10964.6796s
	iters: 200, epoch: 23 | loss: 0.1227704
	speed: 0.0570s/iter; left time: 2074.6650s
	iters: 300, epoch: 23 | loss: 0.0378565
	speed: 0.0537s/iter; left time: 1947.1362s
	iters: 400, epoch: 23 | loss: 0.0037810
	speed: 0.0593s/iter; left time: 2147.0263s
Epoch: 23 cost time: 27.012049198150635
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2429712
	speed: 0.3065s/iter; left time: 11039.6762s
	iters: 200, epoch: 24 | loss: 0.0040891
	speed: 0.0550s/iter; left time: 1974.3378s
	iters: 300, epoch: 24 | loss: 0.0007494
	speed: 0.0577s/iter; left time: 2066.5498s
	iters: 400, epoch: 24 | loss: 0.0022594
	speed: 0.0561s/iter; left time: 2002.8922s
Epoch: 24 cost time: 26.638476371765137
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0003980
	speed: 0.3017s/iter; left time: 10724.3960s
	iters: 200, epoch: 25 | loss: 0.0035892
	speed: 0.0516s/iter; left time: 1830.0591s
	iters: 300, epoch: 25 | loss: 0.0003084
	speed: 0.0523s/iter; left time: 1850.2354s
	iters: 400, epoch: 25 | loss: 0.0001701
	speed: 0.0558s/iter; left time: 1965.0754s
Epoch: 25 cost time: 25.723242044448853
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0073504
	speed: 0.2950s/iter; left time: 10347.4625s
	iters: 200, epoch: 26 | loss: 0.0284029
	speed: 0.0499s/iter; left time: 1745.1305s
	iters: 300, epoch: 26 | loss: 0.0456353
	speed: 0.0522s/iter; left time: 1820.2889s
	iters: 400, epoch: 26 | loss: 0.0006193
	speed: 0.0562s/iter; left time: 1953.4962s
Epoch: 26 cost time: 25.21047592163086
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.980273).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0033635
	speed: 0.2980s/iter; left time: 10312.1693s
	iters: 200, epoch: 27 | loss: 0.0008881
	speed: 0.0549s/iter; left time: 1893.2921s
	iters: 300, epoch: 27 | loss: 0.0086536
	speed: 0.0549s/iter; left time: 1887.5993s
	iters: 400, epoch: 27 | loss: 0.0001053
	speed: 0.0558s/iter; left time: 1915.8383s
Epoch: 27 cost time: 26.56222677230835
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0021159
	speed: 0.3092s/iter; left time: 10555.2972s
	iters: 200, epoch: 28 | loss: 0.0005159
	speed: 0.0564s/iter; left time: 1918.2999s
	iters: 300, epoch: 28 | loss: 0.0018859
	speed: 0.0567s/iter; left time: 1923.8944s
	iters: 400, epoch: 28 | loss: 0.0005297
	speed: 0.0544s/iter; left time: 1841.6689s
Epoch: 28 cost time: 26.910200357437134
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.981131).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0005914
	speed: 0.3095s/iter; left time: 10421.0616s
	iters: 200, epoch: 29 | loss: 0.0123128
	speed: 0.0513s/iter; left time: 1723.3995s
	iters: 300, epoch: 29 | loss: 0.0068817
	speed: 0.0487s/iter; left time: 1628.8530s
	iters: 400, epoch: 29 | loss: 0.0007229
	speed: 0.0502s/iter; left time: 1674.0649s
Epoch: 29 cost time: 25.30117654800415
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0594794
	speed: 0.2970s/iter; left time: 9861.2668s
	iters: 200, epoch: 30 | loss: 0.0013058
	speed: 0.0537s/iter; left time: 1777.3858s
	iters: 300, epoch: 30 | loss: 0.0007002
	speed: 0.0508s/iter; left time: 1676.4583s
	iters: 400, epoch: 30 | loss: 0.0009616
	speed: 0.0494s/iter; left time: 1624.6531s
Epoch: 30 cost time: 24.86484408378601
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0010130
	speed: 0.2961s/iter; left time: 9690.2163s
	iters: 200, epoch: 31 | loss: 0.0082164
	speed: 0.0562s/iter; left time: 1834.2838s
	iters: 300, epoch: 31 | loss: 0.0016560
	speed: 0.0570s/iter; left time: 1854.1497s
	iters: 400, epoch: 31 | loss: 0.0020438
	speed: 0.0536s/iter; left time: 1738.7847s
Epoch: 31 cost time: 26.194939136505127
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0049949
	speed: 0.2888s/iter; left time: 9315.7932s
	iters: 200, epoch: 32 | loss: 0.0008500
	speed: 0.0568s/iter; left time: 1827.9875s
	iters: 300, epoch: 32 | loss: 0.0007121
	speed: 0.0562s/iter; left time: 1802.7181s
	iters: 400, epoch: 32 | loss: 0.0008073
	speed: 0.0501s/iter; left time: 1602.4037s
Epoch: 32 cost time: 25.918463230133057
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0019626
	speed: 0.2804s/iter; left time: 8914.1495s
	iters: 200, epoch: 33 | loss: 0.0359791
	speed: 0.0522s/iter; left time: 1655.4994s
	iters: 300, epoch: 33 | loss: 0.0291739
	speed: 0.0541s/iter; left time: 1708.5063s
	iters: 400, epoch: 33 | loss: 0.0023935
	speed: 0.0555s/iter; left time: 1748.9541s
Epoch: 33 cost time: 26.26555323600769
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0027261
	speed: 0.2892s/iter; left time: 9059.8564s
	iters: 200, epoch: 34 | loss: 0.0011234
	speed: 0.0477s/iter; left time: 1489.1297s
	iters: 300, epoch: 34 | loss: 0.0068816
	speed: 0.0491s/iter; left time: 1527.3756s
	iters: 400, epoch: 34 | loss: 0.0411198
	speed: 0.0534s/iter; left time: 1656.3879s
Epoch: 34 cost time: 25.066767692565918
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0237758
	speed: 0.2982s/iter; left time: 9200.8852s
	iters: 200, epoch: 35 | loss: 0.0010210
	speed: 0.0552s/iter; left time: 1698.4199s
	iters: 300, epoch: 35 | loss: 0.0247091
	speed: 0.0543s/iter; left time: 1663.9269s
	iters: 400, epoch: 35 | loss: 0.0024953
	speed: 0.0521s/iter; left time: 1591.1326s
Epoch: 35 cost time: 26.06637978553772
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982846).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0007175
	speed: 0.2909s/iter; left time: 8840.1723s
	iters: 200, epoch: 36 | loss: 0.0007083
	speed: 0.0511s/iter; left time: 1546.5608s
	iters: 300, epoch: 36 | loss: 0.0010861
	speed: 0.0481s/iter; left time: 1452.8239s
	iters: 400, epoch: 36 | loss: 0.0712327
	speed: 0.0486s/iter; left time: 1462.3334s
Epoch: 36 cost time: 24.315795183181763
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0002717
	speed: 0.2771s/iter; left time: 8288.6960s
	iters: 200, epoch: 37 | loss: 0.0223822
	speed: 0.0523s/iter; left time: 1558.2351s
	iters: 300, epoch: 37 | loss: 0.0008613
	speed: 0.0528s/iter; left time: 1568.5560s
	iters: 400, epoch: 37 | loss: 0.0000401
	speed: 0.0501s/iter; left time: 1482.8353s
Epoch: 37 cost time: 24.787259340286255
Epoch: 37, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.982 Test Loss: 0.124 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0001985
	speed: 0.2857s/iter; left time: 8414.3290s
	iters: 200, epoch: 38 | loss: 0.0001844
	speed: 0.0558s/iter; left time: 1637.9959s
	iters: 300, epoch: 38 | loss: 0.0005532
	speed: 0.0564s/iter; left time: 1648.9776s
	iters: 400, epoch: 38 | loss: 0.0005364
	speed: 0.0537s/iter; left time: 1564.1505s
Epoch: 38 cost time: 25.9369215965271
Epoch: 38, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0008879
	speed: 0.2911s/iter; left time: 8435.0902s
	iters: 200, epoch: 39 | loss: 0.0007912
	speed: 0.0559s/iter; left time: 1614.7524s
	iters: 300, epoch: 39 | loss: 0.0015679
	speed: 0.0549s/iter; left time: 1579.8091s
	iters: 400, epoch: 39 | loss: 0.0022811
	speed: 0.0535s/iter; left time: 1533.9189s
Epoch: 39 cost time: 26.439811944961548
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0611006
	speed: 0.2937s/iter; left time: 8372.8757s
	iters: 200, epoch: 40 | loss: 0.0119143
	speed: 0.0551s/iter; left time: 1566.0934s
	iters: 300, epoch: 40 | loss: 0.0015310
	speed: 0.0572s/iter; left time: 1618.1925s
	iters: 400, epoch: 40 | loss: 0.0003361
	speed: 0.0561s/iter; left time: 1581.6457s
Epoch: 40 cost time: 26.402891874313354
Epoch: 40, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0001600
	speed: 0.2891s/iter; left time: 8105.3220s
	iters: 200, epoch: 41 | loss: 0.0000817
	speed: 0.0533s/iter; left time: 1490.3684s
	iters: 300, epoch: 41 | loss: 0.0674700
	speed: 0.0540s/iter; left time: 1503.6112s
	iters: 400, epoch: 41 | loss: 0.1194708
	speed: 0.0599s/iter; left time: 1661.5969s
Epoch: 41 cost time: 27.06390357017517
Epoch: 41, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0036088
	speed: 0.2885s/iter; left time: 7954.6212s
	iters: 200, epoch: 42 | loss: 0.0013434
	speed: 0.0596s/iter; left time: 1637.6354s
	iters: 300, epoch: 42 | loss: 0.0096372
	speed: 0.0558s/iter; left time: 1528.0360s
	iters: 400, epoch: 42 | loss: 0.0003580
	speed: 0.0540s/iter; left time: 1472.7562s
Epoch: 42 cost time: 26.936814308166504
Epoch: 42, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0001340
	speed: 0.2765s/iter; left time: 7492.7662s
	iters: 200, epoch: 43 | loss: 0.0012379
	speed: 0.0527s/iter; left time: 1422.6949s
	iters: 300, epoch: 43 | loss: 0.0002273
	speed: 0.0539s/iter; left time: 1450.1672s
	iters: 400, epoch: 43 | loss: 0.0004286
	speed: 0.0557s/iter; left time: 1491.8508s
Epoch: 43 cost time: 25.51682162284851
Epoch: 43, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0110675
	speed: 0.2771s/iter; left time: 7379.0802s
	iters: 200, epoch: 44 | loss: 0.0011056
	speed: 0.0542s/iter; left time: 1439.0224s
	iters: 300, epoch: 44 | loss: 0.0005689
	speed: 0.0525s/iter; left time: 1387.1188s
	iters: 400, epoch: 44 | loss: 0.0000961
	speed: 0.0548s/iter; left time: 1444.1062s
Epoch: 44 cost time: 25.270320177078247
Epoch: 44, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0001749
	speed: 0.2887s/iter; left time: 7554.1585s
	iters: 200, epoch: 45 | loss: 0.0005655
	speed: 0.0540s/iter; left time: 1408.7722s
	iters: 300, epoch: 45 | loss: 0.0007066
	speed: 0.0601s/iter; left time: 1560.9922s
	iters: 400, epoch: 45 | loss: 0.0050415
	speed: 0.0562s/iter; left time: 1454.6167s
Epoch: 45 cost time: 26.443471431732178
Epoch: 45, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 56506
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1335317
	speed: 0.0866s/iter; left time: 4054.8554s
	iters: 200, epoch: 1 | loss: 0.4326272
	speed: 0.0667s/iter; left time: 3115.9588s
	iters: 300, epoch: 1 | loss: 0.3891559
	speed: 0.0562s/iter; left time: 2616.7238s
	iters: 400, epoch: 1 | loss: 0.2156111
	speed: 0.0577s/iter; left time: 2684.8401s
Epoch: 1 cost time: 31.030758142471313
Epoch: 1, Steps: 469 | Train Loss: 0.862 Vali Loss: 0.415 Vali Acc: 0.881 Test Loss: 0.415 Test Acc: 0.881
Validation loss decreased (inf --> -0.881357).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4614530
	speed: 0.2995s/iter; left time: 13876.8353s
	iters: 200, epoch: 2 | loss: 0.2447782
	speed: 0.0585s/iter; left time: 2706.1239s
	iters: 300, epoch: 2 | loss: 0.1510140
	speed: 0.0570s/iter; left time: 2631.7860s
	iters: 400, epoch: 2 | loss: 0.3572223
	speed: 0.0552s/iter; left time: 2539.8888s
Epoch: 2 cost time: 27.218591690063477
Epoch: 2, Steps: 469 | Train Loss: 0.215 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.881357 --> -0.943680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1681834
	speed: 0.2978s/iter; left time: 13658.8742s
	iters: 200, epoch: 3 | loss: 0.2737649
	speed: 0.0600s/iter; left time: 2746.8373s
	iters: 300, epoch: 3 | loss: 0.1405195
	speed: 0.0579s/iter; left time: 2645.1977s
	iters: 400, epoch: 3 | loss: 0.0297845
	speed: 0.0544s/iter; left time: 2477.9032s
Epoch: 3 cost time: 27.29846453666687
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.943680 --> -0.949398).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0594797
	speed: 0.2913s/iter; left time: 13223.8922s
	iters: 200, epoch: 4 | loss: 0.0761762
	speed: 0.0571s/iter; left time: 2584.6296s
	iters: 300, epoch: 4 | loss: 0.0798121
	speed: 0.0532s/iter; left time: 2402.8321s
	iters: 400, epoch: 4 | loss: 0.1631211
	speed: 0.0544s/iter; left time: 2451.3674s
Epoch: 4 cost time: 26.8490571975708
Epoch: 4, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.949398 --> -0.962548).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0231464
	speed: 0.2942s/iter; left time: 13219.1385s
	iters: 200, epoch: 5 | loss: 0.2936763
	speed: 0.0607s/iter; left time: 2721.6480s
	iters: 300, epoch: 5 | loss: 0.0502424
	speed: 0.0547s/iter; left time: 2445.0694s
	iters: 400, epoch: 5 | loss: 0.0054247
	speed: 0.0738s/iter; left time: 3293.8252s
Epoch: 5 cost time: 30.349534511566162
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0209257
	speed: 0.2751s/iter; left time: 12228.2795s
	iters: 200, epoch: 6 | loss: 0.0483505
	speed: 0.0391s/iter; left time: 1735.8921s
	iters: 300, epoch: 6 | loss: 0.0062839
	speed: 0.0465s/iter; left time: 2057.4418s
	iters: 400, epoch: 6 | loss: 0.0089260
	speed: 0.0573s/iter; left time: 2529.7284s
Epoch: 6 cost time: 22.88641047477722
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0698663
	speed: 0.3023s/iter; left time: 13297.5197s
	iters: 200, epoch: 7 | loss: 0.0069833
	speed: 0.0563s/iter; left time: 2472.6529s
	iters: 300, epoch: 7 | loss: 0.0267830
	speed: 0.0545s/iter; left time: 2386.4648s
	iters: 400, epoch: 7 | loss: 0.0840580
	speed: 0.0571s/iter; left time: 2496.3633s
Epoch: 7 cost time: 27.349614143371582
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.962548 --> -0.967409).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0197335
	speed: 0.2962s/iter; left time: 12891.9233s
	iters: 200, epoch: 8 | loss: 0.0432055
	speed: 0.0593s/iter; left time: 2573.6162s
	iters: 300, epoch: 8 | loss: 0.0022012
	speed: 0.0570s/iter; left time: 2470.2686s
	iters: 400, epoch: 8 | loss: 0.0432193
	speed: 0.0532s/iter; left time: 2299.8725s
Epoch: 8 cost time: 27.219577312469482
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0191516
	speed: 0.2953s/iter; left time: 12713.2883s
	iters: 200, epoch: 9 | loss: 0.0530851
	speed: 0.0563s/iter; left time: 2416.8922s
	iters: 300, epoch: 9 | loss: 0.0581360
	speed: 0.0548s/iter; left time: 2349.6417s
	iters: 400, epoch: 9 | loss: 0.1055350
	speed: 0.0551s/iter; left time: 2354.2229s
Epoch: 9 cost time: 26.872551441192627
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.967409 --> -0.973698).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0934543
	speed: 0.2902s/iter; left time: 12358.6928s
	iters: 200, epoch: 10 | loss: 0.0710624
	speed: 0.0586s/iter; left time: 2490.6146s
	iters: 300, epoch: 10 | loss: 0.1066265
	speed: 0.0553s/iter; left time: 2341.5451s
	iters: 400, epoch: 10 | loss: 0.0167852
	speed: 0.0570s/iter; left time: 2408.5592s
Epoch: 10 cost time: 27.61605715751648
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0475379
	speed: 0.3062s/iter; left time: 12892.6747s
	iters: 200, epoch: 11 | loss: 0.0094567
	speed: 0.0652s/iter; left time: 2738.3235s
	iters: 300, epoch: 11 | loss: 0.0705729
	speed: 0.0589s/iter; left time: 2469.3474s
	iters: 400, epoch: 11 | loss: 0.0027059
	speed: 0.0553s/iter; left time: 2313.2814s
Epoch: 11 cost time: 28.334553241729736
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0170930
	speed: 0.3130s/iter; left time: 13032.3155s
	iters: 200, epoch: 12 | loss: 0.0428232
	speed: 0.0570s/iter; left time: 2367.2965s
	iters: 300, epoch: 12 | loss: 0.0118813
	speed: 0.0597s/iter; left time: 2472.1491s
	iters: 400, epoch: 12 | loss: 0.4042721
	speed: 0.0551s/iter; left time: 2277.9276s
Epoch: 12 cost time: 27.635478019714355
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0167198
	speed: 0.2926s/iter; left time: 12047.5218s
	iters: 200, epoch: 13 | loss: 0.0044578
	speed: 0.0581s/iter; left time: 2386.7082s
	iters: 300, epoch: 13 | loss: 0.0039655
	speed: 0.0563s/iter; left time: 2304.9321s
	iters: 400, epoch: 13 | loss: 0.1145569
	speed: 0.0581s/iter; left time: 2375.7914s
Epoch: 13 cost time: 27.56976842880249
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.974270).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0631063
	speed: 0.2947s/iter; left time: 11993.6081s
	iters: 200, epoch: 14 | loss: 0.0105966
	speed: 0.0616s/iter; left time: 2500.5365s
	iters: 300, epoch: 14 | loss: 0.0023165
	speed: 0.0566s/iter; left time: 2293.0032s
	iters: 400, epoch: 14 | loss: 0.0013640
	speed: 0.0548s/iter; left time: 2212.9290s
Epoch: 14 cost time: 27.515527725219727
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.978844).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0024913
	speed: 0.2933s/iter; left time: 11801.6681s
	iters: 200, epoch: 15 | loss: 0.0060206
	speed: 0.0564s/iter; left time: 2264.6572s
	iters: 300, epoch: 15 | loss: 0.0003120
	speed: 0.0568s/iter; left time: 2273.6786s
	iters: 400, epoch: 15 | loss: 0.0143743
	speed: 0.0467s/iter; left time: 1864.6191s
Epoch: 15 cost time: 25.589340209960938
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0482320
	speed: 0.2926s/iter; left time: 11636.9714s
	iters: 200, epoch: 16 | loss: 0.2760569
	speed: 0.0606s/iter; left time: 2405.6891s
	iters: 300, epoch: 16 | loss: 0.0005024
	speed: 0.0600s/iter; left time: 2375.2918s
	iters: 400, epoch: 16 | loss: 0.0010528
	speed: 0.0609s/iter; left time: 2402.7706s
Epoch: 16 cost time: 28.363224267959595
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0020045
	speed: 0.2987s/iter; left time: 11739.9119s
	iters: 200, epoch: 17 | loss: 0.0849766
	speed: 0.0627s/iter; left time: 2455.9436s
	iters: 300, epoch: 17 | loss: 0.0040092
	speed: 0.0589s/iter; left time: 2304.6280s
	iters: 400, epoch: 17 | loss: 0.0054230
	speed: 0.0573s/iter; left time: 2234.1099s
Epoch: 17 cost time: 28.57943558692932
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0727854
	speed: 0.2919s/iter; left time: 11334.6225s
	iters: 200, epoch: 18 | loss: 0.0017190
	speed: 0.0579s/iter; left time: 2242.3906s
	iters: 300, epoch: 18 | loss: 0.0093088
	speed: 0.0573s/iter; left time: 2213.5427s
	iters: 400, epoch: 18 | loss: 0.0032568
	speed: 0.0505s/iter; left time: 1947.2311s
Epoch: 18 cost time: 25.843461751937866
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.978844 --> -0.981131).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0012810
	speed: 0.2910s/iter; left time: 11161.9501s
	iters: 200, epoch: 19 | loss: 0.0163461
	speed: 0.0590s/iter; left time: 2256.1275s
	iters: 300, epoch: 19 | loss: 0.0020533
	speed: 0.0573s/iter; left time: 2186.0873s
	iters: 400, epoch: 19 | loss: 0.0009135
	speed: 0.0535s/iter; left time: 2034.5759s
Epoch: 19 cost time: 26.51152467727661
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0019417
	speed: 0.2789s/iter; left time: 10565.6408s
	iters: 200, epoch: 20 | loss: 0.0036803
	speed: 0.0597s/iter; left time: 2257.8525s
	iters: 300, epoch: 20 | loss: 0.0926769
	speed: 0.0580s/iter; left time: 2184.8101s
	iters: 400, epoch: 20 | loss: 0.0028901
	speed: 0.0537s/iter; left time: 2018.9811s
Epoch: 20 cost time: 27.176164865493774
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0018541
	speed: 0.2879s/iter; left time: 10773.0313s
	iters: 200, epoch: 21 | loss: 0.0002839
	speed: 0.0568s/iter; left time: 2120.9055s
	iters: 300, epoch: 21 | loss: 0.0672342
	speed: 0.0619s/iter; left time: 2303.8685s
	iters: 400, epoch: 21 | loss: 0.0189410
	speed: 0.0526s/iter; left time: 1954.0078s
Epoch: 21 cost time: 27.007339477539062
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0102362
	speed: 0.2971s/iter; left time: 10977.2269s
	iters: 200, epoch: 22 | loss: 0.0009367
	speed: 0.0578s/iter; left time: 2128.2611s
	iters: 300, epoch: 22 | loss: 0.0003959
	speed: 0.0592s/iter; left time: 2177.3533s
	iters: 400, epoch: 22 | loss: 0.0946554
	speed: 0.0591s/iter; left time: 2165.1374s
Epoch: 22 cost time: 28.405335426330566
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0018895
	speed: 0.2904s/iter; left time: 10593.8215s
	iters: 200, epoch: 23 | loss: 0.0064083
	speed: 0.0613s/iter; left time: 2229.5849s
	iters: 300, epoch: 23 | loss: 0.0003520
	speed: 0.0603s/iter; left time: 2189.1818s
	iters: 400, epoch: 23 | loss: 0.0106221
	speed: 0.0575s/iter; left time: 2081.3612s
Epoch: 23 cost time: 28.40240240097046
Epoch: 23, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0061279
	speed: 0.2895s/iter; left time: 10427.5436s
	iters: 200, epoch: 24 | loss: 0.0078197
	speed: 0.0584s/iter; left time: 2099.1646s
	iters: 300, epoch: 24 | loss: 0.0025928
	speed: 0.0613s/iter; left time: 2196.5865s
	iters: 400, epoch: 24 | loss: 0.0003728
	speed: 0.0537s/iter; left time: 1917.2797s
Epoch: 24 cost time: 27.11425542831421
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0019931
	speed: 0.2639s/iter; left time: 9380.7312s
	iters: 200, epoch: 25 | loss: 0.0462050
	speed: 0.0542s/iter; left time: 1919.6609s
	iters: 300, epoch: 25 | loss: 0.0020355
	speed: 0.0564s/iter; left time: 1993.5771s
	iters: 400, epoch: 25 | loss: 0.0097153
	speed: 0.0511s/iter; left time: 1801.0865s
Epoch: 25 cost time: 25.96292495727539
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0010497
	speed: 0.2821s/iter; left time: 9894.5687s
	iters: 200, epoch: 26 | loss: 0.0043738
	speed: 0.0463s/iter; left time: 1619.5707s
	iters: 300, epoch: 26 | loss: 0.0125697
	speed: 0.0581s/iter; left time: 2025.9297s
	iters: 400, epoch: 26 | loss: 0.0027071
	speed: 0.0540s/iter; left time: 1878.1674s
Epoch: 26 cost time: 25.196007013320923
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0012231
	speed: 0.2896s/iter; left time: 10023.6188s
	iters: 200, epoch: 27 | loss: 0.0005690
	speed: 0.0555s/iter; left time: 1916.7222s
	iters: 300, epoch: 27 | loss: 0.0010682
	speed: 0.0598s/iter; left time: 2057.4587s
	iters: 400, epoch: 27 | loss: 0.0018283
	speed: 0.0607s/iter; left time: 2083.9181s
Epoch: 27 cost time: 27.679939031600952
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0039066
	speed: 0.2945s/iter; left time: 10053.0965s
	iters: 200, epoch: 28 | loss: 0.1618071
	speed: 0.0519s/iter; left time: 1765.0340s
	iters: 300, epoch: 28 | loss: 0.0348542
	speed: 0.0595s/iter; left time: 2019.3470s
	iters: 400, epoch: 28 | loss: 0.0109765
	speed: 0.0606s/iter; left time: 2049.5166s
Epoch: 28 cost time: 27.434627056121826
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 40122
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1111839
	speed: 0.0715s/iter; left time: 3345.2366s
	iters: 200, epoch: 1 | loss: 0.4781445
	speed: 0.0542s/iter; left time: 2531.4979s
	iters: 300, epoch: 1 | loss: 0.3824773
	speed: 0.0538s/iter; left time: 2507.4379s
	iters: 400, epoch: 1 | loss: 0.2071473
	speed: 0.0508s/iter; left time: 2360.8924s
Epoch: 1 cost time: 26.464016437530518
Epoch: 1, Steps: 469 | Train Loss: 0.864 Vali Loss: 0.396 Vali Acc: 0.891 Test Loss: 0.396 Test Acc: 0.891
Validation loss decreased (inf --> -0.890791).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4466011
	speed: 0.2759s/iter; left time: 12785.1425s
	iters: 200, epoch: 2 | loss: 0.2254170
	speed: 0.0525s/iter; left time: 2427.8038s
	iters: 300, epoch: 2 | loss: 0.0974917
	speed: 0.0528s/iter; left time: 2435.7910s
	iters: 400, epoch: 2 | loss: 0.3787875
	speed: 0.0515s/iter; left time: 2368.5963s
Epoch: 2 cost time: 25.023478746414185
Epoch: 2, Steps: 469 | Train Loss: 0.205 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.890791 --> -0.951685).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1578553
	speed: 0.2660s/iter; left time: 12201.6020s
	iters: 200, epoch: 3 | loss: 0.1950509
	speed: 0.0545s/iter; left time: 2493.7761s
	iters: 300, epoch: 3 | loss: 0.0657077
	speed: 0.0537s/iter; left time: 2450.7824s
	iters: 400, epoch: 3 | loss: 0.0253426
	speed: 0.0535s/iter; left time: 2436.6167s
Epoch: 3 cost time: 25.178212642669678
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.951685 --> -0.953400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0640552
	speed: 0.2661s/iter; left time: 12080.5007s
	iters: 200, epoch: 4 | loss: 0.0735305
	speed: 0.0564s/iter; left time: 2556.2535s
	iters: 300, epoch: 4 | loss: 0.1167983
	speed: 0.0556s/iter; left time: 2513.9235s
	iters: 400, epoch: 4 | loss: 0.1425994
	speed: 0.0534s/iter; left time: 2408.9427s
Epoch: 4 cost time: 25.93136215209961
Epoch: 4, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.953400 --> -0.964836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0210485
	speed: 0.2865s/iter; left time: 12868.9244s
	iters: 200, epoch: 5 | loss: 0.3652012
	speed: 0.0575s/iter; left time: 2576.6847s
	iters: 300, epoch: 5 | loss: 0.0613312
	speed: 0.0560s/iter; left time: 2505.4206s
	iters: 400, epoch: 5 | loss: 0.0054576
	speed: 0.0553s/iter; left time: 2467.5151s
Epoch: 5 cost time: 26.999671697616577
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
Validation loss decreased (-0.964836 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0267437
	speed: 0.2823s/iter; left time: 12548.1827s
	iters: 200, epoch: 6 | loss: 0.0678119
	speed: 0.0560s/iter; left time: 2485.5984s
	iters: 300, epoch: 6 | loss: 0.0028839
	speed: 0.0559s/iter; left time: 2474.7016s
	iters: 400, epoch: 6 | loss: 0.0409414
	speed: 0.0518s/iter; left time: 2289.3646s
Epoch: 6 cost time: 25.814737558364868
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0450991
	speed: 0.2732s/iter; left time: 12018.9138s
	iters: 200, epoch: 7 | loss: 0.0036115
	speed: 0.0510s/iter; left time: 2237.3387s
	iters: 300, epoch: 7 | loss: 0.0219159
	speed: 0.0542s/iter; left time: 2374.2050s
	iters: 400, epoch: 7 | loss: 0.0512263
	speed: 0.0549s/iter; left time: 2399.3727s
Epoch: 7 cost time: 25.30898666381836
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.966265 --> -0.972269).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0041133
	speed: 0.2733s/iter; left time: 11892.0831s
	iters: 200, epoch: 8 | loss: 0.0303173
	speed: 0.0536s/iter; left time: 2325.2772s
	iters: 300, epoch: 8 | loss: 0.0065102
	speed: 0.0540s/iter; left time: 2337.5959s
	iters: 400, epoch: 8 | loss: 0.0188690
	speed: 0.0522s/iter; left time: 2255.8437s
Epoch: 8 cost time: 25.18222975730896
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0075491
	speed: 0.2830s/iter; left time: 12180.8174s
	iters: 200, epoch: 9 | loss: 0.0282423
	speed: 0.0530s/iter; left time: 2278.2986s
	iters: 300, epoch: 9 | loss: 0.0185884
	speed: 0.0554s/iter; left time: 2372.8627s
	iters: 400, epoch: 9 | loss: 0.1634425
	speed: 0.0530s/iter; left time: 2266.9019s
Epoch: 9 cost time: 25.50938391685486
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1129000
	speed: 0.2849s/iter; left time: 12132.1293s
	iters: 200, epoch: 10 | loss: 0.0094119
	speed: 0.0553s/iter; left time: 2350.0177s
	iters: 300, epoch: 10 | loss: 0.1289787
	speed: 0.0599s/iter; left time: 2537.8624s
	iters: 400, epoch: 10 | loss: 0.0259279
	speed: 0.0552s/iter; left time: 2333.1611s
Epoch: 10 cost time: 26.83618688583374
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0752899
	speed: 0.2929s/iter; left time: 12335.3482s
	iters: 200, epoch: 11 | loss: 0.0039987
	speed: 0.0505s/iter; left time: 2120.9612s
	iters: 300, epoch: 11 | loss: 0.0487968
	speed: 0.0581s/iter; left time: 2436.4401s
	iters: 400, epoch: 11 | loss: 0.0120603
	speed: 0.0561s/iter; left time: 2346.5200s
Epoch: 11 cost time: 26.272067308425903
Epoch: 11, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.973412).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0233146
	speed: 0.2922s/iter; left time: 12168.0407s
	iters: 200, epoch: 12 | loss: 0.0391591
	speed: 0.0506s/iter; left time: 2101.7996s
	iters: 300, epoch: 12 | loss: 0.0425037
	speed: 0.0528s/iter; left time: 2189.7378s
	iters: 400, epoch: 12 | loss: 0.1837849
	speed: 0.0544s/iter; left time: 2248.1185s
Epoch: 12 cost time: 24.977814435958862
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.974270).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0442260
	speed: 0.2830s/iter; left time: 11653.8782s
	iters: 200, epoch: 13 | loss: 0.0347976
	speed: 0.0508s/iter; left time: 2086.0906s
	iters: 300, epoch: 13 | loss: 0.0057699
	speed: 0.0500s/iter; left time: 2049.7503s
	iters: 400, epoch: 13 | loss: 0.1049219
	speed: 0.0544s/iter; left time: 2223.1462s
Epoch: 13 cost time: 24.808398723602295
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0170122
	speed: 0.2756s/iter; left time: 11217.5939s
	iters: 200, epoch: 14 | loss: 0.0694238
	speed: 0.0511s/iter; left time: 2073.4088s
	iters: 300, epoch: 14 | loss: 0.0021412
	speed: 0.0530s/iter; left time: 2147.1322s
	iters: 400, epoch: 14 | loss: 0.0179245
	speed: 0.0495s/iter; left time: 2001.5668s
Epoch: 14 cost time: 24.4120934009552
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975985).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0178491
	speed: 0.2832s/iter; left time: 11393.1062s
	iters: 200, epoch: 15 | loss: 0.0489999
	speed: 0.0519s/iter; left time: 2081.6797s
	iters: 300, epoch: 15 | loss: 0.0003694
	speed: 0.0492s/iter; left time: 1968.7507s
	iters: 400, epoch: 15 | loss: 0.0097885
	speed: 0.0519s/iter; left time: 2072.8590s
Epoch: 15 cost time: 25.05902886390686
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0422788
	speed: 0.2925s/iter; left time: 11630.1220s
	iters: 200, epoch: 16 | loss: 0.2941501
	speed: 0.0541s/iter; left time: 2147.8138s
	iters: 300, epoch: 16 | loss: 0.0097640
	speed: 0.0515s/iter; left time: 2037.8535s
	iters: 400, epoch: 16 | loss: 0.0006907
	speed: 0.0538s/iter; left time: 2122.3533s
Epoch: 16 cost time: 25.961915016174316
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0039022
	speed: 0.3022s/iter; left time: 11877.5169s
	iters: 200, epoch: 17 | loss: 0.1589535
	speed: 0.0506s/iter; left time: 1982.6185s
	iters: 300, epoch: 17 | loss: 0.0381839
	speed: 0.0574s/iter; left time: 2244.1305s
	iters: 400, epoch: 17 | loss: 0.0073579
	speed: 0.0530s/iter; left time: 2066.6828s
Epoch: 17 cost time: 25.913190841674805
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0084418
	speed: 0.2854s/iter; left time: 11080.0072s
	iters: 200, epoch: 18 | loss: 0.0260713
	speed: 0.0520s/iter; left time: 2012.4390s
	iters: 300, epoch: 18 | loss: 0.0444345
	speed: 0.0498s/iter; left time: 1924.1065s
	iters: 400, epoch: 18 | loss: 0.0120892
	speed: 0.0495s/iter; left time: 1905.9330s
Epoch: 18 cost time: 25.400742769241333
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.975985).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0027053
	speed: 0.2873s/iter; left time: 11020.9645s
	iters: 200, epoch: 19 | loss: 0.0171122
	speed: 0.0519s/iter; left time: 1984.8046s
	iters: 300, epoch: 19 | loss: 0.0008525
	speed: 0.0508s/iter; left time: 1940.2427s
	iters: 400, epoch: 19 | loss: 0.0032739
	speed: 0.0493s/iter; left time: 1874.9989s
Epoch: 19 cost time: 24.720606327056885
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0044315
	speed: 0.2785s/iter; left time: 10554.1000s
	iters: 200, epoch: 20 | loss: 0.0684023
	speed: 0.0512s/iter; left time: 1933.4557s
	iters: 300, epoch: 20 | loss: 0.0026401
	speed: 0.0532s/iter; left time: 2004.3159s
	iters: 400, epoch: 20 | loss: 0.0771905
	speed: 0.0536s/iter; left time: 2014.9402s
Epoch: 20 cost time: 24.819105863571167
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0006572
	speed: 0.2766s/iter; left time: 10350.2696s
	iters: 200, epoch: 21 | loss: 0.0005070
	speed: 0.0583s/iter; left time: 2176.9700s
	iters: 300, epoch: 21 | loss: 0.0285325
	speed: 0.0509s/iter; left time: 1892.7506s
	iters: 400, epoch: 21 | loss: 0.0316830
	speed: 0.0516s/iter; left time: 1917.0627s
Epoch: 21 cost time: 25.492392778396606
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0044076
	speed: 0.2927s/iter; left time: 10816.5276s
	iters: 200, epoch: 22 | loss: 0.0106850
	speed: 0.0564s/iter; left time: 2078.0279s
	iters: 300, epoch: 22 | loss: 0.0000938
	speed: 0.0538s/iter; left time: 1977.2097s
	iters: 400, epoch: 22 | loss: 0.0230109
	speed: 0.0527s/iter; left time: 1932.3787s
Epoch: 22 cost time: 26.107266664505005
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0014829
	speed: 0.2882s/iter; left time: 10514.3303s
	iters: 200, epoch: 23 | loss: 0.0049973
	speed: 0.0549s/iter; left time: 1997.4469s
	iters: 300, epoch: 23 | loss: 0.0030465
	speed: 0.0481s/iter; left time: 1746.2896s
	iters: 400, epoch: 23 | loss: 0.0011612
	speed: 0.0513s/iter; left time: 1857.5327s
Epoch: 23 cost time: 24.91142225265503
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0294772
	speed: 0.2701s/iter; left time: 9726.5823s
	iters: 200, epoch: 24 | loss: 0.0017098
	speed: 0.0530s/iter; left time: 1902.1400s
	iters: 300, epoch: 24 | loss: 0.0471114
	speed: 0.0544s/iter; left time: 1947.5498s
	iters: 400, epoch: 24 | loss: 0.0035535
	speed: 0.0516s/iter; left time: 1844.0631s
Epoch: 24 cost time: 24.831099271774292
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.978272).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0039150
	speed: 0.2666s/iter; left time: 9477.7903s
	iters: 200, epoch: 25 | loss: 0.0921067
	speed: 0.0537s/iter; left time: 1904.9951s
	iters: 300, epoch: 25 | loss: 0.0047088
	speed: 0.0519s/iter; left time: 1835.4570s
	iters: 400, epoch: 25 | loss: 0.0325468
	speed: 0.0535s/iter; left time: 1886.8686s
Epoch: 25 cost time: 25.350384950637817
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0007199
	speed: 0.2696s/iter; left time: 9457.3089s
	iters: 200, epoch: 26 | loss: 0.0021923
	speed: 0.0527s/iter; left time: 1842.6837s
	iters: 300, epoch: 26 | loss: 0.0036266
	speed: 0.0549s/iter; left time: 1915.7284s
	iters: 400, epoch: 26 | loss: 0.0097203
	speed: 0.0557s/iter; left time: 1937.3660s
Epoch: 26 cost time: 25.342918157577515
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0017417
	speed: 0.2725s/iter; left time: 9431.9325s
	iters: 200, epoch: 27 | loss: 0.0008844
	speed: 0.0593s/iter; left time: 2044.7757s
	iters: 300, epoch: 27 | loss: 0.0112290
	speed: 0.0591s/iter; left time: 2033.0396s
	iters: 400, epoch: 27 | loss: 0.0003986
	speed: 0.0555s/iter; left time: 1905.1769s
Epoch: 27 cost time: 27.569976568222046
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0251598
	speed: 0.2938s/iter; left time: 10029.5541s
	iters: 200, epoch: 28 | loss: 0.0033913
	speed: 0.0567s/iter; left time: 1930.5298s
	iters: 300, epoch: 28 | loss: 0.0043782
	speed: 0.0553s/iter; left time: 1877.7930s
	iters: 400, epoch: 28 | loss: 0.0040602
	speed: 0.0546s/iter; left time: 1848.6632s
Epoch: 28 cost time: 26.516957998275757
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.980559).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0192349
	speed: 0.2857s/iter; left time: 9619.9496s
	iters: 200, epoch: 29 | loss: 0.0075038
	speed: 0.0528s/iter; left time: 1772.2289s
	iters: 300, epoch: 29 | loss: 0.0061541
	speed: 0.0549s/iter; left time: 1837.8656s
	iters: 400, epoch: 29 | loss: 0.0009242
	speed: 0.0542s/iter; left time: 1808.1214s
Epoch: 29 cost time: 25.73527479171753
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0114291
	speed: 0.2734s/iter; left time: 9076.4312s
	iters: 200, epoch: 30 | loss: 0.0004705
	speed: 0.0555s/iter; left time: 1836.7720s
	iters: 300, epoch: 30 | loss: 0.0020417
	speed: 0.0533s/iter; left time: 1758.2093s
	iters: 400, epoch: 30 | loss: 0.0025089
	speed: 0.0530s/iter; left time: 1743.3228s
Epoch: 30 cost time: 25.20471429824829
Epoch: 30, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0679919
	speed: 0.2639s/iter; left time: 8638.0149s
	iters: 200, epoch: 31 | loss: 0.2562709
	speed: 0.0514s/iter; left time: 1678.4217s
	iters: 300, epoch: 31 | loss: 0.0030410
	speed: 0.0474s/iter; left time: 1542.7421s
	iters: 400, epoch: 31 | loss: 0.0084805
	speed: 0.0450s/iter; left time: 1460.1490s
Epoch: 31 cost time: 22.65032458305359
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.982275).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.1505957
	speed: 0.2935s/iter; left time: 9467.4739s
	iters: 200, epoch: 32 | loss: 0.0011844
	speed: 0.0577s/iter; left time: 1857.2269s
	iters: 300, epoch: 32 | loss: 0.0002377
	speed: 0.0541s/iter; left time: 1734.7366s
	iters: 400, epoch: 32 | loss: 0.0002661
	speed: 0.0559s/iter; left time: 1786.1409s
Epoch: 32 cost time: 26.972527742385864
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0022029
	speed: 0.3147s/iter; left time: 10005.0998s
	iters: 200, epoch: 33 | loss: 0.0237714
	speed: 0.0616s/iter; left time: 1951.4193s
	iters: 300, epoch: 33 | loss: 0.0309485
	speed: 0.0576s/iter; left time: 1818.2375s
	iters: 400, epoch: 33 | loss: 0.0003491
	speed: 0.0501s/iter; left time: 1578.6612s
Epoch: 33 cost time: 27.480064153671265
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0020001
	speed: 0.3233s/iter; left time: 10127.6197s
	iters: 200, epoch: 34 | loss: 0.0011655
	speed: 0.0608s/iter; left time: 1897.7411s
	iters: 300, epoch: 34 | loss: 0.0065623
	speed: 0.0601s/iter; left time: 1871.1906s
	iters: 400, epoch: 34 | loss: 0.0976377
	speed: 0.0562s/iter; left time: 1743.0377s
Epoch: 34 cost time: 27.88261103630066
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0075395
	speed: 0.3078s/iter; left time: 9497.1862s
	iters: 200, epoch: 35 | loss: 0.0012423
	speed: 0.0575s/iter; left time: 1768.2230s
	iters: 300, epoch: 35 | loss: 0.0012364
	speed: 0.0562s/iter; left time: 1722.1640s
	iters: 400, epoch: 35 | loss: 0.0010093
	speed: 0.0567s/iter; left time: 1731.9943s
Epoch: 35 cost time: 27.481130123138428
Epoch: 35, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.1007718
	speed: 0.3048s/iter; left time: 9260.1446s
	iters: 200, epoch: 36 | loss: 0.0001557
	speed: 0.0604s/iter; left time: 1828.7936s
	iters: 300, epoch: 36 | loss: 0.0644510
	speed: 0.0576s/iter; left time: 1737.7198s
	iters: 400, epoch: 36 | loss: 0.0977505
	speed: 0.0530s/iter; left time: 1595.4845s
Epoch: 36 cost time: 27.004859924316406
Epoch: 36, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.1294883
	speed: 0.3035s/iter; left time: 9079.3845s
	iters: 200, epoch: 37 | loss: 0.0066991
	speed: 0.0576s/iter; left time: 1718.8284s
	iters: 300, epoch: 37 | loss: 0.0298730
	speed: 0.0552s/iter; left time: 1640.9922s
	iters: 400, epoch: 37 | loss: 0.0002623
	speed: 0.0539s/iter; left time: 1595.2940s
Epoch: 37 cost time: 26.952574968338013
Epoch: 37, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0000605
	speed: 0.2958s/iter; left time: 8711.8643s
	iters: 200, epoch: 38 | loss: 0.0008670
	speed: 0.0599s/iter; left time: 1759.0410s
	iters: 300, epoch: 38 | loss: 0.0005837
	speed: 0.0599s/iter; left time: 1753.0283s
	iters: 400, epoch: 38 | loss: 0.0000410
	speed: 0.0578s/iter; left time: 1684.8996s
Epoch: 38 cost time: 27.232654809951782
Epoch: 38, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0299379
	speed: 0.3090s/iter; left time: 8955.1324s
	iters: 200, epoch: 39 | loss: 0.0056685
	speed: 0.0618s/iter; left time: 1784.9580s
	iters: 300, epoch: 39 | loss: 0.0096549
	speed: 0.0619s/iter; left time: 1781.3980s
	iters: 400, epoch: 39 | loss: 0.0133967
	speed: 0.0559s/iter; left time: 1601.8733s
Epoch: 39 cost time: 28.297136783599854
Epoch: 39, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0001847
	speed: 0.3111s/iter; left time: 8869.6584s
	iters: 200, epoch: 40 | loss: 0.0005865
	speed: 0.0588s/iter; left time: 1670.3403s
	iters: 300, epoch: 40 | loss: 0.0440536
	speed: 0.0616s/iter; left time: 1743.7123s
	iters: 400, epoch: 40 | loss: 0.0002924
	speed: 0.0529s/iter; left time: 1492.7867s
Epoch: 40 cost time: 27.14642572402954
Epoch: 40, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.2791041
	speed: 0.2873s/iter; left time: 8054.9699s
	iters: 200, epoch: 41 | loss: 0.0000169
	speed: 0.0551s/iter; left time: 1540.7701s
	iters: 300, epoch: 41 | loss: 0.0861028
	speed: 0.0532s/iter; left time: 1482.4430s
	iters: 400, epoch: 41 | loss: 0.0005966
	speed: 0.0524s/iter; left time: 1453.0394s
Epoch: 41 cost time: 25.53777027130127
Epoch: 41, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 40122
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1229997
	speed: 0.0725s/iter; left time: 3391.8727s
	iters: 200, epoch: 1 | loss: 0.4814294
	speed: 0.0510s/iter; left time: 2379.4496s
	iters: 300, epoch: 1 | loss: 0.4151788
	speed: 0.0507s/iter; left time: 2362.1647s
	iters: 400, epoch: 1 | loss: 0.1904873
	speed: 0.0532s/iter; left time: 2472.7646s
Epoch: 1 cost time: 26.647060871124268
Epoch: 1, Steps: 469 | Train Loss: 0.868 Vali Loss: 0.362 Vali Acc: 0.909 Test Loss: 0.362 Test Acc: 0.909
Validation loss decreased (inf --> -0.908801).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4337431
	speed: 0.2947s/iter; left time: 13656.1020s
	iters: 200, epoch: 2 | loss: 0.2141662
	speed: 0.0506s/iter; left time: 2341.4239s
	iters: 300, epoch: 2 | loss: 0.0515352
	speed: 0.0516s/iter; left time: 2381.1907s
	iters: 400, epoch: 2 | loss: 0.3467850
	speed: 0.0530s/iter; left time: 2441.5895s
Epoch: 2 cost time: 25.64483666419983
Epoch: 2, Steps: 469 | Train Loss: 0.185 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
Validation loss decreased (-0.908801 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1676583
	speed: 0.3059s/iter; left time: 14029.9845s
	iters: 200, epoch: 3 | loss: 0.1332328
	speed: 0.0579s/iter; left time: 2648.4525s
	iters: 300, epoch: 3 | loss: 0.0461482
	speed: 0.0540s/iter; left time: 2467.0488s
	iters: 400, epoch: 3 | loss: 0.0435920
	speed: 0.0541s/iter; left time: 2464.9595s
Epoch: 3 cost time: 26.865796089172363
Epoch: 3, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
Validation loss decreased (-0.958260 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0360463
	speed: 0.3060s/iter; left time: 13891.3157s
	iters: 200, epoch: 4 | loss: 0.0766572
	speed: 0.0563s/iter; left time: 2548.7713s
	iters: 300, epoch: 4 | loss: 0.0728865
	speed: 0.0573s/iter; left time: 2589.6356s
	iters: 400, epoch: 4 | loss: 0.1405193
	speed: 0.0578s/iter; left time: 2606.5942s
Epoch: 4 cost time: 27.475266933441162
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
Validation loss decreased (-0.961119 --> -0.971411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0270722
	speed: 0.2978s/iter; left time: 13380.5965s
	iters: 200, epoch: 5 | loss: 0.3344841
	speed: 0.0573s/iter; left time: 2568.6622s
	iters: 300, epoch: 5 | loss: 0.0895417
	speed: 0.0500s/iter; left time: 2234.3699s
	iters: 400, epoch: 5 | loss: 0.0066864
	speed: 0.0509s/iter; left time: 2269.4114s
Epoch: 5 cost time: 25.368683576583862
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0104054
	speed: 0.2877s/iter; left time: 12789.6456s
	iters: 200, epoch: 6 | loss: 0.0463783
	speed: 0.0551s/iter; left time: 2444.4152s
	iters: 300, epoch: 6 | loss: 0.0173836
	speed: 0.0539s/iter; left time: 2384.5790s
	iters: 400, epoch: 6 | loss: 0.0204003
	speed: 0.0508s/iter; left time: 2242.9370s
Epoch: 6 cost time: 25.278141260147095
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0425153
	speed: 0.2893s/iter; left time: 12723.9690s
	iters: 200, epoch: 7 | loss: 0.0066629
	speed: 0.0581s/iter; left time: 2551.4315s
	iters: 300, epoch: 7 | loss: 0.0237157
	speed: 0.0572s/iter; left time: 2504.3990s
	iters: 400, epoch: 7 | loss: 0.0617549
	speed: 0.0544s/iter; left time: 2378.4942s
Epoch: 7 cost time: 27.068730354309082
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.971411 --> -0.974842).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0374739
	speed: 0.2966s/iter; left time: 12908.9596s
	iters: 200, epoch: 8 | loss: 0.0498995
	speed: 0.0606s/iter; left time: 2631.8168s
	iters: 300, epoch: 8 | loss: 0.0120885
	speed: 0.0615s/iter; left time: 2665.6489s
	iters: 400, epoch: 8 | loss: 0.0097532
	speed: 0.0543s/iter; left time: 2344.6921s
Epoch: 8 cost time: 27.50544023513794
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0409228
	speed: 0.3051s/iter; left time: 13135.3020s
	iters: 200, epoch: 9 | loss: 0.0711872
	speed: 0.0573s/iter; left time: 2460.3591s
	iters: 300, epoch: 9 | loss: 0.0512250
	speed: 0.0562s/iter; left time: 2408.8952s
	iters: 400, epoch: 9 | loss: 0.0156523
	speed: 0.0536s/iter; left time: 2291.3398s
Epoch: 9 cost time: 26.938207387924194
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0061491
	speed: 0.3011s/iter; left time: 12819.5188s
	iters: 200, epoch: 10 | loss: 0.0045157
	speed: 0.0552s/iter; left time: 2345.4704s
	iters: 300, epoch: 10 | loss: 0.0107702
	speed: 0.0600s/iter; left time: 2542.8108s
	iters: 400, epoch: 10 | loss: 0.0287665
	speed: 0.0570s/iter; left time: 2410.6561s
Epoch: 10 cost time: 27.31778049468994
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.974842 --> -0.976843).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0121615
	speed: 0.2971s/iter; left time: 12511.8722s
	iters: 200, epoch: 11 | loss: 0.0034547
	speed: 0.0580s/iter; left time: 2435.0962s
	iters: 300, epoch: 11 | loss: 0.0200298
	speed: 0.0592s/iter; left time: 2481.7507s
	iters: 400, epoch: 11 | loss: 0.0193691
	speed: 0.0557s/iter; left time: 2330.8220s
Epoch: 11 cost time: 27.04775857925415
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0138353
	speed: 0.2905s/iter; left time: 12098.1783s
	iters: 200, epoch: 12 | loss: 0.0088266
	speed: 0.0559s/iter; left time: 2321.6344s
	iters: 300, epoch: 12 | loss: 0.0162568
	speed: 0.0552s/iter; left time: 2289.3535s
	iters: 400, epoch: 12 | loss: 0.4454820
	speed: 0.0551s/iter; left time: 2278.0964s
Epoch: 12 cost time: 26.233450889587402
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977700).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0020603
	speed: 0.2830s/iter; left time: 11652.5954s
	iters: 200, epoch: 13 | loss: 0.1612625
	speed: 0.0551s/iter; left time: 2262.2652s
	iters: 300, epoch: 13 | loss: 0.0062503
	speed: 0.0550s/iter; left time: 2254.0387s
	iters: 400, epoch: 13 | loss: 0.0524899
	speed: 0.0572s/iter; left time: 2339.6885s
Epoch: 13 cost time: 26.586836099624634
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0496956
	speed: 0.2770s/iter; left time: 11274.7646s
	iters: 200, epoch: 14 | loss: 0.0117548
	speed: 0.0486s/iter; left time: 1973.0392s
	iters: 300, epoch: 14 | loss: 0.0018940
	speed: 0.0462s/iter; left time: 1870.6114s
	iters: 400, epoch: 14 | loss: 0.0056041
	speed: 0.0564s/iter; left time: 2280.5260s
Epoch: 14 cost time: 24.896911144256592
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
Validation loss decreased (-0.977700 --> -0.980559).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0347014
	speed: 0.3061s/iter; left time: 12316.3907s
	iters: 200, epoch: 15 | loss: 0.0044517
	speed: 0.0553s/iter; left time: 2221.2912s
	iters: 300, epoch: 15 | loss: 0.0002668
	speed: 0.0562s/iter; left time: 2251.9402s
	iters: 400, epoch: 15 | loss: 0.0881491
	speed: 0.0573s/iter; left time: 2287.0739s
Epoch: 15 cost time: 26.55040431022644
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0032406
	speed: 0.3079s/iter; left time: 12243.6641s
	iters: 200, epoch: 16 | loss: 0.1634364
	speed: 0.0477s/iter; left time: 1891.7455s
	iters: 300, epoch: 16 | loss: 0.0017053
	speed: 0.0504s/iter; left time: 1993.2389s
	iters: 400, epoch: 16 | loss: 0.0201780
	speed: 0.0535s/iter; left time: 2112.3154s
Epoch: 16 cost time: 24.703946828842163
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0115277
	speed: 0.2935s/iter; left time: 11535.5595s
	iters: 200, epoch: 17 | loss: 0.1123989
	speed: 0.0519s/iter; left time: 2035.3209s
	iters: 300, epoch: 17 | loss: 0.0207716
	speed: 0.0525s/iter; left time: 2052.0902s
	iters: 400, epoch: 17 | loss: 0.0021654
	speed: 0.0526s/iter; left time: 2052.6570s
Epoch: 17 cost time: 25.556857109069824
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0634172
	speed: 0.2984s/iter; left time: 11584.8881s
	iters: 200, epoch: 18 | loss: 0.0001698
	speed: 0.0539s/iter; left time: 2085.7965s
	iters: 300, epoch: 18 | loss: 0.0072658
	speed: 0.0524s/iter; left time: 2022.3427s
	iters: 400, epoch: 18 | loss: 0.0036757
	speed: 0.0531s/iter; left time: 2047.5509s
Epoch: 18 cost time: 25.685551404953003
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0221256
	speed: 0.2926s/iter; left time: 11222.0603s
	iters: 200, epoch: 19 | loss: 0.0192077
	speed: 0.0516s/iter; left time: 1975.4665s
	iters: 300, epoch: 19 | loss: 0.0001762
	speed: 0.0502s/iter; left time: 1915.4259s
	iters: 400, epoch: 19 | loss: 0.0003712
	speed: 0.0510s/iter; left time: 1939.9948s
Epoch: 19 cost time: 24.895259857177734
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0002694
	speed: 0.2969s/iter; left time: 11248.3067s
	iters: 200, epoch: 20 | loss: 0.0006195
	speed: 0.0571s/iter; left time: 2159.1172s
	iters: 300, epoch: 20 | loss: 0.0343252
	speed: 0.0545s/iter; left time: 2053.1627s
	iters: 400, epoch: 20 | loss: 0.0060792
	speed: 0.0541s/iter; left time: 2034.2774s
Epoch: 20 cost time: 26.4543399810791
Epoch: 20, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0159862
	speed: 0.3063s/iter; left time: 11463.8075s
	iters: 200, epoch: 21 | loss: 0.0015558
	speed: 0.0557s/iter; left time: 2079.1127s
	iters: 300, epoch: 21 | loss: 0.0310529
	speed: 0.0536s/iter; left time: 1995.2640s
	iters: 400, epoch: 21 | loss: 0.0416787
	speed: 0.0565s/iter; left time: 2096.9243s
Epoch: 21 cost time: 27.07920217514038
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0102802
	speed: 0.2987s/iter; left time: 11038.8085s
	iters: 200, epoch: 22 | loss: 0.0015497
	speed: 0.0517s/iter; left time: 1904.2636s
	iters: 300, epoch: 22 | loss: 0.0004061
	speed: 0.0507s/iter; left time: 1863.2755s
	iters: 400, epoch: 22 | loss: 0.0069371
	speed: 0.0519s/iter; left time: 1903.5730s
Epoch: 22 cost time: 25.465466499328613
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.981989).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0004391
	speed: 0.2873s/iter; left time: 10481.0451s
	iters: 200, epoch: 23 | loss: 0.0051499
	speed: 0.0538s/iter; left time: 1958.8426s
	iters: 300, epoch: 23 | loss: 0.0014727
	speed: 0.0532s/iter; left time: 1929.2506s
	iters: 400, epoch: 23 | loss: 0.0000450
	speed: 0.0516s/iter; left time: 1865.5586s
Epoch: 23 cost time: 25.43043088912964
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0018136
	speed: 0.2858s/iter; left time: 10293.5052s
	iters: 200, epoch: 24 | loss: 0.0018161
	speed: 0.0563s/iter; left time: 2020.9749s
	iters: 300, epoch: 24 | loss: 0.0002855
	speed: 0.0520s/iter; left time: 1861.1247s
	iters: 400, epoch: 24 | loss: 0.0093446
	speed: 0.0511s/iter; left time: 1825.8501s
Epoch: 24 cost time: 25.621175527572632
Epoch: 24, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0715008
	speed: 0.2942s/iter; left time: 10458.4319s
	iters: 200, epoch: 25 | loss: 0.0455043
	speed: 0.0545s/iter; left time: 1932.3224s
	iters: 300, epoch: 25 | loss: 0.0045147
	speed: 0.0562s/iter; left time: 1987.2375s
	iters: 400, epoch: 25 | loss: 0.0088020
	speed: 0.0552s/iter; left time: 1946.2573s
Epoch: 25 cost time: 26.508435249328613
Epoch: 25, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0047716
	speed: 0.3073s/iter; left time: 10778.6700s
	iters: 200, epoch: 26 | loss: 0.0015849
	speed: 0.0589s/iter; left time: 2061.6236s
	iters: 300, epoch: 26 | loss: 0.0034931
	speed: 0.0520s/iter; left time: 1812.9811s
	iters: 400, epoch: 26 | loss: 0.0003109
	speed: 0.0537s/iter; left time: 1868.5835s
Epoch: 26 cost time: 26.750645399093628
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0025971
	speed: 0.2646s/iter; left time: 9156.8048s
	iters: 200, epoch: 27 | loss: 0.0030224
	speed: 0.0573s/iter; left time: 1978.0092s
	iters: 300, epoch: 27 | loss: 0.0002837
	speed: 0.0563s/iter; left time: 1935.8488s
	iters: 400, epoch: 27 | loss: 0.0033736
	speed: 0.0540s/iter; left time: 1853.7943s
Epoch: 27 cost time: 26.57030701637268
Epoch: 27, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0002683
	speed: 0.2843s/iter; left time: 9705.0045s
	iters: 200, epoch: 28 | loss: 0.0045729
	speed: 0.0541s/iter; left time: 1841.8388s
	iters: 300, epoch: 28 | loss: 0.0014773
	speed: 0.0551s/iter; left time: 1868.4730s
	iters: 400, epoch: 28 | loss: 0.0000583
	speed: 0.0561s/iter; left time: 1897.5512s
Epoch: 28 cost time: 26.06614923477173
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0262073
	speed: 0.2709s/iter; left time: 9122.5832s
	iters: 200, epoch: 29 | loss: 0.0005215
	speed: 0.0513s/iter; left time: 1723.5629s
	iters: 300, epoch: 29 | loss: 0.2022627
	speed: 0.0518s/iter; left time: 1734.9377s
	iters: 400, epoch: 29 | loss: 0.0004830
	speed: 0.0542s/iter; left time: 1807.6642s
Epoch: 29 cost time: 24.999852657318115
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.1265703
	speed: 0.2759s/iter; left time: 9159.7574s
	iters: 200, epoch: 30 | loss: 0.0696638
	speed: 0.0510s/iter; left time: 1686.4556s
	iters: 300, epoch: 30 | loss: 0.0001525
	speed: 0.0530s/iter; left time: 1747.5241s
	iters: 400, epoch: 30 | loss: 0.0028423
	speed: 0.0552s/iter; left time: 1814.9138s
Epoch: 30 cost time: 24.972850561141968
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.982560).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0521919
	speed: 0.2846s/iter; left time: 9316.4629s
	iters: 200, epoch: 31 | loss: 0.2862177
	speed: 0.0534s/iter; left time: 1741.8404s
	iters: 300, epoch: 31 | loss: 0.0002743
	speed: 0.0542s/iter; left time: 1764.2334s
	iters: 400, epoch: 31 | loss: 0.0268865
	speed: 0.0569s/iter; left time: 1845.1100s
Epoch: 31 cost time: 26.227327585220337
Epoch: 31, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0582570
	speed: 0.2910s/iter; left time: 9388.3307s
	iters: 200, epoch: 32 | loss: 0.0001751
	speed: 0.0518s/iter; left time: 1664.5022s
	iters: 300, epoch: 32 | loss: 0.0244197
	speed: 0.0570s/iter; left time: 1826.1533s
	iters: 400, epoch: 32 | loss: 0.0016667
	speed: 0.0549s/iter; left time: 1754.2088s
Epoch: 32 cost time: 26.02052330970764
Epoch: 32, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0029811
	speed: 0.2841s/iter; left time: 9033.5444s
	iters: 200, epoch: 33 | loss: 0.0237482
	speed: 0.0490s/iter; left time: 1552.4588s
	iters: 300, epoch: 33 | loss: 0.0016440
	speed: 0.0530s/iter; left time: 1673.4096s
	iters: 400, epoch: 33 | loss: 0.0002601
	speed: 0.0536s/iter; left time: 1686.7892s
Epoch: 33 cost time: 24.773247003555298
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0182202
	speed: 0.2754s/iter; left time: 8625.1470s
	iters: 200, epoch: 34 | loss: 0.0003431
	speed: 0.0495s/iter; left time: 1545.7787s
	iters: 300, epoch: 34 | loss: 0.0014037
	speed: 0.0523s/iter; left time: 1628.1540s
	iters: 400, epoch: 34 | loss: 0.0486077
	speed: 0.0530s/iter; left time: 1643.5493s
Epoch: 34 cost time: 24.87785577774048
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.982560 --> -0.982846).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0005685
	speed: 0.2839s/iter; left time: 8760.3186s
	iters: 200, epoch: 35 | loss: 0.0052354
	speed: 0.0509s/iter; left time: 1566.8069s
	iters: 300, epoch: 35 | loss: 0.0041658
	speed: 0.0540s/iter; left time: 1654.4323s
	iters: 400, epoch: 35 | loss: 0.0009501
	speed: 0.0552s/iter; left time: 1687.0782s
Epoch: 35 cost time: 24.993084192276
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
Validation loss decreased (-0.982846 --> -0.984562).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0547009
	speed: 0.2768s/iter; left time: 8411.6875s
	iters: 200, epoch: 36 | loss: 0.0006046
	speed: 0.0510s/iter; left time: 1545.0436s
	iters: 300, epoch: 36 | loss: 0.0019985
	speed: 0.0497s/iter; left time: 1501.1699s
	iters: 400, epoch: 36 | loss: 0.0056799
	speed: 0.0567s/iter; left time: 1705.8677s
Epoch: 36 cost time: 24.992186784744263
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0095828
	speed: 0.2928s/iter; left time: 8759.2560s
	iters: 200, epoch: 37 | loss: 0.0005936
	speed: 0.0563s/iter; left time: 1678.1962s
	iters: 300, epoch: 37 | loss: 0.0821331
	speed: 0.0540s/iter; left time: 1604.5668s
	iters: 400, epoch: 37 | loss: 0.2063416
	speed: 0.0557s/iter; left time: 1650.6597s
Epoch: 37 cost time: 26.404076099395752
Epoch: 37, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0002839
	speed: 0.2943s/iter; left time: 8665.5456s
	iters: 200, epoch: 38 | loss: 0.0018021
	speed: 0.0532s/iter; left time: 1560.3681s
	iters: 300, epoch: 38 | loss: 0.0000753
	speed: 0.0554s/iter; left time: 1621.6648s
	iters: 400, epoch: 38 | loss: 0.0013825
	speed: 0.0569s/iter; left time: 1658.4777s
Epoch: 38 cost time: 26.240671157836914
Epoch: 38, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0489926
	speed: 0.2840s/iter; left time: 8228.8701s
	iters: 200, epoch: 39 | loss: 0.0015137
	speed: 0.0485s/iter; left time: 1401.9003s
	iters: 300, epoch: 39 | loss: 0.0045451
	speed: 0.0514s/iter; left time: 1479.6700s
	iters: 400, epoch: 39 | loss: 0.0009678
	speed: 0.0541s/iter; left time: 1551.5610s
Epoch: 39 cost time: 24.600162267684937
Epoch: 39, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0018148
	speed: 0.2780s/iter; left time: 7926.9299s
	iters: 200, epoch: 40 | loss: 0.0001080
	speed: 0.0513s/iter; left time: 1456.5009s
	iters: 300, epoch: 40 | loss: 0.0350737
	speed: 0.0495s/iter; left time: 1400.4784s
	iters: 400, epoch: 40 | loss: 0.0136239
	speed: 0.0486s/iter; left time: 1371.1719s
Epoch: 40 cost time: 23.99572253227234
Epoch: 40, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0021175
	speed: 0.2819s/iter; left time: 7903.5080s
	iters: 200, epoch: 41 | loss: 0.0002021
	speed: 0.0494s/iter; left time: 1379.8582s
	iters: 300, epoch: 41 | loss: 0.0043615
	speed: 0.0508s/iter; left time: 1415.5735s
	iters: 400, epoch: 41 | loss: 0.0023061
	speed: 0.0510s/iter; left time: 1414.6557s
Epoch: 41 cost time: 25.00091528892517
Epoch: 41, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0171333
	speed: 0.2957s/iter; left time: 8154.0882s
	iters: 200, epoch: 42 | loss: 0.0136072
	speed: 0.0529s/iter; left time: 1452.7502s
	iters: 300, epoch: 42 | loss: 0.0016941
	speed: 0.0526s/iter; left time: 1439.8394s
	iters: 400, epoch: 42 | loss: 0.0032407
	speed: 0.0568s/iter; left time: 1548.2020s
Epoch: 42 cost time: 26.565919876098633
Epoch: 42, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0041147
	speed: 0.3051s/iter; left time: 8268.0882s
	iters: 200, epoch: 43 | loss: 0.0140165
	speed: 0.0569s/iter; left time: 1535.1778s
	iters: 300, epoch: 43 | loss: 0.0005778
	speed: 0.0572s/iter; left time: 1539.3853s
	iters: 400, epoch: 43 | loss: 0.0049158
	speed: 0.0526s/iter; left time: 1409.4195s
Epoch: 43 cost time: 26.342612504959106
Epoch: 43, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0001762
	speed: 0.2982s/iter; left time: 7941.8801s
	iters: 200, epoch: 44 | loss: 0.0785403
	speed: 0.0553s/iter; left time: 1466.8886s
	iters: 300, epoch: 44 | loss: 0.0001996
	speed: 0.0530s/iter; left time: 1401.5693s
	iters: 400, epoch: 44 | loss: 0.0144351
	speed: 0.0543s/iter; left time: 1430.8054s
Epoch: 44 cost time: 26.47557497024536
Epoch: 44, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0001107
	speed: 0.2957s/iter; left time: 7737.8204s
	iters: 200, epoch: 45 | loss: 0.0045239
	speed: 0.0527s/iter; left time: 1372.6604s
	iters: 300, epoch: 45 | loss: 0.0000873
	speed: 0.0517s/iter; left time: 1342.5282s
	iters: 400, epoch: 45 | loss: 0.0005067
	speed: 0.0547s/iter; left time: 1414.0633s
Epoch: 45 cost time: 26.037280321121216
Epoch: 45, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 40122
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6734312
	speed: 0.0746s/iter; left time: 3493.5256s
	iters: 200, epoch: 1 | loss: 0.8174761
	speed: 0.0543s/iter; left time: 2535.3637s
	iters: 300, epoch: 1 | loss: 0.4277901
	speed: 0.0576s/iter; left time: 2682.5858s
	iters: 400, epoch: 1 | loss: 0.3256088
	speed: 0.0517s/iter; left time: 2401.8856s
Epoch: 1 cost time: 27.421212673187256
Epoch: 1, Steps: 469 | Train Loss: 1.077 Vali Loss: 0.492 Vali Acc: 0.843 Test Loss: 0.492 Test Acc: 0.843
Validation loss decreased (inf --> -0.843048).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3710734
	speed: 0.2821s/iter; left time: 13071.7131s
	iters: 200, epoch: 2 | loss: 0.1019676
	speed: 0.0561s/iter; left time: 2593.9271s
	iters: 300, epoch: 2 | loss: 0.4026319
	speed: 0.0561s/iter; left time: 2586.6689s
	iters: 400, epoch: 2 | loss: 0.1752884
	speed: 0.0581s/iter; left time: 2674.0646s
Epoch: 2 cost time: 26.937850952148438
Epoch: 2, Steps: 469 | Train Loss: 0.311 Vali Loss: 0.316 Vali Acc: 0.903 Test Loss: 0.316 Test Acc: 0.903
Validation loss decreased (-0.843048 --> -0.903084).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0582202
	speed: 0.2881s/iter; left time: 13215.1571s
	iters: 200, epoch: 3 | loss: 0.0634027
	speed: 0.0593s/iter; left time: 2713.2115s
	iters: 300, epoch: 3 | loss: 0.4174763
	speed: 0.0551s/iter; left time: 2516.0560s
	iters: 400, epoch: 3 | loss: 0.2157796
	speed: 0.0581s/iter; left time: 2646.3674s
Epoch: 3 cost time: 26.98743200302124
Epoch: 3, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.279 Vali Acc: 0.913 Test Loss: 0.279 Test Acc: 0.913
Validation loss decreased (-0.903084 --> -0.913090).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1157365
	speed: 0.2796s/iter; left time: 12690.1681s
	iters: 200, epoch: 4 | loss: 0.0655660
	speed: 0.0575s/iter; left time: 2606.4609s
	iters: 300, epoch: 4 | loss: 0.0479799
	speed: 0.0603s/iter; left time: 2723.8878s
	iters: 400, epoch: 4 | loss: 0.2905106
	speed: 0.0566s/iter; left time: 2552.2207s
Epoch: 4 cost time: 26.661640644073486
Epoch: 4, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.913090 --> -0.937391).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6464761
	speed: 0.2707s/iter; left time: 12163.3294s
	iters: 200, epoch: 5 | loss: 0.1862702
	speed: 0.0551s/iter; left time: 2471.4226s
	iters: 300, epoch: 5 | loss: 0.1094764
	speed: 0.0535s/iter; left time: 2394.5265s
	iters: 400, epoch: 5 | loss: 0.0636819
	speed: 0.0547s/iter; left time: 2441.2115s
Epoch: 5 cost time: 26.24135732650757
Epoch: 5, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.937391 --> -0.945681).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2708137
	speed: 0.2846s/iter; left time: 12650.1807s
	iters: 200, epoch: 6 | loss: 0.0295255
	speed: 0.0540s/iter; left time: 2394.4581s
	iters: 300, epoch: 6 | loss: 0.1269659
	speed: 0.0579s/iter; left time: 2562.0566s
	iters: 400, epoch: 6 | loss: 0.2953511
	speed: 0.0572s/iter; left time: 2523.8594s
Epoch: 6 cost time: 26.522162199020386
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.945681 --> -0.952257).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1575370
	speed: 0.2628s/iter; left time: 11561.1852s
	iters: 200, epoch: 7 | loss: 0.1020109
	speed: 0.0580s/iter; left time: 2543.3698s
	iters: 300, epoch: 7 | loss: 0.1190458
	speed: 0.0546s/iter; left time: 2391.7698s
	iters: 400, epoch: 7 | loss: 0.0460537
	speed: 0.0536s/iter; left time: 2341.5730s
Epoch: 7 cost time: 26.327464818954468
Epoch: 7, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.952257 --> -0.957974).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0877865
	speed: 0.2705s/iter; left time: 11773.1623s
	iters: 200, epoch: 8 | loss: 0.2465640
	speed: 0.0553s/iter; left time: 2399.8206s
	iters: 300, epoch: 8 | loss: 0.0473591
	speed: 0.0573s/iter; left time: 2484.1461s
	iters: 400, epoch: 8 | loss: 0.0449484
	speed: 0.0545s/iter; left time: 2356.6453s
Epoch: 8 cost time: 25.75173854827881
Epoch: 8, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
Validation loss decreased (-0.957974 --> -0.959690).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.2638063
	speed: 0.2860s/iter; left time: 12310.5254s
	iters: 200, epoch: 9 | loss: 0.0070411
	speed: 0.0552s/iter; left time: 2369.4015s
	iters: 300, epoch: 9 | loss: 0.1782900
	speed: 0.0554s/iter; left time: 2372.7826s
	iters: 400, epoch: 9 | loss: 0.0394598
	speed: 0.0585s/iter; left time: 2501.0610s
Epoch: 9 cost time: 26.290870189666748
Epoch: 9, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.959690 --> -0.972269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0092980
	speed: 0.2754s/iter; left time: 11726.5716s
	iters: 200, epoch: 10 | loss: 0.0440807
	speed: 0.0592s/iter; left time: 2516.7675s
	iters: 300, epoch: 10 | loss: 0.0211305
	speed: 0.0582s/iter; left time: 2468.4591s
	iters: 400, epoch: 10 | loss: 0.0477049
	speed: 0.0593s/iter; left time: 2507.4537s
Epoch: 10 cost time: 27.67487668991089
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0782301
	speed: 0.2904s/iter; left time: 12227.3246s
	iters: 200, epoch: 11 | loss: 0.1762766
	speed: 0.0528s/iter; left time: 2216.0932s
	iters: 300, epoch: 11 | loss: 0.0298255
	speed: 0.0568s/iter; left time: 2379.6414s
	iters: 400, epoch: 11 | loss: 0.0131247
	speed: 0.0558s/iter; left time: 2331.5675s
Epoch: 11 cost time: 26.674755096435547
Epoch: 11, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0464118
	speed: 0.2932s/iter; left time: 12209.6917s
	iters: 200, epoch: 12 | loss: 0.0592492
	speed: 0.0521s/iter; left time: 2164.8195s
	iters: 300, epoch: 12 | loss: 0.7507045
	speed: 0.0573s/iter; left time: 2373.6892s
	iters: 400, epoch: 12 | loss: 0.0101275
	speed: 0.0584s/iter; left time: 2415.8795s
Epoch: 12 cost time: 26.446118593215942
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.972269 --> -0.973984).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0052400
	speed: 0.2884s/iter; left time: 11876.2666s
	iters: 200, epoch: 13 | loss: 0.1015776
	speed: 0.0528s/iter; left time: 2169.7345s
	iters: 300, epoch: 13 | loss: 0.0703965
	speed: 0.0540s/iter; left time: 2213.2414s
	iters: 400, epoch: 13 | loss: 0.0175058
	speed: 0.0537s/iter; left time: 2195.3771s
Epoch: 13 cost time: 25.63221549987793
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0148012
	speed: 0.2831s/iter; left time: 11522.2735s
	iters: 200, epoch: 14 | loss: 0.0044809
	speed: 0.0500s/iter; left time: 2030.6523s
	iters: 300, epoch: 14 | loss: 0.0478520
	speed: 0.0496s/iter; left time: 2010.0813s
	iters: 400, epoch: 14 | loss: 0.0112345
	speed: 0.0498s/iter; left time: 2013.8867s
Epoch: 14 cost time: 23.778501272201538
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0108613
	speed: 0.2932s/iter; left time: 11797.7050s
	iters: 200, epoch: 15 | loss: 0.0140128
	speed: 0.0525s/iter; left time: 2106.5152s
	iters: 300, epoch: 15 | loss: 0.0141157
	speed: 0.0395s/iter; left time: 1580.2586s
	iters: 400, epoch: 15 | loss: 0.0539166
	speed: 0.0382s/iter; left time: 1523.8873s
Epoch: 15 cost time: 22.643874168395996
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0110970
	speed: 0.2376s/iter; left time: 9446.6625s
	iters: 200, epoch: 16 | loss: 0.0395355
	speed: 0.0528s/iter; left time: 2094.0105s
	iters: 300, epoch: 16 | loss: 0.0200153
	speed: 0.0563s/iter; left time: 2228.3572s
	iters: 400, epoch: 16 | loss: 0.0861075
	speed: 0.0570s/iter; left time: 2251.1081s
Epoch: 16 cost time: 26.102648973464966
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973984 --> -0.976557).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0102554
	speed: 0.2830s/iter; left time: 11119.1860s
	iters: 200, epoch: 17 | loss: 0.0022613
	speed: 0.0553s/iter; left time: 2167.5796s
	iters: 300, epoch: 17 | loss: 0.0594124
	speed: 0.0545s/iter; left time: 2132.5541s
	iters: 400, epoch: 17 | loss: 0.0330542
	speed: 0.0523s/iter; left time: 2040.2855s
Epoch: 17 cost time: 25.863441705703735
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0843983
	speed: 0.2653s/iter; left time: 10299.6226s
	iters: 200, epoch: 18 | loss: 0.1030620
	speed: 0.0519s/iter; left time: 2009.2772s
	iters: 300, epoch: 18 | loss: 0.0050713
	speed: 0.0525s/iter; left time: 2029.8666s
	iters: 400, epoch: 18 | loss: 0.0050041
	speed: 0.0503s/iter; left time: 1938.2352s
Epoch: 18 cost time: 24.627660512924194
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0611310
	speed: 0.2743s/iter; left time: 10521.2476s
	iters: 200, epoch: 19 | loss: 0.1985612
	speed: 0.0488s/iter; left time: 1866.4997s
	iters: 300, epoch: 19 | loss: 0.0706662
	speed: 0.0527s/iter; left time: 2012.4480s
	iters: 400, epoch: 19 | loss: 0.0041206
	speed: 0.0538s/iter; left time: 2048.8661s
Epoch: 19 cost time: 25.037609100341797
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977415).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0680523
	speed: 0.2697s/iter; left time: 10218.1477s
	iters: 200, epoch: 20 | loss: 0.0102651
	speed: 0.0551s/iter; left time: 2081.5834s
	iters: 300, epoch: 20 | loss: 0.0038067
	speed: 0.0537s/iter; left time: 2024.4314s
	iters: 400, epoch: 20 | loss: 0.0627552
	speed: 0.0523s/iter; left time: 1966.9728s
Epoch: 20 cost time: 25.291319131851196
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1626787
	speed: 0.2706s/iter; left time: 10124.8226s
	iters: 200, epoch: 21 | loss: 0.0033016
	speed: 0.0540s/iter; left time: 2016.0640s
	iters: 300, epoch: 21 | loss: 0.0141275
	speed: 0.0555s/iter; left time: 2064.3521s
	iters: 400, epoch: 21 | loss: 0.0039183
	speed: 0.0544s/iter; left time: 2018.3210s
Epoch: 21 cost time: 26.085421323776245
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.2090426
	speed: 0.2676s/iter; left time: 9888.3053s
	iters: 200, epoch: 22 | loss: 0.0080743
	speed: 0.0561s/iter; left time: 2066.0344s
	iters: 300, epoch: 22 | loss: 0.0007183
	speed: 0.0533s/iter; left time: 1959.8636s
	iters: 400, epoch: 22 | loss: 0.0849571
	speed: 0.0507s/iter; left time: 1857.1432s
Epoch: 22 cost time: 25.591041564941406
Epoch: 22, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0183760
	speed: 0.2799s/iter; left time: 10213.2627s
	iters: 200, epoch: 23 | loss: 0.0116625
	speed: 0.0518s/iter; left time: 1884.2956s
	iters: 300, epoch: 23 | loss: 0.0163690
	speed: 0.0551s/iter; left time: 2000.0458s
	iters: 400, epoch: 23 | loss: 0.0010956
	speed: 0.0534s/iter; left time: 1932.2188s
Epoch: 23 cost time: 25.341904163360596
Epoch: 23, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.2521412
	speed: 0.2736s/iter; left time: 9853.7114s
	iters: 200, epoch: 24 | loss: 0.0007784
	speed: 0.0509s/iter; left time: 1829.5730s
	iters: 300, epoch: 24 | loss: 0.0051187
	speed: 0.0534s/iter; left time: 1912.5085s
	iters: 400, epoch: 24 | loss: 0.4778817
	speed: 0.0535s/iter; left time: 1909.6274s
Epoch: 24 cost time: 25.576355934143066
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0011266
	speed: 0.2642s/iter; left time: 9389.2878s
	iters: 200, epoch: 25 | loss: 0.0038762
	speed: 0.0510s/iter; left time: 1805.9955s
	iters: 300, epoch: 25 | loss: 0.0042352
	speed: 0.0535s/iter; left time: 1890.4700s
	iters: 400, epoch: 25 | loss: 0.1351842
	speed: 0.0520s/iter; left time: 1831.4789s
Epoch: 25 cost time: 24.88565492630005
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.1490642
	speed: 0.2666s/iter; left time: 9350.2926s
	iters: 200, epoch: 26 | loss: 0.0149649
	speed: 0.0512s/iter; left time: 1791.0611s
	iters: 300, epoch: 26 | loss: 0.0033886
	speed: 0.0512s/iter; left time: 1784.0803s
	iters: 400, epoch: 26 | loss: 0.0102549
	speed: 0.0516s/iter; left time: 1795.1569s
Epoch: 26 cost time: 24.84481120109558
Epoch: 26, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.980559).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0008686
	speed: 0.2748s/iter; left time: 9511.4538s
	iters: 200, epoch: 27 | loss: 0.0255488
	speed: 0.0551s/iter; left time: 1902.8540s
	iters: 300, epoch: 27 | loss: 0.0757903
	speed: 0.0573s/iter; left time: 1970.0325s
	iters: 400, epoch: 27 | loss: 0.0071617
	speed: 0.0544s/iter; left time: 1865.6335s
Epoch: 27 cost time: 25.63607621192932
Epoch: 27, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0089663
	speed: 0.2739s/iter; left time: 9349.4955s
	iters: 200, epoch: 28 | loss: 0.0025259
	speed: 0.0524s/iter; left time: 1783.7906s
	iters: 300, epoch: 28 | loss: 0.0053964
	speed: 0.0537s/iter; left time: 1821.9792s
	iters: 400, epoch: 28 | loss: 0.0463959
	speed: 0.0560s/iter; left time: 1896.0717s
Epoch: 28 cost time: 26.1879940032959
Epoch: 28, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0065294
	speed: 0.2723s/iter; left time: 9169.5001s
	iters: 200, epoch: 29 | loss: 0.0011145
	speed: 0.0515s/iter; left time: 1728.0069s
	iters: 300, epoch: 29 | loss: 0.0227730
	speed: 0.0539s/iter; left time: 1803.9716s
	iters: 400, epoch: 29 | loss: 0.1018935
	speed: 0.0506s/iter; left time: 1689.9763s
Epoch: 29 cost time: 24.657342433929443
Epoch: 29, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0039315
	speed: 0.2704s/iter; left time: 8977.2106s
	iters: 200, epoch: 30 | loss: 0.0005886
	speed: 0.0507s/iter; left time: 1678.7156s
	iters: 300, epoch: 30 | loss: 0.0223577
	speed: 0.0532s/iter; left time: 1756.0891s
	iters: 400, epoch: 30 | loss: 0.0366099
	speed: 0.0551s/iter; left time: 1811.8148s
Epoch: 30 cost time: 25.00759220123291
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0265367
	speed: 0.2631s/iter; left time: 8611.2647s
	iters: 200, epoch: 31 | loss: 0.0093175
	speed: 0.0523s/iter; left time: 1705.3365s
	iters: 300, epoch: 31 | loss: 0.0136926
	speed: 0.0544s/iter; left time: 1768.1244s
	iters: 400, epoch: 31 | loss: 0.2027941
	speed: 0.0508s/iter; left time: 1645.8916s
Epoch: 31 cost time: 24.69228506088257
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0024645
	speed: 0.2732s/iter; left time: 8814.6113s
	iters: 200, epoch: 32 | loss: 0.0004995
	speed: 0.0482s/iter; left time: 1548.7408s
	iters: 300, epoch: 32 | loss: 0.0244981
	speed: 0.0519s/iter; left time: 1663.6894s
	iters: 400, epoch: 32 | loss: 0.0087062
	speed: 0.0548s/iter; left time: 1751.0210s
Epoch: 32 cost time: 24.903780460357666
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0321329
	speed: 0.2717s/iter; left time: 8638.4883s
	iters: 200, epoch: 33 | loss: 0.2434987
	speed: 0.0535s/iter; left time: 1694.1194s
	iters: 300, epoch: 33 | loss: 0.0020975
	speed: 0.0511s/iter; left time: 1615.3326s
	iters: 400, epoch: 33 | loss: 0.0099374
	speed: 0.0469s/iter; left time: 1476.8037s
Epoch: 33 cost time: 23.792502880096436
Epoch: 33, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0270251
	speed: 0.2763s/iter; left time: 8654.1941s
	iters: 200, epoch: 34 | loss: 0.0366807
	speed: 0.0582s/iter; left time: 1817.5494s
	iters: 300, epoch: 34 | loss: 0.1579147
	speed: 0.0605s/iter; left time: 1881.5536s
	iters: 400, epoch: 34 | loss: 0.0586794
	speed: 0.0527s/iter; left time: 1636.0205s
Epoch: 34 cost time: 26.62586998939514
Epoch: 34, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0392207
	speed: 0.2763s/iter; left time: 8526.6584s
	iters: 200, epoch: 35 | loss: 0.1054438
	speed: 0.0565s/iter; left time: 1737.8986s
	iters: 300, epoch: 35 | loss: 0.1300692
	speed: 0.0566s/iter; left time: 1735.3684s
	iters: 400, epoch: 35 | loss: 0.0006398
	speed: 0.0540s/iter; left time: 1648.8264s
Epoch: 35 cost time: 25.885610818862915
Epoch: 35, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0008220
	speed: 0.2793s/iter; left time: 8485.3139s
	iters: 200, epoch: 36 | loss: 0.1860377
	speed: 0.0533s/iter; left time: 1614.4641s
	iters: 300, epoch: 36 | loss: 0.0025085
	speed: 0.0565s/iter; left time: 1706.5205s
	iters: 400, epoch: 36 | loss: 0.0090698
	speed: 0.0533s/iter; left time: 1603.8076s
Epoch: 36 cost time: 25.923930406570435
Epoch: 36, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 269946
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5492811
	speed: 0.0717s/iter; left time: 3355.1013s
	iters: 200, epoch: 1 | loss: 0.8141294
	speed: 0.0488s/iter; left time: 2277.6120s
	iters: 300, epoch: 1 | loss: 0.3550716
	speed: 0.0490s/iter; left time: 2282.4204s
	iters: 400, epoch: 1 | loss: 0.2993877
	speed: 0.0546s/iter; left time: 2537.0403s
Epoch: 1 cost time: 26.442108392715454
Epoch: 1, Steps: 469 | Train Loss: 1.036 Vali Loss: 0.440 Vali Acc: 0.859 Test Loss: 0.440 Test Acc: 0.859
Validation loss decreased (inf --> -0.859058).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3587084
	speed: 0.3030s/iter; left time: 14038.1718s
	iters: 200, epoch: 2 | loss: 0.0911746
	speed: 0.0513s/iter; left time: 2372.9131s
	iters: 300, epoch: 2 | loss: 0.4808197
	speed: 0.0502s/iter; left time: 2315.4131s
	iters: 400, epoch: 2 | loss: 0.1427749
	speed: 0.0530s/iter; left time: 2440.1120s
Epoch: 2 cost time: 25.484344244003296
Epoch: 2, Steps: 469 | Train Loss: 0.304 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
Validation loss decreased (-0.859058 --> -0.918808).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0763778
	speed: 0.2959s/iter; left time: 13571.9833s
	iters: 200, epoch: 3 | loss: 0.0640733
	speed: 0.0518s/iter; left time: 2369.8754s
	iters: 300, epoch: 3 | loss: 0.3357564
	speed: 0.0532s/iter; left time: 2427.4119s
	iters: 400, epoch: 3 | loss: 0.2659255
	speed: 0.0545s/iter; left time: 2480.9934s
Epoch: 3 cost time: 25.58910036087036
Epoch: 3, Steps: 469 | Train Loss: 0.205 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.918808 --> -0.933102).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0632979
	speed: 0.2940s/iter; left time: 13343.9304s
	iters: 200, epoch: 4 | loss: 0.0487098
	speed: 0.0492s/iter; left time: 2227.2366s
	iters: 300, epoch: 4 | loss: 0.0597153
	speed: 0.0491s/iter; left time: 2220.0463s
	iters: 400, epoch: 4 | loss: 0.2749346
	speed: 0.0511s/iter; left time: 2302.3185s
Epoch: 4 cost time: 24.989048719406128
Epoch: 4, Steps: 469 | Train Loss: 0.164 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.933102 --> -0.942251).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6059900
	speed: 0.2912s/iter; left time: 13081.6696s
	iters: 200, epoch: 5 | loss: 0.1363060
	speed: 0.0517s/iter; left time: 2315.2850s
	iters: 300, epoch: 5 | loss: 0.1032572
	speed: 0.0703s/iter; left time: 3145.5904s
	iters: 400, epoch: 5 | loss: 0.1239945
	speed: 0.0713s/iter; left time: 3182.5780s
Epoch: 5 cost time: 29.308985233306885
Epoch: 5, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.942251 --> -0.954829).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1046203
	speed: 0.3602s/iter; left time: 16012.6512s
	iters: 200, epoch: 6 | loss: 0.0204573
	speed: 0.0661s/iter; left time: 2931.0002s
	iters: 300, epoch: 6 | loss: 0.0981453
	speed: 0.0589s/iter; left time: 2607.0090s
	iters: 400, epoch: 6 | loss: 0.1560403
	speed: 0.0639s/iter; left time: 2820.3245s
Epoch: 6 cost time: 31.165745735168457
Epoch: 6, Steps: 469 | Train Loss: 0.113 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2506743
	speed: 0.3703s/iter; left time: 16290.3720s
	iters: 200, epoch: 7 | loss: 0.0310657
	speed: 0.0723s/iter; left time: 3171.1751s
	iters: 300, epoch: 7 | loss: 0.0809106
	speed: 0.0641s/iter; left time: 2808.4708s
	iters: 400, epoch: 7 | loss: 0.0607703
	speed: 0.0647s/iter; left time: 2824.4396s
Epoch: 7 cost time: 31.782484531402588
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.954829 --> -0.962548).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0382918
	speed: 0.3720s/iter; left time: 16190.6753s
	iters: 200, epoch: 8 | loss: 0.2553928
	speed: 0.0679s/iter; left time: 2950.2478s
	iters: 300, epoch: 8 | loss: 0.0565445
	speed: 0.0707s/iter; left time: 3061.0759s
	iters: 400, epoch: 8 | loss: 0.0296065
	speed: 0.0734s/iter; left time: 3170.5208s
Epoch: 8 cost time: 32.95085525512695
Epoch: 8, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0957501
	speed: 0.3694s/iter; left time: 15901.8361s
	iters: 200, epoch: 9 | loss: 0.0184246
	speed: 0.0667s/iter; left time: 2865.9958s
	iters: 300, epoch: 9 | loss: 0.0517359
	speed: 0.0657s/iter; left time: 2815.0085s
	iters: 400, epoch: 9 | loss: 0.0522527
	speed: 0.0633s/iter; left time: 2706.0812s
Epoch: 9 cost time: 31.554736852645874
Epoch: 9, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.962548 --> -0.968266).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0055744
	speed: 0.3620s/iter; left time: 15415.2147s
	iters: 200, epoch: 10 | loss: 0.0510430
	speed: 0.0702s/iter; left time: 2982.5075s
	iters: 300, epoch: 10 | loss: 0.0518071
	speed: 0.0680s/iter; left time: 2879.9168s
	iters: 400, epoch: 10 | loss: 0.0229148
	speed: 0.0628s/iter; left time: 2656.2577s
Epoch: 10 cost time: 31.314949989318848
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0994517
	speed: 0.3498s/iter; left time: 14729.4925s
	iters: 200, epoch: 11 | loss: 0.0769292
	speed: 0.0645s/iter; left time: 2708.2171s
	iters: 300, epoch: 11 | loss: 0.0712547
	speed: 0.0632s/iter; left time: 2648.5181s
	iters: 400, epoch: 11 | loss: 0.0378565
	speed: 0.0630s/iter; left time: 2632.8794s
Epoch: 11 cost time: 30.593616724014282
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0495278
	speed: 0.3477s/iter; left time: 14478.7312s
	iters: 200, epoch: 12 | loss: 0.1470869
	speed: 0.0705s/iter; left time: 2926.7754s
	iters: 300, epoch: 12 | loss: 0.5968359
	speed: 0.0719s/iter; left time: 2978.2846s
	iters: 400, epoch: 12 | loss: 0.0075691
	speed: 0.0646s/iter; left time: 2669.9214s
Epoch: 12 cost time: 32.03498363494873
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.968266 --> -0.975413).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0066589
	speed: 0.3587s/iter; left time: 14767.8323s
	iters: 200, epoch: 13 | loss: 0.1720976
	speed: 0.0686s/iter; left time: 2817.3098s
	iters: 300, epoch: 13 | loss: 0.0871243
	speed: 0.0686s/iter; left time: 2812.5261s
	iters: 400, epoch: 13 | loss: 0.0164137
	speed: 0.0699s/iter; left time: 2856.1892s
Epoch: 13 cost time: 32.625539779663086
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0301331
	speed: 0.3618s/iter; left time: 14725.9013s
	iters: 200, epoch: 14 | loss: 0.0092340
	speed: 0.0677s/iter; left time: 2748.1630s
	iters: 300, epoch: 14 | loss: 0.0981050
	speed: 0.0660s/iter; left time: 2674.8236s
	iters: 400, epoch: 14 | loss: 0.0435736
	speed: 0.0645s/iter; left time: 2605.5797s
Epoch: 14 cost time: 31.724767684936523
Epoch: 14, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0046904
	speed: 0.3466s/iter; left time: 13945.8587s
	iters: 200, epoch: 15 | loss: 0.0233630
	speed: 0.0664s/iter; left time: 2665.8286s
	iters: 300, epoch: 15 | loss: 0.0144443
	speed: 0.0674s/iter; left time: 2697.7582s
	iters: 400, epoch: 15 | loss: 0.0421595
	speed: 0.0680s/iter; left time: 2716.8725s
Epoch: 15 cost time: 31.421217441558838
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0079291
	speed: 0.3161s/iter; left time: 12570.5781s
	iters: 200, epoch: 16 | loss: 0.0574977
	speed: 0.0636s/iter; left time: 2521.7381s
	iters: 300, epoch: 16 | loss: 0.0146078
	speed: 0.0644s/iter; left time: 2549.5411s
	iters: 400, epoch: 16 | loss: 0.0369664
	speed: 0.0596s/iter; left time: 2350.8539s
Epoch: 16 cost time: 30.093015432357788
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0167459
	speed: 0.3460s/iter; left time: 13595.7838s
	iters: 200, epoch: 17 | loss: 0.0184886
	speed: 0.0660s/iter; left time: 2586.4218s
	iters: 300, epoch: 17 | loss: 0.0382781
	speed: 0.0699s/iter; left time: 2734.3475s
	iters: 400, epoch: 17 | loss: 0.0848894
	speed: 0.0682s/iter; left time: 2658.1728s
Epoch: 17 cost time: 31.53043508529663
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976843).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0193074
	speed: 0.3539s/iter; left time: 13742.7188s
	iters: 200, epoch: 18 | loss: 0.0664265
	speed: 0.0625s/iter; left time: 2418.6052s
	iters: 300, epoch: 18 | loss: 0.0324153
	speed: 0.0630s/iter; left time: 2431.8179s
	iters: 400, epoch: 18 | loss: 0.0579551
	speed: 0.0696s/iter; left time: 2680.3515s
Epoch: 18 cost time: 31.56906270980835
Epoch: 18, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0249470
	speed: 0.3580s/iter; left time: 13733.4117s
	iters: 200, epoch: 19 | loss: 0.1040642
	speed: 0.0735s/iter; left time: 2811.4800s
	iters: 300, epoch: 19 | loss: 0.0748192
	speed: 0.0769s/iter; left time: 2934.4580s
	iters: 400, epoch: 19 | loss: 0.0300637
	speed: 0.0683s/iter; left time: 2599.2246s
Epoch: 19 cost time: 32.9784939289093
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0078233
	speed: 0.3890s/iter; left time: 14739.6940s
	iters: 200, epoch: 20 | loss: 0.0031375
	speed: 0.0461s/iter; left time: 1741.9795s
	iters: 300, epoch: 20 | loss: 0.0034759
	speed: 0.0490s/iter; left time: 1846.9147s
	iters: 400, epoch: 20 | loss: 0.0560296
	speed: 0.0562s/iter; left time: 2112.3861s
Epoch: 20 cost time: 26.370849609375
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.1330311
	speed: 0.3594s/iter; left time: 13447.2396s
	iters: 200, epoch: 21 | loss: 0.0018192
	speed: 0.0670s/iter; left time: 2501.4627s
	iters: 300, epoch: 21 | loss: 0.0161248
	speed: 0.0609s/iter; left time: 2265.3031s
	iters: 400, epoch: 21 | loss: 0.0289057
	speed: 0.0561s/iter; left time: 2082.5414s
Epoch: 21 cost time: 29.851927518844604
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0750408
	speed: 0.3595s/iter; left time: 13284.7170s
	iters: 200, epoch: 22 | loss: 0.0335320
	speed: 0.0670s/iter; left time: 2467.5847s
	iters: 300, epoch: 22 | loss: 0.0007016
	speed: 0.0701s/iter; left time: 2575.9137s
	iters: 400, epoch: 22 | loss: 0.0076494
	speed: 0.0617s/iter; left time: 2262.8715s
Epoch: 22 cost time: 30.840354919433594
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0053864
	speed: 0.3761s/iter; left time: 13722.9084s
	iters: 200, epoch: 23 | loss: 0.0035668
	speed: 0.0653s/iter; left time: 2374.2497s
	iters: 300, epoch: 23 | loss: 0.0093383
	speed: 0.0664s/iter; left time: 2409.0348s
	iters: 400, epoch: 23 | loss: 0.0092481
	speed: 0.0696s/iter; left time: 2519.8198s
Epoch: 23 cost time: 32.587212800979614
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978844).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2692948
	speed: 0.3765s/iter; left time: 13557.7437s
	iters: 200, epoch: 24 | loss: 0.0074166
	speed: 0.0709s/iter; left time: 2547.3189s
	iters: 300, epoch: 24 | loss: 0.0021384
	speed: 0.0658s/iter; left time: 2357.8000s
	iters: 400, epoch: 24 | loss: 0.4303858
	speed: 0.0633s/iter; left time: 2260.9400s
Epoch: 24 cost time: 32.031312465667725
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0012488
	speed: 0.3697s/iter; left time: 13141.1208s
	iters: 200, epoch: 25 | loss: 0.0024032
	speed: 0.0655s/iter; left time: 2323.2295s
	iters: 300, epoch: 25 | loss: 0.0082268
	speed: 0.0680s/iter; left time: 2405.2237s
	iters: 400, epoch: 25 | loss: 0.0751326
	speed: 0.0664s/iter; left time: 2340.3016s
Epoch: 25 cost time: 31.817447185516357
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0783573
	speed: 0.3688s/iter; left time: 12935.9442s
	iters: 200, epoch: 26 | loss: 0.0936457
	speed: 0.0642s/iter; left time: 2245.3863s
	iters: 300, epoch: 26 | loss: 0.0128182
	speed: 0.0602s/iter; left time: 2098.8188s
	iters: 400, epoch: 26 | loss: 0.0038880
	speed: 0.0600s/iter; left time: 2086.0403s
Epoch: 26 cost time: 29.943037748336792
Epoch: 26, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.978844).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0007266
	speed: 0.3754s/iter; left time: 12990.3367s
	iters: 200, epoch: 27 | loss: 0.0568804
	speed: 0.0663s/iter; left time: 2289.2190s
	iters: 300, epoch: 27 | loss: 0.0132376
	speed: 0.0663s/iter; left time: 2282.6538s
	iters: 400, epoch: 27 | loss: 0.0194193
	speed: 0.0636s/iter; left time: 2181.6913s
Epoch: 27 cost time: 31.65014362335205
Epoch: 27, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.978844).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0135102
	speed: 0.3641s/iter; left time: 12428.1580s
	iters: 200, epoch: 28 | loss: 0.0060853
	speed: 0.0607s/iter; left time: 2066.2790s
	iters: 300, epoch: 28 | loss: 0.0095433
	speed: 0.0580s/iter; left time: 1969.8436s
	iters: 400, epoch: 28 | loss: 0.0276822
	speed: 0.0684s/iter; left time: 2315.4469s
Epoch: 28 cost time: 31.099300861358643
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0052818
	speed: 0.3577s/iter; left time: 12044.4447s
	iters: 200, epoch: 29 | loss: 0.0037588
	speed: 0.0670s/iter; left time: 2248.5397s
	iters: 300, epoch: 29 | loss: 0.0248103
	speed: 0.0585s/iter; left time: 1959.1219s
	iters: 400, epoch: 29 | loss: 0.1565039
	speed: 0.0618s/iter; left time: 2063.0322s
Epoch: 29 cost time: 30.467398643493652
Epoch: 29, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0093856
	speed: 0.3772s/iter; left time: 12524.2878s
	iters: 200, epoch: 30 | loss: 0.0153103
	speed: 0.0608s/iter; left time: 2011.9355s
	iters: 300, epoch: 30 | loss: 0.1427329
	speed: 0.0699s/iter; left time: 2305.1093s
	iters: 400, epoch: 30 | loss: 0.0094598
	speed: 0.0706s/iter; left time: 2324.3330s
Epoch: 30 cost time: 31.137253046035767
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979130).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0934202
	speed: 0.3506s/iter; left time: 11474.3041s
	iters: 200, epoch: 31 | loss: 0.0067576
	speed: 0.0616s/iter; left time: 2009.9788s
	iters: 300, epoch: 31 | loss: 0.0260977
	speed: 0.0598s/iter; left time: 1943.8522s
	iters: 400, epoch: 31 | loss: 0.3238053
	speed: 0.0607s/iter; left time: 1969.9944s
Epoch: 31 cost time: 30.298306226730347
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0052653
	speed: 0.3593s/iter; left time: 11592.5695s
	iters: 200, epoch: 32 | loss: 0.0003977
	speed: 0.0707s/iter; left time: 2274.4648s
	iters: 300, epoch: 32 | loss: 0.1663106
	speed: 0.0639s/iter; left time: 2050.2959s
	iters: 400, epoch: 32 | loss: 0.0555519
	speed: 0.0618s/iter; left time: 1973.7795s
Epoch: 32 cost time: 30.792452573776245
Epoch: 32, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0281941
	speed: 0.3656s/iter; left time: 11622.1314s
	iters: 200, epoch: 33 | loss: 0.0126345
	speed: 0.0620s/iter; left time: 1963.5559s
	iters: 300, epoch: 33 | loss: 0.0030391
	speed: 0.0583s/iter; left time: 1841.2732s
	iters: 400, epoch: 33 | loss: 0.0040579
	speed: 0.0693s/iter; left time: 2181.2196s
Epoch: 33 cost time: 30.78684139251709
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0054659
	speed: 0.3761s/iter; left time: 11780.0378s
	iters: 200, epoch: 34 | loss: 0.0804594
	speed: 0.0715s/iter; left time: 2231.9801s
	iters: 300, epoch: 34 | loss: 0.1858151
	speed: 0.0617s/iter; left time: 1920.5254s
	iters: 400, epoch: 34 | loss: 0.0201952
	speed: 0.0611s/iter; left time: 1894.8294s
Epoch: 34 cost time: 31.65609836578369
Epoch: 34, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0174282
	speed: 0.3224s/iter; left time: 9946.8181s
	iters: 200, epoch: 35 | loss: 0.0405451
	speed: 0.0724s/iter; left time: 2227.0934s
	iters: 300, epoch: 35 | loss: 0.0078310
	speed: 0.0645s/iter; left time: 1977.6896s
	iters: 400, epoch: 35 | loss: 0.0012054
	speed: 0.0627s/iter; left time: 1917.3125s
Epoch: 35 cost time: 31.48349356651306
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0006607
	speed: 0.3603s/iter; left time: 10949.0214s
	iters: 200, epoch: 36 | loss: 0.3045878
	speed: 0.0638s/iter; left time: 1931.0634s
	iters: 300, epoch: 36 | loss: 0.0033955
	speed: 0.0693s/iter; left time: 2092.5439s
	iters: 400, epoch: 36 | loss: 0.0093074
	speed: 0.0612s/iter; left time: 1841.0001s
Epoch: 36 cost time: 30.09233593940735
Epoch: 36, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979987).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0532882
	speed: 0.3685s/iter; left time: 11023.7318s
	iters: 200, epoch: 37 | loss: 0.1408261
	speed: 0.0617s/iter; left time: 1839.3582s
	iters: 300, epoch: 37 | loss: 0.0010319
	speed: 0.0600s/iter; left time: 1781.9470s
	iters: 400, epoch: 37 | loss: 0.0031737
	speed: 0.0625s/iter; left time: 1851.0131s
Epoch: 37 cost time: 30.43929934501648
Epoch: 37, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0137198
	speed: 0.3579s/iter; left time: 10539.1699s
	iters: 200, epoch: 38 | loss: 0.0016746
	speed: 0.0677s/iter; left time: 1987.8149s
	iters: 300, epoch: 38 | loss: 0.0022085
	speed: 0.0625s/iter; left time: 1828.5390s
	iters: 400, epoch: 38 | loss: 0.0020497
	speed: 0.0600s/iter; left time: 1750.0567s
Epoch: 38 cost time: 30.622188568115234
Epoch: 38, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0433014
	speed: 0.3649s/iter; left time: 10574.3422s
	iters: 200, epoch: 39 | loss: 0.0003837
	speed: 0.0692s/iter; left time: 1998.0448s
	iters: 300, epoch: 39 | loss: 0.0045306
	speed: 0.0661s/iter; left time: 1902.2313s
	iters: 400, epoch: 39 | loss: 0.0180917
	speed: 0.0638s/iter; left time: 1828.7684s
Epoch: 39 cost time: 31.11294436454773
Epoch: 39, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0874869
	speed: 0.3775s/iter; left time: 10763.4620s
	iters: 200, epoch: 40 | loss: 0.0035590
	speed: 0.0623s/iter; left time: 1771.2149s
	iters: 300, epoch: 40 | loss: 0.0080717
	speed: 0.0669s/iter; left time: 1892.7453s
	iters: 400, epoch: 40 | loss: 0.0028096
	speed: 0.0732s/iter; left time: 2064.2761s
Epoch: 40 cost time: 32.09915113449097
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0178215
	speed: 0.3595s/iter; left time: 10081.6215s
	iters: 200, epoch: 41 | loss: 0.1169652
	speed: 0.0668s/iter; left time: 1865.3155s
	iters: 300, epoch: 41 | loss: 0.0040973
	speed: 0.0616s/iter; left time: 1715.2114s
	iters: 400, epoch: 41 | loss: 0.0066813
	speed: 0.0627s/iter; left time: 1739.6137s
Epoch: 41 cost time: 31.17280626296997
Epoch: 41, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979987 --> -0.980273).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0234090
	speed: 0.3541s/iter; left time: 9763.3162s
	iters: 200, epoch: 42 | loss: 0.0052188
	speed: 0.0667s/iter; left time: 1831.8468s
	iters: 300, epoch: 42 | loss: 0.0298211
	speed: 0.0606s/iter; left time: 1659.7823s
	iters: 400, epoch: 42 | loss: 0.0093650
	speed: 0.0599s/iter; left time: 1632.7472s
Epoch: 42 cost time: 30.176295042037964
Epoch: 42, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.980273 --> -0.983132).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0216484
	speed: 0.3568s/iter; left time: 9670.2907s
	iters: 200, epoch: 43 | loss: 0.3633631
	speed: 0.0654s/iter; left time: 1765.9943s
	iters: 300, epoch: 43 | loss: 0.0006079
	speed: 0.0681s/iter; left time: 1831.9312s
	iters: 400, epoch: 43 | loss: 0.0171603
	speed: 0.0647s/iter; left time: 1734.4985s
Epoch: 43 cost time: 31.06257200241089
Epoch: 43, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983132 --> -0.983418).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0060339
	speed: 0.3526s/iter; left time: 9390.8221s
	iters: 200, epoch: 44 | loss: 0.0001954
	speed: 0.0646s/iter; left time: 1713.9540s
	iters: 300, epoch: 44 | loss: 0.0012008
	speed: 0.0541s/iter; left time: 1428.8999s
	iters: 400, epoch: 44 | loss: 0.0873522
	speed: 0.0597s/iter; left time: 1571.2291s
Epoch: 44 cost time: 29.30094051361084
Epoch: 44, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 45 | loss: 0.0852224
	speed: 0.3543s/iter; left time: 9271.1362s
	iters: 200, epoch: 45 | loss: 0.0081794
	speed: 0.0700s/iter; left time: 1824.9368s
	iters: 300, epoch: 45 | loss: 0.0151283
	speed: 0.0630s/iter; left time: 1636.2761s
	iters: 400, epoch: 45 | loss: 0.0072880
	speed: 0.0621s/iter; left time: 1604.9611s
Epoch: 45 cost time: 30.964048624038696
Epoch: 45, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 46 | loss: 0.0035203
	speed: 0.3191s/iter; left time: 8199.3706s
	iters: 200, epoch: 46 | loss: 0.0411531
	speed: 0.0668s/iter; left time: 1709.3577s
	iters: 300, epoch: 46 | loss: 0.0003092
	speed: 0.0647s/iter; left time: 1648.4162s
	iters: 400, epoch: 46 | loss: 0.0163870
	speed: 0.0571s/iter; left time: 1451.2348s
Epoch: 46 cost time: 29.664194345474243
Epoch: 46, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
Validation loss decreased (-0.983418 --> -0.983990).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.0011480
	speed: 0.3451s/iter; left time: 8705.4227s
	iters: 200, epoch: 47 | loss: 0.0027242
	speed: 0.0615s/iter; left time: 1545.5255s
	iters: 300, epoch: 47 | loss: 0.0080040
	speed: 0.0600s/iter; left time: 1500.7197s
	iters: 400, epoch: 47 | loss: 0.0272975
	speed: 0.0625s/iter; left time: 1556.8426s
Epoch: 47 cost time: 28.669256448745728
Epoch: 47, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.0002888
	speed: 0.3278s/iter; left time: 8116.3167s
	iters: 200, epoch: 48 | loss: 0.3423460
	speed: 0.0642s/iter; left time: 1583.3311s
	iters: 300, epoch: 48 | loss: 0.0002210
	speed: 0.0608s/iter; left time: 1492.0113s
	iters: 400, epoch: 48 | loss: 0.0044268
	speed: 0.0585s/iter; left time: 1430.1611s
Epoch: 48 cost time: 29.803258180618286
Epoch: 48, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.0116576
	speed: 0.3460s/iter; left time: 8403.1013s
	iters: 200, epoch: 49 | loss: 0.0222569
	speed: 0.0672s/iter; left time: 1625.4273s
	iters: 300, epoch: 49 | loss: 0.0234667
	speed: 0.0603s/iter; left time: 1453.3558s
	iters: 400, epoch: 49 | loss: 0.3218434
	speed: 0.0604s/iter; left time: 1449.3090s
Epoch: 49 cost time: 30.133521795272827
Epoch: 49, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
Validation loss decreased (-0.983990 --> -0.984562).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0048275
	speed: 0.3119s/iter; left time: 7429.6623s
	iters: 200, epoch: 50 | loss: 0.0007820
	speed: 0.0679s/iter; left time: 1610.3324s
	iters: 300, epoch: 50 | loss: 0.0152288
	speed: 0.0726s/iter; left time: 1713.9033s
	iters: 400, epoch: 50 | loss: 0.0083333
	speed: 0.0657s/iter; left time: 1545.9265s
Epoch: 50 cost time: 31.74643039703369
Epoch: 50, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0156236
	speed: 0.3444s/iter; left time: 8041.9286s
	iters: 200, epoch: 51 | loss: 0.0032224
	speed: 0.0614s/iter; left time: 1426.7191s
	iters: 300, epoch: 51 | loss: 0.1155421
	speed: 0.0667s/iter; left time: 1544.6800s
	iters: 400, epoch: 51 | loss: 0.0541783
	speed: 0.0681s/iter; left time: 1569.5845s
Epoch: 51 cost time: 31.098209857940674
Epoch: 51, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0274496
	speed: 0.3437s/iter; left time: 7864.5343s
	iters: 200, epoch: 52 | loss: 0.2268253
	speed: 0.0621s/iter; left time: 1414.3077s
	iters: 300, epoch: 52 | loss: 0.2081273
	speed: 0.0620s/iter; left time: 1406.4270s
	iters: 400, epoch: 52 | loss: 0.0294958
	speed: 0.0649s/iter; left time: 1464.8086s
Epoch: 52 cost time: 30.63298225402832
Epoch: 52, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0037736
	speed: 0.3339s/iter; left time: 7483.9622s
	iters: 200, epoch: 53 | loss: 0.0011765
	speed: 0.0668s/iter; left time: 1490.8759s
	iters: 300, epoch: 53 | loss: 0.0606043
	speed: 0.0629s/iter; left time: 1398.0884s
	iters: 400, epoch: 53 | loss: 0.0052018
	speed: 0.0631s/iter; left time: 1396.3013s
Epoch: 53 cost time: 30.702736139297485
Epoch: 53, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.0095784
	speed: 0.3261s/iter; left time: 7155.6953s
	iters: 200, epoch: 54 | loss: 0.0024168
	speed: 0.0642s/iter; left time: 1403.4707s
	iters: 300, epoch: 54 | loss: 0.0058778
	speed: 0.0688s/iter; left time: 1495.8013s
	iters: 400, epoch: 54 | loss: 0.0011827
	speed: 0.0691s/iter; left time: 1496.4953s
Epoch: 54 cost time: 31.21904492378235
Epoch: 54, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0125074
	speed: 0.3303s/iter; left time: 7092.3984s
	iters: 200, epoch: 55 | loss: 0.0124840
	speed: 0.0625s/iter; left time: 1336.5539s
	iters: 300, epoch: 55 | loss: 0.0004055
	speed: 0.0638s/iter; left time: 1357.7547s
	iters: 400, epoch: 55 | loss: 0.0603139
	speed: 0.0659s/iter; left time: 1394.5879s
Epoch: 55 cost time: 30.98282814025879
Epoch: 55, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.1233360
	speed: 0.3441s/iter; left time: 7227.8526s
	iters: 200, epoch: 56 | loss: 0.0000303
	speed: 0.0653s/iter; left time: 1364.2022s
	iters: 300, epoch: 56 | loss: 0.1740253
	speed: 0.0650s/iter; left time: 1353.1947s
	iters: 400, epoch: 56 | loss: 0.0004526
	speed: 0.0665s/iter; left time: 1376.2948s
Epoch: 56 cost time: 31.533433198928833
Epoch: 56, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 0.0162142
	speed: 0.2977s/iter; left time: 6113.2983s
	iters: 200, epoch: 57 | loss: 0.0328705
	speed: 0.0725s/iter; left time: 1480.8565s
	iters: 300, epoch: 57 | loss: 0.0007711
	speed: 0.0654s/iter; left time: 1330.6584s
	iters: 400, epoch: 57 | loss: 0.0003960
	speed: 0.0599s/iter; left time: 1212.6277s
Epoch: 57 cost time: 31.183311700820923
Epoch: 57, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 0.0053339
	speed: 0.3261s/iter; left time: 6543.7765s
	iters: 200, epoch: 58 | loss: 0.0026719
	speed: 0.0586s/iter; left time: 1169.9975s
	iters: 300, epoch: 58 | loss: 0.0006190
	speed: 0.0781s/iter; left time: 1551.0965s
	iters: 400, epoch: 58 | loss: 0.0240081
	speed: 0.0761s/iter; left time: 1503.4085s
Epoch: 58 cost time: 32.50875735282898
Epoch: 58, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.0001494
	speed: 0.2663s/iter; left time: 5219.9171s
	iters: 200, epoch: 59 | loss: 0.0012949
	speed: 0.0608s/iter; left time: 1185.1054s
	iters: 300, epoch: 59 | loss: 0.0070096
	speed: 0.0622s/iter; left time: 1205.6775s
	iters: 400, epoch: 59 | loss: 0.0022884
	speed: 0.0672s/iter; left time: 1295.9430s
Epoch: 59 cost time: 28.557793617248535
Epoch: 59, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 269946
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3986552
	speed: 0.0852s/iter; left time: 3989.7715s
	iters: 200, epoch: 1 | loss: 0.7639294
	speed: 0.0637s/iter; left time: 2976.7845s
	iters: 300, epoch: 1 | loss: 0.3074318
	speed: 0.0589s/iter; left time: 2744.9201s
	iters: 400, epoch: 1 | loss: 0.3496218
	speed: 0.0597s/iter; left time: 2775.2704s
Epoch: 1 cost time: 30.94414472579956
Epoch: 1, Steps: 469 | Train Loss: 0.995 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
Validation loss decreased (inf --> -0.877926).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2727761
	speed: 0.3484s/iter; left time: 16141.0174s
	iters: 200, epoch: 2 | loss: 0.0429713
	speed: 0.0694s/iter; left time: 3207.9841s
	iters: 300, epoch: 2 | loss: 0.1514102
	speed: 0.0644s/iter; left time: 2971.6419s
	iters: 400, epoch: 2 | loss: 0.1207245
	speed: 0.0594s/iter; left time: 2735.0292s
Epoch: 2 cost time: 30.000011205673218
Epoch: 2, Steps: 469 | Train Loss: 0.274 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.877926 --> -0.941393).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0828401
	speed: 0.3474s/iter; left time: 15932.0081s
	iters: 200, epoch: 3 | loss: 0.0502982
	speed: 0.0625s/iter; left time: 2860.3204s
	iters: 300, epoch: 3 | loss: 0.3214457
	speed: 0.0634s/iter; left time: 2895.1915s
	iters: 400, epoch: 3 | loss: 0.1922130
	speed: 0.0650s/iter; left time: 2963.2805s
Epoch: 3 cost time: 30.040051460266113
Epoch: 3, Steps: 469 | Train Loss: 0.179 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.941393 --> -0.947968).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0412789
	speed: 0.3346s/iter; left time: 15190.1098s
	iters: 200, epoch: 4 | loss: 0.0720466
	speed: 0.0604s/iter; left time: 2736.7622s
	iters: 300, epoch: 4 | loss: 0.0435904
	speed: 0.0579s/iter; left time: 2615.9844s
	iters: 400, epoch: 4 | loss: 0.1914759
	speed: 0.0606s/iter; left time: 2733.4988s
Epoch: 4 cost time: 28.868245363235474
Epoch: 4, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.947968 --> -0.962262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5896130
	speed: 0.3317s/iter; left time: 14900.4482s
	iters: 200, epoch: 5 | loss: 0.0465287
	speed: 0.0657s/iter; left time: 2945.2162s
	iters: 300, epoch: 5 | loss: 0.0376408
	speed: 0.0578s/iter; left time: 2585.2875s
	iters: 400, epoch: 5 | loss: 0.0561353
	speed: 0.0548s/iter; left time: 2443.7237s
Epoch: 5 cost time: 28.75981307029724
Epoch: 5, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.962262 --> -0.963120).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1435623
	speed: 0.3335s/iter; left time: 14824.4461s
	iters: 200, epoch: 6 | loss: 0.0323378
	speed: 0.0622s/iter; left time: 2758.5530s
	iters: 300, epoch: 6 | loss: 0.1202181
	speed: 0.0610s/iter; left time: 2700.0856s
	iters: 400, epoch: 6 | loss: 0.1013390
	speed: 0.0603s/iter; left time: 2662.6509s
Epoch: 6 cost time: 28.604280471801758
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1384400
	speed: 0.3289s/iter; left time: 14467.0513s
	iters: 200, epoch: 7 | loss: 0.0636212
	speed: 0.0624s/iter; left time: 2737.7682s
	iters: 300, epoch: 7 | loss: 0.1489078
	speed: 0.0613s/iter; left time: 2685.7928s
	iters: 400, epoch: 7 | loss: 0.0408200
	speed: 0.0654s/iter; left time: 2855.8997s
Epoch: 7 cost time: 29.947298049926758
Epoch: 7, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.963120 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0190207
	speed: 0.3377s/iter; left time: 14696.1902s
	iters: 200, epoch: 8 | loss: 0.1414169
	speed: 0.0621s/iter; left time: 2694.6828s
	iters: 300, epoch: 8 | loss: 0.0722557
	speed: 0.0565s/iter; left time: 2445.6488s
	iters: 400, epoch: 8 | loss: 0.0153917
	speed: 0.0648s/iter; left time: 2798.5106s
Epoch: 8 cost time: 29.846894025802612
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.967408).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1586445
	speed: 0.3374s/iter; left time: 14524.1599s
	iters: 200, epoch: 9 | loss: 0.0358403
	speed: 0.0627s/iter; left time: 2693.1296s
	iters: 300, epoch: 9 | loss: 0.0078868
	speed: 0.0573s/iter; left time: 2456.6113s
	iters: 400, epoch: 9 | loss: 0.0548942
	speed: 0.0544s/iter; left time: 2325.1811s
Epoch: 9 cost time: 27.945035219192505
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.967408 --> -0.971411).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0043562
	speed: 0.3278s/iter; left time: 13958.6734s
	iters: 200, epoch: 10 | loss: 0.1029962
	speed: 0.0625s/iter; left time: 2655.1158s
	iters: 300, epoch: 10 | loss: 0.0479328
	speed: 0.0637s/iter; left time: 2699.3984s
	iters: 400, epoch: 10 | loss: 0.0091344
	speed: 0.0591s/iter; left time: 2499.2888s
Epoch: 10 cost time: 29.029040098190308
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.3058599
	speed: 0.3222s/iter; left time: 13568.1422s
	iters: 200, epoch: 11 | loss: 0.1328373
	speed: 0.0645s/iter; left time: 2710.3466s
	iters: 300, epoch: 11 | loss: 0.0185187
	speed: 0.0601s/iter; left time: 2517.1238s
	iters: 400, epoch: 11 | loss: 0.0127956
	speed: 0.0602s/iter; left time: 2517.7552s
Epoch: 11 cost time: 29.063184022903442
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972555).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0451197
	speed: 0.3238s/iter; left time: 13483.8891s
	iters: 200, epoch: 12 | loss: 0.0076384
	speed: 0.0604s/iter; left time: 2508.8698s
	iters: 300, epoch: 12 | loss: 0.4586913
	speed: 0.0595s/iter; left time: 2466.7198s
	iters: 400, epoch: 12 | loss: 0.0052497
	speed: 0.0545s/iter; left time: 2253.8310s
Epoch: 12 cost time: 28.657860279083252
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0035619
	speed: 0.3439s/iter; left time: 14160.2309s
	iters: 200, epoch: 13 | loss: 0.1513850
	speed: 0.0662s/iter; left time: 2718.7989s
	iters: 300, epoch: 13 | loss: 0.0477764
	speed: 0.0614s/iter; left time: 2514.6346s
	iters: 400, epoch: 13 | loss: 0.0180129
	speed: 0.0594s/iter; left time: 2426.9615s
Epoch: 13 cost time: 29.636934280395508
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0162240
	speed: 0.3370s/iter; left time: 13717.9722s
	iters: 200, epoch: 14 | loss: 0.0018534
	speed: 0.0656s/iter; left time: 2663.1322s
	iters: 300, epoch: 14 | loss: 0.2047134
	speed: 0.0640s/iter; left time: 2591.4244s
	iters: 400, epoch: 14 | loss: 0.0163924
	speed: 0.0588s/iter; left time: 2374.8807s
Epoch: 14 cost time: 29.481034994125366
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.972840).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0072578
	speed: 0.3040s/iter; left time: 12233.1502s
	iters: 200, epoch: 15 | loss: 0.0799590
	speed: 0.0552s/iter; left time: 2214.0105s
	iters: 300, epoch: 15 | loss: 0.0148909
	speed: 0.0642s/iter; left time: 2571.3095s
	iters: 400, epoch: 15 | loss: 0.0058038
	speed: 0.0662s/iter; left time: 2643.3871s
Epoch: 15 cost time: 29.10750699043274
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0051801
	speed: 0.3075s/iter; left time: 12226.2233s
	iters: 200, epoch: 16 | loss: 0.0602744
	speed: 0.0619s/iter; left time: 2457.1895s
	iters: 300, epoch: 16 | loss: 0.0047109
	speed: 0.0614s/iter; left time: 2428.8032s
	iters: 400, epoch: 16 | loss: 0.1780318
	speed: 0.0587s/iter; left time: 2317.6857s
Epoch: 16 cost time: 28.84491276741028
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0662808
	speed: 0.3139s/iter; left time: 12335.8414s
	iters: 200, epoch: 17 | loss: 0.0027385
	speed: 0.0647s/iter; left time: 2535.9049s
	iters: 300, epoch: 17 | loss: 0.0228031
	speed: 0.0639s/iter; left time: 2498.0368s
	iters: 400, epoch: 17 | loss: 0.0629150
	speed: 0.0621s/iter; left time: 2420.3393s
Epoch: 17 cost time: 29.226553440093994
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1266707
	speed: 0.3247s/iter; left time: 12606.7448s
	iters: 200, epoch: 18 | loss: 0.2203835
	speed: 0.0627s/iter; left time: 2428.0151s
	iters: 300, epoch: 18 | loss: 0.0026844
	speed: 0.0668s/iter; left time: 2578.6943s
	iters: 400, epoch: 18 | loss: 0.0309474
	speed: 0.0623s/iter; left time: 2400.2143s
Epoch: 18 cost time: 29.91487741470337
Epoch: 18, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0238715
	speed: 0.3091s/iter; left time: 11856.6149s
	iters: 200, epoch: 19 | loss: 0.0514088
	speed: 0.0518s/iter; left time: 1982.9698s
	iters: 300, epoch: 19 | loss: 0.0246137
	speed: 0.0665s/iter; left time: 2538.0773s
	iters: 400, epoch: 19 | loss: 0.2002545
	speed: 0.0702s/iter; left time: 2670.6654s
Epoch: 19 cost time: 29.009137630462646
Epoch: 19, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0194940
	speed: 0.3328s/iter; left time: 12611.3942s
	iters: 200, epoch: 20 | loss: 0.0065176
	speed: 0.0632s/iter; left time: 2388.2536s
	iters: 300, epoch: 20 | loss: 0.0013167
	speed: 0.0630s/iter; left time: 2374.1672s
	iters: 400, epoch: 20 | loss: 0.0122482
	speed: 0.0634s/iter; left time: 2382.4486s
Epoch: 20 cost time: 30.080086946487427
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977986).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0062913
	speed: 0.3245s/iter; left time: 12142.2887s
	iters: 200, epoch: 21 | loss: 0.0135472
	speed: 0.0633s/iter; left time: 2363.4798s
	iters: 300, epoch: 21 | loss: 0.0277490
	speed: 0.0671s/iter; left time: 2497.8388s
	iters: 400, epoch: 21 | loss: 0.0095257
	speed: 0.0640s/iter; left time: 2375.2444s
Epoch: 21 cost time: 29.710261344909668
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3637588
	speed: 0.3237s/iter; left time: 11963.0794s
	iters: 200, epoch: 22 | loss: 0.0150411
	speed: 0.0612s/iter; left time: 2254.2037s
	iters: 300, epoch: 22 | loss: 0.0034660
	speed: 0.0608s/iter; left time: 2234.9887s
	iters: 400, epoch: 22 | loss: 0.0325599
	speed: 0.0714s/iter; left time: 2615.8315s
Epoch: 22 cost time: 30.382093906402588
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.977986 --> -0.980273).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0093770
	speed: 0.3286s/iter; left time: 11988.6754s
	iters: 200, epoch: 23 | loss: 0.0193357
	speed: 0.0687s/iter; left time: 2501.2776s
	iters: 300, epoch: 23 | loss: 0.0075302
	speed: 0.0642s/iter; left time: 2330.2869s
	iters: 400, epoch: 23 | loss: 0.0094282
	speed: 0.0648s/iter; left time: 2345.5139s
Epoch: 23 cost time: 31.16244125366211
Epoch: 23, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1206886
	speed: 0.3304s/iter; left time: 11897.5178s
	iters: 200, epoch: 24 | loss: 0.0165289
	speed: 0.0605s/iter; left time: 2174.1745s
	iters: 300, epoch: 24 | loss: 0.0150694
	speed: 0.0679s/iter; left time: 2432.9876s
	iters: 400, epoch: 24 | loss: 0.2990318
	speed: 0.0653s/iter; left time: 2331.2878s
Epoch: 24 cost time: 30.0506432056427
Epoch: 24, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0033056
	speed: 0.3436s/iter; left time: 12211.8836s
	iters: 200, epoch: 25 | loss: 0.0012858
	speed: 0.0610s/iter; left time: 2163.7377s
	iters: 300, epoch: 25 | loss: 0.0051712
	speed: 0.0645s/iter; left time: 2281.4399s
	iters: 400, epoch: 25 | loss: 0.1257647
	speed: 0.0671s/iter; left time: 2364.2974s
Epoch: 25 cost time: 30.66472363471985
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0313666
	speed: 0.3280s/iter; left time: 11505.1585s
	iters: 200, epoch: 26 | loss: 0.0238453
	speed: 0.0680s/iter; left time: 2376.9001s
	iters: 300, epoch: 26 | loss: 0.2490011
	speed: 0.0597s/iter; left time: 2083.3042s
	iters: 400, epoch: 26 | loss: 0.0534898
	speed: 0.0606s/iter; left time: 2107.8365s
Epoch: 26 cost time: 29.84796953201294
Epoch: 26, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0028539
	speed: 0.3365s/iter; left time: 11646.9038s
	iters: 200, epoch: 27 | loss: 0.0372592
	speed: 0.0579s/iter; left time: 1996.8376s
	iters: 300, epoch: 27 | loss: 0.3339226
	speed: 0.0641s/iter; left time: 2205.4948s
	iters: 400, epoch: 27 | loss: 0.0272432
	speed: 0.0669s/iter; left time: 2295.6746s
Epoch: 27 cost time: 29.39999532699585
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0045116
	speed: 0.3312s/iter; left time: 11307.8231s
	iters: 200, epoch: 28 | loss: 0.0022963
	speed: 0.0604s/iter; left time: 2055.4759s
	iters: 300, epoch: 28 | loss: 0.0170610
	speed: 0.0589s/iter; left time: 2000.2099s
	iters: 400, epoch: 28 | loss: 0.0238292
	speed: 0.0622s/iter; left time: 2103.1555s
Epoch: 28 cost time: 29.37528133392334
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0126083
	speed: 0.3333s/iter; left time: 11220.3620s
	iters: 200, epoch: 29 | loss: 0.0034061
	speed: 0.0712s/iter; left time: 2391.2007s
	iters: 300, epoch: 29 | loss: 0.0288256
	speed: 0.0663s/iter; left time: 2218.7024s
	iters: 400, epoch: 29 | loss: 0.2860804
	speed: 0.0630s/iter; left time: 2103.5394s
Epoch: 29 cost time: 30.897704601287842
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0019920
	speed: 0.3399s/iter; left time: 11283.3221s
	iters: 200, epoch: 30 | loss: 0.0009271
	speed: 0.0564s/iter; left time: 1867.8950s
	iters: 300, epoch: 30 | loss: 0.0977417
	speed: 0.0637s/iter; left time: 2101.3358s
	iters: 400, epoch: 30 | loss: 0.0161380
	speed: 0.0680s/iter; left time: 2237.8541s
Epoch: 30 cost time: 29.45037817955017
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0451384
	speed: 0.3358s/iter; left time: 10990.3748s
	iters: 200, epoch: 31 | loss: 0.0013241
	speed: 0.0591s/iter; left time: 1928.8320s
	iters: 300, epoch: 31 | loss: 0.0003990
	speed: 0.0589s/iter; left time: 1917.1696s
	iters: 400, epoch: 31 | loss: 0.2935543
	speed: 0.0615s/iter; left time: 1996.0292s
Epoch: 31 cost time: 29.1695396900177
Epoch: 31, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0320802
	speed: 0.3321s/iter; left time: 10715.1311s
	iters: 200, epoch: 32 | loss: 0.0021558
	speed: 0.0636s/iter; left time: 2045.9525s
	iters: 300, epoch: 32 | loss: 0.0112637
	speed: 0.0685s/iter; left time: 2195.3523s
	iters: 400, epoch: 32 | loss: 0.1794043
	speed: 0.0618s/iter; left time: 1974.8204s
Epoch: 32 cost time: 29.634047031402588
Epoch: 32, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 269946
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6591400
	speed: 0.0815s/iter; left time: 3812.3686s
	iters: 200, epoch: 1 | loss: 0.9491469
	speed: 0.0629s/iter; left time: 2936.0108s
	iters: 300, epoch: 1 | loss: 0.5998417
	speed: 0.0608s/iter; left time: 2835.0023s
	iters: 400, epoch: 1 | loss: 0.3571298
	speed: 0.0637s/iter; left time: 2964.2317s
Epoch: 1 cost time: 31.52372169494629
Epoch: 1, Steps: 469 | Train Loss: 1.082 Vali Loss: 0.502 Vali Acc: 0.847 Test Loss: 0.502 Test Acc: 0.847
Validation loss decreased (inf --> -0.846765).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4161270
	speed: 0.3287s/iter; left time: 15231.4369s
	iters: 200, epoch: 2 | loss: 0.6713995
	speed: 0.0522s/iter; left time: 2412.0888s
	iters: 300, epoch: 2 | loss: 0.3237460
	speed: 0.0514s/iter; left time: 2371.1070s
	iters: 400, epoch: 2 | loss: 0.3045646
	speed: 0.0564s/iter; left time: 2596.7563s
Epoch: 2 cost time: 26.77877640724182
Epoch: 2, Steps: 469 | Train Loss: 0.311 Vali Loss: 0.305 Vali Acc: 0.912 Test Loss: 0.305 Test Acc: 0.912
Validation loss decreased (-0.846765 --> -0.911661).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1477403
	speed: 0.3394s/iter; left time: 15565.9626s
	iters: 200, epoch: 3 | loss: 0.2010193
	speed: 0.0687s/iter; left time: 3142.5963s
	iters: 300, epoch: 3 | loss: 0.1404610
	speed: 0.0625s/iter; left time: 2853.5487s
	iters: 400, epoch: 3 | loss: 0.0638942
	speed: 0.0577s/iter; left time: 2627.3586s
Epoch: 3 cost time: 30.440539360046387
Epoch: 3, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.256 Vali Acc: 0.923 Test Loss: 0.256 Test Acc: 0.923
Validation loss decreased (-0.911661 --> -0.923382).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1841799
	speed: 0.3237s/iter; left time: 14692.1127s
	iters: 200, epoch: 4 | loss: 0.1285056
	speed: 0.0632s/iter; left time: 2863.3183s
	iters: 300, epoch: 4 | loss: 0.6235592
	speed: 0.0642s/iter; left time: 2902.4833s
	iters: 400, epoch: 4 | loss: 0.2937002
	speed: 0.0594s/iter; left time: 2680.7780s
Epoch: 4 cost time: 28.802162408828735
Epoch: 4, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (-0.923382 --> -0.941679).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1258457
	speed: 0.3257s/iter; left time: 14632.9718s
	iters: 200, epoch: 5 | loss: 0.0486849
	speed: 0.0619s/iter; left time: 2776.2180s
	iters: 300, epoch: 5 | loss: 0.0222603
	speed: 0.0621s/iter; left time: 2778.5675s
	iters: 400, epoch: 5 | loss: 0.0607389
	speed: 0.0624s/iter; left time: 2784.2266s
Epoch: 5 cost time: 29.25769543647766
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
Validation loss decreased (-0.941679 --> -0.945967).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0380494
	speed: 0.3265s/iter; left time: 14515.9341s
	iters: 200, epoch: 6 | loss: 0.0581020
	speed: 0.0630s/iter; left time: 2796.1341s
	iters: 300, epoch: 6 | loss: 0.0420070
	speed: 0.0569s/iter; left time: 2518.5888s
	iters: 400, epoch: 6 | loss: 0.0289839
	speed: 0.0573s/iter; left time: 2529.5358s
Epoch: 6 cost time: 28.74944543838501
Epoch: 6, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.945967 --> -0.955687).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1651058
	speed: 0.3311s/iter; left time: 14564.3139s
	iters: 200, epoch: 7 | loss: 0.0482234
	speed: 0.0700s/iter; left time: 3074.0389s
	iters: 300, epoch: 7 | loss: 0.0597171
	speed: 0.0639s/iter; left time: 2799.3484s
	iters: 400, epoch: 7 | loss: 0.0537654
	speed: 0.0582s/iter; left time: 2544.2724s
Epoch: 7 cost time: 29.851678133010864
Epoch: 7, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.955687 --> -0.958832).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1087419
	speed: 0.3566s/iter; left time: 15519.1006s
	iters: 200, epoch: 8 | loss: 0.0379100
	speed: 0.0662s/iter; left time: 2873.5352s
	iters: 300, epoch: 8 | loss: 0.0210607
	speed: 0.0519s/iter; left time: 2247.6766s
	iters: 400, epoch: 8 | loss: 0.1816663
	speed: 0.0470s/iter; left time: 2031.2444s
Epoch: 8 cost time: 27.083505868911743
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
Validation loss decreased (-0.958832 --> -0.965979).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0422512
	speed: 0.2974s/iter; left time: 12801.9626s
	iters: 200, epoch: 9 | loss: 0.0930354
	speed: 0.0609s/iter; left time: 2614.2277s
	iters: 300, epoch: 9 | loss: 0.0198943
	speed: 0.0620s/iter; left time: 2656.4926s
	iters: 400, epoch: 9 | loss: 0.1229672
	speed: 0.0651s/iter; left time: 2782.4450s
Epoch: 9 cost time: 29.863802671432495
Epoch: 9, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0305727
	speed: 0.3280s/iter; left time: 13965.0031s
	iters: 200, epoch: 10 | loss: 0.0322223
	speed: 0.0633s/iter; left time: 2690.1251s
	iters: 300, epoch: 10 | loss: 0.3376737
	speed: 0.0623s/iter; left time: 2638.3448s
	iters: 400, epoch: 10 | loss: 0.1313356
	speed: 0.0611s/iter; left time: 2584.2606s
Epoch: 10 cost time: 30.044981718063354
Epoch: 10, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.965979 --> -0.966551).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0236580
	speed: 0.3250s/iter; left time: 13684.8472s
	iters: 200, epoch: 11 | loss: 0.0147444
	speed: 0.0691s/iter; left time: 2901.3447s
	iters: 300, epoch: 11 | loss: 0.0510432
	speed: 0.0607s/iter; left time: 2545.9039s
	iters: 400, epoch: 11 | loss: 0.0038730
	speed: 0.0589s/iter; left time: 2461.3226s
Epoch: 11 cost time: 29.746199131011963
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.966551 --> -0.969410).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0577098
	speed: 0.3227s/iter; left time: 13437.9064s
	iters: 200, epoch: 12 | loss: 0.1225487
	speed: 0.0639s/iter; left time: 2655.2768s
	iters: 300, epoch: 12 | loss: 0.0118867
	speed: 0.0655s/iter; left time: 2712.7016s
	iters: 400, epoch: 12 | loss: 0.1558261
	speed: 0.0667s/iter; left time: 2756.6064s
Epoch: 12 cost time: 29.918744802474976
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0151363
	speed: 0.3338s/iter; left time: 13743.2763s
	iters: 200, epoch: 13 | loss: 0.0196649
	speed: 0.0631s/iter; left time: 2593.7504s
	iters: 300, epoch: 13 | loss: 0.0197181
	speed: 0.0646s/iter; left time: 2645.9423s
	iters: 400, epoch: 13 | loss: 0.0070393
	speed: 0.0654s/iter; left time: 2673.6243s
Epoch: 13 cost time: 30.57736897468567
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0404934
	speed: 0.3324s/iter; left time: 13528.4064s
	iters: 200, epoch: 14 | loss: 0.0875586
	speed: 0.0630s/iter; left time: 2556.5627s
	iters: 300, epoch: 14 | loss: 0.0546964
	speed: 0.0625s/iter; left time: 2532.3751s
	iters: 400, epoch: 14 | loss: 0.1866880
	speed: 0.0621s/iter; left time: 2508.5684s
Epoch: 14 cost time: 29.90603518486023
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0237710
	speed: 0.3223s/iter; left time: 12966.5427s
	iters: 200, epoch: 15 | loss: 0.0966651
	speed: 0.0684s/iter; left time: 2743.2385s
	iters: 300, epoch: 15 | loss: 0.0090325
	speed: 0.0691s/iter; left time: 2766.0397s
	iters: 400, epoch: 15 | loss: 0.2915455
	speed: 0.0566s/iter; left time: 2260.4558s
Epoch: 15 cost time: 29.87716841697693
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969410 --> -0.976557).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1012740
	speed: 0.3216s/iter; left time: 12789.9934s
	iters: 200, epoch: 16 | loss: 0.0026205
	speed: 0.0618s/iter; left time: 2452.0672s
	iters: 300, epoch: 16 | loss: 0.0141733
	speed: 0.0691s/iter; left time: 2735.9111s
	iters: 400, epoch: 16 | loss: 0.0514699
	speed: 0.0621s/iter; left time: 2449.9291s
Epoch: 16 cost time: 29.826857328414917
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0143392
	speed: 0.3209s/iter; left time: 12609.9081s
	iters: 200, epoch: 17 | loss: 0.0435760
	speed: 0.0617s/iter; left time: 2417.4396s
	iters: 300, epoch: 17 | loss: 0.1279304
	speed: 0.0612s/iter; left time: 2393.8197s
	iters: 400, epoch: 17 | loss: 0.0484678
	speed: 0.0637s/iter; left time: 2482.2468s
Epoch: 17 cost time: 29.63953971862793
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2561432
	speed: 0.3192s/iter; left time: 12393.5022s
	iters: 200, epoch: 18 | loss: 0.0106988
	speed: 0.0567s/iter; left time: 2195.6306s
	iters: 300, epoch: 18 | loss: 0.0494835
	speed: 0.0507s/iter; left time: 1958.6481s
	iters: 400, epoch: 18 | loss: 0.0308434
	speed: 0.0543s/iter; left time: 2092.5038s
Epoch: 18 cost time: 27.712223052978516
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0476160
	speed: 0.3281s/iter; left time: 12583.8829s
	iters: 200, epoch: 19 | loss: 0.4085518
	speed: 0.0684s/iter; left time: 2617.4464s
	iters: 300, epoch: 19 | loss: 0.0444727
	speed: 0.0620s/iter; left time: 2365.3520s
	iters: 400, epoch: 19 | loss: 0.0322287
	speed: 0.0610s/iter; left time: 2323.2986s
Epoch: 19 cost time: 29.973294734954834
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976843).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0349758
	speed: 0.3260s/iter; left time: 12351.3650s
	iters: 200, epoch: 20 | loss: 0.0157122
	speed: 0.0644s/iter; left time: 2433.2746s
	iters: 300, epoch: 20 | loss: 0.0643498
	speed: 0.0636s/iter; left time: 2396.0535s
	iters: 400, epoch: 20 | loss: 0.0063161
	speed: 0.0614s/iter; left time: 2307.9802s
Epoch: 20 cost time: 29.02191662788391
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0528775
	speed: 0.3200s/iter; left time: 11973.6140s
	iters: 200, epoch: 21 | loss: 0.0590848
	speed: 0.0607s/iter; left time: 2264.8288s
	iters: 300, epoch: 21 | loss: 0.0072895
	speed: 0.0649s/iter; left time: 2415.5787s
	iters: 400, epoch: 21 | loss: 0.0153716
	speed: 0.0677s/iter; left time: 2512.4094s
Epoch: 21 cost time: 29.98200535774231
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0274676
	speed: 0.3146s/iter; left time: 11624.0920s
	iters: 200, epoch: 22 | loss: 0.0220383
	speed: 0.0639s/iter; left time: 2354.1093s
	iters: 300, epoch: 22 | loss: 0.0233499
	speed: 0.0609s/iter; left time: 2239.8444s
	iters: 400, epoch: 22 | loss: 0.0516084
	speed: 0.0630s/iter; left time: 2307.6709s
Epoch: 22 cost time: 29.79954481124878
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0010355
	speed: 0.3179s/iter; left time: 11599.4215s
	iters: 200, epoch: 23 | loss: 0.0069926
	speed: 0.0621s/iter; left time: 2261.1722s
	iters: 300, epoch: 23 | loss: 0.0011133
	speed: 0.0633s/iter; left time: 2298.4958s
	iters: 400, epoch: 23 | loss: 0.0039639
	speed: 0.0625s/iter; left time: 2263.0890s
Epoch: 23 cost time: 30.13741445541382
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0537003
	speed: 0.3295s/iter; left time: 11867.5215s
	iters: 200, epoch: 24 | loss: 0.0723333
	speed: 0.0678s/iter; left time: 2434.4362s
	iters: 300, epoch: 24 | loss: 0.0107677
	speed: 0.0637s/iter; left time: 2282.5535s
	iters: 400, epoch: 24 | loss: 0.0203259
	speed: 0.0624s/iter; left time: 2229.3784s
Epoch: 24 cost time: 30.88088321685791
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0776706
	speed: 0.3223s/iter; left time: 11457.1397s
	iters: 200, epoch: 25 | loss: 0.0257672
	speed: 0.0577s/iter; left time: 2046.2723s
	iters: 300, epoch: 25 | loss: 0.0025678
	speed: 0.0606s/iter; left time: 2141.3401s
	iters: 400, epoch: 25 | loss: 0.0028972
	speed: 0.0659s/iter; left time: 2323.3075s
Epoch: 25 cost time: 29.022372007369995
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0114738
	speed: 0.3401s/iter; left time: 11928.6642s
	iters: 200, epoch: 26 | loss: 0.0099282
	speed: 0.0593s/iter; left time: 2075.8014s
	iters: 300, epoch: 26 | loss: 0.1284297
	speed: 0.0630s/iter; left time: 2198.1727s
	iters: 400, epoch: 26 | loss: 0.0093588
	speed: 0.0679s/iter; left time: 2362.6162s
Epoch: 26 cost time: 29.69870924949646
Epoch: 26, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0562870
	speed: 0.3411s/iter; left time: 11803.1257s
	iters: 200, epoch: 27 | loss: 0.0021539
	speed: 0.0576s/iter; left time: 1987.9603s
	iters: 300, epoch: 27 | loss: 0.0200597
	speed: 0.0572s/iter; left time: 1966.5397s
	iters: 400, epoch: 27 | loss: 0.0008832
	speed: 0.0694s/iter; left time: 2382.2396s
Epoch: 27 cost time: 29.554423570632935
Epoch: 27, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978558).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0094019
	speed: 0.3386s/iter; left time: 11559.8328s
	iters: 200, epoch: 28 | loss: 0.0069101
	speed: 0.0479s/iter; left time: 1631.4728s
	iters: 300, epoch: 28 | loss: 0.0215071
	speed: 0.0474s/iter; left time: 1608.6828s
	iters: 400, epoch: 28 | loss: 0.1691184
	speed: 0.0533s/iter; left time: 1805.2194s
Epoch: 28 cost time: 26.614640474319458
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0030848
	speed: 0.3495s/iter; left time: 11765.9355s
	iters: 200, epoch: 29 | loss: 0.0127297
	speed: 0.0653s/iter; left time: 2192.6825s
	iters: 300, epoch: 29 | loss: 0.0021666
	speed: 0.0600s/iter; left time: 2009.2271s
	iters: 400, epoch: 29 | loss: 0.0064782
	speed: 0.0638s/iter; left time: 2128.7207s
Epoch: 29 cost time: 30.498318672180176
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0065717
	speed: 0.3454s/iter; left time: 11468.1758s
	iters: 200, epoch: 30 | loss: 0.0049405
	speed: 0.0637s/iter; left time: 2107.2827s
	iters: 300, epoch: 30 | loss: 0.0295744
	speed: 0.0628s/iter; left time: 2071.0134s
	iters: 400, epoch: 30 | loss: 0.0062280
	speed: 0.0621s/iter; left time: 2041.5210s
Epoch: 30 cost time: 30.173591375350952
Epoch: 30, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0058449
	speed: 0.3492s/iter; left time: 11428.3491s
	iters: 200, epoch: 31 | loss: 0.0027133
	speed: 0.0589s/iter; left time: 1921.0797s
	iters: 300, epoch: 31 | loss: 0.1572092
	speed: 0.0628s/iter; left time: 2041.8305s
	iters: 400, epoch: 31 | loss: 0.0036831
	speed: 0.0633s/iter; left time: 2053.5457s
Epoch: 31 cost time: 29.21248483657837
Epoch: 31, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0040181
	speed: 0.3391s/iter; left time: 10938.8153s
	iters: 200, epoch: 32 | loss: 0.0093945
	speed: 0.0582s/iter; left time: 1872.9186s
	iters: 300, epoch: 32 | loss: 0.0008915
	speed: 0.0592s/iter; left time: 1897.1916s
	iters: 400, epoch: 32 | loss: 0.0506688
	speed: 0.0635s/iter; left time: 2030.7222s
Epoch: 32 cost time: 28.88823127746582
Epoch: 32, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.1122785
	speed: 0.3358s/iter; left time: 10676.7920s
	iters: 200, epoch: 33 | loss: 0.0230627
	speed: 0.0596s/iter; left time: 1887.3641s
	iters: 300, epoch: 33 | loss: 0.0099974
	speed: 0.0581s/iter; left time: 1835.7408s
	iters: 400, epoch: 33 | loss: 0.0098873
	speed: 0.0641s/iter; left time: 2017.2504s
Epoch: 33 cost time: 29.030250310897827
Epoch: 33, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0672776
	speed: 0.3381s/iter; left time: 10591.1026s
	iters: 200, epoch: 34 | loss: 0.0013953
	speed: 0.0595s/iter; left time: 1856.7247s
	iters: 300, epoch: 34 | loss: 0.0266959
	speed: 0.0596s/iter; left time: 1853.8214s
	iters: 400, epoch: 34 | loss: 0.0015779
	speed: 0.0620s/iter; left time: 1923.1004s
Epoch: 34 cost time: 29.564865589141846
Epoch: 34, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0071922
	speed: 0.3571s/iter; left time: 11019.4711s
	iters: 200, epoch: 35 | loss: 0.0037137
	speed: 0.0659s/iter; left time: 2026.5789s
	iters: 300, epoch: 35 | loss: 0.0050348
	speed: 0.0552s/iter; left time: 1692.3981s
	iters: 400, epoch: 35 | loss: 0.0063587
	speed: 0.0602s/iter; left time: 1837.9305s
Epoch: 35 cost time: 30.01277995109558
Epoch: 35, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0040455
	speed: 0.3447s/iter; left time: 10473.8844s
	iters: 200, epoch: 36 | loss: 0.0102677
	speed: 0.0665s/iter; left time: 2015.5087s
	iters: 300, epoch: 36 | loss: 0.2988217
	speed: 0.0598s/iter; left time: 1806.5903s
	iters: 400, epoch: 36 | loss: 0.0011325
	speed: 0.0563s/iter; left time: 1693.2742s
Epoch: 36 cost time: 29.475244283676147
Epoch: 36, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0849562
	speed: 0.3386s/iter; left time: 10129.0989s
	iters: 200, epoch: 37 | loss: 0.1485770
	speed: 0.0634s/iter; left time: 1890.3034s
	iters: 300, epoch: 37 | loss: 0.0049639
	speed: 0.0611s/iter; left time: 1815.9955s
	iters: 400, epoch: 37 | loss: 0.0726353
	speed: 0.0575s/iter; left time: 1703.9420s
Epoch: 37 cost time: 28.63671612739563
Epoch: 37, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0083076
	speed: 0.3110s/iter; left time: 9159.3902s
	iters: 200, epoch: 38 | loss: 0.5270112
	speed: 0.0649s/iter; left time: 1903.5447s
	iters: 300, epoch: 38 | loss: 0.0103371
	speed: 0.0643s/iter; left time: 1879.8561s
	iters: 400, epoch: 38 | loss: 0.0202340
	speed: 0.0688s/iter; left time: 2006.6911s
Epoch: 38 cost time: 30.87986159324646
Epoch: 38, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0107178
	speed: 0.3134s/iter; left time: 9082.5052s
	iters: 200, epoch: 39 | loss: 0.0146428
	speed: 0.0624s/iter; left time: 1802.3459s
	iters: 300, epoch: 39 | loss: 0.0080840
	speed: 0.0617s/iter; left time: 1775.2602s
	iters: 400, epoch: 39 | loss: 0.0073706
	speed: 0.0628s/iter; left time: 1800.5621s
Epoch: 39 cost time: 29.995335340499878
Epoch: 39, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0047856
	speed: 0.3289s/iter; left time: 9376.4852s
	iters: 200, epoch: 40 | loss: 0.0170851
	speed: 0.0638s/iter; left time: 1813.8879s
	iters: 300, epoch: 40 | loss: 0.0016040
	speed: 0.0635s/iter; left time: 1796.7788s
	iters: 400, epoch: 40 | loss: 0.0029926
	speed: 0.0622s/iter; left time: 1753.8619s
Epoch: 40 cost time: 30.444737434387207
Epoch: 40, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.980273).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0129893
	speed: 0.3262s/iter; left time: 9148.1457s
	iters: 200, epoch: 41 | loss: 0.0898685
	speed: 0.0681s/iter; left time: 1902.8181s
	iters: 300, epoch: 41 | loss: 0.0015152
	speed: 0.0621s/iter; left time: 1730.2338s
	iters: 400, epoch: 41 | loss: 0.0022603
	speed: 0.0639s/iter; left time: 1771.5054s
Epoch: 41 cost time: 30.804478883743286
Epoch: 41, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0045099
	speed: 0.2735s/iter; left time: 7539.6439s
	iters: 200, epoch: 42 | loss: 0.0143920
	speed: 0.0610s/iter; left time: 1675.7749s
	iters: 300, epoch: 42 | loss: 0.0178353
	speed: 0.0679s/iter; left time: 1859.4594s
	iters: 400, epoch: 42 | loss: 0.1323355
	speed: 0.0649s/iter; left time: 1768.7682s
Epoch: 42 cost time: 28.948866367340088
Epoch: 42, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.981417).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0221108
	speed: 0.3367s/iter; left time: 9125.7972s
	iters: 200, epoch: 43 | loss: 0.0599578
	speed: 0.0620s/iter; left time: 1675.4455s
	iters: 300, epoch: 43 | loss: 0.0849121
	speed: 0.0643s/iter; left time: 1729.5276s
	iters: 400, epoch: 43 | loss: 0.0233634
	speed: 0.0677s/iter; left time: 1814.7620s
Epoch: 43 cost time: 30.895671844482422
Epoch: 43, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0309050
	speed: 0.3342s/iter; left time: 8902.4111s
	iters: 200, epoch: 44 | loss: 0.0035728
	speed: 0.0635s/iter; left time: 1685.3950s
	iters: 300, epoch: 44 | loss: 0.0134205
	speed: 0.0619s/iter; left time: 1635.9964s
	iters: 400, epoch: 44 | loss: 0.0067574
	speed: 0.0655s/iter; left time: 1723.7099s
Epoch: 44 cost time: 30.55232334136963
Epoch: 44, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0013498
	speed: 0.3302s/iter; left time: 8639.7327s
	iters: 200, epoch: 45 | loss: 0.0007256
	speed: 0.0686s/iter; left time: 1787.8145s
	iters: 300, epoch: 45 | loss: 0.0254062
	speed: 0.0723s/iter; left time: 1877.5572s
	iters: 400, epoch: 45 | loss: 0.0003054
	speed: 0.0645s/iter; left time: 1667.5483s
Epoch: 45 cost time: 32.33308529853821
Epoch: 45, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0071688
	speed: 0.3489s/iter; left time: 8964.2243s
	iters: 200, epoch: 46 | loss: 0.0009613
	speed: 0.0657s/iter; left time: 1682.4724s
	iters: 300, epoch: 46 | loss: 0.0419696
	speed: 0.0660s/iter; left time: 1683.4840s
	iters: 400, epoch: 46 | loss: 0.0100378
	speed: 0.0699s/iter; left time: 1775.6517s
Epoch: 46 cost time: 31.864949464797974
Epoch: 46, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0035625
	speed: 0.3407s/iter; left time: 8594.7119s
	iters: 200, epoch: 47 | loss: 0.0068463
	speed: 0.0634s/iter; left time: 1592.6221s
	iters: 300, epoch: 47 | loss: 0.0018641
	speed: 0.0631s/iter; left time: 1580.0460s
	iters: 400, epoch: 47 | loss: 0.0015646
	speed: 0.0634s/iter; left time: 1580.4334s
Epoch: 47 cost time: 30.850035190582275
Epoch: 47, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.0007619
	speed: 0.3314s/iter; left time: 8205.7123s
	iters: 200, epoch: 48 | loss: 0.0002615
	speed: 0.0693s/iter; left time: 1708.9633s
	iters: 300, epoch: 48 | loss: 0.1299233
	speed: 0.0695s/iter; left time: 1706.7482s
	iters: 400, epoch: 48 | loss: 0.0043508
	speed: 0.0663s/iter; left time: 1620.8205s
Epoch: 48 cost time: 31.800710916519165
Epoch: 48, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.0189710
	speed: 0.3349s/iter; left time: 8134.4591s
	iters: 200, epoch: 49 | loss: 0.0100086
	speed: 0.0634s/iter; left time: 1532.4059s
	iters: 300, epoch: 49 | loss: 0.0004664
	speed: 0.0634s/iter; left time: 1527.3616s
	iters: 400, epoch: 49 | loss: 0.0054383
	speed: 0.0680s/iter; left time: 1631.8647s
Epoch: 49 cost time: 30.9168918132782
Epoch: 49, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.0017220
	speed: 0.3348s/iter; left time: 7975.7390s
	iters: 200, epoch: 50 | loss: 0.0039074
	speed: 0.0625s/iter; left time: 1481.3784s
	iters: 300, epoch: 50 | loss: 0.0065583
	speed: 0.0653s/iter; left time: 1542.6733s
	iters: 400, epoch: 50 | loss: 0.0013079
	speed: 0.0656s/iter; left time: 1542.8595s
Epoch: 50 cost time: 31.029905319213867
Epoch: 50, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.0011252
	speed: 0.3348s/iter; left time: 7817.1534s
	iters: 200, epoch: 51 | loss: 0.0023332
	speed: 0.0734s/iter; left time: 1705.9478s
	iters: 300, epoch: 51 | loss: 0.0207450
	speed: 0.0721s/iter; left time: 1668.5023s
	iters: 400, epoch: 51 | loss: 0.0064677
	speed: 0.0653s/iter; left time: 1505.6060s
Epoch: 51 cost time: 32.10649013519287
Epoch: 51, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.2202910
	speed: 0.3424s/iter; left time: 7835.7974s
	iters: 200, epoch: 52 | loss: 0.0169340
	speed: 0.0649s/iter; left time: 1477.9662s
	iters: 300, epoch: 52 | loss: 0.0026664
	speed: 0.0644s/iter; left time: 1460.1317s
	iters: 400, epoch: 52 | loss: 0.0040581
	speed: 0.0681s/iter; left time: 1538.2798s
Epoch: 52 cost time: 31.3672456741333
Epoch: 52, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 138874
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5352004
	speed: 0.0819s/iter; left time: 3833.0708s
	iters: 200, epoch: 1 | loss: 0.8815131
	speed: 0.0687s/iter; left time: 3208.1792s
	iters: 300, epoch: 1 | loss: 0.6332173
	speed: 0.0637s/iter; left time: 2966.3006s
	iters: 400, epoch: 1 | loss: 0.3809036
	speed: 0.0569s/iter; left time: 2646.8887s
Epoch: 1 cost time: 31.272770881652832
Epoch: 1, Steps: 469 | Train Loss: 1.050 Vali Loss: 0.466 Vali Acc: 0.850 Test Loss: 0.466 Test Acc: 0.850
Validation loss decreased (inf --> -0.849910).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3860829
	speed: 0.3425s/iter; left time: 15868.5009s
	iters: 200, epoch: 2 | loss: 0.6564052
	speed: 0.0620s/iter; left time: 2864.8942s
	iters: 300, epoch: 2 | loss: 0.3922375
	speed: 0.0608s/iter; left time: 2802.8196s
	iters: 400, epoch: 2 | loss: 0.2669706
	speed: 0.0666s/iter; left time: 3065.6261s
Epoch: 2 cost time: 29.725620985031128
Epoch: 2, Steps: 469 | Train Loss: 0.307 Vali Loss: 0.275 Vali Acc: 0.924 Test Loss: 0.275 Test Acc: 0.924
Validation loss decreased (-0.849910 --> -0.923954).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0914528
	speed: 0.3410s/iter; left time: 15638.6956s
	iters: 200, epoch: 3 | loss: 0.3089554
	speed: 0.0639s/iter; left time: 2923.0526s
	iters: 300, epoch: 3 | loss: 0.2087671
	speed: 0.0587s/iter; left time: 2678.3666s
	iters: 400, epoch: 3 | loss: 0.1409926
	speed: 0.0621s/iter; left time: 2827.6386s
Epoch: 3 cost time: 30.171745538711548
Epoch: 3, Steps: 469 | Train Loss: 0.199 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.923954 --> -0.933102).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1941154
	speed: 0.3486s/iter; left time: 15825.1480s
	iters: 200, epoch: 4 | loss: 0.1302534
	speed: 0.0663s/iter; left time: 3001.7490s
	iters: 300, epoch: 4 | loss: 0.6457047
	speed: 0.0661s/iter; left time: 2988.6084s
	iters: 400, epoch: 4 | loss: 0.1905935
	speed: 0.0608s/iter; left time: 2743.9228s
Epoch: 4 cost time: 30.532392740249634
Epoch: 4, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
Validation loss decreased (-0.933102 --> -0.942537).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1430378
	speed: 0.3512s/iter; left time: 15778.3938s
	iters: 200, epoch: 5 | loss: 0.0437058
	speed: 0.0623s/iter; left time: 2792.7469s
	iters: 300, epoch: 5 | loss: 0.0284394
	speed: 0.0620s/iter; left time: 2770.7921s
	iters: 400, epoch: 5 | loss: 0.0185297
	speed: 0.0654s/iter; left time: 2917.9627s
Epoch: 5 cost time: 30.54332733154297
Epoch: 5, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
Validation loss decreased (-0.942537 --> -0.949398).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0367809
	speed: 0.3476s/iter; left time: 15450.8839s
	iters: 200, epoch: 6 | loss: 0.1323978
	speed: 0.0596s/iter; left time: 2644.7448s
	iters: 300, epoch: 6 | loss: 0.0472816
	speed: 0.0563s/iter; left time: 2490.9818s
	iters: 400, epoch: 6 | loss: 0.0220434
	speed: 0.0561s/iter; left time: 2479.1884s
Epoch: 6 cost time: 28.980833768844604
Epoch: 6, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
Validation loss decreased (-0.949398 --> -0.960547).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1365041
	speed: 0.3418s/iter; left time: 15036.2821s
	iters: 200, epoch: 7 | loss: 0.0307310
	speed: 0.0655s/iter; left time: 2873.5536s
	iters: 300, epoch: 7 | loss: 0.1883881
	speed: 0.0636s/iter; left time: 2782.9489s
	iters: 400, epoch: 7 | loss: 0.0381737
	speed: 0.0581s/iter; left time: 2539.5774s
Epoch: 7 cost time: 29.67297601699829
Epoch: 7, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2367910
	speed: 0.3429s/iter; left time: 14923.6085s
	iters: 200, epoch: 8 | loss: 0.0899120
	speed: 0.0609s/iter; left time: 2642.6828s
	iters: 300, epoch: 8 | loss: 0.0343925
	speed: 0.0602s/iter; left time: 2609.7915s
	iters: 400, epoch: 8 | loss: 0.0868658
	speed: 0.0638s/iter; left time: 2755.8558s
Epoch: 8 cost time: 29.640511989593506
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.960547 --> -0.966551).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0206002
	speed: 0.3556s/iter; left time: 15308.5492s
	iters: 200, epoch: 9 | loss: 0.0282373
	speed: 0.0621s/iter; left time: 2666.3770s
	iters: 300, epoch: 9 | loss: 0.0290753
	speed: 0.0575s/iter; left time: 2463.2661s
	iters: 400, epoch: 9 | loss: 0.0719154
	speed: 0.0598s/iter; left time: 2557.6425s
Epoch: 9 cost time: 29.99700403213501
Epoch: 9, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0499780
	speed: 0.3552s/iter; left time: 15125.2129s
	iters: 200, epoch: 10 | loss: 0.0208888
	speed: 0.0612s/iter; left time: 2598.0333s
	iters: 300, epoch: 10 | loss: 0.2918377
	speed: 0.0542s/iter; left time: 2297.6421s
	iters: 400, epoch: 10 | loss: 0.1850824
	speed: 0.0512s/iter; left time: 2165.4303s
Epoch: 10 cost time: 27.5850567817688
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0177891
	speed: 0.3285s/iter; left time: 13833.9267s
	iters: 200, epoch: 11 | loss: 0.0102178
	speed: 0.0599s/iter; left time: 2516.7810s
	iters: 300, epoch: 11 | loss: 0.0875688
	speed: 0.0660s/iter; left time: 2767.8769s
	iters: 400, epoch: 11 | loss: 0.0201084
	speed: 0.0627s/iter; left time: 2622.6271s
Epoch: 11 cost time: 29.82269310951233
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0147825
	speed: 0.3411s/iter; left time: 14205.3977s
	iters: 200, epoch: 12 | loss: 0.0488426
	speed: 0.0593s/iter; left time: 2462.3948s
	iters: 300, epoch: 12 | loss: 0.0045771
	speed: 0.0560s/iter; left time: 2318.9270s
	iters: 400, epoch: 12 | loss: 0.0845431
	speed: 0.0674s/iter; left time: 2786.3143s
Epoch: 12 cost time: 29.451015949249268
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.966551 --> -0.966837).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0466577
	speed: 0.3489s/iter; left time: 14364.4977s
	iters: 200, epoch: 13 | loss: 0.0082686
	speed: 0.0561s/iter; left time: 2305.3422s
	iters: 300, epoch: 13 | loss: 0.0953843
	speed: 0.0542s/iter; left time: 2222.5784s
	iters: 400, epoch: 13 | loss: 0.0294466
	speed: 0.0597s/iter; left time: 2439.3800s
Epoch: 13 cost time: 28.44065546989441
Epoch: 13, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.969124).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0484043
	speed: 0.3400s/iter; left time: 13837.9388s
	iters: 200, epoch: 14 | loss: 0.2113194
	speed: 0.0666s/iter; left time: 2705.4715s
	iters: 300, epoch: 14 | loss: 0.0241449
	speed: 0.0623s/iter; left time: 2524.3724s
	iters: 400, epoch: 14 | loss: 0.0837308
	speed: 0.0637s/iter; left time: 2575.4036s
Epoch: 14 cost time: 30.6655912399292
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0117624
	speed: 0.3526s/iter; left time: 14186.1353s
	iters: 200, epoch: 15 | loss: 0.0106384
	speed: 0.0646s/iter; left time: 2594.3274s
	iters: 300, epoch: 15 | loss: 0.0090960
	speed: 0.0643s/iter; left time: 2575.2413s
	iters: 400, epoch: 15 | loss: 0.2176595
	speed: 0.0654s/iter; left time: 2610.4530s
Epoch: 15 cost time: 30.896549463272095
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
Validation loss decreased (-0.969124 --> -0.974270).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0256540
	speed: 0.3582s/iter; left time: 14243.8382s
	iters: 200, epoch: 16 | loss: 0.0022706
	speed: 0.0570s/iter; left time: 2262.7623s
	iters: 300, epoch: 16 | loss: 0.0071659
	speed: 0.0626s/iter; left time: 2475.1335s
	iters: 400, epoch: 16 | loss: 0.0187077
	speed: 0.0688s/iter; left time: 2713.8918s
Epoch: 16 cost time: 30.24191403388977
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0827412
	speed: 0.3455s/iter; left time: 13575.9690s
	iters: 200, epoch: 17 | loss: 0.0660327
	speed: 0.0589s/iter; left time: 2310.0516s
	iters: 300, epoch: 17 | loss: 0.0577491
	speed: 0.0576s/iter; left time: 2250.1443s
	iters: 400, epoch: 17 | loss: 0.1137066
	speed: 0.0654s/iter; left time: 2551.8345s
Epoch: 17 cost time: 29.972447395324707
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.2917993
	speed: 0.3455s/iter; left time: 13413.4049s
	iters: 200, epoch: 18 | loss: 0.0082967
	speed: 0.0610s/iter; left time: 2363.2416s
	iters: 300, epoch: 18 | loss: 0.0890715
	speed: 0.0585s/iter; left time: 2260.1920s
	iters: 400, epoch: 18 | loss: 0.0145979
	speed: 0.0604s/iter; left time: 2328.0189s
Epoch: 18 cost time: 28.850749015808105
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.976271).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0112792
	speed: 0.3181s/iter; left time: 12202.6225s
	iters: 200, epoch: 19 | loss: 0.3309658
	speed: 0.0677s/iter; left time: 2590.6389s
	iters: 300, epoch: 19 | loss: 0.0352703
	speed: 0.0690s/iter; left time: 2633.2341s
	iters: 400, epoch: 19 | loss: 0.0250845
	speed: 0.0591s/iter; left time: 2250.8156s
Epoch: 19 cost time: 30.005149841308594
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0040298
	speed: 0.3349s/iter; left time: 12688.8441s
	iters: 200, epoch: 20 | loss: 0.0108030
	speed: 0.0645s/iter; left time: 2439.0949s
	iters: 300, epoch: 20 | loss: 0.0484415
	speed: 0.0661s/iter; left time: 2489.9984s
	iters: 400, epoch: 20 | loss: 0.0100466
	speed: 0.0669s/iter; left time: 2515.0374s
Epoch: 20 cost time: 30.721290349960327
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1601182
	speed: 0.3366s/iter; left time: 12594.8382s
	iters: 200, epoch: 21 | loss: 0.1712206
	speed: 0.0645s/iter; left time: 2408.9084s
	iters: 300, epoch: 21 | loss: 0.0034343
	speed: 0.0638s/iter; left time: 2374.7519s
	iters: 400, epoch: 21 | loss: 0.0130823
	speed: 0.0670s/iter; left time: 2488.6763s
Epoch: 21 cost time: 30.961185693740845
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.978844).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0709747
	speed: 0.3344s/iter; left time: 12355.1860s
	iters: 200, epoch: 22 | loss: 0.0207215
	speed: 0.0646s/iter; left time: 2380.1595s
	iters: 300, epoch: 22 | loss: 0.0081885
	speed: 0.0613s/iter; left time: 2252.3442s
	iters: 400, epoch: 22 | loss: 0.0916309
	speed: 0.0593s/iter; left time: 2172.1395s
Epoch: 22 cost time: 30.050801753997803
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0065467
	speed: 0.3308s/iter; left time: 12067.9009s
	iters: 200, epoch: 23 | loss: 0.0040391
	speed: 0.0675s/iter; left time: 2456.1264s
	iters: 300, epoch: 23 | loss: 0.0017939
	speed: 0.0624s/iter; left time: 2264.0533s
	iters: 400, epoch: 23 | loss: 0.0123327
	speed: 0.0609s/iter; left time: 2202.1892s
Epoch: 23 cost time: 29.645296573638916
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979988).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0334600
	speed: 0.3302s/iter; left time: 11890.3127s
	iters: 200, epoch: 24 | loss: 0.0078111
	speed: 0.0611s/iter; left time: 2196.0840s
	iters: 300, epoch: 24 | loss: 0.0062305
	speed: 0.0652s/iter; left time: 2335.0188s
	iters: 400, epoch: 24 | loss: 0.0048987
	speed: 0.0621s/iter; left time: 2218.5819s
Epoch: 24 cost time: 29.282310247421265
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0096289
	speed: 0.3347s/iter; left time: 11896.2932s
	iters: 200, epoch: 25 | loss: 0.0180556
	speed: 0.0660s/iter; left time: 2339.3844s
	iters: 300, epoch: 25 | loss: 0.0037178
	speed: 0.0620s/iter; left time: 2191.3908s
	iters: 400, epoch: 25 | loss: 0.0020462
	speed: 0.0680s/iter; left time: 2396.8243s
Epoch: 25 cost time: 30.947197198867798
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0119991
	speed: 0.3438s/iter; left time: 12057.4740s
	iters: 200, epoch: 26 | loss: 0.0731358
	speed: 0.0685s/iter; left time: 2394.3767s
	iters: 300, epoch: 26 | loss: 0.0506766
	speed: 0.0651s/iter; left time: 2272.0843s
	iters: 400, epoch: 26 | loss: 0.0348732
	speed: 0.0606s/iter; left time: 2106.6154s
Epoch: 26 cost time: 31.42425537109375
Epoch: 26, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0120909
	speed: 0.3337s/iter; left time: 11549.5690s
	iters: 200, epoch: 27 | loss: 0.0007842
	speed: 0.0692s/iter; left time: 2386.4940s
	iters: 300, epoch: 27 | loss: 0.0213324
	speed: 0.0651s/iter; left time: 2240.6523s
	iters: 400, epoch: 27 | loss: 0.0017690
	speed: 0.0601s/iter; left time: 2062.9713s
Epoch: 27 cost time: 30.223392009735107
Epoch: 27, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0018000
	speed: 0.3298s/iter; left time: 11259.4442s
	iters: 200, epoch: 28 | loss: 0.0045317
	speed: 0.0649s/iter; left time: 2208.8675s
	iters: 300, epoch: 28 | loss: 0.1513824
	speed: 0.0665s/iter; left time: 2257.9350s
	iters: 400, epoch: 28 | loss: 0.2049236
	speed: 0.0589s/iter; left time: 1991.7229s
Epoch: 28 cost time: 29.755156993865967
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0111687
	speed: 0.3244s/iter; left time: 10922.0588s
	iters: 200, epoch: 29 | loss: 0.0369661
	speed: 0.0603s/iter; left time: 2024.5432s
	iters: 300, epoch: 29 | loss: 0.0123175
	speed: 0.0606s/iter; left time: 2027.3992s
	iters: 400, epoch: 29 | loss: 0.0093253
	speed: 0.0693s/iter; left time: 2312.7561s
Epoch: 29 cost time: 30.0801842212677
Epoch: 29, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0127373
	speed: 0.2991s/iter; left time: 9928.8771s
	iters: 200, epoch: 30 | loss: 0.0659922
	speed: 0.0569s/iter; left time: 1883.8214s
	iters: 300, epoch: 30 | loss: 0.1252786
	speed: 0.0626s/iter; left time: 2067.1098s
	iters: 400, epoch: 30 | loss: 0.0035067
	speed: 0.0625s/iter; left time: 2054.6920s
Epoch: 30 cost time: 28.860559701919556
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.981131).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0018608
	speed: 0.3356s/iter; left time: 10983.1646s
	iters: 200, epoch: 31 | loss: 0.0406506
	speed: 0.0664s/iter; left time: 2165.9951s
	iters: 300, epoch: 31 | loss: 0.1836105
	speed: 0.0639s/iter; left time: 2078.5516s
	iters: 400, epoch: 31 | loss: 0.0104135
	speed: 0.0638s/iter; left time: 2069.2059s
Epoch: 31 cost time: 30.434127807617188
Epoch: 31, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0018741
	speed: 0.3311s/iter; left time: 10683.3685s
	iters: 200, epoch: 32 | loss: 0.0371695
	speed: 0.0679s/iter; left time: 2183.8755s
	iters: 300, epoch: 32 | loss: 0.0007174
	speed: 0.0666s/iter; left time: 2133.8811s
	iters: 400, epoch: 32 | loss: 0.0212665
	speed: 0.0623s/iter; left time: 1991.2430s
Epoch: 32 cost time: 30.12971520423889
Epoch: 32, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.981131 --> -0.981989).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.3449389
	speed: 0.3213s/iter; left time: 10213.6037s
	iters: 200, epoch: 33 | loss: 0.0798648
	speed: 0.0577s/iter; left time: 1829.4268s
	iters: 300, epoch: 33 | loss: 0.0030526
	speed: 0.0646s/iter; left time: 2040.8505s
	iters: 400, epoch: 33 | loss: 0.0067717
	speed: 0.0650s/iter; left time: 2046.2438s
Epoch: 33 cost time: 28.838837385177612
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0084022
	speed: 0.3082s/iter; left time: 9652.6197s
	iters: 200, epoch: 34 | loss: 0.0291518
	speed: 0.0487s/iter; left time: 1520.2275s
	iters: 300, epoch: 34 | loss: 0.0054631
	speed: 0.0552s/iter; left time: 1718.4129s
	iters: 400, epoch: 34 | loss: 0.0189410
	speed: 0.0663s/iter; left time: 2055.4794s
Epoch: 34 cost time: 26.63050150871277
Epoch: 34, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0052502
	speed: 0.3266s/iter; left time: 10075.7342s
	iters: 200, epoch: 35 | loss: 0.0019041
	speed: 0.0582s/iter; left time: 1788.7601s
	iters: 300, epoch: 35 | loss: 0.0172779
	speed: 0.0566s/iter; left time: 1734.7741s
	iters: 400, epoch: 35 | loss: 0.0389634
	speed: 0.0605s/iter; left time: 1848.9511s
Epoch: 35 cost time: 29.015353679656982
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.981989 --> -0.982275).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0062373
	speed: 0.3251s/iter; left time: 9877.6902s
	iters: 200, epoch: 36 | loss: 0.0017507
	speed: 0.0674s/iter; left time: 2040.6009s
	iters: 300, epoch: 36 | loss: 0.2444098
	speed: 0.0644s/iter; left time: 1942.7423s
	iters: 400, epoch: 36 | loss: 0.0018152
	speed: 0.0618s/iter; left time: 1858.5342s
Epoch: 36 cost time: 30.431154251098633
Epoch: 36, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0106591
	speed: 0.3287s/iter; left time: 9832.7535s
	iters: 200, epoch: 37 | loss: 0.2127097
	speed: 0.0611s/iter; left time: 1820.6330s
	iters: 300, epoch: 37 | loss: 0.0059104
	speed: 0.0667s/iter; left time: 1981.5877s
	iters: 400, epoch: 37 | loss: 0.0287768
	speed: 0.0612s/iter; left time: 1812.7101s
Epoch: 37 cost time: 29.403958559036255
Epoch: 37, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0107233
	speed: 0.3210s/iter; left time: 9452.5462s
	iters: 200, epoch: 38 | loss: 0.3469265
	speed: 0.0566s/iter; left time: 1660.1133s
	iters: 300, epoch: 38 | loss: 0.0026240
	speed: 0.0622s/iter; left time: 1818.1335s
	iters: 400, epoch: 38 | loss: 0.0109070
	speed: 0.0616s/iter; left time: 1794.6562s
Epoch: 38 cost time: 28.238118648529053
Epoch: 38, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0040889
	speed: 0.3130s/iter; left time: 9070.2970s
	iters: 200, epoch: 39 | loss: 0.0048015
	speed: 0.0552s/iter; left time: 1593.2495s
	iters: 300, epoch: 39 | loss: 0.0196179
	speed: 0.0545s/iter; left time: 1567.5031s
	iters: 400, epoch: 39 | loss: 0.0073045
	speed: 0.0617s/iter; left time: 1770.8597s
Epoch: 39 cost time: 27.537627935409546
Epoch: 39, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0055192
	speed: 0.3119s/iter; left time: 8893.1584s
	iters: 200, epoch: 40 | loss: 0.0076018
	speed: 0.0625s/iter; left time: 1776.2383s
	iters: 300, epoch: 40 | loss: 0.0013561
	speed: 0.0611s/iter; left time: 1728.5914s
	iters: 400, epoch: 40 | loss: 0.0014893
	speed: 0.0601s/iter; left time: 1694.5553s
Epoch: 40 cost time: 28.83203148841858
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0080281
	speed: 0.3178s/iter; left time: 8910.7475s
	iters: 200, epoch: 41 | loss: 0.0861836
	speed: 0.0625s/iter; left time: 1745.9987s
	iters: 300, epoch: 41 | loss: 0.0044589
	speed: 0.0600s/iter; left time: 1670.7963s
	iters: 400, epoch: 41 | loss: 0.0057918
	speed: 0.0554s/iter; left time: 1535.9630s
Epoch: 41 cost time: 27.905627965927124
Epoch: 41, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0115449
	speed: 0.3340s/iter; left time: 9208.7741s
	iters: 200, epoch: 42 | loss: 0.0209440
	speed: 0.0706s/iter; left time: 1938.6481s
	iters: 300, epoch: 42 | loss: 0.0883610
	speed: 0.0709s/iter; left time: 1941.6492s
	iters: 400, epoch: 42 | loss: 0.0098459
	speed: 0.0605s/iter; left time: 1650.0757s
Epoch: 42 cost time: 31.175150871276855
Epoch: 42, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.0171802
	speed: 0.3451s/iter; left time: 9352.9552s
	iters: 200, epoch: 43 | loss: 0.0161880
	speed: 0.0616s/iter; left time: 1662.1083s
	iters: 300, epoch: 43 | loss: 0.0673582
	speed: 0.0576s/iter; left time: 1548.5019s
	iters: 400, epoch: 43 | loss: 0.0832545
	speed: 0.0502s/iter; left time: 1344.8084s
Epoch: 43 cost time: 28.35661029815674
Epoch: 43, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0350028
	speed: 0.3507s/iter; left time: 9341.2879s
	iters: 200, epoch: 44 | loss: 0.0052008
	speed: 0.0463s/iter; left time: 1227.4368s
	iters: 300, epoch: 44 | loss: 0.0072482
	speed: 0.0458s/iter; left time: 1209.5683s
	iters: 400, epoch: 44 | loss: 0.0012160
	speed: 0.0579s/iter; left time: 1525.8180s
Epoch: 44 cost time: 24.843725204467773
Epoch: 44, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0035377
	speed: 0.3406s/iter; left time: 8912.5175s
	iters: 200, epoch: 45 | loss: 0.0079152
	speed: 0.0622s/iter; left time: 1622.4701s
	iters: 300, epoch: 45 | loss: 0.0486325
	speed: 0.0587s/iter; left time: 1524.7919s
	iters: 400, epoch: 45 | loss: 0.0018839
	speed: 0.0580s/iter; left time: 1499.5795s
Epoch: 45 cost time: 29.484652996063232
Epoch: 45, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 138874
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6134647
	speed: 0.0772s/iter; left time: 3611.7935s
	iters: 200, epoch: 1 | loss: 0.9947916
	speed: 0.0623s/iter; left time: 2907.6231s
	iters: 300, epoch: 1 | loss: 0.6159335
	speed: 0.0693s/iter; left time: 3227.6545s
	iters: 400, epoch: 1 | loss: 0.4276561
	speed: 0.0622s/iter; left time: 2893.1227s
Epoch: 1 cost time: 31.460787057876587
Epoch: 1, Steps: 469 | Train Loss: 1.060 Vali Loss: 0.456 Vali Acc: 0.864 Test Loss: 0.456 Test Acc: 0.864
Validation loss decreased (inf --> -0.863632).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4274253
	speed: 0.3411s/iter; left time: 15805.0755s
	iters: 200, epoch: 2 | loss: 0.6134939
	speed: 0.0573s/iter; left time: 2647.2881s
	iters: 300, epoch: 2 | loss: 0.4035240
	speed: 0.0569s/iter; left time: 2626.5468s
	iters: 400, epoch: 2 | loss: 0.1061580
	speed: 0.0683s/iter; left time: 3143.0366s
Epoch: 2 cost time: 29.055577993392944
Epoch: 2, Steps: 469 | Train Loss: 0.289 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.863632 --> -0.941107).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0754989
	speed: 0.3356s/iter; left time: 15392.4634s
	iters: 200, epoch: 3 | loss: 0.1001621
	speed: 0.0585s/iter; left time: 2674.9202s
	iters: 300, epoch: 3 | loss: 0.0434277
	speed: 0.0569s/iter; left time: 2599.3398s
	iters: 400, epoch: 3 | loss: 0.0580164
	speed: 0.0621s/iter; left time: 2829.6658s
Epoch: 3 cost time: 28.712890625
Epoch: 3, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.941107 --> -0.949684).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2530523
	speed: 0.3311s/iter; left time: 15030.4175s
	iters: 200, epoch: 4 | loss: 0.1644460
	speed: 0.0581s/iter; left time: 2632.4782s
	iters: 300, epoch: 4 | loss: 0.5862308
	speed: 0.0556s/iter; left time: 2513.6690s
	iters: 400, epoch: 4 | loss: 0.3798767
	speed: 0.0571s/iter; left time: 2573.1880s
Epoch: 4 cost time: 27.983996391296387
Epoch: 4, Steps: 469 | Train Loss: 0.138 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.949684 --> -0.956831).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1118327
	speed: 0.3275s/iter; left time: 14711.5465s
	iters: 200, epoch: 5 | loss: 0.0643151
	speed: 0.0634s/iter; left time: 2840.2885s
	iters: 300, epoch: 5 | loss: 0.0226006
	speed: 0.0578s/iter; left time: 2586.1978s
	iters: 400, epoch: 5 | loss: 0.0136629
	speed: 0.0548s/iter; left time: 2447.1003s
Epoch: 5 cost time: 27.657046794891357
Epoch: 5, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.956831 --> -0.959404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0150550
	speed: 0.3295s/iter; left time: 14648.5773s
	iters: 200, epoch: 6 | loss: 0.0265217
	speed: 0.0575s/iter; left time: 2551.4683s
	iters: 300, epoch: 6 | loss: 0.0446616
	speed: 0.0576s/iter; left time: 2550.6513s
	iters: 400, epoch: 6 | loss: 0.0094891
	speed: 0.0624s/iter; left time: 2756.3417s
Epoch: 6 cost time: 28.575624227523804
Epoch: 6, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.959404 --> -0.968266).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0672199
	speed: 0.3397s/iter; left time: 14942.5797s
	iters: 200, epoch: 7 | loss: 0.1132155
	speed: 0.0586s/iter; left time: 2571.2984s
	iters: 300, epoch: 7 | loss: 0.0320387
	speed: 0.0603s/iter; left time: 2640.3506s
	iters: 400, epoch: 7 | loss: 0.0136709
	speed: 0.0663s/iter; left time: 2897.5299s
Epoch: 7 cost time: 30.03102469444275
Epoch: 7, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1123894
	speed: 0.3388s/iter; left time: 14743.2613s
	iters: 200, epoch: 8 | loss: 0.1088230
	speed: 0.0635s/iter; left time: 2758.3190s
	iters: 300, epoch: 8 | loss: 0.0372749
	speed: 0.0602s/iter; left time: 2608.1098s
	iters: 400, epoch: 8 | loss: 0.0300029
	speed: 0.0569s/iter; left time: 2460.9916s
Epoch: 8 cost time: 30.76401996612549
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
Validation loss decreased (-0.968266 --> -0.971697).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0095678
	speed: 0.3578s/iter; left time: 15402.9043s
	iters: 200, epoch: 9 | loss: 0.0301021
	speed: 0.0677s/iter; left time: 2906.9607s
	iters: 300, epoch: 9 | loss: 0.0140869
	speed: 0.0623s/iter; left time: 2670.5611s
	iters: 400, epoch: 9 | loss: 0.1618762
	speed: 0.0610s/iter; left time: 2606.8928s
Epoch: 9 cost time: 30.48917531967163
Epoch: 9, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0189670
	speed: 0.3561s/iter; left time: 15163.5875s
	iters: 200, epoch: 10 | loss: 0.0156283
	speed: 0.0653s/iter; left time: 2775.0541s
	iters: 300, epoch: 10 | loss: 0.2562042
	speed: 0.0595s/iter; left time: 2523.5695s
	iters: 400, epoch: 10 | loss: 0.0987851
	speed: 0.0596s/iter; left time: 2518.6719s
Epoch: 10 cost time: 29.777113437652588
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972555).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0145000
	speed: 0.3390s/iter; left time: 14277.4012s
	iters: 200, epoch: 11 | loss: 0.0243580
	speed: 0.0588s/iter; left time: 2468.9663s
	iters: 300, epoch: 11 | loss: 0.1387666
	speed: 0.0629s/iter; left time: 2637.5988s
	iters: 400, epoch: 11 | loss: 0.0033245
	speed: 0.0567s/iter; left time: 2369.6192s
Epoch: 11 cost time: 28.561955451965332
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.973412).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0156671
	speed: 0.3435s/iter; left time: 14305.8745s
	iters: 200, epoch: 12 | loss: 0.0111325
	speed: 0.0579s/iter; left time: 2405.9293s
	iters: 300, epoch: 12 | loss: 0.0032360
	speed: 0.0590s/iter; left time: 2446.0786s
	iters: 400, epoch: 12 | loss: 0.0170525
	speed: 0.0614s/iter; left time: 2539.3192s
Epoch: 12 cost time: 29.051196575164795
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.974270).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0079696
	speed: 0.3395s/iter; left time: 13978.3945s
	iters: 200, epoch: 13 | loss: 0.0104066
	speed: 0.0610s/iter; left time: 2503.6351s
	iters: 300, epoch: 13 | loss: 0.1090320
	speed: 0.0568s/iter; left time: 2326.4000s
	iters: 400, epoch: 13 | loss: 0.0111045
	speed: 0.0625s/iter; left time: 2553.5345s
Epoch: 13 cost time: 29.503019332885742
Epoch: 13, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0328735
	speed: 0.3477s/iter; left time: 14154.2818s
	iters: 200, epoch: 14 | loss: 0.1022087
	speed: 0.0653s/iter; left time: 2652.9432s
	iters: 300, epoch: 14 | loss: 0.0333879
	speed: 0.0593s/iter; left time: 2402.5448s
	iters: 400, epoch: 14 | loss: 0.0546674
	speed: 0.0582s/iter; left time: 2350.0840s
Epoch: 14 cost time: 29.765209674835205
Epoch: 14, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0032041
	speed: 0.3134s/iter; left time: 12611.1524s
	iters: 200, epoch: 15 | loss: 0.0080339
	speed: 0.0689s/iter; left time: 2764.9314s
	iters: 300, epoch: 15 | loss: 0.0033987
	speed: 0.0697s/iter; left time: 2789.6916s
	iters: 400, epoch: 15 | loss: 0.0452777
	speed: 0.0644s/iter; left time: 2571.5418s
Epoch: 15 cost time: 31.386420488357544
Epoch: 15, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0776089
	speed: 0.3223s/iter; left time: 12816.7747s
	iters: 200, epoch: 16 | loss: 0.0009387
	speed: 0.0587s/iter; left time: 2328.8235s
	iters: 300, epoch: 16 | loss: 0.0040528
	speed: 0.0613s/iter; left time: 2427.2062s
	iters: 400, epoch: 16 | loss: 0.1286657
	speed: 0.0524s/iter; left time: 2069.5348s
Epoch: 16 cost time: 27.483041048049927
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976843).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0253847
	speed: 0.3070s/iter; left time: 12063.8521s
	iters: 200, epoch: 17 | loss: 0.1270713
	speed: 0.0609s/iter; left time: 2388.3864s
	iters: 300, epoch: 17 | loss: 0.0173866
	speed: 0.0658s/iter; left time: 2570.9439s
	iters: 400, epoch: 17 | loss: 0.1183154
	speed: 0.0630s/iter; left time: 2455.0936s
Epoch: 17 cost time: 29.74953603744507
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0332236
	speed: 0.3131s/iter; left time: 12155.1382s
	iters: 200, epoch: 18 | loss: 0.0524486
	speed: 0.0582s/iter; left time: 2254.3880s
	iters: 300, epoch: 18 | loss: 0.0030937
	speed: 0.0609s/iter; left time: 2351.7555s
	iters: 400, epoch: 18 | loss: 0.0075355
	speed: 0.0656s/iter; left time: 2527.6800s
Epoch: 18 cost time: 29.426294326782227
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977129).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0090622
	speed: 0.3139s/iter; left time: 12039.5438s
	iters: 200, epoch: 19 | loss: 0.1861305
	speed: 0.0605s/iter; left time: 2313.2518s
	iters: 300, epoch: 19 | loss: 0.0074356
	speed: 0.0662s/iter; left time: 2525.2542s
	iters: 400, epoch: 19 | loss: 0.0269206
	speed: 0.0634s/iter; left time: 2414.1672s
Epoch: 19 cost time: 31.115833282470703
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0086732
	speed: 0.3294s/iter; left time: 12482.0614s
	iters: 200, epoch: 20 | loss: 0.0059695
	speed: 0.0641s/iter; left time: 2422.8593s
	iters: 300, epoch: 20 | loss: 0.0531878
	speed: 0.0621s/iter; left time: 2341.8119s
	iters: 400, epoch: 20 | loss: 0.1060138
	speed: 0.0650s/iter; left time: 2443.7121s
Epoch: 20 cost time: 30.593601942062378
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.979130).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0209621
	speed: 0.3248s/iter; left time: 12155.5085s
	iters: 200, epoch: 21 | loss: 0.0968403
	speed: 0.0630s/iter; left time: 2349.6891s
	iters: 300, epoch: 21 | loss: 0.0074016
	speed: 0.0594s/iter; left time: 2212.2767s
	iters: 400, epoch: 21 | loss: 0.0130361
	speed: 0.0558s/iter; left time: 2069.6919s
Epoch: 21 cost time: 28.62538766860962
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.1517661
	speed: 0.3117s/iter; left time: 11519.2930s
	iters: 200, epoch: 22 | loss: 0.0432583
	speed: 0.0610s/iter; left time: 2248.3210s
	iters: 300, epoch: 22 | loss: 0.0890044
	speed: 0.0678s/iter; left time: 2491.6153s
	iters: 400, epoch: 22 | loss: 0.0051545
	speed: 0.0614s/iter; left time: 2252.0027s
Epoch: 22 cost time: 29.583338022232056
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0043755
	speed: 0.3117s/iter; left time: 11372.4249s
	iters: 200, epoch: 23 | loss: 0.0057698
	speed: 0.0611s/iter; left time: 2223.1451s
	iters: 300, epoch: 23 | loss: 0.0033144
	speed: 0.0614s/iter; left time: 2228.5726s
	iters: 400, epoch: 23 | loss: 0.0035566
	speed: 0.0664s/iter; left time: 2403.6669s
Epoch: 23 cost time: 29.680269241333008
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0041304
	speed: 0.3175s/iter; left time: 11435.3983s
	iters: 200, epoch: 24 | loss: 0.0826075
	speed: 0.0606s/iter; left time: 2176.4244s
	iters: 300, epoch: 24 | loss: 0.0097241
	speed: 0.0615s/iter; left time: 2200.9095s
	iters: 400, epoch: 24 | loss: 0.0185798
	speed: 0.0659s/iter; left time: 2352.5511s
Epoch: 24 cost time: 30.060674905776978
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.1531272
	speed: 0.3227s/iter; left time: 11469.3011s
	iters: 200, epoch: 25 | loss: 0.1936694
	speed: 0.0630s/iter; left time: 2233.1520s
	iters: 300, epoch: 25 | loss: 0.0010447
	speed: 0.0603s/iter; left time: 2130.8570s
	iters: 400, epoch: 25 | loss: 0.0006669
	speed: 0.0585s/iter; left time: 2062.3114s
Epoch: 25 cost time: 30.13505458831787
Epoch: 25, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0335557
	speed: 0.3232s/iter; left time: 11335.7368s
	iters: 200, epoch: 26 | loss: 0.0152410
	speed: 0.0681s/iter; left time: 2380.3757s
	iters: 300, epoch: 26 | loss: 0.0889737
	speed: 0.0640s/iter; left time: 2231.8225s
	iters: 400, epoch: 26 | loss: 0.0091751
	speed: 0.0628s/iter; left time: 2185.4044s
Epoch: 26 cost time: 30.602940559387207
Epoch: 26, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0007380
	speed: 0.3248s/iter; left time: 11240.2591s
	iters: 200, epoch: 27 | loss: 0.0002711
	speed: 0.0662s/iter; left time: 2282.7712s
	iters: 300, epoch: 27 | loss: 0.0088984
	speed: 0.0627s/iter; left time: 2156.8225s
	iters: 400, epoch: 27 | loss: 0.0006880
	speed: 0.0602s/iter; left time: 2065.3026s
Epoch: 27 cost time: 29.87425136566162
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0062203
	speed: 0.3191s/iter; left time: 10892.3177s
	iters: 200, epoch: 28 | loss: 0.0124080
	speed: 0.0616s/iter; left time: 2095.7251s
	iters: 300, epoch: 28 | loss: 0.0218510
	speed: 0.0674s/iter; left time: 2287.9746s
	iters: 400, epoch: 28 | loss: 0.0698639
	speed: 0.0622s/iter; left time: 2106.0235s
Epoch: 28 cost time: 29.582857131958008
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0079394
	speed: 0.3132s/iter; left time: 10546.4276s
	iters: 200, epoch: 29 | loss: 0.0026863
	speed: 0.0577s/iter; left time: 1935.2920s
	iters: 300, epoch: 29 | loss: 0.3052836
	speed: 0.0549s/iter; left time: 1838.1118s
	iters: 400, epoch: 29 | loss: 0.0008358
	speed: 0.0665s/iter; left time: 2218.8271s
Epoch: 29 cost time: 28.933682441711426
Epoch: 29, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0026701
	speed: 0.3239s/iter; left time: 10753.5678s
	iters: 200, epoch: 30 | loss: 0.0104720
	speed: 0.0631s/iter; left time: 2089.9447s
	iters: 300, epoch: 30 | loss: 0.0020421
	speed: 0.0621s/iter; left time: 2050.2706s
	iters: 400, epoch: 30 | loss: 0.0002871
	speed: 0.0634s/iter; left time: 2085.5128s
Epoch: 30 cost time: 30.488719701766968
Epoch: 30, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 138874
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5588652
	speed: 0.0798s/iter; left time: 3733.6276s
	iters: 200, epoch: 1 | loss: 0.8180924
	speed: 0.0570s/iter; left time: 2660.8381s
	iters: 300, epoch: 1 | loss: 0.8238758
	speed: 0.0563s/iter; left time: 2623.8639s
	iters: 400, epoch: 1 | loss: 0.2159761
	speed: 0.0613s/iter; left time: 2849.3519s
Epoch: 1 cost time: 30.154632806777954
Epoch: 1, Steps: 469 | Train Loss: 1.069 Vali Loss: 0.539 Vali Acc: 0.840 Test Loss: 0.539 Test Acc: 0.840
Validation loss decreased (inf --> -0.840475).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2386438
	speed: 0.3254s/iter; left time: 15075.7564s
	iters: 200, epoch: 2 | loss: 0.7529052
	speed: 0.0627s/iter; left time: 2899.6142s
	iters: 300, epoch: 2 | loss: 0.2801859
	speed: 0.0556s/iter; left time: 2565.1672s
	iters: 400, epoch: 2 | loss: 0.4104182
	speed: 0.0605s/iter; left time: 2783.1813s
Epoch: 2 cost time: 28.252896785736084
Epoch: 2, Steps: 469 | Train Loss: 0.325 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.840475 --> -0.889076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2489264
	speed: 0.3230s/iter; left time: 14812.0777s
	iters: 200, epoch: 3 | loss: 0.1270745
	speed: 0.0607s/iter; left time: 2778.4737s
	iters: 300, epoch: 3 | loss: 0.3489868
	speed: 0.0599s/iter; left time: 2734.6262s
	iters: 400, epoch: 3 | loss: 0.1101224
	speed: 0.0599s/iter; left time: 2726.9498s
Epoch: 3 cost time: 27.873993158340454
Epoch: 3, Steps: 469 | Train Loss: 0.209 Vali Loss: 0.272 Vali Acc: 0.915 Test Loss: 0.272 Test Acc: 0.915
Validation loss decreased (-0.889076 --> -0.915092).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1076464
	speed: 0.3198s/iter; left time: 14517.7059s
	iters: 200, epoch: 4 | loss: 0.1056881
	speed: 0.0555s/iter; left time: 2514.8294s
	iters: 300, epoch: 4 | loss: 0.0389347
	speed: 0.0625s/iter; left time: 2823.0379s
	iters: 400, epoch: 4 | loss: 0.1697741
	speed: 0.0609s/iter; left time: 2747.0506s
Epoch: 4 cost time: 27.642764568328857
Epoch: 4, Steps: 469 | Train Loss: 0.163 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.915092 --> -0.927671).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1166012
	speed: 0.3272s/iter; left time: 14699.1575s
	iters: 200, epoch: 5 | loss: 0.1308627
	speed: 0.0598s/iter; left time: 2682.0186s
	iters: 300, epoch: 5 | loss: 0.0364452
	speed: 0.0563s/iter; left time: 2517.4165s
	iters: 400, epoch: 5 | loss: 0.0992011
	speed: 0.0628s/iter; left time: 2802.9023s
Epoch: 5 cost time: 28.99228072166443
Epoch: 5, Steps: 469 | Train Loss: 0.133 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
Validation loss decreased (-0.927671 --> -0.949398).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1237368
	speed: 0.3391s/iter; left time: 15074.2547s
	iters: 200, epoch: 6 | loss: 0.1386838
	speed: 0.0580s/iter; left time: 2572.2893s
	iters: 300, epoch: 6 | loss: 0.1066481
	speed: 0.0610s/iter; left time: 2699.5995s
	iters: 400, epoch: 6 | loss: 0.0434514
	speed: 0.0629s/iter; left time: 2778.3905s
Epoch: 6 cost time: 29.504159688949585
Epoch: 6, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.192 Vali Acc: 0.949 Test Loss: 0.192 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0872622
	speed: 0.3358s/iter; left time: 14769.6313s
	iters: 200, epoch: 7 | loss: 0.0993980
	speed: 0.0558s/iter; left time: 2447.8678s
	iters: 300, epoch: 7 | loss: 0.0222606
	speed: 0.0562s/iter; left time: 2459.4435s
	iters: 400, epoch: 7 | loss: 0.0996028
	speed: 0.0612s/iter; left time: 2674.7319s
Epoch: 7 cost time: 28.047035932540894
Epoch: 7, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.949398 --> -0.961405).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0260434
	speed: 0.3163s/iter; left time: 13765.6676s
	iters: 200, epoch: 8 | loss: 0.0467772
	speed: 0.0620s/iter; left time: 2689.9349s
	iters: 300, epoch: 8 | loss: 0.1154802
	speed: 0.0547s/iter; left time: 2369.9420s
	iters: 400, epoch: 8 | loss: 0.0230853
	speed: 0.0555s/iter; left time: 2396.7105s
Epoch: 8 cost time: 26.5828914642334
Epoch: 8, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0338643
	speed: 0.2872s/iter; left time: 12365.2755s
	iters: 200, epoch: 9 | loss: 0.0304128
	speed: 0.0580s/iter; left time: 2492.4134s
	iters: 300, epoch: 9 | loss: 0.0661523
	speed: 0.0603s/iter; left time: 2585.7693s
	iters: 400, epoch: 9 | loss: 0.0666359
	speed: 0.0636s/iter; left time: 2717.6611s
Epoch: 9 cost time: 28.04235577583313
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0495490
	speed: 0.3109s/iter; left time: 13237.3248s
	iters: 200, epoch: 10 | loss: 0.0112363
	speed: 0.0594s/iter; left time: 2523.6339s
	iters: 300, epoch: 10 | loss: 0.0302998
	speed: 0.0596s/iter; left time: 2527.7564s
	iters: 400, epoch: 10 | loss: 0.0313453
	speed: 0.0653s/iter; left time: 2759.7811s
Epoch: 10 cost time: 29.14611840248108
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.961405 --> -0.966837).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0382880
	speed: 0.3228s/iter; left time: 13594.8396s
	iters: 200, epoch: 11 | loss: 0.0670231
	speed: 0.0626s/iter; left time: 2630.9374s
	iters: 300, epoch: 11 | loss: 0.0137441
	speed: 0.0622s/iter; left time: 2606.0400s
	iters: 400, epoch: 11 | loss: 0.0260276
	speed: 0.0650s/iter; left time: 2718.3671s
Epoch: 11 cost time: 30.214064359664917
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.968552).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0453858
	speed: 0.3187s/iter; left time: 13270.2823s
	iters: 200, epoch: 12 | loss: 0.0248017
	speed: 0.0664s/iter; left time: 2759.2548s
	iters: 300, epoch: 12 | loss: 0.0576579
	speed: 0.0602s/iter; left time: 2496.2986s
	iters: 400, epoch: 12 | loss: 0.0200221
	speed: 0.0592s/iter; left time: 2448.8643s
Epoch: 12 cost time: 29.93172597885132
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0165009
	speed: 0.3183s/iter; left time: 13104.6485s
	iters: 200, epoch: 13 | loss: 0.0273641
	speed: 0.0605s/iter; left time: 2483.8457s
	iters: 300, epoch: 13 | loss: 0.0314959
	speed: 0.0494s/iter; left time: 2024.9069s
	iters: 400, epoch: 13 | loss: 0.0562551
	speed: 0.0496s/iter; left time: 2026.8008s
Epoch: 13 cost time: 25.71206307411194
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971697).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0383661
	speed: 0.3235s/iter; left time: 13167.5290s
	iters: 200, epoch: 14 | loss: 0.0078400
	speed: 0.0639s/iter; left time: 2595.6516s
	iters: 300, epoch: 14 | loss: 0.0723481
	speed: 0.0675s/iter; left time: 2733.0888s
	iters: 400, epoch: 14 | loss: 0.0473544
	speed: 0.0587s/iter; left time: 2369.8019s
Epoch: 14 cost time: 29.444022178649902
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0050622
	speed: 0.3200s/iter; left time: 12876.7783s
	iters: 200, epoch: 15 | loss: 0.0093349
	speed: 0.0604s/iter; left time: 2425.3399s
	iters: 300, epoch: 15 | loss: 0.0377114
	speed: 0.0594s/iter; left time: 2379.1860s
	iters: 400, epoch: 15 | loss: 0.0168085
	speed: 0.0634s/iter; left time: 2531.3611s
Epoch: 15 cost time: 29.68778157234192
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.971697 --> -0.972269).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0187903
	speed: 0.3227s/iter; left time: 12832.4388s
	iters: 200, epoch: 16 | loss: 0.0062844
	speed: 0.0694s/iter; left time: 2754.3325s
	iters: 300, epoch: 16 | loss: 0.1360108
	speed: 0.0646s/iter; left time: 2555.1184s
	iters: 400, epoch: 16 | loss: 0.1009029
	speed: 0.0629s/iter; left time: 2480.5121s
Epoch: 16 cost time: 30.777070999145508
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.2532015
	speed: 0.3352s/iter; left time: 13173.2510s
	iters: 200, epoch: 17 | loss: 0.0342399
	speed: 0.0640s/iter; left time: 2509.1069s
	iters: 300, epoch: 17 | loss: 0.0011122
	speed: 0.0681s/iter; left time: 2662.0216s
	iters: 400, epoch: 17 | loss: 0.0368912
	speed: 0.0680s/iter; left time: 2652.1487s
Epoch: 17 cost time: 30.877466917037964
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0166763
	speed: 0.3348s/iter; left time: 12999.4363s
	iters: 200, epoch: 18 | loss: 0.0427084
	speed: 0.0601s/iter; left time: 2328.0966s
	iters: 300, epoch: 18 | loss: 0.0272431
	speed: 0.0564s/iter; left time: 2177.5413s
	iters: 400, epoch: 18 | loss: 0.0665321
	speed: 0.0602s/iter; left time: 2317.5202s
Epoch: 18 cost time: 29.208446264266968
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972269 --> -0.974270).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0859818
	speed: 0.3158s/iter; left time: 12111.8663s
	iters: 200, epoch: 19 | loss: 0.0106604
	speed: 0.0654s/iter; left time: 2501.0558s
	iters: 300, epoch: 19 | loss: 0.0946906
	speed: 0.0638s/iter; left time: 2433.4912s
	iters: 400, epoch: 19 | loss: 0.0118179
	speed: 0.0618s/iter; left time: 2353.0092s
Epoch: 19 cost time: 29.961533784866333
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0178271
	speed: 0.3223s/iter; left time: 12210.1050s
	iters: 200, epoch: 20 | loss: 0.0960451
	speed: 0.0626s/iter; left time: 2367.5015s
	iters: 300, epoch: 20 | loss: 0.0851500
	speed: 0.0632s/iter; left time: 2380.5381s
	iters: 400, epoch: 20 | loss: 0.0178087
	speed: 0.0655s/iter; left time: 2463.5482s
Epoch: 20 cost time: 30.045525789260864
Epoch: 20, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0014308
	speed: 0.3280s/iter; left time: 12273.6574s
	iters: 200, epoch: 21 | loss: 0.0698603
	speed: 0.0635s/iter; left time: 2369.5509s
	iters: 300, epoch: 21 | loss: 0.1912514
	speed: 0.0592s/iter; left time: 2203.6246s
	iters: 400, epoch: 21 | loss: 0.0475663
	speed: 0.0597s/iter; left time: 2217.4871s
Epoch: 21 cost time: 29.343322277069092
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1466093
	speed: 0.3291s/iter; left time: 12159.0560s
	iters: 200, epoch: 22 | loss: 0.0575458
	speed: 0.0665s/iter; left time: 2451.1711s
	iters: 300, epoch: 22 | loss: 0.0049893
	speed: 0.0702s/iter; left time: 2579.0675s
	iters: 400, epoch: 22 | loss: 0.0111313
	speed: 0.0711s/iter; left time: 2604.4454s
Epoch: 22 cost time: 31.423882246017456
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0028452
	speed: 0.3409s/iter; left time: 12437.5514s
	iters: 200, epoch: 23 | loss: 0.1602951
	speed: 0.0704s/iter; left time: 2562.2701s
	iters: 300, epoch: 23 | loss: 0.0993342
	speed: 0.0495s/iter; left time: 1796.1528s
	iters: 400, epoch: 23 | loss: 0.0008056
	speed: 0.0458s/iter; left time: 1657.3183s
Epoch: 23 cost time: 28.127187490463257
Epoch: 23, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0567765
	speed: 0.2950s/iter; left time: 10623.4738s
	iters: 200, epoch: 24 | loss: 0.0056269
	speed: 0.0662s/iter; left time: 2375.9973s
	iters: 300, epoch: 24 | loss: 0.0298861
	speed: 0.0631s/iter; left time: 2258.8073s
	iters: 400, epoch: 24 | loss: 0.0235972
	speed: 0.0619s/iter; left time: 2210.8141s
Epoch: 24 cost time: 30.086154222488403
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0048819
	speed: 0.3270s/iter; left time: 11622.7188s
	iters: 200, epoch: 25 | loss: 0.0211654
	speed: 0.0626s/iter; left time: 2218.1895s
	iters: 300, epoch: 25 | loss: 0.1931870
	speed: 0.0662s/iter; left time: 2339.8695s
	iters: 400, epoch: 25 | loss: 0.2605354
	speed: 0.0662s/iter; left time: 2334.1483s
Epoch: 25 cost time: 30.452856063842773
Epoch: 25, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976843).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0039094
	speed: 0.2992s/iter; left time: 10493.5669s
	iters: 200, epoch: 26 | loss: 0.0414535
	speed: 0.0506s/iter; left time: 1769.8869s
	iters: 300, epoch: 26 | loss: 0.0250414
	speed: 0.0562s/iter; left time: 1959.3613s
	iters: 400, epoch: 26 | loss: 0.0025299
	speed: 0.0660s/iter; left time: 2294.0930s
Epoch: 26 cost time: 27.416977405548096
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978558).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0115568
	speed: 0.3033s/iter; left time: 10496.5774s
	iters: 200, epoch: 27 | loss: 0.0066527
	speed: 0.0663s/iter; left time: 2286.4782s
	iters: 300, epoch: 27 | loss: 0.1455968
	speed: 0.0631s/iter; left time: 2171.7772s
	iters: 400, epoch: 27 | loss: 0.0087074
	speed: 0.0633s/iter; left time: 2170.1443s
Epoch: 27 cost time: 30.630365133285522
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0037139
	speed: 0.3308s/iter; left time: 11292.8912s
	iters: 200, epoch: 28 | loss: 0.0033150
	speed: 0.0698s/iter; left time: 2375.1595s
	iters: 300, epoch: 28 | loss: 0.0135843
	speed: 0.0641s/iter; left time: 2176.6658s
	iters: 400, epoch: 28 | loss: 0.0127547
	speed: 0.0646s/iter; left time: 2184.3065s
Epoch: 28 cost time: 31.098607301712036
Epoch: 28, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0087752
	speed: 0.3336s/iter; left time: 11231.9025s
	iters: 200, epoch: 29 | loss: 0.0016009
	speed: 0.0634s/iter; left time: 2129.5631s
	iters: 300, epoch: 29 | loss: 0.0102698
	speed: 0.0682s/iter; left time: 2281.3852s
	iters: 400, epoch: 29 | loss: 0.0035898
	speed: 0.0634s/iter; left time: 2115.7626s
Epoch: 29 cost time: 30.31449818611145
Epoch: 29, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0366160
	speed: 0.3207s/iter; left time: 10647.7237s
	iters: 200, epoch: 30 | loss: 0.0006720
	speed: 0.0591s/iter; left time: 1955.0732s
	iters: 300, epoch: 30 | loss: 0.0142852
	speed: 0.0586s/iter; left time: 1934.8656s
	iters: 400, epoch: 30 | loss: 0.0062261
	speed: 0.0619s/iter; left time: 2037.8446s
Epoch: 30 cost time: 28.91064763069153
Epoch: 30, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0018197
	speed: 0.3171s/iter; left time: 10379.6145s
	iters: 200, epoch: 31 | loss: 0.0030299
	speed: 0.0669s/iter; left time: 2183.4367s
	iters: 300, epoch: 31 | loss: 0.1051026
	speed: 0.0611s/iter; left time: 1988.1383s
	iters: 400, epoch: 31 | loss: 0.2149888
	speed: 0.0598s/iter; left time: 1937.8554s
Epoch: 31 cost time: 29.40591788291931
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0544193
	speed: 0.3265s/iter; left time: 10533.1323s
	iters: 200, epoch: 32 | loss: 0.0049163
	speed: 0.0646s/iter; left time: 2076.2604s
	iters: 300, epoch: 32 | loss: 0.0053019
	speed: 0.0644s/iter; left time: 2064.2664s
	iters: 400, epoch: 32 | loss: 0.0175589
	speed: 0.0611s/iter; left time: 1953.3551s
Epoch: 32 cost time: 29.47632384300232
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0180865
	speed: 0.3339s/iter; left time: 10616.5613s
	iters: 200, epoch: 33 | loss: 0.0094139
	speed: 0.0586s/iter; left time: 1858.4826s
	iters: 300, epoch: 33 | loss: 0.0958003
	speed: 0.0632s/iter; left time: 1995.9587s
	iters: 400, epoch: 33 | loss: 0.0925688
	speed: 0.0714s/iter; left time: 2249.2270s
Epoch: 33 cost time: 31.156043529510498
Epoch: 33, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0424270
	speed: 0.3287s/iter; left time: 10296.5902s
	iters: 200, epoch: 34 | loss: 0.0591625
	speed: 0.0656s/iter; left time: 2047.2780s
	iters: 300, epoch: 34 | loss: 0.0453141
	speed: 0.0604s/iter; left time: 1879.1741s
	iters: 400, epoch: 34 | loss: 0.0011578
	speed: 0.0641s/iter; left time: 1987.3108s
Epoch: 34 cost time: 30.835724592208862
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0191925
	speed: 0.3288s/iter; left time: 10144.6819s
	iters: 200, epoch: 35 | loss: 0.0046877
	speed: 0.0669s/iter; left time: 2058.7041s
	iters: 300, epoch: 35 | loss: 0.0021805
	speed: 0.0633s/iter; left time: 1941.5543s
	iters: 400, epoch: 35 | loss: 0.0018905
	speed: 0.0595s/iter; left time: 1817.2789s
Epoch: 35 cost time: 29.723711252212524
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0034949
	speed: 0.3181s/iter; left time: 9665.8383s
	iters: 200, epoch: 36 | loss: 0.0061359
	speed: 0.0590s/iter; left time: 1786.2068s
	iters: 300, epoch: 36 | loss: 0.0023324
	speed: 0.0640s/iter; left time: 1931.9563s
	iters: 400, epoch: 36 | loss: 0.0083394
	speed: 0.0671s/iter; left time: 2018.0112s
Epoch: 36 cost time: 29.384127616882324
Epoch: 36, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 73338
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4955860
	speed: 0.0833s/iter; left time: 3896.7817s
	iters: 200, epoch: 1 | loss: 0.7681711
	speed: 0.0666s/iter; left time: 3111.8060s
	iters: 300, epoch: 1 | loss: 0.7611604
	speed: 0.0602s/iter; left time: 2805.5057s
	iters: 400, epoch: 1 | loss: 0.2398567
	speed: 0.0558s/iter; left time: 2596.0430s
Epoch: 1 cost time: 30.742146492004395
Epoch: 1, Steps: 469 | Train Loss: 1.049 Vali Loss: 0.504 Vali Acc: 0.854 Test Loss: 0.504 Test Acc: 0.854
Validation loss decreased (inf --> -0.854197).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2483080
	speed: 0.3337s/iter; left time: 15460.7370s
	iters: 200, epoch: 2 | loss: 0.7489091
	speed: 0.0647s/iter; left time: 2989.5218s
	iters: 300, epoch: 2 | loss: 0.2247318
	speed: 0.0655s/iter; left time: 3023.8974s
	iters: 400, epoch: 2 | loss: 0.3726391
	speed: 0.0605s/iter; left time: 2784.3755s
Epoch: 2 cost time: 30.084254503250122
Epoch: 2, Steps: 469 | Train Loss: 0.310 Vali Loss: 0.324 Vali Acc: 0.903 Test Loss: 0.324 Test Acc: 0.903
Validation loss decreased (-0.854197 --> -0.903084).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2012033
	speed: 0.3433s/iter; left time: 15742.9518s
	iters: 200, epoch: 3 | loss: 0.1418560
	speed: 0.0601s/iter; left time: 2750.9769s
	iters: 300, epoch: 3 | loss: 0.2585383
	speed: 0.0599s/iter; left time: 2737.3162s
	iters: 400, epoch: 3 | loss: 0.0700415
	speed: 0.0648s/iter; left time: 2951.6291s
Epoch: 3 cost time: 29.759544372558594
Epoch: 3, Steps: 469 | Train Loss: 0.202 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.903084 --> -0.935103).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1077622
	speed: 0.3339s/iter; left time: 15156.8938s
	iters: 200, epoch: 4 | loss: 0.0797208
	speed: 0.0617s/iter; left time: 2794.0724s
	iters: 300, epoch: 4 | loss: 0.0399660
	speed: 0.0570s/iter; left time: 2576.2965s
	iters: 400, epoch: 4 | loss: 0.1340622
	speed: 0.0573s/iter; left time: 2582.3434s
Epoch: 4 cost time: 28.42715358734131
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.203 Vali Acc: 0.943 Test Loss: 0.203 Test Acc: 0.943
Validation loss decreased (-0.935103 --> -0.943394).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1920224
	speed: 0.3271s/iter; left time: 14695.9872s
	iters: 200, epoch: 5 | loss: 0.0497306
	speed: 0.0661s/iter; left time: 2964.9020s
	iters: 300, epoch: 5 | loss: 0.0196315
	speed: 0.0606s/iter; left time: 2708.3954s
	iters: 400, epoch: 5 | loss: 0.0500766
	speed: 0.0552s/iter; left time: 2461.5866s
Epoch: 5 cost time: 28.43985414505005
Epoch: 5, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
Validation loss decreased (-0.943394 --> -0.948826).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2271790
	speed: 0.3245s/iter; left time: 14424.5178s
	iters: 200, epoch: 6 | loss: 0.0416048
	speed: 0.0584s/iter; left time: 2588.9249s
	iters: 300, epoch: 6 | loss: 0.0933004
	speed: 0.0596s/iter; left time: 2639.6781s
	iters: 400, epoch: 6 | loss: 0.0267599
	speed: 0.0651s/iter; left time: 2875.9956s
Epoch: 6 cost time: 28.705484628677368
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0765701
	speed: 0.3230s/iter; left time: 14208.5430s
	iters: 200, epoch: 7 | loss: 0.0786031
	speed: 0.0600s/iter; left time: 2634.2522s
	iters: 300, epoch: 7 | loss: 0.0329736
	speed: 0.0555s/iter; left time: 2430.0741s
	iters: 400, epoch: 7 | loss: 0.0839721
	speed: 0.0574s/iter; left time: 2508.5740s
Epoch: 7 cost time: 28.235475778579712
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.948826 --> -0.962548).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0164346
	speed: 0.2985s/iter; left time: 12990.9915s
	iters: 200, epoch: 8 | loss: 0.0405409
	speed: 0.0647s/iter; left time: 2811.1695s
	iters: 300, epoch: 8 | loss: 0.1419632
	speed: 0.0601s/iter; left time: 2603.7462s
	iters: 400, epoch: 8 | loss: 0.0409036
	speed: 0.0587s/iter; left time: 2536.3771s
Epoch: 8 cost time: 29.30669403076172
Epoch: 8, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0986949
	speed: 0.3360s/iter; left time: 14463.4304s
	iters: 200, epoch: 9 | loss: 0.0244027
	speed: 0.0664s/iter; left time: 2853.3954s
	iters: 300, epoch: 9 | loss: 0.0134170
	speed: 0.0601s/iter; left time: 2573.6801s
	iters: 400, epoch: 9 | loss: 0.0242370
	speed: 0.0518s/iter; left time: 2216.1889s
Epoch: 9 cost time: 28.519529581069946
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.962548 --> -0.967409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0667186
	speed: 0.3161s/iter; left time: 13459.9130s
	iters: 200, epoch: 10 | loss: 0.0030703
	speed: 0.0597s/iter; left time: 2536.4907s
	iters: 300, epoch: 10 | loss: 0.0422814
	speed: 0.0639s/iter; left time: 2708.6464s
	iters: 400, epoch: 10 | loss: 0.0095746
	speed: 0.0580s/iter; left time: 2454.0686s
Epoch: 10 cost time: 27.691349506378174
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0235022
	speed: 0.3167s/iter; left time: 13337.6574s
	iters: 200, epoch: 11 | loss: 0.0588333
	speed: 0.0579s/iter; left time: 2432.6771s
	iters: 300, epoch: 11 | loss: 0.0056973
	speed: 0.0554s/iter; left time: 2320.1254s
	iters: 400, epoch: 11 | loss: 0.0320618
	speed: 0.0623s/iter; left time: 2606.4111s
Epoch: 11 cost time: 28.19227647781372
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0990288
	speed: 0.3194s/iter; left time: 13298.9065s
	iters: 200, epoch: 12 | loss: 0.0647443
	speed: 0.0585s/iter; left time: 2431.3404s
	iters: 300, epoch: 12 | loss: 0.0204739
	speed: 0.0555s/iter; left time: 2301.8793s
	iters: 400, epoch: 12 | loss: 0.0131844
	speed: 0.0566s/iter; left time: 2340.6660s
Epoch: 12 cost time: 27.989901542663574
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968552).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0261947
	speed: 0.3270s/iter; left time: 13462.7689s
	iters: 200, epoch: 13 | loss: 0.1229537
	speed: 0.0668s/iter; left time: 2744.7312s
	iters: 300, epoch: 13 | loss: 0.1011868
	speed: 0.0585s/iter; left time: 2395.1818s
	iters: 400, epoch: 13 | loss: 0.0423927
	speed: 0.0558s/iter; left time: 2278.9147s
Epoch: 13 cost time: 28.50643491744995
Epoch: 13, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0476649
	speed: 0.3350s/iter; left time: 13634.0074s
	iters: 200, epoch: 14 | loss: 0.0051826
	speed: 0.0571s/iter; left time: 2318.8981s
	iters: 300, epoch: 14 | loss: 0.0055464
	speed: 0.0640s/iter; left time: 2590.8929s
	iters: 400, epoch: 14 | loss: 0.0485861
	speed: 0.0627s/iter; left time: 2532.6966s
Epoch: 14 cost time: 29.057288646697998
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0104737
	speed: 0.3313s/iter; left time: 13328.2069s
	iters: 200, epoch: 15 | loss: 0.0078960
	speed: 0.0547s/iter; left time: 2196.7345s
	iters: 300, epoch: 15 | loss: 0.0391974
	speed: 0.0548s/iter; left time: 2194.7062s
	iters: 400, epoch: 15 | loss: 0.0055835
	speed: 0.0622s/iter; left time: 2484.1309s
Epoch: 15 cost time: 28.14145851135254
Epoch: 15, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.970267 --> -0.974556).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0127062
	speed: 0.3245s/iter; left time: 12903.6014s
	iters: 200, epoch: 16 | loss: 0.0158917
	speed: 0.0548s/iter; left time: 2175.3382s
	iters: 300, epoch: 16 | loss: 0.0648715
	speed: 0.0505s/iter; left time: 1998.4613s
	iters: 400, epoch: 16 | loss: 0.1369890
	speed: 0.0538s/iter; left time: 2124.0410s
Epoch: 16 cost time: 26.850303173065186
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.974842).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1853736
	speed: 0.2883s/iter; left time: 11328.0620s
	iters: 200, epoch: 17 | loss: 0.1380698
	speed: 0.0612s/iter; left time: 2399.0115s
	iters: 300, epoch: 17 | loss: 0.0031976
	speed: 0.0644s/iter; left time: 2517.1788s
	iters: 400, epoch: 17 | loss: 0.0582276
	speed: 0.0585s/iter; left time: 2282.7710s
Epoch: 17 cost time: 28.348111629486084
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0141833
	speed: 0.2979s/iter; left time: 11568.0252s
	iters: 200, epoch: 18 | loss: 0.0361623
	speed: 0.0581s/iter; left time: 2251.3056s
	iters: 300, epoch: 18 | loss: 0.0108743
	speed: 0.0595s/iter; left time: 2296.4502s
	iters: 400, epoch: 18 | loss: 0.0215142
	speed: 0.0653s/iter; left time: 2514.3617s
Epoch: 18 cost time: 29.30487632751465
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.974842 --> -0.977986).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0520710
	speed: 0.3230s/iter; left time: 12388.6615s
	iters: 200, epoch: 19 | loss: 0.0114740
	speed: 0.0614s/iter; left time: 2350.2952s
	iters: 300, epoch: 19 | loss: 0.0109274
	speed: 0.0593s/iter; left time: 2263.3557s
	iters: 400, epoch: 19 | loss: 0.0129890
	speed: 0.0629s/iter; left time: 2393.2431s
Epoch: 19 cost time: 29.758105516433716
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0274136
	speed: 0.3083s/iter; left time: 11680.0903s
	iters: 200, epoch: 20 | loss: 0.0728029
	speed: 0.0571s/iter; left time: 2156.1972s
	iters: 300, epoch: 20 | loss: 0.1314355
	speed: 0.0522s/iter; left time: 1965.9981s
	iters: 400, epoch: 20 | loss: 0.0053938
	speed: 0.0484s/iter; left time: 1818.9301s
Epoch: 20 cost time: 26.354857683181763
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0027039
	speed: 0.2938s/iter; left time: 10992.6836s
	iters: 200, epoch: 21 | loss: 0.0252543
	speed: 0.0607s/iter; left time: 2265.4577s
	iters: 300, epoch: 21 | loss: 0.0116867
	speed: 0.0603s/iter; left time: 2244.4364s
	iters: 400, epoch: 21 | loss: 0.0059207
	speed: 0.0578s/iter; left time: 2146.4276s
Epoch: 21 cost time: 27.837074995040894
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.2229345
	speed: 0.3055s/iter; left time: 11287.2579s
	iters: 200, epoch: 22 | loss: 0.0508456
	speed: 0.0589s/iter; left time: 2171.3091s
	iters: 300, epoch: 22 | loss: 0.0051752
	speed: 0.0639s/iter; left time: 2348.9824s
	iters: 400, epoch: 22 | loss: 0.0581742
	speed: 0.0592s/iter; left time: 2169.9140s
Epoch: 22 cost time: 28.35717535018921
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978844).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0252352
	speed: 0.3064s/iter; left time: 11177.9840s
	iters: 200, epoch: 23 | loss: 0.1552414
	speed: 0.0542s/iter; left time: 1971.6823s
	iters: 300, epoch: 23 | loss: 0.1583387
	speed: 0.0639s/iter; left time: 2316.7091s
	iters: 400, epoch: 23 | loss: 0.0008817
	speed: 0.0620s/iter; left time: 2243.4432s
Epoch: 23 cost time: 27.882275104522705
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0259859
	speed: 0.3025s/iter; left time: 10895.9169s
	iters: 200, epoch: 24 | loss: 0.0014536
	speed: 0.0589s/iter; left time: 2115.2748s
	iters: 300, epoch: 24 | loss: 0.0213391
	speed: 0.0581s/iter; left time: 2082.1830s
	iters: 400, epoch: 24 | loss: 0.0038554
	speed: 0.0622s/iter; left time: 2222.2649s
Epoch: 24 cost time: 28.89491057395935
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0007326
	speed: 0.3164s/iter; left time: 11245.8487s
	iters: 200, epoch: 25 | loss: 0.0867779
	speed: 0.0640s/iter; left time: 2267.9901s
	iters: 300, epoch: 25 | loss: 0.1415785
	speed: 0.0589s/iter; left time: 2082.7517s
	iters: 400, epoch: 25 | loss: 0.2558690
	speed: 0.0641s/iter; left time: 2258.7893s
Epoch: 25 cost time: 29.930664539337158
Epoch: 25, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0011693
	speed: 0.3161s/iter; left time: 11087.6927s
	iters: 200, epoch: 26 | loss: 0.0338624
	speed: 0.0632s/iter; left time: 2208.9833s
	iters: 300, epoch: 26 | loss: 0.0651303
	speed: 0.0562s/iter; left time: 1960.2468s
	iters: 400, epoch: 26 | loss: 0.0047545
	speed: 0.0566s/iter; left time: 1969.1708s
Epoch: 26 cost time: 27.87164545059204
Epoch: 26, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0075945
	speed: 0.2931s/iter; left time: 10142.5907s
	iters: 200, epoch: 27 | loss: 0.0081638
	speed: 0.0556s/iter; left time: 1918.1805s
	iters: 300, epoch: 27 | loss: 0.2076055
	speed: 0.0622s/iter; left time: 2138.6756s
	iters: 400, epoch: 27 | loss: 0.0815107
	speed: 0.0606s/iter; left time: 2077.5553s
Epoch: 27 cost time: 27.488577842712402
Epoch: 27, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0172661
	speed: 0.2913s/iter; left time: 9945.8312s
	iters: 200, epoch: 28 | loss: 0.0018685
	speed: 0.0578s/iter; left time: 1966.3814s
	iters: 300, epoch: 28 | loss: 0.0017923
	speed: 0.0577s/iter; left time: 1956.6944s
	iters: 400, epoch: 28 | loss: 0.0275689
	speed: 0.0576s/iter; left time: 1947.6869s
Epoch: 28 cost time: 27.846001863479614
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0109728
	speed: 0.3107s/iter; left time: 10461.7857s
	iters: 200, epoch: 29 | loss: 0.0049074
	speed: 0.0597s/iter; left time: 2003.1684s
	iters: 300, epoch: 29 | loss: 0.0025916
	speed: 0.0579s/iter; left time: 1937.0047s
	iters: 400, epoch: 29 | loss: 0.0426232
	speed: 0.0619s/iter; left time: 2067.0705s
Epoch: 29 cost time: 29.102232933044434
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0084099
	speed: 0.3178s/iter; left time: 10552.4419s
	iters: 200, epoch: 30 | loss: 0.0007789
	speed: 0.0646s/iter; left time: 2136.9426s
	iters: 300, epoch: 30 | loss: 0.0128109
	speed: 0.0609s/iter; left time: 2008.9781s
	iters: 400, epoch: 30 | loss: 0.0085604
	speed: 0.0601s/iter; left time: 1977.7218s
Epoch: 30 cost time: 29.73825693130493
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0049973
	speed: 0.3122s/iter; left time: 10219.5410s
	iters: 200, epoch: 31 | loss: 0.0025295
	speed: 0.0628s/iter; left time: 2047.8862s
	iters: 300, epoch: 31 | loss: 0.0957238
	speed: 0.0604s/iter; left time: 1965.8995s
	iters: 400, epoch: 31 | loss: 0.1976058
	speed: 0.0609s/iter; left time: 1973.5025s
Epoch: 31 cost time: 28.95772385597229
Epoch: 31, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0142878
	speed: 0.2996s/iter; left time: 9664.6826s
	iters: 200, epoch: 32 | loss: 0.0010324
	speed: 0.0400s/iter; left time: 1285.0495s
	iters: 300, epoch: 32 | loss: 0.0015193
	speed: 0.0406s/iter; left time: 1302.1680s
	iters: 400, epoch: 32 | loss: 0.1110243
	speed: 0.0390s/iter; left time: 1244.9806s
Epoch: 32 cost time: 19.800923824310303
Epoch: 32, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 73338
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5983385
	speed: 0.0871s/iter; left time: 4076.0991s
	iters: 200, epoch: 1 | loss: 0.7510508
	speed: 0.0627s/iter; left time: 2928.5572s
	iters: 300, epoch: 1 | loss: 0.8190441
	speed: 0.0589s/iter; left time: 2743.5433s
	iters: 400, epoch: 1 | loss: 0.2635621
	speed: 0.0583s/iter; left time: 2709.8238s
Epoch: 1 cost time: 30.994301319122314
Epoch: 1, Steps: 469 | Train Loss: 1.053 Vali Loss: 0.456 Vali Acc: 0.880 Test Loss: 0.456 Test Acc: 0.880
Validation loss decreased (inf --> -0.879927).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3271459
	speed: 0.3284s/iter; left time: 15217.2113s
	iters: 200, epoch: 2 | loss: 0.6849815
	speed: 0.0674s/iter; left time: 3113.8219s
	iters: 300, epoch: 2 | loss: 0.3118686
	speed: 0.0662s/iter; left time: 3052.3654s
	iters: 400, epoch: 2 | loss: 0.1854267
	speed: 0.0575s/iter; left time: 2645.6369s
Epoch: 2 cost time: 29.28181266784668
Epoch: 2, Steps: 469 | Train Loss: 0.300 Vali Loss: 0.306 Vali Acc: 0.908 Test Loss: 0.306 Test Acc: 0.908
Validation loss decreased (-0.879927 --> -0.908230).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1809354
	speed: 0.3342s/iter; left time: 15326.9647s
	iters: 200, epoch: 3 | loss: 0.1196760
	speed: 0.0605s/iter; left time: 2769.4160s
	iters: 300, epoch: 3 | loss: 0.1604901
	speed: 0.0640s/iter; left time: 2923.9191s
	iters: 400, epoch: 3 | loss: 0.1053440
	speed: 0.0624s/iter; left time: 2843.9264s
Epoch: 3 cost time: 29.9798800945282
Epoch: 3, Steps: 469 | Train Loss: 0.187 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.908230 --> -0.948540).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0798816
	speed: 0.3177s/iter; left time: 14423.7567s
	iters: 200, epoch: 4 | loss: 0.0580961
	speed: 0.0641s/iter; left time: 2904.7124s
	iters: 300, epoch: 4 | loss: 0.0204921
	speed: 0.0607s/iter; left time: 2745.4398s
	iters: 400, epoch: 4 | loss: 0.0836905
	speed: 0.0604s/iter; left time: 2725.1872s
Epoch: 4 cost time: 29.678730010986328
Epoch: 4, Steps: 469 | Train Loss: 0.148 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.948540 --> -0.956259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1357248
	speed: 0.3220s/iter; left time: 14466.8500s
	iters: 200, epoch: 5 | loss: 0.0541608
	speed: 0.0645s/iter; left time: 2889.6972s
	iters: 300, epoch: 5 | loss: 0.0848357
	speed: 0.0650s/iter; left time: 2905.4809s
	iters: 400, epoch: 5 | loss: 0.0406786
	speed: 0.0578s/iter; left time: 2577.6463s
Epoch: 5 cost time: 28.63349151611328
Epoch: 5, Steps: 469 | Train Loss: 0.119 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
Validation loss decreased (-0.956259 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2634597
	speed: 0.3188s/iter; left time: 14173.5186s
	iters: 200, epoch: 6 | loss: 0.0065257
	speed: 0.0588s/iter; left time: 2605.9390s
	iters: 300, epoch: 6 | loss: 0.0247270
	speed: 0.0601s/iter; left time: 2657.6401s
	iters: 400, epoch: 6 | loss: 0.0322590
	speed: 0.0689s/iter; left time: 3040.6854s
Epoch: 6 cost time: 29.507927179336548
Epoch: 6, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0514766
	speed: 0.3130s/iter; left time: 13766.0007s
	iters: 200, epoch: 7 | loss: 0.0778255
	speed: 0.0635s/iter; left time: 2788.3111s
	iters: 300, epoch: 7 | loss: 0.0221293
	speed: 0.0600s/iter; left time: 2627.7406s
	iters: 400, epoch: 7 | loss: 0.0107668
	speed: 0.0580s/iter; left time: 2532.4188s
Epoch: 7 cost time: 28.883619785308838
Epoch: 7, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0395955
	speed: 0.3210s/iter; left time: 13970.3634s
	iters: 200, epoch: 8 | loss: 0.0360229
	speed: 0.0661s/iter; left time: 2871.6497s
	iters: 300, epoch: 8 | loss: 0.2238670
	speed: 0.0667s/iter; left time: 2891.2369s
	iters: 400, epoch: 8 | loss: 0.0154371
	speed: 0.0615s/iter; left time: 2656.2978s
Epoch: 8 cost time: 30.373900413513184
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0482450
	speed: 0.3279s/iter; left time: 14115.5142s
	iters: 200, epoch: 9 | loss: 0.0043563
	speed: 0.0626s/iter; left time: 2689.8178s
	iters: 300, epoch: 9 | loss: 0.0262769
	speed: 0.0642s/iter; left time: 2749.8618s
	iters: 400, epoch: 9 | loss: 0.0392012
	speed: 0.0704s/iter; left time: 3008.1756s
Epoch: 9 cost time: 30.98550796508789
Epoch: 9, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0157770
	speed: 0.3280s/iter; left time: 13965.6340s
	iters: 200, epoch: 10 | loss: 0.0048646
	speed: 0.0635s/iter; left time: 2698.4631s
	iters: 300, epoch: 10 | loss: 0.0368372
	speed: 0.0601s/iter; left time: 2545.9259s
	iters: 400, epoch: 10 | loss: 0.0054211
	speed: 0.0611s/iter; left time: 2583.9164s
Epoch: 10 cost time: 30.068182945251465
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973126 --> -0.973412).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0183045
	speed: 0.3174s/iter; left time: 13365.5597s
	iters: 200, epoch: 11 | loss: 0.0496923
	speed: 0.0654s/iter; left time: 2748.7291s
	iters: 300, epoch: 11 | loss: 0.0198029
	speed: 0.0640s/iter; left time: 2684.0897s
	iters: 400, epoch: 11 | loss: 0.1748765
	speed: 0.0623s/iter; left time: 2603.0130s
Epoch: 11 cost time: 29.385740041732788
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1063256
	speed: 0.3146s/iter; left time: 13101.1152s
	iters: 200, epoch: 12 | loss: 0.0258265
	speed: 0.0584s/iter; left time: 2425.9018s
	iters: 300, epoch: 12 | loss: 0.0533473
	speed: 0.0600s/iter; left time: 2486.4999s
	iters: 400, epoch: 12 | loss: 0.0073189
	speed: 0.0660s/iter; left time: 2728.0716s
Epoch: 12 cost time: 29.435744285583496
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0080368
	speed: 0.3034s/iter; left time: 12492.6639s
	iters: 200, epoch: 13 | loss: 0.1163185
	speed: 0.0661s/iter; left time: 2716.3240s
	iters: 300, epoch: 13 | loss: 0.0460618
	speed: 0.0593s/iter; left time: 2428.6572s
	iters: 400, epoch: 13 | loss: 0.0442438
	speed: 0.0558s/iter; left time: 2279.7871s
Epoch: 13 cost time: 29.258086442947388
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.973412 --> -0.975699).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0096548
	speed: 0.3215s/iter; left time: 13086.1484s
	iters: 200, epoch: 14 | loss: 0.0223180
	speed: 0.0630s/iter; left time: 2556.7544s
	iters: 300, epoch: 14 | loss: 0.0040041
	speed: 0.0652s/iter; left time: 2642.7572s
	iters: 400, epoch: 14 | loss: 0.0084676
	speed: 0.0669s/iter; left time: 2702.6945s
Epoch: 14 cost time: 30.187947273254395
Epoch: 14, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0138472
	speed: 0.3249s/iter; left time: 13070.3882s
	iters: 200, epoch: 15 | loss: 0.0163493
	speed: 0.0631s/iter; left time: 2533.5132s
	iters: 300, epoch: 15 | loss: 0.0186538
	speed: 0.0626s/iter; left time: 2505.1307s
	iters: 400, epoch: 15 | loss: 0.0471828
	speed: 0.0626s/iter; left time: 2498.8623s
Epoch: 15 cost time: 30.11937427520752
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.976271).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0059152
	speed: 0.3049s/iter; left time: 12125.0891s
	iters: 200, epoch: 16 | loss: 0.0123058
	speed: 0.0652s/iter; left time: 2584.6997s
	iters: 300, epoch: 16 | loss: 0.0530206
	speed: 0.0632s/iter; left time: 2501.3216s
	iters: 400, epoch: 16 | loss: 0.0194184
	speed: 0.0575s/iter; left time: 2270.8250s
Epoch: 16 cost time: 28.954662322998047
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.979416).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.4516364
	speed: 0.3161s/iter; left time: 12422.9058s
	iters: 200, epoch: 17 | loss: 0.0907746
	speed: 0.0527s/iter; left time: 2064.1218s
	iters: 300, epoch: 17 | loss: 0.0017146
	speed: 0.0587s/iter; left time: 2294.7566s
	iters: 400, epoch: 17 | loss: 0.0122759
	speed: 0.0645s/iter; left time: 2515.8854s
Epoch: 17 cost time: 28.563251972198486
Epoch: 17, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.1514184
	speed: 0.3152s/iter; left time: 12239.6812s
	iters: 200, epoch: 18 | loss: 0.0155247
	speed: 0.0549s/iter; left time: 2127.2897s
	iters: 300, epoch: 18 | loss: 0.0081448
	speed: 0.0548s/iter; left time: 2117.8561s
	iters: 400, epoch: 18 | loss: 0.0345100
	speed: 0.0597s/iter; left time: 2299.8098s
Epoch: 18 cost time: 27.629098653793335
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0074673
	speed: 0.3189s/iter; left time: 12232.1125s
	iters: 200, epoch: 19 | loss: 0.0387976
	speed: 0.0608s/iter; left time: 2326.2296s
	iters: 300, epoch: 19 | loss: 0.0205035
	speed: 0.0655s/iter; left time: 2499.6201s
	iters: 400, epoch: 19 | loss: 0.0132338
	speed: 0.0618s/iter; left time: 2351.7899s
Epoch: 19 cost time: 29.230095386505127
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0269068
	speed: 0.3421s/iter; left time: 12960.6593s
	iters: 200, epoch: 20 | loss: 0.1587690
	speed: 0.0551s/iter; left time: 2081.5585s
	iters: 300, epoch: 20 | loss: 0.0224774
	speed: 0.0602s/iter; left time: 2268.5828s
	iters: 400, epoch: 20 | loss: 0.0011523
	speed: 0.0611s/iter; left time: 2297.8976s
Epoch: 20 cost time: 27.736405849456787
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0018884
	speed: 0.2936s/iter; left time: 10987.1622s
	iters: 200, epoch: 21 | loss: 0.1541131
	speed: 0.0599s/iter; left time: 2234.8277s
	iters: 300, epoch: 21 | loss: 0.0701831
	speed: 0.0590s/iter; left time: 2194.3216s
	iters: 400, epoch: 21 | loss: 0.0981479
	speed: 0.0594s/iter; left time: 2205.7836s
Epoch: 21 cost time: 29.01646852493286
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0180752
	speed: 0.3149s/iter; left time: 11636.4469s
	iters: 200, epoch: 22 | loss: 0.0366191
	speed: 0.0604s/iter; left time: 2226.9136s
	iters: 300, epoch: 22 | loss: 0.0176359
	speed: 0.0582s/iter; left time: 2138.6650s
	iters: 400, epoch: 22 | loss: 0.0191384
	speed: 0.0550s/iter; left time: 2015.1053s
Epoch: 22 cost time: 27.650303602218628
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0021363
	speed: 0.3122s/iter; left time: 11391.0901s
	iters: 200, epoch: 23 | loss: 0.0145785
	speed: 0.0523s/iter; left time: 1901.7942s
	iters: 300, epoch: 23 | loss: 0.0142443
	speed: 0.0657s/iter; left time: 2382.3748s
	iters: 400, epoch: 23 | loss: 0.0006767
	speed: 0.0614s/iter; left time: 2222.5269s
Epoch: 23 cost time: 27.750200748443604
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0449361
	speed: 0.3046s/iter; left time: 10971.2442s
	iters: 200, epoch: 24 | loss: 0.0017861
	speed: 0.0543s/iter; left time: 1949.2987s
	iters: 300, epoch: 24 | loss: 0.0118479
	speed: 0.0596s/iter; left time: 2134.4689s
	iters: 400, epoch: 24 | loss: 0.0013009
	speed: 0.0604s/iter; left time: 2157.4783s
Epoch: 24 cost time: 27.82903552055359
Epoch: 24, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.1287635
	speed: 0.3210s/iter; left time: 11409.1539s
	iters: 200, epoch: 25 | loss: 0.0576524
	speed: 0.0614s/iter; left time: 2177.3169s
	iters: 300, epoch: 25 | loss: 0.0536217
	speed: 0.0612s/iter; left time: 2161.8530s
	iters: 400, epoch: 25 | loss: 0.0823610
	speed: 0.0612s/iter; left time: 2155.5056s
Epoch: 25 cost time: 29.57929491996765
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0450016
	speed: 0.3161s/iter; left time: 11088.9520s
	iters: 200, epoch: 26 | loss: 0.0052084
	speed: 0.0680s/iter; left time: 2379.0845s
	iters: 300, epoch: 26 | loss: 0.2760708
	speed: 0.0612s/iter; left time: 2135.2776s
	iters: 400, epoch: 26 | loss: 0.0064279
	speed: 0.0624s/iter; left time: 2168.3361s
Epoch: 26 cost time: 29.742713928222656
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 73338
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5630091
	speed: 0.0784s/iter; left time: 3668.5469s
	iters: 200, epoch: 1 | loss: 0.8959526
	speed: 0.0545s/iter; left time: 2544.5514s
	iters: 300, epoch: 1 | loss: 0.6780905
	speed: 0.0601s/iter; left time: 2801.7268s
	iters: 400, epoch: 1 | loss: 1.0155224
	speed: 0.0597s/iter; left time: 2775.3993s
Epoch: 1 cost time: 29.47692108154297
Epoch: 1, Steps: 469 | Train Loss: 1.119 Vali Loss: 0.506 Vali Acc: 0.844 Test Loss: 0.506 Test Acc: 0.844
Validation loss decreased (inf --> -0.843620).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3099192
	speed: 0.3195s/iter; left time: 14802.1222s
	iters: 200, epoch: 2 | loss: 0.2151017
	speed: 0.0570s/iter; left time: 2633.1244s
	iters: 300, epoch: 2 | loss: 0.2399710
	speed: 0.0551s/iter; left time: 2543.0355s
	iters: 400, epoch: 2 | loss: 0.4074098
	speed: 0.0604s/iter; left time: 2781.1167s
Epoch: 2 cost time: 27.45834994316101
Epoch: 2, Steps: 469 | Train Loss: 0.318 Vali Loss: 0.340 Vali Acc: 0.876 Test Loss: 0.340 Test Acc: 0.876
Validation loss decreased (-0.843620 --> -0.876212).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2045708
	speed: 0.2910s/iter; left time: 13346.8060s
	iters: 200, epoch: 3 | loss: 0.3135283
	speed: 0.0629s/iter; left time: 2879.5493s
	iters: 300, epoch: 3 | loss: 0.1240509
	speed: 0.0563s/iter; left time: 2569.1838s
	iters: 400, epoch: 3 | loss: 0.1436951
	speed: 0.0506s/iter; left time: 2304.1687s
Epoch: 3 cost time: 27.35356593132019
Epoch: 3, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.876212 --> -0.924812).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0957274
	speed: 0.3092s/iter; left time: 14037.0991s
	iters: 200, epoch: 4 | loss: 0.0338671
	speed: 0.0594s/iter; left time: 2690.9933s
	iters: 300, epoch: 4 | loss: 0.3083065
	speed: 0.0653s/iter; left time: 2950.0257s
	iters: 400, epoch: 4 | loss: 0.0654483
	speed: 0.0601s/iter; left time: 2710.5404s
Epoch: 4 cost time: 28.55158042907715
Epoch: 4, Steps: 469 | Train Loss: 0.158 Vali Loss: 0.208 Vali Acc: 0.940 Test Loss: 0.208 Test Acc: 0.940
Validation loss decreased (-0.924812 --> -0.939678).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0342131
	speed: 0.3196s/iter; left time: 14358.2703s
	iters: 200, epoch: 5 | loss: 0.0171908
	speed: 0.0591s/iter; left time: 2651.0894s
	iters: 300, epoch: 5 | loss: 0.1529786
	speed: 0.0599s/iter; left time: 2680.4813s
	iters: 400, epoch: 5 | loss: 0.1587107
	speed: 0.0640s/iter; left time: 2855.5887s
Epoch: 5 cost time: 28.816647052764893
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
Validation loss decreased (-0.939678 --> -0.956545).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0577549
	speed: 0.3188s/iter; left time: 14172.2731s
	iters: 200, epoch: 6 | loss: 0.0538731
	speed: 0.0526s/iter; left time: 2332.9675s
	iters: 300, epoch: 6 | loss: 0.1270891
	speed: 0.0570s/iter; left time: 2522.5338s
	iters: 400, epoch: 6 | loss: 0.0611186
	speed: 0.0532s/iter; left time: 2350.0305s
Epoch: 6 cost time: 26.72229266166687
Epoch: 6, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.956545 --> -0.956545).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0163649
	speed: 0.3096s/iter; left time: 13618.2802s
	iters: 200, epoch: 7 | loss: 0.1432072
	speed: 0.0661s/iter; left time: 2899.7003s
	iters: 300, epoch: 7 | loss: 0.1202145
	speed: 0.0617s/iter; left time: 2700.0324s
	iters: 400, epoch: 7 | loss: 0.0810782
	speed: 0.0531s/iter; left time: 2318.0420s
Epoch: 7 cost time: 27.806658267974854
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.956545 --> -0.962263).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2268610
	speed: 0.3061s/iter; left time: 13322.5136s
	iters: 200, epoch: 8 | loss: 0.0111974
	speed: 0.0590s/iter; left time: 2562.6435s
	iters: 300, epoch: 8 | loss: 0.0223120
	speed: 0.0617s/iter; left time: 2674.5940s
	iters: 400, epoch: 8 | loss: 0.1047717
	speed: 0.0619s/iter; left time: 2675.4643s
Epoch: 8 cost time: 28.391583919525146
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2025442
	speed: 0.3172s/iter; left time: 13653.7376s
	iters: 200, epoch: 9 | loss: 0.0855044
	speed: 0.0566s/iter; left time: 2432.3772s
	iters: 300, epoch: 9 | loss: 0.0255745
	speed: 0.0566s/iter; left time: 2424.3738s
	iters: 400, epoch: 9 | loss: 0.0679343
	speed: 0.0593s/iter; left time: 2533.3154s
Epoch: 9 cost time: 28.14631962776184
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1470245
	speed: 0.3255s/iter; left time: 13861.5663s
	iters: 200, epoch: 10 | loss: 0.0257984
	speed: 0.0688s/iter; left time: 2923.3512s
	iters: 300, epoch: 10 | loss: 0.0365941
	speed: 0.0539s/iter; left time: 2283.0339s
	iters: 400, epoch: 10 | loss: 0.1553879
	speed: 0.0572s/iter; left time: 2416.8698s
Epoch: 10 cost time: 29.325024604797363
Epoch: 10, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.962263 --> -0.968266).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0933805
	speed: 0.3312s/iter; left time: 13946.3922s
	iters: 200, epoch: 11 | loss: 0.0100734
	speed: 0.0621s/iter; left time: 2608.4454s
	iters: 300, epoch: 11 | loss: 0.0025370
	speed: 0.0660s/iter; left time: 2766.8064s
	iters: 400, epoch: 11 | loss: 0.2463963
	speed: 0.0607s/iter; left time: 2539.9089s
Epoch: 11 cost time: 29.387439489364624
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0859007
	speed: 0.3159s/iter; left time: 13156.3792s
	iters: 200, epoch: 12 | loss: 0.0222467
	speed: 0.0552s/iter; left time: 2291.5694s
	iters: 300, epoch: 12 | loss: 0.0264904
	speed: 0.0603s/iter; left time: 2499.0430s
	iters: 400, epoch: 12 | loss: 0.0232179
	speed: 0.0672s/iter; left time: 2778.5131s
Epoch: 12 cost time: 28.26204562187195
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0258540
	speed: 0.3112s/iter; left time: 12814.6534s
	iters: 200, epoch: 13 | loss: 0.0209219
	speed: 0.0545s/iter; left time: 2237.5628s
	iters: 300, epoch: 13 | loss: 0.1620307
	speed: 0.0560s/iter; left time: 2295.5980s
	iters: 400, epoch: 13 | loss: 0.0041137
	speed: 0.0579s/iter; left time: 2368.3499s
Epoch: 13 cost time: 27.47344708442688
Epoch: 13, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.969696).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1124181
	speed: 0.3039s/iter; left time: 12369.8631s
	iters: 200, epoch: 14 | loss: 0.0282876
	speed: 0.0608s/iter; left time: 2469.4133s
	iters: 300, epoch: 14 | loss: 0.0341779
	speed: 0.0589s/iter; left time: 2387.6230s
	iters: 400, epoch: 14 | loss: 0.0209677
	speed: 0.0586s/iter; left time: 2368.6821s
Epoch: 14 cost time: 27.456855535507202
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.969982).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0542724
	speed: 0.2706s/iter; left time: 10886.9921s
	iters: 200, epoch: 15 | loss: 0.3616754
	speed: 0.0570s/iter; left time: 2287.9299s
	iters: 300, epoch: 15 | loss: 0.1825312
	speed: 0.0653s/iter; left time: 2613.1599s
	iters: 400, epoch: 15 | loss: 0.0229164
	speed: 0.0623s/iter; left time: 2488.6995s
Epoch: 15 cost time: 27.539864540100098
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.1713256
	speed: 0.3164s/iter; left time: 12581.3264s
	iters: 200, epoch: 16 | loss: 0.0498308
	speed: 0.0600s/iter; left time: 2379.8391s
	iters: 300, epoch: 16 | loss: 0.0040358
	speed: 0.0648s/iter; left time: 2565.7768s
	iters: 400, epoch: 16 | loss: 0.0052673
	speed: 0.0623s/iter; left time: 2459.7253s
Epoch: 16 cost time: 29.02841019630432
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969982 --> -0.973412).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1139301
	speed: 0.3172s/iter; left time: 12466.2841s
	iters: 200, epoch: 17 | loss: 0.0124057
	speed: 0.0605s/iter; left time: 2371.8688s
	iters: 300, epoch: 17 | loss: 0.7990632
	speed: 0.0577s/iter; left time: 2254.7030s
	iters: 400, epoch: 17 | loss: 0.0794448
	speed: 0.0620s/iter; left time: 2419.3028s
Epoch: 17 cost time: 28.358662366867065
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0159959
	speed: 0.3033s/iter; left time: 11776.5878s
	iters: 200, epoch: 18 | loss: 0.0122691
	speed: 0.0573s/iter; left time: 2218.2623s
	iters: 300, epoch: 18 | loss: 0.0062055
	speed: 0.0552s/iter; left time: 2132.5751s
	iters: 400, epoch: 18 | loss: 0.0098756
	speed: 0.0595s/iter; left time: 2291.9509s
Epoch: 18 cost time: 27.778324604034424
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0229392
	speed: 0.3033s/iter; left time: 11634.8626s
	iters: 200, epoch: 19 | loss: 0.0369260
	speed: 0.0637s/iter; left time: 2436.5627s
	iters: 300, epoch: 19 | loss: 0.0058351
	speed: 0.0586s/iter; left time: 2236.6244s
	iters: 400, epoch: 19 | loss: 0.0367559
	speed: 0.0570s/iter; left time: 2171.0581s
Epoch: 19 cost time: 27.667675256729126
Epoch: 19, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.973412 --> -0.975985).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0058464
	speed: 0.2993s/iter; left time: 11339.9092s
	iters: 200, epoch: 20 | loss: 0.0124969
	speed: 0.0537s/iter; left time: 2028.1742s
	iters: 300, epoch: 20 | loss: 0.0078544
	speed: 0.0635s/iter; left time: 2392.3031s
	iters: 400, epoch: 20 | loss: 0.0137995
	speed: 0.0633s/iter; left time: 2378.2032s
Epoch: 20 cost time: 27.769185781478882
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0550823
	speed: 0.3031s/iter; left time: 11343.4451s
	iters: 200, epoch: 21 | loss: 0.0055323
	speed: 0.0567s/iter; left time: 2115.5594s
	iters: 300, epoch: 21 | loss: 0.0145501
	speed: 0.0534s/iter; left time: 1989.3634s
	iters: 400, epoch: 21 | loss: 0.0089930
	speed: 0.0573s/iter; left time: 2126.6506s
Epoch: 21 cost time: 27.666147232055664
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0166781
	speed: 0.3209s/iter; left time: 11857.9472s
	iters: 200, epoch: 22 | loss: 0.0164056
	speed: 0.0604s/iter; left time: 2224.0720s
	iters: 300, epoch: 22 | loss: 0.2690482
	speed: 0.0559s/iter; left time: 2052.6648s
	iters: 400, epoch: 22 | loss: 0.0160885
	speed: 0.0571s/iter; left time: 2094.3125s
Epoch: 22 cost time: 28.350740432739258
Epoch: 22, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976557).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0263135
	speed: 0.3049s/iter; left time: 11122.7307s
	iters: 200, epoch: 23 | loss: 0.0269748
	speed: 0.0581s/iter; left time: 2112.7032s
	iters: 300, epoch: 23 | loss: 0.1811687
	speed: 0.0613s/iter; left time: 2224.8287s
	iters: 400, epoch: 23 | loss: 0.0031433
	speed: 0.0560s/iter; left time: 2026.7406s
Epoch: 23 cost time: 27.27717876434326
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1089817
	speed: 0.3082s/iter; left time: 11100.1818s
	iters: 200, epoch: 24 | loss: 0.0020341
	speed: 0.0537s/iter; left time: 1928.8206s
	iters: 300, epoch: 24 | loss: 0.0152099
	speed: 0.0488s/iter; left time: 1747.9683s
	iters: 400, epoch: 24 | loss: 0.0034107
	speed: 0.0605s/iter; left time: 2160.9682s
Epoch: 24 cost time: 27.06650447845459
Epoch: 24, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2968807
	speed: 0.3044s/iter; left time: 10821.0451s
	iters: 200, epoch: 25 | loss: 0.0312253
	speed: 0.0444s/iter; left time: 1573.2683s
	iters: 300, epoch: 25 | loss: 0.0099582
	speed: 0.0430s/iter; left time: 1519.4516s
	iters: 400, epoch: 25 | loss: 0.0019956
	speed: 0.0433s/iter; left time: 1526.5778s
Epoch: 25 cost time: 22.27584981918335
Epoch: 25, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0142539
	speed: 0.3029s/iter; left time: 10623.4767s
	iters: 200, epoch: 26 | loss: 0.0042610
	speed: 0.0642s/iter; left time: 2245.5255s
	iters: 300, epoch: 26 | loss: 0.0469374
	speed: 0.0637s/iter; left time: 2223.3179s
	iters: 400, epoch: 26 | loss: 0.0185212
	speed: 0.0591s/iter; left time: 2055.7428s
Epoch: 26 cost time: 28.905340433120728
Epoch: 26, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0207787
	speed: 0.3206s/iter; left time: 11093.9422s
	iters: 200, epoch: 27 | loss: 0.0305251
	speed: 0.0603s/iter; left time: 2079.6370s
	iters: 300, epoch: 27 | loss: 0.0021754
	speed: 0.0670s/iter; left time: 2304.2316s
	iters: 400, epoch: 27 | loss: 0.0085035
	speed: 0.0592s/iter; left time: 2031.9915s
Epoch: 27 cost time: 28.88733673095703
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979130).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0051811
	speed: 0.3179s/iter; left time: 10850.9518s
	iters: 200, epoch: 28 | loss: 0.0406014
	speed: 0.0586s/iter; left time: 1995.1449s
	iters: 300, epoch: 28 | loss: 0.0109953
	speed: 0.0547s/iter; left time: 1856.8588s
	iters: 400, epoch: 28 | loss: 0.0018960
	speed: 0.0631s/iter; left time: 2133.6431s
Epoch: 28 cost time: 28.312095642089844
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0127539
	speed: 0.3103s/iter; left time: 10446.3454s
	iters: 200, epoch: 29 | loss: 0.0018383
	speed: 0.0598s/iter; left time: 2007.5854s
	iters: 300, epoch: 29 | loss: 0.0022726
	speed: 0.0591s/iter; left time: 1979.1660s
	iters: 400, epoch: 29 | loss: 0.0618724
	speed: 0.0573s/iter; left time: 1912.9994s
Epoch: 29 cost time: 28.631210327148438
Epoch: 29, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.1427410
	speed: 0.3145s/iter; left time: 10441.1025s
	iters: 200, epoch: 30 | loss: 0.1474627
	speed: 0.0634s/iter; left time: 2099.0642s
	iters: 300, epoch: 30 | loss: 0.0064425
	speed: 0.0565s/iter; left time: 1864.6439s
	iters: 400, epoch: 30 | loss: 0.0209897
	speed: 0.0569s/iter; left time: 1870.8828s
Epoch: 30 cost time: 27.996137142181396
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0528247
	speed: 0.2999s/iter; left time: 9814.8722s
	iters: 200, epoch: 31 | loss: 0.0670646
	speed: 0.0577s/iter; left time: 1882.8096s
	iters: 300, epoch: 31 | loss: 0.0070194
	speed: 0.0604s/iter; left time: 1965.6212s
	iters: 400, epoch: 31 | loss: 0.0067139
	speed: 0.0608s/iter; left time: 1972.5468s
Epoch: 31 cost time: 27.950294733047485
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0244543
	speed: 0.3080s/iter; left time: 9936.1144s
	iters: 200, epoch: 32 | loss: 0.0081803
	speed: 0.0598s/iter; left time: 1923.8764s
	iters: 300, epoch: 32 | loss: 0.0092314
	speed: 0.0633s/iter; left time: 2028.1090s
	iters: 400, epoch: 32 | loss: 0.0026107
	speed: 0.0623s/iter; left time: 1991.7534s
Epoch: 32 cost time: 29.728061199188232
Epoch: 32, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0006980
	speed: 0.3220s/iter; left time: 10237.0856s
	iters: 200, epoch: 33 | loss: 0.0134412
	speed: 0.0598s/iter; left time: 1896.1166s
	iters: 300, epoch: 33 | loss: 0.0015619
	speed: 0.0594s/iter; left time: 1878.1786s
	iters: 400, epoch: 33 | loss: 0.0557617
	speed: 0.0593s/iter; left time: 1867.4533s
Epoch: 33 cost time: 29.06332540512085
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0832196
	speed: 0.2688s/iter; left time: 8420.3095s
	iters: 200, epoch: 34 | loss: 0.0012502
	speed: 0.0617s/iter; left time: 1927.6673s
	iters: 300, epoch: 34 | loss: 0.0079198
	speed: 0.0556s/iter; left time: 1731.8247s
	iters: 400, epoch: 34 | loss: 0.0547287
	speed: 0.0540s/iter; left time: 1674.9942s
Epoch: 34 cost time: 27.43461537361145
Epoch: 34, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0042497
	speed: 0.3031s/iter; left time: 9351.1357s
	iters: 200, epoch: 35 | loss: 0.0038824
	speed: 0.0553s/iter; left time: 1699.3394s
	iters: 300, epoch: 35 | loss: 0.1979058
	speed: 0.0611s/iter; left time: 1872.5732s
	iters: 400, epoch: 35 | loss: 0.0123653
	speed: 0.0555s/iter; left time: 1696.8772s
Epoch: 35 cost time: 26.825076818466187
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0020142
	speed: 0.3017s/iter; left time: 9168.9185s
	iters: 200, epoch: 36 | loss: 0.0063112
	speed: 0.0583s/iter; left time: 1764.9551s
	iters: 300, epoch: 36 | loss: 0.0018447
	speed: 0.0590s/iter; left time: 1781.2048s
	iters: 400, epoch: 36 | loss: 0.0025821
	speed: 0.0603s/iter; left time: 1814.5042s
Epoch: 36 cost time: 27.811875343322754
Epoch: 36, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0115111
	speed: 0.3061s/iter; left time: 9157.8315s
	iters: 200, epoch: 37 | loss: 0.1349254
	speed: 0.0584s/iter; left time: 1741.1549s
	iters: 300, epoch: 37 | loss: 0.1055192
	speed: 0.0544s/iter; left time: 1617.1786s
	iters: 400, epoch: 37 | loss: 0.3227091
	speed: 0.0598s/iter; left time: 1772.4678s
Epoch: 37 cost time: 27.63850474357605
Epoch: 37, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979988).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0041692
	speed: 0.3118s/iter; left time: 9182.2505s
	iters: 200, epoch: 38 | loss: 0.0094095
	speed: 0.0581s/iter; left time: 1704.1292s
	iters: 300, epoch: 38 | loss: 0.0010207
	speed: 0.0545s/iter; left time: 1592.7683s
	iters: 400, epoch: 38 | loss: 0.0095966
	speed: 0.0569s/iter; left time: 1657.4224s
Epoch: 38 cost time: 27.29406452178955
Epoch: 38, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.979988).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0012316
	speed: 0.3158s/iter; left time: 9150.5691s
	iters: 200, epoch: 39 | loss: 0.0200608
	speed: 0.0639s/iter; left time: 1846.0810s
	iters: 300, epoch: 39 | loss: 0.0200275
	speed: 0.0521s/iter; left time: 1500.5904s
	iters: 400, epoch: 39 | loss: 0.0004636
	speed: 0.0557s/iter; left time: 1597.5592s
Epoch: 39 cost time: 27.749919891357422
Epoch: 39, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980845).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0079375
	speed: 0.3089s/iter; left time: 8806.8263s
	iters: 200, epoch: 40 | loss: 0.0575989
	speed: 0.0610s/iter; left time: 1732.2947s
	iters: 300, epoch: 40 | loss: 0.0460820
	speed: 0.0538s/iter; left time: 1524.3593s
	iters: 400, epoch: 40 | loss: 0.0005974
	speed: 0.0537s/iter; left time: 1514.0050s
Epoch: 40 cost time: 27.03610324859619
Epoch: 40, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 41 | loss: 0.0005928
	speed: 0.3037s/iter; left time: 8514.8927s
	iters: 200, epoch: 41 | loss: 0.0062394
	speed: 0.0511s/iter; left time: 1428.7833s
	iters: 300, epoch: 41 | loss: 0.0049020
	speed: 0.0590s/iter; left time: 1641.6547s
	iters: 400, epoch: 41 | loss: 0.0031402
	speed: 0.0584s/iter; left time: 1620.5354s
Epoch: 41 cost time: 26.18545651435852
Epoch: 41, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 42 | loss: 0.1036986
	speed: 0.3021s/iter; left time: 8330.4794s
	iters: 200, epoch: 42 | loss: 0.0289280
	speed: 0.0542s/iter; left time: 1488.3958s
	iters: 300, epoch: 42 | loss: 0.0252921
	speed: 0.0537s/iter; left time: 1468.8058s
	iters: 400, epoch: 42 | loss: 0.0489150
	speed: 0.0615s/iter; left time: 1678.3984s
Epoch: 42 cost time: 27.197267532348633
Epoch: 42, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 43 | loss: 0.0123534
	speed: 0.3142s/iter; left time: 8515.6277s
	iters: 200, epoch: 43 | loss: 0.0335520
	speed: 0.0587s/iter; left time: 1586.3059s
	iters: 300, epoch: 43 | loss: 0.0589199
	speed: 0.0590s/iter; left time: 1586.5760s
	iters: 400, epoch: 43 | loss: 0.0445176
	speed: 0.0632s/iter; left time: 1693.8657s
Epoch: 43 cost time: 29.096022605895996
Epoch: 43, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 44 | loss: 0.0011195
	speed: 0.3095s/iter; left time: 8243.7002s
	iters: 200, epoch: 44 | loss: 0.0014383
	speed: 0.0577s/iter; left time: 1530.2415s
	iters: 300, epoch: 44 | loss: 0.1209184
	speed: 0.0608s/iter; left time: 1608.0745s
	iters: 400, epoch: 44 | loss: 0.0676857
	speed: 0.0564s/iter; left time: 1485.9930s
Epoch: 44 cost time: 28.240503549575806
Epoch: 44, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 45 | loss: 0.0583671
	speed: 0.3022s/iter; left time: 7906.5450s
	iters: 200, epoch: 45 | loss: 0.0013247
	speed: 0.0543s/iter; left time: 1415.2152s
	iters: 300, epoch: 45 | loss: 0.0051874
	speed: 0.0619s/iter; left time: 1607.4529s
	iters: 400, epoch: 45 | loss: 0.0009338
	speed: 0.0564s/iter; left time: 1459.9225s
Epoch: 45 cost time: 26.893745183944702
Epoch: 45, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 46 | loss: 0.0004616
	speed: 0.3006s/iter; left time: 7724.7809s
	iters: 200, epoch: 46 | loss: 0.0172754
	speed: 0.0593s/iter; left time: 1517.9164s
	iters: 300, epoch: 46 | loss: 0.0056817
	speed: 0.0628s/iter; left time: 1602.4183s
	iters: 400, epoch: 46 | loss: 0.0043167
	speed: 0.0576s/iter; left time: 1462.7149s
Epoch: 46 cost time: 27.73638081550598
Epoch: 46, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 47 | loss: 0.0018522
	speed: 0.2980s/iter; left time: 7518.3348s
	iters: 200, epoch: 47 | loss: 0.0092064
	speed: 0.0557s/iter; left time: 1400.3415s
	iters: 300, epoch: 47 | loss: 0.0199256
	speed: 0.0591s/iter; left time: 1478.5979s
	iters: 400, epoch: 47 | loss: 0.0012370
	speed: 0.0620s/iter; left time: 1546.5158s
Epoch: 47 cost time: 27.881110191345215
Epoch: 47, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 48 | loss: 0.0052894
	speed: 0.2894s/iter; left time: 7165.6548s
	iters: 200, epoch: 48 | loss: 0.0027258
	speed: 0.0612s/iter; left time: 1508.5135s
	iters: 300, epoch: 48 | loss: 0.0007672
	speed: 0.0560s/iter; left time: 1376.2704s
	iters: 400, epoch: 48 | loss: 0.0245235
	speed: 0.0602s/iter; left time: 1473.4104s
Epoch: 48 cost time: 28.758320569992065
Epoch: 48, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.981703).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.0297234
	speed: 0.3162s/iter; left time: 7680.8971s
	iters: 200, epoch: 49 | loss: 0.0025378
	speed: 0.0652s/iter; left time: 1577.9446s
	iters: 300, epoch: 49 | loss: 0.0002097
	speed: 0.0602s/iter; left time: 1449.4579s
	iters: 400, epoch: 49 | loss: 0.0076855
	speed: 0.0580s/iter; left time: 1392.4717s
Epoch: 49 cost time: 29.070021390914917
Epoch: 49, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 50 | loss: 0.0030389
	speed: 0.3121s/iter; left time: 7435.3129s
	iters: 200, epoch: 50 | loss: 0.0800835
	speed: 0.0660s/iter; left time: 1565.4051s
	iters: 300, epoch: 50 | loss: 0.0197193
	speed: 0.0537s/iter; left time: 1269.0263s
	iters: 400, epoch: 50 | loss: 0.0004877
	speed: 0.0540s/iter; left time: 1270.5606s
Epoch: 50 cost time: 27.901602506637573
Epoch: 50, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 51 | loss: 0.0006433
	speed: 0.2667s/iter; left time: 6228.0554s
	iters: 200, epoch: 51 | loss: 0.0009881
	speed: 0.0587s/iter; left time: 1364.6879s
	iters: 300, epoch: 51 | loss: 0.3374802
	speed: 0.0650s/iter; left time: 1504.1718s
	iters: 400, epoch: 51 | loss: 0.0005896
	speed: 0.0630s/iter; left time: 1451.7019s
Epoch: 51 cost time: 28.082483530044556
Epoch: 51, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 52 | loss: 0.0007542
	speed: 0.3064s/iter; left time: 7012.0115s
	iters: 200, epoch: 52 | loss: 0.0021388
	speed: 0.0588s/iter; left time: 1339.5194s
	iters: 300, epoch: 52 | loss: 0.0027784
	speed: 0.0597s/iter; left time: 1354.0259s
	iters: 400, epoch: 52 | loss: 0.0383400
	speed: 0.0598s/iter; left time: 1350.3359s
Epoch: 52 cost time: 28.815261125564575
Epoch: 52, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 53 | loss: 0.0107949
	speed: 0.3181s/iter; left time: 7130.6396s
	iters: 200, epoch: 53 | loss: 0.0001849
	speed: 0.0648s/iter; left time: 1446.4235s
	iters: 300, epoch: 53 | loss: 0.0046187
	speed: 0.0605s/iter; left time: 1344.6320s
	iters: 400, epoch: 53 | loss: 0.0002858
	speed: 0.0574s/iter; left time: 1270.3674s
Epoch: 53 cost time: 28.847180604934692
Epoch: 53, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 54 | loss: 0.0035344
	speed: 0.3330s/iter; left time: 7308.3062s
	iters: 200, epoch: 54 | loss: 0.1412351
	speed: 0.0569s/iter; left time: 1242.2628s
	iters: 300, epoch: 54 | loss: 0.0664925
	speed: 0.0686s/iter; left time: 1492.2209s
	iters: 400, epoch: 54 | loss: 0.0025559
	speed: 0.0634s/iter; left time: 1372.5306s
Epoch: 54 cost time: 29.50482487678528
Epoch: 54, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 55 | loss: 0.0086043
	speed: 0.3168s/iter; left time: 6802.8329s
	iters: 200, epoch: 55 | loss: 0.0013795
	speed: 0.0634s/iter; left time: 1355.4188s
	iters: 300, epoch: 55 | loss: 0.0005522
	speed: 0.0603s/iter; left time: 1283.8117s
	iters: 400, epoch: 55 | loss: 0.0004945
	speed: 0.0587s/iter; left time: 1242.3680s
Epoch: 55 cost time: 29.509716987609863
Epoch: 55, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 56 | loss: 0.0468805
	speed: 0.3249s/iter; left time: 6823.8281s
	iters: 200, epoch: 56 | loss: 0.0026288
	speed: 0.0651s/iter; left time: 1361.5962s
	iters: 300, epoch: 56 | loss: 0.0001956
	speed: 0.0574s/iter; left time: 1194.4641s
	iters: 400, epoch: 56 | loss: 0.0127786
	speed: 0.0544s/iter; left time: 1127.3594s
Epoch: 56 cost time: 28.31544828414917
Epoch: 56, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 57 | loss: 0.0448438
	speed: 0.3120s/iter; left time: 6407.6324s
	iters: 200, epoch: 57 | loss: 0.1123116
	speed: 0.0556s/iter; left time: 1136.8004s
	iters: 300, epoch: 57 | loss: 0.0004189
	speed: 0.0629s/iter; left time: 1278.2085s
	iters: 400, epoch: 57 | loss: 0.0906025
	speed: 0.0640s/iter; left time: 1295.7747s
Epoch: 57 cost time: 27.942207098007202
Epoch: 57, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 58 | loss: 0.0001678
	speed: 0.3107s/iter; left time: 6235.6338s
	iters: 200, epoch: 58 | loss: 0.0075891
	speed: 0.0603s/iter; left time: 1203.7642s
	iters: 300, epoch: 58 | loss: 0.0016919
	speed: 0.0536s/iter; left time: 1063.9723s
	iters: 400, epoch: 58 | loss: 0.0160435
	speed: 0.0547s/iter; left time: 1080.6622s
Epoch: 58 cost time: 27.876094341278076
Epoch: 58, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 40570
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5245528
	speed: 0.0792s/iter; left time: 3706.7421s
	iters: 200, epoch: 1 | loss: 0.8942330
	speed: 0.0608s/iter; left time: 2838.3051s
	iters: 300, epoch: 1 | loss: 0.6752622
	speed: 0.0625s/iter; left time: 2913.9699s
	iters: 400, epoch: 1 | loss: 0.9809333
	speed: 0.0637s/iter; left time: 2961.7860s
Epoch: 1 cost time: 31.145504474639893
Epoch: 1, Steps: 469 | Train Loss: 1.110 Vali Loss: 0.477 Vali Acc: 0.843 Test Loss: 0.477 Test Acc: 0.843
Validation loss decreased (inf --> -0.842763).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2800008
	speed: 0.3370s/iter; left time: 15615.0578s
	iters: 200, epoch: 2 | loss: 0.2230291
	speed: 0.0560s/iter; left time: 2587.1193s
	iters: 300, epoch: 2 | loss: 0.2362279
	speed: 0.0563s/iter; left time: 2598.1860s
	iters: 400, epoch: 2 | loss: 0.5144006
	speed: 0.0569s/iter; left time: 2619.2045s
Epoch: 2 cost time: 28.655014753341675
Epoch: 2, Steps: 469 | Train Loss: 0.308 Vali Loss: 0.312 Vali Acc: 0.902 Test Loss: 0.312 Test Acc: 0.902
Validation loss decreased (-0.842763 --> -0.902227).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2050035
	speed: 0.3279s/iter; left time: 15036.2874s
	iters: 200, epoch: 3 | loss: 0.2421954
	speed: 0.0588s/iter; left time: 2689.5199s
	iters: 300, epoch: 3 | loss: 0.0950155
	speed: 0.0611s/iter; left time: 2789.1936s
	iters: 400, epoch: 3 | loss: 0.0676583
	speed: 0.0586s/iter; left time: 2670.8395s
Epoch: 3 cost time: 27.635989665985107
Epoch: 3, Steps: 469 | Train Loss: 0.204 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.902227 --> -0.936533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0610160
	speed: 0.3182s/iter; left time: 14442.4807s
	iters: 200, epoch: 4 | loss: 0.0588004
	speed: 0.0539s/iter; left time: 2443.0017s
	iters: 300, epoch: 4 | loss: 0.2381260
	speed: 0.0569s/iter; left time: 2573.3194s
	iters: 400, epoch: 4 | loss: 0.0790374
	speed: 0.0631s/iter; left time: 2846.7784s
Epoch: 4 cost time: 27.61343502998352
Epoch: 4, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.203 Vali Acc: 0.945 Test Loss: 0.203 Test Acc: 0.945
Validation loss decreased (-0.936533 --> -0.944538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0401899
	speed: 0.3132s/iter; left time: 14072.6021s
	iters: 200, epoch: 5 | loss: 0.0287520
	speed: 0.0550s/iter; left time: 2463.4949s
	iters: 300, epoch: 5 | loss: 0.1627630
	speed: 0.0519s/iter; left time: 2322.0868s
	iters: 400, epoch: 5 | loss: 0.2259083
	speed: 0.0601s/iter; left time: 2681.2003s
Epoch: 5 cost time: 27.052294492721558
Epoch: 5, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.944538 --> -0.956545).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0276731
	speed: 0.3145s/iter; left time: 13979.6804s
	iters: 200, epoch: 6 | loss: 0.0342789
	speed: 0.0528s/iter; left time: 2340.1302s
	iters: 300, epoch: 6 | loss: 0.1832834
	speed: 0.0573s/iter; left time: 2536.7389s
	iters: 400, epoch: 6 | loss: 0.0877005
	speed: 0.0628s/iter; left time: 2773.8649s
Epoch: 6 cost time: 27.090243816375732
Epoch: 6, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.956545 --> -0.957688).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0133040
	speed: 0.3282s/iter; left time: 14437.8198s
	iters: 200, epoch: 7 | loss: 0.2356358
	speed: 0.0564s/iter; left time: 2474.0947s
	iters: 300, epoch: 7 | loss: 0.0574815
	speed: 0.0600s/iter; left time: 2628.7208s
	iters: 400, epoch: 7 | loss: 0.0869518
	speed: 0.0630s/iter; left time: 2751.9971s
Epoch: 7 cost time: 29.30752182006836
Epoch: 7, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.957688 --> -0.961119).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3423579
	speed: 0.3244s/iter; left time: 14117.6912s
	iters: 200, epoch: 8 | loss: 0.0211530
	speed: 0.0658s/iter; left time: 2857.5445s
	iters: 300, epoch: 8 | loss: 0.0172738
	speed: 0.0621s/iter; left time: 2692.0755s
	iters: 400, epoch: 8 | loss: 0.0517821
	speed: 0.0592s/iter; left time: 2560.6637s
Epoch: 8 cost time: 29.387336015701294
Epoch: 8, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1521861
	speed: 0.3084s/iter; left time: 13276.0836s
	iters: 200, epoch: 9 | loss: 0.0510318
	speed: 0.0499s/iter; left time: 2143.7271s
	iters: 300, epoch: 9 | loss: 0.0258080
	speed: 0.0603s/iter; left time: 2585.3032s
	iters: 400, epoch: 9 | loss: 0.0377642
	speed: 0.0653s/iter; left time: 2793.5803s
Epoch: 9 cost time: 27.504416942596436
Epoch: 9, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1618410
	speed: 0.3035s/iter; left time: 12922.8401s
	iters: 200, epoch: 10 | loss: 0.0128657
	speed: 0.0602s/iter; left time: 2556.2713s
	iters: 300, epoch: 10 | loss: 0.0416646
	speed: 0.0599s/iter; left time: 2539.0814s
	iters: 400, epoch: 10 | loss: 0.2373172
	speed: 0.0596s/iter; left time: 2518.9306s
Epoch: 10 cost time: 28.71121835708618
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.961119 --> -0.969124).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1138388
	speed: 0.3130s/iter; left time: 13180.4333s
	iters: 200, epoch: 11 | loss: 0.0294052
	speed: 0.0606s/iter; left time: 2547.0531s
	iters: 300, epoch: 11 | loss: 0.0076455
	speed: 0.0629s/iter; left time: 2636.5929s
	iters: 400, epoch: 11 | loss: 0.1972407
	speed: 0.0590s/iter; left time: 2468.7198s
Epoch: 11 cost time: 28.11439871788025
Epoch: 11, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1080917
	speed: 0.3100s/iter; left time: 12906.9415s
	iters: 200, epoch: 12 | loss: 0.0113993
	speed: 0.0563s/iter; left time: 2339.2631s
	iters: 300, epoch: 12 | loss: 0.0088827
	speed: 0.0606s/iter; left time: 2509.4872s
	iters: 400, epoch: 12 | loss: 0.0205925
	speed: 0.0692s/iter; left time: 2859.8451s
Epoch: 12 cost time: 28.925858736038208
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0096961
	speed: 0.3116s/iter; left time: 12830.4093s
	iters: 200, epoch: 13 | loss: 0.0380270
	speed: 0.0560s/iter; left time: 2298.2368s
	iters: 300, epoch: 13 | loss: 0.3718374
	speed: 0.0482s/iter; left time: 1975.1572s
	iters: 400, epoch: 13 | loss: 0.0142596
	speed: 0.0488s/iter; left time: 1994.4275s
Epoch: 13 cost time: 25.436602115631104
Epoch: 13, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0757078
	speed: 0.3164s/iter; left time: 12880.6694s
	iters: 200, epoch: 14 | loss: 0.0385987
	speed: 0.0653s/iter; left time: 2651.4100s
	iters: 300, epoch: 14 | loss: 0.0366630
	speed: 0.0623s/iter; left time: 2524.9168s
	iters: 400, epoch: 14 | loss: 0.0200016
	speed: 0.0576s/iter; left time: 2328.9439s
Epoch: 14 cost time: 28.763529539108276
Epoch: 14, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0430910
	speed: 0.3141s/iter; left time: 12637.4895s
	iters: 200, epoch: 15 | loss: 0.2056408
	speed: 0.0573s/iter; left time: 2298.1119s
	iters: 300, epoch: 15 | loss: 0.1390475
	speed: 0.0658s/iter; left time: 2635.5154s
	iters: 400, epoch: 15 | loss: 0.0052740
	speed: 0.0588s/iter; left time: 2349.8435s
Epoch: 15 cost time: 28.489673137664795
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1527296
	speed: 0.3001s/iter; left time: 11933.2608s
	iters: 200, epoch: 16 | loss: 0.1496343
	speed: 0.0565s/iter; left time: 2241.8406s
	iters: 300, epoch: 16 | loss: 0.0023878
	speed: 0.0562s/iter; left time: 2225.1007s
	iters: 400, epoch: 16 | loss: 0.0143339
	speed: 0.0615s/iter; left time: 2425.3059s
Epoch: 16 cost time: 27.442992210388184
Epoch: 16, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.972555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0670806
	speed: 0.3074s/iter; left time: 12078.3488s
	iters: 200, epoch: 17 | loss: 0.0080258
	speed: 0.0619s/iter; left time: 2427.9880s
	iters: 300, epoch: 17 | loss: 0.9155511
	speed: 0.0591s/iter; left time: 2310.7244s
	iters: 400, epoch: 17 | loss: 0.0287943
	speed: 0.0599s/iter; left time: 2335.3592s
Epoch: 17 cost time: 28.87245798110962
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0154335
	speed: 0.3125s/iter; left time: 12134.8410s
	iters: 200, epoch: 18 | loss: 0.0239935
	speed: 0.0632s/iter; left time: 2447.3090s
	iters: 300, epoch: 18 | loss: 0.0030798
	speed: 0.0611s/iter; left time: 2360.5710s
	iters: 400, epoch: 18 | loss: 0.0096600
	speed: 0.0581s/iter; left time: 2237.5908s
Epoch: 18 cost time: 28.911661624908447
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0130633
	speed: 0.3066s/iter; left time: 11762.1410s
	iters: 200, epoch: 19 | loss: 0.0347933
	speed: 0.0491s/iter; left time: 1877.9324s
	iters: 300, epoch: 19 | loss: 0.0299924
	speed: 0.0570s/iter; left time: 2175.4574s
	iters: 400, epoch: 19 | loss: 0.0210612
	speed: 0.0616s/iter; left time: 2342.6009s
Epoch: 19 cost time: 26.351078033447266
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973698).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0840473
	speed: 0.3202s/iter; left time: 12133.6322s
	iters: 200, epoch: 20 | loss: 0.0144496
	speed: 0.0555s/iter; left time: 2098.5960s
	iters: 300, epoch: 20 | loss: 0.0223718
	speed: 0.0576s/iter; left time: 2172.3472s
	iters: 400, epoch: 20 | loss: 0.0239079
	speed: 0.0663s/iter; left time: 2490.7863s
Epoch: 20 cost time: 28.796874046325684
Epoch: 20, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1831224
	speed: 0.3250s/iter; left time: 12161.4650s
	iters: 200, epoch: 21 | loss: 0.0030413
	speed: 0.0578s/iter; left time: 2157.7419s
	iters: 300, epoch: 21 | loss: 0.0103990
	speed: 0.0582s/iter; left time: 2167.5242s
	iters: 400, epoch: 21 | loss: 0.0039279
	speed: 0.0632s/iter; left time: 2345.0498s
Epoch: 21 cost time: 28.984836101531982
Epoch: 21, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.973984).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0050863
	speed: 0.3008s/iter; left time: 11114.8056s
	iters: 200, epoch: 22 | loss: 0.0361071
	speed: 0.0614s/iter; left time: 2262.6586s
	iters: 300, epoch: 22 | loss: 0.3930235
	speed: 0.0577s/iter; left time: 2120.1526s
	iters: 400, epoch: 22 | loss: 0.0332054
	speed: 0.0523s/iter; left time: 1916.1389s
Epoch: 22 cost time: 27.2031672000885
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1001533
	speed: 0.3083s/iter; left time: 11248.7958s
	iters: 200, epoch: 23 | loss: 0.0445178
	speed: 0.0525s/iter; left time: 1908.3593s
	iters: 300, epoch: 23 | loss: 0.1637693
	speed: 0.0592s/iter; left time: 2146.2559s
	iters: 400, epoch: 23 | loss: 0.0030723
	speed: 0.0641s/iter; left time: 2318.3593s
Epoch: 23 cost time: 27.18660044670105
Epoch: 23, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.2276403
	speed: 0.3078s/iter; left time: 11086.0121s
	iters: 200, epoch: 24 | loss: 0.0050441
	speed: 0.0585s/iter; left time: 2102.6578s
	iters: 300, epoch: 24 | loss: 0.0154735
	speed: 0.0570s/iter; left time: 2042.1686s
	iters: 400, epoch: 24 | loss: 0.0021345
	speed: 0.0584s/iter; left time: 2083.9947s
Epoch: 24 cost time: 27.993102073669434
Epoch: 24, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975127).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.3968429
	speed: 0.3075s/iter; left time: 10928.6079s
	iters: 200, epoch: 25 | loss: 0.0032550
	speed: 0.0639s/iter; left time: 2265.0218s
	iters: 300, epoch: 25 | loss: 0.0037439
	speed: 0.0589s/iter; left time: 2081.6324s
	iters: 400, epoch: 25 | loss: 0.0009847
	speed: 0.0560s/iter; left time: 1974.2873s
Epoch: 25 cost time: 28.204634189605713
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.976271).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0518517
	speed: 0.3122s/iter; left time: 10949.0815s
	iters: 200, epoch: 26 | loss: 0.0099048
	speed: 0.0582s/iter; left time: 2034.1360s
	iters: 300, epoch: 26 | loss: 0.0042681
	speed: 0.0642s/iter; left time: 2240.3410s
	iters: 400, epoch: 26 | loss: 0.0321937
	speed: 0.0628s/iter; left time: 2184.5789s
Epoch: 26 cost time: 28.47992968559265
Epoch: 26, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0166099
	speed: 0.3151s/iter; left time: 10906.0815s
	iters: 200, epoch: 27 | loss: 0.0334235
	speed: 0.0590s/iter; left time: 2035.5029s
	iters: 300, epoch: 27 | loss: 0.0030696
	speed: 0.0566s/iter; left time: 1947.9403s
	iters: 400, epoch: 27 | loss: 0.0536054
	speed: 0.0602s/iter; left time: 2064.6105s
Epoch: 27 cost time: 28.250199794769287
Epoch: 27, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.977986).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0037918
	speed: 0.3041s/iter; left time: 10380.1412s
	iters: 200, epoch: 28 | loss: 0.0142444
	speed: 0.0590s/iter; left time: 2008.8400s
	iters: 300, epoch: 28 | loss: 0.0036732
	speed: 0.0561s/iter; left time: 1905.4599s
	iters: 400, epoch: 28 | loss: 0.0026688
	speed: 0.0536s/iter; left time: 1813.8025s
Epoch: 28 cost time: 27.208765029907227
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0067743
	speed: 0.2932s/iter; left time: 9871.5760s
	iters: 200, epoch: 29 | loss: 0.0097494
	speed: 0.0597s/iter; left time: 2004.5642s
	iters: 300, epoch: 29 | loss: 0.0388165
	speed: 0.0627s/iter; left time: 2098.8844s
	iters: 400, epoch: 29 | loss: 0.0994903
	speed: 0.0590s/iter; left time: 1970.3844s
Epoch: 29 cost time: 27.809138536453247
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.1088494
	speed: 0.2952s/iter; left time: 9801.5359s
	iters: 200, epoch: 30 | loss: 0.0619147
	speed: 0.0572s/iter; left time: 1894.9665s
	iters: 300, epoch: 30 | loss: 0.0094064
	speed: 0.0575s/iter; left time: 1898.3543s
	iters: 400, epoch: 30 | loss: 0.0402035
	speed: 0.0609s/iter; left time: 2004.1154s
Epoch: 30 cost time: 27.822540044784546
Epoch: 30, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0105311
	speed: 0.3098s/iter; left time: 10138.6324s
	iters: 200, epoch: 31 | loss: 0.0550490
	speed: 0.0600s/iter; left time: 1957.4120s
	iters: 300, epoch: 31 | loss: 0.0775390
	speed: 0.0594s/iter; left time: 1932.9118s
	iters: 400, epoch: 31 | loss: 0.0046692
	speed: 0.0606s/iter; left time: 1966.3879s
Epoch: 31 cost time: 29.285841941833496
Epoch: 31, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0297651
	speed: 0.3064s/iter; left time: 9883.5989s
	iters: 200, epoch: 32 | loss: 0.0266515
	speed: 0.0661s/iter; left time: 2125.0546s
	iters: 300, epoch: 32 | loss: 0.0199512
	speed: 0.0615s/iter; left time: 1970.9910s
	iters: 400, epoch: 32 | loss: 0.0006231
	speed: 0.0615s/iter; left time: 1965.4098s
Epoch: 32 cost time: 29.116780757904053
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0007441
	speed: 0.3040s/iter; left time: 9665.5230s
	iters: 200, epoch: 33 | loss: 0.0153702
	speed: 0.0536s/iter; left time: 1699.2299s
	iters: 300, epoch: 33 | loss: 0.0395169
	speed: 0.0588s/iter; left time: 1858.7917s
	iters: 400, epoch: 33 | loss: 0.0259360
	speed: 0.0619s/iter; left time: 1948.0826s
Epoch: 33 cost time: 27.337158679962158
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0261023
	speed: 0.3043s/iter; left time: 9532.6654s
	iters: 200, epoch: 34 | loss: 0.0026922
	speed: 0.0561s/iter; left time: 1751.6291s
	iters: 300, epoch: 34 | loss: 0.0072942
	speed: 0.0577s/iter; left time: 1795.1038s
	iters: 400, epoch: 34 | loss: 0.0367538
	speed: 0.0587s/iter; left time: 1822.5490s
Epoch: 34 cost time: 28.165273189544678
Epoch: 34, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0018747
	speed: 0.3066s/iter; left time: 9459.3614s
	iters: 200, epoch: 35 | loss: 0.0186429
	speed: 0.0599s/iter; left time: 1843.1054s
	iters: 300, epoch: 35 | loss: 0.1022266
	speed: 0.0563s/iter; left time: 1724.6559s
	iters: 400, epoch: 35 | loss: 0.0010518
	speed: 0.0556s/iter; left time: 1700.2123s
Epoch: 35 cost time: 27.421031713485718
Epoch: 35, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0049650
	speed: 0.2988s/iter; left time: 9080.4161s
	iters: 200, epoch: 36 | loss: 0.0023280
	speed: 0.0555s/iter; left time: 1680.8550s
	iters: 300, epoch: 36 | loss: 0.0130718
	speed: 0.0637s/iter; left time: 1921.4888s
	iters: 400, epoch: 36 | loss: 0.0014360
	speed: 0.0635s/iter; left time: 1910.7193s
Epoch: 36 cost time: 27.98231816291809
Epoch: 36, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0171283
	speed: 0.3158s/iter; left time: 9446.9743s
	iters: 200, epoch: 37 | loss: 0.0296307
	speed: 0.0600s/iter; left time: 1787.6666s
	iters: 300, epoch: 37 | loss: 0.1139176
	speed: 0.0591s/iter; left time: 1756.0822s
	iters: 400, epoch: 37 | loss: 0.3503945
	speed: 0.0623s/iter; left time: 1843.6920s
Epoch: 37 cost time: 29.164260864257812
Epoch: 37, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 40570
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5919890
	speed: 0.0768s/iter; left time: 3592.9836s
	iters: 200, epoch: 1 | loss: 0.9748318
	speed: 0.0622s/iter; left time: 2905.5001s
	iters: 300, epoch: 1 | loss: 0.7072636
	speed: 0.0558s/iter; left time: 2598.5723s
	iters: 400, epoch: 1 | loss: 0.9203155
	speed: 0.0537s/iter; left time: 2495.3144s
Epoch: 1 cost time: 28.493737936019897
Epoch: 1, Steps: 469 | Train Loss: 1.125 Vali Loss: 0.439 Vali Acc: 0.869 Test Loss: 0.439 Test Acc: 0.869
Validation loss decreased (inf --> -0.869064).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2809805
	speed: 0.2958s/iter; left time: 13704.1719s
	iters: 200, epoch: 2 | loss: 0.2403729
	speed: 0.0521s/iter; left time: 2408.6727s
	iters: 300, epoch: 2 | loss: 0.2437338
	speed: 0.0546s/iter; left time: 2517.2764s
	iters: 400, epoch: 2 | loss: 0.2763907
	speed: 0.0579s/iter; left time: 2666.0698s
Epoch: 2 cost time: 26.1131112575531
Epoch: 2, Steps: 469 | Train Loss: 0.288 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.869064 --> -0.930243).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3112785
	speed: 0.2957s/iter; left time: 13562.6642s
	iters: 200, epoch: 3 | loss: 0.2079381
	speed: 0.0575s/iter; left time: 2632.3141s
	iters: 300, epoch: 3 | loss: 0.0625519
	speed: 0.0551s/iter; left time: 2514.0994s
	iters: 400, epoch: 3 | loss: 0.0644850
	speed: 0.0547s/iter; left time: 2492.6231s
Epoch: 3 cost time: 27.046130180358887
Epoch: 3, Steps: 469 | Train Loss: 0.187 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.930243 --> -0.952542).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0693419
	speed: 0.3002s/iter; left time: 13629.0716s
	iters: 200, epoch: 4 | loss: 0.0512298
	speed: 0.0635s/iter; left time: 2874.5816s
	iters: 300, epoch: 4 | loss: 0.3498043
	speed: 0.0583s/iter; left time: 2636.3314s
	iters: 400, epoch: 4 | loss: 0.0302559
	speed: 0.0497s/iter; left time: 2241.1988s
Epoch: 4 cost time: 26.737547636032104
Epoch: 4, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
Validation loss decreased (-0.952542 --> -0.960833).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0333274
	speed: 0.3165s/iter; left time: 14219.4541s
	iters: 200, epoch: 5 | loss: 0.0217037
	speed: 0.0546s/iter; left time: 2446.8975s
	iters: 300, epoch: 5 | loss: 0.1620011
	speed: 0.0585s/iter; left time: 2614.4788s
	iters: 400, epoch: 5 | loss: 0.1375626
	speed: 0.0601s/iter; left time: 2682.9708s
Epoch: 5 cost time: 27.62973713874817
Epoch: 5, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
Validation loss decreased (-0.960833 --> -0.961119).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0388687
	speed: 0.3002s/iter; left time: 13344.8282s
	iters: 200, epoch: 6 | loss: 0.0708827
	speed: 0.0592s/iter; left time: 2624.2179s
	iters: 300, epoch: 6 | loss: 0.2257729
	speed: 0.0548s/iter; left time: 2424.9373s
	iters: 400, epoch: 6 | loss: 0.0541039
	speed: 0.0575s/iter; left time: 2540.8272s
Epoch: 6 cost time: 27.807276010513306
Epoch: 6, Steps: 469 | Train Loss: 0.109 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.961119 --> -0.968552).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0067396
	speed: 0.3045s/iter; left time: 13392.7600s
	iters: 200, epoch: 7 | loss: 0.2460743
	speed: 0.0619s/iter; left time: 2717.5493s
	iters: 300, epoch: 7 | loss: 0.1385413
	speed: 0.0556s/iter; left time: 2435.0826s
	iters: 400, epoch: 7 | loss: 0.0080189
	speed: 0.0527s/iter; left time: 2304.3108s
Epoch: 7 cost time: 26.614960432052612
Epoch: 7, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2631702
	speed: 0.2946s/iter; left time: 12819.7222s
	iters: 200, epoch: 8 | loss: 0.0111000
	speed: 0.0522s/iter; left time: 2264.6023s
	iters: 300, epoch: 8 | loss: 0.0217423
	speed: 0.0533s/iter; left time: 2309.3848s
	iters: 400, epoch: 8 | loss: 0.0274135
	speed: 0.0597s/iter; left time: 2578.8071s
Epoch: 8 cost time: 25.878403186798096
Epoch: 8, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3358732
	speed: 0.2875s/iter; left time: 12376.8238s
	iters: 200, epoch: 9 | loss: 0.0699274
	speed: 0.0622s/iter; left time: 2672.3919s
	iters: 300, epoch: 9 | loss: 0.0159415
	speed: 0.0504s/iter; left time: 2161.4498s
	iters: 400, epoch: 9 | loss: 0.0316653
	speed: 0.0507s/iter; left time: 2168.8870s
Epoch: 9 cost time: 26.57024359703064
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.2151134
	speed: 0.3032s/iter; left time: 12911.2587s
	iters: 200, epoch: 10 | loss: 0.0116862
	speed: 0.0575s/iter; left time: 2441.1537s
	iters: 300, epoch: 10 | loss: 0.0522728
	speed: 0.0627s/iter; left time: 2656.0555s
	iters: 400, epoch: 10 | loss: 0.0233389
	speed: 0.0554s/iter; left time: 2343.7554s
Epoch: 10 cost time: 27.47130012512207
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.970267 --> -0.977415).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0768074
	speed: 0.3153s/iter; left time: 13279.1268s
	iters: 200, epoch: 11 | loss: 0.0501971
	speed: 0.0576s/iter; left time: 2419.0966s
	iters: 300, epoch: 11 | loss: 0.0076305
	speed: 0.0575s/iter; left time: 2411.4167s
	iters: 400, epoch: 11 | loss: 0.2767806
	speed: 0.0618s/iter; left time: 2582.9412s
Epoch: 11 cost time: 27.947908878326416
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.1190687
	speed: 0.3107s/iter; left time: 12937.1223s
	iters: 200, epoch: 12 | loss: 0.0161915
	speed: 0.0583s/iter; left time: 2421.5107s
	iters: 300, epoch: 12 | loss: 0.0026721
	speed: 0.0544s/iter; left time: 2253.9344s
	iters: 400, epoch: 12 | loss: 0.0420351
	speed: 0.0528s/iter; left time: 2181.8322s
Epoch: 12 cost time: 27.105114221572876
Epoch: 12, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0798799
	speed: 0.3244s/iter; left time: 13357.8471s
	iters: 200, epoch: 13 | loss: 0.0160541
	speed: 0.0500s/iter; left time: 2052.6751s
	iters: 300, epoch: 13 | loss: 0.2161907
	speed: 0.0337s/iter; left time: 1379.1045s
	iters: 400, epoch: 13 | loss: 0.0084946
	speed: 0.0340s/iter; left time: 1387.6493s
Epoch: 13 cost time: 20.984071969985962
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0807550
	speed: 0.2296s/iter; left time: 9347.0325s
	iters: 200, epoch: 14 | loss: 0.1475123
	speed: 0.0550s/iter; left time: 2234.7179s
	iters: 300, epoch: 14 | loss: 0.1674052
	speed: 0.0528s/iter; left time: 2136.6052s
	iters: 400, epoch: 14 | loss: 0.0629828
	speed: 0.0575s/iter; left time: 2323.7550s
Epoch: 14 cost time: 26.838322162628174
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0463298
	speed: 0.3049s/iter; left time: 12268.1886s
	iters: 200, epoch: 15 | loss: 0.5745723
	speed: 0.0580s/iter; left time: 2326.5450s
	iters: 300, epoch: 15 | loss: 0.1643916
	speed: 0.0525s/iter; left time: 2102.9825s
	iters: 400, epoch: 15 | loss: 0.0205559
	speed: 0.0522s/iter; left time: 2084.7256s
Epoch: 15 cost time: 26.694315195083618
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0098917
	speed: 0.3024s/iter; left time: 12024.8399s
	iters: 200, epoch: 16 | loss: 0.1478875
	speed: 0.0625s/iter; left time: 2479.5767s
	iters: 300, epoch: 16 | loss: 0.0222981
	speed: 0.0602s/iter; left time: 2382.7435s
	iters: 400, epoch: 16 | loss: 0.1154234
	speed: 0.0552s/iter; left time: 2179.8014s
Epoch: 16 cost time: 27.334848642349243
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0416084
	speed: 0.3092s/iter; left time: 12150.5543s
	iters: 200, epoch: 17 | loss: 0.0074443
	speed: 0.0583s/iter; left time: 2285.7719s
	iters: 300, epoch: 17 | loss: 0.5331116
	speed: 0.0571s/iter; left time: 2233.3469s
	iters: 400, epoch: 17 | loss: 0.1216972
	speed: 0.0611s/iter; left time: 2381.7164s
Epoch: 17 cost time: 27.287195205688477
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0037931
	speed: 0.2902s/iter; left time: 11266.7852s
	iters: 200, epoch: 18 | loss: 0.0202061
	speed: 0.0568s/iter; left time: 2199.1539s
	iters: 300, epoch: 18 | loss: 0.0123067
	speed: 0.0561s/iter; left time: 2167.9491s
	iters: 400, epoch: 18 | loss: 0.1479724
	speed: 0.0614s/iter; left time: 2364.2871s
Epoch: 18 cost time: 27.629826068878174
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0230818
	speed: 0.2909s/iter; left time: 11158.5452s
	iters: 200, epoch: 19 | loss: 0.0890846
	speed: 0.0584s/iter; left time: 2234.2306s
	iters: 300, epoch: 19 | loss: 0.0096067
	speed: 0.0545s/iter; left time: 2079.0517s
	iters: 400, epoch: 19 | loss: 0.0051429
	speed: 0.0537s/iter; left time: 2042.3367s
Epoch: 19 cost time: 26.728355646133423
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1457971
	speed: 0.2836s/iter; left time: 10746.6782s
	iters: 200, epoch: 20 | loss: 0.0061674
	speed: 0.0548s/iter; left time: 2071.5544s
	iters: 300, epoch: 20 | loss: 0.0110891
	speed: 0.0610s/iter; left time: 2299.3928s
	iters: 400, epoch: 20 | loss: 0.0103154
	speed: 0.0558s/iter; left time: 2099.1168s
Epoch: 20 cost time: 26.62684464454651
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.1589246
	speed: 0.2957s/iter; left time: 11065.2467s
	iters: 200, epoch: 21 | loss: 0.0029609
	speed: 0.0542s/iter; left time: 2024.5227s
	iters: 300, epoch: 21 | loss: 0.0881205
	speed: 0.0555s/iter; left time: 2066.1280s
	iters: 400, epoch: 21 | loss: 0.0224209
	speed: 0.0615s/iter; left time: 2284.3975s
Epoch: 21 cost time: 27.256147623062134
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0165980
	speed: 0.3047s/iter; left time: 11260.9937s
	iters: 200, epoch: 22 | loss: 0.0295570
	speed: 0.0573s/iter; left time: 2111.2247s
	iters: 300, epoch: 22 | loss: 0.2662612
	speed: 0.0522s/iter; left time: 1919.5864s
	iters: 400, epoch: 22 | loss: 0.0253643
	speed: 0.0559s/iter; left time: 2048.0402s
Epoch: 22 cost time: 27.371907472610474
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.1293118
	speed: 0.3023s/iter; left time: 11030.1013s
	iters: 200, epoch: 23 | loss: 0.0023837
	speed: 0.0654s/iter; left time: 2379.6556s
	iters: 300, epoch: 23 | loss: 0.1177181
	speed: 0.0560s/iter; left time: 2032.1103s
	iters: 400, epoch: 23 | loss: 0.0043694
	speed: 0.0531s/iter; left time: 1920.1454s
Epoch: 23 cost time: 27.226988554000854
Epoch: 23, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0064371
	speed: 0.2939s/iter; left time: 10582.8247s
	iters: 200, epoch: 24 | loss: 0.0011663
	speed: 0.0565s/iter; left time: 2028.0442s
	iters: 300, epoch: 24 | loss: 0.0093977
	speed: 0.0614s/iter; left time: 2198.6895s
	iters: 400, epoch: 24 | loss: 0.0128593
	speed: 0.0549s/iter; left time: 1960.6869s
Epoch: 24 cost time: 26.820008516311646
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.6244616
	speed: 0.2950s/iter; left time: 10485.9715s
	iters: 200, epoch: 25 | loss: 0.4147637
	speed: 0.0536s/iter; left time: 1900.2951s
	iters: 300, epoch: 25 | loss: 0.0005586
	speed: 0.0541s/iter; left time: 1911.3174s
	iters: 400, epoch: 25 | loss: 0.0030208
	speed: 0.0586s/iter; left time: 2066.8169s
Epoch: 25 cost time: 26.76800227165222
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0592554
	speed: 0.2873s/iter; left time: 10077.5431s
	iters: 200, epoch: 26 | loss: 0.0017488
	speed: 0.0580s/iter; left time: 2029.6180s
	iters: 300, epoch: 26 | loss: 0.0037392
	speed: 0.0540s/iter; left time: 1883.1139s
	iters: 400, epoch: 26 | loss: 0.1743940
	speed: 0.0475s/iter; left time: 1650.9485s
Epoch: 26 cost time: 25.824514389038086
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0817483
	speed: 0.2899s/iter; left time: 10033.5789s
	iters: 200, epoch: 27 | loss: 0.0091085
	speed: 0.0555s/iter; left time: 1916.2416s
	iters: 300, epoch: 27 | loss: 0.0038539
	speed: 0.0555s/iter; left time: 1910.4273s
	iters: 400, epoch: 27 | loss: 0.0022927
	speed: 0.0484s/iter; left time: 1661.2311s
Epoch: 27 cost time: 24.548661947250366
Epoch: 27, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0087335
	speed: 0.2827s/iter; left time: 9649.3084s
	iters: 200, epoch: 28 | loss: 0.0592957
	speed: 0.0566s/iter; left time: 1926.9513s
	iters: 300, epoch: 28 | loss: 0.0007833
	speed: 0.0590s/iter; left time: 2001.4589s
	iters: 400, epoch: 28 | loss: 0.0202140
	speed: 0.0570s/iter; left time: 1929.2172s
Epoch: 28 cost time: 27.303359508514404
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 40570
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7579232
	speed: 0.0698s/iter; left time: 3265.4004s
	iters: 200, epoch: 1 | loss: 1.4199606
	speed: 0.0547s/iter; left time: 2555.8693s
	iters: 300, epoch: 1 | loss: 0.6216341
	speed: 0.0588s/iter; left time: 2740.3712s
	iters: 400, epoch: 1 | loss: 0.7241811
	speed: 0.0545s/iter; left time: 2533.5715s
Epoch: 1 cost time: 27.292742490768433
Epoch: 1, Steps: 469 | Train Loss: 1.146 Vali Loss: 0.552 Vali Acc: 0.838 Test Loss: 0.552 Test Acc: 0.838
Validation loss decreased (inf --> -0.837902).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3745369
	speed: 0.2804s/iter; left time: 12990.4812s
	iters: 200, epoch: 2 | loss: 0.5487378
	speed: 0.0548s/iter; left time: 2534.0314s
	iters: 300, epoch: 2 | loss: 0.1807649
	speed: 0.0524s/iter; left time: 2418.3137s
	iters: 400, epoch: 2 | loss: 0.2510502
	speed: 0.0577s/iter; left time: 2656.6226s
Epoch: 2 cost time: 26.598519802093506
Epoch: 2, Steps: 469 | Train Loss: 0.324 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
Validation loss decreased (-0.837902 --> -0.897938).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2545658
	speed: 0.2959s/iter; left time: 13569.9576s
	iters: 200, epoch: 3 | loss: 0.1611672
	speed: 0.0573s/iter; left time: 2622.2104s
	iters: 300, epoch: 3 | loss: 0.0894877
	speed: 0.0531s/iter; left time: 2424.8961s
	iters: 400, epoch: 3 | loss: 0.1082288
	speed: 0.0540s/iter; left time: 2459.3380s
Epoch: 3 cost time: 26.526676654815674
Epoch: 3, Steps: 469 | Train Loss: 0.210 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
Validation loss decreased (-0.897938 --> -0.921953).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0657111
	speed: 0.2837s/iter; left time: 12879.2243s
	iters: 200, epoch: 4 | loss: 0.1929300
	speed: 0.0587s/iter; left time: 2661.0084s
	iters: 300, epoch: 4 | loss: 0.1482614
	speed: 0.0555s/iter; left time: 2509.8029s
	iters: 400, epoch: 4 | loss: 0.1058567
	speed: 0.0530s/iter; left time: 2388.6110s
Epoch: 4 cost time: 26.721041202545166
Epoch: 4, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
Validation loss decreased (-0.921953 --> -0.944824).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0482214
	speed: 0.2964s/iter; left time: 13317.8930s
	iters: 200, epoch: 5 | loss: 0.1100485
	speed: 0.0578s/iter; left time: 2592.9710s
	iters: 300, epoch: 5 | loss: 0.1304709
	speed: 0.0600s/iter; left time: 2683.9839s
	iters: 400, epoch: 5 | loss: 0.1628383
	speed: 0.0563s/iter; left time: 2511.5480s
Epoch: 5 cost time: 26.762555360794067
Epoch: 5, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.944824 --> -0.950827).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0328007
	speed: 0.2980s/iter; left time: 13245.9300s
	iters: 200, epoch: 6 | loss: 0.0666006
	speed: 0.0564s/iter; left time: 2500.9687s
	iters: 300, epoch: 6 | loss: 0.0231695
	speed: 0.0606s/iter; left time: 2681.2510s
	iters: 400, epoch: 6 | loss: 0.1615002
	speed: 0.0558s/iter; left time: 2466.0029s
Epoch: 6 cost time: 26.73639154434204
Epoch: 6, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
Validation loss decreased (-0.950827 --> -0.962262).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0234948
	speed: 0.2885s/iter; left time: 12691.3997s
	iters: 200, epoch: 7 | loss: 0.0368607
	speed: 0.0521s/iter; left time: 2285.3890s
	iters: 300, epoch: 7 | loss: 0.1541381
	speed: 0.0530s/iter; left time: 2318.5935s
	iters: 400, epoch: 7 | loss: 0.1418020
	speed: 0.0552s/iter; left time: 2410.9314s
Epoch: 7 cost time: 25.618682622909546
Epoch: 7, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0119363
	speed: 0.2866s/iter; left time: 12470.7747s
	iters: 200, epoch: 8 | loss: 0.1840714
	speed: 0.0598s/iter; left time: 2594.6505s
	iters: 300, epoch: 8 | loss: 0.0453133
	speed: 0.0523s/iter; left time: 2263.6988s
	iters: 400, epoch: 8 | loss: 0.0235768
	speed: 0.0499s/iter; left time: 2157.8115s
Epoch: 8 cost time: 26.187309980392456
Epoch: 8, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0213154
	speed: 0.2896s/iter; left time: 12468.4684s
	iters: 200, epoch: 9 | loss: 0.0671850
	speed: 0.0584s/iter; left time: 2509.4888s
	iters: 300, epoch: 9 | loss: 0.0109136
	speed: 0.0563s/iter; left time: 2410.6150s
	iters: 400, epoch: 9 | loss: 0.0867321
	speed: 0.0518s/iter; left time: 2214.0117s
Epoch: 9 cost time: 25.831740140914917
Epoch: 9, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.962262 --> -0.963978).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0152913
	speed: 0.2941s/iter; left time: 12522.8712s
	iters: 200, epoch: 10 | loss: 0.0208625
	speed: 0.0552s/iter; left time: 2345.8192s
	iters: 300, epoch: 10 | loss: 0.0516530
	speed: 0.0579s/iter; left time: 2455.2498s
	iters: 400, epoch: 10 | loss: 0.0049034
	speed: 0.0558s/iter; left time: 2358.2363s
Epoch: 10 cost time: 26.47147297859192
Epoch: 10, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.963978 --> -0.969981).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1538813
	speed: 0.2967s/iter; left time: 12494.3373s
	iters: 200, epoch: 11 | loss: 0.0583664
	speed: 0.0559s/iter; left time: 2348.3745s
	iters: 300, epoch: 11 | loss: 0.1551104
	speed: 0.0527s/iter; left time: 2210.5671s
	iters: 400, epoch: 11 | loss: 0.0454785
	speed: 0.0549s/iter; left time: 2297.1370s
Epoch: 11 cost time: 26.479488611221313
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1204729
	speed: 0.2979s/iter; left time: 12404.4467s
	iters: 200, epoch: 12 | loss: 0.0056811
	speed: 0.0543s/iter; left time: 2255.5305s
	iters: 300, epoch: 12 | loss: 0.0148343
	speed: 0.0514s/iter; left time: 2129.2167s
	iters: 400, epoch: 12 | loss: 0.0715365
	speed: 0.0495s/iter; left time: 2045.5601s
Epoch: 12 cost time: 25.396650314331055
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0145812
	speed: 0.2612s/iter; left time: 10752.8699s
	iters: 200, epoch: 13 | loss: 0.0304417
	speed: 0.0564s/iter; left time: 2315.1378s
	iters: 300, epoch: 13 | loss: 0.0139861
	speed: 0.0497s/iter; left time: 2037.3513s
	iters: 400, epoch: 13 | loss: 0.0789401
	speed: 0.0498s/iter; left time: 2034.6379s
Epoch: 13 cost time: 24.76113796234131
Epoch: 13, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0021966
	speed: 0.2831s/iter; left time: 11523.4565s
	iters: 200, epoch: 14 | loss: 0.0223095
	speed: 0.0571s/iter; left time: 2318.6284s
	iters: 300, epoch: 14 | loss: 0.0505856
	speed: 0.0519s/iter; left time: 2101.1176s
	iters: 400, epoch: 14 | loss: 0.0288855
	speed: 0.0498s/iter; left time: 2013.7806s
Epoch: 14 cost time: 24.862213611602783
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0042497
	speed: 0.2762s/iter; left time: 11112.4444s
	iters: 200, epoch: 15 | loss: 0.0042421
	speed: 0.0523s/iter; left time: 2098.2064s
	iters: 300, epoch: 15 | loss: 0.1635287
	speed: 0.0521s/iter; left time: 2083.9634s
	iters: 400, epoch: 15 | loss: 0.0256227
	speed: 0.0545s/iter; left time: 2174.9030s
Epoch: 15 cost time: 24.606379985809326
Epoch: 15, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
Validation loss decreased (-0.969981 --> -0.971983).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0511909
	speed: 0.2904s/iter; left time: 11548.6825s
	iters: 200, epoch: 16 | loss: 0.0025525
	speed: 0.0552s/iter; left time: 2188.6490s
	iters: 300, epoch: 16 | loss: 0.0214425
	speed: 0.0551s/iter; left time: 2179.8311s
	iters: 400, epoch: 16 | loss: 0.0082939
	speed: 0.0580s/iter; left time: 2288.0098s
Epoch: 16 cost time: 26.698056936264038
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.971983 --> -0.972269).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0107153
	speed: 0.2910s/iter; left time: 11436.3312s
	iters: 200, epoch: 17 | loss: 0.0917919
	speed: 0.0520s/iter; left time: 2037.8347s
	iters: 300, epoch: 17 | loss: 0.0151552
	speed: 0.0514s/iter; left time: 2010.9369s
	iters: 400, epoch: 17 | loss: 0.0751178
	speed: 0.0578s/iter; left time: 2255.3543s
Epoch: 17 cost time: 25.668611764907837
Epoch: 17, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.976843).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3720395
	speed: 0.2879s/iter; left time: 11178.4063s
	iters: 200, epoch: 18 | loss: 0.0193835
	speed: 0.0524s/iter; left time: 2030.5508s
	iters: 300, epoch: 18 | loss: 0.1901522
	speed: 0.0514s/iter; left time: 1984.4450s
	iters: 400, epoch: 18 | loss: 0.0213711
	speed: 0.0507s/iter; left time: 1954.3320s
Epoch: 18 cost time: 25.757657051086426
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0051850
	speed: 0.3009s/iter; left time: 11542.1143s
	iters: 200, epoch: 19 | loss: 0.0006858
	speed: 0.0520s/iter; left time: 1989.9159s
	iters: 300, epoch: 19 | loss: 0.0035773
	speed: 0.0499s/iter; left time: 1903.3483s
	iters: 400, epoch: 19 | loss: 0.0320015
	speed: 0.0532s/iter; left time: 2023.0287s
Epoch: 19 cost time: 26.12262988090515
Epoch: 19, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0612392
	speed: 0.2969s/iter; left time: 11248.2429s
	iters: 200, epoch: 20 | loss: 0.0018003
	speed: 0.0531s/iter; left time: 2007.1501s
	iters: 300, epoch: 20 | loss: 0.0036879
	speed: 0.0484s/iter; left time: 1824.5550s
	iters: 400, epoch: 20 | loss: 0.0021532
	speed: 0.0506s/iter; left time: 1903.8452s
Epoch: 20 cost time: 25.12429451942444
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.977414).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0012227
	speed: 0.2896s/iter; left time: 10836.7439s
	iters: 200, epoch: 21 | loss: 0.0249536
	speed: 0.0577s/iter; left time: 2154.0934s
	iters: 300, epoch: 21 | loss: 0.0443024
	speed: 0.0519s/iter; left time: 1932.5749s
	iters: 400, epoch: 21 | loss: 0.1290487
	speed: 0.0530s/iter; left time: 1965.6431s
Epoch: 21 cost time: 25.746214866638184
Epoch: 21, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0053748
	speed: 0.3246s/iter; left time: 11994.0277s
	iters: 200, epoch: 22 | loss: 0.0147528
	speed: 0.0493s/iter; left time: 1815.6409s
	iters: 300, epoch: 22 | loss: 0.0193674
	speed: 0.0429s/iter; left time: 1576.3268s
	iters: 400, epoch: 22 | loss: 0.0060440
	speed: 0.0399s/iter; left time: 1462.8275s
Epoch: 22 cost time: 22.99565625190735
Epoch: 22, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0346785
	speed: 0.2710s/iter; left time: 9885.0756s
	iters: 200, epoch: 23 | loss: 0.0033325
	speed: 0.0567s/iter; left time: 2062.2490s
	iters: 300, epoch: 23 | loss: 0.0371718
	speed: 0.0582s/iter; left time: 2110.7009s
	iters: 400, epoch: 23 | loss: 0.0193573
	speed: 0.0561s/iter; left time: 2029.4981s
Epoch: 23 cost time: 26.908571481704712
Epoch: 23, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0286240
	speed: 0.2903s/iter; left time: 10453.5248s
	iters: 200, epoch: 24 | loss: 0.0239700
	speed: 0.0522s/iter; left time: 1874.4910s
	iters: 300, epoch: 24 | loss: 0.0047940
	speed: 0.0505s/iter; left time: 1807.4508s
	iters: 400, epoch: 24 | loss: 0.1151231
	speed: 0.0468s/iter; left time: 1671.1298s
Epoch: 24 cost time: 23.61986994743347
Epoch: 24, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0693463
	speed: 0.2705s/iter; left time: 9613.5393s
	iters: 200, epoch: 25 | loss: 0.0144260
	speed: 0.0540s/iter; left time: 1915.4550s
	iters: 300, epoch: 25 | loss: 0.0039291
	speed: 0.0540s/iter; left time: 1907.0560s
	iters: 400, epoch: 25 | loss: 0.0029660
	speed: 0.0565s/iter; left time: 1992.2435s
Epoch: 25 cost time: 25.728447914123535
Epoch: 25, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0614811
	speed: 0.2840s/iter; left time: 9961.1548s
	iters: 200, epoch: 26 | loss: 0.3348597
	speed: 0.0527s/iter; left time: 1844.7284s
	iters: 300, epoch: 26 | loss: 0.1543280
	speed: 0.0564s/iter; left time: 1966.8499s
	iters: 400, epoch: 26 | loss: 0.0017745
	speed: 0.0572s/iter; left time: 1989.7590s
Epoch: 26 cost time: 26.08416509628296
Epoch: 26, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0018171
	speed: 0.2835s/iter; left time: 9809.3790s
	iters: 200, epoch: 27 | loss: 0.0049260
	speed: 0.0541s/iter; left time: 1865.1414s
	iters: 300, epoch: 27 | loss: 0.0070875
	speed: 0.0601s/iter; left time: 2068.2864s
	iters: 400, epoch: 27 | loss: 0.0050567
	speed: 0.0574s/iter; left time: 1967.8848s
Epoch: 27 cost time: 26.57327628135681
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0259628
	speed: 0.2894s/iter; left time: 9880.3067s
	iters: 200, epoch: 28 | loss: 0.0233405
	speed: 0.0529s/iter; left time: 1801.3129s
	iters: 300, epoch: 28 | loss: 0.0081640
	speed: 0.0529s/iter; left time: 1796.7570s
	iters: 400, epoch: 28 | loss: 0.0030408
	speed: 0.0530s/iter; left time: 1792.4956s
Epoch: 28 cost time: 25.155890226364136
Epoch: 28, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.2357221
	speed: 0.3061s/iter; left time: 10305.8095s
	iters: 200, epoch: 29 | loss: 0.0017751
	speed: 0.0537s/iter; left time: 1802.7369s
	iters: 300, epoch: 29 | loss: 0.0221802
	speed: 0.0580s/iter; left time: 1942.5248s
	iters: 400, epoch: 29 | loss: 0.0218055
	speed: 0.0530s/iter; left time: 1769.4935s
Epoch: 29 cost time: 26.44470477104187
Epoch: 29, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
Validation loss decreased (-0.977414 --> -0.979130).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0225922
	speed: 0.2943s/iter; left time: 9769.2917s
	iters: 200, epoch: 30 | loss: 0.0102673
	speed: 0.0501s/iter; left time: 1659.7141s
	iters: 300, epoch: 30 | loss: 0.0004526
	speed: 0.0576s/iter; left time: 1902.0649s
	iters: 400, epoch: 30 | loss: 0.0076826
	speed: 0.0549s/iter; left time: 1804.8661s
Epoch: 30 cost time: 25.869745016098022
Epoch: 30, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0084943
	speed: 0.2882s/iter; left time: 9433.4197s
	iters: 200, epoch: 31 | loss: 0.0017605
	speed: 0.0511s/iter; left time: 1667.5274s
	iters: 300, epoch: 31 | loss: 0.0048621
	speed: 0.0526s/iter; left time: 1712.5250s
	iters: 400, epoch: 31 | loss: 0.0023023
	speed: 0.0600s/iter; left time: 1946.3208s
Epoch: 31 cost time: 25.862722158432007
Epoch: 31, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0977154
	speed: 0.2887s/iter; left time: 9314.6098s
	iters: 200, epoch: 32 | loss: 0.0029041
	speed: 0.0504s/iter; left time: 1622.2169s
	iters: 300, epoch: 32 | loss: 0.0093080
	speed: 0.0511s/iter; left time: 1637.7396s
	iters: 400, epoch: 32 | loss: 0.0434143
	speed: 0.0528s/iter; left time: 1687.8830s
Epoch: 32 cost time: 24.83223009109497
Epoch: 32, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0144240
	speed: 0.2989s/iter; left time: 9502.5755s
	iters: 200, epoch: 33 | loss: 0.0005964
	speed: 0.0522s/iter; left time: 1655.4555s
	iters: 300, epoch: 33 | loss: 0.0551974
	speed: 0.0552s/iter; left time: 1744.9856s
	iters: 400, epoch: 33 | loss: 0.0233031
	speed: 0.0614s/iter; left time: 1933.2905s
Epoch: 33 cost time: 27.033138036727905
Epoch: 33, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.1111880
	speed: 0.2851s/iter; left time: 8931.6264s
	iters: 200, epoch: 34 | loss: 0.0170575
	speed: 0.0473s/iter; left time: 1476.9691s
	iters: 300, epoch: 34 | loss: 0.0132150
	speed: 0.0485s/iter; left time: 1508.7707s
	iters: 400, epoch: 34 | loss: 0.0353094
	speed: 0.0608s/iter; left time: 1886.5073s
Epoch: 34 cost time: 24.8412446975708
Epoch: 34, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0020261
	speed: 0.2862s/iter; left time: 8829.4424s
	iters: 200, epoch: 35 | loss: 0.0205096
	speed: 0.0489s/iter; left time: 1503.1319s
	iters: 300, epoch: 35 | loss: 0.0011740
	speed: 0.0517s/iter; left time: 1585.0427s
	iters: 400, epoch: 35 | loss: 0.0194704
	speed: 0.0535s/iter; left time: 1635.6592s
Epoch: 35 cost time: 24.733280181884766
Epoch: 35, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0047480
	speed: 0.2777s/iter; left time: 8438.1090s
	iters: 200, epoch: 36 | loss: 0.0043241
	speed: 0.0507s/iter; left time: 1535.1167s
	iters: 300, epoch: 36 | loss: 0.0023638
	speed: 0.0530s/iter; left time: 1601.1347s
	iters: 400, epoch: 36 | loss: 0.0262230
	speed: 0.0550s/iter; left time: 1653.7814s
Epoch: 36 cost time: 25.732187509536743
Epoch: 36, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.980273).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0417497
	speed: 0.2835s/iter; left time: 8482.3168s
	iters: 200, epoch: 37 | loss: 0.0052939
	speed: 0.0509s/iter; left time: 1517.2933s
	iters: 300, epoch: 37 | loss: 0.0960516
	speed: 0.0523s/iter; left time: 1554.9163s
	iters: 400, epoch: 37 | loss: 0.0132836
	speed: 0.0547s/iter; left time: 1620.5718s
Epoch: 37 cost time: 25.27139639854431
Epoch: 37, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0069979
	speed: 0.2688s/iter; left time: 7916.4813s
	iters: 200, epoch: 38 | loss: 0.0008060
	speed: 0.0491s/iter; left time: 1440.4623s
	iters: 300, epoch: 38 | loss: 0.0097484
	speed: 0.0505s/iter; left time: 1476.9229s
	iters: 400, epoch: 38 | loss: 0.0513720
	speed: 0.0482s/iter; left time: 1405.0476s
Epoch: 38 cost time: 24.63252353668213
Epoch: 38, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 39 | loss: 0.0015787
	speed: 0.2913s/iter; left time: 8441.8392s
	iters: 200, epoch: 39 | loss: 0.0036243
	speed: 0.0530s/iter; left time: 1529.4499s
	iters: 300, epoch: 39 | loss: 0.0313018
	speed: 0.0567s/iter; left time: 1631.2685s
	iters: 400, epoch: 39 | loss: 0.0006291
	speed: 0.0538s/iter; left time: 1542.6500s
Epoch: 39 cost time: 26.51941728591919
Epoch: 39, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 40 | loss: 0.0140116
	speed: 0.2911s/iter; left time: 8298.9917s
	iters: 200, epoch: 40 | loss: 0.1419581
	speed: 0.0524s/iter; left time: 1489.7823s
	iters: 300, epoch: 40 | loss: 0.1114029
	speed: 0.0535s/iter; left time: 1513.3996s
	iters: 400, epoch: 40 | loss: 0.0014280
	speed: 0.0558s/iter; left time: 1574.5369s
Epoch: 40 cost time: 26.11230778694153
Epoch: 40, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 41 | loss: 0.0089037
	speed: 0.2799s/iter; left time: 7848.1593s
	iters: 200, epoch: 41 | loss: 0.3166567
	speed: 0.0517s/iter; left time: 1443.5915s
	iters: 300, epoch: 41 | loss: 0.0029662
	speed: 0.0526s/iter; left time: 1464.6294s
	iters: 400, epoch: 41 | loss: 0.3102825
	speed: 0.0521s/iter; left time: 1446.1089s
Epoch: 41 cost time: 25.220173597335815
Epoch: 41, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 42 | loss: 0.0409068
	speed: 0.2716s/iter; left time: 7487.8674s
	iters: 200, epoch: 42 | loss: 0.1089738
	speed: 0.0534s/iter; left time: 1467.0045s
	iters: 300, epoch: 42 | loss: 0.0003791
	speed: 0.0507s/iter; left time: 1388.6013s
	iters: 400, epoch: 42 | loss: 0.0079790
	speed: 0.0536s/iter; left time: 1460.8183s
Epoch: 42 cost time: 24.737430810928345
Epoch: 42, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 43 | loss: 0.0005329
	speed: 0.2689s/iter; left time: 7287.7549s
	iters: 200, epoch: 43 | loss: 0.0319085
	speed: 0.0527s/iter; left time: 1423.2389s
	iters: 300, epoch: 43 | loss: 0.0007347
	speed: 0.0535s/iter; left time: 1439.9965s
	iters: 400, epoch: 43 | loss: 0.0250004
	speed: 0.0523s/iter; left time: 1402.2822s
Epoch: 43 cost time: 24.74464201927185
Epoch: 43, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 44 | loss: 0.0092367
	speed: 0.2767s/iter; left time: 7369.4775s
	iters: 200, epoch: 44 | loss: 0.0013005
	speed: 0.0551s/iter; left time: 1461.1165s
	iters: 300, epoch: 44 | loss: 0.0070094
	speed: 0.0534s/iter; left time: 1411.8812s
	iters: 400, epoch: 44 | loss: 0.0005175
	speed: 0.0505s/iter; left time: 1331.0101s
Epoch: 44 cost time: 25.0455322265625
Epoch: 44, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 45 | loss: 0.0067550
	speed: 0.2815s/iter; left time: 7365.5709s
	iters: 200, epoch: 45 | loss: 0.0456009
	speed: 0.0492s/iter; left time: 1282.5621s
	iters: 300, epoch: 45 | loss: 0.0016573
	speed: 0.0584s/iter; left time: 1516.8141s
	iters: 400, epoch: 45 | loss: 0.0039772
	speed: 0.0528s/iter; left time: 1365.0874s
Epoch: 45 cost time: 25.038954973220825
Epoch: 45, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 46 | loss: 0.0178469
	speed: 0.2802s/iter; left time: 7199.7948s
	iters: 200, epoch: 46 | loss: 0.0029778
	speed: 0.0510s/iter; left time: 1304.1612s
	iters: 300, epoch: 46 | loss: 0.0017707
	speed: 0.0574s/iter; left time: 1464.3396s
	iters: 400, epoch: 46 | loss: 0.0036866
	speed: 0.0577s/iter; left time: 1466.0861s
Epoch: 46 cost time: 25.92929434776306
Epoch: 46, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 24186
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7219846
	speed: 0.0758s/iter; left time: 3546.8494s
	iters: 200, epoch: 1 | loss: 1.4631289
	speed: 0.0539s/iter; left time: 2515.7948s
	iters: 300, epoch: 1 | loss: 0.6328977
	speed: 0.0573s/iter; left time: 2669.6371s
	iters: 400, epoch: 1 | loss: 0.6823115
	speed: 0.0508s/iter; left time: 2364.3600s
Epoch: 1 cost time: 27.56562304496765
Epoch: 1, Steps: 469 | Train Loss: 1.144 Vali Loss: 0.531 Vali Acc: 0.841 Test Loss: 0.531 Test Acc: 0.841
Validation loss decreased (inf --> -0.841047).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3685408
	speed: 0.2865s/iter; left time: 13275.2290s
	iters: 200, epoch: 2 | loss: 0.5193076
	speed: 0.0528s/iter; left time: 2442.4067s
	iters: 300, epoch: 2 | loss: 0.1980383
	speed: 0.0541s/iter; left time: 2495.2790s
	iters: 400, epoch: 2 | loss: 0.2753184
	speed: 0.0496s/iter; left time: 2282.2402s
Epoch: 2 cost time: 24.3609676361084
Epoch: 2, Steps: 469 | Train Loss: 0.321 Vali Loss: 0.328 Vali Acc: 0.906 Test Loss: 0.328 Test Acc: 0.906
Validation loss decreased (-0.841047 --> -0.905657).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2607210
	speed: 0.2652s/iter; left time: 12163.3223s
	iters: 200, epoch: 3 | loss: 0.2001959
	speed: 0.0529s/iter; left time: 2419.5848s
	iters: 300, epoch: 3 | loss: 0.0770018
	speed: 0.0554s/iter; left time: 2530.4461s
	iters: 400, epoch: 3 | loss: 0.1155345
	speed: 0.0554s/iter; left time: 2525.2358s
Epoch: 3 cost time: 25.873733282089233
Epoch: 3, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.255 Vali Acc: 0.929 Test Loss: 0.255 Test Acc: 0.929
Validation loss decreased (-0.905657 --> -0.928528).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0551237
	speed: 0.2890s/iter; left time: 13118.2253s
	iters: 200, epoch: 4 | loss: 0.1944243
	speed: 0.0583s/iter; left time: 2639.7657s
	iters: 300, epoch: 4 | loss: 0.1870977
	speed: 0.0572s/iter; left time: 2587.3477s
	iters: 400, epoch: 4 | loss: 0.1065244
	speed: 0.0521s/iter; left time: 2347.7826s
Epoch: 4 cost time: 26.169586658477783
Epoch: 4, Steps: 469 | Train Loss: 0.153 Vali Loss: 0.208 Vali Acc: 0.947 Test Loss: 0.208 Test Acc: 0.947
Validation loss decreased (-0.928528 --> -0.946539).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0432309
	speed: 0.2973s/iter; left time: 13355.1089s
	iters: 200, epoch: 5 | loss: 0.0752376
	speed: 0.0525s/iter; left time: 2352.1297s
	iters: 300, epoch: 5 | loss: 0.1489980
	speed: 0.0583s/iter; left time: 2606.4429s
	iters: 400, epoch: 5 | loss: 0.1294514
	speed: 0.0519s/iter; left time: 2315.3558s
Epoch: 5 cost time: 25.783624410629272
Epoch: 5, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.946539 --> -0.955973).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0449358
	speed: 0.2926s/iter; left time: 13006.4899s
	iters: 200, epoch: 6 | loss: 0.0919970
	speed: 0.0528s/iter; left time: 2341.9946s
	iters: 300, epoch: 6 | loss: 0.0412420
	speed: 0.0533s/iter; left time: 2359.8372s
	iters: 400, epoch: 6 | loss: 0.2100711
	speed: 0.0527s/iter; left time: 2328.1450s
Epoch: 6 cost time: 25.137744665145874
Epoch: 6, Steps: 469 | Train Loss: 0.116 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.955973 --> -0.956831).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0214476
	speed: 0.2863s/iter; left time: 12593.8794s
	iters: 200, epoch: 7 | loss: 0.0345624
	speed: 0.0525s/iter; left time: 2302.3034s
	iters: 300, epoch: 7 | loss: 0.1532064
	speed: 0.0546s/iter; left time: 2391.3180s
	iters: 400, epoch: 7 | loss: 0.2166515
	speed: 0.0515s/iter; left time: 2248.4439s
Epoch: 7 cost time: 25.12317681312561
Epoch: 7, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0085428
	speed: 0.2832s/iter; left time: 12323.9226s
	iters: 200, epoch: 8 | loss: 0.2239574
	speed: 0.0519s/iter; left time: 2251.7064s
	iters: 300, epoch: 8 | loss: 0.1185849
	speed: 0.0569s/iter; left time: 2462.7669s
	iters: 400, epoch: 8 | loss: 0.0507741
	speed: 0.0507s/iter; left time: 2190.8398s
Epoch: 8 cost time: 24.92924952507019
Epoch: 8, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.158 Vali Acc: 0.961 Test Loss: 0.158 Test Acc: 0.961
Validation loss decreased (-0.956831 --> -0.960547).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0298367
	speed: 0.2833s/iter; left time: 12195.7172s
	iters: 200, epoch: 9 | loss: 0.0967428
	speed: 0.0473s/iter; left time: 2031.9795s
	iters: 300, epoch: 9 | loss: 0.0060578
	speed: 0.0544s/iter; left time: 2332.7814s
	iters: 400, epoch: 9 | loss: 0.0490281
	speed: 0.0528s/iter; left time: 2257.2740s
Epoch: 9 cost time: 24.688101530075073
Epoch: 9, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.960547 --> -0.963692).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0157916
	speed: 0.2882s/iter; left time: 12272.7734s
	iters: 200, epoch: 10 | loss: 0.0155446
	speed: 0.0556s/iter; left time: 2361.6412s
	iters: 300, epoch: 10 | loss: 0.2325272
	speed: 0.0567s/iter; left time: 2403.9050s
	iters: 400, epoch: 10 | loss: 0.0155586
	speed: 0.0559s/iter; left time: 2363.7434s
Epoch: 10 cost time: 26.299672842025757
Epoch: 10, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.963692 --> -0.965407).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0661036
	speed: 0.2890s/iter; left time: 12170.3198s
	iters: 200, epoch: 11 | loss: 0.0203122
	speed: 0.0538s/iter; left time: 2261.1600s
	iters: 300, epoch: 11 | loss: 0.1597638
	speed: 0.0552s/iter; left time: 2312.8324s
	iters: 400, epoch: 11 | loss: 0.1072612
	speed: 0.0569s/iter; left time: 2379.9615s
Epoch: 11 cost time: 26.128193855285645
Epoch: 11, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.1476283
	speed: 0.2806s/iter; left time: 11683.6037s
	iters: 200, epoch: 12 | loss: 0.0087657
	speed: 0.0564s/iter; left time: 2341.2175s
	iters: 300, epoch: 12 | loss: 0.0186393
	speed: 0.0530s/iter; left time: 2196.7114s
	iters: 400, epoch: 12 | loss: 0.0230413
	speed: 0.0506s/iter; left time: 2092.4109s
Epoch: 12 cost time: 25.012117862701416
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.965407 --> -0.967123).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0135305
	speed: 0.2792s/iter; left time: 11494.0388s
	iters: 200, epoch: 13 | loss: 0.0327018
	speed: 0.0545s/iter; left time: 2236.4875s
	iters: 300, epoch: 13 | loss: 0.0072248
	speed: 0.0506s/iter; left time: 2072.6068s
	iters: 400, epoch: 13 | loss: 0.1615500
	speed: 0.0491s/iter; left time: 2007.0430s
Epoch: 13 cost time: 24.142634868621826
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.968552).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0184861
	speed: 0.2576s/iter; left time: 10483.7639s
	iters: 200, epoch: 14 | loss: 0.0171688
	speed: 0.0564s/iter; left time: 2290.4061s
	iters: 300, epoch: 14 | loss: 0.1734206
	speed: 0.0489s/iter; left time: 1980.1641s
	iters: 400, epoch: 14 | loss: 0.0280786
	speed: 0.0493s/iter; left time: 1992.1611s
Epoch: 14 cost time: 25.061595916748047
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970268).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0069294
	speed: 0.2861s/iter; left time: 11510.8125s
	iters: 200, epoch: 15 | loss: 0.0129272
	speed: 0.0603s/iter; left time: 2419.7426s
	iters: 300, epoch: 15 | loss: 0.0905031
	speed: 0.0591s/iter; left time: 2364.4148s
	iters: 400, epoch: 15 | loss: 0.0817399
	speed: 0.0520s/iter; left time: 2077.8841s
Epoch: 15 cost time: 26.313157320022583
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.973126).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0186605
	speed: 0.3046s/iter; left time: 12114.0820s
	iters: 200, epoch: 16 | loss: 0.0011938
	speed: 0.0585s/iter; left time: 2320.1610s
	iters: 300, epoch: 16 | loss: 0.0028206
	speed: 0.0427s/iter; left time: 1690.6724s
	iters: 400, epoch: 16 | loss: 0.0280725
	speed: 0.0390s/iter; left time: 1539.3821s
Epoch: 16 cost time: 23.74342107772827
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.974270).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0123704
	speed: 0.2530s/iter; left time: 9943.9375s
	iters: 200, epoch: 17 | loss: 0.0404698
	speed: 0.0561s/iter; left time: 2197.4724s
	iters: 300, epoch: 17 | loss: 0.0188018
	speed: 0.0587s/iter; left time: 2296.1922s
	iters: 400, epoch: 17 | loss: 0.0931855
	speed: 0.0518s/iter; left time: 2021.6690s
Epoch: 17 cost time: 26.024433851242065
Epoch: 17, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.976271).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.2701981
	speed: 0.2902s/iter; left time: 11268.5329s
	iters: 200, epoch: 18 | loss: 0.0436667
	speed: 0.0531s/iter; left time: 2057.1003s
	iters: 300, epoch: 18 | loss: 0.3907617
	speed: 0.0567s/iter; left time: 2191.6179s
	iters: 400, epoch: 18 | loss: 0.0161294
	speed: 0.0523s/iter; left time: 2013.0905s
Epoch: 18 cost time: 25.642545700073242
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0016025
	speed: 0.2846s/iter; left time: 10917.7012s
	iters: 200, epoch: 19 | loss: 0.0079443
	speed: 0.0512s/iter; left time: 1958.2928s
	iters: 300, epoch: 19 | loss: 0.0033750
	speed: 0.0499s/iter; left time: 1903.6467s
	iters: 400, epoch: 19 | loss: 0.0497086
	speed: 0.0571s/iter; left time: 2172.5404s
Epoch: 19 cost time: 25.167459964752197
Epoch: 19, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0679280
	speed: 0.2868s/iter; left time: 10865.4909s
	iters: 200, epoch: 20 | loss: 0.0096058
	speed: 0.0485s/iter; left time: 1832.7732s
	iters: 300, epoch: 20 | loss: 0.0027335
	speed: 0.0507s/iter; left time: 1910.1270s
	iters: 400, epoch: 20 | loss: 0.0093003
	speed: 0.0549s/iter; left time: 2064.3862s
Epoch: 20 cost time: 24.869999647140503
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0013256
	speed: 0.2915s/iter; left time: 10909.8083s
	iters: 200, epoch: 21 | loss: 0.0290790
	speed: 0.0516s/iter; left time: 1924.9775s
	iters: 300, epoch: 21 | loss: 0.0263667
	speed: 0.0535s/iter; left time: 1990.1148s
	iters: 400, epoch: 21 | loss: 0.0826090
	speed: 0.0574s/iter; left time: 2129.6981s
Epoch: 21 cost time: 26.52796697616577
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0045548
	speed: 0.2964s/iter; left time: 10953.2065s
	iters: 200, epoch: 22 | loss: 0.0063747
	speed: 0.0534s/iter; left time: 1966.9508s
	iters: 300, epoch: 22 | loss: 0.0133336
	speed: 0.0523s/iter; left time: 1923.1342s
	iters: 400, epoch: 22 | loss: 0.0054230
	speed: 0.0569s/iter; left time: 2086.6695s
Epoch: 22 cost time: 27.098284006118774
Epoch: 22, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0048544
	speed: 0.2963s/iter; left time: 10809.1636s
	iters: 200, epoch: 23 | loss: 0.0028247
	speed: 0.0559s/iter; left time: 2034.9409s
	iters: 300, epoch: 23 | loss: 0.0124671
	speed: 0.0471s/iter; left time: 1710.4586s
	iters: 400, epoch: 23 | loss: 0.0188445
	speed: 0.0525s/iter; left time: 1899.2208s
Epoch: 23 cost time: 25.10414481163025
Epoch: 23, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0082577
	speed: 0.2852s/iter; left time: 10269.4165s
	iters: 200, epoch: 24 | loss: 0.0451673
	speed: 0.0538s/iter; left time: 1930.6648s
	iters: 300, epoch: 24 | loss: 0.0101712
	speed: 0.0527s/iter; left time: 1885.9716s
	iters: 400, epoch: 24 | loss: 0.0292191
	speed: 0.0540s/iter; left time: 1927.1615s
Epoch: 24 cost time: 25.232819080352783
Epoch: 24, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977415).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0310269
	speed: 0.2776s/iter; left time: 9868.5375s
	iters: 200, epoch: 25 | loss: 0.0698857
	speed: 0.0478s/iter; left time: 1693.6924s
	iters: 300, epoch: 25 | loss: 0.0107816
	speed: 0.0568s/iter; left time: 2006.2199s
	iters: 400, epoch: 25 | loss: 0.0025631
	speed: 0.0535s/iter; left time: 1886.5783s
Epoch: 25 cost time: 24.868868827819824
Epoch: 25, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0556251
	speed: 0.2784s/iter; left time: 9766.2143s
	iters: 200, epoch: 26 | loss: 0.2335001
	speed: 0.0483s/iter; left time: 1690.6236s
	iters: 300, epoch: 26 | loss: 0.3076241
	speed: 0.0528s/iter; left time: 1842.7046s
	iters: 400, epoch: 26 | loss: 0.0068575
	speed: 0.0558s/iter; left time: 1942.1861s
Epoch: 26 cost time: 25.253891706466675
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.978272).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0026950
	speed: 0.2902s/iter; left time: 10041.5533s
	iters: 200, epoch: 27 | loss: 0.0008563
	speed: 0.0521s/iter; left time: 1798.1496s
	iters: 300, epoch: 27 | loss: 0.0015586
	speed: 0.0555s/iter; left time: 1907.9419s
	iters: 400, epoch: 27 | loss: 0.0039838
	speed: 0.0587s/iter; left time: 2013.3538s
Epoch: 27 cost time: 26.927167177200317
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0095726
	speed: 0.2933s/iter; left time: 10014.0996s
	iters: 200, epoch: 28 | loss: 0.0074699
	speed: 0.0539s/iter; left time: 1835.0582s
	iters: 300, epoch: 28 | loss: 0.0149208
	speed: 0.0532s/iter; left time: 1804.4461s
	iters: 400, epoch: 28 | loss: 0.0391446
	speed: 0.0554s/iter; left time: 1875.3045s
Epoch: 28 cost time: 26.513391733169556
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1433563
	speed: 0.2740s/iter; left time: 9225.1258s
	iters: 200, epoch: 29 | loss: 0.0019672
	speed: 0.0564s/iter; left time: 1894.2021s
	iters: 300, epoch: 29 | loss: 0.0105060
	speed: 0.0506s/iter; left time: 1693.9944s
	iters: 400, epoch: 29 | loss: 0.0199710
	speed: 0.0525s/iter; left time: 1751.2824s
Epoch: 29 cost time: 25.334190130233765
Epoch: 29, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.979702).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0242238
	speed: 0.2823s/iter; left time: 9371.1436s
	iters: 200, epoch: 30 | loss: 0.0289252
	speed: 0.0546s/iter; left time: 1808.4708s
	iters: 300, epoch: 30 | loss: 0.0010528
	speed: 0.0604s/iter; left time: 1993.2372s
	iters: 400, epoch: 30 | loss: 0.0100649
	speed: 0.0544s/iter; left time: 1789.9759s
Epoch: 30 cost time: 25.820847511291504
Epoch: 30, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0268223
	speed: 0.2785s/iter; left time: 9114.8091s
	iters: 200, epoch: 31 | loss: 0.0044385
	speed: 0.0535s/iter; left time: 1747.2159s
	iters: 300, epoch: 31 | loss: 0.0047964
	speed: 0.0562s/iter; left time: 1828.7233s
	iters: 400, epoch: 31 | loss: 0.0005157
	speed: 0.0540s/iter; left time: 1750.9923s
Epoch: 31 cost time: 25.744343042373657
Epoch: 31, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.1374683
	speed: 0.2779s/iter; left time: 8964.8710s
	iters: 200, epoch: 32 | loss: 0.0091865
	speed: 0.0492s/iter; left time: 1582.8243s
	iters: 300, epoch: 32 | loss: 0.0666135
	speed: 0.0511s/iter; left time: 1637.0521s
	iters: 400, epoch: 32 | loss: 0.0258512
	speed: 0.0563s/iter; left time: 1799.4571s
Epoch: 32 cost time: 25.24767827987671
Epoch: 32, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0047005
	speed: 0.2957s/iter; left time: 9402.4982s
	iters: 200, epoch: 33 | loss: 0.0022725
	speed: 0.0531s/iter; left time: 1682.4336s
	iters: 300, epoch: 33 | loss: 0.1019428
	speed: 0.0490s/iter; left time: 1548.5933s
	iters: 400, epoch: 33 | loss: 0.0104139
	speed: 0.0540s/iter; left time: 1700.5050s
Epoch: 33 cost time: 26.28251028060913
Epoch: 33, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.1217711
	speed: 0.2874s/iter; left time: 9001.1473s
	iters: 200, epoch: 34 | loss: 0.0137041
	speed: 0.0461s/iter; left time: 1440.1865s
	iters: 300, epoch: 34 | loss: 0.0181511
	speed: 0.0463s/iter; left time: 1441.6459s
	iters: 400, epoch: 34 | loss: 0.0154361
	speed: 0.0535s/iter; left time: 1659.2978s
Epoch: 34 cost time: 23.98406195640564
Epoch: 34, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0062136
	speed: 0.2835s/iter; left time: 8745.9216s
	iters: 200, epoch: 35 | loss: 0.0063697
	speed: 0.0473s/iter; left time: 1455.3292s
	iters: 300, epoch: 35 | loss: 0.0028434
	speed: 0.0534s/iter; left time: 1636.6609s
	iters: 400, epoch: 35 | loss: 0.0036323
	speed: 0.0568s/iter; left time: 1736.1334s
Epoch: 35 cost time: 25.38226318359375
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.0073063
	speed: 0.2769s/iter; left time: 8412.6240s
	iters: 200, epoch: 36 | loss: 0.0235255
	speed: 0.0509s/iter; left time: 1540.6354s
	iters: 300, epoch: 36 | loss: 0.0083177
	speed: 0.0502s/iter; left time: 1514.7947s
	iters: 400, epoch: 36 | loss: 0.0259716
	speed: 0.0530s/iter; left time: 1594.2329s
Epoch: 36 cost time: 25.39228343963623
Epoch: 36, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0080179
	speed: 0.2793s/iter; left time: 8356.4422s
	iters: 200, epoch: 37 | loss: 0.0025963
	speed: 0.0519s/iter; left time: 1548.8792s
	iters: 300, epoch: 37 | loss: 0.0028947
	speed: 0.0506s/iter; left time: 1503.2676s
	iters: 400, epoch: 37 | loss: 0.0008185
	speed: 0.0513s/iter; left time: 1520.3014s
Epoch: 37 cost time: 25.38089871406555
Epoch: 37, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0060276
	speed: 0.2852s/iter; left time: 8397.6312s
	iters: 200, epoch: 38 | loss: 0.0043572
	speed: 0.0568s/iter; left time: 1666.0115s
	iters: 300, epoch: 38 | loss: 0.0018668
	speed: 0.0522s/iter; left time: 1526.2334s
	iters: 400, epoch: 38 | loss: 0.0615595
	speed: 0.0562s/iter; left time: 1638.4827s
Epoch: 38 cost time: 26.76828694343567
Epoch: 38, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979988).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0004318
	speed: 0.2903s/iter; left time: 8411.3958s
	iters: 200, epoch: 39 | loss: 0.0237732
	speed: 0.0527s/iter; left time: 1522.0662s
	iters: 300, epoch: 39 | loss: 0.0403044
	speed: 0.0581s/iter; left time: 1672.9120s
	iters: 400, epoch: 39 | loss: 0.0051103
	speed: 0.0571s/iter; left time: 1638.9658s
Epoch: 39 cost time: 27.29620885848999
Epoch: 39, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0151631
	speed: 0.2875s/iter; left time: 8196.6515s
	iters: 200, epoch: 40 | loss: 0.0279952
	speed: 0.0524s/iter; left time: 1488.9517s
	iters: 300, epoch: 40 | loss: 0.2042904
	speed: 0.0525s/iter; left time: 1487.1175s
	iters: 400, epoch: 40 | loss: 0.0011406
	speed: 0.0552s/iter; left time: 1557.5364s
Epoch: 40 cost time: 26.445303440093994
Epoch: 40, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979988 --> -0.982561).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0169260
	speed: 0.2819s/iter; left time: 7906.1044s
	iters: 200, epoch: 41 | loss: 0.0183557
	speed: 0.0512s/iter; left time: 1431.2233s
	iters: 300, epoch: 41 | loss: 0.0005503
	speed: 0.0527s/iter; left time: 1466.2201s
	iters: 400, epoch: 41 | loss: 0.3753504
	speed: 0.0573s/iter; left time: 1589.7141s
Epoch: 41 cost time: 26.014207124710083
Epoch: 41, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.1446818
	speed: 0.2703s/iter; left time: 7453.4381s
	iters: 200, epoch: 42 | loss: 0.0732497
	speed: 0.0533s/iter; left time: 1463.0447s
	iters: 300, epoch: 42 | loss: 0.0001958
	speed: 0.0510s/iter; left time: 1394.6572s
	iters: 400, epoch: 42 | loss: 0.0025640
	speed: 0.0494s/iter; left time: 1347.9669s
Epoch: 42 cost time: 25.267454147338867
Epoch: 42, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0008430
	speed: 0.2673s/iter; left time: 7243.4462s
	iters: 200, epoch: 43 | loss: 0.0047449
	speed: 0.0546s/iter; left time: 1474.4142s
	iters: 300, epoch: 43 | loss: 0.0012355
	speed: 0.0501s/iter; left time: 1347.4701s
	iters: 400, epoch: 43 | loss: 0.2039544
	speed: 0.0526s/iter; left time: 1411.0294s
Epoch: 43 cost time: 25.279298305511475
Epoch: 43, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0179109
	speed: 0.2859s/iter; left time: 7614.9971s
	iters: 200, epoch: 44 | loss: 0.0001362
	speed: 0.0567s/iter; left time: 1504.0759s
	iters: 300, epoch: 44 | loss: 0.0172323
	speed: 0.0539s/iter; left time: 1423.8548s
	iters: 400, epoch: 44 | loss: 0.0011571
	speed: 0.0563s/iter; left time: 1483.2650s
Epoch: 44 cost time: 26.842900037765503
Epoch: 44, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0027354
	speed: 0.2948s/iter; left time: 7713.2502s
	iters: 200, epoch: 45 | loss: 0.0976804
	speed: 0.0526s/iter; left time: 1369.9334s
	iters: 300, epoch: 45 | loss: 0.0044223
	speed: 0.0543s/iter; left time: 1408.8496s
	iters: 400, epoch: 45 | loss: 0.0008892
	speed: 0.0519s/iter; left time: 1341.4137s
Epoch: 45 cost time: 26.484349966049194
Epoch: 45, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0902632
	speed: 0.2775s/iter; left time: 7129.9230s
	iters: 200, epoch: 46 | loss: 0.0065785
	speed: 0.0562s/iter; left time: 1437.6549s
	iters: 300, epoch: 46 | loss: 0.0006935
	speed: 0.0517s/iter; left time: 1317.0856s
	iters: 400, epoch: 46 | loss: 0.0202214
	speed: 0.0482s/iter; left time: 1224.7558s
Epoch: 46 cost time: 24.981173992156982
Epoch: 46, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0017262
	speed: 0.2766s/iter; left time: 6977.1425s
	iters: 200, epoch: 47 | loss: 0.0062605
	speed: 0.0562s/iter; left time: 1411.2954s
	iters: 300, epoch: 47 | loss: 0.0189215
	speed: 0.0517s/iter; left time: 1293.6088s
	iters: 400, epoch: 47 | loss: 0.0021054
	speed: 0.0504s/iter; left time: 1257.4037s
Epoch: 47 cost time: 25.67563247680664
Epoch: 47, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0036693
	speed: 0.2845s/iter; left time: 7044.3075s
	iters: 200, epoch: 48 | loss: 0.0108788
	speed: 0.0527s/iter; left time: 1298.4749s
	iters: 300, epoch: 48 | loss: 0.0021219
	speed: 0.0516s/iter; left time: 1266.0555s
	iters: 400, epoch: 48 | loss: 0.0090730
	speed: 0.0490s/iter; left time: 1197.5641s
Epoch: 48 cost time: 25.441856622695923
Epoch: 48, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0017622
	speed: 0.2768s/iter; left time: 6722.2659s
	iters: 200, epoch: 49 | loss: 0.0201596
	speed: 0.0561s/iter; left time: 1357.0970s
	iters: 300, epoch: 49 | loss: 0.0003915
	speed: 0.0544s/iter; left time: 1309.9216s
	iters: 400, epoch: 49 | loss: 0.0314558
	speed: 0.0508s/iter; left time: 1217.7889s
Epoch: 49 cost time: 25.637294054031372
Epoch: 49, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0129122
	speed: 0.2894s/iter; left time: 6892.6233s
	iters: 200, epoch: 50 | loss: 0.0101366
	speed: 0.0589s/iter; left time: 1396.5360s
	iters: 300, epoch: 50 | loss: 0.0036926
	speed: 0.0526s/iter; left time: 1242.8626s
	iters: 400, epoch: 50 | loss: 0.0047376
	speed: 0.0528s/iter; left time: 1242.7321s
Epoch: 50 cost time: 26.37214493751526
Epoch: 50, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 24186
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6714880
	speed: 0.0726s/iter; left time: 3399.5322s
	iters: 200, epoch: 1 | loss: 1.4858484
	speed: 0.0565s/iter; left time: 2638.5715s
	iters: 300, epoch: 1 | loss: 0.6481299
	speed: 0.0505s/iter; left time: 2352.2795s
	iters: 400, epoch: 1 | loss: 0.7040715
	speed: 0.0502s/iter; left time: 2333.8115s
Epoch: 1 cost time: 26.564143657684326
Epoch: 1, Steps: 469 | Train Loss: 1.146 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (inf --> -0.856198).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3515493
	speed: 0.2592s/iter; left time: 12007.7130s
	iters: 200, epoch: 2 | loss: 0.4789076
	speed: 0.0549s/iter; left time: 2540.0957s
	iters: 300, epoch: 2 | loss: 0.1353695
	speed: 0.0542s/iter; left time: 2500.7473s
	iters: 400, epoch: 2 | loss: 0.2202147
	speed: 0.0500s/iter; left time: 2302.1146s
Epoch: 2 cost time: 24.307140350341797
Epoch: 2, Steps: 469 | Train Loss: 0.303 Vali Loss: 0.298 Vali Acc: 0.921 Test Loss: 0.298 Test Acc: 0.921
Validation loss decreased (-0.856198 --> -0.920809).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1961924
	speed: 0.2635s/iter; left time: 12084.8323s
	iters: 200, epoch: 3 | loss: 0.1723165
	speed: 0.0513s/iter; left time: 2346.2039s
	iters: 300, epoch: 3 | loss: 0.1179100
	speed: 0.0576s/iter; left time: 2632.1703s
	iters: 400, epoch: 3 | loss: 0.0742130
	speed: 0.0512s/iter; left time: 2332.3642s
Epoch: 3 cost time: 24.767393827438354
Epoch: 3, Steps: 469 | Train Loss: 0.184 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
Validation loss decreased (-0.920809 --> -0.943108).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0286500
	speed: 0.2695s/iter; left time: 12234.3280s
	iters: 200, epoch: 4 | loss: 0.5319206
	speed: 0.0511s/iter; left time: 2312.8953s
	iters: 300, epoch: 4 | loss: 0.0726506
	speed: 0.0546s/iter; left time: 2468.5927s
	iters: 400, epoch: 4 | loss: 0.0208293
	speed: 0.0536s/iter; left time: 2415.4049s
Epoch: 4 cost time: 24.866272449493408
Epoch: 4, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
Validation loss decreased (-0.943108 --> -0.953114).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0532490
	speed: 0.2701s/iter; left time: 12135.2666s
	iters: 200, epoch: 5 | loss: 0.1000579
	speed: 0.0517s/iter; left time: 2318.0693s
	iters: 300, epoch: 5 | loss: 0.0876023
	speed: 0.0575s/iter; left time: 2572.6762s
	iters: 400, epoch: 5 | loss: 0.1059029
	speed: 0.0539s/iter; left time: 2405.3836s
Epoch: 5 cost time: 25.01994562149048
Epoch: 5, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
Validation loss decreased (-0.953114 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0273280
	speed: 0.2699s/iter; left time: 11996.9577s
	iters: 200, epoch: 6 | loss: 0.0666813
	speed: 0.0526s/iter; left time: 2333.0740s
	iters: 300, epoch: 6 | loss: 0.0386374
	speed: 0.0501s/iter; left time: 2219.0159s
	iters: 400, epoch: 6 | loss: 0.2179532
	speed: 0.0562s/iter; left time: 2483.1671s
Epoch: 6 cost time: 25.012407302856445
Epoch: 6, Steps: 469 | Train Loss: 0.101 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.960547 --> -0.965121).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0956313
	speed: 0.2748s/iter; left time: 12089.7271s
	iters: 200, epoch: 7 | loss: 0.0532917
	speed: 0.0522s/iter; left time: 2292.0597s
	iters: 300, epoch: 7 | loss: 0.0523725
	speed: 0.0544s/iter; left time: 2380.8225s
	iters: 400, epoch: 7 | loss: 0.0536930
	speed: 0.0559s/iter; left time: 2444.1214s
Epoch: 7 cost time: 25.427761793136597
Epoch: 7, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.965121 --> -0.968838).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0107903
	speed: 0.2705s/iter; left time: 11771.8300s
	iters: 200, epoch: 8 | loss: 0.0617007
	speed: 0.0477s/iter; left time: 2072.8626s
	iters: 300, epoch: 8 | loss: 0.0557352
	speed: 0.0522s/iter; left time: 2260.4783s
	iters: 400, epoch: 8 | loss: 0.0856666
	speed: 0.0568s/iter; left time: 2454.2387s
Epoch: 8 cost time: 24.779327154159546
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0516000
	speed: 0.2570s/iter; left time: 11065.4891s
	iters: 200, epoch: 9 | loss: 0.1305443
	speed: 0.0510s/iter; left time: 2189.7314s
	iters: 300, epoch: 9 | loss: 0.0092305
	speed: 0.0492s/iter; left time: 2110.1750s
	iters: 400, epoch: 9 | loss: 0.0647016
	speed: 0.0517s/iter; left time: 2208.8995s
Epoch: 9 cost time: 24.944305658340454
Epoch: 9, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.970553).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0227991
	speed: 0.2652s/iter; left time: 11294.1705s
	iters: 200, epoch: 10 | loss: 0.0191918
	speed: 0.0529s/iter; left time: 2245.4259s
	iters: 300, epoch: 10 | loss: 0.0950455
	speed: 0.0546s/iter; left time: 2312.0585s
	iters: 400, epoch: 10 | loss: 0.0145062
	speed: 0.0530s/iter; left time: 2240.9684s
Epoch: 10 cost time: 26.210143089294434
Epoch: 10, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.972840).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0238082
	speed: 0.2802s/iter; left time: 11798.7731s
	iters: 200, epoch: 11 | loss: 0.2671400
	speed: 0.0546s/iter; left time: 2295.0460s
	iters: 300, epoch: 11 | loss: 0.0901688
	speed: 0.0527s/iter; left time: 2207.4412s
	iters: 400, epoch: 11 | loss: 0.0399643
	speed: 0.0540s/iter; left time: 2255.8150s
Epoch: 11 cost time: 26.29803729057312
Epoch: 11, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0942099
	speed: 0.2744s/iter; left time: 11427.6307s
	iters: 200, epoch: 12 | loss: 0.0095686
	speed: 0.0559s/iter; left time: 2321.0013s
	iters: 300, epoch: 12 | loss: 0.0390423
	speed: 0.0516s/iter; left time: 2139.9177s
	iters: 400, epoch: 12 | loss: 0.0369510
	speed: 0.0485s/iter; left time: 2006.7893s
Epoch: 12 cost time: 25.433117628097534
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973698).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0149893
	speed: 0.2635s/iter; left time: 10848.5254s
	iters: 200, epoch: 13 | loss: 0.0036202
	speed: 0.0520s/iter; left time: 2135.8826s
	iters: 300, epoch: 13 | loss: 0.0319373
	speed: 0.0528s/iter; left time: 2161.3385s
	iters: 400, epoch: 13 | loss: 0.0443901
	speed: 0.0521s/iter; left time: 2130.0491s
Epoch: 13 cost time: 24.556856870651245
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0563334
	speed: 0.2658s/iter; left time: 10818.7426s
	iters: 200, epoch: 14 | loss: 0.0457825
	speed: 0.0526s/iter; left time: 2136.8722s
	iters: 300, epoch: 14 | loss: 0.1404115
	speed: 0.0434s/iter; left time: 1757.9377s
	iters: 400, epoch: 14 | loss: 0.0373489
	speed: 0.0450s/iter; left time: 1817.2057s
Epoch: 14 cost time: 22.361624240875244
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0073927
	speed: 0.2581s/iter; left time: 10384.1531s
	iters: 200, epoch: 15 | loss: 0.0061930
	speed: 0.0517s/iter; left time: 2076.7995s
	iters: 300, epoch: 15 | loss: 0.0275990
	speed: 0.0515s/iter; left time: 2062.0134s
	iters: 400, epoch: 15 | loss: 0.0187987
	speed: 0.0487s/iter; left time: 1946.4917s
Epoch: 15 cost time: 23.70422625541687
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0410649
	speed: 0.2562s/iter; left time: 10189.1353s
	iters: 200, epoch: 16 | loss: 0.0029265
	speed: 0.0532s/iter; left time: 2110.6596s
	iters: 300, epoch: 16 | loss: 0.0127613
	speed: 0.0561s/iter; left time: 2219.4785s
	iters: 400, epoch: 16 | loss: 0.0041767
	speed: 0.0533s/iter; left time: 2102.9475s
Epoch: 16 cost time: 25.26567053794861
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.974270).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0214085
	speed: 0.2992s/iter; left time: 11757.6575s
	iters: 200, epoch: 17 | loss: 0.0612953
	speed: 0.0359s/iter; left time: 1408.9447s
	iters: 300, epoch: 17 | loss: 0.0037222
	speed: 0.0369s/iter; left time: 1443.0491s
	iters: 400, epoch: 17 | loss: 0.1492474
	speed: 0.0365s/iter; left time: 1424.8028s
Epoch: 17 cost time: 19.31778860092163
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.978844).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.3884945
	speed: 0.2266s/iter; left time: 8797.8217s
	iters: 200, epoch: 18 | loss: 0.0417082
	speed: 0.0529s/iter; left time: 2048.1211s
	iters: 300, epoch: 18 | loss: 0.1649632
	speed: 0.0553s/iter; left time: 2136.4950s
	iters: 400, epoch: 18 | loss: 0.0154124
	speed: 0.0491s/iter; left time: 1893.0243s
Epoch: 18 cost time: 24.710878372192383
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0126851
	speed: 0.2658s/iter; left time: 10196.1424s
	iters: 200, epoch: 19 | loss: 0.0182299
	speed: 0.0505s/iter; left time: 1932.7530s
	iters: 300, epoch: 19 | loss: 0.0064841
	speed: 0.0532s/iter; left time: 2031.4020s
	iters: 400, epoch: 19 | loss: 0.1769368
	speed: 0.0479s/iter; left time: 1823.8208s
Epoch: 19 cost time: 23.595749616622925
Epoch: 19, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0699051
	speed: 0.2684s/iter; left time: 10168.7776s
	iters: 200, epoch: 20 | loss: 0.0835186
	speed: 0.0516s/iter; left time: 1948.6624s
	iters: 300, epoch: 20 | loss: 0.0008323
	speed: 0.0525s/iter; left time: 1979.0280s
	iters: 400, epoch: 20 | loss: 0.0013586
	speed: 0.0523s/iter; left time: 1966.9183s
Epoch: 20 cost time: 24.81089997291565
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0182000
	speed: 0.2766s/iter; left time: 10351.0875s
	iters: 200, epoch: 21 | loss: 0.0062963
	speed: 0.0515s/iter; left time: 1921.5750s
	iters: 300, epoch: 21 | loss: 0.0027395
	speed: 0.0532s/iter; left time: 1978.9566s
	iters: 400, epoch: 21 | loss: 0.0267209
	speed: 0.0510s/iter; left time: 1894.8513s
Epoch: 21 cost time: 24.71667194366455
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0818260
	speed: 0.2792s/iter; left time: 10317.9074s
	iters: 200, epoch: 22 | loss: 0.0148765
	speed: 0.0548s/iter; left time: 2018.7911s
	iters: 300, epoch: 22 | loss: 0.0036470
	speed: 0.0545s/iter; left time: 2001.4856s
	iters: 400, epoch: 22 | loss: 0.0033940
	speed: 0.0522s/iter; left time: 1912.8051s
Epoch: 22 cost time: 25.93073058128357
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0044179
	speed: 0.2827s/iter; left time: 10314.9865s
	iters: 200, epoch: 23 | loss: 0.0009950
	speed: 0.0556s/iter; left time: 2021.8617s
	iters: 300, epoch: 23 | loss: 0.1048599
	speed: 0.0535s/iter; left time: 1940.5336s
	iters: 400, epoch: 23 | loss: 0.0237533
	speed: 0.0537s/iter; left time: 1944.7436s
Epoch: 23 cost time: 25.328138828277588
Epoch: 23, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0042376
	speed: 0.2819s/iter; left time: 10151.0969s
	iters: 200, epoch: 24 | loss: 0.0056597
	speed: 0.0482s/iter; left time: 1730.3541s
	iters: 300, epoch: 24 | loss: 0.0032486
	speed: 0.0511s/iter; left time: 1831.1280s
	iters: 400, epoch: 24 | loss: 0.1705789
	speed: 0.0523s/iter; left time: 1866.5987s
Epoch: 24 cost time: 24.03880548477173
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0104684
	speed: 0.2726s/iter; left time: 9690.5100s
	iters: 200, epoch: 25 | loss: 0.0816396
	speed: 0.0525s/iter; left time: 1861.2986s
	iters: 300, epoch: 25 | loss: 0.0247725
	speed: 0.0519s/iter; left time: 1834.5355s
	iters: 400, epoch: 25 | loss: 0.0181001
	speed: 0.0513s/iter; left time: 1808.2152s
Epoch: 25 cost time: 24.575743913650513
Epoch: 25, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0075090
	speed: 0.2756s/iter; left time: 9665.4856s
	iters: 200, epoch: 26 | loss: 0.2351397
	speed: 0.0520s/iter; left time: 1819.0204s
	iters: 300, epoch: 26 | loss: 0.0187367
	speed: 0.0532s/iter; left time: 1855.9905s
	iters: 400, epoch: 26 | loss: 0.0080499
	speed: 0.0512s/iter; left time: 1780.8774s
Epoch: 26 cost time: 24.567688941955566
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0181503
	speed: 0.2662s/iter; left time: 9212.1306s
	iters: 200, epoch: 27 | loss: 0.0007570
	speed: 0.0504s/iter; left time: 1739.4794s
	iters: 300, epoch: 27 | loss: 0.0164712
	speed: 0.0545s/iter; left time: 1875.3969s
	iters: 400, epoch: 27 | loss: 0.0034214
	speed: 0.0462s/iter; left time: 1586.4930s
Epoch: 27 cost time: 24.43415403366089
Epoch: 27, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 24186
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6917686
	speed: 0.0719s/iter; left time: 3364.6460s
	iters: 200, epoch: 1 | loss: 0.9232150
	speed: 0.0493s/iter; left time: 2300.3976s
	iters: 300, epoch: 1 | loss: 0.4132157
	speed: 0.0514s/iter; left time: 2396.4366s
	iters: 400, epoch: 1 | loss: 0.2738033
	speed: 0.0559s/iter; left time: 2600.9343s
Epoch: 1 cost time: 26.56456685066223
Epoch: 1, Steps: 469 | Train Loss: 1.054 Vali Loss: 0.524 Vali Acc: 0.837 Test Loss: 0.524 Test Acc: 0.837
Validation loss decreased (inf --> -0.837330).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2605250
	speed: 0.2831s/iter; left time: 13116.2957s
	iters: 200, epoch: 2 | loss: 0.1935600
	speed: 0.0480s/iter; left time: 2219.1978s
	iters: 300, epoch: 2 | loss: 0.3825435
	speed: 0.0483s/iter; left time: 2228.5757s
	iters: 400, epoch: 2 | loss: 0.0817035
	speed: 0.0531s/iter; left time: 2446.0280s
Epoch: 2 cost time: 24.34413433074951
Epoch: 2, Steps: 469 | Train Loss: 0.328 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
Validation loss decreased (-0.837330 --> -0.889362).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1936012
	speed: 0.2642s/iter; left time: 12118.6535s
	iters: 200, epoch: 3 | loss: 0.4724391
	speed: 0.0492s/iter; left time: 2250.8972s
	iters: 300, epoch: 3 | loss: 0.3760716
	speed: 0.0504s/iter; left time: 2303.5882s
	iters: 400, epoch: 3 | loss: 0.3087444
	speed: 0.0511s/iter; left time: 2328.0202s
Epoch: 3 cost time: 24.58098292350769
Epoch: 3, Steps: 469 | Train Loss: 0.213 Vali Loss: 0.263 Vali Acc: 0.927 Test Loss: 0.263 Test Acc: 0.927
Validation loss decreased (-0.889362 --> -0.926813).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2041910
	speed: 0.2760s/iter; left time: 12527.3744s
	iters: 200, epoch: 4 | loss: 0.0775655
	speed: 0.0495s/iter; left time: 2240.1753s
	iters: 300, epoch: 4 | loss: 0.0615548
	speed: 0.0481s/iter; left time: 2172.9006s
	iters: 400, epoch: 4 | loss: 0.1001656
	speed: 0.0526s/iter; left time: 2373.2088s
Epoch: 4 cost time: 24.635969161987305
Epoch: 4, Steps: 469 | Train Loss: 0.157 Vali Loss: 0.214 Vali Acc: 0.945 Test Loss: 0.214 Test Acc: 0.945
Validation loss decreased (-0.926813 --> -0.944538).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0651288
	speed: 0.2641s/iter; left time: 11865.8886s
	iters: 200, epoch: 5 | loss: 0.0389852
	speed: 0.0498s/iter; left time: 2232.7125s
	iters: 300, epoch: 5 | loss: 0.1048896
	speed: 0.0483s/iter; left time: 2160.6101s
	iters: 400, epoch: 5 | loss: 0.1454728
	speed: 0.0500s/iter; left time: 2231.1870s
Epoch: 5 cost time: 23.625304222106934
Epoch: 5, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0550521
	speed: 0.2586s/iter; left time: 11497.0523s
	iters: 200, epoch: 6 | loss: 0.1035558
	speed: 0.0474s/iter; left time: 2101.0169s
	iters: 300, epoch: 6 | loss: 0.2617425
	speed: 0.0523s/iter; left time: 2315.2263s
	iters: 400, epoch: 6 | loss: 0.0516786
	speed: 0.0536s/iter; left time: 2364.8986s
Epoch: 6 cost time: 25.123207807540894
Epoch: 6, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.944538 --> -0.960547).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1715088
	speed: 0.2795s/iter; left time: 12296.1955s
	iters: 200, epoch: 7 | loss: 0.0257596
	speed: 0.0518s/iter; left time: 2273.5971s
	iters: 300, epoch: 7 | loss: 0.1524290
	speed: 0.0515s/iter; left time: 2256.8479s
	iters: 400, epoch: 7 | loss: 0.0418867
	speed: 0.0571s/iter; left time: 2494.1821s
Epoch: 7 cost time: 25.66859221458435
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0050083
	speed: 0.2708s/iter; left time: 11786.6504s
	iters: 200, epoch: 8 | loss: 0.1114655
	speed: 0.0511s/iter; left time: 2218.6168s
	iters: 300, epoch: 8 | loss: 0.0335963
	speed: 0.0512s/iter; left time: 2218.3429s
	iters: 400, epoch: 8 | loss: 0.0535777
	speed: 0.0545s/iter; left time: 2357.1284s
Epoch: 8 cost time: 24.527750253677368
Epoch: 8, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.960547 --> -0.968552).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0224653
	speed: 0.2569s/iter; left time: 11061.0041s
	iters: 200, epoch: 9 | loss: 0.0123363
	speed: 0.0503s/iter; left time: 2160.6680s
	iters: 300, epoch: 9 | loss: 0.0833084
	speed: 0.0495s/iter; left time: 2123.0321s
	iters: 400, epoch: 9 | loss: 0.0112855
	speed: 0.0500s/iter; left time: 2138.6630s
Epoch: 9 cost time: 24.425578355789185
Epoch: 9, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0235585
	speed: 0.2699s/iter; left time: 11490.2868s
	iters: 200, epoch: 10 | loss: 0.1340853
	speed: 0.0518s/iter; left time: 2198.7440s
	iters: 300, epoch: 10 | loss: 0.0495010
	speed: 0.0517s/iter; left time: 2191.8477s
	iters: 400, epoch: 10 | loss: 0.0134927
	speed: 0.0511s/iter; left time: 2162.5434s
Epoch: 10 cost time: 24.911711931228638
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0210274
	speed: 0.2709s/iter; left time: 11407.8111s
	iters: 200, epoch: 11 | loss: 0.0521236
	speed: 0.0473s/iter; left time: 1988.1734s
	iters: 300, epoch: 11 | loss: 0.0083192
	speed: 0.0522s/iter; left time: 2185.7966s
	iters: 400, epoch: 11 | loss: 0.0118260
	speed: 0.0557s/iter; left time: 2328.0117s
Epoch: 11 cost time: 25.39035940170288
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0350669
	speed: 0.2707s/iter; left time: 11274.1049s
	iters: 200, epoch: 12 | loss: 0.0181116
	speed: 0.0555s/iter; left time: 2306.5264s
	iters: 300, epoch: 12 | loss: 0.0659524
	speed: 0.0545s/iter; left time: 2257.7590s
	iters: 400, epoch: 12 | loss: 0.0609310
	speed: 0.0500s/iter; left time: 2067.8637s
Epoch: 12 cost time: 25.73635959625244
Epoch: 12, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.9406241
	speed: 0.2760s/iter; left time: 11361.7294s
	iters: 200, epoch: 13 | loss: 0.1298732
	speed: 0.0534s/iter; left time: 2193.0070s
	iters: 300, epoch: 13 | loss: 0.0752981
	speed: 0.0532s/iter; left time: 2180.7511s
	iters: 400, epoch: 13 | loss: 0.2128806
	speed: 0.0526s/iter; left time: 2148.7795s
Epoch: 13 cost time: 25.798282146453857
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.968552 --> -0.973412).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0130323
	speed: 0.2698s/iter; left time: 10981.4517s
	iters: 200, epoch: 14 | loss: 0.1039268
	speed: 0.0503s/iter; left time: 2042.6975s
	iters: 300, epoch: 14 | loss: 0.0114237
	speed: 0.0460s/iter; left time: 1864.7469s
	iters: 400, epoch: 14 | loss: 0.1934723
	speed: 0.0495s/iter; left time: 1999.1645s
Epoch: 14 cost time: 24.09686279296875
Epoch: 14, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0036477
	speed: 0.2600s/iter; left time: 10460.2058s
	iters: 200, epoch: 15 | loss: 0.0039368
	speed: 0.0503s/iter; left time: 2019.4870s
	iters: 300, epoch: 15 | loss: 0.0618831
	speed: 0.0511s/iter; left time: 2044.7935s
	iters: 400, epoch: 15 | loss: 0.3832389
	speed: 0.0500s/iter; left time: 1996.4817s
Epoch: 15 cost time: 24.088999271392822
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0517308
	speed: 0.2584s/iter; left time: 10277.1162s
	iters: 200, epoch: 16 | loss: 0.0292801
	speed: 0.0496s/iter; left time: 1968.4328s
	iters: 300, epoch: 16 | loss: 0.1233748
	speed: 0.0472s/iter; left time: 1866.0930s
	iters: 400, epoch: 16 | loss: 0.0173560
	speed: 0.0505s/iter; left time: 1993.6392s
Epoch: 16 cost time: 23.648663997650146
Epoch: 16, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973412 --> -0.976557).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1690446
	speed: 0.2805s/iter; left time: 11023.1871s
	iters: 200, epoch: 17 | loss: 0.0826404
	speed: 0.0521s/iter; left time: 2043.5507s
	iters: 300, epoch: 17 | loss: 0.0070105
	speed: 0.0544s/iter; left time: 2124.9934s
	iters: 400, epoch: 17 | loss: 0.0192922
	speed: 0.0538s/iter; left time: 2098.4331s
Epoch: 17 cost time: 26.038787603378296
Epoch: 17, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0716578
	speed: 0.2808s/iter; left time: 10903.3362s
	iters: 200, epoch: 18 | loss: 0.0475856
	speed: 0.0534s/iter; left time: 2068.6704s
	iters: 300, epoch: 18 | loss: 0.0173005
	speed: 0.0509s/iter; left time: 1966.9018s
	iters: 400, epoch: 18 | loss: 0.0081783
	speed: 0.0541s/iter; left time: 2085.2278s
Epoch: 18 cost time: 25.515161514282227
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0627892
	speed: 0.2836s/iter; left time: 10876.7277s
	iters: 200, epoch: 19 | loss: 0.0073798
	speed: 0.0518s/iter; left time: 1983.3161s
	iters: 300, epoch: 19 | loss: 0.0058913
	speed: 0.0502s/iter; left time: 1915.3305s
	iters: 400, epoch: 19 | loss: 0.0415696
	speed: 0.0517s/iter; left time: 1966.6064s
Epoch: 19 cost time: 25.293926239013672
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2208423
	speed: 0.2739s/iter; left time: 10379.0127s
	iters: 200, epoch: 20 | loss: 0.0432106
	speed: 0.0530s/iter; left time: 2003.4665s
	iters: 300, epoch: 20 | loss: 0.0024746
	speed: 0.0498s/iter; left time: 1876.7613s
	iters: 400, epoch: 20 | loss: 0.0200872
	speed: 0.0514s/iter; left time: 1930.8932s
Epoch: 20 cost time: 24.954702377319336
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.977415).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0940484
	speed: 0.2676s/iter; left time: 10015.2462s
	iters: 200, epoch: 21 | loss: 0.0063244
	speed: 0.0536s/iter; left time: 1998.5761s
	iters: 300, epoch: 21 | loss: 0.0594272
	speed: 0.0519s/iter; left time: 1933.2983s
	iters: 400, epoch: 21 | loss: 0.0812813
	speed: 0.0494s/iter; left time: 1833.4378s
Epoch: 21 cost time: 24.464993000030518
Epoch: 21, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.977415 --> -0.980273).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.3704949
	speed: 0.2492s/iter; left time: 9208.5535s
	iters: 200, epoch: 22 | loss: 0.0991131
	speed: 0.0540s/iter; left time: 1990.1831s
	iters: 300, epoch: 22 | loss: 0.0183280
	speed: 0.0541s/iter; left time: 1989.5661s
	iters: 400, epoch: 22 | loss: 0.0082083
	speed: 0.0520s/iter; left time: 1907.1743s
Epoch: 22 cost time: 24.983247756958008
Epoch: 22, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0238708
	speed: 0.2825s/iter; left time: 10307.6239s
	iters: 200, epoch: 23 | loss: 0.0061435
	speed: 0.0590s/iter; left time: 2146.4732s
	iters: 300, epoch: 23 | loss: 0.0126998
	speed: 0.0576s/iter; left time: 2090.9691s
	iters: 400, epoch: 23 | loss: 0.3459562
	speed: 0.0553s/iter; left time: 2000.3686s
Epoch: 23 cost time: 26.77450180053711
Epoch: 23, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0701020
	speed: 0.2829s/iter; left time: 10186.7728s
	iters: 200, epoch: 24 | loss: 0.0168530
	speed: 0.0581s/iter; left time: 2085.9694s
	iters: 300, epoch: 24 | loss: 0.0454530
	speed: 0.0597s/iter; left time: 2136.5810s
	iters: 400, epoch: 24 | loss: 0.0031095
	speed: 0.0546s/iter; left time: 1950.6534s
Epoch: 24 cost time: 26.399197340011597
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0111512
	speed: 0.2768s/iter; left time: 9839.6865s
	iters: 200, epoch: 25 | loss: 0.0125228
	speed: 0.0521s/iter; left time: 1845.4990s
	iters: 300, epoch: 25 | loss: 0.0047388
	speed: 0.0540s/iter; left time: 1910.1225s
	iters: 400, epoch: 25 | loss: 0.0044340
	speed: 0.0566s/iter; left time: 1996.3954s
Epoch: 25 cost time: 25.430068731307983
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0223238
	speed: 0.2762s/iter; left time: 9689.7234s
	iters: 200, epoch: 26 | loss: 1.0273261
	speed: 0.0528s/iter; left time: 1848.1451s
	iters: 300, epoch: 26 | loss: 0.1246122
	speed: 0.0532s/iter; left time: 1856.6211s
	iters: 400, epoch: 26 | loss: 0.0305516
	speed: 0.0576s/iter; left time: 2003.2470s
Epoch: 26 cost time: 25.724609851837158
Epoch: 26, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0549192
	speed: 0.2793s/iter; left time: 9667.1011s
	iters: 200, epoch: 27 | loss: 0.0261454
	speed: 0.0524s/iter; left time: 1809.8334s
	iters: 300, epoch: 27 | loss: 0.0012405
	speed: 0.0513s/iter; left time: 1765.7902s
	iters: 400, epoch: 27 | loss: 0.0127685
	speed: 0.0570s/iter; left time: 1956.5803s
Epoch: 27 cost time: 25.625001430511475
Epoch: 27, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0015415
	speed: 0.2720s/iter; left time: 9285.5274s
	iters: 200, epoch: 28 | loss: 0.0023145
	speed: 0.0530s/iter; left time: 1805.3471s
	iters: 300, epoch: 28 | loss: 0.0151905
	speed: 0.0487s/iter; left time: 1653.5830s
	iters: 400, epoch: 28 | loss: 0.0002560
	speed: 0.0558s/iter; left time: 1888.1901s
Epoch: 28 cost time: 25.930789470672607
Epoch: 28, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1339680
	speed: 0.2876s/iter; left time: 9684.6766s
	iters: 200, epoch: 29 | loss: 0.0027647
	speed: 0.0592s/iter; left time: 1987.4234s
	iters: 300, epoch: 29 | loss: 0.0054115
	speed: 0.0561s/iter; left time: 1877.4561s
	iters: 400, epoch: 29 | loss: 0.0012967
	speed: 0.0533s/iter; left time: 1779.6245s
Epoch: 29 cost time: 26.72159433364868
Epoch: 29, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0252121
	speed: 0.2939s/iter; left time: 9758.4605s
	iters: 200, epoch: 30 | loss: 0.0013472
	speed: 0.0586s/iter; left time: 1938.2070s
	iters: 300, epoch: 30 | loss: 0.0191087
	speed: 0.0566s/iter; left time: 1866.9927s
	iters: 400, epoch: 30 | loss: 0.0301927
	speed: 0.0532s/iter; left time: 1749.7998s
Epoch: 30 cost time: 26.647942781448364
Epoch: 30, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0023209
	speed: 0.2818s/iter; left time: 9225.2281s
	iters: 200, epoch: 31 | loss: 0.0100657
	speed: 0.0579s/iter; left time: 1888.9212s
	iters: 300, epoch: 31 | loss: 0.0005495
	speed: 0.0521s/iter; left time: 1693.9848s
	iters: 400, epoch: 31 | loss: 0.0919294
	speed: 0.0509s/iter; left time: 1650.9318s
Epoch: 31 cost time: 25.366947174072266
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 15994
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6966980
	speed: 0.0714s/iter; left time: 3340.5490s
	iters: 200, epoch: 1 | loss: 0.9385745
	speed: 0.0508s/iter; left time: 2371.0406s
	iters: 300, epoch: 1 | loss: 0.4233912
	speed: 0.0562s/iter; left time: 2619.0441s
	iters: 400, epoch: 1 | loss: 0.3109266
	speed: 0.0551s/iter; left time: 2562.2762s
Epoch: 1 cost time: 27.212327241897583
Epoch: 1, Steps: 469 | Train Loss: 1.058 Vali Loss: 0.503 Vali Acc: 0.846 Test Loss: 0.503 Test Acc: 0.846
Validation loss decreased (inf --> -0.845621).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2583075
	speed: 0.2834s/iter; left time: 13130.7585s
	iters: 200, epoch: 2 | loss: 0.2030939
	speed: 0.0507s/iter; left time: 2344.7007s
	iters: 300, epoch: 2 | loss: 0.3839730
	speed: 0.0546s/iter; left time: 2518.8920s
	iters: 400, epoch: 2 | loss: 0.0734962
	speed: 0.0564s/iter; left time: 2597.4697s
Epoch: 2 cost time: 25.240559816360474
Epoch: 2, Steps: 469 | Train Loss: 0.323 Vali Loss: 0.330 Vali Acc: 0.907 Test Loss: 0.330 Test Acc: 0.907
Validation loss decreased (-0.845621 --> -0.907086).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1627418
	speed: 0.2767s/iter; left time: 12688.4313s
	iters: 200, epoch: 3 | loss: 0.4351765
	speed: 0.0523s/iter; left time: 2394.1155s
	iters: 300, epoch: 3 | loss: 0.4498984
	speed: 0.0534s/iter; left time: 2437.8654s
	iters: 400, epoch: 3 | loss: 0.3045436
	speed: 0.0575s/iter; left time: 2619.2286s
Epoch: 3 cost time: 26.050720691680908
Epoch: 3, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.907086 --> -0.937390).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1975648
	speed: 0.2778s/iter; left time: 12611.7307s
	iters: 200, epoch: 4 | loss: 0.0624331
	speed: 0.0515s/iter; left time: 2334.4820s
	iters: 300, epoch: 4 | loss: 0.0546183
	speed: 0.0499s/iter; left time: 2255.7958s
	iters: 400, epoch: 4 | loss: 0.1139903
	speed: 0.0554s/iter; left time: 2499.2424s
Epoch: 4 cost time: 25.649468898773193
Epoch: 4, Steps: 469 | Train Loss: 0.155 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.937390 --> -0.952256).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0406636
	speed: 0.2808s/iter; left time: 12614.3704s
	iters: 200, epoch: 5 | loss: 0.0440997
	speed: 0.0495s/iter; left time: 2219.5142s
	iters: 300, epoch: 5 | loss: 0.1273530
	speed: 0.0491s/iter; left time: 2194.0363s
	iters: 400, epoch: 5 | loss: 0.1042283
	speed: 0.0567s/iter; left time: 2530.9548s
Epoch: 5 cost time: 25.198426246643066
Epoch: 5, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0768863
	speed: 0.2879s/iter; left time: 12800.3950s
	iters: 200, epoch: 6 | loss: 0.0637802
	speed: 0.0523s/iter; left time: 2320.4506s
	iters: 300, epoch: 6 | loss: 0.1993208
	speed: 0.0543s/iter; left time: 2401.0425s
	iters: 400, epoch: 6 | loss: 0.0781712
	speed: 0.0562s/iter; left time: 2482.0229s
Epoch: 6 cost time: 26.691772937774658
Epoch: 6, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
Validation loss decreased (-0.952256 --> -0.961691).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1890602
	speed: 0.2699s/iter; left time: 11870.1083s
	iters: 200, epoch: 7 | loss: 0.0260051
	speed: 0.0545s/iter; left time: 2392.0240s
	iters: 300, epoch: 7 | loss: 0.1575871
	speed: 0.0516s/iter; left time: 2258.3239s
	iters: 400, epoch: 7 | loss: 0.0976033
	speed: 0.0524s/iter; left time: 2287.5496s
Epoch: 7 cost time: 25.941457509994507
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.961691 --> -0.961977).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0037662
	speed: 0.2806s/iter; left time: 12210.5524s
	iters: 200, epoch: 8 | loss: 0.1832910
	speed: 0.0545s/iter; left time: 2365.9296s
	iters: 300, epoch: 8 | loss: 0.0456429
	speed: 0.0506s/iter; left time: 2191.2339s
	iters: 400, epoch: 8 | loss: 0.0497079
	speed: 0.0521s/iter; left time: 2252.8141s
Epoch: 8 cost time: 25.876699209213257
Epoch: 8, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.961977 --> -0.967409).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0242237
	speed: 0.2705s/iter; left time: 11643.2862s
	iters: 200, epoch: 9 | loss: 0.0055715
	speed: 0.0574s/iter; left time: 2467.4032s
	iters: 300, epoch: 9 | loss: 0.0577655
	speed: 0.0517s/iter; left time: 2215.9167s
	iters: 400, epoch: 9 | loss: 0.0365562
	speed: 0.0507s/iter; left time: 2168.5056s
Epoch: 9 cost time: 25.236851692199707
Epoch: 9, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0228395
	speed: 0.2681s/iter; left time: 11416.1810s
	iters: 200, epoch: 10 | loss: 0.1620999
	speed: 0.0580s/iter; left time: 2464.4039s
	iters: 300, epoch: 10 | loss: 0.0470930
	speed: 0.0567s/iter; left time: 2401.2033s
	iters: 400, epoch: 10 | loss: 0.0251431
	speed: 0.0548s/iter; left time: 2317.3967s
Epoch: 10 cost time: 25.8565092086792
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0484420
	speed: 0.2833s/iter; left time: 11929.2020s
	iters: 200, epoch: 11 | loss: 0.0372791
	speed: 0.0604s/iter; left time: 2539.0810s
	iters: 300, epoch: 11 | loss: 0.0242609
	speed: 0.0550s/iter; left time: 2304.3984s
	iters: 400, epoch: 11 | loss: 0.0062947
	speed: 0.0543s/iter; left time: 2271.0617s
Epoch: 11 cost time: 26.755399227142334
Epoch: 11, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0202433
	speed: 0.2876s/iter; left time: 11974.6022s
	iters: 200, epoch: 12 | loss: 0.0219535
	speed: 0.0594s/iter; left time: 2468.7491s
	iters: 300, epoch: 12 | loss: 0.0148321
	speed: 0.0547s/iter; left time: 2265.4059s
	iters: 400, epoch: 12 | loss: 0.0943092
	speed: 0.0493s/iter; left time: 2040.0757s
Epoch: 12 cost time: 25.94831681251526
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 1.1756963
	speed: 0.2661s/iter; left time: 10954.1322s
	iters: 200, epoch: 13 | loss: 0.1052579
	speed: 0.0506s/iter; left time: 2077.7492s
	iters: 300, epoch: 13 | loss: 0.2561744
	speed: 0.0504s/iter; left time: 2063.2425s
	iters: 400, epoch: 13 | loss: 0.1559431
	speed: 0.0496s/iter; left time: 2027.6235s
Epoch: 13 cost time: 23.807088375091553
Epoch: 13, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.967409 --> -0.967694).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0061126
	speed: 0.2764s/iter; left time: 11250.1058s
	iters: 200, epoch: 14 | loss: 0.0403504
	speed: 0.0525s/iter; left time: 2130.3081s
	iters: 300, epoch: 14 | loss: 0.0544386
	speed: 0.0554s/iter; left time: 2244.0217s
	iters: 400, epoch: 14 | loss: 0.2892795
	speed: 0.0523s/iter; left time: 2111.8784s
Epoch: 14 cost time: 24.973954916000366
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.967694 --> -0.969410).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0024017
	speed: 0.2745s/iter; left time: 11044.5504s
	iters: 200, epoch: 15 | loss: 0.0091547
	speed: 0.0502s/iter; left time: 2015.6098s
	iters: 300, epoch: 15 | loss: 0.0722613
	speed: 0.0578s/iter; left time: 2313.4797s
	iters: 400, epoch: 15 | loss: 0.4717864
	speed: 0.0510s/iter; left time: 2034.9702s
Epoch: 15 cost time: 24.51351237297058
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0542670
	speed: 0.2698s/iter; left time: 10727.2750s
	iters: 200, epoch: 16 | loss: 0.0283777
	speed: 0.0519s/iter; left time: 2057.5802s
	iters: 300, epoch: 16 | loss: 0.0699149
	speed: 0.0547s/iter; left time: 2162.5350s
	iters: 400, epoch: 16 | loss: 0.0277902
	speed: 0.0591s/iter; left time: 2333.0895s
Epoch: 16 cost time: 25.701483488082886
Epoch: 16, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.969410 --> -0.976271).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1427952
	speed: 0.2814s/iter; left time: 11059.5303s
	iters: 200, epoch: 17 | loss: 0.0142043
	speed: 0.0548s/iter; left time: 2148.4497s
	iters: 300, epoch: 17 | loss: 0.0066214
	speed: 0.0587s/iter; left time: 2295.6143s
	iters: 400, epoch: 17 | loss: 0.0127253
	speed: 0.0557s/iter; left time: 2172.8947s
Epoch: 17 cost time: 26.217827796936035
Epoch: 17, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0231659
	speed: 0.2820s/iter; left time: 10950.4013s
	iters: 200, epoch: 18 | loss: 0.1266757
	speed: 0.0539s/iter; left time: 2087.9956s
	iters: 300, epoch: 18 | loss: 0.0072746
	speed: 0.0595s/iter; left time: 2299.8016s
	iters: 400, epoch: 18 | loss: 0.0036430
	speed: 0.0502s/iter; left time: 1935.3646s
Epoch: 18 cost time: 25.426012992858887
Epoch: 18, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0450281
	speed: 0.2632s/iter; left time: 10097.5617s
	iters: 200, epoch: 19 | loss: 0.0003659
	speed: 0.0516s/iter; left time: 1976.0678s
	iters: 300, epoch: 19 | loss: 0.0350850
	speed: 0.0532s/iter; left time: 2030.3408s
	iters: 400, epoch: 19 | loss: 0.0072074
	speed: 0.0561s/iter; left time: 2134.9336s
Epoch: 19 cost time: 24.92303228378296
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.2867414
	speed: 0.2643s/iter; left time: 10012.9208s
	iters: 200, epoch: 20 | loss: 0.0456771
	speed: 0.0502s/iter; left time: 1895.7147s
	iters: 300, epoch: 20 | loss: 0.0028178
	speed: 0.0526s/iter; left time: 1981.5276s
	iters: 400, epoch: 20 | loss: 0.0809065
	speed: 0.0563s/iter; left time: 2117.4533s
Epoch: 20 cost time: 25.257137298583984
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.2857749
	speed: 0.2807s/iter; left time: 10503.2959s
	iters: 200, epoch: 21 | loss: 0.0103176
	speed: 0.0523s/iter; left time: 1950.5436s
	iters: 300, epoch: 21 | loss: 0.0481680
	speed: 0.0525s/iter; left time: 1952.6458s
	iters: 400, epoch: 21 | loss: 0.0439720
	speed: 0.0576s/iter; left time: 2138.1442s
Epoch: 21 cost time: 25.761333227157593
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.976271 --> -0.978272).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4997334
	speed: 0.2716s/iter; left time: 10034.3380s
	iters: 200, epoch: 22 | loss: 0.0458805
	speed: 0.0571s/iter; left time: 2105.7458s
	iters: 300, epoch: 22 | loss: 0.0381267
	speed: 0.0525s/iter; left time: 1930.5080s
	iters: 400, epoch: 22 | loss: 0.0031825
	speed: 0.0561s/iter; left time: 2057.6229s
Epoch: 22 cost time: 26.820160150527954
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0113247
	speed: 0.2808s/iter; left time: 10243.8268s
	iters: 200, epoch: 23 | loss: 0.0273908
	speed: 0.0536s/iter; left time: 1951.2116s
	iters: 300, epoch: 23 | loss: 0.0144144
	speed: 0.0553s/iter; left time: 2005.1848s
	iters: 400, epoch: 23 | loss: 0.2548605
	speed: 0.0549s/iter; left time: 1988.1175s
Epoch: 23 cost time: 26.409462451934814
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0263261
	speed: 0.2749s/iter; left time: 9900.4091s
	iters: 200, epoch: 24 | loss: 0.0030369
	speed: 0.0523s/iter; left time: 1877.6635s
	iters: 300, epoch: 24 | loss: 0.0513896
	speed: 0.0512s/iter; left time: 1832.8839s
	iters: 400, epoch: 24 | loss: 0.0037101
	speed: 0.0553s/iter; left time: 1975.7981s
Epoch: 24 cost time: 25.74156904220581
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0052719
	speed: 0.2732s/iter; left time: 9710.6894s
	iters: 200, epoch: 25 | loss: 0.0103457
	speed: 0.0520s/iter; left time: 1842.6271s
	iters: 300, epoch: 25 | loss: 0.0093262
	speed: 0.0504s/iter; left time: 1781.4079s
	iters: 400, epoch: 25 | loss: 0.0061973
	speed: 0.0517s/iter; left time: 1821.2439s
Epoch: 25 cost time: 25.196043252944946
Epoch: 25, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0745845
	speed: 0.2676s/iter; left time: 9385.5438s
	iters: 200, epoch: 26 | loss: 1.0491724
	speed: 0.0479s/iter; left time: 1673.7893s
	iters: 300, epoch: 26 | loss: 0.0646577
	speed: 0.0430s/iter; left time: 1500.6048s
	iters: 400, epoch: 26 | loss: 0.0984673
	speed: 0.0465s/iter; left time: 1618.8214s
Epoch: 26 cost time: 22.977432250976562
Epoch: 26, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0521074
	speed: 0.2672s/iter; left time: 9245.4439s
	iters: 200, epoch: 27 | loss: 0.0387827
	speed: 0.0556s/iter; left time: 1920.0748s
	iters: 300, epoch: 27 | loss: 0.0004129
	speed: 0.0529s/iter; left time: 1819.2739s
	iters: 400, epoch: 27 | loss: 0.0227484
	speed: 0.0535s/iter; left time: 1835.1495s
Epoch: 27 cost time: 25.870691061019897
Epoch: 27, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0010681
	speed: 0.2751s/iter; left time: 9389.8097s
	iters: 200, epoch: 28 | loss: 0.0056035
	speed: 0.0458s/iter; left time: 1559.4953s
	iters: 300, epoch: 28 | loss: 0.0694854
	speed: 0.0488s/iter; left time: 1657.3600s
	iters: 400, epoch: 28 | loss: 0.0002080
	speed: 0.0527s/iter; left time: 1784.0703s
Epoch: 28 cost time: 24.048272371292114
Epoch: 28, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.1806741
	speed: 0.2878s/iter; left time: 9691.2048s
	iters: 200, epoch: 29 | loss: 0.0048058
	speed: 0.0534s/iter; left time: 1791.8116s
	iters: 300, epoch: 29 | loss: 0.0064787
	speed: 0.0506s/iter; left time: 1693.5279s
	iters: 400, epoch: 29 | loss: 0.0033754
	speed: 0.0490s/iter; left time: 1636.0345s
Epoch: 29 cost time: 24.721269369125366
Epoch: 29, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0211599
	speed: 0.2746s/iter; left time: 9115.5099s
	iters: 200, epoch: 30 | loss: 0.0060278
	speed: 0.0507s/iter; left time: 1678.3751s
	iters: 300, epoch: 30 | loss: 0.0698409
	speed: 0.0497s/iter; left time: 1639.0475s
	iters: 400, epoch: 30 | loss: 0.0037011
	speed: 0.0492s/iter; left time: 1617.8598s
Epoch: 30 cost time: 24.42222309112549
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0017151
	speed: 0.2733s/iter; left time: 8943.9280s
	iters: 200, epoch: 31 | loss: 0.0035097
	speed: 0.0494s/iter; left time: 1611.8786s
	iters: 300, epoch: 31 | loss: 0.0051164
	speed: 0.0463s/iter; left time: 1506.9018s
	iters: 400, epoch: 31 | loss: 0.0581492
	speed: 0.0498s/iter; left time: 1616.5972s
Epoch: 31 cost time: 23.809365034103394
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 15994
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7177637
	speed: 0.0687s/iter; left time: 3217.1478s
	iters: 200, epoch: 1 | loss: 0.9693233
	speed: 0.0525s/iter; left time: 2453.6176s
	iters: 300, epoch: 1 | loss: 0.4426671
	speed: 0.0512s/iter; left time: 2387.6841s
	iters: 400, epoch: 1 | loss: 0.3695873
	speed: 0.0466s/iter; left time: 2165.1611s
Epoch: 1 cost time: 25.289010286331177
Epoch: 1, Steps: 469 | Train Loss: 1.100 Vali Loss: 0.502 Vali Acc: 0.845 Test Loss: 0.502 Test Acc: 0.845
Validation loss decreased (inf --> -0.845049).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2984661
	speed: 0.2689s/iter; left time: 12457.1328s
	iters: 200, epoch: 2 | loss: 0.2130315
	speed: 0.0518s/iter; left time: 2394.1622s
	iters: 300, epoch: 2 | loss: 0.3608052
	speed: 0.0548s/iter; left time: 2529.2335s
	iters: 400, epoch: 2 | loss: 0.0712574
	speed: 0.0478s/iter; left time: 2199.4357s
Epoch: 2 cost time: 24.034977197647095
Epoch: 2, Steps: 469 | Train Loss: 0.320 Vali Loss: 0.292 Vali Acc: 0.920 Test Loss: 0.292 Test Acc: 0.920
Validation loss decreased (-0.845049 --> -0.920237).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1789044
	speed: 0.2647s/iter; left time: 12139.9941s
	iters: 200, epoch: 3 | loss: 0.5242316
	speed: 0.0508s/iter; left time: 2324.5605s
	iters: 300, epoch: 3 | loss: 0.3860113
	speed: 0.0536s/iter; left time: 2449.5298s
	iters: 400, epoch: 3 | loss: 0.2710888
	speed: 0.0474s/iter; left time: 2158.9046s
Epoch: 3 cost time: 24.000654697418213
Epoch: 3, Steps: 469 | Train Loss: 0.195 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.920237 --> -0.940535).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0610920
	speed: 0.2570s/iter; left time: 11666.9890s
	iters: 200, epoch: 4 | loss: 0.0436189
	speed: 0.0479s/iter; left time: 2169.8602s
	iters: 300, epoch: 4 | loss: 0.1481121
	speed: 0.0490s/iter; left time: 2214.9584s
	iters: 400, epoch: 4 | loss: 0.2600356
	speed: 0.0522s/iter; left time: 2353.9967s
Epoch: 4 cost time: 23.353466033935547
Epoch: 4, Steps: 469 | Train Loss: 0.145 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.940535 --> -0.956259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0919115
	speed: 0.2548s/iter; left time: 11446.0564s
	iters: 200, epoch: 5 | loss: 0.0619429
	speed: 0.0472s/iter; left time: 2116.2590s
	iters: 300, epoch: 5 | loss: 0.0701078
	speed: 0.0472s/iter; left time: 2108.8800s
	iters: 400, epoch: 5 | loss: 0.0741251
	speed: 0.0518s/iter; left time: 2310.8274s
Epoch: 5 cost time: 23.43693518638611
Epoch: 5, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.956259 --> -0.961405).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0549994
	speed: 0.2598s/iter; left time: 11550.1647s
	iters: 200, epoch: 6 | loss: 0.0709028
	speed: 0.0468s/iter; left time: 2074.9210s
	iters: 300, epoch: 6 | loss: 0.3198976
	speed: 0.0507s/iter; left time: 2242.8839s
	iters: 400, epoch: 6 | loss: 0.1096759
	speed: 0.0501s/iter; left time: 2212.7027s
Epoch: 6 cost time: 23.46686100959778
Epoch: 6, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.961405 --> -0.972269).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2024782
	speed: 0.2552s/iter; left time: 11225.2102s
	iters: 200, epoch: 7 | loss: 0.0179365
	speed: 0.0495s/iter; left time: 2170.6175s
	iters: 300, epoch: 7 | loss: 0.1650967
	speed: 0.0461s/iter; left time: 2019.0033s
	iters: 400, epoch: 7 | loss: 0.0667732
	speed: 0.0495s/iter; left time: 2163.1134s
Epoch: 7 cost time: 23.663376331329346
Epoch: 7, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0047883
	speed: 0.2639s/iter; left time: 11484.0271s
	iters: 200, epoch: 8 | loss: 0.1080674
	speed: 0.0634s/iter; left time: 2753.2537s
	iters: 300, epoch: 8 | loss: 0.0082845
	speed: 0.0625s/iter; left time: 2705.8543s
	iters: 400, epoch: 8 | loss: 0.0587857
	speed: 0.0593s/iter; left time: 2561.7561s
Epoch: 8 cost time: 26.39026927947998
Epoch: 8, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.975413).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0330769
	speed: 0.1828s/iter; left time: 7867.7599s
	iters: 200, epoch: 9 | loss: 0.0548298
	speed: 0.0477s/iter; left time: 2050.5971s
	iters: 300, epoch: 9 | loss: 0.0412486
	speed: 0.0509s/iter; left time: 2179.1148s
	iters: 400, epoch: 9 | loss: 0.0055437
	speed: 0.0483s/iter; left time: 2065.9033s
Epoch: 9 cost time: 22.062829971313477
Epoch: 9, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0093585
	speed: 0.2415s/iter; left time: 10282.5708s
	iters: 200, epoch: 10 | loss: 0.0661114
	speed: 0.0477s/iter; left time: 2027.6987s
	iters: 300, epoch: 10 | loss: 0.0582855
	speed: 0.0526s/iter; left time: 2229.2703s
	iters: 400, epoch: 10 | loss: 0.0528834
	speed: 0.0452s/iter; left time: 1912.4247s
Epoch: 10 cost time: 22.317067623138428
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0449193
	speed: 0.2368s/iter; left time: 9971.3997s
	iters: 200, epoch: 11 | loss: 0.0157742
	speed: 0.0457s/iter; left time: 1920.3859s
	iters: 300, epoch: 11 | loss: 0.1246290
	speed: 0.0498s/iter; left time: 2089.2388s
	iters: 400, epoch: 11 | loss: 0.0735663
	speed: 0.0490s/iter; left time: 2049.2329s
Epoch: 11 cost time: 22.33764934539795
Epoch: 11, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.975413 --> -0.975413).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0111091
	speed: 0.2295s/iter; left time: 9558.0553s
	iters: 200, epoch: 12 | loss: 0.0156741
	speed: 0.0467s/iter; left time: 1939.8353s
	iters: 300, epoch: 12 | loss: 0.0021980
	speed: 0.0423s/iter; left time: 1754.0120s
	iters: 400, epoch: 12 | loss: 0.0673881
	speed: 0.0473s/iter; left time: 1956.2487s
Epoch: 12 cost time: 22.36313819885254
Epoch: 12, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 1.0337131
	speed: 0.2463s/iter; left time: 10139.3898s
	iters: 200, epoch: 13 | loss: 0.1635241
	speed: 0.0468s/iter; left time: 1922.5383s
	iters: 300, epoch: 13 | loss: 0.1485622
	speed: 0.0456s/iter; left time: 1867.0594s
	iters: 400, epoch: 13 | loss: 0.1221781
	speed: 0.0506s/iter; left time: 2066.7235s
Epoch: 13 cost time: 23.647880792617798
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.1262479
	speed: 0.2562s/iter; left time: 10428.6445s
	iters: 200, epoch: 14 | loss: 0.0070282
	speed: 0.0443s/iter; left time: 1798.2823s
	iters: 300, epoch: 14 | loss: 0.0175758
	speed: 0.0460s/iter; left time: 1863.5646s
	iters: 400, epoch: 14 | loss: 0.1188089
	speed: 0.0462s/iter; left time: 1864.6562s
Epoch: 14 cost time: 22.653444051742554
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0065506
	speed: 0.2387s/iter; left time: 9603.9304s
	iters: 200, epoch: 15 | loss: 0.0027243
	speed: 0.0520s/iter; left time: 2087.6856s
	iters: 300, epoch: 15 | loss: 0.0183119
	speed: 0.0474s/iter; left time: 1899.3243s
	iters: 400, epoch: 15 | loss: 0.3766315
	speed: 0.0457s/iter; left time: 1826.0360s
Epoch: 15 cost time: 22.694897890090942
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.1842341
	speed: 0.2333s/iter; left time: 9277.8970s
	iters: 200, epoch: 16 | loss: 0.0375815
	speed: 0.0471s/iter; left time: 1866.7986s
	iters: 300, epoch: 16 | loss: 0.0321506
	speed: 0.0514s/iter; left time: 2031.9039s
	iters: 400, epoch: 16 | loss: 0.0176453
	speed: 0.0445s/iter; left time: 1756.4900s
Epoch: 16 cost time: 22.21724009513855
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0745647
	speed: 0.2421s/iter; left time: 9512.2094s
	iters: 200, epoch: 17 | loss: 0.0270862
	speed: 0.0473s/iter; left time: 1852.2055s
	iters: 300, epoch: 17 | loss: 0.0033566
	speed: 0.0492s/iter; left time: 1921.7321s
	iters: 400, epoch: 17 | loss: 0.0129222
	speed: 0.0503s/iter; left time: 1960.2522s
Epoch: 17 cost time: 23.01406216621399
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.975985).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.1340010
	speed: 0.2355s/iter; left time: 9144.5400s
	iters: 200, epoch: 18 | loss: 0.0869061
	speed: 0.0469s/iter; left time: 1817.2096s
	iters: 300, epoch: 18 | loss: 0.0847132
	speed: 0.0469s/iter; left time: 1813.2617s
	iters: 400, epoch: 18 | loss: 0.0034762
	speed: 0.0488s/iter; left time: 1878.6703s
Epoch: 18 cost time: 22.532798528671265
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976557).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0866047
	speed: 0.2418s/iter; left time: 9276.9452s
	iters: 200, epoch: 19 | loss: 0.0022026
	speed: 0.0473s/iter; left time: 1810.2459s
	iters: 300, epoch: 19 | loss: 0.0227018
	speed: 0.0460s/iter; left time: 1754.6623s
	iters: 400, epoch: 19 | loss: 0.0140717
	speed: 0.0512s/iter; left time: 1947.2783s
Epoch: 19 cost time: 23.78877878189087
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.1181297
	speed: 0.2467s/iter; left time: 9346.0655s
	iters: 200, epoch: 20 | loss: 0.0024734
	speed: 0.0479s/iter; left time: 1810.4203s
	iters: 300, epoch: 20 | loss: 0.0019774
	speed: 0.0441s/iter; left time: 1662.1674s
	iters: 400, epoch: 20 | loss: 0.1591452
	speed: 0.0517s/iter; left time: 1941.8269s
Epoch: 20 cost time: 23.154340744018555
Epoch: 20, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.2123776
	speed: 0.2496s/iter; left time: 9341.3915s
	iters: 200, epoch: 21 | loss: 0.0591934
	speed: 0.0497s/iter; left time: 1853.9998s
	iters: 300, epoch: 21 | loss: 0.1150556
	speed: 0.0486s/iter; left time: 1809.3343s
	iters: 400, epoch: 21 | loss: 0.1412925
	speed: 0.0493s/iter; left time: 1828.2979s
Epoch: 21 cost time: 23.9168918132782
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.979988).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.4608141
	speed: 0.2370s/iter; left time: 8756.1828s
	iters: 200, epoch: 22 | loss: 0.0988115
	speed: 0.0484s/iter; left time: 1783.2115s
	iters: 300, epoch: 22 | loss: 0.0323429
	speed: 0.0476s/iter; left time: 1748.8680s
	iters: 400, epoch: 22 | loss: 0.0029720
	speed: 0.0465s/iter; left time: 1702.6609s
Epoch: 22 cost time: 23.290797233581543
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0065635
	speed: 0.2315s/iter; left time: 8444.9379s
	iters: 200, epoch: 23 | loss: 0.0172982
	speed: 0.0421s/iter; left time: 1532.0179s
	iters: 300, epoch: 23 | loss: 0.0551769
	speed: 0.0405s/iter; left time: 1470.6186s
	iters: 400, epoch: 23 | loss: 0.3205554
	speed: 0.0425s/iter; left time: 1536.0772s
Epoch: 23 cost time: 20.247764348983765
Epoch: 23, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980559).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0326353
	speed: 0.2299s/iter; left time: 8280.2227s
	iters: 200, epoch: 24 | loss: 0.0368617
	speed: 0.0423s/iter; left time: 1519.5509s
	iters: 300, epoch: 24 | loss: 0.0898137
	speed: 0.0422s/iter; left time: 1510.2638s
	iters: 400, epoch: 24 | loss: 0.0019319
	speed: 0.0413s/iter; left time: 1474.7672s
Epoch: 24 cost time: 20.213066577911377
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0195065
	speed: 0.2311s/iter; left time: 8213.8458s
	iters: 200, epoch: 25 | loss: 0.0036589
	speed: 0.0432s/iter; left time: 1529.7896s
	iters: 300, epoch: 25 | loss: 0.0043894
	speed: 0.0445s/iter; left time: 1572.8550s
	iters: 400, epoch: 25 | loss: 0.0016058
	speed: 0.0497s/iter; left time: 1750.9386s
Epoch: 25 cost time: 21.528197526931763
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0094391
	speed: 0.2459s/iter; left time: 8624.2826s
	iters: 200, epoch: 26 | loss: 0.9468386
	speed: 0.0441s/iter; left time: 1542.0502s
	iters: 300, epoch: 26 | loss: 0.0354516
	speed: 0.0458s/iter; left time: 1595.9387s
	iters: 400, epoch: 26 | loss: 0.0104754
	speed: 0.0492s/iter; left time: 1710.4143s
Epoch: 26 cost time: 22.103485584259033
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2594283
	speed: 0.2434s/iter; left time: 8421.6723s
	iters: 200, epoch: 27 | loss: 0.0087915
	speed: 0.0437s/iter; left time: 1509.0373s
	iters: 300, epoch: 27 | loss: 0.0016713
	speed: 0.0457s/iter; left time: 1571.6168s
	iters: 400, epoch: 27 | loss: 0.0026571
	speed: 0.0493s/iter; left time: 1690.1053s
Epoch: 27 cost time: 21.840868711471558
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.980559 --> -0.982561).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0012404
	speed: 0.2365s/iter; left time: 8072.7463s
	iters: 200, epoch: 28 | loss: 0.0063456
	speed: 0.0419s/iter; left time: 1426.9266s
	iters: 300, epoch: 28 | loss: 0.0376833
	speed: 0.0431s/iter; left time: 1461.4962s
	iters: 400, epoch: 28 | loss: 0.0006965
	speed: 0.0459s/iter; left time: 1554.7850s
Epoch: 28 cost time: 21.755465745925903
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.1568572
	speed: 0.2411s/iter; left time: 8116.1660s
	iters: 200, epoch: 29 | loss: 0.0387606
	speed: 0.0444s/iter; left time: 1490.6560s
	iters: 300, epoch: 29 | loss: 0.0386141
	speed: 0.0427s/iter; left time: 1427.5291s
	iters: 400, epoch: 29 | loss: 0.0133107
	speed: 0.0449s/iter; left time: 1497.4206s
Epoch: 29 cost time: 21.40029501914978
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.2696472
	speed: 0.2386s/iter; left time: 7921.1551s
	iters: 200, epoch: 30 | loss: 0.0008866
	speed: 0.0459s/iter; left time: 1518.3843s
	iters: 300, epoch: 30 | loss: 0.1082481
	speed: 0.0418s/iter; left time: 1377.9505s
	iters: 400, epoch: 30 | loss: 0.0099596
	speed: 0.0445s/iter; left time: 1463.5920s
Epoch: 30 cost time: 21.113386392593384
Epoch: 30, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.1303582
	speed: 0.2293s/iter; left time: 7505.8802s
	iters: 200, epoch: 31 | loss: 0.0090399
	speed: 0.0422s/iter; left time: 1378.4816s
	iters: 300, epoch: 31 | loss: 0.0010294
	speed: 0.0466s/iter; left time: 1516.5885s
	iters: 400, epoch: 31 | loss: 0.0153049
	speed: 0.0435s/iter; left time: 1410.9869s
Epoch: 31 cost time: 21.098989963531494
Epoch: 31, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0041431
	speed: 0.2474s/iter; left time: 7982.3091s
	iters: 200, epoch: 32 | loss: 0.0065221
	speed: 0.0432s/iter; left time: 1388.1992s
	iters: 300, epoch: 32 | loss: 0.0020014
	speed: 0.0482s/iter; left time: 1545.7655s
	iters: 400, epoch: 32 | loss: 0.3733944
	speed: 0.0494s/iter; left time: 1577.3651s
Epoch: 32 cost time: 22.280747890472412
Epoch: 32, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0050045
	speed: 0.2469s/iter; left time: 7850.0910s
	iters: 200, epoch: 33 | loss: 0.0144588
	speed: 0.0450s/iter; left time: 1427.1230s
	iters: 300, epoch: 33 | loss: 0.0069763
	speed: 0.0475s/iter; left time: 1500.8641s
	iters: 400, epoch: 33 | loss: 0.0012554
	speed: 0.0482s/iter; left time: 1516.9516s
Epoch: 33 cost time: 22.249345302581787
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0627229
	speed: 0.2363s/iter; left time: 7403.2685s
	iters: 200, epoch: 34 | loss: 0.0327451
	speed: 0.0450s/iter; left time: 1404.5268s
	iters: 300, epoch: 34 | loss: 0.1019803
	speed: 0.0423s/iter; left time: 1317.6717s
	iters: 400, epoch: 34 | loss: 0.0015128
	speed: 0.0505s/iter; left time: 1566.8351s
Epoch: 34 cost time: 21.86708092689514
Epoch: 34, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0198739
	speed: 0.2296s/iter; left time: 7084.7846s
	iters: 200, epoch: 35 | loss: 0.0127836
	speed: 0.0405s/iter; left time: 1245.9763s
	iters: 300, epoch: 35 | loss: 0.2404323
	speed: 0.0390s/iter; left time: 1196.1400s
	iters: 400, epoch: 35 | loss: 0.0021656
	speed: 0.0425s/iter; left time: 1298.8844s
Epoch: 35 cost time: 20.367026805877686
Epoch: 35, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0096183
	speed: 0.2538s/iter; left time: 7710.8497s
	iters: 200, epoch: 36 | loss: 0.0063854
	speed: 0.0475s/iter; left time: 1439.4381s
	iters: 300, epoch: 36 | loss: 0.0021525
	speed: 0.0449s/iter; left time: 1355.7893s
	iters: 400, epoch: 36 | loss: 0.0772495
	speed: 0.0450s/iter; left time: 1354.0767s
Epoch: 36 cost time: 22.30146026611328
Epoch: 36, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0031443
	speed: 0.2439s/iter; left time: 7298.0040s
	iters: 200, epoch: 37 | loss: 0.0080918
	speed: 0.0471s/iter; left time: 1403.3068s
	iters: 300, epoch: 37 | loss: 0.0037640
	speed: 0.0503s/iter; left time: 1494.2006s
	iters: 400, epoch: 37 | loss: 0.0002726
	speed: 0.0487s/iter; left time: 1441.6283s
Epoch: 37 cost time: 23.01667332649231
Epoch: 37, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 15994
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3809207
	speed: 0.0532s/iter; left time: 2490.5188s
	iters: 200, epoch: 1 | loss: 0.1705016
	speed: 0.0348s/iter; left time: 1624.4407s
	iters: 300, epoch: 1 | loss: 0.0331535
	speed: 0.0334s/iter; left time: 1556.8558s
	iters: 400, epoch: 1 | loss: 0.0370560
	speed: 0.0315s/iter; left time: 1465.9080s
Epoch: 1 cost time: 17.45480489730835
Epoch: 1, Steps: 469 | Train Loss: 0.336 Vali Loss: 0.343 Vali Acc: 0.899 Test Loss: 0.343 Test Acc: 0.899
Validation loss decreased (inf --> -0.898510).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0112321
	speed: 0.1785s/iter; left time: 8268.6534s
	iters: 200, epoch: 2 | loss: 0.0833938
	speed: 0.0328s/iter; left time: 1516.7495s
	iters: 300, epoch: 2 | loss: 0.0500107
	speed: 0.0288s/iter; left time: 1329.5072s
	iters: 400, epoch: 2 | loss: 0.2069739
	speed: 0.0316s/iter; left time: 1452.9789s
Epoch: 2 cost time: 15.610233306884766
Epoch: 2, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.898510 --> -0.957688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0602648
	speed: 0.1742s/iter; left time: 7989.4710s
	iters: 200, epoch: 3 | loss: 0.0518202
	speed: 0.0309s/iter; left time: 1415.8902s
	iters: 300, epoch: 3 | loss: 0.0056951
	speed: 0.0278s/iter; left time: 1269.8506s
	iters: 400, epoch: 3 | loss: 0.0058914
	speed: 0.0297s/iter; left time: 1353.8719s
Epoch: 3 cost time: 14.749614238739014
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
Validation loss decreased (-0.957688 --> -0.963692).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2632485
	speed: 0.1790s/iter; left time: 8125.4057s
	iters: 200, epoch: 4 | loss: 0.0077410
	speed: 0.0281s/iter; left time: 1274.8787s
	iters: 300, epoch: 4 | loss: 0.0329291
	speed: 0.0260s/iter; left time: 1174.4546s
	iters: 400, epoch: 4 | loss: 0.0364215
	speed: 0.0351s/iter; left time: 1581.4179s
Epoch: 4 cost time: 14.57487440109253
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.945 Test Loss: 0.246 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0030890
	speed: 0.1683s/iter; left time: 7562.5218s
	iters: 200, epoch: 5 | loss: 0.0151284
	speed: 0.0346s/iter; left time: 1550.6909s
	iters: 300, epoch: 5 | loss: 0.0003444
	speed: 0.0342s/iter; left time: 1530.4004s
	iters: 400, epoch: 5 | loss: 0.0135382
	speed: 0.0315s/iter; left time: 1403.7928s
Epoch: 5 cost time: 15.723769664764404
Epoch: 5, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.963692 --> -0.973126).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0043047
	speed: 0.1690s/iter; left time: 7510.9118s
	iters: 200, epoch: 6 | loss: 0.0128779
	speed: 0.0356s/iter; left time: 1577.3927s
	iters: 300, epoch: 6 | loss: 0.1513185
	speed: 0.0304s/iter; left time: 1344.8237s
	iters: 400, epoch: 6 | loss: 0.0436165
	speed: 0.0319s/iter; left time: 1406.4433s
Epoch: 6 cost time: 15.87672734260559
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0006197
	speed: 0.1676s/iter; left time: 7370.8969s
	iters: 200, epoch: 7 | loss: 0.0165718
	speed: 0.0279s/iter; left time: 1225.0906s
	iters: 300, epoch: 7 | loss: 0.0003549
	speed: 0.0299s/iter; left time: 1309.3668s
	iters: 400, epoch: 7 | loss: 0.0002559
	speed: 0.0286s/iter; left time: 1248.6284s
Epoch: 7 cost time: 13.719948291778564
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1472868
	speed: 0.1775s/iter; left time: 7725.6468s
	iters: 200, epoch: 8 | loss: 0.0003132
	speed: 0.0303s/iter; left time: 1315.6982s
	iters: 300, epoch: 8 | loss: 0.0000384
	speed: 0.0319s/iter; left time: 1383.2587s
	iters: 400, epoch: 8 | loss: 0.0000435
	speed: 0.0317s/iter; left time: 1369.9835s
Epoch: 8 cost time: 15.08445405960083
Epoch: 8, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0924489
	speed: 0.1773s/iter; left time: 7631.1035s
	iters: 200, epoch: 9 | loss: 0.0176953
	speed: 0.0342s/iter; left time: 1467.4830s
	iters: 300, epoch: 9 | loss: 0.0295232
	speed: 0.0327s/iter; left time: 1401.5423s
	iters: 400, epoch: 9 | loss: 0.0006988
	speed: 0.0365s/iter; left time: 1558.5426s
Epoch: 9 cost time: 16.460683822631836
Epoch: 9, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0018948
	speed: 0.1739s/iter; left time: 7403.3392s
	iters: 200, epoch: 10 | loss: 0.0073583
	speed: 0.0354s/iter; left time: 1505.4512s
	iters: 300, epoch: 10 | loss: 0.0118613
	speed: 0.0365s/iter; left time: 1548.9812s
	iters: 400, epoch: 10 | loss: 0.0003602
	speed: 0.0327s/iter; left time: 1381.6330s
Epoch: 10 cost time: 16.22176194190979
Epoch: 10, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0007657
	speed: 0.1803s/iter; left time: 7590.9423s
	iters: 200, epoch: 11 | loss: 0.0152528
	speed: 0.0329s/iter; left time: 1382.3015s
	iters: 300, epoch: 11 | loss: 0.0037981
	speed: 0.0312s/iter; left time: 1306.9615s
	iters: 400, epoch: 11 | loss: 0.0051393
	speed: 0.0302s/iter; left time: 1263.1375s
Epoch: 11 cost time: 15.585424900054932
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.974270).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006095
	speed: 0.1748s/iter; left time: 7279.5266s
	iters: 200, epoch: 12 | loss: 0.0386772
	speed: 0.0287s/iter; left time: 1193.9848s
	iters: 300, epoch: 12 | loss: 0.7812124
	speed: 0.0292s/iter; left time: 1210.8152s
	iters: 400, epoch: 12 | loss: 0.1049180
	speed: 0.0301s/iter; left time: 1244.1087s
Epoch: 12 cost time: 14.448183059692383
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0285985
	speed: 0.1683s/iter; left time: 6929.8528s
	iters: 200, epoch: 13 | loss: 0.0932126
	speed: 0.0287s/iter; left time: 1177.6229s
	iters: 300, epoch: 13 | loss: 0.0034155
	speed: 0.0300s/iter; left time: 1227.8343s
	iters: 400, epoch: 13 | loss: 0.1210953
	speed: 0.0311s/iter; left time: 1269.1851s
Epoch: 13 cost time: 14.813852310180664
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0956395
	speed: 0.1755s/iter; left time: 7143.1266s
	iters: 200, epoch: 14 | loss: 0.0082705
	speed: 0.0309s/iter; left time: 1255.8511s
	iters: 300, epoch: 14 | loss: 0.0005527
	speed: 0.0338s/iter; left time: 1368.9469s
	iters: 400, epoch: 14 | loss: 0.0004342
	speed: 0.0341s/iter; left time: 1378.3823s
Epoch: 14 cost time: 15.427123308181763
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.276 Vali Acc: 0.955 Test Loss: 0.276 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0133953
	speed: 0.1673s/iter; left time: 6731.4365s
	iters: 200, epoch: 15 | loss: 0.0006943
	speed: 0.0354s/iter; left time: 1422.3249s
	iters: 300, epoch: 15 | loss: 0.1821582
	speed: 0.0325s/iter; left time: 1299.1581s
	iters: 400, epoch: 15 | loss: 0.0021864
	speed: 0.0316s/iter; left time: 1260.9213s
Epoch: 15 cost time: 15.998058557510376
Epoch: 15, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0379319
	speed: 0.1710s/iter; left time: 6798.8833s
	iters: 200, epoch: 16 | loss: 0.0198495
	speed: 0.0312s/iter; left time: 1236.7506s
	iters: 300, epoch: 16 | loss: 0.0024959
	speed: 0.0299s/iter; left time: 1184.1165s
	iters: 400, epoch: 16 | loss: 0.0225517
	speed: 0.0317s/iter; left time: 1252.3359s
Epoch: 16 cost time: 14.81029725074768
Epoch: 16, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0010961
	speed: 0.1831s/iter; left time: 7194.4349s
	iters: 200, epoch: 17 | loss: 0.0099704
	speed: 0.0293s/iter; left time: 1150.0440s
	iters: 300, epoch: 17 | loss: 0.0001152
	speed: 0.0296s/iter; left time: 1155.5241s
	iters: 400, epoch: 17 | loss: 0.0001182
	speed: 0.0287s/iter; left time: 1118.6755s
Epoch: 17 cost time: 14.490638732910156
Epoch: 17, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000084
	speed: 0.1776s/iter; left time: 6894.2111s
	iters: 200, epoch: 18 | loss: 0.0028541
	speed: 0.0316s/iter; left time: 1225.2442s
	iters: 300, epoch: 18 | loss: 0.2062666
	speed: 0.0311s/iter; left time: 1201.6797s
	iters: 400, epoch: 18 | loss: 0.1639849
	speed: 0.0338s/iter; left time: 1300.4173s
Epoch: 18 cost time: 15.697976112365723
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.193 Vali Acc: 0.966 Test Loss: 0.193 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000992
	speed: 0.1700s/iter; left time: 6520.4592s
	iters: 200, epoch: 19 | loss: 0.0039300
	speed: 0.0334s/iter; left time: 1277.6541s
	iters: 300, epoch: 19 | loss: 0.0023874
	speed: 0.0357s/iter; left time: 1362.5204s
	iters: 400, epoch: 19 | loss: 0.0000102
	speed: 0.0331s/iter; left time: 1259.7392s
Epoch: 19 cost time: 15.955233573913574
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0038619
	speed: 0.1703s/iter; left time: 6451.5845s
	iters: 200, epoch: 20 | loss: 0.0000616
	speed: 0.0338s/iter; left time: 1278.5399s
	iters: 300, epoch: 20 | loss: 0.0000313
	speed: 0.0294s/iter; left time: 1108.7491s
	iters: 400, epoch: 20 | loss: 0.0005199
	speed: 0.0305s/iter; left time: 1145.6382s
Epoch: 20 cost time: 14.989049673080444
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000894
	speed: 0.1775s/iter; left time: 6641.0829s
	iters: 200, epoch: 21 | loss: 0.0606190
	speed: 0.0294s/iter; left time: 1097.9223s
	iters: 300, epoch: 21 | loss: 0.0016770
	speed: 0.0313s/iter; left time: 1166.2768s
	iters: 400, epoch: 21 | loss: 0.0000214
	speed: 0.0299s/iter; left time: 1111.4053s
Epoch: 21 cost time: 14.825180053710938
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0058071
	speed: 0.1696s/iter; left time: 6266.9024s
	iters: 200, epoch: 22 | loss: 0.0000187
	speed: 0.0285s/iter; left time: 1048.6082s
	iters: 300, epoch: 22 | loss: 0.0156154
	speed: 0.0297s/iter; left time: 1090.4040s
	iters: 400, epoch: 22 | loss: 0.0013980
	speed: 0.0305s/iter; left time: 1116.5938s
Epoch: 22 cost time: 14.728652000427246
Epoch: 22, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.1106005
	speed: 0.1754s/iter; left time: 6399.0689s
	iters: 200, epoch: 23 | loss: 0.0590171
	speed: 0.0275s/iter; left time: 1001.6106s
	iters: 300, epoch: 23 | loss: 0.1681720
	speed: 0.0299s/iter; left time: 1085.1344s
	iters: 400, epoch: 23 | loss: 0.0000025
	speed: 0.0304s/iter; left time: 1099.2222s
Epoch: 23 cost time: 14.489615440368652
Epoch: 23, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001571
	speed: 0.1710s/iter; left time: 6159.9561s
	iters: 200, epoch: 24 | loss: 0.0002183
	speed: 0.0313s/iter; left time: 1125.6838s
	iters: 300, epoch: 24 | loss: 0.0001048
	speed: 0.0365s/iter; left time: 1307.6280s
	iters: 400, epoch: 24 | loss: 0.0501997
	speed: 0.0335s/iter; left time: 1194.6461s
Epoch: 24 cost time: 15.673721075057983
Epoch: 24, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.277 Vali Acc: 0.964 Test Loss: 0.277 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0000025
	speed: 0.1686s/iter; left time: 5993.2230s
	iters: 200, epoch: 25 | loss: 0.0037851
	speed: 0.0362s/iter; left time: 1283.5225s
	iters: 300, epoch: 25 | loss: 0.0000960
	speed: 0.0336s/iter; left time: 1186.0937s
	iters: 400, epoch: 25 | loss: 0.1905711
	speed: 0.0347s/iter; left time: 1223.5070s
Epoch: 25 cost time: 16.501972198486328
Epoch: 25, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0000329
	speed: 0.1733s/iter; left time: 6078.5413s
	iters: 200, epoch: 26 | loss: 0.0013876
	speed: 0.0308s/iter; left time: 1078.8262s
	iters: 300, epoch: 26 | loss: 0.0000995
	speed: 0.0286s/iter; left time: 997.1920s
	iters: 400, epoch: 26 | loss: 0.1166965
	speed: 0.0329s/iter; left time: 1145.5899s
Epoch: 26 cost time: 15.12645149230957
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.980 Test Loss: 0.159 Test Acc: 0.980
Validation loss decreased (-0.975699 --> -0.980273).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0003213
	speed: 0.1835s/iter; left time: 6350.8030s
	iters: 200, epoch: 27 | loss: 0.0013760
	speed: 0.0323s/iter; left time: 1113.8666s
	iters: 300, epoch: 27 | loss: 0.0000200
	speed: 0.0316s/iter; left time: 1087.2697s
	iters: 400, epoch: 27 | loss: 0.0081980
	speed: 0.0300s/iter; left time: 1030.2610s
Epoch: 27 cost time: 15.475625038146973
Epoch: 27, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0002515
	speed: 0.1766s/iter; left time: 6029.9224s
	iters: 200, epoch: 28 | loss: 0.6467134
	speed: 0.0321s/iter; left time: 1094.1250s
	iters: 300, epoch: 28 | loss: 0.0000929
	speed: 0.0322s/iter; left time: 1092.4362s
	iters: 400, epoch: 28 | loss: 0.0012635
	speed: 0.0320s/iter; left time: 1081.7918s
Epoch: 28 cost time: 15.125595808029175
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000418
	speed: 0.1421s/iter; left time: 4784.8437s
	iters: 200, epoch: 29 | loss: 0.3356913
	speed: 0.0339s/iter; left time: 1138.6618s
	iters: 300, epoch: 29 | loss: 0.0000012
	speed: 0.0344s/iter; left time: 1149.8528s
	iters: 400, epoch: 29 | loss: 0.0233697
	speed: 0.0318s/iter; left time: 1059.5611s
Epoch: 29 cost time: 15.432016134262085
Epoch: 29, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0096381
	speed: 0.1768s/iter; left time: 5870.4051s
	iters: 200, epoch: 30 | loss: 0.0001390
	speed: 0.0305s/iter; left time: 1010.1849s
	iters: 300, epoch: 30 | loss: 0.0016004
	speed: 0.0295s/iter; left time: 972.0716s
	iters: 400, epoch: 30 | loss: 0.0491104
	speed: 0.0269s/iter; left time: 884.1879s
Epoch: 30 cost time: 14.544575929641724
Epoch: 30, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.240 Vali Acc: 0.959 Test Loss: 0.240 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0275652
	speed: 0.1619s/iter; left time: 5298.2329s
	iters: 200, epoch: 31 | loss: 0.0000006
	speed: 0.0262s/iter; left time: 854.2088s
	iters: 300, epoch: 31 | loss: 0.0093625
	speed: 0.0263s/iter; left time: 856.0482s
	iters: 400, epoch: 31 | loss: 0.0000322
	speed: 0.0265s/iter; left time: 858.7738s
Epoch: 31 cost time: 12.805862188339233
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0107927
	speed: 0.1771s/iter; left time: 5713.9083s
	iters: 200, epoch: 32 | loss: 0.0536521
	speed: 0.0312s/iter; left time: 1004.9591s
	iters: 300, epoch: 32 | loss: 0.0017376
	speed: 0.0300s/iter; left time: 962.1880s
	iters: 400, epoch: 32 | loss: 0.0977494
	speed: 0.0364s/iter; left time: 1163.1616s
Epoch: 32 cost time: 15.714416265487671
Epoch: 32, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000712
	speed: 0.1674s/iter; left time: 5321.9770s
	iters: 200, epoch: 33 | loss: 0.6695606
	speed: 0.0355s/iter; left time: 1124.2357s
	iters: 300, epoch: 33 | loss: 0.0013868
	speed: 0.0363s/iter; left time: 1145.3980s
	iters: 400, epoch: 33 | loss: 0.0015295
	speed: 0.0332s/iter; left time: 1045.8995s
Epoch: 33 cost time: 16.412635564804077
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000060
	speed: 0.1757s/iter; left time: 5503.4272s
	iters: 200, epoch: 34 | loss: 0.0002157
	speed: 0.0319s/iter; left time: 995.5554s
	iters: 300, epoch: 34 | loss: 0.6372729
	speed: 0.0324s/iter; left time: 1007.6919s
	iters: 400, epoch: 34 | loss: 0.0000375
	speed: 0.0344s/iter; left time: 1067.1527s
Epoch: 34 cost time: 16.10817527770996
Epoch: 34, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.976 Test Loss: 0.169 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000033
	speed: 0.1815s/iter; left time: 5600.2659s
	iters: 200, epoch: 35 | loss: 0.0002035
	speed: 0.0340s/iter; left time: 1044.7579s
	iters: 300, epoch: 35 | loss: 0.0015465
	speed: 0.0314s/iter; left time: 963.0895s
	iters: 400, epoch: 35 | loss: 0.0001249
	speed: 0.0374s/iter; left time: 1142.2645s
Epoch: 35 cost time: 16.402995586395264
Epoch: 35, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0002231
	speed: 0.1747s/iter; left time: 5309.3630s
	iters: 200, epoch: 36 | loss: 0.0092207
	speed: 0.0364s/iter; left time: 1102.8220s
	iters: 300, epoch: 36 | loss: 0.9868266
	speed: 0.0388s/iter; left time: 1171.5952s
	iters: 400, epoch: 36 | loss: 0.0000069
	speed: 0.0339s/iter; left time: 1019.9131s
Epoch: 36 cost time: 17.186241388320923
Epoch: 36, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 2673698
model size : 19.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3696788
	speed: 0.0549s/iter; left time: 2567.5041s
	iters: 200, epoch: 1 | loss: 0.1940306
	speed: 0.0366s/iter; left time: 1706.9970s
	iters: 300, epoch: 1 | loss: 0.0368595
	speed: 0.0318s/iter; left time: 1479.8119s
	iters: 400, epoch: 1 | loss: 0.0370082
	speed: 0.0312s/iter; left time: 1452.9152s
Epoch: 1 cost time: 17.65493869781494
Epoch: 1, Steps: 469 | Train Loss: 0.335 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (inf --> -0.925955).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0228266
	speed: 0.1715s/iter; left time: 7944.5576s
	iters: 200, epoch: 2 | loss: 0.1220402
	speed: 0.0323s/iter; left time: 1495.0343s
	iters: 300, epoch: 2 | loss: 0.0857962
	speed: 0.0312s/iter; left time: 1441.1250s
	iters: 400, epoch: 2 | loss: 0.0507038
	speed: 0.0316s/iter; left time: 1454.5891s
Epoch: 2 cost time: 15.37242317199707
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
Validation loss decreased (-0.925955 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0069012
	speed: 0.1748s/iter; left time: 8016.2803s
	iters: 200, epoch: 3 | loss: 0.0060606
	speed: 0.0252s/iter; left time: 1154.0764s
	iters: 300, epoch: 3 | loss: 0.0218378
	speed: 0.0286s/iter; left time: 1304.6071s
	iters: 400, epoch: 3 | loss: 0.0013679
	speed: 0.0350s/iter; left time: 1592.4948s
Epoch: 3 cost time: 14.51099705696106
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
Validation loss decreased (-0.957974 --> -0.965121).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0640752
	speed: 0.1742s/iter; left time: 7909.8428s
	iters: 200, epoch: 4 | loss: 0.1647983
	speed: 0.0306s/iter; left time: 1388.1556s
	iters: 300, epoch: 4 | loss: 0.0053691
	speed: 0.0348s/iter; left time: 1573.8906s
	iters: 400, epoch: 4 | loss: 0.0941495
	speed: 0.0371s/iter; left time: 1674.7203s
Epoch: 4 cost time: 15.790114879608154
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0355107
	speed: 0.1550s/iter; left time: 6965.5209s
	iters: 200, epoch: 5 | loss: 0.0599563
	speed: 0.0327s/iter; left time: 1464.2897s
	iters: 300, epoch: 5 | loss: 0.0000421
	speed: 0.0360s/iter; left time: 1611.7684s
	iters: 400, epoch: 5 | loss: 0.0388187
	speed: 0.0327s/iter; left time: 1457.3988s
Epoch: 5 cost time: 15.494818687438965
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0120334
	speed: 0.1771s/iter; left time: 7871.2356s
	iters: 200, epoch: 6 | loss: 0.0281429
	speed: 0.0302s/iter; left time: 1340.0546s
	iters: 300, epoch: 6 | loss: 0.0918719
	speed: 0.0304s/iter; left time: 1347.4678s
	iters: 400, epoch: 6 | loss: 0.0016692
	speed: 0.0313s/iter; left time: 1383.7717s
Epoch: 6 cost time: 15.37217903137207
Epoch: 6, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.965121 --> -0.977700).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0303187
	speed: 0.1820s/iter; left time: 8004.9728s
	iters: 200, epoch: 7 | loss: 0.0055029
	speed: 0.0335s/iter; left time: 1469.0025s
	iters: 300, epoch: 7 | loss: 0.0661377
	speed: 0.0338s/iter; left time: 1478.4007s
	iters: 400, epoch: 7 | loss: 0.0000460
	speed: 0.0376s/iter; left time: 1640.7356s
Epoch: 7 cost time: 16.75841498374939
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1761938
	speed: 0.1746s/iter; left time: 7599.1090s
	iters: 200, epoch: 8 | loss: 0.0014214
	speed: 0.0377s/iter; left time: 1637.9714s
	iters: 300, epoch: 8 | loss: 0.0000844
	speed: 0.0358s/iter; left time: 1551.1070s
	iters: 400, epoch: 8 | loss: 0.0002668
	speed: 0.0320s/iter; left time: 1382.2932s
Epoch: 8 cost time: 16.78823709487915
Epoch: 8, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0201974
	speed: 0.1800s/iter; left time: 7747.4924s
	iters: 200, epoch: 9 | loss: 0.0052930
	speed: 0.0315s/iter; left time: 1351.5114s
	iters: 300, epoch: 9 | loss: 0.0002612
	speed: 0.0306s/iter; left time: 1313.2152s
	iters: 400, epoch: 9 | loss: 0.0002895
	speed: 0.0280s/iter; left time: 1197.4784s
Epoch: 9 cost time: 15.106294631958008
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2459391
	speed: 0.1741s/iter; left time: 7412.2265s
	iters: 200, epoch: 10 | loss: 0.0046504
	speed: 0.0323s/iter; left time: 1372.3357s
	iters: 300, epoch: 10 | loss: 0.0017705
	speed: 0.0312s/iter; left time: 1323.8047s
	iters: 400, epoch: 10 | loss: 0.0000166
	speed: 0.0311s/iter; left time: 1314.7525s
Epoch: 10 cost time: 15.318355321884155
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1505565
	speed: 0.1742s/iter; left time: 7337.2292s
	iters: 200, epoch: 11 | loss: 0.0035898
	speed: 0.0309s/iter; left time: 1297.6274s
	iters: 300, epoch: 11 | loss: 0.4055927
	speed: 0.0312s/iter; left time: 1307.4822s
	iters: 400, epoch: 11 | loss: 0.0027352
	speed: 0.0319s/iter; left time: 1332.4667s
Epoch: 11 cost time: 14.912500143051147
Epoch: 11, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000786
	speed: 0.1511s/iter; left time: 6292.5884s
	iters: 200, epoch: 12 | loss: 0.0708832
	speed: 0.0335s/iter; left time: 1392.1863s
	iters: 300, epoch: 12 | loss: 0.1207700
	speed: 0.0321s/iter; left time: 1328.8040s
	iters: 400, epoch: 12 | loss: 0.0029483
	speed: 0.0295s/iter; left time: 1218.4847s
Epoch: 12 cost time: 15.10947299003601
Epoch: 12, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0010041
	speed: 0.1754s/iter; left time: 7221.1977s
	iters: 200, epoch: 13 | loss: 0.0001557
	speed: 0.0316s/iter; left time: 1298.6484s
	iters: 300, epoch: 13 | loss: 0.0426244
	speed: 0.0310s/iter; left time: 1269.1537s
	iters: 400, epoch: 13 | loss: 0.0104621
	speed: 0.0280s/iter; left time: 1143.4171s
Epoch: 13 cost time: 14.695850372314453
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.1583440
	speed: 0.1686s/iter; left time: 6861.6843s
	iters: 200, epoch: 14 | loss: 0.0001183
	speed: 0.0290s/iter; left time: 1177.9569s
	iters: 300, epoch: 14 | loss: 0.0007342
	speed: 0.0300s/iter; left time: 1216.5916s
	iters: 400, epoch: 14 | loss: 0.0002416
	speed: 0.0310s/iter; left time: 1253.1560s
Epoch: 14 cost time: 14.74536919593811
Epoch: 14, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0020345
	speed: 0.1711s/iter; left time: 6885.1372s
	iters: 200, epoch: 15 | loss: 0.0026649
	speed: 0.0303s/iter; left time: 1214.1812s
	iters: 300, epoch: 15 | loss: 0.0002712
	speed: 0.0328s/iter; left time: 1312.6248s
	iters: 400, epoch: 15 | loss: 0.0017993
	speed: 0.0353s/iter; left time: 1409.8813s
Epoch: 15 cost time: 15.626824378967285
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3904079
	speed: 0.1751s/iter; left time: 6963.6052s
	iters: 200, epoch: 16 | loss: 0.0025902
	speed: 0.0369s/iter; left time: 1463.8388s
	iters: 300, epoch: 16 | loss: 0.0452808
	speed: 0.0306s/iter; left time: 1211.9676s
	iters: 400, epoch: 16 | loss: 0.0009816
	speed: 0.0302s/iter; left time: 1192.7746s
Epoch: 16 cost time: 15.85873556137085
Epoch: 16, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.211 Vali Acc: 0.968 Test Loss: 0.211 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 2673698
model size : 19.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3775194
	speed: 0.0540s/iter; left time: 2529.4547s
	iters: 200, epoch: 1 | loss: 0.2154271
	speed: 0.0315s/iter; left time: 1470.7411s
	iters: 300, epoch: 1 | loss: 0.0148504
	speed: 0.0307s/iter; left time: 1431.2850s
	iters: 400, epoch: 1 | loss: 0.0163564
	speed: 0.0295s/iter; left time: 1369.7266s
Epoch: 1 cost time: 16.580476999282837
Epoch: 1, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.283 Vali Acc: 0.921 Test Loss: 0.283 Test Acc: 0.921
Validation loss decreased (inf --> -0.921095).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0163086
	speed: 0.1692s/iter; left time: 7841.3062s
	iters: 200, epoch: 2 | loss: 0.0159819
	speed: 0.0298s/iter; left time: 1379.8909s
	iters: 300, epoch: 2 | loss: 0.2953234
	speed: 0.0299s/iter; left time: 1379.5982s
	iters: 400, epoch: 2 | loss: 0.1686651
	speed: 0.0354s/iter; left time: 1631.6323s
Epoch: 2 cost time: 15.42085576057434
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.921095 --> -0.971983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000537
	speed: 0.1633s/iter; left time: 7488.2780s
	iters: 200, epoch: 3 | loss: 0.0297347
	speed: 0.0320s/iter; left time: 1466.2702s
	iters: 300, epoch: 3 | loss: 0.0055080
	speed: 0.0351s/iter; left time: 1601.8895s
	iters: 400, epoch: 3 | loss: 0.1642760
	speed: 0.0328s/iter; left time: 1496.1044s
Epoch: 3 cost time: 15.64617919921875
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0087046
	speed: 0.1729s/iter; left time: 7848.6646s
	iters: 200, epoch: 4 | loss: 0.0001575
	speed: 0.0321s/iter; left time: 1452.8351s
	iters: 300, epoch: 4 | loss: 0.0043454
	speed: 0.0297s/iter; left time: 1343.5296s
	iters: 400, epoch: 4 | loss: 0.4360868
	speed: 0.0281s/iter; left time: 1268.8185s
Epoch: 4 cost time: 14.863843441009521
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1898502
	speed: 0.1692s/iter; left time: 7603.5288s
	iters: 200, epoch: 5 | loss: 0.0024951
	speed: 0.0302s/iter; left time: 1355.5059s
	iters: 300, epoch: 5 | loss: 0.0000240
	speed: 0.0316s/iter; left time: 1411.2562s
	iters: 400, epoch: 5 | loss: 0.0013022
	speed: 0.0328s/iter; left time: 1461.9316s
Epoch: 5 cost time: 15.214776039123535
Epoch: 5, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.206 Vali Acc: 0.964 Test Loss: 0.206 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0002629
	speed: 0.1600s/iter; left time: 7114.1153s
	iters: 200, epoch: 6 | loss: 0.0036292
	speed: 0.0287s/iter; left time: 1272.9206s
	iters: 300, epoch: 6 | loss: 0.0013970
	speed: 0.0312s/iter; left time: 1379.4559s
	iters: 400, epoch: 6 | loss: 0.0080652
	speed: 0.0347s/iter; left time: 1531.4460s
Epoch: 6 cost time: 14.949748277664185
Epoch: 6, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.977414).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0970405
	speed: 0.1709s/iter; left time: 7515.6659s
	iters: 200, epoch: 7 | loss: 0.0007758
	speed: 0.0345s/iter; left time: 1513.6924s
	iters: 300, epoch: 7 | loss: 0.0000608
	speed: 0.0353s/iter; left time: 1543.9461s
	iters: 400, epoch: 7 | loss: 0.0118332
	speed: 0.0306s/iter; left time: 1337.2575s
Epoch: 7 cost time: 15.536828756332397
Epoch: 7, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.290 Vali Acc: 0.959 Test Loss: 0.290 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0001607
	speed: 0.1903s/iter; left time: 8282.2396s
	iters: 200, epoch: 8 | loss: 0.0023107
	speed: 0.0426s/iter; left time: 1850.2539s
	iters: 300, epoch: 8 | loss: 0.0047867
	speed: 0.0257s/iter; left time: 1113.4316s
	iters: 400, epoch: 8 | loss: 0.0005902
	speed: 0.0224s/iter; left time: 970.1045s
Epoch: 8 cost time: 15.458930492401123
Epoch: 8, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.288 Vali Acc: 0.962 Test Loss: 0.288 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000013
	speed: 0.1227s/iter; left time: 5281.7305s
	iters: 200, epoch: 9 | loss: 0.0380852
	speed: 0.0211s/iter; left time: 907.9553s
	iters: 300, epoch: 9 | loss: 0.0000005
	speed: 0.0217s/iter; left time: 931.5898s
	iters: 400, epoch: 9 | loss: 0.0000301
	speed: 0.0300s/iter; left time: 1280.5168s
Epoch: 9 cost time: 12.182798862457275
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.265 Vali Acc: 0.965 Test Loss: 0.265 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0001070
	speed: 0.1769s/iter; left time: 7532.3908s
	iters: 200, epoch: 10 | loss: 0.4380761
	speed: 0.0326s/iter; left time: 1384.9799s
	iters: 300, epoch: 10 | loss: 0.0026054
	speed: 0.0353s/iter; left time: 1497.2166s
	iters: 400, epoch: 10 | loss: 0.0000158
	speed: 0.0343s/iter; left time: 1449.3147s
Epoch: 10 cost time: 15.858340978622437
Epoch: 10, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000002
	speed: 0.1668s/iter; left time: 7022.3791s
	iters: 200, epoch: 11 | loss: 0.0000006
	speed: 0.0347s/iter; left time: 1455.8093s
	iters: 300, epoch: 11 | loss: 0.2395446
	speed: 0.0317s/iter; left time: 1327.6757s
	iters: 400, epoch: 11 | loss: 0.0005494
	speed: 0.0303s/iter; left time: 1268.5477s
Epoch: 11 cost time: 15.760215520858765
Epoch: 11, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0004411
	speed: 0.1670s/iter; left time: 6953.7820s
	iters: 200, epoch: 12 | loss: 0.0000244
	speed: 0.0261s/iter; left time: 1082.5233s
	iters: 300, epoch: 12 | loss: 1.2363756
	speed: 0.0284s/iter; left time: 1176.3208s
	iters: 400, epoch: 12 | loss: 0.0398235
	speed: 0.0300s/iter; left time: 1241.4184s
Epoch: 12 cost time: 14.439914464950562
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000295
	speed: 0.1758s/iter; left time: 7239.1075s
	iters: 200, epoch: 13 | loss: 0.0214540
	speed: 0.0286s/iter; left time: 1176.3686s
	iters: 300, epoch: 13 | loss: 0.0000541
	speed: 0.0300s/iter; left time: 1230.1306s
	iters: 400, epoch: 13 | loss: 0.0048802
	speed: 0.0334s/iter; left time: 1365.5865s
Epoch: 13 cost time: 15.00429630279541
Epoch: 13, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0007824
	speed: 0.1635s/iter; left time: 6655.0176s
	iters: 200, epoch: 14 | loss: 0.0000118
	speed: 0.0316s/iter; left time: 1284.4961s
	iters: 300, epoch: 14 | loss: 0.0000005
	speed: 0.0362s/iter; left time: 1464.5197s
	iters: 400, epoch: 14 | loss: 0.0000029
	speed: 0.0316s/iter; left time: 1274.8797s
Epoch: 14 cost time: 15.576232194900513
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.284 Vali Acc: 0.963 Test Loss: 0.284 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000812
	speed: 0.1681s/iter; left time: 6761.5639s
	iters: 200, epoch: 15 | loss: 0.0000211
	speed: 0.0292s/iter; left time: 1172.7823s
	iters: 300, epoch: 15 | loss: 0.0046249
	speed: 0.0286s/iter; left time: 1146.4840s
	iters: 400, epoch: 15 | loss: 0.0004802
	speed: 0.0287s/iter; left time: 1145.7838s
Epoch: 15 cost time: 14.306197166442871
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.3595902
	speed: 0.1580s/iter; left time: 6284.4111s
	iters: 200, epoch: 16 | loss: 0.0004795
	speed: 0.0322s/iter; left time: 1277.1111s
	iters: 300, epoch: 16 | loss: 0.0010002
	speed: 0.0308s/iter; left time: 1218.9214s
	iters: 400, epoch: 16 | loss: 0.0003514
	speed: 0.0351s/iter; left time: 1386.8758s
Epoch: 16 cost time: 15.884519577026367
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 2673698
model size : 19.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4760700
	speed: 0.0575s/iter; left time: 2690.3929s
	iters: 200, epoch: 1 | loss: 0.1326260
	speed: 0.0316s/iter; left time: 1475.9381s
	iters: 300, epoch: 1 | loss: 0.0758250
	speed: 0.0321s/iter; left time: 1494.5671s
	iters: 400, epoch: 1 | loss: 0.0136365
	speed: 0.0304s/iter; left time: 1412.7185s
Epoch: 1 cost time: 17.281877756118774
Epoch: 1, Steps: 469 | Train Loss: 0.342 Vali Loss: 0.186 Vali Acc: 0.945 Test Loss: 0.186 Test Acc: 0.945
Validation loss decreased (inf --> -0.945110).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0147134
	speed: 0.1667s/iter; left time: 7723.3687s
	iters: 200, epoch: 2 | loss: 0.1607921
	speed: 0.0324s/iter; left time: 1496.1691s
	iters: 300, epoch: 2 | loss: 0.0194614
	speed: 0.0306s/iter; left time: 1412.8185s
	iters: 400, epoch: 2 | loss: 0.0051144
	speed: 0.0327s/iter; left time: 1503.7952s
Epoch: 2 cost time: 15.0134117603302
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0048100
	speed: 0.1354s/iter; left time: 6209.3191s
	iters: 200, epoch: 3 | loss: 0.0181084
	speed: 0.0323s/iter; left time: 1477.2298s
	iters: 300, epoch: 3 | loss: 0.0337932
	speed: 0.0317s/iter; left time: 1446.5039s
	iters: 400, epoch: 3 | loss: 0.0006823
	speed: 0.0293s/iter; left time: 1335.8539s
Epoch: 3 cost time: 14.440451383590698
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
Validation loss decreased (-0.945110 --> -0.954544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0166314
	speed: 0.1679s/iter; left time: 7623.3466s
	iters: 200, epoch: 4 | loss: 0.0076689
	speed: 0.0297s/iter; left time: 1347.1552s
	iters: 300, epoch: 4 | loss: 0.0624227
	speed: 0.0282s/iter; left time: 1273.5398s
	iters: 400, epoch: 4 | loss: 0.3453054
	speed: 0.0280s/iter; left time: 1262.7887s
Epoch: 4 cost time: 14.184108018875122
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
Validation loss decreased (-0.954544 --> -0.960547).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0056042
	speed: 0.1649s/iter; left time: 7405.8885s
	iters: 200, epoch: 5 | loss: 0.0003747
	speed: 0.0294s/iter; left time: 1318.5249s
	iters: 300, epoch: 5 | loss: 0.0032575
	speed: 0.0305s/iter; left time: 1366.0467s
	iters: 400, epoch: 5 | loss: 0.0001749
	speed: 0.0321s/iter; left time: 1432.5772s
Epoch: 5 cost time: 15.092449188232422
Epoch: 5, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
Validation loss decreased (-0.960547 --> -0.961691).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0057196
	speed: 0.1612s/iter; left time: 7165.8723s
	iters: 200, epoch: 6 | loss: 0.0023168
	speed: 0.0273s/iter; left time: 1209.8006s
	iters: 300, epoch: 6 | loss: 0.4934756
	speed: 0.0277s/iter; left time: 1224.2991s
	iters: 400, epoch: 6 | loss: 0.0001453
	speed: 0.0334s/iter; left time: 1472.8572s
Epoch: 6 cost time: 14.424463748931885
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0810045
	speed: 0.1607s/iter; left time: 7068.8188s
	iters: 200, epoch: 7 | loss: 0.0115726
	speed: 0.0328s/iter; left time: 1440.3737s
	iters: 300, epoch: 7 | loss: 0.0117063
	speed: 0.0328s/iter; left time: 1435.2508s
	iters: 400, epoch: 7 | loss: 0.0148116
	speed: 0.0290s/iter; left time: 1268.3909s
Epoch: 7 cost time: 14.65915584564209
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.961691 --> -0.962548).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0387002
	speed: 0.1606s/iter; left time: 6990.3332s
	iters: 200, epoch: 8 | loss: 0.0410571
	speed: 0.0333s/iter; left time: 1445.3965s
	iters: 300, epoch: 8 | loss: 0.0039588
	speed: 0.0317s/iter; left time: 1371.1285s
	iters: 400, epoch: 8 | loss: 0.0000108
	speed: 0.0321s/iter; left time: 1386.6767s
Epoch: 8 cost time: 15.692516088485718
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.189 Vali Acc: 0.955 Test Loss: 0.189 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001864
	speed: 0.1649s/iter; left time: 7097.8655s
	iters: 200, epoch: 9 | loss: 0.1818727
	speed: 0.0287s/iter; left time: 1232.7095s
	iters: 300, epoch: 9 | loss: 0.0014685
	speed: 0.0324s/iter; left time: 1387.5421s
	iters: 400, epoch: 9 | loss: 0.2110605
	speed: 0.0321s/iter; left time: 1373.7543s
Epoch: 9 cost time: 14.945971488952637
Epoch: 9, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.947 Test Loss: 0.234 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000313
	speed: 0.1739s/iter; left time: 7403.6402s
	iters: 200, epoch: 10 | loss: 0.0006390
	speed: 0.0294s/iter; left time: 1248.0602s
	iters: 300, epoch: 10 | loss: 0.2059221
	speed: 0.0313s/iter; left time: 1326.1321s
	iters: 400, epoch: 10 | loss: 0.0033563
	speed: 0.0315s/iter; left time: 1333.5352s
Epoch: 10 cost time: 14.822160243988037
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.969 Test Loss: 0.161 Test Acc: 0.969
Validation loss decreased (-0.962548 --> -0.968552).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0016037
	speed: 0.1665s/iter; left time: 7011.4740s
	iters: 200, epoch: 11 | loss: 0.0224951
	speed: 0.0359s/iter; left time: 1508.8366s
	iters: 300, epoch: 11 | loss: 0.0151947
	speed: 0.0349s/iter; left time: 1463.8014s
	iters: 400, epoch: 11 | loss: 0.0010325
	speed: 0.0302s/iter; left time: 1261.5439s
Epoch: 11 cost time: 15.43687105178833
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.969123).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0006885
	speed: 0.1557s/iter; left time: 6484.9150s
	iters: 200, epoch: 12 | loss: 0.0190129
	speed: 0.0315s/iter; left time: 1307.5971s
	iters: 300, epoch: 12 | loss: 0.0012304
	speed: 0.0298s/iter; left time: 1234.0669s
	iters: 400, epoch: 12 | loss: 0.0038456
	speed: 0.0302s/iter; left time: 1249.3981s
Epoch: 12 cost time: 14.633488416671753
Epoch: 12, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.969123 --> -0.976557).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0094206
	speed: 0.1627s/iter; left time: 6699.1580s
	iters: 200, epoch: 13 | loss: 0.0042973
	speed: 0.0282s/iter; left time: 1159.4585s
	iters: 300, epoch: 13 | loss: 0.0000981
	speed: 0.0272s/iter; left time: 1113.2235s
	iters: 400, epoch: 13 | loss: 0.1780591
	speed: 0.0281s/iter; left time: 1150.4951s
Epoch: 13 cost time: 13.728177309036255
Epoch: 13, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0093581
	speed: 0.1663s/iter; left time: 6767.3174s
	iters: 200, epoch: 14 | loss: 0.3188035
	speed: 0.0296s/iter; left time: 1200.4130s
	iters: 300, epoch: 14 | loss: 0.0018651
	speed: 0.0289s/iter; left time: 1169.8357s
	iters: 400, epoch: 14 | loss: 0.0886727
	speed: 0.0346s/iter; left time: 1397.8496s
Epoch: 14 cost time: 15.152550220489502
Epoch: 14, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.972 Test Loss: 0.153 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0011930
	speed: 0.1563s/iter; left time: 6287.6576s
	iters: 200, epoch: 15 | loss: 0.0030744
	speed: 0.0309s/iter; left time: 1240.4238s
	iters: 300, epoch: 15 | loss: 0.0025804
	speed: 0.0311s/iter; left time: 1246.1561s
	iters: 400, epoch: 15 | loss: 0.0259831
	speed: 0.0319s/iter; left time: 1275.4151s
Epoch: 15 cost time: 14.49830150604248
Epoch: 15, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0019850
	speed: 0.1634s/iter; left time: 6496.2492s
	iters: 200, epoch: 16 | loss: 0.0000006
	speed: 0.0314s/iter; left time: 1243.6227s
	iters: 300, epoch: 16 | loss: 0.3797584
	speed: 0.0263s/iter; left time: 1041.4635s
	iters: 400, epoch: 16 | loss: 0.0002872
	speed: 0.0291s/iter; left time: 1148.6474s
Epoch: 16 cost time: 14.212328672409058
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0641664
	speed: 0.1641s/iter; left time: 6447.3511s
	iters: 200, epoch: 17 | loss: 0.0843325
	speed: 0.0315s/iter; left time: 1234.5236s
	iters: 300, epoch: 17 | loss: 0.0150473
	speed: 0.0306s/iter; left time: 1197.7986s
	iters: 400, epoch: 17 | loss: 0.0009753
	speed: 0.0304s/iter; left time: 1183.9592s
Epoch: 17 cost time: 15.137174606323242
Epoch: 17, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000134
	speed: 0.1663s/iter; left time: 6457.0448s
	iters: 200, epoch: 18 | loss: 0.0725772
	speed: 0.0314s/iter; left time: 1217.6138s
	iters: 300, epoch: 18 | loss: 0.0001668
	speed: 0.0308s/iter; left time: 1188.9444s
	iters: 400, epoch: 18 | loss: 0.1385048
	speed: 0.0343s/iter; left time: 1320.7174s
Epoch: 18 cost time: 15.437973022460938
Epoch: 18, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0027640
	speed: 0.1653s/iter; left time: 6342.4885s
	iters: 200, epoch: 19 | loss: 0.0000197
	speed: 0.0314s/iter; left time: 1199.5496s
	iters: 300, epoch: 19 | loss: 0.0229557
	speed: 0.0320s/iter; left time: 1221.7464s
	iters: 400, epoch: 19 | loss: 0.0000005
	speed: 0.0283s/iter; left time: 1076.7491s
Epoch: 19 cost time: 14.445868492126465
Epoch: 19, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0033980
	speed: 0.1710s/iter; left time: 6477.8143s
	iters: 200, epoch: 20 | loss: 0.0037975
	speed: 0.0307s/iter; left time: 1160.6006s
	iters: 300, epoch: 20 | loss: 0.0004019
	speed: 0.0301s/iter; left time: 1134.6322s
	iters: 400, epoch: 20 | loss: 0.0034801
	speed: 0.0309s/iter; left time: 1159.7768s
Epoch: 20 cost time: 14.820090293884277
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0065543
	speed: 0.1606s/iter; left time: 6008.4518s
	iters: 200, epoch: 21 | loss: 0.0612005
	speed: 0.0286s/iter; left time: 1067.9062s
	iters: 300, epoch: 21 | loss: 0.0000114
	speed: 0.0281s/iter; left time: 1046.1259s
	iters: 400, epoch: 21 | loss: 0.0000097
	speed: 0.0285s/iter; left time: 1059.5902s
Epoch: 21 cost time: 14.193456888198853
Epoch: 21, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.978272).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.2746277
	speed: 0.1641s/iter; left time: 6065.0209s
	iters: 200, epoch: 22 | loss: 0.0020659
	speed: 0.0279s/iter; left time: 1027.6989s
	iters: 300, epoch: 22 | loss: 0.0013033
	speed: 0.0277s/iter; left time: 1019.7070s
	iters: 400, epoch: 22 | loss: 0.1410975
	speed: 0.0298s/iter; left time: 1091.2100s
Epoch: 22 cost time: 13.92786169052124
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.952 Test Loss: 0.294 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0000439
	speed: 0.1664s/iter; left time: 6069.9902s
	iters: 200, epoch: 23 | loss: 0.1289791
	speed: 0.0293s/iter; left time: 1065.9830s
	iters: 300, epoch: 23 | loss: 0.0084322
	speed: 0.0305s/iter; left time: 1107.9999s
	iters: 400, epoch: 23 | loss: 0.0000103
	speed: 0.0263s/iter; left time: 951.9967s
Epoch: 23 cost time: 13.785339832305908
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.230 Vali Acc: 0.963 Test Loss: 0.230 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0005553
	speed: 0.1424s/iter; left time: 5128.0180s
	iters: 200, epoch: 24 | loss: 0.0034899
	speed: 0.0362s/iter; left time: 1300.3310s
	iters: 300, epoch: 24 | loss: 0.8127584
	speed: 0.0319s/iter; left time: 1142.0100s
	iters: 400, epoch: 24 | loss: 0.0001996
	speed: 0.0308s/iter; left time: 1099.3270s
Epoch: 24 cost time: 15.60127854347229
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0047282
	speed: 0.1715s/iter; left time: 6095.6902s
	iters: 200, epoch: 25 | loss: 0.0000196
	speed: 0.0286s/iter; left time: 1013.6914s
	iters: 300, epoch: 25 | loss: 0.0000098
	speed: 0.0284s/iter; left time: 1005.5415s
	iters: 400, epoch: 25 | loss: 0.0000019
	speed: 0.0276s/iter; left time: 973.9146s
Epoch: 25 cost time: 14.064187288284302
Epoch: 25, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0519614
	speed: 0.1756s/iter; left time: 6158.2215s
	iters: 200, epoch: 26 | loss: 0.0006212
	speed: 0.0341s/iter; left time: 1193.8781s
	iters: 300, epoch: 26 | loss: 0.0000025
	speed: 0.0331s/iter; left time: 1154.0361s
	iters: 400, epoch: 26 | loss: 0.2138693
	speed: 0.0316s/iter; left time: 1099.2413s
Epoch: 26 cost time: 15.664800643920898
Epoch: 26, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.966 Test Loss: 0.209 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0012615
	speed: 0.1733s/iter; left time: 5998.7364s
	iters: 200, epoch: 27 | loss: 0.0003702
	speed: 0.0298s/iter; left time: 1026.6281s
	iters: 300, epoch: 27 | loss: 0.0860985
	speed: 0.0294s/iter; left time: 1012.7811s
	iters: 400, epoch: 27 | loss: 0.0003743
	speed: 0.0334s/iter; left time: 1147.0141s
Epoch: 27 cost time: 14.971675634384155
Epoch: 27, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.219 Vali Acc: 0.965 Test Loss: 0.219 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0000036
	speed: 0.1725s/iter; left time: 5887.6097s
	iters: 200, epoch: 28 | loss: 0.0016609
	speed: 0.0358s/iter; left time: 1218.9310s
	iters: 300, epoch: 28 | loss: 0.0019120
	speed: 0.0362s/iter; left time: 1228.5925s
	iters: 400, epoch: 28 | loss: 0.0000075
	speed: 0.0323s/iter; left time: 1093.0031s
Epoch: 28 cost time: 16.363629817962646
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.317 Vali Acc: 0.959 Test Loss: 0.317 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0000347
	speed: 0.1667s/iter; left time: 5613.4959s
	iters: 200, epoch: 29 | loss: 0.0000065
	speed: 0.0359s/iter; left time: 1203.9513s
	iters: 300, epoch: 29 | loss: 0.0103606
	speed: 0.0312s/iter; left time: 1044.1044s
	iters: 400, epoch: 29 | loss: 0.0040283
	speed: 0.0310s/iter; left time: 1033.3269s
Epoch: 29 cost time: 15.833864450454712
Epoch: 29, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.190 Vali Acc: 0.969 Test Loss: 0.190 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000739
	speed: 0.1681s/iter; left time: 5581.5294s
	iters: 200, epoch: 30 | loss: 0.0000252
	speed: 0.0275s/iter; left time: 909.4739s
	iters: 300, epoch: 30 | loss: 0.1769699
	speed: 0.0279s/iter; left time: 921.5797s
	iters: 400, epoch: 30 | loss: 0.0000028
	speed: 0.0282s/iter; left time: 928.9978s
Epoch: 30 cost time: 13.994928359985352
Epoch: 30, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.971 Test Loss: 0.250 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0050008
	speed: 0.1676s/iter; left time: 5486.0376s
	iters: 200, epoch: 31 | loss: 0.0001478
	speed: 0.0316s/iter; left time: 1031.9729s
	iters: 300, epoch: 31 | loss: 0.0750532
	speed: 0.0300s/iter; left time: 976.2312s
	iters: 400, epoch: 31 | loss: 0.0000438
	speed: 0.0307s/iter; left time: 996.3137s
Epoch: 31 cost time: 14.490570306777954
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.978273299028016
model parameter : 1625122
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4671498
	speed: 0.0539s/iter; left time: 2521.0950s
	iters: 200, epoch: 1 | loss: 0.1166158
	speed: 0.0307s/iter; left time: 1435.4505s
	iters: 300, epoch: 1 | loss: 0.1013324
	speed: 0.0311s/iter; left time: 1447.3730s
	iters: 400, epoch: 1 | loss: 0.0121054
	speed: 0.0301s/iter; left time: 1399.2582s
Epoch: 1 cost time: 17.054967641830444
Epoch: 1, Steps: 469 | Train Loss: 0.336 Vali Loss: 0.180 Vali Acc: 0.945 Test Loss: 0.180 Test Acc: 0.945
Validation loss decreased (inf --> -0.944538).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0065365
	speed: 0.1711s/iter; left time: 7925.6176s
	iters: 200, epoch: 2 | loss: 0.0906862
	speed: 0.0285s/iter; left time: 1316.6499s
	iters: 300, epoch: 2 | loss: 0.0098468
	speed: 0.0379s/iter; left time: 1750.5606s
	iters: 400, epoch: 2 | loss: 0.0025118
	speed: 0.0357s/iter; left time: 1644.8128s
Epoch: 2 cost time: 15.937487840652466
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.944538 --> -0.949112).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031500
	speed: 0.1661s/iter; left time: 7619.4139s
	iters: 200, epoch: 3 | loss: 0.1059218
	speed: 0.0305s/iter; left time: 1396.4508s
	iters: 300, epoch: 3 | loss: 0.1321319
	speed: 0.0361s/iter; left time: 1649.0039s
	iters: 400, epoch: 3 | loss: 0.0064780
	speed: 0.0342s/iter; left time: 1557.7146s
Epoch: 3 cost time: 15.633533477783203
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.259 Vali Acc: 0.939 Test Loss: 0.259 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0025152
	speed: 0.1786s/iter; left time: 8106.9349s
	iters: 200, epoch: 4 | loss: 0.0063977
	speed: 0.0346s/iter; left time: 1568.6427s
	iters: 300, epoch: 4 | loss: 0.0129813
	speed: 0.0322s/iter; left time: 1456.5790s
	iters: 400, epoch: 4 | loss: 0.1769173
	speed: 0.0312s/iter; left time: 1408.0839s
Epoch: 4 cost time: 16.147955656051636
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949112 --> -0.950255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0007597
	speed: 0.1785s/iter; left time: 8019.5547s
	iters: 200, epoch: 5 | loss: 0.0250852
	speed: 0.0330s/iter; left time: 1477.1472s
	iters: 300, epoch: 5 | loss: 0.0002970
	speed: 0.0323s/iter; left time: 1444.6161s
	iters: 400, epoch: 5 | loss: 0.0001524
	speed: 0.0330s/iter; left time: 1474.7301s
Epoch: 5 cost time: 15.834653377532959
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.950255 --> -0.967980).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1068799
	speed: 0.1779s/iter; left time: 7910.4791s
	iters: 200, epoch: 6 | loss: 0.0025611
	speed: 0.0326s/iter; left time: 1448.0606s
	iters: 300, epoch: 6 | loss: 0.0131539
	speed: 0.0336s/iter; left time: 1488.1056s
	iters: 400, epoch: 6 | loss: 0.0001365
	speed: 0.0374s/iter; left time: 1650.9699s
Epoch: 6 cost time: 16.348952054977417
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0068624
	speed: 0.1663s/iter; left time: 7315.4697s
	iters: 200, epoch: 7 | loss: 0.0762662
	speed: 0.0327s/iter; left time: 1436.7682s
	iters: 300, epoch: 7 | loss: 0.0246382
	speed: 0.0323s/iter; left time: 1412.3800s
	iters: 400, epoch: 7 | loss: 0.2071529
	speed: 0.0308s/iter; left time: 1347.1340s
Epoch: 7 cost time: 14.880096912384033
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0860631
	speed: 0.1682s/iter; left time: 7321.5130s
	iters: 200, epoch: 8 | loss: 0.0246198
	speed: 0.0371s/iter; left time: 1611.3638s
	iters: 300, epoch: 8 | loss: 0.0015213
	speed: 0.0331s/iter; left time: 1433.7722s
	iters: 400, epoch: 8 | loss: 0.0049604
	speed: 0.0304s/iter; left time: 1312.2358s
Epoch: 8 cost time: 15.797702550888062
Epoch: 8, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0004066
	speed: 0.1654s/iter; left time: 7121.7127s
	iters: 200, epoch: 9 | loss: 0.0003831
	speed: 0.0331s/iter; left time: 1419.6427s
	iters: 300, epoch: 9 | loss: 0.0000115
	speed: 0.0321s/iter; left time: 1374.5240s
	iters: 400, epoch: 9 | loss: 0.0019538
	speed: 0.0314s/iter; left time: 1342.1402s
Epoch: 9 cost time: 15.531566619873047
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.205 Vali Acc: 0.966 Test Loss: 0.205 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1714s/iter; left time: 7296.1176s
	iters: 200, epoch: 10 | loss: 0.0000049
	speed: 0.0289s/iter; left time: 1228.3649s
	iters: 300, epoch: 10 | loss: 0.0016188
	speed: 0.0296s/iter; left time: 1254.2124s
	iters: 400, epoch: 10 | loss: 0.1881528
	speed: 0.0289s/iter; left time: 1223.2125s
Epoch: 10 cost time: 14.512227773666382
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001926
	speed: 0.1758s/iter; left time: 7401.7441s
	iters: 200, epoch: 11 | loss: 0.0008167
	speed: 0.0321s/iter; left time: 1347.3698s
	iters: 300, epoch: 11 | loss: 0.0085397
	speed: 0.0324s/iter; left time: 1358.1824s
	iters: 400, epoch: 11 | loss: 0.0123533
	speed: 0.0330s/iter; left time: 1379.7611s
Epoch: 11 cost time: 15.629188060760498
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.218 Vali Acc: 0.958 Test Loss: 0.218 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0073152
	speed: 0.1662s/iter; left time: 6919.1106s
	iters: 200, epoch: 12 | loss: 0.0000257
	speed: 0.0365s/iter; left time: 1515.4779s
	iters: 300, epoch: 12 | loss: 0.0064469
	speed: 0.0375s/iter; left time: 1554.0725s
	iters: 400, epoch: 12 | loss: 0.0002505
	speed: 0.0344s/iter; left time: 1421.1803s
Epoch: 12 cost time: 16.556232690811157
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.215 Vali Acc: 0.965 Test Loss: 0.215 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0005767
	speed: 0.1746s/iter; left time: 7186.7794s
	iters: 200, epoch: 13 | loss: 0.0124216
	speed: 0.0356s/iter; left time: 1463.8580s
	iters: 300, epoch: 13 | loss: 0.0027189
	speed: 0.0317s/iter; left time: 1299.0058s
	iters: 400, epoch: 13 | loss: 0.0001677
	speed: 0.0323s/iter; left time: 1318.6106s
Epoch: 13 cost time: 16.348057508468628
Epoch: 13, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.287 Vali Acc: 0.960 Test Loss: 0.287 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0910367
	speed: 0.1770s/iter; left time: 7206.4950s
	iters: 200, epoch: 14 | loss: 0.0278222
	speed: 0.0336s/iter; left time: 1363.3255s
	iters: 300, epoch: 14 | loss: 0.0078786
	speed: 0.0299s/iter; left time: 1209.1137s
	iters: 400, epoch: 14 | loss: 0.0047196
	speed: 0.0291s/iter; left time: 1175.1706s
Epoch: 14 cost time: 15.25137734413147
Epoch: 14, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.260 Vali Acc: 0.965 Test Loss: 0.260 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0007710
	speed: 0.1724s/iter; left time: 6936.2728s
	iters: 200, epoch: 15 | loss: 0.0000309
	speed: 0.0321s/iter; left time: 1289.5205s
	iters: 300, epoch: 15 | loss: 0.0000601
	speed: 0.0336s/iter; left time: 1343.9374s
	iters: 400, epoch: 15 | loss: 0.0018962
	speed: 0.0304s/iter; left time: 1215.5597s
Epoch: 15 cost time: 15.68404245376587
Epoch: 15, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.967980 --> -0.970267).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002656
	speed: 0.1711s/iter; left time: 6802.7023s
	iters: 200, epoch: 16 | loss: 0.0001280
	speed: 0.0308s/iter; left time: 1222.0044s
	iters: 300, epoch: 16 | loss: 0.6946999
	speed: 0.0329s/iter; left time: 1303.5629s
	iters: 400, epoch: 16 | loss: 0.0004799
	speed: 0.0363s/iter; left time: 1432.4810s
Epoch: 16 cost time: 15.905101776123047
Epoch: 16, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0088095
	speed: 0.1663s/iter; left time: 6535.6362s
	iters: 200, epoch: 17 | loss: 0.0019746
	speed: 0.0328s/iter; left time: 1286.6094s
	iters: 300, epoch: 17 | loss: 0.0489574
	speed: 0.0341s/iter; left time: 1332.7178s
	iters: 400, epoch: 17 | loss: 0.0000156
	speed: 0.0326s/iter; left time: 1272.9005s
Epoch: 17 cost time: 15.45017385482788
Epoch: 17, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000044
	speed: 0.1612s/iter; left time: 6260.1486s
	iters: 200, epoch: 18 | loss: 0.0268705
	speed: 0.0369s/iter; left time: 1430.2268s
	iters: 300, epoch: 18 | loss: 0.0018216
	speed: 0.0365s/iter; left time: 1409.7330s
	iters: 400, epoch: 18 | loss: 0.0188350
	speed: 0.0307s/iter; left time: 1181.6188s
Epoch: 18 cost time: 16.15706777572632
Epoch: 18, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2922235
	speed: 0.1615s/iter; left time: 6193.3194s
	iters: 200, epoch: 19 | loss: 0.0000190
	speed: 0.0332s/iter; left time: 1271.5293s
	iters: 300, epoch: 19 | loss: 0.0000169
	speed: 0.0325s/iter; left time: 1241.9044s
	iters: 400, epoch: 19 | loss: 0.0001245
	speed: 0.0314s/iter; left time: 1193.8871s
Epoch: 19 cost time: 15.71289610862732
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.971124).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0038270
	speed: 0.1791s/iter; left time: 6786.0577s
	iters: 200, epoch: 20 | loss: 0.0000036
	speed: 0.0289s/iter; left time: 1093.3236s
	iters: 300, epoch: 20 | loss: 0.0002249
	speed: 0.0297s/iter; left time: 1120.3175s
	iters: 400, epoch: 20 | loss: 0.0041556
	speed: 0.0302s/iter; left time: 1134.7243s
Epoch: 20 cost time: 14.629245042800903
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
Validation loss decreased (-0.971124 --> -0.971410).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0910072
	speed: 0.1812s/iter; left time: 6779.0549s
	iters: 200, epoch: 21 | loss: 0.0006425
	speed: 0.0342s/iter; left time: 1277.9951s
	iters: 300, epoch: 21 | loss: 0.0000010
	speed: 0.0336s/iter; left time: 1250.4173s
	iters: 400, epoch: 21 | loss: 0.0008512
	speed: 0.0340s/iter; left time: 1261.0824s
Epoch: 21 cost time: 16.323498010635376
Epoch: 21, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.963 Test Loss: 0.222 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.3140352
	speed: 0.1713s/iter; left time: 6331.3856s
	iters: 200, epoch: 22 | loss: 0.2589845
	speed: 0.0357s/iter; left time: 1316.9084s
	iters: 300, epoch: 22 | loss: 0.1551465
	speed: 0.0395s/iter; left time: 1450.9780s
	iters: 400, epoch: 22 | loss: 0.0063984
	speed: 0.0333s/iter; left time: 1221.5760s
Epoch: 22 cost time: 16.737943649291992
Epoch: 22, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000041
	speed: 0.1706s/iter; left time: 6224.8077s
	iters: 200, epoch: 23 | loss: 0.0684312
	speed: 0.0310s/iter; left time: 1128.2866s
	iters: 300, epoch: 23 | loss: 0.0087337
	speed: 0.0262s/iter; left time: 949.3956s
	iters: 400, epoch: 23 | loss: 0.0001643
	speed: 0.0249s/iter; left time: 899.1768s
Epoch: 23 cost time: 13.816838264465332
Epoch: 23, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
Validation loss decreased (-0.971410 --> -0.971982).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000353
	speed: 0.1688s/iter; left time: 6078.5831s
	iters: 200, epoch: 24 | loss: 0.0092045
	speed: 0.0316s/iter; left time: 1133.9596s
	iters: 300, epoch: 24 | loss: 0.4651416
	speed: 0.0303s/iter; left time: 1083.4980s
	iters: 400, epoch: 24 | loss: 0.0004600
	speed: 0.0301s/iter; left time: 1074.7485s
Epoch: 24 cost time: 15.403096914291382
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.313 Vali Acc: 0.958 Test Loss: 0.313 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0002381
	speed: 0.1685s/iter; left time: 5990.9853s
	iters: 200, epoch: 25 | loss: 0.0003435
	speed: 0.0286s/iter; left time: 1012.7860s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0275s/iter; left time: 970.8058s
	iters: 400, epoch: 25 | loss: 0.0003457
	speed: 0.0305s/iter; left time: 1075.0096s
Epoch: 25 cost time: 14.166435241699219
Epoch: 25, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.338 Vali Acc: 0.961 Test Loss: 0.338 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0560067
	speed: 0.1675s/iter; left time: 5873.6919s
	iters: 200, epoch: 26 | loss: 0.0047852
	speed: 0.0362s/iter; left time: 1266.6620s
	iters: 300, epoch: 26 | loss: 0.0030952
	speed: 0.0361s/iter; left time: 1258.0689s
	iters: 400, epoch: 26 | loss: 0.0001114
	speed: 0.0303s/iter; left time: 1055.0069s
Epoch: 26 cost time: 15.442004203796387
Epoch: 26, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.250 Vali Acc: 0.966 Test Loss: 0.250 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0011596
	speed: 0.1581s/iter; left time: 5470.3976s
	iters: 200, epoch: 27 | loss: 0.0000008
	speed: 0.0364s/iter; left time: 1255.5433s
	iters: 300, epoch: 27 | loss: 0.3223526
	speed: 0.0299s/iter; left time: 1029.3616s
	iters: 400, epoch: 27 | loss: 0.0008620
	speed: 0.0300s/iter; left time: 1030.1002s
Epoch: 27 cost time: 15.395366668701172
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.1662s/iter; left time: 5675.0062s
	iters: 200, epoch: 28 | loss: 0.0007123
	speed: 0.0294s/iter; left time: 1000.9051s
	iters: 300, epoch: 28 | loss: 0.5249950
	speed: 0.0297s/iter; left time: 1007.6854s
	iters: 400, epoch: 28 | loss: 0.0000002
	speed: 0.0301s/iter; left time: 1017.2356s
Epoch: 28 cost time: 14.266189098358154
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.322 Vali Acc: 0.965 Test Loss: 0.322 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000273
	speed: 0.1715s/iter; left time: 5775.4314s
	iters: 200, epoch: 29 | loss: 0.0039492
	speed: 0.0303s/iter; left time: 1017.6447s
	iters: 300, epoch: 29 | loss: 0.0000295
	speed: 0.0290s/iter; left time: 971.8097s
	iters: 400, epoch: 29 | loss: 0.0027816
	speed: 0.0325s/iter; left time: 1085.1147s
Epoch: 29 cost time: 14.887054443359375
Epoch: 29, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.274 Vali Acc: 0.971 Test Loss: 0.274 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000170
	speed: 0.1704s/iter; left time: 5657.1024s
	iters: 200, epoch: 30 | loss: 0.0000307
	speed: 0.0361s/iter; left time: 1194.6740s
	iters: 300, epoch: 30 | loss: 0.0000778
	speed: 0.0353s/iter; left time: 1163.3488s
	iters: 400, epoch: 30 | loss: 0.0724522
	speed: 0.0317s/iter; left time: 1042.9143s
Epoch: 30 cost time: 16.13128089904785
Epoch: 30, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.959 Test Loss: 0.269 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000676
	speed: 0.1724s/iter; left time: 5641.3234s
	iters: 200, epoch: 31 | loss: 0.0000590
	speed: 0.0325s/iter; left time: 1061.1245s
	iters: 300, epoch: 31 | loss: 0.0000002
	speed: 0.0308s/iter; left time: 1003.2928s
	iters: 400, epoch: 31 | loss: 0.0000759
	speed: 0.0304s/iter; left time: 986.7314s
Epoch: 31 cost time: 15.311563968658447
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.971982 --> -0.974555).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0001396
	speed: 0.1786s/iter; left time: 5763.3101s
	iters: 200, epoch: 32 | loss: 0.0236540
	speed: 0.0306s/iter; left time: 985.3151s
	iters: 300, epoch: 32 | loss: 0.0000001
	speed: 0.0291s/iter; left time: 932.1868s
	iters: 400, epoch: 32 | loss: 0.0000072
	speed: 0.0313s/iter; left time: 999.7926s
Epoch: 32 cost time: 14.894949913024902
Epoch: 32, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.262 Vali Acc: 0.969 Test Loss: 0.262 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0000049
	speed: 0.1708s/iter; left time: 5429.0925s
	iters: 200, epoch: 33 | loss: 0.0118908
	speed: 0.0305s/iter; left time: 968.1421s
	iters: 300, epoch: 33 | loss: 0.0001404
	speed: 0.0332s/iter; left time: 1049.5174s
	iters: 400, epoch: 33 | loss: 0.0000119
	speed: 0.0337s/iter; left time: 1062.6564s
Epoch: 33 cost time: 15.533142328262329
Epoch: 33, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.297 Vali Acc: 0.973 Test Loss: 0.297 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0901150
	speed: 0.1648s/iter; left time: 5162.9169s
	iters: 200, epoch: 34 | loss: 0.0005484
	speed: 0.0349s/iter; left time: 1089.7285s
	iters: 300, epoch: 34 | loss: 0.1878864
	speed: 0.0328s/iter; left time: 1019.6856s
	iters: 400, epoch: 34 | loss: 0.0000012
	speed: 0.0300s/iter; left time: 930.8065s
Epoch: 34 cost time: 15.472419500350952
Epoch: 34, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.376 Vali Acc: 0.959 Test Loss: 0.376 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0000428
	speed: 0.1705s/iter; left time: 5259.9660s
	iters: 200, epoch: 35 | loss: 0.0000054
	speed: 0.0294s/iter; left time: 905.3105s
	iters: 300, epoch: 35 | loss: 0.0207555
	speed: 0.0290s/iter; left time: 887.6647s
	iters: 400, epoch: 35 | loss: 0.0141573
	speed: 0.0297s/iter; left time: 906.0734s
Epoch: 35 cost time: 14.26821517944336
Epoch: 35, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.435 Vali Acc: 0.957 Test Loss: 0.435 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0012295
	speed: 0.1692s/iter; left time: 5140.0891s
	iters: 200, epoch: 36 | loss: 0.0000000
	speed: 0.0298s/iter; left time: 903.5003s
	iters: 300, epoch: 36 | loss: 0.0061430
	speed: 0.0303s/iter; left time: 913.2048s
	iters: 400, epoch: 36 | loss: 0.0000340
	speed: 0.0337s/iter; left time: 1014.8298s
Epoch: 36 cost time: 15.068866491317749
Epoch: 36, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.363 Vali Acc: 0.966 Test Loss: 0.363 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000055
	speed: 0.1669s/iter; left time: 4992.0451s
	iters: 200, epoch: 37 | loss: 0.0000126
	speed: 0.0312s/iter; left time: 931.3394s
	iters: 300, epoch: 37 | loss: 0.0000013
	speed: 0.0359s/iter; left time: 1065.5990s
	iters: 400, epoch: 37 | loss: 0.0000321
	speed: 0.0354s/iter; left time: 1049.0429s
Epoch: 37 cost time: 15.901192903518677
Epoch: 37, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.286 Vali Acc: 0.964 Test Loss: 0.286 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0436252
	speed: 0.1680s/iter; left time: 4947.6280s
	iters: 200, epoch: 38 | loss: 0.0000096
	speed: 0.0323s/iter; left time: 948.9766s
	iters: 300, epoch: 38 | loss: 0.0000327
	speed: 0.0309s/iter; left time: 904.9242s
	iters: 400, epoch: 38 | loss: 0.1742580
	speed: 0.0317s/iter; left time: 923.2626s
Epoch: 38 cost time: 15.460835218429565
Epoch: 38, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.267 Vali Acc: 0.967 Test Loss: 0.267 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0004953
	speed: 0.1770s/iter; left time: 5130.5887s
	iters: 200, epoch: 39 | loss: 0.0042721
	speed: 0.0323s/iter; left time: 931.4559s
	iters: 300, epoch: 39 | loss: 0.0000478
	speed: 0.0311s/iter; left time: 894.8681s
	iters: 400, epoch: 39 | loss: 0.0006636
	speed: 0.0309s/iter; left time: 885.6250s
Epoch: 39 cost time: 15.48209834098816
Epoch: 39, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.450 Vali Acc: 0.943 Test Loss: 0.450 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0000878
	speed: 0.1701s/iter; left time: 4850.6709s
	iters: 200, epoch: 40 | loss: 0.0047057
	speed: 0.0338s/iter; left time: 960.8301s
	iters: 300, epoch: 40 | loss: 0.0002346
	speed: 0.0358s/iter; left time: 1013.0670s
	iters: 400, epoch: 40 | loss: 0.0000101
	speed: 0.0339s/iter; left time: 956.9588s
Epoch: 40 cost time: 15.99750566482544
Epoch: 40, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.314 Vali Acc: 0.961 Test Loss: 0.314 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0000765
	speed: 0.1703s/iter; left time: 4775.1787s
	iters: 200, epoch: 41 | loss: 0.0157456
	speed: 0.0366s/iter; left time: 1023.6061s
	iters: 300, epoch: 41 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 952.6113s
	iters: 400, epoch: 41 | loss: 0.0000000
	speed: 0.0306s/iter; left time: 849.9261s
Epoch: 41 cost time: 16.390311002731323
Epoch: 41, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.275 Vali Acc: 0.966 Test Loss: 0.275 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 1625122
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5380340
	speed: 0.0516s/iter; left time: 2413.0230s
	iters: 200, epoch: 1 | loss: 0.0598025
	speed: 0.0331s/iter; left time: 1547.3916s
	iters: 300, epoch: 1 | loss: 0.0435879
	speed: 0.0294s/iter; left time: 1368.0108s
	iters: 400, epoch: 1 | loss: 0.0062660
	speed: 0.0300s/iter; left time: 1393.6495s
Epoch: 1 cost time: 16.56059241294861
Epoch: 1, Steps: 469 | Train Loss: 0.342 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (inf --> -0.953114).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0041094
	speed: 0.1647s/iter; left time: 7630.0526s
	iters: 200, epoch: 2 | loss: 0.0980849
	speed: 0.0278s/iter; left time: 1284.8291s
	iters: 300, epoch: 2 | loss: 0.0094833
	speed: 0.0282s/iter; left time: 1299.5966s
	iters: 400, epoch: 2 | loss: 0.0283339
	speed: 0.0284s/iter; left time: 1307.3100s
Epoch: 2 cost time: 14.185587882995605
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.953114 --> -0.957688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0001375
	speed: 0.1720s/iter; left time: 7888.0656s
	iters: 200, epoch: 3 | loss: 0.0017961
	speed: 0.0311s/iter; left time: 1423.4420s
	iters: 300, epoch: 3 | loss: 0.0059561
	speed: 0.0335s/iter; left time: 1529.8644s
	iters: 400, epoch: 3 | loss: 0.0070381
	speed: 0.0325s/iter; left time: 1479.6400s
Epoch: 3 cost time: 15.077239274978638
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0037365
	speed: 0.1589s/iter; left time: 7213.2549s
	iters: 200, epoch: 4 | loss: 0.1365716
	speed: 0.0356s/iter; left time: 1611.5918s
	iters: 300, epoch: 4 | loss: 0.0016227
	speed: 0.0357s/iter; left time: 1612.9821s
	iters: 400, epoch: 4 | loss: 0.0026172
	speed: 0.0294s/iter; left time: 1326.8941s
Epoch: 4 cost time: 15.41510534286499
Epoch: 4, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.957688 --> -0.963406).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0003154
	speed: 0.1575s/iter; left time: 7074.5746s
	iters: 200, epoch: 5 | loss: 0.0000771
	speed: 0.0319s/iter; left time: 1430.2039s
	iters: 300, epoch: 5 | loss: 0.0003454
	speed: 0.0273s/iter; left time: 1221.3108s
	iters: 400, epoch: 5 | loss: 0.0854268
	speed: 0.0318s/iter; left time: 1419.0064s
Epoch: 5 cost time: 14.5450758934021
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.968552).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1101206
	speed: 0.1692s/iter; left time: 7519.8520s
	iters: 200, epoch: 6 | loss: 0.0074153
	speed: 0.0305s/iter; left time: 1353.5594s
	iters: 300, epoch: 6 | loss: 0.0007877
	speed: 0.0283s/iter; left time: 1252.7099s
	iters: 400, epoch: 6 | loss: 0.0000302
	speed: 0.0293s/iter; left time: 1295.0329s
Epoch: 6 cost time: 14.456478118896484
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.968552 --> -0.977128).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000124
	speed: 0.1681s/iter; left time: 7392.9382s
	iters: 200, epoch: 7 | loss: 0.0000073
	speed: 0.0319s/iter; left time: 1400.4157s
	iters: 300, epoch: 7 | loss: 0.4140444
	speed: 0.0329s/iter; left time: 1438.4098s
	iters: 400, epoch: 7 | loss: 0.2697117
	speed: 0.0351s/iter; left time: 1534.6058s
Epoch: 7 cost time: 15.705343008041382
Epoch: 7, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0003630
	speed: 0.1661s/iter; left time: 7227.9494s
	iters: 200, epoch: 8 | loss: 0.1483239
	speed: 0.0359s/iter; left time: 1557.3922s
	iters: 300, epoch: 8 | loss: 0.0000066
	speed: 0.0332s/iter; left time: 1436.2952s
	iters: 400, epoch: 8 | loss: 0.0000481
	speed: 0.0296s/iter; left time: 1279.5703s
Epoch: 8 cost time: 15.543761968612671
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.342 Vali Acc: 0.953 Test Loss: 0.342 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.1566s/iter; left time: 6741.8746s
	iters: 200, epoch: 9 | loss: 0.0096239
	speed: 0.0230s/iter; left time: 986.8832s
	iters: 300, epoch: 9 | loss: 0.1606043
	speed: 0.0235s/iter; left time: 1006.4766s
	iters: 400, epoch: 9 | loss: 0.0036686
	speed: 0.0213s/iter; left time: 912.0020s
Epoch: 9 cost time: 11.314403533935547
Epoch: 9, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.966 Test Loss: 0.258 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000002
	speed: 0.1599s/iter; left time: 6808.1174s
	iters: 200, epoch: 10 | loss: 0.0000019
	speed: 0.0298s/iter; left time: 1265.2038s
	iters: 300, epoch: 10 | loss: 0.0020803
	speed: 0.0306s/iter; left time: 1297.8275s
	iters: 400, epoch: 10 | loss: 0.0065924
	speed: 0.0262s/iter; left time: 1107.0711s
Epoch: 10 cost time: 14.46027135848999
Epoch: 10, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000001
	speed: 0.1577s/iter; left time: 6640.1980s
	iters: 200, epoch: 11 | loss: 0.0001230
	speed: 0.0282s/iter; left time: 1185.8204s
	iters: 300, epoch: 11 | loss: 0.0147825
	speed: 0.0330s/iter; left time: 1381.3638s
	iters: 400, epoch: 11 | loss: 0.0000074
	speed: 0.0330s/iter; left time: 1377.9890s
Epoch: 11 cost time: 14.639796495437622
Epoch: 11, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0201232
	speed: 0.1557s/iter; left time: 6485.0124s
	iters: 200, epoch: 12 | loss: 0.4273374
	speed: 0.0313s/iter; left time: 1299.8479s
	iters: 300, epoch: 12 | loss: 0.0000692
	speed: 0.0268s/iter; left time: 1112.4719s
	iters: 400, epoch: 12 | loss: 0.0000037
	speed: 0.0290s/iter; left time: 1200.3055s
Epoch: 12 cost time: 14.116363763809204
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.306 Vali Acc: 0.964 Test Loss: 0.306 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000632
	speed: 0.1612s/iter; left time: 6635.2781s
	iters: 200, epoch: 13 | loss: 0.0747068
	speed: 0.0269s/iter; left time: 1105.9233s
	iters: 300, epoch: 13 | loss: 0.0001803
	speed: 0.0279s/iter; left time: 1143.6161s
	iters: 400, epoch: 13 | loss: 0.0059731
	speed: 0.0282s/iter; left time: 1152.6576s
Epoch: 13 cost time: 13.63815689086914
Epoch: 13, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.350 Vali Acc: 0.967 Test Loss: 0.350 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0011265
	speed: 0.1586s/iter; left time: 6457.2581s
	iters: 200, epoch: 14 | loss: 0.0028291
	speed: 0.0289s/iter; left time: 1171.6766s
	iters: 300, epoch: 14 | loss: 0.0045129
	speed: 0.0289s/iter; left time: 1170.9024s
	iters: 400, epoch: 14 | loss: 0.1006212
	speed: 0.0349s/iter; left time: 1408.4384s
Epoch: 14 cost time: 14.729997158050537
Epoch: 14, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
Validation loss decreased (-0.977128 --> -0.978843).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0013127
	speed: 0.1673s/iter; left time: 6732.8113s
	iters: 200, epoch: 15 | loss: 0.0000287
	speed: 0.0252s/iter; left time: 1009.5251s
	iters: 300, epoch: 15 | loss: 0.0000000
	speed: 0.0305s/iter; left time: 1219.2273s
	iters: 400, epoch: 15 | loss: 0.0001050
	speed: 0.0319s/iter; left time: 1272.5324s
Epoch: 15 cost time: 14.01203441619873
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0002484
	speed: 0.1634s/iter; left time: 6499.1018s
	iters: 200, epoch: 16 | loss: 0.0000007
	speed: 0.0322s/iter; left time: 1276.8558s
	iters: 300, epoch: 16 | loss: 0.8173714
	speed: 0.0300s/iter; left time: 1188.6400s
	iters: 400, epoch: 16 | loss: 0.0597417
	speed: 0.0297s/iter; left time: 1170.3366s
Epoch: 16 cost time: 15.017760276794434
Epoch: 16, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.979 Test Loss: 0.220 Test Acc: 0.979
Validation loss decreased (-0.978843 --> -0.979415).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1062842
	speed: 0.1629s/iter; left time: 6401.7038s
	iters: 200, epoch: 17 | loss: 0.0000004
	speed: 0.0318s/iter; left time: 1245.4975s
	iters: 300, epoch: 17 | loss: 0.0000000
	speed: 0.0321s/iter; left time: 1254.4673s
	iters: 400, epoch: 17 | loss: 0.4413829
	speed: 0.0359s/iter; left time: 1398.6370s
Epoch: 17 cost time: 15.89773154258728
Epoch: 17, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1571s/iter; left time: 6101.6600s
	iters: 200, epoch: 18 | loss: 0.0411652
	speed: 0.0311s/iter; left time: 1202.5258s
	iters: 300, epoch: 18 | loss: 0.0000169
	speed: 0.0327s/iter; left time: 1261.6438s
	iters: 400, epoch: 18 | loss: 0.0000129
	speed: 0.0296s/iter; left time: 1141.2802s
Epoch: 18 cost time: 14.497371435165405
Epoch: 18, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000194
	speed: 0.1627s/iter; left time: 6241.9962s
	iters: 200, epoch: 19 | loss: 0.0000013
	speed: 0.0299s/iter; left time: 1144.6958s
	iters: 300, epoch: 19 | loss: 0.0080051
	speed: 0.0284s/iter; left time: 1082.0922s
	iters: 400, epoch: 19 | loss: 0.0021471
	speed: 0.0264s/iter; left time: 1005.9071s
Epoch: 19 cost time: 14.061030864715576
Epoch: 19, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.366 Vali Acc: 0.961 Test Loss: 0.366 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0000130
	speed: 0.1563s/iter; left time: 5923.0042s
	iters: 200, epoch: 20 | loss: 0.0000314
	speed: 0.0288s/iter; left time: 1086.7405s
	iters: 300, epoch: 20 | loss: 0.0031804
	speed: 0.0303s/iter; left time: 1143.7682s
	iters: 400, epoch: 20 | loss: 0.0000188
	speed: 0.0294s/iter; left time: 1103.6802s
Epoch: 20 cost time: 14.310656547546387
Epoch: 20, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.240 Vali Acc: 0.973 Test Loss: 0.240 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000207
	speed: 0.1600s/iter; left time: 5988.9803s
	iters: 200, epoch: 21 | loss: 0.0529177
	speed: 0.0275s/iter; left time: 1025.7830s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0324s/iter; left time: 1206.6304s
	iters: 400, epoch: 21 | loss: 0.0000000
	speed: 0.0320s/iter; left time: 1186.9434s
Epoch: 21 cost time: 14.260387182235718
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.318 Vali Acc: 0.974 Test Loss: 0.318 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.4410961
	speed: 0.1478s/iter; left time: 5460.3442s
	iters: 200, epoch: 22 | loss: 0.0003532
	speed: 0.0337s/iter; left time: 1240.6525s
	iters: 300, epoch: 22 | loss: 0.0000004
	speed: 0.0303s/iter; left time: 1114.3212s
	iters: 400, epoch: 22 | loss: 0.0001592
	speed: 0.0296s/iter; left time: 1084.4052s
Epoch: 22 cost time: 15.24450421333313
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000032
	speed: 0.1708s/iter; left time: 6233.0574s
	iters: 200, epoch: 23 | loss: 0.0000091
	speed: 0.0294s/iter; left time: 1069.8341s
	iters: 300, epoch: 23 | loss: 0.0000001
	speed: 0.0276s/iter; left time: 1002.8283s
	iters: 400, epoch: 23 | loss: 0.0000025
	speed: 0.0292s/iter; left time: 1056.8092s
Epoch: 23 cost time: 14.451176881790161
Epoch: 23, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.298 Vali Acc: 0.969 Test Loss: 0.298 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0000640
	speed: 0.1778s/iter; left time: 6404.1457s
	iters: 200, epoch: 24 | loss: 0.5578134
	speed: 0.0327s/iter; left time: 1175.0573s
	iters: 300, epoch: 24 | loss: 0.0000137
	speed: 0.0297s/iter; left time: 1061.8864s
	iters: 400, epoch: 24 | loss: 0.5324047
	speed: 0.0346s/iter; left time: 1237.1096s
Epoch: 24 cost time: 15.555793285369873
Epoch: 24, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.328 Vali Acc: 0.975 Test Loss: 0.328 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1639s/iter; left time: 5827.0317s
	iters: 200, epoch: 25 | loss: 0.0000000
	speed: 0.0360s/iter; left time: 1274.6884s
	iters: 300, epoch: 25 | loss: 0.0001547
	speed: 0.0364s/iter; left time: 1286.1360s
	iters: 400, epoch: 25 | loss: 0.0000732
	speed: 0.0317s/iter; left time: 1117.8546s
Epoch: 25 cost time: 16.194104194641113
Epoch: 25, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.372 Vali Acc: 0.967 Test Loss: 0.372 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.2931918
	speed: 0.1697s/iter; left time: 5950.9157s
	iters: 200, epoch: 26 | loss: 0.0000116
	speed: 0.0305s/iter; left time: 1066.3890s
	iters: 300, epoch: 26 | loss: 0.0000008
	speed: 0.0296s/iter; left time: 1031.5863s
	iters: 400, epoch: 26 | loss: 0.0385039
	speed: 0.0323s/iter; left time: 1123.1588s
Epoch: 26 cost time: 14.837904930114746
Epoch: 26, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.340 Vali Acc: 0.971 Test Loss: 0.340 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 1625122
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3094826
	speed: 0.0556s/iter; left time: 2602.6258s
	iters: 200, epoch: 1 | loss: 0.0852725
	speed: 0.0331s/iter; left time: 1543.9795s
	iters: 300, epoch: 1 | loss: 0.0348352
	speed: 0.0308s/iter; left time: 1434.0486s
	iters: 400, epoch: 1 | loss: 0.1088756
	speed: 0.0297s/iter; left time: 1382.0250s
Epoch: 1 cost time: 16.874523162841797
Epoch: 1, Steps: 469 | Train Loss: 0.352 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (inf --> -0.955687).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0076332
	speed: 0.1556s/iter; left time: 7211.4517s
	iters: 200, epoch: 2 | loss: 0.0579322
	speed: 0.0299s/iter; left time: 1384.1262s
	iters: 300, epoch: 2 | loss: 0.1670140
	speed: 0.0287s/iter; left time: 1322.9008s
	iters: 400, epoch: 2 | loss: 0.0209324
	speed: 0.0321s/iter; left time: 1476.9885s
Epoch: 2 cost time: 14.01472020149231
Epoch: 2, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
Validation loss decreased (-0.955687 --> -0.962834).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0297873
	speed: 0.1633s/iter; left time: 7491.4438s
	iters: 200, epoch: 3 | loss: 0.0110630
	speed: 0.0297s/iter; left time: 1359.7984s
	iters: 300, epoch: 3 | loss: 0.0058672
	speed: 0.0287s/iter; left time: 1309.8875s
	iters: 400, epoch: 3 | loss: 0.0164460
	speed: 0.0324s/iter; left time: 1478.4453s
Epoch: 3 cost time: 14.562361478805542
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0059106
	speed: 0.1597s/iter; left time: 7250.2163s
	iters: 200, epoch: 4 | loss: 0.4555622
	speed: 0.0338s/iter; left time: 1531.8781s
	iters: 300, epoch: 4 | loss: 0.0317467
	speed: 0.0348s/iter; left time: 1571.5991s
	iters: 400, epoch: 4 | loss: 0.0009038
	speed: 0.0313s/iter; left time: 1409.9286s
Epoch: 4 cost time: 15.519996404647827
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.962834 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0131142
	speed: 0.1678s/iter; left time: 7540.3102s
	iters: 200, epoch: 5 | loss: 0.5627617
	speed: 0.0321s/iter; left time: 1437.9253s
	iters: 300, epoch: 5 | loss: 0.0196846
	speed: 0.0284s/iter; left time: 1270.5827s
	iters: 400, epoch: 5 | loss: 0.0028486
	speed: 0.0321s/iter; left time: 1432.0782s
Epoch: 5 cost time: 15.153908252716064
Epoch: 5, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.971125 --> -0.977415).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009144
	speed: 0.1587s/iter; left time: 7052.9857s
	iters: 200, epoch: 6 | loss: 0.0987792
	speed: 0.0260s/iter; left time: 1153.1708s
	iters: 300, epoch: 6 | loss: 0.0097795
	speed: 0.0260s/iter; left time: 1149.1372s
	iters: 400, epoch: 6 | loss: 0.0074268
	speed: 0.0337s/iter; left time: 1487.4048s
Epoch: 6 cost time: 13.977496862411499
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0053267
	speed: 0.1728s/iter; left time: 7602.8385s
	iters: 200, epoch: 7 | loss: 0.4136550
	speed: 0.0365s/iter; left time: 1602.7640s
	iters: 300, epoch: 7 | loss: 0.3526712
	speed: 0.0343s/iter; left time: 1501.3534s
	iters: 400, epoch: 7 | loss: 0.0007670
	speed: 0.0314s/iter; left time: 1372.8760s
Epoch: 7 cost time: 15.838323593139648
Epoch: 7, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0012066
	speed: 0.1609s/iter; left time: 7003.6738s
	iters: 200, epoch: 8 | loss: 0.0017245
	speed: 0.0316s/iter; left time: 1371.2871s
	iters: 300, epoch: 8 | loss: 0.0006989
	speed: 0.0309s/iter; left time: 1338.3835s
	iters: 400, epoch: 8 | loss: 0.1613245
	speed: 0.0306s/iter; left time: 1321.7870s
Epoch: 8 cost time: 15.081802606582642
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000113
	speed: 0.1640s/iter; left time: 7059.8678s
	iters: 200, epoch: 9 | loss: 0.0143149
	speed: 0.0279s/iter; left time: 1197.0469s
	iters: 300, epoch: 9 | loss: 0.1849347
	speed: 0.0327s/iter; left time: 1402.1453s
	iters: 400, epoch: 9 | loss: 0.0001601
	speed: 0.0323s/iter; left time: 1380.2849s
Epoch: 9 cost time: 14.567112445831299
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0019982
	speed: 0.1614s/iter; left time: 6872.8350s
	iters: 200, epoch: 10 | loss: 0.1570462
	speed: 0.0335s/iter; left time: 1422.9263s
	iters: 300, epoch: 10 | loss: 0.0797698
	speed: 0.0304s/iter; left time: 1287.7715s
	iters: 400, epoch: 10 | loss: 0.1246128
	speed: 0.0275s/iter; left time: 1161.6729s
Epoch: 10 cost time: 14.55087924003601
Epoch: 10, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0172321
	speed: 0.1535s/iter; left time: 6463.5166s
	iters: 200, epoch: 11 | loss: 0.0010959
	speed: 0.0294s/iter; left time: 1236.5721s
	iters: 300, epoch: 11 | loss: 0.0002726
	speed: 0.0293s/iter; left time: 1228.7111s
	iters: 400, epoch: 11 | loss: 0.0863740
	speed: 0.0291s/iter; left time: 1215.2996s
Epoch: 11 cost time: 13.947313070297241
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0027968
	speed: 0.1651s/iter; left time: 6875.0601s
	iters: 200, epoch: 12 | loss: 0.0030147
	speed: 0.0294s/iter; left time: 1220.4766s
	iters: 300, epoch: 12 | loss: 0.0799064
	speed: 0.0283s/iter; left time: 1170.8715s
	iters: 400, epoch: 12 | loss: 0.0016163
	speed: 0.0322s/iter; left time: 1329.5551s
Epoch: 12 cost time: 14.265509843826294
Epoch: 12, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0102108
	speed: 0.1661s/iter; left time: 6840.1952s
	iters: 200, epoch: 13 | loss: 0.0000743
	speed: 0.0355s/iter; left time: 1458.3654s
	iters: 300, epoch: 13 | loss: 0.2938271
	speed: 0.0347s/iter; left time: 1421.5328s
	iters: 400, epoch: 13 | loss: 0.1546560
	speed: 0.0307s/iter; left time: 1256.0630s
Epoch: 13 cost time: 15.686105728149414
Epoch: 13, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0161256
	speed: 0.1681s/iter; left time: 6842.2320s
	iters: 200, epoch: 14 | loss: 0.0000296
	speed: 0.0322s/iter; left time: 1305.4334s
	iters: 300, epoch: 14 | loss: 0.0145236
	speed: 0.0308s/iter; left time: 1247.0874s
	iters: 400, epoch: 14 | loss: 0.0002675
	speed: 0.0331s/iter; left time: 1335.4590s
Epoch: 14 cost time: 15.596639394760132
Epoch: 14, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0007735
	speed: 0.1699s/iter; left time: 6836.4607s
	iters: 200, epoch: 15 | loss: 0.0005670
	speed: 0.0289s/iter; left time: 1161.0395s
	iters: 300, epoch: 15 | loss: 0.0008517
	speed: 0.0320s/iter; left time: 1280.7669s
	iters: 400, epoch: 15 | loss: 0.0010349
	speed: 0.0373s/iter; left time: 1488.0940s
Epoch: 15 cost time: 15.70369267463684
Epoch: 15, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
Validation loss decreased (-0.977415 --> -0.980559).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0260651
	speed: 0.1715s/iter; left time: 6818.3285s
	iters: 200, epoch: 16 | loss: 0.0000043
	speed: 0.0368s/iter; left time: 1461.2829s
	iters: 300, epoch: 16 | loss: 0.0027016
	speed: 0.0359s/iter; left time: 1421.5784s
	iters: 400, epoch: 16 | loss: 0.0001804
	speed: 0.0293s/iter; left time: 1156.0410s
Epoch: 16 cost time: 15.787822246551514
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000494
	speed: 0.1783s/iter; left time: 7006.2394s
	iters: 200, epoch: 17 | loss: 0.0000137
	speed: 0.0308s/iter; left time: 1208.1140s
	iters: 300, epoch: 17 | loss: 0.0002046
	speed: 0.0227s/iter; left time: 888.3540s
	iters: 400, epoch: 17 | loss: 0.0033334
	speed: 0.0222s/iter; left time: 864.3063s
Epoch: 17 cost time: 13.86022663116455
Epoch: 17, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0013515
	speed: 0.1204s/iter; left time: 4674.0859s
	iters: 200, epoch: 18 | loss: 0.0604810
	speed: 0.0220s/iter; left time: 851.4936s
	iters: 300, epoch: 18 | loss: 0.0088845
	speed: 0.0244s/iter; left time: 944.0022s
	iters: 400, epoch: 18 | loss: 0.0069349
	speed: 0.0289s/iter; left time: 1111.7304s
Epoch: 18 cost time: 12.38805079460144
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0594958
	speed: 0.1635s/iter; left time: 6272.1647s
	iters: 200, epoch: 19 | loss: 0.0046652
	speed: 0.0295s/iter; left time: 1126.9068s
	iters: 300, epoch: 19 | loss: 0.2718989
	speed: 0.0330s/iter; left time: 1257.9678s
	iters: 400, epoch: 19 | loss: 0.0001552
	speed: 0.0329s/iter; left time: 1250.2497s
Epoch: 19 cost time: 14.678783893585205
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.234 Vali Acc: 0.965 Test Loss: 0.234 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.2240790
	speed: 0.1594s/iter; left time: 6039.2236s
	iters: 200, epoch: 20 | loss: 0.2873291
	speed: 0.0329s/iter; left time: 1241.4773s
	iters: 300, epoch: 20 | loss: 0.0475294
	speed: 0.0305s/iter; left time: 1150.4237s
	iters: 400, epoch: 20 | loss: 0.0054991
	speed: 0.0307s/iter; left time: 1155.1554s
Epoch: 20 cost time: 15.18847942352295
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0002241
	speed: 0.1598s/iter; left time: 5980.0525s
	iters: 200, epoch: 21 | loss: 0.0000041
	speed: 0.0272s/iter; left time: 1014.2843s
	iters: 300, epoch: 21 | loss: 0.0027883
	speed: 0.0286s/iter; left time: 1065.7499s
	iters: 400, epoch: 21 | loss: 0.0143159
	speed: 0.0288s/iter; left time: 1069.0138s
Epoch: 21 cost time: 13.694544076919556
Epoch: 21, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1936901
	speed: 0.1563s/iter; left time: 5775.1314s
	iters: 200, epoch: 22 | loss: 0.0000086
	speed: 0.0280s/iter; left time: 1031.9716s
	iters: 300, epoch: 22 | loss: 0.0047901
	speed: 0.0277s/iter; left time: 1019.0169s
	iters: 400, epoch: 22 | loss: 0.0004694
	speed: 0.0350s/iter; left time: 1281.6443s
Epoch: 22 cost time: 14.638068914413452
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.2477317
	speed: 0.1798s/iter; left time: 6561.3633s
	iters: 200, epoch: 23 | loss: 0.0019849
	speed: 0.0346s/iter; left time: 1260.0012s
	iters: 300, epoch: 23 | loss: 0.0473643
	speed: 0.0380s/iter; left time: 1377.2434s
	iters: 400, epoch: 23 | loss: 0.0000107
	speed: 0.0353s/iter; left time: 1278.6674s
Epoch: 23 cost time: 16.700575590133667
Epoch: 23, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.2246692
	speed: 0.1742s/iter; left time: 6273.6612s
	iters: 200, epoch: 24 | loss: 0.0521531
	speed: 0.0338s/iter; left time: 1213.8443s
	iters: 300, epoch: 24 | loss: 0.0031251
	speed: 0.0344s/iter; left time: 1233.2193s
	iters: 400, epoch: 24 | loss: 0.0520542
	speed: 0.0327s/iter; left time: 1167.7556s
Epoch: 24 cost time: 16.54493999481201
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.974 Test Loss: 0.195 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0001245
	speed: 0.1707s/iter; left time: 6068.1830s
	iters: 200, epoch: 25 | loss: 0.0000046
	speed: 0.0273s/iter; left time: 966.8403s
	iters: 300, epoch: 25 | loss: 0.0036962
	speed: 0.0288s/iter; left time: 1016.8916s
	iters: 400, epoch: 25 | loss: 0.0014515
	speed: 0.0313s/iter; left time: 1103.2085s
Epoch: 25 cost time: 14.719109773635864
Epoch: 25, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.216 Vali Acc: 0.969 Test Loss: 0.216 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 1100834
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2953118
	speed: 0.0495s/iter; left time: 2315.8456s
	iters: 200, epoch: 1 | loss: 0.0623617
	speed: 0.0274s/iter; left time: 1281.7775s
	iters: 300, epoch: 1 | loss: 0.0239382
	speed: 0.0308s/iter; left time: 1434.4276s
	iters: 400, epoch: 1 | loss: 0.0633384
	speed: 0.0321s/iter; left time: 1491.9105s
Epoch: 1 cost time: 16.482550621032715
Epoch: 1, Steps: 469 | Train Loss: 0.351 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
Validation loss decreased (inf --> -0.961405).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0060173
	speed: 0.1764s/iter; left time: 8174.5451s
	iters: 200, epoch: 2 | loss: 0.0932641
	speed: 0.0284s/iter; left time: 1314.9471s
	iters: 300, epoch: 2 | loss: 0.1443014
	speed: 0.0296s/iter; left time: 1363.9264s
	iters: 400, epoch: 2 | loss: 0.0076766
	speed: 0.0339s/iter; left time: 1561.8783s
Epoch: 2 cost time: 14.864028692245483
Epoch: 2, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0042219
	speed: 0.1691s/iter; left time: 7757.2888s
	iters: 200, epoch: 3 | loss: 0.0214009
	speed: 0.0362s/iter; left time: 1655.6611s
	iters: 300, epoch: 3 | loss: 0.0053080
	speed: 0.0352s/iter; left time: 1605.4095s
	iters: 400, epoch: 3 | loss: 0.1333984
	speed: 0.0320s/iter; left time: 1460.0372s
Epoch: 3 cost time: 15.929032325744629
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.961405 --> -0.963406).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0052195
	speed: 0.1663s/iter; left time: 7547.4302s
	iters: 200, epoch: 4 | loss: 0.0111287
	speed: 0.0329s/iter; left time: 1490.5220s
	iters: 300, epoch: 4 | loss: 0.0032924
	speed: 0.0307s/iter; left time: 1388.6444s
	iters: 400, epoch: 4 | loss: 0.0254798
	speed: 0.0310s/iter; left time: 1398.0955s
Epoch: 4 cost time: 15.755767583847046
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.951 Test Loss: 0.232 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0115556
	speed: 0.1716s/iter; left time: 7708.2610s
	iters: 200, epoch: 5 | loss: 0.2780332
	speed: 0.0301s/iter; left time: 1349.8036s
	iters: 300, epoch: 5 | loss: 0.0033822
	speed: 0.0288s/iter; left time: 1289.3202s
	iters: 400, epoch: 5 | loss: 0.1099666
	speed: 0.0309s/iter; left time: 1380.8570s
Epoch: 5 cost time: 14.743249654769897
Epoch: 5, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0002533
	speed: 0.1850s/iter; left time: 8226.4099s
	iters: 200, epoch: 6 | loss: 0.1207678
	speed: 0.0335s/iter; left time: 1486.9407s
	iters: 300, epoch: 6 | loss: 0.0000935
	speed: 0.0327s/iter; left time: 1449.3543s
	iters: 400, epoch: 6 | loss: 0.0119804
	speed: 0.0351s/iter; left time: 1549.0030s
Epoch: 6 cost time: 16.558271646499634
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.966 Test Loss: 0.188 Test Acc: 0.966
Validation loss decreased (-0.963406 --> -0.965693).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0427864
	speed: 0.1742s/iter; left time: 7660.7834s
	iters: 200, epoch: 7 | loss: 0.3664376
	speed: 0.0357s/iter; left time: 1567.8426s
	iters: 300, epoch: 7 | loss: 0.6972546
	speed: 0.0373s/iter; left time: 1632.0287s
	iters: 400, epoch: 7 | loss: 0.0182826
	speed: 0.0339s/iter; left time: 1482.9555s
Epoch: 7 cost time: 16.973177671432495
Epoch: 7, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.965 Test Loss: 0.220 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2962087
	speed: 0.1726s/iter; left time: 7512.2907s
	iters: 200, epoch: 8 | loss: 0.0001298
	speed: 0.0309s/iter; left time: 1342.4511s
	iters: 300, epoch: 8 | loss: 0.0001797
	speed: 0.0318s/iter; left time: 1379.0330s
	iters: 400, epoch: 8 | loss: 0.2236845
	speed: 0.0312s/iter; left time: 1347.5921s
Epoch: 8 cost time: 15.568596363067627
Epoch: 8, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.228 Vali Acc: 0.962 Test Loss: 0.228 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000418
	speed: 0.1755s/iter; left time: 7553.3367s
	iters: 200, epoch: 9 | loss: 0.0031506
	speed: 0.0299s/iter; left time: 1282.3993s
	iters: 300, epoch: 9 | loss: 0.0022430
	speed: 0.0297s/iter; left time: 1270.9081s
	iters: 400, epoch: 9 | loss: 0.0667502
	speed: 0.0324s/iter; left time: 1383.0463s
Epoch: 9 cost time: 15.396075248718262
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.967122).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0001139
	speed: 0.1683s/iter; left time: 7167.7120s
	iters: 200, epoch: 10 | loss: 0.4693958
	speed: 0.0304s/iter; left time: 1293.1531s
	iters: 300, epoch: 10 | loss: 0.0345617
	speed: 0.0350s/iter; left time: 1482.4149s
	iters: 400, epoch: 10 | loss: 0.0000038
	speed: 0.0363s/iter; left time: 1535.4517s
Epoch: 10 cost time: 16.116719007492065
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0031823
	speed: 0.1604s/iter; left time: 6754.4409s
	iters: 200, epoch: 11 | loss: 0.0048503
	speed: 0.0361s/iter; left time: 1516.0031s
	iters: 300, epoch: 11 | loss: 0.0085883
	speed: 0.0352s/iter; left time: 1475.7503s
	iters: 400, epoch: 11 | loss: 0.0000050
	speed: 0.0333s/iter; left time: 1390.7258s
Epoch: 11 cost time: 15.847986936569214
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0108296
	speed: 0.1698s/iter; left time: 7071.6506s
	iters: 200, epoch: 12 | loss: 0.0501450
	speed: 0.0349s/iter; left time: 1448.1295s
	iters: 300, epoch: 12 | loss: 0.0155245
	speed: 0.0301s/iter; left time: 1248.4894s
	iters: 400, epoch: 12 | loss: 0.0004320
	speed: 0.0300s/iter; left time: 1238.8587s
Epoch: 12 cost time: 15.531015396118164
Epoch: 12, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.221 Vali Acc: 0.966 Test Loss: 0.221 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0083618
	speed: 0.1734s/iter; left time: 7138.5471s
	iters: 200, epoch: 13 | loss: 0.0000465
	speed: 0.0332s/iter; left time: 1364.5680s
	iters: 300, epoch: 13 | loss: 0.0649602
	speed: 0.0338s/iter; left time: 1383.4545s
	iters: 400, epoch: 13 | loss: 0.0014777
	speed: 0.0340s/iter; left time: 1390.5937s
Epoch: 13 cost time: 16.137722730636597
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.966 Test Loss: 0.199 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0206279
	speed: 0.1716s/iter; left time: 6983.3335s
	iters: 200, epoch: 14 | loss: 0.0005431
	speed: 0.0306s/iter; left time: 1240.7442s
	iters: 300, epoch: 14 | loss: 0.0065837
	speed: 0.0300s/iter; left time: 1213.9404s
	iters: 400, epoch: 14 | loss: 0.0114642
	speed: 0.0323s/iter; left time: 1304.2625s
Epoch: 14 cost time: 14.985677719116211
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.955 Test Loss: 0.230 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0002231
	speed: 0.1798s/iter; left time: 7235.4752s
	iters: 200, epoch: 15 | loss: 0.0000090
	speed: 0.0345s/iter; left time: 1383.5307s
	iters: 300, epoch: 15 | loss: 0.0000135
	speed: 0.0332s/iter; left time: 1327.5570s
	iters: 400, epoch: 15 | loss: 0.0965446
	speed: 0.0345s/iter; left time: 1378.1748s
Epoch: 15 cost time: 16.581969022750854
Epoch: 15, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.1239395
	speed: 0.1742s/iter; left time: 6927.1552s
	iters: 200, epoch: 16 | loss: 0.0192400
	speed: 0.0334s/iter; left time: 1322.8778s
	iters: 300, epoch: 16 | loss: 0.0000686
	speed: 0.0329s/iter; left time: 1301.2417s
	iters: 400, epoch: 16 | loss: 0.0002662
	speed: 0.0325s/iter; left time: 1282.9727s
Epoch: 16 cost time: 15.829436302185059
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.287 Vali Acc: 0.953 Test Loss: 0.287 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000022
	speed: 0.1718s/iter; left time: 6750.9182s
	iters: 200, epoch: 17 | loss: 0.0000063
	speed: 0.0294s/iter; left time: 1152.6490s
	iters: 300, epoch: 17 | loss: 0.0000220
	speed: 0.0341s/iter; left time: 1335.0712s
	iters: 400, epoch: 17 | loss: 0.0017783
	speed: 0.0351s/iter; left time: 1367.7576s
Epoch: 17 cost time: 15.62268853187561
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.285 Vali Acc: 0.965 Test Loss: 0.285 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0005320
	speed: 0.1712s/iter; left time: 6648.8329s
	iters: 200, epoch: 18 | loss: 0.0000607
	speed: 0.0355s/iter; left time: 1374.0170s
	iters: 300, epoch: 18 | loss: 0.0003609
	speed: 0.0315s/iter; left time: 1215.5563s
	iters: 400, epoch: 18 | loss: 0.0000185
	speed: 0.0299s/iter; left time: 1150.6706s
Epoch: 18 cost time: 15.52232575416565
Epoch: 18, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.250 Vali Acc: 0.969 Test Loss: 0.250 Test Acc: 0.969
Validation loss decreased (-0.967122 --> -0.968837).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.3146322
	speed: 0.1683s/iter; left time: 6455.0910s
	iters: 200, epoch: 19 | loss: 0.0250314
	speed: 0.0316s/iter; left time: 1208.8237s
	iters: 300, epoch: 19 | loss: 0.0043995
	speed: 0.0309s/iter; left time: 1179.0301s
	iters: 400, epoch: 19 | loss: 0.0075413
	speed: 0.0312s/iter; left time: 1185.8404s
Epoch: 19 cost time: 15.296067714691162
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.166 Vali Acc: 0.978 Test Loss: 0.166 Test Acc: 0.978
Validation loss decreased (-0.968837 --> -0.977700).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000712
	speed: 0.1494s/iter; left time: 5661.2770s
	iters: 200, epoch: 20 | loss: 0.0444349
	speed: 0.0246s/iter; left time: 930.5788s
	iters: 300, epoch: 20 | loss: 0.0000189
	speed: 0.0249s/iter; left time: 936.6259s
	iters: 400, epoch: 20 | loss: 0.0015618
	speed: 0.0280s/iter; left time: 1051.8293s
Epoch: 20 cost time: 13.223418474197388
Epoch: 20, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.284 Vali Acc: 0.957 Test Loss: 0.284 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0001188
	speed: 0.1726s/iter; left time: 6460.3860s
	iters: 200, epoch: 21 | loss: 0.0000203
	speed: 0.0314s/iter; left time: 1170.2127s
	iters: 300, epoch: 21 | loss: 0.0001012
	speed: 0.0343s/iter; left time: 1276.3954s
	iters: 400, epoch: 21 | loss: 0.0000543
	speed: 0.0328s/iter; left time: 1217.8362s
Epoch: 21 cost time: 15.495656251907349
Epoch: 21, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.296 Vali Acc: 0.958 Test Loss: 0.296 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1410820
	speed: 0.1681s/iter; left time: 6210.4224s
	iters: 200, epoch: 22 | loss: 0.0208563
	speed: 0.0343s/iter; left time: 1262.6923s
	iters: 300, epoch: 22 | loss: 0.0018712
	speed: 0.0330s/iter; left time: 1214.4469s
	iters: 400, epoch: 22 | loss: 0.0934459
	speed: 0.0331s/iter; left time: 1211.5091s
Epoch: 22 cost time: 16.245370626449585
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000175
	speed: 0.1682s/iter; left time: 6137.3894s
	iters: 200, epoch: 23 | loss: 0.0000054
	speed: 0.0325s/iter; left time: 1184.1925s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0348s/iter; left time: 1262.2933s
	iters: 400, epoch: 23 | loss: 0.0000050
	speed: 0.0372s/iter; left time: 1344.2411s
Epoch: 23 cost time: 16.17798399925232
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0017554
	speed: 0.1752s/iter; left time: 6309.1082s
	iters: 200, epoch: 24 | loss: 0.0000010
	speed: 0.0347s/iter; left time: 1244.4829s
	iters: 300, epoch: 24 | loss: 0.0000051
	speed: 0.0305s/iter; left time: 1091.6609s
	iters: 400, epoch: 24 | loss: 0.3254634
	speed: 0.0308s/iter; left time: 1100.1336s
Epoch: 24 cost time: 15.761397123336792
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.257 Vali Acc: 0.965 Test Loss: 0.257 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.1136178
	speed: 0.1763s/iter; left time: 6268.1260s
	iters: 200, epoch: 25 | loss: 0.0000089
	speed: 0.0303s/iter; left time: 1074.3424s
	iters: 300, epoch: 25 | loss: 0.1138811
	speed: 0.0280s/iter; left time: 988.2064s
	iters: 400, epoch: 25 | loss: 0.0007291
	speed: 0.0290s/iter; left time: 1021.3090s
Epoch: 25 cost time: 13.888102769851685
Epoch: 25, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.233 Vali Acc: 0.966 Test Loss: 0.233 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0002385
	speed: 0.1639s/iter; left time: 5750.6571s
	iters: 200, epoch: 26 | loss: 0.0000013
	speed: 0.0328s/iter; left time: 1146.5151s
	iters: 300, epoch: 26 | loss: 0.2789920
	speed: 0.0323s/iter; left time: 1127.7383s
	iters: 400, epoch: 26 | loss: 0.0008988
	speed: 0.0349s/iter; left time: 1213.9776s
Epoch: 26 cost time: 15.880474328994751
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0163031
	speed: 0.1668s/iter; left time: 5771.7487s
	iters: 200, epoch: 27 | loss: 0.0000046
	speed: 0.0343s/iter; left time: 1182.1931s
	iters: 300, epoch: 27 | loss: 0.0000285
	speed: 0.0297s/iter; left time: 1021.6418s
	iters: 400, epoch: 27 | loss: 0.0001077
	speed: 0.0313s/iter; left time: 1074.9351s
Epoch: 27 cost time: 15.264979600906372
Epoch: 27, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.370 Vali Acc: 0.957 Test Loss: 0.370 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0276110
	speed: 0.1699s/iter; left time: 5801.0497s
	iters: 200, epoch: 28 | loss: 0.0000372
	speed: 0.0308s/iter; left time: 1046.8161s
	iters: 300, epoch: 28 | loss: 0.0007146
	speed: 0.0256s/iter; left time: 870.0946s
	iters: 400, epoch: 28 | loss: 0.0002174
	speed: 0.0279s/iter; left time: 944.7343s
Epoch: 28 cost time: 13.857665777206421
Epoch: 28, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0042368
	speed: 0.1641s/iter; left time: 5524.6821s
	iters: 200, epoch: 29 | loss: 0.0254197
	speed: 0.0294s/iter; left time: 988.3489s
	iters: 300, epoch: 29 | loss: 0.0001090
	speed: 0.0268s/iter; left time: 898.1282s
	iters: 400, epoch: 29 | loss: 0.1965047
	speed: 0.0333s/iter; left time: 1110.2671s
Epoch: 29 cost time: 14.79275131225586
Epoch: 29, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.360 Vali Acc: 0.956 Test Loss: 0.360 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 1100834
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2817328
	speed: 0.0510s/iter; left time: 2387.5350s
	iters: 200, epoch: 1 | loss: 0.0522663
	speed: 0.0334s/iter; left time: 1557.8426s
	iters: 300, epoch: 1 | loss: 0.0363416
	speed: 0.0333s/iter; left time: 1550.4322s
	iters: 400, epoch: 1 | loss: 0.0255448
	speed: 0.0362s/iter; left time: 1683.8736s
Epoch: 1 cost time: 17.99661636352539
Epoch: 1, Steps: 469 | Train Loss: 0.364 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (inf --> -0.958832).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0102545
	speed: 0.1686s/iter; left time: 7809.7619s
	iters: 200, epoch: 2 | loss: 0.0022582
	speed: 0.0368s/iter; left time: 1701.6111s
	iters: 300, epoch: 2 | loss: 0.0121845
	speed: 0.0336s/iter; left time: 1549.5062s
	iters: 400, epoch: 2 | loss: 0.0582547
	speed: 0.0328s/iter; left time: 1511.3936s
Epoch: 2 cost time: 16.20137667655945
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.958832 --> -0.968266).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0005628
	speed: 0.1703s/iter; left time: 7812.7524s
	iters: 200, epoch: 3 | loss: 0.0421558
	speed: 0.0317s/iter; left time: 1450.9412s
	iters: 300, epoch: 3 | loss: 0.0002819
	speed: 0.0311s/iter; left time: 1418.1532s
	iters: 400, epoch: 3 | loss: 0.0033360
	speed: 0.0301s/iter; left time: 1371.6384s
Epoch: 3 cost time: 15.103567600250244
Epoch: 3, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.201 Vali Acc: 0.964 Test Loss: 0.201 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0833012
	speed: 0.1782s/iter; left time: 8089.7927s
	iters: 200, epoch: 4 | loss: 0.1996939
	speed: 0.0323s/iter; left time: 1460.9411s
	iters: 300, epoch: 4 | loss: 0.0978408
	speed: 0.0377s/iter; left time: 1702.9489s
	iters: 400, epoch: 4 | loss: 0.1237686
	speed: 0.0310s/iter; left time: 1399.5742s
Epoch: 4 cost time: 15.582119941711426
Epoch: 4, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.970267).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0212065
	speed: 0.1578s/iter; left time: 7089.2889s
	iters: 200, epoch: 5 | loss: 0.0031957
	speed: 0.0331s/iter; left time: 1485.2229s
	iters: 300, epoch: 5 | loss: 0.0003923
	speed: 0.0283s/iter; left time: 1264.0035s
	iters: 400, epoch: 5 | loss: 0.0011276
	speed: 0.0240s/iter; left time: 1071.4552s
Epoch: 5 cost time: 13.875481367111206
Epoch: 5, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.198 Vali Acc: 0.964 Test Loss: 0.198 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000161
	speed: 0.1483s/iter; left time: 6593.6711s
	iters: 200, epoch: 6 | loss: 0.2487348
	speed: 0.0289s/iter; left time: 1283.8365s
	iters: 300, epoch: 6 | loss: 0.0000085
	speed: 0.0304s/iter; left time: 1347.4994s
	iters: 400, epoch: 6 | loss: 0.0036802
	speed: 0.0289s/iter; left time: 1277.1743s
Epoch: 6 cost time: 14.59037446975708
Epoch: 6, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.274 Vali Acc: 0.959 Test Loss: 0.274 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0016143
	speed: 0.1672s/iter; left time: 7354.0764s
	iters: 200, epoch: 7 | loss: 0.0000006
	speed: 0.0309s/iter; left time: 1357.8645s
	iters: 300, epoch: 7 | loss: 0.0330023
	speed: 0.0318s/iter; left time: 1391.2501s
	iters: 400, epoch: 7 | loss: 0.0000048
	speed: 0.0331s/iter; left time: 1447.2808s
Epoch: 7 cost time: 15.373888731002808
Epoch: 7, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.244 Vali Acc: 0.971 Test Loss: 0.244 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.971410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1260704
	speed: 0.1634s/iter; left time: 7111.7662s
	iters: 200, epoch: 8 | loss: 0.0000227
	speed: 0.0326s/iter; left time: 1413.9621s
	iters: 300, epoch: 8 | loss: 0.0016898
	speed: 0.0346s/iter; left time: 1500.6463s
	iters: 400, epoch: 8 | loss: 0.0190212
	speed: 0.0300s/iter; left time: 1297.9913s
Epoch: 8 cost time: 15.333332061767578
Epoch: 8, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.444 Vali Acc: 0.952 Test Loss: 0.444 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000081
	speed: 0.1640s/iter; left time: 7061.6097s
	iters: 200, epoch: 9 | loss: 0.0039955
	speed: 0.0292s/iter; left time: 1252.0474s
	iters: 300, epoch: 9 | loss: 0.0045184
	speed: 0.0310s/iter; left time: 1326.6643s
	iters: 400, epoch: 9 | loss: 0.0000213
	speed: 0.0328s/iter; left time: 1402.0842s
Epoch: 9 cost time: 14.675681591033936
Epoch: 9, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.342 Vali Acc: 0.969 Test Loss: 0.342 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0006515
	speed: 0.1769s/iter; left time: 7532.6398s
	iters: 200, epoch: 10 | loss: 0.0001143
	speed: 0.0316s/iter; left time: 1341.8831s
	iters: 300, epoch: 10 | loss: 0.0000414
	speed: 0.0319s/iter; left time: 1350.7388s
	iters: 400, epoch: 10 | loss: 0.0008181
	speed: 0.0335s/iter; left time: 1415.4383s
Epoch: 10 cost time: 15.360352277755737
Epoch: 10, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.250 Vali Acc: 0.962 Test Loss: 0.250 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000006
	speed: 0.1674s/iter; left time: 7050.9523s
	iters: 200, epoch: 11 | loss: 0.0021574
	speed: 0.0343s/iter; left time: 1439.8660s
	iters: 300, epoch: 11 | loss: 0.0000001
	speed: 0.0326s/iter; left time: 1366.9181s
	iters: 400, epoch: 11 | loss: 0.8289745
	speed: 0.0333s/iter; left time: 1393.3413s
Epoch: 11 cost time: 16.18456530570984
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.358 Vali Acc: 0.960 Test Loss: 0.358 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0293427
	speed: 0.1659s/iter; left time: 6909.0352s
	iters: 200, epoch: 12 | loss: 0.0009228
	speed: 0.0317s/iter; left time: 1317.4144s
	iters: 300, epoch: 12 | loss: 0.0000129
	speed: 0.0323s/iter; left time: 1340.5513s
	iters: 400, epoch: 12 | loss: 0.0009974
	speed: 0.0355s/iter; left time: 1469.4101s
Epoch: 12 cost time: 15.696128368377686
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.966 Test Loss: 0.252 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0029720
	speed: 0.1612s/iter; left time: 6638.7205s
	iters: 200, epoch: 13 | loss: 0.0000964
	speed: 0.0314s/iter; left time: 1291.6820s
	iters: 300, epoch: 13 | loss: 0.5679774
	speed: 0.0290s/iter; left time: 1189.3792s
	iters: 400, epoch: 13 | loss: 0.0000140
	speed: 0.0267s/iter; left time: 1090.4749s
Epoch: 13 cost time: 13.955820322036743
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.1979961
	speed: 0.1633s/iter; left time: 6645.1856s
	iters: 200, epoch: 14 | loss: 0.0000053
	speed: 0.0308s/iter; left time: 1250.5417s
	iters: 300, epoch: 14 | loss: 0.4113435
	speed: 0.0287s/iter; left time: 1161.8468s
	iters: 400, epoch: 14 | loss: 0.6858392
	speed: 0.0287s/iter; left time: 1160.6640s
Epoch: 14 cost time: 14.768389701843262
Epoch: 14, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.214 Vali Acc: 0.972 Test Loss: 0.214 Test Acc: 0.972
Validation loss decreased (-0.971410 --> -0.972268).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0005862
	speed: 0.1554s/iter; left time: 6252.1421s
	iters: 200, epoch: 15 | loss: 0.0000014
	speed: 0.0286s/iter; left time: 1147.6540s
	iters: 300, epoch: 15 | loss: 0.0327528
	speed: 0.0286s/iter; left time: 1144.9551s
	iters: 400, epoch: 15 | loss: 0.0000109
	speed: 0.0305s/iter; left time: 1216.9266s
Epoch: 15 cost time: 14.17358660697937
Epoch: 15, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.5799840
	speed: 0.1629s/iter; left time: 6477.9007s
	iters: 200, epoch: 16 | loss: 0.3743310
	speed: 0.0287s/iter; left time: 1140.0621s
	iters: 300, epoch: 16 | loss: 0.0000007
	speed: 0.0287s/iter; left time: 1134.3633s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0315s/iter; left time: 1243.1302s
Epoch: 16 cost time: 14.34961199760437
Epoch: 16, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0000473
	speed: 0.1626s/iter; left time: 6389.7205s
	iters: 200, epoch: 17 | loss: 0.0000000
	speed: 0.0346s/iter; left time: 1357.4124s
	iters: 300, epoch: 17 | loss: 0.0001087
	speed: 0.0305s/iter; left time: 1191.0436s
	iters: 400, epoch: 17 | loss: 0.0000576
	speed: 0.0302s/iter; left time: 1178.7269s
Epoch: 17 cost time: 14.988678693771362
Epoch: 17, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
Validation loss decreased (-0.972268 --> -0.976556).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.1630s/iter; left time: 6328.9492s
	iters: 200, epoch: 18 | loss: 0.0000718
	speed: 0.0330s/iter; left time: 1277.9544s
	iters: 300, epoch: 18 | loss: 0.0107659
	speed: 0.0319s/iter; left time: 1230.5586s
	iters: 400, epoch: 18 | loss: 0.4992683
	speed: 0.0321s/iter; left time: 1235.9111s
Epoch: 18 cost time: 15.598368644714355
Epoch: 18, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.260 Vali Acc: 0.970 Test Loss: 0.260 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.1596437
	speed: 0.1705s/iter; left time: 6541.0546s
	iters: 200, epoch: 19 | loss: 0.0075671
	speed: 0.0293s/iter; left time: 1120.2985s
	iters: 300, epoch: 19 | loss: 0.2027033
	speed: 0.0313s/iter; left time: 1195.0675s
	iters: 400, epoch: 19 | loss: 0.0000042
	speed: 0.0351s/iter; left time: 1335.4378s
Epoch: 19 cost time: 15.576168775558472
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.310 Vali Acc: 0.971 Test Loss: 0.310 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0022161
	speed: 0.1653s/iter; left time: 6261.9221s
	iters: 200, epoch: 20 | loss: 0.0000127
	speed: 0.0310s/iter; left time: 1170.5128s
	iters: 300, epoch: 20 | loss: 0.0000155
	speed: 0.0279s/iter; left time: 1053.2089s
	iters: 400, epoch: 20 | loss: 0.0000957
	speed: 0.0264s/iter; left time: 991.4669s
Epoch: 20 cost time: 13.866215944290161
Epoch: 20, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.272 Vali Acc: 0.973 Test Loss: 0.272 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000387
	speed: 0.1475s/iter; left time: 5517.9474s
	iters: 200, epoch: 21 | loss: 0.5848177
	speed: 0.0256s/iter; left time: 955.8936s
	iters: 300, epoch: 21 | loss: 0.0000014
	speed: 0.0256s/iter; left time: 951.2279s
	iters: 400, epoch: 21 | loss: 0.0000011
	speed: 0.0266s/iter; left time: 988.3772s
Epoch: 21 cost time: 12.88529634475708
Epoch: 21, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.323 Vali Acc: 0.964 Test Loss: 0.323 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0051375
	speed: 0.1611s/iter; left time: 5952.0492s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0284s/iter; left time: 1046.4689s
	iters: 300, epoch: 22 | loss: 0.0000011
	speed: 0.0321s/iter; left time: 1178.2238s
	iters: 400, epoch: 22 | loss: 0.2455509
	speed: 0.0315s/iter; left time: 1154.1597s
Epoch: 22 cost time: 14.47356104850769
Epoch: 22, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.256 Vali Acc: 0.971 Test Loss: 0.256 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1482s/iter; left time: 5408.5708s
	iters: 200, epoch: 23 | loss: 0.0000109
	speed: 0.0321s/iter; left time: 1166.3591s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0337s/iter; left time: 1220.9271s
	iters: 400, epoch: 23 | loss: 0.0000014
	speed: 0.0274s/iter; left time: 993.1754s
Epoch: 23 cost time: 14.32193636894226
Epoch: 23, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.311 Vali Acc: 0.969 Test Loss: 0.311 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000031
	speed: 0.1577s/iter; left time: 5678.3677s
	iters: 200, epoch: 24 | loss: 0.1215139
	speed: 0.0299s/iter; left time: 1073.3950s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0256s/iter; left time: 918.0947s
	iters: 400, epoch: 24 | loss: 0.0000003
	speed: 0.0259s/iter; left time: 924.9463s
Epoch: 24 cost time: 13.548513174057007
Epoch: 24, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.341 Vali Acc: 0.961 Test Loss: 0.341 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000002
	speed: 0.1595s/iter; left time: 5669.3999s
	iters: 200, epoch: 25 | loss: 0.0000250
	speed: 0.0293s/iter; left time: 1037.0203s
	iters: 300, epoch: 25 | loss: 0.0000001
	speed: 0.0289s/iter; left time: 1022.4443s
	iters: 400, epoch: 25 | loss: 0.2509118
	speed: 0.0288s/iter; left time: 1014.8054s
Epoch: 25 cost time: 14.159135818481445
Epoch: 25, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002340
	speed: 0.1596s/iter; left time: 5597.2330s
	iters: 200, epoch: 26 | loss: 0.0000027
	speed: 0.0302s/iter; left time: 1057.7467s
	iters: 300, epoch: 26 | loss: 0.0000001
	speed: 0.0349s/iter; left time: 1216.0791s
	iters: 400, epoch: 26 | loss: 0.0001077
	speed: 0.0351s/iter; left time: 1220.3938s
Epoch: 26 cost time: 15.589853048324585
Epoch: 26, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000400
	speed: 0.1587s/iter; left time: 5491.8033s
	iters: 200, epoch: 27 | loss: 0.0044574
	speed: 0.0282s/iter; left time: 973.5633s
	iters: 300, epoch: 27 | loss: 0.0000248
	speed: 0.0289s/iter; left time: 994.6782s
	iters: 400, epoch: 27 | loss: 0.0186116
	speed: 0.0314s/iter; left time: 1077.1301s
Epoch: 27 cost time: 14.7510244846344
Epoch: 27, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.970 Test Loss: 0.271 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 1100834
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3207816
	speed: 0.0488s/iter; left time: 2281.5929s
	iters: 200, epoch: 1 | loss: 0.0729433
	speed: 0.0318s/iter; left time: 1486.1206s
	iters: 300, epoch: 1 | loss: 0.1232917
	speed: 0.0337s/iter; left time: 1570.2829s
	iters: 400, epoch: 1 | loss: 0.1730919
	speed: 0.0300s/iter; left time: 1395.7531s
Epoch: 1 cost time: 16.58559823036194
Epoch: 1, Steps: 469 | Train Loss: 0.341 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (inf --> -0.950541).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0486071
	speed: 0.1508s/iter; left time: 6986.9728s
	iters: 200, epoch: 2 | loss: 0.0134437
	speed: 0.0301s/iter; left time: 1390.9743s
	iters: 300, epoch: 2 | loss: 0.0656934
	speed: 0.0293s/iter; left time: 1349.4381s
	iters: 400, epoch: 2 | loss: 0.0028563
	speed: 0.0283s/iter; left time: 1301.1567s
Epoch: 2 cost time: 14.334798336029053
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.950541 --> -0.956545).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0065928
	speed: 0.1578s/iter; left time: 7237.8615s
	iters: 200, epoch: 3 | loss: 0.0011330
	speed: 0.0268s/iter; left time: 1224.8130s
	iters: 300, epoch: 3 | loss: 0.0736587
	speed: 0.0265s/iter; left time: 1210.1544s
	iters: 400, epoch: 3 | loss: 0.0441110
	speed: 0.0266s/iter; left time: 1211.6431s
Epoch: 3 cost time: 13.372046709060669
Epoch: 3, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.956545 --> -0.970267).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0594304
	speed: 0.1545s/iter; left time: 7013.2946s
	iters: 200, epoch: 4 | loss: 0.0014526
	speed: 0.0287s/iter; left time: 1301.9664s
	iters: 300, epoch: 4 | loss: 0.0527577
	speed: 0.0296s/iter; left time: 1335.7692s
	iters: 400, epoch: 4 | loss: 0.0024209
	speed: 0.0323s/iter; left time: 1457.0983s
Epoch: 4 cost time: 14.546914339065552
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.6040899
	speed: 0.1448s/iter; left time: 6504.0110s
	iters: 200, epoch: 5 | loss: 0.0055058
	speed: 0.0277s/iter; left time: 1240.0823s
	iters: 300, epoch: 5 | loss: 0.0483442
	speed: 0.0326s/iter; left time: 1459.6118s
	iters: 400, epoch: 5 | loss: 0.1821332
	speed: 0.0315s/iter; left time: 1403.6370s
Epoch: 5 cost time: 14.026939868927002
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.970267 --> -0.970839).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1350345
	speed: 0.1550s/iter; left time: 6888.7237s
	iters: 200, epoch: 6 | loss: 0.2912298
	speed: 0.0322s/iter; left time: 1428.4269s
	iters: 300, epoch: 6 | loss: 0.0019573
	speed: 0.0278s/iter; left time: 1228.3837s
	iters: 400, epoch: 6 | loss: 0.0131281
	speed: 0.0267s/iter; left time: 1180.6431s
Epoch: 6 cost time: 14.016963720321655
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0169827
	speed: 0.1486s/iter; left time: 6535.6422s
	iters: 200, epoch: 7 | loss: 0.0013042
	speed: 0.0266s/iter; left time: 1165.7447s
	iters: 300, epoch: 7 | loss: 0.0355437
	speed: 0.0262s/iter; left time: 1146.9085s
	iters: 400, epoch: 7 | loss: 0.0002214
	speed: 0.0280s/iter; left time: 1222.6452s
Epoch: 7 cost time: 13.042115449905396
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0104196
	speed: 0.1498s/iter; left time: 6517.4229s
	iters: 200, epoch: 8 | loss: 0.3826519
	speed: 0.0300s/iter; left time: 1302.1051s
	iters: 300, epoch: 8 | loss: 0.0004731
	speed: 0.0308s/iter; left time: 1334.8665s
	iters: 400, epoch: 8 | loss: 0.0382998
	speed: 0.0335s/iter; left time: 1449.5353s
Epoch: 8 cost time: 14.922774314880371
Epoch: 8, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002394
	speed: 0.1550s/iter; left time: 6672.6850s
	iters: 200, epoch: 9 | loss: 0.0657854
	speed: 0.0322s/iter; left time: 1384.1632s
	iters: 300, epoch: 9 | loss: 0.0924084
	speed: 0.0327s/iter; left time: 1401.8578s
	iters: 400, epoch: 9 | loss: 0.0004669
	speed: 0.0286s/iter; left time: 1223.3095s
Epoch: 9 cost time: 14.417205095291138
Epoch: 9, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3761862
	speed: 0.1609s/iter; left time: 6851.5922s
	iters: 200, epoch: 10 | loss: 0.0842009
	speed: 0.0318s/iter; left time: 1351.2105s
	iters: 300, epoch: 10 | loss: 0.0633528
	speed: 0.0314s/iter; left time: 1330.2231s
	iters: 400, epoch: 10 | loss: 0.0322587
	speed: 0.0288s/iter; left time: 1219.0237s
Epoch: 10 cost time: 14.809410095214844
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000599
	speed: 0.1459s/iter; left time: 6145.0833s
	iters: 200, epoch: 11 | loss: 0.0023453
	speed: 0.0295s/iter; left time: 1241.2382s
	iters: 300, epoch: 11 | loss: 0.0088068
	speed: 0.0289s/iter; left time: 1210.8712s
	iters: 400, epoch: 11 | loss: 1.1241117
	speed: 0.0288s/iter; left time: 1204.5576s
Epoch: 11 cost time: 14.031445741653442
Epoch: 11, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.228 Vali Acc: 0.953 Test Loss: 0.228 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0008807
	speed: 0.1557s/iter; left time: 6484.1498s
	iters: 200, epoch: 12 | loss: 0.0001095
	speed: 0.0265s/iter; left time: 1100.3700s
	iters: 300, epoch: 12 | loss: 0.0024988
	speed: 0.0293s/iter; left time: 1213.6549s
	iters: 400, epoch: 12 | loss: 0.0214447
	speed: 0.0311s/iter; left time: 1287.4721s
Epoch: 12 cost time: 13.793558597564697
Epoch: 12, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
Validation loss decreased (-0.970839 --> -0.974269).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0007425
	speed: 0.1580s/iter; left time: 6504.9560s
	iters: 200, epoch: 13 | loss: 0.0059371
	speed: 0.0319s/iter; left time: 1310.6436s
	iters: 300, epoch: 13 | loss: 1.3417991
	speed: 0.0286s/iter; left time: 1170.1343s
	iters: 400, epoch: 13 | loss: 0.0017016
	speed: 0.0285s/iter; left time: 1163.6740s
Epoch: 13 cost time: 13.984752655029297
Epoch: 13, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0173617
	speed: 0.1522s/iter; left time: 6193.9969s
	iters: 200, epoch: 14 | loss: 0.0007797
	speed: 0.0286s/iter; left time: 1160.6430s
	iters: 300, epoch: 14 | loss: 0.4355573
	speed: 0.0281s/iter; left time: 1139.1296s
	iters: 400, epoch: 14 | loss: 0.0123466
	speed: 0.0278s/iter; left time: 1124.4300s
Epoch: 14 cost time: 13.768006086349487
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000007
	speed: 0.1554s/iter; left time: 6254.3052s
	iters: 200, epoch: 15 | loss: 0.0352656
	speed: 0.0254s/iter; left time: 1020.4494s
	iters: 300, epoch: 15 | loss: 0.0000185
	speed: 0.0259s/iter; left time: 1037.5635s
	iters: 400, epoch: 15 | loss: 0.0004580
	speed: 0.0248s/iter; left time: 990.5380s
Epoch: 15 cost time: 12.629516124725342
Epoch: 15, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.1243839
	speed: 0.1548s/iter; left time: 6155.7555s
	iters: 200, epoch: 16 | loss: 0.0053658
	speed: 0.0294s/iter; left time: 1164.8563s
	iters: 300, epoch: 16 | loss: 0.0004613
	speed: 0.0317s/iter; left time: 1253.2348s
	iters: 400, epoch: 16 | loss: 0.0397403
	speed: 0.0321s/iter; left time: 1266.5114s
Epoch: 16 cost time: 14.741182088851929
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0920764
	speed: 0.1576s/iter; left time: 6192.1412s
	iters: 200, epoch: 17 | loss: 0.0022516
	speed: 0.0334s/iter; left time: 1308.7470s
	iters: 300, epoch: 17 | loss: 0.0952473
	speed: 0.0293s/iter; left time: 1144.5674s
	iters: 400, epoch: 17 | loss: 0.0000305
	speed: 0.0305s/iter; left time: 1189.9025s
Epoch: 17 cost time: 15.30884575843811
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
Validation loss decreased (-0.974269 --> -0.975985).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0573089
	speed: 0.1615s/iter; left time: 6270.6201s
	iters: 200, epoch: 18 | loss: 0.0254849
	speed: 0.0281s/iter; left time: 1089.5088s
	iters: 300, epoch: 18 | loss: 0.0013428
	speed: 0.0296s/iter; left time: 1144.7595s
	iters: 400, epoch: 18 | loss: 0.2939259
	speed: 0.0300s/iter; left time: 1155.4301s
Epoch: 18 cost time: 14.362382173538208
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0040730
	speed: 0.1616s/iter; left time: 6196.9156s
	iters: 200, epoch: 19 | loss: 0.0033608
	speed: 0.0312s/iter; left time: 1194.2491s
	iters: 300, epoch: 19 | loss: 0.0017544
	speed: 0.0311s/iter; left time: 1184.9106s
	iters: 400, epoch: 19 | loss: 0.9546714
	speed: 0.0301s/iter; left time: 1143.7955s
Epoch: 19 cost time: 14.597740650177002
Epoch: 19, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.217 Vali Acc: 0.960 Test Loss: 0.217 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.2092930
	speed: 0.1455s/iter; left time: 5514.8431s
	iters: 200, epoch: 20 | loss: 0.0021244
	speed: 0.0315s/iter; left time: 1189.4061s
	iters: 300, epoch: 20 | loss: 0.0258924
	speed: 0.0311s/iter; left time: 1172.5125s
	iters: 400, epoch: 20 | loss: 0.0000053
	speed: 0.0275s/iter; left time: 1033.6166s
Epoch: 20 cost time: 14.087795734405518
Epoch: 20, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977986).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000016
	speed: 0.1563s/iter; left time: 5849.2589s
	iters: 200, epoch: 21 | loss: 0.0194785
	speed: 0.0347s/iter; left time: 1294.4182s
	iters: 300, epoch: 21 | loss: 0.0000245
	speed: 0.0327s/iter; left time: 1216.8988s
	iters: 400, epoch: 21 | loss: 0.0167695
	speed: 0.0196s/iter; left time: 729.2826s
Epoch: 21 cost time: 14.120177984237671
Epoch: 21, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.173 Vali Acc: 0.974 Test Loss: 0.173 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0003155
	speed: 0.1108s/iter; left time: 4095.1356s
	iters: 200, epoch: 22 | loss: 0.0000496
	speed: 0.0227s/iter; left time: 836.4342s
	iters: 300, epoch: 22 | loss: 0.0005686
	speed: 0.0197s/iter; left time: 723.3440s
	iters: 400, epoch: 22 | loss: 0.0000847
	speed: 0.0198s/iter; left time: 725.7819s
Epoch: 22 cost time: 10.127548217773438
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0000562
	speed: 0.1423s/iter; left time: 5192.3799s
	iters: 200, epoch: 23 | loss: 0.0129768
	speed: 0.0256s/iter; left time: 932.4484s
	iters: 300, epoch: 23 | loss: 0.0000065
	speed: 0.0283s/iter; left time: 1025.0301s
	iters: 400, epoch: 23 | loss: 0.1448147
	speed: 0.0283s/iter; left time: 1025.7712s
Epoch: 23 cost time: 13.436305522918701
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0002068
	speed: 0.1557s/iter; left time: 5608.6513s
	iters: 200, epoch: 24 | loss: 0.0000948
	speed: 0.0267s/iter; left time: 958.1507s
	iters: 300, epoch: 24 | loss: 0.0000086
	speed: 0.0294s/iter; left time: 1052.8607s
	iters: 400, epoch: 24 | loss: 0.0028518
	speed: 0.0294s/iter; left time: 1048.2915s
Epoch: 24 cost time: 13.887094259262085
Epoch: 24, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0011389
	speed: 0.1596s/iter; left time: 5672.8294s
	iters: 200, epoch: 25 | loss: 0.0120284
	speed: 0.0314s/iter; left time: 1113.3309s
	iters: 300, epoch: 25 | loss: 0.0293211
	speed: 0.0306s/iter; left time: 1080.8325s
	iters: 400, epoch: 25 | loss: 0.0018067
	speed: 0.0280s/iter; left time: 987.8939s
Epoch: 25 cost time: 15.012492418289185
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0062694
	speed: 0.1643s/iter; left time: 5761.7011s
	iters: 200, epoch: 26 | loss: 0.0383632
	speed: 0.0280s/iter; left time: 981.0275s
	iters: 300, epoch: 26 | loss: 0.0005578
	speed: 0.0270s/iter; left time: 943.2957s
	iters: 400, epoch: 26 | loss: 0.0057027
	speed: 0.0288s/iter; left time: 999.8623s
Epoch: 26 cost time: 13.830477714538574
Epoch: 26, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.240 Vali Acc: 0.958 Test Loss: 0.240 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0002935
	speed: 0.1660s/iter; left time: 5745.5733s
	iters: 200, epoch: 27 | loss: 0.0011338
	speed: 0.0286s/iter; left time: 986.4714s
	iters: 300, epoch: 27 | loss: 0.1529745
	speed: 0.0257s/iter; left time: 884.4655s
	iters: 400, epoch: 27 | loss: 0.0291020
	speed: 0.0309s/iter; left time: 1059.7666s
Epoch: 27 cost time: 13.975763320922852
Epoch: 27, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0021746
	speed: 0.1514s/iter; left time: 5166.8328s
	iters: 200, epoch: 28 | loss: 0.0004041
	speed: 0.0323s/iter; left time: 1100.9333s
	iters: 300, epoch: 28 | loss: 0.0001502
	speed: 0.0290s/iter; left time: 985.5366s
	iters: 400, epoch: 28 | loss: 0.0020170
	speed: 0.0287s/iter; left time: 969.7315s
Epoch: 28 cost time: 14.276066303253174
Epoch: 28, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0206418
	speed: 0.1448s/iter; left time: 4875.1913s
	iters: 200, epoch: 29 | loss: 0.0002517
	speed: 0.0273s/iter; left time: 914.8764s
	iters: 300, epoch: 29 | loss: 0.0000152
	speed: 0.0252s/iter; left time: 844.8930s
	iters: 400, epoch: 29 | loss: 0.0122656
	speed: 0.0263s/iter; left time: 878.9167s
Epoch: 29 cost time: 12.508841753005981
Epoch: 29, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0020422
	speed: 0.1478s/iter; left time: 4905.5076s
	iters: 200, epoch: 30 | loss: 0.0000039
	speed: 0.0261s/iter; left time: 863.2733s
	iters: 300, epoch: 30 | loss: 0.0008323
	speed: 0.0266s/iter; left time: 879.3160s
	iters: 400, epoch: 30 | loss: 0.0004037
	speed: 0.0279s/iter; left time: 916.4308s
Epoch: 30 cost time: 12.993869304656982
Epoch: 30, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.961 Test Loss: 0.234 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 838690
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3119588
	speed: 0.0467s/iter; left time: 2183.8904s
	iters: 200, epoch: 1 | loss: 0.0625289
	speed: 0.0276s/iter; left time: 1290.7044s
	iters: 300, epoch: 1 | loss: 0.0745195
	speed: 0.0262s/iter; left time: 1220.8605s
	iters: 400, epoch: 1 | loss: 0.1895451
	speed: 0.0261s/iter; left time: 1215.0188s
Epoch: 1 cost time: 14.551256656646729
Epoch: 1, Steps: 469 | Train Loss: 0.340 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
Validation loss decreased (inf --> -0.949398).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0150491
	speed: 0.1561s/iter; left time: 7230.2008s
	iters: 200, epoch: 2 | loss: 0.0154933
	speed: 0.0313s/iter; left time: 1446.7003s
	iters: 300, epoch: 2 | loss: 0.0521516
	speed: 0.0313s/iter; left time: 1445.9817s
	iters: 400, epoch: 2 | loss: 0.0013259
	speed: 0.0304s/iter; left time: 1398.2850s
Epoch: 2 cost time: 14.603897094726562
Epoch: 2, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
Validation loss decreased (-0.949398 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0139216
	speed: 0.1586s/iter; left time: 7272.9114s
	iters: 200, epoch: 3 | loss: 0.0104772
	speed: 0.0321s/iter; left time: 1468.8355s
	iters: 300, epoch: 3 | loss: 0.0016666
	speed: 0.0296s/iter; left time: 1349.8567s
	iters: 400, epoch: 3 | loss: 0.0558696
	speed: 0.0300s/iter; left time: 1368.2365s
Epoch: 3 cost time: 14.923152208328247
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.953114 --> -0.961976).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0273809
	speed: 0.1592s/iter; left time: 7225.2533s
	iters: 200, epoch: 4 | loss: 0.0030979
	speed: 0.0283s/iter; left time: 1280.5038s
	iters: 300, epoch: 4 | loss: 0.0025548
	speed: 0.0288s/iter; left time: 1303.1149s
	iters: 400, epoch: 4 | loss: 0.0197490
	speed: 0.0327s/iter; left time: 1474.9346s
Epoch: 4 cost time: 14.57516074180603
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
Validation loss decreased (-0.961976 --> -0.971982).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5287807
	speed: 0.1659s/iter; left time: 7453.4573s
	iters: 200, epoch: 5 | loss: 0.0005673
	speed: 0.0325s/iter; left time: 1455.1525s
	iters: 300, epoch: 5 | loss: 0.0329449
	speed: 0.0330s/iter; left time: 1475.0892s
	iters: 400, epoch: 5 | loss: 0.4278123
	speed: 0.0274s/iter; left time: 1221.2440s
Epoch: 5 cost time: 14.776934385299683
Epoch: 5, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.962 Test Loss: 0.231 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1038520
	speed: 0.1523s/iter; left time: 6772.8298s
	iters: 200, epoch: 6 | loss: 0.0418016
	speed: 0.0290s/iter; left time: 1284.7449s
	iters: 300, epoch: 6 | loss: 0.0049308
	speed: 0.0288s/iter; left time: 1274.0535s
	iters: 400, epoch: 6 | loss: 0.0095012
	speed: 0.0289s/iter; left time: 1275.2265s
Epoch: 6 cost time: 13.898465871810913
Epoch: 6, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.947 Test Loss: 0.288 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000296
	speed: 0.1516s/iter; left time: 6666.3268s
	iters: 200, epoch: 7 | loss: 0.0002013
	speed: 0.0277s/iter; left time: 1216.9944s
	iters: 300, epoch: 7 | loss: 0.0007674
	speed: 0.0291s/iter; left time: 1273.0715s
	iters: 400, epoch: 7 | loss: 0.0000992
	speed: 0.0305s/iter; left time: 1334.2390s
Epoch: 7 cost time: 13.878568172454834
Epoch: 7, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0682248
	speed: 0.1386s/iter; left time: 6031.1013s
	iters: 200, epoch: 8 | loss: 0.2371250
	speed: 0.0312s/iter; left time: 1354.6452s
	iters: 300, epoch: 8 | loss: 0.0000291
	speed: 0.0290s/iter; left time: 1257.7743s
	iters: 400, epoch: 8 | loss: 0.0004116
	speed: 0.0282s/iter; left time: 1219.0052s
Epoch: 8 cost time: 13.849103212356567
Epoch: 8, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0002907
	speed: 0.1516s/iter; left time: 6524.9179s
	iters: 200, epoch: 9 | loss: 0.1358516
	speed: 0.0272s/iter; left time: 1170.1325s
	iters: 300, epoch: 9 | loss: 0.0820124
	speed: 0.0268s/iter; left time: 1146.7372s
	iters: 400, epoch: 9 | loss: 0.0002795
	speed: 0.0276s/iter; left time: 1178.0068s
Epoch: 9 cost time: 13.03672480583191
Epoch: 9, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0013771
	speed: 0.1492s/iter; left time: 6351.3993s
	iters: 200, epoch: 10 | loss: 0.0000303
	speed: 0.0272s/iter; left time: 1155.0971s
	iters: 300, epoch: 10 | loss: 0.0212326
	speed: 0.0289s/iter; left time: 1226.3170s
	iters: 400, epoch: 10 | loss: 0.3057872
	speed: 0.0299s/iter; left time: 1264.3558s
Epoch: 10 cost time: 13.896022319793701
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.971982 --> -0.975127).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0007789
	speed: 0.1476s/iter; left time: 6216.4091s
	iters: 200, epoch: 11 | loss: 0.0000780
	speed: 0.0269s/iter; left time: 1131.0034s
	iters: 300, epoch: 11 | loss: 0.0355413
	speed: 0.0323s/iter; left time: 1352.2516s
	iters: 400, epoch: 11 | loss: 0.3061949
	speed: 0.0318s/iter; left time: 1327.6274s
Epoch: 11 cost time: 14.263802289962769
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0035811
	speed: 0.1556s/iter; left time: 6478.8781s
	iters: 200, epoch: 12 | loss: 0.0001230
	speed: 0.0287s/iter; left time: 1193.5284s
	iters: 300, epoch: 12 | loss: 0.0008729
	speed: 0.0284s/iter; left time: 1177.7749s
	iters: 400, epoch: 12 | loss: 0.0012372
	speed: 0.0285s/iter; left time: 1179.3426s
Epoch: 12 cost time: 14.112385511398315
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.975127 --> -0.975127).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000754
	speed: 0.1541s/iter; left time: 6342.7917s
	iters: 200, epoch: 13 | loss: 0.1967296
	speed: 0.0291s/iter; left time: 1196.4105s
	iters: 300, epoch: 13 | loss: 1.6423175
	speed: 0.0299s/iter; left time: 1226.4806s
	iters: 400, epoch: 13 | loss: 0.0532432
	speed: 0.0324s/iter; left time: 1324.4394s
Epoch: 13 cost time: 14.742461442947388
Epoch: 13, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0210146
	speed: 0.1503s/iter; left time: 6116.1503s
	iters: 200, epoch: 14 | loss: 0.0041653
	speed: 0.0340s/iter; left time: 1379.8373s
	iters: 300, epoch: 14 | loss: 0.0034619
	speed: 0.0324s/iter; left time: 1314.3279s
	iters: 400, epoch: 14 | loss: 0.1780442
	speed: 0.0321s/iter; left time: 1296.8462s
Epoch: 14 cost time: 15.272543907165527
Epoch: 14, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0012469
	speed: 0.1571s/iter; left time: 6319.5206s
	iters: 200, epoch: 15 | loss: 0.2919500
	speed: 0.0272s/iter; left time: 1093.6554s
	iters: 300, epoch: 15 | loss: 0.0000259
	speed: 0.0265s/iter; left time: 1059.7754s
	iters: 400, epoch: 15 | loss: 0.0027021
	speed: 0.0268s/iter; left time: 1069.1115s
Epoch: 15 cost time: 13.393180847167969
Epoch: 15, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.204 Vali Acc: 0.966 Test Loss: 0.204 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000979
	speed: 0.1524s/iter; left time: 6062.0129s
	iters: 200, epoch: 16 | loss: 0.0143146
	speed: 0.0284s/iter; left time: 1126.7793s
	iters: 300, epoch: 16 | loss: 0.0001009
	speed: 0.0285s/iter; left time: 1126.2788s
	iters: 400, epoch: 16 | loss: 0.0001184
	speed: 0.0295s/iter; left time: 1164.7325s
Epoch: 16 cost time: 14.104768514633179
Epoch: 16, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.178 Vali Acc: 0.961 Test Loss: 0.178 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0007869
	speed: 0.1492s/iter; left time: 5861.7614s
	iters: 200, epoch: 17 | loss: 0.0066541
	speed: 0.0294s/iter; left time: 1152.1177s
	iters: 300, epoch: 17 | loss: 0.0002309
	speed: 0.0314s/iter; left time: 1229.3450s
	iters: 400, epoch: 17 | loss: 0.0002598
	speed: 0.0298s/iter; left time: 1161.8833s
Epoch: 17 cost time: 14.345515489578247
Epoch: 17, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.199 Vali Acc: 0.969 Test Loss: 0.199 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0011334
	speed: 0.1528s/iter; left time: 5932.1956s
	iters: 200, epoch: 18 | loss: 0.0281203
	speed: 0.0266s/iter; left time: 1030.0022s
	iters: 300, epoch: 18 | loss: 0.0009943
	speed: 0.0272s/iter; left time: 1049.8873s
	iters: 400, epoch: 18 | loss: 0.4026468
	speed: 0.0267s/iter; left time: 1027.4244s
Epoch: 18 cost time: 13.25621485710144
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.222 Vali Acc: 0.955 Test Loss: 0.222 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000016
	speed: 0.1565s/iter; left time: 6002.1222s
	iters: 200, epoch: 19 | loss: 0.0934247
	speed: 0.0277s/iter; left time: 1061.4955s
	iters: 300, epoch: 19 | loss: 0.0000803
	speed: 0.0278s/iter; left time: 1060.8534s
	iters: 400, epoch: 19 | loss: 0.9418216
	speed: 0.0268s/iter; left time: 1021.5856s
Epoch: 19 cost time: 13.338284492492676
Epoch: 19, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.167 Vali Acc: 0.972 Test Loss: 0.167 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000003
	speed: 0.1495s/iter; left time: 5666.3009s
	iters: 200, epoch: 20 | loss: 0.0126204
	speed: 0.0295s/iter; left time: 1113.1203s
	iters: 300, epoch: 20 | loss: 0.0033370
	speed: 0.0324s/iter; left time: 1219.7933s
	iters: 400, epoch: 20 | loss: 0.0000025
	speed: 0.0331s/iter; left time: 1246.0969s
Epoch: 20 cost time: 14.726120710372925
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0002378
	speed: 0.1510s/iter; left time: 5651.1318s
	iters: 200, epoch: 21 | loss: 0.0003456
	speed: 0.0314s/iter; left time: 1173.6127s
	iters: 300, epoch: 21 | loss: 0.0001064
	speed: 0.0273s/iter; left time: 1014.6936s
	iters: 400, epoch: 21 | loss: 0.0086177
	speed: 0.0286s/iter; left time: 1062.0205s
Epoch: 21 cost time: 14.33459758758545
Epoch: 21, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000026
	speed: 0.1544s/iter; left time: 5705.6794s
	iters: 200, epoch: 22 | loss: 0.0022375
	speed: 0.0293s/iter; left time: 1079.2155s
	iters: 300, epoch: 22 | loss: 0.0000617
	speed: 0.0304s/iter; left time: 1118.3389s
	iters: 400, epoch: 22 | loss: 0.0002922
	speed: 0.0313s/iter; left time: 1145.8371s
Epoch: 22 cost time: 14.622917652130127
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.320 Vali Acc: 0.958 Test Loss: 0.320 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9751286449399656
model parameter : 838690
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.3376702
	speed: 0.0466s/iter; left time: 2182.3876s
	iters: 200, epoch: 1 | loss: 0.0486609
	speed: 0.0276s/iter; left time: 1290.2670s
	iters: 300, epoch: 1 | loss: 0.0463303
	speed: 0.0290s/iter; left time: 1349.3959s
	iters: 400, epoch: 1 | loss: 0.2408092
	speed: 0.0283s/iter; left time: 1314.2240s
Epoch: 1 cost time: 15.065889596939087
Epoch: 1, Steps: 469 | Train Loss: 0.342 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (inf --> -0.959118).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0431251
	speed: 0.1514s/iter; left time: 7015.7350s
	iters: 200, epoch: 2 | loss: 0.0444924
	speed: 0.0321s/iter; left time: 1485.1784s
	iters: 300, epoch: 2 | loss: 0.0131497
	speed: 0.0283s/iter; left time: 1307.3915s
	iters: 400, epoch: 2 | loss: 0.0009541
	speed: 0.0282s/iter; left time: 1299.6357s
Epoch: 2 cost time: 14.615127801895142
Epoch: 2, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.959118 --> -0.969124).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0819342
	speed: 0.1477s/iter; left time: 6772.2809s
	iters: 200, epoch: 3 | loss: 0.1352024
	speed: 0.0295s/iter; left time: 1347.9905s
	iters: 300, epoch: 3 | loss: 0.0491722
	speed: 0.0279s/iter; left time: 1276.2266s
	iters: 400, epoch: 3 | loss: 0.1134428
	speed: 0.0283s/iter; left time: 1288.4686s
Epoch: 3 cost time: 14.014893770217896
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.969124 --> -0.975127).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0022128
	speed: 0.1557s/iter; left time: 7069.7508s
	iters: 200, epoch: 4 | loss: 0.0000738
	speed: 0.0278s/iter; left time: 1261.2757s
	iters: 300, epoch: 4 | loss: 0.0015184
	speed: 0.0297s/iter; left time: 1341.4104s
	iters: 400, epoch: 4 | loss: 0.0133098
	speed: 0.0290s/iter; left time: 1307.7196s
Epoch: 4 cost time: 13.858340978622437
Epoch: 4, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.220 Vali Acc: 0.965 Test Loss: 0.220 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.9162517
	speed: 0.1471s/iter; left time: 6606.9983s
	iters: 200, epoch: 5 | loss: 0.0018152
	speed: 0.0307s/iter; left time: 1377.6925s
	iters: 300, epoch: 5 | loss: 0.0292762
	speed: 0.0292s/iter; left time: 1307.2232s
	iters: 400, epoch: 5 | loss: 0.1363574
	speed: 0.0263s/iter; left time: 1173.6955s
Epoch: 5 cost time: 13.80480694770813
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0000826
	speed: 0.1519s/iter; left time: 6750.6610s
	iters: 200, epoch: 6 | loss: 0.0000528
	speed: 0.0291s/iter; left time: 1291.7137s
	iters: 300, epoch: 6 | loss: 0.0000053
	speed: 0.0294s/iter; left time: 1300.7746s
	iters: 400, epoch: 6 | loss: 0.0392617
	speed: 0.0254s/iter; left time: 1122.1714s
Epoch: 6 cost time: 13.779255151748657
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0019682
	speed: 0.1655s/iter; left time: 7280.2633s
	iters: 200, epoch: 7 | loss: 0.0000239
	speed: 0.0276s/iter; left time: 1212.6849s
	iters: 300, epoch: 7 | loss: 0.0988289
	speed: 0.0302s/iter; left time: 1324.2616s
	iters: 400, epoch: 7 | loss: 0.0002034
	speed: 0.0280s/iter; left time: 1221.6564s
Epoch: 7 cost time: 14.008481740951538
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.302 Vali Acc: 0.958 Test Loss: 0.302 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0147801
	speed: 0.1580s/iter; left time: 6875.6075s
	iters: 200, epoch: 8 | loss: 0.0050413
	speed: 0.0279s/iter; left time: 1210.5468s
	iters: 300, epoch: 8 | loss: 0.0000010
	speed: 0.0275s/iter; left time: 1192.0101s
	iters: 400, epoch: 8 | loss: 0.0000759
	speed: 0.0255s/iter; left time: 1104.1444s
Epoch: 8 cost time: 13.349646091461182
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0116609
	speed: 0.1459s/iter; left time: 6281.4761s
	iters: 200, epoch: 9 | loss: 0.1196374
	speed: 0.0307s/iter; left time: 1316.4822s
	iters: 300, epoch: 9 | loss: 0.0167129
	speed: 0.0304s/iter; left time: 1303.6983s
	iters: 400, epoch: 9 | loss: 0.0004794
	speed: 0.0305s/iter; left time: 1303.7052s
Epoch: 9 cost time: 14.666051149368286
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.223 Vali Acc: 0.962 Test Loss: 0.223 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001304
	speed: 0.1517s/iter; left time: 6458.8542s
	iters: 200, epoch: 10 | loss: 0.0010350
	speed: 0.0259s/iter; left time: 1098.2898s
	iters: 300, epoch: 10 | loss: 0.0000218
	speed: 0.0315s/iter; left time: 1336.7808s
	iters: 400, epoch: 10 | loss: 0.0012311
	speed: 0.0293s/iter; left time: 1240.1439s
Epoch: 10 cost time: 13.6965913772583
Epoch: 10, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000804
	speed: 0.1561s/iter; left time: 6571.6657s
	iters: 200, epoch: 11 | loss: 0.0001462
	speed: 0.0302s/iter; left time: 1270.7644s
	iters: 300, epoch: 11 | loss: 0.0000119
	speed: 0.0281s/iter; left time: 1177.9550s
	iters: 400, epoch: 11 | loss: 0.4812411
	speed: 0.0273s/iter; left time: 1142.8246s
Epoch: 11 cost time: 13.83379054069519
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.316 Vali Acc: 0.963 Test Loss: 0.316 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0111479
	speed: 0.1512s/iter; left time: 6296.6618s
	iters: 200, epoch: 12 | loss: 0.0000015
	speed: 0.0287s/iter; left time: 1192.0299s
	iters: 300, epoch: 12 | loss: 0.0420623
	speed: 0.0288s/iter; left time: 1192.0363s
	iters: 400, epoch: 12 | loss: 0.0000667
	speed: 0.0279s/iter; left time: 1154.6386s
Epoch: 12 cost time: 13.606584072113037
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.978 Test Loss: 0.183 Test Acc: 0.978
Validation loss decreased (-0.975127 --> -0.978271).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000387
	speed: 0.1527s/iter; left time: 6285.5341s
	iters: 200, epoch: 13 | loss: 0.0000410
	speed: 0.0268s/iter; left time: 1101.0426s
	iters: 300, epoch: 13 | loss: 2.1601636
	speed: 0.0304s/iter; left time: 1246.2481s
	iters: 400, epoch: 13 | loss: 0.0066749
	speed: 0.0302s/iter; left time: 1235.3066s
Epoch: 13 cost time: 13.884680271148682
Epoch: 13, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.410 Vali Acc: 0.955 Test Loss: 0.410 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0744894
	speed: 0.1531s/iter; left time: 6232.8363s
	iters: 200, epoch: 14 | loss: 0.0009581
	speed: 0.0297s/iter; left time: 1204.5481s
	iters: 300, epoch: 14 | loss: 0.3139929
	speed: 0.0275s/iter; left time: 1112.1959s
	iters: 400, epoch: 14 | loss: 0.0018669
	speed: 0.0271s/iter; left time: 1094.1850s
Epoch: 14 cost time: 13.720064163208008
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.963 Test Loss: 0.249 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000002
	speed: 0.1901s/iter; left time: 7649.2211s
	iters: 200, epoch: 15 | loss: 0.1410462
	speed: 0.0376s/iter; left time: 1510.0959s
	iters: 300, epoch: 15 | loss: 0.0020873
	speed: 0.0376s/iter; left time: 1506.2547s
	iters: 400, epoch: 15 | loss: 0.0000041
	speed: 0.0375s/iter; left time: 1498.4381s
Epoch: 15 cost time: 17.72356939315796
Epoch: 15, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0124546
	speed: 0.1603s/iter; left time: 6373.3485s
	iters: 200, epoch: 16 | loss: 0.0000646
	speed: 0.0288s/iter; left time: 1142.9927s
	iters: 300, epoch: 16 | loss: 0.0762693
	speed: 0.0304s/iter; left time: 1203.3678s
	iters: 400, epoch: 16 | loss: 0.0000107
	speed: 0.0332s/iter; left time: 1312.0424s
Epoch: 16 cost time: 14.800682067871094
Epoch: 16, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.209 Vali Acc: 0.979 Test Loss: 0.209 Test Acc: 0.979
Validation loss decreased (-0.978271 --> -0.978557).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0006358
	speed: 0.1568s/iter; left time: 6160.5319s
	iters: 200, epoch: 17 | loss: 0.0000043
	speed: 0.0310s/iter; left time: 1215.6584s
	iters: 300, epoch: 17 | loss: 0.0018727
	speed: 0.0302s/iter; left time: 1180.9174s
	iters: 400, epoch: 17 | loss: 0.0050109
	speed: 0.0292s/iter; left time: 1136.9773s
Epoch: 17 cost time: 14.363996744155884
Epoch: 17, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.194 Vali Acc: 0.980 Test Loss: 0.194 Test Acc: 0.980
Validation loss decreased (-0.978557 --> -0.979701).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000129
	speed: 0.1567s/iter; left time: 6083.8523s
	iters: 200, epoch: 18 | loss: 0.0000048
	speed: 0.0285s/iter; left time: 1104.2602s
	iters: 300, epoch: 18 | loss: 0.0000841
	speed: 0.0287s/iter; left time: 1110.0323s
	iters: 400, epoch: 18 | loss: 0.0094724
	speed: 0.0283s/iter; left time: 1091.2384s
Epoch: 18 cost time: 13.997640371322632
Epoch: 18, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.327 Vali Acc: 0.962 Test Loss: 0.327 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.1488s/iter; left time: 5708.6457s
	iters: 200, epoch: 19 | loss: 0.0292396
	speed: 0.0259s/iter; left time: 989.9088s
	iters: 300, epoch: 19 | loss: 0.0000020
	speed: 0.0273s/iter; left time: 1043.0583s
	iters: 400, epoch: 19 | loss: 0.4379966
	speed: 0.0260s/iter; left time: 991.4257s
Epoch: 19 cost time: 12.834880352020264
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.260 Vali Acc: 0.974 Test Loss: 0.260 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0000097
	speed: 0.1485s/iter; left time: 5628.2979s
	iters: 200, epoch: 20 | loss: 0.0000004
	speed: 0.0314s/iter; left time: 1185.4135s
	iters: 300, epoch: 20 | loss: 0.0001632
	speed: 0.0290s/iter; left time: 1092.8483s
	iters: 400, epoch: 20 | loss: 0.0000090
	speed: 0.0274s/iter; left time: 1030.8184s
Epoch: 20 cost time: 14.106506109237671
Epoch: 20, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.218 Vali Acc: 0.978 Test Loss: 0.218 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000298
	speed: 0.1515s/iter; left time: 5667.6148s
	iters: 200, epoch: 21 | loss: 0.0558184
	speed: 0.0267s/iter; left time: 995.5310s
	iters: 300, epoch: 21 | loss: 0.0000063
	speed: 0.0274s/iter; left time: 1018.4556s
	iters: 400, epoch: 21 | loss: 0.5106304
	speed: 0.0245s/iter; left time: 908.6306s
Epoch: 21 cost time: 13.162106275558472
Epoch: 21, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.376 Vali Acc: 0.965 Test Loss: 0.376 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.1550s/iter; left time: 5726.0269s
	iters: 200, epoch: 22 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 945.8253s
	iters: 300, epoch: 22 | loss: 0.0002759
	speed: 0.0265s/iter; left time: 974.8236s
	iters: 400, epoch: 22 | loss: 0.2550361
	speed: 0.0266s/iter; left time: 975.0623s
Epoch: 22 cost time: 13.279517412185669
Epoch: 22, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.356 Vali Acc: 0.971 Test Loss: 0.356 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.1549s/iter; left time: 5650.4382s
	iters: 200, epoch: 23 | loss: 0.0054054
	speed: 0.0283s/iter; left time: 1029.1001s
	iters: 300, epoch: 23 | loss: 0.0000000
	speed: 0.0303s/iter; left time: 1097.9932s
	iters: 400, epoch: 23 | loss: 0.0003587
	speed: 0.0289s/iter; left time: 1047.1201s
Epoch: 23 cost time: 14.114655017852783
Epoch: 23, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.1564s/iter; left time: 5631.0222s
	iters: 200, epoch: 24 | loss: 0.0000055
	speed: 0.0288s/iter; left time: 1034.1320s
	iters: 300, epoch: 24 | loss: 0.0000137
	speed: 0.0289s/iter; left time: 1035.1797s
	iters: 400, epoch: 24 | loss: 0.0031931
	speed: 0.0284s/iter; left time: 1012.5771s
Epoch: 24 cost time: 14.216727256774902
Epoch: 24, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.398 Vali Acc: 0.964 Test Loss: 0.398 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.1638s/iter; left time: 5821.4680s
	iters: 200, epoch: 25 | loss: 0.0028677
	speed: 0.0267s/iter; left time: 944.8197s
	iters: 300, epoch: 25 | loss: 0.0000017
	speed: 0.0268s/iter; left time: 946.6857s
	iters: 400, epoch: 25 | loss: 0.0000089
	speed: 0.0270s/iter; left time: 951.3737s
Epoch: 25 cost time: 13.430416584014893
Epoch: 25, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.375 Vali Acc: 0.970 Test Loss: 0.375 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000002
	speed: 0.1613s/iter; left time: 5658.5735s
	iters: 200, epoch: 26 | loss: 0.0089865
	speed: 0.0306s/iter; left time: 1069.0624s
	iters: 300, epoch: 26 | loss: 0.0000016
	speed: 0.0302s/iter; left time: 1054.4127s
	iters: 400, epoch: 26 | loss: 0.0000030
	speed: 0.0311s/iter; left time: 1080.2873s
Epoch: 26 cost time: 14.460318803787231
Epoch: 26, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.278 Vali Acc: 0.973 Test Loss: 0.278 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0000018
	speed: 0.1526s/iter; left time: 5281.6457s
	iters: 200, epoch: 27 | loss: 0.0356919
	speed: 0.0313s/iter; left time: 1079.3767s
	iters: 300, epoch: 27 | loss: 0.0000003
	speed: 0.0289s/iter; left time: 993.2689s
	iters: 400, epoch: 27 | loss: 0.0000000
	speed: 0.0282s/iter; left time: 968.2123s
Epoch: 27 cost time: 14.050245761871338
Epoch: 27, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.378 Vali Acc: 0.968 Test Loss: 0.378 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 838690
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1688097
	speed: 0.0473s/iter; left time: 2211.9657s
	iters: 200, epoch: 1 | loss: 0.5641933
	speed: 0.0290s/iter; left time: 1353.2328s
	iters: 300, epoch: 1 | loss: 0.0899665
	speed: 0.0278s/iter; left time: 1294.6291s
	iters: 400, epoch: 1 | loss: 0.0162797
	speed: 0.0263s/iter; left time: 1224.0564s
Epoch: 1 cost time: 14.897043228149414
Epoch: 1, Steps: 469 | Train Loss: 0.335 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (inf --> -0.941393).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0494029
	speed: 0.1469s/iter; left time: 6807.1896s
	iters: 200, epoch: 2 | loss: 0.0285032
	speed: 0.0284s/iter; left time: 1314.6975s
	iters: 300, epoch: 2 | loss: 0.0403203
	speed: 0.0252s/iter; left time: 1162.0499s
	iters: 400, epoch: 2 | loss: 0.0855122
	speed: 0.0247s/iter; left time: 1136.9099s
Epoch: 2 cost time: 12.806288003921509
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.925 Test Loss: 0.277 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0398118
	speed: 0.1328s/iter; left time: 6089.7291s
	iters: 200, epoch: 3 | loss: 0.0010167
	speed: 0.0269s/iter; left time: 1231.1225s
	iters: 300, epoch: 3 | loss: 0.0800016
	speed: 0.0301s/iter; left time: 1372.4040s
	iters: 400, epoch: 3 | loss: 0.0152356
	speed: 0.0261s/iter; left time: 1188.0158s
Epoch: 3 cost time: 13.330330610275269
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
Validation loss decreased (-0.941393 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0106473
	speed: 0.1462s/iter; left time: 6634.8319s
	iters: 200, epoch: 4 | loss: 0.0461647
	speed: 0.0276s/iter; left time: 1248.6194s
	iters: 300, epoch: 4 | loss: 0.0035453
	speed: 0.0275s/iter; left time: 1244.7838s
	iters: 400, epoch: 4 | loss: 0.0015193
	speed: 0.0309s/iter; left time: 1395.4218s
Epoch: 4 cost time: 13.481927394866943
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0646355
	speed: 0.1524s/iter; left time: 6846.7187s
	iters: 200, epoch: 5 | loss: 0.0047832
	speed: 0.0316s/iter; left time: 1415.8602s
	iters: 300, epoch: 5 | loss: 0.0013450
	speed: 0.0289s/iter; left time: 1290.6050s
	iters: 400, epoch: 5 | loss: 0.0480356
	speed: 0.0296s/iter; left time: 1318.7714s
Epoch: 5 cost time: 14.085406303405762
Epoch: 5, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.961119 --> -0.977700).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1654225
	speed: 0.1526s/iter; left time: 6784.0188s
	iters: 200, epoch: 6 | loss: 0.0283100
	speed: 0.0277s/iter; left time: 1229.7972s
	iters: 300, epoch: 6 | loss: 0.3750015
	speed: 0.0272s/iter; left time: 1201.8004s
	iters: 400, epoch: 6 | loss: 0.0001674
	speed: 0.0277s/iter; left time: 1224.9374s
Epoch: 6 cost time: 13.325014352798462
Epoch: 6, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.191 Vali Acc: 0.961 Test Loss: 0.191 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000718
	speed: 0.1494s/iter; left time: 6570.7884s
	iters: 200, epoch: 7 | loss: 0.3198986
	speed: 0.0276s/iter; left time: 1211.9771s
	iters: 300, epoch: 7 | loss: 0.0710350
	speed: 0.0303s/iter; left time: 1328.7428s
	iters: 400, epoch: 7 | loss: 0.2711919
	speed: 0.0305s/iter; left time: 1331.4652s
Epoch: 7 cost time: 13.954073190689087
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1914506
	speed: 0.1543s/iter; left time: 6715.5034s
	iters: 200, epoch: 8 | loss: 0.0118340
	speed: 0.0310s/iter; left time: 1345.3546s
	iters: 300, epoch: 8 | loss: 0.0012399
	speed: 0.0302s/iter; left time: 1309.1760s
	iters: 400, epoch: 8 | loss: 0.0001744
	speed: 0.0296s/iter; left time: 1278.7450s
Epoch: 8 cost time: 14.619697093963623
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0053966
	speed: 0.1553s/iter; left time: 6687.3070s
	iters: 200, epoch: 9 | loss: 0.0117860
	speed: 0.0292s/iter; left time: 1253.3863s
	iters: 300, epoch: 9 | loss: 0.0030050
	speed: 0.0315s/iter; left time: 1348.3801s
	iters: 400, epoch: 9 | loss: 0.0147824
	speed: 0.0316s/iter; left time: 1351.5470s
Epoch: 9 cost time: 14.747650384902954
Epoch: 9, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.3354877
	speed: 0.1595s/iter; left time: 6790.9932s
	iters: 200, epoch: 10 | loss: 0.0000857
	speed: 0.0259s/iter; left time: 1098.2631s
	iters: 300, epoch: 10 | loss: 0.0242407
	speed: 0.0254s/iter; left time: 1075.6705s
	iters: 400, epoch: 10 | loss: 0.0001783
	speed: 0.0277s/iter; left time: 1169.3036s
Epoch: 10 cost time: 13.286299705505371
Epoch: 10, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0005340
	speed: 0.1583s/iter; left time: 6665.1778s
	iters: 200, epoch: 11 | loss: 0.0002119
	speed: 0.0278s/iter; left time: 1166.9111s
	iters: 300, epoch: 11 | loss: 0.9038109
	speed: 0.0264s/iter; left time: 1104.8254s
	iters: 400, epoch: 11 | loss: 0.0670583
	speed: 0.0275s/iter; left time: 1148.5324s
Epoch: 11 cost time: 13.52788758277893
Epoch: 11, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0472292
	speed: 0.1565s/iter; left time: 6516.7256s
	iters: 200, epoch: 12 | loss: 0.0286848
	speed: 0.0290s/iter; left time: 1202.8830s
	iters: 300, epoch: 12 | loss: 0.0002547
	speed: 0.0306s/iter; left time: 1268.8246s
	iters: 400, epoch: 12 | loss: 0.0970884
	speed: 0.0270s/iter; left time: 1117.7029s
Epoch: 12 cost time: 14.05685806274414
Epoch: 12, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0004558
	speed: 0.1506s/iter; left time: 6202.4945s
	iters: 200, epoch: 13 | loss: 0.0158927
	speed: 0.0262s/iter; left time: 1075.9307s
	iters: 300, epoch: 13 | loss: 0.0011791
	speed: 0.0265s/iter; left time: 1087.2376s
	iters: 400, epoch: 13 | loss: 0.0212613
	speed: 0.0272s/iter; left time: 1113.4072s
Epoch: 13 cost time: 13.4421067237854
Epoch: 13, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.308 Vali Acc: 0.941 Test Loss: 0.308 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0015043
	speed: 0.1550s/iter; left time: 6308.5699s
	iters: 200, epoch: 14 | loss: 0.1824457
	speed: 0.0289s/iter; left time: 1175.4054s
	iters: 300, epoch: 14 | loss: 0.0242164
	speed: 0.0296s/iter; left time: 1199.6509s
	iters: 400, epoch: 14 | loss: 0.0000001
	speed: 0.0294s/iter; left time: 1188.4904s
Epoch: 14 cost time: 14.050470113754272
Epoch: 14, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0661404
	speed: 0.1475s/iter; left time: 5934.4009s
	iters: 200, epoch: 15 | loss: 0.0215222
	speed: 0.0307s/iter; left time: 1233.2998s
	iters: 300, epoch: 15 | loss: 0.0332164
	speed: 0.0286s/iter; left time: 1143.3438s
	iters: 400, epoch: 15 | loss: 0.0035222
	speed: 0.0281s/iter; left time: 1121.3250s
Epoch: 15 cost time: 14.120235681533813
Epoch: 15, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 707618
model size : 12.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1569958
	speed: 0.0501s/iter; left time: 2345.1758s
	iters: 200, epoch: 1 | loss: 0.5651420
	speed: 0.0274s/iter; left time: 1278.7505s
	iters: 300, epoch: 1 | loss: 0.1368868
	speed: 0.0280s/iter; left time: 1305.3017s
	iters: 400, epoch: 1 | loss: 0.0119043
	speed: 0.0278s/iter; left time: 1292.0962s
Epoch: 1 cost time: 15.60265851020813
Epoch: 1, Steps: 469 | Train Loss: 0.333 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (inf --> -0.949684).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0218259
	speed: 0.1537s/iter; left time: 7119.2257s
	iters: 200, epoch: 2 | loss: 0.1547678
	speed: 0.0290s/iter; left time: 1341.1935s
	iters: 300, epoch: 2 | loss: 0.0929097
	speed: 0.0315s/iter; left time: 1451.9699s
	iters: 400, epoch: 2 | loss: 0.0736448
	speed: 0.0309s/iter; left time: 1424.1238s
Epoch: 2 cost time: 14.497141361236572
Epoch: 2, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.4123728
	speed: 0.1583s/iter; left time: 7258.7180s
	iters: 200, epoch: 3 | loss: 0.0002494
	speed: 0.0284s/iter; left time: 1301.0321s
	iters: 300, epoch: 3 | loss: 0.0154541
	speed: 0.0261s/iter; left time: 1191.7276s
	iters: 400, epoch: 3 | loss: 0.0135144
	speed: 0.0267s/iter; left time: 1216.9027s
Epoch: 3 cost time: 13.41837763786316
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0026796
	speed: 0.1421s/iter; left time: 6449.5959s
	iters: 200, epoch: 4 | loss: 0.0529414
	speed: 0.0241s/iter; left time: 1091.9493s
	iters: 300, epoch: 4 | loss: 0.0021373
	speed: 0.0261s/iter; left time: 1181.6451s
	iters: 400, epoch: 4 | loss: 0.0031045
	speed: 0.0273s/iter; left time: 1229.1137s
Epoch: 4 cost time: 12.67801809310913
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.277 Vali Acc: 0.939 Test Loss: 0.277 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.2469864
	speed: 0.1520s/iter; left time: 6828.3298s
	iters: 200, epoch: 5 | loss: 0.0213771
	speed: 0.0286s/iter; left time: 1282.5460s
	iters: 300, epoch: 5 | loss: 0.0045135
	speed: 0.0290s/iter; left time: 1299.1904s
	iters: 400, epoch: 5 | loss: 0.0194255
	speed: 0.0280s/iter; left time: 1251.0054s
Epoch: 5 cost time: 13.767005920410156
Epoch: 5, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.207 Vali Acc: 0.961 Test Loss: 0.207 Test Acc: 0.961
Validation loss decreased (-0.949684 --> -0.960547).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035874
	speed: 0.1507s/iter; left time: 6698.3860s
	iters: 200, epoch: 6 | loss: 0.0037007
	speed: 0.0252s/iter; left time: 1117.0317s
	iters: 300, epoch: 6 | loss: 0.0025034
	speed: 0.0275s/iter; left time: 1218.9140s
	iters: 400, epoch: 6 | loss: 0.0138330
	speed: 0.0281s/iter; left time: 1241.2005s
Epoch: 6 cost time: 13.357906103134155
Epoch: 6, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.960547 --> -0.966836).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0001307
	speed: 0.1514s/iter; left time: 6658.2053s
	iters: 200, epoch: 7 | loss: 0.1893215
	speed: 0.0285s/iter; left time: 1251.8559s
	iters: 300, epoch: 7 | loss: 0.4481020
	speed: 0.0287s/iter; left time: 1257.9242s
	iters: 400, epoch: 7 | loss: 0.1833031
	speed: 0.0277s/iter; left time: 1209.5262s
Epoch: 7 cost time: 13.577427625656128
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.7637078
	speed: 0.1536s/iter; left time: 6685.2579s
	iters: 200, epoch: 8 | loss: 0.0017684
	speed: 0.0285s/iter; left time: 1237.9732s
	iters: 300, epoch: 8 | loss: 0.0121388
	speed: 0.0286s/iter; left time: 1237.3405s
	iters: 400, epoch: 8 | loss: 0.0000118
	speed: 0.0289s/iter; left time: 1249.9245s
Epoch: 8 cost time: 13.94826889038086
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.954 Test Loss: 0.228 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0777944
	speed: 0.1513s/iter; left time: 6514.0085s
	iters: 200, epoch: 9 | loss: 0.1157734
	speed: 0.0306s/iter; left time: 1312.7576s
	iters: 300, epoch: 9 | loss: 0.0402007
	speed: 0.0300s/iter; left time: 1284.9217s
	iters: 400, epoch: 9 | loss: 0.2234392
	speed: 0.0311s/iter; left time: 1330.5244s
Epoch: 9 cost time: 14.656760692596436
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.964 Test Loss: 0.204 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.2244619
	speed: 0.1560s/iter; left time: 6642.5523s
	iters: 200, epoch: 10 | loss: 0.0000180
	speed: 0.0311s/iter; left time: 1319.7586s
	iters: 300, epoch: 10 | loss: 0.0201317
	speed: 0.0320s/iter; left time: 1356.2536s
	iters: 400, epoch: 10 | loss: 0.0007635
	speed: 0.0295s/iter; left time: 1246.3880s
Epoch: 10 cost time: 14.488556385040283
Epoch: 10, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.244 Vali Acc: 0.962 Test Loss: 0.244 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0001195
	speed: 0.1555s/iter; left time: 6549.2673s
	iters: 200, epoch: 11 | loss: 0.0012499
	speed: 0.0296s/iter; left time: 1244.2063s
	iters: 300, epoch: 11 | loss: 0.4661027
	speed: 0.0295s/iter; left time: 1237.0559s
	iters: 400, epoch: 11 | loss: 0.0067530
	speed: 0.0281s/iter; left time: 1176.2853s
Epoch: 11 cost time: 14.203485012054443
Epoch: 11, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0023926
	speed: 0.1542s/iter; left time: 6422.3527s
	iters: 200, epoch: 12 | loss: 0.0007918
	speed: 0.0299s/iter; left time: 1240.5509s
	iters: 300, epoch: 12 | loss: 0.0050246
	speed: 0.0319s/iter; left time: 1321.1664s
	iters: 400, epoch: 12 | loss: 0.0003895
	speed: 0.0289s/iter; left time: 1193.6966s
Epoch: 12 cost time: 14.292540311813354
Epoch: 12, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0376193
	speed: 0.1454s/iter; left time: 5985.0732s
	iters: 200, epoch: 13 | loss: 0.0211734
	speed: 0.0253s/iter; left time: 1037.4589s
	iters: 300, epoch: 13 | loss: 0.0005787
	speed: 0.0280s/iter; left time: 1147.7599s
	iters: 400, epoch: 13 | loss: 0.0002994
	speed: 0.0238s/iter; left time: 972.9181s
Epoch: 13 cost time: 12.541842937469482
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.190 Vali Acc: 0.958 Test Loss: 0.190 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000272
	speed: 0.1577s/iter; left time: 6418.3040s
	iters: 200, epoch: 14 | loss: 0.3657275
	speed: 0.0259s/iter; left time: 1053.5690s
	iters: 300, epoch: 14 | loss: 0.0000211
	speed: 0.0267s/iter; left time: 1080.9196s
	iters: 400, epoch: 14 | loss: 0.1519011
	speed: 0.0254s/iter; left time: 1027.6890s
Epoch: 14 cost time: 12.887778043746948
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.947 Test Loss: 0.260 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.2985123
	speed: 0.1575s/iter; left time: 6335.1942s
	iters: 200, epoch: 15 | loss: 0.0024932
	speed: 0.0275s/iter; left time: 1104.1746s
	iters: 300, epoch: 15 | loss: 0.0001878
	speed: 0.0291s/iter; left time: 1164.5042s
	iters: 400, epoch: 15 | loss: 0.0009612
	speed: 0.0300s/iter; left time: 1198.8101s
Epoch: 15 cost time: 13.310194969177246
Epoch: 15, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.233 Vali Acc: 0.963 Test Loss: 0.233 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002415
	speed: 0.1622s/iter; left time: 6449.4406s
	iters: 200, epoch: 16 | loss: 0.0460284
	speed: 0.0249s/iter; left time: 987.2196s
	iters: 300, epoch: 16 | loss: 0.0000911
	speed: 0.0217s/iter; left time: 859.9666s
	iters: 400, epoch: 16 | loss: 0.0928452
	speed: 0.0201s/iter; left time: 793.6682s
Epoch: 16 cost time: 11.866430759429932
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9668381932532876
model parameter : 707618
model size : 12.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.1848428
	speed: 0.0485s/iter; left time: 2269.2187s
	iters: 200, epoch: 1 | loss: 0.8350222
	speed: 0.0296s/iter; left time: 1382.8166s
	iters: 300, epoch: 1 | loss: 0.0618193
	speed: 0.0295s/iter; left time: 1373.7849s
	iters: 400, epoch: 1 | loss: 0.0084664
	speed: 0.0293s/iter; left time: 1360.9273s
Epoch: 1 cost time: 15.77881646156311
Epoch: 1, Steps: 469 | Train Loss: 0.346 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (inf --> -0.963406).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0040963
	speed: 0.1483s/iter; left time: 6868.9973s
	iters: 200, epoch: 2 | loss: 0.0741661
	speed: 0.0274s/iter; left time: 1267.4661s
	iters: 300, epoch: 2 | loss: 0.0275873
	speed: 0.0299s/iter; left time: 1377.7741s
	iters: 400, epoch: 2 | loss: 0.0517403
	speed: 0.0309s/iter; left time: 1422.3120s
Epoch: 2 cost time: 14.152199506759644
Epoch: 2, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.963406 --> -0.969982).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1390872
	speed: 0.1513s/iter; left time: 6939.5435s
	iters: 200, epoch: 3 | loss: 0.0001141
	speed: 0.0301s/iter; left time: 1376.3110s
	iters: 300, epoch: 3 | loss: 0.0774666
	speed: 0.0280s/iter; left time: 1277.5204s
	iters: 400, epoch: 3 | loss: 0.0014917
	speed: 0.0241s/iter; left time: 1099.3784s
Epoch: 3 cost time: 13.403362035751343
Epoch: 3, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0563424
	speed: 0.1471s/iter; left time: 6676.8428s
	iters: 200, epoch: 4 | loss: 0.0192621
	speed: 0.0266s/iter; left time: 1204.3140s
	iters: 300, epoch: 4 | loss: 0.0009094
	speed: 0.0261s/iter; left time: 1180.1793s
	iters: 400, epoch: 4 | loss: 0.0018891
	speed: 0.0245s/iter; left time: 1103.6246s
Epoch: 4 cost time: 12.66334581375122
Epoch: 4, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.298 Vali Acc: 0.951 Test Loss: 0.298 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0083342
	speed: 0.1436s/iter; left time: 6450.3306s
	iters: 200, epoch: 5 | loss: 0.0540644
	speed: 0.0258s/iter; left time: 1157.9384s
	iters: 300, epoch: 5 | loss: 0.0007912
	speed: 0.0254s/iter; left time: 1136.1853s
	iters: 400, epoch: 5 | loss: 0.0013332
	speed: 0.0266s/iter; left time: 1188.7770s
Epoch: 5 cost time: 12.588476181030273
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.230 Vali Acc: 0.963 Test Loss: 0.230 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.4118932
	speed: 0.1443s/iter; left time: 6414.4968s
	iters: 200, epoch: 6 | loss: 0.0007050
	speed: 0.0263s/iter; left time: 1167.8870s
	iters: 300, epoch: 6 | loss: 0.0043222
	speed: 0.0275s/iter; left time: 1218.8940s
	iters: 400, epoch: 6 | loss: 0.0110266
	speed: 0.0287s/iter; left time: 1267.6009s
Epoch: 6 cost time: 13.091694593429565
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.969982 --> -0.974841).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000462
	speed: 0.1441s/iter; left time: 6339.3159s
	iters: 200, epoch: 7 | loss: 0.0007272
	speed: 0.0300s/iter; left time: 1317.2560s
	iters: 300, epoch: 7 | loss: 0.0051964
	speed: 0.0271s/iter; left time: 1187.1922s
	iters: 400, epoch: 7 | loss: 0.0043532
	speed: 0.0273s/iter; left time: 1190.5914s
Epoch: 7 cost time: 13.6121244430542
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.314 Vali Acc: 0.959 Test Loss: 0.314 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.4240618
	speed: 0.1370s/iter; left time: 5963.8095s
	iters: 200, epoch: 8 | loss: 0.0012258
	speed: 0.0240s/iter; left time: 1041.4289s
	iters: 300, epoch: 8 | loss: 0.0000017
	speed: 0.0212s/iter; left time: 918.7268s
	iters: 400, epoch: 8 | loss: 0.0016716
	speed: 0.0222s/iter; left time: 959.3100s
Epoch: 8 cost time: 10.927172183990479
Epoch: 8, Steps: 469 | Train Loss: 0.092 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0000717
	speed: 0.1333s/iter; left time: 5738.9398s
	iters: 200, epoch: 9 | loss: 0.0031229
	speed: 0.0258s/iter; left time: 1108.6540s
	iters: 300, epoch: 9 | loss: 0.2147538
	speed: 0.0246s/iter; left time: 1052.4843s
	iters: 400, epoch: 9 | loss: 0.0000745
	speed: 0.0273s/iter; left time: 1164.9827s
Epoch: 9 cost time: 13.042352676391602
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.242 Vali Acc: 0.956 Test Loss: 0.242 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0053481
	speed: 0.1543s/iter; left time: 6570.3600s
	iters: 200, epoch: 10 | loss: 0.0000063
	speed: 0.0264s/iter; left time: 1123.0474s
	iters: 300, epoch: 10 | loss: 0.0001556
	speed: 0.0257s/iter; left time: 1091.0445s
	iters: 400, epoch: 10 | loss: 0.0050357
	speed: 0.0292s/iter; left time: 1233.9645s
Epoch: 10 cost time: 13.266042470932007
Epoch: 10, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.974841 --> -0.976842).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003716
	speed: 0.1491s/iter; left time: 6277.6292s
	iters: 200, epoch: 11 | loss: 0.0000038
	speed: 0.0306s/iter; left time: 1285.5435s
	iters: 300, epoch: 11 | loss: 1.4503024
	speed: 0.0293s/iter; left time: 1228.6675s
	iters: 400, epoch: 11 | loss: 0.0053497
	speed: 0.0266s/iter; left time: 1113.0534s
Epoch: 11 cost time: 14.0247220993042
Epoch: 11, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.212 Vali Acc: 0.974 Test Loss: 0.212 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000008
	speed: 0.1478s/iter; left time: 6154.0117s
	iters: 200, epoch: 12 | loss: 0.0000783
	speed: 0.0281s/iter; left time: 1168.6940s
	iters: 300, epoch: 12 | loss: 0.0000093
	speed: 0.0278s/iter; left time: 1151.9910s
	iters: 400, epoch: 12 | loss: 0.0437911
	speed: 0.0299s/iter; left time: 1237.8916s
Epoch: 12 cost time: 13.933563947677612
Epoch: 12, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.309 Vali Acc: 0.965 Test Loss: 0.309 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0034014
	speed: 0.1408s/iter; left time: 5798.8981s
	iters: 200, epoch: 13 | loss: 0.5214224
	speed: 0.0263s/iter; left time: 1082.0444s
	iters: 300, epoch: 13 | loss: 0.0005572
	speed: 0.0273s/iter; left time: 1119.5722s
	iters: 400, epoch: 13 | loss: 0.0000001
	speed: 0.0269s/iter; left time: 1100.8381s
Epoch: 13 cost time: 12.672754049301147
Epoch: 13, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.328 Vali Acc: 0.963 Test Loss: 0.328 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0670668
	speed: 0.1471s/iter; left time: 5989.4221s
	iters: 200, epoch: 14 | loss: 0.4317634
	speed: 0.0270s/iter; left time: 1096.3563s
	iters: 300, epoch: 14 | loss: 0.0000003
	speed: 0.0276s/iter; left time: 1118.9827s
	iters: 400, epoch: 14 | loss: 0.0004465
	speed: 0.0249s/iter; left time: 1006.8148s
Epoch: 14 cost time: 12.929757833480835
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0001816
	speed: 0.1427s/iter; left time: 5742.6217s
	iters: 200, epoch: 15 | loss: 0.0002223
	speed: 0.0278s/iter; left time: 1117.6059s
	iters: 300, epoch: 15 | loss: 0.0518692
	speed: 0.0249s/iter; left time: 995.9781s
	iters: 400, epoch: 15 | loss: 0.0000012
	speed: 0.0263s/iter; left time: 1049.4789s
Epoch: 15 cost time: 12.922118663787842
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.191 Vali Acc: 0.982 Test Loss: 0.191 Test Acc: 0.982
Validation loss decreased (-0.976842 --> -0.981988).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000083
	speed: 0.1439s/iter; left time: 5721.0856s
	iters: 200, epoch: 16 | loss: 0.0000064
	speed: 0.0257s/iter; left time: 1020.1625s
	iters: 300, epoch: 16 | loss: 0.0032162
	speed: 0.0257s/iter; left time: 1015.3478s
	iters: 400, epoch: 16 | loss: 0.8220215
	speed: 0.0286s/iter; left time: 1128.3350s
Epoch: 16 cost time: 13.024401187896729
Epoch: 16, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.324 Vali Acc: 0.952 Test Loss: 0.324 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000001
	speed: 0.1458s/iter; left time: 5730.6564s
	iters: 200, epoch: 17 | loss: 0.0067558
	speed: 0.0299s/iter; left time: 1171.0010s
	iters: 300, epoch: 17 | loss: 0.0010790
	speed: 0.0292s/iter; left time: 1140.4302s
	iters: 400, epoch: 17 | loss: 0.0000005
	speed: 0.0263s/iter; left time: 1024.9174s
Epoch: 17 cost time: 13.435303688049316
Epoch: 17, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000039
	speed: 0.1391s/iter; left time: 5400.5386s
	iters: 200, epoch: 18 | loss: 0.0007272
	speed: 0.0276s/iter; left time: 1069.9641s
	iters: 300, epoch: 18 | loss: 0.0037799
	speed: 0.0283s/iter; left time: 1092.1461s
	iters: 400, epoch: 18 | loss: 0.0388010
	speed: 0.0279s/iter; left time: 1075.3897s
Epoch: 18 cost time: 13.571263074874878
Epoch: 18, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.299 Vali Acc: 0.971 Test Loss: 0.299 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000749
	speed: 0.1481s/iter; left time: 5682.7435s
	iters: 200, epoch: 19 | loss: 0.0000001
	speed: 0.0257s/iter; left time: 983.4300s
	iters: 300, epoch: 19 | loss: 0.0000052
	speed: 0.0267s/iter; left time: 1020.4128s
	iters: 400, epoch: 19 | loss: 0.0006725
	speed: 0.0285s/iter; left time: 1086.2092s
Epoch: 19 cost time: 13.204682111740112
Epoch: 19, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.372 Vali Acc: 0.955 Test Loss: 0.372 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000136
	speed: 0.1520s/iter; left time: 5760.6252s
	iters: 200, epoch: 20 | loss: 0.0001915
	speed: 0.0275s/iter; left time: 1037.6393s
	iters: 300, epoch: 20 | loss: 1.1936853
	speed: 0.0286s/iter; left time: 1079.4277s
	iters: 400, epoch: 20 | loss: 0.0039210
	speed: 0.0296s/iter; left time: 1114.1863s
Epoch: 20 cost time: 13.552070140838623
Epoch: 20, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.324 Vali Acc: 0.979 Test Loss: 0.324 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.1493s/iter; left time: 5585.5780s
	iters: 200, epoch: 21 | loss: 0.5851760
	speed: 0.0302s/iter; left time: 1128.7241s
	iters: 300, epoch: 21 | loss: 0.0001931
	speed: 0.0281s/iter; left time: 1045.5543s
	iters: 400, epoch: 21 | loss: 0.0000001
	speed: 0.0284s/iter; left time: 1053.5881s
Epoch: 21 cost time: 14.109836101531982
Epoch: 21, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.968 Test Loss: 0.310 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0001562
	speed: 0.1459s/iter; left time: 5390.4707s
	iters: 200, epoch: 22 | loss: 0.5713784
	speed: 0.0262s/iter; left time: 966.6106s
	iters: 300, epoch: 22 | loss: 0.0000012
	speed: 0.0281s/iter; left time: 1031.8060s
	iters: 400, epoch: 22 | loss: 0.5653785
	speed: 0.0280s/iter; left time: 1027.2551s
Epoch: 22 cost time: 13.276552677154541
Epoch: 22, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.396 Vali Acc: 0.965 Test Loss: 0.396 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000555
	speed: 0.1446s/iter; left time: 5276.4753s
	iters: 200, epoch: 23 | loss: 0.0014916
	speed: 0.0247s/iter; left time: 897.4984s
	iters: 300, epoch: 23 | loss: 0.0395158
	speed: 0.0265s/iter; left time: 962.3248s
	iters: 400, epoch: 23 | loss: 0.0000154
	speed: 0.0278s/iter; left time: 1005.2563s
Epoch: 23 cost time: 12.538930416107178
Epoch: 23, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.295 Vali Acc: 0.978 Test Loss: 0.295 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0297035
	speed: 0.1353s/iter; left time: 4873.3662s
	iters: 200, epoch: 24 | loss: 0.0000007
	speed: 0.0302s/iter; left time: 1083.9625s
	iters: 300, epoch: 24 | loss: 0.0000001
	speed: 0.0288s/iter; left time: 1031.3636s
	iters: 400, epoch: 24 | loss: 0.0003282
	speed: 0.0257s/iter; left time: 917.3564s
Epoch: 24 cost time: 13.22530221939087
Epoch: 24, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.172 Vali Acc: 0.982 Test Loss: 0.172 Test Acc: 0.982
Validation loss decreased (-0.981988 --> -0.982274).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000015
	speed: 0.1413s/iter; left time: 5022.4971s
	iters: 200, epoch: 25 | loss: 0.0000015
	speed: 0.0287s/iter; left time: 1016.4269s
	iters: 300, epoch: 25 | loss: 0.0498724
	speed: 0.0277s/iter; left time: 978.5853s
	iters: 400, epoch: 25 | loss: 0.0001884
	speed: 0.0266s/iter; left time: 937.2672s
Epoch: 25 cost time: 13.509857654571533
Epoch: 25, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.3986086
	speed: 0.1396s/iter; left time: 4896.6830s
	iters: 200, epoch: 26 | loss: 0.0001370
	speed: 0.0247s/iter; left time: 863.9139s
	iters: 300, epoch: 26 | loss: 0.0000387
	speed: 0.0245s/iter; left time: 854.5141s
	iters: 400, epoch: 26 | loss: 0.0000004
	speed: 0.0253s/iter; left time: 878.7579s
Epoch: 26 cost time: 12.330565214157104
Epoch: 26, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.268 Vali Acc: 0.970 Test Loss: 0.268 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0000001
	speed: 0.1511s/iter; left time: 5229.5226s
	iters: 200, epoch: 27 | loss: 0.0001192
	speed: 0.0290s/iter; left time: 999.4497s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0309s/iter; left time: 1063.8452s
	iters: 400, epoch: 27 | loss: 0.0205490
	speed: 0.0260s/iter; left time: 890.5170s
Epoch: 27 cost time: 13.780706644058228
Epoch: 27, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.627 Vali Acc: 0.957 Test Loss: 0.627 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000060
	speed: 0.1532s/iter; left time: 5228.8802s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0314s/iter; left time: 1070.4363s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0290s/iter; left time: 984.0148s
	iters: 400, epoch: 28 | loss: 0.0010316
	speed: 0.0264s/iter; left time: 894.0378s
Epoch: 28 cost time: 14.259594202041626
Epoch: 28, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.379 Vali Acc: 0.965 Test Loss: 0.379 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.6920744
	speed: 0.1575s/iter; left time: 5303.1010s
	iters: 200, epoch: 29 | loss: 0.0000015
	speed: 0.0266s/iter; left time: 894.2930s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0265s/iter; left time: 886.8345s
	iters: 400, epoch: 29 | loss: 0.0000308
	speed: 0.0258s/iter; left time: 860.2095s
Epoch: 29 cost time: 13.214497804641724
Epoch: 29, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.304 Vali Acc: 0.973 Test Loss: 0.304 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.1506s/iter; left time: 4999.0706s
	iters: 200, epoch: 30 | loss: 0.0000017
	speed: 0.0273s/iter; left time: 903.2346s
	iters: 300, epoch: 30 | loss: 0.0000000
	speed: 0.0287s/iter; left time: 948.6015s
	iters: 400, epoch: 30 | loss: 0.0000001
	speed: 0.0290s/iter; left time: 955.6913s
Epoch: 30 cost time: 13.726305723190308
Epoch: 30, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.378 Vali Acc: 0.971 Test Loss: 0.378 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.6880362
	speed: 0.1464s/iter; left time: 4790.9860s
	iters: 200, epoch: 31 | loss: 0.0000001
	speed: 0.0301s/iter; left time: 982.7480s
	iters: 300, epoch: 31 | loss: 0.0000050
	speed: 0.0269s/iter; left time: 875.1498s
	iters: 400, epoch: 31 | loss: 0.0034871
	speed: 0.0285s/iter; left time: 925.0536s
Epoch: 31 cost time: 13.80565071105957
Epoch: 31, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.266 Vali Acc: 0.977 Test Loss: 0.266 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0000475
	speed: 0.1429s/iter; left time: 4609.1975s
	iters: 200, epoch: 32 | loss: 0.0890083
	speed: 0.0261s/iter; left time: 840.9870s
	iters: 300, epoch: 32 | loss: 0.0150306
	speed: 0.0264s/iter; left time: 847.3028s
	iters: 400, epoch: 32 | loss: 0.0000223
	speed: 0.0272s/iter; left time: 870.7612s
Epoch: 32 cost time: 12.685783624649048
Epoch: 32, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.397 Vali Acc: 0.972 Test Loss: 0.397 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0068483
	speed: 0.1452s/iter; left time: 4616.8670s
	iters: 200, epoch: 33 | loss: 0.0000000
	speed: 0.0254s/iter; left time: 804.9796s
	iters: 300, epoch: 33 | loss: 0.0000015
	speed: 0.0255s/iter; left time: 806.0683s
	iters: 400, epoch: 33 | loss: 0.0000000
	speed: 0.0276s/iter; left time: 869.0567s
Epoch: 33 cost time: 12.553175210952759
Epoch: 33, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.326 Vali Acc: 0.976 Test Loss: 0.326 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.1458s/iter; left time: 4567.8263s
	iters: 200, epoch: 34 | loss: 0.0000003
	speed: 0.0251s/iter; left time: 782.6909s
	iters: 300, epoch: 34 | loss: 0.0000000
	speed: 0.0293s/iter; left time: 912.8087s
	iters: 400, epoch: 34 | loss: 0.0000029
	speed: 0.0296s/iter; left time: 917.6747s
Epoch: 34 cost time: 13.257739305496216
Epoch: 34, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.353 Vali Acc: 0.973 Test Loss: 0.353 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 707618
model size : 12.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2817948
	speed: 0.0457s/iter; left time: 2138.3249s
	iters: 200, epoch: 1 | loss: 0.1162210
	speed: 0.0279s/iter; left time: 1304.5188s
	iters: 300, epoch: 1 | loss: 0.0495155
	speed: 0.0292s/iter; left time: 1362.1432s
	iters: 400, epoch: 1 | loss: 0.0161545
	speed: 0.0296s/iter; left time: 1374.4195s
Epoch: 1 cost time: 15.277167081832886
Epoch: 1, Steps: 469 | Train Loss: 0.357 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
Validation loss decreased (inf --> -0.950255).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0173288
	speed: 0.1354s/iter; left time: 6274.5442s
	iters: 200, epoch: 2 | loss: 0.1684181
	speed: 0.0308s/iter; left time: 1424.6221s
	iters: 300, epoch: 2 | loss: 0.0158027
	speed: 0.0295s/iter; left time: 1358.9995s
	iters: 400, epoch: 2 | loss: 0.2502336
	speed: 0.0290s/iter; left time: 1334.2209s
Epoch: 2 cost time: 13.937844514846802
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.950255 --> -0.956831).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0087722
	speed: 0.1528s/iter; left time: 7007.9357s
	iters: 200, epoch: 3 | loss: 0.0033610
	speed: 0.0275s/iter; left time: 1258.9710s
	iters: 300, epoch: 3 | loss: 0.2525789
	speed: 0.0263s/iter; left time: 1201.8983s
	iters: 400, epoch: 3 | loss: 0.3789810
	speed: 0.0256s/iter; left time: 1168.4393s
Epoch: 3 cost time: 12.998933792114258
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0528341
	speed: 0.1409s/iter; left time: 6397.6525s
	iters: 200, epoch: 4 | loss: 0.0035027
	speed: 0.0278s/iter; left time: 1258.1354s
	iters: 300, epoch: 4 | loss: 0.2041993
	speed: 0.0267s/iter; left time: 1206.1966s
	iters: 400, epoch: 4 | loss: 0.0534064
	speed: 0.0278s/iter; left time: 1253.6819s
Epoch: 4 cost time: 13.280067682266235
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.956831 --> -0.958260).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0061288
	speed: 0.1424s/iter; left time: 6397.1435s
	iters: 200, epoch: 5 | loss: 0.0944567
	speed: 0.0299s/iter; left time: 1340.0114s
	iters: 300, epoch: 5 | loss: 0.0004199
	speed: 0.0291s/iter; left time: 1300.9183s
	iters: 400, epoch: 5 | loss: 0.2465830
	speed: 0.0266s/iter; left time: 1186.8737s
Epoch: 5 cost time: 13.49070119857788
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0259494
	speed: 0.1451s/iter; left time: 6450.3786s
	iters: 200, epoch: 6 | loss: 0.0100424
	speed: 0.0256s/iter; left time: 1136.1630s
	iters: 300, epoch: 6 | loss: 0.0317468
	speed: 0.0249s/iter; left time: 1101.9422s
	iters: 400, epoch: 6 | loss: 0.0001125
	speed: 0.0251s/iter; left time: 1108.0841s
Epoch: 6 cost time: 12.561398267745972
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.227 Vali Acc: 0.947 Test Loss: 0.227 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.2656580
	speed: 0.1521s/iter; left time: 6691.9668s
	iters: 200, epoch: 7 | loss: 0.0022385
	speed: 0.0258s/iter; left time: 1133.6659s
	iters: 300, epoch: 7 | loss: 0.0444848
	speed: 0.0247s/iter; left time: 1081.1686s
	iters: 400, epoch: 7 | loss: 0.0005715
	speed: 0.0231s/iter; left time: 1010.6208s
Epoch: 7 cost time: 12.186920881271362
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.958260 --> -0.963120).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1480465
	speed: 0.1477s/iter; left time: 6425.6673s
	iters: 200, epoch: 8 | loss: 0.7595908
	speed: 0.0273s/iter; left time: 1186.9295s
	iters: 300, epoch: 8 | loss: 0.0595640
	speed: 0.0263s/iter; left time: 1141.0952s
	iters: 400, epoch: 8 | loss: 0.1514695
	speed: 0.0286s/iter; left time: 1235.5654s
Epoch: 8 cost time: 13.024427890777588
Epoch: 8, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.963120 --> -0.976557).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3211926
	speed: 0.1376s/iter; left time: 5925.6841s
	iters: 200, epoch: 9 | loss: 0.0043802
	speed: 0.0302s/iter; left time: 1297.8875s
	iters: 300, epoch: 9 | loss: 0.0046542
	speed: 0.0292s/iter; left time: 1253.0212s
	iters: 400, epoch: 9 | loss: 0.0701055
	speed: 0.0278s/iter; left time: 1188.0245s
Epoch: 9 cost time: 13.724487781524658
Epoch: 9, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0351750
	speed: 0.1505s/iter; left time: 6406.7293s
	iters: 200, epoch: 10 | loss: 0.0071373
	speed: 0.0275s/iter; left time: 1169.9324s
	iters: 300, epoch: 10 | loss: 0.0170819
	speed: 0.0262s/iter; left time: 1110.1112s
	iters: 400, epoch: 10 | loss: 0.0001747
	speed: 0.0272s/iter; left time: 1147.9895s
Epoch: 10 cost time: 13.354841232299805
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0855341
	speed: 0.1500s/iter; left time: 6316.2483s
	iters: 200, epoch: 11 | loss: 0.0003464
	speed: 0.0286s/iter; left time: 1200.1706s
	iters: 300, epoch: 11 | loss: 0.0016145
	speed: 0.0258s/iter; left time: 1082.5508s
	iters: 400, epoch: 11 | loss: 0.0026868
	speed: 0.0285s/iter; left time: 1189.9619s
Epoch: 11 cost time: 13.465013027191162
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000038
	speed: 0.1477s/iter; left time: 6152.2216s
	iters: 200, epoch: 12 | loss: 0.0051358
	speed: 0.0304s/iter; left time: 1261.7745s
	iters: 300, epoch: 12 | loss: 0.0022370
	speed: 0.0272s/iter; left time: 1125.1636s
	iters: 400, epoch: 12 | loss: 0.0000649
	speed: 0.0266s/iter; left time: 1100.8417s
Epoch: 12 cost time: 13.564682006835938
Epoch: 12, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0045532
	speed: 0.1440s/iter; left time: 5929.2281s
	iters: 200, epoch: 13 | loss: 0.2136898
	speed: 0.0275s/iter; left time: 1129.8032s
	iters: 300, epoch: 13 | loss: 0.0002379
	speed: 0.0249s/iter; left time: 1021.5509s
	iters: 400, epoch: 13 | loss: 0.1179926
	speed: 0.0234s/iter; left time: 958.4230s
Epoch: 13 cost time: 12.607856273651123
Epoch: 13, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0001080
	speed: 0.1484s/iter; left time: 6041.2287s
	iters: 200, epoch: 14 | loss: 0.0017793
	speed: 0.0244s/iter; left time: 991.4373s
	iters: 300, epoch: 14 | loss: 0.0005757
	speed: 0.0242s/iter; left time: 980.4209s
	iters: 400, epoch: 14 | loss: 0.0000618
	speed: 0.0246s/iter; left time: 992.4811s
Epoch: 14 cost time: 12.109094858169556
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0063258
	speed: 0.1452s/iter; left time: 5842.4292s
	iters: 200, epoch: 15 | loss: 0.0000238
	speed: 0.0262s/iter; left time: 1053.4656s
	iters: 300, epoch: 15 | loss: 0.0006401
	speed: 0.0277s/iter; left time: 1108.7597s
	iters: 400, epoch: 15 | loss: 0.1546348
	speed: 0.0291s/iter; left time: 1162.5577s
Epoch: 15 cost time: 13.395582914352417
Epoch: 15, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0003516
	speed: 0.1422s/iter; left time: 5655.8513s
	iters: 200, epoch: 16 | loss: 0.0009135
	speed: 0.0264s/iter; left time: 1045.8418s
	iters: 300, epoch: 16 | loss: 0.0101384
	speed: 0.0295s/iter; left time: 1168.7457s
	iters: 400, epoch: 16 | loss: 0.0567922
	speed: 0.0261s/iter; left time: 1030.9771s
Epoch: 16 cost time: 13.201003789901733
Epoch: 16, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.3722455
	speed: 0.1442s/iter; left time: 5666.6706s
	iters: 200, epoch: 17 | loss: 0.0053786
	speed: 0.0245s/iter; left time: 960.1693s
	iters: 300, epoch: 17 | loss: 0.0715097
	speed: 0.0255s/iter; left time: 996.7276s
	iters: 400, epoch: 17 | loss: 0.0015704
	speed: 0.0264s/iter; left time: 1028.8252s
Epoch: 17 cost time: 12.710480213165283
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0015811
	speed: 0.1526s/iter; left time: 5925.9961s
	iters: 200, epoch: 18 | loss: 0.0019877
	speed: 0.0260s/iter; left time: 1005.4370s
	iters: 300, epoch: 18 | loss: 0.0116891
	speed: 0.0261s/iter; left time: 1009.6747s
	iters: 400, epoch: 18 | loss: 0.0679631
	speed: 0.0262s/iter; left time: 1008.6015s
Epoch: 18 cost time: 12.836690425872803
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9765580331618068
model parameter : 642082
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2604935
	speed: 0.0458s/iter; left time: 2143.1247s
	iters: 200, epoch: 1 | loss: 0.1388535
	speed: 0.0268s/iter; left time: 1250.3020s
	iters: 300, epoch: 1 | loss: 0.0670926
	speed: 0.0272s/iter; left time: 1267.1828s
	iters: 400, epoch: 1 | loss: 0.0105414
	speed: 0.0297s/iter; left time: 1381.4736s
Epoch: 1 cost time: 15.153278112411499
Epoch: 1, Steps: 469 | Train Loss: 0.350 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (inf --> -0.952542).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0108958
	speed: 0.1530s/iter; left time: 7089.2104s
	iters: 200, epoch: 2 | loss: 0.2486196
	speed: 0.0314s/iter; left time: 1450.5787s
	iters: 300, epoch: 2 | loss: 0.0128572
	speed: 0.0260s/iter; left time: 1199.6664s
	iters: 400, epoch: 2 | loss: 0.0799839
	speed: 0.0259s/iter; left time: 1192.9223s
Epoch: 2 cost time: 13.212303161621094
Epoch: 2, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0216411
	speed: 0.1428s/iter; left time: 6550.6919s
	iters: 200, epoch: 3 | loss: 0.0006794
	speed: 0.0274s/iter; left time: 1254.6791s
	iters: 300, epoch: 3 | loss: 0.0191522
	speed: 0.0271s/iter; left time: 1238.6214s
	iters: 400, epoch: 3 | loss: 0.2145918
	speed: 0.0236s/iter; left time: 1076.1538s
Epoch: 3 cost time: 12.87877368927002
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.952542 --> -0.964836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008397
	speed: 0.1459s/iter; left time: 6620.7804s
	iters: 200, epoch: 4 | loss: 0.0097633
	speed: 0.0248s/iter; left time: 1124.7449s
	iters: 300, epoch: 4 | loss: 0.0451593
	speed: 0.0248s/iter; left time: 1119.0224s
	iters: 400, epoch: 4 | loss: 0.0020726
	speed: 0.0260s/iter; left time: 1174.3245s
Epoch: 4 cost time: 11.960042238235474
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.242 Vali Acc: 0.955 Test Loss: 0.242 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0001092
	speed: 0.1377s/iter; left time: 6188.2150s
	iters: 200, epoch: 5 | loss: 0.0352466
	speed: 0.0270s/iter; left time: 1211.2372s
	iters: 300, epoch: 5 | loss: 0.0003310
	speed: 0.0268s/iter; left time: 1200.5012s
	iters: 400, epoch: 5 | loss: 0.2027201
	speed: 0.0272s/iter; left time: 1212.1603s
Epoch: 5 cost time: 12.784778833389282
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.962 Test Loss: 0.221 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0283854
	speed: 0.1405s/iter; left time: 6247.3710s
	iters: 200, epoch: 6 | loss: 0.0028351
	speed: 0.0289s/iter; left time: 1283.2870s
	iters: 300, epoch: 6 | loss: 0.1376911
	speed: 0.0278s/iter; left time: 1228.4583s
	iters: 400, epoch: 6 | loss: 0.0016064
	speed: 0.0271s/iter; left time: 1195.7854s
Epoch: 6 cost time: 13.398409366607666
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.264 Vali Acc: 0.953 Test Loss: 0.264 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0976723
	speed: 0.1395s/iter; left time: 6136.1096s
	iters: 200, epoch: 7 | loss: 0.0230243
	speed: 0.0273s/iter; left time: 1196.6530s
	iters: 300, epoch: 7 | loss: 0.0699695
	speed: 0.0237s/iter; left time: 1038.4278s
	iters: 400, epoch: 7 | loss: 0.0042879
	speed: 0.0274s/iter; left time: 1196.8476s
Epoch: 7 cost time: 12.845586776733398
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.3808305
	speed: 0.1445s/iter; left time: 6290.0051s
	iters: 200, epoch: 8 | loss: 0.0222367
	speed: 0.0253s/iter; left time: 1096.4233s
	iters: 300, epoch: 8 | loss: 0.0051589
	speed: 0.0257s/iter; left time: 1111.2194s
	iters: 400, epoch: 8 | loss: 0.0052266
	speed: 0.0300s/iter; left time: 1296.4004s
Epoch: 8 cost time: 12.970595598220825
Epoch: 8, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.964836 --> -0.967694).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0127958
	speed: 0.1532s/iter; left time: 6596.0963s
	iters: 200, epoch: 9 | loss: 0.0004318
	speed: 0.0311s/iter; left time: 1334.1363s
	iters: 300, epoch: 9 | loss: 0.0274658
	speed: 0.0257s/iter; left time: 1100.8750s
	iters: 400, epoch: 9 | loss: 0.0085061
	speed: 0.0270s/iter; left time: 1156.1342s
Epoch: 9 cost time: 13.498782873153687
Epoch: 9, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.967694 --> -0.969695).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0036771
	speed: 0.1484s/iter; left time: 6320.9663s
	iters: 200, epoch: 10 | loss: 0.0124210
	speed: 0.0276s/iter; left time: 1171.5324s
	iters: 300, epoch: 10 | loss: 0.0123733
	speed: 0.0280s/iter; left time: 1184.7470s
	iters: 400, epoch: 10 | loss: 0.0001820
	speed: 0.0290s/iter; left time: 1226.2061s
Epoch: 10 cost time: 13.711353778839111
Epoch: 10, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.969695 --> -0.974556).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0010129
	speed: 0.1474s/iter; left time: 6208.7252s
	iters: 200, epoch: 11 | loss: 0.0008313
	speed: 0.0283s/iter; left time: 1189.9401s
	iters: 300, epoch: 11 | loss: 0.0000160
	speed: 0.0305s/iter; left time: 1278.8884s
	iters: 400, epoch: 11 | loss: 0.0675217
	speed: 0.0280s/iter; left time: 1169.5968s
Epoch: 11 cost time: 13.695930480957031
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0027293
	speed: 0.1432s/iter; left time: 5961.2253s
	iters: 200, epoch: 12 | loss: 0.2647797
	speed: 0.0256s/iter; left time: 1063.9425s
	iters: 300, epoch: 12 | loss: 0.0435449
	speed: 0.0242s/iter; left time: 1004.6389s
	iters: 400, epoch: 12 | loss: 0.0000904
	speed: 0.0250s/iter; left time: 1034.0962s
Epoch: 12 cost time: 12.034432888031006
Epoch: 12, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.204 Vali Acc: 0.966 Test Loss: 0.204 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.1448s/iter; left time: 5961.3726s
	iters: 200, epoch: 13 | loss: 0.0018488
	speed: 0.0230s/iter; left time: 946.4504s
	iters: 300, epoch: 13 | loss: 0.0000065
	speed: 0.0257s/iter; left time: 1054.3119s
	iters: 400, epoch: 13 | loss: 0.0015353
	speed: 0.0254s/iter; left time: 1039.2021s
Epoch: 13 cost time: 12.319514751434326
Epoch: 13, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.227 Vali Acc: 0.969 Test Loss: 0.227 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0146031
	speed: 0.1293s/iter; left time: 5261.0994s
	iters: 200, epoch: 14 | loss: 0.2080152
	speed: 0.0255s/iter; left time: 1035.4445s
	iters: 300, epoch: 14 | loss: 0.0015318
	speed: 0.0252s/iter; left time: 1020.9834s
	iters: 400, epoch: 14 | loss: 0.0023838
	speed: 0.0291s/iter; left time: 1175.4569s
Epoch: 14 cost time: 12.83099102973938
Epoch: 14, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.255 Vali Acc: 0.963 Test Loss: 0.255 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0045346
	speed: 0.1421s/iter; left time: 5715.4040s
	iters: 200, epoch: 15 | loss: 0.0000036
	speed: 0.0286s/iter; left time: 1148.3129s
	iters: 300, epoch: 15 | loss: 0.0095898
	speed: 0.0283s/iter; left time: 1131.3432s
	iters: 400, epoch: 15 | loss: 0.5056993
	speed: 0.0260s/iter; left time: 1038.4863s
Epoch: 15 cost time: 13.133213520050049
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0036830
	speed: 0.1488s/iter; left time: 5916.6322s
	iters: 200, epoch: 16 | loss: 0.0097492
	speed: 0.0280s/iter; left time: 1109.7293s
	iters: 300, epoch: 16 | loss: 0.0039926
	speed: 0.0252s/iter; left time: 995.2178s
	iters: 400, epoch: 16 | loss: 0.0036622
	speed: 0.0256s/iter; left time: 1009.9921s
Epoch: 16 cost time: 12.89873480796814
Epoch: 16, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2793919
	speed: 0.1443s/iter; left time: 5670.2383s
	iters: 200, epoch: 17 | loss: 0.0002693
	speed: 0.0281s/iter; left time: 1100.4317s
	iters: 300, epoch: 17 | loss: 0.0000779
	speed: 0.0280s/iter; left time: 1095.9407s
	iters: 400, epoch: 17 | loss: 0.5277980
	speed: 0.0306s/iter; left time: 1193.5871s
Epoch: 17 cost time: 14.021915197372437
Epoch: 17, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.356 Vali Acc: 0.945 Test Loss: 0.356 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0013946
	speed: 0.1497s/iter; left time: 5811.3308s
	iters: 200, epoch: 18 | loss: 0.0004709
	speed: 0.0282s/iter; left time: 1091.9442s
	iters: 300, epoch: 18 | loss: 0.0033235
	speed: 0.0324s/iter; left time: 1250.5343s
	iters: 400, epoch: 18 | loss: 0.1423399
	speed: 0.0328s/iter; left time: 1262.8462s
Epoch: 18 cost time: 14.258781433105469
Epoch: 18, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.1649755
	speed: 0.1493s/iter; left time: 5726.0620s
	iters: 200, epoch: 19 | loss: 0.0043447
	speed: 0.0303s/iter; left time: 1161.0150s
	iters: 300, epoch: 19 | loss: 0.0000487
	speed: 0.0276s/iter; left time: 1052.3667s
	iters: 400, epoch: 19 | loss: 0.0000035
	speed: 0.0269s/iter; left time: 1022.0732s
Epoch: 19 cost time: 13.756697416305542
Epoch: 19, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0000102
	speed: 0.1523s/iter; left time: 5770.4315s
	iters: 200, epoch: 20 | loss: 0.0000231
	speed: 0.0281s/iter; left time: 1061.4770s
	iters: 300, epoch: 20 | loss: 0.0000539
	speed: 0.0289s/iter; left time: 1087.5792s
	iters: 400, epoch: 20 | loss: 0.0000347
	speed: 0.0276s/iter; left time: 1037.2598s
Epoch: 20 cost time: 13.662487030029297
Epoch: 20, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9745568896512292
model parameter : 642082
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.2613996
	speed: 0.0429s/iter; left time: 2006.2677s
	iters: 200, epoch: 1 | loss: 0.1492315
	speed: 0.0253s/iter; left time: 1180.3927s
	iters: 300, epoch: 1 | loss: 0.0243984
	speed: 0.0277s/iter; left time: 1291.4874s
	iters: 400, epoch: 1 | loss: 0.0101688
	speed: 0.0268s/iter; left time: 1247.0357s
Epoch: 1 cost time: 14.080615043640137
Epoch: 1, Steps: 469 | Train Loss: 0.350 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
Validation loss decreased (inf --> -0.962549).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0013679
	speed: 0.1459s/iter; left time: 6758.6366s
	iters: 200, epoch: 2 | loss: 0.1765964
	speed: 0.0270s/iter; left time: 1249.7356s
	iters: 300, epoch: 2 | loss: 0.0068777
	speed: 0.0287s/iter; left time: 1324.2797s
	iters: 400, epoch: 2 | loss: 0.0020017
	speed: 0.0259s/iter; left time: 1190.4694s
Epoch: 2 cost time: 13.058014869689941
Epoch: 2, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1055409
	speed: 0.1452s/iter; left time: 6657.7355s
	iters: 200, epoch: 3 | loss: 0.0352648
	speed: 0.0259s/iter; left time: 1186.7777s
	iters: 300, epoch: 3 | loss: 0.0006387
	speed: 0.0281s/iter; left time: 1282.1301s
	iters: 400, epoch: 3 | loss: 0.0177390
	speed: 0.0272s/iter; left time: 1237.0947s
Epoch: 3 cost time: 13.260358095169067
Epoch: 3, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.158 Vali Acc: 0.966 Test Loss: 0.158 Test Acc: 0.966
Validation loss decreased (-0.962549 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1639799
	speed: 0.1470s/iter; left time: 6673.9807s
	iters: 200, epoch: 4 | loss: 0.0026755
	speed: 0.0253s/iter; left time: 1145.5184s
	iters: 300, epoch: 4 | loss: 0.2694162
	speed: 0.0267s/iter; left time: 1208.1880s
	iters: 400, epoch: 4 | loss: 0.0144866
	speed: 0.0269s/iter; left time: 1214.9501s
Epoch: 4 cost time: 12.9486403465271
Epoch: 4, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.229 Vali Acc: 0.966 Test Loss: 0.229 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000680
	speed: 0.1473s/iter; left time: 6617.2028s
	iters: 200, epoch: 5 | loss: 0.0387714
	speed: 0.0298s/iter; left time: 1334.2402s
	iters: 300, epoch: 5 | loss: 0.2237004
	speed: 0.0298s/iter; left time: 1331.0960s
	iters: 400, epoch: 5 | loss: 0.0085838
	speed: 0.0283s/iter; left time: 1265.0735s
Epoch: 5 cost time: 14.002537250518799
Epoch: 5, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.257 Vali Acc: 0.965 Test Loss: 0.257 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.3219699
	speed: 0.1409s/iter; left time: 6264.8791s
	iters: 200, epoch: 6 | loss: 0.0035447
	speed: 0.0257s/iter; left time: 1138.6701s
	iters: 300, epoch: 6 | loss: 0.0524868
	speed: 0.0267s/iter; left time: 1181.8659s
	iters: 400, epoch: 6 | loss: 0.0000002
	speed: 0.0261s/iter; left time: 1151.5487s
Epoch: 6 cost time: 13.053333520889282
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0007534
	speed: 0.1536s/iter; left time: 6756.0800s
	iters: 200, epoch: 7 | loss: 0.0012783
	speed: 0.0278s/iter; left time: 1220.1985s
	iters: 300, epoch: 7 | loss: 0.2787053
	speed: 0.0285s/iter; left time: 1249.7529s
	iters: 400, epoch: 7 | loss: 0.0002921
	speed: 0.0284s/iter; left time: 1239.1371s
Epoch: 7 cost time: 13.746521472930908
Epoch: 7, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
Validation loss decreased (-0.966265 --> -0.971124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1731538
	speed: 0.1480s/iter; left time: 6438.6471s
	iters: 200, epoch: 8 | loss: 0.1215227
	speed: 0.0299s/iter; left time: 1300.1339s
	iters: 300, epoch: 8 | loss: 0.1025384
	speed: 0.0316s/iter; left time: 1369.8621s
	iters: 400, epoch: 8 | loss: 0.0810279
	speed: 0.0305s/iter; left time: 1317.2054s
Epoch: 8 cost time: 14.437181234359741
Epoch: 8, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.256 Vali Acc: 0.966 Test Loss: 0.256 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000001
	speed: 0.1463s/iter; left time: 6299.1988s
	iters: 200, epoch: 9 | loss: 0.2866022
	speed: 0.0265s/iter; left time: 1136.4224s
	iters: 300, epoch: 9 | loss: 0.0000257
	speed: 0.0264s/iter; left time: 1132.2145s
	iters: 400, epoch: 9 | loss: 0.0001093
	speed: 0.0263s/iter; left time: 1125.5412s
Epoch: 9 cost time: 13.155596494674683
Epoch: 9, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
Validation loss decreased (-0.971124 --> -0.974269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0000034
	speed: 0.1517s/iter; left time: 6459.7806s
	iters: 200, epoch: 10 | loss: 0.1400110
	speed: 0.0268s/iter; left time: 1137.8484s
	iters: 300, epoch: 10 | loss: 0.0000000
	speed: 0.0257s/iter; left time: 1089.4125s
	iters: 400, epoch: 10 | loss: 0.0000219
	speed: 0.0270s/iter; left time: 1139.7552s
Epoch: 10 cost time: 12.861438989639282
Epoch: 10, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.270 Vali Acc: 0.964 Test Loss: 0.270 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0017007
	speed: 0.1467s/iter; left time: 6176.6897s
	iters: 200, epoch: 11 | loss: 0.0010518
	speed: 0.0268s/iter; left time: 1127.7424s
	iters: 300, epoch: 11 | loss: 0.0001050
	speed: 0.0297s/iter; left time: 1246.7015s
	iters: 400, epoch: 11 | loss: 0.0092204
	speed: 0.0298s/iter; left time: 1244.4652s
Epoch: 11 cost time: 13.560719013214111
Epoch: 11, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.970 Test Loss: 0.238 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0000264
	speed: 0.1408s/iter; left time: 5862.0952s
	iters: 200, epoch: 12 | loss: 0.0002656
	speed: 0.0281s/iter; left time: 1167.9618s
	iters: 300, epoch: 12 | loss: 0.0000491
	speed: 0.0282s/iter; left time: 1168.9707s
	iters: 400, epoch: 12 | loss: 0.0012608
	speed: 0.0274s/iter; left time: 1133.2229s
Epoch: 12 cost time: 13.373845100402832
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
Validation loss decreased (-0.974269 --> -0.977414).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000326
	speed: 0.1585s/iter; left time: 6526.4735s
	iters: 200, epoch: 13 | loss: 0.0000306
	speed: 0.0311s/iter; left time: 1275.5353s
	iters: 300, epoch: 13 | loss: 0.0255363
	speed: 0.0216s/iter; left time: 885.6688s
	iters: 400, epoch: 13 | loss: 0.0353280
	speed: 0.0217s/iter; left time: 885.0144s
Epoch: 13 cost time: 12.663448333740234
Epoch: 13, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.974 Test Loss: 0.225 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000066
	speed: 0.1096s/iter; left time: 4459.6699s
	iters: 200, epoch: 14 | loss: 0.0000093
	speed: 0.0218s/iter; left time: 886.6931s
	iters: 300, epoch: 14 | loss: 0.0055062
	speed: 0.0265s/iter; left time: 1073.6848s
	iters: 400, epoch: 14 | loss: 0.0000243
	speed: 0.0307s/iter; left time: 1242.3548s
Epoch: 14 cost time: 12.793168544769287
Epoch: 14, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.298 Vali Acc: 0.959 Test Loss: 0.298 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1597793
	speed: 0.1472s/iter; left time: 5920.7389s
	iters: 200, epoch: 15 | loss: 0.0025055
	speed: 0.0311s/iter; left time: 1249.9790s
	iters: 300, epoch: 15 | loss: 0.0000007
	speed: 0.0289s/iter; left time: 1159.0035s
	iters: 400, epoch: 15 | loss: 0.0847635
	speed: 0.0287s/iter; left time: 1145.3040s
Epoch: 15 cost time: 14.02457046508789
Epoch: 15, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.293 Vali Acc: 0.957 Test Loss: 0.293 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000902
	speed: 0.1441s/iter; left time: 5728.6099s
	iters: 200, epoch: 16 | loss: 0.0307323
	speed: 0.0248s/iter; left time: 983.8373s
	iters: 300, epoch: 16 | loss: 0.0224150
	speed: 0.0239s/iter; left time: 944.0619s
	iters: 400, epoch: 16 | loss: 0.0000000
	speed: 0.0234s/iter; left time: 924.5355s
Epoch: 16 cost time: 11.805160999298096
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.1714008
	speed: 0.1462s/iter; left time: 5745.1469s
	iters: 200, epoch: 17 | loss: 0.0261556
	speed: 0.0280s/iter; left time: 1098.0964s
	iters: 300, epoch: 17 | loss: 0.0002081
	speed: 0.0260s/iter; left time: 1016.3505s
	iters: 400, epoch: 17 | loss: 0.0000856
	speed: 0.0263s/iter; left time: 1025.6751s
Epoch: 17 cost time: 13.038804292678833
Epoch: 17, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.250 Vali Acc: 0.977 Test Loss: 0.250 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0000221
	speed: 0.1428s/iter; left time: 5544.7361s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0266s/iter; left time: 1028.3552s
	iters: 300, epoch: 18 | loss: 0.0003418
	speed: 0.0286s/iter; left time: 1106.6624s
	iters: 400, epoch: 18 | loss: 0.0004698
	speed: 0.0289s/iter; left time: 1112.3387s
Epoch: 18 cost time: 13.219953775405884
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.294 Vali Acc: 0.971 Test Loss: 0.294 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.2084241
	speed: 0.1462s/iter; left time: 5607.1659s
	iters: 200, epoch: 19 | loss: 0.0000797
	speed: 0.0283s/iter; left time: 1081.4123s
	iters: 300, epoch: 19 | loss: 0.0000042
	speed: 0.0281s/iter; left time: 1073.9193s
	iters: 400, epoch: 19 | loss: 0.0002195
	speed: 0.0248s/iter; left time: 944.2807s
Epoch: 19 cost time: 12.785351753234863
Epoch: 19, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.269 Vali Acc: 0.969 Test Loss: 0.269 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.1455s/iter; left time: 5512.2945s
	iters: 200, epoch: 20 | loss: 0.0010183
	speed: 0.0280s/iter; left time: 1057.2043s
	iters: 300, epoch: 20 | loss: 0.0000176
	speed: 0.0269s/iter; left time: 1012.9202s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0261s/iter; left time: 979.2484s
Epoch: 20 cost time: 13.019242286682129
Epoch: 20, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.261 Vali Acc: 0.974 Test Loss: 0.261 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.2678453
	speed: 0.1437s/iter; left time: 5378.9691s
	iters: 200, epoch: 21 | loss: 0.0000960
	speed: 0.0279s/iter; left time: 1042.2372s
	iters: 300, epoch: 21 | loss: 0.0000802
	speed: 0.0296s/iter; left time: 1102.8010s
	iters: 400, epoch: 21 | loss: 0.0002644
	speed: 0.0299s/iter; left time: 1109.3316s
Epoch: 21 cost time: 13.732129335403442
Epoch: 21, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.284 Vali Acc: 0.976 Test Loss: 0.284 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0002161
	speed: 0.1463s/iter; left time: 5404.2557s
	iters: 200, epoch: 22 | loss: 0.0000094
	speed: 0.0284s/iter; left time: 1047.0723s
	iters: 300, epoch: 22 | loss: 0.0000493
	speed: 0.0262s/iter; left time: 964.0380s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0263s/iter; left time: 962.8761s
Epoch: 22 cost time: 13.159503936767578
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 642082
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8071730
	speed: 0.0479s/iter; left time: 2243.7328s
	iters: 200, epoch: 1 | loss: 0.2039104
	speed: 0.0283s/iter; left time: 1320.3599s
	iters: 300, epoch: 1 | loss: 0.1644900
	speed: 0.0295s/iter; left time: 1372.5702s
	iters: 400, epoch: 1 | loss: 0.0742427
	speed: 0.0290s/iter; left time: 1348.4275s
Epoch: 1 cost time: 15.484960556030273
Epoch: 1, Steps: 469 | Train Loss: 0.475 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (inf --> -0.933102).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1264064
	speed: 0.1463s/iter; left time: 6776.5636s
	iters: 200, epoch: 2 | loss: 0.0479898
	speed: 0.0281s/iter; left time: 1296.9685s
	iters: 300, epoch: 2 | loss: 0.1031282
	speed: 0.0271s/iter; left time: 1252.0747s
	iters: 400, epoch: 2 | loss: 0.1711763
	speed: 0.0264s/iter; left time: 1213.0515s
Epoch: 2 cost time: 13.397080183029175
Epoch: 2, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.933102 --> -0.943680).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0670091
	speed: 0.1475s/iter; left time: 6766.7526s
	iters: 200, epoch: 3 | loss: 0.0088875
	speed: 0.0258s/iter; left time: 1180.6923s
	iters: 300, epoch: 3 | loss: 0.0952753
	speed: 0.0254s/iter; left time: 1161.5337s
	iters: 400, epoch: 3 | loss: 0.0069760
	speed: 0.0255s/iter; left time: 1161.0293s
Epoch: 3 cost time: 12.72015905380249
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.943680 --> -0.969696).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0149552
	speed: 0.1452s/iter; left time: 6589.6697s
	iters: 200, epoch: 4 | loss: 0.0609420
	speed: 0.0278s/iter; left time: 1259.0601s
	iters: 300, epoch: 4 | loss: 0.0106764
	speed: 0.0285s/iter; left time: 1285.9893s
	iters: 400, epoch: 4 | loss: 0.0153525
	speed: 0.0259s/iter; left time: 1166.9636s
Epoch: 4 cost time: 13.011817216873169
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0519232
	speed: 0.1374s/iter; left time: 6172.4660s
	iters: 200, epoch: 5 | loss: 0.1764202
	speed: 0.0300s/iter; left time: 1343.5365s
	iters: 300, epoch: 5 | loss: 0.0183551
	speed: 0.0280s/iter; left time: 1252.6785s
	iters: 400, epoch: 5 | loss: 0.0645913
	speed: 0.0233s/iter; left time: 1037.5959s
Epoch: 5 cost time: 13.016383171081543
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969696 --> -0.973126).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0291368
	speed: 0.1424s/iter; left time: 6331.8100s
	iters: 200, epoch: 6 | loss: 0.1357758
	speed: 0.0262s/iter; left time: 1162.5118s
	iters: 300, epoch: 6 | loss: 0.0140372
	speed: 0.0250s/iter; left time: 1108.5840s
	iters: 400, epoch: 6 | loss: 0.0015182
	speed: 0.0256s/iter; left time: 1131.6275s
Epoch: 6 cost time: 12.509280443191528
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0473040
	speed: 0.1324s/iter; left time: 5821.7345s
	iters: 200, epoch: 7 | loss: 0.0029919
	speed: 0.0238s/iter; left time: 1043.0579s
	iters: 300, epoch: 7 | loss: 0.0378622
	speed: 0.0262s/iter; left time: 1148.6938s
	iters: 400, epoch: 7 | loss: 0.0001396
	speed: 0.0286s/iter; left time: 1249.1663s
Epoch: 7 cost time: 12.59424877166748
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0008518
	speed: 0.1445s/iter; left time: 6289.6528s
	iters: 200, epoch: 8 | loss: 0.0548209
	speed: 0.0274s/iter; left time: 1188.8703s
	iters: 300, epoch: 8 | loss: 0.0031104
	speed: 0.0302s/iter; left time: 1308.4823s
	iters: 400, epoch: 8 | loss: 0.0030478
	speed: 0.0258s/iter; left time: 1113.3062s
Epoch: 8 cost time: 13.21023154258728
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0244913
	speed: 0.1469s/iter; left time: 6322.1061s
	iters: 200, epoch: 9 | loss: 0.0019097
	speed: 0.0279s/iter; left time: 1198.6115s
	iters: 300, epoch: 9 | loss: 0.0204271
	speed: 0.0279s/iter; left time: 1196.7210s
	iters: 400, epoch: 9 | loss: 0.0274992
	speed: 0.0275s/iter; left time: 1177.2246s
Epoch: 9 cost time: 13.452510833740234
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0591543
	speed: 0.1474s/iter; left time: 6275.5770s
	iters: 200, epoch: 10 | loss: 0.0801294
	speed: 0.0246s/iter; left time: 1046.4341s
	iters: 300, epoch: 10 | loss: 0.0092308
	speed: 0.0266s/iter; left time: 1127.0109s
	iters: 400, epoch: 10 | loss: 0.0222685
	speed: 0.0284s/iter; left time: 1200.6810s
Epoch: 10 cost time: 12.890637159347534
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.973126 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0049288
	speed: 0.1374s/iter; left time: 5785.7762s
	iters: 200, epoch: 11 | loss: 0.0029911
	speed: 0.0270s/iter; left time: 1135.4372s
	iters: 300, epoch: 11 | loss: 0.0001864
	speed: 0.0274s/iter; left time: 1147.3983s
	iters: 400, epoch: 11 | loss: 0.0288167
	speed: 0.0287s/iter; left time: 1198.6156s
Epoch: 11 cost time: 13.171145915985107
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0373733
	speed: 0.1458s/iter; left time: 6072.5010s
	iters: 200, epoch: 12 | loss: 0.2020311
	speed: 0.0298s/iter; left time: 1236.4339s
	iters: 300, epoch: 12 | loss: 0.0007838
	speed: 0.0278s/iter; left time: 1153.8716s
	iters: 400, epoch: 12 | loss: 0.0000354
	speed: 0.0265s/iter; left time: 1094.4311s
Epoch: 12 cost time: 13.699055910110474
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1338224
	speed: 0.1418s/iter; left time: 5839.8468s
	iters: 200, epoch: 13 | loss: 0.0004113
	speed: 0.0264s/iter; left time: 1082.7577s
	iters: 300, epoch: 13 | loss: 0.0019296
	speed: 0.0271s/iter; left time: 1110.1006s
	iters: 400, epoch: 13 | loss: 0.0018017
	speed: 0.0265s/iter; left time: 1081.4270s
Epoch: 13 cost time: 12.97263479232788
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002365
	speed: 0.1477s/iter; left time: 6013.7005s
	iters: 200, epoch: 14 | loss: 0.0015906
	speed: 0.0254s/iter; left time: 1031.0474s
	iters: 300, epoch: 14 | loss: 0.0116475
	speed: 0.0250s/iter; left time: 1012.8706s
	iters: 400, epoch: 14 | loss: 0.0209078
	speed: 0.0290s/iter; left time: 1172.9372s
Epoch: 14 cost time: 12.962181329727173
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0001393
	speed: 0.1468s/iter; left time: 5908.2789s
	iters: 200, epoch: 15 | loss: 0.0018486
	speed: 0.0285s/iter; left time: 1144.7994s
	iters: 300, epoch: 15 | loss: 0.0099329
	speed: 0.0287s/iter; left time: 1148.4371s
	iters: 400, epoch: 15 | loss: 0.2153351
	speed: 0.0276s/iter; left time: 1102.2082s
Epoch: 15 cost time: 13.542129278182983
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000993
	speed: 0.1451s/iter; left time: 5769.0070s
	iters: 200, epoch: 16 | loss: 0.0003050
	speed: 0.0285s/iter; left time: 1130.2996s
	iters: 300, epoch: 16 | loss: 0.0000306
	speed: 0.0270s/iter; left time: 1069.9687s
	iters: 400, epoch: 16 | loss: 0.0284640
	speed: 0.0267s/iter; left time: 1053.1616s
Epoch: 16 cost time: 13.371216058731079
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.2727708
	speed: 0.1494s/iter; left time: 5870.0329s
	iters: 200, epoch: 17 | loss: 0.0008672
	speed: 0.0268s/iter; left time: 1049.4394s
	iters: 300, epoch: 17 | loss: 0.0002787
	speed: 0.0283s/iter; left time: 1105.3918s
	iters: 400, epoch: 17 | loss: 0.0115812
	speed: 0.0281s/iter; left time: 1094.4027s
Epoch: 17 cost time: 13.760742902755737
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981703).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000172
	speed: 0.1533s/iter; left time: 5953.1418s
	iters: 200, epoch: 18 | loss: 0.0184565
	speed: 0.0288s/iter; left time: 1116.8621s
	iters: 300, epoch: 18 | loss: 0.0066748
	speed: 0.0311s/iter; left time: 1200.2593s
	iters: 400, epoch: 18 | loss: 0.0005209
	speed: 0.0290s/iter; left time: 1117.1474s
Epoch: 18 cost time: 13.909526109695435
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.982560).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000112
	speed: 0.1507s/iter; left time: 5781.8635s
	iters: 200, epoch: 19 | loss: 0.0065393
	speed: 0.0319s/iter; left time: 1221.2874s
	iters: 300, epoch: 19 | loss: 0.1247146
	speed: 0.0287s/iter; left time: 1095.7634s
	iters: 400, epoch: 19 | loss: 0.0009926
	speed: 0.0258s/iter; left time: 980.9053s
Epoch: 19 cost time: 14.353654623031616
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002867
	speed: 0.1480s/iter; left time: 5608.2456s
	iters: 200, epoch: 20 | loss: 0.0332010
	speed: 0.0263s/iter; left time: 993.8670s
	iters: 300, epoch: 20 | loss: 0.0131349
	speed: 0.0262s/iter; left time: 986.9487s
	iters: 400, epoch: 20 | loss: 0.0002697
	speed: 0.0273s/iter; left time: 1026.9478s
Epoch: 20 cost time: 13.163391590118408
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0010022
	speed: 0.1493s/iter; left time: 5587.6604s
	iters: 200, epoch: 21 | loss: 0.0014748
	speed: 0.0288s/iter; left time: 1073.4554s
	iters: 300, epoch: 21 | loss: 0.0000662
	speed: 0.0281s/iter; left time: 1045.7082s
	iters: 400, epoch: 21 | loss: 0.0035381
	speed: 0.0264s/iter; left time: 978.9955s
Epoch: 21 cost time: 13.435484886169434
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0004107
	speed: 0.1451s/iter; left time: 5360.3899s
	iters: 200, epoch: 22 | loss: 0.0240467
	speed: 0.0292s/iter; left time: 1076.5273s
	iters: 300, epoch: 22 | loss: 0.0010536
	speed: 0.0254s/iter; left time: 934.6481s
	iters: 400, epoch: 22 | loss: 0.0045360
	speed: 0.0255s/iter; left time: 934.6097s
Epoch: 22 cost time: 13.06606912612915
Epoch: 22, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0370302
	speed: 0.1461s/iter; left time: 5328.5664s
	iters: 200, epoch: 23 | loss: 0.0065343
	speed: 0.0260s/iter; left time: 946.2634s
	iters: 300, epoch: 23 | loss: 0.0005123
	speed: 0.0262s/iter; left time: 948.9681s
	iters: 400, epoch: 23 | loss: 0.0013490
	speed: 0.0271s/iter; left time: 981.3460s
Epoch: 23 cost time: 12.557881116867065
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.982560 --> -0.983418).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0035368
	speed: 0.1501s/iter; left time: 5406.9546s
	iters: 200, epoch: 24 | loss: 0.0000299
	speed: 0.0266s/iter; left time: 953.8387s
	iters: 300, epoch: 24 | loss: 0.2995084
	speed: 0.0266s/iter; left time: 954.3458s
	iters: 400, epoch: 24 | loss: 0.0012080
	speed: 0.0257s/iter; left time: 917.2454s
Epoch: 24 cost time: 12.748019695281982
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000254
	speed: 0.1307s/iter; left time: 4646.9919s
	iters: 200, epoch: 25 | loss: 0.0004119
	speed: 0.0261s/iter; left time: 926.0670s
	iters: 300, epoch: 25 | loss: 0.0001677
	speed: 0.0305s/iter; left time: 1077.4877s
	iters: 400, epoch: 25 | loss: 0.0023621
	speed: 0.0304s/iter; left time: 1069.9172s
Epoch: 25 cost time: 13.636601686477661
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000645
	speed: 0.1443s/iter; left time: 5061.1005s
	iters: 200, epoch: 26 | loss: 0.7305664
	speed: 0.0296s/iter; left time: 1035.1569s
	iters: 300, epoch: 26 | loss: 0.0001003
	speed: 0.0286s/iter; left time: 998.7782s
	iters: 400, epoch: 26 | loss: 0.0216487
	speed: 0.0277s/iter; left time: 963.5964s
Epoch: 26 cost time: 13.840483665466309
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0003368
	speed: 0.1481s/iter; left time: 5126.9777s
	iters: 200, epoch: 27 | loss: 0.0017561
	speed: 0.0274s/iter; left time: 946.3640s
	iters: 300, epoch: 27 | loss: 0.0001026
	speed: 0.0271s/iter; left time: 933.1022s
	iters: 400, epoch: 27 | loss: 0.0008548
	speed: 0.0274s/iter; left time: 938.3682s
Epoch: 27 cost time: 13.269802331924438
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0049927
	speed: 0.1473s/iter; left time: 5028.5580s
	iters: 200, epoch: 28 | loss: 0.0000641
	speed: 0.0297s/iter; left time: 1011.4026s
	iters: 300, epoch: 28 | loss: 0.0062572
	speed: 0.0314s/iter; left time: 1067.0750s
	iters: 400, epoch: 28 | loss: 0.0019080
	speed: 0.0283s/iter; left time: 956.1792s
Epoch: 28 cost time: 14.05750060081482
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0004237
	speed: 0.1400s/iter; left time: 4715.2506s
	iters: 200, epoch: 29 | loss: 0.0001250
	speed: 0.0281s/iter; left time: 943.2222s
	iters: 300, epoch: 29 | loss: 0.0230355
	speed: 0.0268s/iter; left time: 897.8690s
	iters: 400, epoch: 29 | loss: 0.0015130
	speed: 0.0267s/iter; left time: 890.0166s
Epoch: 29 cost time: 13.21277117729187
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000770
	speed: 0.1451s/iter; left time: 4817.1056s
	iters: 200, epoch: 30 | loss: 0.0464802
	speed: 0.0254s/iter; left time: 841.2122s
	iters: 300, epoch: 30 | loss: 0.0013829
	speed: 0.0269s/iter; left time: 887.8346s
	iters: 400, epoch: 30 | loss: 0.3482177
	speed: 0.0263s/iter; left time: 865.2831s
Epoch: 30 cost time: 12.911792993545532
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0049636
	speed: 0.1474s/iter; left time: 4825.9068s
	iters: 200, epoch: 31 | loss: 0.0006145
	speed: 0.0274s/iter; left time: 892.8799s
	iters: 300, epoch: 31 | loss: 0.0867898
	speed: 0.0281s/iter; left time: 913.0654s
	iters: 400, epoch: 31 | loss: 0.0073387
	speed: 0.0269s/iter; left time: 872.3635s
Epoch: 31 cost time: 13.07884693145752
Epoch: 31, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.981 Test Loss: 0.152 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0007752
	speed: 0.1404s/iter; left time: 4528.3237s
	iters: 200, epoch: 32 | loss: 0.0015144
	speed: 0.0281s/iter; left time: 902.1798s
	iters: 300, epoch: 32 | loss: 0.1954411
	speed: 0.0277s/iter; left time: 888.2999s
	iters: 400, epoch: 32 | loss: 0.0000034
	speed: 0.0254s/iter; left time: 812.7236s
Epoch: 32 cost time: 13.161517858505249
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0018442
	speed: 0.1474s/iter; left time: 4687.4655s
	iters: 200, epoch: 33 | loss: 0.0079964
	speed: 0.0246s/iter; left time: 778.9554s
	iters: 300, epoch: 33 | loss: 0.0197912
	speed: 0.0248s/iter; left time: 783.0370s
	iters: 400, epoch: 33 | loss: 0.0000307
	speed: 0.0230s/iter; left time: 724.4233s
Epoch: 33 cost time: 12.143126726150513
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 1205794
model size : 9.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8914415
	speed: 0.0451s/iter; left time: 2112.8413s
	iters: 200, epoch: 1 | loss: 0.1824933
	speed: 0.0263s/iter; left time: 1228.7295s
	iters: 300, epoch: 1 | loss: 0.1227193
	speed: 0.0279s/iter; left time: 1299.8093s
	iters: 400, epoch: 1 | loss: 0.0826822
	speed: 0.0300s/iter; left time: 1397.2794s
Epoch: 1 cost time: 15.056573867797852
Epoch: 1, Steps: 469 | Train Loss: 0.480 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (inf --> -0.936533).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1163287
	speed: 0.1476s/iter; left time: 6836.8920s
	iters: 200, epoch: 2 | loss: 0.0577703
	speed: 0.0285s/iter; left time: 1317.0918s
	iters: 300, epoch: 2 | loss: 0.0837437
	speed: 0.0283s/iter; left time: 1303.9326s
	iters: 400, epoch: 2 | loss: 0.2077242
	speed: 0.0255s/iter; left time: 1175.1251s
Epoch: 2 cost time: 13.271116733551025
Epoch: 2, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
Validation loss decreased (-0.936533 --> -0.946825).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0623816
	speed: 0.1544s/iter; left time: 7082.6504s
	iters: 200, epoch: 3 | loss: 0.0253171
	speed: 0.0290s/iter; left time: 1328.8600s
	iters: 300, epoch: 3 | loss: 0.0486613
	speed: 0.0274s/iter; left time: 1249.7131s
	iters: 400, epoch: 3 | loss: 0.0094880
	speed: 0.0250s/iter; left time: 1138.7128s
Epoch: 3 cost time: 13.378851175308228
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.946825 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0095369
	speed: 0.1449s/iter; left time: 6577.5854s
	iters: 200, epoch: 4 | loss: 0.0036924
	speed: 0.0241s/iter; left time: 1092.5836s
	iters: 300, epoch: 4 | loss: 0.0035275
	speed: 0.0263s/iter; left time: 1187.7430s
	iters: 400, epoch: 4 | loss: 0.0060529
	speed: 0.0256s/iter; left time: 1155.3872s
Epoch: 4 cost time: 12.459747076034546
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0070533
	speed: 0.1322s/iter; left time: 5939.5754s
	iters: 200, epoch: 5 | loss: 0.0373945
	speed: 0.0252s/iter; left time: 1127.4291s
	iters: 300, epoch: 5 | loss: 0.0267998
	speed: 0.0251s/iter; left time: 1123.2248s
	iters: 400, epoch: 5 | loss: 0.0101104
	speed: 0.0285s/iter; left time: 1271.6284s
Epoch: 5 cost time: 12.467584133148193
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.953 Test Loss: 0.194 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0029043
	speed: 0.1420s/iter; left time: 6311.0127s
	iters: 200, epoch: 6 | loss: 0.1853540
	speed: 0.0272s/iter; left time: 1208.2834s
	iters: 300, epoch: 6 | loss: 0.0276040
	speed: 0.0262s/iter; left time: 1157.4095s
	iters: 400, epoch: 6 | loss: 0.0016502
	speed: 0.0262s/iter; left time: 1159.0515s
Epoch: 6 cost time: 12.820513248443604
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1026810
	speed: 0.1404s/iter; left time: 6173.8858s
	iters: 200, epoch: 7 | loss: 0.0091123
	speed: 0.0252s/iter; left time: 1106.3772s
	iters: 300, epoch: 7 | loss: 0.0705877
	speed: 0.0251s/iter; left time: 1098.1717s
	iters: 400, epoch: 7 | loss: 0.0000907
	speed: 0.0281s/iter; left time: 1225.6459s
Epoch: 7 cost time: 12.759527206420898
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004854
	speed: 0.1446s/iter; left time: 6291.3075s
	iters: 200, epoch: 8 | loss: 0.0058349
	speed: 0.0236s/iter; left time: 1026.0992s
	iters: 300, epoch: 8 | loss: 0.0112079
	speed: 0.0266s/iter; left time: 1152.5133s
	iters: 400, epoch: 8 | loss: 0.0030836
	speed: 0.0280s/iter; left time: 1210.5866s
Epoch: 8 cost time: 12.489927768707275
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0313178
	speed: 0.1465s/iter; left time: 6305.2247s
	iters: 200, epoch: 9 | loss: 0.0012190
	speed: 0.0269s/iter; left time: 1153.2358s
	iters: 300, epoch: 9 | loss: 0.0022856
	speed: 0.0279s/iter; left time: 1193.8418s
	iters: 400, epoch: 9 | loss: 0.0016685
	speed: 0.0270s/iter; left time: 1155.4565s
Epoch: 9 cost time: 13.476308584213257
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.968838 --> -0.973984).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0410739
	speed: 0.1444s/iter; left time: 6146.9659s
	iters: 200, epoch: 10 | loss: 0.0018797
	speed: 0.0265s/iter; left time: 1127.7865s
	iters: 300, epoch: 10 | loss: 0.1062203
	speed: 0.0275s/iter; left time: 1167.5082s
	iters: 400, epoch: 10 | loss: 0.0037401
	speed: 0.0302s/iter; left time: 1276.8233s
Epoch: 10 cost time: 13.547306776046753
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0356878
	speed: 0.1448s/iter; left time: 6096.0529s
	iters: 200, epoch: 11 | loss: 0.0112304
	speed: 0.0282s/iter; left time: 1185.9123s
	iters: 300, epoch: 11 | loss: 0.0000408
	speed: 0.0266s/iter; left time: 1113.5317s
	iters: 400, epoch: 11 | loss: 0.0005522
	speed: 0.0274s/iter; left time: 1147.1299s
Epoch: 11 cost time: 13.195881128311157
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.979416).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0805495
	speed: 0.1456s/iter; left time: 6064.7000s
	iters: 200, epoch: 12 | loss: 0.2539783
	speed: 0.0260s/iter; left time: 1078.2461s
	iters: 300, epoch: 12 | loss: 0.0018228
	speed: 0.0247s/iter; left time: 1022.8838s
	iters: 400, epoch: 12 | loss: 0.0000885
	speed: 0.0258s/iter; left time: 1067.3198s
Epoch: 12 cost time: 12.482491731643677
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0897381
	speed: 0.1379s/iter; left time: 5677.4365s
	iters: 200, epoch: 13 | loss: 0.0002019
	speed: 0.0255s/iter; left time: 1046.7204s
	iters: 300, epoch: 13 | loss: 0.0305938
	speed: 0.0254s/iter; left time: 1039.9752s
	iters: 400, epoch: 13 | loss: 0.0022513
	speed: 0.0299s/iter; left time: 1221.1240s
Epoch: 13 cost time: 13.059492349624634
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000997
	speed: 0.1377s/iter; left time: 5603.8959s
	iters: 200, epoch: 14 | loss: 0.0169884
	speed: 0.0258s/iter; left time: 1048.3064s
	iters: 300, epoch: 14 | loss: 0.0098802
	speed: 0.0267s/iter; left time: 1079.9198s
	iters: 400, epoch: 14 | loss: 0.4322807
	speed: 0.0261s/iter; left time: 1056.1073s
Epoch: 14 cost time: 12.396352529525757
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0033353
	speed: 0.1424s/iter; left time: 5729.4424s
	iters: 200, epoch: 15 | loss: 0.0002419
	speed: 0.0259s/iter; left time: 1037.7630s
	iters: 300, epoch: 15 | loss: 0.0186531
	speed: 0.0259s/iter; left time: 1038.8634s
	iters: 400, epoch: 15 | loss: 0.0735034
	speed: 0.0253s/iter; left time: 1010.7041s
Epoch: 15 cost time: 12.705843687057495
Epoch: 15, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0008584
	speed: 0.1373s/iter; left time: 5460.3059s
	iters: 200, epoch: 16 | loss: 0.0018233
	speed: 0.0244s/iter; left time: 966.2355s
	iters: 300, epoch: 16 | loss: 0.0000853
	speed: 0.0253s/iter; left time: 1002.8847s
	iters: 400, epoch: 16 | loss: 0.0031146
	speed: 0.0259s/iter; left time: 1023.1318s
Epoch: 16 cost time: 12.130156993865967
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.1831749
	speed: 0.1397s/iter; left time: 5489.6908s
	iters: 200, epoch: 17 | loss: 0.0054938
	speed: 0.0284s/iter; left time: 1112.3219s
	iters: 300, epoch: 17 | loss: 0.0000904
	speed: 0.0274s/iter; left time: 1069.5204s
	iters: 400, epoch: 17 | loss: 0.0535383
	speed: 0.0273s/iter; left time: 1066.1194s
Epoch: 17 cost time: 13.365741729736328
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0002146
	speed: 0.1387s/iter; left time: 5384.1718s
	iters: 200, epoch: 18 | loss: 0.0006598
	speed: 0.0248s/iter; left time: 959.0557s
	iters: 300, epoch: 18 | loss: 0.0053295
	speed: 0.0249s/iter; left time: 959.9497s
	iters: 400, epoch: 18 | loss: 0.0012809
	speed: 0.0248s/iter; left time: 955.8165s
Epoch: 18 cost time: 12.091431617736816
Epoch: 18, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001014
	speed: 0.1474s/iter; left time: 5653.7321s
	iters: 200, epoch: 19 | loss: 0.0139247
	speed: 0.0255s/iter; left time: 974.6984s
	iters: 300, epoch: 19 | loss: 0.0463544
	speed: 0.0271s/iter; left time: 1033.4384s
	iters: 400, epoch: 19 | loss: 0.0056808
	speed: 0.0272s/iter; left time: 1035.3528s
Epoch: 19 cost time: 13.208380699157715
Epoch: 19, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0030469
	speed: 0.1473s/iter; left time: 5579.3989s
	iters: 200, epoch: 20 | loss: 0.0035506
	speed: 0.0300s/iter; left time: 1133.0236s
	iters: 300, epoch: 20 | loss: 0.0247970
	speed: 0.0295s/iter; left time: 1110.5523s
	iters: 400, epoch: 20 | loss: 0.0044483
	speed: 0.0280s/iter; left time: 1052.7829s
Epoch: 20 cost time: 13.997539758682251
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0003629
	speed: 0.1435s/iter; left time: 5371.2863s
	iters: 200, epoch: 21 | loss: 0.0018094
	speed: 0.0267s/iter; left time: 995.6728s
	iters: 300, epoch: 21 | loss: 0.0000056
	speed: 0.0263s/iter; left time: 978.5616s
	iters: 400, epoch: 21 | loss: 0.0002266
	speed: 0.0274s/iter; left time: 1018.0176s
Epoch: 21 cost time: 13.264217853546143
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000656
	speed: 0.1444s/iter; left time: 5335.6992s
	iters: 200, epoch: 22 | loss: 0.0618353
	speed: 0.0243s/iter; left time: 895.6555s
	iters: 300, epoch: 22 | loss: 0.0000488
	speed: 0.0245s/iter; left time: 901.6788s
	iters: 400, epoch: 22 | loss: 0.0031468
	speed: 0.0261s/iter; left time: 958.0252s
Epoch: 22 cost time: 12.424004793167114
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0012635
	speed: 0.1446s/iter; left time: 5274.5216s
	iters: 200, epoch: 23 | loss: 0.0048351
	speed: 0.0257s/iter; left time: 934.0559s
	iters: 300, epoch: 23 | loss: 0.0077405
	speed: 0.0274s/iter; left time: 992.6095s
	iters: 400, epoch: 23 | loss: 0.0003024
	speed: 0.0291s/iter; left time: 1054.4909s
Epoch: 23 cost time: 13.060962200164795
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0001498
	speed: 0.1365s/iter; left time: 4915.3624s
	iters: 200, epoch: 24 | loss: 0.0000842
	speed: 0.0291s/iter; left time: 1046.8109s
	iters: 300, epoch: 24 | loss: 0.0189266
	speed: 0.0284s/iter; left time: 1017.8847s
	iters: 400, epoch: 24 | loss: 0.0001798
	speed: 0.0263s/iter; left time: 938.5518s
Epoch: 24 cost time: 13.300397872924805
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000017
	speed: 0.1465s/iter; left time: 5208.9652s
	iters: 200, epoch: 25 | loss: 0.0028847
	speed: 0.0252s/iter; left time: 892.9175s
	iters: 300, epoch: 25 | loss: 0.0022663
	speed: 0.0254s/iter; left time: 897.6657s
	iters: 400, epoch: 25 | loss: 0.0019276
	speed: 0.0251s/iter; left time: 882.9027s
Epoch: 25 cost time: 12.529975175857544
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0029362
	speed: 0.1441s/iter; left time: 5054.0470s
	iters: 200, epoch: 26 | loss: 0.5388874
	speed: 0.0288s/iter; left time: 1006.2962s
	iters: 300, epoch: 26 | loss: 0.0315135
	speed: 0.0265s/iter; left time: 925.7078s
	iters: 400, epoch: 26 | loss: 0.0117128
	speed: 0.0291s/iter; left time: 1010.2458s
Epoch: 26 cost time: 13.540706634521484
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000164
	speed: 0.1473s/iter; left time: 5097.2393s
	iters: 200, epoch: 27 | loss: 0.0010909
	speed: 0.0295s/iter; left time: 1019.0543s
	iters: 300, epoch: 27 | loss: 0.0000393
	speed: 0.0294s/iter; left time: 1012.3213s
	iters: 400, epoch: 27 | loss: 0.3222713
	speed: 0.0278s/iter; left time: 952.0221s
Epoch: 27 cost time: 13.687798976898193
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980845).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0194926
	speed: 0.1499s/iter; left time: 5118.2108s
	iters: 200, epoch: 28 | loss: 0.0001797
	speed: 0.0276s/iter; left time: 940.4802s
	iters: 300, epoch: 28 | loss: 0.0252317
	speed: 0.0249s/iter; left time: 843.4750s
	iters: 400, epoch: 28 | loss: 0.0001333
	speed: 0.0259s/iter; left time: 876.1648s
Epoch: 28 cost time: 12.997568845748901
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0007677
	speed: 0.1448s/iter; left time: 4875.1655s
	iters: 200, epoch: 29 | loss: 0.0000761
	speed: 0.0271s/iter; left time: 909.1335s
	iters: 300, epoch: 29 | loss: 0.0364173
	speed: 0.0266s/iter; left time: 891.2837s
	iters: 400, epoch: 29 | loss: 0.0033579
	speed: 0.0268s/iter; left time: 892.6851s
Epoch: 29 cost time: 13.081109046936035
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.974 Test Loss: 0.173 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000174
	speed: 0.1419s/iter; left time: 4710.4135s
	iters: 200, epoch: 30 | loss: 0.3390937
	speed: 0.0285s/iter; left time: 942.9444s
	iters: 300, epoch: 30 | loss: 0.0016695
	speed: 0.0298s/iter; left time: 983.3097s
	iters: 400, epoch: 30 | loss: 0.0237174
	speed: 0.0275s/iter; left time: 906.2037s
Epoch: 30 cost time: 13.538383722305298
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0016916
	speed: 0.1431s/iter; left time: 4685.3731s
	iters: 200, epoch: 31 | loss: 0.0000970
	speed: 0.0259s/iter; left time: 843.9744s
	iters: 300, epoch: 31 | loss: 0.0003216
	speed: 0.0261s/iter; left time: 847.7906s
	iters: 400, epoch: 31 | loss: 0.0001039
	speed: 0.0267s/iter; left time: 865.2332s
Epoch: 31 cost time: 12.69287633895874
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
Validation loss decreased (-0.980845 --> -0.981988).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0008714
	speed: 0.1490s/iter; left time: 4808.4955s
	iters: 200, epoch: 32 | loss: 0.0000154
	speed: 0.0259s/iter; left time: 833.5874s
	iters: 300, epoch: 32 | loss: 0.2872203
	speed: 0.0247s/iter; left time: 792.1420s
	iters: 400, epoch: 32 | loss: 0.0001327
	speed: 0.0246s/iter; left time: 786.0477s
Epoch: 32 cost time: 12.03003215789795
Epoch: 32, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0158222
	speed: 0.1434s/iter; left time: 4557.8045s
	iters: 200, epoch: 33 | loss: 0.0263949
	speed: 0.0255s/iter; left time: 808.4003s
	iters: 300, epoch: 33 | loss: 0.0005045
	speed: 0.0269s/iter; left time: 849.6433s
	iters: 400, epoch: 33 | loss: 0.0000268
	speed: 0.0281s/iter; left time: 884.8660s
Epoch: 33 cost time: 13.113391160964966
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0010089
	speed: 0.1428s/iter; left time: 4473.3626s
	iters: 200, epoch: 34 | loss: 0.0745710
	speed: 0.0265s/iter; left time: 828.2782s
	iters: 300, epoch: 34 | loss: 0.0227508
	speed: 0.0275s/iter; left time: 855.5853s
	iters: 400, epoch: 34 | loss: 0.0029961
	speed: 0.0279s/iter; left time: 865.9585s
Epoch: 34 cost time: 13.03663420677185
Epoch: 34, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0004158
	speed: 0.1453s/iter; left time: 4483.3929s
	iters: 200, epoch: 35 | loss: 0.0002815
	speed: 0.0278s/iter; left time: 854.6204s
	iters: 300, epoch: 35 | loss: 0.2116108
	speed: 0.0268s/iter; left time: 821.5449s
	iters: 400, epoch: 35 | loss: 0.0000004
	speed: 0.0265s/iter; left time: 809.3635s
Epoch: 35 cost time: 13.442116022109985
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0039023
	speed: 0.1466s/iter; left time: 4453.5321s
	iters: 200, epoch: 36 | loss: 0.0650709
	speed: 0.0269s/iter; left time: 814.4991s
	iters: 300, epoch: 36 | loss: 0.0024061
	speed: 0.0270s/iter; left time: 815.0272s
	iters: 400, epoch: 36 | loss: 0.0878923
	speed: 0.0286s/iter; left time: 859.0948s
Epoch: 36 cost time: 13.740041732788086
Epoch: 36, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0000024
	speed: 0.1487s/iter; left time: 4447.3176s
	iters: 200, epoch: 37 | loss: 0.0173220
	speed: 0.0263s/iter; left time: 785.1357s
	iters: 300, epoch: 37 | loss: 0.0000588
	speed: 0.0292s/iter; left time: 867.7917s
	iters: 400, epoch: 37 | loss: 0.0001875
	speed: 0.0311s/iter; left time: 919.6875s
Epoch: 37 cost time: 13.644431829452515
Epoch: 37, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0001159
	speed: 0.1433s/iter; left time: 4220.5997s
	iters: 200, epoch: 38 | loss: 0.0000029
	speed: 0.0279s/iter; left time: 817.9040s
	iters: 300, epoch: 38 | loss: 0.0022087
	speed: 0.0259s/iter; left time: 757.5070s
	iters: 400, epoch: 38 | loss: 0.0485514
	speed: 0.0251s/iter; left time: 732.9509s
Epoch: 38 cost time: 12.740817070007324
Epoch: 38, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0000723
	speed: 0.1456s/iter; left time: 4220.2781s
	iters: 200, epoch: 39 | loss: 0.0620178
	speed: 0.0264s/iter; left time: 761.9871s
	iters: 300, epoch: 39 | loss: 0.0002035
	speed: 0.0258s/iter; left time: 741.4472s
	iters: 400, epoch: 39 | loss: 0.0178970
	speed: 0.0265s/iter; left time: 760.8782s
Epoch: 39 cost time: 13.06547999382019
Epoch: 39, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.1332162
	speed: 0.1417s/iter; left time: 4040.8609s
	iters: 200, epoch: 40 | loss: 0.0051922
	speed: 0.0257s/iter; left time: 729.6243s
	iters: 300, epoch: 40 | loss: 0.0140020
	speed: 0.0266s/iter; left time: 753.1675s
	iters: 400, epoch: 40 | loss: 0.1717842
	speed: 0.0283s/iter; left time: 799.3646s
Epoch: 40 cost time: 13.04633116722107
Epoch: 40, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0189756
	speed: 0.1423s/iter; left time: 3991.1782s
	iters: 200, epoch: 41 | loss: 0.1221128
	speed: 0.0249s/iter; left time: 694.9067s
	iters: 300, epoch: 41 | loss: 0.0000130
	speed: 0.0276s/iter; left time: 768.2943s
	iters: 400, epoch: 41 | loss: 0.0000028
	speed: 0.0270s/iter; left time: 749.3599s
Epoch: 41 cost time: 12.750084161758423
Epoch: 41, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 1205794
model size : 9.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0867500
	speed: 0.0528s/iter; left time: 2471.7717s
	iters: 200, epoch: 1 | loss: 0.1669374
	speed: 0.0276s/iter; left time: 1287.9206s
	iters: 300, epoch: 1 | loss: 0.1368178
	speed: 0.0272s/iter; left time: 1266.2102s
	iters: 400, epoch: 1 | loss: 0.1577480
	speed: 0.0267s/iter; left time: 1243.7094s
Epoch: 1 cost time: 15.377754211425781
Epoch: 1, Steps: 469 | Train Loss: 0.483 Vali Loss: 0.214 Vali Acc: 0.942 Test Loss: 0.214 Test Acc: 0.942
Validation loss decreased (inf --> -0.941679).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1722616
	speed: 0.1883s/iter; left time: 8725.4596s
	iters: 200, epoch: 2 | loss: 0.0718302
	speed: 0.0311s/iter; left time: 1440.1123s
	iters: 300, epoch: 2 | loss: 0.0683873
	speed: 0.0274s/iter; left time: 1264.6579s
	iters: 400, epoch: 2 | loss: 0.2305807
	speed: 0.0307s/iter; left time: 1414.0843s
Epoch: 2 cost time: 14.029865264892578
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.941679 --> -0.953114).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0028492
	speed: 0.1922s/iter; left time: 8814.7282s
	iters: 200, epoch: 3 | loss: 0.0082797
	speed: 0.0300s/iter; left time: 1373.1401s
	iters: 300, epoch: 3 | loss: 0.0051864
	speed: 0.0321s/iter; left time: 1464.1755s
	iters: 400, epoch: 3 | loss: 0.0008142
	speed: 0.0306s/iter; left time: 1395.4919s
Epoch: 3 cost time: 14.992734670639038
Epoch: 3, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.953114 --> -0.969410).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0145448
	speed: 0.2040s/iter; left time: 9259.1964s
	iters: 200, epoch: 4 | loss: 0.0079955
	speed: 0.0325s/iter; left time: 1471.4763s
	iters: 300, epoch: 4 | loss: 0.0845077
	speed: 0.0286s/iter; left time: 1294.4952s
	iters: 400, epoch: 4 | loss: 0.0007060
	speed: 0.0319s/iter; left time: 1438.2005s
Epoch: 4 cost time: 15.187800407409668
Epoch: 4, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0014513
	speed: 0.2057s/iter; left time: 9241.4589s
	iters: 200, epoch: 5 | loss: 0.1052582
	speed: 0.0315s/iter; left time: 1413.8566s
	iters: 300, epoch: 5 | loss: 0.0330983
	speed: 0.0302s/iter; left time: 1350.9674s
	iters: 400, epoch: 5 | loss: 0.0284012
	speed: 0.0320s/iter; left time: 1427.2943s
Epoch: 5 cost time: 15.381709575653076
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.970839).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0033079
	speed: 0.2257s/iter; left time: 10034.3108s
	iters: 200, epoch: 6 | loss: 0.0886682
	speed: 0.0356s/iter; left time: 1579.0314s
	iters: 300, epoch: 6 | loss: 0.0002316
	speed: 0.0346s/iter; left time: 1531.6534s
	iters: 400, epoch: 6 | loss: 0.0129008
	speed: 0.0359s/iter; left time: 1586.4152s
Epoch: 6 cost time: 16.592790126800537
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1513999
	speed: 0.2311s/iter; left time: 10165.1409s
	iters: 200, epoch: 7 | loss: 0.0010060
	speed: 0.0343s/iter; left time: 1504.3849s
	iters: 300, epoch: 7 | loss: 0.0177260
	speed: 0.0342s/iter; left time: 1497.5581s
	iters: 400, epoch: 7 | loss: 0.0000056
	speed: 0.0340s/iter; left time: 1483.8472s
Epoch: 7 cost time: 16.548406839370728
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.970839 --> -0.974556).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0009540
	speed: 0.2275s/iter; left time: 9900.0874s
	iters: 200, epoch: 8 | loss: 0.0018287
	speed: 0.0310s/iter; left time: 1343.9330s
	iters: 300, epoch: 8 | loss: 0.0006966
	speed: 0.0348s/iter; left time: 1509.4799s
	iters: 400, epoch: 8 | loss: 0.0391802
	speed: 0.0317s/iter; left time: 1370.9793s
Epoch: 8 cost time: 16.186476230621338
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.974556 --> -0.980273).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003349
	speed: 0.2156s/iter; left time: 9283.3775s
	iters: 200, epoch: 9 | loss: 0.0000622
	speed: 0.0321s/iter; left time: 1380.1389s
	iters: 300, epoch: 9 | loss: 0.0124842
	speed: 0.0320s/iter; left time: 1372.9898s
	iters: 400, epoch: 9 | loss: 0.0002275
	speed: 0.0337s/iter; left time: 1439.7532s
Epoch: 9 cost time: 16.083211421966553
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0007621
	speed: 0.2195s/iter; left time: 9347.0709s
	iters: 200, epoch: 10 | loss: 0.0438576
	speed: 0.0307s/iter; left time: 1304.4107s
	iters: 300, epoch: 10 | loss: 0.0361399
	speed: 0.0349s/iter; left time: 1478.6479s
	iters: 400, epoch: 10 | loss: 0.0000724
	speed: 0.0360s/iter; left time: 1520.8512s
Epoch: 10 cost time: 16.26993727684021
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0237221
	speed: 0.2336s/iter; left time: 9836.7032s
	iters: 200, epoch: 11 | loss: 0.0001087
	speed: 0.0319s/iter; left time: 1341.4295s
	iters: 300, epoch: 11 | loss: 0.0008818
	speed: 0.0307s/iter; left time: 1286.4767s
	iters: 400, epoch: 11 | loss: 0.0067363
	speed: 0.0304s/iter; left time: 1270.2902s
Epoch: 11 cost time: 15.665053606033325
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.4181394
	speed: 0.1908s/iter; left time: 7943.2594s
	iters: 200, epoch: 12 | loss: 0.0301158
	speed: 0.0295s/iter; left time: 1227.2420s
	iters: 300, epoch: 12 | loss: 0.0002192
	speed: 0.0321s/iter; left time: 1328.6318s
	iters: 400, epoch: 12 | loss: 0.0000828
	speed: 0.0334s/iter; left time: 1381.1037s
Epoch: 12 cost time: 15.573778629302979
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0016384
	speed: 0.1994s/iter; left time: 8208.4649s
	iters: 200, epoch: 13 | loss: 0.0007678
	speed: 0.0304s/iter; left time: 1249.7477s
	iters: 300, epoch: 13 | loss: 0.0000523
	speed: 0.0343s/iter; left time: 1405.0043s
	iters: 400, epoch: 13 | loss: 0.0004638
	speed: 0.0344s/iter; left time: 1405.1500s
Epoch: 13 cost time: 15.744390487670898
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.981131).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000552
	speed: 0.2087s/iter; left time: 8492.9096s
	iters: 200, epoch: 14 | loss: 0.0108285
	speed: 0.0313s/iter; left time: 1269.0099s
	iters: 300, epoch: 14 | loss: 0.0001074
	speed: 0.0281s/iter; left time: 1138.9519s
	iters: 400, epoch: 14 | loss: 0.0020799
	speed: 0.0309s/iter; left time: 1249.5363s
Epoch: 14 cost time: 14.498687982559204
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0080301
	speed: 0.2056s/iter; left time: 8274.1041s
	iters: 200, epoch: 15 | loss: 0.0000390
	speed: 0.0302s/iter; left time: 1212.9362s
	iters: 300, epoch: 15 | loss: 0.0002071
	speed: 0.0354s/iter; left time: 1418.5443s
	iters: 400, epoch: 15 | loss: 0.0005213
	speed: 0.0317s/iter; left time: 1266.1530s
Epoch: 15 cost time: 15.545915842056274
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0008808
	speed: 0.1981s/iter; left time: 7878.2279s
	iters: 200, epoch: 16 | loss: 0.0000194
	speed: 0.0326s/iter; left time: 1295.0702s
	iters: 300, epoch: 16 | loss: 0.0001124
	speed: 0.0314s/iter; left time: 1243.8254s
	iters: 400, epoch: 16 | loss: 0.0003705
	speed: 0.0259s/iter; left time: 1022.7168s
Epoch: 16 cost time: 14.427006483078003
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0011963
	speed: 0.1717s/iter; left time: 6747.3853s
	iters: 200, epoch: 17 | loss: 0.0158466
	speed: 0.0313s/iter; left time: 1227.4023s
	iters: 300, epoch: 17 | loss: 0.0000380
	speed: 0.0321s/iter; left time: 1253.3516s
	iters: 400, epoch: 17 | loss: 0.0001806
	speed: 0.0314s/iter; left time: 1223.8806s
Epoch: 17 cost time: 14.984875917434692
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0041972
	speed: 0.1977s/iter; left time: 7676.2475s
	iters: 200, epoch: 18 | loss: 0.0480174
	speed: 0.0283s/iter; left time: 1094.7971s
	iters: 300, epoch: 18 | loss: 0.1438331
	speed: 0.0289s/iter; left time: 1118.1915s
	iters: 400, epoch: 18 | loss: 0.1035969
	speed: 0.0279s/iter; left time: 1076.0544s
Epoch: 18 cost time: 14.319308280944824
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.978 Test Loss: 0.143 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.7958152
	speed: 0.1879s/iter; left time: 7207.7768s
	iters: 200, epoch: 19 | loss: 0.2812059
	speed: 0.0296s/iter; left time: 1131.8387s
	iters: 300, epoch: 19 | loss: 0.0445921
	speed: 0.0297s/iter; left time: 1132.3311s
	iters: 400, epoch: 19 | loss: 0.0006331
	speed: 0.0306s/iter; left time: 1164.9264s
Epoch: 19 cost time: 14.940635681152344
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0070115
	speed: 0.2148s/iter; left time: 8137.5056s
	iters: 200, epoch: 20 | loss: 0.0104929
	speed: 0.0328s/iter; left time: 1238.1372s
	iters: 300, epoch: 20 | loss: 0.0007873
	speed: 0.0297s/iter; left time: 1120.8754s
	iters: 400, epoch: 20 | loss: 0.0003845
	speed: 0.0304s/iter; left time: 1143.6373s
Epoch: 20 cost time: 15.585262537002563
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000072
	speed: 0.1951s/iter; left time: 7300.0250s
	iters: 200, epoch: 21 | loss: 0.0024287
	speed: 0.0299s/iter; left time: 1114.5703s
	iters: 300, epoch: 21 | loss: 0.0005724
	speed: 0.0292s/iter; left time: 1087.9985s
	iters: 400, epoch: 21 | loss: 0.1965703
	speed: 0.0288s/iter; left time: 1069.4801s
Epoch: 21 cost time: 14.35722303390503
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000005
	speed: 0.2012s/iter; left time: 7435.0666s
	iters: 200, epoch: 22 | loss: 0.0003677
	speed: 0.0303s/iter; left time: 1117.5458s
	iters: 300, epoch: 22 | loss: 0.0001195
	speed: 0.0322s/iter; left time: 1181.9505s
	iters: 400, epoch: 22 | loss: 0.5578359
	speed: 0.0321s/iter; left time: 1177.1409s
Epoch: 22 cost time: 15.000460386276245
Epoch: 22, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000012
	speed: 0.1974s/iter; left time: 7200.9153s
	iters: 200, epoch: 23 | loss: 0.2596461
	speed: 0.0274s/iter; left time: 996.7038s
	iters: 300, epoch: 23 | loss: 0.0000096
	speed: 0.0304s/iter; left time: 1102.1143s
	iters: 400, epoch: 23 | loss: 0.0001052
	speed: 0.0287s/iter; left time: 1038.4415s
Epoch: 23 cost time: 14.35288953781128
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 1205794
model size : 9.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6562538
	speed: 0.0449s/iter; left time: 2102.6791s
	iters: 200, epoch: 1 | loss: 0.1940156
	speed: 0.0274s/iter; left time: 1280.5280s
	iters: 300, epoch: 1 | loss: 0.1432077
	speed: 0.0263s/iter; left time: 1223.6910s
	iters: 400, epoch: 1 | loss: 0.1910619
	speed: 0.0236s/iter; left time: 1098.3394s
Epoch: 1 cost time: 14.091886758804321
Epoch: 1, Steps: 469 | Train Loss: 0.451 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (inf --> -0.947968).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0159177
	speed: 0.1383s/iter; left time: 6405.7201s
	iters: 200, epoch: 2 | loss: 0.0254662
	speed: 0.0264s/iter; left time: 1221.9642s
	iters: 300, epoch: 2 | loss: 0.0373040
	speed: 0.0273s/iter; left time: 1261.3486s
	iters: 400, epoch: 2 | loss: 0.0468908
	speed: 0.0253s/iter; left time: 1166.8333s
Epoch: 2 cost time: 12.646429300308228
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0065930
	speed: 0.1486s/iter; left time: 6813.3178s
	iters: 200, epoch: 3 | loss: 0.0230379
	speed: 0.0272s/iter; left time: 1242.8450s
	iters: 300, epoch: 3 | loss: 0.0054433
	speed: 0.0263s/iter; left time: 1202.6646s
	iters: 400, epoch: 3 | loss: 0.0017175
	speed: 0.0243s/iter; left time: 1106.4772s
Epoch: 3 cost time: 12.760671377182007
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.947968 --> -0.965122).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0327904
	speed: 0.1455s/iter; left time: 6605.3683s
	iters: 200, epoch: 4 | loss: 0.0031839
	speed: 0.0287s/iter; left time: 1299.4642s
	iters: 300, epoch: 4 | loss: 0.1944367
	speed: 0.0296s/iter; left time: 1337.0907s
	iters: 400, epoch: 4 | loss: 0.0167730
	speed: 0.0286s/iter; left time: 1287.6488s
Epoch: 4 cost time: 13.80084753036499
Epoch: 4, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.965122 --> -0.969410).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1021866
	speed: 0.1429s/iter; left time: 6420.4379s
	iters: 200, epoch: 5 | loss: 0.0002414
	speed: 0.0262s/iter; left time: 1175.9108s
	iters: 300, epoch: 5 | loss: 0.0940307
	speed: 0.0273s/iter; left time: 1220.7469s
	iters: 400, epoch: 5 | loss: 0.0028661
	speed: 0.0269s/iter; left time: 1201.5822s
Epoch: 5 cost time: 13.284047365188599
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0074789
	speed: 0.1394s/iter; left time: 6197.0681s
	iters: 200, epoch: 6 | loss: 0.2505410
	speed: 0.0229s/iter; left time: 1017.9520s
	iters: 300, epoch: 6 | loss: 0.0042984
	speed: 0.0247s/iter; left time: 1092.5313s
	iters: 400, epoch: 6 | loss: 0.0444889
	speed: 0.0247s/iter; left time: 1089.3460s
Epoch: 6 cost time: 12.120469808578491
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1438227
	speed: 0.1416s/iter; left time: 6229.3767s
	iters: 200, epoch: 7 | loss: 0.0427436
	speed: 0.0255s/iter; left time: 1119.5265s
	iters: 300, epoch: 7 | loss: 0.0043567
	speed: 0.0240s/iter; left time: 1050.7623s
	iters: 400, epoch: 7 | loss: 0.0030238
	speed: 0.0269s/iter; left time: 1174.5545s
Epoch: 7 cost time: 12.581975936889648
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.973126).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0020987
	speed: 0.1432s/iter; left time: 6230.3037s
	iters: 200, epoch: 8 | loss: 0.0096950
	speed: 0.0243s/iter; left time: 1054.0473s
	iters: 300, epoch: 8 | loss: 0.0183910
	speed: 0.0250s/iter; left time: 1082.0023s
	iters: 400, epoch: 8 | loss: 0.0409195
	speed: 0.0246s/iter; left time: 1061.8209s
Epoch: 8 cost time: 12.080206155776978
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
Validation loss decreased (-0.973126 --> -0.975699).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003720
	speed: 0.1404s/iter; left time: 6044.7494s
	iters: 200, epoch: 9 | loss: 0.0876474
	speed: 0.0282s/iter; left time: 1209.0257s
	iters: 300, epoch: 9 | loss: 0.0175950
	speed: 0.0258s/iter; left time: 1106.8338s
	iters: 400, epoch: 9 | loss: 0.0276270
	speed: 0.0254s/iter; left time: 1085.2637s
Epoch: 9 cost time: 12.712613344192505
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0016791
	speed: 0.1389s/iter; left time: 5913.0413s
	iters: 200, epoch: 10 | loss: 0.0022974
	speed: 0.0263s/iter; left time: 1116.8448s
	iters: 300, epoch: 10 | loss: 0.0007261
	speed: 0.0254s/iter; left time: 1077.6911s
	iters: 400, epoch: 10 | loss: 0.0326047
	speed: 0.0257s/iter; left time: 1088.0618s
Epoch: 10 cost time: 12.575481653213501
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0006483
	speed: 0.1335s/iter; left time: 5621.0041s
	iters: 200, epoch: 11 | loss: 0.0016640
	speed: 0.0260s/iter; left time: 1092.0305s
	iters: 300, epoch: 11 | loss: 0.0001220
	speed: 0.0269s/iter; left time: 1126.4255s
	iters: 400, epoch: 11 | loss: 0.0014060
	speed: 0.0289s/iter; left time: 1206.4232s
Epoch: 11 cost time: 12.895946502685547
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0007243
	speed: 0.1427s/iter; left time: 5940.9858s
	iters: 200, epoch: 12 | loss: 0.0008037
	speed: 0.0252s/iter; left time: 1047.4741s
	iters: 300, epoch: 12 | loss: 0.0592568
	speed: 0.0277s/iter; left time: 1146.7426s
	iters: 400, epoch: 12 | loss: 0.0003462
	speed: 0.0268s/iter; left time: 1109.3480s
Epoch: 12 cost time: 12.483932971954346
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.975985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000252
	speed: 0.1403s/iter; left time: 5778.2944s
	iters: 200, epoch: 13 | loss: 0.0623882
	speed: 0.0279s/iter; left time: 1145.7928s
	iters: 300, epoch: 13 | loss: 0.0001344
	speed: 0.0282s/iter; left time: 1153.5169s
	iters: 400, epoch: 13 | loss: 0.0079912
	speed: 0.0264s/iter; left time: 1078.7057s
Epoch: 13 cost time: 12.89230489730835
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.975985 --> -0.979987).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003010
	speed: 0.1430s/iter; left time: 5819.2013s
	iters: 200, epoch: 14 | loss: 0.0000633
	speed: 0.0248s/iter; left time: 1007.6706s
	iters: 300, epoch: 14 | loss: 0.0075942
	speed: 0.0265s/iter; left time: 1071.3546s
	iters: 400, epoch: 14 | loss: 0.0015836
	speed: 0.0273s/iter; left time: 1104.1134s
Epoch: 14 cost time: 12.751782178878784
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0384085
	speed: 0.1397s/iter; left time: 5622.3254s
	iters: 200, epoch: 15 | loss: 0.0220834
	speed: 0.0254s/iter; left time: 1021.0110s
	iters: 300, epoch: 15 | loss: 0.0071203
	speed: 0.0243s/iter; left time: 973.6482s
	iters: 400, epoch: 15 | loss: 0.0038929
	speed: 0.0272s/iter; left time: 1085.8595s
Epoch: 15 cost time: 12.511211395263672
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0011210
	speed: 0.1354s/iter; left time: 5383.4464s
	iters: 200, epoch: 16 | loss: 0.0008907
	speed: 0.0263s/iter; left time: 1044.9565s
	iters: 300, epoch: 16 | loss: 0.4440258
	speed: 0.0275s/iter; left time: 1089.5489s
	iters: 400, epoch: 16 | loss: 0.1485791
	speed: 0.0276s/iter; left time: 1087.4186s
Epoch: 16 cost time: 12.800594091415405
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0003594
	speed: 0.1334s/iter; left time: 5241.9726s
	iters: 200, epoch: 17 | loss: 0.0024605
	speed: 0.0233s/iter; left time: 913.7784s
	iters: 300, epoch: 17 | loss: 0.0011095
	speed: 0.0226s/iter; left time: 884.3021s
	iters: 400, epoch: 17 | loss: 0.0043600
	speed: 0.0228s/iter; left time: 890.1840s
Epoch: 17 cost time: 11.462766647338867
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0012777
	speed: 0.1309s/iter; left time: 5082.1199s
	iters: 200, epoch: 18 | loss: 0.0390103
	speed: 0.0267s/iter; left time: 1033.6704s
	iters: 300, epoch: 18 | loss: 0.0060269
	speed: 0.0236s/iter; left time: 912.2667s
	iters: 400, epoch: 18 | loss: 0.0000035
	speed: 0.0242s/iter; left time: 933.3174s
Epoch: 18 cost time: 11.93956470489502
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0011811
	speed: 0.1355s/iter; left time: 5198.9489s
	iters: 200, epoch: 19 | loss: 0.0000588
	speed: 0.0229s/iter; left time: 876.9528s
	iters: 300, epoch: 19 | loss: 0.0000527
	speed: 0.0222s/iter; left time: 846.5899s
	iters: 400, epoch: 19 | loss: 0.3580560
	speed: 0.0230s/iter; left time: 875.0238s
Epoch: 19 cost time: 11.267839193344116
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0188832
	speed: 0.1378s/iter; left time: 5221.3998s
	iters: 200, epoch: 20 | loss: 0.0000388
	speed: 0.0273s/iter; left time: 1031.4422s
	iters: 300, epoch: 20 | loss: 0.0002893
	speed: 0.0300s/iter; left time: 1129.0598s
	iters: 400, epoch: 20 | loss: 0.0099047
	speed: 0.0295s/iter; left time: 1109.8978s
Epoch: 20 cost time: 13.789165019989014
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0019665
	speed: 0.1374s/iter; left time: 5142.9691s
	iters: 200, epoch: 21 | loss: 0.0206230
	speed: 0.0279s/iter; left time: 1042.3485s
	iters: 300, epoch: 21 | loss: 0.0019866
	speed: 0.0269s/iter; left time: 1002.8220s
	iters: 400, epoch: 21 | loss: 0.0008474
	speed: 0.0269s/iter; left time: 999.4591s
Epoch: 21 cost time: 13.41004490852356
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0017795
	speed: 0.1458s/iter; left time: 5388.2598s
	iters: 200, epoch: 22 | loss: 0.0020543
	speed: 0.0261s/iter; left time: 960.0106s
	iters: 300, epoch: 22 | loss: 0.0013063
	speed: 0.0267s/iter; left time: 979.5636s
	iters: 400, epoch: 22 | loss: 0.2752480
	speed: 0.0269s/iter; left time: 985.4794s
Epoch: 22 cost time: 12.975667238235474
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0023775
	speed: 0.1455s/iter; left time: 5307.9405s
	iters: 200, epoch: 23 | loss: 0.2564153
	speed: 0.0261s/iter; left time: 951.3438s
	iters: 300, epoch: 23 | loss: 0.0001498
	speed: 0.0276s/iter; left time: 1003.0383s
	iters: 400, epoch: 23 | loss: 0.0009539
	speed: 0.0258s/iter; left time: 934.8470s
Epoch: 23 cost time: 12.718604803085327
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 681506
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6923195
	speed: 0.0453s/iter; left time: 2120.2024s
	iters: 200, epoch: 1 | loss: 0.1736520
	speed: 0.0262s/iter; left time: 1221.6203s
	iters: 300, epoch: 1 | loss: 0.1377539
	speed: 0.0254s/iter; left time: 1182.6287s
	iters: 400, epoch: 1 | loss: 0.2299451
	speed: 0.0257s/iter; left time: 1195.3403s
Epoch: 1 cost time: 14.103142976760864
Epoch: 1, Steps: 469 | Train Loss: 0.460 Vali Loss: 0.216 Vali Acc: 0.947 Test Loss: 0.216 Test Acc: 0.947
Validation loss decreased (inf --> -0.947396).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0119467
	speed: 0.1373s/iter; left time: 6360.3014s
	iters: 200, epoch: 2 | loss: 0.0585474
	speed: 0.0246s/iter; left time: 1136.2951s
	iters: 300, epoch: 2 | loss: 0.0300537
	speed: 0.0250s/iter; left time: 1152.9123s
	iters: 400, epoch: 2 | loss: 0.0450462
	speed: 0.0260s/iter; left time: 1195.2169s
Epoch: 2 cost time: 12.215473651885986
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.947396 --> -0.950827).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0055032
	speed: 0.1365s/iter; left time: 6262.2003s
	iters: 200, epoch: 3 | loss: 0.0984159
	speed: 0.0248s/iter; left time: 1136.4725s
	iters: 300, epoch: 3 | loss: 0.0036082
	speed: 0.0256s/iter; left time: 1170.4006s
	iters: 400, epoch: 3 | loss: 0.0069638
	speed: 0.0274s/iter; left time: 1249.2790s
Epoch: 3 cost time: 12.674240112304688
Epoch: 3, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.950827 --> -0.970553).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0620365
	speed: 0.1454s/iter; left time: 6599.3512s
	iters: 200, epoch: 4 | loss: 0.0037442
	speed: 0.0249s/iter; left time: 1126.3873s
	iters: 300, epoch: 4 | loss: 0.0534940
	speed: 0.0274s/iter; left time: 1238.4370s
	iters: 400, epoch: 4 | loss: 0.2167436
	speed: 0.0279s/iter; left time: 1258.7722s
Epoch: 4 cost time: 12.581661224365234
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0418223
	speed: 0.1389s/iter; left time: 6239.1675s
	iters: 200, epoch: 5 | loss: 0.0003611
	speed: 0.0287s/iter; left time: 1285.8270s
	iters: 300, epoch: 5 | loss: 0.0907513
	speed: 0.0267s/iter; left time: 1195.1348s
	iters: 400, epoch: 5 | loss: 0.0073775
	speed: 0.0262s/iter; left time: 1171.3878s
Epoch: 5 cost time: 13.04728651046753
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0081454
	speed: 0.1425s/iter; left time: 6334.9996s
	iters: 200, epoch: 6 | loss: 0.1672723
	speed: 0.0263s/iter; left time: 1166.0093s
	iters: 300, epoch: 6 | loss: 0.0068610
	speed: 0.0273s/iter; left time: 1207.4889s
	iters: 400, epoch: 6 | loss: 0.0020661
	speed: 0.0272s/iter; left time: 1201.7172s
Epoch: 6 cost time: 13.209670066833496
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2155042
	speed: 0.1261s/iter; left time: 5547.5574s
	iters: 200, epoch: 7 | loss: 0.0014130
	speed: 0.0235s/iter; left time: 1032.1996s
	iters: 300, epoch: 7 | loss: 0.0020433
	speed: 0.0282s/iter; left time: 1234.4859s
	iters: 400, epoch: 7 | loss: 0.0049437
	speed: 0.0306s/iter; left time: 1335.4010s
Epoch: 7 cost time: 13.073547840118408
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013365
	speed: 0.1482s/iter; left time: 6450.1568s
	iters: 200, epoch: 8 | loss: 0.2190857
	speed: 0.0302s/iter; left time: 1311.3223s
	iters: 300, epoch: 8 | loss: 0.0141235
	speed: 0.0282s/iter; left time: 1219.5371s
	iters: 400, epoch: 8 | loss: 0.0414487
	speed: 0.0267s/iter; left time: 1155.7371s
Epoch: 8 cost time: 13.637598991394043
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.970553 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0034810
	speed: 0.1413s/iter; left time: 6082.2801s
	iters: 200, epoch: 9 | loss: 0.0851828
	speed: 0.0268s/iter; left time: 1151.2293s
	iters: 300, epoch: 9 | loss: 0.0015895
	speed: 0.0254s/iter; left time: 1088.8069s
	iters: 400, epoch: 9 | loss: 0.0013504
	speed: 0.0267s/iter; left time: 1140.2407s
Epoch: 9 cost time: 12.687054634094238
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.973126 --> -0.977986).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0470395
	speed: 0.1397s/iter; left time: 5948.7787s
	iters: 200, epoch: 10 | loss: 0.0015182
	speed: 0.0258s/iter; left time: 1096.2534s
	iters: 300, epoch: 10 | loss: 0.0005097
	speed: 0.0251s/iter; left time: 1062.5935s
	iters: 400, epoch: 10 | loss: 0.2033837
	speed: 0.0283s/iter; left time: 1197.8929s
Epoch: 10 cost time: 12.855758666992188
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.970 Test Loss: 0.204 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0034502
	speed: 0.1427s/iter; left time: 6008.6601s
	iters: 200, epoch: 11 | loss: 0.0731501
	speed: 0.0280s/iter; left time: 1178.0667s
	iters: 300, epoch: 11 | loss: 0.0002530
	speed: 0.0276s/iter; left time: 1157.3639s
	iters: 400, epoch: 11 | loss: 0.0176363
	speed: 0.0258s/iter; left time: 1079.4226s
Epoch: 11 cost time: 12.841678380966187
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0008494
	speed: 0.1416s/iter; left time: 5895.8312s
	iters: 200, epoch: 12 | loss: 0.0142014
	speed: 0.0270s/iter; left time: 1120.3752s
	iters: 300, epoch: 12 | loss: 0.0098968
	speed: 0.0256s/iter; left time: 1059.7314s
	iters: 400, epoch: 12 | loss: 0.0004911
	speed: 0.0251s/iter; left time: 1037.2846s
Epoch: 12 cost time: 12.783256530761719
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0089361
	speed: 0.1405s/iter; left time: 5785.9337s
	iters: 200, epoch: 13 | loss: 0.2003772
	speed: 0.0251s/iter; left time: 1029.0420s
	iters: 300, epoch: 13 | loss: 0.0002993
	speed: 0.0250s/iter; left time: 1022.3604s
	iters: 400, epoch: 13 | loss: 0.0021875
	speed: 0.0244s/iter; left time: 999.1110s
Epoch: 13 cost time: 12.142536878585815
Epoch: 13, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0006592
	speed: 0.1330s/iter; left time: 5411.6673s
	iters: 200, epoch: 14 | loss: 0.0017259
	speed: 0.0271s/iter; left time: 1100.9467s
	iters: 300, epoch: 14 | loss: 0.0001435
	speed: 0.0272s/iter; left time: 1102.5979s
	iters: 400, epoch: 14 | loss: 0.0001463
	speed: 0.0286s/iter; left time: 1154.3734s
Epoch: 14 cost time: 13.359442472457886
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.1456996
	speed: 0.1430s/iter; left time: 5752.8387s
	iters: 200, epoch: 15 | loss: 0.0001037
	speed: 0.0279s/iter; left time: 1120.4317s
	iters: 300, epoch: 15 | loss: 0.0584792
	speed: 0.0281s/iter; left time: 1125.9683s
	iters: 400, epoch: 15 | loss: 0.0016621
	speed: 0.0278s/iter; left time: 1111.0597s
Epoch: 15 cost time: 13.37832522392273
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0072776
	speed: 0.1453s/iter; left time: 5778.9202s
	iters: 200, epoch: 16 | loss: 0.0133269
	speed: 0.0297s/iter; left time: 1179.3457s
	iters: 300, epoch: 16 | loss: 0.0767386
	speed: 0.0246s/iter; left time: 972.4701s
	iters: 400, epoch: 16 | loss: 0.3102733
	speed: 0.0267s/iter; left time: 1053.9668s
Epoch: 16 cost time: 13.272789001464844
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0029891
	speed: 0.1496s/iter; left time: 5878.0236s
	iters: 200, epoch: 17 | loss: 0.0198934
	speed: 0.0276s/iter; left time: 1080.7168s
	iters: 300, epoch: 17 | loss: 0.0003672
	speed: 0.0247s/iter; left time: 964.4044s
	iters: 400, epoch: 17 | loss: 0.0465734
	speed: 0.0282s/iter; left time: 1099.5316s
Epoch: 17 cost time: 13.223740816116333
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0150124
	speed: 0.1426s/iter; left time: 5535.1563s
	iters: 200, epoch: 18 | loss: 0.0279836
	speed: 0.0256s/iter; left time: 992.7273s
	iters: 300, epoch: 18 | loss: 0.0772099
	speed: 0.0249s/iter; left time: 961.4527s
	iters: 400, epoch: 18 | loss: 0.0443816
	speed: 0.0283s/iter; left time: 1090.8912s
Epoch: 18 cost time: 12.774841785430908
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0053032
	speed: 0.1433s/iter; left time: 5496.1716s
	iters: 200, epoch: 19 | loss: 0.0001652
	speed: 0.0285s/iter; left time: 1091.0130s
	iters: 300, epoch: 19 | loss: 0.0001143
	speed: 0.0273s/iter; left time: 1041.4161s
	iters: 400, epoch: 19 | loss: 0.0984807
	speed: 0.0253s/iter; left time: 963.5355s
Epoch: 19 cost time: 12.891076803207397
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9779874213836478
model parameter : 681506
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7227530
	speed: 0.0457s/iter; left time: 2139.7453s
	iters: 200, epoch: 1 | loss: 0.1415858
	speed: 0.0238s/iter; left time: 1112.6590s
	iters: 300, epoch: 1 | loss: 0.1588357
	speed: 0.0239s/iter; left time: 1114.4388s
	iters: 400, epoch: 1 | loss: 0.2795069
	speed: 0.0251s/iter; left time: 1168.5339s
Epoch: 1 cost time: 13.644052028656006
Epoch: 1, Steps: 469 | Train Loss: 0.477 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (inf --> -0.951113).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0122065
	speed: 0.1408s/iter; left time: 6524.8128s
	iters: 200, epoch: 2 | loss: 0.0275721
	speed: 0.0243s/iter; left time: 1121.5333s
	iters: 300, epoch: 2 | loss: 0.0077255
	speed: 0.0217s/iter; left time: 1000.7205s
	iters: 400, epoch: 2 | loss: 0.0230781
	speed: 0.0238s/iter; left time: 1095.6091s
Epoch: 2 cost time: 11.632989406585693
Epoch: 2, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.951113 --> -0.969981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0031821
	speed: 0.1312s/iter; left time: 6017.5950s
	iters: 200, epoch: 3 | loss: 0.0286050
	speed: 0.0240s/iter; left time: 1097.6572s
	iters: 300, epoch: 3 | loss: 0.0039707
	speed: 0.0250s/iter; left time: 1142.0463s
	iters: 400, epoch: 3 | loss: 0.0021104
	speed: 0.0238s/iter; left time: 1083.5352s
Epoch: 3 cost time: 12.134078741073608
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0047895
	speed: 0.1377s/iter; left time: 6250.0738s
	iters: 200, epoch: 4 | loss: 0.0020631
	speed: 0.0245s/iter; left time: 1110.7445s
	iters: 300, epoch: 4 | loss: 0.0720295
	speed: 0.0267s/iter; left time: 1208.4059s
	iters: 400, epoch: 4 | loss: 0.0762646
	speed: 0.0299s/iter; left time: 1346.5156s
Epoch: 4 cost time: 12.941057920455933
Epoch: 4, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0314736
	speed: 0.1460s/iter; left time: 6560.1569s
	iters: 200, epoch: 5 | loss: 0.0000281
	speed: 0.0288s/iter; left time: 1292.0307s
	iters: 300, epoch: 5 | loss: 0.0961561
	speed: 0.0270s/iter; left time: 1206.2321s
	iters: 400, epoch: 5 | loss: 0.0018472
	speed: 0.0259s/iter; left time: 1154.6538s
Epoch: 5 cost time: 13.195547819137573
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0048561
	speed: 0.1460s/iter; left time: 6491.9208s
	iters: 200, epoch: 6 | loss: 0.0489977
	speed: 0.0236s/iter; left time: 1045.5849s
	iters: 300, epoch: 6 | loss: 0.0003301
	speed: 0.0264s/iter; left time: 1170.0499s
	iters: 400, epoch: 6 | loss: 0.0014266
	speed: 0.0262s/iter; left time: 1155.9293s
Epoch: 6 cost time: 12.758559703826904
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0257623
	speed: 0.1354s/iter; left time: 5957.6792s
	iters: 200, epoch: 7 | loss: 0.0007394
	speed: 0.0222s/iter; left time: 972.5868s
	iters: 300, epoch: 7 | loss: 0.0003121
	speed: 0.0246s/iter; left time: 1075.0846s
	iters: 400, epoch: 7 | loss: 0.0063320
	speed: 0.0245s/iter; left time: 1071.7130s
Epoch: 7 cost time: 11.675665378570557
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0260233
	speed: 0.1400s/iter; left time: 6092.7024s
	iters: 200, epoch: 8 | loss: 0.0386110
	speed: 0.0235s/iter; left time: 1020.5896s
	iters: 300, epoch: 8 | loss: 0.0166243
	speed: 0.0225s/iter; left time: 973.9345s
	iters: 400, epoch: 8 | loss: 0.0097367
	speed: 0.0238s/iter; left time: 1027.0498s
Epoch: 8 cost time: 11.648715734481812
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.969981 --> -0.979702).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0018153
	speed: 0.1345s/iter; left time: 5790.0523s
	iters: 200, epoch: 9 | loss: 0.0229557
	speed: 0.0246s/iter; left time: 1055.6378s
	iters: 300, epoch: 9 | loss: 0.0015175
	speed: 0.0287s/iter; left time: 1230.7643s
	iters: 400, epoch: 9 | loss: 0.0056005
	speed: 0.0282s/iter; left time: 1204.2726s
Epoch: 9 cost time: 12.727009773254395
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0004538
	speed: 0.1377s/iter; left time: 5862.9418s
	iters: 200, epoch: 10 | loss: 0.0004929
	speed: 0.0282s/iter; left time: 1198.6395s
	iters: 300, epoch: 10 | loss: 0.0000126
	speed: 0.0277s/iter; left time: 1175.4243s
	iters: 400, epoch: 10 | loss: 0.0050785
	speed: 0.0257s/iter; left time: 1088.2312s
Epoch: 10 cost time: 12.921476125717163
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.972 Test Loss: 0.169 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0154693
	speed: 0.1403s/iter; left time: 5909.3472s
	iters: 200, epoch: 11 | loss: 0.0021057
	speed: 0.0248s/iter; left time: 1043.8471s
	iters: 300, epoch: 11 | loss: 0.0000625
	speed: 0.0244s/iter; left time: 1021.5298s
	iters: 400, epoch: 11 | loss: 0.0044968
	speed: 0.0230s/iter; left time: 961.1483s
Epoch: 11 cost time: 11.764122009277344
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0085629
	speed: 0.1313s/iter; left time: 5468.8038s
	iters: 200, epoch: 12 | loss: 0.0305285
	speed: 0.0221s/iter; left time: 918.2760s
	iters: 300, epoch: 12 | loss: 0.0162359
	speed: 0.0211s/iter; left time: 876.1469s
	iters: 400, epoch: 12 | loss: 0.0014020
	speed: 0.0259s/iter; left time: 1071.5834s
Epoch: 12 cost time: 11.50856876373291
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0003434
	speed: 0.1501s/iter; left time: 6179.9897s
	iters: 200, epoch: 13 | loss: 0.0011360
	speed: 0.0250s/iter; left time: 1025.4263s
	iters: 300, epoch: 13 | loss: 0.0000024
	speed: 0.0253s/iter; left time: 1036.7591s
	iters: 400, epoch: 13 | loss: 0.0079612
	speed: 0.0288s/iter; left time: 1176.6281s
Epoch: 13 cost time: 13.058406591415405
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000080
	speed: 0.1439s/iter; left time: 5859.3187s
	iters: 200, epoch: 14 | loss: 0.4326672
	speed: 0.0292s/iter; left time: 1186.5037s
	iters: 300, epoch: 14 | loss: 0.0010819
	speed: 0.0298s/iter; left time: 1206.7554s
	iters: 400, epoch: 14 | loss: 0.0000146
	speed: 0.0273s/iter; left time: 1102.1345s
Epoch: 14 cost time: 13.755395889282227
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0689794
	speed: 0.1483s/iter; left time: 5967.3905s
	iters: 200, epoch: 15 | loss: 0.0004755
	speed: 0.0266s/iter; left time: 1069.2940s
	iters: 300, epoch: 15 | loss: 0.1253161
	speed: 0.0281s/iter; left time: 1126.2201s
	iters: 400, epoch: 15 | loss: 0.0021570
	speed: 0.0286s/iter; left time: 1142.8717s
Epoch: 15 cost time: 13.613283634185791
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001273
	speed: 0.1452s/iter; left time: 5774.8402s
	iters: 200, epoch: 16 | loss: 0.0000850
	speed: 0.0260s/iter; left time: 1031.4511s
	iters: 300, epoch: 16 | loss: 0.1477934
	speed: 0.0245s/iter; left time: 967.6903s
	iters: 400, epoch: 16 | loss: 0.0000958
	speed: 0.0271s/iter; left time: 1071.1304s
Epoch: 16 cost time: 12.787906408309937
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0269729
	speed: 0.1389s/iter; left time: 5458.1723s
	iters: 200, epoch: 17 | loss: 0.0031450
	speed: 0.0258s/iter; left time: 1013.2415s
	iters: 300, epoch: 17 | loss: 0.0006073
	speed: 0.0280s/iter; left time: 1095.2784s
	iters: 400, epoch: 17 | loss: 0.0001678
	speed: 0.0290s/iter; left time: 1131.2704s
Epoch: 17 cost time: 12.87404751777649
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0228272
	speed: 0.1336s/iter; left time: 5185.9475s
	iters: 200, epoch: 18 | loss: 0.0000024
	speed: 0.0251s/iter; left time: 972.6525s
	iters: 300, epoch: 18 | loss: 0.0872912
	speed: 0.0278s/iter; left time: 1074.6512s
	iters: 400, epoch: 18 | loss: 0.0011960
	speed: 0.0266s/iter; left time: 1025.2051s
Epoch: 18 cost time: 12.581397533416748
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 681506
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7527390
	speed: 0.0441s/iter; left time: 2061.6965s
	iters: 200, epoch: 1 | loss: 0.2716735
	speed: 0.0259s/iter; left time: 1207.9047s
	iters: 300, epoch: 1 | loss: 0.0844912
	speed: 0.0264s/iter; left time: 1230.2568s
	iters: 400, epoch: 1 | loss: 0.2750906
	speed: 0.0274s/iter; left time: 1275.1161s
Epoch: 1 cost time: 14.230699062347412
Epoch: 1, Steps: 469 | Train Loss: 0.455 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (inf --> -0.951685).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0431015
	speed: 0.1396s/iter; left time: 6465.9433s
	iters: 200, epoch: 2 | loss: 0.0375400
	speed: 0.0304s/iter; left time: 1406.1605s
	iters: 300, epoch: 2 | loss: 0.0089930
	speed: 0.0311s/iter; left time: 1435.8567s
	iters: 400, epoch: 2 | loss: 0.0262872
	speed: 0.0283s/iter; left time: 1301.0728s
Epoch: 2 cost time: 14.170529842376709
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.951685 --> -0.954544).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0058509
	speed: 0.1500s/iter; left time: 6880.6819s
	iters: 200, epoch: 3 | loss: 0.0388332
	speed: 0.0265s/iter; left time: 1210.5698s
	iters: 300, epoch: 3 | loss: 0.2182491
	speed: 0.0270s/iter; left time: 1231.1734s
	iters: 400, epoch: 3 | loss: 0.0188017
	speed: 0.0277s/iter; left time: 1262.1700s
Epoch: 3 cost time: 13.372404098510742
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.954544 --> -0.964835).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0441695
	speed: 0.1457s/iter; left time: 6612.2986s
	iters: 200, epoch: 4 | loss: 0.1087274
	speed: 0.0288s/iter; left time: 1302.8427s
	iters: 300, epoch: 4 | loss: 0.0187837
	speed: 0.0280s/iter; left time: 1265.5036s
	iters: 400, epoch: 4 | loss: 0.0473542
	speed: 0.0288s/iter; left time: 1298.5748s
Epoch: 4 cost time: 13.760959386825562
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0264836
	speed: 0.1493s/iter; left time: 6707.4410s
	iters: 200, epoch: 5 | loss: 0.0033150
	speed: 0.0304s/iter; left time: 1363.0072s
	iters: 300, epoch: 5 | loss: 0.0379155
	speed: 0.0289s/iter; left time: 1292.5644s
	iters: 400, epoch: 5 | loss: 0.0059437
	speed: 0.0266s/iter; left time: 1186.8783s
Epoch: 5 cost time: 13.803438663482666
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.964835 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0091649
	speed: 0.1442s/iter; left time: 6412.4253s
	iters: 200, epoch: 6 | loss: 0.0244423
	speed: 0.0272s/iter; left time: 1205.3524s
	iters: 300, epoch: 6 | loss: 0.1008187
	speed: 0.0251s/iter; left time: 1110.5306s
	iters: 400, epoch: 6 | loss: 0.0077546
	speed: 0.0259s/iter; left time: 1143.0898s
Epoch: 6 cost time: 12.822343111038208
Epoch: 6, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971411).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0952680
	speed: 0.1469s/iter; left time: 6462.5506s
	iters: 200, epoch: 7 | loss: 0.0081103
	speed: 0.0255s/iter; left time: 1117.1110s
	iters: 300, epoch: 7 | loss: 0.0001020
	speed: 0.0235s/iter; left time: 1027.8934s
	iters: 400, epoch: 7 | loss: 0.0139499
	speed: 0.0268s/iter; left time: 1171.4500s
Epoch: 7 cost time: 12.55328917503357
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1031946
	speed: 0.1459s/iter; left time: 6350.7339s
	iters: 200, epoch: 8 | loss: 0.0035170
	speed: 0.0287s/iter; left time: 1247.2105s
	iters: 300, epoch: 8 | loss: 0.0372977
	speed: 0.0263s/iter; left time: 1138.0355s
	iters: 400, epoch: 8 | loss: 0.0016770
	speed: 0.0272s/iter; left time: 1177.0826s
Epoch: 8 cost time: 13.06638503074646
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0029719
	speed: 0.1432s/iter; left time: 6163.5716s
	iters: 200, epoch: 9 | loss: 0.0858868
	speed: 0.0273s/iter; left time: 1173.1653s
	iters: 300, epoch: 9 | loss: 0.0004793
	speed: 0.0280s/iter; left time: 1201.1779s
	iters: 400, epoch: 9 | loss: 0.0405707
	speed: 0.0277s/iter; left time: 1183.4375s
Epoch: 9 cost time: 13.40834665298462
Epoch: 9, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0013875
	speed: 0.1459s/iter; left time: 6210.5346s
	iters: 200, epoch: 10 | loss: 0.0032646
	speed: 0.0262s/iter; left time: 1112.9151s
	iters: 300, epoch: 10 | loss: 0.0011037
	speed: 0.0276s/iter; left time: 1170.5493s
	iters: 400, epoch: 10 | loss: 0.0015081
	speed: 0.0280s/iter; left time: 1183.9564s
Epoch: 10 cost time: 13.186196565628052
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.971411 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0191272
	speed: 0.1337s/iter; left time: 5630.2268s
	iters: 200, epoch: 11 | loss: 0.0007287
	speed: 0.0283s/iter; left time: 1187.4503s
	iters: 300, epoch: 11 | loss: 0.0004653
	speed: 0.0304s/iter; left time: 1274.6334s
	iters: 400, epoch: 11 | loss: 0.2546860
	speed: 0.0280s/iter; left time: 1170.1627s
Epoch: 11 cost time: 13.699130773544312
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0012372
	speed: 0.1510s/iter; left time: 6286.4348s
	iters: 200, epoch: 12 | loss: 0.0626925
	speed: 0.0261s/iter; left time: 1082.3511s
	iters: 300, epoch: 12 | loss: 0.0000171
	speed: 0.0272s/iter; left time: 1129.0214s
	iters: 400, epoch: 12 | loss: 0.0198312
	speed: 0.0263s/iter; left time: 1085.4230s
Epoch: 12 cost time: 13.26519775390625
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0017863
	speed: 0.1438s/iter; left time: 5921.7961s
	iters: 200, epoch: 13 | loss: 0.0090742
	speed: 0.0280s/iter; left time: 1151.6980s
	iters: 300, epoch: 13 | loss: 0.1165273
	speed: 0.0282s/iter; left time: 1154.0329s
	iters: 400, epoch: 13 | loss: 0.0426321
	speed: 0.0309s/iter; left time: 1263.8533s
Epoch: 13 cost time: 14.008148431777954
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0002704
	speed: 0.1473s/iter; left time: 5994.2905s
	iters: 200, epoch: 14 | loss: 0.0085521
	speed: 0.0290s/iter; left time: 1178.5176s
	iters: 300, epoch: 14 | loss: 0.0022303
	speed: 0.0285s/iter; left time: 1153.5655s
	iters: 400, epoch: 14 | loss: 0.0467374
	speed: 0.0267s/iter; left time: 1078.8031s
Epoch: 14 cost time: 13.37695598602295
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0081111
	speed: 0.1473s/iter; left time: 5927.8620s
	iters: 200, epoch: 15 | loss: 0.0154053
	speed: 0.0257s/iter; left time: 1030.1150s
	iters: 300, epoch: 15 | loss: 0.0014943
	speed: 0.0266s/iter; left time: 1065.2765s
	iters: 400, epoch: 15 | loss: 0.0009655
	speed: 0.0242s/iter; left time: 965.7138s
Epoch: 15 cost time: 12.679057598114014
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0059446
	speed: 0.1460s/iter; left time: 5807.1957s
	iters: 200, epoch: 16 | loss: 0.0475648
	speed: 0.0256s/iter; left time: 1013.8801s
	iters: 300, epoch: 16 | loss: 0.0038802
	speed: 0.0256s/iter; left time: 1011.1608s
	iters: 400, epoch: 16 | loss: 0.0002453
	speed: 0.0251s/iter; left time: 992.5087s
Epoch: 16 cost time: 12.570189714431763
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000434
	speed: 0.1451s/iter; left time: 5702.0291s
	iters: 200, epoch: 17 | loss: 0.0929912
	speed: 0.0264s/iter; left time: 1033.5251s
	iters: 300, epoch: 17 | loss: 0.0414494
	speed: 0.0288s/iter; left time: 1124.7878s
	iters: 400, epoch: 17 | loss: 0.0425420
	speed: 0.0266s/iter; left time: 1038.9254s
Epoch: 17 cost time: 13.175581932067871
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0049064
	speed: 0.1407s/iter; left time: 5464.5918s
	iters: 200, epoch: 18 | loss: 0.0009121
	speed: 0.0269s/iter; left time: 1041.2261s
	iters: 300, epoch: 18 | loss: 0.0004652
	speed: 0.0259s/iter; left time: 998.6893s
	iters: 400, epoch: 18 | loss: 0.0001352
	speed: 0.0262s/iter; left time: 1009.2265s
Epoch: 18 cost time: 12.999237775802612
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0000398
	speed: 0.1507s/iter; left time: 5778.9818s
	iters: 200, epoch: 19 | loss: 0.0048112
	speed: 0.0255s/iter; left time: 976.7709s
	iters: 300, epoch: 19 | loss: 0.0011545
	speed: 0.0274s/iter; left time: 1044.5245s
	iters: 400, epoch: 19 | loss: 0.0021933
	speed: 0.0282s/iter; left time: 1073.2190s
Epoch: 19 cost time: 13.385465383529663
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0026549
	speed: 0.1486s/iter; left time: 5630.5978s
	iters: 200, epoch: 20 | loss: 0.0031843
	speed: 0.0306s/iter; left time: 1156.5943s
	iters: 300, epoch: 20 | loss: 0.0157028
	speed: 0.0311s/iter; left time: 1170.9894s
	iters: 400, epoch: 20 | loss: 0.0081599
	speed: 0.0288s/iter; left time: 1081.2622s
Epoch: 20 cost time: 13.84186601638794
Epoch: 20, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 419362
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7730898
	speed: 0.0482s/iter; left time: 2257.9220s
	iters: 200, epoch: 1 | loss: 0.2398652
	speed: 0.0282s/iter; left time: 1316.8542s
	iters: 300, epoch: 1 | loss: 0.0618228
	speed: 0.0238s/iter; left time: 1109.0352s
	iters: 400, epoch: 1 | loss: 0.2498417
	speed: 0.0262s/iter; left time: 1218.2010s
Epoch: 1 cost time: 14.52580976486206
Epoch: 1, Steps: 469 | Train Loss: 0.461 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (inf --> -0.952256).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0440173
	speed: 0.1411s/iter; left time: 6538.7212s
	iters: 200, epoch: 2 | loss: 0.0609170
	speed: 0.0271s/iter; left time: 1254.4791s
	iters: 300, epoch: 2 | loss: 0.0128076
	speed: 0.0265s/iter; left time: 1220.6420s
	iters: 400, epoch: 2 | loss: 0.0289864
	speed: 0.0272s/iter; left time: 1250.7428s
Epoch: 2 cost time: 13.075923204421997
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0169458
	speed: 0.1411s/iter; left time: 6472.9654s
	iters: 200, epoch: 3 | loss: 0.0378606
	speed: 0.0263s/iter; left time: 1203.0483s
	iters: 300, epoch: 3 | loss: 0.1625735
	speed: 0.0280s/iter; left time: 1280.4228s
	iters: 400, epoch: 3 | loss: 0.0338203
	speed: 0.0285s/iter; left time: 1300.5802s
Epoch: 3 cost time: 12.987483978271484
Epoch: 3, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.952256 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0528911
	speed: 0.1393s/iter; left time: 6324.5154s
	iters: 200, epoch: 4 | loss: 0.0689013
	speed: 0.0278s/iter; left time: 1258.9016s
	iters: 300, epoch: 4 | loss: 0.0097697
	speed: 0.0258s/iter; left time: 1166.3948s
	iters: 400, epoch: 4 | loss: 0.0080936
	speed: 0.0251s/iter; left time: 1132.0356s
Epoch: 4 cost time: 12.434685945510864
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
Validation loss decreased (-0.965407 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0844732
	speed: 0.1430s/iter; left time: 6422.4994s
	iters: 200, epoch: 5 | loss: 0.0041312
	speed: 0.0267s/iter; left time: 1196.9500s
	iters: 300, epoch: 5 | loss: 0.0022982
	speed: 0.0262s/iter; left time: 1169.7845s
	iters: 400, epoch: 5 | loss: 0.0125203
	speed: 0.0264s/iter; left time: 1178.2726s
Epoch: 5 cost time: 12.844220638275146
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0002629
	speed: 0.1408s/iter; left time: 6258.2519s
	iters: 200, epoch: 6 | loss: 0.1210723
	speed: 0.0238s/iter; left time: 1055.4758s
	iters: 300, epoch: 6 | loss: 0.0544492
	speed: 0.0260s/iter; left time: 1149.0444s
	iters: 400, epoch: 6 | loss: 0.0163361
	speed: 0.0262s/iter; left time: 1156.6913s
Epoch: 6 cost time: 12.38790488243103
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971411).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0057601
	speed: 0.1238s/iter; left time: 5446.6783s
	iters: 200, epoch: 7 | loss: 0.0037056
	speed: 0.0219s/iter; left time: 960.9560s
	iters: 300, epoch: 7 | loss: 0.0000979
	speed: 0.0269s/iter; left time: 1177.6438s
	iters: 400, epoch: 7 | loss: 0.0134799
	speed: 0.0270s/iter; left time: 1178.3968s
Epoch: 7 cost time: 11.957145929336548
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2501522
	speed: 0.1356s/iter; left time: 5902.8205s
	iters: 200, epoch: 8 | loss: 0.0109864
	speed: 0.0270s/iter; left time: 1172.4838s
	iters: 300, epoch: 8 | loss: 0.0004441
	speed: 0.0253s/iter; left time: 1095.0742s
	iters: 400, epoch: 8 | loss: 0.0010392
	speed: 0.0264s/iter; left time: 1141.2735s
Epoch: 8 cost time: 12.623790502548218
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0038612
	speed: 0.1387s/iter; left time: 5970.2388s
	iters: 200, epoch: 9 | loss: 0.0355985
	speed: 0.0261s/iter; left time: 1119.1192s
	iters: 300, epoch: 9 | loss: 0.0006371
	speed: 0.0264s/iter; left time: 1132.5609s
	iters: 400, epoch: 9 | loss: 0.0144243
	speed: 0.0254s/iter; left time: 1085.8925s
Epoch: 9 cost time: 12.586370706558228
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.971411 --> -0.977415).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0129995
	speed: 0.1368s/iter; left time: 5826.5693s
	iters: 200, epoch: 10 | loss: 0.0078717
	speed: 0.0252s/iter; left time: 1072.2900s
	iters: 300, epoch: 10 | loss: 0.0011861
	speed: 0.0249s/iter; left time: 1053.9680s
	iters: 400, epoch: 10 | loss: 0.0017584
	speed: 0.0296s/iter; left time: 1249.7788s
Epoch: 10 cost time: 12.917254447937012
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.977415 --> -0.979702).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0607026
	speed: 0.1433s/iter; left time: 6035.5759s
	iters: 200, epoch: 11 | loss: 0.0067779
	speed: 0.0270s/iter; left time: 1133.0418s
	iters: 300, epoch: 11 | loss: 0.0000670
	speed: 0.0265s/iter; left time: 1111.8921s
	iters: 400, epoch: 11 | loss: 0.0043529
	speed: 0.0264s/iter; left time: 1101.8077s
Epoch: 11 cost time: 12.86550498008728
Epoch: 11, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.962 Test Loss: 0.215 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0011163
	speed: 0.1443s/iter; left time: 6008.5802s
	iters: 200, epoch: 12 | loss: 0.0001571
	speed: 0.0242s/iter; left time: 1007.2990s
	iters: 300, epoch: 12 | loss: 0.0000228
	speed: 0.0242s/iter; left time: 1003.8040s
	iters: 400, epoch: 12 | loss: 0.0001986
	speed: 0.0249s/iter; left time: 1027.7607s
Epoch: 12 cost time: 12.286330938339233
Epoch: 12, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0026896
	speed: 0.1402s/iter; left time: 5772.1420s
	iters: 200, epoch: 13 | loss: 0.0345877
	speed: 0.0247s/iter; left time: 1013.8201s
	iters: 300, epoch: 13 | loss: 0.2504053
	speed: 0.0255s/iter; left time: 1045.8605s
	iters: 400, epoch: 13 | loss: 0.0003486
	speed: 0.0260s/iter; left time: 1063.2253s
Epoch: 13 cost time: 12.56021785736084
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000639
	speed: 0.1370s/iter; left time: 5576.9441s
	iters: 200, epoch: 14 | loss: 0.0007226
	speed: 0.0240s/iter; left time: 972.9808s
	iters: 300, epoch: 14 | loss: 0.0001023
	speed: 0.0272s/iter; left time: 1099.7487s
	iters: 400, epoch: 14 | loss: 0.0009176
	speed: 0.0279s/iter; left time: 1125.2742s
Epoch: 14 cost time: 12.629728078842163
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0213728
	speed: 0.1382s/iter; left time: 5560.0747s
	iters: 200, epoch: 15 | loss: 0.1317226
	speed: 0.0283s/iter; left time: 1137.2223s
	iters: 300, epoch: 15 | loss: 0.0169810
	speed: 0.0254s/iter; left time: 1018.7064s
	iters: 400, epoch: 15 | loss: 0.0006817
	speed: 0.0245s/iter; left time: 979.3382s
Epoch: 15 cost time: 12.628976821899414
Epoch: 15, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0131713
	speed: 0.1377s/iter; left time: 5477.4739s
	iters: 200, epoch: 16 | loss: 0.0009457
	speed: 0.0260s/iter; left time: 1030.0717s
	iters: 300, epoch: 16 | loss: 0.0000853
	speed: 0.0261s/iter; left time: 1034.0549s
	iters: 400, epoch: 16 | loss: 0.0000049
	speed: 0.0259s/iter; left time: 1021.0462s
Epoch: 16 cost time: 12.80719804763794
Epoch: 16, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000263
	speed: 0.1402s/iter; left time: 5509.6069s
	iters: 200, epoch: 17 | loss: 0.0001410
	speed: 0.0256s/iter; left time: 1001.8242s
	iters: 300, epoch: 17 | loss: 0.1510781
	speed: 0.0261s/iter; left time: 1020.1394s
	iters: 400, epoch: 17 | loss: 0.0211414
	speed: 0.0275s/iter; left time: 1071.4627s
Epoch: 17 cost time: 12.884938478469849
Epoch: 17, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0002284
	speed: 0.1414s/iter; left time: 5490.6903s
	iters: 200, epoch: 18 | loss: 0.0024879
	speed: 0.0281s/iter; left time: 1088.8632s
	iters: 300, epoch: 18 | loss: 0.0000144
	speed: 0.0266s/iter; left time: 1028.1884s
	iters: 400, epoch: 18 | loss: 0.0018371
	speed: 0.0248s/iter; left time: 954.7466s
Epoch: 18 cost time: 12.807555437088013
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0395903
	speed: 0.1240s/iter; left time: 4755.7117s
	iters: 200, epoch: 19 | loss: 0.0353919
	speed: 0.0235s/iter; left time: 898.7538s
	iters: 300, epoch: 19 | loss: 0.0011701
	speed: 0.0252s/iter; left time: 962.6810s
	iters: 400, epoch: 19 | loss: 0.0027315
	speed: 0.0265s/iter; left time: 1006.7897s
Epoch: 19 cost time: 12.044121980667114
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0063524
	speed: 0.1435s/iter; left time: 5437.2273s
	iters: 200, epoch: 20 | loss: 0.0022656
	speed: 0.0272s/iter; left time: 1026.9336s
	iters: 300, epoch: 20 | loss: 0.0037641
	speed: 0.0287s/iter; left time: 1079.9029s
	iters: 400, epoch: 20 | loss: 0.0004999
	speed: 0.0278s/iter; left time: 1045.7528s
Epoch: 20 cost time: 13.6627037525177
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 419362
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7961194
	speed: 0.0399s/iter; left time: 1866.6527s
	iters: 200, epoch: 1 | loss: 0.2365183
	speed: 0.0211s/iter; left time: 983.8538s
	iters: 300, epoch: 1 | loss: 0.0515343
	speed: 0.0205s/iter; left time: 955.8914s
	iters: 400, epoch: 1 | loss: 0.1878485
	speed: 0.0199s/iter; left time: 926.2531s
Epoch: 1 cost time: 11.620233535766602
Epoch: 1, Steps: 469 | Train Loss: 0.476 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (inf --> -0.956259).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0340366
	speed: 0.1338s/iter; left time: 6197.6060s
	iters: 200, epoch: 2 | loss: 0.1675969
	speed: 0.0255s/iter; left time: 1179.7903s
	iters: 300, epoch: 2 | loss: 0.0682124
	speed: 0.0260s/iter; left time: 1199.4389s
	iters: 400, epoch: 2 | loss: 0.0443634
	speed: 0.0253s/iter; left time: 1166.1887s
Epoch: 2 cost time: 12.587958812713623
Epoch: 2, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.956259 --> -0.959975).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057758
	speed: 0.1444s/iter; left time: 6623.5378s
	iters: 200, epoch: 3 | loss: 0.0071110
	speed: 0.0247s/iter; left time: 1131.9870s
	iters: 300, epoch: 3 | loss: 0.0311368
	speed: 0.0255s/iter; left time: 1162.4672s
	iters: 400, epoch: 3 | loss: 0.1567302
	speed: 0.0269s/iter; left time: 1226.1945s
Epoch: 3 cost time: 12.692684888839722
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.959975 --> -0.972269).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1060893
	speed: 0.1386s/iter; left time: 6292.9564s
	iters: 200, epoch: 4 | loss: 0.2827120
	speed: 0.0293s/iter; left time: 1327.7901s
	iters: 300, epoch: 4 | loss: 0.0038962
	speed: 0.0263s/iter; left time: 1189.7385s
	iters: 400, epoch: 4 | loss: 0.0362813
	speed: 0.0252s/iter; left time: 1136.8430s
Epoch: 4 cost time: 12.963481187820435
Epoch: 4, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0648896
	speed: 0.1404s/iter; left time: 6307.7107s
	iters: 200, epoch: 5 | loss: 0.0096437
	speed: 0.0260s/iter; left time: 1165.1964s
	iters: 300, epoch: 5 | loss: 0.0034539
	speed: 0.0238s/iter; left time: 1062.7404s
	iters: 400, epoch: 5 | loss: 0.0266872
	speed: 0.0250s/iter; left time: 1114.6427s
Epoch: 5 cost time: 12.315413236618042
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0015620
	speed: 0.1417s/iter; left time: 6299.9532s
	iters: 200, epoch: 6 | loss: 0.0696405
	speed: 0.0237s/iter; left time: 1050.7804s
	iters: 300, epoch: 6 | loss: 0.0068709
	speed: 0.0235s/iter; left time: 1041.1843s
	iters: 400, epoch: 6 | loss: 0.0823586
	speed: 0.0239s/iter; left time: 1056.5942s
Epoch: 6 cost time: 11.833573579788208
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.972269 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0012178
	speed: 0.1398s/iter; left time: 6150.4477s
	iters: 200, epoch: 7 | loss: 0.0001019
	speed: 0.0243s/iter; left time: 1065.0520s
	iters: 300, epoch: 7 | loss: 0.0199040
	speed: 0.0275s/iter; left time: 1202.8693s
	iters: 400, epoch: 7 | loss: 0.0023161
	speed: 0.0280s/iter; left time: 1225.4181s
Epoch: 7 cost time: 12.681257963180542
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0129502
	speed: 0.1401s/iter; left time: 6095.1370s
	iters: 200, epoch: 8 | loss: 0.0219260
	speed: 0.0295s/iter; left time: 1282.0499s
	iters: 300, epoch: 8 | loss: 0.0308271
	speed: 0.0269s/iter; left time: 1165.0578s
	iters: 400, epoch: 8 | loss: 0.0001508
	speed: 0.0263s/iter; left time: 1136.6284s
Epoch: 8 cost time: 13.326586246490479
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0035985
	speed: 0.1407s/iter; left time: 6055.5605s
	iters: 200, epoch: 9 | loss: 0.0029964
	speed: 0.0232s/iter; left time: 998.3125s
	iters: 300, epoch: 9 | loss: 0.0002806
	speed: 0.0242s/iter; left time: 1037.6908s
	iters: 400, epoch: 9 | loss: 0.4553210
	speed: 0.0242s/iter; left time: 1035.1400s
Epoch: 9 cost time: 12.246257781982422
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.974270).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0002741
	speed: 0.1515s/iter; left time: 6451.2825s
	iters: 200, epoch: 10 | loss: 0.0014600
	speed: 0.0263s/iter; left time: 1115.6771s
	iters: 300, epoch: 10 | loss: 0.0030160
	speed: 0.0282s/iter; left time: 1195.9585s
	iters: 400, epoch: 10 | loss: 0.0381369
	speed: 0.0283s/iter; left time: 1196.4601s
Epoch: 10 cost time: 13.178624868392944
Epoch: 10, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0009023
	speed: 0.1379s/iter; left time: 5805.1522s
	iters: 200, epoch: 11 | loss: 0.0336720
	speed: 0.0275s/iter; left time: 1156.4884s
	iters: 300, epoch: 11 | loss: 0.0002429
	speed: 0.0248s/iter; left time: 1040.7014s
	iters: 400, epoch: 11 | loss: 0.0003983
	speed: 0.0254s/iter; left time: 1060.0653s
Epoch: 11 cost time: 12.476651430130005
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975413).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0001269
	speed: 0.1350s/iter; left time: 5622.4481s
	iters: 200, epoch: 12 | loss: 0.0164490
	speed: 0.0241s/iter; left time: 1000.3134s
	iters: 300, epoch: 12 | loss: 0.0000204
	speed: 0.0237s/iter; left time: 984.0806s
	iters: 400, epoch: 12 | loss: 0.0003131
	speed: 0.0258s/iter; left time: 1065.3747s
Epoch: 12 cost time: 12.135201930999756
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0176919
	speed: 0.1399s/iter; left time: 5760.4855s
	iters: 200, epoch: 13 | loss: 0.0000344
	speed: 0.0250s/iter; left time: 1027.5618s
	iters: 300, epoch: 13 | loss: 0.0461475
	speed: 0.0260s/iter; left time: 1064.6264s
	iters: 400, epoch: 13 | loss: 0.0003517
	speed: 0.0266s/iter; left time: 1088.8647s
Epoch: 13 cost time: 12.466214895248413
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000325
	speed: 0.1275s/iter; left time: 5191.7201s
	iters: 200, epoch: 14 | loss: 0.0004179
	speed: 0.0254s/iter; left time: 1031.7703s
	iters: 300, epoch: 14 | loss: 0.0001303
	speed: 0.0227s/iter; left time: 918.7774s
	iters: 400, epoch: 14 | loss: 0.0015046
	speed: 0.0230s/iter; left time: 928.8412s
Epoch: 14 cost time: 11.612152814865112
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0040495
	speed: 0.1407s/iter; left time: 5662.9053s
	iters: 200, epoch: 15 | loss: 0.0095897
	speed: 0.0244s/iter; left time: 978.5132s
	iters: 300, epoch: 15 | loss: 0.0000774
	speed: 0.0249s/iter; left time: 995.3625s
	iters: 400, epoch: 15 | loss: 0.0000072
	speed: 0.0248s/iter; left time: 990.9393s
Epoch: 15 cost time: 12.084985971450806
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0014378
	speed: 0.1394s/iter; left time: 5542.8470s
	iters: 200, epoch: 16 | loss: 0.0043695
	speed: 0.0237s/iter; left time: 938.2510s
	iters: 300, epoch: 16 | loss: 0.0007015
	speed: 0.0267s/iter; left time: 1057.0551s
	iters: 400, epoch: 16 | loss: 0.0000032
	speed: 0.0265s/iter; left time: 1046.5067s
Epoch: 16 cost time: 12.786819219589233
Epoch: 16, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
Validation loss decreased (-0.975413 --> -0.978272).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0162249
	speed: 0.1307s/iter; left time: 5136.7045s
	iters: 200, epoch: 17 | loss: 0.0000009
	speed: 0.0250s/iter; left time: 978.4167s
	iters: 300, epoch: 17 | loss: 0.0013754
	speed: 0.0278s/iter; left time: 1087.3991s
	iters: 400, epoch: 17 | loss: 0.0086901
	speed: 0.0296s/iter; left time: 1154.0160s
Epoch: 17 cost time: 13.140419006347656
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.978272 --> -0.982560).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000095
	speed: 0.1479s/iter; left time: 5743.5135s
	iters: 200, epoch: 18 | loss: 0.0000038
	speed: 0.0305s/iter; left time: 1179.8293s
	iters: 300, epoch: 18 | loss: 0.0000572
	speed: 0.0268s/iter; left time: 1035.2331s
	iters: 400, epoch: 18 | loss: 0.0000378
	speed: 0.0268s/iter; left time: 1030.9459s
Epoch: 18 cost time: 13.724348545074463
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.982560 --> -0.983418).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0001386
	speed: 0.1470s/iter; left time: 5637.4961s
	iters: 200, epoch: 19 | loss: 0.0002372
	speed: 0.0268s/iter; left time: 1023.8859s
	iters: 300, epoch: 19 | loss: 0.0011130
	speed: 0.0253s/iter; left time: 964.2146s
	iters: 400, epoch: 19 | loss: 0.0000338
	speed: 0.0258s/iter; left time: 983.1291s
Epoch: 19 cost time: 12.74010443687439
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.966 Test Loss: 0.200 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0002371
	speed: 0.1430s/iter; left time: 5417.0068s
	iters: 200, epoch: 20 | loss: 0.0669867
	speed: 0.0245s/iter; left time: 925.5005s
	iters: 300, epoch: 20 | loss: 0.0027433
	speed: 0.0261s/iter; left time: 984.8699s
	iters: 400, epoch: 20 | loss: 0.0003509
	speed: 0.0296s/iter; left time: 1113.9769s
Epoch: 20 cost time: 12.902545690536499
Epoch: 20, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0006452
	speed: 0.1389s/iter; left time: 5197.4059s
	iters: 200, epoch: 21 | loss: 0.0096607
	speed: 0.0265s/iter; left time: 989.6546s
	iters: 300, epoch: 21 | loss: 0.1961525
	speed: 0.0274s/iter; left time: 1018.8980s
	iters: 400, epoch: 21 | loss: 0.0050094
	speed: 0.0258s/iter; left time: 957.9398s
Epoch: 21 cost time: 12.70202922821045
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0001185
	speed: 0.1419s/iter; left time: 5244.3573s
	iters: 200, epoch: 22 | loss: 0.0001197
	speed: 0.0263s/iter; left time: 967.8693s
	iters: 300, epoch: 22 | loss: 0.0000021
	speed: 0.0262s/iter; left time: 961.3510s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0262s/iter; left time: 959.5923s
Epoch: 22 cost time: 12.928166627883911
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0000489
	speed: 0.1423s/iter; left time: 5191.7213s
	iters: 200, epoch: 23 | loss: 0.0013655
	speed: 0.0271s/iter; left time: 985.2915s
	iters: 300, epoch: 23 | loss: 0.0000104
	speed: 0.0273s/iter; left time: 990.3418s
	iters: 400, epoch: 23 | loss: 0.0001494
	speed: 0.0288s/iter; left time: 1043.5264s
Epoch: 23 cost time: 13.413523197174072
Epoch: 23, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.194 Vali Acc: 0.973 Test Loss: 0.194 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000195
	speed: 0.1412s/iter; left time: 5085.7236s
	iters: 200, epoch: 24 | loss: 0.0001448
	speed: 0.0268s/iter; left time: 963.7552s
	iters: 300, epoch: 24 | loss: 0.0238742
	speed: 0.0261s/iter; left time: 933.1096s
	iters: 400, epoch: 24 | loss: 0.0020911
	speed: 0.0255s/iter; left time: 911.4582s
Epoch: 24 cost time: 12.787617444992065
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0020311
	speed: 0.1549s/iter; left time: 5505.5621s
	iters: 200, epoch: 25 | loss: 0.0000039
	speed: 0.0264s/iter; left time: 937.1764s
	iters: 300, epoch: 25 | loss: 0.0052864
	speed: 0.0250s/iter; left time: 885.1161s
	iters: 400, epoch: 25 | loss: 0.0204707
	speed: 0.0262s/iter; left time: 921.8551s
Epoch: 25 cost time: 12.985801935195923
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.979 Test Loss: 0.203 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.1665715
	speed: 0.1429s/iter; left time: 5012.5400s
	iters: 200, epoch: 26 | loss: 0.0000005
	speed: 0.0266s/iter; left time: 931.0854s
	iters: 300, epoch: 26 | loss: 0.1412841
	speed: 0.0272s/iter; left time: 946.9748s
	iters: 400, epoch: 26 | loss: 0.0000059
	speed: 0.0308s/iter; left time: 1070.5206s
Epoch: 26 cost time: 13.672883033752441
Epoch: 26, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.0000022
	speed: 0.1420s/iter; left time: 4913.4721s
	iters: 200, epoch: 27 | loss: 0.0000208
	speed: 0.0290s/iter; left time: 1002.3013s
	iters: 300, epoch: 27 | loss: 0.5951232
	speed: 0.0290s/iter; left time: 997.0418s
	iters: 400, epoch: 27 | loss: 0.0176033
	speed: 0.0281s/iter; left time: 964.0835s
Epoch: 27 cost time: 13.560051679611206
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0000588
	speed: 0.1453s/iter; left time: 4959.4497s
	iters: 200, epoch: 28 | loss: 0.0072593
	speed: 0.0247s/iter; left time: 839.9367s
	iters: 300, epoch: 28 | loss: 0.0021129
	speed: 0.0247s/iter; left time: 839.1407s
	iters: 400, epoch: 28 | loss: 0.0001535
	speed: 0.0246s/iter; left time: 830.9869s
Epoch: 28 cost time: 11.97493052482605
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.177 Vali Acc: 0.979 Test Loss: 0.177 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 419362
model size : 6.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5483645
	speed: 0.0489s/iter; left time: 2286.5546s
	iters: 200, epoch: 1 | loss: 0.2832705
	speed: 0.0256s/iter; left time: 1194.1599s
	iters: 300, epoch: 1 | loss: 0.0658809
	speed: 0.0273s/iter; left time: 1272.5004s
	iters: 400, epoch: 1 | loss: 0.1446373
	speed: 0.0259s/iter; left time: 1204.6702s
Epoch: 1 cost time: 14.682536125183105
Epoch: 1, Steps: 469 | Train Loss: 0.473 Vali Loss: 0.209 Vali Acc: 0.945 Test Loss: 0.209 Test Acc: 0.945
Validation loss decreased (inf --> -0.945109).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0069778
	speed: 0.1421s/iter; left time: 6584.7191s
	iters: 200, epoch: 2 | loss: 0.1798818
	speed: 0.0269s/iter; left time: 1243.4199s
	iters: 300, epoch: 2 | loss: 0.0835237
	speed: 0.0273s/iter; left time: 1260.8899s
	iters: 400, epoch: 2 | loss: 0.0191483
	speed: 0.0279s/iter; left time: 1285.8231s
Epoch: 2 cost time: 13.236718893051147
Epoch: 2, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.945109 --> -0.953400).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0211166
	speed: 0.1424s/iter; left time: 6531.1605s
	iters: 200, epoch: 3 | loss: 0.1099740
	speed: 0.0285s/iter; left time: 1304.1091s
	iters: 300, epoch: 3 | loss: 0.0122600
	speed: 0.0263s/iter; left time: 1201.3034s
	iters: 400, epoch: 3 | loss: 0.4422497
	speed: 0.0259s/iter; left time: 1178.3266s
Epoch: 3 cost time: 13.059756755828857
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.953400 --> -0.960547).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0072357
	speed: 0.1458s/iter; left time: 6619.5002s
	iters: 200, epoch: 4 | loss: 0.0063995
	speed: 0.0290s/iter; left time: 1311.3217s
	iters: 300, epoch: 4 | loss: 0.0150112
	speed: 0.0280s/iter; left time: 1265.7540s
	iters: 400, epoch: 4 | loss: 0.4368437
	speed: 0.0266s/iter; left time: 1199.7985s
Epoch: 4 cost time: 13.644057512283325
Epoch: 4, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.178 Vali Acc: 0.955 Test Loss: 0.178 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0343503
	speed: 0.1499s/iter; left time: 6735.3024s
	iters: 200, epoch: 5 | loss: 0.0021918
	speed: 0.0282s/iter; left time: 1262.3681s
	iters: 300, epoch: 5 | loss: 0.0346679
	speed: 0.0296s/iter; left time: 1324.0815s
	iters: 400, epoch: 5 | loss: 0.0012292
	speed: 0.0307s/iter; left time: 1370.8200s
Epoch: 5 cost time: 14.244826316833496
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.960547 --> -0.973698).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2224956
	speed: 0.1444s/iter; left time: 6419.3514s
	iters: 200, epoch: 6 | loss: 0.0183210
	speed: 0.0283s/iter; left time: 1254.9938s
	iters: 300, epoch: 6 | loss: 0.0020066
	speed: 0.0274s/iter; left time: 1211.0674s
	iters: 400, epoch: 6 | loss: 0.0975677
	speed: 0.0285s/iter; left time: 1257.1817s
Epoch: 6 cost time: 13.530278444290161
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0005048
	speed: 0.1509s/iter; left time: 6637.4598s
	iters: 200, epoch: 7 | loss: 0.0873303
	speed: 0.0266s/iter; left time: 1165.4584s
	iters: 300, epoch: 7 | loss: 0.0019344
	speed: 0.0268s/iter; left time: 1171.5431s
	iters: 400, epoch: 7 | loss: 0.0113023
	speed: 0.0264s/iter; left time: 1154.9056s
Epoch: 7 cost time: 13.119237184524536
Epoch: 7, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0012728
	speed: 0.1471s/iter; left time: 6399.9605s
	iters: 200, epoch: 8 | loss: 0.0222317
	speed: 0.0282s/iter; left time: 1225.3746s
	iters: 300, epoch: 8 | loss: 0.0228514
	speed: 0.0264s/iter; left time: 1144.2498s
	iters: 400, epoch: 8 | loss: 0.0102165
	speed: 0.0271s/iter; left time: 1172.3771s
Epoch: 8 cost time: 13.22123122215271
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0032451
	speed: 0.1462s/iter; left time: 6295.4515s
	iters: 200, epoch: 9 | loss: 0.0409565
	speed: 0.0284s/iter; left time: 1220.8994s
	iters: 300, epoch: 9 | loss: 0.0009325
	speed: 0.0266s/iter; left time: 1139.2084s
	iters: 400, epoch: 9 | loss: 0.0018366
	speed: 0.0242s/iter; left time: 1032.5944s
Epoch: 9 cost time: 13.07180905342102
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0050113
	speed: 0.1420s/iter; left time: 6045.6932s
	iters: 200, epoch: 10 | loss: 0.0105801
	speed: 0.0243s/iter; left time: 1031.5312s
	iters: 300, epoch: 10 | loss: 0.0989021
	speed: 0.0233s/iter; left time: 986.9721s
	iters: 400, epoch: 10 | loss: 0.0014000
	speed: 0.0232s/iter; left time: 979.7948s
Epoch: 10 cost time: 11.468842029571533
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.1475497
	speed: 0.1387s/iter; left time: 5841.4746s
	iters: 200, epoch: 11 | loss: 0.1308715
	speed: 0.0265s/iter; left time: 1111.5244s
	iters: 300, epoch: 11 | loss: 0.0010231
	speed: 0.0257s/iter; left time: 1075.5577s
	iters: 400, epoch: 11 | loss: 0.0007877
	speed: 0.0272s/iter; left time: 1135.2295s
Epoch: 11 cost time: 13.006935119628906
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0012584
	speed: 0.1382s/iter; left time: 5755.9877s
	iters: 200, epoch: 12 | loss: 0.0182521
	speed: 0.0287s/iter; left time: 1193.0273s
	iters: 300, epoch: 12 | loss: 0.0005376
	speed: 0.0281s/iter; left time: 1162.5263s
	iters: 400, epoch: 12 | loss: 0.2569838
	speed: 0.0261s/iter; left time: 1080.9617s
Epoch: 12 cost time: 13.319239377975464
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.973698 --> -0.977986).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0019903
	speed: 0.1476s/iter; left time: 6078.0579s
	iters: 200, epoch: 13 | loss: 0.0066267
	speed: 0.0270s/iter; left time: 1109.5483s
	iters: 300, epoch: 13 | loss: 0.0098409
	speed: 0.0252s/iter; left time: 1034.2370s
	iters: 400, epoch: 13 | loss: 0.0044432
	speed: 0.0274s/iter; left time: 1119.0554s
Epoch: 13 cost time: 13.228763580322266
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0063457
	speed: 0.1511s/iter; left time: 6148.7236s
	iters: 200, epoch: 14 | loss: 0.0551943
	speed: 0.0248s/iter; left time: 1005.0251s
	iters: 300, epoch: 14 | loss: 0.0173293
	speed: 0.0256s/iter; left time: 1037.6793s
	iters: 400, epoch: 14 | loss: 0.0000205
	speed: 0.0278s/iter; left time: 1123.3097s
Epoch: 14 cost time: 12.61041784286499
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0002330
	speed: 0.1493s/iter; left time: 6007.1980s
	iters: 200, epoch: 15 | loss: 0.1398490
	speed: 0.0296s/iter; left time: 1186.5655s
	iters: 300, epoch: 15 | loss: 0.0037168
	speed: 0.0268s/iter; left time: 1072.5528s
	iters: 400, epoch: 15 | loss: 0.0000613
	speed: 0.0270s/iter; left time: 1080.0530s
Epoch: 15 cost time: 13.438595294952393
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.2348524
	speed: 0.1417s/iter; left time: 5634.6306s
	iters: 200, epoch: 16 | loss: 0.4674473
	speed: 0.0268s/iter; left time: 1063.4290s
	iters: 300, epoch: 16 | loss: 0.0641015
	speed: 0.0264s/iter; left time: 1044.6053s
	iters: 400, epoch: 16 | loss: 0.0023418
	speed: 0.0271s/iter; left time: 1070.7342s
Epoch: 16 cost time: 13.087449312210083
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0260876
	speed: 0.1413s/iter; left time: 5552.9034s
	iters: 200, epoch: 17 | loss: 0.0000097
	speed: 0.0257s/iter; left time: 1005.9090s
	iters: 300, epoch: 17 | loss: 0.0001058
	speed: 0.0260s/iter; left time: 1017.6720s
	iters: 400, epoch: 17 | loss: 0.1181069
	speed: 0.0276s/iter; left time: 1075.5223s
Epoch: 17 cost time: 12.719680309295654
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.977986 --> -0.982560).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5850553
	speed: 0.1305s/iter; left time: 5068.1541s
	iters: 200, epoch: 18 | loss: 0.0003758
	speed: 0.0286s/iter; left time: 1106.1274s
	iters: 300, epoch: 18 | loss: 0.0006524
	speed: 0.0288s/iter; left time: 1113.9690s
	iters: 400, epoch: 18 | loss: 0.0001911
	speed: 0.0267s/iter; left time: 1028.2577s
Epoch: 18 cost time: 13.016396522521973
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0010356
	speed: 0.1449s/iter; left time: 5559.3983s
	iters: 200, epoch: 19 | loss: 0.0010059
	speed: 0.0245s/iter; left time: 936.4713s
	iters: 300, epoch: 19 | loss: 0.1229559
	speed: 0.0261s/iter; left time: 995.0755s
	iters: 400, epoch: 19 | loss: 0.2164029
	speed: 0.0260s/iter; left time: 989.0216s
Epoch: 19 cost time: 12.542498588562012
Epoch: 19, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0072465
	speed: 0.1495s/iter; left time: 5663.8760s
	iters: 200, epoch: 20 | loss: 0.1253071
	speed: 0.0264s/iter; left time: 997.3672s
	iters: 300, epoch: 20 | loss: 0.0000567
	speed: 0.0245s/iter; left time: 924.8942s
	iters: 400, epoch: 20 | loss: 0.0029029
	speed: 0.0275s/iter; left time: 1032.8144s
Epoch: 20 cost time: 12.828385829925537
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.228 Vali Acc: 0.960 Test Loss: 0.228 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0000651
	speed: 0.1433s/iter; left time: 5362.3277s
	iters: 200, epoch: 21 | loss: 0.0008660
	speed: 0.0283s/iter; left time: 1054.9386s
	iters: 300, epoch: 21 | loss: 0.0012449
	speed: 0.0277s/iter; left time: 1029.4659s
	iters: 400, epoch: 21 | loss: 0.0001284
	speed: 0.0302s/iter; left time: 1119.5411s
Epoch: 21 cost time: 13.87283992767334
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0000710
	speed: 0.1479s/iter; left time: 5464.4261s
	iters: 200, epoch: 22 | loss: 0.0002504
	speed: 0.0283s/iter; left time: 1042.6121s
	iters: 300, epoch: 22 | loss: 0.0044551
	speed: 0.0265s/iter; left time: 973.0955s
	iters: 400, epoch: 22 | loss: 0.0000021
	speed: 0.0277s/iter; left time: 1014.9809s
Epoch: 22 cost time: 13.564313888549805
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.1218636
	speed: 0.1459s/iter; left time: 5323.6637s
	iters: 200, epoch: 23 | loss: 0.0018267
	speed: 0.0259s/iter; left time: 940.7299s
	iters: 300, epoch: 23 | loss: 0.0001821
	speed: 0.0284s/iter; left time: 1029.0202s
	iters: 400, epoch: 23 | loss: 0.6750830
	speed: 0.0280s/iter; left time: 1014.2489s
Epoch: 23 cost time: 13.322650909423828
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000847
	speed: 0.1461s/iter; left time: 5262.0074s
	iters: 200, epoch: 24 | loss: 0.0000103
	speed: 0.0258s/iter; left time: 926.3202s
	iters: 300, epoch: 24 | loss: 0.0023576
	speed: 0.0302s/iter; left time: 1082.7327s
	iters: 400, epoch: 24 | loss: 0.0000185
	speed: 0.0292s/iter; left time: 1042.4739s
Epoch: 24 cost time: 13.294913053512573
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0004882
	speed: 0.1398s/iter; left time: 4970.1653s
	iters: 200, epoch: 25 | loss: 0.0000067
	speed: 0.0252s/iter; left time: 892.2231s
	iters: 300, epoch: 25 | loss: 0.0047079
	speed: 0.0267s/iter; left time: 944.6189s
	iters: 400, epoch: 25 | loss: 0.0008802
	speed: 0.0266s/iter; left time: 939.0655s
Epoch: 25 cost time: 12.823755025863647
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0008438
	speed: 0.1418s/iter; left time: 4972.5217s
	iters: 200, epoch: 26 | loss: 0.0005141
	speed: 0.0264s/iter; left time: 925.0934s
	iters: 300, epoch: 26 | loss: 0.0577537
	speed: 0.0271s/iter; left time: 946.1343s
	iters: 400, epoch: 26 | loss: 0.0379410
	speed: 0.0256s/iter; left time: 889.1791s
Epoch: 26 cost time: 12.84247636795044
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0001123
	speed: 0.1434s/iter; left time: 4961.1102s
	iters: 200, epoch: 27 | loss: 0.0017036
	speed: 0.0275s/iter; left time: 948.1110s
	iters: 300, epoch: 27 | loss: 0.0006439
	speed: 0.0292s/iter; left time: 1004.2076s
	iters: 400, epoch: 27 | loss: 0.0002737
	speed: 0.0264s/iter; left time: 906.8346s
Epoch: 27 cost time: 13.312419891357422
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 288290
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6426986
	speed: 0.0491s/iter; left time: 2297.5953s
	iters: 200, epoch: 1 | loss: 0.3298810
	speed: 0.0263s/iter; left time: 1228.3397s
	iters: 300, epoch: 1 | loss: 0.0763924
	speed: 0.0261s/iter; left time: 1215.8993s
	iters: 400, epoch: 1 | loss: 0.1430077
	speed: 0.0272s/iter; left time: 1265.6400s
Epoch: 1 cost time: 14.811310768127441
Epoch: 1, Steps: 469 | Train Loss: 0.478 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
Validation loss decreased (inf --> -0.939678).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0093699
	speed: 0.1519s/iter; left time: 7036.3492s
	iters: 200, epoch: 2 | loss: 0.1004471
	speed: 0.0266s/iter; left time: 1229.9539s
	iters: 300, epoch: 2 | loss: 0.0676637
	speed: 0.0273s/iter; left time: 1257.1318s
	iters: 400, epoch: 2 | loss: 0.0090538
	speed: 0.0288s/iter; left time: 1323.4321s
Epoch: 2 cost time: 13.477782487869263
Epoch: 2, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
Validation loss decreased (-0.939678 --> -0.951113).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0088864
	speed: 0.1478s/iter; left time: 6780.0519s
	iters: 200, epoch: 3 | loss: 0.0772543
	speed: 0.0293s/iter; left time: 1338.5887s
	iters: 300, epoch: 3 | loss: 0.0238013
	speed: 0.0303s/iter; left time: 1382.6108s
	iters: 400, epoch: 3 | loss: 0.3991004
	speed: 0.0270s/iter; left time: 1230.4410s
Epoch: 3 cost time: 13.727520942687988
Epoch: 3, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.951113 --> -0.957974).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0458720
	speed: 0.1484s/iter; left time: 6738.7236s
	iters: 200, epoch: 4 | loss: 0.0087648
	speed: 0.0285s/iter; left time: 1289.9672s
	iters: 300, epoch: 4 | loss: 0.0043091
	speed: 0.0285s/iter; left time: 1287.3481s
	iters: 400, epoch: 4 | loss: 0.6688972
	speed: 0.0271s/iter; left time: 1221.3986s
Epoch: 4 cost time: 13.669849157333374
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.958 Test Loss: 0.174 Test Acc: 0.958
Validation loss decreased (-0.957974 --> -0.958260).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0451590
	speed: 0.1396s/iter; left time: 6270.6518s
	iters: 200, epoch: 5 | loss: 0.0483017
	speed: 0.0254s/iter; left time: 1139.6416s
	iters: 300, epoch: 5 | loss: 0.0057185
	speed: 0.0301s/iter; left time: 1347.8306s
	iters: 400, epoch: 5 | loss: 0.0114444
	speed: 0.0297s/iter; left time: 1324.4521s
Epoch: 5 cost time: 13.314316034317017
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.958260 --> -0.964835).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2287249
	speed: 0.1364s/iter; left time: 6064.8767s
	iters: 200, epoch: 6 | loss: 0.0024767
	speed: 0.0269s/iter; left time: 1193.2105s
	iters: 300, epoch: 6 | loss: 0.0030939
	speed: 0.0271s/iter; left time: 1199.7287s
	iters: 400, epoch: 6 | loss: 0.0004458
	speed: 0.0259s/iter; left time: 1145.0036s
Epoch: 6 cost time: 12.723699569702148
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0006768
	speed: 0.1444s/iter; left time: 6353.1666s
	iters: 200, epoch: 7 | loss: 0.0267207
	speed: 0.0270s/iter; left time: 1186.6989s
	iters: 300, epoch: 7 | loss: 0.0040411
	speed: 0.0250s/iter; left time: 1093.7834s
	iters: 400, epoch: 7 | loss: 0.0573495
	speed: 0.0253s/iter; left time: 1106.8407s
Epoch: 7 cost time: 12.534170150756836
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0159152
	speed: 0.1399s/iter; left time: 6086.0023s
	iters: 200, epoch: 8 | loss: 0.0192827
	speed: 0.0274s/iter; left time: 1191.1493s
	iters: 300, epoch: 8 | loss: 0.0933345
	speed: 0.0270s/iter; left time: 1167.8932s
	iters: 400, epoch: 8 | loss: 0.0040211
	speed: 0.0304s/iter; left time: 1315.8596s
Epoch: 8 cost time: 13.551340818405151
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.964835 --> -0.969696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0209066
	speed: 0.1415s/iter; left time: 6091.4801s
	iters: 200, epoch: 9 | loss: 0.3300758
	speed: 0.0276s/iter; left time: 1184.0348s
	iters: 300, epoch: 9 | loss: 0.0012263
	speed: 0.0275s/iter; left time: 1178.4041s
	iters: 400, epoch: 9 | loss: 0.0004427
	speed: 0.0270s/iter; left time: 1154.4854s
Epoch: 9 cost time: 13.173270225524902
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.969696 --> -0.974556).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0009121
	speed: 0.1425s/iter; left time: 6069.6530s
	iters: 200, epoch: 10 | loss: 0.0771656
	speed: 0.0249s/iter; left time: 1058.4296s
	iters: 300, epoch: 10 | loss: 0.0003646
	speed: 0.0239s/iter; left time: 1014.3424s
	iters: 400, epoch: 10 | loss: 0.0004100
	speed: 0.0239s/iter; left time: 1010.2841s
Epoch: 10 cost time: 11.99343991279602
Epoch: 10, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1922578
	speed: 0.1487s/iter; left time: 6263.4043s
	iters: 200, epoch: 11 | loss: 0.0390801
	speed: 0.0273s/iter; left time: 1145.8355s
	iters: 300, epoch: 11 | loss: 0.0043079
	speed: 0.0272s/iter; left time: 1140.2949s
	iters: 400, epoch: 11 | loss: 0.0014220
	speed: 0.0294s/iter; left time: 1229.3776s
Epoch: 11 cost time: 13.803294897079468
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.260 Vali Acc: 0.953 Test Loss: 0.260 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0034902
	speed: 0.1430s/iter; left time: 5954.6610s
	iters: 200, epoch: 12 | loss: 0.0001614
	speed: 0.0287s/iter; left time: 1190.3262s
	iters: 300, epoch: 12 | loss: 0.0014713
	speed: 0.0295s/iter; left time: 1224.3140s
	iters: 400, epoch: 12 | loss: 0.2551991
	speed: 0.0277s/iter; left time: 1143.6379s
Epoch: 12 cost time: 13.690214157104492
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0026876
	speed: 0.1489s/iter; left time: 6130.9105s
	iters: 200, epoch: 13 | loss: 0.0014386
	speed: 0.0262s/iter; left time: 1075.1686s
	iters: 300, epoch: 13 | loss: 0.0009212
	speed: 0.0261s/iter; left time: 1070.9286s
	iters: 400, epoch: 13 | loss: 0.0016320
	speed: 0.0258s/iter; left time: 1052.9413s
Epoch: 13 cost time: 12.684853076934814
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974556 --> -0.974556).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0006722
	speed: 0.1423s/iter; left time: 5790.8052s
	iters: 200, epoch: 14 | loss: 0.0035381
	speed: 0.0267s/iter; left time: 1083.2474s
	iters: 300, epoch: 14 | loss: 0.0375616
	speed: 0.0248s/iter; left time: 1003.7036s
	iters: 400, epoch: 14 | loss: 0.0019571
	speed: 0.0279s/iter; left time: 1126.8474s
Epoch: 14 cost time: 12.942263841629028
Epoch: 14, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0022342
	speed: 0.1373s/iter; left time: 5523.3905s
	iters: 200, epoch: 15 | loss: 0.0004091
	speed: 0.0289s/iter; left time: 1159.4060s
	iters: 300, epoch: 15 | loss: 0.0000709
	speed: 0.0261s/iter; left time: 1043.3285s
	iters: 400, epoch: 15 | loss: 0.0005036
	speed: 0.0262s/iter; left time: 1046.0811s
Epoch: 15 cost time: 12.864282608032227
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0076648
	speed: 0.1417s/iter; left time: 5633.9516s
	iters: 200, epoch: 16 | loss: 0.4486332
	speed: 0.0270s/iter; left time: 1069.8851s
	iters: 300, epoch: 16 | loss: 0.1008163
	speed: 0.0241s/iter; left time: 952.3486s
	iters: 400, epoch: 16 | loss: 0.0184299
	speed: 0.0250s/iter; left time: 987.7374s
Epoch: 16 cost time: 12.480742692947388
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0008152
	speed: 0.1403s/iter; left time: 5514.4830s
	iters: 200, epoch: 17 | loss: 0.0000245
	speed: 0.0263s/iter; left time: 1030.8977s
	iters: 300, epoch: 17 | loss: 0.0000494
	speed: 0.0260s/iter; left time: 1015.6055s
	iters: 400, epoch: 17 | loss: 0.0488416
	speed: 0.0264s/iter; left time: 1028.9942s
Epoch: 17 cost time: 12.939002990722656
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.974556 --> -0.979988).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.5605912
	speed: 0.1391s/iter; left time: 5401.7947s
	iters: 200, epoch: 18 | loss: 0.0005899
	speed: 0.0284s/iter; left time: 1100.6282s
	iters: 300, epoch: 18 | loss: 0.0071351
	speed: 0.0290s/iter; left time: 1121.0169s
	iters: 400, epoch: 18 | loss: 0.0000601
	speed: 0.0271s/iter; left time: 1044.3115s
Epoch: 18 cost time: 13.435899019241333
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0033385
	speed: 0.1448s/iter; left time: 5554.7983s
	iters: 200, epoch: 19 | loss: 0.0000616
	speed: 0.0270s/iter; left time: 1031.3137s
	iters: 300, epoch: 19 | loss: 0.0403955
	speed: 0.0266s/iter; left time: 1015.9825s
	iters: 400, epoch: 19 | loss: 0.4922198
	speed: 0.0268s/iter; left time: 1020.9395s
Epoch: 19 cost time: 13.18585753440857
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0003958
	speed: 0.1511s/iter; left time: 5725.5808s
	iters: 200, epoch: 20 | loss: 0.0204288
	speed: 0.0279s/iter; left time: 1053.1245s
	iters: 300, epoch: 20 | loss: 0.0109195
	speed: 0.0284s/iter; left time: 1070.1753s
	iters: 400, epoch: 20 | loss: 0.0046394
	speed: 0.0276s/iter; left time: 1036.9205s
Epoch: 20 cost time: 13.487936735153198
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0002604
	speed: 0.1443s/iter; left time: 5398.6770s
	iters: 200, epoch: 21 | loss: 0.0001176
	speed: 0.0287s/iter; left time: 1069.9598s
	iters: 300, epoch: 21 | loss: 0.0023378
	speed: 0.0304s/iter; left time: 1129.9090s
	iters: 400, epoch: 21 | loss: 0.0016959
	speed: 0.0298s/iter; left time: 1107.6378s
Epoch: 21 cost time: 13.986860036849976
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0001542
	speed: 0.1462s/iter; left time: 5400.8982s
	iters: 200, epoch: 22 | loss: 0.0042435
	speed: 0.0262s/iter; left time: 963.7607s
	iters: 300, epoch: 22 | loss: 0.0257733
	speed: 0.0261s/iter; left time: 959.8418s
	iters: 400, epoch: 22 | loss: 0.0000289
	speed: 0.0255s/iter; left time: 933.6498s
Epoch: 22 cost time: 12.755483388900757
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.2447547
	speed: 0.1322s/iter; left time: 4823.3656s
	iters: 200, epoch: 23 | loss: 0.0000595
	speed: 0.0262s/iter; left time: 954.0377s
	iters: 300, epoch: 23 | loss: 0.0000712
	speed: 0.0261s/iter; left time: 947.5847s
	iters: 400, epoch: 23 | loss: 0.0926922
	speed: 0.0281s/iter; left time: 1018.1006s
Epoch: 23 cost time: 12.811076164245605
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0000435
	speed: 0.1390s/iter; left time: 5006.1090s
	iters: 200, epoch: 24 | loss: 0.0000077
	speed: 0.0237s/iter; left time: 849.9746s
	iters: 300, epoch: 24 | loss: 0.0026412
	speed: 0.0263s/iter; left time: 942.9791s
	iters: 400, epoch: 24 | loss: 0.0000385
	speed: 0.0262s/iter; left time: 934.4538s
Epoch: 24 cost time: 12.29027509689331
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.200 Vali Acc: 0.968 Test Loss: 0.200 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0114125
	speed: 0.1386s/iter; left time: 4927.3090s
	iters: 200, epoch: 25 | loss: 0.0150717
	speed: 0.0288s/iter; left time: 1020.1097s
	iters: 300, epoch: 25 | loss: 0.0006533
	speed: 0.0283s/iter; left time: 1000.3644s
	iters: 400, epoch: 25 | loss: 0.0001223
	speed: 0.0261s/iter; left time: 920.1529s
Epoch: 25 cost time: 13.12978219985962
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.980 Test Loss: 0.133 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0002987
	speed: 0.1379s/iter; left time: 4835.7923s
	iters: 200, epoch: 26 | loss: 0.0006320
	speed: 0.0271s/iter; left time: 947.2173s
	iters: 300, epoch: 26 | loss: 0.0065817
	speed: 0.0271s/iter; left time: 943.4157s
	iters: 400, epoch: 26 | loss: 0.0278096
	speed: 0.0258s/iter; left time: 896.3070s
Epoch: 26 cost time: 12.957219362258911
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0078504
	speed: 0.1417s/iter; left time: 4902.4969s
	iters: 200, epoch: 27 | loss: 0.0000187
	speed: 0.0252s/iter; left time: 869.4495s
	iters: 300, epoch: 27 | loss: 0.0307109
	speed: 0.0269s/iter; left time: 924.9436s
	iters: 400, epoch: 27 | loss: 0.0005739
	speed: 0.0288s/iter; left time: 988.0151s
Epoch: 27 cost time: 13.21713662147522
Epoch: 27, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 288290
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7916041
	speed: 0.0455s/iter; left time: 2127.4644s
	iters: 200, epoch: 1 | loss: 0.3848367
	speed: 0.0271s/iter; left time: 1265.8450s
	iters: 300, epoch: 1 | loss: 0.1007817
	speed: 0.0287s/iter; left time: 1336.6787s
	iters: 400, epoch: 1 | loss: 0.0930080
	speed: 0.0296s/iter; left time: 1374.5950s
Epoch: 1 cost time: 14.972042083740234
Epoch: 1, Steps: 469 | Train Loss: 0.489 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (inf --> -0.949969).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0070664
	speed: 0.1469s/iter; left time: 6807.6432s
	iters: 200, epoch: 2 | loss: 0.0352407
	speed: 0.0292s/iter; left time: 1349.8778s
	iters: 300, epoch: 2 | loss: 0.0308343
	speed: 0.0270s/iter; left time: 1247.8222s
	iters: 400, epoch: 2 | loss: 0.0224926
	speed: 0.0257s/iter; left time: 1185.2980s
Epoch: 2 cost time: 13.13101863861084
Epoch: 2, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
Validation loss decreased (-0.949969 --> -0.964550).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0074226
	speed: 0.1422s/iter; left time: 6521.8480s
	iters: 200, epoch: 3 | loss: 0.1202553
	speed: 0.0263s/iter; left time: 1205.6508s
	iters: 300, epoch: 3 | loss: 0.0219147
	speed: 0.0257s/iter; left time: 1173.2629s
	iters: 400, epoch: 3 | loss: 0.4672125
	speed: 0.0257s/iter; left time: 1169.6190s
Epoch: 3 cost time: 12.622264862060547
Epoch: 3, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0042116
	speed: 0.1368s/iter; left time: 6211.0497s
	iters: 200, epoch: 4 | loss: 0.0103419
	speed: 0.0243s/iter; left time: 1099.3071s
	iters: 300, epoch: 4 | loss: 0.0044807
	speed: 0.0260s/iter; left time: 1174.3416s
	iters: 400, epoch: 4 | loss: 0.8162407
	speed: 0.0283s/iter; left time: 1277.4209s
Epoch: 4 cost time: 12.773322820663452
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.964550 --> -0.972840).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0854313
	speed: 0.1400s/iter; left time: 6289.0266s
	iters: 200, epoch: 5 | loss: 0.0127686
	speed: 0.0238s/iter; left time: 1068.4742s
	iters: 300, epoch: 5 | loss: 0.0027797
	speed: 0.0249s/iter; left time: 1114.3430s
	iters: 400, epoch: 5 | loss: 0.0003112
	speed: 0.0264s/iter; left time: 1180.2979s
Epoch: 5 cost time: 12.24042296409607
Epoch: 5, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.976843).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0069375
	speed: 0.1411s/iter; left time: 6273.3358s
	iters: 200, epoch: 6 | loss: 0.0055317
	speed: 0.0271s/iter; left time: 1199.9135s
	iters: 300, epoch: 6 | loss: 0.0003216
	speed: 0.0222s/iter; left time: 983.4756s
	iters: 400, epoch: 6 | loss: 0.0001345
	speed: 0.0242s/iter; left time: 1069.5748s
Epoch: 6 cost time: 12.055411338806152
Epoch: 6, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0009839
	speed: 0.1393s/iter; left time: 6125.2402s
	iters: 200, epoch: 7 | loss: 0.0025045
	speed: 0.0253s/iter; left time: 1110.3532s
	iters: 300, epoch: 7 | loss: 0.0007480
	speed: 0.0243s/iter; left time: 1062.7420s
	iters: 400, epoch: 7 | loss: 0.0442821
	speed: 0.0238s/iter; left time: 1039.8518s
Epoch: 7 cost time: 12.391128540039062
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000419
	speed: 0.1372s/iter; left time: 5972.3465s
	iters: 200, epoch: 8 | loss: 0.0117549
	speed: 0.0240s/iter; left time: 1040.0859s
	iters: 300, epoch: 8 | loss: 0.4594048
	speed: 0.0243s/iter; left time: 1051.2425s
	iters: 400, epoch: 8 | loss: 0.0008665
	speed: 0.0264s/iter; left time: 1140.0178s
Epoch: 8 cost time: 12.475255966186523
Epoch: 8, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002353
	speed: 0.1421s/iter; left time: 6117.5683s
	iters: 200, epoch: 9 | loss: 0.0425340
	speed: 0.0268s/iter; left time: 1150.1350s
	iters: 300, epoch: 9 | loss: 0.0011996
	speed: 0.0280s/iter; left time: 1198.1096s
	iters: 400, epoch: 9 | loss: 0.0001318
	speed: 0.0269s/iter; left time: 1149.3331s
Epoch: 9 cost time: 13.164944648742676
Epoch: 9, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000146
	speed: 0.1445s/iter; left time: 6153.0850s
	iters: 200, epoch: 10 | loss: 0.0331972
	speed: 0.0259s/iter; left time: 1100.9237s
	iters: 300, epoch: 10 | loss: 0.0015552
	speed: 0.0269s/iter; left time: 1139.2126s
	iters: 400, epoch: 10 | loss: 0.0004054
	speed: 0.0262s/iter; left time: 1109.2860s
Epoch: 10 cost time: 13.294844627380371
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2046896
	speed: 0.1436s/iter; left time: 6046.3610s
	iters: 200, epoch: 11 | loss: 0.0098770
	speed: 0.0261s/iter; left time: 1097.0192s
	iters: 300, epoch: 11 | loss: 0.0006043
	speed: 0.0251s/iter; left time: 1053.6840s
	iters: 400, epoch: 11 | loss: 0.0000691
	speed: 0.0267s/iter; left time: 1116.0528s
Epoch: 11 cost time: 12.795389413833618
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0034428
	speed: 0.1495s/iter; left time: 6226.6434s
	iters: 200, epoch: 12 | loss: 0.8143632
	speed: 0.0253s/iter; left time: 1051.6472s
	iters: 300, epoch: 12 | loss: 0.0001533
	speed: 0.0239s/iter; left time: 991.2002s
	iters: 400, epoch: 12 | loss: 0.4400483
	speed: 0.0251s/iter; left time: 1037.6487s
Epoch: 12 cost time: 12.355274200439453
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977700).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0010867
	speed: 0.1413s/iter; left time: 5817.9650s
	iters: 200, epoch: 13 | loss: 0.0035832
	speed: 0.0256s/iter; left time: 1052.7504s
	iters: 300, epoch: 13 | loss: 0.0005103
	speed: 0.0285s/iter; left time: 1169.0925s
	iters: 400, epoch: 13 | loss: 0.0062636
	speed: 0.0279s/iter; left time: 1140.3338s
Epoch: 13 cost time: 12.886293649673462
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0099168
	speed: 0.1370s/iter; left time: 5576.0016s
	iters: 200, epoch: 14 | loss: 0.0012056
	speed: 0.0273s/iter; left time: 1109.9754s
	iters: 300, epoch: 14 | loss: 0.0129312
	speed: 0.0267s/iter; left time: 1079.5333s
	iters: 400, epoch: 14 | loss: 0.0000046
	speed: 0.0257s/iter; left time: 1036.9077s
Epoch: 14 cost time: 12.834898710250854
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0001629
	speed: 0.1381s/iter; left time: 5554.8829s
	iters: 200, epoch: 15 | loss: 0.0007975
	speed: 0.0244s/iter; left time: 977.3115s
	iters: 300, epoch: 15 | loss: 0.0001413
	speed: 0.0247s/iter; left time: 987.9636s
	iters: 400, epoch: 15 | loss: 0.0019947
	speed: 0.0239s/iter; left time: 955.5623s
Epoch: 15 cost time: 11.878138780593872
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0033744
	speed: 0.1435s/iter; left time: 5704.4814s
	iters: 200, epoch: 16 | loss: 0.5670635
	speed: 0.0238s/iter; left time: 945.5866s
	iters: 300, epoch: 16 | loss: 0.0097493
	speed: 0.0254s/iter; left time: 1003.8922s
	iters: 400, epoch: 16 | loss: 0.0000728
	speed: 0.0252s/iter; left time: 993.3568s
Epoch: 16 cost time: 12.159515619277954
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0000159
	speed: 0.1372s/iter; left time: 5390.3328s
	iters: 200, epoch: 17 | loss: 0.0000365
	speed: 0.0271s/iter; left time: 1060.8026s
	iters: 300, epoch: 17 | loss: 0.0000593
	speed: 0.0252s/iter; left time: 985.8324s
	iters: 400, epoch: 17 | loss: 0.1238820
	speed: 0.0291s/iter; left time: 1134.2722s
Epoch: 17 cost time: 13.220670223236084
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.6982509
	speed: 0.1421s/iter; left time: 5519.1184s
	iters: 200, epoch: 18 | loss: 0.0025421
	speed: 0.0283s/iter; left time: 1095.1368s
	iters: 300, epoch: 18 | loss: 0.0025533
	speed: 0.0276s/iter; left time: 1066.7893s
	iters: 400, epoch: 18 | loss: 0.0000830
	speed: 0.0265s/iter; left time: 1020.3258s
Epoch: 18 cost time: 13.069673538208008
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000012
	speed: 0.1420s/iter; left time: 5445.2573s
	iters: 200, epoch: 19 | loss: 0.0000190
	speed: 0.0278s/iter; left time: 1063.4605s
	iters: 300, epoch: 19 | loss: 0.1506682
	speed: 0.0279s/iter; left time: 1065.8239s
	iters: 400, epoch: 19 | loss: 0.0000357
	speed: 0.0274s/iter; left time: 1043.1112s
Epoch: 19 cost time: 13.312347173690796
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000386
	speed: 0.1382s/iter; left time: 5237.2854s
	iters: 200, epoch: 20 | loss: 0.0001750
	speed: 0.0224s/iter; left time: 846.6867s
	iters: 300, epoch: 20 | loss: 0.0000031
	speed: 0.0258s/iter; left time: 972.1472s
	iters: 400, epoch: 20 | loss: 0.0000015
	speed: 0.0251s/iter; left time: 945.0487s
Epoch: 20 cost time: 12.248754262924194
Epoch: 20, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.969 Test Loss: 0.213 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0059225
	speed: 0.1396s/iter; left time: 5224.2555s
	iters: 200, epoch: 21 | loss: 0.0005994
	speed: 0.0227s/iter; left time: 848.4591s
	iters: 300, epoch: 21 | loss: 0.0000058
	speed: 0.0245s/iter; left time: 910.8346s
	iters: 400, epoch: 21 | loss: 0.0000313
	speed: 0.0267s/iter; left time: 989.9832s
Epoch: 21 cost time: 12.195660829544067
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000055
	speed: 0.1378s/iter; left time: 5091.7789s
	iters: 200, epoch: 22 | loss: 0.0000020
	speed: 0.0249s/iter; left time: 918.9147s
	iters: 300, epoch: 22 | loss: 0.0056315
	speed: 0.0261s/iter; left time: 958.6071s
	iters: 400, epoch: 22 | loss: 0.0000151
	speed: 0.0276s/iter; left time: 1012.2032s
Epoch: 22 cost time: 12.574625968933105
Epoch: 22, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 288290
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5598145
	speed: 0.0422s/iter; left time: 1975.7763s
	iters: 200, epoch: 1 | loss: 0.1806857
	speed: 0.0251s/iter; left time: 1171.1131s
	iters: 300, epoch: 1 | loss: 0.1645268
	speed: 0.0229s/iter; left time: 1067.0456s
	iters: 400, epoch: 1 | loss: 0.0476835
	speed: 0.0253s/iter; left time: 1178.1500s
Epoch: 1 cost time: 13.54910659790039
Epoch: 1, Steps: 469 | Train Loss: 0.465 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (inf --> -0.930815).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1002220
	speed: 0.1379s/iter; left time: 6390.6940s
	iters: 200, epoch: 2 | loss: 0.0183809
	speed: 0.0262s/iter; left time: 1211.1708s
	iters: 300, epoch: 2 | loss: 0.2144962
	speed: 0.0288s/iter; left time: 1327.2365s
	iters: 400, epoch: 2 | loss: 0.0409069
	speed: 0.0289s/iter; left time: 1331.9798s
Epoch: 2 cost time: 13.013218402862549
Epoch: 2, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
Validation loss decreased (-0.930815 --> -0.957402).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3154046
	speed: 0.1458s/iter; left time: 6687.9610s
	iters: 200, epoch: 3 | loss: 0.0060776
	speed: 0.0319s/iter; left time: 1459.1027s
	iters: 300, epoch: 3 | loss: 0.1377891
	speed: 0.0279s/iter; left time: 1274.5989s
	iters: 400, epoch: 3 | loss: 0.0080574
	speed: 0.0271s/iter; left time: 1235.3742s
Epoch: 3 cost time: 13.858638525009155
Epoch: 3, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0666630
	speed: 0.1388s/iter; left time: 6301.3913s
	iters: 200, epoch: 4 | loss: 0.0196218
	speed: 0.0275s/iter; left time: 1243.5346s
	iters: 300, epoch: 4 | loss: 0.1616782
	speed: 0.0284s/iter; left time: 1284.9146s
	iters: 400, epoch: 4 | loss: 0.0288081
	speed: 0.0283s/iter; left time: 1275.9500s
Epoch: 4 cost time: 13.587587118148804
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.957402 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0030188
	speed: 0.1442s/iter; left time: 6479.8974s
	iters: 200, epoch: 5 | loss: 0.0008188
	speed: 0.0283s/iter; left time: 1267.5530s
	iters: 300, epoch: 5 | loss: 0.0391929
	speed: 0.0292s/iter; left time: 1306.8934s
	iters: 400, epoch: 5 | loss: 0.0072275
	speed: 0.0263s/iter; left time: 1173.6160s
Epoch: 5 cost time: 13.316808223724365
Epoch: 5, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.963120 --> -0.964835).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0434498
	speed: 0.1394s/iter; left time: 6198.4283s
	iters: 200, epoch: 6 | loss: 0.0036226
	speed: 0.0257s/iter; left time: 1140.4037s
	iters: 300, epoch: 6 | loss: 0.0017735
	speed: 0.0262s/iter; left time: 1157.9191s
	iters: 400, epoch: 6 | loss: 0.0072188
	speed: 0.0242s/iter; left time: 1070.0590s
Epoch: 6 cost time: 12.478542566299438
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.964835 --> -0.970267).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0762961
	speed: 0.1423s/iter; left time: 6261.2066s
	iters: 200, epoch: 7 | loss: 0.0001097
	speed: 0.0254s/iter; left time: 1116.3624s
	iters: 300, epoch: 7 | loss: 0.0008591
	speed: 0.0254s/iter; left time: 1112.9580s
	iters: 400, epoch: 7 | loss: 0.1486107
	speed: 0.0261s/iter; left time: 1139.0272s
Epoch: 7 cost time: 12.583969593048096
Epoch: 7, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970267 --> -0.972840).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0054329
	speed: 0.1371s/iter; left time: 5968.0392s
	iters: 200, epoch: 8 | loss: 0.0361347
	speed: 0.0252s/iter; left time: 1094.9415s
	iters: 300, epoch: 8 | loss: 0.0030400
	speed: 0.0276s/iter; left time: 1196.9536s
	iters: 400, epoch: 8 | loss: 0.0488808
	speed: 0.0255s/iter; left time: 1101.6319s
Epoch: 8 cost time: 12.124996662139893
Epoch: 8, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0582474
	speed: 0.1423s/iter; left time: 6124.3490s
	iters: 200, epoch: 9 | loss: 0.0406909
	speed: 0.0223s/iter; left time: 956.4018s
	iters: 300, epoch: 9 | loss: 0.0000373
	speed: 0.0199s/iter; left time: 851.4015s
	iters: 400, epoch: 9 | loss: 0.0475626
	speed: 0.0208s/iter; left time: 890.7280s
Epoch: 9 cost time: 11.222776412963867
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.973126 --> -0.981131).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0303365
	speed: 0.1111s/iter; left time: 4728.6253s
	iters: 200, epoch: 10 | loss: 0.0262900
	speed: 0.0227s/iter; left time: 964.2307s
	iters: 300, epoch: 10 | loss: 0.0037231
	speed: 0.0217s/iter; left time: 920.6843s
	iters: 400, epoch: 10 | loss: 0.0028159
	speed: 0.0245s/iter; left time: 1035.5778s
Epoch: 10 cost time: 11.184919357299805
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0027549
	speed: 0.1398s/iter; left time: 5885.8678s
	iters: 200, epoch: 11 | loss: 0.0540663
	speed: 0.0265s/iter; left time: 1112.5967s
	iters: 300, epoch: 11 | loss: 0.0002183
	speed: 0.0290s/iter; left time: 1217.2520s
	iters: 400, epoch: 11 | loss: 0.0005151
	speed: 0.0290s/iter; left time: 1213.8076s
Epoch: 11 cost time: 13.335690975189209
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0028780
	speed: 0.1430s/iter; left time: 5953.5990s
	iters: 200, epoch: 12 | loss: 0.0034868
	speed: 0.0279s/iter; left time: 1160.6724s
	iters: 300, epoch: 12 | loss: 0.0079925
	speed: 0.0264s/iter; left time: 1092.9580s
	iters: 400, epoch: 12 | loss: 0.0086046
	speed: 0.0260s/iter; left time: 1076.0477s
Epoch: 12 cost time: 13.256038665771484
Epoch: 12, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0091334
	speed: 0.1454s/iter; left time: 5985.9159s
	iters: 200, epoch: 13 | loss: 0.0476436
	speed: 0.0255s/iter; left time: 1047.6769s
	iters: 300, epoch: 13 | loss: 0.0024204
	speed: 0.0265s/iter; left time: 1084.2495s
	iters: 400, epoch: 13 | loss: 0.0048346
	speed: 0.0282s/iter; left time: 1152.6015s
Epoch: 13 cost time: 13.078388214111328
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0052320
	speed: 0.1454s/iter; left time: 5916.6401s
	iters: 200, epoch: 14 | loss: 0.0000914
	speed: 0.0294s/iter; left time: 1192.2768s
	iters: 300, epoch: 14 | loss: 0.0000968
	speed: 0.0293s/iter; left time: 1186.1593s
	iters: 400, epoch: 14 | loss: 0.0011024
	speed: 0.0254s/iter; left time: 1025.1349s
Epoch: 14 cost time: 13.330884456634521
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0231293
	speed: 0.1366s/iter; left time: 5495.6074s
	iters: 200, epoch: 15 | loss: 0.0066145
	speed: 0.0240s/iter; left time: 961.5469s
	iters: 300, epoch: 15 | loss: 0.0014105
	speed: 0.0258s/iter; left time: 1032.3222s
	iters: 400, epoch: 15 | loss: 0.0135819
	speed: 0.0261s/iter; left time: 1042.0618s
Epoch: 15 cost time: 12.436373233795166
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0028566
	speed: 0.1394s/iter; left time: 5544.5042s
	iters: 200, epoch: 16 | loss: 0.0002712
	speed: 0.0257s/iter; left time: 1017.4469s
	iters: 300, epoch: 16 | loss: 0.0026457
	speed: 0.0261s/iter; left time: 1032.8953s
	iters: 400, epoch: 16 | loss: 0.0004908
	speed: 0.0262s/iter; left time: 1035.9034s
Epoch: 16 cost time: 12.506278038024902
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0026264
	speed: 0.1370s/iter; left time: 5383.9720s
	iters: 200, epoch: 17 | loss: 0.0073493
	speed: 0.0277s/iter; left time: 1085.6284s
	iters: 300, epoch: 17 | loss: 0.2205147
	speed: 0.0248s/iter; left time: 970.1868s
	iters: 400, epoch: 17 | loss: 0.0000120
	speed: 0.0244s/iter; left time: 950.8444s
Epoch: 17 cost time: 12.653290748596191
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.1556680
	speed: 0.1351s/iter; left time: 5245.9663s
	iters: 200, epoch: 18 | loss: 0.0002167
	speed: 0.0247s/iter; left time: 955.1540s
	iters: 300, epoch: 18 | loss: 0.0058277
	speed: 0.0249s/iter; left time: 961.5900s
	iters: 400, epoch: 18 | loss: 0.0002923
	speed: 0.0261s/iter; left time: 1005.5078s
Epoch: 18 cost time: 12.448683738708496
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0041803
	speed: 0.1356s/iter; left time: 5201.5583s
	iters: 200, epoch: 19 | loss: 0.0001953
	speed: 0.0240s/iter; left time: 919.1167s
	iters: 300, epoch: 19 | loss: 0.0001401
	speed: 0.0264s/iter; left time: 1006.4757s
	iters: 400, epoch: 19 | loss: 0.0316338
	speed: 0.0260s/iter; left time: 990.2200s
Epoch: 19 cost time: 12.169632196426392
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 222754
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5618429
	speed: 0.0468s/iter; left time: 2188.1479s
	iters: 200, epoch: 1 | loss: 0.1874648
	speed: 0.0275s/iter; left time: 1285.9540s
	iters: 300, epoch: 1 | loss: 0.1793043
	speed: 0.0265s/iter; left time: 1235.5490s
	iters: 400, epoch: 1 | loss: 0.0462693
	speed: 0.0255s/iter; left time: 1184.2380s
Epoch: 1 cost time: 14.595478057861328
Epoch: 1, Steps: 469 | Train Loss: 0.470 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (inf --> -0.942822).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0744172
	speed: 0.1447s/iter; left time: 6706.2162s
	iters: 200, epoch: 2 | loss: 0.0148536
	speed: 0.0273s/iter; left time: 1262.4862s
	iters: 300, epoch: 2 | loss: 0.2203500
	speed: 0.0259s/iter; left time: 1196.7443s
	iters: 400, epoch: 2 | loss: 0.0209202
	speed: 0.0276s/iter; left time: 1268.4260s
Epoch: 2 cost time: 13.067479610443115
Epoch: 2, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
Validation loss decreased (-0.942822 --> -0.959690).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2036815
	speed: 0.1435s/iter; left time: 6579.4036s
	iters: 200, epoch: 3 | loss: 0.0043007
	speed: 0.0298s/iter; left time: 1365.9606s
	iters: 300, epoch: 3 | loss: 0.0759903
	speed: 0.0265s/iter; left time: 1210.5112s
	iters: 400, epoch: 3 | loss: 0.0053796
	speed: 0.0253s/iter; left time: 1152.1703s
Epoch: 3 cost time: 12.863015174865723
Epoch: 3, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.2971976
	speed: 0.1361s/iter; left time: 6178.1266s
	iters: 200, epoch: 4 | loss: 0.0204052
	speed: 0.0222s/iter; left time: 1005.9444s
	iters: 300, epoch: 4 | loss: 0.0901541
	speed: 0.0241s/iter; left time: 1089.1794s
	iters: 400, epoch: 4 | loss: 0.0141987
	speed: 0.0237s/iter; left time: 1069.4585s
Epoch: 4 cost time: 11.627851247787476
Epoch: 4, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.959690 --> -0.971411).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0039899
	speed: 0.1345s/iter; left time: 6043.5357s
	iters: 200, epoch: 5 | loss: 0.0058022
	speed: 0.0243s/iter; left time: 1087.5954s
	iters: 300, epoch: 5 | loss: 0.0144712
	speed: 0.0250s/iter; left time: 1117.8413s
	iters: 400, epoch: 5 | loss: 0.0023925
	speed: 0.0249s/iter; left time: 1109.9412s
Epoch: 5 cost time: 12.069293975830078
Epoch: 5, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0432997
	speed: 0.1343s/iter; left time: 5969.2952s
	iters: 200, epoch: 6 | loss: 0.0052051
	speed: 0.0260s/iter; left time: 1155.3826s
	iters: 300, epoch: 6 | loss: 0.0007834
	speed: 0.0263s/iter; left time: 1163.0714s
	iters: 400, epoch: 6 | loss: 0.0066247
	speed: 0.0281s/iter; left time: 1242.6110s
Epoch: 6 cost time: 12.800535440444946
Epoch: 6, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0119322
	speed: 0.1359s/iter; left time: 5977.2206s
	iters: 200, epoch: 7 | loss: 0.0000569
	speed: 0.0271s/iter; left time: 1190.7750s
	iters: 300, epoch: 7 | loss: 0.0008445
	speed: 0.0263s/iter; left time: 1151.0243s
	iters: 400, epoch: 7 | loss: 0.0439740
	speed: 0.0262s/iter; left time: 1143.4938s
Epoch: 7 cost time: 12.624905586242676
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.971411 --> -0.975699).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0015106
	speed: 0.1375s/iter; left time: 5983.7840s
	iters: 200, epoch: 8 | loss: 0.0061617
	speed: 0.0246s/iter; left time: 1069.5079s
	iters: 300, epoch: 8 | loss: 0.0477817
	speed: 0.0240s/iter; left time: 1037.8301s
	iters: 400, epoch: 8 | loss: 0.0485008
	speed: 0.0259s/iter; left time: 1119.9314s
Epoch: 8 cost time: 12.247275829315186
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0729516
	speed: 0.1436s/iter; left time: 6179.8501s
	iters: 200, epoch: 9 | loss: 0.0105900
	speed: 0.0271s/iter; left time: 1163.9109s
	iters: 300, epoch: 9 | loss: 0.0001369
	speed: 0.0271s/iter; left time: 1160.4735s
	iters: 400, epoch: 9 | loss: 0.0130334
	speed: 0.0274s/iter; left time: 1171.2378s
Epoch: 9 cost time: 13.345511674880981
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0009473
	speed: 0.1394s/iter; left time: 5935.7325s
	iters: 200, epoch: 10 | loss: 0.0293952
	speed: 0.0276s/iter; left time: 1172.6958s
	iters: 300, epoch: 10 | loss: 0.0002698
	speed: 0.0280s/iter; left time: 1186.7501s
	iters: 400, epoch: 10 | loss: 0.0009669
	speed: 0.0271s/iter; left time: 1146.1362s
Epoch: 10 cost time: 13.262411832809448
Epoch: 10, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0015830
	speed: 0.1415s/iter; left time: 5960.3986s
	iters: 200, epoch: 11 | loss: 0.0084907
	speed: 0.0269s/iter; left time: 1131.6770s
	iters: 300, epoch: 11 | loss: 0.0008058
	speed: 0.0266s/iter; left time: 1113.3821s
	iters: 400, epoch: 11 | loss: 0.0000445
	speed: 0.0258s/iter; left time: 1080.1959s
Epoch: 11 cost time: 12.88180923461914
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0026176
	speed: 0.1410s/iter; left time: 5870.6536s
	iters: 200, epoch: 12 | loss: 0.0080730
	speed: 0.0266s/iter; left time: 1103.8429s
	iters: 300, epoch: 12 | loss: 0.0066971
	speed: 0.0262s/iter; left time: 1087.0774s
	iters: 400, epoch: 12 | loss: 0.0002792
	speed: 0.0238s/iter; left time: 982.8785s
Epoch: 12 cost time: 12.474753618240356
Epoch: 12, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0016306
	speed: 0.1391s/iter; left time: 5727.7078s
	iters: 200, epoch: 13 | loss: 0.1921931
	speed: 0.0254s/iter; left time: 1044.6502s
	iters: 300, epoch: 13 | loss: 0.0060713
	speed: 0.0263s/iter; left time: 1079.4703s
	iters: 400, epoch: 13 | loss: 0.0003947
	speed: 0.0257s/iter; left time: 1051.1359s
Epoch: 13 cost time: 12.449546098709106
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0223979
	speed: 0.1399s/iter; left time: 5695.4889s
	iters: 200, epoch: 14 | loss: 0.0001248
	speed: 0.0250s/iter; left time: 1014.0573s
	iters: 300, epoch: 14 | loss: 0.0000475
	speed: 0.0250s/iter; left time: 1014.1624s
	iters: 400, epoch: 14 | loss: 0.2246634
	speed: 0.0250s/iter; left time: 1010.4595s
Epoch: 14 cost time: 12.139097213745117
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0017983
	speed: 0.1408s/iter; left time: 5666.4881s
	iters: 200, epoch: 15 | loss: 0.0410108
	speed: 0.0256s/iter; left time: 1029.3000s
	iters: 300, epoch: 15 | loss: 0.0033638
	speed: 0.0255s/iter; left time: 1019.3889s
	iters: 400, epoch: 15 | loss: 0.0732595
	speed: 0.0256s/iter; left time: 1024.2185s
Epoch: 15 cost time: 12.552700281143188
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.975699 --> -0.975985).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0002061
	speed: 0.1343s/iter; left time: 5342.1278s
	iters: 200, epoch: 16 | loss: 0.0002929
	speed: 0.0261s/iter; left time: 1034.9756s
	iters: 300, epoch: 16 | loss: 0.0002957
	speed: 0.0266s/iter; left time: 1053.6704s
	iters: 400, epoch: 16 | loss: 0.0005460
	speed: 0.0258s/iter; left time: 1018.3193s
Epoch: 16 cost time: 12.731308698654175
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.975985 --> -0.979416).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000337
	speed: 0.1392s/iter; left time: 5469.4636s
	iters: 200, epoch: 17 | loss: 0.0022578
	speed: 0.0243s/iter; left time: 951.4296s
	iters: 300, epoch: 17 | loss: 0.2725844
	speed: 0.0270s/iter; left time: 1054.7628s
	iters: 400, epoch: 17 | loss: 0.0000026
	speed: 0.0259s/iter; left time: 1011.3198s
Epoch: 17 cost time: 12.555710554122925
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.968 Test Loss: 0.197 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0129593
	speed: 0.1492s/iter; left time: 5792.3972s
	iters: 200, epoch: 18 | loss: 0.0019153
	speed: 0.0272s/iter; left time: 1054.6486s
	iters: 300, epoch: 18 | loss: 0.0073463
	speed: 0.0267s/iter; left time: 1031.1805s
	iters: 400, epoch: 18 | loss: 0.0000986
	speed: 0.0259s/iter; left time: 998.6460s
Epoch: 18 cost time: 13.205402135848999
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0191626
	speed: 0.1418s/iter; left time: 5437.8911s
	iters: 200, epoch: 19 | loss: 0.0000451
	speed: 0.0263s/iter; left time: 1007.3041s
	iters: 300, epoch: 19 | loss: 0.0014017
	speed: 0.0252s/iter; left time: 962.8031s
	iters: 400, epoch: 19 | loss: 0.0005559
	speed: 0.0242s/iter; left time: 921.9385s
Epoch: 19 cost time: 12.22930908203125
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0010734
	speed: 0.1331s/iter; left time: 5043.8456s
	iters: 200, epoch: 20 | loss: 0.0003475
	speed: 0.0257s/iter; left time: 970.4055s
	iters: 300, epoch: 20 | loss: 0.0003972
	speed: 0.0252s/iter; left time: 947.9933s
	iters: 400, epoch: 20 | loss: 0.0000601
	speed: 0.0263s/iter; left time: 989.5596s
Epoch: 20 cost time: 12.390717506408691
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0060074
	speed: 0.1332s/iter; left time: 4984.8792s
	iters: 200, epoch: 21 | loss: 0.0000048
	speed: 0.0262s/iter; left time: 976.4736s
	iters: 300, epoch: 21 | loss: 0.0003464
	speed: 0.0267s/iter; left time: 993.2531s
	iters: 400, epoch: 21 | loss: 0.0501582
	speed: 0.0250s/iter; left time: 926.8850s
Epoch: 21 cost time: 12.539372682571411
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0009336
	speed: 0.1375s/iter; left time: 5080.6706s
	iters: 200, epoch: 22 | loss: 0.0004001
	speed: 0.0252s/iter; left time: 930.0571s
	iters: 300, epoch: 22 | loss: 0.0003959
	speed: 0.0253s/iter; left time: 930.9649s
	iters: 400, epoch: 22 | loss: 0.0134509
	speed: 0.0248s/iter; left time: 910.3935s
Epoch: 22 cost time: 12.216195106506348
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0001593
	speed: 0.1396s/iter; left time: 5092.5319s
	iters: 200, epoch: 23 | loss: 0.0000846
	speed: 0.0247s/iter; left time: 897.9569s
	iters: 300, epoch: 23 | loss: 0.0009446
	speed: 0.0245s/iter; left time: 889.8481s
	iters: 400, epoch: 23 | loss: 0.0619209
	speed: 0.0246s/iter; left time: 890.2199s
Epoch: 23 cost time: 12.166862487792969
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979701).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000293
	speed: 0.1393s/iter; left time: 5018.3221s
	iters: 200, epoch: 24 | loss: 0.0003540
	speed: 0.0256s/iter; left time: 917.9528s
	iters: 300, epoch: 24 | loss: 0.0106238
	speed: 0.0260s/iter; left time: 932.3708s
	iters: 400, epoch: 24 | loss: 0.0000410
	speed: 0.0246s/iter; left time: 877.9586s
Epoch: 24 cost time: 12.33221983909607
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0123928
	speed: 0.1381s/iter; left time: 4909.8195s
	iters: 200, epoch: 25 | loss: 0.0000235
	speed: 0.0247s/iter; left time: 874.7691s
	iters: 300, epoch: 25 | loss: 0.0000210
	speed: 0.0262s/iter; left time: 926.2303s
	iters: 400, epoch: 25 | loss: 0.1413226
	speed: 0.0277s/iter; left time: 976.4664s
Epoch: 25 cost time: 12.663627862930298
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0002674
	speed: 0.1420s/iter; left time: 4980.3454s
	iters: 200, epoch: 26 | loss: 0.0617372
	speed: 0.0279s/iter; left time: 976.1691s
	iters: 300, epoch: 26 | loss: 0.0098496
	speed: 0.0253s/iter; left time: 882.8497s
	iters: 400, epoch: 26 | loss: 0.0000816
	speed: 0.0255s/iter; left time: 887.2763s
Epoch: 26 cost time: 12.8545663356781
Epoch: 26, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0023531
	speed: 0.1383s/iter; left time: 4784.4416s
	iters: 200, epoch: 27 | loss: 0.3886957
	speed: 0.0261s/iter; left time: 901.6472s
	iters: 300, epoch: 27 | loss: 0.0022823
	speed: 0.0264s/iter; left time: 909.1251s
	iters: 400, epoch: 27 | loss: 0.0007707
	speed: 0.0253s/iter; left time: 866.8397s
Epoch: 27 cost time: 12.790035486221313
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0003473
	speed: 0.1331s/iter; left time: 4542.7054s
	iters: 200, epoch: 28 | loss: 0.0002058
	speed: 0.0267s/iter; left time: 907.5152s
	iters: 300, epoch: 28 | loss: 0.0000116
	speed: 0.0274s/iter; left time: 929.0947s
	iters: 400, epoch: 28 | loss: 0.0001773
	speed: 0.0270s/iter; left time: 914.3616s
Epoch: 28 cost time: 12.862914800643921
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0003472
	speed: 0.1374s/iter; left time: 4626.9375s
	iters: 200, epoch: 29 | loss: 0.0001371
	speed: 0.0269s/iter; left time: 904.4581s
	iters: 300, epoch: 29 | loss: 0.0000052
	speed: 0.0255s/iter; left time: 852.8054s
	iters: 400, epoch: 29 | loss: 0.1508595
	speed: 0.0256s/iter; left time: 854.6353s
Epoch: 29 cost time: 12.511577129364014
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000017
	speed: 0.1367s/iter; left time: 4539.0979s
	iters: 200, epoch: 30 | loss: 0.0015631
	speed: 0.0257s/iter; left time: 849.3898s
	iters: 300, epoch: 30 | loss: 0.0093140
	speed: 0.0249s/iter; left time: 823.3214s
	iters: 400, epoch: 30 | loss: 0.0000132
	speed: 0.0248s/iter; left time: 815.8587s
Epoch: 30 cost time: 12.183410882949829
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000302
	speed: 0.1371s/iter; left time: 4488.7382s
	iters: 200, epoch: 31 | loss: 0.0000113
	speed: 0.0270s/iter; left time: 879.7856s
	iters: 300, epoch: 31 | loss: 0.0002652
	speed: 0.0259s/iter; left time: 842.5101s
	iters: 400, epoch: 31 | loss: 0.0000227
	speed: 0.0250s/iter; left time: 812.3902s
Epoch: 31 cost time: 12.469895124435425
Epoch: 31, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0014094
	speed: 0.1338s/iter; left time: 4317.4204s
	iters: 200, epoch: 32 | loss: 0.0007565
	speed: 0.0274s/iter; left time: 880.0292s
	iters: 300, epoch: 32 | loss: 0.0023948
	speed: 0.0261s/iter; left time: 836.4309s
	iters: 400, epoch: 32 | loss: 0.0001007
	speed: 0.0255s/iter; left time: 815.9580s
Epoch: 32 cost time: 12.378053665161133
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0039793
	speed: 0.1382s/iter; left time: 4393.4378s
	iters: 200, epoch: 33 | loss: 0.0020761
	speed: 0.0255s/iter; left time: 809.5330s
	iters: 300, epoch: 33 | loss: 0.0015155
	speed: 0.0246s/iter; left time: 776.0080s
	iters: 400, epoch: 33 | loss: 0.0000030
	speed: 0.0237s/iter; left time: 747.6369s
Epoch: 33 cost time: 12.094855070114136
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 222754
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6802011
	speed: 0.0432s/iter; left time: 2022.7771s
	iters: 200, epoch: 1 | loss: 0.1930040
	speed: 0.0245s/iter; left time: 1143.4066s
	iters: 300, epoch: 1 | loss: 0.1357168
	speed: 0.0238s/iter; left time: 1111.1180s
	iters: 400, epoch: 1 | loss: 0.1463591
	speed: 0.0233s/iter; left time: 1082.2778s
Epoch: 1 cost time: 13.185916900634766
Epoch: 1, Steps: 469 | Train Loss: 0.487 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (inf --> -0.945681).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0481699
	speed: 0.1337s/iter; left time: 6195.5030s
	iters: 200, epoch: 2 | loss: 0.0031961
	speed: 0.0264s/iter; left time: 1221.6762s
	iters: 300, epoch: 2 | loss: 0.2264648
	speed: 0.0263s/iter; left time: 1215.5729s
	iters: 400, epoch: 2 | loss: 0.0424390
	speed: 0.0284s/iter; left time: 1309.4907s
Epoch: 2 cost time: 13.273743391036987
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.945681 --> -0.955687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0384631
	speed: 0.1425s/iter; left time: 6535.8695s
	iters: 200, epoch: 3 | loss: 0.0021422
	speed: 0.0259s/iter; left time: 1183.2163s
	iters: 300, epoch: 3 | loss: 0.0314144
	speed: 0.0258s/iter; left time: 1177.3738s
	iters: 400, epoch: 3 | loss: 0.0106192
	speed: 0.0268s/iter; left time: 1220.0095s
Epoch: 3 cost time: 12.70664644241333
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.955687 --> -0.962834).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2604088
	speed: 0.1478s/iter; left time: 6708.1943s
	iters: 200, epoch: 4 | loss: 0.0119314
	speed: 0.0260s/iter; left time: 1179.2173s
	iters: 300, epoch: 4 | loss: 0.1578763
	speed: 0.0246s/iter; left time: 1110.4841s
	iters: 400, epoch: 4 | loss: 0.0014064
	speed: 0.0246s/iter; left time: 1110.5816s
Epoch: 4 cost time: 12.646884202957153
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.962834 --> -0.972840).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0036044
	speed: 0.1335s/iter; left time: 5999.4879s
	iters: 200, epoch: 5 | loss: 0.0007945
	speed: 0.0253s/iter; left time: 1133.4996s
	iters: 300, epoch: 5 | loss: 0.0373802
	speed: 0.0249s/iter; left time: 1114.8181s
	iters: 400, epoch: 5 | loss: 0.0004695
	speed: 0.0247s/iter; left time: 1103.0480s
Epoch: 5 cost time: 12.292720079421997
Epoch: 5, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0151262
	speed: 0.1345s/iter; left time: 5978.2037s
	iters: 200, epoch: 6 | loss: 0.0010637
	speed: 0.0247s/iter; left time: 1095.9386s
	iters: 300, epoch: 6 | loss: 0.0001530
	speed: 0.0249s/iter; left time: 1100.8155s
	iters: 400, epoch: 6 | loss: 0.0024855
	speed: 0.0275s/iter; left time: 1213.1169s
Epoch: 6 cost time: 12.387424945831299
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973412).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0064377
	speed: 0.1383s/iter; left time: 6081.3412s
	iters: 200, epoch: 7 | loss: 0.0027424
	speed: 0.0265s/iter; left time: 1162.9834s
	iters: 300, epoch: 7 | loss: 0.0008204
	speed: 0.0241s/iter; left time: 1053.4554s
	iters: 400, epoch: 7 | loss: 0.0001862
	speed: 0.0225s/iter; left time: 984.1037s
Epoch: 7 cost time: 12.017934322357178
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.973412 --> -0.982560).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0035868
	speed: 0.1335s/iter; left time: 5810.0535s
	iters: 200, epoch: 8 | loss: 0.0088360
	speed: 0.0246s/iter; left time: 1069.0030s
	iters: 300, epoch: 8 | loss: 0.0243827
	speed: 0.0240s/iter; left time: 1039.2397s
	iters: 400, epoch: 8 | loss: 0.0072143
	speed: 0.0231s/iter; left time: 997.5754s
Epoch: 8 cost time: 11.664580821990967
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0033654
	speed: 0.1316s/iter; left time: 5667.0674s
	iters: 200, epoch: 9 | loss: 0.0295589
	speed: 0.0243s/iter; left time: 1042.8691s
	iters: 300, epoch: 9 | loss: 0.0003355
	speed: 0.0227s/iter; left time: 973.0971s
	iters: 400, epoch: 9 | loss: 0.0389552
	speed: 0.0247s/iter; left time: 1056.2450s
Epoch: 9 cost time: 11.694079160690308
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0041088
	speed: 0.1361s/iter; left time: 5796.0383s
	iters: 200, epoch: 10 | loss: 0.0003689
	speed: 0.0266s/iter; left time: 1128.5437s
	iters: 300, epoch: 10 | loss: 0.0000185
	speed: 0.0262s/iter; left time: 1111.8526s
	iters: 400, epoch: 10 | loss: 0.0010367
	speed: 0.0253s/iter; left time: 1068.7009s
Epoch: 10 cost time: 12.681135177612305
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000805
	speed: 0.1389s/iter; left time: 5848.0293s
	iters: 200, epoch: 11 | loss: 0.0032495
	speed: 0.0274s/iter; left time: 1152.2992s
	iters: 300, epoch: 11 | loss: 0.0000939
	speed: 0.0286s/iter; left time: 1197.2103s
	iters: 400, epoch: 11 | loss: 0.0028002
	speed: 0.0260s/iter; left time: 1088.3716s
Epoch: 11 cost time: 13.125980615615845
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0353956
	speed: 0.1389s/iter; left time: 5785.6196s
	iters: 200, epoch: 12 | loss: 0.0001066
	speed: 0.0259s/iter; left time: 1074.4142s
	iters: 300, epoch: 12 | loss: 0.0000954
	speed: 0.0271s/iter; left time: 1124.6883s
	iters: 400, epoch: 12 | loss: 0.0002393
	speed: 0.0255s/iter; left time: 1053.0825s
Epoch: 12 cost time: 12.51021671295166
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000229
	speed: 0.1370s/iter; left time: 5639.8635s
	iters: 200, epoch: 13 | loss: 0.0096800
	speed: 0.0244s/iter; left time: 1001.8860s
	iters: 300, epoch: 13 | loss: 0.0000023
	speed: 0.0241s/iter; left time: 989.4821s
	iters: 400, epoch: 13 | loss: 0.0000862
	speed: 0.0227s/iter; left time: 927.6848s
Epoch: 13 cost time: 11.53187870979309
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0008729
	speed: 0.1251s/iter; left time: 5092.5090s
	iters: 200, epoch: 14 | loss: 0.0018083
	speed: 0.0220s/iter; left time: 894.4840s
	iters: 300, epoch: 14 | loss: 0.0000477
	speed: 0.0218s/iter; left time: 884.2929s
	iters: 400, epoch: 14 | loss: 0.0002016
	speed: 0.0226s/iter; left time: 913.7011s
Epoch: 14 cost time: 11.090831756591797
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0045407
	speed: 0.1252s/iter; left time: 5036.9227s
	iters: 200, epoch: 15 | loss: 0.1899607
	speed: 0.0220s/iter; left time: 881.0224s
	iters: 300, epoch: 15 | loss: 0.0002111
	speed: 0.0228s/iter; left time: 914.2198s
	iters: 400, epoch: 15 | loss: 0.0970370
	speed: 0.0244s/iter; left time: 974.8161s
Epoch: 15 cost time: 11.270349025726318
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0022085
	speed: 0.1309s/iter; left time: 5203.9756s
	iters: 200, epoch: 16 | loss: 0.0176446
	speed: 0.0270s/iter; left time: 1071.8891s
	iters: 300, epoch: 16 | loss: 0.0001083
	speed: 0.0261s/iter; left time: 1033.7225s
	iters: 400, epoch: 16 | loss: 0.0000087
	speed: 0.0229s/iter; left time: 904.0843s
Epoch: 16 cost time: 12.155015230178833
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000350
	speed: 0.1318s/iter; left time: 5177.7928s
	iters: 200, epoch: 17 | loss: 0.0199285
	speed: 0.0265s/iter; left time: 1038.8224s
	iters: 300, epoch: 17 | loss: 0.0009175
	speed: 0.0250s/iter; left time: 976.9311s
	iters: 400, epoch: 17 | loss: 0.0000138
	speed: 0.0250s/iter; left time: 976.3101s
Epoch: 17 cost time: 12.513204574584961
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 222754
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4671064
	speed: 0.0474s/iter; left time: 2217.6276s
	iters: 200, epoch: 1 | loss: 0.4316483
	speed: 0.0266s/iter; left time: 1240.9497s
	iters: 300, epoch: 1 | loss: 0.0710918
	speed: 0.0256s/iter; left time: 1191.7525s
	iters: 400, epoch: 1 | loss: 0.1612219
	speed: 0.0271s/iter; left time: 1259.7293s
Epoch: 1 cost time: 14.609453201293945
Epoch: 1, Steps: 469 | Train Loss: 0.468 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
Validation loss decreased (inf --> -0.943394).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1023058
	speed: 0.1442s/iter; left time: 6681.0472s
	iters: 200, epoch: 2 | loss: 0.0707926
	speed: 0.0281s/iter; left time: 1298.0451s
	iters: 300, epoch: 2 | loss: 0.0132674
	speed: 0.0283s/iter; left time: 1304.7415s
	iters: 400, epoch: 2 | loss: 0.0144444
	speed: 0.0298s/iter; left time: 1372.2747s
Epoch: 2 cost time: 13.604132890701294
Epoch: 2, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.943394 --> -0.961691).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0772397
	speed: 0.1439s/iter; left time: 6597.7171s
	iters: 200, epoch: 3 | loss: 0.0563054
	speed: 0.0277s/iter; left time: 1265.3791s
	iters: 300, epoch: 3 | loss: 0.1557825
	speed: 0.0262s/iter; left time: 1198.4211s
	iters: 400, epoch: 3 | loss: 0.0108718
	speed: 0.0269s/iter; left time: 1223.9582s
Epoch: 3 cost time: 13.004271507263184
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.967409).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0034465
	speed: 0.1386s/iter; left time: 6292.0198s
	iters: 200, epoch: 4 | loss: 0.0018391
	speed: 0.0245s/iter; left time: 1110.0435s
	iters: 300, epoch: 4 | loss: 0.0043047
	speed: 0.0248s/iter; left time: 1121.1750s
	iters: 400, epoch: 4 | loss: 0.0007172
	speed: 0.0252s/iter; left time: 1137.7777s
Epoch: 4 cost time: 12.151572942733765
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2368519
	speed: 0.1427s/iter; left time: 6410.9955s
	iters: 200, epoch: 5 | loss: 0.0051424
	speed: 0.0253s/iter; left time: 1132.2856s
	iters: 300, epoch: 5 | loss: 0.0321336
	speed: 0.0263s/iter; left time: 1177.9692s
	iters: 400, epoch: 5 | loss: 0.0026327
	speed: 0.0267s/iter; left time: 1193.5445s
Epoch: 5 cost time: 12.660181760787964
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0626353
	speed: 0.1387s/iter; left time: 6164.6724s
	iters: 200, epoch: 6 | loss: 0.0004335
	speed: 0.0270s/iter; left time: 1198.8878s
	iters: 300, epoch: 6 | loss: 0.0201148
	speed: 0.0271s/iter; left time: 1198.3183s
	iters: 400, epoch: 6 | loss: 0.0018772
	speed: 0.0272s/iter; left time: 1199.5896s
Epoch: 6 cost time: 12.876708984375
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003728
	speed: 0.1376s/iter; left time: 6051.0851s
	iters: 200, epoch: 7 | loss: 0.0242448
	speed: 0.0256s/iter; left time: 1125.2987s
	iters: 300, epoch: 7 | loss: 0.1195603
	speed: 0.0259s/iter; left time: 1133.6124s
	iters: 400, epoch: 7 | loss: 0.1534742
	speed: 0.0262s/iter; left time: 1146.4938s
Epoch: 7 cost time: 12.5837082862854
Epoch: 7, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967409 --> -0.973412).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0886404
	speed: 0.1380s/iter; left time: 6007.4553s
	iters: 200, epoch: 8 | loss: 0.0077425
	speed: 0.0265s/iter; left time: 1151.3998s
	iters: 300, epoch: 8 | loss: 0.0086913
	speed: 0.0274s/iter; left time: 1188.7593s
	iters: 400, epoch: 8 | loss: 0.0008264
	speed: 0.0280s/iter; left time: 1212.1222s
Epoch: 8 cost time: 13.201650857925415
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.973412 --> -0.973984).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1109107
	speed: 0.1428s/iter; left time: 6146.1373s
	iters: 200, epoch: 9 | loss: 0.0321600
	speed: 0.0290s/iter; left time: 1244.9541s
	iters: 300, epoch: 9 | loss: 0.0994833
	speed: 0.0289s/iter; left time: 1236.3476s
	iters: 400, epoch: 9 | loss: 0.0014184
	speed: 0.0274s/iter; left time: 1172.2402s
Epoch: 9 cost time: 13.621122598648071
Epoch: 9, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.975699).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1535706
	speed: 0.1409s/iter; left time: 6000.6982s
	iters: 200, epoch: 10 | loss: 0.1885061
	speed: 0.0271s/iter; left time: 1149.4208s
	iters: 300, epoch: 10 | loss: 0.0089424
	speed: 0.0262s/iter; left time: 1109.4405s
	iters: 400, epoch: 10 | loss: 0.0015497
	speed: 0.0280s/iter; left time: 1182.9979s
Epoch: 10 cost time: 12.848899602890015
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0027408
	speed: 0.1421s/iter; left time: 5983.4407s
	iters: 200, epoch: 11 | loss: 0.0000556
	speed: 0.0269s/iter; left time: 1130.4072s
	iters: 300, epoch: 11 | loss: 0.0034663
	speed: 0.0265s/iter; left time: 1110.5904s
	iters: 400, epoch: 11 | loss: 0.0135824
	speed: 0.0283s/iter; left time: 1182.8949s
Epoch: 11 cost time: 13.166734457015991
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976557).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005106
	speed: 0.1367s/iter; left time: 5694.2574s
	iters: 200, epoch: 12 | loss: 0.0139213
	speed: 0.0267s/iter; left time: 1109.2064s
	iters: 300, epoch: 12 | loss: 0.1663444
	speed: 0.0267s/iter; left time: 1104.6090s
	iters: 400, epoch: 12 | loss: 0.0751734
	speed: 0.0263s/iter; left time: 1087.7531s
Epoch: 12 cost time: 12.712366819381714
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.976557 --> -0.980559).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2391646
	speed: 0.1384s/iter; left time: 5698.3306s
	iters: 200, epoch: 13 | loss: 0.0037677
	speed: 0.0247s/iter; left time: 1016.2533s
	iters: 300, epoch: 13 | loss: 0.0999491
	speed: 0.0243s/iter; left time: 996.2223s
	iters: 400, epoch: 13 | loss: 0.0365904
	speed: 0.0257s/iter; left time: 1052.4673s
Epoch: 13 cost time: 12.077003955841064
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.981703).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0082059
	speed: 0.1386s/iter; left time: 5643.2686s
	iters: 200, epoch: 14 | loss: 0.0034256
	speed: 0.0233s/iter; left time: 944.6759s
	iters: 300, epoch: 14 | loss: 0.0003203
	speed: 0.0238s/iter; left time: 964.7488s
	iters: 400, epoch: 14 | loss: 0.2977310
	speed: 0.0238s/iter; left time: 962.6134s
Epoch: 14 cost time: 11.801105499267578
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0190676
	speed: 0.1394s/iter; left time: 5609.2644s
	iters: 200, epoch: 15 | loss: 0.0004899
	speed: 0.0254s/iter; left time: 1020.1201s
	iters: 300, epoch: 15 | loss: 0.0341932
	speed: 0.0258s/iter; left time: 1033.3229s
	iters: 400, epoch: 15 | loss: 0.0195173
	speed: 0.0248s/iter; left time: 990.3235s
Epoch: 15 cost time: 12.353193759918213
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0034598
	speed: 0.1380s/iter; left time: 5487.7139s
	iters: 200, epoch: 16 | loss: 0.0011997
	speed: 0.0262s/iter; left time: 1041.2062s
	iters: 300, epoch: 16 | loss: 0.0000303
	speed: 0.0262s/iter; left time: 1034.9105s
	iters: 400, epoch: 16 | loss: 0.0006122
	speed: 0.0262s/iter; left time: 1034.2978s
Epoch: 16 cost time: 12.615352392196655
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0053400
	speed: 0.1400s/iter; left time: 5502.2708s
	iters: 200, epoch: 17 | loss: 0.1355947
	speed: 0.0263s/iter; left time: 1031.4528s
	iters: 300, epoch: 17 | loss: 0.0004209
	speed: 0.0261s/iter; left time: 1019.2765s
	iters: 400, epoch: 17 | loss: 0.0026559
	speed: 0.0264s/iter; left time: 1029.7993s
Epoch: 17 cost time: 12.888466596603394
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0001926
	speed: 0.1416s/iter; left time: 5498.6485s
	iters: 200, epoch: 18 | loss: 0.0054773
	speed: 0.0262s/iter; left time: 1012.7963s
	iters: 300, epoch: 18 | loss: 0.0000973
	speed: 0.0288s/iter; left time: 1113.2986s
	iters: 400, epoch: 18 | loss: 0.0861553
	speed: 0.0280s/iter; left time: 1078.7149s
Epoch: 18 cost time: 13.087206840515137
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0480266
	speed: 0.1410s/iter; left time: 5410.3779s
	iters: 200, epoch: 19 | loss: 0.0293283
	speed: 0.0283s/iter; left time: 1081.7922s
	iters: 300, epoch: 19 | loss: 0.0059898
	speed: 0.0266s/iter; left time: 1016.3126s
	iters: 400, epoch: 19 | loss: 0.0029149
	speed: 0.0274s/iter; left time: 1041.5051s
Epoch: 19 cost time: 13.088033437728882
Epoch: 19, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0028006
	speed: 0.1443s/iter; left time: 5466.3802s
	iters: 200, epoch: 20 | loss: 0.0295807
	speed: 0.0253s/iter; left time: 956.9540s
	iters: 300, epoch: 20 | loss: 0.0004432
	speed: 0.0260s/iter; left time: 981.5462s
	iters: 400, epoch: 20 | loss: 0.0000372
	speed: 0.0254s/iter; left time: 956.3753s
Epoch: 20 cost time: 12.347928524017334
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0037609
	speed: 0.1344s/iter; left time: 5028.2178s
	iters: 200, epoch: 21 | loss: 0.0243999
	speed: 0.0245s/iter; left time: 915.9849s
	iters: 300, epoch: 21 | loss: 0.0297637
	speed: 0.0263s/iter; left time: 980.3484s
	iters: 400, epoch: 21 | loss: 0.0071408
	speed: 0.0234s/iter; left time: 868.0919s
Epoch: 21 cost time: 11.976472854614258
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000645
	speed: 0.1245s/iter; left time: 4599.5606s
	iters: 200, epoch: 22 | loss: 0.0160543
	speed: 0.0270s/iter; left time: 995.0712s
	iters: 300, epoch: 22 | loss: 0.0031357
	speed: 0.0265s/iter; left time: 972.8952s
	iters: 400, epoch: 22 | loss: 0.0278468
	speed: 0.0267s/iter; left time: 977.0929s
Epoch: 22 cost time: 12.775477409362793
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.2508932
	speed: 0.1386s/iter; left time: 5057.1741s
	iters: 200, epoch: 23 | loss: 0.0003056
	speed: 0.0253s/iter; left time: 921.3571s
	iters: 300, epoch: 23 | loss: 0.0027376
	speed: 0.0247s/iter; left time: 894.6789s
	iters: 400, epoch: 23 | loss: 0.0005983
	speed: 0.0246s/iter; left time: 890.6095s
Epoch: 23 cost time: 12.145067691802979
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.981703 --> -0.983132).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1943592
	speed: 0.1428s/iter; left time: 5142.5505s
	iters: 200, epoch: 24 | loss: 0.0652352
	speed: 0.0252s/iter; left time: 903.5278s
	iters: 300, epoch: 24 | loss: 0.0000416
	speed: 0.0246s/iter; left time: 881.8479s
	iters: 400, epoch: 24 | loss: 0.0006866
	speed: 0.0264s/iter; left time: 943.4962s
Epoch: 24 cost time: 12.510445594787598
Epoch: 24, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0001494
	speed: 0.1362s/iter; left time: 4841.1779s
	iters: 200, epoch: 25 | loss: 0.0000628
	speed: 0.0245s/iter; left time: 869.1864s
	iters: 300, epoch: 25 | loss: 0.0001692
	speed: 0.0272s/iter; left time: 962.3890s
	iters: 400, epoch: 25 | loss: 0.0001632
	speed: 0.0247s/iter; left time: 872.2562s
Epoch: 25 cost time: 11.817973136901855
Epoch: 25, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0617697
	speed: 0.1242s/iter; left time: 4354.8284s
	iters: 200, epoch: 26 | loss: 0.0002562
	speed: 0.0196s/iter; left time: 684.7403s
	iters: 300, epoch: 26 | loss: 0.0000423
	speed: 0.0194s/iter; left time: 677.6659s
	iters: 400, epoch: 26 | loss: 0.0007854
	speed: 0.0189s/iter; left time: 656.9090s
Epoch: 26 cost time: 9.595927000045776
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.968 Test Loss: 0.203 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0001710
	speed: 0.1054s/iter; left time: 3647.3945s
	iters: 200, epoch: 27 | loss: 0.0002298
	speed: 0.0242s/iter; left time: 834.1989s
	iters: 300, epoch: 27 | loss: 0.0072793
	speed: 0.0261s/iter; left time: 897.4634s
	iters: 400, epoch: 27 | loss: 0.0019056
	speed: 0.0272s/iter; left time: 933.5878s
Epoch: 27 cost time: 12.42128849029541
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000084
	speed: 0.1413s/iter; left time: 4824.4618s
	iters: 200, epoch: 28 | loss: 0.0000225
	speed: 0.0263s/iter; left time: 895.5006s
	iters: 300, epoch: 28 | loss: 0.2644971
	speed: 0.0262s/iter; left time: 888.9912s
	iters: 400, epoch: 28 | loss: 0.0014438
	speed: 0.0258s/iter; left time: 871.6860s
Epoch: 28 cost time: 12.664689302444458
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1656678
	speed: 0.1371s/iter; left time: 4617.2247s
	iters: 200, epoch: 29 | loss: 0.1446584
	speed: 0.0261s/iter; left time: 877.7052s
	iters: 300, epoch: 29 | loss: 0.1081450
	speed: 0.0271s/iter; left time: 905.5312s
	iters: 400, epoch: 29 | loss: 0.0014636
	speed: 0.0248s/iter; left time: 828.9385s
Epoch: 29 cost time: 12.778561115264893
Epoch: 29, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0003523
	speed: 0.1357s/iter; left time: 4506.8263s
	iters: 200, epoch: 30 | loss: 0.0027806
	speed: 0.0244s/iter; left time: 807.7966s
	iters: 300, epoch: 30 | loss: 0.0009120
	speed: 0.0241s/iter; left time: 794.7186s
	iters: 400, epoch: 30 | loss: 0.0025427
	speed: 0.0268s/iter; left time: 880.8957s
Epoch: 30 cost time: 12.351000785827637
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0029225
	speed: 0.1351s/iter; left time: 4422.6808s
	iters: 200, epoch: 31 | loss: 0.0000262
	speed: 0.0237s/iter; left time: 773.6641s
	iters: 300, epoch: 31 | loss: 0.0008774
	speed: 0.0252s/iter; left time: 820.0330s
	iters: 400, epoch: 31 | loss: 0.0000396
	speed: 0.0253s/iter; left time: 821.1040s
Epoch: 31 cost time: 11.92250680923462
Epoch: 31, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0058032
	speed: 0.1338s/iter; left time: 4315.2346s
	iters: 200, epoch: 32 | loss: 0.0008109
	speed: 0.0264s/iter; left time: 847.9931s
	iters: 300, epoch: 32 | loss: 0.2315968
	speed: 0.0245s/iter; left time: 784.2004s
	iters: 400, epoch: 32 | loss: 0.0371931
	speed: 0.0247s/iter; left time: 788.8042s
Epoch: 32 cost time: 12.17391562461853
Epoch: 32, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0073007
	speed: 0.1357s/iter; left time: 4314.4235s
	iters: 200, epoch: 33 | loss: 0.0000068
	speed: 0.0246s/iter; left time: 780.7249s
	iters: 300, epoch: 33 | loss: 0.0010959
	speed: 0.0249s/iter; left time: 786.3765s
	iters: 400, epoch: 33 | loss: 0.0028911
	speed: 0.0253s/iter; left time: 795.2233s
Epoch: 33 cost time: 12.656912565231323
Epoch: 33, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9831332189822756
model parameter : 189986
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.4709395
	speed: 0.0417s/iter; left time: 1953.0960s
	iters: 200, epoch: 1 | loss: 0.4084331
	speed: 0.0262s/iter; left time: 1222.3253s
	iters: 300, epoch: 1 | loss: 0.1070123
	speed: 0.0270s/iter; left time: 1257.2937s
	iters: 400, epoch: 1 | loss: 0.2024310
	speed: 0.0235s/iter; left time: 1091.8870s
Epoch: 1 cost time: 13.430545330047607
Epoch: 1, Steps: 469 | Train Loss: 0.473 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
Validation loss decreased (inf --> -0.944538).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0809438
	speed: 0.1339s/iter; left time: 6201.6077s
	iters: 200, epoch: 2 | loss: 0.0389627
	speed: 0.0228s/iter; left time: 1054.2879s
	iters: 300, epoch: 2 | loss: 0.0131878
	speed: 0.0249s/iter; left time: 1146.9190s
	iters: 400, epoch: 2 | loss: 0.0129031
	speed: 0.0248s/iter; left time: 1140.6857s
Epoch: 2 cost time: 11.776768207550049
Epoch: 2, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.944538 --> -0.958546).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1444465
	speed: 0.1387s/iter; left time: 6360.5776s
	iters: 200, epoch: 3 | loss: 0.0630229
	speed: 0.0243s/iter; left time: 1112.7979s
	iters: 300, epoch: 3 | loss: 0.0473837
	speed: 0.0226s/iter; left time: 1030.1252s
	iters: 400, epoch: 3 | loss: 0.0401613
	speed: 0.0245s/iter; left time: 1116.0710s
Epoch: 3 cost time: 11.612064838409424
Epoch: 3, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.958546 --> -0.963978).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0008612
	speed: 0.1216s/iter; left time: 5519.4393s
	iters: 200, epoch: 4 | loss: 0.0066147
	speed: 0.0247s/iter; left time: 1117.6085s
	iters: 300, epoch: 4 | loss: 0.0122620
	speed: 0.0237s/iter; left time: 1070.7277s
	iters: 400, epoch: 4 | loss: 0.0007217
	speed: 0.0233s/iter; left time: 1052.1696s
Epoch: 4 cost time: 11.872305870056152
Epoch: 4, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0302490
	speed: 0.1335s/iter; left time: 5999.5919s
	iters: 200, epoch: 5 | loss: 0.0092374
	speed: 0.0272s/iter; left time: 1217.5597s
	iters: 300, epoch: 5 | loss: 0.0389096
	speed: 0.0296s/iter; left time: 1324.6522s
	iters: 400, epoch: 5 | loss: 0.0184993
	speed: 0.0274s/iter; left time: 1224.0595s
Epoch: 5 cost time: 13.386045694351196
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.963978 --> -0.971411).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2957391
	speed: 0.1420s/iter; left time: 6311.7430s
	iters: 200, epoch: 6 | loss: 0.0029702
	speed: 0.0257s/iter; left time: 1141.3966s
	iters: 300, epoch: 6 | loss: 0.1952684
	speed: 0.0250s/iter; left time: 1104.5289s
	iters: 400, epoch: 6 | loss: 0.0029224
	speed: 0.0262s/iter; left time: 1155.9247s
Epoch: 6 cost time: 12.537748575210571
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0035031
	speed: 0.1461s/iter; left time: 6426.3962s
	iters: 200, epoch: 7 | loss: 0.0064170
	speed: 0.0265s/iter; left time: 1164.0773s
	iters: 300, epoch: 7 | loss: 0.0809800
	speed: 0.0270s/iter; left time: 1184.2262s
	iters: 400, epoch: 7 | loss: 0.1802717
	speed: 0.0280s/iter; left time: 1224.8066s
Epoch: 7 cost time: 13.271230459213257
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.971411 --> -0.977129).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2219003
	speed: 0.1400s/iter; left time: 6092.1083s
	iters: 200, epoch: 8 | loss: 0.0062263
	speed: 0.0265s/iter; left time: 1148.8872s
	iters: 300, epoch: 8 | loss: 0.0008710
	speed: 0.0268s/iter; left time: 1159.4979s
	iters: 400, epoch: 8 | loss: 0.0057244
	speed: 0.0261s/iter; left time: 1128.9897s
Epoch: 8 cost time: 12.563654661178589
Epoch: 8, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.979130).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0177803
	speed: 0.1387s/iter; left time: 5970.1524s
	iters: 200, epoch: 9 | loss: 0.0011040
	speed: 0.0251s/iter; left time: 1077.0479s
	iters: 300, epoch: 9 | loss: 0.0557985
	speed: 0.0246s/iter; left time: 1055.4745s
	iters: 400, epoch: 9 | loss: 0.0375054
	speed: 0.0254s/iter; left time: 1086.1602s
Epoch: 9 cost time: 12.279274940490723
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0185536
	speed: 0.1345s/iter; left time: 5727.7435s
	iters: 200, epoch: 10 | loss: 0.0042761
	speed: 0.0228s/iter; left time: 970.1197s
	iters: 300, epoch: 10 | loss: 0.0028011
	speed: 0.0237s/iter; left time: 1003.2797s
	iters: 400, epoch: 10 | loss: 0.0004829
	speed: 0.0265s/iter; left time: 1121.7286s
Epoch: 10 cost time: 12.019190549850464
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0007250
	speed: 0.1419s/iter; left time: 5974.8704s
	iters: 200, epoch: 11 | loss: 0.0008301
	speed: 0.0259s/iter; left time: 1087.7822s
	iters: 300, epoch: 11 | loss: 0.0025781
	speed: 0.0243s/iter; left time: 1019.8357s
	iters: 400, epoch: 11 | loss: 0.0166360
	speed: 0.0232s/iter; left time: 969.0804s
Epoch: 11 cost time: 11.949382305145264
Epoch: 11, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979987).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0008376
	speed: 0.1342s/iter; left time: 5588.9906s
	iters: 200, epoch: 12 | loss: 0.0543779
	speed: 0.0253s/iter; left time: 1050.0611s
	iters: 300, epoch: 12 | loss: 0.0135041
	speed: 0.0238s/iter; left time: 985.7396s
	iters: 400, epoch: 12 | loss: 0.1301461
	speed: 0.0244s/iter; left time: 1008.7670s
Epoch: 12 cost time: 12.044562816619873
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0603385
	speed: 0.1327s/iter; left time: 5464.2135s
	iters: 200, epoch: 13 | loss: 0.0000258
	speed: 0.0241s/iter; left time: 989.0205s
	iters: 300, epoch: 13 | loss: 0.0580037
	speed: 0.0250s/iter; left time: 1023.4475s
	iters: 400, epoch: 13 | loss: 0.0105448
	speed: 0.0252s/iter; left time: 1028.3531s
Epoch: 13 cost time: 12.114211082458496
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0109869
	speed: 0.1299s/iter; left time: 5286.7267s
	iters: 200, epoch: 14 | loss: 0.0005613
	speed: 0.0237s/iter; left time: 962.4287s
	iters: 300, epoch: 14 | loss: 0.0004726
	speed: 0.0227s/iter; left time: 920.5781s
	iters: 400, epoch: 14 | loss: 0.2322338
	speed: 0.0222s/iter; left time: 897.1837s
Epoch: 14 cost time: 11.556639432907104
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0001497
	speed: 0.1352s/iter; left time: 5438.7409s
	iters: 200, epoch: 15 | loss: 0.0030273
	speed: 0.0263s/iter; left time: 1054.3906s
	iters: 300, epoch: 15 | loss: 0.0004367
	speed: 0.0277s/iter; left time: 1109.3459s
	iters: 400, epoch: 15 | loss: 0.2615510
	speed: 0.0275s/iter; left time: 1098.2192s
Epoch: 15 cost time: 12.952304124832153
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000717
	speed: 0.1328s/iter; left time: 5281.0636s
	iters: 200, epoch: 16 | loss: 0.0039193
	speed: 0.0285s/iter; left time: 1132.0262s
	iters: 300, epoch: 16 | loss: 0.0001759
	speed: 0.0253s/iter; left time: 1001.4718s
	iters: 400, epoch: 16 | loss: 0.0208541
	speed: 0.0249s/iter; left time: 981.0789s
Epoch: 16 cost time: 12.43823790550232
Epoch: 16, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0402728
	speed: 0.1288s/iter; left time: 5061.1762s
	iters: 200, epoch: 17 | loss: 0.0006272
	speed: 0.0231s/iter; left time: 906.6125s
	iters: 300, epoch: 17 | loss: 0.0000784
	speed: 0.0231s/iter; left time: 904.2452s
	iters: 400, epoch: 17 | loss: 0.0004335
	speed: 0.0222s/iter; left time: 866.4567s
Epoch: 17 cost time: 11.083255290985107
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0007218
	speed: 0.1298s/iter; left time: 5040.9025s
	iters: 200, epoch: 18 | loss: 0.0000137
	speed: 0.0218s/iter; left time: 845.9763s
	iters: 300, epoch: 18 | loss: 0.0001429
	speed: 0.0241s/iter; left time: 932.2650s
	iters: 400, epoch: 18 | loss: 0.0367174
	speed: 0.0240s/iter; left time: 923.6983s
Epoch: 18 cost time: 11.642105340957642
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0585789
	speed: 0.1329s/iter; left time: 5099.6027s
	iters: 200, epoch: 19 | loss: 0.0016638
	speed: 0.0237s/iter; left time: 908.2795s
	iters: 300, epoch: 19 | loss: 0.0242513
	speed: 0.0256s/iter; left time: 978.2428s
	iters: 400, epoch: 19 | loss: 0.2590063
	speed: 0.0258s/iter; left time: 982.3472s
Epoch: 19 cost time: 12.114513874053955
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0012396
	speed: 0.1418s/iter; left time: 5371.4475s
	iters: 200, epoch: 20 | loss: 0.0001853
	speed: 0.0259s/iter; left time: 980.4134s
	iters: 300, epoch: 20 | loss: 0.0000754
	speed: 0.0258s/iter; left time: 972.5341s
	iters: 400, epoch: 20 | loss: 0.0000088
	speed: 0.0259s/iter; left time: 972.4464s
Epoch: 20 cost time: 12.706627368927002
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0141208
	speed: 0.1396s/iter; left time: 5223.7188s
	iters: 200, epoch: 21 | loss: 0.0361701
	speed: 0.0251s/iter; left time: 937.8260s
	iters: 300, epoch: 21 | loss: 0.0012196
	speed: 0.0254s/iter; left time: 944.4899s
	iters: 400, epoch: 21 | loss: 0.0004594
	speed: 0.0253s/iter; left time: 940.2116s
Epoch: 21 cost time: 12.366054773330688
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.981 Test Loss: 0.136 Test Acc: 0.981
Validation loss decreased (-0.979987 --> -0.980845).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0003788
	speed: 0.1413s/iter; left time: 5222.7396s
	iters: 200, epoch: 22 | loss: 0.1369139
	speed: 0.0262s/iter; left time: 964.4221s
	iters: 300, epoch: 22 | loss: 0.0000014
	speed: 0.0272s/iter; left time: 998.8335s
	iters: 400, epoch: 22 | loss: 0.0008600
	speed: 0.0284s/iter; left time: 1039.8674s
Epoch: 22 cost time: 13.298086881637573
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.4524936
	speed: 0.1419s/iter; left time: 5177.5206s
	iters: 200, epoch: 23 | loss: 0.0047166
	speed: 0.0268s/iter; left time: 973.5015s
	iters: 300, epoch: 23 | loss: 0.0003245
	speed: 0.0272s/iter; left time: 987.0794s
	iters: 400, epoch: 23 | loss: 0.0116899
	speed: 0.0263s/iter; left time: 950.2613s
Epoch: 23 cost time: 13.061903953552246
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
Validation loss decreased (-0.980845 --> -0.981417).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0405584
	speed: 0.1437s/iter; left time: 5174.7745s
	iters: 200, epoch: 24 | loss: 0.0146609
	speed: 0.0276s/iter; left time: 992.6224s
	iters: 300, epoch: 24 | loss: 0.0000916
	speed: 0.0268s/iter; left time: 960.7909s
	iters: 400, epoch: 24 | loss: 0.0001451
	speed: 0.0266s/iter; left time: 951.1330s
Epoch: 24 cost time: 13.313503980636597
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0742209
	speed: 0.1425s/iter; left time: 5065.2273s
	iters: 200, epoch: 25 | loss: 0.0000150
	speed: 0.0274s/iter; left time: 970.2135s
	iters: 300, epoch: 25 | loss: 0.0001484
	speed: 0.0280s/iter; left time: 990.2192s
	iters: 400, epoch: 25 | loss: 0.0118703
	speed: 0.0265s/iter; left time: 933.0970s
Epoch: 25 cost time: 12.861310243606567
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0106116
	speed: 0.1409s/iter; left time: 4942.9481s
	iters: 200, epoch: 26 | loss: 0.0050270
	speed: 0.0270s/iter; left time: 944.9930s
	iters: 300, epoch: 26 | loss: 0.0004139
	speed: 0.0255s/iter; left time: 887.7256s
	iters: 400, epoch: 26 | loss: 0.0277834
	speed: 0.0249s/iter; left time: 866.1528s
Epoch: 26 cost time: 12.46459174156189
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2209762
	speed: 0.1431s/iter; left time: 4952.3381s
	iters: 200, epoch: 27 | loss: 0.0026818
	speed: 0.0259s/iter; left time: 892.8668s
	iters: 300, epoch: 27 | loss: 0.0003801
	speed: 0.0258s/iter; left time: 887.0476s
	iters: 400, epoch: 27 | loss: 0.0000611
	speed: 0.0257s/iter; left time: 881.4757s
Epoch: 27 cost time: 12.355039358139038
Epoch: 27, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000817
	speed: 0.1383s/iter; left time: 4720.7160s
	iters: 200, epoch: 28 | loss: 0.0012983
	speed: 0.0266s/iter; left time: 905.1682s
	iters: 300, epoch: 28 | loss: 0.1809980
	speed: 0.0261s/iter; left time: 885.4531s
	iters: 400, epoch: 28 | loss: 0.0001168
	speed: 0.0264s/iter; left time: 892.5640s
Epoch: 28 cost time: 12.614678144454956
Epoch: 28, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0007139
	speed: 0.1261s/iter; left time: 4245.5549s
	iters: 200, epoch: 29 | loss: 0.0216867
	speed: 0.0241s/iter; left time: 809.8708s
	iters: 300, epoch: 29 | loss: 0.0025357
	speed: 0.0268s/iter; left time: 897.9210s
	iters: 400, epoch: 29 | loss: 0.0177965
	speed: 0.0253s/iter; left time: 844.7941s
Epoch: 29 cost time: 12.199548721313477
Epoch: 29, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000004
	speed: 0.1399s/iter; left time: 4644.8049s
	iters: 200, epoch: 30 | loss: 0.0293751
	speed: 0.0245s/iter; left time: 810.7899s
	iters: 300, epoch: 30 | loss: 0.0004209
	speed: 0.0252s/iter; left time: 830.4501s
	iters: 400, epoch: 30 | loss: 0.0708549
	speed: 0.0245s/iter; left time: 805.7091s
Epoch: 30 cost time: 12.324505805969238
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0005119
	speed: 0.1421s/iter; left time: 4651.2711s
	iters: 200, epoch: 31 | loss: 0.0000028
	speed: 0.0251s/iter; left time: 818.0808s
	iters: 300, epoch: 31 | loss: 0.0000043
	speed: 0.0263s/iter; left time: 854.7772s
	iters: 400, epoch: 31 | loss: 0.0000140
	speed: 0.0275s/iter; left time: 891.4708s
Epoch: 31 cost time: 12.886761903762817
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0391686
	speed: 0.1455s/iter; left time: 4694.2564s
	iters: 200, epoch: 32 | loss: 0.0017190
	speed: 0.0228s/iter; left time: 734.4745s
	iters: 300, epoch: 32 | loss: 0.1666206
	speed: 0.0273s/iter; left time: 874.1999s
	iters: 400, epoch: 32 | loss: 0.0050073
	speed: 0.0274s/iter; left time: 874.7623s
Epoch: 32 cost time: 12.663352966308594
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0173647
	speed: 0.1414s/iter; left time: 4496.4147s
	iters: 200, epoch: 33 | loss: 0.0000142
	speed: 0.0280s/iter; left time: 888.1515s
	iters: 300, epoch: 33 | loss: 0.0001823
	speed: 0.0267s/iter; left time: 844.4603s
	iters: 400, epoch: 33 | loss: 0.0076941
	speed: 0.0258s/iter; left time: 811.8308s
Epoch: 33 cost time: 13.1257963180542
Epoch: 33, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 189986
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5604967
	speed: 0.0432s/iter; left time: 2020.8201s
	iters: 200, epoch: 1 | loss: 0.4199915
	speed: 0.0240s/iter; left time: 1122.3030s
	iters: 300, epoch: 1 | loss: 0.0756667
	speed: 0.0238s/iter; left time: 1110.3959s
	iters: 400, epoch: 1 | loss: 0.1846188
	speed: 0.0246s/iter; left time: 1141.9197s
Epoch: 1 cost time: 13.418311834335327
Epoch: 1, Steps: 469 | Train Loss: 0.485 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (inf --> -0.951399).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0442805
	speed: 0.1373s/iter; left time: 6363.0537s
	iters: 200, epoch: 2 | loss: 0.0386954
	speed: 0.0257s/iter; left time: 1186.3982s
	iters: 300, epoch: 2 | loss: 0.0115624
	speed: 0.0232s/iter; left time: 1069.0103s
	iters: 400, epoch: 2 | loss: 0.0081628
	speed: 0.0254s/iter; left time: 1169.2559s
Epoch: 2 cost time: 12.189777851104736
Epoch: 2, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.951399 --> -0.976557).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1956780
	speed: 0.1376s/iter; left time: 6309.5284s
	iters: 200, epoch: 3 | loss: 0.0506880
	speed: 0.0275s/iter; left time: 1260.6001s
	iters: 300, epoch: 3 | loss: 0.0078403
	speed: 0.0255s/iter; left time: 1166.2850s
	iters: 400, epoch: 3 | loss: 0.0104837
	speed: 0.0248s/iter; left time: 1128.6966s
Epoch: 3 cost time: 12.576071500778198
Epoch: 3, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0012107
	speed: 0.1343s/iter; left time: 6095.2907s
	iters: 200, epoch: 4 | loss: 0.0084291
	speed: 0.0250s/iter; left time: 1134.3435s
	iters: 300, epoch: 4 | loss: 0.0102392
	speed: 0.0252s/iter; left time: 1138.0146s
	iters: 400, epoch: 4 | loss: 0.0016580
	speed: 0.0247s/iter; left time: 1115.0800s
Epoch: 4 cost time: 12.169010400772095
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.1351968
	speed: 0.1344s/iter; left time: 6035.8033s
	iters: 200, epoch: 5 | loss: 0.0296640
	speed: 0.0255s/iter; left time: 1141.5755s
	iters: 300, epoch: 5 | loss: 0.0638515
	speed: 0.0265s/iter; left time: 1184.9861s
	iters: 400, epoch: 5 | loss: 0.0032510
	speed: 0.0243s/iter; left time: 1085.9054s
Epoch: 5 cost time: 12.494025230407715
Epoch: 5, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979416).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4027910
	speed: 0.1356s/iter; left time: 6026.2771s
	iters: 200, epoch: 6 | loss: 0.0017647
	speed: 0.0289s/iter; left time: 1282.5809s
	iters: 300, epoch: 6 | loss: 0.0031177
	speed: 0.0290s/iter; left time: 1283.3673s
	iters: 400, epoch: 6 | loss: 0.0110888
	speed: 0.0272s/iter; left time: 1201.4912s
Epoch: 6 cost time: 13.111083745956421
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0037155
	speed: 0.1345s/iter; left time: 5915.2171s
	iters: 200, epoch: 7 | loss: 0.0027651
	speed: 0.0275s/iter; left time: 1206.5387s
	iters: 300, epoch: 7 | loss: 0.1586657
	speed: 0.0270s/iter; left time: 1180.8621s
	iters: 400, epoch: 7 | loss: 0.0303974
	speed: 0.0260s/iter; left time: 1136.3226s
Epoch: 7 cost time: 12.679821968078613
Epoch: 7, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.972 Test Loss: 0.146 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0385536
	speed: 0.1411s/iter; left time: 6141.8325s
	iters: 200, epoch: 8 | loss: 0.0012393
	speed: 0.0267s/iter; left time: 1158.0410s
	iters: 300, epoch: 8 | loss: 0.0041754
	speed: 0.0265s/iter; left time: 1146.1072s
	iters: 400, epoch: 8 | loss: 0.1538618
	speed: 0.0263s/iter; left time: 1137.6524s
Epoch: 8 cost time: 12.887581586837769
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.979416 --> -0.979416).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0118531
	speed: 0.1349s/iter; left time: 5805.7040s
	iters: 200, epoch: 9 | loss: 0.0018545
	speed: 0.0271s/iter; left time: 1162.0889s
	iters: 300, epoch: 9 | loss: 0.0928687
	speed: 0.0265s/iter; left time: 1133.5547s
	iters: 400, epoch: 9 | loss: 0.0001808
	speed: 0.0272s/iter; left time: 1161.4210s
Epoch: 9 cost time: 12.820805549621582
Epoch: 9, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 1.1659865
	speed: 0.1314s/iter; left time: 5597.0472s
	iters: 200, epoch: 10 | loss: 0.3245138
	speed: 0.0269s/iter; left time: 1142.8346s
	iters: 300, epoch: 10 | loss: 0.0009015
	speed: 0.0279s/iter; left time: 1183.7988s
	iters: 400, epoch: 10 | loss: 0.0333706
	speed: 0.0250s/iter; left time: 1057.9894s
Epoch: 10 cost time: 12.516514539718628
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000903
	speed: 0.1349s/iter; left time: 5679.0356s
	iters: 200, epoch: 11 | loss: 0.0001441
	speed: 0.0248s/iter; left time: 1040.3300s
	iters: 300, epoch: 11 | loss: 0.0003462
	speed: 0.0239s/iter; left time: 1001.2061s
	iters: 400, epoch: 11 | loss: 0.0006641
	speed: 0.0239s/iter; left time: 1001.0427s
Epoch: 11 cost time: 11.912762880325317
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.984 Test Loss: 0.101 Test Acc: 0.984
Validation loss decreased (-0.979416 --> -0.984276).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000301
	speed: 0.1362s/iter; left time: 5671.2317s
	iters: 200, epoch: 12 | loss: 0.0409762
	speed: 0.0242s/iter; left time: 1004.1736s
	iters: 300, epoch: 12 | loss: 0.0094833
	speed: 0.0244s/iter; left time: 1012.2519s
	iters: 400, epoch: 12 | loss: 0.0057369
	speed: 0.0244s/iter; left time: 1008.6955s
Epoch: 12 cost time: 12.07357120513916
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0300767
	speed: 0.1350s/iter; left time: 5556.6460s
	iters: 200, epoch: 13 | loss: 0.0002506
	speed: 0.0250s/iter; left time: 1026.8853s
	iters: 300, epoch: 13 | loss: 0.0796991
	speed: 0.0250s/iter; left time: 1026.0690s
	iters: 400, epoch: 13 | loss: 0.0325078
	speed: 0.0247s/iter; left time: 1010.6305s
Epoch: 13 cost time: 12.14409852027893
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0008119
	speed: 0.1364s/iter; left time: 5551.5417s
	iters: 200, epoch: 14 | loss: 0.1013000
	speed: 0.0250s/iter; left time: 1016.8020s
	iters: 300, epoch: 14 | loss: 0.0001022
	speed: 0.0258s/iter; left time: 1046.1481s
	iters: 400, epoch: 14 | loss: 0.3732425
	speed: 0.0271s/iter; left time: 1093.8856s
Epoch: 14 cost time: 12.479005813598633
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000068
	speed: 0.1340s/iter; left time: 5391.0015s
	iters: 200, epoch: 15 | loss: 0.0000097
	speed: 0.0280s/iter; left time: 1123.4081s
	iters: 300, epoch: 15 | loss: 0.0022571
	speed: 0.0266s/iter; left time: 1065.0390s
	iters: 400, epoch: 15 | loss: 0.1448013
	speed: 0.0261s/iter; left time: 1042.4893s
Epoch: 15 cost time: 13.0606369972229
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000731
	speed: 0.1347s/iter; left time: 5354.5368s
	iters: 200, epoch: 16 | loss: 0.0007644
	speed: 0.0253s/iter; left time: 1002.6388s
	iters: 300, epoch: 16 | loss: 0.0015256
	speed: 0.0245s/iter; left time: 970.1668s
	iters: 400, epoch: 16 | loss: 0.1005670
	speed: 0.0245s/iter; left time: 966.1296s
Epoch: 16 cost time: 12.051241159439087
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000396
	speed: 0.1257s/iter; left time: 4938.6356s
	iters: 200, epoch: 17 | loss: 0.0001128
	speed: 0.0247s/iter; left time: 968.4978s
	iters: 300, epoch: 17 | loss: 0.0015629
	speed: 0.0287s/iter; left time: 1121.0623s
	iters: 400, epoch: 17 | loss: 0.0030803
	speed: 0.0285s/iter; left time: 1113.1049s
Epoch: 17 cost time: 12.866650819778442
Epoch: 17, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000884
	speed: 0.1347s/iter; left time: 5231.7677s
	iters: 200, epoch: 18 | loss: 0.0001654
	speed: 0.0262s/iter; left time: 1013.0673s
	iters: 300, epoch: 18 | loss: 0.0000037
	speed: 0.0252s/iter; left time: 975.0307s
	iters: 400, epoch: 18 | loss: 0.0001767
	speed: 0.0252s/iter; left time: 971.1677s
Epoch: 18 cost time: 12.383484840393066
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0136037
	speed: 0.1340s/iter; left time: 5141.2582s
	iters: 200, epoch: 19 | loss: 0.0563166
	speed: 0.0258s/iter; left time: 986.7235s
	iters: 300, epoch: 19 | loss: 0.0050459
	speed: 0.0258s/iter; left time: 985.4815s
	iters: 400, epoch: 19 | loss: 0.0326119
	speed: 0.0250s/iter; left time: 953.1803s
Epoch: 19 cost time: 12.31155014038086
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0006969
	speed: 0.1338s/iter; left time: 5069.3197s
	iters: 200, epoch: 20 | loss: 0.0000303
	speed: 0.0252s/iter; left time: 952.5635s
	iters: 300, epoch: 20 | loss: 0.0001885
	speed: 0.0255s/iter; left time: 962.5916s
	iters: 400, epoch: 20 | loss: 0.0000047
	speed: 0.0246s/iter; left time: 924.1671s
Epoch: 20 cost time: 12.111555337905884
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0038308
	speed: 0.1375s/iter; left time: 5145.6801s
	iters: 200, epoch: 21 | loss: 0.0000004
	speed: 0.0250s/iter; left time: 932.0572s
	iters: 300, epoch: 21 | loss: 0.0009253
	speed: 0.0249s/iter; left time: 924.9758s
	iters: 400, epoch: 21 | loss: 0.0004089
	speed: 0.0246s/iter; left time: 912.9870s
Epoch: 21 cost time: 11.82009482383728
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 189986
model size : 5.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0388014
	speed: 0.0441s/iter; left time: 2065.0809s
	iters: 200, epoch: 1 | loss: 0.3034391
	speed: 0.0263s/iter; left time: 1228.9885s
	iters: 300, epoch: 1 | loss: 0.3025185
	speed: 0.0276s/iter; left time: 1287.3651s
	iters: 400, epoch: 1 | loss: 0.4254342
	speed: 0.0268s/iter; left time: 1244.9280s
Epoch: 1 cost time: 14.303947448730469
Epoch: 1, Steps: 469 | Train Loss: 0.626 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
Validation loss decreased (inf --> -0.919380).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0241139
	speed: 0.1369s/iter; left time: 6345.0231s
	iters: 200, epoch: 2 | loss: 0.1456402
	speed: 0.0291s/iter; left time: 1345.9533s
	iters: 300, epoch: 2 | loss: 0.0699006
	speed: 0.0259s/iter; left time: 1194.2354s
	iters: 400, epoch: 2 | loss: 0.0157030
	speed: 0.0256s/iter; left time: 1176.2250s
Epoch: 2 cost time: 12.94278860092163
Epoch: 2, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.919380 --> -0.957688).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0329317
	speed: 0.1311s/iter; left time: 6013.5492s
	iters: 200, epoch: 3 | loss: 0.0312810
	speed: 0.0249s/iter; left time: 1139.2711s
	iters: 300, epoch: 3 | loss: 0.1626402
	speed: 0.0246s/iter; left time: 1123.4029s
	iters: 400, epoch: 3 | loss: 0.0168917
	speed: 0.0262s/iter; left time: 1193.0637s
Epoch: 3 cost time: 11.979732513427734
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.957688 --> -0.962549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3810940
	speed: 0.1379s/iter; left time: 6258.3938s
	iters: 200, epoch: 4 | loss: 0.0126109
	speed: 0.0249s/iter; left time: 1126.0720s
	iters: 300, epoch: 4 | loss: 0.0205709
	speed: 0.0242s/iter; left time: 1092.9996s
	iters: 400, epoch: 4 | loss: 0.0019511
	speed: 0.0242s/iter; left time: 1089.9181s
Epoch: 4 cost time: 11.617008924484253
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0121707
	speed: 0.1310s/iter; left time: 5885.8810s
	iters: 200, epoch: 5 | loss: 0.0024843
	speed: 0.0225s/iter; left time: 1008.8311s
	iters: 300, epoch: 5 | loss: 0.0189130
	speed: 0.0260s/iter; left time: 1162.3522s
	iters: 400, epoch: 5 | loss: 0.0262826
	speed: 0.0261s/iter; left time: 1163.0047s
Epoch: 5 cost time: 11.935282230377197
Epoch: 5, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0041289
	speed: 0.1284s/iter; left time: 5706.2101s
	iters: 200, epoch: 6 | loss: 0.0388215
	speed: 0.0258s/iter; left time: 1143.9742s
	iters: 300, epoch: 6 | loss: 0.0028034
	speed: 0.0237s/iter; left time: 1048.1931s
	iters: 400, epoch: 6 | loss: 0.0030769
	speed: 0.0234s/iter; left time: 1034.3920s
Epoch: 6 cost time: 11.64965295791626
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
Validation loss decreased (-0.962549 --> -0.966265).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1685601
	speed: 0.1273s/iter; left time: 5597.9555s
	iters: 200, epoch: 7 | loss: 0.0049838
	speed: 0.0257s/iter; left time: 1126.6010s
	iters: 300, epoch: 7 | loss: 0.4088665
	speed: 0.0242s/iter; left time: 1058.9796s
	iters: 400, epoch: 7 | loss: 0.0060270
	speed: 0.0247s/iter; left time: 1076.9343s
Epoch: 7 cost time: 11.89215350151062
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.966265 --> -0.969982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0193975
	speed: 0.1311s/iter; left time: 5706.7997s
	iters: 200, epoch: 8 | loss: 0.0195674
	speed: 0.0239s/iter; left time: 1037.8535s
	iters: 300, epoch: 8 | loss: 0.0148703
	speed: 0.0243s/iter; left time: 1050.9779s
	iters: 400, epoch: 8 | loss: 0.0788840
	speed: 0.0250s/iter; left time: 1081.8004s
Epoch: 8 cost time: 11.813195943832397
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0031459
	speed: 0.1330s/iter; left time: 5727.2188s
	iters: 200, epoch: 9 | loss: 0.0015088
	speed: 0.0241s/iter; left time: 1034.3323s
	iters: 300, epoch: 9 | loss: 0.0022976
	speed: 0.0246s/iter; left time: 1053.7098s
	iters: 400, epoch: 9 | loss: 0.0064098
	speed: 0.0243s/iter; left time: 1039.8300s
Epoch: 9 cost time: 11.695919275283813
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.969982 --> -0.977701).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0013413
	speed: 0.1399s/iter; left time: 5957.1012s
	iters: 200, epoch: 10 | loss: 0.0383395
	speed: 0.0225s/iter; left time: 956.5611s
	iters: 300, epoch: 10 | loss: 0.0001195
	speed: 0.0263s/iter; left time: 1114.2293s
	iters: 400, epoch: 10 | loss: 0.0012272
	speed: 0.0268s/iter; left time: 1134.6163s
Epoch: 10 cost time: 12.430641889572144
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0074316
	speed: 0.1370s/iter; left time: 5770.9412s
	iters: 200, epoch: 11 | loss: 0.0295932
	speed: 0.0276s/iter; left time: 1158.2046s
	iters: 300, epoch: 11 | loss: 0.0015563
	speed: 0.0259s/iter; left time: 1086.5611s
	iters: 400, epoch: 11 | loss: 0.0671192
	speed: 0.0252s/iter; left time: 1053.9770s
Epoch: 11 cost time: 12.80030083656311
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0113297
	speed: 0.1354s/iter; left time: 5637.6831s
	iters: 200, epoch: 12 | loss: 0.0869137
	speed: 0.0235s/iter; left time: 975.8703s
	iters: 300, epoch: 12 | loss: 0.0001567
	speed: 0.0252s/iter; left time: 1044.2428s
	iters: 400, epoch: 12 | loss: 0.0093292
	speed: 0.0257s/iter; left time: 1061.8306s
Epoch: 12 cost time: 12.185026168823242
Epoch: 12, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0515810
	speed: 0.1333s/iter; left time: 5490.1571s
	iters: 200, epoch: 13 | loss: 0.0009725
	speed: 0.0275s/iter; left time: 1128.9570s
	iters: 300, epoch: 13 | loss: 0.0023204
	speed: 0.0273s/iter; left time: 1118.8375s
	iters: 400, epoch: 13 | loss: 0.0014065
	speed: 0.0262s/iter; left time: 1072.6795s
Epoch: 13 cost time: 12.816353559494019
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.1766646
	speed: 0.1320s/iter; left time: 5371.4020s
	iters: 200, epoch: 14 | loss: 0.0379523
	speed: 0.0248s/iter; left time: 1005.5228s
	iters: 300, epoch: 14 | loss: 0.0006150
	speed: 0.0245s/iter; left time: 992.4659s
	iters: 400, epoch: 14 | loss: 0.0276770
	speed: 0.0248s/iter; left time: 1001.4459s
Epoch: 14 cost time: 12.158801078796387
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0018334
	speed: 0.1389s/iter; left time: 5587.8650s
	iters: 200, epoch: 15 | loss: 0.0081515
	speed: 0.0255s/iter; left time: 1025.3317s
	iters: 300, epoch: 15 | loss: 0.0041107
	speed: 0.0279s/iter; left time: 1115.0528s
	iters: 400, epoch: 15 | loss: 0.0005798
	speed: 0.0287s/iter; left time: 1145.2369s
Epoch: 15 cost time: 13.108991384506226
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0003360
	speed: 0.1370s/iter; left time: 5449.0791s
	iters: 200, epoch: 16 | loss: 0.0008752
	speed: 0.0200s/iter; left time: 795.2125s
	iters: 300, epoch: 16 | loss: 0.0010696
	speed: 0.0194s/iter; left time: 768.9473s
	iters: 400, epoch: 16 | loss: 0.0035741
	speed: 0.0202s/iter; left time: 797.8233s
Epoch: 16 cost time: 10.212356567382812
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0139184
	speed: 0.1343s/iter; left time: 5277.5713s
	iters: 200, epoch: 17 | loss: 0.0397504
	speed: 0.0276s/iter; left time: 1081.7222s
	iters: 300, epoch: 17 | loss: 0.0813568
	speed: 0.0259s/iter; left time: 1014.5437s
	iters: 400, epoch: 17 | loss: 0.0127206
	speed: 0.0257s/iter; left time: 1003.7686s
Epoch: 17 cost time: 12.864608526229858
Epoch: 17, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0066737
	speed: 0.1392s/iter; left time: 5404.5371s
	iters: 200, epoch: 18 | loss: 0.0028285
	speed: 0.0255s/iter; left time: 986.0928s
	iters: 300, epoch: 18 | loss: 0.0006561
	speed: 0.0251s/iter; left time: 970.6604s
	iters: 400, epoch: 18 | loss: 0.0062487
	speed: 0.0266s/iter; left time: 1025.6477s
Epoch: 18 cost time: 12.38357925415039
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0473366
	speed: 0.1362s/iter; left time: 5223.9419s
	iters: 200, epoch: 19 | loss: 0.0096154
	speed: 0.0257s/iter; left time: 984.8885s
	iters: 300, epoch: 19 | loss: 0.0645363
	speed: 0.0274s/iter; left time: 1044.0473s
	iters: 400, epoch: 19 | loss: 0.0061479
	speed: 0.0237s/iter; left time: 900.9598s
Epoch: 19 cost time: 12.481731414794922
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9777015437392796
model parameter : 570146
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0902743
	speed: 0.0418s/iter; left time: 1958.0616s
	iters: 200, epoch: 1 | loss: 0.3135338
	speed: 0.0241s/iter; left time: 1126.2995s
	iters: 300, epoch: 1 | loss: 0.2799844
	speed: 0.0244s/iter; left time: 1134.7369s
	iters: 400, epoch: 1 | loss: 0.4385642
	speed: 0.0244s/iter; left time: 1136.0283s
Epoch: 1 cost time: 13.296781063079834
Epoch: 1, Steps: 469 | Train Loss: 0.638 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (inf --> -0.924526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0177626
	speed: 0.1334s/iter; left time: 6181.5649s
	iters: 200, epoch: 2 | loss: 0.1131231
	speed: 0.0254s/iter; left time: 1174.4100s
	iters: 300, epoch: 2 | loss: 0.0530253
	speed: 0.0256s/iter; left time: 1181.0034s
	iters: 400, epoch: 2 | loss: 0.0102992
	speed: 0.0249s/iter; left time: 1144.6485s
Epoch: 2 cost time: 12.328315496444702
Epoch: 2, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.924526 --> -0.956545).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0368807
	speed: 0.1257s/iter; left time: 5765.4182s
	iters: 200, epoch: 3 | loss: 0.1116280
	speed: 0.0233s/iter; left time: 1067.6265s
	iters: 300, epoch: 3 | loss: 0.0593996
	speed: 0.0253s/iter; left time: 1153.7005s
	iters: 400, epoch: 3 | loss: 0.0093331
	speed: 0.0251s/iter; left time: 1144.7271s
Epoch: 3 cost time: 12.110603332519531
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.956545 --> -0.962549).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3504277
	speed: 0.1315s/iter; left time: 5970.7097s
	iters: 200, epoch: 4 | loss: 0.0140956
	speed: 0.0244s/iter; left time: 1105.7297s
	iters: 300, epoch: 4 | loss: 0.0165078
	speed: 0.0241s/iter; left time: 1089.2352s
	iters: 400, epoch: 4 | loss: 0.0124838
	speed: 0.0249s/iter; left time: 1122.2281s
Epoch: 4 cost time: 11.67311143875122
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (-0.962549 --> -0.963692).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0059050
	speed: 0.1373s/iter; left time: 6168.9773s
	iters: 200, epoch: 5 | loss: 0.0020757
	speed: 0.0258s/iter; left time: 1158.2682s
	iters: 300, epoch: 5 | loss: 0.0050522
	speed: 0.0240s/iter; left time: 1074.6947s
	iters: 400, epoch: 5 | loss: 0.1030484
	speed: 0.0248s/iter; left time: 1106.7480s
Epoch: 5 cost time: 12.063356161117554
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.177 Vali Acc: 0.958 Test Loss: 0.177 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0128940
	speed: 0.1344s/iter; left time: 5974.7104s
	iters: 200, epoch: 6 | loss: 0.0456300
	speed: 0.0241s/iter; left time: 1070.1543s
	iters: 300, epoch: 6 | loss: 0.0009512
	speed: 0.0243s/iter; left time: 1073.5737s
	iters: 400, epoch: 6 | loss: 0.0023990
	speed: 0.0234s/iter; left time: 1034.7550s
Epoch: 6 cost time: 11.96825647354126
Epoch: 6, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.963692 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0503701
	speed: 0.1336s/iter; left time: 5875.5123s
	iters: 200, epoch: 7 | loss: 0.0070821
	speed: 0.0231s/iter; left time: 1015.0035s
	iters: 300, epoch: 7 | loss: 0.1807260
	speed: 0.0234s/iter; left time: 1025.9311s
	iters: 400, epoch: 7 | loss: 0.0056673
	speed: 0.0241s/iter; left time: 1054.6724s
Epoch: 7 cost time: 11.618045806884766
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.970553).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0167582
	speed: 0.1288s/iter; left time: 5604.5601s
	iters: 200, epoch: 8 | loss: 0.0166967
	speed: 0.0248s/iter; left time: 1077.0883s
	iters: 300, epoch: 8 | loss: 0.0349580
	speed: 0.0248s/iter; left time: 1076.2157s
	iters: 400, epoch: 8 | loss: 0.0411808
	speed: 0.0245s/iter; left time: 1060.2158s
Epoch: 8 cost time: 11.892642498016357
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0004184
	speed: 0.1333s/iter; left time: 5737.6860s
	iters: 200, epoch: 9 | loss: 0.0008368
	speed: 0.0267s/iter; left time: 1145.2510s
	iters: 300, epoch: 9 | loss: 0.0088024
	speed: 0.0261s/iter; left time: 1118.5857s
	iters: 400, epoch: 9 | loss: 0.0287906
	speed: 0.0255s/iter; left time: 1088.6425s
Epoch: 9 cost time: 12.766422033309937
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.970553 --> -0.971411).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0013138
	speed: 0.1296s/iter; left time: 5516.3025s
	iters: 200, epoch: 10 | loss: 0.0738414
	speed: 0.0231s/iter; left time: 980.0399s
	iters: 300, epoch: 10 | loss: 0.0001732
	speed: 0.0261s/iter; left time: 1105.7505s
	iters: 400, epoch: 10 | loss: 0.0048837
	speed: 0.0247s/iter; left time: 1044.4215s
Epoch: 10 cost time: 12.005259990692139
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972554).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0331121
	speed: 0.1350s/iter; left time: 5683.0625s
	iters: 200, epoch: 11 | loss: 0.0221046
	speed: 0.0240s/iter; left time: 1008.5052s
	iters: 300, epoch: 11 | loss: 0.0002902
	speed: 0.0252s/iter; left time: 1058.1356s
	iters: 400, epoch: 11 | loss: 0.4542000
	speed: 0.0250s/iter; left time: 1043.1984s
Epoch: 11 cost time: 11.978795051574707
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.972554 --> -0.972840).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0148884
	speed: 0.1280s/iter; left time: 5330.2947s
	iters: 200, epoch: 12 | loss: 0.0402446
	speed: 0.0256s/iter; left time: 1062.1510s
	iters: 300, epoch: 12 | loss: 0.0022168
	speed: 0.0258s/iter; left time: 1068.1536s
	iters: 400, epoch: 12 | loss: 0.0230745
	speed: 0.0242s/iter; left time: 1001.0066s
Epoch: 12 cost time: 12.121197938919067
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974842).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0330772
	speed: 0.1267s/iter; left time: 5214.6171s
	iters: 200, epoch: 13 | loss: 0.0060425
	speed: 0.0234s/iter; left time: 961.0244s
	iters: 300, epoch: 13 | loss: 0.0015473
	speed: 0.0237s/iter; left time: 971.6514s
	iters: 400, epoch: 13 | loss: 0.0057196
	speed: 0.0242s/iter; left time: 988.1748s
Epoch: 13 cost time: 11.67280650138855
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0689885
	speed: 0.1308s/iter; left time: 5324.5090s
	iters: 200, epoch: 14 | loss: 0.0146571
	speed: 0.0232s/iter; left time: 941.2569s
	iters: 300, epoch: 14 | loss: 0.0007431
	speed: 0.0227s/iter; left time: 920.5199s
	iters: 400, epoch: 14 | loss: 0.0052827
	speed: 0.0237s/iter; left time: 957.6513s
Epoch: 14 cost time: 11.422450065612793
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0041000
	speed: 0.1259s/iter; left time: 5065.4669s
	iters: 200, epoch: 15 | loss: 0.0036127
	speed: 0.0239s/iter; left time: 961.1482s
	iters: 300, epoch: 15 | loss: 0.0101560
	speed: 0.0232s/iter; left time: 928.4196s
	iters: 400, epoch: 15 | loss: 0.0143537
	speed: 0.0251s/iter; left time: 1003.3234s
Epoch: 15 cost time: 11.723179817199707
Epoch: 15, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0002017
	speed: 0.1281s/iter; left time: 5094.3300s
	iters: 200, epoch: 16 | loss: 0.0002746
	speed: 0.0230s/iter; left time: 913.8543s
	iters: 300, epoch: 16 | loss: 0.0063114
	speed: 0.0239s/iter; left time: 945.0839s
	iters: 400, epoch: 16 | loss: 0.0007530
	speed: 0.0250s/iter; left time: 986.6684s
Epoch: 16 cost time: 11.65203857421875
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975413).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0037012
	speed: 0.1321s/iter; left time: 5190.0562s
	iters: 200, epoch: 17 | loss: 0.0611970
	speed: 0.0247s/iter; left time: 968.9833s
	iters: 300, epoch: 17 | loss: 0.0133123
	speed: 0.0240s/iter; left time: 938.6679s
	iters: 400, epoch: 17 | loss: 0.0148608
	speed: 0.0231s/iter; left time: 899.7397s
Epoch: 17 cost time: 11.45551085472107
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0113839
	speed: 0.1316s/iter; left time: 5109.1167s
	iters: 200, epoch: 18 | loss: 0.0032518
	speed: 0.0255s/iter; left time: 986.3329s
	iters: 300, epoch: 18 | loss: 0.0049231
	speed: 0.0251s/iter; left time: 968.4945s
	iters: 400, epoch: 18 | loss: 0.0083094
	speed: 0.0259s/iter; left time: 997.3211s
Epoch: 18 cost time: 12.474369764328003
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0209267
	speed: 0.1291s/iter; left time: 4953.2015s
	iters: 200, epoch: 19 | loss: 0.0013746
	speed: 0.0256s/iter; left time: 978.4260s
	iters: 300, epoch: 19 | loss: 0.0006503
	speed: 0.0246s/iter; left time: 939.6973s
	iters: 400, epoch: 19 | loss: 0.0086162
	speed: 0.0273s/iter; left time: 1039.1393s
Epoch: 19 cost time: 12.31622838973999
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.977414).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0065313
	speed: 0.1240s/iter; left time: 4699.8385s
	iters: 200, epoch: 20 | loss: 0.0016109
	speed: 0.0232s/iter; left time: 875.4462s
	iters: 300, epoch: 20 | loss: 0.0839823
	speed: 0.0246s/iter; left time: 927.9192s
	iters: 400, epoch: 20 | loss: 0.0204891
	speed: 0.0251s/iter; left time: 942.3086s
Epoch: 20 cost time: 11.693300247192383
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0018757
	speed: 0.1383s/iter; left time: 5174.7694s
	iters: 200, epoch: 21 | loss: 0.0007569
	speed: 0.0282s/iter; left time: 1052.5580s
	iters: 300, epoch: 21 | loss: 0.0186233
	speed: 0.0260s/iter; left time: 968.5287s
	iters: 400, epoch: 21 | loss: 0.0005010
	speed: 0.0256s/iter; left time: 950.1492s
Epoch: 21 cost time: 12.52125096321106
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0029432
	speed: 0.1318s/iter; left time: 4871.0824s
	iters: 200, epoch: 22 | loss: 0.0019678
	speed: 0.0251s/iter; left time: 923.5829s
	iters: 300, epoch: 22 | loss: 0.0021505
	speed: 0.0248s/iter; left time: 912.6954s
	iters: 400, epoch: 22 | loss: 0.0003352
	speed: 0.0233s/iter; left time: 854.1683s
Epoch: 22 cost time: 11.738284587860107
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000106
	speed: 0.1356s/iter; left time: 4945.6858s
	iters: 200, epoch: 23 | loss: 0.0210272
	speed: 0.0231s/iter; left time: 841.6404s
	iters: 300, epoch: 23 | loss: 0.2420800
	speed: 0.0236s/iter; left time: 857.9358s
	iters: 400, epoch: 23 | loss: 0.0005667
	speed: 0.0240s/iter; left time: 867.6566s
Epoch: 23 cost time: 11.676185846328735
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0053903
	speed: 0.1282s/iter; left time: 4618.2632s
	iters: 200, epoch: 24 | loss: 0.0010833
	speed: 0.0219s/iter; left time: 786.9251s
	iters: 300, epoch: 24 | loss: 0.1408319
	speed: 0.0238s/iter; left time: 853.4118s
	iters: 400, epoch: 24 | loss: 0.0001951
	speed: 0.0246s/iter; left time: 878.1869s
Epoch: 24 cost time: 11.33393406867981
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
Validation loss decreased (-0.977414 --> -0.978558).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0006903
	speed: 0.1342s/iter; left time: 4769.3103s
	iters: 200, epoch: 25 | loss: 0.0317550
	speed: 0.0260s/iter; left time: 922.8110s
	iters: 300, epoch: 25 | loss: 0.0001565
	speed: 0.0245s/iter; left time: 865.0568s
	iters: 400, epoch: 25 | loss: 0.0060005
	speed: 0.0234s/iter; left time: 823.3735s
Epoch: 25 cost time: 11.999910116195679
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0015109
	speed: 0.1309s/iter; left time: 4590.9733s
	iters: 200, epoch: 26 | loss: 0.0002888
	speed: 0.0242s/iter; left time: 845.0967s
	iters: 300, epoch: 26 | loss: 0.0000498
	speed: 0.0247s/iter; left time: 860.1820s
	iters: 400, epoch: 26 | loss: 0.2731208
	speed: 0.0251s/iter; left time: 874.4580s
Epoch: 26 cost time: 11.99902081489563
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0001267
	speed: 0.1323s/iter; left time: 4579.3897s
	iters: 200, epoch: 27 | loss: 0.0085209
	speed: 0.0247s/iter; left time: 852.3304s
	iters: 300, epoch: 27 | loss: 0.0007889
	speed: 0.0250s/iter; left time: 861.1956s
	iters: 400, epoch: 27 | loss: 0.0018772
	speed: 0.0258s/iter; left time: 886.2094s
Epoch: 27 cost time: 12.02377986907959
Epoch: 27, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0000279
	speed: 0.1387s/iter; left time: 4734.8119s
	iters: 200, epoch: 28 | loss: 0.0070341
	speed: 0.0274s/iter; left time: 931.1451s
	iters: 300, epoch: 28 | loss: 0.0013622
	speed: 0.0267s/iter; left time: 904.8493s
	iters: 400, epoch: 28 | loss: 0.0000117
	speed: 0.0253s/iter; left time: 856.4616s
Epoch: 28 cost time: 12.758939266204834
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978844).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0232451
	speed: 0.1390s/iter; left time: 4678.5248s
	iters: 200, epoch: 29 | loss: 0.0002620
	speed: 0.0269s/iter; left time: 903.7036s
	iters: 300, epoch: 29 | loss: 0.0000983
	speed: 0.0268s/iter; left time: 895.8594s
	iters: 400, epoch: 29 | loss: 0.0531897
	speed: 0.0285s/iter; left time: 950.3781s
Epoch: 29 cost time: 13.42369794845581
Epoch: 29, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0448000
	speed: 0.1371s/iter; left time: 4552.1031s
	iters: 200, epoch: 30 | loss: 0.0215943
	speed: 0.0256s/iter; left time: 848.3975s
	iters: 300, epoch: 30 | loss: 0.0038068
	speed: 0.0282s/iter; left time: 929.2235s
	iters: 400, epoch: 30 | loss: 0.0013891
	speed: 0.0283s/iter; left time: 930.0111s
Epoch: 30 cost time: 13.141123294830322
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.1059414
	speed: 0.1370s/iter; left time: 4485.2427s
	iters: 200, epoch: 31 | loss: 0.0021505
	speed: 0.0237s/iter; left time: 773.7790s
	iters: 300, epoch: 31 | loss: 0.0002618
	speed: 0.0248s/iter; left time: 807.2172s
	iters: 400, epoch: 31 | loss: 0.0025429
	speed: 0.0262s/iter; left time: 849.3748s
Epoch: 31 cost time: 12.278761625289917
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0002518
	speed: 0.1385s/iter; left time: 4469.5899s
	iters: 200, epoch: 32 | loss: 0.0029823
	speed: 0.0257s/iter; left time: 826.1929s
	iters: 300, epoch: 32 | loss: 0.0003782
	speed: 0.0261s/iter; left time: 838.0019s
	iters: 400, epoch: 32 | loss: 0.0028026
	speed: 0.0261s/iter; left time: 835.6790s
Epoch: 32 cost time: 12.524701356887817
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0066046
	speed: 0.1391s/iter; left time: 4423.6262s
	iters: 200, epoch: 33 | loss: 0.0056865
	speed: 0.0251s/iter; left time: 795.4392s
	iters: 300, epoch: 33 | loss: 0.0241423
	speed: 0.0244s/iter; left time: 769.3254s
	iters: 400, epoch: 33 | loss: 0.0002973
	speed: 0.0267s/iter; left time: 840.8209s
Epoch: 33 cost time: 12.588452100753784
Epoch: 33, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0018454
	speed: 0.1373s/iter; left time: 4301.4751s
	iters: 200, epoch: 34 | loss: 0.0008668
	speed: 0.0253s/iter; left time: 789.5761s
	iters: 300, epoch: 34 | loss: 0.0002456
	speed: 0.0262s/iter; left time: 814.0066s
	iters: 400, epoch: 34 | loss: 0.0899991
	speed: 0.0259s/iter; left time: 802.2269s
Epoch: 34 cost time: 12.527775287628174
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0008606
	speed: 0.1416s/iter; left time: 4369.3363s
	iters: 200, epoch: 35 | loss: 0.0000274
	speed: 0.0251s/iter; left time: 770.6360s
	iters: 300, epoch: 35 | loss: 0.0252021
	speed: 0.0241s/iter; left time: 739.8937s
	iters: 400, epoch: 35 | loss: 0.0000721
	speed: 0.0233s/iter; left time: 712.1473s
Epoch: 35 cost time: 12.107428312301636
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0001424
	speed: 0.1314s/iter; left time: 3992.1924s
	iters: 200, epoch: 36 | loss: 0.0006971
	speed: 0.0257s/iter; left time: 778.1206s
	iters: 300, epoch: 36 | loss: 0.0934525
	speed: 0.0251s/iter; left time: 758.8840s
	iters: 400, epoch: 36 | loss: 0.1638254
	speed: 0.0261s/iter; left time: 784.1044s
Epoch: 36 cost time: 12.68774151802063
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0004396
	speed: 0.1383s/iter; left time: 4137.6236s
	iters: 200, epoch: 37 | loss: 0.0000143
	speed: 0.0257s/iter; left time: 765.2705s
	iters: 300, epoch: 37 | loss: 0.0000119
	speed: 0.0289s/iter; left time: 859.5866s
	iters: 400, epoch: 37 | loss: 0.0000225
	speed: 0.0280s/iter; left time: 828.0841s
Epoch: 37 cost time: 13.237966299057007
Epoch: 37, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0004301
	speed: 0.1439s/iter; left time: 4236.4008s
	iters: 200, epoch: 38 | loss: 0.0070398
	speed: 0.0259s/iter; left time: 760.8314s
	iters: 300, epoch: 38 | loss: 0.0000017
	speed: 0.0254s/iter; left time: 741.5486s
	iters: 400, epoch: 38 | loss: 0.0002328
	speed: 0.0253s/iter; left time: 737.7067s
Epoch: 38 cost time: 12.694873809814453
Epoch: 38, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 570146
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2424785
	speed: 0.0442s/iter; left time: 2068.0078s
	iters: 200, epoch: 1 | loss: 0.3385926
	speed: 0.0240s/iter; left time: 1119.1956s
	iters: 300, epoch: 1 | loss: 0.2753932
	speed: 0.0244s/iter; left time: 1136.1581s
	iters: 400, epoch: 1 | loss: 0.4022163
	speed: 0.0252s/iter; left time: 1170.5582s
Epoch: 1 cost time: 13.55159330368042
Epoch: 1, Steps: 469 | Train Loss: 0.655 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (inf --> -0.949683).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0155640
	speed: 0.1309s/iter; left time: 6063.2209s
	iters: 200, epoch: 2 | loss: 0.0697630
	speed: 0.0230s/iter; left time: 1061.0717s
	iters: 300, epoch: 2 | loss: 0.0967171
	speed: 0.0244s/iter; left time: 1127.5444s
	iters: 400, epoch: 2 | loss: 0.0060069
	speed: 0.0246s/iter; left time: 1133.5172s
Epoch: 2 cost time: 11.618302345275879
Epoch: 2, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.949683 --> -0.963978).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0416745
	speed: 0.1339s/iter; left time: 6139.3016s
	iters: 200, epoch: 3 | loss: 0.0232063
	speed: 0.0235s/iter; left time: 1074.5856s
	iters: 300, epoch: 3 | loss: 0.0303543
	speed: 0.0235s/iter; left time: 1071.4566s
	iters: 400, epoch: 3 | loss: 0.0050915
	speed: 0.0251s/iter; left time: 1143.3911s
Epoch: 3 cost time: 11.579320192337036
Epoch: 3, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.963978 --> -0.967123).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3873260
	speed: 0.1266s/iter; left time: 5747.1857s
	iters: 200, epoch: 4 | loss: 0.0043357
	speed: 0.0236s/iter; left time: 1070.3872s
	iters: 300, epoch: 4 | loss: 0.0252384
	speed: 0.0239s/iter; left time: 1081.1110s
	iters: 400, epoch: 4 | loss: 0.0022939
	speed: 0.0234s/iter; left time: 1055.6856s
Epoch: 4 cost time: 11.562469244003296
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0145011
	speed: 0.1291s/iter; left time: 5800.6752s
	iters: 200, epoch: 5 | loss: 0.0009692
	speed: 0.0224s/iter; left time: 1002.9804s
	iters: 300, epoch: 5 | loss: 0.0030226
	speed: 0.0235s/iter; left time: 1051.2492s
	iters: 400, epoch: 5 | loss: 0.2574019
	speed: 0.0245s/iter; left time: 1092.8764s
Epoch: 5 cost time: 11.544398307800293
Epoch: 5, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.967123 --> -0.967408).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0288904
	speed: 0.1266s/iter; left time: 5628.3004s
	iters: 200, epoch: 6 | loss: 0.0253435
	speed: 0.0231s/iter; left time: 1026.1083s
	iters: 300, epoch: 6 | loss: 0.0006597
	speed: 0.0242s/iter; left time: 1073.0207s
	iters: 400, epoch: 6 | loss: 0.0005409
	speed: 0.0256s/iter; left time: 1128.8436s
Epoch: 6 cost time: 11.638047933578491
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.967408 --> -0.969982).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2555896
	speed: 0.1323s/iter; left time: 5817.4458s
	iters: 200, epoch: 7 | loss: 0.0022252
	speed: 0.0231s/iter; left time: 1012.6654s
	iters: 300, epoch: 7 | loss: 0.1905903
	speed: 0.0251s/iter; left time: 1099.0866s
	iters: 400, epoch: 7 | loss: 0.0867437
	speed: 0.0240s/iter; left time: 1047.9694s
Epoch: 7 cost time: 11.805471181869507
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.969982 --> -0.972840).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1500635
	speed: 0.1377s/iter; left time: 5990.9869s
	iters: 200, epoch: 8 | loss: 0.0196700
	speed: 0.0233s/iter; left time: 1012.5533s
	iters: 300, epoch: 8 | loss: 0.0348836
	speed: 0.0245s/iter; left time: 1061.8538s
	iters: 400, epoch: 8 | loss: 0.1740925
	speed: 0.0245s/iter; left time: 1058.5672s
Epoch: 8 cost time: 11.933959007263184
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0024458
	speed: 0.1364s/iter; left time: 5873.2877s
	iters: 200, epoch: 9 | loss: 0.0009027
	speed: 0.0253s/iter; left time: 1088.2731s
	iters: 300, epoch: 9 | loss: 0.0008743
	speed: 0.0251s/iter; left time: 1073.7237s
	iters: 400, epoch: 9 | loss: 0.0009889
	speed: 0.0257s/iter; left time: 1098.7997s
Epoch: 9 cost time: 12.23668360710144
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975985).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0062297
	speed: 0.1330s/iter; left time: 5663.2211s
	iters: 200, epoch: 10 | loss: 0.0202703
	speed: 0.0249s/iter; left time: 1057.8816s
	iters: 300, epoch: 10 | loss: 0.0004595
	speed: 0.0251s/iter; left time: 1063.4475s
	iters: 400, epoch: 10 | loss: 0.0004814
	speed: 0.0253s/iter; left time: 1069.5933s
Epoch: 10 cost time: 12.007617473602295
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0018054
	speed: 0.1305s/iter; left time: 5496.1478s
	iters: 200, epoch: 11 | loss: 0.0380974
	speed: 0.0251s/iter; left time: 1054.5607s
	iters: 300, epoch: 11 | loss: 0.0006254
	speed: 0.0239s/iter; left time: 1000.6852s
	iters: 400, epoch: 11 | loss: 0.0210563
	speed: 0.0247s/iter; left time: 1031.2879s
Epoch: 11 cost time: 11.558714151382446
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0010262
	speed: 0.1360s/iter; left time: 5661.3255s
	iters: 200, epoch: 12 | loss: 0.0110775
	speed: 0.0235s/iter; left time: 977.7747s
	iters: 300, epoch: 12 | loss: 0.0005203
	speed: 0.0242s/iter; left time: 1001.8780s
	iters: 400, epoch: 12 | loss: 0.0250834
	speed: 0.0237s/iter; left time: 980.5608s
Epoch: 12 cost time: 11.720560550689697
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0029316
	speed: 0.1307s/iter; left time: 5380.0643s
	iters: 200, epoch: 13 | loss: 0.0007777
	speed: 0.0239s/iter; left time: 980.8815s
	iters: 300, epoch: 13 | loss: 0.0233069
	speed: 0.0238s/iter; left time: 973.1470s
	iters: 400, epoch: 13 | loss: 0.0026626
	speed: 0.0223s/iter; left time: 912.9324s
Epoch: 13 cost time: 11.429044723510742
Epoch: 13, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.2771325
	speed: 0.1298s/iter; left time: 5282.9246s
	iters: 200, epoch: 14 | loss: 0.0006142
	speed: 0.0241s/iter; left time: 980.3886s
	iters: 300, epoch: 14 | loss: 0.0000493
	speed: 0.0236s/iter; left time: 956.6585s
	iters: 400, epoch: 14 | loss: 0.0058351
	speed: 0.0244s/iter; left time: 983.9170s
Epoch: 14 cost time: 11.569488763809204
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0026629
	speed: 0.1281s/iter; left time: 5153.9816s
	iters: 200, epoch: 15 | loss: 0.0218976
	speed: 0.0253s/iter; left time: 1013.6639s
	iters: 300, epoch: 15 | loss: 0.0094561
	speed: 0.0248s/iter; left time: 993.8851s
	iters: 400, epoch: 15 | loss: 0.3751649
	speed: 0.0243s/iter; left time: 971.3620s
Epoch: 15 cost time: 11.991732835769653
Epoch: 15, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0001305
	speed: 0.1278s/iter; left time: 5082.1286s
	iters: 200, epoch: 16 | loss: 0.0088714
	speed: 0.0240s/iter; left time: 950.2123s
	iters: 300, epoch: 16 | loss: 0.0086598
	speed: 0.0228s/iter; left time: 901.0326s
	iters: 400, epoch: 16 | loss: 0.0621304
	speed: 0.0234s/iter; left time: 923.5762s
Epoch: 16 cost time: 11.395226240158081
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0005547
	speed: 0.1356s/iter; left time: 5329.4125s
	iters: 200, epoch: 17 | loss: 0.0029153
	speed: 0.0243s/iter; left time: 952.5481s
	iters: 300, epoch: 17 | loss: 0.0001681
	speed: 0.0227s/iter; left time: 888.5412s
	iters: 400, epoch: 17 | loss: 0.0006888
	speed: 0.0242s/iter; left time: 942.1688s
Epoch: 17 cost time: 11.710485696792603
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0526056
	speed: 0.1326s/iter; left time: 5148.0046s
	iters: 200, epoch: 18 | loss: 0.0000584
	speed: 0.0234s/iter; left time: 905.7210s
	iters: 300, epoch: 18 | loss: 0.0006615
	speed: 0.0237s/iter; left time: 915.2018s
	iters: 400, epoch: 18 | loss: 0.0000941
	speed: 0.0254s/iter; left time: 979.7998s
Epoch: 18 cost time: 11.650811433792114
Epoch: 18, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0001923
	speed: 0.1344s/iter; left time: 5153.5874s
	iters: 200, epoch: 19 | loss: 0.0000266
	speed: 0.0243s/iter; left time: 930.8257s
	iters: 300, epoch: 19 | loss: 0.0003344
	speed: 0.0239s/iter; left time: 910.7111s
	iters: 400, epoch: 19 | loss: 0.0155728
	speed: 0.0236s/iter; left time: 896.9451s
Epoch: 19 cost time: 11.688867092132568
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9759862778730704
model parameter : 570146
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7622055
	speed: 0.0463s/iter; left time: 2165.7557s
	iters: 200, epoch: 1 | loss: 0.2214185
	speed: 0.0251s/iter; left time: 1173.0314s
	iters: 300, epoch: 1 | loss: 0.0679732
	speed: 0.0244s/iter; left time: 1135.4655s
	iters: 400, epoch: 1 | loss: 0.3381969
	speed: 0.0244s/iter; left time: 1136.4976s
Epoch: 1 cost time: 13.897406578063965
Epoch: 1, Steps: 469 | Train Loss: 0.615 Vali Loss: 0.288 Vali Acc: 0.914 Test Loss: 0.288 Test Acc: 0.914
Validation loss decreased (inf --> -0.913948).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2044168
	speed: 0.1321s/iter; left time: 6121.9188s
	iters: 200, epoch: 2 | loss: 0.0875406
	speed: 0.0238s/iter; left time: 1099.1286s
	iters: 300, epoch: 2 | loss: 0.0634468
	speed: 0.0238s/iter; left time: 1096.8199s
	iters: 400, epoch: 2 | loss: 0.0506510
	speed: 0.0246s/iter; left time: 1131.4489s
Epoch: 2 cost time: 11.651880741119385
Epoch: 2, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.913948 --> -0.954544).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2187221
	speed: 0.1352s/iter; left time: 6199.9618s
	iters: 200, epoch: 3 | loss: 0.0347808
	speed: 0.0244s/iter; left time: 1117.2670s
	iters: 300, epoch: 3 | loss: 0.0407966
	speed: 0.0245s/iter; left time: 1120.5098s
	iters: 400, epoch: 3 | loss: 0.0151903
	speed: 0.0247s/iter; left time: 1124.7048s
Epoch: 3 cost time: 11.88059687614441
Epoch: 3, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.954544 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0395165
	speed: 0.1338s/iter; left time: 6072.4576s
	iters: 200, epoch: 4 | loss: 0.1707770
	speed: 0.0248s/iter; left time: 1122.0643s
	iters: 300, epoch: 4 | loss: 0.0379441
	speed: 0.0276s/iter; left time: 1249.3477s
	iters: 400, epoch: 4 | loss: 0.0346862
	speed: 0.0263s/iter; left time: 1187.5527s
Epoch: 4 cost time: 12.535170793533325
Epoch: 4, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.957117 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0139997
	speed: 0.1364s/iter; left time: 6128.2037s
	iters: 200, epoch: 5 | loss: 0.0200944
	speed: 0.0283s/iter; left time: 1266.6980s
	iters: 300, epoch: 5 | loss: 0.0057333
	speed: 0.0267s/iter; left time: 1192.7114s
	iters: 400, epoch: 5 | loss: 0.0068896
	speed: 0.0262s/iter; left time: 1168.8464s
Epoch: 5 cost time: 13.113675594329834
Epoch: 5, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.961977 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0157018
	speed: 0.1356s/iter; left time: 6028.4427s
	iters: 200, epoch: 6 | loss: 0.0017392
	speed: 0.0266s/iter; left time: 1179.1369s
	iters: 300, epoch: 6 | loss: 0.0669728
	speed: 0.0271s/iter; left time: 1199.9226s
	iters: 400, epoch: 6 | loss: 0.0263726
	speed: 0.0259s/iter; left time: 1144.6048s
Epoch: 6 cost time: 12.735583782196045
Epoch: 6, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0057723
	speed: 0.1437s/iter; left time: 6322.0223s
	iters: 200, epoch: 7 | loss: 0.0049540
	speed: 0.0253s/iter; left time: 1109.5469s
	iters: 300, epoch: 7 | loss: 0.0024424
	speed: 0.0246s/iter; left time: 1077.4227s
	iters: 400, epoch: 7 | loss: 0.0067964
	speed: 0.0257s/iter; left time: 1123.3481s
Epoch: 7 cost time: 12.250200510025024
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0049256
	speed: 0.1402s/iter; left time: 6102.3150s
	iters: 200, epoch: 8 | loss: 0.0572849
	speed: 0.0254s/iter; left time: 1103.9462s
	iters: 300, epoch: 8 | loss: 0.0646217
	speed: 0.0258s/iter; left time: 1115.5055s
	iters: 400, epoch: 8 | loss: 0.0001685
	speed: 0.0243s/iter; left time: 1051.3737s
Epoch: 8 cost time: 12.185335159301758
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0018833
	speed: 0.1317s/iter; left time: 5667.4645s
	iters: 200, epoch: 9 | loss: 0.0130317
	speed: 0.0267s/iter; left time: 1146.2503s
	iters: 300, epoch: 9 | loss: 0.0140639
	speed: 0.0250s/iter; left time: 1069.2894s
	iters: 400, epoch: 9 | loss: 0.7926636
	speed: 0.0260s/iter; left time: 1112.0670s
Epoch: 9 cost time: 12.51746129989624
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0121153
	speed: 0.1356s/iter; left time: 5774.9708s
	iters: 200, epoch: 10 | loss: 0.0485143
	speed: 0.0255s/iter; left time: 1083.6578s
	iters: 300, epoch: 10 | loss: 0.4478205
	speed: 0.0253s/iter; left time: 1071.1186s
	iters: 400, epoch: 10 | loss: 0.0212243
	speed: 0.0247s/iter; left time: 1042.5720s
Epoch: 10 cost time: 12.142425298690796
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0015335
	speed: 0.1403s/iter; left time: 5906.1932s
	iters: 200, epoch: 11 | loss: 0.0034662
	speed: 0.0242s/iter; left time: 1017.8685s
	iters: 300, epoch: 11 | loss: 0.0503628
	speed: 0.0241s/iter; left time: 1010.4053s
	iters: 400, epoch: 11 | loss: 0.0094642
	speed: 0.0252s/iter; left time: 1055.4172s
Epoch: 11 cost time: 11.796955823898315
Epoch: 11, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.974270 --> -0.980559).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0086968
	speed: 0.1356s/iter; left time: 5646.4769s
	iters: 200, epoch: 12 | loss: 0.0178476
	speed: 0.0243s/iter; left time: 1011.2056s
	iters: 300, epoch: 12 | loss: 0.0392357
	speed: 0.0269s/iter; left time: 1114.1043s
	iters: 400, epoch: 12 | loss: 0.8804048
	speed: 0.0281s/iter; left time: 1163.3017s
Epoch: 12 cost time: 12.529476404190063
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0127949
	speed: 0.1321s/iter; left time: 5438.5976s
	iters: 200, epoch: 13 | loss: 0.0020934
	speed: 0.0262s/iter; left time: 1076.0336s
	iters: 300, epoch: 13 | loss: 0.0263824
	speed: 0.0271s/iter; left time: 1111.1025s
	iters: 400, epoch: 13 | loss: 0.0115070
	speed: 0.0280s/iter; left time: 1146.1157s
Epoch: 13 cost time: 12.903386354446411
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0018348
	speed: 0.1372s/iter; left time: 5583.4392s
	iters: 200, epoch: 14 | loss: 0.0003805
	speed: 0.0255s/iter; left time: 1036.5011s
	iters: 300, epoch: 14 | loss: 0.0018104
	speed: 0.0248s/iter; left time: 1005.1907s
	iters: 400, epoch: 14 | loss: 0.0128338
	speed: 0.0269s/iter; left time: 1085.9455s
Epoch: 14 cost time: 12.484557390213013
Epoch: 14, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0012898
	speed: 0.1394s/iter; left time: 5607.0727s
	iters: 200, epoch: 15 | loss: 0.0053393
	speed: 0.0252s/iter; left time: 1010.7159s
	iters: 300, epoch: 15 | loss: 0.0005834
	speed: 0.0250s/iter; left time: 1000.1344s
	iters: 400, epoch: 15 | loss: 0.0158188
	speed: 0.0284s/iter; left time: 1136.0864s
Epoch: 15 cost time: 12.752814531326294
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.980559 --> -0.982561).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0564037
	speed: 0.1409s/iter; left time: 5602.9660s
	iters: 200, epoch: 16 | loss: 0.0109833
	speed: 0.0274s/iter; left time: 1086.7021s
	iters: 300, epoch: 16 | loss: 0.0024369
	speed: 0.0267s/iter; left time: 1057.6256s
	iters: 400, epoch: 16 | loss: 0.0414952
	speed: 0.0261s/iter; left time: 1030.3936s
Epoch: 16 cost time: 12.900894403457642
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0015490
	speed: 0.1392s/iter; left time: 5471.8139s
	iters: 200, epoch: 17 | loss: 0.0049051
	speed: 0.0258s/iter; left time: 1010.4322s
	iters: 300, epoch: 17 | loss: 0.0001406
	speed: 0.0235s/iter; left time: 920.6901s
	iters: 400, epoch: 17 | loss: 0.1564926
	speed: 0.0260s/iter; left time: 1012.5331s
Epoch: 17 cost time: 12.180942058563232
Epoch: 17, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0040497
	speed: 0.1346s/iter; left time: 5227.5422s
	iters: 200, epoch: 18 | loss: 0.0030191
	speed: 0.0242s/iter; left time: 937.8920s
	iters: 300, epoch: 18 | loss: 0.0010984
	speed: 0.0250s/iter; left time: 964.7740s
	iters: 400, epoch: 18 | loss: 0.4809431
	speed: 0.0245s/iter; left time: 943.9560s
Epoch: 18 cost time: 12.092056035995483
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0019628
	speed: 0.1394s/iter; left time: 5346.6886s
	iters: 200, epoch: 19 | loss: 0.0003847
	speed: 0.0257s/iter; left time: 983.6026s
	iters: 300, epoch: 19 | loss: 0.0002153
	speed: 0.0248s/iter; left time: 947.6588s
	iters: 400, epoch: 19 | loss: 0.0256681
	speed: 0.0255s/iter; left time: 969.0173s
Epoch: 19 cost time: 12.309953689575195
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0022226
	speed: 0.1331s/iter; left time: 5044.6304s
	iters: 200, epoch: 20 | loss: 0.0064756
	speed: 0.0245s/iter; left time: 923.9708s
	iters: 300, epoch: 20 | loss: 0.0003730
	speed: 0.0261s/iter; left time: 983.2789s
	iters: 400, epoch: 20 | loss: 0.0028379
	speed: 0.0253s/iter; left time: 951.7978s
Epoch: 20 cost time: 12.298654079437256
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0822089
	speed: 0.1313s/iter; left time: 4913.0102s
	iters: 200, epoch: 21 | loss: 0.0251160
	speed: 0.0252s/iter; left time: 941.0444s
	iters: 300, epoch: 21 | loss: 0.0020369
	speed: 0.0256s/iter; left time: 951.5427s
	iters: 400, epoch: 21 | loss: 0.0088039
	speed: 0.0239s/iter; left time: 889.0468s
Epoch: 21 cost time: 11.99714207649231
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0195814
	speed: 0.1354s/iter; left time: 5003.6572s
	iters: 200, epoch: 22 | loss: 0.0011270
	speed: 0.0220s/iter; left time: 810.0232s
	iters: 300, epoch: 22 | loss: 0.0076680
	speed: 0.0242s/iter; left time: 888.4789s
	iters: 400, epoch: 22 | loss: 0.0026357
	speed: 0.0235s/iter; left time: 862.6601s
Epoch: 22 cost time: 11.521241426467896
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0093449
	speed: 0.1327s/iter; left time: 4842.3780s
	iters: 200, epoch: 23 | loss: 0.0001368
	speed: 0.0267s/iter; left time: 970.3083s
	iters: 300, epoch: 23 | loss: 0.0004260
	speed: 0.0269s/iter; left time: 974.3715s
	iters: 400, epoch: 23 | loss: 0.0178172
	speed: 0.0254s/iter; left time: 919.4764s
Epoch: 23 cost time: 12.883583545684814
Epoch: 23, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000229
	speed: 0.1395s/iter; left time: 5024.4129s
	iters: 200, epoch: 24 | loss: 0.0000434
	speed: 0.0270s/iter; left time: 971.3829s
	iters: 300, epoch: 24 | loss: 0.0239141
	speed: 0.0270s/iter; left time: 966.9541s
	iters: 400, epoch: 24 | loss: 0.0003934
	speed: 0.0275s/iter; left time: 983.7604s
Epoch: 24 cost time: 13.061463356018066
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0009545
	speed: 0.1410s/iter; left time: 5011.9035s
	iters: 200, epoch: 25 | loss: 0.0101991
	speed: 0.0273s/iter; left time: 966.0177s
	iters: 300, epoch: 25 | loss: 0.0000563
	speed: 0.0252s/iter; left time: 890.7965s
	iters: 400, epoch: 25 | loss: 0.0011404
	speed: 0.0262s/iter; left time: 925.1384s
Epoch: 25 cost time: 12.865211009979248
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 308002
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7873111
	speed: 0.0434s/iter; left time: 2031.0418s
	iters: 200, epoch: 1 | loss: 0.2070096
	speed: 0.0207s/iter; left time: 966.6773s
	iters: 300, epoch: 1 | loss: 0.0781968
	speed: 0.0235s/iter; left time: 1096.7340s
	iters: 400, epoch: 1 | loss: 0.3600048
	speed: 0.0211s/iter; left time: 981.3746s
Epoch: 1 cost time: 12.45902967453003
Epoch: 1, Steps: 469 | Train Loss: 0.620 Vali Loss: 0.275 Vali Acc: 0.921 Test Loss: 0.275 Test Acc: 0.921
Validation loss decreased (inf --> -0.920523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2136575
	speed: 0.1255s/iter; left time: 5816.4102s
	iters: 200, epoch: 2 | loss: 0.0584542
	speed: 0.0241s/iter; left time: 1112.8136s
	iters: 300, epoch: 2 | loss: 0.0403355
	speed: 0.0246s/iter; left time: 1134.1405s
	iters: 400, epoch: 2 | loss: 0.0573023
	speed: 0.0250s/iter; left time: 1150.8340s
Epoch: 2 cost time: 12.130393266677856
Epoch: 2, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.920523 --> -0.955687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1249862
	speed: 0.1267s/iter; left time: 5811.0254s
	iters: 200, epoch: 3 | loss: 0.0135931
	speed: 0.0240s/iter; left time: 1097.1462s
	iters: 300, epoch: 3 | loss: 0.0438584
	speed: 0.0254s/iter; left time: 1159.7345s
	iters: 400, epoch: 3 | loss: 0.0139505
	speed: 0.0258s/iter; left time: 1173.7836s
Epoch: 3 cost time: 12.044898748397827
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.955687 --> -0.960261).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0218528
	speed: 0.1306s/iter; left time: 5926.4780s
	iters: 200, epoch: 4 | loss: 0.2072232
	speed: 0.0242s/iter; left time: 1095.0683s
	iters: 300, epoch: 4 | loss: 0.0373208
	speed: 0.0230s/iter; left time: 1041.6307s
	iters: 400, epoch: 4 | loss: 0.0097998
	speed: 0.0233s/iter; left time: 1052.0132s
Epoch: 4 cost time: 11.637498617172241
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.960261 --> -0.963406).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0118560
	speed: 0.1364s/iter; left time: 6129.5517s
	iters: 200, epoch: 5 | loss: 0.0082070
	speed: 0.0230s/iter; left time: 1030.8943s
	iters: 300, epoch: 5 | loss: 0.0020030
	speed: 0.0245s/iter; left time: 1096.2640s
	iters: 400, epoch: 5 | loss: 0.0008534
	speed: 0.0237s/iter; left time: 1059.3980s
Epoch: 5 cost time: 11.551770448684692
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.969124).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0036381
	speed: 0.1366s/iter; left time: 6071.7905s
	iters: 200, epoch: 6 | loss: 0.0022615
	speed: 0.0247s/iter; left time: 1094.1699s
	iters: 300, epoch: 6 | loss: 0.0367979
	speed: 0.0207s/iter; left time: 915.0086s
	iters: 400, epoch: 6 | loss: 0.0558054
	speed: 0.0289s/iter; left time: 1275.4616s
Epoch: 6 cost time: 12.404541254043579
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0023161
	speed: 0.1441s/iter; left time: 6337.0843s
	iters: 200, epoch: 7 | loss: 0.0120281
	speed: 0.0181s/iter; left time: 794.6172s
	iters: 300, epoch: 7 | loss: 0.0019971
	speed: 0.0192s/iter; left time: 838.6421s
	iters: 400, epoch: 7 | loss: 0.0065342
	speed: 0.0183s/iter; left time: 797.6411s
Epoch: 7 cost time: 9.032775163650513
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969124 --> -0.969982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0022980
	speed: 0.1064s/iter; left time: 4629.9594s
	iters: 200, epoch: 8 | loss: 0.0640144
	speed: 0.0207s/iter; left time: 897.9768s
	iters: 300, epoch: 8 | loss: 0.2313771
	speed: 0.0252s/iter; left time: 1090.6859s
	iters: 400, epoch: 8 | loss: 0.0002321
	speed: 0.0263s/iter; left time: 1137.2320s
Epoch: 8 cost time: 11.672559976577759
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.969982 --> -0.972555).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0005863
	speed: 0.1345s/iter; left time: 5792.1666s
	iters: 200, epoch: 9 | loss: 0.0145205
	speed: 0.0248s/iter; left time: 1065.2356s
	iters: 300, epoch: 9 | loss: 0.0022963
	speed: 0.0241s/iter; left time: 1032.9162s
	iters: 400, epoch: 9 | loss: 0.6179934
	speed: 0.0249s/iter; left time: 1064.9051s
Epoch: 9 cost time: 12.231996059417725
Epoch: 9, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0024427
	speed: 0.1318s/iter; left time: 5612.1250s
	iters: 200, epoch: 10 | loss: 0.0035669
	speed: 0.0238s/iter; left time: 1009.0664s
	iters: 300, epoch: 10 | loss: 0.3364547
	speed: 0.0248s/iter; left time: 1052.1478s
	iters: 400, epoch: 10 | loss: 0.0005268
	speed: 0.0250s/iter; left time: 1056.9116s
Epoch: 10 cost time: 12.036117315292358
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0038878
	speed: 0.1394s/iter; left time: 5871.3495s
	iters: 200, epoch: 11 | loss: 0.0004787
	speed: 0.0243s/iter; left time: 1020.7747s
	iters: 300, epoch: 11 | loss: 0.0913136
	speed: 0.0248s/iter; left time: 1040.4868s
	iters: 400, epoch: 11 | loss: 0.0005359
	speed: 0.0242s/iter; left time: 1013.0578s
Epoch: 11 cost time: 12.217821598052979
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973984).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0347756
	speed: 0.1389s/iter; left time: 5785.3495s
	iters: 200, epoch: 12 | loss: 0.0030639
	speed: 0.0245s/iter; left time: 1016.3383s
	iters: 300, epoch: 12 | loss: 0.0703612
	speed: 0.0242s/iter; left time: 1001.9355s
	iters: 400, epoch: 12 | loss: 0.7115166
	speed: 0.0236s/iter; left time: 973.7847s
Epoch: 12 cost time: 11.873249053955078
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0112130
	speed: 0.1405s/iter; left time: 5784.7596s
	iters: 200, epoch: 13 | loss: 0.0003026
	speed: 0.0248s/iter; left time: 1016.9746s
	iters: 300, epoch: 13 | loss: 0.0040717
	speed: 0.0246s/iter; left time: 1006.5348s
	iters: 400, epoch: 13 | loss: 0.0004884
	speed: 0.0260s/iter; left time: 1062.4444s
Epoch: 13 cost time: 12.159307956695557
Epoch: 13, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.973984 --> -0.974270).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0008569
	speed: 0.1299s/iter; left time: 5288.7917s
	iters: 200, epoch: 14 | loss: 0.0003888
	speed: 0.0241s/iter; left time: 976.8354s
	iters: 300, epoch: 14 | loss: 0.0014104
	speed: 0.0256s/iter; left time: 1037.9118s
	iters: 400, epoch: 14 | loss: 0.0905298
	speed: 0.0234s/iter; left time: 944.3339s
Epoch: 14 cost time: 11.642205476760864
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0044248
	speed: 0.1305s/iter; left time: 5249.9661s
	iters: 200, epoch: 15 | loss: 0.0006935
	speed: 0.0260s/iter; left time: 1042.6174s
	iters: 300, epoch: 15 | loss: 0.0002445
	speed: 0.0271s/iter; left time: 1086.6883s
	iters: 400, epoch: 15 | loss: 0.0036976
	speed: 0.0260s/iter; left time: 1039.1114s
Epoch: 15 cost time: 12.7328622341156
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975127).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1784733
	speed: 0.1402s/iter; left time: 5577.0554s
	iters: 200, epoch: 16 | loss: 0.0133007
	speed: 0.0248s/iter; left time: 982.8425s
	iters: 300, epoch: 16 | loss: 0.0355430
	speed: 0.0263s/iter; left time: 1040.8817s
	iters: 400, epoch: 16 | loss: 0.0379748
	speed: 0.0258s/iter; left time: 1016.4556s
Epoch: 16 cost time: 12.789921045303345
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0025821
	speed: 0.1332s/iter; left time: 5232.6003s
	iters: 200, epoch: 17 | loss: 0.0014844
	speed: 0.0232s/iter; left time: 909.5442s
	iters: 300, epoch: 17 | loss: 0.0001617
	speed: 0.0242s/iter; left time: 945.6268s
	iters: 400, epoch: 17 | loss: 0.0106278
	speed: 0.0240s/iter; left time: 935.3904s
Epoch: 17 cost time: 11.656076431274414
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0058011
	speed: 0.1352s/iter; left time: 5247.8785s
	iters: 200, epoch: 18 | loss: 0.0199217
	speed: 0.0251s/iter; left time: 970.2630s
	iters: 300, epoch: 18 | loss: 0.0050688
	speed: 0.0252s/iter; left time: 972.7181s
	iters: 400, epoch: 18 | loss: 0.0052161
	speed: 0.0228s/iter; left time: 878.8779s
Epoch: 18 cost time: 11.833062410354614
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000608
	speed: 0.1264s/iter; left time: 4848.6467s
	iters: 200, epoch: 19 | loss: 0.0060952
	speed: 0.0239s/iter; left time: 913.2249s
	iters: 300, epoch: 19 | loss: 0.0005797
	speed: 0.0238s/iter; left time: 906.6600s
	iters: 400, epoch: 19 | loss: 0.0006070
	speed: 0.0239s/iter; left time: 910.3743s
Epoch: 19 cost time: 11.59367322921753
Epoch: 19, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0033853
	speed: 0.1294s/iter; left time: 4902.8793s
	iters: 200, epoch: 20 | loss: 0.0127555
	speed: 0.0227s/iter; left time: 858.3804s
	iters: 300, epoch: 20 | loss: 0.0011165
	speed: 0.0234s/iter; left time: 880.2860s
	iters: 400, epoch: 20 | loss: 0.0000763
	speed: 0.0242s/iter; left time: 910.2246s
Epoch: 20 cost time: 11.652708053588867
Epoch: 20, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0656497
	speed: 0.1301s/iter; left time: 4866.6940s
	iters: 200, epoch: 21 | loss: 0.0091963
	speed: 0.0225s/iter; left time: 839.2370s
	iters: 300, epoch: 21 | loss: 0.0004846
	speed: 0.0230s/iter; left time: 854.3725s
	iters: 400, epoch: 21 | loss: 0.0025055
	speed: 0.0232s/iter; left time: 862.3991s
Epoch: 21 cost time: 11.195720195770264
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0113435
	speed: 0.1283s/iter; left time: 4742.5494s
	iters: 200, epoch: 22 | loss: 0.0054535
	speed: 0.0235s/iter; left time: 867.2087s
	iters: 300, epoch: 22 | loss: 0.0076076
	speed: 0.0241s/iter; left time: 884.4421s
	iters: 400, epoch: 22 | loss: 0.0048572
	speed: 0.0230s/iter; left time: 844.0921s
Epoch: 22 cost time: 11.505931615829468
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.975127 --> -0.978272).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0010591
	speed: 0.1269s/iter; left time: 4629.7287s
	iters: 200, epoch: 23 | loss: 0.0056275
	speed: 0.0242s/iter; left time: 879.0079s
	iters: 300, epoch: 23 | loss: 0.0004459
	speed: 0.0236s/iter; left time: 857.6312s
	iters: 400, epoch: 23 | loss: 0.0031537
	speed: 0.0231s/iter; left time: 837.5515s
Epoch: 23 cost time: 11.675257921218872
Epoch: 23, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0001514
	speed: 0.1261s/iter; left time: 4541.2112s
	iters: 200, epoch: 24 | loss: 0.0003291
	speed: 0.0232s/iter; left time: 834.5510s
	iters: 300, epoch: 24 | loss: 0.0135780
	speed: 0.0233s/iter; left time: 834.8169s
	iters: 400, epoch: 24 | loss: 0.0004608
	speed: 0.0241s/iter; left time: 861.0811s
Epoch: 24 cost time: 11.551076173782349
Epoch: 24, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.2174959
	speed: 0.1348s/iter; left time: 4791.0092s
	iters: 200, epoch: 25 | loss: 0.0125611
	speed: 0.0259s/iter; left time: 916.5487s
	iters: 300, epoch: 25 | loss: 0.0000056
	speed: 0.0259s/iter; left time: 917.1723s
	iters: 400, epoch: 25 | loss: 0.0004734
	speed: 0.0243s/iter; left time: 855.8789s
Epoch: 25 cost time: 12.194499731063843
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.978272 --> -0.978272).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0052626
	speed: 0.1341s/iter; left time: 4702.6767s
	iters: 200, epoch: 26 | loss: 0.0012369
	speed: 0.0252s/iter; left time: 880.1479s
	iters: 300, epoch: 26 | loss: 0.0032295
	speed: 0.0244s/iter; left time: 849.7021s
	iters: 400, epoch: 26 | loss: 0.0090807
	speed: 0.0237s/iter; left time: 825.8681s
Epoch: 26 cost time: 12.079846382141113
Epoch: 26, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0058902
	speed: 0.1308s/iter; left time: 4528.1565s
	iters: 200, epoch: 27 | loss: 0.0003710
	speed: 0.0235s/iter; left time: 811.5475s
	iters: 300, epoch: 27 | loss: 0.0060865
	speed: 0.0236s/iter; left time: 813.3381s
	iters: 400, epoch: 27 | loss: 0.0001257
	speed: 0.0237s/iter; left time: 812.8422s
Epoch: 27 cost time: 11.508111715316772
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0011465
	speed: 0.1316s/iter; left time: 4494.1771s
	iters: 200, epoch: 28 | loss: 0.1390279
	speed: 0.0240s/iter; left time: 816.6241s
	iters: 300, epoch: 28 | loss: 0.0147927
	speed: 0.0228s/iter; left time: 775.3460s
	iters: 400, epoch: 28 | loss: 0.0663685
	speed: 0.0236s/iter; left time: 800.1683s
Epoch: 28 cost time: 11.240105628967285
Epoch: 28, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0014418
	speed: 0.1241s/iter; left time: 4178.6891s
	iters: 200, epoch: 29 | loss: 0.0073326
	speed: 0.0247s/iter; left time: 829.6905s
	iters: 300, epoch: 29 | loss: 0.0000454
	speed: 0.0258s/iter; left time: 862.6857s
	iters: 400, epoch: 29 | loss: 0.0007574
	speed: 0.0239s/iter; left time: 796.7142s
Epoch: 29 cost time: 11.825823307037354
Epoch: 29, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.3141606
	speed: 0.1236s/iter; left time: 4103.4060s
	iters: 200, epoch: 30 | loss: 0.0426110
	speed: 0.0225s/iter; left time: 746.2709s
	iters: 300, epoch: 30 | loss: 0.0019799
	speed: 0.0243s/iter; left time: 802.9614s
	iters: 400, epoch: 30 | loss: 0.0070712
	speed: 0.0229s/iter; left time: 752.3031s
Epoch: 30 cost time: 11.433613061904907
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0204158
	speed: 0.1187s/iter; left time: 3886.7822s
	iters: 200, epoch: 31 | loss: 0.0000159
	speed: 0.0214s/iter; left time: 696.7696s
	iters: 300, epoch: 31 | loss: 0.0028524
	speed: 0.0214s/iter; left time: 696.8346s
	iters: 400, epoch: 31 | loss: 0.0000365
	speed: 0.0231s/iter; left time: 750.3515s
Epoch: 31 cost time: 10.869953870773315
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0007716
	speed: 0.1364s/iter; left time: 4401.3470s
	iters: 200, epoch: 32 | loss: 0.0000946
	speed: 0.0229s/iter; left time: 735.9951s
	iters: 300, epoch: 32 | loss: 0.0028024
	speed: 0.0234s/iter; left time: 751.0573s
	iters: 400, epoch: 32 | loss: 0.0058476
	speed: 0.0250s/iter; left time: 799.5506s
Epoch: 32 cost time: 11.676280498504639
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0065972
	speed: 0.1327s/iter; left time: 4217.5889s
	iters: 200, epoch: 33 | loss: 0.0024898
	speed: 0.0229s/iter; left time: 726.8250s
	iters: 300, epoch: 33 | loss: 0.0054364
	speed: 0.0251s/iter; left time: 793.0571s
	iters: 400, epoch: 33 | loss: 0.0007639
	speed: 0.0243s/iter; left time: 765.5029s
Epoch: 33 cost time: 11.917853832244873
Epoch: 33, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.980273).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0013298
	speed: 0.1426s/iter; left time: 4467.4441s
	iters: 200, epoch: 34 | loss: 0.0000343
	speed: 0.0258s/iter; left time: 806.2296s
	iters: 300, epoch: 34 | loss: 0.0019785
	speed: 0.0258s/iter; left time: 804.5292s
	iters: 400, epoch: 34 | loss: 0.0003434
	speed: 0.0254s/iter; left time: 789.2449s
Epoch: 34 cost time: 12.647433996200562
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 35 | loss: 0.0000962
	speed: 0.1399s/iter; left time: 4317.2391s
	iters: 200, epoch: 35 | loss: 0.0000563
	speed: 0.0264s/iter; left time: 813.0848s
	iters: 300, epoch: 35 | loss: 0.0025069
	speed: 0.0257s/iter; left time: 788.2233s
	iters: 400, epoch: 35 | loss: 0.0140166
	speed: 0.0263s/iter; left time: 802.1416s
Epoch: 35 cost time: 12.754684686660767
Epoch: 35, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 36 | loss: 0.0000766
	speed: 0.1387s/iter; left time: 4213.4930s
	iters: 200, epoch: 36 | loss: 0.0002173
	speed: 0.0269s/iter; left time: 814.3564s
	iters: 300, epoch: 36 | loss: 0.0005170
	speed: 0.0272s/iter; left time: 822.5265s
	iters: 400, epoch: 36 | loss: 0.0239102
	speed: 0.0257s/iter; left time: 774.6419s
Epoch: 36 cost time: 12.89170789718628
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 37 | loss: 0.0040847
	speed: 0.1406s/iter; left time: 4205.6963s
	iters: 200, epoch: 37 | loss: 0.0017783
	speed: 0.0246s/iter; left time: 733.1646s
	iters: 300, epoch: 37 | loss: 0.0000716
	speed: 0.0242s/iter; left time: 720.5615s
	iters: 400, epoch: 37 | loss: 0.0004245
	speed: 0.0250s/iter; left time: 740.7231s
Epoch: 37 cost time: 11.985885858535767
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 38 | loss: 0.0904438
	speed: 0.1388s/iter; left time: 4088.6904s
	iters: 200, epoch: 38 | loss: 0.1057017
	speed: 0.0235s/iter; left time: 689.1794s
	iters: 300, epoch: 38 | loss: 0.0011168
	speed: 0.0250s/iter; left time: 730.4675s
	iters: 400, epoch: 38 | loss: 0.0000019
	speed: 0.0248s/iter; left time: 722.5193s
Epoch: 38 cost time: 12.159894943237305
Epoch: 38, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 39 | loss: 0.0000423
	speed: 0.1391s/iter; left time: 4032.0918s
	iters: 200, epoch: 39 | loss: 0.0257635
	speed: 0.0256s/iter; left time: 739.8195s
	iters: 300, epoch: 39 | loss: 0.0001662
	speed: 0.0255s/iter; left time: 733.6989s
	iters: 400, epoch: 39 | loss: 0.0194732
	speed: 0.0247s/iter; left time: 708.7178s
Epoch: 39 cost time: 12.36191725730896
Epoch: 39, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 40 | loss: 0.0033930
	speed: 0.1392s/iter; left time: 3967.3150s
	iters: 200, epoch: 40 | loss: 0.0000033
	speed: 0.0249s/iter; left time: 706.1713s
	iters: 300, epoch: 40 | loss: 0.0004685
	speed: 0.0247s/iter; left time: 700.3864s
	iters: 400, epoch: 40 | loss: 0.0004272
	speed: 0.0253s/iter; left time: 714.8028s
Epoch: 40 cost time: 12.399547338485718
Epoch: 40, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 41 | loss: 0.0002980
	speed: 0.1351s/iter; left time: 3787.4522s
	iters: 200, epoch: 41 | loss: 0.0003116
	speed: 0.0238s/iter; left time: 665.4739s
	iters: 300, epoch: 41 | loss: 0.0000101
	speed: 0.0244s/iter; left time: 679.6669s
	iters: 400, epoch: 41 | loss: 0.1490199
	speed: 0.0246s/iter; left time: 683.4384s
Epoch: 41 cost time: 12.175013542175293
Epoch: 41, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 42 | loss: 0.0011597
	speed: 0.1371s/iter; left time: 3780.0831s
	iters: 200, epoch: 42 | loss: 0.0029044
	speed: 0.0236s/iter; left time: 649.2059s
	iters: 300, epoch: 42 | loss: 0.0000106
	speed: 0.0252s/iter; left time: 689.1483s
	iters: 400, epoch: 42 | loss: 0.0003143
	speed: 0.0260s/iter; left time: 708.7950s
Epoch: 42 cost time: 12.126056432723999
Epoch: 42, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 43 | loss: 0.0016634
	speed: 0.1401s/iter; left time: 3796.7158s
	iters: 200, epoch: 43 | loss: 0.0028203
	speed: 0.0276s/iter; left time: 745.3742s
	iters: 300, epoch: 43 | loss: 0.0032171
	speed: 0.0266s/iter; left time: 714.4211s
	iters: 400, epoch: 43 | loss: 0.0001939
	speed: 0.0255s/iter; left time: 682.6254s
Epoch: 43 cost time: 12.7695472240448
Epoch: 43, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9802744425385935
model parameter : 308002
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9035391
	speed: 0.0588s/iter; left time: 2752.7551s
	iters: 200, epoch: 1 | loss: 0.2231046
	speed: 0.0266s/iter; left time: 1241.2408s
	iters: 300, epoch: 1 | loss: 0.0778070
	speed: 0.0248s/iter; left time: 1154.4233s
	iters: 400, epoch: 1 | loss: 0.3986832
	speed: 0.0264s/iter; left time: 1225.7485s
Epoch: 1 cost time: 15.586155414581299
Epoch: 1, Steps: 469 | Train Loss: 0.642 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (inf --> -0.935104).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1472636
	speed: 0.1782s/iter; left time: 8257.3310s
	iters: 200, epoch: 2 | loss: 0.0708299
	speed: 0.0279s/iter; left time: 1291.3191s
	iters: 300, epoch: 2 | loss: 0.0745734
	speed: 0.0275s/iter; left time: 1269.6429s
	iters: 400, epoch: 2 | loss: 0.0527788
	speed: 0.0259s/iter; left time: 1191.7099s
Epoch: 2 cost time: 12.959556102752686
Epoch: 2, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.935104 --> -0.959404).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2538518
	speed: 0.1919s/iter; left time: 8803.3322s
	iters: 200, epoch: 3 | loss: 0.0201958
	speed: 0.0240s/iter; left time: 1098.9354s
	iters: 300, epoch: 3 | loss: 0.0137239
	speed: 0.0262s/iter; left time: 1197.5965s
	iters: 400, epoch: 3 | loss: 0.0123715
	speed: 0.0243s/iter; left time: 1109.0676s
Epoch: 3 cost time: 12.988237380981445
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
Validation loss decreased (-0.959404 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0344877
	speed: 0.1826s/iter; left time: 8288.5130s
	iters: 200, epoch: 4 | loss: 0.4882599
	speed: 0.0257s/iter; left time: 1162.3317s
	iters: 300, epoch: 4 | loss: 0.0157495
	speed: 0.0257s/iter; left time: 1160.4626s
	iters: 400, epoch: 4 | loss: 0.0079121
	speed: 0.0263s/iter; left time: 1186.6728s
Epoch: 4 cost time: 12.519836902618408
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
Validation loss decreased (-0.966265 --> -0.969124).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0026799
	speed: 0.1807s/iter; left time: 8119.5716s
	iters: 200, epoch: 5 | loss: 0.0068365
	speed: 0.0271s/iter; left time: 1214.9886s
	iters: 300, epoch: 5 | loss: 0.0033183
	speed: 0.0266s/iter; left time: 1188.1390s
	iters: 400, epoch: 5 | loss: 0.0004666
	speed: 0.0279s/iter; left time: 1246.2641s
Epoch: 5 cost time: 13.015075445175171
Epoch: 5, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.969124 --> -0.974270).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0009579
	speed: 0.1749s/iter; left time: 7775.7853s
	iters: 200, epoch: 6 | loss: 0.0014130
	speed: 0.0335s/iter; left time: 1487.0619s
	iters: 300, epoch: 6 | loss: 0.0470273
	speed: 0.0313s/iter; left time: 1385.9129s
	iters: 400, epoch: 6 | loss: 0.0248514
	speed: 0.0276s/iter; left time: 1218.8490s
Epoch: 6 cost time: 14.844918012619019
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0113173
	speed: 0.1932s/iter; left time: 8498.9175s
	iters: 200, epoch: 7 | loss: 0.0010144
	speed: 0.0281s/iter; left time: 1234.8321s
	iters: 300, epoch: 7 | loss: 0.0003834
	speed: 0.0247s/iter; left time: 1079.5550s
	iters: 400, epoch: 7 | loss: 0.0010087
	speed: 0.0283s/iter; left time: 1235.2412s
Epoch: 7 cost time: 13.539169549942017
Epoch: 7, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976557).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0016205
	speed: 0.1937s/iter; left time: 8430.0845s
	iters: 200, epoch: 8 | loss: 0.0564538
	speed: 0.0283s/iter; left time: 1229.8752s
	iters: 300, epoch: 8 | loss: 0.0654714
	speed: 0.0287s/iter; left time: 1243.9276s
	iters: 400, epoch: 8 | loss: 0.0004130
	speed: 0.0315s/iter; left time: 1360.2384s
Epoch: 8 cost time: 14.496166706085205
Epoch: 8, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000211
	speed: 0.2021s/iter; left time: 8701.0872s
	iters: 200, epoch: 9 | loss: 0.0016939
	speed: 0.0315s/iter; left time: 1353.1749s
	iters: 300, epoch: 9 | loss: 0.0054696
	speed: 0.0299s/iter; left time: 1282.6787s
	iters: 400, epoch: 9 | loss: 0.4497363
	speed: 0.0333s/iter; left time: 1424.0335s
Epoch: 9 cost time: 15.508153915405273
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0056021
	speed: 0.2250s/iter; left time: 9579.1703s
	iters: 200, epoch: 10 | loss: 0.0012037
	speed: 0.0330s/iter; left time: 1401.4404s
	iters: 300, epoch: 10 | loss: 0.0376756
	speed: 0.0350s/iter; left time: 1482.4760s
	iters: 400, epoch: 10 | loss: 0.1285682
	speed: 0.0322s/iter; left time: 1359.3161s
Epoch: 10 cost time: 16.391358852386475
Epoch: 10, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979130).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.1062522
	speed: 0.2154s/iter; left time: 9070.6583s
	iters: 200, epoch: 11 | loss: 0.4033650
	speed: 0.0271s/iter; left time: 1137.4526s
	iters: 300, epoch: 11 | loss: 0.0001975
	speed: 0.0292s/iter; left time: 1223.2494s
	iters: 400, epoch: 11 | loss: 0.0208113
	speed: 0.0290s/iter; left time: 1213.7984s
Epoch: 11 cost time: 14.283952236175537
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0491396
	speed: 0.2101s/iter; left time: 8748.6173s
	iters: 200, epoch: 12 | loss: 0.0380736
	speed: 0.0296s/iter; left time: 1228.6118s
	iters: 300, epoch: 12 | loss: 0.1222511
	speed: 0.0315s/iter; left time: 1306.8035s
	iters: 400, epoch: 12 | loss: 0.8430485
	speed: 0.0329s/iter; left time: 1362.1799s
Epoch: 12 cost time: 14.830862283706665
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0001977
	speed: 0.2112s/iter; left time: 8694.3624s
	iters: 200, epoch: 13 | loss: 0.0003598
	speed: 0.0319s/iter; left time: 1308.4331s
	iters: 300, epoch: 13 | loss: 0.0673646
	speed: 0.0300s/iter; left time: 1227.9416s
	iters: 400, epoch: 13 | loss: 0.0046168
	speed: 0.0285s/iter; left time: 1166.7585s
Epoch: 13 cost time: 14.914431810379028
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0017928
	speed: 0.2116s/iter; left time: 8612.1219s
	iters: 200, epoch: 14 | loss: 0.0000992
	speed: 0.0312s/iter; left time: 1267.9680s
	iters: 300, epoch: 14 | loss: 0.0625766
	speed: 0.0304s/iter; left time: 1231.1768s
	iters: 400, epoch: 14 | loss: 0.0001422
	speed: 0.0344s/iter; left time: 1389.6669s
Epoch: 14 cost time: 15.511028051376343
Epoch: 14, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0000933
	speed: 0.2180s/iter; left time: 8770.3752s
	iters: 200, epoch: 15 | loss: 0.0179453
	speed: 0.0293s/iter; left time: 1175.1817s
	iters: 300, epoch: 15 | loss: 0.0039043
	speed: 0.0288s/iter; left time: 1152.8896s
	iters: 400, epoch: 15 | loss: 0.0004828
	speed: 0.0292s/iter; left time: 1166.8042s
Epoch: 15 cost time: 14.725474119186401
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.1411766
	speed: 0.2114s/iter; left time: 8408.1409s
	iters: 200, epoch: 16 | loss: 0.0046146
	speed: 0.0309s/iter; left time: 1224.5398s
	iters: 300, epoch: 16 | loss: 0.0031289
	speed: 0.0326s/iter; left time: 1291.5102s
	iters: 400, epoch: 16 | loss: 0.0021559
	speed: 0.0319s/iter; left time: 1259.1226s
Epoch: 16 cost time: 15.361286401748657
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.979130 --> -0.980559).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0012396
	speed: 0.2117s/iter; left time: 8318.9663s
	iters: 200, epoch: 17 | loss: 0.0001716
	speed: 0.0283s/iter; left time: 1109.1584s
	iters: 300, epoch: 17 | loss: 0.0001021
	speed: 0.0274s/iter; left time: 1072.0217s
	iters: 400, epoch: 17 | loss: 0.3034948
	speed: 0.0303s/iter; left time: 1182.6858s
Epoch: 17 cost time: 14.027554750442505
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0008160
	speed: 0.2055s/iter; left time: 7980.1259s
	iters: 200, epoch: 18 | loss: 0.0000329
	speed: 0.0285s/iter; left time: 1104.5345s
	iters: 300, epoch: 18 | loss: 0.0019427
	speed: 0.0296s/iter; left time: 1142.2261s
	iters: 400, epoch: 18 | loss: 0.0281524
	speed: 0.0353s/iter; left time: 1361.9214s
Epoch: 18 cost time: 15.536098718643188
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0000153
	speed: 0.2047s/iter; left time: 7853.1278s
	iters: 200, epoch: 19 | loss: 0.0000697
	speed: 0.0293s/iter; left time: 1119.7751s
	iters: 300, epoch: 19 | loss: 0.0215273
	speed: 0.0263s/iter; left time: 1004.3908s
	iters: 400, epoch: 19 | loss: 0.0001014
	speed: 0.0292s/iter; left time: 1109.8562s
Epoch: 19 cost time: 13.79315733909607
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0053023
	speed: 0.1852s/iter; left time: 7018.4940s
	iters: 200, epoch: 20 | loss: 0.2696312
	speed: 0.0257s/iter; left time: 970.9639s
	iters: 300, epoch: 20 | loss: 0.0009042
	speed: 0.0241s/iter; left time: 908.3862s
	iters: 400, epoch: 20 | loss: 0.0284287
	speed: 0.0258s/iter; left time: 970.1955s
Epoch: 20 cost time: 12.536754131317139
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0015107
	speed: 0.1796s/iter; left time: 6719.8958s
	iters: 200, epoch: 21 | loss: 0.0004771
	speed: 0.0290s/iter; left time: 1080.8555s
	iters: 300, epoch: 21 | loss: 0.0011246
	speed: 0.0270s/iter; left time: 1004.4793s
	iters: 400, epoch: 21 | loss: 0.0004211
	speed: 0.0278s/iter; left time: 1031.4410s
Epoch: 21 cost time: 13.517865657806396
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0125345
	speed: 0.1823s/iter; left time: 6736.6184s
	iters: 200, epoch: 22 | loss: 0.0954475
	speed: 0.0264s/iter; left time: 974.4455s
	iters: 300, epoch: 22 | loss: 0.0243981
	speed: 0.0285s/iter; left time: 1046.6619s
	iters: 400, epoch: 22 | loss: 0.0005921
	speed: 0.0295s/iter; left time: 1080.4478s
Epoch: 22 cost time: 13.701429605484009
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0001712
	speed: 0.2051s/iter; left time: 7481.2655s
	iters: 200, epoch: 23 | loss: 0.0010540
	speed: 0.0305s/iter; left time: 1110.0010s
	iters: 300, epoch: 23 | loss: 0.0000760
	speed: 0.0297s/iter; left time: 1078.2632s
	iters: 400, epoch: 23 | loss: 0.0002597
	speed: 0.0294s/iter; left time: 1065.1365s
Epoch: 23 cost time: 14.858711957931519
Epoch: 23, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0001809
	speed: 0.2200s/iter; left time: 7923.9922s
	iters: 200, epoch: 24 | loss: 0.0000457
	speed: 0.0310s/iter; left time: 1114.6716s
	iters: 300, epoch: 24 | loss: 0.0290551
	speed: 0.0318s/iter; left time: 1140.4295s
	iters: 400, epoch: 24 | loss: 0.0000285
	speed: 0.0321s/iter; left time: 1146.9253s
Epoch: 24 cost time: 15.349685907363892
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0014972
	speed: 0.2091s/iter; left time: 7431.1202s
	iters: 200, epoch: 25 | loss: 0.0001585
	speed: 0.0291s/iter; left time: 1031.7073s
	iters: 300, epoch: 25 | loss: 0.0000053
	speed: 0.0280s/iter; left time: 988.9466s
	iters: 400, epoch: 25 | loss: 0.0000279
	speed: 0.0310s/iter; left time: 1091.6462s
Epoch: 25 cost time: 14.765763282775879
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.979 Test Loss: 0.164 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 26 | loss: 0.0000384
	speed: 0.2059s/iter; left time: 7220.8843s
	iters: 200, epoch: 26 | loss: 0.0102292
	speed: 0.0316s/iter; left time: 1104.8555s
	iters: 300, epoch: 26 | loss: 0.0000500
	speed: 0.0280s/iter; left time: 976.2108s
	iters: 400, epoch: 26 | loss: 0.0000909
	speed: 0.0295s/iter; left time: 1025.0864s
Epoch: 26 cost time: 14.727452278137207
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 308002
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.7801879
	speed: 0.0440s/iter; left time: 2057.3877s
	iters: 200, epoch: 1 | loss: 0.5266222
	speed: 0.0248s/iter; left time: 1156.7619s
	iters: 300, epoch: 1 | loss: 0.3459797
	speed: 0.0250s/iter; left time: 1165.7844s
	iters: 400, epoch: 1 | loss: 0.2929576
	speed: 0.0256s/iter; left time: 1192.4582s
Epoch: 1 cost time: 13.73177170753479
Epoch: 1, Steps: 469 | Train Loss: 0.618 Vali Loss: 0.282 Vali Acc: 0.910 Test Loss: 0.282 Test Acc: 0.910
Validation loss decreased (inf --> -0.909946).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1387392
	speed: 0.1347s/iter; left time: 6240.1399s
	iters: 200, epoch: 2 | loss: 0.0931724
	speed: 0.0248s/iter; left time: 1148.6084s
	iters: 300, epoch: 2 | loss: 0.0724750
	speed: 0.0252s/iter; left time: 1162.5058s
	iters: 400, epoch: 2 | loss: 0.0380406
	speed: 0.0243s/iter; left time: 1116.3273s
Epoch: 2 cost time: 11.973796844482422
Epoch: 2, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.909946 --> -0.957974).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0279697
	speed: 0.1331s/iter; left time: 6102.1025s
	iters: 200, epoch: 3 | loss: 0.0820521
	speed: 0.0238s/iter; left time: 1091.2884s
	iters: 300, epoch: 3 | loss: 0.0120544
	speed: 0.0254s/iter; left time: 1160.1129s
	iters: 400, epoch: 3 | loss: 0.0740623
	speed: 0.0248s/iter; left time: 1131.6812s
Epoch: 3 cost time: 11.790178298950195
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.957974 --> -0.964550).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0056629
	speed: 0.1406s/iter; left time: 6380.8846s
	iters: 200, epoch: 4 | loss: 0.0477150
	speed: 0.0254s/iter; left time: 1148.9153s
	iters: 300, epoch: 4 | loss: 0.2499350
	speed: 0.0190s/iter; left time: 859.3135s
	iters: 400, epoch: 4 | loss: 0.0908895
	speed: 0.0198s/iter; left time: 892.8229s
Epoch: 4 cost time: 10.949172019958496
Epoch: 4, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.964550 --> -0.964550).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0326429
	speed: 0.1138s/iter; left time: 5112.6713s
	iters: 200, epoch: 5 | loss: 0.0442776
	speed: 0.0207s/iter; left time: 927.2199s
	iters: 300, epoch: 5 | loss: 0.0988780
	speed: 0.0231s/iter; left time: 1033.9078s
	iters: 400, epoch: 5 | loss: 0.0099494
	speed: 0.0244s/iter; left time: 1090.4470s
Epoch: 5 cost time: 11.06871509552002
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
Validation loss decreased (-0.964550 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0190713
	speed: 0.1341s/iter; left time: 5959.9457s
	iters: 200, epoch: 6 | loss: 0.0133379
	speed: 0.0235s/iter; left time: 1044.0111s
	iters: 300, epoch: 6 | loss: 0.0232167
	speed: 0.0224s/iter; left time: 992.9709s
	iters: 400, epoch: 6 | loss: 0.0141586
	speed: 0.0230s/iter; left time: 1017.5862s
Epoch: 6 cost time: 11.398331880569458
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.969982).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0128779
	speed: 0.1250s/iter; left time: 5497.5040s
	iters: 200, epoch: 7 | loss: 0.0264708
	speed: 0.0257s/iter; left time: 1129.7531s
	iters: 300, epoch: 7 | loss: 0.0269507
	speed: 0.0266s/iter; left time: 1165.2692s
	iters: 400, epoch: 7 | loss: 0.0139731
	speed: 0.0253s/iter; left time: 1104.0617s
Epoch: 7 cost time: 12.430294036865234
Epoch: 7, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969982 --> -0.969982).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0380507
	speed: 0.1314s/iter; left time: 5718.6930s
	iters: 200, epoch: 8 | loss: 0.0070642
	speed: 0.0249s/iter; left time: 1082.0022s
	iters: 300, epoch: 8 | loss: 0.0035099
	speed: 0.0255s/iter; left time: 1106.6652s
	iters: 400, epoch: 8 | loss: 0.0115844
	speed: 0.0253s/iter; left time: 1095.4788s
Epoch: 8 cost time: 12.071276903152466
Epoch: 8, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.969982 --> -0.972840).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0483445
	speed: 0.1362s/iter; left time: 5865.1072s
	iters: 200, epoch: 9 | loss: 0.0018263
	speed: 0.0249s/iter; left time: 1067.2915s
	iters: 300, epoch: 9 | loss: 0.0005961
	speed: 0.0251s/iter; left time: 1073.7125s
	iters: 400, epoch: 9 | loss: 0.0644867
	speed: 0.0252s/iter; left time: 1075.1883s
Epoch: 9 cost time: 12.195904731750488
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0042316
	speed: 0.1352s/iter; left time: 5755.8156s
	iters: 200, epoch: 10 | loss: 0.0182186
	speed: 0.0273s/iter; left time: 1158.0425s
	iters: 300, epoch: 10 | loss: 0.1042402
	speed: 0.0277s/iter; left time: 1172.0858s
	iters: 400, epoch: 10 | loss: 0.0049949
	speed: 0.0251s/iter; left time: 1060.2108s
Epoch: 10 cost time: 12.732240200042725
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0020956
	speed: 0.1356s/iter; left time: 5709.6236s
	iters: 200, epoch: 11 | loss: 0.0019030
	speed: 0.0263s/iter; left time: 1104.9187s
	iters: 300, epoch: 11 | loss: 0.0116427
	speed: 0.0259s/iter; left time: 1085.8014s
	iters: 400, epoch: 11 | loss: 0.0239393
	speed: 0.0239s/iter; left time: 1000.9151s
Epoch: 11 cost time: 12.446949481964111
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0011482
	speed: 0.1322s/iter; left time: 5503.0352s
	iters: 200, epoch: 12 | loss: 0.3705484
	speed: 0.0237s/iter; left time: 985.6827s
	iters: 300, epoch: 12 | loss: 0.0069851
	speed: 0.0238s/iter; left time: 984.6995s
	iters: 400, epoch: 12 | loss: 0.0011021
	speed: 0.0253s/iter; left time: 1044.3131s
Epoch: 12 cost time: 11.87031364440918
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0545256
	speed: 0.1340s/iter; left time: 5518.9254s
	iters: 200, epoch: 13 | loss: 0.0004949
	speed: 0.0237s/iter; left time: 971.9343s
	iters: 300, epoch: 13 | loss: 0.1153146
	speed: 0.0246s/iter; left time: 1008.7424s
	iters: 400, epoch: 13 | loss: 0.0021936
	speed: 0.0247s/iter; left time: 1007.8753s
Epoch: 13 cost time: 11.902656078338623
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973984).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0007193
	speed: 0.1350s/iter; left time: 5494.9302s
	iters: 200, epoch: 14 | loss: 0.0020559
	speed: 0.0254s/iter; left time: 1031.2455s
	iters: 300, epoch: 14 | loss: 0.0073983
	speed: 0.0257s/iter; left time: 1039.8049s
	iters: 400, epoch: 14 | loss: 0.0057903
	speed: 0.0252s/iter; left time: 1018.9801s
Epoch: 14 cost time: 12.165620565414429
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0004919
	speed: 0.1352s/iter; left time: 5439.7267s
	iters: 200, epoch: 15 | loss: 0.0010804
	speed: 0.0228s/iter; left time: 916.5997s
	iters: 300, epoch: 15 | loss: 0.0037265
	speed: 0.0246s/iter; left time: 983.2450s
	iters: 400, epoch: 15 | loss: 0.2138988
	speed: 0.0250s/iter; left time: 996.8283s
Epoch: 15 cost time: 11.775131225585938
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974556).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0007228
	speed: 0.1287s/iter; left time: 5117.6409s
	iters: 200, epoch: 16 | loss: 0.0043938
	speed: 0.0230s/iter; left time: 912.1825s
	iters: 300, epoch: 16 | loss: 0.0029292
	speed: 0.0234s/iter; left time: 924.4983s
	iters: 400, epoch: 16 | loss: 0.0005797
	speed: 0.0231s/iter; left time: 910.5326s
Epoch: 16 cost time: 11.393685340881348
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0830018
	speed: 0.1292s/iter; left time: 5078.4638s
	iters: 200, epoch: 17 | loss: 0.0013341
	speed: 0.0264s/iter; left time: 1033.5760s
	iters: 300, epoch: 17 | loss: 0.0008286
	speed: 0.0251s/iter; left time: 980.5768s
	iters: 400, epoch: 17 | loss: 0.0028378
	speed: 0.0246s/iter; left time: 957.7823s
Epoch: 17 cost time: 12.23432445526123
Epoch: 17, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.974556 --> -0.979702).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0013114
	speed: 0.1316s/iter; left time: 5109.3663s
	iters: 200, epoch: 18 | loss: 0.0138087
	speed: 0.0243s/iter; left time: 939.9711s
	iters: 300, epoch: 18 | loss: 0.0008541
	speed: 0.0249s/iter; left time: 960.2303s
	iters: 400, epoch: 18 | loss: 0.0003501
	speed: 0.0242s/iter; left time: 934.1659s
Epoch: 18 cost time: 11.879972457885742
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0024824
	speed: 0.1385s/iter; left time: 5314.1684s
	iters: 200, epoch: 19 | loss: 0.0024707
	speed: 0.0226s/iter; left time: 863.6535s
	iters: 300, epoch: 19 | loss: 0.0021263
	speed: 0.0237s/iter; left time: 903.6332s
	iters: 400, epoch: 19 | loss: 0.0057750
	speed: 0.0237s/iter; left time: 902.1475s
Epoch: 19 cost time: 11.44762134552002
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0014758
	speed: 0.1381s/iter; left time: 5233.4591s
	iters: 200, epoch: 20 | loss: 0.0484455
	speed: 0.0231s/iter; left time: 872.9022s
	iters: 300, epoch: 20 | loss: 0.0003643
	speed: 0.0242s/iter; left time: 912.6278s
	iters: 400, epoch: 20 | loss: 0.0004196
	speed: 0.0247s/iter; left time: 929.8165s
Epoch: 20 cost time: 11.716418743133545
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0181326
	speed: 0.1260s/iter; left time: 4714.7460s
	iters: 200, epoch: 21 | loss: 0.1674224
	speed: 0.0225s/iter; left time: 839.6236s
	iters: 300, epoch: 21 | loss: 0.0060261
	speed: 0.0242s/iter; left time: 898.9067s
	iters: 400, epoch: 21 | loss: 0.0000220
	speed: 0.0230s/iter; left time: 853.2645s
Epoch: 21 cost time: 11.279102087020874
Epoch: 21, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0049213
	speed: 0.1228s/iter; left time: 4538.4746s
	iters: 200, epoch: 22 | loss: 0.0005566
	speed: 0.0227s/iter; left time: 837.5347s
	iters: 300, epoch: 22 | loss: 0.0006190
	speed: 0.0229s/iter; left time: 842.3929s
	iters: 400, epoch: 22 | loss: 0.0001596
	speed: 0.0231s/iter; left time: 844.8617s
Epoch: 22 cost time: 11.346736669540405
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0182316
	speed: 0.1303s/iter; left time: 4753.6330s
	iters: 200, epoch: 23 | loss: 0.0284039
	speed: 0.0213s/iter; left time: 775.8409s
	iters: 300, epoch: 23 | loss: 0.0001363
	speed: 0.0234s/iter; left time: 849.8377s
	iters: 400, epoch: 23 | loss: 0.0059646
	speed: 0.0238s/iter; left time: 860.0314s
Epoch: 23 cost time: 11.409382343292236
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000378
	speed: 0.1304s/iter; left time: 4694.8622s
	iters: 200, epoch: 24 | loss: 0.0001005
	speed: 0.0226s/iter; left time: 812.6005s
	iters: 300, epoch: 24 | loss: 0.8761057
	speed: 0.0220s/iter; left time: 789.5226s
	iters: 400, epoch: 24 | loss: 0.0022148
	speed: 0.0244s/iter; left time: 872.6714s
Epoch: 24 cost time: 11.405398607254028
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0312044
	speed: 0.1350s/iter; left time: 4798.3328s
	iters: 200, epoch: 25 | loss: 0.3012408
	speed: 0.0240s/iter; left time: 851.7414s
	iters: 300, epoch: 25 | loss: 0.1754037
	speed: 0.0225s/iter; left time: 794.1378s
	iters: 400, epoch: 25 | loss: 0.0001788
	speed: 0.0239s/iter; left time: 843.0915s
Epoch: 25 cost time: 11.465096473693848
Epoch: 25, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981417).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0003512
	speed: 0.1337s/iter; left time: 4688.9439s
	iters: 200, epoch: 26 | loss: 0.1062313
	speed: 0.0268s/iter; left time: 936.4304s
	iters: 300, epoch: 26 | loss: 0.0000972
	speed: 0.0248s/iter; left time: 864.2960s
	iters: 400, epoch: 26 | loss: 0.0117029
	speed: 0.0239s/iter; left time: 830.6260s
Epoch: 26 cost time: 12.180563688278198
Epoch: 26, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0003606
	speed: 0.1356s/iter; left time: 4692.8523s
	iters: 200, epoch: 27 | loss: 0.0061670
	speed: 0.0254s/iter; left time: 876.3025s
	iters: 300, epoch: 27 | loss: 0.2477382
	speed: 0.0246s/iter; left time: 848.0243s
	iters: 400, epoch: 27 | loss: 0.0234036
	speed: 0.0251s/iter; left time: 861.3831s
Epoch: 27 cost time: 12.361932516098022
Epoch: 27, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.981417 --> -0.982846).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0002853
	speed: 0.1319s/iter; left time: 4502.3118s
	iters: 200, epoch: 28 | loss: 0.0005349
	speed: 0.0243s/iter; left time: 826.1804s
	iters: 300, epoch: 28 | loss: 0.0334228
	speed: 0.0237s/iter; left time: 806.0178s
	iters: 400, epoch: 28 | loss: 0.0005838
	speed: 0.0247s/iter; left time: 835.0949s
Epoch: 28 cost time: 11.855387449264526
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0001926
	speed: 0.1302s/iter; left time: 4385.2681s
	iters: 200, epoch: 29 | loss: 0.0039841
	speed: 0.0231s/iter; left time: 773.9574s
	iters: 300, epoch: 29 | loss: 0.0174332
	speed: 0.0272s/iter; left time: 911.4329s
	iters: 400, epoch: 29 | loss: 0.0006460
	speed: 0.0256s/iter; left time: 853.5972s
Epoch: 29 cost time: 11.908498764038086
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000456
	speed: 0.1361s/iter; left time: 4519.9985s
	iters: 200, epoch: 30 | loss: 0.0032471
	speed: 0.0243s/iter; left time: 805.7305s
	iters: 300, epoch: 30 | loss: 0.0149827
	speed: 0.0248s/iter; left time: 818.6398s
	iters: 400, epoch: 30 | loss: 0.0012498
	speed: 0.0233s/iter; left time: 767.5382s
Epoch: 30 cost time: 11.70079755783081
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0001345
	speed: 0.1335s/iter; left time: 4369.1657s
	iters: 200, epoch: 31 | loss: 0.0110199
	speed: 0.0249s/iter; left time: 811.8565s
	iters: 300, epoch: 31 | loss: 0.0001581
	speed: 0.0241s/iter; left time: 783.5529s
	iters: 400, epoch: 31 | loss: 0.0002627
	speed: 0.0239s/iter; left time: 776.3806s
Epoch: 31 cost time: 11.964170217514038
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0001854
	speed: 0.1325s/iter; left time: 4274.9665s
	iters: 200, epoch: 32 | loss: 0.0087495
	speed: 0.0237s/iter; left time: 760.9384s
	iters: 300, epoch: 32 | loss: 0.0183375
	speed: 0.0236s/iter; left time: 755.6446s
	iters: 400, epoch: 32 | loss: 0.1347698
	speed: 0.0249s/iter; left time: 795.5885s
Epoch: 32 cost time: 11.669114828109741
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0039077
	speed: 0.1320s/iter; left time: 4196.8617s
	iters: 200, epoch: 33 | loss: 0.0004433
	speed: 0.0228s/iter; left time: 723.5668s
	iters: 300, epoch: 33 | loss: 0.1261246
	speed: 0.0226s/iter; left time: 714.9925s
	iters: 400, epoch: 33 | loss: 0.0191196
	speed: 0.0235s/iter; left time: 741.4310s
Epoch: 33 cost time: 11.438833713531494
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0067192
	speed: 0.1360s/iter; left time: 4259.4848s
	iters: 200, epoch: 34 | loss: 0.0004735
	speed: 0.0232s/iter; left time: 724.4566s
	iters: 300, epoch: 34 | loss: 0.0001832
	speed: 0.0242s/iter; left time: 752.1835s
	iters: 400, epoch: 34 | loss: 0.0021510
	speed: 0.0252s/iter; left time: 783.1027s
Epoch: 34 cost time: 11.876839637756348
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0044512
	speed: 0.1372s/iter; left time: 4232.0537s
	iters: 200, epoch: 35 | loss: 0.0080600
	speed: 0.0261s/iter; left time: 803.8576s
	iters: 300, epoch: 35 | loss: 0.0478854
	speed: 0.0259s/iter; left time: 794.3472s
	iters: 400, epoch: 35 | loss: 0.0007621
	speed: 0.0246s/iter; left time: 752.6330s
Epoch: 35 cost time: 12.362422704696655
Epoch: 35, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0062408
	speed: 0.1384s/iter; left time: 4205.4742s
	iters: 200, epoch: 36 | loss: 0.0003559
	speed: 0.0256s/iter; left time: 775.3410s
	iters: 300, epoch: 36 | loss: 0.0050159
	speed: 0.0248s/iter; left time: 749.8314s
	iters: 400, epoch: 36 | loss: 0.0120277
	speed: 0.0264s/iter; left time: 794.7814s
Epoch: 36 cost time: 12.613495826721191
Epoch: 36, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0019195
	speed: 0.1379s/iter; left time: 4125.2659s
	iters: 200, epoch: 37 | loss: 0.0737955
	speed: 0.0248s/iter; left time: 740.2586s
	iters: 300, epoch: 37 | loss: 0.0011926
	speed: 0.0247s/iter; left time: 735.4125s
	iters: 400, epoch: 37 | loss: 0.0003124
	speed: 0.0256s/iter; left time: 757.0583s
Epoch: 37 cost time: 12.423995733261108
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 176930
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8391414
	speed: 0.0444s/iter; left time: 2079.6710s
	iters: 200, epoch: 1 | loss: 0.5286469
	speed: 0.0255s/iter; left time: 1191.2499s
	iters: 300, epoch: 1 | loss: 0.3772904
	speed: 0.0248s/iter; left time: 1157.1400s
	iters: 400, epoch: 1 | loss: 0.3411601
	speed: 0.0257s/iter; left time: 1194.0366s
Epoch: 1 cost time: 13.860881567001343
Epoch: 1, Steps: 469 | Train Loss: 0.630 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
Validation loss decreased (inf --> -0.918522).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1257589
	speed: 0.1291s/iter; left time: 5979.8545s
	iters: 200, epoch: 2 | loss: 0.0667726
	speed: 0.0241s/iter; left time: 1116.2212s
	iters: 300, epoch: 2 | loss: 0.0732430
	speed: 0.0231s/iter; left time: 1065.3329s
	iters: 400, epoch: 2 | loss: 0.0311571
	speed: 0.0220s/iter; left time: 1012.6988s
Epoch: 2 cost time: 11.144518852233887
Epoch: 2, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.918522 --> -0.959976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0447623
	speed: 0.1202s/iter; left time: 5513.0461s
	iters: 200, epoch: 3 | loss: 0.0661017
	speed: 0.0256s/iter; left time: 1173.2171s
	iters: 300, epoch: 3 | loss: 0.0083200
	speed: 0.0252s/iter; left time: 1152.6826s
	iters: 400, epoch: 3 | loss: 0.0778999
	speed: 0.0257s/iter; left time: 1172.8372s
Epoch: 3 cost time: 12.08632493019104
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.959976 --> -0.968838).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0087793
	speed: 0.1267s/iter; left time: 5752.5304s
	iters: 200, epoch: 4 | loss: 0.0199950
	speed: 0.0240s/iter; left time: 1088.0880s
	iters: 300, epoch: 4 | loss: 0.1664511
	speed: 0.0244s/iter; left time: 1103.9330s
	iters: 400, epoch: 4 | loss: 0.0630086
	speed: 0.0247s/iter; left time: 1112.7897s
Epoch: 4 cost time: 11.911542892456055
Epoch: 4, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0404997
	speed: 0.1342s/iter; left time: 6028.6826s
	iters: 200, epoch: 5 | loss: 0.0226883
	speed: 0.0233s/iter; left time: 1045.2949s
	iters: 300, epoch: 5 | loss: 0.1410397
	speed: 0.0240s/iter; left time: 1073.0428s
	iters: 400, epoch: 5 | loss: 0.0103351
	speed: 0.0237s/iter; left time: 1059.4671s
Epoch: 5 cost time: 11.629345655441284
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.968838 --> -0.971125).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0326258
	speed: 0.1340s/iter; left time: 5957.7773s
	iters: 200, epoch: 6 | loss: 0.0063167
	speed: 0.0246s/iter; left time: 1092.3652s
	iters: 300, epoch: 6 | loss: 0.0173934
	speed: 0.0255s/iter; left time: 1126.7971s
	iters: 400, epoch: 6 | loss: 0.0055858
	speed: 0.0259s/iter; left time: 1141.8487s
Epoch: 6 cost time: 12.229097604751587
Epoch: 6, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0106864
	speed: 0.1303s/iter; left time: 5729.7003s
	iters: 200, epoch: 7 | loss: 0.0272600
	speed: 0.0243s/iter; left time: 1068.0207s
	iters: 300, epoch: 7 | loss: 0.0125900
	speed: 0.0255s/iter; left time: 1118.6383s
	iters: 400, epoch: 7 | loss: 0.0176519
	speed: 0.0258s/iter; left time: 1129.1634s
Epoch: 7 cost time: 12.25340723991394
Epoch: 7, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0159608
	speed: 0.1405s/iter; left time: 6116.3681s
	iters: 200, epoch: 8 | loss: 0.0050665
	speed: 0.0256s/iter; left time: 1110.9373s
	iters: 300, epoch: 8 | loss: 0.0054007
	speed: 0.0241s/iter; left time: 1043.3330s
	iters: 400, epoch: 8 | loss: 0.0282785
	speed: 0.0243s/iter; left time: 1049.7819s
Epoch: 8 cost time: 12.2508704662323
Epoch: 8, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.971125 --> -0.972840).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0737004
	speed: 0.1349s/iter; left time: 5808.1678s
	iters: 200, epoch: 9 | loss: 0.0021170
	speed: 0.0255s/iter; left time: 1094.2762s
	iters: 300, epoch: 9 | loss: 0.0011944
	speed: 0.0251s/iter; left time: 1076.3513s
	iters: 400, epoch: 9 | loss: 0.0027965
	speed: 0.0268s/iter; left time: 1144.4509s
Epoch: 9 cost time: 12.594926595687866
Epoch: 9, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0058045
	speed: 0.1351s/iter; left time: 5754.2079s
	iters: 200, epoch: 10 | loss: 0.2375642
	speed: 0.0252s/iter; left time: 1071.7477s
	iters: 300, epoch: 10 | loss: 0.0467911
	speed: 0.0251s/iter; left time: 1063.1296s
	iters: 400, epoch: 10 | loss: 0.0048203
	speed: 0.0252s/iter; left time: 1064.9677s
Epoch: 10 cost time: 12.160805702209473
Epoch: 10, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0024383
	speed: 0.1369s/iter; left time: 5763.7811s
	iters: 200, epoch: 11 | loss: 0.0004503
	speed: 0.0238s/iter; left time: 999.3331s
	iters: 300, epoch: 11 | loss: 0.0630699
	speed: 0.0231s/iter; left time: 967.8674s
	iters: 400, epoch: 11 | loss: 0.0438990
	speed: 0.0236s/iter; left time: 986.7644s
Epoch: 11 cost time: 11.687449216842651
Epoch: 11, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002670
	speed: 0.1343s/iter; left time: 5590.6726s
	iters: 200, epoch: 12 | loss: 0.3132756
	speed: 0.0253s/iter; left time: 1051.4309s
	iters: 300, epoch: 12 | loss: 0.0004963
	speed: 0.0245s/iter; left time: 1015.5871s
	iters: 400, epoch: 12 | loss: 0.0816132
	speed: 0.0234s/iter; left time: 968.5214s
Epoch: 12 cost time: 11.950466871261597
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0038387
	speed: 0.1293s/iter; left time: 5321.8741s
	iters: 200, epoch: 13 | loss: 0.0004619
	speed: 0.0246s/iter; left time: 1012.2580s
	iters: 300, epoch: 13 | loss: 0.0253500
	speed: 0.0246s/iter; left time: 1007.7368s
	iters: 400, epoch: 13 | loss: 0.0010870
	speed: 0.0244s/iter; left time: 998.6262s
Epoch: 13 cost time: 11.96595811843872
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0061523
	speed: 0.1301s/iter; left time: 5296.7778s
	iters: 200, epoch: 14 | loss: 0.0018505
	speed: 0.0255s/iter; left time: 1035.0332s
	iters: 300, epoch: 14 | loss: 0.0100984
	speed: 0.0251s/iter; left time: 1017.7560s
	iters: 400, epoch: 14 | loss: 0.0024396
	speed: 0.0222s/iter; left time: 898.9674s
Epoch: 14 cost time: 11.677318572998047
Epoch: 14, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0003897
	speed: 0.1224s/iter; left time: 4923.5918s
	iters: 200, epoch: 15 | loss: 0.0002983
	speed: 0.0248s/iter; left time: 996.1074s
	iters: 300, epoch: 15 | loss: 0.0074930
	speed: 0.0249s/iter; left time: 995.7920s
	iters: 400, epoch: 15 | loss: 0.0962318
	speed: 0.0247s/iter; left time: 985.4395s
Epoch: 15 cost time: 11.808288812637329
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001434
	speed: 0.1429s/iter; left time: 5682.1025s
	iters: 200, epoch: 16 | loss: 0.0010540
	speed: 0.0252s/iter; left time: 999.8207s
	iters: 300, epoch: 16 | loss: 0.0003096
	speed: 0.0262s/iter; left time: 1035.6455s
	iters: 400, epoch: 16 | loss: 0.0002807
	speed: 0.0264s/iter; left time: 1042.5233s
Epoch: 16 cost time: 12.776967763900757
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976271).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0900200
	speed: 0.1383s/iter; left time: 5435.5467s
	iters: 200, epoch: 17 | loss: 0.0000365
	speed: 0.0252s/iter; left time: 988.2172s
	iters: 300, epoch: 17 | loss: 0.0021185
	speed: 0.0277s/iter; left time: 1082.2115s
	iters: 400, epoch: 17 | loss: 0.0088011
	speed: 0.0267s/iter; left time: 1042.4952s
Epoch: 17 cost time: 12.75922441482544
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0095313
	speed: 0.1321s/iter; left time: 5130.1044s
	iters: 200, epoch: 18 | loss: 0.0021926
	speed: 0.0274s/iter; left time: 1059.4687s
	iters: 300, epoch: 18 | loss: 0.0001234
	speed: 0.0286s/iter; left time: 1105.1534s
	iters: 400, epoch: 18 | loss: 0.0003432
	speed: 0.0262s/iter; left time: 1007.5757s
Epoch: 18 cost time: 12.954580307006836
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0481090
	speed: 0.1350s/iter; left time: 5177.3064s
	iters: 200, epoch: 19 | loss: 0.0001059
	speed: 0.0241s/iter; left time: 920.3988s
	iters: 300, epoch: 19 | loss: 0.0001147
	speed: 0.0237s/iter; left time: 904.7256s
	iters: 400, epoch: 19 | loss: 0.0029816
	speed: 0.0237s/iter; left time: 902.7978s
Epoch: 19 cost time: 11.883893251419067
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0083752
	speed: 0.1379s/iter; left time: 5225.2133s
	iters: 200, epoch: 20 | loss: 0.0352163
	speed: 0.0246s/iter; left time: 930.2794s
	iters: 300, epoch: 20 | loss: 0.0005108
	speed: 0.0237s/iter; left time: 894.2888s
	iters: 400, epoch: 20 | loss: 0.0023306
	speed: 0.0227s/iter; left time: 851.9687s
Epoch: 20 cost time: 11.718952655792236
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0344698
	speed: 0.1334s/iter; left time: 4991.4576s
	iters: 200, epoch: 21 | loss: 0.0230099
	speed: 0.0243s/iter; left time: 905.9034s
	iters: 300, epoch: 21 | loss: 0.0039054
	speed: 0.0235s/iter; left time: 875.3312s
	iters: 400, epoch: 21 | loss: 0.0002638
	speed: 0.0254s/iter; left time: 943.7039s
Epoch: 21 cost time: 11.635642528533936
Epoch: 21, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0018127
	speed: 0.1308s/iter; left time: 4833.2429s
	iters: 200, epoch: 22 | loss: 0.0064774
	speed: 0.0259s/iter; left time: 954.8986s
	iters: 300, epoch: 22 | loss: 0.0018300
	speed: 0.0255s/iter; left time: 935.4171s
	iters: 400, epoch: 22 | loss: 0.0001065
	speed: 0.0241s/iter; left time: 884.2663s
Epoch: 22 cost time: 12.313629150390625
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0004534
	speed: 0.1366s/iter; left time: 4983.3300s
	iters: 200, epoch: 23 | loss: 0.0065213
	speed: 0.0264s/iter; left time: 959.3212s
	iters: 300, epoch: 23 | loss: 0.0000807
	speed: 0.0254s/iter; left time: 920.9724s
	iters: 400, epoch: 23 | loss: 0.0004071
	speed: 0.0251s/iter; left time: 907.9604s
Epoch: 23 cost time: 12.606774806976318
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976557).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000077
	speed: 0.1377s/iter; left time: 4960.2900s
	iters: 200, epoch: 24 | loss: 0.0000216
	speed: 0.0255s/iter; left time: 914.4761s
	iters: 300, epoch: 24 | loss: 0.8538956
	speed: 0.0256s/iter; left time: 916.7222s
	iters: 400, epoch: 24 | loss: 0.1090042
	speed: 0.0264s/iter; left time: 944.3454s
Epoch: 24 cost time: 12.745057106018066
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0004754
	speed: 0.1470s/iter; left time: 5225.1804s
	iters: 200, epoch: 25 | loss: 0.3580115
	speed: 0.0258s/iter; left time: 913.6187s
	iters: 300, epoch: 25 | loss: 0.0354835
	speed: 0.0284s/iter; left time: 1003.2493s
	iters: 400, epoch: 25 | loss: 0.0005204
	speed: 0.0282s/iter; left time: 992.8660s
Epoch: 25 cost time: 13.238727569580078
Epoch: 25, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.979130).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0002806
	speed: 0.1482s/iter; left time: 5199.4500s
	iters: 200, epoch: 26 | loss: 0.0295109
	speed: 0.0245s/iter; left time: 855.3413s
	iters: 300, epoch: 26 | loss: 0.0004019
	speed: 0.0242s/iter; left time: 844.5452s
	iters: 400, epoch: 26 | loss: 0.0122526
	speed: 0.0238s/iter; left time: 827.7081s
Epoch: 26 cost time: 12.117074489593506
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0002185
	speed: 0.1344s/iter; left time: 4652.7964s
	iters: 200, epoch: 27 | loss: 0.0042945
	speed: 0.0277s/iter; left time: 957.2269s
	iters: 300, epoch: 27 | loss: 0.1493664
	speed: 0.0265s/iter; left time: 912.0393s
	iters: 400, epoch: 27 | loss: 0.0106712
	speed: 0.0266s/iter; left time: 911.2591s
Epoch: 27 cost time: 13.075385570526123
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0083038
	speed: 0.1405s/iter; left time: 4796.2011s
	iters: 200, epoch: 28 | loss: 0.0337627
	speed: 0.0280s/iter; left time: 953.9134s
	iters: 300, epoch: 28 | loss: 0.0001304
	speed: 0.0257s/iter; left time: 873.6927s
	iters: 400, epoch: 28 | loss: 0.0014460
	speed: 0.0259s/iter; left time: 876.9490s
Epoch: 28 cost time: 12.992842674255371
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0004389
	speed: 0.1429s/iter; left time: 4809.6839s
	iters: 200, epoch: 29 | loss: 0.0051023
	speed: 0.0250s/iter; left time: 840.4536s
	iters: 300, epoch: 29 | loss: 0.0003346
	speed: 0.0245s/iter; left time: 820.9738s
	iters: 400, epoch: 29 | loss: 0.0022748
	speed: 0.0257s/iter; left time: 857.6565s
Epoch: 29 cost time: 12.364102363586426
Epoch: 29, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0000318
	speed: 0.1435s/iter; left time: 4765.2455s
	iters: 200, epoch: 30 | loss: 0.0000328
	speed: 0.0252s/iter; left time: 833.5810s
	iters: 300, epoch: 30 | loss: 0.0179993
	speed: 0.0248s/iter; left time: 817.7682s
	iters: 400, epoch: 30 | loss: 0.0004771
	speed: 0.0245s/iter; left time: 806.8827s
Epoch: 30 cost time: 12.342249870300293
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0003540
	speed: 0.1383s/iter; left time: 4526.4046s
	iters: 200, epoch: 31 | loss: 0.0013418
	speed: 0.0250s/iter; left time: 815.9945s
	iters: 300, epoch: 31 | loss: 0.0000769
	speed: 0.0264s/iter; left time: 857.2893s
	iters: 400, epoch: 31 | loss: 0.0009564
	speed: 0.0254s/iter; left time: 824.7608s
Epoch: 31 cost time: 12.684518814086914
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0000742
	speed: 0.1367s/iter; left time: 4408.9280s
	iters: 200, epoch: 32 | loss: 0.0005093
	speed: 0.0251s/iter; left time: 807.7907s
	iters: 300, epoch: 32 | loss: 0.0342020
	speed: 0.0257s/iter; left time: 824.7738s
	iters: 400, epoch: 32 | loss: 0.2475305
	speed: 0.0258s/iter; left time: 824.8011s
Epoch: 32 cost time: 12.475010633468628
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0005192
	speed: 0.1365s/iter; left time: 4340.8877s
	iters: 200, epoch: 33 | loss: 0.0020276
	speed: 0.0240s/iter; left time: 760.8753s
	iters: 300, epoch: 33 | loss: 0.1351540
	speed: 0.0255s/iter; left time: 804.3979s
	iters: 400, epoch: 33 | loss: 0.0002366
	speed: 0.0241s/iter; left time: 759.3623s
Epoch: 33 cost time: 12.124791860580444
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0056811
	speed: 0.1458s/iter; left time: 4567.4910s
	iters: 200, epoch: 34 | loss: 0.0002096
	speed: 0.0275s/iter; left time: 857.6176s
	iters: 300, epoch: 34 | loss: 0.0002353
	speed: 0.0265s/iter; left time: 824.6837s
	iters: 400, epoch: 34 | loss: 0.0292734
	speed: 0.0254s/iter; left time: 788.9433s
Epoch: 34 cost time: 13.090119123458862
Epoch: 34, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0002839
	speed: 0.1498s/iter; left time: 4621.0551s
	iters: 200, epoch: 35 | loss: 0.0278795
	speed: 0.0266s/iter; left time: 819.3937s
	iters: 300, epoch: 35 | loss: 0.0117173
	speed: 0.0267s/iter; left time: 817.3177s
	iters: 400, epoch: 35 | loss: 0.0081661
	speed: 0.0246s/iter; left time: 750.4775s
Epoch: 35 cost time: 12.962266445159912
Epoch: 35, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 176930
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9271778
	speed: 0.0434s/iter; left time: 2033.3152s
	iters: 200, epoch: 1 | loss: 0.5752538
	speed: 0.0246s/iter; left time: 1146.6118s
	iters: 300, epoch: 1 | loss: 0.3789266
	speed: 0.0257s/iter; left time: 1195.4734s
	iters: 400, epoch: 1 | loss: 0.2844765
	speed: 0.0253s/iter; left time: 1177.4549s
Epoch: 1 cost time: 13.598638534545898
Epoch: 1, Steps: 469 | Train Loss: 0.647 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
Validation loss decreased (inf --> -0.939106).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1513582
	speed: 0.1291s/iter; left time: 5980.2156s
	iters: 200, epoch: 2 | loss: 0.0383269
	speed: 0.0237s/iter; left time: 1095.9717s
	iters: 300, epoch: 2 | loss: 0.0342727
	speed: 0.0242s/iter; left time: 1117.1377s
	iters: 400, epoch: 2 | loss: 0.0557788
	speed: 0.0227s/iter; left time: 1045.5644s
Epoch: 2 cost time: 11.457571744918823
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.939106 --> -0.963406).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0916790
	speed: 0.1361s/iter; left time: 6242.4108s
	iters: 200, epoch: 3 | loss: 0.0735946
	speed: 0.0250s/iter; left time: 1143.1301s
	iters: 300, epoch: 3 | loss: 0.0072247
	speed: 0.0238s/iter; left time: 1085.3708s
	iters: 400, epoch: 3 | loss: 0.0143571
	speed: 0.0233s/iter; left time: 1061.4093s
Epoch: 3 cost time: 11.639686346054077
Epoch: 3, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.963406 --> -0.973984).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0020932
	speed: 0.1349s/iter; left time: 6122.6756s
	iters: 200, epoch: 4 | loss: 0.0187191
	speed: 0.0232s/iter; left time: 1050.5996s
	iters: 300, epoch: 4 | loss: 0.0306726
	speed: 0.0233s/iter; left time: 1054.6512s
	iters: 400, epoch: 4 | loss: 0.0605277
	speed: 0.0235s/iter; left time: 1059.6954s
Epoch: 4 cost time: 11.471365213394165
Epoch: 4, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0028624
	speed: 0.1253s/iter; left time: 5628.0151s
	iters: 200, epoch: 5 | loss: 0.0140669
	speed: 0.0230s/iter; left time: 1031.5565s
	iters: 300, epoch: 5 | loss: 0.1502302
	speed: 0.0228s/iter; left time: 1018.2373s
	iters: 400, epoch: 5 | loss: 0.0063063
	speed: 0.0231s/iter; left time: 1029.4162s
Epoch: 5 cost time: 11.246736764907837
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0181927
	speed: 0.1269s/iter; left time: 5643.5979s
	iters: 200, epoch: 6 | loss: 0.0075995
	speed: 0.0244s/iter; left time: 1080.5829s
	iters: 300, epoch: 6 | loss: 0.0131632
	speed: 0.0243s/iter; left time: 1076.0738s
	iters: 400, epoch: 6 | loss: 0.0149439
	speed: 0.0243s/iter; left time: 1072.0971s
Epoch: 6 cost time: 11.707748651504517
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0373980
	speed: 0.1289s/iter; left time: 5669.8024s
	iters: 200, epoch: 7 | loss: 0.0463696
	speed: 0.0236s/iter; left time: 1037.7773s
	iters: 300, epoch: 7 | loss: 0.0331217
	speed: 0.0246s/iter; left time: 1075.2925s
	iters: 400, epoch: 7 | loss: 0.0356823
	speed: 0.0230s/iter; left time: 1004.5345s
Epoch: 7 cost time: 11.602824687957764
Epoch: 7, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.973984 --> -0.978558).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0009375
	speed: 0.1405s/iter; left time: 6113.4515s
	iters: 200, epoch: 8 | loss: 0.0067708
	speed: 0.0258s/iter; left time: 1119.5131s
	iters: 300, epoch: 8 | loss: 0.0017796
	speed: 0.0259s/iter; left time: 1123.7618s
	iters: 400, epoch: 8 | loss: 0.0749703
	speed: 0.0232s/iter; left time: 1003.2681s
Epoch: 8 cost time: 12.24200177192688
Epoch: 8, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0577655
	speed: 0.1391s/iter; left time: 5987.4382s
	iters: 200, epoch: 9 | loss: 0.0010581
	speed: 0.0246s/iter; left time: 1054.6046s
	iters: 300, epoch: 9 | loss: 0.0007008
	speed: 0.0243s/iter; left time: 1040.2770s
	iters: 400, epoch: 9 | loss: 0.0053231
	speed: 0.0229s/iter; left time: 976.9856s
Epoch: 9 cost time: 11.729053020477295
Epoch: 9, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0002781
	speed: 0.1305s/iter; left time: 5557.4150s
	iters: 200, epoch: 10 | loss: 0.0008100
	speed: 0.0247s/iter; left time: 1047.7211s
	iters: 300, epoch: 10 | loss: 0.0006924
	speed: 0.0246s/iter; left time: 1041.7156s
	iters: 400, epoch: 10 | loss: 0.0117484
	speed: 0.0257s/iter; left time: 1087.0533s
Epoch: 10 cost time: 12.055219650268555
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.107 Vali Acc: 0.982 Test Loss: 0.107 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981989).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0011161
	speed: 0.1291s/iter; left time: 5438.3057s
	iters: 200, epoch: 11 | loss: 0.2368771
	speed: 0.0245s/iter; left time: 1030.4918s
	iters: 300, epoch: 11 | loss: 0.0001270
	speed: 0.0254s/iter; left time: 1062.6739s
	iters: 400, epoch: 11 | loss: 0.0077586
	speed: 0.0237s/iter; left time: 989.3192s
Epoch: 11 cost time: 11.766270160675049
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0035539
	speed: 0.1319s/iter; left time: 5491.4592s
	iters: 200, epoch: 12 | loss: 0.5408034
	speed: 0.0235s/iter; left time: 974.6611s
	iters: 300, epoch: 12 | loss: 0.0003472
	speed: 0.0242s/iter; left time: 1000.8793s
	iters: 400, epoch: 12 | loss: 0.0015277
	speed: 0.0239s/iter; left time: 988.3979s
Epoch: 12 cost time: 11.674617052078247
Epoch: 12, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0504995
	speed: 0.1364s/iter; left time: 5616.4243s
	iters: 200, epoch: 13 | loss: 0.0003520
	speed: 0.0234s/iter; left time: 959.1930s
	iters: 300, epoch: 13 | loss: 0.0185561
	speed: 0.0241s/iter; left time: 987.8794s
	iters: 400, epoch: 13 | loss: 0.0010361
	speed: 0.0231s/iter; left time: 944.0076s
Epoch: 13 cost time: 11.527332305908203
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000382
	speed: 0.1289s/iter; left time: 5247.7531s
	iters: 200, epoch: 14 | loss: 0.0000099
	speed: 0.0232s/iter; left time: 940.2595s
	iters: 300, epoch: 14 | loss: 0.0015749
	speed: 0.0237s/iter; left time: 958.4387s
	iters: 400, epoch: 14 | loss: 0.0022210
	speed: 0.0229s/iter; left time: 926.4626s
Epoch: 14 cost time: 11.228216409683228
Epoch: 14, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.972 Test Loss: 0.147 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0001563
	speed: 0.1261s/iter; left time: 5073.1426s
	iters: 200, epoch: 15 | loss: 0.0095087
	speed: 0.0231s/iter; left time: 928.2649s
	iters: 300, epoch: 15 | loss: 0.0107941
	speed: 0.0233s/iter; left time: 933.9014s
	iters: 400, epoch: 15 | loss: 0.0883009
	speed: 0.0240s/iter; left time: 957.6037s
Epoch: 15 cost time: 11.426320552825928
Epoch: 15, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0004794
	speed: 0.1290s/iter; left time: 5130.8691s
	iters: 200, epoch: 16 | loss: 0.0484439
	speed: 0.0248s/iter; left time: 985.4912s
	iters: 300, epoch: 16 | loss: 0.0000150
	speed: 0.0240s/iter; left time: 950.6221s
	iters: 400, epoch: 16 | loss: 0.0005110
	speed: 0.0235s/iter; left time: 928.2864s
Epoch: 16 cost time: 11.594400644302368
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0039161
	speed: 0.1311s/iter; left time: 5152.9113s
	iters: 200, epoch: 17 | loss: 0.0000360
	speed: 0.0260s/iter; left time: 1020.0277s
	iters: 300, epoch: 17 | loss: 0.0003428
	speed: 0.0230s/iter; left time: 900.0037s
	iters: 400, epoch: 17 | loss: 0.0669374
	speed: 0.0243s/iter; left time: 948.0258s
Epoch: 17 cost time: 11.982784032821655
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0093902
	speed: 0.1278s/iter; left time: 4962.6183s
	iters: 200, epoch: 18 | loss: 0.0096309
	speed: 0.0238s/iter; left time: 921.2452s
	iters: 300, epoch: 18 | loss: 0.0146129
	speed: 0.0219s/iter; left time: 844.4120s
	iters: 400, epoch: 18 | loss: 0.0005673
	speed: 0.0235s/iter; left time: 905.2626s
Epoch: 18 cost time: 11.359151601791382
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0001731
	speed: 0.1376s/iter; left time: 5278.2174s
	iters: 200, epoch: 19 | loss: 0.0000365
	speed: 0.0232s/iter; left time: 888.7326s
	iters: 300, epoch: 19 | loss: 0.0007603
	speed: 0.0209s/iter; left time: 798.0489s
	iters: 400, epoch: 19 | loss: 0.0038106
	speed: 0.0289s/iter; left time: 1098.9006s
Epoch: 19 cost time: 12.455564737319946
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0170715
	speed: 0.1399s/iter; left time: 5301.5759s
	iters: 200, epoch: 20 | loss: 0.1408257
	speed: 0.0201s/iter; left time: 757.8256s
	iters: 300, epoch: 20 | loss: 0.0005321
	speed: 0.0191s/iter; left time: 718.5129s
	iters: 400, epoch: 20 | loss: 0.0014424
	speed: 0.0200s/iter; left time: 749.9920s
Epoch: 20 cost time: 9.716959953308105
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 176930
model size : 3.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.8925368
	speed: 0.0445s/iter; left time: 2081.5681s
	iters: 200, epoch: 1 | loss: 0.2728950
	speed: 0.0258s/iter; left time: 1205.6578s
	iters: 300, epoch: 1 | loss: 0.2598854
	speed: 0.0253s/iter; left time: 1178.6711s
	iters: 400, epoch: 1 | loss: 0.2660094
	speed: 0.0246s/iter; left time: 1146.0465s
Epoch: 1 cost time: 13.777766942977905
Epoch: 1, Steps: 469 | Train Loss: 0.620 Vali Loss: 0.304 Vali Acc: 0.909 Test Loss: 0.304 Test Acc: 0.909
Validation loss decreased (inf --> -0.909374).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1635976
	speed: 0.1278s/iter; left time: 5919.4967s
	iters: 200, epoch: 2 | loss: 0.0892887
	speed: 0.0223s/iter; left time: 1032.4557s
	iters: 300, epoch: 2 | loss: 0.1290198
	speed: 0.0236s/iter; left time: 1087.1193s
	iters: 400, epoch: 2 | loss: 0.1393302
	speed: 0.0243s/iter; left time: 1120.2326s
Epoch: 2 cost time: 11.51063871383667
Epoch: 2, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.909374 --> -0.949684).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0701720
	speed: 0.1331s/iter; left time: 6106.6255s
	iters: 200, epoch: 3 | loss: 0.0381063
	speed: 0.0238s/iter; left time: 1087.4185s
	iters: 300, epoch: 3 | loss: 0.1187973
	speed: 0.0220s/iter; left time: 1005.9982s
	iters: 400, epoch: 3 | loss: 0.1005918
	speed: 0.0237s/iter; left time: 1080.6513s
Epoch: 3 cost time: 11.429342269897461
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.949684 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0222702
	speed: 0.1290s/iter; left time: 5855.9360s
	iters: 200, epoch: 4 | loss: 0.0199189
	speed: 0.0243s/iter; left time: 1099.8316s
	iters: 300, epoch: 4 | loss: 0.0048573
	speed: 0.0247s/iter; left time: 1115.9683s
	iters: 400, epoch: 4 | loss: 0.0044201
	speed: 0.0251s/iter; left time: 1130.4325s
Epoch: 4 cost time: 11.68108606338501
Epoch: 4, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.956259 --> -0.971125).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0098045
	speed: 0.1323s/iter; left time: 5945.4600s
	iters: 200, epoch: 5 | loss: 0.0067996
	speed: 0.0269s/iter; left time: 1205.7383s
	iters: 300, epoch: 5 | loss: 0.0022914
	speed: 0.0257s/iter; left time: 1150.5450s
	iters: 400, epoch: 5 | loss: 0.2213614
	speed: 0.0259s/iter; left time: 1156.8155s
Epoch: 5 cost time: 12.487382888793945
Epoch: 5, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.971125 --> -0.971125).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0350576
	speed: 0.1375s/iter; left time: 6110.6524s
	iters: 200, epoch: 6 | loss: 0.0682020
	speed: 0.0248s/iter; left time: 1098.3589s
	iters: 300, epoch: 6 | loss: 0.0115359
	speed: 0.0241s/iter; left time: 1066.5688s
	iters: 400, epoch: 6 | loss: 0.0098183
	speed: 0.0248s/iter; left time: 1094.8097s
Epoch: 6 cost time: 12.224795579910278
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0226627
	speed: 0.1353s/iter; left time: 5953.3381s
	iters: 200, epoch: 7 | loss: 0.0012163
	speed: 0.0269s/iter; left time: 1181.0907s
	iters: 300, epoch: 7 | loss: 0.0034400
	speed: 0.0243s/iter; left time: 1063.1171s
	iters: 400, epoch: 7 | loss: 0.0061987
	speed: 0.0235s/iter; left time: 1024.4947s
Epoch: 7 cost time: 12.171172380447388
Epoch: 7, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0184588
	speed: 0.1357s/iter; left time: 5904.2235s
	iters: 200, epoch: 8 | loss: 0.0256017
	speed: 0.0242s/iter; left time: 1050.9914s
	iters: 300, epoch: 8 | loss: 0.0137518
	speed: 0.0223s/iter; left time: 963.9930s
	iters: 400, epoch: 8 | loss: 0.0032461
	speed: 0.0237s/iter; left time: 1023.1460s
Epoch: 8 cost time: 11.664500713348389
Epoch: 8, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.971125 --> -0.977129).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0013535
	speed: 0.1337s/iter; left time: 5757.5932s
	iters: 200, epoch: 9 | loss: 0.0158334
	speed: 0.0237s/iter; left time: 1019.8792s
	iters: 300, epoch: 9 | loss: 0.1292443
	speed: 0.0235s/iter; left time: 1006.1938s
	iters: 400, epoch: 9 | loss: 0.0177166
	speed: 0.0240s/iter; left time: 1025.1643s
Epoch: 9 cost time: 11.50170111656189
Epoch: 9, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0477608
	speed: 0.1319s/iter; left time: 5618.3713s
	iters: 200, epoch: 10 | loss: 0.0910158
	speed: 0.0237s/iter; left time: 1007.1058s
	iters: 300, epoch: 10 | loss: 0.1375992
	speed: 0.0234s/iter; left time: 992.8279s
	iters: 400, epoch: 10 | loss: 0.0094442
	speed: 0.0245s/iter; left time: 1034.3161s
Epoch: 10 cost time: 11.725863218307495
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0039911
	speed: 0.1306s/iter; left time: 5499.5476s
	iters: 200, epoch: 11 | loss: 0.0032471
	speed: 0.0247s/iter; left time: 1036.7059s
	iters: 300, epoch: 11 | loss: 0.0120369
	speed: 0.0255s/iter; left time: 1070.2446s
	iters: 400, epoch: 11 | loss: 0.1732661
	speed: 0.0250s/iter; left time: 1045.2072s
Epoch: 11 cost time: 12.067660093307495
Epoch: 11, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0061063
	speed: 0.1297s/iter; left time: 5401.3624s
	iters: 200, epoch: 12 | loss: 0.0006135
	speed: 0.0237s/iter; left time: 983.5236s
	iters: 300, epoch: 12 | loss: 0.0019714
	speed: 0.0218s/iter; left time: 902.0319s
	iters: 400, epoch: 12 | loss: 0.0202019
	speed: 0.0234s/iter; left time: 965.7401s
Epoch: 12 cost time: 11.546833515167236
Epoch: 12, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.977129 --> -0.981989).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0096832
	speed: 0.1344s/iter; left time: 5534.1937s
	iters: 200, epoch: 13 | loss: 0.0020989
	speed: 0.0230s/iter; left time: 944.7354s
	iters: 300, epoch: 13 | loss: 0.0852894
	speed: 0.0228s/iter; left time: 934.6434s
	iters: 400, epoch: 13 | loss: 0.0045735
	speed: 0.0232s/iter; left time: 946.8818s
Epoch: 13 cost time: 11.355960607528687
Epoch: 13, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0031964
	speed: 0.1328s/iter; left time: 5404.3692s
	iters: 200, epoch: 14 | loss: 0.0016472
	speed: 0.0264s/iter; left time: 1073.9271s
	iters: 300, epoch: 14 | loss: 0.0091422
	speed: 0.0262s/iter; left time: 1060.2706s
	iters: 400, epoch: 14 | loss: 0.0018771
	speed: 0.0245s/iter; left time: 989.4788s
Epoch: 14 cost time: 12.345608949661255
Epoch: 14, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.1151738
	speed: 0.1349s/iter; left time: 5427.5285s
	iters: 200, epoch: 15 | loss: 0.0009117
	speed: 0.0281s/iter; left time: 1126.1684s
	iters: 300, epoch: 15 | loss: 0.0012884
	speed: 0.0251s/iter; left time: 1005.4451s
	iters: 400, epoch: 15 | loss: 0.0053377
	speed: 0.0250s/iter; left time: 997.8925s
Epoch: 15 cost time: 12.67487382888794
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0006709
	speed: 0.1301s/iter; left time: 5173.4587s
	iters: 200, epoch: 16 | loss: 0.0646061
	speed: 0.0241s/iter; left time: 957.5626s
	iters: 300, epoch: 16 | loss: 0.0214470
	speed: 0.0241s/iter; left time: 953.9699s
	iters: 400, epoch: 16 | loss: 0.0011299
	speed: 0.0251s/iter; left time: 989.8992s
Epoch: 16 cost time: 12.000651121139526
Epoch: 16, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005275
	speed: 0.1335s/iter; left time: 5246.1321s
	iters: 200, epoch: 17 | loss: 0.0557925
	speed: 0.0249s/iter; left time: 976.0600s
	iters: 300, epoch: 17 | loss: 0.0404341
	speed: 0.0242s/iter; left time: 945.7670s
	iters: 400, epoch: 17 | loss: 0.0117312
	speed: 0.0226s/iter; left time: 881.5937s
Epoch: 17 cost time: 11.662732124328613
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0002307
	speed: 0.1242s/iter; left time: 4821.6892s
	iters: 200, epoch: 18 | loss: 0.0009394
	speed: 0.0247s/iter; left time: 956.3714s
	iters: 300, epoch: 18 | loss: 0.0045972
	speed: 0.0249s/iter; left time: 962.3572s
	iters: 400, epoch: 18 | loss: 0.0224526
	speed: 0.0248s/iter; left time: 956.0260s
Epoch: 18 cost time: 11.99118685722351
Epoch: 18, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0160642
	speed: 0.1339s/iter; left time: 5136.6928s
	iters: 200, epoch: 19 | loss: 0.0020111
	speed: 0.0236s/iter; left time: 902.9290s
	iters: 300, epoch: 19 | loss: 0.0002336
	speed: 0.0233s/iter; left time: 890.0810s
	iters: 400, epoch: 19 | loss: 0.1425802
	speed: 0.0244s/iter; left time: 930.1592s
Epoch: 19 cost time: 11.707344055175781
Epoch: 19, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0847185
	speed: 0.1327s/iter; left time: 5026.3069s
	iters: 200, epoch: 20 | loss: 0.0029716
	speed: 0.0254s/iter; left time: 958.9723s
	iters: 300, epoch: 20 | loss: 0.0021819
	speed: 0.0234s/iter; left time: 882.8814s
	iters: 400, epoch: 20 | loss: 0.1666797
	speed: 0.0249s/iter; left time: 934.3137s
Epoch: 20 cost time: 11.900224208831787
Epoch: 20, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0005581
	speed: 0.1291s/iter; left time: 4829.7257s
	iters: 200, epoch: 21 | loss: 0.0432990
	speed: 0.0257s/iter; left time: 958.7696s
	iters: 300, epoch: 21 | loss: 0.0676090
	speed: 0.0250s/iter; left time: 931.7125s
	iters: 400, epoch: 21 | loss: 0.0127254
	speed: 0.0243s/iter; left time: 901.6053s
Epoch: 21 cost time: 12.099571466445923
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000280
	speed: 0.1278s/iter; left time: 4721.1820s
	iters: 200, epoch: 22 | loss: 0.0001836
	speed: 0.0229s/iter; left time: 844.7189s
	iters: 300, epoch: 22 | loss: 0.0003093
	speed: 0.0250s/iter; left time: 920.6134s
	iters: 400, epoch: 22 | loss: 0.0361560
	speed: 0.0245s/iter; left time: 897.4169s
Epoch: 22 cost time: 11.693296432495117
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 111394
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9423190
	speed: 0.0430s/iter; left time: 2014.4603s
	iters: 200, epoch: 1 | loss: 0.2858758
	speed: 0.0234s/iter; left time: 1091.6229s
	iters: 300, epoch: 1 | loss: 0.3061175
	speed: 0.0245s/iter; left time: 1141.8177s
	iters: 400, epoch: 1 | loss: 0.2424854
	speed: 0.0237s/iter; left time: 1102.0449s
Epoch: 1 cost time: 13.050420761108398
Epoch: 1, Steps: 469 | Train Loss: 0.635 Vali Loss: 0.293 Vali Acc: 0.910 Test Loss: 0.293 Test Acc: 0.910
Validation loss decreased (inf --> -0.909946).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1744413
	speed: 0.1280s/iter; left time: 5928.9468s
	iters: 200, epoch: 2 | loss: 0.0833029
	speed: 0.0236s/iter; left time: 1092.7397s
	iters: 300, epoch: 2 | loss: 0.1661496
	speed: 0.0242s/iter; left time: 1114.2489s
	iters: 400, epoch: 2 | loss: 0.0886825
	speed: 0.0243s/iter; left time: 1118.7952s
Epoch: 2 cost time: 11.723798751831055
Epoch: 2, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.909946 --> -0.955687).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0998823
	speed: 0.1286s/iter; left time: 5897.8617s
	iters: 200, epoch: 3 | loss: 0.0557599
	speed: 0.0246s/iter; left time: 1127.5679s
	iters: 300, epoch: 3 | loss: 0.0916211
	speed: 0.0261s/iter; left time: 1193.3608s
	iters: 400, epoch: 3 | loss: 0.0735706
	speed: 0.0262s/iter; left time: 1195.4179s
Epoch: 3 cost time: 12.247846841812134
Epoch: 3, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.955687 --> -0.957117).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0379442
	speed: 0.1249s/iter; left time: 5668.1074s
	iters: 200, epoch: 4 | loss: 0.0184327
	speed: 0.0252s/iter; left time: 1140.5343s
	iters: 300, epoch: 4 | loss: 0.0083792
	speed: 0.0217s/iter; left time: 980.9920s
	iters: 400, epoch: 4 | loss: 0.0047292
	speed: 0.0236s/iter; left time: 1062.0257s
Epoch: 4 cost time: 11.429157733917236
Epoch: 4, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
Validation loss decreased (-0.957117 --> -0.968552).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0067097
	speed: 0.1287s/iter; left time: 5781.2451s
	iters: 200, epoch: 5 | loss: 0.0071959
	speed: 0.0216s/iter; left time: 968.1111s
	iters: 300, epoch: 5 | loss: 0.0012343
	speed: 0.0215s/iter; left time: 963.4938s
	iters: 400, epoch: 5 | loss: 0.1814902
	speed: 0.0211s/iter; left time: 940.0154s
Epoch: 5 cost time: 10.473421335220337
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0027599
	speed: 0.1242s/iter; left time: 5521.7002s
	iters: 200, epoch: 6 | loss: 0.0215613
	speed: 0.0231s/iter; left time: 1022.7412s
	iters: 300, epoch: 6 | loss: 0.0189727
	speed: 0.0225s/iter; left time: 997.6434s
	iters: 400, epoch: 6 | loss: 0.0056794
	speed: 0.0235s/iter; left time: 1038.7762s
Epoch: 6 cost time: 11.15012264251709
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0673492
	speed: 0.1237s/iter; left time: 5439.6913s
	iters: 200, epoch: 7 | loss: 0.0019857
	speed: 0.0242s/iter; left time: 1061.2006s
	iters: 300, epoch: 7 | loss: 0.0031282
	speed: 0.0243s/iter; left time: 1062.2345s
	iters: 400, epoch: 7 | loss: 0.0032275
	speed: 0.0255s/iter; left time: 1115.9971s
Epoch: 7 cost time: 11.858795642852783
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0166367
	speed: 0.1275s/iter; left time: 5549.2824s
	iters: 200, epoch: 8 | loss: 0.0058340
	speed: 0.0237s/iter; left time: 1027.8728s
	iters: 300, epoch: 8 | loss: 0.0043766
	speed: 0.0242s/iter; left time: 1048.9264s
	iters: 400, epoch: 8 | loss: 0.0045140
	speed: 0.0229s/iter; left time: 987.6080s
Epoch: 8 cost time: 11.491546154022217
Epoch: 8, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0066389
	speed: 0.1270s/iter; left time: 5468.8069s
	iters: 200, epoch: 9 | loss: 0.0055957
	speed: 0.0249s/iter; left time: 1068.1315s
	iters: 300, epoch: 9 | loss: 0.0116710
	speed: 0.0239s/iter; left time: 1022.0419s
	iters: 400, epoch: 9 | loss: 0.0074048
	speed: 0.0216s/iter; left time: 922.3461s
Epoch: 9 cost time: 11.53690505027771
Epoch: 9, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.968552 --> -0.972269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0266063
	speed: 0.1333s/iter; left time: 5676.5643s
	iters: 200, epoch: 10 | loss: 0.1903769
	speed: 0.0235s/iter; left time: 996.9586s
	iters: 300, epoch: 10 | loss: 0.2792000
	speed: 0.0247s/iter; left time: 1045.0816s
	iters: 400, epoch: 10 | loss: 0.0014101
	speed: 0.0238s/iter; left time: 1005.0019s
Epoch: 10 cost time: 11.499362230300903
Epoch: 10, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0008334
	speed: 0.1354s/iter; left time: 5703.4132s
	iters: 200, epoch: 11 | loss: 0.0136134
	speed: 0.0240s/iter; left time: 1006.6829s
	iters: 300, epoch: 11 | loss: 0.0335594
	speed: 0.0235s/iter; left time: 984.1669s
	iters: 400, epoch: 11 | loss: 0.0024812
	speed: 0.0230s/iter; left time: 960.4191s
Epoch: 11 cost time: 11.518245220184326
Epoch: 11, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.972269 --> -0.976271).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0018184
	speed: 0.1318s/iter; left time: 5488.5035s
	iters: 200, epoch: 12 | loss: 0.0042693
	speed: 0.0242s/iter; left time: 1005.2523s
	iters: 300, epoch: 12 | loss: 0.0044993
	speed: 0.0248s/iter; left time: 1025.9955s
	iters: 400, epoch: 12 | loss: 0.0168773
	speed: 0.0250s/iter; left time: 1033.5947s
Epoch: 12 cost time: 11.890421152114868
Epoch: 12, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0019696
	speed: 0.1169s/iter; left time: 4814.8391s
	iters: 200, epoch: 13 | loss: 0.0016580
	speed: 0.0227s/iter; left time: 930.5986s
	iters: 300, epoch: 13 | loss: 0.1300467
	speed: 0.0252s/iter; left time: 1033.8382s
	iters: 400, epoch: 13 | loss: 0.0002687
	speed: 0.0249s/iter; left time: 1017.5574s
Epoch: 13 cost time: 11.563279867172241
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976843).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0151299
	speed: 0.1285s/iter; left time: 5229.7473s
	iters: 200, epoch: 14 | loss: 0.0006041
	speed: 0.0237s/iter; left time: 961.5566s
	iters: 300, epoch: 14 | loss: 0.0069148
	speed: 0.0218s/iter; left time: 883.4616s
	iters: 400, epoch: 14 | loss: 0.0027724
	speed: 0.0217s/iter; left time: 877.5623s
Epoch: 14 cost time: 11.219143629074097
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977700).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0027309
	speed: 0.1288s/iter; left time: 5181.2584s
	iters: 200, epoch: 15 | loss: 0.0071588
	speed: 0.0240s/iter; left time: 965.2027s
	iters: 300, epoch: 15 | loss: 0.0053511
	speed: 0.0227s/iter; left time: 907.5733s
	iters: 400, epoch: 15 | loss: 0.0004342
	speed: 0.0224s/iter; left time: 893.0837s
Epoch: 15 cost time: 11.17140007019043
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0060102
	speed: 0.1249s/iter; left time: 4965.2125s
	iters: 200, epoch: 16 | loss: 0.1689449
	speed: 0.0219s/iter; left time: 868.1552s
	iters: 300, epoch: 16 | loss: 0.0358552
	speed: 0.0216s/iter; left time: 855.1276s
	iters: 400, epoch: 16 | loss: 0.0058473
	speed: 0.0221s/iter; left time: 870.4314s
Epoch: 16 cost time: 10.846102952957153
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0026504
	speed: 0.1160s/iter; left time: 4559.8978s
	iters: 200, epoch: 17 | loss: 0.0944230
	speed: 0.0210s/iter; left time: 821.5763s
	iters: 300, epoch: 17 | loss: 0.0060208
	speed: 0.0236s/iter; left time: 922.7763s
	iters: 400, epoch: 17 | loss: 0.0922182
	speed: 0.0245s/iter; left time: 956.8074s
Epoch: 17 cost time: 11.220227479934692
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0120637
	speed: 0.1304s/iter; left time: 5064.8891s
	iters: 200, epoch: 18 | loss: 0.0045795
	speed: 0.0257s/iter; left time: 995.4852s
	iters: 300, epoch: 18 | loss: 0.0071369
	speed: 0.0235s/iter; left time: 908.7539s
	iters: 400, epoch: 18 | loss: 0.0020338
	speed: 0.0230s/iter; left time: 884.9578s
Epoch: 18 cost time: 11.713555335998535
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0033401
	speed: 0.1353s/iter; left time: 5191.7824s
	iters: 200, epoch: 19 | loss: 0.0009724
	speed: 0.0259s/iter; left time: 989.8133s
	iters: 300, epoch: 19 | loss: 0.0010647
	speed: 0.0252s/iter; left time: 961.5096s
	iters: 400, epoch: 19 | loss: 0.0638899
	speed: 0.0261s/iter; left time: 993.7025s
Epoch: 19 cost time: 12.358714818954468
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0072691
	speed: 0.1394s/iter; left time: 5282.7444s
	iters: 200, epoch: 20 | loss: 0.0978710
	speed: 0.0259s/iter; left time: 980.0624s
	iters: 300, epoch: 20 | loss: 0.0003671
	speed: 0.0263s/iter; left time: 989.4539s
	iters: 400, epoch: 20 | loss: 0.0056934
	speed: 0.0270s/iter; left time: 1014.5801s
Epoch: 20 cost time: 12.70148491859436
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0029220
	speed: 0.1413s/iter; left time: 5289.0729s
	iters: 200, epoch: 21 | loss: 0.0055319
	speed: 0.0264s/iter; left time: 984.9698s
	iters: 300, epoch: 21 | loss: 0.0028201
	speed: 0.0249s/iter; left time: 925.5734s
	iters: 400, epoch: 21 | loss: 0.1386486
	speed: 0.0254s/iter; left time: 942.6515s
Epoch: 21 cost time: 12.484739780426025
Epoch: 21, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0000110
	speed: 0.1401s/iter; left time: 5175.5363s
	iters: 200, epoch: 22 | loss: 0.0014095
	speed: 0.0248s/iter; left time: 913.0665s
	iters: 300, epoch: 22 | loss: 0.0078944
	speed: 0.0237s/iter; left time: 870.7110s
	iters: 400, epoch: 22 | loss: 0.0025189
	speed: 0.0241s/iter; left time: 884.1277s
Epoch: 22 cost time: 11.991999626159668
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0145521
	speed: 0.1355s/iter; left time: 4944.3539s
	iters: 200, epoch: 23 | loss: 0.0013733
	speed: 0.0246s/iter; left time: 894.0241s
	iters: 300, epoch: 23 | loss: 0.0855442
	speed: 0.0246s/iter; left time: 893.6986s
	iters: 400, epoch: 23 | loss: 0.0000722
	speed: 0.0252s/iter; left time: 913.2438s
Epoch: 23 cost time: 12.17692494392395
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
Validation loss decreased (-0.977700 --> -0.982275).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0001213
	speed: 0.1326s/iter; left time: 4777.1664s
	iters: 200, epoch: 24 | loss: 0.0013850
	speed: 0.0246s/iter; left time: 882.6697s
	iters: 300, epoch: 24 | loss: 0.0003851
	speed: 0.0246s/iter; left time: 880.6286s
	iters: 400, epoch: 24 | loss: 0.0097290
	speed: 0.0251s/iter; left time: 897.8175s
Epoch: 24 cost time: 12.069067001342773
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0004362
	speed: 0.1337s/iter; left time: 4752.1839s
	iters: 200, epoch: 25 | loss: 0.0003844
	speed: 0.0224s/iter; left time: 794.9701s
	iters: 300, epoch: 25 | loss: 0.2606182
	speed: 0.0219s/iter; left time: 775.6043s
	iters: 400, epoch: 25 | loss: 0.0000184
	speed: 0.0236s/iter; left time: 832.1683s
Epoch: 25 cost time: 11.362871408462524
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0005621
	speed: 0.1337s/iter; left time: 4689.8890s
	iters: 200, epoch: 26 | loss: 0.0014859
	speed: 0.0241s/iter; left time: 841.6823s
	iters: 300, epoch: 26 | loss: 0.1710757
	speed: 0.0232s/iter; left time: 808.1988s
	iters: 400, epoch: 26 | loss: 0.0007660
	speed: 0.0258s/iter; left time: 897.8493s
Epoch: 26 cost time: 12.062490224838257
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0045872
	speed: 0.1340s/iter; left time: 4637.2459s
	iters: 200, epoch: 27 | loss: 0.0007193
	speed: 0.0251s/iter; left time: 866.8495s
	iters: 300, epoch: 27 | loss: 0.0181427
	speed: 0.0260s/iter; left time: 894.8427s
	iters: 400, epoch: 27 | loss: 0.3799148
	speed: 0.0271s/iter; left time: 929.4957s
Epoch: 27 cost time: 12.642584800720215
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0015388
	speed: 0.1365s/iter; left time: 4661.0778s
	iters: 200, epoch: 28 | loss: 0.0019653
	speed: 0.0251s/iter; left time: 853.4299s
	iters: 300, epoch: 28 | loss: 0.0004481
	speed: 0.0246s/iter; left time: 835.2885s
	iters: 400, epoch: 28 | loss: 0.0034545
	speed: 0.0264s/iter; left time: 894.5350s
Epoch: 28 cost time: 12.476311683654785
Epoch: 28, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
Validation loss decreased (-0.982275 --> -0.984276).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0006627
	speed: 0.1351s/iter; left time: 4547.4271s
	iters: 200, epoch: 29 | loss: 0.0017658
	speed: 0.0252s/iter; left time: 846.8870s
	iters: 300, epoch: 29 | loss: 0.0036772
	speed: 0.0233s/iter; left time: 778.2262s
	iters: 400, epoch: 29 | loss: 0.0005808
	speed: 0.0250s/iter; left time: 834.6631s
Epoch: 29 cost time: 12.136084079742432
Epoch: 29, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0090207
	speed: 0.1324s/iter; left time: 4397.2387s
	iters: 200, epoch: 30 | loss: 0.0002074
	speed: 0.0253s/iter; left time: 836.3117s
	iters: 300, epoch: 30 | loss: 0.0075796
	speed: 0.0262s/iter; left time: 863.2304s
	iters: 400, epoch: 30 | loss: 0.0044271
	speed: 0.0275s/iter; left time: 905.7255s
Epoch: 30 cost time: 12.642677307128906
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0001512
	speed: 0.1387s/iter; left time: 4540.2017s
	iters: 200, epoch: 31 | loss: 0.0027190
	speed: 0.0254s/iter; left time: 829.4863s
	iters: 300, epoch: 31 | loss: 0.0970034
	speed: 0.0246s/iter; left time: 799.2128s
	iters: 400, epoch: 31 | loss: 0.0000025
	speed: 0.0249s/iter; left time: 806.0865s
Epoch: 31 cost time: 12.12865924835205
Epoch: 31, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0000177
	speed: 0.1326s/iter; left time: 4278.1219s
	iters: 200, epoch: 32 | loss: 0.0016404
	speed: 0.0237s/iter; left time: 760.8538s
	iters: 300, epoch: 32 | loss: 0.0002247
	speed: 0.0233s/iter; left time: 746.0862s
	iters: 400, epoch: 32 | loss: 0.0001345
	speed: 0.0242s/iter; left time: 773.9099s
Epoch: 32 cost time: 11.725682735443115
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0001314
	speed: 0.1361s/iter; left time: 4327.6568s
	iters: 200, epoch: 33 | loss: 0.0035663
	speed: 0.0246s/iter; left time: 778.7417s
	iters: 300, epoch: 33 | loss: 0.0037108
	speed: 0.0247s/iter; left time: 780.8605s
	iters: 400, epoch: 33 | loss: 0.0041917
	speed: 0.0243s/iter; left time: 766.6556s
Epoch: 33 cost time: 11.9854154586792
Epoch: 33, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0588740
	speed: 0.1338s/iter; left time: 4192.0956s
	iters: 200, epoch: 34 | loss: 0.0291371
	speed: 0.0251s/iter; left time: 783.7785s
	iters: 300, epoch: 34 | loss: 0.0008872
	speed: 0.0244s/iter; left time: 759.2538s
	iters: 400, epoch: 34 | loss: 0.0091795
	speed: 0.0240s/iter; left time: 744.0382s
Epoch: 34 cost time: 12.017737865447998
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0002100
	speed: 0.1340s/iter; left time: 4133.5520s
	iters: 200, epoch: 35 | loss: 0.0012709
	speed: 0.0238s/iter; left time: 731.5894s
	iters: 300, epoch: 35 | loss: 0.0008024
	speed: 0.0245s/iter; left time: 752.5290s
	iters: 400, epoch: 35 | loss: 0.0029126
	speed: 0.0240s/iter; left time: 732.9450s
Epoch: 35 cost time: 12.007385015487671
Epoch: 35, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.0590767
	speed: 0.1357s/iter; left time: 4122.8092s
	iters: 200, epoch: 36 | loss: 0.0889597
	speed: 0.0232s/iter; left time: 701.5182s
	iters: 300, epoch: 36 | loss: 0.0120211
	speed: 0.0236s/iter; left time: 713.1140s
	iters: 400, epoch: 36 | loss: 0.0005120
	speed: 0.0258s/iter; left time: 775.5830s
Epoch: 36 cost time: 12.129100561141968
Epoch: 36, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.0003946
	speed: 0.1308s/iter; left time: 3913.0164s
	iters: 200, epoch: 37 | loss: 0.0003846
	speed: 0.0244s/iter; left time: 728.9461s
	iters: 300, epoch: 37 | loss: 0.0044139
	speed: 0.0253s/iter; left time: 752.9896s
	iters: 400, epoch: 37 | loss: 0.0001897
	speed: 0.0245s/iter; left time: 726.1722s
Epoch: 37 cost time: 12.093370914459229
Epoch: 37, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0009753
	speed: 0.1358s/iter; left time: 4000.0281s
	iters: 200, epoch: 38 | loss: 0.0000057
	speed: 0.0260s/iter; left time: 763.4899s
	iters: 300, epoch: 38 | loss: 0.0014114
	speed: 0.0259s/iter; left time: 757.1827s
	iters: 400, epoch: 38 | loss: 0.0000618
	speed: 0.0229s/iter; left time: 666.7043s
Epoch: 38 cost time: 12.402724266052246
Epoch: 38, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9842767295597484
model parameter : 111394
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0742736
	speed: 0.0440s/iter; left time: 2058.6977s
	iters: 200, epoch: 1 | loss: 0.3291880
	speed: 0.0239s/iter; left time: 1116.4395s
	iters: 300, epoch: 1 | loss: 0.2985501
	speed: 0.0239s/iter; left time: 1114.5984s
	iters: 400, epoch: 1 | loss: 0.2465640
	speed: 0.0242s/iter; left time: 1124.9150s
Epoch: 1 cost time: 13.384172677993774
Epoch: 1, Steps: 469 | Train Loss: 0.669 Vali Loss: 0.230 Vali Acc: 0.936 Test Loss: 0.230 Test Acc: 0.936
Validation loss decreased (inf --> -0.936247).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0760539
	speed: 0.1283s/iter; left time: 5943.3782s
	iters: 200, epoch: 2 | loss: 0.0438385
	speed: 0.0242s/iter; left time: 1117.2794s
	iters: 300, epoch: 2 | loss: 0.3265819
	speed: 0.0241s/iter; left time: 1111.9021s
	iters: 400, epoch: 2 | loss: 0.0594063
	speed: 0.0238s/iter; left time: 1094.7284s
Epoch: 2 cost time: 11.502713918685913
Epoch: 2, Steps: 469 | Train Loss: 0.112 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.936247 --> -0.959118).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0855776
	speed: 0.1267s/iter; left time: 5812.8439s
	iters: 200, epoch: 3 | loss: 0.0258950
	speed: 0.0247s/iter; left time: 1131.3393s
	iters: 300, epoch: 3 | loss: 0.0270402
	speed: 0.0243s/iter; left time: 1109.3240s
	iters: 400, epoch: 3 | loss: 0.0283261
	speed: 0.0240s/iter; left time: 1093.3998s
Epoch: 3 cost time: 11.805418491363525
Epoch: 3, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.959118 --> -0.963120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0048684
	speed: 0.1277s/iter; left time: 5797.9375s
	iters: 200, epoch: 4 | loss: 0.0465607
	speed: 0.0237s/iter; left time: 1072.8759s
	iters: 300, epoch: 4 | loss: 0.0014876
	speed: 0.0234s/iter; left time: 1058.9945s
	iters: 400, epoch: 4 | loss: 0.0037972
	speed: 0.0226s/iter; left time: 1018.9658s
Epoch: 4 cost time: 11.39732050895691
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.963120 --> -0.973412).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0064183
	speed: 0.1346s/iter; left time: 6048.6106s
	iters: 200, epoch: 5 | loss: 0.0048355
	speed: 0.0241s/iter; left time: 1080.8885s
	iters: 300, epoch: 5 | loss: 0.0016985
	speed: 0.0232s/iter; left time: 1038.9416s
	iters: 400, epoch: 5 | loss: 0.1329543
	speed: 0.0239s/iter; left time: 1065.3665s
Epoch: 5 cost time: 11.407237529754639
Epoch: 5, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0778797
	speed: 0.1266s/iter; left time: 5629.0143s
	iters: 200, epoch: 6 | loss: 0.0094905
	speed: 0.0240s/iter; left time: 1063.2036s
	iters: 300, epoch: 6 | loss: 0.0405910
	speed: 0.0242s/iter; left time: 1071.8691s
	iters: 400, epoch: 6 | loss: 0.0022944
	speed: 0.0247s/iter; left time: 1092.4151s
Epoch: 6 cost time: 11.560558080673218
Epoch: 6, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0026389
	speed: 0.1229s/iter; left time: 5407.9915s
	iters: 200, epoch: 7 | loss: 0.0048308
	speed: 0.0243s/iter; left time: 1064.9096s
	iters: 300, epoch: 7 | loss: 0.0004757
	speed: 0.0248s/iter; left time: 1085.9920s
	iters: 400, epoch: 7 | loss: 0.0029717
	speed: 0.0251s/iter; left time: 1096.6583s
Epoch: 7 cost time: 11.845540046691895
Epoch: 7, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0201224
	speed: 0.1313s/iter; left time: 5715.5721s
	iters: 200, epoch: 8 | loss: 0.0484678
	speed: 0.0247s/iter; left time: 1070.9402s
	iters: 300, epoch: 8 | loss: 0.0013142
	speed: 0.0247s/iter; left time: 1071.5976s
	iters: 400, epoch: 8 | loss: 0.0006414
	speed: 0.0241s/iter; left time: 1040.2687s
Epoch: 8 cost time: 11.8583242893219
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.973412 --> -0.974556).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0032623
	speed: 0.1283s/iter; left time: 5522.8152s
	iters: 200, epoch: 9 | loss: 0.0392895
	speed: 0.0246s/iter; left time: 1054.5179s
	iters: 300, epoch: 9 | loss: 0.0008567
	speed: 0.0261s/iter; left time: 1120.0903s
	iters: 400, epoch: 9 | loss: 0.0040799
	speed: 0.0250s/iter; left time: 1068.6541s
Epoch: 9 cost time: 12.013983011245728
Epoch: 9, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0378190
	speed: 0.1285s/iter; left time: 5473.6015s
	iters: 200, epoch: 10 | loss: 0.0269912
	speed: 0.0234s/iter; left time: 993.6072s
	iters: 300, epoch: 10 | loss: 0.0489344
	speed: 0.0233s/iter; left time: 987.9891s
	iters: 400, epoch: 10 | loss: 0.0008714
	speed: 0.0221s/iter; left time: 932.6710s
Epoch: 10 cost time: 11.140702486038208
Epoch: 10, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0239251
	speed: 0.1227s/iter; left time: 5167.9064s
	iters: 200, epoch: 11 | loss: 0.0013919
	speed: 0.0236s/iter; left time: 989.3646s
	iters: 300, epoch: 11 | loss: 0.0013000
	speed: 0.0232s/iter; left time: 973.7497s
	iters: 400, epoch: 11 | loss: 0.0000904
	speed: 0.0237s/iter; left time: 989.0712s
Epoch: 11 cost time: 11.358232498168945
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0283029
	speed: 0.1260s/iter; left time: 5247.9221s
	iters: 200, epoch: 12 | loss: 0.0000433
	speed: 0.0247s/iter; left time: 1025.8563s
	iters: 300, epoch: 12 | loss: 0.0223460
	speed: 0.0240s/iter; left time: 992.7875s
	iters: 400, epoch: 12 | loss: 0.0950641
	speed: 0.0237s/iter; left time: 979.9247s
Epoch: 12 cost time: 11.618420839309692
Epoch: 12, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0007505
	speed: 0.1277s/iter; left time: 5256.1614s
	iters: 200, epoch: 13 | loss: 0.0002632
	speed: 0.0223s/iter; left time: 917.9713s
	iters: 300, epoch: 13 | loss: 0.2893369
	speed: 0.0228s/iter; left time: 932.4964s
	iters: 400, epoch: 13 | loss: 0.0000769
	speed: 0.0230s/iter; left time: 941.2269s
Epoch: 13 cost time: 11.140824556350708
Epoch: 13, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
Validation loss decreased (-0.974556 --> -0.981703).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0113320
	speed: 0.1243s/iter; left time: 5059.7928s
	iters: 200, epoch: 14 | loss: 0.0005513
	speed: 0.0232s/iter; left time: 941.1580s
	iters: 300, epoch: 14 | loss: 0.0031607
	speed: 0.0237s/iter; left time: 958.0035s
	iters: 400, epoch: 14 | loss: 0.0010111
	speed: 0.0220s/iter; left time: 887.5014s
Epoch: 14 cost time: 11.161091566085815
Epoch: 14, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0009713
	speed: 0.1330s/iter; left time: 5350.8995s
	iters: 200, epoch: 15 | loss: 0.0017599
	speed: 0.0244s/iter; left time: 977.4024s
	iters: 300, epoch: 15 | loss: 0.0046551
	speed: 0.0232s/iter; left time: 926.9656s
	iters: 400, epoch: 15 | loss: 0.0001332
	speed: 0.0239s/iter; left time: 956.0974s
Epoch: 15 cost time: 11.530079126358032
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0001468
	speed: 0.1296s/iter; left time: 5154.5427s
	iters: 200, epoch: 16 | loss: 0.0443313
	speed: 0.0235s/iter; left time: 930.2164s
	iters: 300, epoch: 16 | loss: 0.0093766
	speed: 0.0239s/iter; left time: 947.0279s
	iters: 400, epoch: 16 | loss: 0.0007533
	speed: 0.0242s/iter; left time: 955.5668s
Epoch: 16 cost time: 11.494629383087158
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0188944
	speed: 0.1278s/iter; left time: 5022.5784s
	iters: 200, epoch: 17 | loss: 0.0005420
	speed: 0.0233s/iter; left time: 913.7033s
	iters: 300, epoch: 17 | loss: 0.0004114
	speed: 0.0236s/iter; left time: 924.5261s
	iters: 400, epoch: 17 | loss: 0.0010967
	speed: 0.0241s/iter; left time: 938.6086s
Epoch: 17 cost time: 11.708091735839844
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.979 Test Loss: 0.148 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000022
	speed: 0.1275s/iter; left time: 4948.7158s
	iters: 200, epoch: 18 | loss: 0.0002034
	speed: 0.0244s/iter; left time: 944.7479s
	iters: 300, epoch: 18 | loss: 0.0251582
	speed: 0.0254s/iter; left time: 982.9753s
	iters: 400, epoch: 18 | loss: 0.0001178
	speed: 0.0234s/iter; left time: 902.9072s
Epoch: 18 cost time: 11.68808913230896
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0035065
	speed: 0.1177s/iter; left time: 4514.8055s
	iters: 200, epoch: 19 | loss: 0.0075379
	speed: 0.0237s/iter; left time: 906.7725s
	iters: 300, epoch: 19 | loss: 0.0000852
	speed: 0.0247s/iter; left time: 941.4237s
	iters: 400, epoch: 19 | loss: 0.0575814
	speed: 0.0220s/iter; left time: 837.7964s
Epoch: 19 cost time: 11.44057559967041
Epoch: 19, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0058447
	speed: 0.1333s/iter; left time: 5052.1680s
	iters: 200, epoch: 20 | loss: 0.0101865
	speed: 0.0231s/iter; left time: 872.7127s
	iters: 300, epoch: 20 | loss: 0.0003609
	speed: 0.0234s/iter; left time: 882.2419s
	iters: 400, epoch: 20 | loss: 0.0014910
	speed: 0.0225s/iter; left time: 846.0639s
Epoch: 20 cost time: 11.348798036575317
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0147234
	speed: 0.1366s/iter; left time: 5110.3228s
	iters: 200, epoch: 21 | loss: 0.0007630
	speed: 0.0250s/iter; left time: 932.6607s
	iters: 300, epoch: 21 | loss: 0.0018266
	speed: 0.0257s/iter; left time: 957.5159s
	iters: 400, epoch: 21 | loss: 0.1316986
	speed: 0.0224s/iter; left time: 831.6642s
Epoch: 21 cost time: 11.833359956741333
Epoch: 21, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000145
	speed: 0.1295s/iter; left time: 4783.7536s
	iters: 200, epoch: 22 | loss: 0.0000317
	speed: 0.0248s/iter; left time: 913.1635s
	iters: 300, epoch: 22 | loss: 0.0086032
	speed: 0.0244s/iter; left time: 895.6682s
	iters: 400, epoch: 22 | loss: 0.0082988
	speed: 0.0253s/iter; left time: 927.5770s
Epoch: 22 cost time: 12.02330207824707
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0001621
	speed: 0.1275s/iter; left time: 4650.4710s
	iters: 200, epoch: 23 | loss: 0.0561396
	speed: 0.0240s/iter; left time: 874.6930s
	iters: 300, epoch: 23 | loss: 0.0010343
	speed: 0.0242s/iter; left time: 879.1577s
	iters: 400, epoch: 23 | loss: 0.0001429
	speed: 0.0240s/iter; left time: 867.9531s
Epoch: 23 cost time: 11.708842277526855
Epoch: 23, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 111394
model size : 2.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.5775626
	speed: 0.0429s/iter; left time: 2006.8529s
	iters: 200, epoch: 1 | loss: 0.2613180
	speed: 0.0245s/iter; left time: 1144.7552s
	iters: 300, epoch: 1 | loss: 0.2426105
	speed: 0.0230s/iter; left time: 1070.1468s
	iters: 400, epoch: 1 | loss: 0.1545055
	speed: 0.0235s/iter; left time: 1090.8835s
Epoch: 1 cost time: 12.980141162872314
Epoch: 1, Steps: 469 | Train Loss: 0.594 Vali Loss: 0.303 Vali Acc: 0.908 Test Loss: 0.303 Test Acc: 0.908
Validation loss decreased (inf --> -0.908230).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0960964
	speed: 0.1273s/iter; left time: 5898.8512s
	iters: 200, epoch: 2 | loss: 0.0640755
	speed: 0.0204s/iter; left time: 944.7852s
	iters: 300, epoch: 2 | loss: 0.0613977
	speed: 0.0264s/iter; left time: 1216.1558s
	iters: 400, epoch: 2 | loss: 0.1493483
	speed: 0.0256s/iter; left time: 1178.6849s
Epoch: 2 cost time: 11.824828386306763
Epoch: 2, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.908230 --> -0.956831).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1735587
	speed: 0.1263s/iter; left time: 5794.5342s
	iters: 200, epoch: 3 | loss: 0.0157049
	speed: 0.0195s/iter; left time: 893.9299s
	iters: 300, epoch: 3 | loss: 0.0092117
	speed: 0.0189s/iter; left time: 863.4821s
	iters: 400, epoch: 3 | loss: 0.0423750
	speed: 0.0178s/iter; left time: 809.0670s
Epoch: 3 cost time: 9.402495384216309
Epoch: 3, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.956831 --> -0.961977).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0454815
	speed: 0.1187s/iter; left time: 5388.3474s
	iters: 200, epoch: 4 | loss: 0.0247171
	speed: 0.0237s/iter; left time: 1075.1513s
	iters: 300, epoch: 4 | loss: 0.1347549
	speed: 0.0251s/iter; left time: 1132.1308s
	iters: 400, epoch: 4 | loss: 0.0053721
	speed: 0.0242s/iter; left time: 1090.0186s
Epoch: 4 cost time: 11.684244632720947
Epoch: 4, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.961977 --> -0.963978).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0127524
	speed: 0.1265s/iter; left time: 5682.6990s
	iters: 200, epoch: 5 | loss: 0.0262445
	speed: 0.0225s/iter; left time: 1009.2236s
	iters: 300, epoch: 5 | loss: 0.0239425
	speed: 0.0234s/iter; left time: 1046.6044s
	iters: 400, epoch: 5 | loss: 0.2620261
	speed: 0.0238s/iter; left time: 1063.8136s
Epoch: 5 cost time: 11.496739625930786
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
Validation loss decreased (-0.963978 --> -0.966265).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0249608
	speed: 0.1248s/iter; left time: 5547.7241s
	iters: 200, epoch: 6 | loss: 0.0388115
	speed: 0.0244s/iter; left time: 1082.3020s
	iters: 300, epoch: 6 | loss: 0.1089416
	speed: 0.0241s/iter; left time: 1067.1974s
	iters: 400, epoch: 6 | loss: 0.0765871
	speed: 0.0253s/iter; left time: 1116.8871s
Epoch: 6 cost time: 11.962685823440552
Epoch: 6, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.967123).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0020921
	speed: 0.1305s/iter; left time: 5740.7371s
	iters: 200, epoch: 7 | loss: 0.0762845
	speed: 0.0240s/iter; left time: 1054.4001s
	iters: 300, epoch: 7 | loss: 0.0020064
	speed: 0.0247s/iter; left time: 1081.7954s
	iters: 400, epoch: 7 | loss: 0.0185701
	speed: 0.0243s/iter; left time: 1062.0365s
Epoch: 7 cost time: 11.765613317489624
Epoch: 7, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967123 --> -0.968266).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0153803
	speed: 0.1272s/iter; left time: 5534.2138s
	iters: 200, epoch: 8 | loss: 0.0161747
	speed: 0.0246s/iter; left time: 1070.2332s
	iters: 300, epoch: 8 | loss: 0.0573178
	speed: 0.0246s/iter; left time: 1067.0344s
	iters: 400, epoch: 8 | loss: 0.0013079
	speed: 0.0225s/iter; left time: 972.9137s
Epoch: 8 cost time: 11.54185152053833
Epoch: 8, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0556491
	speed: 0.1234s/iter; left time: 5312.2378s
	iters: 200, epoch: 9 | loss: 0.0382321
	speed: 0.0235s/iter; left time: 1008.3140s
	iters: 300, epoch: 9 | loss: 0.0441493
	speed: 0.0234s/iter; left time: 1001.3389s
	iters: 400, epoch: 9 | loss: 0.0011488
	speed: 0.0232s/iter; left time: 992.7644s
Epoch: 9 cost time: 11.393255472183228
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.968266 --> -0.971697).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0503188
	speed: 0.1252s/iter; left time: 5329.0766s
	iters: 200, epoch: 10 | loss: 0.0602174
	speed: 0.0223s/iter; left time: 946.6548s
	iters: 300, epoch: 10 | loss: 0.0572447
	speed: 0.0223s/iter; left time: 946.3738s
	iters: 400, epoch: 10 | loss: 0.0024511
	speed: 0.0234s/iter; left time: 991.1924s
Epoch: 10 cost time: 11.129291296005249
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0145249
	speed: 0.1275s/iter; left time: 5370.9837s
	iters: 200, epoch: 11 | loss: 0.0079540
	speed: 0.0244s/iter; left time: 1024.0025s
	iters: 300, epoch: 11 | loss: 0.0413576
	speed: 0.0246s/iter; left time: 1030.0993s
	iters: 400, epoch: 11 | loss: 0.0034314
	speed: 0.0227s/iter; left time: 950.2268s
Epoch: 11 cost time: 11.54022479057312
Epoch: 11, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972840).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0606073
	speed: 0.1296s/iter; left time: 5398.7475s
	iters: 200, epoch: 12 | loss: 0.0015660
	speed: 0.0251s/iter; left time: 1044.7218s
	iters: 300, epoch: 12 | loss: 0.0015493
	speed: 0.0235s/iter; left time: 974.5030s
	iters: 400, epoch: 12 | loss: 0.0034839
	speed: 0.0230s/iter; left time: 950.5189s
Epoch: 12 cost time: 11.495738506317139
Epoch: 12, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0166105
	speed: 0.1286s/iter; left time: 5296.4302s
	iters: 200, epoch: 13 | loss: 0.0064970
	speed: 0.0228s/iter; left time: 936.5695s
	iters: 300, epoch: 13 | loss: 0.0050739
	speed: 0.0228s/iter; left time: 932.5060s
	iters: 400, epoch: 13 | loss: 0.0066220
	speed: 0.0221s/iter; left time: 904.3821s
Epoch: 13 cost time: 11.143341302871704
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977415).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0008211
	speed: 0.1358s/iter; left time: 5527.5977s
	iters: 200, epoch: 14 | loss: 0.0047272
	speed: 0.0245s/iter; left time: 993.0386s
	iters: 300, epoch: 14 | loss: 0.0034800
	speed: 0.0254s/iter; left time: 1027.9985s
	iters: 400, epoch: 14 | loss: 0.0016905
	speed: 0.0252s/iter; left time: 1018.9408s
Epoch: 14 cost time: 12.17663049697876
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0007634
	speed: 0.1294s/iter; left time: 5207.6119s
	iters: 200, epoch: 15 | loss: 0.0006961
	speed: 0.0251s/iter; left time: 1005.6742s
	iters: 300, epoch: 15 | loss: 0.0021250
	speed: 0.0261s/iter; left time: 1045.0569s
	iters: 400, epoch: 15 | loss: 0.0001862
	speed: 0.0263s/iter; left time: 1048.3256s
Epoch: 15 cost time: 12.255690097808838
Epoch: 15, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981131).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.3290439
	speed: 0.1286s/iter; left time: 5114.1857s
	iters: 200, epoch: 16 | loss: 0.0002270
	speed: 0.0239s/iter; left time: 948.7929s
	iters: 300, epoch: 16 | loss: 0.1450905
	speed: 0.0235s/iter; left time: 931.7071s
	iters: 400, epoch: 16 | loss: 0.0009148
	speed: 0.0238s/iter; left time: 940.6409s
Epoch: 16 cost time: 11.660139560699463
Epoch: 16, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.981131 --> -0.984276).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0096903
	speed: 0.1333s/iter; left time: 5237.4424s
	iters: 200, epoch: 17 | loss: 0.0006570
	speed: 0.0234s/iter; left time: 918.1405s
	iters: 300, epoch: 17 | loss: 0.0092054
	speed: 0.0247s/iter; left time: 967.4977s
	iters: 400, epoch: 17 | loss: 0.0017271
	speed: 0.0237s/iter; left time: 925.0830s
Epoch: 17 cost time: 11.586462497711182
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0002561
	speed: 0.1261s/iter; left time: 4898.0250s
	iters: 200, epoch: 18 | loss: 0.0006373
	speed: 0.0229s/iter; left time: 887.1705s
	iters: 300, epoch: 18 | loss: 0.0026073
	speed: 0.0239s/iter; left time: 922.4563s
	iters: 400, epoch: 18 | loss: 0.0009111
	speed: 0.0249s/iter; left time: 957.4788s
Epoch: 18 cost time: 11.582579135894775
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.1871896
	speed: 0.1244s/iter; left time: 4770.5843s
	iters: 200, epoch: 19 | loss: 0.0000370
	speed: 0.0236s/iter; left time: 904.4744s
	iters: 300, epoch: 19 | loss: 0.0019495
	speed: 0.0231s/iter; left time: 881.1914s
	iters: 400, epoch: 19 | loss: 0.0052191
	speed: 0.0231s/iter; left time: 880.2253s
Epoch: 19 cost time: 11.463173151016235
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0042776
	speed: 0.1280s/iter; left time: 4848.4271s
	iters: 200, epoch: 20 | loss: 0.0031017
	speed: 0.0244s/iter; left time: 922.3176s
	iters: 300, epoch: 20 | loss: 0.0011675
	speed: 0.0227s/iter; left time: 856.1575s
	iters: 400, epoch: 20 | loss: 0.0001169
	speed: 0.0234s/iter; left time: 880.5407s
Epoch: 20 cost time: 11.49129033088684
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0003065
	speed: 0.1267s/iter; left time: 4739.6904s
	iters: 200, epoch: 21 | loss: 0.6619510
	speed: 0.0238s/iter; left time: 888.7954s
	iters: 300, epoch: 21 | loss: 0.0000053
	speed: 0.0229s/iter; left time: 851.4192s
	iters: 400, epoch: 21 | loss: 0.0014879
	speed: 0.0245s/iter; left time: 909.7383s
Epoch: 21 cost time: 11.45865774154663
Epoch: 21, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002311
	speed: 0.1267s/iter; left time: 4680.1484s
	iters: 200, epoch: 22 | loss: 0.0106732
	speed: 0.0236s/iter; left time: 870.6791s
	iters: 300, epoch: 22 | loss: 0.0033341
	speed: 0.0244s/iter; left time: 898.2230s
	iters: 400, epoch: 22 | loss: 0.0018928
	speed: 0.0221s/iter; left time: 811.4591s
Epoch: 22 cost time: 11.46156907081604
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0045168
	speed: 0.1340s/iter; left time: 4888.9575s
	iters: 200, epoch: 23 | loss: 0.0013041
	speed: 0.0262s/iter; left time: 954.2024s
	iters: 300, epoch: 23 | loss: 0.0000037
	speed: 0.0231s/iter; left time: 837.2387s
	iters: 400, epoch: 23 | loss: 0.0142337
	speed: 0.0230s/iter; left time: 830.8671s
Epoch: 23 cost time: 11.691180229187012
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0927779
	speed: 0.1281s/iter; left time: 4612.3160s
	iters: 200, epoch: 24 | loss: 0.0001097
	speed: 0.0229s/iter; left time: 822.7185s
	iters: 300, epoch: 24 | loss: 0.0122738
	speed: 0.0223s/iter; left time: 798.2622s
	iters: 400, epoch: 24 | loss: 0.0255125
	speed: 0.0227s/iter; left time: 812.2434s
Epoch: 24 cost time: 11.09753155708313
Epoch: 24, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 25 | loss: 0.0005735
	speed: 0.1298s/iter; left time: 4613.6962s
	iters: 200, epoch: 25 | loss: 0.0194502
	speed: 0.0242s/iter; left time: 856.7936s
	iters: 300, epoch: 25 | loss: 0.0045322
	speed: 0.0253s/iter; left time: 895.3446s
	iters: 400, epoch: 25 | loss: 0.2451763
	speed: 0.0263s/iter; left time: 925.7085s
Epoch: 25 cost time: 12.125141143798828
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
Validation loss decreased (-0.984276 --> -0.984562).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0016543
	speed: 0.1291s/iter; left time: 4527.3991s
	iters: 200, epoch: 26 | loss: 0.0106149
	speed: 0.0235s/iter; left time: 821.3549s
	iters: 300, epoch: 26 | loss: 0.0177171
	speed: 0.0236s/iter; left time: 823.1141s
	iters: 400, epoch: 26 | loss: 0.0078020
	speed: 0.0238s/iter; left time: 827.6912s
Epoch: 26 cost time: 11.551761865615845
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0035720
	speed: 0.1301s/iter; left time: 4503.8488s
	iters: 200, epoch: 27 | loss: 0.1530046
	speed: 0.0226s/iter; left time: 780.1610s
	iters: 300, epoch: 27 | loss: 0.0003905
	speed: 0.0218s/iter; left time: 748.3981s
	iters: 400, epoch: 27 | loss: 0.0006126
	speed: 0.0227s/iter; left time: 779.6470s
Epoch: 27 cost time: 11.0912184715271
Epoch: 27, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0011099
	speed: 0.1288s/iter; left time: 4397.2433s
	iters: 200, epoch: 28 | loss: 0.0074735
	speed: 0.0231s/iter; left time: 787.9058s
	iters: 300, epoch: 28 | loss: 0.0316892
	speed: 0.0239s/iter; left time: 810.3974s
	iters: 400, epoch: 28 | loss: 0.0006472
	speed: 0.0218s/iter; left time: 739.2730s
Epoch: 28 cost time: 11.386994361877441
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0005049
	speed: 0.1266s/iter; left time: 4263.4361s
	iters: 200, epoch: 29 | loss: 0.0002503
	speed: 0.0237s/iter; left time: 794.8362s
	iters: 300, epoch: 29 | loss: 0.0706640
	speed: 0.0245s/iter; left time: 819.1215s
	iters: 400, epoch: 29 | loss: 0.0015584
	speed: 0.0261s/iter; left time: 871.0396s
Epoch: 29 cost time: 11.75169324874878
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0013034
	speed: 0.1270s/iter; left time: 4217.2436s
	iters: 200, epoch: 30 | loss: 0.0009823
	speed: 0.0244s/iter; left time: 807.8050s
	iters: 300, epoch: 30 | loss: 0.0006367
	speed: 0.0232s/iter; left time: 766.7414s
	iters: 400, epoch: 30 | loss: 0.0024203
	speed: 0.0232s/iter; left time: 762.8776s
Epoch: 30 cost time: 11.416084289550781
Epoch: 30, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.1098911
	speed: 0.1212s/iter; left time: 3968.5591s
	iters: 200, epoch: 31 | loss: 0.0003435
	speed: 0.0243s/iter; left time: 791.9439s
	iters: 300, epoch: 31 | loss: 0.0016961
	speed: 0.0239s/iter; left time: 779.0766s
	iters: 400, epoch: 31 | loss: 0.0120352
	speed: 0.0241s/iter; left time: 780.7201s
Epoch: 31 cost time: 11.525225400924683
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.984 Test Loss: 0.096 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 32 | loss: 0.0011236
	speed: 0.1283s/iter; left time: 4140.2800s
	iters: 200, epoch: 32 | loss: 0.0133336
	speed: 0.0222s/iter; left time: 713.7375s
	iters: 300, epoch: 32 | loss: 0.0237400
	speed: 0.0242s/iter; left time: 777.3632s
	iters: 400, epoch: 32 | loss: 0.0187695
	speed: 0.0245s/iter; left time: 783.2465s
Epoch: 32 cost time: 11.471285343170166
Epoch: 32, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 33 | loss: 0.0000849
	speed: 0.1224s/iter; left time: 3891.7120s
	iters: 200, epoch: 33 | loss: 0.0118587
	speed: 0.0212s/iter; left time: 672.7345s
	iters: 300, epoch: 33 | loss: 0.0055783
	speed: 0.0247s/iter; left time: 778.8985s
	iters: 400, epoch: 33 | loss: 0.0056083
	speed: 0.0243s/iter; left time: 766.6611s
Epoch: 33 cost time: 11.396842002868652
Epoch: 33, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 34 | loss: 0.0001797
	speed: 0.1313s/iter; left time: 4113.9713s
	iters: 200, epoch: 34 | loss: 0.0000837
	speed: 0.0260s/iter; left time: 811.6780s
	iters: 300, epoch: 34 | loss: 0.0000213
	speed: 0.0249s/iter; left time: 776.3410s
	iters: 400, epoch: 34 | loss: 0.0000455
	speed: 0.0237s/iter; left time: 734.5733s
Epoch: 34 cost time: 11.995193481445312
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 35 | loss: 0.0004359
	speed: 0.1309s/iter; left time: 4039.5771s
	iters: 200, epoch: 35 | loss: 0.0001616
	speed: 0.0243s/iter; left time: 748.0570s
	iters: 300, epoch: 35 | loss: 0.0934990
	speed: 0.0244s/iter; left time: 748.0281s
	iters: 400, epoch: 35 | loss: 0.0014143
	speed: 0.0247s/iter; left time: 754.4318s
Epoch: 35 cost time: 12.011555433273315
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9845626072041166
model parameter : 78626
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6134393
	speed: 0.0447s/iter; left time: 2092.8882s
	iters: 200, epoch: 1 | loss: 0.3061664
	speed: 0.0245s/iter; left time: 1146.2250s
	iters: 300, epoch: 1 | loss: 0.2223911
	speed: 0.0243s/iter; left time: 1132.3540s
	iters: 400, epoch: 1 | loss: 0.1484272
	speed: 0.0255s/iter; left time: 1187.3313s
Epoch: 1 cost time: 13.647989988327026
Epoch: 1, Steps: 469 | Train Loss: 0.610 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
Validation loss decreased (inf --> -0.918808).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1034980
	speed: 0.1331s/iter; left time: 6164.6823s
	iters: 200, epoch: 2 | loss: 0.0596921
	speed: 0.0251s/iter; left time: 1161.3122s
	iters: 300, epoch: 2 | loss: 0.0432934
	speed: 0.0247s/iter; left time: 1141.3261s
	iters: 400, epoch: 2 | loss: 0.2303634
	speed: 0.0232s/iter; left time: 1069.0929s
Epoch: 2 cost time: 11.85384225845337
Epoch: 2, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
Validation loss decreased (-0.918808 --> -0.955115).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1100570
	speed: 0.1296s/iter; left time: 5945.3125s
	iters: 200, epoch: 3 | loss: 0.0222205
	speed: 0.0246s/iter; left time: 1126.0423s
	iters: 300, epoch: 3 | loss: 0.0359119
	speed: 0.0234s/iter; left time: 1069.0733s
	iters: 400, epoch: 3 | loss: 0.0733376
	speed: 0.0244s/iter; left time: 1111.3173s
Epoch: 3 cost time: 11.64131236076355
Epoch: 3, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.955115 --> -0.963120).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0533557
	speed: 0.1281s/iter; left time: 5815.7657s
	iters: 200, epoch: 4 | loss: 0.0387520
	speed: 0.0247s/iter; left time: 1119.4410s
	iters: 300, epoch: 4 | loss: 0.1517073
	speed: 0.0257s/iter; left time: 1161.0763s
	iters: 400, epoch: 4 | loss: 0.0041318
	speed: 0.0255s/iter; left time: 1150.3086s
Epoch: 4 cost time: 12.05736517906189
Epoch: 4, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.963120 --> -0.967409).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0048742
	speed: 0.1262s/iter; left time: 5671.6196s
	iters: 200, epoch: 5 | loss: 0.0450356
	speed: 0.0270s/iter; left time: 1209.9496s
	iters: 300, epoch: 5 | loss: 0.0285557
	speed: 0.0268s/iter; left time: 1198.3503s
	iters: 400, epoch: 5 | loss: 0.0996481
	speed: 0.0256s/iter; left time: 1143.2144s
Epoch: 5 cost time: 12.48205852508545
Epoch: 5, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.967409 --> -0.967694).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0628246
	speed: 0.1330s/iter; left time: 5911.1923s
	iters: 200, epoch: 6 | loss: 0.0493583
	speed: 0.0249s/iter; left time: 1102.9758s
	iters: 300, epoch: 6 | loss: 0.0814499
	speed: 0.0254s/iter; left time: 1124.5870s
	iters: 400, epoch: 6 | loss: 0.0050563
	speed: 0.0244s/iter; left time: 1078.0994s
Epoch: 6 cost time: 12.05997633934021
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0054533
	speed: 0.1346s/iter; left time: 5921.6376s
	iters: 200, epoch: 7 | loss: 0.0257217
	speed: 0.0246s/iter; left time: 1081.7337s
	iters: 300, epoch: 7 | loss: 0.0036300
	speed: 0.0267s/iter; left time: 1168.9325s
	iters: 400, epoch: 7 | loss: 0.0123627
	speed: 0.0257s/iter; left time: 1120.5742s
Epoch: 7 cost time: 12.145598888397217
Epoch: 7, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967694 --> -0.968266).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1555193
	speed: 0.1298s/iter; left time: 5646.8421s
	iters: 200, epoch: 8 | loss: 0.0638123
	speed: 0.0261s/iter; left time: 1133.4009s
	iters: 300, epoch: 8 | loss: 0.0118820
	speed: 0.0258s/iter; left time: 1119.4705s
	iters: 400, epoch: 8 | loss: 0.0054069
	speed: 0.0254s/iter; left time: 1098.8845s
Epoch: 8 cost time: 12.305413484573364
Epoch: 8, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.2174231
	speed: 0.1270s/iter; left time: 5466.0754s
	iters: 200, epoch: 9 | loss: 0.0501716
	speed: 0.0238s/iter; left time: 1021.4934s
	iters: 300, epoch: 9 | loss: 0.0512041
	speed: 0.0244s/iter; left time: 1045.1329s
	iters: 400, epoch: 9 | loss: 0.0009007
	speed: 0.0250s/iter; left time: 1067.5269s
Epoch: 9 cost time: 11.851761817932129
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1131587
	speed: 0.1309s/iter; left time: 5574.6523s
	iters: 200, epoch: 10 | loss: 0.0764361
	speed: 0.0245s/iter; left time: 1042.6181s
	iters: 300, epoch: 10 | loss: 0.0332663
	speed: 0.0247s/iter; left time: 1045.9738s
	iters: 400, epoch: 10 | loss: 0.0004975
	speed: 0.0241s/iter; left time: 1019.6673s
Epoch: 10 cost time: 11.884153366088867
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0078698
	speed: 0.1287s/iter; left time: 5420.4912s
	iters: 200, epoch: 11 | loss: 0.0002378
	speed: 0.0230s/iter; left time: 965.5888s
	iters: 300, epoch: 11 | loss: 0.0066180
	speed: 0.0227s/iter; left time: 952.8020s
	iters: 400, epoch: 11 | loss: 0.0055107
	speed: 0.0225s/iter; left time: 938.8903s
Epoch: 11 cost time: 11.184744834899902
Epoch: 11, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.968266 --> -0.969981).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2246227
	speed: 0.1336s/iter; left time: 5561.3487s
	iters: 200, epoch: 12 | loss: 0.0044983
	speed: 0.0253s/iter; left time: 1050.0678s
	iters: 300, epoch: 12 | loss: 0.0017412
	speed: 0.0248s/iter; left time: 1028.7363s
	iters: 400, epoch: 12 | loss: 0.0008488
	speed: 0.0253s/iter; left time: 1047.7154s
Epoch: 12 cost time: 11.950977325439453
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0227922
	speed: 0.1296s/iter; left time: 5334.1050s
	iters: 200, epoch: 13 | loss: 0.0005187
	speed: 0.0250s/iter; left time: 1026.8597s
	iters: 300, epoch: 13 | loss: 0.0008584
	speed: 0.0253s/iter; left time: 1036.8324s
	iters: 400, epoch: 13 | loss: 0.0302687
	speed: 0.0262s/iter; left time: 1072.0263s
Epoch: 13 cost time: 12.245696544647217
Epoch: 13, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.969981 --> -0.972269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0003430
	speed: 0.1309s/iter; left time: 5327.8571s
	iters: 200, epoch: 14 | loss: 0.0011605
	speed: 0.0250s/iter; left time: 1016.4728s
	iters: 300, epoch: 14 | loss: 0.0007047
	speed: 0.0242s/iter; left time: 978.4560s
	iters: 400, epoch: 14 | loss: 0.0004726
	speed: 0.0247s/iter; left time: 996.4480s
Epoch: 14 cost time: 12.113975763320923
Epoch: 14, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.972269 --> -0.974556).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0034634
	speed: 0.1343s/iter; left time: 5401.6896s
	iters: 200, epoch: 15 | loss: 0.0002470
	speed: 0.0237s/iter; left time: 951.9152s
	iters: 300, epoch: 15 | loss: 0.0003784
	speed: 0.0235s/iter; left time: 941.2719s
	iters: 400, epoch: 15 | loss: 0.0000344
	speed: 0.0233s/iter; left time: 930.5476s
Epoch: 15 cost time: 11.514573097229004
Epoch: 15, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6782475
	speed: 0.1304s/iter; left time: 5185.2191s
	iters: 200, epoch: 16 | loss: 0.0001014
	speed: 0.0241s/iter; left time: 957.4129s
	iters: 300, epoch: 16 | loss: 0.0161210
	speed: 0.0244s/iter; left time: 965.6345s
	iters: 400, epoch: 16 | loss: 0.0141136
	speed: 0.0252s/iter; left time: 995.1750s
Epoch: 16 cost time: 12.084200143814087
Epoch: 16, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.974556 --> -0.976843).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0050355
	speed: 0.1281s/iter; left time: 5034.2589s
	iters: 200, epoch: 17 | loss: 0.0006519
	speed: 0.0254s/iter; left time: 994.4895s
	iters: 300, epoch: 17 | loss: 0.0079844
	speed: 0.0261s/iter; left time: 1018.7225s
	iters: 400, epoch: 17 | loss: 0.0007337
	speed: 0.0249s/iter; left time: 971.7252s
Epoch: 17 cost time: 12.287322282791138
Epoch: 17, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0001079
	speed: 0.1281s/iter; left time: 4975.4084s
	iters: 200, epoch: 18 | loss: 0.0001936
	speed: 0.0241s/iter; left time: 933.4064s
	iters: 300, epoch: 18 | loss: 0.0385735
	speed: 0.0235s/iter; left time: 907.6707s
	iters: 400, epoch: 18 | loss: 0.0021553
	speed: 0.0226s/iter; left time: 870.6446s
Epoch: 18 cost time: 11.515748262405396
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0197975
	speed: 0.1279s/iter; left time: 4907.6973s
	iters: 200, epoch: 19 | loss: 0.0002618
	speed: 0.0235s/iter; left time: 900.5349s
	iters: 300, epoch: 19 | loss: 0.0710496
	speed: 0.0224s/iter; left time: 853.5086s
	iters: 400, epoch: 19 | loss: 0.0092327
	speed: 0.0225s/iter; left time: 857.7546s
Epoch: 19 cost time: 11.339401006698608
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0074951
	speed: 0.1299s/iter; left time: 4922.2837s
	iters: 200, epoch: 20 | loss: 0.0002602
	speed: 0.0225s/iter; left time: 849.2496s
	iters: 300, epoch: 20 | loss: 0.0041219
	speed: 0.0240s/iter; left time: 904.7869s
	iters: 400, epoch: 20 | loss: 0.0000194
	speed: 0.0232s/iter; left time: 872.0917s
Epoch: 20 cost time: 11.58371353149414
Epoch: 20, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0010578
	speed: 0.1324s/iter; left time: 4956.0237s
	iters: 200, epoch: 21 | loss: 0.2809545
	speed: 0.0236s/iter; left time: 880.2725s
	iters: 300, epoch: 21 | loss: 0.0000032
	speed: 0.0242s/iter; left time: 900.5972s
	iters: 400, epoch: 21 | loss: 0.0029810
	speed: 0.0231s/iter; left time: 855.8109s
Epoch: 21 cost time: 11.498025178909302
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0001063
	speed: 0.1274s/iter; left time: 4708.5368s
	iters: 200, epoch: 22 | loss: 0.0174598
	speed: 0.0244s/iter; left time: 900.6786s
	iters: 300, epoch: 22 | loss: 0.0059361
	speed: 0.0242s/iter; left time: 888.6648s
	iters: 400, epoch: 22 | loss: 0.0012604
	speed: 0.0242s/iter; left time: 887.2830s
Epoch: 22 cost time: 11.740826606750488
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0129094
	speed: 0.1292s/iter; left time: 4714.3372s
	iters: 200, epoch: 23 | loss: 0.0008429
	speed: 0.0245s/iter; left time: 892.0623s
	iters: 300, epoch: 23 | loss: 0.0002791
	speed: 0.0244s/iter; left time: 885.9797s
	iters: 400, epoch: 23 | loss: 0.0023931
	speed: 0.0258s/iter; left time: 933.9584s
Epoch: 23 cost time: 12.01227879524231
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976843 --> -0.979987).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0007901
	speed: 0.1240s/iter; left time: 4465.5353s
	iters: 200, epoch: 24 | loss: 0.0051001
	speed: 0.0221s/iter; left time: 793.7296s
	iters: 300, epoch: 24 | loss: 0.0238670
	speed: 0.0228s/iter; left time: 816.2819s
	iters: 400, epoch: 24 | loss: 0.0019425
	speed: 0.0232s/iter; left time: 830.1835s
Epoch: 24 cost time: 11.251657009124756
Epoch: 24, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0006222
	speed: 0.1379s/iter; left time: 4901.9924s
	iters: 200, epoch: 25 | loss: 0.0337872
	speed: 0.0223s/iter; left time: 789.4915s
	iters: 300, epoch: 25 | loss: 0.0011689
	speed: 0.0259s/iter; left time: 916.3276s
	iters: 400, epoch: 25 | loss: 0.0159543
	speed: 0.0257s/iter; left time: 905.2727s
Epoch: 25 cost time: 11.98348331451416
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0046187
	speed: 0.1331s/iter; left time: 4668.6731s
	iters: 200, epoch: 26 | loss: 0.0013726
	speed: 0.0248s/iter; left time: 868.8788s
	iters: 300, epoch: 26 | loss: 0.0002942
	speed: 0.0252s/iter; left time: 878.1501s
	iters: 400, epoch: 26 | loss: 0.0026716
	speed: 0.0246s/iter; left time: 857.0015s
Epoch: 26 cost time: 12.06521987915039
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.2234046
	speed: 0.1281s/iter; left time: 4431.6734s
	iters: 200, epoch: 27 | loss: 0.0085330
	speed: 0.0233s/iter; left time: 804.1244s
	iters: 300, epoch: 27 | loss: 0.0002595
	speed: 0.0234s/iter; left time: 806.6388s
	iters: 400, epoch: 27 | loss: 0.0122047
	speed: 0.0234s/iter; left time: 804.4583s
Epoch: 27 cost time: 11.392947435379028
Epoch: 27, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0027182
	speed: 0.1274s/iter; left time: 4350.0674s
	iters: 200, epoch: 28 | loss: 0.0063089
	speed: 0.0245s/iter; left time: 833.4216s
	iters: 300, epoch: 28 | loss: 0.0101987
	speed: 0.0256s/iter; left time: 869.6076s
	iters: 400, epoch: 28 | loss: 0.0002097
	speed: 0.0245s/iter; left time: 829.3807s
Epoch: 28 cost time: 11.888039350509644
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000295
	speed: 0.1277s/iter; left time: 4298.1951s
	iters: 200, epoch: 29 | loss: 0.0116994
	speed: 0.0242s/iter; left time: 811.6141s
	iters: 300, epoch: 29 | loss: 0.0026181
	speed: 0.0227s/iter; left time: 759.3631s
	iters: 400, epoch: 29 | loss: 0.0015573
	speed: 0.0232s/iter; left time: 775.2514s
Epoch: 29 cost time: 11.497382164001465
Epoch: 29, Steps: 469 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0035288
	speed: 0.1254s/iter; left time: 4164.6108s
	iters: 200, epoch: 30 | loss: 0.0025891
	speed: 0.0225s/iter; left time: 743.8578s
	iters: 300, epoch: 30 | loss: 0.0007477
	speed: 0.0229s/iter; left time: 755.6399s
	iters: 400, epoch: 30 | loss: 0.0053065
	speed: 0.0226s/iter; left time: 742.4251s
Epoch: 30 cost time: 10.943532466888428
Epoch: 30, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0026270
	speed: 0.1282s/iter; left time: 4197.4966s
	iters: 200, epoch: 31 | loss: 0.0000600
	speed: 0.0213s/iter; left time: 693.4592s
	iters: 300, epoch: 31 | loss: 0.0002984
	speed: 0.0240s/iter; left time: 781.3454s
	iters: 400, epoch: 31 | loss: 0.0533979
	speed: 0.0242s/iter; left time: 785.3392s
Epoch: 31 cost time: 11.40957260131836
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0032737
	speed: 0.1253s/iter; left time: 4042.8218s
	iters: 200, epoch: 32 | loss: 0.0099209
	speed: 0.0252s/iter; left time: 811.6545s
	iters: 300, epoch: 32 | loss: 0.0000439
	speed: 0.0260s/iter; left time: 833.5183s
	iters: 400, epoch: 32 | loss: 0.0505788
	speed: 0.0259s/iter; left time: 827.8918s
Epoch: 32 cost time: 12.372783422470093
Epoch: 32, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.969 Test Loss: 0.199 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0026869
	speed: 0.1339s/iter; left time: 4257.5230s
	iters: 200, epoch: 33 | loss: 0.0007655
	speed: 0.0242s/iter; left time: 766.5039s
	iters: 300, epoch: 33 | loss: 0.0018967
	speed: 0.0240s/iter; left time: 759.4563s
	iters: 400, epoch: 33 | loss: 0.0188962
	speed: 0.0248s/iter; left time: 780.6349s
Epoch: 33 cost time: 12.03492283821106
Epoch: 33, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9799885648942253
model parameter : 78626
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.6839812
	speed: 0.0426s/iter; left time: 1992.0959s
	iters: 200, epoch: 1 | loss: 0.3384833
	speed: 0.0228s/iter; left time: 1063.4542s
	iters: 300, epoch: 1 | loss: 0.2389373
	speed: 0.0215s/iter; left time: 1000.9106s
	iters: 400, epoch: 1 | loss: 0.1460301
	speed: 0.0232s/iter; left time: 1079.1973s
Epoch: 1 cost time: 12.779052257537842
Epoch: 1, Steps: 469 | Train Loss: 0.636 Vali Loss: 0.229 Vali Acc: 0.945 Test Loss: 0.229 Test Acc: 0.945
Validation loss decreased (inf --> -0.945109).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0808678
	speed: 0.1318s/iter; left time: 6104.3172s
	iters: 200, epoch: 2 | loss: 0.0473780
	speed: 0.0226s/iter; left time: 1042.5545s
	iters: 300, epoch: 2 | loss: 0.0161487
	speed: 0.0217s/iter; left time: 1001.6913s
	iters: 400, epoch: 2 | loss: 0.1911719
	speed: 0.0207s/iter; left time: 951.9712s
Epoch: 2 cost time: 10.815805673599243
Epoch: 2, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.945109 --> -0.957403).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1256422
	speed: 0.1234s/iter; left time: 5657.6872s
	iters: 200, epoch: 3 | loss: 0.0163781
	speed: 0.0249s/iter; left time: 1137.9871s
	iters: 300, epoch: 3 | loss: 0.0359922
	speed: 0.0244s/iter; left time: 1112.0252s
	iters: 400, epoch: 3 | loss: 0.0664158
	speed: 0.0241s/iter; left time: 1096.9627s
Epoch: 3 cost time: 11.648832559585571
Epoch: 3, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.957403 --> -0.965407).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0325177
	speed: 0.1268s/iter; left time: 5756.9744s
	iters: 200, epoch: 4 | loss: 0.0040083
	speed: 0.0242s/iter; left time: 1097.5955s
	iters: 300, epoch: 4 | loss: 0.0890868
	speed: 0.0241s/iter; left time: 1087.0397s
	iters: 400, epoch: 4 | loss: 0.0052356
	speed: 0.0241s/iter; left time: 1085.2810s
Epoch: 4 cost time: 11.676191806793213
Epoch: 4, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
Validation loss decreased (-0.965407 --> -0.971983).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032619
	speed: 0.1330s/iter; left time: 5973.9912s
	iters: 200, epoch: 5 | loss: 0.0099813
	speed: 0.0236s/iter; left time: 1057.5359s
	iters: 300, epoch: 5 | loss: 0.0097712
	speed: 0.0246s/iter; left time: 1098.6434s
	iters: 400, epoch: 5 | loss: 0.1710365
	speed: 0.0249s/iter; left time: 1111.5894s
Epoch: 5 cost time: 11.944702386856079
Epoch: 5, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.2818126
	speed: 0.1365s/iter; left time: 6066.0234s
	iters: 200, epoch: 6 | loss: 0.0137848
	speed: 0.0237s/iter; left time: 1049.5026s
	iters: 300, epoch: 6 | loss: 0.0191023
	speed: 0.0251s/iter; left time: 1112.3902s
	iters: 400, epoch: 6 | loss: 0.0079871
	speed: 0.0248s/iter; left time: 1095.8859s
Epoch: 6 cost time: 11.931724548339844
Epoch: 6, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0088919
	speed: 0.1317s/iter; left time: 5793.4392s
	iters: 200, epoch: 7 | loss: 0.0426725
	speed: 0.0253s/iter; left time: 1112.4778s
	iters: 300, epoch: 7 | loss: 0.0171464
	speed: 0.0232s/iter; left time: 1015.7990s
	iters: 400, epoch: 7 | loss: 0.0008387
	speed: 0.0248s/iter; left time: 1081.2964s
Epoch: 7 cost time: 12.036020278930664
Epoch: 7, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.971983 --> -0.972840).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0411607
	speed: 0.1287s/iter; left time: 5600.3322s
	iters: 200, epoch: 8 | loss: 0.0074623
	speed: 0.0231s/iter; left time: 1003.3869s
	iters: 300, epoch: 8 | loss: 0.1909398
	speed: 0.0236s/iter; left time: 1020.3398s
	iters: 400, epoch: 8 | loss: 0.0148770
	speed: 0.0239s/iter; left time: 1032.8085s
Epoch: 8 cost time: 11.480632543563843
Epoch: 8, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0099789
	speed: 0.1208s/iter; left time: 5200.8394s
	iters: 200, epoch: 9 | loss: 0.0022893
	speed: 0.0233s/iter; left time: 1002.7694s
	iters: 300, epoch: 9 | loss: 0.0436768
	speed: 0.0247s/iter; left time: 1059.6847s
	iters: 400, epoch: 9 | loss: 0.0062844
	speed: 0.0240s/iter; left time: 1025.9473s
Epoch: 9 cost time: 11.427085399627686
Epoch: 9, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0008431
	speed: 0.1309s/iter; left time: 5572.8394s
	iters: 200, epoch: 10 | loss: 0.0874306
	speed: 0.0231s/iter; left time: 982.3164s
	iters: 300, epoch: 10 | loss: 0.2299612
	speed: 0.0242s/iter; left time: 1023.8791s
	iters: 400, epoch: 10 | loss: 0.0008198
	speed: 0.0228s/iter; left time: 961.9849s
Epoch: 10 cost time: 11.172420740127563
Epoch: 10, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.975413).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0031834
	speed: 0.1280s/iter; left time: 5391.2955s
	iters: 200, epoch: 11 | loss: 0.0001286
	speed: 0.0222s/iter; left time: 933.8061s
	iters: 300, epoch: 11 | loss: 0.0020919
	speed: 0.0211s/iter; left time: 883.3459s
	iters: 400, epoch: 11 | loss: 0.0008887
	speed: 0.0228s/iter; left time: 954.7529s
Epoch: 11 cost time: 10.922189712524414
Epoch: 11, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0029230
	speed: 0.1293s/iter; left time: 5385.7355s
	iters: 200, epoch: 12 | loss: 0.0009095
	speed: 0.0228s/iter; left time: 945.5406s
	iters: 300, epoch: 12 | loss: 0.1303688
	speed: 0.0232s/iter; left time: 962.2482s
	iters: 400, epoch: 12 | loss: 0.0026753
	speed: 0.0213s/iter; left time: 880.2127s
Epoch: 12 cost time: 11.140801668167114
Epoch: 12, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0009805
	speed: 0.1274s/iter; left time: 5246.7429s
	iters: 200, epoch: 13 | loss: 0.0005643
	speed: 0.0225s/iter; left time: 924.4282s
	iters: 300, epoch: 13 | loss: 0.0006592
	speed: 0.0233s/iter; left time: 954.4913s
	iters: 400, epoch: 13 | loss: 0.0002400
	speed: 0.0209s/iter; left time: 856.0776s
Epoch: 13 cost time: 10.911205768585205
Epoch: 13, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0584149
	speed: 0.1178s/iter; left time: 4795.8397s
	iters: 200, epoch: 14 | loss: 0.0015968
	speed: 0.0230s/iter; left time: 932.6372s
	iters: 300, epoch: 14 | loss: 0.0038148
	speed: 0.0233s/iter; left time: 942.9606s
	iters: 400, epoch: 14 | loss: 0.0030205
	speed: 0.0235s/iter; left time: 949.9989s
Epoch: 14 cost time: 11.198554277420044
Epoch: 14, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000085
	speed: 0.1264s/iter; left time: 5086.5221s
	iters: 200, epoch: 15 | loss: 0.0000304
	speed: 0.0213s/iter; left time: 856.7837s
	iters: 300, epoch: 15 | loss: 0.0169554
	speed: 0.0229s/iter; left time: 915.1207s
	iters: 400, epoch: 15 | loss: 0.0001353
	speed: 0.0228s/iter; left time: 910.4250s
Epoch: 15 cost time: 11.028090715408325
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.2636023
	speed: 0.1288s/iter; left time: 5123.4752s
	iters: 200, epoch: 16 | loss: 0.0069554
	speed: 0.0219s/iter; left time: 868.8395s
	iters: 300, epoch: 16 | loss: 0.0034937
	speed: 0.0213s/iter; left time: 843.4348s
	iters: 400, epoch: 16 | loss: 0.0004065
	speed: 0.0233s/iter; left time: 920.9328s
Epoch: 16 cost time: 10.90435791015625
Epoch: 16, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.977129 --> -0.979987).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0527244
	speed: 0.1306s/iter; left time: 5133.0121s
	iters: 200, epoch: 17 | loss: 0.0000603
	speed: 0.0238s/iter; left time: 932.4682s
	iters: 300, epoch: 17 | loss: 0.0115010
	speed: 0.0226s/iter; left time: 884.3822s
	iters: 400, epoch: 17 | loss: 0.0008010
	speed: 0.0243s/iter; left time: 947.2852s
Epoch: 17 cost time: 11.703228235244751
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0005404
	speed: 0.1281s/iter; left time: 4973.5935s
	iters: 200, epoch: 18 | loss: 0.0000306
	speed: 0.0244s/iter; left time: 944.2323s
	iters: 300, epoch: 18 | loss: 0.0144210
	speed: 0.0242s/iter; left time: 933.1563s
	iters: 400, epoch: 18 | loss: 0.0000341
	speed: 0.0237s/iter; left time: 911.4549s
Epoch: 18 cost time: 11.631099224090576
Epoch: 18, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0238498
	speed: 0.1287s/iter; left time: 4938.5798s
	iters: 200, epoch: 19 | loss: 0.0021662
	speed: 0.0241s/iter; left time: 920.4160s
	iters: 300, epoch: 19 | loss: 0.0146716
	speed: 0.0231s/iter; left time: 882.4814s
	iters: 400, epoch: 19 | loss: 0.0003770
	speed: 0.0226s/iter; left time: 858.3504s
Epoch: 19 cost time: 11.477209091186523
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0029373
	speed: 0.1241s/iter; left time: 4703.3696s
	iters: 200, epoch: 20 | loss: 0.2496273
	speed: 0.0213s/iter; left time: 804.9179s
	iters: 300, epoch: 20 | loss: 0.1459178
	speed: 0.0222s/iter; left time: 835.9571s
	iters: 400, epoch: 20 | loss: 0.0000441
	speed: 0.0227s/iter; left time: 854.0459s
Epoch: 20 cost time: 10.853712320327759
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.973 Test Loss: 0.174 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0042453
	speed: 0.1292s/iter; left time: 4836.1078s
	iters: 200, epoch: 21 | loss: 0.0369748
	speed: 0.0225s/iter; left time: 840.3180s
	iters: 300, epoch: 21 | loss: 0.0000149
	speed: 0.0231s/iter; left time: 859.5970s
	iters: 400, epoch: 21 | loss: 0.0453576
	speed: 0.0226s/iter; left time: 840.2634s
Epoch: 21 cost time: 11.230522394180298
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0006176
	speed: 0.1286s/iter; left time: 4752.3789s
	iters: 200, epoch: 22 | loss: 0.0000293
	speed: 0.0243s/iter; left time: 893.9085s
	iters: 300, epoch: 22 | loss: 0.0005923
	speed: 0.0222s/iter; left time: 816.7269s
	iters: 400, epoch: 22 | loss: 0.0061759
	speed: 0.0236s/iter; left time: 863.9593s
Epoch: 22 cost time: 11.28520393371582
Epoch: 22, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0018756
	speed: 0.1252s/iter; left time: 4568.3176s
	iters: 200, epoch: 23 | loss: 0.0010989
	speed: 0.0224s/iter; left time: 815.9213s
	iters: 300, epoch: 23 | loss: 0.0001338
	speed: 0.0225s/iter; left time: 815.5860s
	iters: 400, epoch: 23 | loss: 0.0010438
	speed: 0.0225s/iter; left time: 815.0517s
Epoch: 23 cost time: 11.002302885055542
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0003298
	speed: 0.1261s/iter; left time: 4542.9890s
	iters: 200, epoch: 24 | loss: 0.0002942
	speed: 0.0229s/iter; left time: 823.2044s
	iters: 300, epoch: 24 | loss: 0.0407722
	speed: 0.0223s/iter; left time: 799.2828s
	iters: 400, epoch: 24 | loss: 0.0032126
	speed: 0.0249s/iter; left time: 888.5446s
Epoch: 24 cost time: 11.380668640136719
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
Validation loss decreased (-0.979987 --> -0.982274).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0007479
	speed: 0.1260s/iter; left time: 4478.8278s
	iters: 200, epoch: 25 | loss: 0.0429932
	speed: 0.0214s/iter; left time: 759.9860s
	iters: 300, epoch: 25 | loss: 0.0040402
	speed: 0.0224s/iter; left time: 791.0305s
	iters: 400, epoch: 25 | loss: 0.2227191
	speed: 0.0235s/iter; left time: 826.7332s
Epoch: 25 cost time: 10.93412971496582
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0582007
	speed: 0.1302s/iter; left time: 4565.9461s
	iters: 200, epoch: 26 | loss: 0.0000086
	speed: 0.0231s/iter; left time: 807.4862s
	iters: 300, epoch: 26 | loss: 0.0000745
	speed: 0.0223s/iter; left time: 776.4205s
	iters: 400, epoch: 26 | loss: 0.0366512
	speed: 0.0226s/iter; left time: 784.3359s
Epoch: 26 cost time: 11.183741092681885
Epoch: 26, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0048953
	speed: 0.1315s/iter; left time: 4549.4176s
	iters: 200, epoch: 27 | loss: 0.0055530
	speed: 0.0229s/iter; left time: 790.4137s
	iters: 300, epoch: 27 | loss: 0.0000202
	speed: 0.0224s/iter; left time: 772.3089s
	iters: 400, epoch: 27 | loss: 0.0045611
	speed: 0.0210s/iter; left time: 721.7514s
Epoch: 27 cost time: 11.04857611656189
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0251307
	speed: 0.1277s/iter; left time: 4359.6157s
	iters: 200, epoch: 28 | loss: 0.0005798
	speed: 0.0239s/iter; left time: 814.3419s
	iters: 300, epoch: 28 | loss: 0.0290431
	speed: 0.0243s/iter; left time: 824.8188s
	iters: 400, epoch: 28 | loss: 0.0053729
	speed: 0.0235s/iter; left time: 795.5741s
Epoch: 28 cost time: 11.500215291976929
Epoch: 28, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.968 Test Loss: 0.208 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0002428
	speed: 0.1317s/iter; left time: 4434.4142s
	iters: 200, epoch: 29 | loss: 0.0001461
	speed: 0.0250s/iter; left time: 838.7728s
	iters: 300, epoch: 29 | loss: 0.0224665
	speed: 0.0235s/iter; left time: 787.4511s
	iters: 400, epoch: 29 | loss: 0.0584652
	speed: 0.0225s/iter; left time: 750.3043s
Epoch: 29 cost time: 11.713550567626953
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0018364
	speed: 0.1189s/iter; left time: 3945.8289s
	iters: 200, epoch: 30 | loss: 0.0001454
	speed: 0.0206s/iter; left time: 682.7883s
	iters: 300, epoch: 30 | loss: 0.0007200
	speed: 0.0216s/iter; left time: 712.8146s
	iters: 400, epoch: 30 | loss: 0.0064067
	speed: 0.0217s/iter; left time: 715.2560s
Epoch: 30 cost time: 10.466458320617676
Epoch: 30, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0272899
	speed: 0.1302s/iter; left time: 4260.9689s
	iters: 200, epoch: 31 | loss: 0.0000818
	speed: 0.0226s/iter; left time: 737.4909s
	iters: 300, epoch: 31 | loss: 0.0001300
	speed: 0.0215s/iter; left time: 699.5592s
	iters: 400, epoch: 31 | loss: 0.0004344
	speed: 0.0218s/iter; left time: 707.6672s
Epoch: 31 cost time: 10.936107158660889
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0178290
	speed: 0.1262s/iter; left time: 4070.9599s
	iters: 200, epoch: 32 | loss: 0.0003939
	speed: 0.0226s/iter; left time: 726.2421s
	iters: 300, epoch: 32 | loss: 0.0000339
	speed: 0.0222s/iter; left time: 711.3452s
	iters: 400, epoch: 32 | loss: 0.0959809
	speed: 0.0211s/iter; left time: 673.7895s
Epoch: 32 cost time: 10.65779995918274
Epoch: 32, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0000848
	speed: 0.1301s/iter; left time: 4136.1549s
	iters: 200, epoch: 33 | loss: 0.0003042
	speed: 0.0231s/iter; left time: 731.4260s
	iters: 300, epoch: 33 | loss: 0.0084360
	speed: 0.0180s/iter; left time: 569.6637s
	iters: 400, epoch: 33 | loss: 0.2648152
	speed: 0.0175s/iter; left time: 552.0942s
Epoch: 33 cost time: 9.989740133285522
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.978 Test Loss: 0.171 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0000893
	speed: 0.0982s/iter; left time: 3075.4968s
	iters: 200, epoch: 34 | loss: 0.0018079
	speed: 0.0194s/iter; left time: 604.5420s
	iters: 300, epoch: 34 | loss: 0.0001012
	speed: 0.0202s/iter; left time: 629.5786s
	iters: 400, epoch: 34 | loss: 0.0001680
	speed: 0.0200s/iter; left time: 621.6192s
Epoch: 34 cost time: 9.762576341629028
Epoch: 34, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.982275586049171
model parameter : 78626
model size : 2.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 0.9810473
	speed: 0.0439s/iter; left time: 2056.3718s
	iters: 200, epoch: 1 | loss: 0.2254439
	speed: 0.0248s/iter; left time: 1159.5267s
	iters: 300, epoch: 1 | loss: 0.3073954
	speed: 0.0251s/iter; left time: 1170.7966s
	iters: 400, epoch: 1 | loss: 0.2991688
	speed: 0.0243s/iter; left time: 1128.5488s
Epoch: 1 cost time: 13.50387167930603
Epoch: 1, Steps: 469 | Train Loss: 0.599 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
Validation loss decreased (inf --> -0.924526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1224649
	speed: 0.1256s/iter; left time: 5818.5897s
	iters: 200, epoch: 2 | loss: 0.0461441
	speed: 0.0240s/iter; left time: 1108.2019s
	iters: 300, epoch: 2 | loss: 0.0279387
	speed: 0.0241s/iter; left time: 1113.0649s
	iters: 400, epoch: 2 | loss: 0.0156435
	speed: 0.0251s/iter; left time: 1155.0319s
Epoch: 2 cost time: 11.860993146896362
Epoch: 2, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.924526 --> -0.959404).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0551661
	speed: 0.1344s/iter; left time: 6166.2790s
	iters: 200, epoch: 3 | loss: 0.0689132
	speed: 0.0253s/iter; left time: 1157.4027s
	iters: 300, epoch: 3 | loss: 0.1405140
	speed: 0.0244s/iter; left time: 1114.4618s
	iters: 400, epoch: 3 | loss: 0.0268376
	speed: 0.0241s/iter; left time: 1098.8849s
Epoch: 3 cost time: 11.708070993423462
Epoch: 3, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.959404 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1175873
	speed: 0.1254s/iter; left time: 5694.1526s
	iters: 200, epoch: 4 | loss: 0.0134184
	speed: 0.0246s/iter; left time: 1112.2728s
	iters: 300, epoch: 4 | loss: 0.0053779
	speed: 0.0247s/iter; left time: 1115.5473s
	iters: 400, epoch: 4 | loss: 0.0068860
	speed: 0.0245s/iter; left time: 1103.2887s
Epoch: 4 cost time: 11.618311405181885
Epoch: 4, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.962263 --> -0.968266).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1350349
	speed: 0.1242s/iter; left time: 5579.0220s
	iters: 200, epoch: 5 | loss: 0.1043107
	speed: 0.0236s/iter; left time: 1057.8465s
	iters: 300, epoch: 5 | loss: 0.1044803
	speed: 0.0238s/iter; left time: 1062.4354s
	iters: 400, epoch: 5 | loss: 0.0289842
	speed: 0.0247s/iter; left time: 1101.2414s
Epoch: 5 cost time: 11.584684371948242
Epoch: 5, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0191905
	speed: 0.1283s/iter; left time: 5702.6408s
	iters: 200, epoch: 6 | loss: 0.0099518
	speed: 0.0230s/iter; left time: 1021.9457s
	iters: 300, epoch: 6 | loss: 0.0838539
	speed: 0.0234s/iter; left time: 1036.3458s
	iters: 400, epoch: 6 | loss: 0.0051144
	speed: 0.0227s/iter; left time: 1004.2119s
Epoch: 6 cost time: 11.277795553207397
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0396483
	speed: 0.1240s/iter; left time: 5452.2697s
	iters: 200, epoch: 7 | loss: 0.0583084
	speed: 0.0249s/iter; left time: 1092.3683s
	iters: 300, epoch: 7 | loss: 0.0294295
	speed: 0.0250s/iter; left time: 1093.0160s
	iters: 400, epoch: 7 | loss: 0.0047985
	speed: 0.0237s/iter; left time: 1033.6068s
Epoch: 7 cost time: 11.805342674255371
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.968266 --> -0.969124).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0164418
	speed: 0.1279s/iter; left time: 5566.9773s
	iters: 200, epoch: 8 | loss: 0.0164092
	speed: 0.0232s/iter; left time: 1009.1034s
	iters: 300, epoch: 8 | loss: 0.0045368
	speed: 0.0242s/iter; left time: 1047.8952s
	iters: 400, epoch: 8 | loss: 0.0203655
	speed: 0.0241s/iter; left time: 1042.9604s
Epoch: 8 cost time: 11.66526484489441
Epoch: 8, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.969124 --> -0.972841).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0075780
	speed: 0.1291s/iter; left time: 5558.2885s
	iters: 200, epoch: 9 | loss: 0.0099938
	speed: 0.0241s/iter; left time: 1033.1504s
	iters: 300, epoch: 9 | loss: 0.0523572
	speed: 0.0244s/iter; left time: 1046.8062s
	iters: 400, epoch: 9 | loss: 0.0045596
	speed: 0.0247s/iter; left time: 1054.9697s
Epoch: 9 cost time: 11.869322538375854
Epoch: 9, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.972841 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0636370
	speed: 0.1306s/iter; left time: 5559.8903s
	iters: 200, epoch: 10 | loss: 0.0068823
	speed: 0.0256s/iter; left time: 1089.0098s
	iters: 300, epoch: 10 | loss: 0.0433120
	speed: 0.0261s/iter; left time: 1105.8906s
	iters: 400, epoch: 10 | loss: 0.0053595
	speed: 0.0256s/iter; left time: 1083.9640s
Epoch: 10 cost time: 12.395108461380005
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.974270).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0063666
	speed: 0.1326s/iter; left time: 5585.0130s
	iters: 200, epoch: 11 | loss: 0.0530963
	speed: 0.0247s/iter; left time: 1038.5899s
	iters: 300, epoch: 11 | loss: 0.0034756
	speed: 0.0253s/iter; left time: 1060.5746s
	iters: 400, epoch: 11 | loss: 0.0093569
	speed: 0.0234s/iter; left time: 980.1453s
Epoch: 11 cost time: 11.968888521194458
Epoch: 11, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0042412
	speed: 0.1334s/iter; left time: 5555.4736s
	iters: 200, epoch: 12 | loss: 0.0042548
	speed: 0.0230s/iter; left time: 956.2477s
	iters: 300, epoch: 12 | loss: 0.0033522
	speed: 0.0238s/iter; left time: 987.5239s
	iters: 400, epoch: 12 | loss: 0.0065494
	speed: 0.0236s/iter; left time: 976.2899s
Epoch: 12 cost time: 11.269237279891968
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0019716
	speed: 0.1261s/iter; left time: 5192.3340s
	iters: 200, epoch: 13 | loss: 0.0361966
	speed: 0.0243s/iter; left time: 999.0723s
	iters: 300, epoch: 13 | loss: 0.0034711
	speed: 0.0243s/iter; left time: 996.1801s
	iters: 400, epoch: 13 | loss: 0.0172317
	speed: 0.0244s/iter; left time: 997.4756s
Epoch: 13 cost time: 11.57307505607605
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.2148345
	speed: 0.1221s/iter; left time: 4971.1068s
	iters: 200, epoch: 14 | loss: 0.0444256
	speed: 0.0238s/iter; left time: 965.3866s
	iters: 300, epoch: 14 | loss: 0.0099496
	speed: 0.0237s/iter; left time: 961.8052s
	iters: 400, epoch: 14 | loss: 0.0158510
	speed: 0.0235s/iter; left time: 949.1018s
Epoch: 14 cost time: 11.579669952392578
Epoch: 14, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975699).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.2115647
	speed: 0.1248s/iter; left time: 5020.6122s
	iters: 200, epoch: 15 | loss: 0.0239045
	speed: 0.0239s/iter; left time: 960.3438s
	iters: 300, epoch: 15 | loss: 0.0099622
	speed: 0.0236s/iter; left time: 943.2736s
	iters: 400, epoch: 15 | loss: 0.0007737
	speed: 0.0244s/iter; left time: 974.1635s
Epoch: 15 cost time: 11.614900350570679
Epoch: 15, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.975699 --> -0.977701).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0121959
	speed: 0.1207s/iter; left time: 4801.1275s
	iters: 200, epoch: 16 | loss: 0.0011638
	speed: 0.0233s/iter; left time: 922.7688s
	iters: 300, epoch: 16 | loss: 0.0002813
	speed: 0.0242s/iter; left time: 958.4693s
	iters: 400, epoch: 16 | loss: 0.0143946
	speed: 0.0233s/iter; left time: 917.9125s
Epoch: 16 cost time: 11.305135250091553
Epoch: 16, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0021240
	speed: 0.1308s/iter; left time: 5140.8760s
	iters: 200, epoch: 17 | loss: 0.0214843
	speed: 0.0247s/iter; left time: 969.6397s
	iters: 300, epoch: 17 | loss: 0.0126890
	speed: 0.0221s/iter; left time: 865.9656s
	iters: 400, epoch: 17 | loss: 0.0005031
	speed: 0.0237s/iter; left time: 922.5862s
Epoch: 17 cost time: 11.507333755493164
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.978272).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0667575
	speed: 0.1342s/iter; left time: 5212.1375s
	iters: 200, epoch: 18 | loss: 0.0233843
	speed: 0.0248s/iter; left time: 959.1217s
	iters: 300, epoch: 18 | loss: 0.0005043
	speed: 0.0242s/iter; left time: 933.3791s
	iters: 400, epoch: 18 | loss: 0.0067569
	speed: 0.0228s/iter; left time: 879.0331s
Epoch: 18 cost time: 11.890382528305054
Epoch: 18, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0139016
	speed: 0.1303s/iter; left time: 4999.6976s
	iters: 200, epoch: 19 | loss: 0.0041551
	speed: 0.0244s/iter; left time: 932.1494s
	iters: 300, epoch: 19 | loss: 0.0854681
	speed: 0.0243s/iter; left time: 929.0583s
	iters: 400, epoch: 19 | loss: 0.0000525
	speed: 0.0255s/iter; left time: 970.1354s
Epoch: 19 cost time: 12.045137643814087
Epoch: 19, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
Validation loss decreased (-0.978272 --> -0.981989).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.2507355
	speed: 0.1323s/iter; left time: 5014.6641s
	iters: 200, epoch: 20 | loss: 0.0004362
	speed: 0.0261s/iter; left time: 984.9531s
	iters: 300, epoch: 20 | loss: 0.4040634
	speed: 0.0252s/iter; left time: 949.4786s
	iters: 400, epoch: 20 | loss: 0.0001476
	speed: 0.0242s/iter; left time: 908.8966s
Epoch: 20 cost time: 12.104811191558838
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0032071
	speed: 0.1267s/iter; left time: 4740.0472s
	iters: 200, epoch: 21 | loss: 0.0081214
	speed: 0.0249s/iter; left time: 928.7043s
	iters: 300, epoch: 21 | loss: 0.0009039
	speed: 0.0248s/iter; left time: 922.0651s
	iters: 400, epoch: 21 | loss: 0.0343564
	speed: 0.0251s/iter; left time: 932.3480s
Epoch: 21 cost time: 11.794369220733643
Epoch: 21, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0044963
	speed: 0.1253s/iter; left time: 4628.3779s
	iters: 200, epoch: 22 | loss: 0.0012875
	speed: 0.0222s/iter; left time: 816.9481s
	iters: 300, epoch: 22 | loss: 0.0001526
	speed: 0.0236s/iter; left time: 868.7767s
	iters: 400, epoch: 22 | loss: 0.0206141
	speed: 0.0244s/iter; left time: 893.5569s
Epoch: 22 cost time: 11.35122299194336
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0008231
	speed: 0.1293s/iter; left time: 4718.7516s
	iters: 200, epoch: 23 | loss: 0.0190796
	speed: 0.0219s/iter; left time: 797.5847s
	iters: 300, epoch: 23 | loss: 0.0010861
	speed: 0.0242s/iter; left time: 877.3549s
	iters: 400, epoch: 23 | loss: 0.0042368
	speed: 0.0227s/iter; left time: 820.7250s
Epoch: 23 cost time: 11.152772665023804
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0048566
	speed: 0.1183s/iter; left time: 4261.8977s
	iters: 200, epoch: 24 | loss: 0.0002257
	speed: 0.0250s/iter; left time: 899.5397s
	iters: 300, epoch: 24 | loss: 0.3064665
	speed: 0.0266s/iter; left time: 954.1251s
	iters: 400, epoch: 24 | loss: 0.0002003
	speed: 0.0247s/iter; left time: 882.4060s
Epoch: 24 cost time: 12.103149175643921
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0075114
	speed: 0.1262s/iter; left time: 4485.1989s
	iters: 200, epoch: 25 | loss: 0.0949693
	speed: 0.0239s/iter; left time: 848.5708s
	iters: 300, epoch: 25 | loss: 0.0010293
	speed: 0.0244s/iter; left time: 864.0726s
	iters: 400, epoch: 25 | loss: 0.0205263
	speed: 0.0238s/iter; left time: 839.1902s
Epoch: 25 cost time: 11.635902881622314
Epoch: 25, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0016788
	speed: 0.1272s/iter; left time: 4463.1274s
	iters: 200, epoch: 26 | loss: 0.0000117
	speed: 0.0224s/iter; left time: 784.9182s
	iters: 300, epoch: 26 | loss: 0.0000238
	speed: 0.0229s/iter; left time: 800.1509s
	iters: 400, epoch: 26 | loss: 0.0070125
	speed: 0.0233s/iter; left time: 810.5898s
Epoch: 26 cost time: 11.308019161224365
Epoch: 26, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0025539
	speed: 0.1294s/iter; left time: 4478.9496s
	iters: 200, epoch: 27 | loss: 0.0010176
	speed: 0.0248s/iter; left time: 855.2660s
	iters: 300, epoch: 27 | loss: 0.0000823
	speed: 0.0258s/iter; left time: 886.5897s
	iters: 400, epoch: 27 | loss: 0.0383126
	speed: 0.0272s/iter; left time: 933.7902s
Epoch: 27 cost time: 12.289923429489136
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.984 Test Loss: 0.106 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983990).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000949
	speed: 0.1331s/iter; left time: 4542.9854s
	iters: 200, epoch: 28 | loss: 0.0016418
	speed: 0.0260s/iter; left time: 885.2412s
	iters: 300, epoch: 28 | loss: 0.0013724
	speed: 0.0264s/iter; left time: 896.5462s
	iters: 400, epoch: 28 | loss: 0.0001160
	speed: 0.0252s/iter; left time: 851.1580s
Epoch: 28 cost time: 12.363522291183472
Epoch: 28, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0161691
	speed: 0.1309s/iter; left time: 4408.4109s
	iters: 200, epoch: 29 | loss: 0.0016913
	speed: 0.0234s/iter; left time: 784.9347s
	iters: 300, epoch: 29 | loss: 0.1973531
	speed: 0.0239s/iter; left time: 799.6140s
	iters: 400, epoch: 29 | loss: 0.0015767
	speed: 0.0241s/iter; left time: 804.6443s
Epoch: 29 cost time: 11.746445655822754
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0029278
	speed: 0.1299s/iter; left time: 4313.2361s
	iters: 200, epoch: 30 | loss: 0.0011589
	speed: 0.0255s/iter; left time: 843.6883s
	iters: 300, epoch: 30 | loss: 0.0008324
	speed: 0.0255s/iter; left time: 842.3300s
	iters: 400, epoch: 30 | loss: 0.0000102
	speed: 0.0255s/iter; left time: 840.5927s
Epoch: 30 cost time: 12.23026180267334
Epoch: 30, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0010174
	speed: 0.1283s/iter; left time: 4199.9729s
	iters: 200, epoch: 31 | loss: 0.0025965
	speed: 0.0239s/iter; left time: 779.6011s
	iters: 300, epoch: 31 | loss: 0.0000568
	speed: 0.0233s/iter; left time: 757.9709s
	iters: 400, epoch: 31 | loss: 0.0011487
	speed: 0.0233s/iter; left time: 755.1618s
Epoch: 31 cost time: 11.515572786331177
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0039799
	speed: 0.1278s/iter; left time: 4124.1482s
	iters: 200, epoch: 32 | loss: 0.0004565
	speed: 0.0230s/iter; left time: 740.2124s
	iters: 300, epoch: 32 | loss: 0.0000891
	speed: 0.0227s/iter; left time: 728.4763s
	iters: 400, epoch: 32 | loss: 0.0005778
	speed: 0.0237s/iter; left time: 757.0600s
Epoch: 32 cost time: 11.329482316970825
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.5704488
	speed: 0.1259s/iter; left time: 4002.0574s
	iters: 200, epoch: 33 | loss: 0.0001595
	speed: 0.0237s/iter; left time: 749.7274s
	iters: 300, epoch: 33 | loss: 0.0016526
	speed: 0.0226s/iter; left time: 714.6591s
	iters: 400, epoch: 33 | loss: 0.0000441
	speed: 0.0241s/iter; left time: 758.2877s
Epoch: 33 cost time: 11.401881694793701
Epoch: 33, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0087475
	speed: 0.1293s/iter; left time: 4051.4553s
	iters: 200, epoch: 34 | loss: 0.0000175
	speed: 0.0242s/iter; left time: 755.7062s
	iters: 300, epoch: 34 | loss: 0.0114772
	speed: 0.0240s/iter; left time: 747.3386s
	iters: 400, epoch: 34 | loss: 0.0000224
	speed: 0.0238s/iter; left time: 739.1416s
Epoch: 34 cost time: 11.681525230407715
Epoch: 34, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.4956460
	speed: 0.1321s/iter; left time: 4077.2692s
	iters: 200, epoch: 35 | loss: 0.0000536
	speed: 0.0234s/iter; left time: 720.9546s
	iters: 300, epoch: 35 | loss: 0.0007214
	speed: 0.0235s/iter; left time: 721.2124s
	iters: 400, epoch: 35 | loss: 0.0029754
	speed: 0.0241s/iter; left time: 736.1536s
Epoch: 35 cost time: 11.526533126831055
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0020643
	speed: 0.1342s/iter; left time: 4077.2598s
	iters: 200, epoch: 36 | loss: 0.0401683
	speed: 0.0243s/iter; left time: 735.7593s
	iters: 300, epoch: 36 | loss: 0.0019248
	speed: 0.0244s/iter; left time: 736.2227s
	iters: 400, epoch: 36 | loss: 0.1345387
	speed: 0.0242s/iter; left time: 727.6116s
Epoch: 36 cost time: 11.858439207077026
Epoch: 36, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0016004
	speed: 0.1352s/iter; left time: 4046.1751s
	iters: 200, epoch: 37 | loss: 0.0000729
	speed: 0.0259s/iter; left time: 771.8088s
	iters: 300, epoch: 37 | loss: 0.0003750
	speed: 0.0257s/iter; left time: 764.6848s
	iters: 400, epoch: 37 | loss: 0.0000769
	speed: 0.0260s/iter; left time: 770.4032s
Epoch: 37 cost time: 12.308857679367065
Epoch: 37, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 62242
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0246167
	speed: 0.0439s/iter; left time: 2056.4304s
	iters: 200, epoch: 1 | loss: 0.1947373
	speed: 0.0253s/iter; left time: 1181.6781s
	iters: 300, epoch: 1 | loss: 0.3094431
	speed: 0.0265s/iter; left time: 1233.8660s
	iters: 400, epoch: 1 | loss: 0.3115769
	speed: 0.0259s/iter; left time: 1205.2267s
Epoch: 1 cost time: 13.950514554977417
Epoch: 1, Steps: 469 | Train Loss: 0.610 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
Validation loss decreased (inf --> -0.925383).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0933604
	speed: 0.1290s/iter; left time: 5975.4311s
	iters: 200, epoch: 2 | loss: 0.0463586
	speed: 0.0230s/iter; left time: 1064.2352s
	iters: 300, epoch: 2 | loss: 0.0298874
	speed: 0.0243s/iter; left time: 1121.1376s
	iters: 400, epoch: 2 | loss: 0.0253226
	speed: 0.0248s/iter; left time: 1143.4509s
Epoch: 2 cost time: 11.589868545532227
Epoch: 2, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
Validation loss decreased (-0.925383 --> -0.958260).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0690376
	speed: 0.1300s/iter; left time: 5962.0922s
	iters: 200, epoch: 3 | loss: 0.0712344
	speed: 0.0251s/iter; left time: 1146.7194s
	iters: 300, epoch: 3 | loss: 0.1224557
	speed: 0.0264s/iter; left time: 1203.7685s
	iters: 400, epoch: 3 | loss: 0.0185859
	speed: 0.0237s/iter; left time: 1077.9571s
Epoch: 3 cost time: 11.91041111946106
Epoch: 3, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
Validation loss decreased (-0.958260 --> -0.966265).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1009056
	speed: 0.1306s/iter; left time: 5930.2926s
	iters: 200, epoch: 4 | loss: 0.0067213
	speed: 0.0243s/iter; left time: 1102.6348s
	iters: 300, epoch: 4 | loss: 0.0050071
	speed: 0.0252s/iter; left time: 1137.4917s
	iters: 400, epoch: 4 | loss: 0.0056082
	speed: 0.0246s/iter; left time: 1107.1452s
Epoch: 4 cost time: 12.022394180297852
Epoch: 4, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.966265 --> -0.967695).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0667483
	speed: 0.1298s/iter; left time: 5830.9753s
	iters: 200, epoch: 5 | loss: 0.2616483
	speed: 0.0238s/iter; left time: 1068.1310s
	iters: 300, epoch: 5 | loss: 0.0617640
	speed: 0.0243s/iter; left time: 1087.4620s
	iters: 400, epoch: 5 | loss: 0.0051627
	speed: 0.0244s/iter; left time: 1088.8758s
Epoch: 5 cost time: 11.883891820907593
Epoch: 5, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.967695 --> -0.971125).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0122948
	speed: 0.1323s/iter; left time: 5881.9406s
	iters: 200, epoch: 6 | loss: 0.0021900
	speed: 0.0240s/iter; left time: 1064.4018s
	iters: 300, epoch: 6 | loss: 0.1427653
	speed: 0.0255s/iter; left time: 1127.3669s
	iters: 400, epoch: 6 | loss: 0.0032080
	speed: 0.0251s/iter; left time: 1108.9004s
Epoch: 6 cost time: 11.998355388641357
Epoch: 6, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0437691
	speed: 0.1296s/iter; left time: 5698.7939s
	iters: 200, epoch: 7 | loss: 0.1111979
	speed: 0.0238s/iter; left time: 1044.3369s
	iters: 300, epoch: 7 | loss: 0.0165582
	speed: 0.0245s/iter; left time: 1070.9115s
	iters: 400, epoch: 7 | loss: 0.0127522
	speed: 0.0253s/iter; left time: 1104.6445s
Epoch: 7 cost time: 11.967952013015747
Epoch: 7, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0128752
	speed: 0.1368s/iter; left time: 5953.1683s
	iters: 200, epoch: 8 | loss: 0.0299434
	speed: 0.0237s/iter; left time: 1029.6534s
	iters: 300, epoch: 8 | loss: 0.0023328
	speed: 0.0242s/iter; left time: 1049.9107s
	iters: 400, epoch: 8 | loss: 0.0023226
	speed: 0.0245s/iter; left time: 1060.9898s
Epoch: 8 cost time: 11.823921203613281
Epoch: 8, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0019169
	speed: 0.1355s/iter; left time: 5833.1829s
	iters: 200, epoch: 9 | loss: 0.0122684
	speed: 0.0233s/iter; left time: 1001.3392s
	iters: 300, epoch: 9 | loss: 0.0917943
	speed: 0.0245s/iter; left time: 1048.6965s
	iters: 400, epoch: 9 | loss: 0.0130789
	speed: 0.0260s/iter; left time: 1113.0772s
Epoch: 9 cost time: 12.128951072692871
Epoch: 9, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.971125 --> -0.971411).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0497841
	speed: 0.1298s/iter; left time: 5525.3424s
	iters: 200, epoch: 10 | loss: 0.0002972
	speed: 0.0265s/iter; left time: 1126.2760s
	iters: 300, epoch: 10 | loss: 0.0072793
	speed: 0.0263s/iter; left time: 1116.3566s
	iters: 400, epoch: 10 | loss: 0.0002129
	speed: 0.0265s/iter; left time: 1118.8209s
Epoch: 10 cost time: 12.631276607513428
Epoch: 10, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0453424
	speed: 0.1268s/iter; left time: 5337.8255s
	iters: 200, epoch: 11 | loss: 0.0066776
	speed: 0.0239s/iter; left time: 1004.5731s
	iters: 300, epoch: 11 | loss: 0.0014473
	speed: 0.0250s/iter; left time: 1047.9843s
	iters: 400, epoch: 11 | loss: 0.0006827
	speed: 0.0235s/iter; left time: 984.0681s
Epoch: 11 cost time: 11.743815660476685
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0013688
	speed: 0.1270s/iter; left time: 5287.5750s
	iters: 200, epoch: 12 | loss: 0.0062607
	speed: 0.0239s/iter; left time: 992.9523s
	iters: 300, epoch: 12 | loss: 0.0070553
	speed: 0.0241s/iter; left time: 999.7815s
	iters: 400, epoch: 12 | loss: 0.0011927
	speed: 0.0250s/iter; left time: 1034.7564s
Epoch: 12 cost time: 11.767313718795776
Epoch: 12, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0497005
	speed: 0.1321s/iter; left time: 5436.9525s
	iters: 200, epoch: 13 | loss: 0.0140854
	speed: 0.0258s/iter; left time: 1057.8031s
	iters: 300, epoch: 13 | loss: 0.0019994
	speed: 0.0254s/iter; left time: 1042.4721s
	iters: 400, epoch: 13 | loss: 0.0008724
	speed: 0.0235s/iter; left time: 962.3903s
Epoch: 13 cost time: 11.97614049911499
Epoch: 13, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.972268).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.1186161
	speed: 0.1319s/iter; left time: 5370.7357s
	iters: 200, epoch: 14 | loss: 0.1815988
	speed: 0.0251s/iter; left time: 1019.3916s
	iters: 300, epoch: 14 | loss: 0.0246693
	speed: 0.0244s/iter; left time: 986.3870s
	iters: 400, epoch: 14 | loss: 0.0186368
	speed: 0.0244s/iter; left time: 987.4073s
Epoch: 14 cost time: 11.786272525787354
Epoch: 14, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.972268 --> -0.973126).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0727063
	speed: 0.1310s/iter; left time: 5269.6091s
	iters: 200, epoch: 15 | loss: 0.0020833
	speed: 0.0238s/iter; left time: 956.6205s
	iters: 300, epoch: 15 | loss: 0.0076999
	speed: 0.0233s/iter; left time: 932.4606s
	iters: 400, epoch: 15 | loss: 0.0136196
	speed: 0.0241s/iter; left time: 962.5483s
Epoch: 15 cost time: 11.6874361038208
Epoch: 15, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
Validation loss decreased (-0.973126 --> -0.979416).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0147635
	speed: 0.1338s/iter; left time: 5319.1601s
	iters: 200, epoch: 16 | loss: 0.0004954
	speed: 0.0243s/iter; left time: 963.7988s
	iters: 300, epoch: 16 | loss: 0.0016086
	speed: 0.0246s/iter; left time: 974.1589s
	iters: 400, epoch: 16 | loss: 0.0002144
	speed: 0.0248s/iter; left time: 979.7844s
Epoch: 16 cost time: 11.842928171157837
Epoch: 16, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0480124
	speed: 0.1207s/iter; left time: 4742.1828s
	iters: 200, epoch: 17 | loss: 0.0048493
	speed: 0.0258s/iter; left time: 1011.8461s
	iters: 300, epoch: 17 | loss: 0.0014834
	speed: 0.0265s/iter; left time: 1037.1446s
	iters: 400, epoch: 17 | loss: 0.0023156
	speed: 0.0269s/iter; left time: 1047.2711s
Epoch: 17 cost time: 12.466663360595703
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1263491
	speed: 0.1299s/iter; left time: 5042.6627s
	iters: 200, epoch: 18 | loss: 0.0643474
	speed: 0.0230s/iter; left time: 892.3568s
	iters: 300, epoch: 18 | loss: 0.0008804
	speed: 0.0236s/iter; left time: 913.1571s
	iters: 400, epoch: 18 | loss: 0.0221803
	speed: 0.0247s/iter; left time: 953.5147s
Epoch: 18 cost time: 11.857727527618408
Epoch: 18, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0007503
	speed: 0.1290s/iter; left time: 4946.5003s
	iters: 200, epoch: 19 | loss: 0.0324250
	speed: 0.0255s/iter; left time: 977.2918s
	iters: 300, epoch: 19 | loss: 0.0009663
	speed: 0.0246s/iter; left time: 939.7235s
	iters: 400, epoch: 19 | loss: 0.0001407
	speed: 0.0247s/iter; left time: 940.1441s
Epoch: 19 cost time: 12.276888370513916
Epoch: 19, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0010579
	speed: 0.1318s/iter; left time: 4994.6279s
	iters: 200, epoch: 20 | loss: 0.0001761
	speed: 0.0264s/iter; left time: 997.1925s
	iters: 300, epoch: 20 | loss: 0.4486774
	speed: 0.0244s/iter; left time: 921.0468s
	iters: 400, epoch: 20 | loss: 0.0009534
	speed: 0.0247s/iter; left time: 929.9790s
Epoch: 20 cost time: 12.15143084526062
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0085927
	speed: 0.1268s/iter; left time: 4745.7458s
	iters: 200, epoch: 21 | loss: 0.0120671
	speed: 0.0246s/iter; left time: 917.0445s
	iters: 300, epoch: 21 | loss: 0.0011385
	speed: 0.0227s/iter; left time: 845.8543s
	iters: 400, epoch: 21 | loss: 0.0051088
	speed: 0.0255s/iter; left time: 947.0004s
Epoch: 21 cost time: 11.735896587371826
Epoch: 21, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0023616
	speed: 0.1362s/iter; left time: 5032.7049s
	iters: 200, epoch: 22 | loss: 0.0000856
	speed: 0.0237s/iter; left time: 872.0749s
	iters: 300, epoch: 22 | loss: 0.0014554
	speed: 0.0237s/iter; left time: 872.1036s
	iters: 400, epoch: 22 | loss: 0.0710873
	speed: 0.0236s/iter; left time: 865.2797s
Epoch: 22 cost time: 11.651816606521606
Epoch: 22, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0049062
	speed: 0.1359s/iter; left time: 4959.1236s
	iters: 200, epoch: 23 | loss: 0.0015980
	speed: 0.0236s/iter; left time: 858.1029s
	iters: 300, epoch: 23 | loss: 0.0039458
	speed: 0.0251s/iter; left time: 909.1957s
	iters: 400, epoch: 23 | loss: 0.0004357
	speed: 0.0236s/iter; left time: 855.5774s
Epoch: 23 cost time: 11.808084726333618
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0348768
	speed: 0.1327s/iter; left time: 4778.0577s
	iters: 200, epoch: 24 | loss: 0.0000432
	speed: 0.0251s/iter; left time: 900.7513s
	iters: 300, epoch: 24 | loss: 0.0049505
	speed: 0.0250s/iter; left time: 895.1768s
	iters: 400, epoch: 24 | loss: 0.0000518
	speed: 0.0244s/iter; left time: 869.6754s
Epoch: 24 cost time: 12.074634552001953
Epoch: 24, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0165329
	speed: 0.1321s/iter; left time: 4693.8157s
	iters: 200, epoch: 25 | loss: 0.0102685
	speed: 0.0239s/iter; left time: 848.2902s
	iters: 300, epoch: 25 | loss: 0.0279800
	speed: 0.0240s/iter; left time: 847.7573s
	iters: 400, epoch: 25 | loss: 0.0012039
	speed: 0.0255s/iter; left time: 897.7906s
Epoch: 25 cost time: 11.905254125595093
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 62242
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1310965
	speed: 0.0422s/iter; left time: 1974.0717s
	iters: 200, epoch: 1 | loss: 0.1995328
	speed: 0.0237s/iter; left time: 1107.9311s
	iters: 300, epoch: 1 | loss: 0.2486107
	speed: 0.0226s/iter; left time: 1053.8576s
	iters: 400, epoch: 1 | loss: 0.2248759
	speed: 0.0246s/iter; left time: 1144.4900s
Epoch: 1 cost time: 13.04524827003479
Epoch: 1, Steps: 469 | Train Loss: 0.633 Vali Loss: 0.218 Vali Acc: 0.949 Test Loss: 0.218 Test Acc: 0.949
Validation loss decreased (inf --> -0.949397).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0744330
	speed: 0.1289s/iter; left time: 5971.9978s
	iters: 200, epoch: 2 | loss: 0.0368676
	speed: 0.0235s/iter; left time: 1085.4134s
	iters: 300, epoch: 2 | loss: 0.0424567
	speed: 0.0228s/iter; left time: 1053.7354s
	iters: 400, epoch: 2 | loss: 0.0065095
	speed: 0.0254s/iter; left time: 1170.4624s
Epoch: 2 cost time: 11.664135456085205
Epoch: 2, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
Validation loss decreased (-0.949397 --> -0.965693).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1311451
	speed: 0.1274s/iter; left time: 5842.0766s
	iters: 200, epoch: 3 | loss: 0.0206624
	speed: 0.0238s/iter; left time: 1087.8575s
	iters: 300, epoch: 3 | loss: 0.1690066
	speed: 0.0227s/iter; left time: 1038.2491s
	iters: 400, epoch: 3 | loss: 0.0169897
	speed: 0.0232s/iter; left time: 1058.4346s
Epoch: 3 cost time: 11.443382978439331
Epoch: 3, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.965693 --> -0.966837).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1337643
	speed: 0.1248s/iter; left time: 5665.8525s
	iters: 200, epoch: 4 | loss: 0.0047116
	speed: 0.0215s/iter; left time: 972.3570s
	iters: 300, epoch: 4 | loss: 0.0192734
	speed: 0.0225s/iter; left time: 1015.8788s
	iters: 400, epoch: 4 | loss: 0.0035246
	speed: 0.0216s/iter; left time: 973.1264s
Epoch: 4 cost time: 10.85096549987793
Epoch: 4, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.966837 --> -0.975127).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0102021
	speed: 0.1289s/iter; left time: 5789.3541s
	iters: 200, epoch: 5 | loss: 0.0175374
	speed: 0.0239s/iter; left time: 1072.6668s
	iters: 300, epoch: 5 | loss: 0.1337965
	speed: 0.0243s/iter; left time: 1084.6822s
	iters: 400, epoch: 5 | loss: 0.0267325
	speed: 0.0243s/iter; left time: 1086.3998s
Epoch: 5 cost time: 11.675175905227661
Epoch: 5, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0252906
	speed: 0.1270s/iter; left time: 5646.3327s
	iters: 200, epoch: 6 | loss: 0.0041030
	speed: 0.0229s/iter; left time: 1013.8922s
	iters: 300, epoch: 6 | loss: 0.4741647
	speed: 0.0242s/iter; left time: 1072.2616s
	iters: 400, epoch: 6 | loss: 0.0110605
	speed: 0.0242s/iter; left time: 1069.2453s
Epoch: 6 cost time: 11.511725902557373
Epoch: 6, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0048502
	speed: 0.1321s/iter; left time: 5808.7264s
	iters: 200, epoch: 7 | loss: 0.0114380
	speed: 0.0230s/iter; left time: 1011.5053s
	iters: 300, epoch: 7 | loss: 0.1067863
	speed: 0.0223s/iter; left time: 974.9929s
	iters: 400, epoch: 7 | loss: 0.0478528
	speed: 0.0232s/iter; left time: 1012.7416s
Epoch: 7 cost time: 11.200519800186157
Epoch: 7, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004922
	speed: 0.1256s/iter; left time: 5464.2148s
	iters: 200, epoch: 8 | loss: 0.0003414
	speed: 0.0238s/iter; left time: 1031.1834s
	iters: 300, epoch: 8 | loss: 0.0027043
	speed: 0.0240s/iter; left time: 1039.4236s
	iters: 400, epoch: 8 | loss: 0.0008896
	speed: 0.0232s/iter; left time: 1001.6577s
Epoch: 8 cost time: 11.41350507736206
Epoch: 8, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0220633
	speed: 0.1248s/iter; left time: 5371.5794s
	iters: 200, epoch: 9 | loss: 0.0150651
	speed: 0.0233s/iter; left time: 999.1834s
	iters: 300, epoch: 9 | loss: 0.1465936
	speed: 0.0241s/iter; left time: 1031.9490s
	iters: 400, epoch: 9 | loss: 0.0042266
	speed: 0.0239s/iter; left time: 1021.3538s
Epoch: 9 cost time: 11.571640491485596
Epoch: 9, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.975127 --> -0.975127).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0051581
	speed: 0.1256s/iter; left time: 5348.0885s
	iters: 200, epoch: 10 | loss: 0.0002399
	speed: 0.0250s/iter; left time: 1061.0110s
	iters: 300, epoch: 10 | loss: 0.0078873
	speed: 0.0239s/iter; left time: 1014.8548s
	iters: 400, epoch: 10 | loss: 0.0000857
	speed: 0.0235s/iter; left time: 991.6580s
Epoch: 10 cost time: 11.570305347442627
Epoch: 10, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0013484
	speed: 0.1279s/iter; left time: 5386.6833s
	iters: 200, epoch: 11 | loss: 0.0025542
	speed: 0.0228s/iter; left time: 959.4973s
	iters: 300, epoch: 11 | loss: 0.0011896
	speed: 0.0240s/iter; left time: 1003.9277s
	iters: 400, epoch: 11 | loss: 0.0002910
	speed: 0.0235s/iter; left time: 984.0688s
Epoch: 11 cost time: 11.484002113342285
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0065180
	speed: 0.1325s/iter; left time: 5517.7495s
	iters: 200, epoch: 12 | loss: 0.0001635
	speed: 0.0199s/iter; left time: 825.5301s
	iters: 300, epoch: 12 | loss: 0.0016033
	speed: 0.0225s/iter; left time: 933.2042s
	iters: 400, epoch: 12 | loss: 0.0010495
	speed: 0.0253s/iter; left time: 1045.3573s
Epoch: 12 cost time: 11.3172926902771
Epoch: 12, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.974 Test Loss: 0.152 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000593
	speed: 0.1296s/iter; left time: 5334.3012s
	iters: 200, epoch: 13 | loss: 0.3292480
	speed: 0.0205s/iter; left time: 842.3484s
	iters: 300, epoch: 13 | loss: 0.0254451
	speed: 0.0196s/iter; left time: 803.7586s
	iters: 400, epoch: 13 | loss: 0.0031544
	speed: 0.0191s/iter; left time: 781.0044s
Epoch: 13 cost time: 9.710900783538818
Epoch: 13, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.975127 --> -0.976843).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.5905680
	speed: 0.1204s/iter; left time: 4902.0805s
	iters: 200, epoch: 14 | loss: 0.1413119
	speed: 0.0227s/iter; left time: 921.2781s
	iters: 300, epoch: 14 | loss: 0.0009365
	speed: 0.0227s/iter; left time: 921.1002s
	iters: 400, epoch: 14 | loss: 0.0940898
	speed: 0.0230s/iter; left time: 929.7819s
Epoch: 14 cost time: 11.114535808563232
Epoch: 14, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978272).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0010699
	speed: 0.1261s/iter; left time: 5075.4621s
	iters: 200, epoch: 15 | loss: 0.0057266
	speed: 0.0235s/iter; left time: 944.3694s
	iters: 300, epoch: 15 | loss: 0.0883097
	speed: 0.0221s/iter; left time: 882.8017s
	iters: 400, epoch: 15 | loss: 0.0144657
	speed: 0.0226s/iter; left time: 903.4002s
Epoch: 15 cost time: 11.124377489089966
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0006720
	speed: 0.1265s/iter; left time: 5030.3848s
	iters: 200, epoch: 16 | loss: 0.0023001
	speed: 0.0224s/iter; left time: 889.4445s
	iters: 300, epoch: 16 | loss: 0.0005892
	speed: 0.0225s/iter; left time: 891.9473s
	iters: 400, epoch: 16 | loss: 0.0010958
	speed: 0.0236s/iter; left time: 930.0907s
Epoch: 16 cost time: 11.100329637527466
Epoch: 16, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0006550
	speed: 0.1302s/iter; left time: 5115.8163s
	iters: 200, epoch: 17 | loss: 0.0015513
	speed: 0.0234s/iter; left time: 917.7544s
	iters: 300, epoch: 17 | loss: 0.0241796
	speed: 0.0235s/iter; left time: 918.0247s
	iters: 400, epoch: 17 | loss: 0.0364550
	speed: 0.0227s/iter; left time: 886.5919s
Epoch: 17 cost time: 11.325644969940186
Epoch: 17, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.978558 --> -0.982846).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0178294
	speed: 0.1278s/iter; left time: 4960.9084s
	iters: 200, epoch: 18 | loss: 0.0138441
	speed: 0.0223s/iter; left time: 862.5689s
	iters: 300, epoch: 18 | loss: 0.0000202
	speed: 0.0224s/iter; left time: 865.4778s
	iters: 400, epoch: 18 | loss: 0.0190006
	speed: 0.0232s/iter; left time: 894.5346s
Epoch: 18 cost time: 11.16649603843689
Epoch: 18, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0001155
	speed: 0.1253s/iter; left time: 4808.0346s
	iters: 200, epoch: 19 | loss: 0.0074641
	speed: 0.0237s/iter; left time: 905.7920s
	iters: 300, epoch: 19 | loss: 0.0000345
	speed: 0.0226s/iter; left time: 862.9492s
	iters: 400, epoch: 19 | loss: 0.0000497
	speed: 0.0224s/iter; left time: 851.3477s
Epoch: 19 cost time: 11.146369457244873
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0005409
	speed: 0.1223s/iter; left time: 4633.4117s
	iters: 200, epoch: 20 | loss: 0.0004522
	speed: 0.0253s/iter; left time: 955.0943s
	iters: 300, epoch: 20 | loss: 0.3072797
	speed: 0.0243s/iter; left time: 916.8584s
	iters: 400, epoch: 20 | loss: 0.0003015
	speed: 0.0229s/iter; left time: 860.7475s
Epoch: 20 cost time: 11.570308685302734
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0003743
	speed: 0.1230s/iter; left time: 4601.6646s
	iters: 200, epoch: 21 | loss: 0.0001560
	speed: 0.0225s/iter; left time: 839.6753s
	iters: 300, epoch: 21 | loss: 0.0000239
	speed: 0.0215s/iter; left time: 800.0873s
	iters: 400, epoch: 21 | loss: 0.0015613
	speed: 0.0219s/iter; left time: 814.5040s
Epoch: 21 cost time: 10.81179165840149
Epoch: 21, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0364248
	speed: 0.1287s/iter; left time: 4754.6535s
	iters: 200, epoch: 22 | loss: 0.0007921
	speed: 0.0229s/iter; left time: 842.6895s
	iters: 300, epoch: 22 | loss: 0.0011528
	speed: 0.0230s/iter; left time: 845.7935s
	iters: 400, epoch: 22 | loss: 0.2380244
	speed: 0.0246s/iter; left time: 899.8267s
Epoch: 22 cost time: 11.462807178497314
Epoch: 22, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0018442
	speed: 0.1302s/iter; left time: 4748.5067s
	iters: 200, epoch: 23 | loss: 0.0008853
	speed: 0.0237s/iter; left time: 862.7036s
	iters: 300, epoch: 23 | loss: 0.0004145
	speed: 0.0237s/iter; left time: 860.6967s
	iters: 400, epoch: 23 | loss: 0.0004125
	speed: 0.0229s/iter; left time: 828.4976s
Epoch: 23 cost time: 11.506075382232666
Epoch: 23, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0004825
	speed: 0.1320s/iter; left time: 4752.8103s
	iters: 200, epoch: 24 | loss: 0.0000552
	speed: 0.0220s/iter; left time: 789.8472s
	iters: 300, epoch: 24 | loss: 0.0227956
	speed: 0.0226s/iter; left time: 810.2174s
	iters: 400, epoch: 24 | loss: 0.0000069
	speed: 0.0230s/iter; left time: 820.7655s
Epoch: 24 cost time: 11.072955846786499
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0302754
	speed: 0.1249s/iter; left time: 4438.3683s
	iters: 200, epoch: 25 | loss: 0.0102900
	speed: 0.0225s/iter; left time: 798.4366s
	iters: 300, epoch: 25 | loss: 0.0021505
	speed: 0.0216s/iter; left time: 764.2035s
	iters: 400, epoch: 25 | loss: 0.0000045
	speed: 0.0226s/iter; left time: 794.8479s
Epoch: 25 cost time: 10.944222927093506
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0000202
	speed: 0.1274s/iter; left time: 4470.1386s
	iters: 200, epoch: 26 | loss: 0.0000873
	speed: 0.0229s/iter; left time: 800.6955s
	iters: 300, epoch: 26 | loss: 0.0000531
	speed: 0.0232s/iter; left time: 808.9385s
	iters: 400, epoch: 26 | loss: 0.0001902
	speed: 0.0247s/iter; left time: 859.0026s
Epoch: 26 cost time: 11.391338109970093
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 27 | loss: 0.0012343
	speed: 0.1269s/iter; left time: 4392.9514s
	iters: 200, epoch: 27 | loss: 0.0013705
	speed: 0.0242s/iter; left time: 835.8623s
	iters: 300, epoch: 27 | loss: 0.0003161
	speed: 0.0237s/iter; left time: 815.3523s
	iters: 400, epoch: 27 | loss: 0.0084579
	speed: 0.0231s/iter; left time: 790.8659s
Epoch: 27 cost time: 11.441227912902832
Epoch: 27, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.979 Test Loss: 0.149 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 62242
model size : 2.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2738688
	speed: 0.0444s/iter; left time: 2079.3671s
	iters: 200, epoch: 1 | loss: 0.6759138
	speed: 0.0252s/iter; left time: 1175.8228s
	iters: 300, epoch: 1 | loss: 0.6714776
	speed: 0.0254s/iter; left time: 1185.7349s
	iters: 400, epoch: 1 | loss: 0.2259546
	speed: 0.0230s/iter; left time: 1070.8626s
Epoch: 1 cost time: 13.425974130630493
Epoch: 1, Steps: 469 | Train Loss: 0.847 Vali Loss: 0.430 Vali Acc: 0.861 Test Loss: 0.430 Test Acc: 0.861
Validation loss decreased (inf --> -0.861059).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2740614
	speed: 0.1223s/iter; left time: 5664.6309s
	iters: 200, epoch: 2 | loss: 0.3363823
	speed: 0.0231s/iter; left time: 1067.0751s
	iters: 300, epoch: 2 | loss: 0.1213568
	speed: 0.0233s/iter; left time: 1075.9004s
	iters: 400, epoch: 2 | loss: 0.1569915
	speed: 0.0247s/iter; left time: 1138.3107s
Epoch: 2 cost time: 11.354022026062012
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.252 Vali Acc: 0.920 Test Loss: 0.252 Test Acc: 0.920
Validation loss decreased (-0.861059 --> -0.919666).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2287757
	speed: 0.1241s/iter; left time: 5692.2294s
	iters: 200, epoch: 3 | loss: 0.0671532
	speed: 0.0241s/iter; left time: 1104.0420s
	iters: 300, epoch: 3 | loss: 0.1817195
	speed: 0.0245s/iter; left time: 1118.2288s
	iters: 400, epoch: 3 | loss: 0.0898807
	speed: 0.0245s/iter; left time: 1114.7644s
Epoch: 3 cost time: 11.562021255493164
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.919666 --> -0.957688).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0270844
	speed: 0.1322s/iter; left time: 6000.1654s
	iters: 200, epoch: 4 | loss: 0.0485719
	speed: 0.0242s/iter; left time: 1096.5550s
	iters: 300, epoch: 4 | loss: 0.0160980
	speed: 0.0216s/iter; left time: 977.5028s
	iters: 400, epoch: 4 | loss: 0.0516353
	speed: 0.0232s/iter; left time: 1046.4136s
Epoch: 4 cost time: 11.215104103088379
Epoch: 4, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.957688 --> -0.964264).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1512927
	speed: 0.1267s/iter; left time: 5691.6339s
	iters: 200, epoch: 5 | loss: 0.0190988
	speed: 0.0228s/iter; left time: 1020.8231s
	iters: 300, epoch: 5 | loss: 0.0538467
	speed: 0.0224s/iter; left time: 1000.4106s
	iters: 400, epoch: 5 | loss: 0.0992437
	speed: 0.0224s/iter; left time: 999.2628s
Epoch: 5 cost time: 10.853527784347534
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0129799
	speed: 0.1241s/iter; left time: 5517.9152s
	iters: 200, epoch: 6 | loss: 0.0255087
	speed: 0.0236s/iter; left time: 1047.6438s
	iters: 300, epoch: 6 | loss: 0.0094408
	speed: 0.0240s/iter; left time: 1060.0515s
	iters: 400, epoch: 6 | loss: 0.0183943
	speed: 0.0243s/iter; left time: 1071.2861s
Epoch: 6 cost time: 11.60218358039856
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
Validation loss decreased (-0.964264 --> -0.966265).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1079491
	speed: 0.1240s/iter; left time: 5454.6821s
	iters: 200, epoch: 7 | loss: 0.0403301
	speed: 0.0233s/iter; left time: 1021.1265s
	iters: 300, epoch: 7 | loss: 0.0170429
	speed: 0.0241s/iter; left time: 1057.2852s
	iters: 400, epoch: 7 | loss: 0.0195714
	speed: 0.0254s/iter; left time: 1109.0446s
Epoch: 7 cost time: 11.67685580253601
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.966265 --> -0.966551).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0530282
	speed: 0.1252s/iter; left time: 5450.2324s
	iters: 200, epoch: 8 | loss: 0.0945667
	speed: 0.0234s/iter; left time: 1015.3995s
	iters: 300, epoch: 8 | loss: 0.3325593
	speed: 0.0238s/iter; left time: 1031.3530s
	iters: 400, epoch: 8 | loss: 0.0531056
	speed: 0.0234s/iter; left time: 1012.8068s
Epoch: 8 cost time: 11.570013284683228
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.966551 --> -0.970839).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0400460
	speed: 0.1366s/iter; left time: 5878.7357s
	iters: 200, epoch: 9 | loss: 0.0196400
	speed: 0.0231s/iter; left time: 990.7836s
	iters: 300, epoch: 9 | loss: 0.0182618
	speed: 0.0243s/iter; left time: 1041.8217s
	iters: 400, epoch: 9 | loss: 0.0153055
	speed: 0.0243s/iter; left time: 1039.5943s
Epoch: 9 cost time: 11.634803533554077
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0582977
	speed: 0.1267s/iter; left time: 5396.5826s
	iters: 200, epoch: 10 | loss: 0.0011793
	speed: 0.0228s/iter; left time: 970.3565s
	iters: 300, epoch: 10 | loss: 0.0095429
	speed: 0.0207s/iter; left time: 876.9087s
	iters: 400, epoch: 10 | loss: 0.0195435
	speed: 0.0232s/iter; left time: 981.8542s
Epoch: 10 cost time: 10.892333507537842
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0313760
	speed: 0.1211s/iter; left time: 5097.6530s
	iters: 200, epoch: 11 | loss: 0.0215893
	speed: 0.0250s/iter; left time: 1051.9618s
	iters: 300, epoch: 11 | loss: 0.0171836
	speed: 0.0238s/iter; left time: 997.5820s
	iters: 400, epoch: 11 | loss: 0.0038105
	speed: 0.0241s/iter; left time: 1009.7313s
Epoch: 11 cost time: 11.937463521957397
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.970839 --> -0.975413).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0204733
	speed: 0.1310s/iter; left time: 5454.2292s
	iters: 200, epoch: 12 | loss: 0.4298273
	speed: 0.0243s/iter; left time: 1009.0043s
	iters: 300, epoch: 12 | loss: 0.0385647
	speed: 0.0246s/iter; left time: 1021.1706s
	iters: 400, epoch: 12 | loss: 0.0660400
	speed: 0.0246s/iter; left time: 1018.7342s
Epoch: 12 cost time: 12.006930351257324
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975413 --> -0.976843).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0787458
	speed: 0.1294s/iter; left time: 5327.9556s
	iters: 200, epoch: 13 | loss: 0.0010276
	speed: 0.0250s/iter; left time: 1028.3217s
	iters: 300, epoch: 13 | loss: 0.0016016
	speed: 0.0269s/iter; left time: 1103.7584s
	iters: 400, epoch: 13 | loss: 0.0084883
	speed: 0.0260s/iter; left time: 1063.8386s
Epoch: 13 cost time: 12.469122648239136
Epoch: 13, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0063343
	speed: 0.1359s/iter; left time: 5531.9363s
	iters: 200, epoch: 14 | loss: 0.0118820
	speed: 0.0254s/iter; left time: 1029.8733s
	iters: 300, epoch: 14 | loss: 0.0300979
	speed: 0.0242s/iter; left time: 979.4780s
	iters: 400, epoch: 14 | loss: 0.0041393
	speed: 0.0246s/iter; left time: 993.6814s
Epoch: 14 cost time: 11.938134670257568
Epoch: 14, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977986).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0096490
	speed: 0.1331s/iter; left time: 5355.2565s
	iters: 200, epoch: 15 | loss: 0.0281766
	speed: 0.0242s/iter; left time: 972.9132s
	iters: 300, epoch: 15 | loss: 0.0579103
	speed: 0.0242s/iter; left time: 968.4577s
	iters: 400, epoch: 15 | loss: 0.0247759
	speed: 0.0235s/iter; left time: 937.1088s
Epoch: 15 cost time: 11.470428228378296
Epoch: 15, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.977986 --> -0.978272).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0084831
	speed: 0.1268s/iter; left time: 5044.0163s
	iters: 200, epoch: 16 | loss: 0.1639423
	speed: 0.0244s/iter; left time: 966.4045s
	iters: 300, epoch: 16 | loss: 0.0590613
	speed: 0.0249s/iter; left time: 986.0967s
	iters: 400, epoch: 16 | loss: 0.0008098
	speed: 0.0245s/iter; left time: 965.0965s
Epoch: 16 cost time: 11.897287607192993
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0026126
	speed: 0.1268s/iter; left time: 4981.5410s
	iters: 200, epoch: 17 | loss: 0.0058497
	speed: 0.0243s/iter; left time: 951.1742s
	iters: 300, epoch: 17 | loss: 0.0010905
	speed: 0.0241s/iter; left time: 940.9921s
	iters: 400, epoch: 17 | loss: 0.0102424
	speed: 0.0233s/iter; left time: 909.2061s
Epoch: 17 cost time: 11.756858825683594
Epoch: 17, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0021019
	speed: 0.1351s/iter; left time: 5243.8971s
	iters: 200, epoch: 18 | loss: 0.1575760
	speed: 0.0242s/iter; left time: 936.1358s
	iters: 300, epoch: 18 | loss: 0.0035494
	speed: 0.0240s/iter; left time: 927.8974s
	iters: 400, epoch: 18 | loss: 0.0059774
	speed: 0.0238s/iter; left time: 915.3878s
Epoch: 18 cost time: 11.62049913406372
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.981417).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0958302
	speed: 0.1336s/iter; left time: 5125.2302s
	iters: 200, epoch: 19 | loss: 0.0045765
	speed: 0.0246s/iter; left time: 942.3809s
	iters: 300, epoch: 19 | loss: 0.0780469
	speed: 0.0243s/iter; left time: 927.3230s
	iters: 400, epoch: 19 | loss: 0.0033121
	speed: 0.0267s/iter; left time: 1016.6953s
Epoch: 19 cost time: 12.310812711715698
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0130739
	speed: 0.1297s/iter; left time: 4914.5695s
	iters: 200, epoch: 20 | loss: 0.0371138
	speed: 0.0254s/iter; left time: 959.4368s
	iters: 300, epoch: 20 | loss: 0.0043088
	speed: 0.0252s/iter; left time: 951.3736s
	iters: 400, epoch: 20 | loss: 0.0034216
	speed: 0.0253s/iter; left time: 951.4531s
Epoch: 20 cost time: 12.141102075576782
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0135670
	speed: 0.1232s/iter; left time: 4610.2566s
	iters: 200, epoch: 21 | loss: 0.0056513
	speed: 0.0240s/iter; left time: 896.7349s
	iters: 300, epoch: 21 | loss: 0.0012386
	speed: 0.0250s/iter; left time: 931.4486s
	iters: 400, epoch: 21 | loss: 0.0016015
	speed: 0.0238s/iter; left time: 882.5491s
Epoch: 21 cost time: 11.84138536453247
Epoch: 21, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0219837
	speed: 0.1316s/iter; left time: 4864.1510s
	iters: 200, epoch: 22 | loss: 0.0049650
	speed: 0.0247s/iter; left time: 910.2495s
	iters: 300, epoch: 22 | loss: 0.0041777
	speed: 0.0244s/iter; left time: 896.0533s
	iters: 400, epoch: 22 | loss: 0.0065789
	speed: 0.0249s/iter; left time: 914.2141s
Epoch: 22 cost time: 12.033350229263306
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0196760
	speed: 0.1373s/iter; left time: 5009.8794s
	iters: 200, epoch: 23 | loss: 0.0007706
	speed: 0.0243s/iter; left time: 882.9708s
	iters: 300, epoch: 23 | loss: 0.0079225
	speed: 0.0243s/iter; left time: 883.2304s
	iters: 400, epoch: 23 | loss: 0.0075161
	speed: 0.0229s/iter; left time: 826.8138s
Epoch: 23 cost time: 11.56373119354248
Epoch: 23, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0043459
	speed: 0.1319s/iter; left time: 4748.8730s
	iters: 200, epoch: 24 | loss: 0.0029301
	speed: 0.0231s/iter; left time: 830.0779s
	iters: 300, epoch: 24 | loss: 0.0051446
	speed: 0.0236s/iter; left time: 844.8185s
	iters: 400, epoch: 24 | loss: 0.0652637
	speed: 0.0230s/iter; left time: 822.3265s
Epoch: 24 cost time: 11.466851711273193
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0080975
	speed: 0.1251s/iter; left time: 4447.0741s
	iters: 200, epoch: 25 | loss: 0.0031883
	speed: 0.0233s/iter; left time: 826.0513s
	iters: 300, epoch: 25 | loss: 0.0041976
	speed: 0.0239s/iter; left time: 843.4714s
	iters: 400, epoch: 25 | loss: 0.0038990
	speed: 0.0235s/iter; left time: 828.3817s
Epoch: 25 cost time: 11.442288637161255
Epoch: 25, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0002825
	speed: 0.1229s/iter; left time: 4309.8255s
	iters: 200, epoch: 26 | loss: 0.0020149
	speed: 0.0240s/iter; left time: 838.4767s
	iters: 300, epoch: 26 | loss: 0.0020502
	speed: 0.0260s/iter; left time: 905.5632s
	iters: 400, epoch: 26 | loss: 0.0251191
	speed: 0.0240s/iter; left time: 835.9972s
Epoch: 26 cost time: 11.905141592025757
Epoch: 26, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
Validation loss decreased (-0.981417 --> -0.981703).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0021192
	speed: 0.1248s/iter; left time: 4318.1731s
	iters: 200, epoch: 27 | loss: 0.0004940
	speed: 0.0235s/iter; left time: 811.5012s
	iters: 300, epoch: 27 | loss: 0.0959157
	speed: 0.0225s/iter; left time: 774.8568s
	iters: 400, epoch: 27 | loss: 0.0062011
	speed: 0.0244s/iter; left time: 838.3444s
Epoch: 27 cost time: 11.606096029281616
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0024001
	speed: 0.1333s/iter; left time: 4552.2109s
	iters: 200, epoch: 28 | loss: 0.0256182
	speed: 0.0246s/iter; left time: 835.6612s
	iters: 300, epoch: 28 | loss: 0.0006243
	speed: 0.0238s/iter; left time: 806.8119s
	iters: 400, epoch: 28 | loss: 0.0154315
	speed: 0.0228s/iter; left time: 772.1845s
Epoch: 28 cost time: 11.623375415802002
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0068461
	speed: 0.1341s/iter; left time: 4515.1618s
	iters: 200, epoch: 29 | loss: 0.0027184
	speed: 0.0241s/iter; left time: 810.4362s
	iters: 300, epoch: 29 | loss: 0.0188714
	speed: 0.0261s/iter; left time: 872.5393s
	iters: 400, epoch: 29 | loss: 0.0035693
	speed: 0.0236s/iter; left time: 787.8705s
Epoch: 29 cost time: 12.074985980987549
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0137267
	speed: 0.1323s/iter; left time: 4393.1646s
	iters: 200, epoch: 30 | loss: 0.0001104
	speed: 0.0244s/iter; left time: 807.8274s
	iters: 300, epoch: 30 | loss: 0.0063294
	speed: 0.0241s/iter; left time: 795.6350s
	iters: 400, epoch: 30 | loss: 0.0001686
	speed: 0.0253s/iter; left time: 831.7388s
Epoch: 30 cost time: 11.983563661575317
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0096795
	speed: 0.1316s/iter; left time: 4308.8975s
	iters: 200, epoch: 31 | loss: 0.0204875
	speed: 0.0241s/iter; left time: 786.8166s
	iters: 300, epoch: 31 | loss: 0.0832831
	speed: 0.0242s/iter; left time: 787.4394s
	iters: 400, epoch: 31 | loss: 0.1527704
	speed: 0.0243s/iter; left time: 786.6857s
Epoch: 31 cost time: 11.895151138305664
Epoch: 31, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0657268
	speed: 0.1304s/iter; left time: 4206.2146s
	iters: 200, epoch: 32 | loss: 0.0011933
	speed: 0.0238s/iter; left time: 764.6633s
	iters: 300, epoch: 32 | loss: 0.0019003
	speed: 0.0250s/iter; left time: 800.9971s
	iters: 400, epoch: 32 | loss: 0.0069019
	speed: 0.0253s/iter; left time: 809.8194s
Epoch: 32 cost time: 12.009631156921387
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0106248
	speed: 0.1310s/iter; left time: 4164.1686s
	iters: 200, epoch: 33 | loss: 0.0010574
	speed: 0.0251s/iter; left time: 795.8799s
	iters: 300, epoch: 33 | loss: 0.0290223
	speed: 0.0245s/iter; left time: 773.9555s
	iters: 400, epoch: 33 | loss: 0.0008585
	speed: 0.0237s/iter; left time: 745.1959s
Epoch: 33 cost time: 11.661375522613525
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0072824
	speed: 0.1309s/iter; left time: 4101.6575s
	iters: 200, epoch: 34 | loss: 0.0057005
	speed: 0.0226s/iter; left time: 706.9590s
	iters: 300, epoch: 34 | loss: 0.0025592
	speed: 0.0228s/iter; left time: 708.6556s
	iters: 400, epoch: 34 | loss: 0.0137386
	speed: 0.0227s/iter; left time: 702.7996s
Epoch: 34 cost time: 11.371061325073242
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0025956
	speed: 0.1238s/iter; left time: 3819.4121s
	iters: 200, epoch: 35 | loss: 0.0003667
	speed: 0.0232s/iter; left time: 713.6908s
	iters: 300, epoch: 35 | loss: 0.0028342
	speed: 0.0230s/iter; left time: 704.0388s
	iters: 400, epoch: 35 | loss: 0.0019270
	speed: 0.0237s/iter; left time: 723.9762s
Epoch: 35 cost time: 11.515973806381226
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000893
	speed: 0.1252s/iter; left time: 3805.4984s
	iters: 200, epoch: 36 | loss: 0.1975351
	speed: 0.0228s/iter; left time: 689.9630s
	iters: 300, epoch: 36 | loss: 0.0190006
	speed: 0.0219s/iter; left time: 661.3786s
	iters: 400, epoch: 36 | loss: 0.0002140
	speed: 0.0219s/iter; left time: 659.9007s
Epoch: 36 cost time: 10.808573722839355
Epoch: 36, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 276898
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2770488
	speed: 0.0438s/iter; left time: 2047.9123s
	iters: 200, epoch: 1 | loss: 0.7216958
	speed: 0.0217s/iter; left time: 1015.6031s
	iters: 300, epoch: 1 | loss: 0.6539701
	speed: 0.0227s/iter; left time: 1056.9670s
	iters: 400, epoch: 1 | loss: 0.2589627
	speed: 0.0228s/iter; left time: 1058.7571s
Epoch: 1 cost time: 12.698494911193848
Epoch: 1, Steps: 469 | Train Loss: 0.869 Vali Loss: 0.429 Vali Acc: 0.862 Test Loss: 0.429 Test Acc: 0.862
Validation loss decreased (inf --> -0.861631).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2973086
	speed: 0.1304s/iter; left time: 6042.0534s
	iters: 200, epoch: 2 | loss: 0.3793478
	speed: 0.0240s/iter; left time: 1109.4342s
	iters: 300, epoch: 2 | loss: 0.1297300
	speed: 0.0232s/iter; left time: 1067.9702s
	iters: 400, epoch: 2 | loss: 0.1721663
	speed: 0.0234s/iter; left time: 1075.7495s
Epoch: 2 cost time: 11.487890481948853
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.861631 --> -0.927671).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2271489
	speed: 0.1279s/iter; left time: 5867.3423s
	iters: 200, epoch: 3 | loss: 0.0701718
	speed: 0.0242s/iter; left time: 1108.1587s
	iters: 300, epoch: 3 | loss: 0.1674590
	speed: 0.0233s/iter; left time: 1062.1196s
	iters: 400, epoch: 3 | loss: 0.0819006
	speed: 0.0244s/iter; left time: 1112.2235s
Epoch: 3 cost time: 11.866496324539185
Epoch: 3, Steps: 469 | Train Loss: 0.131 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
Validation loss decreased (-0.927671 --> -0.955401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0474905
	speed: 0.1326s/iter; left time: 6018.1778s
	iters: 200, epoch: 4 | loss: 0.0698696
	speed: 0.0244s/iter; left time: 1105.3960s
	iters: 300, epoch: 4 | loss: 0.0173073
	speed: 0.0236s/iter; left time: 1067.3802s
	iters: 400, epoch: 4 | loss: 0.0474537
	speed: 0.0229s/iter; left time: 1034.8803s
Epoch: 4 cost time: 11.716188192367554
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.955401 --> -0.963692).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0671823
	speed: 0.1226s/iter; left time: 5507.1069s
	iters: 200, epoch: 5 | loss: 0.0150756
	speed: 0.0237s/iter; left time: 1064.3644s
	iters: 300, epoch: 5 | loss: 0.0216588
	speed: 0.0229s/iter; left time: 1022.1703s
	iters: 400, epoch: 5 | loss: 0.0989401
	speed: 0.0224s/iter; left time: 1001.0422s
Epoch: 5 cost time: 11.359490871429443
Epoch: 5, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0211189
	speed: 0.1237s/iter; left time: 5500.3602s
	iters: 200, epoch: 6 | loss: 0.0156174
	speed: 0.0219s/iter; left time: 969.3433s
	iters: 300, epoch: 6 | loss: 0.0162766
	speed: 0.0226s/iter; left time: 1002.3541s
	iters: 400, epoch: 6 | loss: 0.0156507
	speed: 0.0237s/iter; left time: 1044.6465s
Epoch: 6 cost time: 10.997642993927002
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1211323
	speed: 0.1264s/iter; left time: 5559.9424s
	iters: 200, epoch: 7 | loss: 0.0412300
	speed: 0.0221s/iter; left time: 968.9427s
	iters: 300, epoch: 7 | loss: 0.0113878
	speed: 0.0223s/iter; left time: 978.0898s
	iters: 400, epoch: 7 | loss: 0.0171559
	speed: 0.0227s/iter; left time: 991.3898s
Epoch: 7 cost time: 10.914907932281494
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.963692 --> -0.963978).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0249537
	speed: 0.1196s/iter; left time: 5203.6753s
	iters: 200, epoch: 8 | loss: 0.1246808
	speed: 0.0232s/iter; left time: 1005.4437s
	iters: 300, epoch: 8 | loss: 0.4133703
	speed: 0.0244s/iter; left time: 1056.4574s
	iters: 400, epoch: 8 | loss: 0.0936243
	speed: 0.0219s/iter; left time: 948.0234s
Epoch: 8 cost time: 11.105388879776001
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.963978 --> -0.969410).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0119051
	speed: 0.1174s/iter; left time: 5052.7096s
	iters: 200, epoch: 9 | loss: 0.0444819
	speed: 0.0231s/iter; left time: 993.0593s
	iters: 300, epoch: 9 | loss: 0.0147508
	speed: 0.0219s/iter; left time: 938.9984s
	iters: 400, epoch: 9 | loss: 0.0088065
	speed: 0.0219s/iter; left time: 935.3304s
Epoch: 9 cost time: 10.717919826507568
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.969410 --> -0.971411).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1140717
	speed: 0.1187s/iter; left time: 5052.8124s
	iters: 200, epoch: 10 | loss: 0.0026105
	speed: 0.0224s/iter; left time: 951.2263s
	iters: 300, epoch: 10 | loss: 0.0490923
	speed: 0.0220s/iter; left time: 933.7613s
	iters: 400, epoch: 10 | loss: 0.0412645
	speed: 0.0231s/iter; left time: 978.3036s
Epoch: 10 cost time: 11.01488208770752
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.971411 --> -0.972555).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0344741
	speed: 0.1327s/iter; left time: 5590.1583s
	iters: 200, epoch: 11 | loss: 0.0249902
	speed: 0.0229s/iter; left time: 961.0325s
	iters: 300, epoch: 11 | loss: 0.0042000
	speed: 0.0227s/iter; left time: 950.4537s
	iters: 400, epoch: 11 | loss: 0.0036280
	speed: 0.0230s/iter; left time: 961.7924s
Epoch: 11 cost time: 11.313879489898682
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.972555 --> -0.977415).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0062397
	speed: 0.1303s/iter; left time: 5427.6189s
	iters: 200, epoch: 12 | loss: 0.3020425
	speed: 0.0221s/iter; left time: 919.5663s
	iters: 300, epoch: 12 | loss: 0.0176900
	speed: 0.0230s/iter; left time: 954.8133s
	iters: 400, epoch: 12 | loss: 0.0063351
	speed: 0.0237s/iter; left time: 980.2174s
Epoch: 12 cost time: 11.079255104064941
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0260732
	speed: 0.1266s/iter; left time: 5211.8435s
	iters: 200, epoch: 13 | loss: 0.0016428
	speed: 0.0227s/iter; left time: 934.1248s
	iters: 300, epoch: 13 | loss: 0.0029921
	speed: 0.0221s/iter; left time: 907.0932s
	iters: 400, epoch: 13 | loss: 0.0057289
	speed: 0.0226s/iter; left time: 922.7376s
Epoch: 13 cost time: 10.977171659469604
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0401246
	speed: 0.1232s/iter; left time: 5015.0170s
	iters: 200, epoch: 14 | loss: 0.0114188
	speed: 0.0220s/iter; left time: 894.2379s
	iters: 300, epoch: 14 | loss: 0.0140222
	speed: 0.0217s/iter; left time: 880.6676s
	iters: 400, epoch: 14 | loss: 0.0186736
	speed: 0.0218s/iter; left time: 882.3169s
Epoch: 14 cost time: 10.640269756317139
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0011268
	speed: 0.1200s/iter; left time: 4826.9973s
	iters: 200, epoch: 15 | loss: 0.0157884
	speed: 0.0225s/iter; left time: 902.3261s
	iters: 300, epoch: 15 | loss: 0.0730160
	speed: 0.0238s/iter; left time: 953.4500s
	iters: 400, epoch: 15 | loss: 0.0142977
	speed: 0.0221s/iter; left time: 881.0916s
Epoch: 15 cost time: 11.077811002731323
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0035248
	speed: 0.1243s/iter; left time: 4942.5127s
	iters: 200, epoch: 16 | loss: 0.0108178
	speed: 0.0217s/iter; left time: 862.0422s
	iters: 300, epoch: 16 | loss: 0.1235748
	speed: 0.0226s/iter; left time: 894.5726s
	iters: 400, epoch: 16 | loss: 0.0034498
	speed: 0.0230s/iter; left time: 907.6275s
Epoch: 16 cost time: 10.937223196029663
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0045939
	speed: 0.1253s/iter; left time: 4925.2680s
	iters: 200, epoch: 17 | loss: 0.0073744
	speed: 0.0212s/iter; left time: 830.1967s
	iters: 300, epoch: 17 | loss: 0.0003372
	speed: 0.0227s/iter; left time: 886.5576s
	iters: 400, epoch: 17 | loss: 0.0124184
	speed: 0.0223s/iter; left time: 870.1131s
Epoch: 17 cost time: 10.892668962478638
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0039568
	speed: 0.1207s/iter; left time: 4685.8982s
	iters: 200, epoch: 18 | loss: 0.0393292
	speed: 0.0224s/iter; left time: 867.3484s
	iters: 300, epoch: 18 | loss: 0.0092637
	speed: 0.0226s/iter; left time: 874.2530s
	iters: 400, epoch: 18 | loss: 0.2014623
	speed: 0.0224s/iter; left time: 863.4155s
Epoch: 18 cost time: 10.98617959022522
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.977415 --> -0.978272).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1182243
	speed: 0.1246s/iter; left time: 4778.0427s
	iters: 200, epoch: 19 | loss: 0.0014644
	speed: 0.0222s/iter; left time: 849.5353s
	iters: 300, epoch: 19 | loss: 0.0249718
	speed: 0.0216s/iter; left time: 825.6176s
	iters: 400, epoch: 19 | loss: 0.0015561
	speed: 0.0228s/iter; left time: 866.3119s
Epoch: 19 cost time: 10.787736654281616
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978844).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0148749
	speed: 0.1284s/iter; left time: 4864.9099s
	iters: 200, epoch: 20 | loss: 0.0179488
	speed: 0.0239s/iter; left time: 903.7206s
	iters: 300, epoch: 20 | loss: 0.0013705
	speed: 0.0248s/iter; left time: 936.5732s
	iters: 400, epoch: 20 | loss: 0.0083417
	speed: 0.0240s/iter; left time: 903.7429s
Epoch: 20 cost time: 11.914600849151611
Epoch: 20, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0160774
	speed: 0.1337s/iter; left time: 5002.9383s
	iters: 200, epoch: 21 | loss: 0.0005570
	speed: 0.0229s/iter; left time: 854.0912s
	iters: 300, epoch: 21 | loss: 0.0107916
	speed: 0.0236s/iter; left time: 876.6003s
	iters: 400, epoch: 21 | loss: 0.0073860
	speed: 0.0237s/iter; left time: 881.3825s
Epoch: 21 cost time: 11.322135210037231
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0682780
	speed: 0.1247s/iter; left time: 4609.3216s
	iters: 200, epoch: 22 | loss: 0.0172792
	speed: 0.0230s/iter; left time: 847.1341s
	iters: 300, epoch: 22 | loss: 0.0025713
	speed: 0.0230s/iter; left time: 846.2588s
	iters: 400, epoch: 22 | loss: 0.0080348
	speed: 0.0227s/iter; left time: 832.1069s
Epoch: 22 cost time: 10.843895673751831
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0016708
	speed: 0.1132s/iter; left time: 4128.7809s
	iters: 200, epoch: 23 | loss: 0.0001720
	speed: 0.0234s/iter; left time: 852.2953s
	iters: 300, epoch: 23 | loss: 0.0117633
	speed: 0.0224s/iter; left time: 813.8677s
	iters: 400, epoch: 23 | loss: 0.0021043
	speed: 0.0215s/iter; left time: 777.9446s
Epoch: 23 cost time: 10.901823997497559
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.978844 --> -0.979702).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0018686
	speed: 0.1200s/iter; left time: 4323.2484s
	iters: 200, epoch: 24 | loss: 0.0040549
	speed: 0.0219s/iter; left time: 785.2590s
	iters: 300, epoch: 24 | loss: 0.0613422
	speed: 0.0213s/iter; left time: 764.0306s
	iters: 400, epoch: 24 | loss: 0.0293760
	speed: 0.0219s/iter; left time: 781.8484s
Epoch: 24 cost time: 10.60528564453125
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0110374
	speed: 0.1181s/iter; left time: 4196.2462s
	iters: 200, epoch: 25 | loss: 0.0134298
	speed: 0.0222s/iter; left time: 785.7519s
	iters: 300, epoch: 25 | loss: 0.0007476
	speed: 0.0215s/iter; left time: 761.0045s
	iters: 400, epoch: 25 | loss: 0.0035628
	speed: 0.0222s/iter; left time: 781.9344s
Epoch: 25 cost time: 10.817617654800415
Epoch: 25, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0019236
	speed: 0.1250s/iter; left time: 4385.8565s
	iters: 200, epoch: 26 | loss: 0.0006397
	speed: 0.0225s/iter; left time: 788.5426s
	iters: 300, epoch: 26 | loss: 0.0084942
	speed: 0.0236s/iter; left time: 822.8725s
	iters: 400, epoch: 26 | loss: 0.0972776
	speed: 0.0238s/iter; left time: 826.6743s
Epoch: 26 cost time: 11.172581672668457
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0073550
	speed: 0.1307s/iter; left time: 4521.9659s
	iters: 200, epoch: 27 | loss: 0.0003811
	speed: 0.0232s/iter; left time: 800.6975s
	iters: 300, epoch: 27 | loss: 0.0123970
	speed: 0.0217s/iter; left time: 746.0300s
	iters: 400, epoch: 27 | loss: 0.0200917
	speed: 0.0225s/iter; left time: 770.3364s
Epoch: 27 cost time: 11.035158395767212
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0015239
	speed: 0.1232s/iter; left time: 4207.0075s
	iters: 200, epoch: 28 | loss: 0.0465115
	speed: 0.0224s/iter; left time: 763.6629s
	iters: 300, epoch: 28 | loss: 0.0062138
	speed: 0.0222s/iter; left time: 752.0957s
	iters: 400, epoch: 28 | loss: 0.0220516
	speed: 0.0216s/iter; left time: 731.1180s
Epoch: 28 cost time: 10.83588457107544
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0718109
	speed: 0.1237s/iter; left time: 4164.3812s
	iters: 200, epoch: 29 | loss: 0.0043381
	speed: 0.0223s/iter; left time: 748.5096s
	iters: 300, epoch: 29 | loss: 0.0032821
	speed: 0.0224s/iter; left time: 750.2014s
	iters: 400, epoch: 29 | loss: 0.0013561
	speed: 0.0218s/iter; left time: 727.4123s
Epoch: 29 cost time: 10.865304231643677
Epoch: 29, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0021632
	speed: 0.1207s/iter; left time: 4008.7842s
	iters: 200, epoch: 30 | loss: 0.0054383
	speed: 0.0229s/iter; left time: 758.6362s
	iters: 300, epoch: 30 | loss: 0.0027400
	speed: 0.0232s/iter; left time: 764.6498s
	iters: 400, epoch: 30 | loss: 0.0026066
	speed: 0.0240s/iter; left time: 790.6732s
Epoch: 30 cost time: 11.10364294052124
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0004618
	speed: 0.1275s/iter; left time: 4174.0485s
	iters: 200, epoch: 31 | loss: 0.0409313
	speed: 0.0235s/iter; left time: 765.3017s
	iters: 300, epoch: 31 | loss: 0.0050424
	speed: 0.0235s/iter; left time: 763.1147s
	iters: 400, epoch: 31 | loss: 0.0090704
	speed: 0.0226s/iter; left time: 734.4317s
Epoch: 31 cost time: 11.101591110229492
Epoch: 31, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0020783
	speed: 0.1293s/iter; left time: 4171.2723s
	iters: 200, epoch: 32 | loss: 0.0009897
	speed: 0.0241s/iter; left time: 776.1130s
	iters: 300, epoch: 32 | loss: 0.0015618
	speed: 0.0224s/iter; left time: 719.6988s
	iters: 400, epoch: 32 | loss: 0.0039095
	speed: 0.0217s/iter; left time: 693.1681s
Epoch: 32 cost time: 10.961885690689087
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0008571
	speed: 0.1210s/iter; left time: 3845.3812s
	iters: 200, epoch: 33 | loss: 0.0013586
	speed: 0.0215s/iter; left time: 682.6673s
	iters: 300, epoch: 33 | loss: 0.0054651
	speed: 0.0219s/iter; left time: 692.6200s
	iters: 400, epoch: 33 | loss: 0.0007912
	speed: 0.0223s/iter; left time: 701.4494s
Epoch: 33 cost time: 10.736035585403442
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 276898
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5027995
	speed: 0.0410s/iter; left time: 1919.4230s
	iters: 200, epoch: 1 | loss: 0.8599163
	speed: 0.0235s/iter; left time: 1097.6802s
	iters: 300, epoch: 1 | loss: 0.6458688
	speed: 0.0232s/iter; left time: 1082.0812s
	iters: 400, epoch: 1 | loss: 0.3336288
	speed: 0.0244s/iter; left time: 1132.6450s
Epoch: 1 cost time: 12.936124324798584
Epoch: 1, Steps: 469 | Train Loss: 0.931 Vali Loss: 0.390 Vali Acc: 0.886 Test Loss: 0.390 Test Acc: 0.886
Validation loss decreased (inf --> -0.885931).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2708444
	speed: 0.1312s/iter; left time: 6079.9833s
	iters: 200, epoch: 2 | loss: 0.4139867
	speed: 0.0234s/iter; left time: 1080.3620s
	iters: 300, epoch: 2 | loss: 0.0793113
	speed: 0.0225s/iter; left time: 1036.1320s
	iters: 400, epoch: 2 | loss: 0.1957004
	speed: 0.0238s/iter; left time: 1097.4193s
Epoch: 2 cost time: 11.251925230026245
Epoch: 2, Steps: 469 | Train Loss: 0.203 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.885931 --> -0.950255).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1444897
	speed: 0.1266s/iter; left time: 5807.4253s
	iters: 200, epoch: 3 | loss: 0.0513651
	speed: 0.0239s/iter; left time: 1091.5667s
	iters: 300, epoch: 3 | loss: 0.0936548
	speed: 0.0224s/iter; left time: 1022.5739s
	iters: 400, epoch: 3 | loss: 0.0698414
	speed: 0.0207s/iter; left time: 944.3076s
Epoch: 3 cost time: 10.932446479797363
Epoch: 3, Steps: 469 | Train Loss: 0.115 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.950255 --> -0.965979).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0102799
	speed: 0.1231s/iter; left time: 5586.3342s
	iters: 200, epoch: 4 | loss: 0.0194389
	speed: 0.0238s/iter; left time: 1078.5807s
	iters: 300, epoch: 4 | loss: 0.0144423
	speed: 0.0239s/iter; left time: 1078.0893s
	iters: 400, epoch: 4 | loss: 0.0286616
	speed: 0.0234s/iter; left time: 1054.4542s
Epoch: 4 cost time: 11.39233136177063
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.968838).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0889316
	speed: 0.1190s/iter; left time: 5344.6696s
	iters: 200, epoch: 5 | loss: 0.0040401
	speed: 0.0222s/iter; left time: 995.7900s
	iters: 300, epoch: 5 | loss: 0.0219567
	speed: 0.0230s/iter; left time: 1030.7589s
	iters: 400, epoch: 5 | loss: 0.0668896
	speed: 0.0216s/iter; left time: 962.3103s
Epoch: 5 cost time: 10.879278898239136
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0100916
	speed: 0.1160s/iter; left time: 5157.1225s
	iters: 200, epoch: 6 | loss: 0.0465342
	speed: 0.0243s/iter; left time: 1075.6374s
	iters: 300, epoch: 6 | loss: 0.1605413
	speed: 0.0244s/iter; left time: 1081.9912s
	iters: 400, epoch: 6 | loss: 0.0189792
	speed: 0.0242s/iter; left time: 1068.6887s
Epoch: 6 cost time: 11.84466552734375
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0270470
	speed: 0.1322s/iter; left time: 5813.9451s
	iters: 200, epoch: 7 | loss: 0.0334075
	speed: 0.0221s/iter; left time: 968.3105s
	iters: 300, epoch: 7 | loss: 0.0054553
	speed: 0.0243s/iter; left time: 1063.3869s
	iters: 400, epoch: 7 | loss: 0.0127341
	speed: 0.0234s/iter; left time: 1020.4790s
Epoch: 7 cost time: 11.505216836929321
Epoch: 7, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.969124 --> -0.971125).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0117645
	speed: 0.1363s/iter; left time: 5932.0027s
	iters: 200, epoch: 8 | loss: 0.1501126
	speed: 0.0236s/iter; left time: 1024.4866s
	iters: 300, epoch: 8 | loss: 0.5710659
	speed: 0.0218s/iter; left time: 942.8521s
	iters: 400, epoch: 8 | loss: 0.0259036
	speed: 0.0234s/iter; left time: 1010.1906s
Epoch: 8 cost time: 11.279540300369263
Epoch: 8, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0022479
	speed: 0.1261s/iter; left time: 5426.7319s
	iters: 200, epoch: 9 | loss: 0.0025761
	speed: 0.0233s/iter; left time: 1000.8184s
	iters: 300, epoch: 9 | loss: 0.0099362
	speed: 0.0229s/iter; left time: 980.4659s
	iters: 400, epoch: 9 | loss: 0.0263077
	speed: 0.0226s/iter; left time: 967.1745s
Epoch: 9 cost time: 11.180541515350342
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0150839
	speed: 0.1206s/iter; left time: 5136.0103s
	iters: 200, epoch: 10 | loss: 0.0026372
	speed: 0.0223s/iter; left time: 947.3445s
	iters: 300, epoch: 10 | loss: 0.0167078
	speed: 0.0231s/iter; left time: 978.1596s
	iters: 400, epoch: 10 | loss: 0.0225822
	speed: 0.0225s/iter; left time: 949.2841s
Epoch: 10 cost time: 11.026070594787598
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0254826
	speed: 0.1207s/iter; left time: 5083.1698s
	iters: 200, epoch: 11 | loss: 0.0025340
	speed: 0.0238s/iter; left time: 998.7403s
	iters: 300, epoch: 11 | loss: 0.0017750
	speed: 0.0246s/iter; left time: 1031.8933s
	iters: 400, epoch: 11 | loss: 0.0066152
	speed: 0.0233s/iter; left time: 974.8830s
Epoch: 11 cost time: 11.376597166061401
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.971125 --> -0.973698).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0035630
	speed: 0.1256s/iter; left time: 5228.8431s
	iters: 200, epoch: 12 | loss: 0.3007572
	speed: 0.0231s/iter; left time: 958.2841s
	iters: 300, epoch: 12 | loss: 0.0924281
	speed: 0.0228s/iter; left time: 943.8846s
	iters: 400, epoch: 12 | loss: 0.0045988
	speed: 0.0229s/iter; left time: 947.2637s
Epoch: 12 cost time: 11.135207891464233
Epoch: 12, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0824986
	speed: 0.1236s/iter; left time: 5089.2339s
	iters: 200, epoch: 13 | loss: 0.0213182
	speed: 0.0226s/iter; left time: 928.9137s
	iters: 300, epoch: 13 | loss: 0.0182935
	speed: 0.0226s/iter; left time: 924.4303s
	iters: 400, epoch: 13 | loss: 0.0006629
	speed: 0.0231s/iter; left time: 946.0581s
Epoch: 13 cost time: 11.00509524345398
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975128).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0333112
	speed: 0.1248s/iter; left time: 5081.1560s
	iters: 200, epoch: 14 | loss: 0.0117428
	speed: 0.0235s/iter; left time: 952.8390s
	iters: 300, epoch: 14 | loss: 0.2176658
	speed: 0.0238s/iter; left time: 962.0973s
	iters: 400, epoch: 14 | loss: 0.0470851
	speed: 0.0237s/iter; left time: 957.6451s
Epoch: 14 cost time: 11.619858264923096
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976843).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0077824
	speed: 0.1252s/iter; left time: 5037.4739s
	iters: 200, epoch: 15 | loss: 0.0120589
	speed: 0.0236s/iter; left time: 946.3021s
	iters: 300, epoch: 15 | loss: 0.0130656
	speed: 0.0248s/iter; left time: 991.3000s
	iters: 400, epoch: 15 | loss: 0.0226765
	speed: 0.0237s/iter; left time: 947.7637s
Epoch: 15 cost time: 11.560672521591187
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.976843).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0483445
	speed: 0.1254s/iter; left time: 4987.4672s
	iters: 200, epoch: 16 | loss: 0.0078765
	speed: 0.0239s/iter; left time: 947.4523s
	iters: 300, epoch: 16 | loss: 0.0008631
	speed: 0.0234s/iter; left time: 925.3375s
	iters: 400, epoch: 16 | loss: 0.0030708
	speed: 0.0244s/iter; left time: 961.2524s
Epoch: 16 cost time: 11.60914945602417
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0537397
	speed: 0.1305s/iter; left time: 5129.9476s
	iters: 200, epoch: 17 | loss: 0.0008955
	speed: 0.0236s/iter; left time: 925.7541s
	iters: 300, epoch: 17 | loss: 0.0004433
	speed: 0.0229s/iter; left time: 895.4710s
	iters: 400, epoch: 17 | loss: 0.0030638
	speed: 0.0229s/iter; left time: 891.5716s
Epoch: 17 cost time: 11.22723650932312
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0186032
	speed: 0.1244s/iter; left time: 4831.1235s
	iters: 200, epoch: 18 | loss: 0.1620972
	speed: 0.0228s/iter; left time: 882.9663s
	iters: 300, epoch: 18 | loss: 0.0074578
	speed: 0.0254s/iter; left time: 981.4039s
	iters: 400, epoch: 18 | loss: 0.0011154
	speed: 0.0270s/iter; left time: 1039.3793s
Epoch: 18 cost time: 11.706541538238525
Epoch: 18, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.2692669
	speed: 0.1171s/iter; left time: 4492.6230s
	iters: 200, epoch: 19 | loss: 0.0005110
	speed: 0.0197s/iter; left time: 754.8617s
	iters: 300, epoch: 19 | loss: 0.0277359
	speed: 0.0194s/iter; left time: 739.0619s
	iters: 400, epoch: 19 | loss: 0.0000988
	speed: 0.0184s/iter; left time: 701.6342s
Epoch: 19 cost time: 9.304817914962769
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0162375
	speed: 0.1103s/iter; left time: 4179.2221s
	iters: 200, epoch: 20 | loss: 0.0169442
	speed: 0.0225s/iter; left time: 848.7569s
	iters: 300, epoch: 20 | loss: 0.0029009
	speed: 0.0213s/iter; left time: 801.1520s
	iters: 400, epoch: 20 | loss: 0.0027737
	speed: 0.0210s/iter; left time: 790.1572s
Epoch: 20 cost time: 10.62966251373291
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0059311
	speed: 0.1190s/iter; left time: 4451.7514s
	iters: 200, epoch: 21 | loss: 0.0004616
	speed: 0.0234s/iter; left time: 871.5559s
	iters: 300, epoch: 21 | loss: 0.1435039
	speed: 0.0226s/iter; left time: 841.9438s
	iters: 400, epoch: 21 | loss: 0.0116822
	speed: 0.0221s/iter; left time: 821.5481s
Epoch: 21 cost time: 11.112059116363525
Epoch: 21, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0074586
	speed: 0.1260s/iter; left time: 4654.8423s
	iters: 200, epoch: 22 | loss: 0.0320452
	speed: 0.0232s/iter; left time: 856.0232s
	iters: 300, epoch: 22 | loss: 0.0087833
	speed: 0.0219s/iter; left time: 805.9804s
	iters: 400, epoch: 22 | loss: 0.0020809
	speed: 0.0236s/iter; left time: 865.9450s
Epoch: 22 cost time: 11.229544639587402
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0018171
	speed: 0.1294s/iter; left time: 4720.8593s
	iters: 200, epoch: 23 | loss: 0.0020932
	speed: 0.0240s/iter; left time: 872.9674s
	iters: 300, epoch: 23 | loss: 0.0163602
	speed: 0.0246s/iter; left time: 892.3648s
	iters: 400, epoch: 23 | loss: 0.0041522
	speed: 0.0241s/iter; left time: 872.8087s
Epoch: 23 cost time: 11.550251245498657
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.978558).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0024073
	speed: 0.1290s/iter; left time: 4647.2116s
	iters: 200, epoch: 24 | loss: 0.0009278
	speed: 0.0241s/iter; left time: 866.7724s
	iters: 300, epoch: 24 | loss: 0.0006959
	speed: 0.0245s/iter; left time: 876.6073s
	iters: 400, epoch: 24 | loss: 0.1921083
	speed: 0.0251s/iter; left time: 897.4310s
Epoch: 24 cost time: 11.709782600402832
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0003903
	speed: 0.1235s/iter; left time: 4391.4898s
	iters: 200, epoch: 25 | loss: 0.0418277
	speed: 0.0240s/iter; left time: 851.6598s
	iters: 300, epoch: 25 | loss: 0.0001106
	speed: 0.0229s/iter; left time: 810.8684s
	iters: 400, epoch: 25 | loss: 0.0802488
	speed: 0.0222s/iter; left time: 783.4896s
Epoch: 25 cost time: 11.048649787902832
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0005316
	speed: 0.1180s/iter; left time: 4137.8304s
	iters: 200, epoch: 26 | loss: 0.0006568
	speed: 0.0231s/iter; left time: 809.6871s
	iters: 300, epoch: 26 | loss: 0.0552973
	speed: 0.0229s/iter; left time: 799.0573s
	iters: 400, epoch: 26 | loss: 0.0037863
	speed: 0.0218s/iter; left time: 757.0665s
Epoch: 26 cost time: 11.177444219589233
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0068145
	speed: 0.1224s/iter; left time: 4236.4571s
	iters: 200, epoch: 27 | loss: 0.0001106
	speed: 0.0231s/iter; left time: 796.4266s
	iters: 300, epoch: 27 | loss: 0.1993058
	speed: 0.0230s/iter; left time: 789.9958s
	iters: 400, epoch: 27 | loss: 0.0346804
	speed: 0.0234s/iter; left time: 801.7068s
Epoch: 27 cost time: 11.133159160614014
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0020516
	speed: 0.1322s/iter; left time: 4514.1891s
	iters: 200, epoch: 28 | loss: 0.0018595
	speed: 0.0242s/iter; left time: 824.8270s
	iters: 300, epoch: 28 | loss: 0.0001207
	speed: 0.0236s/iter; left time: 801.1200s
	iters: 400, epoch: 28 | loss: 0.0439677
	speed: 0.0239s/iter; left time: 810.0566s
Epoch: 28 cost time: 11.528782844543457
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0068832
	speed: 0.1296s/iter; left time: 4364.1471s
	iters: 200, epoch: 29 | loss: 0.0001372
	speed: 0.0232s/iter; left time: 779.4109s
	iters: 300, epoch: 29 | loss: 0.0033135
	speed: 0.0232s/iter; left time: 777.1674s
	iters: 400, epoch: 29 | loss: 0.0002797
	speed: 0.0226s/iter; left time: 753.9045s
Epoch: 29 cost time: 11.354492425918579
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0002041
	speed: 0.1310s/iter; left time: 4350.2029s
	iters: 200, epoch: 30 | loss: 0.0306308
	speed: 0.0230s/iter; left time: 761.5769s
	iters: 300, epoch: 30 | loss: 0.0008673
	speed: 0.0225s/iter; left time: 743.6105s
	iters: 400, epoch: 30 | loss: 0.0002162
	speed: 0.0231s/iter; left time: 759.9858s
Epoch: 30 cost time: 11.245757102966309
Epoch: 30, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0002360
	speed: 0.1226s/iter; left time: 4012.6182s
	iters: 200, epoch: 31 | loss: 0.0071695
	speed: 0.0227s/iter; left time: 739.9454s
	iters: 300, epoch: 31 | loss: 0.0146900
	speed: 0.0227s/iter; left time: 739.7148s
	iters: 400, epoch: 31 | loss: 0.1303615
	speed: 0.0243s/iter; left time: 787.7379s
Epoch: 31 cost time: 11.326520442962646
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0032012
	speed: 0.1205s/iter; left time: 3886.2707s
	iters: 200, epoch: 32 | loss: 0.0007954
	speed: 0.0239s/iter; left time: 768.2608s
	iters: 300, epoch: 32 | loss: 0.0001216
	speed: 0.0233s/iter; left time: 745.4767s
	iters: 400, epoch: 32 | loss: 0.0013994
	speed: 0.0227s/iter; left time: 725.5856s
Epoch: 32 cost time: 11.271806478500366
Epoch: 32, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.2526897
	speed: 0.1285s/iter; left time: 4086.4568s
	iters: 200, epoch: 33 | loss: 0.0004875
	speed: 0.0246s/iter; left time: 779.9632s
	iters: 300, epoch: 33 | loss: 0.0024698
	speed: 0.0238s/iter; left time: 750.7525s
	iters: 400, epoch: 33 | loss: 0.0003863
	speed: 0.0245s/iter; left time: 771.7665s
Epoch: 33 cost time: 11.864028692245483
Epoch: 33, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 276898
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4370437
	speed: 0.0440s/iter; left time: 2057.9325s
	iters: 200, epoch: 1 | loss: 0.5146956
	speed: 0.0242s/iter; left time: 1131.8681s
	iters: 300, epoch: 1 | loss: 0.4623842
	speed: 0.0248s/iter; left time: 1154.2561s
	iters: 400, epoch: 1 | loss: 0.3530332
	speed: 0.0246s/iter; left time: 1143.7726s
Epoch: 1 cost time: 13.547715187072754
Epoch: 1, Steps: 469 | Train Loss: 0.841 Vali Loss: 0.419 Vali Acc: 0.867 Test Loss: 0.419 Test Acc: 0.867
Validation loss decreased (inf --> -0.867349).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2450346
	speed: 0.1249s/iter; left time: 5785.7606s
	iters: 200, epoch: 2 | loss: 0.4366968
	speed: 0.0217s/iter; left time: 1001.4763s
	iters: 300, epoch: 2 | loss: 0.0464683
	speed: 0.0219s/iter; left time: 1012.0931s
	iters: 400, epoch: 2 | loss: 0.1681860
	speed: 0.0230s/iter; left time: 1059.8904s
Epoch: 2 cost time: 10.9982271194458
Epoch: 2, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
Validation loss decreased (-0.867349 --> -0.935103).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1260356
	speed: 0.1247s/iter; left time: 5720.6241s
	iters: 200, epoch: 3 | loss: 0.0823190
	speed: 0.0233s/iter; left time: 1068.5374s
	iters: 300, epoch: 3 | loss: 0.0437417
	speed: 0.0244s/iter; left time: 1112.6635s
	iters: 400, epoch: 3 | loss: 0.1970223
	speed: 0.0259s/iter; left time: 1178.5408s
Epoch: 3 cost time: 11.707430601119995
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
Validation loss decreased (-0.935103 --> -0.953400).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0363072
	speed: 0.1334s/iter; left time: 6057.1632s
	iters: 200, epoch: 4 | loss: 0.1288248
	speed: 0.0260s/iter; left time: 1178.1796s
	iters: 300, epoch: 4 | loss: 0.1787423
	speed: 0.0241s/iter; left time: 1089.8891s
	iters: 400, epoch: 4 | loss: 0.1340333
	speed: 0.0234s/iter; left time: 1053.3155s
Epoch: 4 cost time: 11.829338312149048
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.953400 --> -0.955973).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0426396
	speed: 0.1338s/iter; left time: 6010.8353s
	iters: 200, epoch: 5 | loss: 0.1190365
	speed: 0.0232s/iter; left time: 1040.9626s
	iters: 300, epoch: 5 | loss: 0.0985754
	speed: 0.0242s/iter; left time: 1083.4302s
	iters: 400, epoch: 5 | loss: 0.1133336
	speed: 0.0248s/iter; left time: 1108.5797s
Epoch: 5 cost time: 11.620404243469238
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.955973 --> -0.962549).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0810641
	speed: 0.1268s/iter; left time: 5637.0761s
	iters: 200, epoch: 6 | loss: 0.0138861
	speed: 0.0236s/iter; left time: 1047.1815s
	iters: 300, epoch: 6 | loss: 0.0345482
	speed: 0.0245s/iter; left time: 1083.0849s
	iters: 400, epoch: 6 | loss: 0.0156776
	speed: 0.0254s/iter; left time: 1122.3466s
Epoch: 6 cost time: 11.89987301826477
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0330734
	speed: 0.1302s/iter; left time: 5729.1355s
	iters: 200, epoch: 7 | loss: 0.2252223
	speed: 0.0230s/iter; left time: 1007.3287s
	iters: 300, epoch: 7 | loss: 0.1115856
	speed: 0.0215s/iter; left time: 941.1967s
	iters: 400, epoch: 7 | loss: 0.0326396
	speed: 0.0247s/iter; left time: 1079.8412s
Epoch: 7 cost time: 11.43999457359314
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0444582
	speed: 0.1388s/iter; left time: 6040.1339s
	iters: 200, epoch: 8 | loss: 0.0141499
	speed: 0.0249s/iter; left time: 1081.2491s
	iters: 300, epoch: 8 | loss: 0.0235808
	speed: 0.0243s/iter; left time: 1051.3772s
	iters: 400, epoch: 8 | loss: 0.0064805
	speed: 0.0255s/iter; left time: 1101.0703s
Epoch: 8 cost time: 12.053334712982178
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0244708
	speed: 0.1391s/iter; left time: 5988.3829s
	iters: 200, epoch: 9 | loss: 0.0257995
	speed: 0.0254s/iter; left time: 1091.2853s
	iters: 300, epoch: 9 | loss: 0.2321025
	speed: 0.0257s/iter; left time: 1101.4876s
	iters: 400, epoch: 9 | loss: 0.0367339
	speed: 0.0270s/iter; left time: 1154.4384s
Epoch: 9 cost time: 12.645017147064209
Epoch: 9, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.962549 --> -0.967981).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0110785
	speed: 0.1310s/iter; left time: 5578.4280s
	iters: 200, epoch: 10 | loss: 0.0042218
	speed: 0.0251s/iter; left time: 1064.7626s
	iters: 300, epoch: 10 | loss: 0.0579927
	speed: 0.0241s/iter; left time: 1019.3818s
	iters: 400, epoch: 10 | loss: 0.0714889
	speed: 0.0240s/iter; left time: 1015.1226s
Epoch: 10 cost time: 11.862184286117554
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.967981 --> -0.971697).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0205794
	speed: 0.1286s/iter; left time: 5413.8389s
	iters: 200, epoch: 11 | loss: 0.0157328
	speed: 0.0237s/iter; left time: 995.5296s
	iters: 300, epoch: 11 | loss: 0.0036721
	speed: 0.0239s/iter; left time: 1000.6271s
	iters: 400, epoch: 11 | loss: 0.0746431
	speed: 0.0228s/iter; left time: 951.3389s
Epoch: 11 cost time: 11.553461790084839
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.973126).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0457800
	speed: 0.1266s/iter; left time: 5272.9108s
	iters: 200, epoch: 12 | loss: 0.2871924
	speed: 0.0238s/iter; left time: 990.4118s
	iters: 300, epoch: 12 | loss: 0.0064736
	speed: 0.0246s/iter; left time: 1018.1380s
	iters: 400, epoch: 12 | loss: 0.1070471
	speed: 0.0245s/iter; left time: 1013.4712s
Epoch: 12 cost time: 11.90062141418457
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0340915
	speed: 0.1359s/iter; left time: 5593.4121s
	iters: 200, epoch: 13 | loss: 0.0023682
	speed: 0.0251s/iter; left time: 1032.6819s
	iters: 300, epoch: 13 | loss: 0.0101605
	speed: 0.0224s/iter; left time: 919.5198s
	iters: 400, epoch: 13 | loss: 0.0036820
	speed: 0.0248s/iter; left time: 1015.4435s
Epoch: 13 cost time: 11.882030487060547
Epoch: 13, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0288753
	speed: 0.1379s/iter; left time: 5612.7190s
	iters: 200, epoch: 14 | loss: 0.0008903
	speed: 0.0241s/iter; left time: 977.6310s
	iters: 300, epoch: 14 | loss: 0.0116052
	speed: 0.0236s/iter; left time: 955.2669s
	iters: 400, epoch: 14 | loss: 0.0507679
	speed: 0.0240s/iter; left time: 970.8334s
Epoch: 14 cost time: 11.739785432815552
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0101529
	speed: 0.1300s/iter; left time: 5230.4502s
	iters: 200, epoch: 15 | loss: 0.0106491
	speed: 0.0245s/iter; left time: 983.5502s
	iters: 300, epoch: 15 | loss: 0.0109085
	speed: 0.0249s/iter; left time: 997.9325s
	iters: 400, epoch: 15 | loss: 0.0121279
	speed: 0.0250s/iter; left time: 999.8627s
Epoch: 15 cost time: 12.07650089263916
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.974270).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0096800
	speed: 0.1320s/iter; left time: 5250.2765s
	iters: 200, epoch: 16 | loss: 0.0014509
	speed: 0.0240s/iter; left time: 950.8791s
	iters: 300, epoch: 16 | loss: 0.0031760
	speed: 0.0249s/iter; left time: 986.6064s
	iters: 400, epoch: 16 | loss: 0.0179868
	speed: 0.0252s/iter; left time: 993.7378s
Epoch: 16 cost time: 12.104628324508667
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0022383
	speed: 0.1295s/iter; left time: 5088.2419s
	iters: 200, epoch: 17 | loss: 0.0304213
	speed: 0.0245s/iter; left time: 961.0342s
	iters: 300, epoch: 17 | loss: 0.1065572
	speed: 0.0251s/iter; left time: 980.7818s
	iters: 400, epoch: 17 | loss: 0.0179749
	speed: 0.0246s/iter; left time: 958.6964s
Epoch: 17 cost time: 12.302737951278687
Epoch: 17, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0052796
	speed: 0.1369s/iter; left time: 5316.2292s
	iters: 200, epoch: 18 | loss: 0.0506143
	speed: 0.0259s/iter; left time: 1002.8220s
	iters: 300, epoch: 18 | loss: 0.0017287
	speed: 0.0253s/iter; left time: 979.2043s
	iters: 400, epoch: 18 | loss: 0.0224992
	speed: 0.0249s/iter; left time: 958.3176s
Epoch: 18 cost time: 12.515709638595581
Epoch: 18, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.974270 --> -0.974270).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0519851
	speed: 0.1329s/iter; left time: 5098.3711s
	iters: 200, epoch: 19 | loss: 0.0400932
	speed: 0.0238s/iter; left time: 908.6988s
	iters: 300, epoch: 19 | loss: 0.0007773
	speed: 0.0253s/iter; left time: 966.3659s
	iters: 400, epoch: 19 | loss: 0.0950830
	speed: 0.0254s/iter; left time: 968.5019s
Epoch: 19 cost time: 12.142431259155273
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.974270 --> -0.979702).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0007985
	speed: 0.1282s/iter; left time: 4859.2823s
	iters: 200, epoch: 20 | loss: 0.0837501
	speed: 0.0241s/iter; left time: 909.9545s
	iters: 300, epoch: 20 | loss: 0.0659916
	speed: 0.0250s/iter; left time: 943.8470s
	iters: 400, epoch: 20 | loss: 0.0477595
	speed: 0.0233s/iter; left time: 874.8413s
Epoch: 20 cost time: 11.767524242401123
Epoch: 20, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1438041
	speed: 0.1314s/iter; left time: 4915.2942s
	iters: 200, epoch: 21 | loss: 0.0128804
	speed: 0.0240s/iter; left time: 896.2740s
	iters: 300, epoch: 21 | loss: 0.0026765
	speed: 0.0234s/iter; left time: 871.0545s
	iters: 400, epoch: 21 | loss: 0.0496217
	speed: 0.0233s/iter; left time: 866.6189s
Epoch: 21 cost time: 11.694950819015503
Epoch: 21, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980559).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0009808
	speed: 0.1309s/iter; left time: 4835.9339s
	iters: 200, epoch: 22 | loss: 0.0005060
	speed: 0.0231s/iter; left time: 852.7571s
	iters: 300, epoch: 22 | loss: 0.0840870
	speed: 0.0243s/iter; left time: 892.8301s
	iters: 400, epoch: 22 | loss: 0.0007416
	speed: 0.0223s/iter; left time: 817.0511s
Epoch: 22 cost time: 11.434137344360352
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1302912
	speed: 0.1347s/iter; left time: 4913.9444s
	iters: 200, epoch: 23 | loss: 0.0017554
	speed: 0.0237s/iter; left time: 862.9644s
	iters: 300, epoch: 23 | loss: 0.7951113
	speed: 0.0240s/iter; left time: 869.9711s
	iters: 400, epoch: 23 | loss: 0.0573441
	speed: 0.0234s/iter; left time: 847.2069s
Epoch: 23 cost time: 11.670361518859863
Epoch: 23, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0069208
	speed: 0.1232s/iter; left time: 4437.9456s
	iters: 200, epoch: 24 | loss: 0.0006499
	speed: 0.0239s/iter; left time: 859.5072s
	iters: 300, epoch: 24 | loss: 0.0260934
	speed: 0.0242s/iter; left time: 867.4302s
	iters: 400, epoch: 24 | loss: 0.0006529
	speed: 0.0228s/iter; left time: 816.0457s
Epoch: 24 cost time: 11.580447912216187
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.980559).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0060064
	speed: 0.1239s/iter; left time: 4404.6010s
	iters: 200, epoch: 25 | loss: 0.0010927
	speed: 0.0232s/iter; left time: 822.6558s
	iters: 300, epoch: 25 | loss: 0.0479672
	speed: 0.0239s/iter; left time: 843.5692s
	iters: 400, epoch: 25 | loss: 0.0018521
	speed: 0.0234s/iter; left time: 825.4997s
Epoch: 25 cost time: 11.645136833190918
Epoch: 25, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0204419
	speed: 0.1292s/iter; left time: 4532.9355s
	iters: 200, epoch: 26 | loss: 0.0028835
	speed: 0.0256s/iter; left time: 895.5288s
	iters: 300, epoch: 26 | loss: 0.1010380
	speed: 0.0239s/iter; left time: 832.3090s
	iters: 400, epoch: 26 | loss: 0.0012583
	speed: 0.0249s/iter; left time: 866.7117s
Epoch: 26 cost time: 12.119664192199707
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.980845).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0008693
	speed: 0.1428s/iter; left time: 4940.7745s
	iters: 200, epoch: 27 | loss: 0.0026550
	speed: 0.0245s/iter; left time: 845.9434s
	iters: 300, epoch: 27 | loss: 0.0368949
	speed: 0.0247s/iter; left time: 850.6962s
	iters: 400, epoch: 27 | loss: 0.1028379
	speed: 0.0259s/iter; left time: 888.4208s
Epoch: 27 cost time: 12.156788349151611
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0007327
	speed: 0.1374s/iter; left time: 4691.0994s
	iters: 200, epoch: 28 | loss: 0.0093619
	speed: 0.0247s/iter; left time: 841.5648s
	iters: 300, epoch: 28 | loss: 0.0022984
	speed: 0.0221s/iter; left time: 748.9348s
	iters: 400, epoch: 28 | loss: 0.0016381
	speed: 0.0237s/iter; left time: 802.0713s
Epoch: 28 cost time: 11.574594736099243
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0003049
	speed: 0.1316s/iter; left time: 4430.2971s
	iters: 200, epoch: 29 | loss: 0.0015665
	speed: 0.0248s/iter; left time: 831.2884s
	iters: 300, epoch: 29 | loss: 0.0060221
	speed: 0.0233s/iter; left time: 778.9869s
	iters: 400, epoch: 29 | loss: 0.0005570
	speed: 0.0246s/iter; left time: 820.5555s
Epoch: 29 cost time: 11.735386371612549
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0141018
	speed: 0.1303s/iter; left time: 4327.0575s
	iters: 200, epoch: 30 | loss: 0.0434716
	speed: 0.0245s/iter; left time: 810.9385s
	iters: 300, epoch: 30 | loss: 0.0105424
	speed: 0.0248s/iter; left time: 818.3476s
	iters: 400, epoch: 30 | loss: 0.1922193
	speed: 0.0247s/iter; left time: 811.6072s
Epoch: 30 cost time: 11.987475872039795
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0003631
	speed: 0.1275s/iter; left time: 4174.6283s
	iters: 200, epoch: 31 | loss: 0.2595822
	speed: 0.0226s/iter; left time: 738.7486s
	iters: 300, epoch: 31 | loss: 0.0123887
	speed: 0.0233s/iter; left time: 758.2293s
	iters: 400, epoch: 31 | loss: 0.0000163
	speed: 0.0248s/iter; left time: 803.2989s
Epoch: 31 cost time: 11.592878818511963
Epoch: 31, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.4184207
	speed: 0.1317s/iter; left time: 4250.4311s
	iters: 200, epoch: 32 | loss: 0.0016984
	speed: 0.0250s/iter; left time: 805.3422s
	iters: 300, epoch: 32 | loss: 0.1810862
	speed: 0.0242s/iter; left time: 776.9654s
	iters: 400, epoch: 32 | loss: 0.0135817
	speed: 0.0245s/iter; left time: 782.2330s
Epoch: 32 cost time: 11.96638011932373
Epoch: 32, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0005429
	speed: 0.1333s/iter; left time: 4238.2829s
	iters: 200, epoch: 33 | loss: 0.0683429
	speed: 0.0241s/iter; left time: 762.8400s
	iters: 300, epoch: 33 | loss: 0.0589846
	speed: 0.0233s/iter; left time: 737.3605s
	iters: 400, epoch: 33 | loss: 0.1519707
	speed: 0.0243s/iter; left time: 764.7353s
Epoch: 33 cost time: 11.801998138427734
Epoch: 33, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0004373
	speed: 0.1311s/iter; left time: 4106.0855s
	iters: 200, epoch: 34 | loss: 0.0134636
	speed: 0.0232s/iter; left time: 722.9118s
	iters: 300, epoch: 34 | loss: 0.0000538
	speed: 0.0238s/iter; left time: 739.5598s
	iters: 400, epoch: 34 | loss: 0.0023629
	speed: 0.0243s/iter; left time: 754.6358s
Epoch: 34 cost time: 11.662848711013794
Epoch: 34, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0004281
	speed: 0.1328s/iter; left time: 4097.0606s
	iters: 200, epoch: 35 | loss: 0.0045229
	speed: 0.0243s/iter; left time: 748.5227s
	iters: 300, epoch: 35 | loss: 0.0059652
	speed: 0.0237s/iter; left time: 725.6721s
	iters: 400, epoch: 35 | loss: 0.0001393
	speed: 0.0234s/iter; left time: 715.4484s
Epoch: 35 cost time: 11.587313413619995
Epoch: 35, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0038567
	speed: 0.1363s/iter; left time: 4140.3217s
	iters: 200, epoch: 36 | loss: 0.0045922
	speed: 0.0229s/iter; left time: 693.0118s
	iters: 300, epoch: 36 | loss: 0.0193030
	speed: 0.0237s/iter; left time: 714.7545s
	iters: 400, epoch: 36 | loss: 0.0001974
	speed: 0.0236s/iter; left time: 710.7837s
Epoch: 36 cost time: 11.603522062301636
Epoch: 36, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 145826
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4490330
	speed: 0.0420s/iter; left time: 1965.7029s
	iters: 200, epoch: 1 | loss: 0.5697045
	speed: 0.0244s/iter; left time: 1140.3603s
	iters: 300, epoch: 1 | loss: 0.4817176
	speed: 0.0243s/iter; left time: 1132.6619s
	iters: 400, epoch: 1 | loss: 0.3937080
	speed: 0.0235s/iter; left time: 1090.6114s
Epoch: 1 cost time: 13.101370811462402
Epoch: 1, Steps: 469 | Train Loss: 0.871 Vali Loss: 0.420 Vali Acc: 0.866 Test Loss: 0.420 Test Acc: 0.866
Validation loss decreased (inf --> -0.866491).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3084441
	speed: 0.1260s/iter; left time: 5839.2238s
	iters: 200, epoch: 2 | loss: 0.4041719
	speed: 0.0233s/iter; left time: 1079.3089s
	iters: 300, epoch: 2 | loss: 0.0406736
	speed: 0.0238s/iter; left time: 1096.9764s
	iters: 400, epoch: 2 | loss: 0.1705892
	speed: 0.0232s/iter; left time: 1066.8260s
Epoch: 2 cost time: 11.349802494049072
Epoch: 2, Steps: 469 | Train Loss: 0.222 Vali Loss: 0.232 Vali Acc: 0.940 Test Loss: 0.232 Test Acc: 0.940
Validation loss decreased (-0.866491 --> -0.939678).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0995091
	speed: 0.1248s/iter; left time: 5723.3587s
	iters: 200, epoch: 3 | loss: 0.0710842
	speed: 0.0230s/iter; left time: 1053.9167s
	iters: 300, epoch: 3 | loss: 0.0312578
	speed: 0.0235s/iter; left time: 1074.2578s
	iters: 400, epoch: 3 | loss: 0.1205515
	speed: 0.0223s/iter; left time: 1017.1800s
Epoch: 3 cost time: 11.330774307250977
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.180 Vali Acc: 0.955 Test Loss: 0.180 Test Acc: 0.955
Validation loss decreased (-0.939678 --> -0.955401).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0396493
	speed: 0.1352s/iter; left time: 6137.3232s
	iters: 200, epoch: 4 | loss: 0.2426589
	speed: 0.0237s/iter; left time: 1073.1616s
	iters: 300, epoch: 4 | loss: 0.0466476
	speed: 0.0236s/iter; left time: 1068.7370s
	iters: 400, epoch: 4 | loss: 0.1762350
	speed: 0.0244s/iter; left time: 1102.0947s
Epoch: 4 cost time: 11.644503355026245
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0443914
	speed: 0.1359s/iter; left time: 6106.0056s
	iters: 200, epoch: 5 | loss: 0.1349853
	speed: 0.0232s/iter; left time: 1039.3381s
	iters: 300, epoch: 5 | loss: 0.0498605
	speed: 0.0235s/iter; left time: 1049.8220s
	iters: 400, epoch: 5 | loss: 0.1000583
	speed: 0.0235s/iter; left time: 1050.2300s
Epoch: 5 cost time: 11.60645580291748
Epoch: 5, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.955401 --> -0.961405).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0736590
	speed: 0.1311s/iter; left time: 5827.2930s
	iters: 200, epoch: 6 | loss: 0.0274032
	speed: 0.0234s/iter; left time: 1038.7973s
	iters: 300, epoch: 6 | loss: 0.0110348
	speed: 0.0233s/iter; left time: 1030.1824s
	iters: 400, epoch: 6 | loss: 0.0269603
	speed: 0.0224s/iter; left time: 990.9152s
Epoch: 6 cost time: 11.382364511489868
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
Validation loss decreased (-0.961405 --> -0.965693).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0356764
	speed: 0.1322s/iter; left time: 5813.7642s
	iters: 200, epoch: 7 | loss: 0.2576061
	speed: 0.0246s/iter; left time: 1081.3786s
	iters: 300, epoch: 7 | loss: 0.0564728
	speed: 0.0243s/iter; left time: 1064.7759s
	iters: 400, epoch: 7 | loss: 0.0164774
	speed: 0.0238s/iter; left time: 1039.1979s
Epoch: 7 cost time: 11.923281908035278
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0848424
	speed: 0.1260s/iter; left time: 5483.0005s
	iters: 200, epoch: 8 | loss: 0.0109133
	speed: 0.0247s/iter; left time: 1073.4717s
	iters: 300, epoch: 8 | loss: 0.0317537
	speed: 0.0238s/iter; left time: 1032.5525s
	iters: 400, epoch: 8 | loss: 0.0072722
	speed: 0.0234s/iter; left time: 1012.9235s
Epoch: 8 cost time: 11.695790529251099
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0026258
	speed: 0.1356s/iter; left time: 5838.6137s
	iters: 200, epoch: 9 | loss: 0.0092966
	speed: 0.0247s/iter; left time: 1059.8850s
	iters: 300, epoch: 9 | loss: 0.1633120
	speed: 0.0245s/iter; left time: 1048.8286s
	iters: 400, epoch: 9 | loss: 0.0408345
	speed: 0.0233s/iter; left time: 994.0383s
Epoch: 9 cost time: 11.801757335662842
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0080340
	speed: 0.1368s/iter; left time: 5826.4242s
	iters: 200, epoch: 10 | loss: 0.0034464
	speed: 0.0243s/iter; left time: 1034.0439s
	iters: 300, epoch: 10 | loss: 0.0780918
	speed: 0.0236s/iter; left time: 1000.7144s
	iters: 400, epoch: 10 | loss: 0.0764409
	speed: 0.0215s/iter; left time: 910.8610s
Epoch: 10 cost time: 11.360204696655273
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.965693 --> -0.972841).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0675957
	speed: 0.1287s/iter; left time: 5419.8496s
	iters: 200, epoch: 11 | loss: 0.0145694
	speed: 0.0231s/iter; left time: 972.5150s
	iters: 300, epoch: 11 | loss: 0.0045348
	speed: 0.0238s/iter; left time: 996.3500s
	iters: 400, epoch: 11 | loss: 0.0453319
	speed: 0.0237s/iter; left time: 989.9415s
Epoch: 11 cost time: 11.48862910270691
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0234237
	speed: 0.1294s/iter; left time: 5388.0461s
	iters: 200, epoch: 12 | loss: 0.1683863
	speed: 0.0225s/iter; left time: 935.4467s
	iters: 300, epoch: 12 | loss: 0.0056487
	speed: 0.0242s/iter; left time: 1001.9005s
	iters: 400, epoch: 12 | loss: 0.1351582
	speed: 0.0237s/iter; left time: 978.0385s
Epoch: 12 cost time: 11.483853340148926
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0111655
	speed: 0.1307s/iter; left time: 5381.4374s
	iters: 200, epoch: 13 | loss: 0.0060945
	speed: 0.0247s/iter; left time: 1014.9086s
	iters: 300, epoch: 13 | loss: 0.0482433
	speed: 0.0236s/iter; left time: 968.3009s
	iters: 400, epoch: 13 | loss: 0.0602583
	speed: 0.0232s/iter; left time: 947.6109s
Epoch: 13 cost time: 11.796497583389282
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0266164
	speed: 0.1341s/iter; left time: 5456.5371s
	iters: 200, epoch: 14 | loss: 0.0046048
	speed: 0.0230s/iter; left time: 934.6427s
	iters: 300, epoch: 14 | loss: 0.0042220
	speed: 0.0235s/iter; left time: 950.1968s
	iters: 400, epoch: 14 | loss: 0.1619307
	speed: 0.0239s/iter; left time: 966.4680s
Epoch: 14 cost time: 11.613914966583252
Epoch: 14, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0317892
	speed: 0.1344s/iter; left time: 5405.6457s
	iters: 200, epoch: 15 | loss: 0.0127878
	speed: 0.0223s/iter; left time: 896.8857s
	iters: 300, epoch: 15 | loss: 0.0005696
	speed: 0.0221s/iter; left time: 885.2070s
	iters: 400, epoch: 15 | loss: 0.0561361
	speed: 0.0235s/iter; left time: 939.6571s
Epoch: 15 cost time: 11.128748655319214
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.974270).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0178211
	speed: 0.1215s/iter; left time: 4829.7141s
	iters: 200, epoch: 16 | loss: 0.0007926
	speed: 0.0241s/iter; left time: 955.7139s
	iters: 300, epoch: 16 | loss: 0.0022530
	speed: 0.0237s/iter; left time: 939.3602s
	iters: 400, epoch: 16 | loss: 0.0928286
	speed: 0.0245s/iter; left time: 968.5792s
Epoch: 16 cost time: 11.600828647613525
Epoch: 16, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0010340
	speed: 0.1248s/iter; left time: 4904.0206s
	iters: 200, epoch: 17 | loss: 0.0169332
	speed: 0.0256s/iter; left time: 1003.0711s
	iters: 300, epoch: 17 | loss: 0.0575865
	speed: 0.0234s/iter; left time: 915.3953s
	iters: 400, epoch: 17 | loss: 0.0404089
	speed: 0.0234s/iter; left time: 913.9268s
Epoch: 17 cost time: 11.69873857498169
Epoch: 17, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0028585
	speed: 0.1236s/iter; left time: 4800.6678s
	iters: 200, epoch: 18 | loss: 0.0220506
	speed: 0.0239s/iter; left time: 926.0602s
	iters: 300, epoch: 18 | loss: 0.0003613
	speed: 0.0234s/iter; left time: 904.6516s
	iters: 400, epoch: 18 | loss: 0.0217540
	speed: 0.0236s/iter; left time: 908.5430s
Epoch: 18 cost time: 11.610361814498901
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.974270 --> -0.976557).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0507713
	speed: 0.1386s/iter; left time: 5317.2683s
	iters: 200, epoch: 19 | loss: 0.0015527
	speed: 0.0238s/iter; left time: 908.6873s
	iters: 300, epoch: 19 | loss: 0.0026331
	speed: 0.0240s/iter; left time: 916.5965s
	iters: 400, epoch: 19 | loss: 0.2736606
	speed: 0.0241s/iter; left time: 918.1994s
Epoch: 19 cost time: 11.606314420700073
Epoch: 19, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0001968
	speed: 0.1403s/iter; left time: 5315.3256s
	iters: 200, epoch: 20 | loss: 0.0320709
	speed: 0.0235s/iter; left time: 889.0403s
	iters: 300, epoch: 20 | loss: 0.1879065
	speed: 0.0233s/iter; left time: 877.8562s
	iters: 400, epoch: 20 | loss: 0.0253395
	speed: 0.0233s/iter; left time: 875.6332s
Epoch: 20 cost time: 11.580238103866577
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.976557 --> -0.980273).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.2931890
	speed: 0.1252s/iter; left time: 4685.0591s
	iters: 200, epoch: 21 | loss: 0.0127819
	speed: 0.0234s/iter; left time: 873.3406s
	iters: 300, epoch: 21 | loss: 0.0072478
	speed: 0.0229s/iter; left time: 853.7013s
	iters: 400, epoch: 21 | loss: 0.0477759
	speed: 0.0226s/iter; left time: 840.2259s
Epoch: 21 cost time: 11.144165277481079
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.980559).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0053665
	speed: 0.1228s/iter; left time: 4538.7922s
	iters: 200, epoch: 22 | loss: 0.0076634
	speed: 0.0225s/iter; left time: 828.3622s
	iters: 300, epoch: 22 | loss: 0.0223962
	speed: 0.0226s/iter; left time: 829.9720s
	iters: 400, epoch: 22 | loss: 0.0102362
	speed: 0.0232s/iter; left time: 851.6572s
Epoch: 22 cost time: 11.054957628250122
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1981861
	speed: 0.1229s/iter; left time: 4482.9820s
	iters: 200, epoch: 23 | loss: 0.0077027
	speed: 0.0237s/iter; left time: 862.7980s
	iters: 300, epoch: 23 | loss: 0.8649910
	speed: 0.0251s/iter; left time: 909.9663s
	iters: 400, epoch: 23 | loss: 0.0560261
	speed: 0.0245s/iter; left time: 885.6449s
Epoch: 23 cost time: 11.777264595031738
Epoch: 23, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0129419
	speed: 0.1368s/iter; left time: 4926.9420s
	iters: 200, epoch: 24 | loss: 0.0002845
	speed: 0.0224s/iter; left time: 803.5844s
	iters: 300, epoch: 24 | loss: 0.0324818
	speed: 0.0242s/iter; left time: 865.9798s
	iters: 400, epoch: 24 | loss: 0.0008739
	speed: 0.0247s/iter; left time: 881.3599s
Epoch: 24 cost time: 11.553146362304688
Epoch: 24, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0175131
	speed: 0.1409s/iter; left time: 5009.1873s
	iters: 200, epoch: 25 | loss: 0.0003385
	speed: 0.0244s/iter; left time: 865.8572s
	iters: 300, epoch: 25 | loss: 0.0221950
	speed: 0.0234s/iter; left time: 825.5324s
	iters: 400, epoch: 25 | loss: 0.0089516
	speed: 0.0232s/iter; left time: 816.2625s
Epoch: 25 cost time: 11.66062045097351
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0036034
	speed: 0.1257s/iter; left time: 4409.9945s
	iters: 200, epoch: 26 | loss: 0.0035945
	speed: 0.0239s/iter; left time: 835.0981s
	iters: 300, epoch: 26 | loss: 0.0377756
	speed: 0.0242s/iter; left time: 844.5714s
	iters: 400, epoch: 26 | loss: 0.0004727
	speed: 0.0234s/iter; left time: 814.5446s
Epoch: 26 cost time: 11.59361720085144
Epoch: 26, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.981989).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0219836
	speed: 0.1236s/iter; left time: 4277.4241s
	iters: 200, epoch: 27 | loss: 0.0214524
	speed: 0.0235s/iter; left time: 811.7033s
	iters: 300, epoch: 27 | loss: 0.0009945
	speed: 0.0239s/iter; left time: 822.6820s
	iters: 400, epoch: 27 | loss: 0.1997231
	speed: 0.0238s/iter; left time: 816.7906s
Epoch: 27 cost time: 11.4875168800354
Epoch: 27, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0025603
	speed: 0.1216s/iter; left time: 4151.1396s
	iters: 200, epoch: 28 | loss: 0.0057948
	speed: 0.0243s/iter; left time: 827.0736s
	iters: 300, epoch: 28 | loss: 0.0325654
	speed: 0.0239s/iter; left time: 812.5478s
	iters: 400, epoch: 28 | loss: 0.0078404
	speed: 0.0242s/iter; left time: 820.4364s
Epoch: 28 cost time: 11.734553337097168
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0007912
	speed: 0.1322s/iter; left time: 4449.6964s
	iters: 200, epoch: 29 | loss: 0.0031379
	speed: 0.0250s/iter; left time: 838.8937s
	iters: 300, epoch: 29 | loss: 0.0010435
	speed: 0.0230s/iter; left time: 768.7361s
	iters: 400, epoch: 29 | loss: 0.0004713
	speed: 0.0254s/iter; left time: 848.5603s
Epoch: 29 cost time: 11.742041826248169
Epoch: 29, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0083095
	speed: 0.1376s/iter; left time: 4569.4595s
	iters: 200, epoch: 30 | loss: 0.1701672
	speed: 0.0224s/iter; left time: 741.7315s
	iters: 300, epoch: 30 | loss: 0.0091102
	speed: 0.0217s/iter; left time: 715.1704s
	iters: 400, epoch: 30 | loss: 0.0315262
	speed: 0.0228s/iter; left time: 750.5122s
Epoch: 30 cost time: 11.188297033309937
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0007599
	speed: 0.1137s/iter; left time: 3720.9138s
	iters: 200, epoch: 31 | loss: 0.2147173
	speed: 0.0218s/iter; left time: 711.4991s
	iters: 300, epoch: 31 | loss: 0.0011854
	speed: 0.0229s/iter; left time: 743.9089s
	iters: 400, epoch: 31 | loss: 0.0000899
	speed: 0.0226s/iter; left time: 732.9651s
Epoch: 31 cost time: 10.869325160980225
Epoch: 31, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.4156153
	speed: 0.1239s/iter; left time: 3998.2890s
	iters: 200, epoch: 32 | loss: 0.0448328
	speed: 0.0228s/iter; left time: 732.6848s
	iters: 300, epoch: 32 | loss: 0.1223372
	speed: 0.0236s/iter; left time: 755.2608s
	iters: 400, epoch: 32 | loss: 0.0024296
	speed: 0.0225s/iter; left time: 720.3467s
Epoch: 32 cost time: 11.203547954559326
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0018122
	speed: 0.1286s/iter; left time: 4089.3038s
	iters: 200, epoch: 33 | loss: 0.0374935
	speed: 0.0242s/iter; left time: 765.5653s
	iters: 300, epoch: 33 | loss: 0.3422820
	speed: 0.0256s/iter; left time: 810.2251s
	iters: 400, epoch: 33 | loss: 0.1192934
	speed: 0.0240s/iter; left time: 756.3754s
Epoch: 33 cost time: 11.927846670150757
Epoch: 33, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0185963
	speed: 0.1347s/iter; left time: 4218.5404s
	iters: 200, epoch: 34 | loss: 0.0032275
	speed: 0.0234s/iter; left time: 729.8767s
	iters: 300, epoch: 34 | loss: 0.0000564
	speed: 0.0242s/iter; left time: 751.9795s
	iters: 400, epoch: 34 | loss: 0.0019652
	speed: 0.0251s/iter; left time: 779.8633s
Epoch: 34 cost time: 11.841919422149658
Epoch: 34, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0002871
	speed: 0.1378s/iter; left time: 4252.5186s
	iters: 200, epoch: 35 | loss: 0.0280326
	speed: 0.0217s/iter; left time: 666.5737s
	iters: 300, epoch: 35 | loss: 0.0598616
	speed: 0.0242s/iter; left time: 740.9605s
	iters: 400, epoch: 35 | loss: 0.0000081
	speed: 0.0269s/iter; left time: 822.6131s
Epoch: 35 cost time: 11.984290838241577
Epoch: 35, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0037609
	speed: 0.1303s/iter; left time: 3958.1209s
	iters: 200, epoch: 36 | loss: 0.1402203
	speed: 0.0194s/iter; left time: 587.2005s
	iters: 300, epoch: 36 | loss: 0.0085554
	speed: 0.0194s/iter; left time: 585.5521s
	iters: 400, epoch: 36 | loss: 0.0006751
	speed: 0.0200s/iter; left time: 601.4369s
Epoch: 36 cost time: 9.710420608520508
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9819897084048027
model parameter : 145826
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5381062
	speed: 0.0403s/iter; left time: 1884.3628s
	iters: 200, epoch: 1 | loss: 0.6614063
	speed: 0.0218s/iter; left time: 1016.2570s
	iters: 300, epoch: 1 | loss: 0.6368771
	speed: 0.0219s/iter; left time: 1018.3520s
	iters: 400, epoch: 1 | loss: 0.3863347
	speed: 0.0227s/iter; left time: 1056.5372s
Epoch: 1 cost time: 12.28329062461853
Epoch: 1, Steps: 469 | Train Loss: 0.944 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
Validation loss decreased (inf --> -0.877640).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2926604
	speed: 0.1235s/iter; left time: 5723.4762s
	iters: 200, epoch: 2 | loss: 0.5293581
	speed: 0.0218s/iter; left time: 1005.7223s
	iters: 300, epoch: 2 | loss: 0.0375429
	speed: 0.0223s/iter; left time: 1030.0758s
	iters: 400, epoch: 2 | loss: 0.1228050
	speed: 0.0221s/iter; left time: 1019.1017s
Epoch: 2 cost time: 10.765958309173584
Epoch: 2, Steps: 469 | Train Loss: 0.215 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
Validation loss decreased (-0.877640 --> -0.953972).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0640756
	speed: 0.1184s/iter; left time: 5429.4614s
	iters: 200, epoch: 3 | loss: 0.1074488
	speed: 0.0201s/iter; left time: 918.2180s
	iters: 300, epoch: 3 | loss: 0.1017295
	speed: 0.0203s/iter; left time: 926.2985s
	iters: 400, epoch: 3 | loss: 0.0909910
	speed: 0.0213s/iter; left time: 971.2947s
Epoch: 3 cost time: 10.14402174949646
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.953972 --> -0.954544).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0382492
	speed: 0.1173s/iter; left time: 5325.6806s
	iters: 200, epoch: 4 | loss: 0.1124057
	speed: 0.0224s/iter; left time: 1013.3742s
	iters: 300, epoch: 4 | loss: 0.0541993
	speed: 0.0209s/iter; left time: 943.9450s
	iters: 400, epoch: 4 | loss: 0.1428591
	speed: 0.0205s/iter; left time: 922.7888s
Epoch: 4 cost time: 10.26103687286377
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
Validation loss decreased (-0.954544 --> -0.963120).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0083323
	speed: 0.1081s/iter; left time: 4856.0119s
	iters: 200, epoch: 5 | loss: 0.0361058
	speed: 0.0199s/iter; left time: 894.0422s
	iters: 300, epoch: 5 | loss: 0.0982738
	speed: 0.0232s/iter; left time: 1036.9482s
	iters: 400, epoch: 5 | loss: 0.1265264
	speed: 0.0211s/iter; left time: 942.0953s
Epoch: 5 cost time: 10.465967655181885
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.963120 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1202622
	speed: 0.1167s/iter; left time: 5188.6411s
	iters: 200, epoch: 6 | loss: 0.0514883
	speed: 0.0210s/iter; left time: 933.1853s
	iters: 300, epoch: 6 | loss: 0.0949701
	speed: 0.0208s/iter; left time: 922.2909s
	iters: 400, epoch: 6 | loss: 0.0255539
	speed: 0.0209s/iter; left time: 921.6243s
Epoch: 6 cost time: 10.321908712387085
Epoch: 6, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.965407 --> -0.966837).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0103644
	speed: 0.1176s/iter; left time: 5174.7340s
	iters: 200, epoch: 7 | loss: 0.2941244
	speed: 0.0231s/iter; left time: 1013.0671s
	iters: 300, epoch: 7 | loss: 0.0365738
	speed: 0.0223s/iter; left time: 976.1776s
	iters: 400, epoch: 7 | loss: 0.0083743
	speed: 0.0213s/iter; left time: 931.8890s
Epoch: 7 cost time: 10.86829924583435
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2960076
	speed: 0.1170s/iter; left time: 5090.0281s
	iters: 200, epoch: 8 | loss: 0.0093371
	speed: 0.0235s/iter; left time: 1021.0829s
	iters: 300, epoch: 8 | loss: 0.0159003
	speed: 0.0251s/iter; left time: 1088.1502s
	iters: 400, epoch: 8 | loss: 0.0051689
	speed: 0.0233s/iter; left time: 1007.1911s
Epoch: 8 cost time: 11.508205652236938
Epoch: 8, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.966837 --> -0.971411).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0030207
	speed: 0.1203s/iter; left time: 5180.6276s
	iters: 200, epoch: 9 | loss: 0.0383681
	speed: 0.0223s/iter; left time: 957.3720s
	iters: 300, epoch: 9 | loss: 0.2416241
	speed: 0.0225s/iter; left time: 963.0485s
	iters: 400, epoch: 9 | loss: 0.0059530
	speed: 0.0227s/iter; left time: 970.8388s
Epoch: 9 cost time: 10.891957521438599
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971983).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3231166
	speed: 0.1164s/iter; left time: 4956.6664s
	iters: 200, epoch: 10 | loss: 0.0133419
	speed: 0.0211s/iter; left time: 897.4357s
	iters: 300, epoch: 10 | loss: 0.0184062
	speed: 0.0199s/iter; left time: 843.5371s
	iters: 400, epoch: 10 | loss: 0.0139721
	speed: 0.0204s/iter; left time: 863.2285s
Epoch: 10 cost time: 9.921712875366211
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0786195
	speed: 0.1168s/iter; left time: 4919.8584s
	iters: 200, epoch: 11 | loss: 0.0624481
	speed: 0.0218s/iter; left time: 917.1390s
	iters: 300, epoch: 11 | loss: 0.0015705
	speed: 0.0216s/iter; left time: 905.8006s
	iters: 400, epoch: 11 | loss: 0.1201738
	speed: 0.0215s/iter; left time: 896.8555s
Epoch: 11 cost time: 10.608835935592651
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.974842).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2701396
	speed: 0.1164s/iter; left time: 4846.8862s
	iters: 200, epoch: 12 | loss: 0.3864146
	speed: 0.0214s/iter; left time: 887.1633s
	iters: 300, epoch: 12 | loss: 0.0129872
	speed: 0.0216s/iter; left time: 897.1525s
	iters: 400, epoch: 12 | loss: 0.0114397
	speed: 0.0223s/iter; left time: 921.2634s
Epoch: 12 cost time: 10.586594820022583
Epoch: 12, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.974842).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0081038
	speed: 0.1115s/iter; left time: 4592.7785s
	iters: 200, epoch: 13 | loss: 0.1002686
	speed: 0.0218s/iter; left time: 894.1241s
	iters: 300, epoch: 13 | loss: 0.0094987
	speed: 0.0216s/iter; left time: 883.2549s
	iters: 400, epoch: 13 | loss: 0.0973070
	speed: 0.0215s/iter; left time: 876.9108s
Epoch: 13 cost time: 10.499821901321411
Epoch: 13, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0012535
	speed: 0.1201s/iter; left time: 4889.4515s
	iters: 200, epoch: 14 | loss: 0.0036788
	speed: 0.0221s/iter; left time: 897.8432s
	iters: 300, epoch: 14 | loss: 0.0024958
	speed: 0.0217s/iter; left time: 880.8964s
	iters: 400, epoch: 14 | loss: 0.1154771
	speed: 0.0216s/iter; left time: 874.1674s
Epoch: 14 cost time: 10.609756708145142
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0081275
	speed: 0.1184s/iter; left time: 4763.6548s
	iters: 200, epoch: 15 | loss: 0.0571263
	speed: 0.0212s/iter; left time: 852.5657s
	iters: 300, epoch: 15 | loss: 0.0002138
	speed: 0.0206s/iter; left time: 826.6431s
	iters: 400, epoch: 15 | loss: 0.0030607
	speed: 0.0219s/iter; left time: 875.7672s
Epoch: 15 cost time: 10.600771188735962
Epoch: 15, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975127).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0403082
	speed: 0.1159s/iter; left time: 4607.8508s
	iters: 200, epoch: 16 | loss: 0.0014506
	speed: 0.0220s/iter; left time: 872.8918s
	iters: 300, epoch: 16 | loss: 0.0055706
	speed: 0.0226s/iter; left time: 895.6205s
	iters: 400, epoch: 16 | loss: 0.0133259
	speed: 0.0229s/iter; left time: 902.2884s
Epoch: 16 cost time: 11.004505634307861
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.975699).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0016242
	speed: 0.1184s/iter; left time: 4654.4149s
	iters: 200, epoch: 17 | loss: 0.0024381
	speed: 0.0234s/iter; left time: 916.0776s
	iters: 300, epoch: 17 | loss: 0.0194571
	speed: 0.0228s/iter; left time: 891.9713s
	iters: 400, epoch: 17 | loss: 0.0677071
	speed: 0.0219s/iter; left time: 852.1243s
Epoch: 17 cost time: 11.032077550888062
Epoch: 17, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0031470
	speed: 0.1159s/iter; left time: 4498.5381s
	iters: 200, epoch: 18 | loss: 0.1861386
	speed: 0.0210s/iter; left time: 814.2104s
	iters: 300, epoch: 18 | loss: 0.0054278
	speed: 0.0225s/iter; left time: 869.9250s
	iters: 400, epoch: 18 | loss: 0.0498940
	speed: 0.0239s/iter; left time: 922.1549s
Epoch: 18 cost time: 11.076117515563965
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0486197
	speed: 0.1241s/iter; left time: 4759.1140s
	iters: 200, epoch: 19 | loss: 0.0795069
	speed: 0.0212s/iter; left time: 812.1724s
	iters: 300, epoch: 19 | loss: 0.0000970
	speed: 0.0230s/iter; left time: 879.3064s
	iters: 400, epoch: 19 | loss: 0.0057649
	speed: 0.0227s/iter; left time: 862.3096s
Epoch: 19 cost time: 10.9000403881073
Epoch: 19, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0002763
	speed: 0.1228s/iter; left time: 4654.2450s
	iters: 200, epoch: 20 | loss: 0.0711498
	speed: 0.0223s/iter; left time: 841.0710s
	iters: 300, epoch: 20 | loss: 0.0963843
	speed: 0.0205s/iter; left time: 773.9516s
	iters: 400, epoch: 20 | loss: 0.0796391
	speed: 0.0218s/iter; left time: 820.2732s
Epoch: 20 cost time: 10.644181728363037
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.4056334
	speed: 0.1180s/iter; left time: 4414.9059s
	iters: 200, epoch: 21 | loss: 0.1209885
	speed: 0.0217s/iter; left time: 810.4251s
	iters: 300, epoch: 21 | loss: 0.0008285
	speed: 0.0215s/iter; left time: 800.5142s
	iters: 400, epoch: 21 | loss: 0.2032885
	speed: 0.0221s/iter; left time: 818.5478s
Epoch: 21 cost time: 10.72800874710083
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.978558).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0173519
	speed: 0.1177s/iter; left time: 4349.2939s
	iters: 200, epoch: 22 | loss: 0.0004262
	speed: 0.0206s/iter; left time: 759.3843s
	iters: 300, epoch: 22 | loss: 0.0157533
	speed: 0.0220s/iter; left time: 810.2099s
	iters: 400, epoch: 22 | loss: 0.0034778
	speed: 0.0217s/iter; left time: 797.0998s
Epoch: 22 cost time: 10.503578186035156
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0908411
	speed: 0.1073s/iter; left time: 3914.5200s
	iters: 200, epoch: 23 | loss: 0.0004104
	speed: 0.0224s/iter; left time: 813.7535s
	iters: 300, epoch: 23 | loss: 0.7698135
	speed: 0.0218s/iter; left time: 792.6963s
	iters: 400, epoch: 23 | loss: 0.0404723
	speed: 0.0214s/iter; left time: 775.6484s
Epoch: 23 cost time: 10.758387088775635
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0065389
	speed: 0.1176s/iter; left time: 4236.3915s
	iters: 200, epoch: 24 | loss: 0.0791703
	speed: 0.0217s/iter; left time: 778.1284s
	iters: 300, epoch: 24 | loss: 0.0020002
	speed: 0.0207s/iter; left time: 739.7091s
	iters: 400, epoch: 24 | loss: 0.0025347
	speed: 0.0223s/iter; left time: 798.0864s
Epoch: 24 cost time: 10.627594709396362
Epoch: 24, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.1468260
	speed: 0.1228s/iter; left time: 4363.7072s
	iters: 200, epoch: 25 | loss: 0.0012117
	speed: 0.0231s/iter; left time: 819.1053s
	iters: 300, epoch: 25 | loss: 0.0088328
	speed: 0.0231s/iter; left time: 816.1175s
	iters: 400, epoch: 25 | loss: 0.0026028
	speed: 0.0216s/iter; left time: 759.7487s
Epoch: 25 cost time: 11.13124418258667
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0664180
	speed: 0.1198s/iter; left time: 4203.0317s
	iters: 200, epoch: 26 | loss: 0.0028446
	speed: 0.0218s/iter; left time: 761.3334s
	iters: 300, epoch: 26 | loss: 0.0065988
	speed: 0.0221s/iter; left time: 771.5636s
	iters: 400, epoch: 26 | loss: 0.0004423
	speed: 0.0222s/iter; left time: 773.4633s
Epoch: 26 cost time: 10.899517059326172
Epoch: 26, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978558).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0002885
	speed: 0.1184s/iter; left time: 4096.7028s
	iters: 200, epoch: 27 | loss: 0.0207933
	speed: 0.0227s/iter; left time: 784.3816s
	iters: 300, epoch: 27 | loss: 0.0003964
	speed: 0.0239s/iter; left time: 821.2698s
	iters: 400, epoch: 27 | loss: 0.0860479
	speed: 0.0238s/iter; left time: 817.7845s
Epoch: 27 cost time: 11.244058847427368
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0057143
	speed: 0.1169s/iter; left time: 3991.3431s
	iters: 200, epoch: 28 | loss: 0.0104162
	speed: 0.0233s/iter; left time: 792.8412s
	iters: 300, epoch: 28 | loss: 0.0246563
	speed: 0.0234s/iter; left time: 792.5798s
	iters: 400, epoch: 28 | loss: 0.0051274
	speed: 0.0221s/iter; left time: 746.5878s
Epoch: 28 cost time: 11.157546997070312
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0049499
	speed: 0.1218s/iter; left time: 4099.3660s
	iters: 200, epoch: 29 | loss: 0.0019596
	speed: 0.0217s/iter; left time: 729.5686s
	iters: 300, epoch: 29 | loss: 0.0197604
	speed: 0.0216s/iter; left time: 721.9762s
	iters: 400, epoch: 29 | loss: 0.0002132
	speed: 0.0225s/iter; left time: 749.8511s
Epoch: 29 cost time: 10.610194206237793
Epoch: 29, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0180709
	speed: 0.1234s/iter; left time: 4096.1436s
	iters: 200, epoch: 30 | loss: 0.3694302
	speed: 0.0205s/iter; left time: 679.0439s
	iters: 300, epoch: 30 | loss: 0.0063420
	speed: 0.0226s/iter; left time: 745.9359s
	iters: 400, epoch: 30 | loss: 0.0072558
	speed: 0.0216s/iter; left time: 709.9589s
Epoch: 30 cost time: 10.772230863571167
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0021261
	speed: 0.1194s/iter; left time: 3908.6589s
	iters: 200, epoch: 31 | loss: 0.0064120
	speed: 0.0223s/iter; left time: 729.2754s
	iters: 300, epoch: 31 | loss: 0.0001915
	speed: 0.0212s/iter; left time: 690.9033s
	iters: 400, epoch: 31 | loss: 0.0004861
	speed: 0.0224s/iter; left time: 725.2767s
Epoch: 31 cost time: 10.865058898925781
Epoch: 31, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.1676869
	speed: 0.1149s/iter; left time: 3705.8803s
	iters: 200, epoch: 32 | loss: 0.0575405
	speed: 0.0209s/iter; left time: 673.2560s
	iters: 300, epoch: 32 | loss: 0.2205745
	speed: 0.0214s/iter; left time: 687.0071s
	iters: 400, epoch: 32 | loss: 0.0006670
	speed: 0.0215s/iter; left time: 687.6918s
Epoch: 32 cost time: 10.494920015335083
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0008856
	speed: 0.1152s/iter; left time: 3661.4681s
	iters: 200, epoch: 33 | loss: 0.0006851
	speed: 0.0222s/iter; left time: 704.0743s
	iters: 300, epoch: 33 | loss: 0.0158701
	speed: 0.0221s/iter; left time: 698.9878s
	iters: 400, epoch: 33 | loss: 0.0326602
	speed: 0.0223s/iter; left time: 701.7577s
Epoch: 33 cost time: 10.853630542755127
Epoch: 33, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0005128
	speed: 0.1199s/iter; left time: 3755.5792s
	iters: 200, epoch: 34 | loss: 0.0029110
	speed: 0.0237s/iter; left time: 741.3084s
	iters: 300, epoch: 34 | loss: 0.0003797
	speed: 0.0226s/iter; left time: 704.1084s
	iters: 400, epoch: 34 | loss: 0.0062114
	speed: 0.0237s/iter; left time: 736.2866s
Epoch: 34 cost time: 11.20757269859314
Epoch: 34, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0004670
	speed: 0.1282s/iter; left time: 3955.6027s
	iters: 200, epoch: 35 | loss: 0.0002853
	speed: 0.0220s/iter; left time: 677.8518s
	iters: 300, epoch: 35 | loss: 0.0105275
	speed: 0.0224s/iter; left time: 687.2302s
	iters: 400, epoch: 35 | loss: 0.0000209
	speed: 0.0228s/iter; left time: 697.3986s
Epoch: 35 cost time: 10.919981718063354
Epoch: 35, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0187296
	speed: 0.1205s/iter; left time: 3661.8666s
	iters: 200, epoch: 36 | loss: 0.0835036
	speed: 0.0223s/iter; left time: 675.5199s
	iters: 300, epoch: 36 | loss: 0.0064450
	speed: 0.0224s/iter; left time: 677.2718s
	iters: 400, epoch: 36 | loss: 0.0099523
	speed: 0.0226s/iter; left time: 678.5155s
Epoch: 36 cost time: 10.967461585998535
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 145826
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1753349
	speed: 0.0428s/iter; left time: 2005.1765s
	iters: 200, epoch: 1 | loss: 0.6503557
	speed: 0.0219s/iter; left time: 1023.8484s
	iters: 300, epoch: 1 | loss: 0.1553951
	speed: 0.0211s/iter; left time: 981.5751s
	iters: 400, epoch: 1 | loss: 0.2895116
	speed: 0.0225s/iter; left time: 1048.2822s
Epoch: 1 cost time: 12.41804027557373
Epoch: 1, Steps: 469 | Train Loss: 0.817 Vali Loss: 0.412 Vali Acc: 0.862 Test Loss: 0.412 Test Acc: 0.862
Validation loss decreased (inf --> -0.861917).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1082738
	speed: 0.1222s/iter; left time: 5661.6635s
	iters: 200, epoch: 2 | loss: 0.2988028
	speed: 0.0222s/iter; left time: 1028.4414s
	iters: 300, epoch: 2 | loss: 0.3912259
	speed: 0.0204s/iter; left time: 943.1916s
	iters: 400, epoch: 2 | loss: 0.0329730
	speed: 0.0215s/iter; left time: 990.2211s
Epoch: 2 cost time: 10.518264055252075
Epoch: 2, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.266 Vali Acc: 0.914 Test Loss: 0.266 Test Acc: 0.914
Validation loss decreased (-0.861917 --> -0.913662).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0684654
	speed: 0.1169s/iter; left time: 5362.6637s
	iters: 200, epoch: 3 | loss: 0.1878700
	speed: 0.0223s/iter; left time: 1021.8698s
	iters: 300, epoch: 3 | loss: 0.2322268
	speed: 0.0223s/iter; left time: 1020.1388s
	iters: 400, epoch: 3 | loss: 0.1410100
	speed: 0.0232s/iter; left time: 1056.0680s
Epoch: 3 cost time: 10.894140243530273
Epoch: 3, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.913662 --> -0.943680).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0139236
	speed: 0.1167s/iter; left time: 5298.3608s
	iters: 200, epoch: 4 | loss: 0.0767581
	speed: 0.0236s/iter; left time: 1067.2675s
	iters: 300, epoch: 4 | loss: 0.0766387
	speed: 0.0230s/iter; left time: 1039.4844s
	iters: 400, epoch: 4 | loss: 0.0343834
	speed: 0.0217s/iter; left time: 977.4727s
Epoch: 4 cost time: 11.060534954071045
Epoch: 4, Steps: 469 | Train Loss: 0.104 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.943680 --> -0.962263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0285948
	speed: 0.1125s/iter; left time: 5055.1635s
	iters: 200, epoch: 5 | loss: 0.0623655
	speed: 0.0223s/iter; left time: 999.0792s
	iters: 300, epoch: 5 | loss: 0.0642587
	speed: 0.0234s/iter; left time: 1048.0948s
	iters: 400, epoch: 5 | loss: 0.0886244
	speed: 0.0256s/iter; left time: 1143.6014s
Epoch: 5 cost time: 11.515768766403198
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0129145
	speed: 0.1255s/iter; left time: 5578.7185s
	iters: 200, epoch: 6 | loss: 0.0071635
	speed: 0.0251s/iter; left time: 1114.7746s
	iters: 300, epoch: 6 | loss: 0.0788457
	speed: 0.0249s/iter; left time: 1103.2935s
	iters: 400, epoch: 6 | loss: 0.0094127
	speed: 0.0240s/iter; left time: 1059.5108s
Epoch: 6 cost time: 11.920947074890137
Epoch: 6, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.962263 --> -0.967695).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0063024
	speed: 0.1237s/iter; left time: 5442.0876s
	iters: 200, epoch: 7 | loss: 1.0169957
	speed: 0.0237s/iter; left time: 1041.0402s
	iters: 300, epoch: 7 | loss: 0.0084180
	speed: 0.0230s/iter; left time: 1009.1833s
	iters: 400, epoch: 7 | loss: 0.4120191
	speed: 0.0227s/iter; left time: 991.5613s
Epoch: 7 cost time: 11.304411172866821
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.967695 --> -0.972840).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0062262
	speed: 0.1156s/iter; left time: 5029.8813s
	iters: 200, epoch: 8 | loss: 0.1099254
	speed: 0.0229s/iter; left time: 995.3182s
	iters: 300, epoch: 8 | loss: 0.0457347
	speed: 0.0227s/iter; left time: 982.4999s
	iters: 400, epoch: 8 | loss: 0.0059078
	speed: 0.0249s/iter; left time: 1075.2945s
Epoch: 8 cost time: 11.397199153900146
Epoch: 8, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973126).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0161647
	speed: 0.1128s/iter; left time: 4855.8147s
	iters: 200, epoch: 9 | loss: 0.3869392
	speed: 0.0224s/iter; left time: 961.4936s
	iters: 300, epoch: 9 | loss: 0.1150708
	speed: 0.0218s/iter; left time: 935.9395s
	iters: 400, epoch: 9 | loss: 0.0042712
	speed: 0.0235s/iter; left time: 1004.9431s
Epoch: 9 cost time: 10.823468685150146
Epoch: 9, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1405905
	speed: 0.1230s/iter; left time: 5235.6126s
	iters: 200, epoch: 10 | loss: 0.0066314
	speed: 0.0231s/iter; left time: 982.3727s
	iters: 300, epoch: 10 | loss: 0.0032525
	speed: 0.0228s/iter; left time: 966.2218s
	iters: 400, epoch: 10 | loss: 0.1409670
	speed: 0.0231s/iter; left time: 978.2340s
Epoch: 10 cost time: 11.120214939117432
Epoch: 10, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.973126 --> -0.979416).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0054426
	speed: 0.1236s/iter; left time: 5204.1762s
	iters: 200, epoch: 11 | loss: 0.0042734
	speed: 0.0230s/iter; left time: 964.7712s
	iters: 300, epoch: 11 | loss: 0.0371807
	speed: 0.0242s/iter; left time: 1012.7089s
	iters: 400, epoch: 11 | loss: 0.0415307
	speed: 0.0245s/iter; left time: 1022.4177s
Epoch: 11 cost time: 11.395611047744751
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0911806
	speed: 0.1190s/iter; left time: 4953.4490s
	iters: 200, epoch: 12 | loss: 0.0615891
	speed: 0.0236s/iter; left time: 982.3951s
	iters: 300, epoch: 12 | loss: 0.0504170
	speed: 0.0231s/iter; left time: 956.5494s
	iters: 400, epoch: 12 | loss: 0.0219053
	speed: 0.0226s/iter; left time: 933.8371s
Epoch: 12 cost time: 11.2579026222229
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0180846
	speed: 0.1212s/iter; left time: 4991.7716s
	iters: 200, epoch: 13 | loss: 0.0112322
	speed: 0.0234s/iter; left time: 959.3317s
	iters: 300, epoch: 13 | loss: 0.1832919
	speed: 0.0236s/iter; left time: 966.0197s
	iters: 400, epoch: 13 | loss: 0.0381939
	speed: 0.0239s/iter; left time: 978.6113s
Epoch: 13 cost time: 11.652933597564697
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0471285
	speed: 0.1220s/iter; left time: 4966.8585s
	iters: 200, epoch: 14 | loss: 0.1562112
	speed: 0.0246s/iter; left time: 997.8915s
	iters: 300, epoch: 14 | loss: 0.0109757
	speed: 0.0247s/iter; left time: 999.9704s
	iters: 400, epoch: 14 | loss: 0.0401864
	speed: 0.0249s/iter; left time: 1006.9334s
Epoch: 14 cost time: 12.058468580245972
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0079171
	speed: 0.1292s/iter; left time: 5197.5539s
	iters: 200, epoch: 15 | loss: 0.8087174
	speed: 0.0230s/iter; left time: 923.8264s
	iters: 300, epoch: 15 | loss: 0.0013749
	speed: 0.0245s/iter; left time: 979.9619s
	iters: 400, epoch: 15 | loss: 0.1241857
	speed: 0.0251s/iter; left time: 1003.7265s
Epoch: 15 cost time: 11.711495637893677
Epoch: 15, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0104686
	speed: 0.1267s/iter; left time: 5040.1730s
	iters: 200, epoch: 16 | loss: 0.2394752
	speed: 0.0234s/iter; left time: 927.2035s
	iters: 300, epoch: 16 | loss: 0.0064033
	speed: 0.0238s/iter; left time: 941.9407s
	iters: 400, epoch: 16 | loss: 0.1054468
	speed: 0.0227s/iter; left time: 895.5539s
Epoch: 16 cost time: 11.263065338134766
Epoch: 16, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0151849
	speed: 0.1170s/iter; left time: 4599.2479s
	iters: 200, epoch: 17 | loss: 0.0011442
	speed: 0.0229s/iter; left time: 899.4298s
	iters: 300, epoch: 17 | loss: 0.0070815
	speed: 0.0218s/iter; left time: 852.5783s
	iters: 400, epoch: 17 | loss: 0.0118799
	speed: 0.0229s/iter; left time: 892.3298s
Epoch: 17 cost time: 11.08875846862793
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0049008
	speed: 0.1173s/iter; left time: 4553.9478s
	iters: 200, epoch: 18 | loss: 0.0127310
	speed: 0.0222s/iter; left time: 858.9458s
	iters: 300, epoch: 18 | loss: 0.0927258
	speed: 0.0231s/iter; left time: 891.4540s
	iters: 400, epoch: 18 | loss: 0.0002755
	speed: 0.0236s/iter; left time: 908.3059s
Epoch: 18 cost time: 11.156412839889526
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0026912
	speed: 0.1188s/iter; left time: 4555.5864s
	iters: 200, epoch: 19 | loss: 0.0084246
	speed: 0.0232s/iter; left time: 889.3065s
	iters: 300, epoch: 19 | loss: 0.0037823
	speed: 0.0225s/iter; left time: 859.3492s
	iters: 400, epoch: 19 | loss: 0.0005845
	speed: 0.0236s/iter; left time: 896.9716s
Epoch: 19 cost time: 11.329302310943604
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0100447
	speed: 0.1252s/iter; left time: 4745.4193s
	iters: 200, epoch: 20 | loss: 0.0052712
	speed: 0.0233s/iter; left time: 880.9543s
	iters: 300, epoch: 20 | loss: 0.0014199
	speed: 0.0236s/iter; left time: 888.9894s
	iters: 400, epoch: 20 | loss: 0.0374286
	speed: 0.0241s/iter; left time: 904.1047s
Epoch: 20 cost time: 11.489302396774292
Epoch: 20, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 80290
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2223345
	speed: 0.0407s/iter; left time: 1903.0145s
	iters: 200, epoch: 1 | loss: 0.7304033
	speed: 0.0205s/iter; left time: 959.1926s
	iters: 300, epoch: 1 | loss: 0.1626204
	speed: 0.0222s/iter; left time: 1035.7465s
	iters: 400, epoch: 1 | loss: 0.2841990
	speed: 0.0248s/iter; left time: 1155.1242s
Epoch: 1 cost time: 12.47643256187439
Epoch: 1, Steps: 469 | Train Loss: 0.843 Vali Loss: 0.396 Vali Acc: 0.873 Test Loss: 0.396 Test Acc: 0.873
Validation loss decreased (inf --> -0.873352).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1593676
	speed: 0.1159s/iter; left time: 5369.9013s
	iters: 200, epoch: 2 | loss: 0.2349324
	speed: 0.0220s/iter; left time: 1015.1084s
	iters: 300, epoch: 2 | loss: 0.4993834
	speed: 0.0231s/iter; left time: 1066.2401s
	iters: 400, epoch: 2 | loss: 0.0419212
	speed: 0.0224s/iter; left time: 1030.1921s
Epoch: 2 cost time: 11.14519453048706
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.873352 --> -0.926527).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0815586
	speed: 0.1163s/iter; left time: 5334.4492s
	iters: 200, epoch: 3 | loss: 0.1458758
	speed: 0.0233s/iter; left time: 1065.4854s
	iters: 300, epoch: 3 | loss: 0.2253662
	speed: 0.0234s/iter; left time: 1066.9126s
	iters: 400, epoch: 3 | loss: 0.1716753
	speed: 0.0250s/iter; left time: 1137.2109s
Epoch: 3 cost time: 11.425203800201416
Epoch: 3, Steps: 469 | Train Loss: 0.134 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.926527 --> -0.951113).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0224387
	speed: 0.1218s/iter; left time: 5530.2808s
	iters: 200, epoch: 4 | loss: 0.0828968
	speed: 0.0234s/iter; left time: 1059.6139s
	iters: 300, epoch: 4 | loss: 0.0639307
	speed: 0.0240s/iter; left time: 1084.0908s
	iters: 400, epoch: 4 | loss: 0.0516966
	speed: 0.0236s/iter; left time: 1065.0981s
Epoch: 4 cost time: 11.343812942504883
Epoch: 4, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.951113 --> -0.962263).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0462699
	speed: 0.1134s/iter; left time: 5092.9322s
	iters: 200, epoch: 5 | loss: 0.0707050
	speed: 0.0216s/iter; left time: 967.7470s
	iters: 300, epoch: 5 | loss: 0.0421812
	speed: 0.0223s/iter; left time: 998.7645s
	iters: 400, epoch: 5 | loss: 0.1231424
	speed: 0.0219s/iter; left time: 979.2892s
Epoch: 5 cost time: 10.582213878631592
Epoch: 5, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0141745
	speed: 0.1110s/iter; left time: 4935.5707s
	iters: 200, epoch: 6 | loss: 0.0086952
	speed: 0.0212s/iter; left time: 938.6342s
	iters: 300, epoch: 6 | loss: 0.2278109
	speed: 0.0208s/iter; left time: 920.4117s
	iters: 400, epoch: 6 | loss: 0.0220264
	speed: 0.0214s/iter; left time: 946.0146s
Epoch: 6 cost time: 10.526038885116577
Epoch: 6, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.962263 --> -0.968552).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0143967
	speed: 0.1131s/iter; left time: 4974.2686s
	iters: 200, epoch: 7 | loss: 0.8444790
	speed: 0.0223s/iter; left time: 978.8663s
	iters: 300, epoch: 7 | loss: 0.0092526
	speed: 0.0226s/iter; left time: 991.4460s
	iters: 400, epoch: 7 | loss: 0.5669846
	speed: 0.0202s/iter; left time: 882.8798s
Epoch: 7 cost time: 10.465212106704712
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0097392
	speed: 0.1183s/iter; left time: 5148.7442s
	iters: 200, epoch: 8 | loss: 0.0375187
	speed: 0.0232s/iter; left time: 1008.4555s
	iters: 300, epoch: 8 | loss: 0.0456949
	speed: 0.0221s/iter; left time: 955.1653s
	iters: 400, epoch: 8 | loss: 0.0036400
	speed: 0.0205s/iter; left time: 884.1053s
Epoch: 8 cost time: 10.731912612915039
Epoch: 8, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.969982).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0401115
	speed: 0.1214s/iter; left time: 5224.5476s
	iters: 200, epoch: 9 | loss: 0.4524218
	speed: 0.0221s/iter; left time: 950.5506s
	iters: 300, epoch: 9 | loss: 0.1043843
	speed: 0.0227s/iter; left time: 971.2367s
	iters: 400, epoch: 9 | loss: 0.0051340
	speed: 0.0223s/iter; left time: 952.6689s
Epoch: 9 cost time: 10.86670994758606
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.2911508
	speed: 0.1157s/iter; left time: 4927.8029s
	iters: 200, epoch: 10 | loss: 0.0229061
	speed: 0.0231s/iter; left time: 982.9346s
	iters: 300, epoch: 10 | loss: 0.0063555
	speed: 0.0229s/iter; left time: 971.8710s
	iters: 400, epoch: 10 | loss: 0.1400827
	speed: 0.0234s/iter; left time: 991.2662s
Epoch: 10 cost time: 11.166114568710327
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0275256
	speed: 0.1146s/iter; left time: 4826.2890s
	iters: 200, epoch: 11 | loss: 0.0040874
	speed: 0.0231s/iter; left time: 970.5724s
	iters: 300, epoch: 11 | loss: 0.0283246
	speed: 0.0240s/iter; left time: 1005.0619s
	iters: 400, epoch: 11 | loss: 0.0048320
	speed: 0.0230s/iter; left time: 961.5121s
Epoch: 11 cost time: 11.300424098968506
Epoch: 11, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.969982 --> -0.972269).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0677184
	speed: 0.1153s/iter; left time: 4800.9705s
	iters: 200, epoch: 12 | loss: 0.1056839
	speed: 0.0247s/iter; left time: 1025.8784s
	iters: 300, epoch: 12 | loss: 0.0097210
	speed: 0.0219s/iter; left time: 906.4126s
	iters: 400, epoch: 12 | loss: 0.0205741
	speed: 0.0246s/iter; left time: 1016.8618s
Epoch: 12 cost time: 11.426096200942993
Epoch: 12, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.972269 --> -0.973698).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0283336
	speed: 0.1247s/iter; left time: 5133.7910s
	iters: 200, epoch: 13 | loss: 0.0147957
	speed: 0.0232s/iter; left time: 952.0115s
	iters: 300, epoch: 13 | loss: 0.0639413
	speed: 0.0231s/iter; left time: 944.9242s
	iters: 400, epoch: 13 | loss: 0.0115191
	speed: 0.0232s/iter; left time: 949.8665s
Epoch: 13 cost time: 11.25768232345581
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0290544
	speed: 0.1213s/iter; left time: 4938.1075s
	iters: 200, epoch: 14 | loss: 0.0716046
	speed: 0.0234s/iter; left time: 950.8233s
	iters: 300, epoch: 14 | loss: 0.0141508
	speed: 0.0210s/iter; left time: 852.3836s
	iters: 400, epoch: 14 | loss: 0.0497990
	speed: 0.0227s/iter; left time: 918.7512s
Epoch: 14 cost time: 10.855721950531006
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.973698 --> -0.978558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0045574
	speed: 0.1116s/iter; left time: 4491.7676s
	iters: 200, epoch: 15 | loss: 0.6163614
	speed: 0.0201s/iter; left time: 804.9977s
	iters: 300, epoch: 15 | loss: 0.0064060
	speed: 0.0219s/iter; left time: 877.7608s
	iters: 400, epoch: 15 | loss: 0.0104515
	speed: 0.0218s/iter; left time: 868.7549s
Epoch: 15 cost time: 10.472632884979248
Epoch: 15, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0093577
	speed: 0.1104s/iter; left time: 4390.8576s
	iters: 200, epoch: 16 | loss: 0.2407568
	speed: 0.0215s/iter; left time: 853.7047s
	iters: 300, epoch: 16 | loss: 0.0019349
	speed: 0.0221s/iter; left time: 875.4978s
	iters: 400, epoch: 16 | loss: 0.0067139
	speed: 0.0213s/iter; left time: 841.6024s
Epoch: 16 cost time: 10.472200155258179
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0114310
	speed: 0.1098s/iter; left time: 4314.9314s
	iters: 200, epoch: 17 | loss: 0.0075067
	speed: 0.0224s/iter; left time: 877.6714s
	iters: 300, epoch: 17 | loss: 0.0162589
	speed: 0.0237s/iter; left time: 925.8501s
	iters: 400, epoch: 17 | loss: 0.0314941
	speed: 0.0228s/iter; left time: 889.2803s
Epoch: 17 cost time: 10.834997415542603
Epoch: 17, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0163650
	speed: 0.1153s/iter; left time: 4475.5991s
	iters: 200, epoch: 18 | loss: 0.0037518
	speed: 0.0220s/iter; left time: 851.0213s
	iters: 300, epoch: 18 | loss: 0.1020738
	speed: 0.0225s/iter; left time: 868.8621s
	iters: 400, epoch: 18 | loss: 0.0038454
	speed: 0.0217s/iter; left time: 836.9566s
Epoch: 18 cost time: 10.599685192108154
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0011378
	speed: 0.1195s/iter; left time: 4584.8314s
	iters: 200, epoch: 19 | loss: 0.0293567
	speed: 0.0216s/iter; left time: 827.1644s
	iters: 300, epoch: 19 | loss: 0.0023453
	speed: 0.0210s/iter; left time: 802.5699s
	iters: 400, epoch: 19 | loss: 0.0002465
	speed: 0.0223s/iter; left time: 850.2490s
Epoch: 19 cost time: 10.579585075378418
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0118426
	speed: 0.1141s/iter; left time: 4324.9101s
	iters: 200, epoch: 20 | loss: 0.0021713
	speed: 0.0220s/iter; left time: 830.2302s
	iters: 300, epoch: 20 | loss: 0.0019698
	speed: 0.0238s/iter; left time: 897.9647s
	iters: 400, epoch: 20 | loss: 0.0850896
	speed: 0.0230s/iter; left time: 864.2800s
Epoch: 20 cost time: 11.125272989273071
Epoch: 20, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0607558
	speed: 0.1144s/iter; left time: 4279.5810s
	iters: 200, epoch: 21 | loss: 0.0255898
	speed: 0.0232s/iter; left time: 866.7482s
	iters: 300, epoch: 21 | loss: 0.0074724
	speed: 0.0241s/iter; left time: 895.9442s
	iters: 400, epoch: 21 | loss: 0.0091791
	speed: 0.0233s/iter; left time: 863.9493s
Epoch: 21 cost time: 11.534931659698486
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0079798
	speed: 0.1155s/iter; left time: 4266.2328s
	iters: 200, epoch: 22 | loss: 0.0009656
	speed: 0.0245s/iter; left time: 903.2740s
	iters: 300, epoch: 22 | loss: 0.0005282
	speed: 0.0223s/iter; left time: 819.9327s
	iters: 400, epoch: 22 | loss: 0.0019126
	speed: 0.0244s/iter; left time: 895.8852s
Epoch: 22 cost time: 11.292816400527954
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0022665
	speed: 0.1153s/iter; left time: 4205.0656s
	iters: 200, epoch: 23 | loss: 0.0260050
	speed: 0.0231s/iter; left time: 840.8253s
	iters: 300, epoch: 23 | loss: 0.0000498
	speed: 0.0227s/iter; left time: 824.4353s
	iters: 400, epoch: 23 | loss: 0.0507546
	speed: 0.0217s/iter; left time: 785.4805s
Epoch: 23 cost time: 10.641660690307617
Epoch: 23, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0008876
	speed: 0.1142s/iter; left time: 4114.0456s
	iters: 200, epoch: 24 | loss: 0.0005366
	speed: 0.0213s/iter; left time: 765.3850s
	iters: 300, epoch: 24 | loss: 0.0041331
	speed: 0.0214s/iter; left time: 765.3015s
	iters: 400, epoch: 24 | loss: 0.0003923
	speed: 0.0217s/iter; left time: 776.2981s
Epoch: 24 cost time: 10.558944940567017
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 80290
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4515464
	speed: 0.0405s/iter; left time: 1897.1266s
	iters: 200, epoch: 1 | loss: 0.8015419
	speed: 0.0212s/iter; left time: 990.3609s
	iters: 300, epoch: 1 | loss: 0.2233623
	speed: 0.0234s/iter; left time: 1090.6877s
	iters: 400, epoch: 1 | loss: 0.2728631
	speed: 0.0237s/iter; left time: 1101.2314s
Epoch: 1 cost time: 12.512922286987305
Epoch: 1, Steps: 469 | Train Loss: 0.882 Vali Loss: 0.369 Vali Acc: 0.893 Test Loss: 0.369 Test Acc: 0.893
Validation loss decreased (inf --> -0.892506).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1659290
	speed: 0.1110s/iter; left time: 5142.7968s
	iters: 200, epoch: 2 | loss: 0.2308698
	speed: 0.0230s/iter; left time: 1065.2707s
	iters: 300, epoch: 2 | loss: 0.4528029
	speed: 0.0223s/iter; left time: 1028.3457s
	iters: 400, epoch: 2 | loss: 0.0396001
	speed: 0.0221s/iter; left time: 1016.9615s
Epoch: 2 cost time: 10.7389554977417
Epoch: 2, Steps: 469 | Train Loss: 0.211 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.892506 --> -0.949398).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0466154
	speed: 0.1217s/iter; left time: 5579.6433s
	iters: 200, epoch: 3 | loss: 0.2759283
	speed: 0.0219s/iter; left time: 999.9464s
	iters: 300, epoch: 3 | loss: 0.1278174
	speed: 0.0221s/iter; left time: 1010.8260s
	iters: 400, epoch: 3 | loss: 0.2090503
	speed: 0.0226s/iter; left time: 1031.3778s
Epoch: 3 cost time: 10.964468717575073
Epoch: 3, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.949398 --> -0.955115).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0369594
	speed: 0.1196s/iter; left time: 5428.6963s
	iters: 200, epoch: 4 | loss: 0.0317018
	speed: 0.0243s/iter; left time: 1101.0491s
	iters: 300, epoch: 4 | loss: 0.0128889
	speed: 0.0252s/iter; left time: 1138.2859s
	iters: 400, epoch: 4 | loss: 0.0475736
	speed: 0.0249s/iter; left time: 1121.4548s
Epoch: 4 cost time: 11.316020965576172
Epoch: 4, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
Validation loss decreased (-0.955115 --> -0.962835).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1431186
	speed: 0.1078s/iter; left time: 4843.4721s
	iters: 200, epoch: 5 | loss: 0.0380197
	speed: 0.0209s/iter; left time: 936.2333s
	iters: 300, epoch: 5 | loss: 0.0557067
	speed: 0.0193s/iter; left time: 861.6019s
	iters: 400, epoch: 5 | loss: 0.0462501
	speed: 0.0193s/iter; left time: 862.8460s
Epoch: 5 cost time: 9.527401447296143
Epoch: 5, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0082393
	speed: 0.0898s/iter; left time: 3993.1114s
	iters: 200, epoch: 6 | loss: 0.0025828
	speed: 0.0220s/iter; left time: 976.2434s
	iters: 300, epoch: 6 | loss: 0.1936906
	speed: 0.0233s/iter; left time: 1032.7690s
	iters: 400, epoch: 6 | loss: 0.0090016
	speed: 0.0215s/iter; left time: 950.2416s
Epoch: 6 cost time: 10.580643653869629
Epoch: 6, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.962835 --> -0.971125).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0409756
	speed: 0.1159s/iter; left time: 5098.5369s
	iters: 200, epoch: 7 | loss: 0.7741204
	speed: 0.0208s/iter; left time: 914.9245s
	iters: 300, epoch: 7 | loss: 0.0330706
	speed: 0.0233s/iter; left time: 1022.2424s
	iters: 400, epoch: 7 | loss: 0.4791423
	speed: 0.0222s/iter; left time: 969.7234s
Epoch: 7 cost time: 10.912731647491455
Epoch: 7, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.971125 --> -0.971697).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1132357
	speed: 0.1246s/iter; left time: 5423.6760s
	iters: 200, epoch: 8 | loss: 0.0491127
	speed: 0.0213s/iter; left time: 925.5584s
	iters: 300, epoch: 8 | loss: 0.0725188
	speed: 0.0222s/iter; left time: 960.9969s
	iters: 400, epoch: 8 | loss: 0.0007682
	speed: 0.0220s/iter; left time: 951.8891s
Epoch: 8 cost time: 10.702930450439453
Epoch: 8, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0120490
	speed: 0.1202s/iter; left time: 5176.3745s
	iters: 200, epoch: 9 | loss: 0.3058052
	speed: 0.0247s/iter; left time: 1059.4877s
	iters: 300, epoch: 9 | loss: 0.0794444
	speed: 0.0235s/iter; left time: 1004.9459s
	iters: 400, epoch: 9 | loss: 0.0035275
	speed: 0.0246s/iter; left time: 1050.0856s
Epoch: 9 cost time: 11.713602542877197
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.973412).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1250057
	speed: 0.1309s/iter; left time: 5574.9636s
	iters: 200, epoch: 10 | loss: 0.0289299
	speed: 0.0240s/iter; left time: 1020.4374s
	iters: 300, epoch: 10 | loss: 0.0069305
	speed: 0.0245s/iter; left time: 1038.7797s
	iters: 400, epoch: 10 | loss: 0.0212197
	speed: 0.0241s/iter; left time: 1017.4061s
Epoch: 10 cost time: 11.50341272354126
Epoch: 10, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0165330
	speed: 0.1352s/iter; left time: 5695.2032s
	iters: 200, epoch: 11 | loss: 0.0741477
	speed: 0.0219s/iter; left time: 921.8326s
	iters: 300, epoch: 11 | loss: 0.0070714
	speed: 0.0212s/iter; left time: 887.6981s
	iters: 400, epoch: 11 | loss: 0.0071895
	speed: 0.0227s/iter; left time: 948.3852s
Epoch: 11 cost time: 10.916103839874268
Epoch: 11, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
Validation loss decreased (-0.973412 --> -0.975699).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0007976
	speed: 0.1175s/iter; left time: 4891.3013s
	iters: 200, epoch: 12 | loss: 0.0258182
	speed: 0.0224s/iter; left time: 931.7187s
	iters: 300, epoch: 12 | loss: 0.0028978
	speed: 0.0231s/iter; left time: 959.0478s
	iters: 400, epoch: 12 | loss: 0.0095149
	speed: 0.0231s/iter; left time: 954.4482s
Epoch: 12 cost time: 11.07787561416626
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977129).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0323258
	speed: 0.1245s/iter; left time: 5125.5592s
	iters: 200, epoch: 13 | loss: 0.0020467
	speed: 0.0226s/iter; left time: 928.6398s
	iters: 300, epoch: 13 | loss: 0.0563168
	speed: 0.0219s/iter; left time: 898.5755s
	iters: 400, epoch: 13 | loss: 0.0055894
	speed: 0.0223s/iter; left time: 911.4121s
Epoch: 13 cost time: 10.926232814788818
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0148769
	speed: 0.1144s/iter; left time: 4657.2993s
	iters: 200, epoch: 14 | loss: 0.1772015
	speed: 0.0206s/iter; left time: 836.9455s
	iters: 300, epoch: 14 | loss: 0.0425861
	speed: 0.0222s/iter; left time: 898.9541s
	iters: 400, epoch: 14 | loss: 0.0012550
	speed: 0.0231s/iter; left time: 931.3460s
Epoch: 14 cost time: 10.78393268585205
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.977129 --> -0.978844).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0441291
	speed: 0.1306s/iter; left time: 5256.4943s
	iters: 200, epoch: 15 | loss: 1.1607358
	speed: 0.0225s/iter; left time: 901.7323s
	iters: 300, epoch: 15 | loss: 0.0066822
	speed: 0.0239s/iter; left time: 955.2647s
	iters: 400, epoch: 15 | loss: 0.0474677
	speed: 0.0235s/iter; left time: 938.0484s
Epoch: 15 cost time: 11.238189458847046
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0010600
	speed: 0.1296s/iter; left time: 5153.8847s
	iters: 200, epoch: 16 | loss: 0.1120149
	speed: 0.0228s/iter; left time: 903.9289s
	iters: 300, epoch: 16 | loss: 0.0021340
	speed: 0.0223s/iter; left time: 880.3974s
	iters: 400, epoch: 16 | loss: 0.4264182
	speed: 0.0222s/iter; left time: 875.2350s
Epoch: 16 cost time: 10.834136486053467
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0076044
	speed: 0.1262s/iter; left time: 4960.8505s
	iters: 200, epoch: 17 | loss: 0.0018119
	speed: 0.0236s/iter; left time: 924.6069s
	iters: 300, epoch: 17 | loss: 0.0091847
	speed: 0.0227s/iter; left time: 887.4959s
	iters: 400, epoch: 17 | loss: 0.0291367
	speed: 0.0226s/iter; left time: 883.0351s
Epoch: 17 cost time: 11.277372121810913
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0005180
	speed: 0.1150s/iter; left time: 4465.1169s
	iters: 200, epoch: 18 | loss: 0.0002906
	speed: 0.0214s/iter; left time: 827.6594s
	iters: 300, epoch: 18 | loss: 0.1393100
	speed: 0.0212s/iter; left time: 820.1649s
	iters: 400, epoch: 18 | loss: 0.0002818
	speed: 0.0227s/iter; left time: 876.3149s
Epoch: 18 cost time: 10.715921401977539
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0014699
	speed: 0.1137s/iter; left time: 4359.7355s
	iters: 200, epoch: 19 | loss: 0.0135414
	speed: 0.0216s/iter; left time: 826.8550s
	iters: 300, epoch: 19 | loss: 0.0575894
	speed: 0.0233s/iter; left time: 887.2605s
	iters: 400, epoch: 19 | loss: 0.0999697
	speed: 0.0219s/iter; left time: 832.6723s
Epoch: 19 cost time: 10.807840824127197
Epoch: 19, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0069786
	speed: 0.1247s/iter; left time: 4723.9296s
	iters: 200, epoch: 20 | loss: 0.0050853
	speed: 0.0220s/iter; left time: 832.5112s
	iters: 300, epoch: 20 | loss: 0.0017248
	speed: 0.0210s/iter; left time: 790.8548s
	iters: 400, epoch: 20 | loss: 0.1623696
	speed: 0.0217s/iter; left time: 815.7717s
Epoch: 20 cost time: 10.860056400299072
Epoch: 20, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0981764
	speed: 0.1149s/iter; left time: 4298.1470s
	iters: 200, epoch: 21 | loss: 0.0006597
	speed: 0.0231s/iter; left time: 860.3698s
	iters: 300, epoch: 21 | loss: 0.0056863
	speed: 0.0230s/iter; left time: 854.9050s
	iters: 400, epoch: 21 | loss: 0.0565280
	speed: 0.0255s/iter; left time: 945.5948s
Epoch: 21 cost time: 11.696903228759766
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0128228
	speed: 0.1176s/iter; left time: 4344.7151s
	iters: 200, epoch: 22 | loss: 0.0007766
	speed: 0.0243s/iter; left time: 896.4155s
	iters: 300, epoch: 22 | loss: 0.0193030
	speed: 0.0235s/iter; left time: 864.2125s
	iters: 400, epoch: 22 | loss: 0.0015091
	speed: 0.0238s/iter; left time: 873.1590s
Epoch: 22 cost time: 11.371553421020508
Epoch: 22, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0008556
	speed: 0.1167s/iter; left time: 4258.5162s
	iters: 200, epoch: 23 | loss: 0.0265365
	speed: 0.0223s/iter; left time: 811.5018s
	iters: 300, epoch: 23 | loss: 0.0000590
	speed: 0.0230s/iter; left time: 834.1447s
	iters: 400, epoch: 23 | loss: 0.0010531
	speed: 0.0233s/iter; left time: 842.9097s
Epoch: 23 cost time: 11.250090599060059
Epoch: 23, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0470413
	speed: 0.1248s/iter; left time: 4495.4795s
	iters: 200, epoch: 24 | loss: 0.0003869
	speed: 0.0218s/iter; left time: 783.0872s
	iters: 300, epoch: 24 | loss: 0.0703221
	speed: 0.0239s/iter; left time: 854.3915s
	iters: 400, epoch: 24 | loss: 0.0016217
	speed: 0.0235s/iter; left time: 840.8608s
Epoch: 24 cost time: 11.198452949523926
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 80290
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 277, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3571726
	speed: 0.0393s/iter; left time: 1838.8367s
	iters: 200, epoch: 1 | loss: 0.3767333
	speed: 0.0217s/iter; left time: 1012.9028s
	iters: 300, epoch: 1 | loss: 0.3447441
	speed: 0.0222s/iter; left time: 1033.8891s
	iters: 400, epoch: 1 | loss: 0.6654682
	speed: 0.0212s/iter; left time: 986.1733s
Epoch: 1 cost time: 12.22714638710022
Epoch: 1, Steps: 469 | Train Loss: 0.839 Vali Loss: 0.401 Vali Acc: 0.883 Test Loss: 0.401 Test Acc: 0.883
Validation loss decreased (inf --> -0.882500).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0869796
	speed: 0.1162s/iter; left time: 5384.9293s
	iters: 200, epoch: 2 | loss: 0.0630148
	speed: 0.0223s/iter; left time: 1031.9057s
	iters: 300, epoch: 2 | loss: 0.2393784
	speed: 0.0225s/iter; left time: 1038.1573s
	iters: 400, epoch: 2 | loss: 0.4043237
	speed: 0.0223s/iter; left time: 1024.3809s
Epoch: 2 cost time: 10.794328927993774
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.882500 --> -0.932530).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0324359
	speed: 0.1133s/iter; left time: 5197.5795s
	iters: 200, epoch: 3 | loss: 0.1180456
	speed: 0.0233s/iter; left time: 1064.9627s
	iters: 300, epoch: 3 | loss: 0.1487295
	speed: 0.0234s/iter; left time: 1069.7880s
	iters: 400, epoch: 3 | loss: 0.0535564
	speed: 0.0230s/iter; left time: 1048.5130s
Epoch: 3 cost time: 11.09340524673462
Epoch: 3, Steps: 469 | Train Loss: 0.132 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.932530 --> -0.951399).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6450580
	speed: 0.1215s/iter; left time: 5513.2579s
	iters: 200, epoch: 4 | loss: 0.1101072
	speed: 0.0240s/iter; left time: 1087.2801s
	iters: 300, epoch: 4 | loss: 0.0313048
	speed: 0.0246s/iter; left time: 1113.6268s
	iters: 400, epoch: 4 | loss: 0.0503172
	speed: 0.0267s/iter; left time: 1204.7296s
Epoch: 4 cost time: 12.061743974685669
Epoch: 4, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.951399 --> -0.962548).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0195082
	speed: 0.1221s/iter; left time: 5486.6505s
	iters: 200, epoch: 5 | loss: 0.0281471
	speed: 0.0229s/iter; left time: 1027.2030s
	iters: 300, epoch: 5 | loss: 0.0105527
	speed: 0.0247s/iter; left time: 1103.8951s
	iters: 400, epoch: 5 | loss: 0.0250976
	speed: 0.0237s/iter; left time: 1056.0047s
Epoch: 5 cost time: 11.540846586227417
Epoch: 5, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.962548 --> -0.965407).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0244734
	speed: 0.1156s/iter; left time: 5140.0806s
	iters: 200, epoch: 6 | loss: 0.0234002
	speed: 0.0231s/iter; left time: 1023.2814s
	iters: 300, epoch: 6 | loss: 0.0795423
	speed: 0.0237s/iter; left time: 1047.4250s
	iters: 400, epoch: 6 | loss: 0.0142668
	speed: 0.0238s/iter; left time: 1049.1705s
Epoch: 6 cost time: 11.474583864212036
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0053093
	speed: 0.1195s/iter; left time: 5255.8966s
	iters: 200, epoch: 7 | loss: 0.0422012
	speed: 0.0265s/iter; left time: 1162.2924s
	iters: 300, epoch: 7 | loss: 0.0122447
	speed: 0.0245s/iter; left time: 1073.4156s
	iters: 400, epoch: 7 | loss: 0.0894667
	speed: 0.0224s/iter; left time: 977.6359s
Epoch: 7 cost time: 11.734678268432617
Epoch: 7, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.965407 --> -0.971125).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1844210
	speed: 0.1217s/iter; left time: 5298.1256s
	iters: 200, epoch: 8 | loss: 0.4338154
	speed: 0.0228s/iter; left time: 990.5836s
	iters: 300, epoch: 8 | loss: 0.1653093
	speed: 0.0230s/iter; left time: 994.6142s
	iters: 400, epoch: 8 | loss: 0.0064400
	speed: 0.0221s/iter; left time: 957.1233s
Epoch: 8 cost time: 11.096513748168945
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0027552
	speed: 0.1199s/iter; left time: 5160.3209s
	iters: 200, epoch: 9 | loss: 0.0766445
	speed: 0.0229s/iter; left time: 984.8037s
	iters: 300, epoch: 9 | loss: 0.0244133
	speed: 0.0240s/iter; left time: 1027.0417s
	iters: 400, epoch: 9 | loss: 0.0245101
	speed: 0.0244s/iter; left time: 1040.9437s
Epoch: 9 cost time: 11.341957569122314
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.971125 --> -0.976271).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0127485
	speed: 0.1132s/iter; left time: 4820.5981s
	iters: 200, epoch: 10 | loss: 0.0062023
	speed: 0.0235s/iter; left time: 998.0298s
	iters: 300, epoch: 10 | loss: 0.0297909
	speed: 0.0235s/iter; left time: 995.6292s
	iters: 400, epoch: 10 | loss: 0.0275293
	speed: 0.0230s/iter; left time: 971.2758s
Epoch: 10 cost time: 11.095334529876709
Epoch: 10, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0752721
	speed: 0.1148s/iter; left time: 4833.1382s
	iters: 200, epoch: 11 | loss: 0.0144222
	speed: 0.0216s/iter; left time: 905.8864s
	iters: 300, epoch: 11 | loss: 0.0020217
	speed: 0.0223s/iter; left time: 936.0496s
	iters: 400, epoch: 11 | loss: 0.0512910
	speed: 0.0225s/iter; left time: 942.5194s
Epoch: 11 cost time: 10.904872417449951
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0076887
	speed: 0.1157s/iter; left time: 4818.6810s
	iters: 200, epoch: 12 | loss: 0.0200588
	speed: 0.0229s/iter; left time: 950.1873s
	iters: 300, epoch: 12 | loss: 0.0012533
	speed: 0.0219s/iter; left time: 906.5509s
	iters: 400, epoch: 12 | loss: 0.1041939
	speed: 0.0232s/iter; left time: 957.7902s
Epoch: 12 cost time: 11.090007781982422
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0777366
	speed: 0.1278s/iter; left time: 5260.8193s
	iters: 200, epoch: 13 | loss: 0.0096057
	speed: 0.0255s/iter; left time: 1046.3007s
	iters: 300, epoch: 13 | loss: 0.0360979
	speed: 0.0236s/iter; left time: 965.3664s
	iters: 400, epoch: 13 | loss: 0.0022789
	speed: 0.0240s/iter; left time: 982.1033s
Epoch: 13 cost time: 11.809090375900269
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0249798
	speed: 0.1273s/iter; left time: 5183.4594s
	iters: 200, epoch: 14 | loss: 0.0021511
	speed: 0.0224s/iter; left time: 909.5898s
	iters: 300, epoch: 14 | loss: 0.0277903
	speed: 0.0234s/iter; left time: 946.6803s
	iters: 400, epoch: 14 | loss: 0.0142532
	speed: 0.0248s/iter; left time: 1003.1763s
Epoch: 14 cost time: 11.582911252975464
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.978558).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0152414
	speed: 0.1188s/iter; left time: 4779.7907s
	iters: 200, epoch: 15 | loss: 0.0005396
	speed: 0.0258s/iter; left time: 1033.5508s
	iters: 300, epoch: 15 | loss: 0.0044404
	speed: 0.0250s/iter; left time: 1002.4371s
	iters: 400, epoch: 15 | loss: 0.0164532
	speed: 0.0248s/iter; left time: 989.0548s
Epoch: 15 cost time: 12.093878507614136
Epoch: 15, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0010569
	speed: 0.1137s/iter; left time: 4520.5656s
	iters: 200, epoch: 16 | loss: 0.0534309
	speed: 0.0216s/iter; left time: 856.2723s
	iters: 300, epoch: 16 | loss: 0.0005529
	speed: 0.0224s/iter; left time: 885.1282s
	iters: 400, epoch: 16 | loss: 0.0222664
	speed: 0.0237s/iter; left time: 935.4440s
Epoch: 16 cost time: 11.0480477809906
Epoch: 16, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0033660
	speed: 0.1149s/iter; left time: 4514.3592s
	iters: 200, epoch: 17 | loss: 0.0165485
	speed: 0.0230s/iter; left time: 899.9470s
	iters: 300, epoch: 17 | loss: 0.0192696
	speed: 0.0229s/iter; left time: 896.6216s
	iters: 400, epoch: 17 | loss: 0.0312095
	speed: 0.0228s/iter; left time: 887.2829s
Epoch: 17 cost time: 11.026526927947998
Epoch: 17, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979416).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0339093
	speed: 0.1205s/iter; left time: 4678.8198s
	iters: 200, epoch: 18 | loss: 0.0132897
	speed: 0.0238s/iter; left time: 919.9837s
	iters: 300, epoch: 18 | loss: 0.2595726
	speed: 0.0230s/iter; left time: 887.5519s
	iters: 400, epoch: 18 | loss: 0.0106555
	speed: 0.0219s/iter; left time: 844.9599s
Epoch: 18 cost time: 11.271989107131958
Epoch: 18, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0523311
	speed: 0.1139s/iter; left time: 4367.8913s
	iters: 200, epoch: 19 | loss: 0.0855452
	speed: 0.0217s/iter; left time: 830.2112s
	iters: 300, epoch: 19 | loss: 0.0044840
	speed: 0.0222s/iter; left time: 848.7607s
	iters: 400, epoch: 19 | loss: 0.0560181
	speed: 0.0228s/iter; left time: 867.5565s
Epoch: 19 cost time: 10.873080730438232
Epoch: 19, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0233878
	speed: 0.1115s/iter; left time: 4226.1415s
	iters: 200, epoch: 20 | loss: 0.0012935
	speed: 0.0227s/iter; left time: 858.0768s
	iters: 300, epoch: 20 | loss: 0.0018122
	speed: 0.0229s/iter; left time: 861.5744s
	iters: 400, epoch: 20 | loss: 0.0012938
	speed: 0.0234s/iter; left time: 878.7958s
Epoch: 20 cost time: 10.877539157867432
Epoch: 20, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0008397
	speed: 0.1107s/iter; left time: 4144.1673s
	iters: 200, epoch: 21 | loss: 0.0008516
	speed: 0.0246s/iter; left time: 919.1718s
	iters: 300, epoch: 21 | loss: 0.0040358
	speed: 0.0237s/iter; left time: 881.4181s
	iters: 400, epoch: 21 | loss: 0.0017331
	speed: 0.0231s/iter; left time: 859.2597s
Epoch: 21 cost time: 11.815214395523071
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0471224
	speed: 0.1283s/iter; left time: 4739.9494s
	iters: 200, epoch: 22 | loss: 0.0470472
	speed: 0.0248s/iter; left time: 912.4119s
	iters: 300, epoch: 22 | loss: 0.0022893
	speed: 0.0256s/iter; left time: 939.5984s
	iters: 400, epoch: 22 | loss: 0.0671132
	speed: 0.0254s/iter; left time: 931.0987s
Epoch: 22 cost time: 11.928878545761108
Epoch: 22, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0052341
	speed: 0.1276s/iter; left time: 4656.0446s
	iters: 200, epoch: 23 | loss: 0.0118418
	speed: 0.0248s/iter; left time: 903.1524s
	iters: 300, epoch: 23 | loss: 0.0017237
	speed: 0.0239s/iter; left time: 867.8112s
	iters: 400, epoch: 23 | loss: 0.0098401
	speed: 0.0243s/iter; left time: 880.6770s
Epoch: 23 cost time: 11.605249404907227
Epoch: 23, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0032105
	speed: 0.1196s/iter; left time: 4305.8230s
	iters: 200, epoch: 24 | loss: 0.0930463
	speed: 0.0240s/iter; left time: 863.0350s
	iters: 300, epoch: 24 | loss: 0.0135905
	speed: 0.0238s/iter; left time: 852.2364s
	iters: 400, epoch: 24 | loss: 0.0048491
	speed: 0.0213s/iter; left time: 759.2646s
Epoch: 24 cost time: 11.360138416290283
Epoch: 24, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0070612
	speed: 0.1181s/iter; left time: 4197.5863s
	iters: 200, epoch: 25 | loss: 0.0003312
	speed: 0.0225s/iter; left time: 796.0553s
	iters: 300, epoch: 25 | loss: 0.0130370
	speed: 0.0241s/iter; left time: 850.4032s
	iters: 400, epoch: 25 | loss: 0.0033209
	speed: 0.0228s/iter; left time: 802.1044s
Epoch: 25 cost time: 11.186831712722778
Epoch: 25, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0103479
	speed: 0.1154s/iter; left time: 4049.3057s
	iters: 200, epoch: 26 | loss: 0.0066781
	speed: 0.0222s/iter; left time: 776.3749s
	iters: 300, epoch: 26 | loss: 0.0047041
	speed: 0.0235s/iter; left time: 818.3494s
	iters: 400, epoch: 26 | loss: 0.0003355
	speed: 0.0226s/iter; left time: 784.9594s
Epoch: 26 cost time: 11.130446672439575
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
Validation loss decreased (-0.979702 --> -0.981989).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0006815
	speed: 0.1225s/iter; left time: 4240.3445s
	iters: 200, epoch: 27 | loss: 0.0117300
	speed: 0.0222s/iter; left time: 765.0822s
	iters: 300, epoch: 27 | loss: 0.0080494
	speed: 0.0234s/iter; left time: 806.7689s
	iters: 400, epoch: 27 | loss: 0.0021922
	speed: 0.0235s/iter; left time: 805.8828s
Epoch: 27 cost time: 11.249373435974121
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0002052
	speed: 0.1216s/iter; left time: 4150.7097s
	iters: 200, epoch: 28 | loss: 0.0007655
	speed: 0.0209s/iter; left time: 709.9191s
	iters: 300, epoch: 28 | loss: 0.0023483
	speed: 0.0241s/iter; left time: 818.8821s
	iters: 400, epoch: 28 | loss: 0.0023066
	speed: 0.0242s/iter; left time: 819.3052s
Epoch: 28 cost time: 11.274161338806152
Epoch: 28, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0028210
	speed: 0.1153s/iter; left time: 3880.8470s
	iters: 200, epoch: 29 | loss: 0.0003487
	speed: 0.0227s/iter; left time: 762.5029s
	iters: 300, epoch: 29 | loss: 0.0057493
	speed: 0.0243s/iter; left time: 813.9105s
	iters: 400, epoch: 29 | loss: 0.0047008
	speed: 0.0243s/iter; left time: 810.2941s
Epoch: 29 cost time: 11.6573646068573
Epoch: 29, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.981989 --> -0.983990).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0054769
	speed: 0.1161s/iter; left time: 3854.8565s
	iters: 200, epoch: 30 | loss: 0.1424095
	speed: 0.0234s/iter; left time: 776.1211s
	iters: 300, epoch: 30 | loss: 0.0148609
	speed: 0.0240s/iter; left time: 791.6029s
	iters: 400, epoch: 30 | loss: 0.0297229
	speed: 0.0237s/iter; left time: 780.7862s
Epoch: 30 cost time: 11.30582308769226
Epoch: 30, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0597614
	speed: 0.1097s/iter; left time: 3590.1142s
	iters: 200, epoch: 31 | loss: 0.0002258
	speed: 0.0239s/iter; left time: 778.8054s
	iters: 300, epoch: 31 | loss: 0.0000406
	speed: 0.0249s/iter; left time: 808.6359s
	iters: 400, epoch: 31 | loss: 0.0231012
	speed: 0.0254s/iter; left time: 823.7802s
Epoch: 31 cost time: 12.017393112182617
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0051707
	speed: 0.1294s/iter; left time: 4173.7173s
	iters: 200, epoch: 32 | loss: 0.0027949
	speed: 0.0250s/iter; left time: 803.2225s
	iters: 300, epoch: 32 | loss: 0.0007488
	speed: 0.0236s/iter; left time: 757.9482s
	iters: 400, epoch: 32 | loss: 0.0007342
	speed: 0.0238s/iter; left time: 760.2926s
Epoch: 32 cost time: 11.839495420455933
Epoch: 32, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 33 | loss: 0.0122759
	speed: 0.1177s/iter; left time: 3741.0953s
	iters: 200, epoch: 33 | loss: 0.0004269
	speed: 0.0224s/iter; left time: 709.1298s
	iters: 300, epoch: 33 | loss: 0.0006485
	speed: 0.0221s/iter; left time: 699.5510s
	iters: 400, epoch: 33 | loss: 0.0002538
	speed: 0.0231s/iter; left time: 726.7900s
Epoch: 33 cost time: 11.083674907684326
Epoch: 33, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 34 | loss: 0.0023184
	speed: 0.1176s/iter; left time: 3684.9801s
	iters: 200, epoch: 34 | loss: 0.0022909
	speed: 0.0239s/iter; left time: 746.0065s
	iters: 300, epoch: 34 | loss: 0.0078742
	speed: 0.0237s/iter; left time: 738.9345s
	iters: 400, epoch: 34 | loss: 0.0002385
	speed: 0.0231s/iter; left time: 717.0849s
Epoch: 34 cost time: 11.344395160675049
Epoch: 34, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 35 | loss: 0.0004937
	speed: 0.1174s/iter; left time: 3622.2431s
	iters: 200, epoch: 35 | loss: 0.0075850
	speed: 0.0230s/iter; left time: 705.9889s
	iters: 300, epoch: 35 | loss: 0.0191290
	speed: 0.0225s/iter; left time: 690.4920s
	iters: 400, epoch: 35 | loss: 0.0029619
	speed: 0.0219s/iter; left time: 668.0383s
Epoch: 35 cost time: 11.151405096054077
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 36 | loss: 0.3351105
	speed: 0.1271s/iter; left time: 3863.4816s
	iters: 200, epoch: 36 | loss: 0.0650708
	speed: 0.0227s/iter; left time: 687.0543s
	iters: 300, epoch: 36 | loss: 0.1154089
	speed: 0.0243s/iter; left time: 733.9494s
	iters: 400, epoch: 36 | loss: 0.0000343
	speed: 0.0220s/iter; left time: 662.4590s
Epoch: 36 cost time: 11.243614196777344
Epoch: 36, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 37 | loss: 0.0172256
	speed: 0.1235s/iter; left time: 3693.9653s
	iters: 200, epoch: 37 | loss: 0.0013233
	speed: 0.0233s/iter; left time: 693.5188s
	iters: 300, epoch: 37 | loss: 0.0002292
	speed: 0.0226s/iter; left time: 672.5355s
	iters: 400, epoch: 37 | loss: 0.0003660
	speed: 0.0215s/iter; left time: 637.3112s
Epoch: 37 cost time: 11.054229497909546
Epoch: 37, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 38 | loss: 0.0007699
	speed: 0.1151s/iter; left time: 3388.7944s
	iters: 200, epoch: 38 | loss: 0.0003050
	speed: 0.0234s/iter; left time: 686.8336s
	iters: 300, epoch: 38 | loss: 0.0014553
	speed: 0.0234s/iter; left time: 683.2604s
	iters: 400, epoch: 38 | loss: 0.0004794
	speed: 0.0231s/iter; left time: 672.2259s
Epoch: 38 cost time: 11.375766277313232
Epoch: 38, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 39 | loss: 0.0000895
	speed: 0.1151s/iter; left time: 3335.7839s
	iters: 200, epoch: 39 | loss: 0.0030904
	speed: 0.0242s/iter; left time: 699.4908s
	iters: 300, epoch: 39 | loss: 0.0016135
	speed: 0.0235s/iter; left time: 677.2731s
	iters: 400, epoch: 39 | loss: 0.0135960
	speed: 0.0224s/iter; left time: 642.8004s
Epoch: 39 cost time: 11.318218231201172
Epoch: 39, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9839908519153803
model parameter : 47522
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.3676410
	speed: 0.0391s/iter; left time: 1831.6840s
	iters: 200, epoch: 1 | loss: 0.4213379
	speed: 0.0211s/iter; left time: 983.7308s
	iters: 300, epoch: 1 | loss: 0.3904900
	speed: 0.0217s/iter; left time: 1011.3585s
	iters: 400, epoch: 1 | loss: 0.6711504
	speed: 0.0206s/iter; left time: 959.9885s
Epoch: 1 cost time: 11.93620777130127
Epoch: 1, Steps: 469 | Train Loss: 0.871 Vali Loss: 0.403 Vali Acc: 0.887 Test Loss: 0.403 Test Acc: 0.887
Validation loss decreased (inf --> -0.886503).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0778801
	speed: 0.1217s/iter; left time: 5638.4560s
	iters: 200, epoch: 2 | loss: 0.0740038
	speed: 0.0213s/iter; left time: 983.0775s
	iters: 300, epoch: 2 | loss: 0.2368661
	speed: 0.0211s/iter; left time: 974.7240s
	iters: 400, epoch: 2 | loss: 0.3005185
	speed: 0.0196s/iter; left time: 901.6471s
Epoch: 2 cost time: 10.3313889503479
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.250 Vali Acc: 0.935 Test Loss: 0.250 Test Acc: 0.935
Validation loss decreased (-0.886503 --> -0.935103).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0176268
	speed: 0.1123s/iter; left time: 5148.9770s
	iters: 200, epoch: 3 | loss: 0.1475008
	speed: 0.0214s/iter; left time: 977.7188s
	iters: 300, epoch: 3 | loss: 0.1007833
	speed: 0.0210s/iter; left time: 960.2036s
	iters: 400, epoch: 3 | loss: 0.0808715
	speed: 0.0201s/iter; left time: 916.1071s
Epoch: 3 cost time: 10.227235555648804
Epoch: 3, Steps: 469 | Train Loss: 0.130 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
Validation loss decreased (-0.935103 --> -0.959404).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5949767
	speed: 0.1152s/iter; left time: 5227.9569s
	iters: 200, epoch: 4 | loss: 0.1336217
	speed: 0.0226s/iter; left time: 1022.3382s
	iters: 300, epoch: 4 | loss: 0.0388055
	speed: 0.0214s/iter; left time: 968.9164s
	iters: 400, epoch: 4 | loss: 0.0250914
	speed: 0.0212s/iter; left time: 954.0188s
Epoch: 4 cost time: 10.78184199333191
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.959404 --> -0.961977).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0187672
	speed: 0.1146s/iter; left time: 5150.2971s
	iters: 200, epoch: 5 | loss: 0.0296102
	speed: 0.0213s/iter; left time: 955.5641s
	iters: 300, epoch: 5 | loss: 0.0121892
	speed: 0.0231s/iter; left time: 1032.5576s
	iters: 400, epoch: 5 | loss: 0.0186946
	speed: 0.0233s/iter; left time: 1038.4901s
Epoch: 5 cost time: 10.955070972442627
Epoch: 5, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.961977 --> -0.963692).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0313038
	speed: 0.1249s/iter; left time: 5553.7293s
	iters: 200, epoch: 6 | loss: 0.0277513
	speed: 0.0208s/iter; left time: 922.5262s
	iters: 300, epoch: 6 | loss: 0.0579887
	speed: 0.0223s/iter; left time: 988.0548s
	iters: 400, epoch: 6 | loss: 0.0081334
	speed: 0.0230s/iter; left time: 1015.9993s
Epoch: 6 cost time: 10.931735515594482
Epoch: 6, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0040432
	speed: 0.1246s/iter; left time: 5482.6061s
	iters: 200, epoch: 7 | loss: 0.0518169
	speed: 0.0216s/iter; left time: 946.5528s
	iters: 300, epoch: 7 | loss: 0.0292248
	speed: 0.0222s/iter; left time: 973.3210s
	iters: 400, epoch: 7 | loss: 0.1035562
	speed: 0.0221s/iter; left time: 963.9824s
Epoch: 7 cost time: 11.001635074615479
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.2372660
	speed: 0.1197s/iter; left time: 5208.2846s
	iters: 200, epoch: 8 | loss: 0.3864454
	speed: 0.0237s/iter; left time: 1030.9265s
	iters: 300, epoch: 8 | loss: 0.0560952
	speed: 0.0232s/iter; left time: 1004.6300s
	iters: 400, epoch: 8 | loss: 0.0103256
	speed: 0.0204s/iter; left time: 881.7167s
Epoch: 8 cost time: 11.154584169387817
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.963692 --> -0.966837).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0017862
	speed: 0.1088s/iter; left time: 4682.0722s
	iters: 200, epoch: 9 | loss: 0.2594346
	speed: 0.0247s/iter; left time: 1059.5542s
	iters: 300, epoch: 9 | loss: 0.0281074
	speed: 0.0234s/iter; left time: 1004.5802s
	iters: 400, epoch: 9 | loss: 0.0353916
	speed: 0.0224s/iter; left time: 959.0388s
Epoch: 9 cost time: 11.444581985473633
Epoch: 9, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.966837 --> -0.971983).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0036037
	speed: 0.1177s/iter; left time: 5013.3126s
	iters: 200, epoch: 10 | loss: 0.0072190
	speed: 0.0235s/iter; left time: 996.7306s
	iters: 300, epoch: 10 | loss: 0.2436564
	speed: 0.0233s/iter; left time: 988.5879s
	iters: 400, epoch: 10 | loss: 0.0638769
	speed: 0.0232s/iter; left time: 982.5172s
Epoch: 10 cost time: 11.464170932769775
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0164798
	speed: 0.1200s/iter; left time: 5052.5707s
	iters: 200, epoch: 11 | loss: 0.0837628
	speed: 0.0218s/iter; left time: 914.5313s
	iters: 300, epoch: 11 | loss: 0.0134685
	speed: 0.0211s/iter; left time: 886.1903s
	iters: 400, epoch: 11 | loss: 0.0244771
	speed: 0.0223s/iter; left time: 932.5663s
Epoch: 11 cost time: 10.792973041534424
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0202741
	speed: 0.1146s/iter; left time: 4772.1039s
	iters: 200, epoch: 12 | loss: 0.0218880
	speed: 0.0227s/iter; left time: 943.2505s
	iters: 300, epoch: 12 | loss: 0.0060081
	speed: 0.0223s/iter; left time: 925.2931s
	iters: 400, epoch: 12 | loss: 0.0764648
	speed: 0.0230s/iter; left time: 952.0954s
Epoch: 12 cost time: 10.960209369659424
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0063156
	speed: 0.1151s/iter; left time: 4739.7470s
	iters: 200, epoch: 13 | loss: 0.0094721
	speed: 0.0214s/iter; left time: 879.4803s
	iters: 300, epoch: 13 | loss: 0.0292635
	speed: 0.0209s/iter; left time: 855.1331s
	iters: 400, epoch: 13 | loss: 0.0021683
	speed: 0.0213s/iter; left time: 872.0599s
Epoch: 13 cost time: 10.547577142715454
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0049749
	speed: 0.1148s/iter; left time: 4673.6939s
	iters: 200, epoch: 14 | loss: 0.0012739
	speed: 0.0233s/iter; left time: 946.8493s
	iters: 300, epoch: 14 | loss: 0.0406056
	speed: 0.0225s/iter; left time: 911.9991s
	iters: 400, epoch: 14 | loss: 0.0421475
	speed: 0.0210s/iter; left time: 850.2375s
Epoch: 14 cost time: 10.841275215148926
Epoch: 14, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.977129).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0089051
	speed: 0.1228s/iter; left time: 4939.5173s
	iters: 200, epoch: 15 | loss: 0.0013129
	speed: 0.0236s/iter; left time: 947.0594s
	iters: 300, epoch: 15 | loss: 0.0011122
	speed: 0.0218s/iter; left time: 873.9785s
	iters: 400, epoch: 15 | loss: 0.0939927
	speed: 0.0220s/iter; left time: 877.7216s
Epoch: 15 cost time: 11.104325294494629
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0014711
	speed: 0.1297s/iter; left time: 5158.7709s
	iters: 200, epoch: 16 | loss: 0.0359394
	speed: 0.0230s/iter; left time: 912.3459s
	iters: 300, epoch: 16 | loss: 0.0051893
	speed: 0.0211s/iter; left time: 833.6063s
	iters: 400, epoch: 16 | loss: 0.0054628
	speed: 0.0230s/iter; left time: 908.0776s
Epoch: 16 cost time: 11.05684757232666
Epoch: 16, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0409361
	speed: 0.1176s/iter; left time: 4619.3957s
	iters: 200, epoch: 17 | loss: 0.0093489
	speed: 0.0239s/iter; left time: 938.3758s
	iters: 300, epoch: 17 | loss: 0.0076735
	speed: 0.0233s/iter; left time: 911.2006s
	iters: 400, epoch: 17 | loss: 0.0078875
	speed: 0.0234s/iter; left time: 914.0505s
Epoch: 17 cost time: 11.407938003540039
Epoch: 17, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0470046
	speed: 0.1191s/iter; left time: 4623.1643s
	iters: 200, epoch: 18 | loss: 0.0072108
	speed: 0.0230s/iter; left time: 889.7564s
	iters: 300, epoch: 18 | loss: 0.1661951
	speed: 0.0230s/iter; left time: 887.9904s
	iters: 400, epoch: 18 | loss: 0.0012723
	speed: 0.0223s/iter; left time: 860.8545s
Epoch: 18 cost time: 11.182449340820312
Epoch: 18, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.3959449
	speed: 0.1148s/iter; left time: 4403.0042s
	iters: 200, epoch: 19 | loss: 0.0115609
	speed: 0.0233s/iter; left time: 892.0010s
	iters: 300, epoch: 19 | loss: 0.0323288
	speed: 0.0230s/iter; left time: 877.1870s
	iters: 400, epoch: 19 | loss: 0.0257648
	speed: 0.0225s/iter; left time: 855.1021s
Epoch: 19 cost time: 11.168022871017456
Epoch: 19, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0185283
	speed: 0.1173s/iter; left time: 4442.9075s
	iters: 200, epoch: 20 | loss: 0.0043372
	speed: 0.0217s/iter; left time: 818.3966s
	iters: 300, epoch: 20 | loss: 0.0055103
	speed: 0.0226s/iter; left time: 851.2140s
	iters: 400, epoch: 20 | loss: 0.0044154
	speed: 0.0213s/iter; left time: 799.1835s
Epoch: 20 cost time: 10.487748146057129
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0031594
	speed: 0.1197s/iter; left time: 4480.7674s
	iters: 200, epoch: 21 | loss: 0.0001211
	speed: 0.0218s/iter; left time: 812.1048s
	iters: 300, epoch: 21 | loss: 0.0056973
	speed: 0.0217s/iter; left time: 807.3306s
	iters: 400, epoch: 21 | loss: 0.0021006
	speed: 0.0214s/iter; left time: 795.4605s
Epoch: 21 cost time: 10.645537376403809
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0442787
	speed: 0.1102s/iter; left time: 4072.0703s
	iters: 200, epoch: 22 | loss: 0.0049488
	speed: 0.0227s/iter; left time: 834.7564s
	iters: 300, epoch: 22 | loss: 0.0044108
	speed: 0.0232s/iter; left time: 853.4892s
	iters: 400, epoch: 22 | loss: 0.0283131
	speed: 0.0212s/iter; left time: 776.4835s
Epoch: 22 cost time: 10.82158088684082
Epoch: 22, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0085227
	speed: 0.1115s/iter; left time: 4068.2731s
	iters: 200, epoch: 23 | loss: 0.0125747
	speed: 0.0206s/iter; left time: 747.6751s
	iters: 300, epoch: 23 | loss: 0.0522842
	speed: 0.0204s/iter; left time: 740.8322s
	iters: 400, epoch: 23 | loss: 0.0795140
	speed: 0.0223s/iter; left time: 807.3118s
Epoch: 23 cost time: 10.375446081161499
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 24 | loss: 0.0004795
	speed: 0.1195s/iter; left time: 4304.0162s
	iters: 200, epoch: 24 | loss: 0.1445670
	speed: 0.0218s/iter; left time: 784.0116s
	iters: 300, epoch: 24 | loss: 0.0046217
	speed: 0.0214s/iter; left time: 764.6486s
	iters: 400, epoch: 24 | loss: 0.0012967
	speed: 0.0233s/iter; left time: 831.0779s
Epoch: 24 cost time: 10.87895154953003
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9771297884505432
model parameter : 47522
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5303100
	speed: 0.0393s/iter; left time: 1839.3630s
	iters: 200, epoch: 1 | loss: 0.5124390
	speed: 0.0234s/iter; left time: 1094.5019s
	iters: 300, epoch: 1 | loss: 0.4900959
	speed: 0.0209s/iter; left time: 975.9360s
	iters: 400, epoch: 1 | loss: 0.7390915
	speed: 0.0218s/iter; left time: 1014.7185s
Epoch: 1 cost time: 12.109788179397583
Epoch: 1, Steps: 469 | Train Loss: 0.911 Vali Loss: 0.363 Vali Acc: 0.898 Test Loss: 0.363 Test Acc: 0.898
Validation loss decreased (inf --> -0.897938).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0940645
	speed: 0.1109s/iter; left time: 5138.2709s
	iters: 200, epoch: 2 | loss: 0.0743914
	speed: 0.0212s/iter; left time: 979.6330s
	iters: 300, epoch: 2 | loss: 0.1700525
	speed: 0.0206s/iter; left time: 949.3626s
	iters: 400, epoch: 2 | loss: 0.2896813
	speed: 0.0214s/iter; left time: 985.3650s
Epoch: 2 cost time: 10.364126682281494
Epoch: 2, Steps: 469 | Train Loss: 0.208 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
Validation loss decreased (-0.897938 --> -0.948826).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0206753
	speed: 0.1109s/iter; left time: 5086.7086s
	iters: 200, epoch: 3 | loss: 0.1081870
	speed: 0.0203s/iter; left time: 929.4905s
	iters: 300, epoch: 3 | loss: 0.1527021
	speed: 0.0210s/iter; left time: 960.0610s
	iters: 400, epoch: 3 | loss: 0.0682486
	speed: 0.0218s/iter; left time: 993.5739s
Epoch: 3 cost time: 10.13930344581604
Epoch: 3, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
Validation loss decreased (-0.948826 --> -0.961119).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7365619
	speed: 0.1110s/iter; left time: 5040.9025s
	iters: 200, epoch: 4 | loss: 0.0313493
	speed: 0.0220s/iter; left time: 996.1242s
	iters: 300, epoch: 4 | loss: 0.0370787
	speed: 0.0214s/iter; left time: 965.4512s
	iters: 400, epoch: 4 | loss: 0.0115496
	speed: 0.0209s/iter; left time: 944.1606s
Epoch: 4 cost time: 10.46069884300232
Epoch: 4, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.961119 --> -0.965979).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0174797
	speed: 0.1139s/iter; left time: 5118.5683s
	iters: 200, epoch: 5 | loss: 0.0324728
	speed: 0.0213s/iter; left time: 954.4038s
	iters: 300, epoch: 5 | loss: 0.0095911
	speed: 0.0221s/iter; left time: 990.5761s
	iters: 400, epoch: 5 | loss: 0.0299955
	speed: 0.0208s/iter; left time: 929.8282s
Epoch: 5 cost time: 10.419097900390625
Epoch: 5, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.965979 --> -0.969410).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0587020
	speed: 0.1095s/iter; left time: 4869.8693s
	iters: 200, epoch: 6 | loss: 0.0568810
	speed: 0.0203s/iter; left time: 901.5020s
	iters: 300, epoch: 6 | loss: 0.0551543
	speed: 0.0209s/iter; left time: 926.0134s
	iters: 400, epoch: 6 | loss: 0.0588274
	speed: 0.0203s/iter; left time: 896.4790s
Epoch: 6 cost time: 10.020577430725098
Epoch: 6, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969410 --> -0.969696).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0030222
	speed: 0.1121s/iter; left time: 4931.3075s
	iters: 200, epoch: 7 | loss: 0.0072324
	speed: 0.0214s/iter; left time: 940.7071s
	iters: 300, epoch: 7 | loss: 0.0204221
	speed: 0.0213s/iter; left time: 932.0329s
	iters: 400, epoch: 7 | loss: 0.0624726
	speed: 0.0213s/iter; left time: 928.8702s
Epoch: 7 cost time: 10.374961853027344
Epoch: 7, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0962634
	speed: 0.1140s/iter; left time: 4960.6446s
	iters: 200, epoch: 8 | loss: 0.2225053
	speed: 0.0234s/iter; left time: 1015.0456s
	iters: 300, epoch: 8 | loss: 0.0150482
	speed: 0.0217s/iter; left time: 941.1850s
	iters: 400, epoch: 8 | loss: 0.0062597
	speed: 0.0217s/iter; left time: 939.5216s
Epoch: 8 cost time: 10.847819566726685
Epoch: 8, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0128282
	speed: 0.1211s/iter; left time: 5212.1865s
	iters: 200, epoch: 9 | loss: 0.0223861
	speed: 0.0223s/iter; left time: 957.6383s
	iters: 300, epoch: 9 | loss: 0.0462910
	speed: 0.0231s/iter; left time: 988.5666s
	iters: 400, epoch: 9 | loss: 0.0147267
	speed: 0.0253s/iter; left time: 1081.9347s
Epoch: 9 cost time: 11.446450471878052
Epoch: 9, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0027180
	speed: 0.1260s/iter; left time: 5364.9562s
	iters: 200, epoch: 10 | loss: 0.0062023
	speed: 0.0231s/iter; left time: 980.0531s
	iters: 300, epoch: 10 | loss: 0.1408567
	speed: 0.0249s/iter; left time: 1055.4015s
	iters: 400, epoch: 10 | loss: 0.0233985
	speed: 0.0218s/iter; left time: 922.1303s
Epoch: 10 cost time: 11.573843002319336
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.971411).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0447112
	speed: 0.1369s/iter; left time: 5764.6394s
	iters: 200, epoch: 11 | loss: 0.0248841
	speed: 0.0176s/iter; left time: 739.1063s
	iters: 300, epoch: 11 | loss: 0.0260812
	speed: 0.0184s/iter; left time: 772.3338s
	iters: 400, epoch: 11 | loss: 0.0154989
	speed: 0.0180s/iter; left time: 751.8648s
Epoch: 11 cost time: 9.64805269241333
Epoch: 11, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0052632
	speed: 0.0935s/iter; left time: 3891.9726s
	iters: 200, epoch: 12 | loss: 0.0031262
	speed: 0.0193s/iter; left time: 800.9497s
	iters: 300, epoch: 12 | loss: 0.0014681
	speed: 0.0203s/iter; left time: 841.0510s
	iters: 400, epoch: 12 | loss: 0.0058215
	speed: 0.0219s/iter; left time: 906.5816s
Epoch: 12 cost time: 9.909844636917114
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0073284
	speed: 0.1129s/iter; left time: 4649.4742s
	iters: 200, epoch: 13 | loss: 0.0072829
	speed: 0.0227s/iter; left time: 930.3224s
	iters: 300, epoch: 13 | loss: 0.0224925
	speed: 0.0210s/iter; left time: 859.6912s
	iters: 400, epoch: 13 | loss: 0.0067484
	speed: 0.0213s/iter; left time: 870.5551s
Epoch: 13 cost time: 10.665555238723755
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.972269).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0404590
	speed: 0.1161s/iter; left time: 4726.5103s
	iters: 200, epoch: 14 | loss: 0.0021491
	speed: 0.0214s/iter; left time: 869.9742s
	iters: 300, epoch: 14 | loss: 0.0942236
	speed: 0.0210s/iter; left time: 848.5940s
	iters: 400, epoch: 14 | loss: 0.0028292
	speed: 0.0230s/iter; left time: 929.1125s
Epoch: 14 cost time: 10.739440679550171
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.972269 --> -0.977129).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0752654
	speed: 0.1131s/iter; left time: 4548.6988s
	iters: 200, epoch: 15 | loss: 0.0141193
	speed: 0.0205s/iter; left time: 821.6071s
	iters: 300, epoch: 15 | loss: 0.0133967
	speed: 0.0213s/iter; left time: 851.4170s
	iters: 400, epoch: 15 | loss: 0.1072026
	speed: 0.0212s/iter; left time: 847.8120s
Epoch: 15 cost time: 10.418649911880493
Epoch: 15, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0176759
	speed: 0.1164s/iter; left time: 4629.9840s
	iters: 200, epoch: 16 | loss: 0.0036298
	speed: 0.0206s/iter; left time: 816.8035s
	iters: 300, epoch: 16 | loss: 0.0007300
	speed: 0.0201s/iter; left time: 794.9886s
	iters: 400, epoch: 16 | loss: 0.0047530
	speed: 0.0208s/iter; left time: 822.0144s
Epoch: 16 cost time: 10.20919942855835
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0188784
	speed: 0.1179s/iter; left time: 4632.9604s
	iters: 200, epoch: 17 | loss: 0.0106042
	speed: 0.0212s/iter; left time: 829.0686s
	iters: 300, epoch: 17 | loss: 0.0085436
	speed: 0.0207s/iter; left time: 808.3132s
	iters: 400, epoch: 17 | loss: 0.0235617
	speed: 0.0217s/iter; left time: 845.1316s
Epoch: 17 cost time: 10.579205989837646
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0378590
	speed: 0.1131s/iter; left time: 4390.7256s
	iters: 200, epoch: 18 | loss: 0.0109839
	speed: 0.0236s/iter; left time: 914.6905s
	iters: 300, epoch: 18 | loss: 0.0639503
	speed: 0.0233s/iter; left time: 900.2927s
	iters: 400, epoch: 18 | loss: 0.0166061
	speed: 0.0229s/iter; left time: 883.8768s
Epoch: 18 cost time: 11.212044477462769
Epoch: 18, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0426202
	speed: 0.1126s/iter; left time: 4319.0591s
	iters: 200, epoch: 19 | loss: 0.0172018
	speed: 0.0218s/iter; left time: 834.1166s
	iters: 300, epoch: 19 | loss: 0.0075438
	speed: 0.0232s/iter; left time: 885.0890s
	iters: 400, epoch: 19 | loss: 0.0406989
	speed: 0.0222s/iter; left time: 845.2158s
Epoch: 19 cost time: 11.048722743988037
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0187407
	speed: 0.1114s/iter; left time: 4220.4557s
	iters: 200, epoch: 20 | loss: 0.0022570
	speed: 0.0213s/iter; left time: 806.2855s
	iters: 300, epoch: 20 | loss: 0.0037694
	speed: 0.0214s/iter; left time: 805.9558s
	iters: 400, epoch: 20 | loss: 0.0200237
	speed: 0.0215s/iter; left time: 808.7256s
Epoch: 20 cost time: 10.430495023727417
Epoch: 20, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 21 | loss: 0.0000133
	speed: 0.1145s/iter; left time: 4283.1842s
	iters: 200, epoch: 21 | loss: 0.0005170
	speed: 0.0199s/iter; left time: 743.3616s
	iters: 300, epoch: 21 | loss: 0.0055892
	speed: 0.0205s/iter; left time: 763.7695s
	iters: 400, epoch: 21 | loss: 0.0219284
	speed: 0.0196s/iter; left time: 728.1826s
Epoch: 21 cost time: 10.046159505844116
Epoch: 21, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 22 | loss: 0.0423079
	speed: 0.1143s/iter; left time: 4223.4808s
	iters: 200, epoch: 22 | loss: 0.0001261
	speed: 0.0209s/iter; left time: 768.4653s
	iters: 300, epoch: 22 | loss: 0.0092254
	speed: 0.0198s/iter; left time: 729.0919s
	iters: 400, epoch: 22 | loss: 0.0101964
	speed: 0.0212s/iter; left time: 777.5826s
Epoch: 22 cost time: 10.204570055007935
Epoch: 22, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 23 | loss: 0.0072729
	speed: 0.1064s/iter; left time: 3882.2611s
	iters: 200, epoch: 23 | loss: 0.0259067
	speed: 0.0208s/iter; left time: 757.4148s
	iters: 300, epoch: 23 | loss: 0.0029068
	speed: 0.0215s/iter; left time: 779.2077s
	iters: 400, epoch: 23 | loss: 0.0114471
	speed: 0.0197s/iter; left time: 711.6416s
Epoch: 23 cost time: 10.156778335571289
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.977129 --> -0.977129).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0093106
	speed: 0.1104s/iter; left time: 3974.2493s
	iters: 200, epoch: 24 | loss: 0.4461325
	speed: 0.0218s/iter; left time: 782.7202s
	iters: 300, epoch: 24 | loss: 0.0007212
	speed: 0.0215s/iter; left time: 769.7845s
	iters: 400, epoch: 24 | loss: 0.0065956
	speed: 0.0205s/iter; left time: 731.4010s
Epoch: 24 cost time: 10.465658903121948
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0026326
	speed: 0.1100s/iter; left time: 3910.6310s
	iters: 200, epoch: 25 | loss: 0.0010148
	speed: 0.0216s/iter; left time: 766.0924s
	iters: 300, epoch: 25 | loss: 0.0035346
	speed: 0.0231s/iter; left time: 817.0814s
	iters: 400, epoch: 25 | loss: 0.0372268
	speed: 0.0228s/iter; left time: 804.2121s
Epoch: 25 cost time: 10.702204465866089
Epoch: 25, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0013621
	speed: 0.1160s/iter; left time: 4068.5843s
	iters: 200, epoch: 26 | loss: 0.0706060
	speed: 0.0223s/iter; left time: 780.8091s
	iters: 300, epoch: 26 | loss: 0.0067040
	speed: 0.0205s/iter; left time: 713.3676s
	iters: 400, epoch: 26 | loss: 0.0049149
	speed: 0.0211s/iter; left time: 735.0370s
Epoch: 26 cost time: 10.614264726638794
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0012538
	speed: 0.1141s/iter; left time: 3949.1417s
	iters: 200, epoch: 27 | loss: 0.0020228
	speed: 0.0212s/iter; left time: 730.6502s
	iters: 300, epoch: 27 | loss: 0.0010453
	speed: 0.0195s/iter; left time: 669.6470s
	iters: 400, epoch: 27 | loss: 0.1619012
	speed: 0.0208s/iter; left time: 712.0258s
Epoch: 27 cost time: 10.068480968475342
Epoch: 27, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0006926
	speed: 0.1050s/iter; left time: 3584.3575s
	iters: 200, epoch: 28 | loss: 0.0009499
	speed: 0.0207s/iter; left time: 704.3357s
	iters: 300, epoch: 28 | loss: 0.0138587
	speed: 0.0208s/iter; left time: 707.3087s
	iters: 400, epoch: 28 | loss: 0.0108499
	speed: 0.0210s/iter; left time: 712.0195s
Epoch: 28 cost time: 10.441999197006226
Epoch: 28, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977986).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0021951
	speed: 0.1018s/iter; left time: 3427.3897s
	iters: 200, epoch: 29 | loss: 0.0002115
	speed: 0.0211s/iter; left time: 708.7905s
	iters: 300, epoch: 29 | loss: 0.0059744
	speed: 0.0211s/iter; left time: 706.5472s
	iters: 400, epoch: 29 | loss: 0.2332692
	speed: 0.0212s/iter; left time: 708.8000s
Epoch: 29 cost time: 10.316285133361816
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.977986 --> -0.979702).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0114330
	speed: 0.1046s/iter; left time: 3473.2754s
	iters: 200, epoch: 30 | loss: 0.1328532
	speed: 0.0211s/iter; left time: 696.7880s
	iters: 300, epoch: 30 | loss: 0.0013005
	speed: 0.0208s/iter; left time: 685.7844s
	iters: 400, epoch: 30 | loss: 0.0102306
	speed: 0.0200s/iter; left time: 659.5118s
Epoch: 30 cost time: 10.149863243103027
Epoch: 30, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0263834
	speed: 0.1071s/iter; left time: 3504.1122s
	iters: 200, epoch: 31 | loss: 0.0005564
	speed: 0.0189s/iter; left time: 616.9406s
	iters: 300, epoch: 31 | loss: 0.0000636
	speed: 0.0194s/iter; left time: 629.9310s
	iters: 400, epoch: 31 | loss: 0.0010218
	speed: 0.0206s/iter; left time: 667.6693s
Epoch: 31 cost time: 9.763806343078613
Epoch: 31, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.980559).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0456240
	speed: 0.1053s/iter; left time: 3398.3901s
	iters: 200, epoch: 32 | loss: 0.0008267
	speed: 0.0196s/iter; left time: 631.3934s
	iters: 300, epoch: 32 | loss: 0.0007627
	speed: 0.0197s/iter; left time: 633.1988s
	iters: 400, epoch: 32 | loss: 0.0012747
	speed: 0.0198s/iter; left time: 631.8408s
Epoch: 32 cost time: 9.773724794387817
Epoch: 32, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0022660
	speed: 0.1006s/iter; left time: 3199.0655s
	iters: 200, epoch: 33 | loss: 0.0011455
	speed: 0.0208s/iter; left time: 658.5580s
	iters: 300, epoch: 33 | loss: 0.0124184
	speed: 0.0215s/iter; left time: 677.8185s
	iters: 400, epoch: 33 | loss: 0.0001014
	speed: 0.0197s/iter; left time: 620.6399s
Epoch: 33 cost time: 10.149317741394043
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0007676
	speed: 0.1020s/iter; left time: 3194.2004s
	iters: 200, epoch: 34 | loss: 0.0046217
	speed: 0.0213s/iter; left time: 666.0694s
	iters: 300, epoch: 34 | loss: 0.0012527
	speed: 0.0221s/iter; left time: 686.9369s
	iters: 400, epoch: 34 | loss: 0.0003552
	speed: 0.0210s/iter; left time: 651.5460s
Epoch: 34 cost time: 10.609968662261963
Epoch: 34, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.981131).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0029703
	speed: 0.1016s/iter; left time: 3136.0143s
	iters: 200, epoch: 35 | loss: 0.0805861
	speed: 0.0212s/iter; left time: 650.8308s
	iters: 300, epoch: 35 | loss: 0.0038320
	speed: 0.0216s/iter; left time: 663.3095s
	iters: 400, epoch: 35 | loss: 0.0001758
	speed: 0.0217s/iter; left time: 662.7113s
Epoch: 35 cost time: 10.390042304992676
Epoch: 35, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.1312907
	speed: 0.1058s/iter; left time: 3214.8086s
	iters: 200, epoch: 36 | loss: 0.0038045
	speed: 0.0213s/iter; left time: 645.2390s
	iters: 300, epoch: 36 | loss: 0.0453527
	speed: 0.0207s/iter; left time: 624.0296s
	iters: 400, epoch: 36 | loss: 0.0007400
	speed: 0.0213s/iter; left time: 640.2270s
Epoch: 36 cost time: 10.269283056259155
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0368322
	speed: 0.1048s/iter; left time: 3136.2448s
	iters: 200, epoch: 37 | loss: 0.0005587
	speed: 0.0203s/iter; left time: 604.0379s
	iters: 300, epoch: 37 | loss: 0.0000827
	speed: 0.0198s/iter; left time: 588.7854s
	iters: 400, epoch: 37 | loss: 0.0763649
	speed: 0.0194s/iter; left time: 575.5580s
Epoch: 37 cost time: 9.673141717910767
Epoch: 37, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 38 | loss: 0.0002001
	speed: 0.1003s/iter; left time: 2952.4694s
	iters: 200, epoch: 38 | loss: 0.1626368
	speed: 0.0207s/iter; left time: 606.4129s
	iters: 300, epoch: 38 | loss: 0.0102080
	speed: 0.0220s/iter; left time: 642.3197s
	iters: 400, epoch: 38 | loss: 0.0005537
	speed: 0.0204s/iter; left time: 595.6774s
Epoch: 38 cost time: 10.363755226135254
Epoch: 38, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 39 | loss: 0.0001284
	speed: 0.1042s/iter; left time: 3018.5922s
	iters: 200, epoch: 39 | loss: 0.0013389
	speed: 0.0209s/iter; left time: 603.9812s
	iters: 300, epoch: 39 | loss: 0.0003212
	speed: 0.0202s/iter; left time: 582.4981s
	iters: 400, epoch: 39 | loss: 0.0002681
	speed: 0.0210s/iter; left time: 600.8524s
Epoch: 39 cost time: 10.277905464172363
Epoch: 39, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 40 | loss: 0.0083746
	speed: 0.1040s/iter; left time: 2966.3962s
	iters: 200, epoch: 40 | loss: 0.0006551
	speed: 0.0214s/iter; left time: 608.0765s
	iters: 300, epoch: 40 | loss: 0.0042826
	speed: 0.0209s/iter; left time: 590.4525s
	iters: 400, epoch: 40 | loss: 0.0022031
	speed: 0.0210s/iter; left time: 593.4702s
Epoch: 40 cost time: 10.196234464645386
Epoch: 40, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.982846).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0129642
	speed: 0.1072s/iter; left time: 3004.6777s
	iters: 200, epoch: 41 | loss: 0.0054286
	speed: 0.0206s/iter; left time: 575.6004s
	iters: 300, epoch: 41 | loss: 0.0118195
	speed: 0.0200s/iter; left time: 556.7784s
	iters: 400, epoch: 41 | loss: 0.0051446
	speed: 0.0203s/iter; left time: 562.7738s
Epoch: 41 cost time: 9.989628314971924
Epoch: 41, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0002445
	speed: 0.1050s/iter; left time: 2894.8231s
	iters: 200, epoch: 42 | loss: 0.0034305
	speed: 0.0208s/iter; left time: 570.6052s
	iters: 300, epoch: 42 | loss: 0.0073134
	speed: 0.0203s/iter; left time: 556.7583s
	iters: 400, epoch: 42 | loss: 0.0007244
	speed: 0.0203s/iter; left time: 554.8404s
Epoch: 42 cost time: 9.948028564453125
Epoch: 42, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0001816
	speed: 0.1011s/iter; left time: 2740.9664s
	iters: 200, epoch: 43 | loss: 0.0003529
	speed: 0.0213s/iter; left time: 573.9596s
	iters: 300, epoch: 43 | loss: 0.0006204
	speed: 0.0191s/iter; left time: 514.9684s
	iters: 400, epoch: 43 | loss: 0.1232194
	speed: 0.0199s/iter; left time: 533.0850s
Epoch: 43 cost time: 9.844334125518799
Epoch: 43, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0043985
	speed: 0.0933s/iter; left time: 2486.0678s
	iters: 200, epoch: 44 | loss: 0.0244650
	speed: 0.0181s/iter; left time: 480.5643s
	iters: 300, epoch: 44 | loss: 0.0046976
	speed: 0.0195s/iter; left time: 514.4749s
	iters: 400, epoch: 44 | loss: 0.0834527
	speed: 0.0231s/iter; left time: 607.7370s
Epoch: 44 cost time: 10.197086334228516
Epoch: 44, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0476279
	speed: 0.1032s/iter; left time: 2699.9083s
	iters: 200, epoch: 45 | loss: 0.1142710
	speed: 0.0213s/iter; left time: 555.1706s
	iters: 300, epoch: 45 | loss: 0.0004015
	speed: 0.0213s/iter; left time: 553.2164s
	iters: 400, epoch: 45 | loss: 0.2218674
	speed: 0.0208s/iter; left time: 537.4929s
Epoch: 45 cost time: 10.28788161277771
Epoch: 45, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0088053
	speed: 0.1039s/iter; left time: 2671.0107s
	iters: 200, epoch: 46 | loss: 0.0007018
	speed: 0.0228s/iter; left time: 584.5725s
	iters: 300, epoch: 46 | loss: 0.0906354
	speed: 0.0221s/iter; left time: 562.2591s
	iters: 400, epoch: 46 | loss: 0.0001067
	speed: 0.0213s/iter; left time: 541.3978s
Epoch: 46 cost time: 10.815276622772217
Epoch: 46, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0494061
	speed: 0.1110s/iter; left time: 2799.8085s
	iters: 200, epoch: 47 | loss: 0.0007375
	speed: 0.0220s/iter; left time: 553.6355s
	iters: 300, epoch: 47 | loss: 0.0001827
	speed: 0.0217s/iter; left time: 543.5904s
	iters: 400, epoch: 47 | loss: 0.0031044
	speed: 0.0207s/iter; left time: 514.8081s
Epoch: 47 cost time: 10.492199897766113
Epoch: 47, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0015651
	speed: 0.1035s/iter; left time: 2562.6662s
	iters: 200, epoch: 48 | loss: 0.0000238
	speed: 0.0209s/iter; left time: 514.2095s
	iters: 300, epoch: 48 | loss: 0.0001233
	speed: 0.0198s/iter; left time: 485.3083s
	iters: 400, epoch: 48 | loss: 0.0092840
	speed: 0.0204s/iter; left time: 499.2385s
Epoch: 48 cost time: 10.276698112487793
Epoch: 48, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0003346
	speed: 0.1060s/iter; left time: 2574.1401s
	iters: 200, epoch: 49 | loss: 0.0013905
	speed: 0.0207s/iter; left time: 501.6932s
	iters: 300, epoch: 49 | loss: 0.0023861
	speed: 0.0206s/iter; left time: 495.4988s
	iters: 400, epoch: 49 | loss: 0.0005896
	speed: 0.0192s/iter; left time: 460.9030s
Epoch: 49 cost time: 10.200680017471313
Epoch: 49, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 50 | loss: 0.0064804
	speed: 0.1020s/iter; left time: 2430.5365s
	iters: 200, epoch: 50 | loss: 0.0356755
	speed: 0.0216s/iter; left time: 511.3227s
	iters: 300, epoch: 50 | loss: 0.0143174
	speed: 0.0217s/iter; left time: 511.8619s
	iters: 400, epoch: 50 | loss: 0.0001442
	speed: 0.0207s/iter; left time: 488.0242s
Epoch: 50 cost time: 10.463954210281372
Epoch: 50, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9828473413379074
model parameter : 47522
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.0942168
	speed: 0.0384s/iter; left time: 1794.9331s
	iters: 200, epoch: 1 | loss: 0.4779005
	speed: 0.0215s/iter; left time: 1005.0661s
	iters: 300, epoch: 1 | loss: 0.5076326
	speed: 0.0192s/iter; left time: 893.8912s
	iters: 400, epoch: 1 | loss: 0.3011172
	speed: 0.0222s/iter; left time: 1032.1717s
Epoch: 1 cost time: 11.791702032089233
Epoch: 1, Steps: 469 | Train Loss: 0.823 Vali Loss: 0.392 Vali Acc: 0.882 Test Loss: 0.392 Test Acc: 0.882
Validation loss decreased (inf --> -0.881929).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1906389
	speed: 0.1077s/iter; left time: 4988.0332s
	iters: 200, epoch: 2 | loss: 0.2223363
	speed: 0.0229s/iter; left time: 1057.0878s
	iters: 300, epoch: 2 | loss: 0.1589858
	speed: 0.0217s/iter; left time: 1001.9527s
	iters: 400, epoch: 2 | loss: 0.0320341
	speed: 0.0230s/iter; left time: 1060.4741s
Epoch: 2 cost time: 10.938234090805054
Epoch: 2, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.881929 --> -0.933388).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1843563
	speed: 0.1049s/iter; left time: 4811.8621s
	iters: 200, epoch: 3 | loss: 0.1641537
	speed: 0.0213s/iter; left time: 976.0617s
	iters: 300, epoch: 3 | loss: 0.0543251
	speed: 0.0226s/iter; left time: 1032.4515s
	iters: 400, epoch: 3 | loss: 0.2250738
	speed: 0.0241s/iter; left time: 1099.0455s
Epoch: 3 cost time: 10.695338726043701
Epoch: 3, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.933388 --> -0.945967).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0406652
	speed: 0.1029s/iter; left time: 4669.8819s
	iters: 200, epoch: 4 | loss: 0.0573376
	speed: 0.0224s/iter; left time: 1015.5885s
	iters: 300, epoch: 4 | loss: 0.3428716
	speed: 0.0218s/iter; left time: 985.9352s
	iters: 400, epoch: 4 | loss: 0.1548068
	speed: 0.0218s/iter; left time: 983.7901s
Epoch: 4 cost time: 10.556151390075684
Epoch: 4, Steps: 469 | Train Loss: 0.100 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
Validation loss decreased (-0.945967 --> -0.953400).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0141322
	speed: 0.1061s/iter; left time: 4768.5187s
	iters: 200, epoch: 5 | loss: 0.0717965
	speed: 0.0206s/iter; left time: 922.2504s
	iters: 300, epoch: 5 | loss: 0.0288802
	speed: 0.0192s/iter; left time: 859.9314s
	iters: 400, epoch: 5 | loss: 0.0631608
	speed: 0.0201s/iter; left time: 896.4860s
Epoch: 5 cost time: 9.782469272613525
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (-0.953400 --> -0.954544).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0918391
	speed: 0.1037s/iter; left time: 4608.8517s
	iters: 200, epoch: 6 | loss: 0.0899857
	speed: 0.0210s/iter; left time: 930.6353s
	iters: 300, epoch: 6 | loss: 0.0551652
	speed: 0.0199s/iter; left time: 881.5906s
	iters: 400, epoch: 6 | loss: 0.0025105
	speed: 0.0194s/iter; left time: 858.6946s
Epoch: 6 cost time: 9.930940866470337
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.954544 --> -0.964550).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0934019
	speed: 0.1033s/iter; left time: 4545.6769s
	iters: 200, epoch: 7 | loss: 0.2765310
	speed: 0.0219s/iter; left time: 960.9145s
	iters: 300, epoch: 7 | loss: 0.0094726
	speed: 0.0223s/iter; left time: 978.0928s
	iters: 400, epoch: 7 | loss: 0.0335997
	speed: 0.0215s/iter; left time: 941.3071s
Epoch: 7 cost time: 10.756473541259766
Epoch: 7, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0875604
	speed: 0.1019s/iter; left time: 4435.7110s
	iters: 200, epoch: 8 | loss: 0.1630046
	speed: 0.0212s/iter; left time: 920.2301s
	iters: 300, epoch: 8 | loss: 0.1233197
	speed: 0.0196s/iter; left time: 850.1721s
	iters: 400, epoch: 8 | loss: 0.0035058
	speed: 0.0191s/iter; left time: 823.6836s
Epoch: 8 cost time: 9.927268981933594
Epoch: 8, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964550 --> -0.968266).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0033655
	speed: 0.1095s/iter; left time: 4714.8518s
	iters: 200, epoch: 9 | loss: 0.0156449
	speed: 0.0231s/iter; left time: 994.2513s
	iters: 300, epoch: 9 | loss: 0.0477087
	speed: 0.0229s/iter; left time: 982.1509s
	iters: 400, epoch: 9 | loss: 0.0108890
	speed: 0.0211s/iter; left time: 903.1494s
Epoch: 9 cost time: 10.868671894073486
Epoch: 9, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.968266 --> -0.975128).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0772408
	speed: 0.1096s/iter; left time: 4668.3708s
	iters: 200, epoch: 10 | loss: 0.0147507
	speed: 0.0225s/iter; left time: 953.8589s
	iters: 300, epoch: 10 | loss: 0.0587631
	speed: 0.0222s/iter; left time: 938.9953s
	iters: 400, epoch: 10 | loss: 0.0422612
	speed: 0.0216s/iter; left time: 912.7602s
Epoch: 10 cost time: 10.801318407058716
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2799808
	speed: 0.1151s/iter; left time: 4844.8821s
	iters: 200, epoch: 11 | loss: 0.0899534
	speed: 0.0221s/iter; left time: 928.5292s
	iters: 300, epoch: 11 | loss: 0.0054347
	speed: 0.0227s/iter; left time: 952.3674s
	iters: 400, epoch: 11 | loss: 0.0709073
	speed: 0.0219s/iter; left time: 913.7721s
Epoch: 11 cost time: 10.72655725479126
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0339452
	speed: 0.1071s/iter; left time: 4459.9715s
	iters: 200, epoch: 12 | loss: 0.0011802
	speed: 0.0216s/iter; left time: 895.7689s
	iters: 300, epoch: 12 | loss: 0.0440718
	speed: 0.0216s/iter; left time: 896.7750s
	iters: 400, epoch: 12 | loss: 0.1445453
	speed: 0.0202s/iter; left time: 836.9426s
Epoch: 12 cost time: 10.18872880935669
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0006703
	speed: 0.1078s/iter; left time: 4436.5153s
	iters: 200, epoch: 13 | loss: 0.0685602
	speed: 0.0212s/iter; left time: 869.0412s
	iters: 300, epoch: 13 | loss: 0.8814533
	speed: 0.0240s/iter; left time: 981.4184s
	iters: 400, epoch: 13 | loss: 0.0208844
	speed: 0.0223s/iter; left time: 911.0180s
Epoch: 13 cost time: 10.847761392593384
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0311464
	speed: 0.1082s/iter; left time: 4403.0205s
	iters: 200, epoch: 14 | loss: 0.0123912
	speed: 0.0210s/iter; left time: 854.5583s
	iters: 300, epoch: 14 | loss: 0.1759529
	speed: 0.0212s/iter; left time: 856.8463s
	iters: 400, epoch: 14 | loss: 0.0009307
	speed: 0.0206s/iter; left time: 834.3411s
Epoch: 14 cost time: 10.180293560028076
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0055610
	speed: 0.1083s/iter; left time: 4359.1426s
	iters: 200, epoch: 15 | loss: 0.0103896
	speed: 0.0218s/iter; left time: 873.3037s
	iters: 300, epoch: 15 | loss: 0.0007101
	speed: 0.0216s/iter; left time: 865.6543s
	iters: 400, epoch: 15 | loss: 0.0261503
	speed: 0.0218s/iter; left time: 871.1349s
Epoch: 15 cost time: 10.51556921005249
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
Validation loss decreased (-0.975128 --> -0.975414).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0047829
	speed: 0.1072s/iter; left time: 4261.3128s
	iters: 200, epoch: 16 | loss: 0.0099240
	speed: 0.0216s/iter; left time: 855.3561s
	iters: 300, epoch: 16 | loss: 0.0154629
	speed: 0.0213s/iter; left time: 842.0872s
	iters: 400, epoch: 16 | loss: 0.0084749
	speed: 0.0219s/iter; left time: 864.3403s
Epoch: 16 cost time: 10.466261625289917
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.975414 --> -0.978272).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0029803
	speed: 0.1114s/iter; left time: 4379.6275s
	iters: 200, epoch: 17 | loss: 0.0264488
	speed: 0.0216s/iter; left time: 846.8800s
	iters: 300, epoch: 17 | loss: 0.1221367
	speed: 0.0226s/iter; left time: 883.4154s
	iters: 400, epoch: 17 | loss: 0.0022259
	speed: 0.0233s/iter; left time: 909.1731s
Epoch: 17 cost time: 10.567587614059448
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0060215
	speed: 0.1076s/iter; left time: 4177.9049s
	iters: 200, epoch: 18 | loss: 0.0025838
	speed: 0.0211s/iter; left time: 818.4601s
	iters: 300, epoch: 18 | loss: 0.0008056
	speed: 0.0218s/iter; left time: 841.2179s
	iters: 400, epoch: 18 | loss: 0.0195426
	speed: 0.0228s/iter; left time: 879.9399s
Epoch: 18 cost time: 10.588513612747192
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0197023
	speed: 0.1058s/iter; left time: 4059.3956s
	iters: 200, epoch: 19 | loss: 0.0072901
	speed: 0.0209s/iter; left time: 798.0359s
	iters: 300, epoch: 19 | loss: 0.3159417
	speed: 0.0211s/iter; left time: 806.8310s
	iters: 400, epoch: 19 | loss: 0.0060127
	speed: 0.0217s/iter; left time: 826.3307s
Epoch: 19 cost time: 10.211159467697144
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0067730
	speed: 0.1062s/iter; left time: 4025.7878s
	iters: 200, epoch: 20 | loss: 0.0010392
	speed: 0.0225s/iter; left time: 848.7333s
	iters: 300, epoch: 20 | loss: 0.0034187
	speed: 0.0221s/iter; left time: 832.2845s
	iters: 400, epoch: 20 | loss: 0.0033125
	speed: 0.0219s/iter; left time: 825.0921s
Epoch: 20 cost time: 10.581090688705444
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.978272 --> -0.980559).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0085359
	speed: 0.1158s/iter; left time: 4332.2795s
	iters: 200, epoch: 21 | loss: 0.0039118
	speed: 0.0223s/iter; left time: 831.2442s
	iters: 300, epoch: 21 | loss: 0.0826197
	speed: 0.0226s/iter; left time: 841.7704s
	iters: 400, epoch: 21 | loss: 0.0188662
	speed: 0.0220s/iter; left time: 817.6333s
Epoch: 21 cost time: 10.73776912689209
Epoch: 21, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
Validation loss decreased (-0.980559 --> -0.981989).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0053443
	speed: 0.1183s/iter; left time: 4371.6086s
	iters: 200, epoch: 22 | loss: 0.0013566
	speed: 0.0212s/iter; left time: 782.9709s
	iters: 300, epoch: 22 | loss: 0.0132870
	speed: 0.0219s/iter; left time: 805.5284s
	iters: 400, epoch: 22 | loss: 0.0010466
	speed: 0.0222s/iter; left time: 812.0903s
Epoch: 22 cost time: 10.653406858444214
Epoch: 22, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0094406
	speed: 0.1078s/iter; left time: 3934.5718s
	iters: 200, epoch: 23 | loss: 0.0335737
	speed: 0.0209s/iter; left time: 761.2295s
	iters: 300, epoch: 23 | loss: 0.0008219
	speed: 0.0202s/iter; left time: 733.5957s
	iters: 400, epoch: 23 | loss: 0.0042040
	speed: 0.0210s/iter; left time: 759.7033s
Epoch: 23 cost time: 10.233940839767456
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0377217
	speed: 0.1041s/iter; left time: 3750.3695s
	iters: 200, epoch: 24 | loss: 0.0022075
	speed: 0.0205s/iter; left time: 736.6056s
	iters: 300, epoch: 24 | loss: 0.0004048
	speed: 0.0211s/iter; left time: 755.7860s
	iters: 400, epoch: 24 | loss: 0.0007816
	speed: 0.0210s/iter; left time: 750.4167s
Epoch: 24 cost time: 10.264764070510864
Epoch: 24, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.2778888
	speed: 0.1101s/iter; left time: 3912.5135s
	iters: 200, epoch: 25 | loss: 0.0016815
	speed: 0.0210s/iter; left time: 743.0804s
	iters: 300, epoch: 25 | loss: 0.0413163
	speed: 0.0221s/iter; left time: 782.8453s
	iters: 400, epoch: 25 | loss: 0.0006482
	speed: 0.0216s/iter; left time: 762.1202s
Epoch: 25 cost time: 10.554578065872192
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0289504
	speed: 0.1176s/iter; left time: 4125.5462s
	iters: 200, epoch: 26 | loss: 0.0006732
	speed: 0.0207s/iter; left time: 723.3124s
	iters: 300, epoch: 26 | loss: 0.0020590
	speed: 0.0206s/iter; left time: 717.4603s
	iters: 400, epoch: 26 | loss: 0.0008428
	speed: 0.0218s/iter; left time: 758.9962s
Epoch: 26 cost time: 10.451582908630371
Epoch: 26, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0196990
	speed: 0.1150s/iter; left time: 3979.6520s
	iters: 200, epoch: 27 | loss: 0.0001820
	speed: 0.0200s/iter; left time: 689.1105s
	iters: 300, epoch: 27 | loss: 0.0089298
	speed: 0.0189s/iter; left time: 649.5861s
	iters: 400, epoch: 27 | loss: 0.2074553
	speed: 0.0191s/iter; left time: 655.1452s
Epoch: 27 cost time: 9.823466300964355
Epoch: 27, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0046406
	speed: 0.1060s/iter; left time: 3616.9945s
	iters: 200, epoch: 28 | loss: 0.0002511
	speed: 0.0205s/iter; left time: 699.2749s
	iters: 300, epoch: 28 | loss: 0.0282165
	speed: 0.0200s/iter; left time: 677.9624s
	iters: 400, epoch: 28 | loss: 0.0085322
	speed: 0.0193s/iter; left time: 652.7888s
Epoch: 28 cost time: 9.73682451248169
Epoch: 28, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0898304
	speed: 0.0957s/iter; left time: 3223.0251s
	iters: 200, epoch: 29 | loss: 0.0006713
	speed: 0.0189s/iter; left time: 635.8892s
	iters: 300, epoch: 29 | loss: 0.0005400
	speed: 0.0199s/iter; left time: 665.8344s
	iters: 400, epoch: 29 | loss: 0.0047719
	speed: 0.0207s/iter; left time: 692.0734s
Epoch: 29 cost time: 9.704139947891235
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0103411
	speed: 0.1038s/iter; left time: 3445.6435s
	iters: 200, epoch: 30 | loss: 0.0552851
	speed: 0.0195s/iter; left time: 645.5022s
	iters: 300, epoch: 30 | loss: 0.0041058
	speed: 0.0201s/iter; left time: 664.2860s
	iters: 400, epoch: 30 | loss: 0.0029775
	speed: 0.0201s/iter; left time: 662.2301s
Epoch: 30 cost time: 9.716850996017456
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.981989 --> -0.983132).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0096215
	speed: 0.1133s/iter; left time: 3709.6244s
	iters: 200, epoch: 31 | loss: 0.0000323
	speed: 0.0206s/iter; left time: 670.8270s
	iters: 300, epoch: 31 | loss: 0.0002842
	speed: 0.0204s/iter; left time: 664.0745s
	iters: 400, epoch: 31 | loss: 0.0025769
	speed: 0.0207s/iter; left time: 671.7064s
Epoch: 31 cost time: 10.023386240005493
Epoch: 31, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0013102
	speed: 0.1136s/iter; left time: 3663.6825s
	iters: 200, epoch: 32 | loss: 0.0025460
	speed: 0.0209s/iter; left time: 671.2507s
	iters: 300, epoch: 32 | loss: 0.0164556
	speed: 0.0209s/iter; left time: 669.3304s
	iters: 400, epoch: 32 | loss: 0.0242207
	speed: 0.0221s/iter; left time: 705.9109s
Epoch: 32 cost time: 10.510103702545166
Epoch: 32, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0004908
	speed: 0.1111s/iter; left time: 3530.8098s
	iters: 200, epoch: 33 | loss: 0.0000834
	speed: 0.0209s/iter; left time: 661.2338s
	iters: 300, epoch: 33 | loss: 0.0045483
	speed: 0.0204s/iter; left time: 644.1484s
	iters: 400, epoch: 33 | loss: 0.0019620
	speed: 0.0212s/iter; left time: 668.5291s
Epoch: 33 cost time: 10.209119081497192
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0015465
	speed: 0.1080s/iter; left time: 3382.1107s
	iters: 200, epoch: 34 | loss: 0.0014023
	speed: 0.0210s/iter; left time: 657.0995s
	iters: 300, epoch: 34 | loss: 0.0082319
	speed: 0.0222s/iter; left time: 690.6915s
	iters: 400, epoch: 34 | loss: 0.0003527
	speed: 0.0211s/iter; left time: 654.3669s
Epoch: 34 cost time: 10.539159297943115
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0136086
	speed: 0.1078s/iter; left time: 3325.8457s
	iters: 200, epoch: 35 | loss: 0.0021083
	speed: 0.0205s/iter; left time: 629.6007s
	iters: 300, epoch: 35 | loss: 0.0461068
	speed: 0.0199s/iter; left time: 610.7810s
	iters: 400, epoch: 35 | loss: 0.0606820
	speed: 0.0208s/iter; left time: 636.9718s
Epoch: 35 cost time: 10.054079532623291
Epoch: 35, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.8145227
	speed: 0.1113s/iter; left time: 3380.6963s
	iters: 200, epoch: 36 | loss: 0.0008515
	speed: 0.0212s/iter; left time: 641.4129s
	iters: 300, epoch: 36 | loss: 0.0052665
	speed: 0.0210s/iter; left time: 634.8611s
	iters: 400, epoch: 36 | loss: 0.2027096
	speed: 0.0210s/iter; left time: 630.6216s
Epoch: 36 cost time: 10.2513747215271
Epoch: 36, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.2048554
	speed: 0.1113s/iter; left time: 3329.0163s
	iters: 200, epoch: 37 | loss: 0.0029728
	speed: 0.0201s/iter; left time: 598.0727s
	iters: 300, epoch: 37 | loss: 0.0007032
	speed: 0.0209s/iter; left time: 620.4805s
	iters: 400, epoch: 37 | loss: 0.0894622
	speed: 0.0199s/iter; left time: 590.8379s
Epoch: 37 cost time: 10.049456357955933
Epoch: 37, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983132 --> -0.983132).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0114048
	speed: 0.1103s/iter; left time: 3249.4358s
	iters: 200, epoch: 38 | loss: 0.0216936
	speed: 0.0190s/iter; left time: 556.1713s
	iters: 300, epoch: 38 | loss: 0.0004557
	speed: 0.0204s/iter; left time: 597.1496s
	iters: 400, epoch: 38 | loss: 0.0007511
	speed: 0.0197s/iter; left time: 574.2930s
Epoch: 38 cost time: 9.762876749038696
Epoch: 38, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0000947
	speed: 0.1037s/iter; left time: 3005.5528s
	iters: 200, epoch: 39 | loss: 0.0171121
	speed: 0.0211s/iter; left time: 609.1517s
	iters: 300, epoch: 39 | loss: 0.0000633
	speed: 0.0211s/iter; left time: 607.9523s
	iters: 400, epoch: 39 | loss: 0.0001592
	speed: 0.0207s/iter; left time: 592.3300s
Epoch: 39 cost time: 10.185435771942139
Epoch: 39, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0554520
	speed: 0.1066s/iter; left time: 3037.8227s
	iters: 200, epoch: 40 | loss: 0.0002071
	speed: 0.0234s/iter; left time: 665.7113s
	iters: 300, epoch: 40 | loss: 0.0059634
	speed: 0.0211s/iter; left time: 597.9515s
	iters: 400, epoch: 40 | loss: 0.0116112
	speed: 0.0220s/iter; left time: 621.6659s
Epoch: 40 cost time: 10.890369415283203
Epoch: 40, Steps: 469 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 41 | loss: 0.0020899
	speed: 0.1060s/iter; left time: 2971.9406s
	iters: 200, epoch: 41 | loss: 0.0003345
	speed: 0.0201s/iter; left time: 560.6552s
	iters: 300, epoch: 41 | loss: 0.0005040
	speed: 0.0197s/iter; left time: 549.0486s
	iters: 400, epoch: 41 | loss: 0.0014377
	speed: 0.0221s/iter; left time: 613.8214s
Epoch: 41 cost time: 10.126430034637451
Epoch: 41, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 42 | loss: 0.0248767
	speed: 0.1158s/iter; left time: 3193.4251s
	iters: 200, epoch: 42 | loss: 0.0005042
	speed: 0.0216s/iter; left time: 593.7062s
	iters: 300, epoch: 42 | loss: 0.0000934
	speed: 0.0200s/iter; left time: 547.3261s
	iters: 400, epoch: 42 | loss: 0.0007131
	speed: 0.0211s/iter; left time: 576.6826s
Epoch: 42 cost time: 10.251407623291016
Epoch: 42, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
Validation loss decreased (-0.983132 --> -0.983704).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0009749
	speed: 0.1142s/iter; left time: 3094.6665s
	iters: 200, epoch: 43 | loss: 0.0135862
	speed: 0.0210s/iter; left time: 568.3473s
	iters: 300, epoch: 43 | loss: 0.0037060
	speed: 0.0200s/iter; left time: 539.0276s
	iters: 400, epoch: 43 | loss: 0.0002744
	speed: 0.0196s/iter; left time: 526.4269s
Epoch: 43 cost time: 9.943036079406738
Epoch: 43, Steps: 469 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 44 | loss: 0.0116827
	speed: 0.1079s/iter; left time: 2874.1945s
	iters: 200, epoch: 44 | loss: 0.0035068
	speed: 0.0208s/iter; left time: 553.0844s
	iters: 300, epoch: 44 | loss: 0.0035850
	speed: 0.0214s/iter; left time: 565.2802s
	iters: 400, epoch: 44 | loss: 0.0016566
	speed: 0.0203s/iter; left time: 533.4403s
Epoch: 44 cost time: 10.136625051498413
Epoch: 44, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 45 | loss: 0.0067685
	speed: 0.1072s/iter; left time: 2803.7089s
	iters: 200, epoch: 45 | loss: 0.0005541
	speed: 0.0203s/iter; left time: 528.1977s
	iters: 300, epoch: 45 | loss: 0.0309173
	speed: 0.0203s/iter; left time: 526.5059s
	iters: 400, epoch: 45 | loss: 0.0002338
	speed: 0.0193s/iter; left time: 498.2289s
Epoch: 45 cost time: 9.85186767578125
Epoch: 45, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 46 | loss: 0.0024086
	speed: 0.1057s/iter; left time: 2716.6037s
	iters: 200, epoch: 46 | loss: 0.0017256
	speed: 0.0209s/iter; left time: 534.7555s
	iters: 300, epoch: 46 | loss: 0.0003476
	speed: 0.0205s/iter; left time: 523.4303s
	iters: 400, epoch: 46 | loss: 0.0003635
	speed: 0.0197s/iter; left time: 500.8397s
Epoch: 46 cost time: 10.179739952087402
Epoch: 46, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 47 | loss: 0.0007510
	speed: 0.1132s/iter; left time: 2856.5094s
	iters: 200, epoch: 47 | loss: 0.0092149
	speed: 0.0208s/iter; left time: 522.5311s
	iters: 300, epoch: 47 | loss: 0.0038655
	speed: 0.0209s/iter; left time: 523.0783s
	iters: 400, epoch: 47 | loss: 0.0059582
	speed: 0.0221s/iter; left time: 551.7192s
Epoch: 47 cost time: 10.452200889587402
Epoch: 47, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 48 | loss: 0.0003877
	speed: 0.1147s/iter; left time: 2838.7705s
	iters: 200, epoch: 48 | loss: 0.0540171
	speed: 0.0221s/iter; left time: 544.0984s
	iters: 300, epoch: 48 | loss: 0.0085454
	speed: 0.0221s/iter; left time: 542.5569s
	iters: 400, epoch: 48 | loss: 0.0001235
	speed: 0.0215s/iter; left time: 524.9253s
Epoch: 48 cost time: 10.632126808166504
Epoch: 48, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 49 | loss: 0.0002802
	speed: 0.1135s/iter; left time: 2755.7005s
	iters: 200, epoch: 49 | loss: 0.0006011
	speed: 0.0220s/iter; left time: 531.1738s
	iters: 300, epoch: 49 | loss: 0.0030777
	speed: 0.0219s/iter; left time: 526.8447s
	iters: 400, epoch: 49 | loss: 0.0004318
	speed: 0.0223s/iter; left time: 535.4377s
Epoch: 49 cost time: 10.75431227684021
Epoch: 49, Steps: 469 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 50 | loss: 0.0000347
	speed: 0.1068s/iter; left time: 2543.1516s
	iters: 200, epoch: 50 | loss: 0.0000674
	speed: 0.0212s/iter; left time: 501.9259s
	iters: 300, epoch: 50 | loss: 0.0018331
	speed: 0.0213s/iter; left time: 502.4606s
	iters: 400, epoch: 50 | loss: 0.0590631
	speed: 0.0213s/iter; left time: 501.9388s
Epoch: 50 cost time: 10.337956666946411
Epoch: 50, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 51 | loss: 0.0975899
	speed: 0.1108s/iter; left time: 2586.7852s
	iters: 200, epoch: 51 | loss: 0.0561366
	speed: 0.0215s/iter; left time: 499.9594s
	iters: 300, epoch: 51 | loss: 0.0469465
	speed: 0.0208s/iter; left time: 481.5057s
	iters: 400, epoch: 51 | loss: 0.2284050
	speed: 0.0196s/iter; left time: 451.8908s
Epoch: 51 cost time: 10.191684246063232
Epoch: 51, Steps: 469 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 52 | loss: 0.0002249
	speed: 0.1063s/iter; left time: 2432.0763s
	iters: 200, epoch: 52 | loss: 0.0002457
	speed: 0.0191s/iter; left time: 436.0058s
	iters: 300, epoch: 52 | loss: 0.1143461
	speed: 0.0199s/iter; left time: 451.9953s
	iters: 400, epoch: 52 | loss: 0.0001617
	speed: 0.0200s/iter; left time: 451.0005s
Epoch: 52 cost time: 9.78934121131897
Epoch: 52, Steps: 469 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.983704974271012
model parameter : 31138
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.1702939
	speed: 0.0428s/iter; left time: 2003.9651s
	iters: 200, epoch: 1 | loss: 0.5121770
	speed: 0.0248s/iter; left time: 1159.8176s
	iters: 300, epoch: 1 | loss: 0.5193234
	speed: 0.0231s/iter; left time: 1077.0966s
	iters: 400, epoch: 1 | loss: 0.2910229
	speed: 0.0222s/iter; left time: 1031.2717s
Epoch: 1 cost time: 12.851216554641724
Epoch: 1, Steps: 469 | Train Loss: 0.848 Vali Loss: 0.388 Vali Acc: 0.885 Test Loss: 0.388 Test Acc: 0.885
Validation loss decreased (inf --> -0.885359).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1843984
	speed: 0.1202s/iter; left time: 5570.6869s
	iters: 200, epoch: 2 | loss: 0.1584225
	speed: 0.0222s/iter; left time: 1024.7657s
	iters: 300, epoch: 2 | loss: 0.1988100
	speed: 0.0219s/iter; left time: 1012.5648s
	iters: 400, epoch: 2 | loss: 0.0271052
	speed: 0.0224s/iter; left time: 1031.8087s
Epoch: 2 cost time: 10.815470933914185
Epoch: 2, Steps: 469 | Train Loss: 0.220 Vali Loss: 0.261 Vali Acc: 0.932 Test Loss: 0.261 Test Acc: 0.932
Validation loss decreased (-0.885359 --> -0.931673).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1478054
	speed: 0.1155s/iter; left time: 5299.3385s
	iters: 200, epoch: 3 | loss: 0.1508985
	speed: 0.0224s/iter; left time: 1024.7294s
	iters: 300, epoch: 3 | loss: 0.0620095
	speed: 0.0212s/iter; left time: 970.2837s
	iters: 400, epoch: 3 | loss: 0.1677650
	speed: 0.0212s/iter; left time: 965.5835s
Epoch: 3 cost time: 10.643442630767822
Epoch: 3, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.212 Vali Acc: 0.945 Test Loss: 0.212 Test Acc: 0.945
Validation loss decreased (-0.931673 --> -0.945395).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0468780
	speed: 0.1142s/iter; left time: 5186.1082s
	iters: 200, epoch: 4 | loss: 0.0306309
	speed: 0.0214s/iter; left time: 968.0174s
	iters: 300, epoch: 4 | loss: 0.3589763
	speed: 0.0201s/iter; left time: 910.6568s
	iters: 400, epoch: 4 | loss: 0.0855830
	speed: 0.0212s/iter; left time: 957.2106s
Epoch: 4 cost time: 10.208176851272583
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.945395 --> -0.956545).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0131552
	speed: 0.1156s/iter; left time: 5193.6577s
	iters: 200, epoch: 5 | loss: 0.0770805
	speed: 0.0213s/iter; left time: 953.6109s
	iters: 300, epoch: 5 | loss: 0.0206310
	speed: 0.0218s/iter; left time: 974.6659s
	iters: 400, epoch: 5 | loss: 0.0534303
	speed: 0.0218s/iter; left time: 972.1370s
Epoch: 5 cost time: 10.57853651046753
Epoch: 5, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.956545 --> -0.962548).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0391720
	speed: 0.1148s/iter; left time: 5101.8221s
	iters: 200, epoch: 6 | loss: 0.0143487
	speed: 0.0212s/iter; left time: 939.7066s
	iters: 300, epoch: 6 | loss: 0.0405212
	speed: 0.0207s/iter; left time: 915.2223s
	iters: 400, epoch: 6 | loss: 0.0028918
	speed: 0.0218s/iter; left time: 962.2224s
Epoch: 6 cost time: 10.473474979400635
Epoch: 6, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.962548 --> -0.963978).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2069019
	speed: 0.1183s/iter; left time: 5203.6604s
	iters: 200, epoch: 7 | loss: 0.2920655
	speed: 0.0208s/iter; left time: 910.8791s
	iters: 300, epoch: 7 | loss: 0.0078229
	speed: 0.0208s/iter; left time: 909.5168s
	iters: 400, epoch: 7 | loss: 0.0389468
	speed: 0.0198s/iter; left time: 863.7202s
Epoch: 7 cost time: 10.029202938079834
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0513724
	speed: 0.1091s/iter; left time: 4746.8883s
	iters: 200, epoch: 8 | loss: 0.1783915
	speed: 0.0199s/iter; left time: 863.0510s
	iters: 300, epoch: 8 | loss: 0.0736891
	speed: 0.0205s/iter; left time: 888.9362s
	iters: 400, epoch: 8 | loss: 0.0040346
	speed: 0.0200s/iter; left time: 863.9660s
Epoch: 8 cost time: 9.86588454246521
Epoch: 8, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0047337
	speed: 0.1092s/iter; left time: 4698.9973s
	iters: 200, epoch: 9 | loss: 0.0160893
	speed: 0.0210s/iter; left time: 903.8515s
	iters: 300, epoch: 9 | loss: 0.0284913
	speed: 0.0221s/iter; left time: 948.9125s
	iters: 400, epoch: 9 | loss: 0.0158848
	speed: 0.0219s/iter; left time: 934.4308s
Epoch: 9 cost time: 10.709320306777954
Epoch: 9, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.963978 --> -0.972269).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1360839
	speed: 0.1159s/iter; left time: 4936.5548s
	iters: 200, epoch: 10 | loss: 0.0071746
	speed: 0.0232s/iter; left time: 984.0294s
	iters: 300, epoch: 10 | loss: 0.0205265
	speed: 0.0223s/iter; left time: 944.0249s
	iters: 400, epoch: 10 | loss: 0.0413178
	speed: 0.0225s/iter; left time: 950.2084s
Epoch: 10 cost time: 11.157039880752563
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.1802938
	speed: 0.1223s/iter; left time: 5151.8274s
	iters: 200, epoch: 11 | loss: 0.0270732
	speed: 0.0213s/iter; left time: 896.0660s
	iters: 300, epoch: 11 | loss: 0.0048309
	speed: 0.0230s/iter; left time: 962.9548s
	iters: 400, epoch: 11 | loss: 0.0125586
	speed: 0.0216s/iter; left time: 903.2879s
Epoch: 11 cost time: 10.873786449432373
Epoch: 11, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0109696
	speed: 0.1168s/iter; left time: 4865.1340s
	iters: 200, epoch: 12 | loss: 0.0012294
	speed: 0.0178s/iter; left time: 740.2181s
	iters: 300, epoch: 12 | loss: 0.0048462
	speed: 0.0194s/iter; left time: 805.6118s
	iters: 400, epoch: 12 | loss: 0.0953103
	speed: 0.0232s/iter; left time: 959.6035s
Epoch: 12 cost time: 10.346149921417236
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0013485
	speed: 0.1203s/iter; left time: 4953.5874s
	iters: 200, epoch: 13 | loss: 0.0385829
	speed: 0.0180s/iter; left time: 741.3053s
	iters: 300, epoch: 13 | loss: 0.8195211
	speed: 0.0195s/iter; left time: 797.4670s
	iters: 400, epoch: 13 | loss: 0.0087751
	speed: 0.0187s/iter; left time: 763.4936s
Epoch: 13 cost time: 9.281611204147339
Epoch: 13, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0053581
	speed: 0.0936s/iter; left time: 3809.0851s
	iters: 200, epoch: 14 | loss: 0.0327198
	speed: 0.0197s/iter; left time: 801.3380s
	iters: 300, epoch: 14 | loss: 0.1885535
	speed: 0.0204s/iter; left time: 824.2878s
	iters: 400, epoch: 14 | loss: 0.0001219
	speed: 0.0188s/iter; left time: 759.3169s
Epoch: 14 cost time: 9.653084754943848
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0074704
	speed: 0.1090s/iter; left time: 4385.1269s
	iters: 200, epoch: 15 | loss: 0.0192506
	speed: 0.0218s/iter; left time: 873.4506s
	iters: 300, epoch: 15 | loss: 0.0001165
	speed: 0.0216s/iter; left time: 865.3724s
	iters: 400, epoch: 15 | loss: 0.0248341
	speed: 0.0220s/iter; left time: 877.3575s
Epoch: 15 cost time: 10.456624269485474
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.972269 --> -0.976271).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0865596
	speed: 0.1203s/iter; left time: 4782.9212s
	iters: 200, epoch: 16 | loss: 0.0070062
	speed: 0.0211s/iter; left time: 838.4760s
	iters: 300, epoch: 16 | loss: 0.0035904
	speed: 0.0223s/iter; left time: 883.6377s
	iters: 400, epoch: 16 | loss: 0.0198262
	speed: 0.0208s/iter; left time: 819.3222s
Epoch: 16 cost time: 10.539944887161255
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0055164
	speed: 0.1124s/iter; left time: 4416.6700s
	iters: 200, epoch: 17 | loss: 0.0362891
	speed: 0.0216s/iter; left time: 845.7518s
	iters: 300, epoch: 17 | loss: 0.0756562
	speed: 0.0218s/iter; left time: 853.8874s
	iters: 400, epoch: 17 | loss: 0.0040543
	speed: 0.0220s/iter; left time: 856.5432s
Epoch: 17 cost time: 10.634726285934448
Epoch: 17, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0341221
	speed: 0.1202s/iter; left time: 4666.7374s
	iters: 200, epoch: 18 | loss: 0.0062478
	speed: 0.0223s/iter; left time: 865.4947s
	iters: 300, epoch: 18 | loss: 0.0079620
	speed: 0.0216s/iter; left time: 832.6052s
	iters: 400, epoch: 18 | loss: 0.0335067
	speed: 0.0219s/iter; left time: 845.6080s
Epoch: 18 cost time: 10.70693039894104
Epoch: 18, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976843).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0654944
	speed: 0.1237s/iter; left time: 4745.1352s
	iters: 200, epoch: 19 | loss: 0.0028505
	speed: 0.0225s/iter; left time: 861.6330s
	iters: 300, epoch: 19 | loss: 0.1645432
	speed: 0.0215s/iter; left time: 818.7624s
	iters: 400, epoch: 19 | loss: 0.0045611
	speed: 0.0227s/iter; left time: 864.4239s
Epoch: 19 cost time: 10.855358839035034
Epoch: 19, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0029679
	speed: 0.1205s/iter; left time: 4565.5416s
	iters: 200, epoch: 20 | loss: 0.0021116
	speed: 0.0208s/iter; left time: 787.8835s
	iters: 300, epoch: 20 | loss: 0.0008984
	speed: 0.0219s/iter; left time: 823.7695s
	iters: 400, epoch: 20 | loss: 0.0017937
	speed: 0.0216s/iter; left time: 811.4439s
Epoch: 20 cost time: 10.46778678894043
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976843 --> -0.976843).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0023268
	speed: 0.1121s/iter; left time: 4195.0387s
	iters: 200, epoch: 21 | loss: 0.0054707
	speed: 0.0217s/iter; left time: 809.8456s
	iters: 300, epoch: 21 | loss: 0.0248594
	speed: 0.0211s/iter; left time: 783.9175s
	iters: 400, epoch: 21 | loss: 0.0075693
	speed: 0.0207s/iter; left time: 768.6666s
Epoch: 21 cost time: 10.515570878982544
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978272).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0262917
	speed: 0.1111s/iter; left time: 4106.1553s
	iters: 200, epoch: 22 | loss: 0.0203458
	speed: 0.0230s/iter; left time: 847.4568s
	iters: 300, epoch: 22 | loss: 0.0036104
	speed: 0.0209s/iter; left time: 766.7809s
	iters: 400, epoch: 22 | loss: 0.0010419
	speed: 0.0218s/iter; left time: 799.8016s
Epoch: 22 cost time: 10.421078205108643
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0098750
	speed: 0.1188s/iter; left time: 4335.6581s
	iters: 200, epoch: 23 | loss: 0.0034780
	speed: 0.0214s/iter; left time: 779.2937s
	iters: 300, epoch: 23 | loss: 0.0008985
	speed: 0.0219s/iter; left time: 793.9654s
	iters: 400, epoch: 23 | loss: 0.0216416
	speed: 0.0222s/iter; left time: 803.1135s
Epoch: 23 cost time: 10.774872779846191
Epoch: 23, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0997919
	speed: 0.1236s/iter; left time: 4451.4379s
	iters: 200, epoch: 24 | loss: 0.0027727
	speed: 0.0223s/iter; left time: 802.4568s
	iters: 300, epoch: 24 | loss: 0.0029478
	speed: 0.0226s/iter; left time: 807.7771s
	iters: 400, epoch: 24 | loss: 0.0099065
	speed: 0.0230s/iter; left time: 820.5350s
Epoch: 24 cost time: 10.964651346206665
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0077306
	speed: 0.1220s/iter; left time: 4335.5214s
	iters: 200, epoch: 25 | loss: 0.0012257
	speed: 0.0206s/iter; left time: 729.0118s
	iters: 300, epoch: 25 | loss: 0.0479392
	speed: 0.0213s/iter; left time: 751.8928s
	iters: 400, epoch: 25 | loss: 0.0075489
	speed: 0.0210s/iter; left time: 740.1823s
Epoch: 25 cost time: 10.321257829666138
Epoch: 25, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0503355
	speed: 0.1142s/iter; left time: 4006.3954s
	iters: 200, epoch: 26 | loss: 0.0655854
	speed: 0.0209s/iter; left time: 732.4443s
	iters: 300, epoch: 26 | loss: 0.0031883
	speed: 0.0221s/iter; left time: 769.6619s
	iters: 400, epoch: 26 | loss: 0.0349009
	speed: 0.0215s/iter; left time: 747.3283s
Epoch: 26 cost time: 10.49583911895752
Epoch: 26, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0154679
	speed: 0.1142s/iter; left time: 3951.7414s
	iters: 200, epoch: 27 | loss: 0.0003022
	speed: 0.0214s/iter; left time: 739.2888s
	iters: 300, epoch: 27 | loss: 0.0103368
	speed: 0.0218s/iter; left time: 748.6925s
	iters: 400, epoch: 27 | loss: 0.0582799
	speed: 0.0220s/iter; left time: 754.7417s
Epoch: 27 cost time: 10.59432578086853
Epoch: 27, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0003860
	speed: 0.1199s/iter; left time: 4092.6399s
	iters: 200, epoch: 28 | loss: 0.0002348
	speed: 0.0210s/iter; left time: 713.2942s
	iters: 300, epoch: 28 | loss: 0.0224930
	speed: 0.0239s/iter; left time: 811.0387s
	iters: 400, epoch: 28 | loss: 0.0046086
	speed: 0.0237s/iter; left time: 801.8441s
Epoch: 28 cost time: 11.16025686264038
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.978272 --> -0.979702).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0127183
	speed: 0.1260s/iter; left time: 4241.3635s
	iters: 200, epoch: 29 | loss: 0.0054888
	speed: 0.0228s/iter; left time: 765.3105s
	iters: 300, epoch: 29 | loss: 0.0015336
	speed: 0.0209s/iter; left time: 700.5488s
	iters: 400, epoch: 29 | loss: 0.0022709
	speed: 0.0234s/iter; left time: 781.0247s
Epoch: 29 cost time: 10.850897789001465
Epoch: 29, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 30 | loss: 0.0052574
	speed: 0.1244s/iter; left time: 4131.1187s
	iters: 200, epoch: 30 | loss: 0.1965832
	speed: 0.0224s/iter; left time: 740.8743s
	iters: 300, epoch: 30 | loss: 0.0170746
	speed: 0.0219s/iter; left time: 722.9711s
	iters: 400, epoch: 30 | loss: 0.0778847
	speed: 0.0220s/iter; left time: 723.2208s
Epoch: 30 cost time: 10.839295148849487
Epoch: 30, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 31 | loss: 0.0672071
	speed: 0.1097s/iter; left time: 3589.4446s
	iters: 200, epoch: 31 | loss: 0.0003296
	speed: 0.0226s/iter; left time: 736.5168s
	iters: 300, epoch: 31 | loss: 0.0006759
	speed: 0.0231s/iter; left time: 752.6227s
	iters: 400, epoch: 31 | loss: 0.0022219
	speed: 0.0231s/iter; left time: 748.6431s
Epoch: 31 cost time: 10.965160131454468
Epoch: 31, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 32 | loss: 0.0015487
	speed: 0.1182s/iter; left time: 3812.2955s
	iters: 200, epoch: 32 | loss: 0.0139400
	speed: 0.0215s/iter; left time: 690.0575s
	iters: 300, epoch: 32 | loss: 0.0184157
	speed: 0.0216s/iter; left time: 693.7044s
	iters: 400, epoch: 32 | loss: 0.0007407
	speed: 0.0212s/iter; left time: 678.8318s
Epoch: 32 cost time: 10.624186515808105
Epoch: 32, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 33 | loss: 0.0033228
	speed: 0.1151s/iter; left time: 3659.5138s
	iters: 200, epoch: 33 | loss: 0.0002551
	speed: 0.0213s/iter; left time: 675.3155s
	iters: 300, epoch: 33 | loss: 0.0175591
	speed: 0.0214s/iter; left time: 677.3966s
	iters: 400, epoch: 33 | loss: 0.0000697
	speed: 0.0211s/iter; left time: 663.7465s
Epoch: 33 cost time: 10.443427801132202
Epoch: 33, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 34 | loss: 0.0019266
	speed: 0.1225s/iter; left time: 3837.0607s
	iters: 200, epoch: 34 | loss: 0.0030812
	speed: 0.0222s/iter; left time: 693.9269s
	iters: 300, epoch: 34 | loss: 0.0165982
	speed: 0.0218s/iter; left time: 678.3308s
	iters: 400, epoch: 34 | loss: 0.0129319
	speed: 0.0223s/iter; left time: 690.3230s
Epoch: 34 cost time: 10.905686140060425
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 35 | loss: 0.0056700
	speed: 0.1214s/iter; left time: 3745.9158s
	iters: 200, epoch: 35 | loss: 0.0019330
	speed: 0.0227s/iter; left time: 699.6210s
	iters: 300, epoch: 35 | loss: 0.1614303
	speed: 0.0229s/iter; left time: 701.1021s
	iters: 400, epoch: 35 | loss: 0.0057552
	speed: 0.0229s/iter; left time: 699.5698s
Epoch: 35 cost time: 11.16060733795166
Epoch: 35, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 36 | loss: 0.8622847
	speed: 0.1174s/iter; left time: 3567.8507s
	iters: 200, epoch: 36 | loss: 0.0000883
	speed: 0.0220s/iter; left time: 666.7517s
	iters: 300, epoch: 36 | loss: 0.0164310
	speed: 0.0211s/iter; left time: 636.4641s
	iters: 400, epoch: 36 | loss: 0.0085377
	speed: 0.0210s/iter; left time: 630.9116s
Epoch: 36 cost time: 10.537391185760498
Epoch: 36, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 37 | loss: 0.1760689
	speed: 0.1121s/iter; left time: 3354.5930s
	iters: 200, epoch: 37 | loss: 0.0156617
	speed: 0.0220s/iter; left time: 655.1610s
	iters: 300, epoch: 37 | loss: 0.0003914
	speed: 0.0225s/iter; left time: 668.2371s
	iters: 400, epoch: 37 | loss: 0.0143906
	speed: 0.0218s/iter; left time: 645.2932s
Epoch: 37 cost time: 10.771696090698242
Epoch: 37, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 38 | loss: 0.0000733
	speed: 0.1147s/iter; left time: 3379.0378s
	iters: 200, epoch: 38 | loss: 0.0096090
	speed: 0.0225s/iter; left time: 660.1840s
	iters: 300, epoch: 38 | loss: 0.0008427
	speed: 0.0202s/iter; left time: 591.1286s
	iters: 400, epoch: 38 | loss: 0.0005171
	speed: 0.0212s/iter; left time: 617.8592s
Epoch: 38 cost time: 10.30871033668518
Epoch: 38, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 31138
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.2623150
	speed: 0.0409s/iter; left time: 1915.2241s
	iters: 200, epoch: 1 | loss: 0.6828414
	speed: 0.0219s/iter; left time: 1023.2842s
	iters: 300, epoch: 1 | loss: 0.5046666
	speed: 0.0225s/iter; left time: 1048.3547s
	iters: 400, epoch: 1 | loss: 0.2349049
	speed: 0.0226s/iter; left time: 1052.8773s
Epoch: 1 cost time: 12.392099142074585
Epoch: 1, Steps: 469 | Train Loss: 0.899 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (inf --> -0.902798).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1270832
	speed: 0.1233s/iter; left time: 5712.9196s
	iters: 200, epoch: 2 | loss: 0.1617824
	speed: 0.0220s/iter; left time: 1015.5588s
	iters: 300, epoch: 2 | loss: 0.0757748
	speed: 0.0216s/iter; left time: 997.0558s
	iters: 400, epoch: 2 | loss: 0.0363626
	speed: 0.0212s/iter; left time: 974.5956s
Epoch: 2 cost time: 10.691347599029541
Epoch: 2, Steps: 469 | Train Loss: 0.200 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.902798 --> -0.944252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0897634
	speed: 0.1164s/iter; left time: 5338.4924s
	iters: 200, epoch: 3 | loss: 0.1968616
	speed: 0.0218s/iter; left time: 997.9324s
	iters: 300, epoch: 3 | loss: 0.0418416
	speed: 0.0221s/iter; left time: 1008.8023s
	iters: 400, epoch: 3 | loss: 0.1689111
	speed: 0.0211s/iter; left time: 961.2256s
Epoch: 3 cost time: 10.50628399848938
Epoch: 3, Steps: 469 | Train Loss: 0.129 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.944252 --> -0.956259).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0065617
	speed: 0.1135s/iter; left time: 5152.7467s
	iters: 200, epoch: 4 | loss: 0.0219697
	speed: 0.0221s/iter; left time: 1001.6816s
	iters: 300, epoch: 4 | loss: 0.3371100
	speed: 0.0211s/iter; left time: 954.7377s
	iters: 400, epoch: 4 | loss: 0.0748296
	speed: 0.0215s/iter; left time: 968.2954s
Epoch: 4 cost time: 10.429486274719238
Epoch: 4, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.956259 --> -0.963978).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0078822
	speed: 0.1131s/iter; left time: 5082.5754s
	iters: 200, epoch: 5 | loss: 0.0369446
	speed: 0.0234s/iter; left time: 1048.9953s
	iters: 300, epoch: 5 | loss: 0.0953199
	speed: 0.0228s/iter; left time: 1019.3285s
	iters: 400, epoch: 5 | loss: 0.0265753
	speed: 0.0235s/iter; left time: 1049.2719s
Epoch: 5 cost time: 11.234515190124512
Epoch: 5, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.963978 --> -0.966837).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0700736
	speed: 0.1287s/iter; left time: 5721.8627s
	iters: 200, epoch: 6 | loss: 0.0413654
	speed: 0.0232s/iter; left time: 1030.6853s
	iters: 300, epoch: 6 | loss: 0.0114115
	speed: 0.0237s/iter; left time: 1050.4525s
	iters: 400, epoch: 6 | loss: 0.0010903
	speed: 0.0235s/iter; left time: 1038.1320s
Epoch: 6 cost time: 11.264140844345093
Epoch: 6, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.969124).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0719868
	speed: 0.1267s/iter; left time: 5572.6214s
	iters: 200, epoch: 7 | loss: 0.1916852
	speed: 0.0234s/iter; left time: 1025.3147s
	iters: 300, epoch: 7 | loss: 0.0063836
	speed: 0.0215s/iter; left time: 941.8286s
	iters: 400, epoch: 7 | loss: 0.0083718
	speed: 0.0236s/iter; left time: 1030.6296s
Epoch: 7 cost time: 11.083612442016602
Epoch: 7, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0181242
	speed: 0.1113s/iter; left time: 4842.2303s
	iters: 200, epoch: 8 | loss: 0.3275384
	speed: 0.0223s/iter; left time: 968.4120s
	iters: 300, epoch: 8 | loss: 0.0306014
	speed: 0.0211s/iter; left time: 912.8717s
	iters: 400, epoch: 8 | loss: 0.0004757
	speed: 0.0214s/iter; left time: 923.0069s
Epoch: 8 cost time: 10.50986647605896
Epoch: 8, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.969124 --> -0.974842).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0042687
	speed: 0.1169s/iter; left time: 5033.7372s
	iters: 200, epoch: 9 | loss: 0.0139999
	speed: 0.0214s/iter; left time: 917.2829s
	iters: 300, epoch: 9 | loss: 0.0320485
	speed: 0.0211s/iter; left time: 902.9985s
	iters: 400, epoch: 9 | loss: 0.0030005
	speed: 0.0217s/iter; left time: 927.4142s
Epoch: 9 cost time: 10.430044889450073
Epoch: 9, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974842 --> -0.975413).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0310299
	speed: 0.1185s/iter; left time: 5047.3827s
	iters: 200, epoch: 10 | loss: 0.0014436
	speed: 0.0216s/iter; left time: 918.7651s
	iters: 300, epoch: 10 | loss: 0.2003873
	speed: 0.0224s/iter; left time: 950.9146s
	iters: 400, epoch: 10 | loss: 0.0447999
	speed: 0.0212s/iter; left time: 897.3461s
Epoch: 10 cost time: 10.750335454940796
Epoch: 10, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.2816261
	speed: 0.1188s/iter; left time: 5002.7181s
	iters: 200, epoch: 11 | loss: 0.0548426
	speed: 0.0222s/iter; left time: 932.6360s
	iters: 300, epoch: 11 | loss: 0.0033848
	speed: 0.0230s/iter; left time: 962.1330s
	iters: 400, epoch: 11 | loss: 0.0057883
	speed: 0.0226s/iter; left time: 944.5521s
Epoch: 11 cost time: 11.01421594619751
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0179237
	speed: 0.1207s/iter; left time: 5025.1964s
	iters: 200, epoch: 12 | loss: 0.0009281
	speed: 0.0207s/iter; left time: 861.8525s
	iters: 300, epoch: 12 | loss: 0.0099473
	speed: 0.0203s/iter; left time: 839.5622s
	iters: 400, epoch: 12 | loss: 0.1789833
	speed: 0.0211s/iter; left time: 872.9219s
Epoch: 12 cost time: 10.082791328430176
Epoch: 12, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0268052
	speed: 0.1131s/iter; left time: 4656.3430s
	iters: 200, epoch: 13 | loss: 0.0741844
	speed: 0.0216s/iter; left time: 885.8686s
	iters: 300, epoch: 13 | loss: 0.9415189
	speed: 0.0223s/iter; left time: 914.3980s
	iters: 400, epoch: 13 | loss: 0.0604295
	speed: 0.0218s/iter; left time: 889.3753s
Epoch: 13 cost time: 10.738243579864502
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0800453
	speed: 0.1150s/iter; left time: 4681.5352s
	iters: 200, epoch: 14 | loss: 0.0234028
	speed: 0.0229s/iter; left time: 931.8376s
	iters: 300, epoch: 14 | loss: 0.1303827
	speed: 0.0219s/iter; left time: 887.2631s
	iters: 400, epoch: 14 | loss: 0.0011816
	speed: 0.0211s/iter; left time: 851.5396s
Epoch: 14 cost time: 10.762324571609497
Epoch: 14, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0006733
	speed: 0.1114s/iter; left time: 4482.0428s
	iters: 200, epoch: 15 | loss: 0.0354901
	speed: 0.0217s/iter; left time: 871.9849s
	iters: 300, epoch: 15 | loss: 0.0003400
	speed: 0.0217s/iter; left time: 869.8139s
	iters: 400, epoch: 15 | loss: 0.1217017
	speed: 0.0212s/iter; left time: 848.2071s
Epoch: 15 cost time: 10.44490647315979
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.975413 --> -0.978558).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0045623
	speed: 0.1174s/iter; left time: 4668.2133s
	iters: 200, epoch: 16 | loss: 0.0010415
	speed: 0.0205s/iter; left time: 811.7491s
	iters: 300, epoch: 16 | loss: 0.0008249
	speed: 0.0215s/iter; left time: 849.5095s
	iters: 400, epoch: 16 | loss: 0.0226861
	speed: 0.0208s/iter; left time: 822.3557s
Epoch: 16 cost time: 10.242230892181396
Epoch: 16, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0082775
	speed: 0.1164s/iter; left time: 4572.6754s
	iters: 200, epoch: 17 | loss: 0.0169054
	speed: 0.0217s/iter; left time: 849.4049s
	iters: 300, epoch: 17 | loss: 0.2379985
	speed: 0.0207s/iter; left time: 807.6050s
	iters: 400, epoch: 17 | loss: 0.0177488
	speed: 0.0203s/iter; left time: 791.7936s
Epoch: 17 cost time: 10.444945335388184
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0066403
	speed: 0.1100s/iter; left time: 4272.3457s
	iters: 200, epoch: 18 | loss: 0.0017204
	speed: 0.0204s/iter; left time: 788.6081s
	iters: 300, epoch: 18 | loss: 0.0685444
	speed: 0.0203s/iter; left time: 783.5410s
	iters: 400, epoch: 18 | loss: 0.0034050
	speed: 0.0203s/iter; left time: 781.9867s
Epoch: 18 cost time: 9.967731475830078
Epoch: 18, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
Validation loss decreased (-0.978558 --> -0.981703).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0049758
	speed: 0.1060s/iter; left time: 4065.7609s
	iters: 200, epoch: 19 | loss: 0.0019748
	speed: 0.0199s/iter; left time: 761.2186s
	iters: 300, epoch: 19 | loss: 0.2984299
	speed: 0.0197s/iter; left time: 750.8990s
	iters: 400, epoch: 19 | loss: 0.1621856
	speed: 0.0208s/iter; left time: 790.0518s
Epoch: 19 cost time: 9.878126859664917
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0594108
	speed: 0.1039s/iter; left time: 3937.4620s
	iters: 200, epoch: 20 | loss: 0.0030423
	speed: 0.0201s/iter; left time: 758.4761s
	iters: 300, epoch: 20 | loss: 0.0003430
	speed: 0.0203s/iter; left time: 763.4896s
	iters: 400, epoch: 20 | loss: 0.0021371
	speed: 0.0199s/iter; left time: 746.7997s
Epoch: 20 cost time: 9.699127197265625
Epoch: 20, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0042406
	speed: 0.1145s/iter; left time: 4285.5318s
	iters: 200, epoch: 21 | loss: 0.0069921
	speed: 0.0224s/iter; left time: 836.5582s
	iters: 300, epoch: 21 | loss: 0.0049922
	speed: 0.0213s/iter; left time: 791.4239s
	iters: 400, epoch: 21 | loss: 0.1096165
	speed: 0.0212s/iter; left time: 787.6297s
Epoch: 21 cost time: 10.603139400482178
Epoch: 21, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0937750
	speed: 0.1188s/iter; left time: 4391.1372s
	iters: 200, epoch: 22 | loss: 0.0014707
	speed: 0.0222s/iter; left time: 819.5028s
	iters: 300, epoch: 22 | loss: 0.0137866
	speed: 0.0225s/iter; left time: 828.7292s
	iters: 400, epoch: 22 | loss: 0.0017220
	speed: 0.0219s/iter; left time: 803.2266s
Epoch: 22 cost time: 10.818397760391235
Epoch: 22, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0174802
	speed: 0.1147s/iter; left time: 4185.7971s
	iters: 200, epoch: 23 | loss: 0.0028114
	speed: 0.0215s/iter; left time: 782.3514s
	iters: 300, epoch: 23 | loss: 0.0003666
	speed: 0.0215s/iter; left time: 778.2821s
	iters: 400, epoch: 23 | loss: 0.0019304
	speed: 0.0211s/iter; left time: 763.7238s
Epoch: 23 cost time: 10.435409307479858
Epoch: 23, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0088075
	speed: 0.1109s/iter; left time: 3992.2734s
	iters: 200, epoch: 24 | loss: 0.0001704
	speed: 0.0216s/iter; left time: 777.4044s
	iters: 300, epoch: 24 | loss: 0.0002757
	speed: 0.0206s/iter; left time: 736.1225s
	iters: 400, epoch: 24 | loss: 0.0062978
	speed: 0.0213s/iter; left time: 760.4289s
Epoch: 24 cost time: 10.245871782302856
Epoch: 24, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0269073
	speed: 0.1053s/iter; left time: 3741.5326s
	iters: 200, epoch: 25 | loss: 0.0074324
	speed: 0.0204s/iter; left time: 723.0075s
	iters: 300, epoch: 25 | loss: 0.0015875
	speed: 0.0202s/iter; left time: 712.4534s
	iters: 400, epoch: 25 | loss: 0.0012437
	speed: 0.0198s/iter; left time: 698.7170s
Epoch: 25 cost time: 9.96388840675354
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0315385
	speed: 0.1119s/iter; left time: 3924.8293s
	iters: 200, epoch: 26 | loss: 0.0005973
	speed: 0.0206s/iter; left time: 722.2211s
	iters: 300, epoch: 26 | loss: 0.0040553
	speed: 0.0216s/iter; left time: 753.5214s
	iters: 400, epoch: 26 | loss: 0.0187424
	speed: 0.0211s/iter; left time: 735.4797s
Epoch: 26 cost time: 10.442909240722656
Epoch: 26, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 27 | loss: 0.1557495
	speed: 0.1229s/iter; left time: 4252.6570s
	iters: 200, epoch: 27 | loss: 0.0005802
	speed: 0.0216s/iter; left time: 743.8828s
	iters: 300, epoch: 27 | loss: 0.1523978
	speed: 0.0215s/iter; left time: 740.4415s
	iters: 400, epoch: 27 | loss: 0.1200393
	speed: 0.0218s/iter; left time: 746.6852s
Epoch: 27 cost time: 10.474119186401367
Epoch: 27, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 28 | loss: 0.0001487
	speed: 0.1191s/iter; left time: 4065.0157s
	iters: 200, epoch: 28 | loss: 0.0048015
	speed: 0.0211s/iter; left time: 717.5157s
	iters: 300, epoch: 28 | loss: 0.0069588
	speed: 0.0202s/iter; left time: 684.1024s
	iters: 400, epoch: 28 | loss: 0.0034982
	speed: 0.0202s/iter; left time: 682.2919s
Epoch: 28 cost time: 10.212278127670288
Epoch: 28, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9817038307604345
model parameter : 31138
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4475923
	speed: 0.0387s/iter; left time: 1809.0073s
	iters: 200, epoch: 1 | loss: 0.6106974
	speed: 0.0232s/iter; left time: 1082.7378s
	iters: 300, epoch: 1 | loss: 0.3110480
	speed: 0.0234s/iter; left time: 1088.3202s
	iters: 400, epoch: 1 | loss: 0.5179742
	speed: 0.0225s/iter; left time: 1043.9838s
Epoch: 1 cost time: 12.400059223175049
Epoch: 1, Steps: 469 | Train Loss: 0.849 Vali Loss: 0.412 Vali Acc: 0.879 Test Loss: 0.412 Test Acc: 0.879
Validation loss decreased (inf --> -0.879070).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3755019
	speed: 0.1118s/iter; left time: 5179.7291s
	iters: 200, epoch: 2 | loss: 0.2713026
	speed: 0.0241s/iter; left time: 1113.5747s
	iters: 300, epoch: 2 | loss: 0.1320524
	speed: 0.0231s/iter; left time: 1067.7148s
	iters: 400, epoch: 2 | loss: 0.1271186
	speed: 0.0234s/iter; left time: 1075.1186s
Epoch: 2 cost time: 11.57529616355896
Epoch: 2, Steps: 469 | Train Loss: 0.213 Vali Loss: 0.247 Vali Acc: 0.927 Test Loss: 0.247 Test Acc: 0.927
Validation loss decreased (-0.879070 --> -0.926813).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1035131
	speed: 0.1197s/iter; left time: 5490.5239s
	iters: 200, epoch: 3 | loss: 0.1889821
	speed: 0.0224s/iter; left time: 1023.2740s
	iters: 300, epoch: 3 | loss: 0.0390593
	speed: 0.0218s/iter; left time: 994.1089s
	iters: 400, epoch: 3 | loss: 0.0443827
	speed: 0.0214s/iter; left time: 973.9099s
Epoch: 3 cost time: 10.649699449539185
Epoch: 3, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.926813 --> -0.947682).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0552738
	speed: 0.1199s/iter; left time: 5444.1254s
	iters: 200, epoch: 4 | loss: 0.0362123
	speed: 0.0211s/iter; left time: 956.5493s
	iters: 300, epoch: 4 | loss: 0.0455314
	speed: 0.0229s/iter; left time: 1033.2347s
	iters: 400, epoch: 4 | loss: 0.0564612
	speed: 0.0227s/iter; left time: 1024.2074s
Epoch: 4 cost time: 10.897606611251831
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.947682 --> -0.958832).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0658865
	speed: 0.1127s/iter; left time: 5062.8760s
	iters: 200, epoch: 5 | loss: 0.1172747
	speed: 0.0218s/iter; left time: 978.1584s
	iters: 300, epoch: 5 | loss: 0.0234814
	speed: 0.0215s/iter; left time: 960.3422s
	iters: 400, epoch: 5 | loss: 0.0407149
	speed: 0.0225s/iter; left time: 1004.8163s
Epoch: 5 cost time: 10.588417768478394
Epoch: 5, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.958832 --> -0.964550).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1821242
	speed: 0.1145s/iter; left time: 5090.4625s
	iters: 200, epoch: 6 | loss: 0.0108661
	speed: 0.0227s/iter; left time: 1006.0494s
	iters: 300, epoch: 6 | loss: 0.0380193
	speed: 0.0215s/iter; left time: 951.7862s
	iters: 400, epoch: 6 | loss: 0.0448118
	speed: 0.0220s/iter; left time: 973.5323s
Epoch: 6 cost time: 10.617552995681763
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.964550 --> -0.973126).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0155804
	speed: 0.1173s/iter; left time: 5159.3760s
	iters: 200, epoch: 7 | loss: 0.0068941
	speed: 0.0226s/iter; left time: 991.7920s
	iters: 300, epoch: 7 | loss: 0.0264722
	speed: 0.0230s/iter; left time: 1006.9996s
	iters: 400, epoch: 7 | loss: 0.0322918
	speed: 0.0225s/iter; left time: 982.4993s
Epoch: 7 cost time: 11.071098804473877
Epoch: 7, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6117328
	speed: 0.1231s/iter; left time: 5358.8330s
	iters: 200, epoch: 8 | loss: 0.0287765
	speed: 0.0233s/iter; left time: 1012.6068s
	iters: 300, epoch: 8 | loss: 0.0268477
	speed: 0.0229s/iter; left time: 991.9037s
	iters: 400, epoch: 8 | loss: 0.1072984
	speed: 0.0229s/iter; left time: 989.9896s
Epoch: 8 cost time: 11.04676342010498
Epoch: 8, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0333074
	speed: 0.1248s/iter; left time: 5374.0739s
	iters: 200, epoch: 9 | loss: 0.0077967
	speed: 0.0207s/iter; left time: 890.2409s
	iters: 300, epoch: 9 | loss: 0.2163999
	speed: 0.0224s/iter; left time: 959.1569s
	iters: 400, epoch: 9 | loss: 0.0185957
	speed: 0.0218s/iter; left time: 931.7764s
Epoch: 9 cost time: 10.853044509887695
Epoch: 9, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0053851
	speed: 0.1139s/iter; left time: 4849.1217s
	iters: 200, epoch: 10 | loss: 0.0350946
	speed: 0.0222s/iter; left time: 943.3041s
	iters: 300, epoch: 10 | loss: 0.0232011
	speed: 0.0213s/iter; left time: 902.7453s
	iters: 400, epoch: 10 | loss: 0.0255989
	speed: 0.0224s/iter; left time: 947.9912s
Epoch: 10 cost time: 10.676213264465332
Epoch: 10, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0077251
	speed: 0.1116s/iter; left time: 4700.5768s
	iters: 200, epoch: 11 | loss: 0.0172166
	speed: 0.0229s/iter; left time: 959.9535s
	iters: 300, epoch: 11 | loss: 0.0201020
	speed: 0.0236s/iter; left time: 990.6677s
	iters: 400, epoch: 11 | loss: 0.0271527
	speed: 0.0230s/iter; left time: 961.4735s
Epoch: 11 cost time: 11.283870935440063
Epoch: 11, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0070152
	speed: 0.1173s/iter; left time: 4884.2799s
	iters: 200, epoch: 12 | loss: 0.0050756
	speed: 0.0221s/iter; left time: 919.3778s
	iters: 300, epoch: 12 | loss: 0.0124514
	speed: 0.0213s/iter; left time: 883.0192s
	iters: 400, epoch: 12 | loss: 0.0066014
	speed: 0.0214s/iter; left time: 886.1637s
Epoch: 12 cost time: 10.724631309509277
Epoch: 12, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973984).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2282788
	speed: 0.1198s/iter; left time: 4932.5512s
	iters: 200, epoch: 13 | loss: 0.0071800
	speed: 0.0216s/iter; left time: 887.9568s
	iters: 300, epoch: 13 | loss: 0.0092085
	speed: 0.0228s/iter; left time: 932.3672s
	iters: 400, epoch: 13 | loss: 0.0927719
	speed: 0.0226s/iter; left time: 922.8225s
Epoch: 13 cost time: 10.750801086425781
Epoch: 13, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.973984 --> -0.975699).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0010224
	speed: 0.1203s/iter; left time: 4897.8472s
	iters: 200, epoch: 14 | loss: 0.0017832
	speed: 0.0224s/iter; left time: 909.7077s
	iters: 300, epoch: 14 | loss: 0.1478727
	speed: 0.0214s/iter; left time: 868.5101s
	iters: 400, epoch: 14 | loss: 0.0035030
	speed: 0.0214s/iter; left time: 864.0462s
Epoch: 14 cost time: 10.67426347732544
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0073776
	speed: 0.1161s/iter; left time: 4670.0673s
	iters: 200, epoch: 15 | loss: 0.0100983
	speed: 0.0221s/iter; left time: 885.8343s
	iters: 300, epoch: 15 | loss: 0.0015242
	speed: 0.0222s/iter; left time: 887.0499s
	iters: 400, epoch: 15 | loss: 0.0276266
	speed: 0.0216s/iter; left time: 862.4977s
Epoch: 15 cost time: 10.731917142868042
Epoch: 15, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0377061
	speed: 0.1134s/iter; left time: 4509.3462s
	iters: 200, epoch: 16 | loss: 0.0065438
	speed: 0.0212s/iter; left time: 842.8012s
	iters: 300, epoch: 16 | loss: 0.0697142
	speed: 0.0217s/iter; left time: 857.3652s
	iters: 400, epoch: 16 | loss: 0.0008051
	speed: 0.0195s/iter; left time: 770.8565s
Epoch: 16 cost time: 10.32682466506958
Epoch: 16, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.978558).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0219343
	speed: 0.1186s/iter; left time: 4661.3184s
	iters: 200, epoch: 17 | loss: 0.0244905
	speed: 0.0227s/iter; left time: 891.4369s
	iters: 300, epoch: 17 | loss: 0.0051193
	speed: 0.0234s/iter; left time: 915.3472s
	iters: 400, epoch: 17 | loss: 0.0017062
	speed: 0.0225s/iter; left time: 877.3465s
Epoch: 17 cost time: 11.212732791900635
Epoch: 17, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0463444
	speed: 0.1278s/iter; left time: 4960.5283s
	iters: 200, epoch: 18 | loss: 0.0134022
	speed: 0.0218s/iter; left time: 844.0597s
	iters: 300, epoch: 18 | loss: 0.1166894
	speed: 0.0224s/iter; left time: 864.4696s
	iters: 400, epoch: 18 | loss: 0.0046724
	speed: 0.0234s/iter; left time: 902.7704s
Epoch: 18 cost time: 11.054388761520386
Epoch: 18, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0011281
	speed: 0.1288s/iter; left time: 4941.9727s
	iters: 200, epoch: 19 | loss: 0.0030837
	speed: 0.0234s/iter; left time: 895.7927s
	iters: 300, epoch: 19 | loss: 0.0153458
	speed: 0.0216s/iter; left time: 823.5756s
	iters: 400, epoch: 19 | loss: 0.0091154
	speed: 0.0217s/iter; left time: 826.1593s
Epoch: 19 cost time: 11.049011468887329
Epoch: 19, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0232373
	speed: 0.1099s/iter; left time: 4164.8506s
	iters: 200, epoch: 20 | loss: 0.0000752
	speed: 0.0222s/iter; left time: 837.7692s
	iters: 300, epoch: 20 | loss: 0.0084356
	speed: 0.0224s/iter; left time: 845.2358s
	iters: 400, epoch: 20 | loss: 0.0054233
	speed: 0.0210s/iter; left time: 790.5651s
Epoch: 20 cost time: 10.486247301101685
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0102554
	speed: 0.1095s/iter; left time: 4096.1261s
	iters: 200, epoch: 21 | loss: 0.0122037
	speed: 0.0224s/iter; left time: 836.0376s
	iters: 300, epoch: 21 | loss: 0.0046880
	speed: 0.0217s/iter; left time: 805.8708s
	iters: 400, epoch: 21 | loss: 0.0067037
	speed: 0.0213s/iter; left time: 791.8971s
Epoch: 21 cost time: 10.466454267501831
Epoch: 21, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0002113
	speed: 0.1138s/iter; left time: 4205.4604s
	iters: 200, epoch: 22 | loss: 0.0148854
	speed: 0.0223s/iter; left time: 822.7034s
	iters: 300, epoch: 22 | loss: 0.0004435
	speed: 0.0208s/iter; left time: 765.5949s
	iters: 400, epoch: 22 | loss: 0.0051489
	speed: 0.0220s/iter; left time: 808.1506s
Epoch: 22 cost time: 10.807822227478027
Epoch: 22, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0050952
	speed: 0.1247s/iter; left time: 4550.7920s
	iters: 200, epoch: 23 | loss: 0.0408010
	speed: 0.0215s/iter; left time: 780.5509s
	iters: 300, epoch: 23 | loss: 0.0117211
	speed: 0.0224s/iter; left time: 814.3971s
	iters: 400, epoch: 23 | loss: 0.0427725
	speed: 0.0232s/iter; left time: 840.5885s
Epoch: 23 cost time: 10.891155242919922
Epoch: 23, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 24 | loss: 0.0010431
	speed: 0.1194s/iter; left time: 4299.8774s
	iters: 200, epoch: 24 | loss: 0.0190009
	speed: 0.0226s/iter; left time: 811.9528s
	iters: 300, epoch: 24 | loss: 0.0020180
	speed: 0.0220s/iter; left time: 788.2619s
	iters: 400, epoch: 24 | loss: 0.0104272
	speed: 0.0226s/iter; left time: 807.9617s
Epoch: 24 cost time: 10.98489761352539
Epoch: 24, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979702).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0012504
	speed: 0.1161s/iter; left time: 4125.2591s
	iters: 200, epoch: 25 | loss: 0.0018173
	speed: 0.0228s/iter; left time: 807.0245s
	iters: 300, epoch: 25 | loss: 0.2681323
	speed: 0.0238s/iter; left time: 841.3013s
	iters: 400, epoch: 25 | loss: 0.0071742
	speed: 0.0224s/iter; left time: 790.9627s
Epoch: 25 cost time: 10.99531626701355
Epoch: 25, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0044383
	speed: 0.1192s/iter; left time: 4180.8967s
	iters: 200, epoch: 26 | loss: 0.0003325
	speed: 0.0234s/iter; left time: 817.0490s
	iters: 300, epoch: 26 | loss: 0.0019223
	speed: 0.0229s/iter; left time: 799.2280s
	iters: 400, epoch: 26 | loss: 0.0050317
	speed: 0.0227s/iter; left time: 788.7895s
Epoch: 26 cost time: 11.066922664642334
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0109691
	speed: 0.1152s/iter; left time: 3987.6302s
	iters: 200, epoch: 27 | loss: 0.0032080
	speed: 0.0223s/iter; left time: 767.7809s
	iters: 300, epoch: 27 | loss: 0.0021448
	speed: 0.0226s/iter; left time: 777.2676s
	iters: 400, epoch: 27 | loss: 0.0196002
	speed: 0.0227s/iter; left time: 777.9963s
Epoch: 27 cost time: 10.818628549575806
Epoch: 27, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0004722
	speed: 0.1238s/iter; left time: 4227.2049s
	iters: 200, epoch: 28 | loss: 0.0034593
	speed: 0.0233s/iter; left time: 791.6884s
	iters: 300, epoch: 28 | loss: 0.0004659
	speed: 0.0237s/iter; left time: 805.1035s
	iters: 400, epoch: 28 | loss: 0.0193629
	speed: 0.0225s/iter; left time: 762.2252s
Epoch: 28 cost time: 11.191232919692993
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0092786
	speed: 0.1196s/iter; left time: 4025.7552s
	iters: 200, epoch: 29 | loss: 0.0278372
	speed: 0.0221s/iter; left time: 742.0288s
	iters: 300, epoch: 29 | loss: 0.0025431
	speed: 0.0219s/iter; left time: 731.8112s
	iters: 400, epoch: 29 | loss: 0.0177467
	speed: 0.0212s/iter; left time: 706.6974s
Epoch: 29 cost time: 10.650962352752686
Epoch: 29, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0118262
	speed: 0.1154s/iter; left time: 3832.3827s
	iters: 200, epoch: 30 | loss: 0.0128700
	speed: 0.0213s/iter; left time: 704.7479s
	iters: 300, epoch: 30 | loss: 0.0004824
	speed: 0.0216s/iter; left time: 712.2859s
	iters: 400, epoch: 30 | loss: 0.0185356
	speed: 0.0215s/iter; left time: 707.8581s
Epoch: 30 cost time: 10.594894170761108
Epoch: 30, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.979702 --> -0.981131).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0815279
	speed: 0.1216s/iter; left time: 3978.9622s
	iters: 200, epoch: 31 | loss: 0.0121743
	speed: 0.0223s/iter; left time: 727.6249s
	iters: 300, epoch: 31 | loss: 0.0039117
	speed: 0.0223s/iter; left time: 724.1074s
	iters: 400, epoch: 31 | loss: 0.0001067
	speed: 0.0231s/iter; left time: 748.7447s
Epoch: 31 cost time: 11.116672039031982
Epoch: 31, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.3246689
	speed: 0.1211s/iter; left time: 3905.6634s
	iters: 200, epoch: 32 | loss: 0.0051064
	speed: 0.0220s/iter; left time: 708.3706s
	iters: 300, epoch: 32 | loss: 0.0106654
	speed: 0.0224s/iter; left time: 717.8113s
	iters: 400, epoch: 32 | loss: 0.0127910
	speed: 0.0215s/iter; left time: 687.1867s
Epoch: 32 cost time: 10.732324361801147
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.981131 --> -0.983418).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0020675
	speed: 0.1284s/iter; left time: 4082.8001s
	iters: 200, epoch: 33 | loss: 0.3688690
	speed: 0.0234s/iter; left time: 741.3225s
	iters: 300, epoch: 33 | loss: 0.0079979
	speed: 0.0241s/iter; left time: 760.9563s
	iters: 400, epoch: 33 | loss: 0.0202576
	speed: 0.0247s/iter; left time: 777.1716s
Epoch: 33 cost time: 11.602943897247314
Epoch: 33, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0040540
	speed: 0.1273s/iter; left time: 3986.5129s
	iters: 200, epoch: 34 | loss: 0.0012780
	speed: 0.0241s/iter; left time: 751.6481s
	iters: 300, epoch: 34 | loss: 0.0001791
	speed: 0.0250s/iter; left time: 778.8651s
	iters: 400, epoch: 34 | loss: 0.0085887
	speed: 0.0233s/iter; left time: 722.3684s
Epoch: 34 cost time: 11.684520244598389
Epoch: 34, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0009199
	speed: 0.1229s/iter; left time: 3792.3901s
	iters: 200, epoch: 35 | loss: 0.0000962
	speed: 0.0274s/iter; left time: 843.0291s
	iters: 300, epoch: 35 | loss: 0.0009982
	speed: 0.0265s/iter; left time: 812.4561s
	iters: 400, epoch: 35 | loss: 0.0004058
	speed: 0.0194s/iter; left time: 591.7985s
Epoch: 35 cost time: 11.725049495697021
Epoch: 35, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0007785
	speed: 0.0973s/iter; left time: 2956.3653s
	iters: 200, epoch: 36 | loss: 0.0010857
	speed: 0.0193s/iter; left time: 584.1205s
	iters: 300, epoch: 36 | loss: 0.0155351
	speed: 0.0198s/iter; left time: 598.1191s
	iters: 400, epoch: 36 | loss: 0.0047894
	speed: 0.0191s/iter; left time: 574.0318s
Epoch: 36 cost time: 9.244395971298218
Epoch: 36, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0765846
	speed: 0.1142s/iter; left time: 3416.6933s
	iters: 200, epoch: 37 | loss: 0.0163327
	speed: 0.0219s/iter; left time: 652.0320s
	iters: 300, epoch: 37 | loss: 0.0004482
	speed: 0.0219s/iter; left time: 649.8616s
	iters: 400, epoch: 37 | loss: 0.0100642
	speed: 0.0223s/iter; left time: 659.1538s
Epoch: 37 cost time: 10.689838886260986
Epoch: 37, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0154619
	speed: 0.1176s/iter; left time: 3462.8912s
	iters: 200, epoch: 38 | loss: 0.0070219
	speed: 0.0223s/iter; left time: 654.4000s
	iters: 300, epoch: 38 | loss: 0.0215601
	speed: 0.0216s/iter; left time: 631.0630s
	iters: 400, epoch: 38 | loss: 0.0025916
	speed: 0.0228s/iter; left time: 663.8252s
Epoch: 38 cost time: 10.844557523727417
Epoch: 38, Steps: 469 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0027021
	speed: 0.1161s/iter; left time: 3365.3396s
	iters: 200, epoch: 39 | loss: 0.0053284
	speed: 0.0224s/iter; left time: 646.0057s
	iters: 300, epoch: 39 | loss: 0.0009098
	speed: 0.0219s/iter; left time: 629.3639s
	iters: 400, epoch: 39 | loss: 0.0029627
	speed: 0.0212s/iter; left time: 609.0953s
Epoch: 39 cost time: 10.914331674575806
Epoch: 39, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0001329
	speed: 0.1274s/iter; left time: 3633.2681s
	iters: 200, epoch: 40 | loss: 0.0017321
	speed: 0.0235s/iter; left time: 668.4834s
	iters: 300, epoch: 40 | loss: 0.0001658
	speed: 0.0225s/iter; left time: 637.6037s
	iters: 400, epoch: 40 | loss: 0.0009993
	speed: 0.0229s/iter; left time: 645.2731s
Epoch: 40 cost time: 11.14313268661499
Epoch: 40, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0006171
	speed: 0.1276s/iter; left time: 3577.9964s
	iters: 200, epoch: 41 | loss: 0.0012900
	speed: 0.0208s/iter; left time: 580.3240s
	iters: 300, epoch: 41 | loss: 0.0109777
	speed: 0.0220s/iter; left time: 612.0649s
	iters: 400, epoch: 41 | loss: 0.0882577
	speed: 0.0229s/iter; left time: 636.6449s
Epoch: 41 cost time: 10.749266386032104
Epoch: 41, Steps: 469 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0016825
	speed: 0.1126s/iter; left time: 3105.6708s
	iters: 200, epoch: 42 | loss: 0.0002936
	speed: 0.0221s/iter; left time: 607.2301s
	iters: 300, epoch: 42 | loss: 0.0000908
	speed: 0.0229s/iter; left time: 627.5290s
	iters: 400, epoch: 42 | loss: 0.0008546
	speed: 0.0226s/iter; left time: 615.9725s
Epoch: 42 cost time: 10.967723369598389
Epoch: 42, Steps: 469 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9834190966266438
model parameter : 22946
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5159918
	speed: 0.0401s/iter; left time: 1874.7138s
	iters: 200, epoch: 1 | loss: 0.6772987
	speed: 0.0212s/iter; left time: 991.7971s
	iters: 300, epoch: 1 | loss: 0.3545229
	speed: 0.0214s/iter; left time: 995.0031s
	iters: 400, epoch: 1 | loss: 0.5490488
	speed: 0.0213s/iter; left time: 988.3556s
Epoch: 1 cost time: 11.960046291351318
Epoch: 1, Steps: 469 | Train Loss: 0.877 Vali Loss: 0.412 Vali Acc: 0.877 Test Loss: 0.412 Test Acc: 0.877
Validation loss decreased (inf --> -0.877068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3906171
	speed: 0.1143s/iter; left time: 5294.4724s
	iters: 200, epoch: 2 | loss: 0.3264276
	speed: 0.0217s/iter; left time: 1002.2207s
	iters: 300, epoch: 2 | loss: 0.1368880
	speed: 0.0212s/iter; left time: 976.4546s
	iters: 400, epoch: 2 | loss: 0.1015573
	speed: 0.0214s/iter; left time: 986.3802s
Epoch: 2 cost time: 10.401217460632324
Epoch: 2, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.248 Vali Acc: 0.921 Test Loss: 0.248 Test Acc: 0.921
Validation loss decreased (-0.877068 --> -0.920524).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1269209
	speed: 0.1136s/iter; left time: 5209.1060s
	iters: 200, epoch: 3 | loss: 0.1377907
	speed: 0.0206s/iter; left time: 941.9423s
	iters: 300, epoch: 3 | loss: 0.0313400
	speed: 0.0211s/iter; left time: 965.6718s
	iters: 400, epoch: 3 | loss: 0.1114295
	speed: 0.0207s/iter; left time: 945.3570s
Epoch: 3 cost time: 10.179710865020752
Epoch: 3, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.920524 --> -0.951113).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0851333
	speed: 0.1109s/iter; left time: 5034.8101s
	iters: 200, epoch: 4 | loss: 0.0546707
	speed: 0.0202s/iter; left time: 913.2433s
	iters: 300, epoch: 4 | loss: 0.1610344
	speed: 0.0205s/iter; left time: 928.5372s
	iters: 400, epoch: 4 | loss: 0.0495058
	speed: 0.0200s/iter; left time: 903.4927s
Epoch: 4 cost time: 9.805680990219116
Epoch: 4, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
Validation loss decreased (-0.951113 --> -0.959975).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0685783
	speed: 0.1072s/iter; left time: 4814.0619s
	iters: 200, epoch: 5 | loss: 0.0942627
	speed: 0.0205s/iter; left time: 919.5215s
	iters: 300, epoch: 5 | loss: 0.0255359
	speed: 0.0216s/iter; left time: 966.5391s
	iters: 400, epoch: 5 | loss: 0.0354384
	speed: 0.0199s/iter; left time: 889.2336s
Epoch: 5 cost time: 9.950589418411255
Epoch: 5, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.959975 --> -0.962263).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0874027
	speed: 0.1055s/iter; left time: 4690.0644s
	iters: 200, epoch: 6 | loss: 0.0064667
	speed: 0.0203s/iter; left time: 901.4421s
	iters: 300, epoch: 6 | loss: 0.0267451
	speed: 0.0207s/iter; left time: 916.3172s
	iters: 400, epoch: 6 | loss: 0.0546754
	speed: 0.0201s/iter; left time: 887.8236s
Epoch: 6 cost time: 9.916183710098267
Epoch: 6, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.962263 --> -0.971983).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0115342
	speed: 0.1054s/iter; left time: 4635.3235s
	iters: 200, epoch: 7 | loss: 0.0185287
	speed: 0.0213s/iter; left time: 935.1185s
	iters: 300, epoch: 7 | loss: 0.0311949
	speed: 0.0215s/iter; left time: 940.5989s
	iters: 400, epoch: 7 | loss: 0.0573329
	speed: 0.0209s/iter; left time: 911.8709s
Epoch: 7 cost time: 10.362785816192627
Epoch: 7, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.6756101
	speed: 0.1247s/iter; left time: 5425.4591s
	iters: 200, epoch: 8 | loss: 0.0578889
	speed: 0.0212s/iter; left time: 920.0296s
	iters: 300, epoch: 8 | loss: 0.0204592
	speed: 0.0253s/iter; left time: 1096.2877s
	iters: 400, epoch: 8 | loss: 0.0732092
	speed: 0.0248s/iter; left time: 1072.0814s
Epoch: 8 cost time: 11.531414985656738
Epoch: 8, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0344197
	speed: 0.1296s/iter; left time: 5577.7970s
	iters: 200, epoch: 9 | loss: 0.0080133
	speed: 0.0206s/iter; left time: 885.5498s
	iters: 300, epoch: 9 | loss: 0.1050526
	speed: 0.0226s/iter; left time: 969.6900s
	iters: 400, epoch: 9 | loss: 0.0335892
	speed: 0.0225s/iter; left time: 961.4050s
Epoch: 9 cost time: 10.996842384338379
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0028673
	speed: 0.1136s/iter; left time: 4839.1047s
	iters: 200, epoch: 10 | loss: 0.0308480
	speed: 0.0211s/iter; left time: 896.6336s
	iters: 300, epoch: 10 | loss: 0.0194481
	speed: 0.0223s/iter; left time: 946.3475s
	iters: 400, epoch: 10 | loss: 0.0157124
	speed: 0.0215s/iter; left time: 909.0185s
Epoch: 10 cost time: 10.602890491485596
Epoch: 10, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0206091
	speed: 0.1160s/iter; left time: 4885.6987s
	iters: 200, epoch: 11 | loss: 0.0087836
	speed: 0.0226s/iter; left time: 949.1811s
	iters: 300, epoch: 11 | loss: 0.0183017
	speed: 0.0228s/iter; left time: 956.1317s
	iters: 400, epoch: 11 | loss: 0.0146780
	speed: 0.0237s/iter; left time: 989.4250s
Epoch: 11 cost time: 11.270604610443115
Epoch: 11, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.971983 --> -0.972841).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0131784
	speed: 0.1235s/iter; left time: 5142.5655s
	iters: 200, epoch: 12 | loss: 0.0018937
	speed: 0.0226s/iter; left time: 940.6775s
	iters: 300, epoch: 12 | loss: 0.0093691
	speed: 0.0231s/iter; left time: 956.6390s
	iters: 400, epoch: 12 | loss: 0.0187963
	speed: 0.0231s/iter; left time: 955.1002s
Epoch: 12 cost time: 11.259263515472412
Epoch: 12, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0929797
	speed: 0.1211s/iter; left time: 4986.6051s
	iters: 200, epoch: 13 | loss: 0.0156737
	speed: 0.0234s/iter; left time: 961.1041s
	iters: 300, epoch: 13 | loss: 0.0029570
	speed: 0.0221s/iter; left time: 906.5553s
	iters: 400, epoch: 13 | loss: 0.0606060
	speed: 0.0222s/iter; left time: 908.6686s
Epoch: 13 cost time: 11.057180643081665
Epoch: 13, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0009107
	speed: 0.1240s/iter; left time: 5046.5443s
	iters: 200, epoch: 14 | loss: 0.0058275
	speed: 0.0208s/iter; left time: 845.9615s
	iters: 300, epoch: 14 | loss: 0.0442234
	speed: 0.0216s/iter; left time: 875.9349s
	iters: 400, epoch: 14 | loss: 0.0051606
	speed: 0.0218s/iter; left time: 880.5833s
Epoch: 14 cost time: 10.594099998474121
Epoch: 14, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0718305
	speed: 0.1190s/iter; left time: 4786.4413s
	iters: 200, epoch: 15 | loss: 0.0104064
	speed: 0.0222s/iter; left time: 890.1906s
	iters: 300, epoch: 15 | loss: 0.0005724
	speed: 0.0225s/iter; left time: 899.9559s
	iters: 400, epoch: 15 | loss: 0.0463786
	speed: 0.0223s/iter; left time: 890.8255s
Epoch: 15 cost time: 11.086437463760376
Epoch: 15, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0150424
	speed: 0.1200s/iter; left time: 4770.3656s
	iters: 200, epoch: 16 | loss: 0.0306481
	speed: 0.0220s/iter; left time: 873.1597s
	iters: 300, epoch: 16 | loss: 0.0841065
	speed: 0.0227s/iter; left time: 896.1785s
	iters: 400, epoch: 16 | loss: 0.0008123
	speed: 0.0237s/iter; left time: 937.2396s
Epoch: 16 cost time: 11.172629356384277
Epoch: 16, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0131860
	speed: 0.1218s/iter; left time: 4787.3976s
	iters: 200, epoch: 17 | loss: 0.0114970
	speed: 0.0232s/iter; left time: 910.3670s
	iters: 300, epoch: 17 | loss: 0.0278918
	speed: 0.0229s/iter; left time: 897.1344s
	iters: 400, epoch: 17 | loss: 0.0023807
	speed: 0.0243s/iter; left time: 947.3931s
Epoch: 17 cost time: 11.443527698516846
Epoch: 17, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0193150
	speed: 0.1239s/iter; left time: 4809.4942s
	iters: 200, epoch: 18 | loss: 0.0008291
	speed: 0.0236s/iter; left time: 913.8772s
	iters: 300, epoch: 18 | loss: 0.0695138
	speed: 0.0238s/iter; left time: 917.8503s
	iters: 400, epoch: 18 | loss: 0.0051347
	speed: 0.0231s/iter; left time: 889.8308s
Epoch: 18 cost time: 11.513721942901611
Epoch: 18, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0017613
	speed: 0.1192s/iter; left time: 4570.5372s
	iters: 200, epoch: 19 | loss: 0.0039897
	speed: 0.0216s/iter; left time: 824.7279s
	iters: 300, epoch: 19 | loss: 0.0196345
	speed: 0.0213s/iter; left time: 813.4179s
	iters: 400, epoch: 19 | loss: 0.0215091
	speed: 0.0218s/iter; left time: 829.1335s
Epoch: 19 cost time: 10.63830828666687
Epoch: 19, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
Validation loss decreased (-0.972841 --> -0.974270).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0883223
	speed: 0.1166s/iter; left time: 4416.3527s
	iters: 200, epoch: 20 | loss: 0.0001252
	speed: 0.0232s/iter; left time: 875.5246s
	iters: 300, epoch: 20 | loss: 0.0458440
	speed: 0.0219s/iter; left time: 825.1449s
	iters: 400, epoch: 20 | loss: 0.0618162
	speed: 0.0224s/iter; left time: 843.2453s
Epoch: 20 cost time: 10.87939715385437
Epoch: 20, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.974270 --> -0.979130).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0123089
	speed: 0.1117s/iter; left time: 4179.1916s
	iters: 200, epoch: 21 | loss: 0.0684534
	speed: 0.0214s/iter; left time: 797.1554s
	iters: 300, epoch: 21 | loss: 0.0092615
	speed: 0.0216s/iter; left time: 803.2562s
	iters: 400, epoch: 21 | loss: 0.0021169
	speed: 0.0223s/iter; left time: 829.1297s
Epoch: 21 cost time: 10.643489599227905
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0009418
	speed: 0.1176s/iter; left time: 4347.2868s
	iters: 200, epoch: 22 | loss: 0.0027027
	speed: 0.0229s/iter; left time: 845.6188s
	iters: 300, epoch: 22 | loss: 0.0001225
	speed: 0.0224s/iter; left time: 823.6062s
	iters: 400, epoch: 22 | loss: 0.0328312
	speed: 0.0239s/iter; left time: 876.6546s
Epoch: 22 cost time: 11.068947315216064
Epoch: 22, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0208060
	speed: 0.1224s/iter; left time: 4465.4861s
	iters: 200, epoch: 23 | loss: 0.0599752
	speed: 0.0227s/iter; left time: 824.4950s
	iters: 300, epoch: 23 | loss: 0.0122213
	speed: 0.0231s/iter; left time: 838.0120s
	iters: 400, epoch: 23 | loss: 0.1065615
	speed: 0.0231s/iter; left time: 837.5196s
Epoch: 23 cost time: 11.26807188987732
Epoch: 23, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0047223
	speed: 0.1257s/iter; left time: 4526.9731s
	iters: 200, epoch: 24 | loss: 0.0156350
	speed: 0.0228s/iter; left time: 819.7563s
	iters: 300, epoch: 24 | loss: 0.0051460
	speed: 0.0233s/iter; left time: 834.5955s
	iters: 400, epoch: 24 | loss: 0.1485832
	speed: 0.0229s/iter; left time: 816.6597s
Epoch: 24 cost time: 11.022707462310791
Epoch: 24, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0006564
	speed: 0.1212s/iter; left time: 4308.4579s
	iters: 200, epoch: 25 | loss: 0.0059538
	speed: 0.0240s/iter; left time: 851.1784s
	iters: 300, epoch: 25 | loss: 0.1055370
	speed: 0.0215s/iter; left time: 759.7906s
	iters: 400, epoch: 25 | loss: 0.0076797
	speed: 0.0224s/iter; left time: 790.8185s
Epoch: 25 cost time: 11.078718662261963
Epoch: 25, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0138669
	speed: 0.1164s/iter; left time: 4084.2214s
	iters: 200, epoch: 26 | loss: 0.0051000
	speed: 0.0206s/iter; left time: 721.7535s
	iters: 300, epoch: 26 | loss: 0.0081383
	speed: 0.0209s/iter; left time: 727.5595s
	iters: 400, epoch: 26 | loss: 0.0218778
	speed: 0.0213s/iter; left time: 740.7504s
Epoch: 26 cost time: 10.584839820861816
Epoch: 26, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0223199
	speed: 0.1225s/iter; left time: 4238.8637s
	iters: 200, epoch: 27 | loss: 0.0002152
	speed: 0.0223s/iter; left time: 770.6516s
	iters: 300, epoch: 27 | loss: 0.0063104
	speed: 0.0231s/iter; left time: 793.8916s
	iters: 400, epoch: 27 | loss: 0.1094308
	speed: 0.0235s/iter; left time: 807.5656s
Epoch: 27 cost time: 11.142183303833008
Epoch: 27, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0007034
	speed: 0.1270s/iter; left time: 4335.1480s
	iters: 200, epoch: 28 | loss: 0.0119090
	speed: 0.0231s/iter; left time: 785.0552s
	iters: 300, epoch: 28 | loss: 0.0096848
	speed: 0.0225s/iter; left time: 764.3641s
	iters: 400, epoch: 28 | loss: 0.0090623
	speed: 0.0223s/iter; left time: 754.1435s
Epoch: 28 cost time: 11.19727897644043
Epoch: 28, Steps: 469 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0057598
	speed: 0.1171s/iter; left time: 3941.8761s
	iters: 200, epoch: 29 | loss: 0.0075691
	speed: 0.0218s/iter; left time: 733.2681s
	iters: 300, epoch: 29 | loss: 0.0009935
	speed: 0.0223s/iter; left time: 746.6207s
	iters: 400, epoch: 29 | loss: 0.0011480
	speed: 0.0228s/iter; left time: 759.2951s
Epoch: 29 cost time: 10.81381607055664
Epoch: 29, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0199532
	speed: 0.1201s/iter; left time: 3987.3099s
	iters: 200, epoch: 30 | loss: 0.0023812
	speed: 0.0219s/iter; left time: 724.9893s
	iters: 300, epoch: 30 | loss: 0.0005005
	speed: 0.0214s/iter; left time: 705.0778s
	iters: 400, epoch: 30 | loss: 0.0027252
	speed: 0.0211s/iter; left time: 693.2346s
Epoch: 30 cost time: 10.635375022888184
Epoch: 30, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 22946
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6275648
	speed: 0.0416s/iter; left time: 1947.3190s
	iters: 200, epoch: 1 | loss: 0.8092953
	speed: 0.0223s/iter; left time: 1041.7992s
	iters: 300, epoch: 1 | loss: 0.3835081
	speed: 0.0224s/iter; left time: 1044.2421s
	iters: 400, epoch: 1 | loss: 0.6000041
	speed: 0.0227s/iter; left time: 1055.8221s
Epoch: 1 cost time: 12.427553653717041
Epoch: 1, Steps: 469 | Train Loss: 0.943 Vali Loss: 0.402 Vali Acc: 0.888 Test Loss: 0.402 Test Acc: 0.888
Validation loss decreased (inf --> -0.887932).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3796532
	speed: 0.1128s/iter; left time: 5224.7072s
	iters: 200, epoch: 2 | loss: 0.4288199
	speed: 0.0223s/iter; left time: 1032.3547s
	iters: 300, epoch: 2 | loss: 0.1580887
	speed: 0.0226s/iter; left time: 1042.2504s
	iters: 400, epoch: 2 | loss: 0.1287925
	speed: 0.0219s/iter; left time: 1007.8763s
Epoch: 2 cost time: 10.789162158966064
Epoch: 2, Steps: 469 | Train Loss: 0.207 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
Validation loss decreased (-0.887932 --> -0.949112).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0533875
	speed: 0.1140s/iter; left time: 5226.6977s
	iters: 200, epoch: 3 | loss: 0.0729485
	speed: 0.0220s/iter; left time: 1005.5216s
	iters: 300, epoch: 3 | loss: 0.0376937
	speed: 0.0219s/iter; left time: 1001.1608s
	iters: 400, epoch: 3 | loss: 0.0745281
	speed: 0.0219s/iter; left time: 997.1882s
Epoch: 3 cost time: 10.687645673751831
Epoch: 3, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.949112 --> -0.962263).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0417628
	speed: 0.1121s/iter; left time: 5087.0652s
	iters: 200, epoch: 4 | loss: 0.0177429
	speed: 0.0213s/iter; left time: 962.7923s
	iters: 300, epoch: 4 | loss: 0.0563964
	speed: 0.0208s/iter; left time: 939.4119s
	iters: 400, epoch: 4 | loss: 0.0302224
	speed: 0.0215s/iter; left time: 967.9050s
Epoch: 4 cost time: 10.347684144973755
Epoch: 4, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.962263 --> -0.964836).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0488315
	speed: 0.1103s/iter; left time: 4954.6461s
	iters: 200, epoch: 5 | loss: 0.0247852
	speed: 0.0208s/iter; left time: 931.1088s
	iters: 300, epoch: 5 | loss: 0.0072347
	speed: 0.0211s/iter; left time: 943.9519s
	iters: 400, epoch: 5 | loss: 0.0272200
	speed: 0.0210s/iter; left time: 935.4881s
Epoch: 5 cost time: 10.187740087509155
Epoch: 5, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0784531
	speed: 0.1147s/iter; left time: 5100.6280s
	iters: 200, epoch: 6 | loss: 0.0064642
	speed: 0.0223s/iter; left time: 987.3976s
	iters: 300, epoch: 6 | loss: 0.0241148
	speed: 0.0216s/iter; left time: 956.1109s
	iters: 400, epoch: 6 | loss: 0.0090840
	speed: 0.0223s/iter; left time: 982.6807s
Epoch: 6 cost time: 10.688438415527344
Epoch: 6, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.964836 --> -0.972555).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0081258
	speed: 0.1225s/iter; left time: 5389.5677s
	iters: 200, epoch: 7 | loss: 0.0153173
	speed: 0.0220s/iter; left time: 966.5236s
	iters: 300, epoch: 7 | loss: 0.0095486
	speed: 0.0230s/iter; left time: 1006.7093s
	iters: 400, epoch: 7 | loss: 0.0093644
	speed: 0.0224s/iter; left time: 979.5434s
Epoch: 7 cost time: 10.912176847457886
Epoch: 7, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 1.1272290
	speed: 0.1170s/iter; left time: 5090.5539s
	iters: 200, epoch: 8 | loss: 0.0733378
	speed: 0.0216s/iter; left time: 936.6870s
	iters: 300, epoch: 8 | loss: 0.0136606
	speed: 0.0225s/iter; left time: 975.4603s
	iters: 400, epoch: 8 | loss: 0.0203001
	speed: 0.0220s/iter; left time: 952.7304s
Epoch: 8 cost time: 10.6309335231781
Epoch: 8, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0181674
	speed: 0.1094s/iter; left time: 4707.9033s
	iters: 200, epoch: 9 | loss: 0.0543615
	speed: 0.0219s/iter; left time: 940.9153s
	iters: 300, epoch: 9 | loss: 0.0409182
	speed: 0.0225s/iter; left time: 962.8526s
	iters: 400, epoch: 9 | loss: 0.0033219
	speed: 0.0231s/iter; left time: 987.6011s
Epoch: 9 cost time: 10.80258846282959
Epoch: 9, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0086522
	speed: 0.1119s/iter; left time: 4765.5524s
	iters: 200, epoch: 10 | loss: 0.1273359
	speed: 0.0211s/iter; left time: 894.8880s
	iters: 300, epoch: 10 | loss: 0.0056755
	speed: 0.0212s/iter; left time: 897.6815s
	iters: 400, epoch: 10 | loss: 0.0191633
	speed: 0.0215s/iter; left time: 910.0866s
Epoch: 10 cost time: 10.365343809127808
Epoch: 10, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973698).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0074801
	speed: 0.1203s/iter; left time: 5065.5678s
	iters: 200, epoch: 11 | loss: 0.0053759
	speed: 0.0221s/iter; left time: 927.4996s
	iters: 300, epoch: 11 | loss: 0.0589109
	speed: 0.0235s/iter; left time: 984.5425s
	iters: 400, epoch: 11 | loss: 0.0055426
	speed: 0.0224s/iter; left time: 937.1234s
Epoch: 11 cost time: 11.112535953521729
Epoch: 11, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0104826
	speed: 0.1214s/iter; left time: 5057.0398s
	iters: 200, epoch: 12 | loss: 0.0006928
	speed: 0.0225s/iter; left time: 932.8857s
	iters: 300, epoch: 12 | loss: 0.0539075
	speed: 0.0215s/iter; left time: 891.9477s
	iters: 400, epoch: 12 | loss: 0.0011421
	speed: 0.0214s/iter; left time: 885.6743s
Epoch: 12 cost time: 10.73582911491394
Epoch: 12, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2153732
	speed: 0.1181s/iter; left time: 4860.9577s
	iters: 200, epoch: 13 | loss: 0.0228455
	speed: 0.0210s/iter; left time: 862.9733s
	iters: 300, epoch: 13 | loss: 0.0064626
	speed: 0.0217s/iter; left time: 887.3135s
	iters: 400, epoch: 13 | loss: 0.0081612
	speed: 0.0206s/iter; left time: 842.9365s
Epoch: 13 cost time: 10.500308513641357
Epoch: 13, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.975127).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0013966
	speed: 0.1143s/iter; left time: 4652.4754s
	iters: 200, epoch: 14 | loss: 0.0088627
	speed: 0.0203s/iter; left time: 824.9970s
	iters: 300, epoch: 14 | loss: 0.0609998
	speed: 0.0199s/iter; left time: 804.2704s
	iters: 400, epoch: 14 | loss: 0.0033230
	speed: 0.0206s/iter; left time: 833.8113s
Epoch: 14 cost time: 9.976255178451538
Epoch: 14, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
Validation loss decreased (-0.975127 --> -0.976271).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0022235
	speed: 0.1086s/iter; left time: 4371.1382s
	iters: 200, epoch: 15 | loss: 0.1917983
	speed: 0.0210s/iter; left time: 841.8465s
	iters: 300, epoch: 15 | loss: 0.0005776
	speed: 0.0211s/iter; left time: 844.9324s
	iters: 400, epoch: 15 | loss: 0.0004080
	speed: 0.0213s/iter; left time: 851.2207s
Epoch: 15 cost time: 10.429387331008911
Epoch: 15, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.978558).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2438299
	speed: 0.1168s/iter; left time: 4646.1455s
	iters: 200, epoch: 16 | loss: 0.0559918
	speed: 0.0218s/iter; left time: 865.6658s
	iters: 300, epoch: 16 | loss: 0.0579128
	speed: 0.0229s/iter; left time: 904.5249s
	iters: 400, epoch: 16 | loss: 0.0002885
	speed: 0.0225s/iter; left time: 887.8932s
Epoch: 16 cost time: 10.967247009277344
Epoch: 16, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0121105
	speed: 0.1231s/iter; left time: 4836.8651s
	iters: 200, epoch: 17 | loss: 0.0149597
	speed: 0.0214s/iter; left time: 839.7234s
	iters: 300, epoch: 17 | loss: 0.0771093
	speed: 0.0218s/iter; left time: 852.0443s
	iters: 400, epoch: 17 | loss: 0.0020970
	speed: 0.0216s/iter; left time: 840.6530s
Epoch: 17 cost time: 10.700284481048584
Epoch: 17, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.3165037
	speed: 0.1235s/iter; left time: 4794.2073s
	iters: 200, epoch: 18 | loss: 0.0022660
	speed: 0.0197s/iter; left time: 764.3509s
	iters: 300, epoch: 18 | loss: 0.0474722
	speed: 0.0217s/iter; left time: 838.1328s
	iters: 400, epoch: 18 | loss: 0.0123379
	speed: 0.0215s/iter; left time: 828.3054s
Epoch: 18 cost time: 10.509777307510376
Epoch: 18, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0009436
	speed: 0.1102s/iter; left time: 4228.2977s
	iters: 200, epoch: 19 | loss: 0.0006531
	speed: 0.0211s/iter; left time: 808.8961s
	iters: 300, epoch: 19 | loss: 0.0073696
	speed: 0.0211s/iter; left time: 804.2266s
	iters: 400, epoch: 19 | loss: 0.0018323
	speed: 0.0213s/iter; left time: 809.3261s
Epoch: 19 cost time: 10.258976936340332
Epoch: 19, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.978558).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0114501
	speed: 0.1121s/iter; left time: 4248.7774s
	iters: 200, epoch: 20 | loss: 0.0009837
	speed: 0.0221s/iter; left time: 836.9133s
	iters: 300, epoch: 20 | loss: 0.0376691
	speed: 0.0222s/iter; left time: 838.5496s
	iters: 400, epoch: 20 | loss: 0.0043820
	speed: 0.0227s/iter; left time: 852.9765s
Epoch: 20 cost time: 10.588053226470947
Epoch: 20, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0041476
	speed: 0.1184s/iter; left time: 4430.6612s
	iters: 200, epoch: 21 | loss: 0.0029996
	speed: 0.0214s/iter; left time: 799.9473s
	iters: 300, epoch: 21 | loss: 0.0010986
	speed: 0.0225s/iter; left time: 837.4423s
	iters: 400, epoch: 21 | loss: 0.0082412
	speed: 0.0220s/iter; left time: 816.8827s
Epoch: 21 cost time: 10.662501096725464
Epoch: 21, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0022294
	speed: 0.1266s/iter; left time: 4678.5457s
	iters: 200, epoch: 22 | loss: 0.0013807
	speed: 0.0208s/iter; left time: 766.8803s
	iters: 300, epoch: 22 | loss: 0.0004313
	speed: 0.0224s/iter; left time: 822.6738s
	iters: 400, epoch: 22 | loss: 0.0021030
	speed: 0.0198s/iter; left time: 726.9061s
Epoch: 22 cost time: 10.418689250946045
Epoch: 22, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0037538
	speed: 0.1126s/iter; left time: 4106.8883s
	iters: 200, epoch: 23 | loss: 0.0004831
	speed: 0.0208s/iter; left time: 755.6675s
	iters: 300, epoch: 23 | loss: 0.0167398
	speed: 0.0211s/iter; left time: 765.6709s
	iters: 400, epoch: 23 | loss: 0.0199499
	speed: 0.0231s/iter; left time: 836.6428s
Epoch: 23 cost time: 10.513252019882202
Epoch: 23, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
Validation loss decreased (-0.978558 --> -0.979130).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0054806
	speed: 0.1100s/iter; left time: 3959.8687s
	iters: 200, epoch: 24 | loss: 0.1028776
	speed: 0.0206s/iter; left time: 741.0629s
	iters: 300, epoch: 24 | loss: 0.0142191
	speed: 0.0212s/iter; left time: 758.9192s
	iters: 400, epoch: 24 | loss: 0.0975747
	speed: 0.0214s/iter; left time: 763.6638s
Epoch: 24 cost time: 10.254735469818115
Epoch: 24, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0013716
	speed: 0.1133s/iter; left time: 4028.2154s
	iters: 200, epoch: 25 | loss: 0.0018615
	speed: 0.0212s/iter; left time: 752.7513s
	iters: 300, epoch: 25 | loss: 0.0451334
	speed: 0.0221s/iter; left time: 780.8334s
	iters: 400, epoch: 25 | loss: 0.0015644
	speed: 0.0228s/iter; left time: 804.1915s
Epoch: 25 cost time: 10.679567575454712
Epoch: 25, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0009403
	speed: 0.1135s/iter; left time: 3981.0321s
	iters: 200, epoch: 26 | loss: 0.0005318
	speed: 0.0239s/iter; left time: 836.1655s
	iters: 300, epoch: 26 | loss: 0.0003061
	speed: 0.0215s/iter; left time: 748.9427s
	iters: 400, epoch: 26 | loss: 0.0071085
	speed: 0.0200s/iter; left time: 697.2305s
Epoch: 26 cost time: 10.702110290527344
Epoch: 26, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0564975
	speed: 0.1216s/iter; left time: 4207.6789s
	iters: 200, epoch: 27 | loss: 0.0023649
	speed: 0.0228s/iter; left time: 786.0598s
	iters: 300, epoch: 27 | loss: 0.0055589
	speed: 0.0235s/iter; left time: 808.4504s
	iters: 400, epoch: 27 | loss: 0.0526184
	speed: 0.0224s/iter; left time: 768.1019s
Epoch: 27 cost time: 10.975965976715088
Epoch: 27, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0010112
	speed: 0.1219s/iter; left time: 4162.3078s
	iters: 200, epoch: 28 | loss: 0.0571343
	speed: 0.0218s/iter; left time: 741.8346s
	iters: 300, epoch: 28 | loss: 0.0071280
	speed: 0.0210s/iter; left time: 714.1815s
	iters: 400, epoch: 28 | loss: 0.0017847
	speed: 0.0211s/iter; left time: 714.4083s
Epoch: 28 cost time: 10.483020544052124
Epoch: 28, Steps: 469 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0085847
	speed: 0.1114s/iter; left time: 3751.6495s
	iters: 200, epoch: 29 | loss: 0.0123552
	speed: 0.0205s/iter; left time: 688.4690s
	iters: 300, epoch: 29 | loss: 0.0003622
	speed: 0.0204s/iter; left time: 684.1593s
	iters: 400, epoch: 29 | loss: 0.0022676
	speed: 0.0211s/iter; left time: 702.9655s
Epoch: 29 cost time: 10.224598407745361
Epoch: 29, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0014294
	speed: 0.1154s/iter; left time: 3830.2911s
	iters: 200, epoch: 30 | loss: 0.1861352
	speed: 0.0222s/iter; left time: 735.3290s
	iters: 300, epoch: 30 | loss: 0.0011492
	speed: 0.0211s/iter; left time: 695.7107s
	iters: 400, epoch: 30 | loss: 0.0022770
	speed: 0.0195s/iter; left time: 641.9679s
Epoch: 30 cost time: 10.467636585235596
Epoch: 30, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0036315
	speed: 0.1151s/iter; left time: 3766.2777s
	iters: 200, epoch: 31 | loss: 0.0058080
	speed: 0.0225s/iter; left time: 735.5343s
	iters: 300, epoch: 31 | loss: 0.0007844
	speed: 0.0212s/iter; left time: 691.1866s
	iters: 400, epoch: 31 | loss: 0.0071118
	speed: 0.0217s/iter; left time: 703.2712s
Epoch: 31 cost time: 10.75888204574585
Epoch: 31, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.979 Test Loss: 0.133 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.1080586
	speed: 0.1223s/iter; left time: 3946.4323s
	iters: 200, epoch: 32 | loss: 0.0017202
	speed: 0.0227s/iter; left time: 729.5265s
	iters: 300, epoch: 32 | loss: 0.0024259
	speed: 0.0225s/iter; left time: 722.1723s
	iters: 400, epoch: 32 | loss: 0.0515048
	speed: 0.0205s/iter; left time: 655.6886s
Epoch: 32 cost time: 10.701279878616333
Epoch: 32, Steps: 469 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0076519
	speed: 0.1255s/iter; left time: 3990.6963s
	iters: 200, epoch: 33 | loss: 0.0073386
	speed: 0.0217s/iter; left time: 686.8995s
	iters: 300, epoch: 33 | loss: 0.0003137
	speed: 0.0220s/iter; left time: 694.5514s
	iters: 400, epoch: 33 | loss: 0.4092315
	speed: 0.0236s/iter; left time: 743.7715s
Epoch: 33 cost time: 10.949020624160767
Epoch: 33, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 22946
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.4290981
	speed: 0.0382s/iter; left time: 1787.0481s
	iters: 200, epoch: 1 | loss: 1.0253688
	speed: 0.0219s/iter; left time: 1024.3209s
	iters: 300, epoch: 1 | loss: 0.5359583
	speed: 0.0213s/iter; left time: 994.4941s
	iters: 400, epoch: 1 | loss: 0.4710723
	speed: 0.0213s/iter; left time: 989.7400s
Epoch: 1 cost time: 11.936093807220459
Epoch: 1, Steps: 469 | Train Loss: 1.061 Vali Loss: 0.543 Vali Acc: 0.836 Test Loss: 0.543 Test Acc: 0.836
Validation loss decreased (inf --> -0.836187).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2653295
	speed: 0.1109s/iter; left time: 5139.0022s
	iters: 200, epoch: 2 | loss: 0.3435973
	speed: 0.0231s/iter; left time: 1067.5164s
	iters: 300, epoch: 2 | loss: 0.4491421
	speed: 0.0224s/iter; left time: 1035.1353s
	iters: 400, epoch: 2 | loss: 0.3242534
	speed: 0.0213s/iter; left time: 980.4363s
Epoch: 2 cost time: 10.5773606300354
Epoch: 2, Steps: 469 | Train Loss: 0.336 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
Validation loss decreased (-0.836187 --> -0.883358).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3352309
	speed: 0.1213s/iter; left time: 5562.1088s
	iters: 200, epoch: 3 | loss: 0.1628097
	speed: 0.0207s/iter; left time: 948.9688s
	iters: 300, epoch: 3 | loss: 0.1590106
	speed: 0.0215s/iter; left time: 982.4701s
	iters: 400, epoch: 3 | loss: 0.0475316
	speed: 0.0217s/iter; left time: 988.5221s
Epoch: 3 cost time: 10.511484384536743
Epoch: 3, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.287 Vali Acc: 0.924 Test Loss: 0.287 Test Acc: 0.924
Validation loss decreased (-0.883358 --> -0.923954).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1203763
	speed: 0.1179s/iter; left time: 5353.5653s
	iters: 200, epoch: 4 | loss: 0.1293379
	speed: 0.0221s/iter; left time: 1000.4879s
	iters: 300, epoch: 4 | loss: 0.1016295
	speed: 0.0217s/iter; left time: 979.6837s
	iters: 400, epoch: 4 | loss: 0.2444833
	speed: 0.0213s/iter; left time: 960.1768s
Epoch: 4 cost time: 10.633277416229248
Epoch: 4, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
Validation loss decreased (-0.923954 --> -0.943394).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0737453
	speed: 0.1069s/iter; left time: 4803.1442s
	iters: 200, epoch: 5 | loss: 0.1750822
	speed: 0.0210s/iter; left time: 941.5275s
	iters: 300, epoch: 5 | loss: 0.0431182
	speed: 0.0215s/iter; left time: 959.5694s
	iters: 400, epoch: 5 | loss: 0.2919180
	speed: 0.0209s/iter; left time: 934.6953s
Epoch: 5 cost time: 10.418928384780884
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.943394 --> -0.949684).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1860464
	speed: 0.1128s/iter; left time: 5014.0649s
	iters: 200, epoch: 6 | loss: 0.1674675
	speed: 0.0213s/iter; left time: 944.9652s
	iters: 300, epoch: 6 | loss: 0.7383975
	speed: 0.0219s/iter; left time: 970.0096s
	iters: 400, epoch: 6 | loss: 0.0294170
	speed: 0.0209s/iter; left time: 921.0043s
Epoch: 6 cost time: 10.397368907928467
Epoch: 6, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1841684
	speed: 0.1148s/iter; left time: 5050.3189s
	iters: 200, epoch: 7 | loss: 0.0766796
	speed: 0.0214s/iter; left time: 938.8861s
	iters: 300, epoch: 7 | loss: 0.0369458
	speed: 0.0222s/iter; left time: 970.1693s
	iters: 400, epoch: 7 | loss: 0.0168790
	speed: 0.0223s/iter; left time: 974.1297s
Epoch: 7 cost time: 10.688985347747803
Epoch: 7, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.949684 --> -0.955687).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1062119
	speed: 0.1223s/iter; left time: 5324.1683s
	iters: 200, epoch: 8 | loss: 0.0438066
	speed: 0.0225s/iter; left time: 978.2438s
	iters: 300, epoch: 8 | loss: 0.0406659
	speed: 0.0225s/iter; left time: 974.7871s
	iters: 400, epoch: 8 | loss: 0.0959253
	speed: 0.0220s/iter; left time: 951.0172s
Epoch: 8 cost time: 10.83903169631958
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.955687 --> -0.961691).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1055137
	speed: 0.1109s/iter; left time: 4774.4440s
	iters: 200, epoch: 9 | loss: 0.0847202
	speed: 0.0215s/iter; left time: 923.9391s
	iters: 300, epoch: 9 | loss: 0.2673811
	speed: 0.0219s/iter; left time: 939.8220s
	iters: 400, epoch: 9 | loss: 0.0745884
	speed: 0.0221s/iter; left time: 944.3293s
Epoch: 9 cost time: 10.632673025131226
Epoch: 9, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.961691 --> -0.967409).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0863608
	speed: 0.1135s/iter; left time: 4834.1353s
	iters: 200, epoch: 10 | loss: 0.0290942
	speed: 0.0211s/iter; left time: 896.1544s
	iters: 300, epoch: 10 | loss: 0.0074648
	speed: 0.0208s/iter; left time: 883.2388s
	iters: 400, epoch: 10 | loss: 0.0819117
	speed: 0.0210s/iter; left time: 886.5295s
Epoch: 10 cost time: 10.392488241195679
Epoch: 10, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.967409 --> -0.968552).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0272342
	speed: 0.1151s/iter; left time: 4845.3856s
	iters: 200, epoch: 11 | loss: 0.0749825
	speed: 0.0211s/iter; left time: 887.3279s
	iters: 300, epoch: 11 | loss: 0.0274955
	speed: 0.0215s/iter; left time: 901.1053s
	iters: 400, epoch: 11 | loss: 0.0293378
	speed: 0.0230s/iter; left time: 960.0846s
Epoch: 11 cost time: 10.68027400970459
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0182255
	speed: 0.1172s/iter; left time: 4882.4402s
	iters: 200, epoch: 12 | loss: 0.1325587
	speed: 0.0210s/iter; left time: 871.4034s
	iters: 300, epoch: 12 | loss: 0.0713632
	speed: 0.0209s/iter; left time: 865.7845s
	iters: 400, epoch: 12 | loss: 0.0389942
	speed: 0.0207s/iter; left time: 856.3318s
Epoch: 12 cost time: 10.320035696029663
Epoch: 12, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.968838).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.2819780
	speed: 0.1103s/iter; left time: 4540.9247s
	iters: 200, epoch: 13 | loss: 0.0644170
	speed: 0.0216s/iter; left time: 887.7111s
	iters: 300, epoch: 13 | loss: 0.0857003
	speed: 0.0232s/iter; left time: 949.0685s
	iters: 400, epoch: 13 | loss: 0.0662776
	speed: 0.0226s/iter; left time: 922.7914s
Epoch: 13 cost time: 10.84952998161316
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.968838 --> -0.969410).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0454841
	speed: 0.1191s/iter; left time: 4849.2647s
	iters: 200, epoch: 14 | loss: 0.0202134
	speed: 0.0222s/iter; left time: 901.0409s
	iters: 300, epoch: 14 | loss: 0.2037914
	speed: 0.0227s/iter; left time: 918.3971s
	iters: 400, epoch: 14 | loss: 0.0151198
	speed: 0.0213s/iter; left time: 861.3730s
Epoch: 14 cost time: 10.783335447311401
Epoch: 14, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0205324
	speed: 0.1151s/iter; left time: 4631.3352s
	iters: 200, epoch: 15 | loss: 0.1093662
	speed: 0.0220s/iter; left time: 881.2195s
	iters: 300, epoch: 15 | loss: 0.0563961
	speed: 0.0216s/iter; left time: 866.4529s
	iters: 400, epoch: 15 | loss: 0.1496896
	speed: 0.0217s/iter; left time: 864.9712s
Epoch: 15 cost time: 10.56843376159668
Epoch: 15, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971983).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1041289
	speed: 0.1138s/iter; left time: 4525.2343s
	iters: 200, epoch: 16 | loss: 0.1129663
	speed: 0.0215s/iter; left time: 853.0372s
	iters: 300, epoch: 16 | loss: 0.0112048
	speed: 0.0222s/iter; left time: 876.4248s
	iters: 400, epoch: 16 | loss: 0.0308958
	speed: 0.0218s/iter; left time: 859.5393s
Epoch: 16 cost time: 10.678365230560303
Epoch: 16, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.971983 --> -0.972555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0172973
	speed: 0.1139s/iter; left time: 4476.9660s
	iters: 200, epoch: 17 | loss: 0.0275978
	speed: 0.0215s/iter; left time: 841.2669s
	iters: 300, epoch: 17 | loss: 0.3407196
	speed: 0.0217s/iter; left time: 850.3230s
	iters: 400, epoch: 17 | loss: 0.0555946
	speed: 0.0211s/iter; left time: 822.0629s
Epoch: 17 cost time: 10.310359001159668
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0217338
	speed: 0.1137s/iter; left time: 4415.3976s
	iters: 200, epoch: 18 | loss: 0.0267882
	speed: 0.0228s/iter; left time: 882.9587s
	iters: 300, epoch: 18 | loss: 0.0488017
	speed: 0.0224s/iter; left time: 864.8050s
	iters: 400, epoch: 18 | loss: 0.0295053
	speed: 0.0214s/iter; left time: 824.7754s
Epoch: 18 cost time: 10.805705308914185
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.972555 --> -0.974556).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0037360
	speed: 0.1161s/iter; left time: 4451.7540s
	iters: 200, epoch: 19 | loss: 0.0040569
	speed: 0.0219s/iter; left time: 837.4867s
	iters: 300, epoch: 19 | loss: 0.0038229
	speed: 0.0224s/iter; left time: 855.2065s
	iters: 400, epoch: 19 | loss: 0.0932623
	speed: 0.0220s/iter; left time: 836.4662s
Epoch: 19 cost time: 10.76034688949585
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.1950411
	speed: 0.1213s/iter; left time: 4597.4941s
	iters: 200, epoch: 20 | loss: 0.0122793
	speed: 0.0203s/iter; left time: 765.8466s
	iters: 300, epoch: 20 | loss: 0.0039318
	speed: 0.0200s/iter; left time: 754.6602s
	iters: 400, epoch: 20 | loss: 0.0372743
	speed: 0.0203s/iter; left time: 764.1277s
Epoch: 20 cost time: 10.179432392120361
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0614331
	speed: 0.1098s/iter; left time: 4107.2515s
	iters: 200, epoch: 21 | loss: 0.0567677
	speed: 0.0211s/iter; left time: 786.3814s
	iters: 300, epoch: 21 | loss: 0.0056824
	speed: 0.0206s/iter; left time: 765.1165s
	iters: 400, epoch: 21 | loss: 0.0048166
	speed: 0.0218s/iter; left time: 811.0028s
Epoch: 21 cost time: 9.998551845550537
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0229371
	speed: 0.1134s/iter; left time: 4191.7631s
	iters: 200, epoch: 22 | loss: 0.0029076
	speed: 0.0199s/iter; left time: 734.7512s
	iters: 300, epoch: 22 | loss: 0.1385283
	speed: 0.0208s/iter; left time: 765.2204s
	iters: 400, epoch: 22 | loss: 0.1209154
	speed: 0.0208s/iter; left time: 762.5989s
Epoch: 22 cost time: 10.027428388595581
Epoch: 22, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0034333
	speed: 0.1084s/iter; left time: 3953.7574s
	iters: 200, epoch: 23 | loss: 0.0586711
	speed: 0.0218s/iter; left time: 792.2935s
	iters: 300, epoch: 23 | loss: 0.0092825
	speed: 0.0208s/iter; left time: 754.4003s
	iters: 400, epoch: 23 | loss: 0.0107785
	speed: 0.0222s/iter; left time: 803.0866s
Epoch: 23 cost time: 10.51487135887146
Epoch: 23, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977129).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1654083
	speed: 0.1203s/iter; left time: 4333.4096s
	iters: 200, epoch: 24 | loss: 0.0113371
	speed: 0.0215s/iter; left time: 771.8152s
	iters: 300, epoch: 24 | loss: 0.0217119
	speed: 0.0219s/iter; left time: 783.0002s
	iters: 400, epoch: 24 | loss: 0.0064106
	speed: 0.0201s/iter; left time: 717.3390s
Epoch: 24 cost time: 10.514766454696655
Epoch: 24, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0163284
	speed: 0.1191s/iter; left time: 4234.2499s
	iters: 200, epoch: 25 | loss: 0.0004204
	speed: 0.0216s/iter; left time: 766.6254s
	iters: 300, epoch: 25 | loss: 0.0721964
	speed: 0.0220s/iter; left time: 779.0400s
	iters: 400, epoch: 25 | loss: 0.0862781
	speed: 0.0224s/iter; left time: 789.1760s
Epoch: 25 cost time: 10.508793830871582
Epoch: 25, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0114414
	speed: 0.1092s/iter; left time: 3830.3751s
	iters: 200, epoch: 26 | loss: 0.0745102
	speed: 0.0242s/iter; left time: 847.7144s
	iters: 300, epoch: 26 | loss: 0.0305449
	speed: 0.0228s/iter; left time: 793.8163s
	iters: 400, epoch: 26 | loss: 0.0006270
	speed: 0.0230s/iter; left time: 801.0359s
Epoch: 26 cost time: 11.002286434173584
Epoch: 26, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0313467
	speed: 0.0932s/iter; left time: 3225.8124s
	iters: 200, epoch: 27 | loss: 0.0042380
	speed: 0.0192s/iter; left time: 661.1251s
	iters: 300, epoch: 27 | loss: 0.0106598
	speed: 0.0187s/iter; left time: 642.9803s
	iters: 400, epoch: 27 | loss: 0.2041631
	speed: 0.0196s/iter; left time: 672.0302s
Epoch: 27 cost time: 9.24287462234497
Epoch: 27, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.977700).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.1384152
	speed: 0.1191s/iter; left time: 4065.2398s
	iters: 200, epoch: 28 | loss: 0.0088668
	speed: 0.0221s/iter; left time: 751.2910s
	iters: 300, epoch: 28 | loss: 0.0080413
	speed: 0.0226s/iter; left time: 766.9742s
	iters: 400, epoch: 28 | loss: 0.1231716
	speed: 0.0220s/iter; left time: 743.5670s
Epoch: 28 cost time: 10.83693528175354
Epoch: 28, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0059280
	speed: 0.1212s/iter; left time: 4080.6702s
	iters: 200, epoch: 29 | loss: 0.2140317
	speed: 0.0218s/iter; left time: 732.7438s
	iters: 300, epoch: 29 | loss: 0.0467718
	speed: 0.0216s/iter; left time: 723.0307s
	iters: 400, epoch: 29 | loss: 0.0053670
	speed: 0.0201s/iter; left time: 670.7189s
Epoch: 29 cost time: 10.513314485549927
Epoch: 29, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.977700 --> -0.977700).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0240978
	speed: 0.1144s/iter; left time: 3797.0144s
	iters: 200, epoch: 30 | loss: 0.0038316
	speed: 0.0218s/iter; left time: 720.6980s
	iters: 300, epoch: 30 | loss: 0.0447363
	speed: 0.0217s/iter; left time: 716.9575s
	iters: 400, epoch: 30 | loss: 0.0017329
	speed: 0.0229s/iter; left time: 753.9514s
Epoch: 30 cost time: 10.730842113494873
Epoch: 30, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0032712
	speed: 0.1280s/iter; left time: 4191.0519s
	iters: 200, epoch: 31 | loss: 0.0133835
	speed: 0.0223s/iter; left time: 728.8927s
	iters: 300, epoch: 31 | loss: 0.0064081
	speed: 0.0216s/iter; left time: 702.9136s
	iters: 400, epoch: 31 | loss: 0.0345232
	speed: 0.0243s/iter; left time: 789.6716s
Epoch: 31 cost time: 11.170790433883667
Epoch: 31, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0007224
	speed: 0.1277s/iter; left time: 4120.4864s
	iters: 200, epoch: 32 | loss: 0.0037379
	speed: 0.0234s/iter; left time: 753.6996s
	iters: 300, epoch: 32 | loss: 0.0022047
	speed: 0.0223s/iter; left time: 714.1068s
	iters: 400, epoch: 32 | loss: 0.0422552
	speed: 0.0222s/iter; left time: 708.8848s
Epoch: 32 cost time: 11.150179862976074
Epoch: 32, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.977700 --> -0.977986).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0039443
	speed: 0.1207s/iter; left time: 3836.4840s
	iters: 200, epoch: 33 | loss: 0.0191664
	speed: 0.0232s/iter; left time: 735.3565s
	iters: 300, epoch: 33 | loss: 0.0128761
	speed: 0.0213s/iter; left time: 673.8103s
	iters: 400, epoch: 33 | loss: 0.1037637
	speed: 0.0217s/iter; left time: 684.2417s
Epoch: 33 cost time: 10.74585509300232
Epoch: 33, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0347573
	speed: 0.1145s/iter; left time: 3587.4642s
	iters: 200, epoch: 34 | loss: 0.0058926
	speed: 0.0219s/iter; left time: 684.6574s
	iters: 300, epoch: 34 | loss: 0.0040304
	speed: 0.0213s/iter; left time: 664.3351s
	iters: 400, epoch: 34 | loss: 0.0111118
	speed: 0.0207s/iter; left time: 643.0257s
Epoch: 34 cost time: 10.453673124313354
Epoch: 34, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0062184
	speed: 0.1128s/iter; left time: 3479.5751s
	iters: 200, epoch: 35 | loss: 0.0865898
	speed: 0.0235s/iter; left time: 721.3760s
	iters: 300, epoch: 35 | loss: 0.0020925
	speed: 0.0210s/iter; left time: 645.1220s
	iters: 400, epoch: 35 | loss: 0.0017336
	speed: 0.0223s/iter; left time: 682.1164s
Epoch: 35 cost time: 10.814003705978394
Epoch: 35, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0030604
	speed: 0.1226s/iter; left time: 3724.9230s
	iters: 200, epoch: 36 | loss: 0.0201115
	speed: 0.0221s/iter; left time: 669.4340s
	iters: 300, epoch: 36 | loss: 0.0051474
	speed: 0.0219s/iter; left time: 660.4245s
	iters: 400, epoch: 36 | loss: 0.0024961
	speed: 0.0225s/iter; left time: 678.1104s
Epoch: 36 cost time: 10.798315048217773
Epoch: 36, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0199747
	speed: 0.1236s/iter; left time: 3698.7960s
	iters: 200, epoch: 37 | loss: 0.0005486
	speed: 0.0222s/iter; left time: 660.8153s
	iters: 300, epoch: 37 | loss: 0.3239053
	speed: 0.0217s/iter; left time: 644.6102s
	iters: 400, epoch: 37 | loss: 0.0126432
	speed: 0.0211s/iter; left time: 625.9771s
Epoch: 37 cost time: 10.697835922241211
Epoch: 37, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.979130).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0176443
	speed: 0.1114s/iter; left time: 3279.7926s
	iters: 200, epoch: 38 | loss: 0.0045444
	speed: 0.0215s/iter; left time: 629.9483s
	iters: 300, epoch: 38 | loss: 0.0011939
	speed: 0.0211s/iter; left time: 617.2676s
	iters: 400, epoch: 38 | loss: 0.0224570
	speed: 0.0215s/iter; left time: 626.1094s
Epoch: 38 cost time: 10.359551906585693
Epoch: 38, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0064182
	speed: 0.1160s/iter; left time: 3361.4063s
	iters: 200, epoch: 39 | loss: 0.0031933
	speed: 0.0225s/iter; left time: 648.7045s
	iters: 300, epoch: 39 | loss: 0.0009284
	speed: 0.0219s/iter; left time: 631.2389s
	iters: 400, epoch: 39 | loss: 0.1818510
	speed: 0.0225s/iter; left time: 645.6696s
Epoch: 39 cost time: 10.869919300079346
Epoch: 39, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0011899
	speed: 0.1168s/iter; left time: 3329.2535s
	iters: 200, epoch: 40 | loss: 0.0025959
	speed: 0.0219s/iter; left time: 621.3957s
	iters: 300, epoch: 40 | loss: 0.0067001
	speed: 0.0224s/iter; left time: 633.7260s
	iters: 400, epoch: 40 | loss: 0.1262353
	speed: 0.0236s/iter; left time: 667.1054s
Epoch: 40 cost time: 11.105490684509277
Epoch: 40, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979130 --> -0.979702).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0874096
	speed: 0.1268s/iter; left time: 3555.7170s
	iters: 200, epoch: 41 | loss: 0.0004618
	speed: 0.0212s/iter; left time: 592.9798s
	iters: 300, epoch: 41 | loss: 0.0035777
	speed: 0.0222s/iter; left time: 618.1431s
	iters: 400, epoch: 41 | loss: 0.0440826
	speed: 0.0221s/iter; left time: 613.5976s
Epoch: 41 cost time: 10.822222232818604
Epoch: 41, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0024596
	speed: 0.1233s/iter; left time: 3398.3480s
	iters: 200, epoch: 42 | loss: 0.0073530
	speed: 0.0238s/iter; left time: 653.5613s
	iters: 300, epoch: 42 | loss: 0.0028512
	speed: 0.0212s/iter; left time: 580.2007s
	iters: 400, epoch: 42 | loss: 0.0025581
	speed: 0.0212s/iter; left time: 578.5104s
Epoch: 42 cost time: 10.77495002746582
Epoch: 42, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0261691
	speed: 0.1079s/iter; left time: 2924.6811s
	iters: 200, epoch: 43 | loss: 0.0012046
	speed: 0.0222s/iter; left time: 598.8462s
	iters: 300, epoch: 43 | loss: 0.0111094
	speed: 0.0211s/iter; left time: 568.3967s
	iters: 400, epoch: 43 | loss: 0.0098888
	speed: 0.0214s/iter; left time: 572.4060s
Epoch: 43 cost time: 10.553457498550415
Epoch: 43, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0040387
	speed: 0.1176s/iter; left time: 3130.8375s
	iters: 200, epoch: 44 | loss: 0.0096332
	speed: 0.0220s/iter; left time: 584.1352s
	iters: 300, epoch: 44 | loss: 0.0047553
	speed: 0.0221s/iter; left time: 584.4114s
	iters: 400, epoch: 44 | loss: 0.0066700
	speed: 0.0233s/iter; left time: 612.4730s
Epoch: 44 cost time: 10.945827722549438
Epoch: 44, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0176508
	speed: 0.1200s/iter; left time: 3139.6421s
	iters: 200, epoch: 45 | loss: 0.0143804
	speed: 0.0213s/iter; left time: 554.6658s
	iters: 300, epoch: 45 | loss: 0.0448721
	speed: 0.0222s/iter; left time: 577.2263s
	iters: 400, epoch: 45 | loss: 0.0238756
	speed: 0.0209s/iter; left time: 540.4661s
Epoch: 45 cost time: 10.357831716537476
Epoch: 45, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0078709
	speed: 0.1223s/iter; left time: 3142.3616s
	iters: 200, epoch: 46 | loss: 0.0720024
	speed: 0.0218s/iter; left time: 557.4910s
	iters: 300, epoch: 46 | loss: 0.0431130
	speed: 0.0216s/iter; left time: 549.9958s
	iters: 400, epoch: 46 | loss: 0.0050165
	speed: 0.0214s/iter; left time: 544.1904s
Epoch: 46 cost time: 10.663268327713013
Epoch: 46, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979702 --> -0.979988).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.0011767
	speed: 0.1219s/iter; left time: 3074.2827s
	iters: 200, epoch: 47 | loss: 0.0024328
	speed: 0.0225s/iter; left time: 564.9601s
	iters: 300, epoch: 47 | loss: 0.0003408
	speed: 0.0218s/iter; left time: 546.7871s
	iters: 400, epoch: 47 | loss: 0.0141195
	speed: 0.0218s/iter; left time: 542.6813s
Epoch: 47 cost time: 10.682672500610352
Epoch: 47, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 48 | loss: 0.0283171
	speed: 0.1185s/iter; left time: 2932.5855s
	iters: 200, epoch: 48 | loss: 0.0122582
	speed: 0.0221s/iter; left time: 546.0853s
	iters: 300, epoch: 48 | loss: 0.0184310
	speed: 0.0221s/iter; left time: 543.3287s
	iters: 400, epoch: 48 | loss: 0.0261799
	speed: 0.0219s/iter; left time: 535.3971s
Epoch: 48 cost time: 10.77691102027893
Epoch: 48, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 49 | loss: 0.0833631
	speed: 0.1152s/iter; left time: 2797.8638s
	iters: 200, epoch: 49 | loss: 0.0136084
	speed: 0.0220s/iter; left time: 532.8645s
	iters: 300, epoch: 49 | loss: 0.0355979
	speed: 0.0219s/iter; left time: 528.6061s
	iters: 400, epoch: 49 | loss: 0.0048887
	speed: 0.0221s/iter; left time: 530.4618s
Epoch: 49 cost time: 10.68149185180664
Epoch: 49, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 50 | loss: 0.0051449
	speed: 0.1088s/iter; left time: 2592.3809s
	iters: 200, epoch: 50 | loss: 0.0159339
	speed: 0.0219s/iter; left time: 518.7626s
	iters: 300, epoch: 50 | loss: 0.0667895
	speed: 0.0222s/iter; left time: 523.5653s
	iters: 400, epoch: 50 | loss: 0.0001135
	speed: 0.0213s/iter; left time: 500.6313s
Epoch: 50 cost time: 10.534949779510498
Epoch: 50, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 51 | loss: 0.0005739
	speed: 0.1204s/iter; left time: 2811.6573s
	iters: 200, epoch: 51 | loss: 0.0695295
	speed: 0.0215s/iter; left time: 499.1518s
	iters: 300, epoch: 51 | loss: 0.0305506
	speed: 0.0220s/iter; left time: 508.5657s
	iters: 400, epoch: 51 | loss: 0.0055640
	speed: 0.0223s/iter; left time: 513.6269s
Epoch: 51 cost time: 10.659328699111938
Epoch: 51, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 52 | loss: 0.0387300
	speed: 0.1209s/iter; left time: 2767.0877s
	iters: 200, epoch: 52 | loss: 0.0161928
	speed: 0.0234s/iter; left time: 532.7539s
	iters: 300, epoch: 52 | loss: 0.0020477
	speed: 0.0224s/iter; left time: 507.6871s
	iters: 400, epoch: 52 | loss: 0.0060350
	speed: 0.0232s/iter; left time: 524.7363s
Epoch: 52 cost time: 11.09778356552124
Epoch: 52, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.979988 --> -0.980559).  Saving model ...
	iters: 100, epoch: 53 | loss: 0.0024890
	speed: 0.1246s/iter; left time: 2793.1051s
	iters: 200, epoch: 53 | loss: 0.0020809
	speed: 0.0220s/iter; left time: 491.3516s
	iters: 300, epoch: 53 | loss: 0.0204922
	speed: 0.0230s/iter; left time: 510.1445s
	iters: 400, epoch: 53 | loss: 0.0019778
	speed: 0.0218s/iter; left time: 482.9822s
Epoch: 53 cost time: 10.841555118560791
Epoch: 53, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.980559 --> -0.981131).  Saving model ...
	iters: 100, epoch: 54 | loss: 0.0054011
	speed: 0.1121s/iter; left time: 2459.1872s
	iters: 200, epoch: 54 | loss: 0.0074037
	speed: 0.0219s/iter; left time: 479.0007s
	iters: 300, epoch: 54 | loss: 0.0298148
	speed: 0.0220s/iter; left time: 478.7955s
	iters: 400, epoch: 54 | loss: 0.2239544
	speed: 0.0214s/iter; left time: 463.8189s
Epoch: 54 cost time: 10.645507574081421
Epoch: 54, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 55 | loss: 0.0028738
	speed: 0.1140s/iter; left time: 2447.4869s
	iters: 200, epoch: 55 | loss: 0.0019794
	speed: 0.0207s/iter; left time: 441.9458s
	iters: 300, epoch: 55 | loss: 0.0178919
	speed: 0.0213s/iter; left time: 453.3680s
	iters: 400, epoch: 55 | loss: 0.0050742
	speed: 0.0225s/iter; left time: 475.7914s
Epoch: 55 cost time: 10.574381113052368
Epoch: 55, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 56 | loss: 0.0094847
	speed: 0.1189s/iter; left time: 2498.2468s
	iters: 200, epoch: 56 | loss: 0.0391952
	speed: 0.0241s/iter; left time: 503.1437s
	iters: 300, epoch: 56 | loss: 0.0048958
	speed: 0.0239s/iter; left time: 497.4461s
	iters: 400, epoch: 56 | loss: 0.0012493
	speed: 0.0241s/iter; left time: 499.7322s
Epoch: 56 cost time: 11.595930576324463
Epoch: 56, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 57 | loss: 0.0807503
	speed: 0.1248s/iter; left time: 2563.2280s
	iters: 200, epoch: 57 | loss: 0.0017665
	speed: 0.0227s/iter; left time: 464.0043s
	iters: 300, epoch: 57 | loss: 0.1184967
	speed: 0.0228s/iter; left time: 462.7977s
	iters: 400, epoch: 57 | loss: 0.0057311
	speed: 0.0239s/iter; left time: 484.4155s
Epoch: 57 cost time: 11.30666184425354
Epoch: 57, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 58 | loss: 0.0004976
	speed: 0.1163s/iter; left time: 2333.1311s
	iters: 200, epoch: 58 | loss: 0.0257432
	speed: 0.0218s/iter; left time: 434.3219s
	iters: 300, epoch: 58 | loss: 0.0021358
	speed: 0.0207s/iter; left time: 411.3105s
	iters: 400, epoch: 58 | loss: 0.0015693
	speed: 0.0223s/iter; left time: 439.9838s
Epoch: 58 cost time: 10.507394313812256
Epoch: 58, Steps: 469 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 59 | loss: 0.0040775
	speed: 0.1104s/iter; left time: 2162.8698s
	iters: 200, epoch: 59 | loss: 0.0016261
	speed: 0.0218s/iter; left time: 424.3502s
	iters: 300, epoch: 59 | loss: 0.0053991
	speed: 0.0224s/iter; left time: 434.6321s
	iters: 400, epoch: 59 | loss: 0.0091021
	speed: 0.0215s/iter; left time: 414.9851s
Epoch: 59 cost time: 10.559528112411499
Epoch: 59, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 60 | loss: 0.0001610
	speed: 0.1126s/iter; left time: 2154.1469s
	iters: 200, epoch: 60 | loss: 0.0231987
	speed: 0.0219s/iter; left time: 416.3076s
	iters: 300, epoch: 60 | loss: 0.0017898
	speed: 0.0214s/iter; left time: 404.8549s
	iters: 400, epoch: 60 | loss: 0.0002507
	speed: 0.0217s/iter; left time: 407.9009s
Epoch: 60 cost time: 10.604851007461548
Epoch: 60, Steps: 469 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 61 | loss: 0.0037954
	speed: 0.1156s/iter; left time: 2156.7984s
	iters: 200, epoch: 61 | loss: 0.0193297
	speed: 0.0227s/iter; left time: 420.8486s
	iters: 300, epoch: 61 | loss: 0.4216901
	speed: 0.0226s/iter; left time: 416.9313s
	iters: 400, epoch: 61 | loss: 0.0003808
	speed: 0.0231s/iter; left time: 423.7656s
Epoch: 61 cost time: 11.122547388076782
Epoch: 61, Steps: 469 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 62 | loss: 0.0043141
	speed: 0.1197s/iter; left time: 2177.7260s
	iters: 200, epoch: 62 | loss: 0.0074776
	speed: 0.0217s/iter; left time: 391.8103s
	iters: 300, epoch: 62 | loss: 0.1971279
	speed: 0.0224s/iter; left time: 402.5215s
	iters: 400, epoch: 62 | loss: 0.0034771
	speed: 0.0222s/iter; left time: 397.0805s
Epoch: 62 cost time: 10.783691883087158
Epoch: 62, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 63 | loss: 0.0386877
	speed: 0.1159s/iter; left time: 2053.7528s
	iters: 200, epoch: 63 | loss: 0.0046899
	speed: 0.0224s/iter; left time: 394.0255s
	iters: 300, epoch: 63 | loss: 0.0008475
	speed: 0.0208s/iter; left time: 363.6716s
	iters: 400, epoch: 63 | loss: 0.0326676
	speed: 0.0220s/iter; left time: 383.8633s
Epoch: 63 cost time: 10.532283306121826
Epoch: 63, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 136418
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5243112
	speed: 0.0408s/iter; left time: 1911.5385s
	iters: 200, epoch: 1 | loss: 1.1046988
	speed: 0.0214s/iter; left time: 1001.2793s
	iters: 300, epoch: 1 | loss: 0.6166673
	speed: 0.0215s/iter; left time: 1001.7729s
	iters: 400, epoch: 1 | loss: 0.4870116
	speed: 0.0221s/iter; left time: 1028.3851s
Epoch: 1 cost time: 12.144437789916992
Epoch: 1, Steps: 469 | Train Loss: 1.107 Vali Loss: 0.564 Vali Acc: 0.824 Test Loss: 0.564 Test Acc: 0.824
Validation loss decreased (inf --> -0.824465).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3204458
	speed: 0.1108s/iter; left time: 5134.4186s
	iters: 200, epoch: 2 | loss: 0.3718902
	speed: 0.0212s/iter; left time: 979.1152s
	iters: 300, epoch: 2 | loss: 0.4861861
	speed: 0.0223s/iter; left time: 1029.6491s
	iters: 400, epoch: 2 | loss: 0.3508101
	speed: 0.0206s/iter; left time: 946.7563s
Epoch: 2 cost time: 10.727132081985474
Epoch: 2, Steps: 469 | Train Loss: 0.352 Vali Loss: 0.357 Vali Acc: 0.893 Test Loss: 0.357 Test Acc: 0.893
Validation loss decreased (-0.824465 --> -0.893078).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3757775
	speed: 0.1199s/iter; left time: 5499.3760s
	iters: 200, epoch: 3 | loss: 0.1996821
	speed: 0.0227s/iter; left time: 1038.2579s
	iters: 300, epoch: 3 | loss: 0.2305192
	speed: 0.0227s/iter; left time: 1036.0562s
	iters: 400, epoch: 3 | loss: 0.0614817
	speed: 0.0229s/iter; left time: 1041.7277s
Epoch: 3 cost time: 10.804154396057129
Epoch: 3, Steps: 469 | Train Loss: 0.235 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.893078 --> -0.924526).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1054263
	speed: 0.1156s/iter; left time: 5247.8073s
	iters: 200, epoch: 4 | loss: 0.1306899
	speed: 0.0214s/iter; left time: 968.3940s
	iters: 300, epoch: 4 | loss: 0.0870738
	speed: 0.0217s/iter; left time: 982.4817s
	iters: 400, epoch: 4 | loss: 0.2991080
	speed: 0.0221s/iter; left time: 996.8557s
Epoch: 4 cost time: 10.665313720703125
Epoch: 4, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.924526 --> -0.947682).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1380064
	speed: 0.1161s/iter; left time: 5216.4989s
	iters: 200, epoch: 5 | loss: 0.2019803
	speed: 0.0209s/iter; left time: 936.5050s
	iters: 300, epoch: 5 | loss: 0.0542446
	speed: 0.0217s/iter; left time: 970.9153s
	iters: 400, epoch: 5 | loss: 0.2780563
	speed: 0.0211s/iter; left time: 942.0797s
Epoch: 5 cost time: 10.343417882919312
Epoch: 5, Steps: 469 | Train Loss: 0.147 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1824077
	speed: 0.1132s/iter; left time: 5030.2914s
	iters: 200, epoch: 6 | loss: 0.0949505
	speed: 0.0202s/iter; left time: 894.4549s
	iters: 300, epoch: 6 | loss: 0.6983771
	speed: 0.0211s/iter; left time: 933.7108s
	iters: 400, epoch: 6 | loss: 0.0297891
	speed: 0.0222s/iter; left time: 980.2983s
Epoch: 6 cost time: 10.373010396957397
Epoch: 6, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1647754
	speed: 0.1168s/iter; left time: 5138.4867s
	iters: 200, epoch: 7 | loss: 0.0964139
	speed: 0.0210s/iter; left time: 922.1093s
	iters: 300, epoch: 7 | loss: 0.0940795
	speed: 0.0213s/iter; left time: 933.8367s
	iters: 400, epoch: 7 | loss: 0.0287508
	speed: 0.0218s/iter; left time: 952.0462s
Epoch: 7 cost time: 10.494813919067383
Epoch: 7, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.947682 --> -0.960261).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1559221
	speed: 0.1175s/iter; left time: 5112.0474s
	iters: 200, epoch: 8 | loss: 0.0334699
	speed: 0.0219s/iter; left time: 949.3893s
	iters: 300, epoch: 8 | loss: 0.0850083
	speed: 0.0221s/iter; left time: 959.3832s
	iters: 400, epoch: 8 | loss: 0.0755831
	speed: 0.0219s/iter; left time: 947.2079s
Epoch: 8 cost time: 10.839332342147827
Epoch: 8, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1233449
	speed: 0.1215s/iter; left time: 5229.7271s
	iters: 200, epoch: 9 | loss: 0.1063081
	speed: 0.0227s/iter; left time: 973.4944s
	iters: 300, epoch: 9 | loss: 0.2126054
	speed: 0.0237s/iter; left time: 1016.6429s
	iters: 400, epoch: 9 | loss: 0.1994867
	speed: 0.0230s/iter; left time: 983.4073s
Epoch: 9 cost time: 11.1354238986969
Epoch: 9, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.960261 --> -0.965121).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0991521
	speed: 0.1159s/iter; left time: 4934.7390s
	iters: 200, epoch: 10 | loss: 0.0493180
	speed: 0.0215s/iter; left time: 911.2977s
	iters: 300, epoch: 10 | loss: 0.0227410
	speed: 0.0221s/iter; left time: 937.4226s
	iters: 400, epoch: 10 | loss: 0.0880601
	speed: 0.0224s/iter; left time: 945.6105s
Epoch: 10 cost time: 10.62131929397583
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
Validation loss decreased (-0.965121 --> -0.967123).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0169035
	speed: 0.1100s/iter; left time: 4634.0935s
	iters: 200, epoch: 11 | loss: 0.0696873
	speed: 0.0223s/iter; left time: 936.7593s
	iters: 300, epoch: 11 | loss: 0.0325517
	speed: 0.0223s/iter; left time: 934.5413s
	iters: 400, epoch: 11 | loss: 0.0069558
	speed: 0.0225s/iter; left time: 938.8610s
Epoch: 11 cost time: 10.79507565498352
Epoch: 11, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0069495
	speed: 0.1152s/iter; left time: 4797.7356s
	iters: 200, epoch: 12 | loss: 0.0947793
	speed: 0.0213s/iter; left time: 884.9176s
	iters: 300, epoch: 12 | loss: 0.1447836
	speed: 0.0211s/iter; left time: 872.4743s
	iters: 400, epoch: 12 | loss: 0.0180317
	speed: 0.0223s/iter; left time: 920.9483s
Epoch: 12 cost time: 10.560985326766968
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.969410).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.1378597
	speed: 0.1241s/iter; left time: 5108.8299s
	iters: 200, epoch: 13 | loss: 0.0088462
	speed: 0.0236s/iter; left time: 971.2862s
	iters: 300, epoch: 13 | loss: 0.1231750
	speed: 0.0227s/iter; left time: 928.3133s
	iters: 400, epoch: 13 | loss: 0.1892993
	speed: 0.0230s/iter; left time: 941.1777s
Epoch: 13 cost time: 11.383861780166626
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.971697).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0348231
	speed: 0.1240s/iter; left time: 5046.1076s
	iters: 200, epoch: 14 | loss: 0.0166667
	speed: 0.0232s/iter; left time: 940.2094s
	iters: 300, epoch: 14 | loss: 0.3580409
	speed: 0.0233s/iter; left time: 941.9572s
	iters: 400, epoch: 14 | loss: 0.0279799
	speed: 0.0218s/iter; left time: 880.4889s
Epoch: 14 cost time: 11.083067178726196
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0219052
	speed: 0.1177s/iter; left time: 4734.0487s
	iters: 200, epoch: 15 | loss: 0.0437465
	speed: 0.0208s/iter; left time: 835.4013s
	iters: 300, epoch: 15 | loss: 0.0372984
	speed: 0.0215s/iter; left time: 859.9857s
	iters: 400, epoch: 15 | loss: 0.0455677
	speed: 0.0219s/iter; left time: 875.1464s
Epoch: 15 cost time: 10.46683144569397
Epoch: 15, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.973984).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2104075
	speed: 0.1170s/iter; left time: 4651.4080s
	iters: 200, epoch: 16 | loss: 0.1104507
	speed: 0.0228s/iter; left time: 904.9156s
	iters: 300, epoch: 16 | loss: 0.0123013
	speed: 0.0233s/iter; left time: 920.4197s
	iters: 400, epoch: 16 | loss: 0.0307121
	speed: 0.0221s/iter; left time: 871.3200s
Epoch: 16 cost time: 10.971592903137207
Epoch: 16, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0513045
	speed: 0.1150s/iter; left time: 4520.2728s
	iters: 200, epoch: 17 | loss: 0.2304614
	speed: 0.0221s/iter; left time: 864.3956s
	iters: 300, epoch: 17 | loss: 0.1567866
	speed: 0.0230s/iter; left time: 900.9908s
	iters: 400, epoch: 17 | loss: 0.0432073
	speed: 0.0225s/iter; left time: 876.5935s
Epoch: 17 cost time: 10.94392466545105
Epoch: 17, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0762531
	speed: 0.1263s/iter; left time: 4905.0131s
	iters: 200, epoch: 18 | loss: 0.0496872
	speed: 0.0233s/iter; left time: 900.7044s
	iters: 300, epoch: 18 | loss: 0.0225447
	speed: 0.0240s/iter; left time: 927.7222s
	iters: 400, epoch: 18 | loss: 0.0760521
	speed: 0.0244s/iter; left time: 939.1454s
Epoch: 18 cost time: 11.59193754196167
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.975128).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0103708
	speed: 0.1232s/iter; left time: 4726.3484s
	iters: 200, epoch: 19 | loss: 0.0159417
	speed: 0.0228s/iter; left time: 872.3111s
	iters: 300, epoch: 19 | loss: 0.0144909
	speed: 0.0246s/iter; left time: 939.2141s
	iters: 400, epoch: 19 | loss: 0.0603501
	speed: 0.0231s/iter; left time: 879.3961s
Epoch: 19 cost time: 11.349184036254883
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.975128 --> -0.975413).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0964887
	speed: 0.1154s/iter; left time: 4370.6448s
	iters: 200, epoch: 20 | loss: 0.1047080
	speed: 0.0220s/iter; left time: 830.7969s
	iters: 300, epoch: 20 | loss: 0.0106357
	speed: 0.0212s/iter; left time: 800.6458s
	iters: 400, epoch: 20 | loss: 0.0251611
	speed: 0.0219s/iter; left time: 824.9529s
Epoch: 20 cost time: 10.475953578948975
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0615338
	speed: 0.1140s/iter; left time: 4264.9483s
	iters: 200, epoch: 21 | loss: 0.1132031
	speed: 0.0218s/iter; left time: 814.4794s
	iters: 300, epoch: 21 | loss: 0.0083890
	speed: 0.0212s/iter; left time: 788.3582s
	iters: 400, epoch: 21 | loss: 0.0172199
	speed: 0.0212s/iter; left time: 786.6453s
Epoch: 21 cost time: 10.50613808631897
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0186815
	speed: 0.1179s/iter; left time: 4357.2049s
	iters: 200, epoch: 22 | loss: 0.0073982
	speed: 0.0208s/iter; left time: 766.8387s
	iters: 300, epoch: 22 | loss: 0.0602042
	speed: 0.0218s/iter; left time: 799.6808s
	iters: 400, epoch: 22 | loss: 0.1252233
	speed: 0.0203s/iter; left time: 743.8174s
Epoch: 22 cost time: 10.353578567504883
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0138762
	speed: 0.1167s/iter; left time: 4258.1532s
	iters: 200, epoch: 23 | loss: 0.1647514
	speed: 0.0217s/iter; left time: 789.2483s
	iters: 300, epoch: 23 | loss: 0.0178259
	speed: 0.0221s/iter; left time: 803.0973s
	iters: 400, epoch: 23 | loss: 0.1817850
	speed: 0.0230s/iter; left time: 832.8239s
Epoch: 23 cost time: 10.94492220878601
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.975413 --> -0.975413).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.2004838
	speed: 0.1176s/iter; left time: 4233.8675s
	iters: 200, epoch: 24 | loss: 0.0331343
	speed: 0.0227s/iter; left time: 813.6052s
	iters: 300, epoch: 24 | loss: 0.0038360
	speed: 0.0227s/iter; left time: 811.5936s
	iters: 400, epoch: 24 | loss: 0.0084765
	speed: 0.0226s/iter; left time: 805.6374s
Epoch: 24 cost time: 11.054694652557373
Epoch: 24, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0135560
	speed: 0.1191s/iter; left time: 4234.8013s
	iters: 200, epoch: 25 | loss: 0.0013378
	speed: 0.0226s/iter; left time: 800.0628s
	iters: 300, epoch: 25 | loss: 0.0637872
	speed: 0.0216s/iter; left time: 764.7174s
	iters: 400, epoch: 25 | loss: 0.0068459
	speed: 0.0222s/iter; left time: 784.0578s
Epoch: 25 cost time: 10.564356088638306
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0019545
	speed: 0.1116s/iter; left time: 3913.6131s
	iters: 200, epoch: 26 | loss: 0.0748686
	speed: 0.0224s/iter; left time: 782.4954s
	iters: 300, epoch: 26 | loss: 0.0073841
	speed: 0.0208s/iter; left time: 725.6204s
	iters: 400, epoch: 26 | loss: 0.0061244
	speed: 0.0205s/iter; left time: 711.6447s
Epoch: 26 cost time: 10.309807062149048
Epoch: 26, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.975413 --> -0.976271).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0553987
	speed: 0.1113s/iter; left time: 3851.3874s
	iters: 200, epoch: 27 | loss: 0.0008901
	speed: 0.0212s/iter; left time: 732.2199s
	iters: 300, epoch: 27 | loss: 0.0078760
	speed: 0.0225s/iter; left time: 775.2200s
	iters: 400, epoch: 27 | loss: 0.3548959
	speed: 0.0221s/iter; left time: 757.0779s
Epoch: 27 cost time: 10.65257215499878
Epoch: 27, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0857342
	speed: 0.1123s/iter; left time: 3835.3667s
	iters: 200, epoch: 28 | loss: 0.0717007
	speed: 0.0225s/iter; left time: 764.8456s
	iters: 300, epoch: 28 | loss: 0.0364405
	speed: 0.0227s/iter; left time: 769.5576s
	iters: 400, epoch: 28 | loss: 0.0297414
	speed: 0.0211s/iter; left time: 713.5155s
Epoch: 28 cost time: 10.691389083862305
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0054916
	speed: 0.1171s/iter; left time: 3941.5742s
	iters: 200, epoch: 29 | loss: 0.0226514
	speed: 0.0214s/iter; left time: 717.7576s
	iters: 300, epoch: 29 | loss: 0.1377811
	speed: 0.0220s/iter; left time: 735.7778s
	iters: 400, epoch: 29 | loss: 0.0033843
	speed: 0.0229s/iter; left time: 763.9446s
Epoch: 29 cost time: 10.7435622215271
Epoch: 29, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0206603
	speed: 0.1217s/iter; left time: 4039.1076s
	iters: 200, epoch: 30 | loss: 0.0022223
	speed: 0.0225s/iter; left time: 745.5139s
	iters: 300, epoch: 30 | loss: 0.0445625
	speed: 0.0214s/iter; left time: 705.4764s
	iters: 400, epoch: 30 | loss: 0.0115383
	speed: 0.0218s/iter; left time: 718.4072s
Epoch: 30 cost time: 10.635960578918457
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0064179
	speed: 0.1082s/iter; left time: 3541.8355s
	iters: 200, epoch: 31 | loss: 0.0229434
	speed: 0.0207s/iter; left time: 675.1998s
	iters: 300, epoch: 31 | loss: 0.1120272
	speed: 0.0205s/iter; left time: 666.6386s
	iters: 400, epoch: 31 | loss: 0.0096941
	speed: 0.0209s/iter; left time: 677.3228s
Epoch: 31 cost time: 10.153579711914062
Epoch: 31, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0041540
	speed: 0.1070s/iter; left time: 3451.7381s
	iters: 200, epoch: 32 | loss: 0.0035598
	speed: 0.0198s/iter; left time: 635.8746s
	iters: 300, epoch: 32 | loss: 0.0109369
	speed: 0.0198s/iter; left time: 635.5255s
	iters: 400, epoch: 32 | loss: 0.0129048
	speed: 0.0196s/iter; left time: 626.2337s
Epoch: 32 cost time: 9.818872213363647
Epoch: 32, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0034668
	speed: 0.1094s/iter; left time: 3476.9968s
	iters: 200, epoch: 33 | loss: 0.0256622
	speed: 0.0200s/iter; left time: 632.8873s
	iters: 300, epoch: 33 | loss: 0.0030034
	speed: 0.0206s/iter; left time: 650.2419s
	iters: 400, epoch: 33 | loss: 0.1283556
	speed: 0.0200s/iter; left time: 630.7757s
Epoch: 33 cost time: 10.03067922592163
Epoch: 33, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0080748
	speed: 0.1229s/iter; left time: 3850.4799s
	iters: 200, epoch: 34 | loss: 0.0038325
	speed: 0.0217s/iter; left time: 676.8526s
	iters: 300, epoch: 34 | loss: 0.0058413
	speed: 0.0216s/iter; left time: 673.7518s
	iters: 400, epoch: 34 | loss: 0.0286187
	speed: 0.0227s/iter; left time: 705.5637s
Epoch: 34 cost time: 10.70951247215271
Epoch: 34, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0201440
	speed: 0.1203s/iter; left time: 3710.7783s
	iters: 200, epoch: 35 | loss: 0.1162756
	speed: 0.0223s/iter; left time: 685.0855s
	iters: 300, epoch: 35 | loss: 0.0035645
	speed: 0.0225s/iter; left time: 689.9599s
	iters: 400, epoch: 35 | loss: 0.0025792
	speed: 0.0224s/iter; left time: 685.3119s
Epoch: 35 cost time: 10.821621656417847
Epoch: 35, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.977415).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0113767
	speed: 0.1079s/iter; left time: 3278.2802s
	iters: 200, epoch: 36 | loss: 0.0398078
	speed: 0.0205s/iter; left time: 621.4862s
	iters: 300, epoch: 36 | loss: 0.0042507
	speed: 0.0204s/iter; left time: 614.5558s
	iters: 400, epoch: 36 | loss: 0.0087552
	speed: 0.0214s/iter; left time: 644.6885s
Epoch: 36 cost time: 10.168227434158325
Epoch: 36, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 37 | loss: 0.0121121
	speed: 0.1083s/iter; left time: 3239.6582s
	iters: 200, epoch: 37 | loss: 0.0042279
	speed: 0.0203s/iter; left time: 604.0745s
	iters: 300, epoch: 37 | loss: 0.3956137
	speed: 0.0207s/iter; left time: 613.9293s
	iters: 400, epoch: 37 | loss: 0.0037785
	speed: 0.0209s/iter; left time: 618.3131s
Epoch: 37 cost time: 10.081920146942139
Epoch: 37, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 38 | loss: 0.0174085
	speed: 0.1088s/iter; left time: 3204.3136s
	iters: 200, epoch: 38 | loss: 0.0014314
	speed: 0.0205s/iter; left time: 602.9370s
	iters: 300, epoch: 38 | loss: 0.0060339
	speed: 0.0204s/iter; left time: 595.8207s
	iters: 400, epoch: 38 | loss: 0.0273840
	speed: 0.0198s/iter; left time: 578.5575s
Epoch: 38 cost time: 10.086670637130737
Epoch: 38, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 39 | loss: 0.0601645
	speed: 0.1193s/iter; left time: 3458.6318s
	iters: 200, epoch: 39 | loss: 0.0028079
	speed: 0.0209s/iter; left time: 604.2034s
	iters: 300, epoch: 39 | loss: 0.0010288
	speed: 0.0204s/iter; left time: 585.7621s
	iters: 400, epoch: 39 | loss: 0.1786726
	speed: 0.0204s/iter; left time: 586.0423s
Epoch: 39 cost time: 10.211120843887329
Epoch: 39, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 40 | loss: 0.0003941
	speed: 0.1156s/iter; left time: 3295.1811s
	iters: 200, epoch: 40 | loss: 0.0009483
	speed: 0.0218s/iter; left time: 618.9513s
	iters: 300, epoch: 40 | loss: 0.0564170
	speed: 0.0214s/iter; left time: 605.6173s
	iters: 400, epoch: 40 | loss: 0.0535817
	speed: 0.0210s/iter; left time: 593.5261s
Epoch: 40 cost time: 10.39809775352478
Epoch: 40, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 41 | loss: 0.0347705
	speed: 0.1128s/iter; left time: 3163.8055s
	iters: 200, epoch: 41 | loss: 0.0017136
	speed: 0.0206s/iter; left time: 575.5479s
	iters: 300, epoch: 41 | loss: 0.0122769
	speed: 0.0207s/iter; left time: 576.8698s
	iters: 400, epoch: 41 | loss: 0.1073218
	speed: 0.0204s/iter; left time: 564.5303s
Epoch: 41 cost time: 10.134801626205444
Epoch: 41, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 42 | loss: 0.0039485
	speed: 0.1104s/iter; left time: 3044.1375s
	iters: 200, epoch: 42 | loss: 0.1204901
	speed: 0.0210s/iter; left time: 577.6953s
	iters: 300, epoch: 42 | loss: 0.0392865
	speed: 0.0204s/iter; left time: 559.1821s
	iters: 400, epoch: 42 | loss: 0.0001045
	speed: 0.0207s/iter; left time: 564.6897s
Epoch: 42 cost time: 10.099362134933472
Epoch: 42, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 43 | loss: 0.2624331
	speed: 0.1108s/iter; left time: 3002.5713s
	iters: 200, epoch: 43 | loss: 0.0001333
	speed: 0.0203s/iter; left time: 549.2559s
	iters: 300, epoch: 43 | loss: 0.0871715
	speed: 0.0211s/iter; left time: 566.8108s
	iters: 400, epoch: 43 | loss: 0.0138114
	speed: 0.0208s/iter; left time: 557.7579s
Epoch: 43 cost time: 10.113539695739746
Epoch: 43, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 44 | loss: 0.0015235
	speed: 0.1051s/iter; left time: 2799.9650s
	iters: 200, epoch: 44 | loss: 0.0717838
	speed: 0.0220s/iter; left time: 583.7867s
	iters: 300, epoch: 44 | loss: 0.0653634
	speed: 0.0212s/iter; left time: 560.1709s
	iters: 400, epoch: 44 | loss: 0.0109783
	speed: 0.0220s/iter; left time: 580.4026s
Epoch: 44 cost time: 10.716870069503784
Epoch: 44, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 45 | loss: 0.0280791
	speed: 0.1192s/iter; left time: 3120.0708s
	iters: 200, epoch: 45 | loss: 0.0152098
	speed: 0.0219s/iter; left time: 571.8414s
	iters: 300, epoch: 45 | loss: 0.0077540
	speed: 0.0226s/iter; left time: 586.6420s
	iters: 400, epoch: 45 | loss: 0.0081087
	speed: 0.0206s/iter; left time: 533.4162s
Epoch: 45 cost time: 10.555258512496948
Epoch: 45, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9774156660949114
model parameter : 136418
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5945207
	speed: 0.0408s/iter; left time: 1908.6137s
	iters: 200, epoch: 1 | loss: 1.2343928
	speed: 0.0213s/iter; left time: 996.8095s
	iters: 300, epoch: 1 | loss: 0.7148988
	speed: 0.0211s/iter; left time: 982.0760s
	iters: 400, epoch: 1 | loss: 0.5598096
	speed: 0.0212s/iter; left time: 985.8427s
Epoch: 1 cost time: 12.105722188949585
Epoch: 1, Steps: 469 | Train Loss: 1.169 Vali Loss: 0.589 Vali Acc: 0.827 Test Loss: 0.589 Test Acc: 0.827
Validation loss decreased (inf --> -0.827038).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3892924
	speed: 0.1174s/iter; left time: 5438.3327s
	iters: 200, epoch: 2 | loss: 0.2844411
	speed: 0.0211s/iter; left time: 977.6067s
	iters: 300, epoch: 2 | loss: 0.4256520
	speed: 0.0219s/iter; left time: 1011.7331s
	iters: 400, epoch: 2 | loss: 0.3868979
	speed: 0.0218s/iter; left time: 1003.7463s
Epoch: 2 cost time: 10.390419721603394
Epoch: 2, Steps: 469 | Train Loss: 0.357 Vali Loss: 0.318 Vali Acc: 0.912 Test Loss: 0.318 Test Acc: 0.912
Validation loss decreased (-0.827038 --> -0.911947).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1916182
	speed: 0.1104s/iter; left time: 5062.3133s
	iters: 200, epoch: 3 | loss: 0.1420568
	speed: 0.0207s/iter; left time: 947.1838s
	iters: 300, epoch: 3 | loss: 0.1254610
	speed: 0.0202s/iter; left time: 923.9638s
	iters: 400, epoch: 3 | loss: 0.0409028
	speed: 0.0203s/iter; left time: 924.3704s
Epoch: 3 cost time: 10.082602739334106
Epoch: 3, Steps: 469 | Train Loss: 0.225 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.911947 --> -0.937105).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0776993
	speed: 0.1216s/iter; left time: 5518.8102s
	iters: 200, epoch: 4 | loss: 0.1019138
	speed: 0.0223s/iter; left time: 1011.8824s
	iters: 300, epoch: 4 | loss: 0.0809332
	speed: 0.0215s/iter; left time: 973.4911s
	iters: 400, epoch: 4 | loss: 0.2851484
	speed: 0.0222s/iter; left time: 999.4137s
Epoch: 4 cost time: 10.82744026184082
Epoch: 4, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.937105 --> -0.956545).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1688515
	speed: 0.1202s/iter; left time: 5400.5183s
	iters: 200, epoch: 5 | loss: 0.1817301
	speed: 0.0225s/iter; left time: 1007.9467s
	iters: 300, epoch: 5 | loss: 0.0442021
	speed: 0.0226s/iter; left time: 1010.6483s
	iters: 400, epoch: 5 | loss: 0.2976108
	speed: 0.0220s/iter; left time: 982.6558s
Epoch: 5 cost time: 10.91730785369873
Epoch: 5, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.956545 --> -0.960261).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0958323
	speed: 0.1134s/iter; left time: 5039.4502s
	iters: 200, epoch: 6 | loss: 0.1044553
	speed: 0.0223s/iter; left time: 988.8779s
	iters: 300, epoch: 6 | loss: 0.6224476
	speed: 0.0208s/iter; left time: 918.5119s
	iters: 400, epoch: 6 | loss: 0.0205007
	speed: 0.0219s/iter; left time: 965.8668s
Epoch: 6 cost time: 10.58602786064148
Epoch: 6, Steps: 469 | Train Loss: 0.126 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1931091
	speed: 0.1071s/iter; left time: 4709.1674s
	iters: 200, epoch: 7 | loss: 0.0758786
	speed: 0.0214s/iter; left time: 940.2220s
	iters: 300, epoch: 7 | loss: 0.0947986
	speed: 0.0193s/iter; left time: 846.7344s
	iters: 400, epoch: 7 | loss: 0.0202609
	speed: 0.0201s/iter; left time: 877.5468s
Epoch: 7 cost time: 9.93817663192749
Epoch: 7, Steps: 469 | Train Loss: 0.111 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.960261 --> -0.963978).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1302799
	speed: 0.1075s/iter; left time: 4680.2389s
	iters: 200, epoch: 8 | loss: 0.0132457
	speed: 0.0213s/iter; left time: 926.2581s
	iters: 300, epoch: 8 | loss: 0.0079604
	speed: 0.0221s/iter; left time: 956.0490s
	iters: 400, epoch: 8 | loss: 0.0477321
	speed: 0.0206s/iter; left time: 888.6926s
Epoch: 8 cost time: 10.400830030441284
Epoch: 8, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.963978 --> -0.969696).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1142485
	speed: 0.1220s/iter; left time: 5251.1494s
	iters: 200, epoch: 9 | loss: 0.0101453
	speed: 0.0224s/iter; left time: 960.3066s
	iters: 300, epoch: 9 | loss: 0.1437968
	speed: 0.0220s/iter; left time: 944.1974s
	iters: 400, epoch: 9 | loss: 0.0673743
	speed: 0.0220s/iter; left time: 941.6853s
Epoch: 9 cost time: 10.771645307540894
Epoch: 9, Steps: 469 | Train Loss: 0.093 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0509018
	speed: 0.1189s/iter; left time: 5061.0893s
	iters: 200, epoch: 10 | loss: 0.0596052
	speed: 0.0223s/iter; left time: 947.2191s
	iters: 300, epoch: 10 | loss: 0.0064186
	speed: 0.0209s/iter; left time: 886.7764s
	iters: 400, epoch: 10 | loss: 0.1095034
	speed: 0.0214s/iter; left time: 905.6012s
Epoch: 10 cost time: 10.599944591522217
Epoch: 10, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.969696 --> -0.970268).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0056431
	speed: 0.1121s/iter; left time: 4718.7743s
	iters: 200, epoch: 11 | loss: 0.1382012
	speed: 0.0204s/iter; left time: 858.3976s
	iters: 300, epoch: 11 | loss: 0.0143891
	speed: 0.0200s/iter; left time: 839.3138s
	iters: 400, epoch: 11 | loss: 0.0123395
	speed: 0.0204s/iter; left time: 853.0415s
Epoch: 11 cost time: 9.939574480056763
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0311622
	speed: 0.1082s/iter; left time: 4505.3343s
	iters: 200, epoch: 12 | loss: 0.1132195
	speed: 0.0205s/iter; left time: 849.9714s
	iters: 300, epoch: 12 | loss: 0.0767811
	speed: 0.0212s/iter; left time: 878.0553s
	iters: 400, epoch: 12 | loss: 0.0229520
	speed: 0.0215s/iter; left time: 889.8153s
Epoch: 12 cost time: 10.22477912902832
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1242976
	speed: 0.1119s/iter; left time: 4605.7570s
	iters: 200, epoch: 13 | loss: 0.0098771
	speed: 0.0219s/iter; left time: 898.5557s
	iters: 300, epoch: 13 | loss: 0.0261596
	speed: 0.0212s/iter; left time: 870.3626s
	iters: 400, epoch: 13 | loss: 0.1077679
	speed: 0.0223s/iter; left time: 910.4699s
Epoch: 13 cost time: 10.46942949295044
Epoch: 13, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.970268 --> -0.975985).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0565842
	speed: 0.1072s/iter; left time: 4364.2970s
	iters: 200, epoch: 14 | loss: 0.0240160
	speed: 0.0223s/iter; left time: 906.7411s
	iters: 300, epoch: 14 | loss: 0.1058353
	speed: 0.0220s/iter; left time: 892.9850s
	iters: 400, epoch: 14 | loss: 0.0184259
	speed: 0.0222s/iter; left time: 895.5373s
Epoch: 14 cost time: 10.77832579612732
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0046895
	speed: 0.1155s/iter; left time: 4648.2921s
	iters: 200, epoch: 15 | loss: 0.3478638
	speed: 0.0221s/iter; left time: 885.0139s
	iters: 300, epoch: 15 | loss: 0.0689996
	speed: 0.0213s/iter; left time: 853.0708s
	iters: 400, epoch: 15 | loss: 0.0898056
	speed: 0.0217s/iter; left time: 867.0991s
Epoch: 15 cost time: 10.391066312789917
Epoch: 15, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.975985 --> -0.976271).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0670763
	speed: 0.1174s/iter; left time: 4669.0737s
	iters: 200, epoch: 16 | loss: 0.2328850
	speed: 0.0210s/iter; left time: 832.7550s
	iters: 300, epoch: 16 | loss: 0.0123702
	speed: 0.0218s/iter; left time: 861.1133s
	iters: 400, epoch: 16 | loss: 0.0232165
	speed: 0.0201s/iter; left time: 791.9996s
Epoch: 16 cost time: 10.338335514068604
Epoch: 16, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0204821
	speed: 0.1134s/iter; left time: 4455.0343s
	iters: 200, epoch: 17 | loss: 0.2086328
	speed: 0.0211s/iter; left time: 826.4273s
	iters: 300, epoch: 17 | loss: 0.0487304
	speed: 0.0207s/iter; left time: 809.2460s
	iters: 400, epoch: 17 | loss: 0.0074369
	speed: 0.0209s/iter; left time: 814.4937s
Epoch: 17 cost time: 10.197238683700562
Epoch: 17, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.1028375
	speed: 0.1139s/iter; left time: 4422.4359s
	iters: 200, epoch: 18 | loss: 0.0036029
	speed: 0.0211s/iter; left time: 818.1828s
	iters: 300, epoch: 18 | loss: 0.0041330
	speed: 0.0219s/iter; left time: 847.8768s
	iters: 400, epoch: 18 | loss: 0.0494732
	speed: 0.0205s/iter; left time: 788.9139s
Epoch: 18 cost time: 10.281692028045654
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0159254
	speed: 0.1123s/iter; left time: 4306.3558s
	iters: 200, epoch: 19 | loss: 0.0025973
	speed: 0.0221s/iter; left time: 844.5681s
	iters: 300, epoch: 19 | loss: 0.0034429
	speed: 0.0213s/iter; left time: 813.7902s
	iters: 400, epoch: 19 | loss: 0.0683758
	speed: 0.0231s/iter; left time: 879.5951s
Epoch: 19 cost time: 10.80103611946106
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.3810583
	speed: 0.1204s/iter; left time: 4562.6280s
	iters: 200, epoch: 20 | loss: 0.0053098
	speed: 0.0227s/iter; left time: 859.5366s
	iters: 300, epoch: 20 | loss: 0.0040903
	speed: 0.0225s/iter; left time: 847.4395s
	iters: 400, epoch: 20 | loss: 0.0327493
	speed: 0.0219s/iter; left time: 823.7278s
Epoch: 20 cost time: 10.954772472381592
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0520555
	speed: 0.1242s/iter; left time: 4646.2488s
	iters: 200, epoch: 21 | loss: 0.0179994
	speed: 0.0206s/iter; left time: 767.5069s
	iters: 300, epoch: 21 | loss: 0.0026549
	speed: 0.0214s/iter; left time: 796.1063s
	iters: 400, epoch: 21 | loss: 0.0104079
	speed: 0.0218s/iter; left time: 809.3310s
Epoch: 21 cost time: 10.458646297454834
Epoch: 21, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1029285
	speed: 0.1152s/iter; left time: 4255.8670s
	iters: 200, epoch: 22 | loss: 0.0032656
	speed: 0.0220s/iter; left time: 810.9492s
	iters: 300, epoch: 22 | loss: 0.0040073
	speed: 0.0216s/iter; left time: 792.9317s
	iters: 400, epoch: 22 | loss: 0.1149185
	speed: 0.0215s/iter; left time: 789.6154s
Epoch: 22 cost time: 10.394469976425171
Epoch: 22, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976271 --> -0.976557).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0043066
	speed: 0.1106s/iter; left time: 4036.8427s
	iters: 200, epoch: 23 | loss: 0.1734494
	speed: 0.0206s/iter; left time: 751.2656s
	iters: 300, epoch: 23 | loss: 0.0440483
	speed: 0.0216s/iter; left time: 783.5855s
	iters: 400, epoch: 23 | loss: 0.0330162
	speed: 0.0220s/iter; left time: 797.6165s
Epoch: 23 cost time: 10.535249948501587
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0438225
	speed: 0.1185s/iter; left time: 4265.9502s
	iters: 200, epoch: 24 | loss: 0.0938001
	speed: 0.0232s/iter; left time: 832.2711s
	iters: 300, epoch: 24 | loss: 0.0524734
	speed: 0.0230s/iter; left time: 823.3317s
	iters: 400, epoch: 24 | loss: 0.0054610
	speed: 0.0217s/iter; left time: 773.3308s
Epoch: 24 cost time: 11.044217824935913
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0233969
	speed: 0.1201s/iter; left time: 4270.7160s
	iters: 200, epoch: 25 | loss: 0.0015990
	speed: 0.0224s/iter; left time: 792.3362s
	iters: 300, epoch: 25 | loss: 0.1078407
	speed: 0.0222s/iter; left time: 785.1245s
	iters: 400, epoch: 25 | loss: 0.0049727
	speed: 0.0228s/iter; left time: 802.5700s
Epoch: 25 cost time: 10.93795895576477
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0272475
	speed: 0.1233s/iter; left time: 4323.5525s
	iters: 200, epoch: 26 | loss: 0.2076932
	speed: 0.0218s/iter; left time: 761.9345s
	iters: 300, epoch: 26 | loss: 0.0085052
	speed: 0.0213s/iter; left time: 741.4797s
	iters: 400, epoch: 26 | loss: 0.0004374
	speed: 0.0215s/iter; left time: 746.8111s
Epoch: 26 cost time: 10.47253942489624
Epoch: 26, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.976557 --> -0.977700).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0100435
	speed: 0.1146s/iter; left time: 3965.1943s
	iters: 200, epoch: 27 | loss: 0.0005707
	speed: 0.0210s/iter; left time: 724.1228s
	iters: 300, epoch: 27 | loss: 0.0990262
	speed: 0.0214s/iter; left time: 736.0517s
	iters: 400, epoch: 27 | loss: 0.4191395
	speed: 0.0208s/iter; left time: 712.9084s
Epoch: 27 cost time: 10.025622606277466
Epoch: 27, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.1197503
	speed: 0.1115s/iter; left time: 3804.7501s
	iters: 200, epoch: 28 | loss: 0.0861633
	speed: 0.0208s/iter; left time: 708.2075s
	iters: 300, epoch: 28 | loss: 0.0506980
	speed: 0.0202s/iter; left time: 684.2618s
	iters: 400, epoch: 28 | loss: 0.0024706
	speed: 0.0200s/iter; left time: 676.7176s
Epoch: 28 cost time: 9.953964471817017
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0077084
	speed: 0.1215s/iter; left time: 4089.2735s
	iters: 200, epoch: 29 | loss: 0.0023311
	speed: 0.0220s/iter; left time: 737.7347s
	iters: 300, epoch: 29 | loss: 0.0276545
	speed: 0.0225s/iter; left time: 751.7788s
	iters: 400, epoch: 29 | loss: 0.0006456
	speed: 0.0230s/iter; left time: 768.3992s
Epoch: 29 cost time: 11.059897899627686
Epoch: 29, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0368837
	speed: 0.1307s/iter; left time: 4337.6237s
	iters: 200, epoch: 30 | loss: 0.0007831
	speed: 0.0231s/iter; left time: 763.3643s
	iters: 300, epoch: 30 | loss: 0.0803088
	speed: 0.0228s/iter; left time: 750.7821s
	iters: 400, epoch: 30 | loss: 0.0061335
	speed: 0.0213s/iter; left time: 699.2317s
Epoch: 30 cost time: 11.033004522323608
Epoch: 30, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.977700 --> -0.979130).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.1806566
	speed: 0.1064s/iter; left time: 3482.7415s
	iters: 200, epoch: 31 | loss: 0.0904267
	speed: 0.0202s/iter; left time: 660.7520s
	iters: 300, epoch: 31 | loss: 0.0224624
	speed: 0.0246s/iter; left time: 801.7760s
	iters: 400, epoch: 31 | loss: 0.0336858
	speed: 0.0239s/iter; left time: 775.6256s
Epoch: 31 cost time: 10.575977563858032
Epoch: 31, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0018388
	speed: 0.1098s/iter; left time: 3542.3102s
	iters: 200, epoch: 32 | loss: 0.0007952
	speed: 0.0190s/iter; left time: 610.9406s
	iters: 300, epoch: 32 | loss: 0.0659105
	speed: 0.0198s/iter; left time: 634.6443s
	iters: 400, epoch: 32 | loss: 0.1342950
	speed: 0.0175s/iter; left time: 559.0045s
Epoch: 32 cost time: 9.120864868164062
Epoch: 32, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0176733
	speed: 0.0897s/iter; left time: 2852.6460s
	iters: 200, epoch: 33 | loss: 0.0073155
	speed: 0.0205s/iter; left time: 649.6235s
	iters: 300, epoch: 33 | loss: 0.1754836
	speed: 0.0206s/iter; left time: 649.7280s
	iters: 400, epoch: 33 | loss: 0.4210565
	speed: 0.0205s/iter; left time: 645.8986s
Epoch: 33 cost time: 9.875627756118774
Epoch: 33, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0024357
	speed: 0.1120s/iter; left time: 3507.5065s
	iters: 200, epoch: 34 | loss: 0.0072684
	speed: 0.0207s/iter; left time: 644.8909s
	iters: 300, epoch: 34 | loss: 0.0073779
	speed: 0.0205s/iter; left time: 639.4941s
	iters: 400, epoch: 34 | loss: 0.0070031
	speed: 0.0215s/iter; left time: 665.6004s
Epoch: 34 cost time: 10.16675329208374
Epoch: 34, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.1007538
	speed: 0.1140s/iter; left time: 3516.1225s
	iters: 200, epoch: 35 | loss: 0.0018719
	speed: 0.0200s/iter; left time: 616.6098s
	iters: 300, epoch: 35 | loss: 0.0047278
	speed: 0.0190s/iter; left time: 583.8493s
	iters: 400, epoch: 35 | loss: 0.0062203
	speed: 0.0208s/iter; left time: 635.8228s
Epoch: 35 cost time: 9.836324453353882
Epoch: 35, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0041551
	speed: 0.1074s/iter; left time: 3263.8205s
	iters: 200, epoch: 36 | loss: 0.0094852
	speed: 0.0209s/iter; left time: 633.0396s
	iters: 300, epoch: 36 | loss: 0.0067094
	speed: 0.0216s/iter; left time: 650.9690s
	iters: 400, epoch: 36 | loss: 0.0340532
	speed: 0.0208s/iter; left time: 624.9171s
Epoch: 36 cost time: 10.334234714508057
Epoch: 36, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0087305
	speed: 0.1159s/iter; left time: 3466.1226s
	iters: 200, epoch: 37 | loss: 0.0195346
	speed: 0.0203s/iter; left time: 606.4477s
	iters: 300, epoch: 37 | loss: 0.1539891
	speed: 0.0214s/iter; left time: 635.5714s
	iters: 400, epoch: 37 | loss: 0.0097486
	speed: 0.0218s/iter; left time: 645.3027s
Epoch: 37 cost time: 10.33022665977478
Epoch: 37, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0042198
	speed: 0.1166s/iter; left time: 3434.5910s
	iters: 200, epoch: 38 | loss: 0.0011402
	speed: 0.0223s/iter; left time: 655.1677s
	iters: 300, epoch: 38 | loss: 0.0026877
	speed: 0.0200s/iter; left time: 585.2782s
	iters: 400, epoch: 38 | loss: 0.0203083
	speed: 0.0202s/iter; left time: 589.9342s
Epoch: 38 cost time: 10.287790775299072
Epoch: 38, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0054892
	speed: 0.1102s/iter; left time: 3193.4629s
	iters: 200, epoch: 39 | loss: 0.0005558
	speed: 0.0216s/iter; left time: 624.1787s
	iters: 300, epoch: 39 | loss: 0.0020430
	speed: 0.0197s/iter; left time: 566.6747s
	iters: 400, epoch: 39 | loss: 0.0559508
	speed: 0.0208s/iter; left time: 597.5150s
Epoch: 39 cost time: 10.198829650878906
Epoch: 39, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0108748
	speed: 0.1034s/iter; left time: 2947.9202s
	iters: 200, epoch: 40 | loss: 0.0007330
	speed: 0.0211s/iter; left time: 599.0204s
	iters: 300, epoch: 40 | loss: 0.0680980
	speed: 0.0215s/iter; left time: 608.2493s
	iters: 400, epoch: 40 | loss: 0.0119620
	speed: 0.0208s/iter; left time: 587.5985s
Epoch: 40 cost time: 10.201094388961792
Epoch: 40, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 136418
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5195928
	speed: 0.0415s/iter; left time: 1940.7297s
	iters: 200, epoch: 1 | loss: 1.0337687
	speed: 0.0222s/iter; left time: 1037.9897s
	iters: 300, epoch: 1 | loss: 0.5563595
	speed: 0.0225s/iter; left time: 1049.4395s
	iters: 400, epoch: 1 | loss: 0.8656872
	speed: 0.0222s/iter; left time: 1032.8815s
Epoch: 1 cost time: 12.468451738357544
Epoch: 1, Steps: 469 | Train Loss: 1.162 Vali Loss: 0.558 Vali Acc: 0.828 Test Loss: 0.558 Test Acc: 0.828
Validation loss decreased (inf --> -0.828182).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2291489
	speed: 0.1193s/iter; left time: 5527.4862s
	iters: 200, epoch: 2 | loss: 0.1889848
	speed: 0.0214s/iter; left time: 989.2158s
	iters: 300, epoch: 2 | loss: 0.3344553
	speed: 0.0207s/iter; left time: 952.7811s
	iters: 400, epoch: 2 | loss: 0.3720093
	speed: 0.0215s/iter; left time: 990.8969s
Epoch: 2 cost time: 10.137571811676025
Epoch: 2, Steps: 469 | Train Loss: 0.347 Vali Loss: 0.376 Vali Acc: 0.882 Test Loss: 0.376 Test Acc: 0.882
Validation loss decreased (-0.828182 --> -0.881643).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4602034
	speed: 0.1081s/iter; left time: 4958.3214s
	iters: 200, epoch: 3 | loss: 0.1983346
	speed: 0.0203s/iter; left time: 928.6393s
	iters: 300, epoch: 3 | loss: 0.4008729
	speed: 0.0218s/iter; left time: 993.8962s
	iters: 400, epoch: 3 | loss: 0.0653027
	speed: 0.0217s/iter; left time: 988.5182s
Epoch: 3 cost time: 10.161334037780762
Epoch: 3, Steps: 469 | Train Loss: 0.228 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
Validation loss decreased (-0.881643 --> -0.914806).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0902769
	speed: 0.1087s/iter; left time: 4935.9239s
	iters: 200, epoch: 4 | loss: 0.1869351
	speed: 0.0217s/iter; left time: 984.0471s
	iters: 300, epoch: 4 | loss: 0.2290862
	speed: 0.0211s/iter; left time: 954.3787s
	iters: 400, epoch: 4 | loss: 0.0995690
	speed: 0.0213s/iter; left time: 960.7531s
Epoch: 4 cost time: 10.423118352890015
Epoch: 4, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.245 Vali Acc: 0.934 Test Loss: 0.245 Test Acc: 0.934
Validation loss decreased (-0.914806 --> -0.933960).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1729747
	speed: 0.1159s/iter; left time: 5207.7146s
	iters: 200, epoch: 5 | loss: 0.1553203
	speed: 0.0221s/iter; left time: 989.3505s
	iters: 300, epoch: 5 | loss: 0.0431421
	speed: 0.0224s/iter; left time: 1003.8244s
	iters: 400, epoch: 5 | loss: 0.4618754
	speed: 0.0237s/iter; left time: 1055.8575s
Epoch: 5 cost time: 10.936073541641235
Epoch: 5, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.933960 --> -0.947968).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0171033
	speed: 0.1219s/iter; left time: 5418.5114s
	iters: 200, epoch: 6 | loss: 0.0571909
	speed: 0.0227s/iter; left time: 1006.8807s
	iters: 300, epoch: 6 | loss: 0.0316474
	speed: 0.0221s/iter; left time: 980.1700s
	iters: 400, epoch: 6 | loss: 0.1281895
	speed: 0.0225s/iter; left time: 993.5013s
Epoch: 6 cost time: 10.878551483154297
Epoch: 6, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.947968 --> -0.953400).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1013529
	speed: 0.1195s/iter; left time: 5256.8822s
	iters: 200, epoch: 7 | loss: 0.0509314
	speed: 0.0229s/iter; left time: 1005.7563s
	iters: 300, epoch: 7 | loss: 0.0438396
	speed: 0.0233s/iter; left time: 1018.7949s
	iters: 400, epoch: 7 | loss: 0.1272108
	speed: 0.0207s/iter; left time: 904.5666s
Epoch: 7 cost time: 10.862818956375122
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.953400 --> -0.956545).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0898138
	speed: 0.1113s/iter; left time: 4845.4966s
	iters: 200, epoch: 8 | loss: 0.0870275
	speed: 0.0209s/iter; left time: 906.3822s
	iters: 300, epoch: 8 | loss: 0.1124699
	speed: 0.0219s/iter; left time: 949.6720s
	iters: 400, epoch: 8 | loss: 0.0340872
	speed: 0.0222s/iter; left time: 959.6842s
Epoch: 8 cost time: 10.59330701828003
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956545 --> -0.958546).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5361849
	speed: 0.1197s/iter; left time: 5154.2250s
	iters: 200, epoch: 9 | loss: 0.0887316
	speed: 0.0221s/iter; left time: 950.6292s
	iters: 300, epoch: 9 | loss: 0.0290638
	speed: 0.0210s/iter; left time: 901.0342s
	iters: 400, epoch: 9 | loss: 0.0337970
	speed: 0.0212s/iter; left time: 906.7574s
Epoch: 9 cost time: 10.579176187515259
Epoch: 9, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.958546 --> -0.961977).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0038731
	speed: 0.1164s/iter; left time: 4954.3755s
	iters: 200, epoch: 10 | loss: 0.0472646
	speed: 0.0212s/iter; left time: 901.4441s
	iters: 300, epoch: 10 | loss: 0.0471976
	speed: 0.0221s/iter; left time: 936.9819s
	iters: 400, epoch: 10 | loss: 0.0147155
	speed: 0.0227s/iter; left time: 957.7637s
Epoch: 10 cost time: 10.585183382034302
Epoch: 10, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.961977 --> -0.967123).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0454158
	speed: 0.1191s/iter; left time: 5017.3118s
	iters: 200, epoch: 11 | loss: 0.0299595
	speed: 0.0223s/iter; left time: 938.5843s
	iters: 300, epoch: 11 | loss: 0.1307086
	speed: 0.0209s/iter; left time: 877.4925s
	iters: 400, epoch: 11 | loss: 0.0295913
	speed: 0.0211s/iter; left time: 882.1569s
Epoch: 11 cost time: 10.551907539367676
Epoch: 11, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0434571
	speed: 0.1193s/iter; left time: 4966.8438s
	iters: 200, epoch: 12 | loss: 0.1416698
	speed: 0.0215s/iter; left time: 893.7517s
	iters: 300, epoch: 12 | loss: 0.0799938
	speed: 0.0230s/iter; left time: 955.1214s
	iters: 400, epoch: 12 | loss: 0.0850233
	speed: 0.0216s/iter; left time: 894.9696s
Epoch: 12 cost time: 10.57075810432434
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0203709
	speed: 0.1092s/iter; left time: 4494.7687s
	iters: 200, epoch: 13 | loss: 0.0372832
	speed: 0.0213s/iter; left time: 874.6130s
	iters: 300, epoch: 13 | loss: 0.0268572
	speed: 0.0214s/iter; left time: 878.8594s
	iters: 400, epoch: 13 | loss: 0.0894159
	speed: 0.0219s/iter; left time: 894.1336s
Epoch: 13 cost time: 10.440827369689941
Epoch: 13, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.967123 --> -0.972555).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0263774
	speed: 0.1139s/iter; left time: 4635.3790s
	iters: 200, epoch: 14 | loss: 0.1121771
	speed: 0.0225s/iter; left time: 913.9745s
	iters: 300, epoch: 14 | loss: 0.0080939
	speed: 0.0226s/iter; left time: 914.6001s
	iters: 400, epoch: 14 | loss: 0.0114130
	speed: 0.0218s/iter; left time: 881.2610s
Epoch: 14 cost time: 10.916170597076416
Epoch: 14, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0553442
	speed: 0.1120s/iter; left time: 4504.5809s
	iters: 200, epoch: 15 | loss: 0.0408244
	speed: 0.0206s/iter; left time: 824.9242s
	iters: 300, epoch: 15 | loss: 0.1249466
	speed: 0.0210s/iter; left time: 841.2959s
	iters: 400, epoch: 15 | loss: 0.0094538
	speed: 0.0212s/iter; left time: 846.9559s
Epoch: 15 cost time: 10.38778281211853
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.972840).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.6473783
	speed: 0.1223s/iter; left time: 4863.2807s
	iters: 200, epoch: 16 | loss: 0.0621821
	speed: 0.0205s/iter; left time: 815.1136s
	iters: 300, epoch: 16 | loss: 0.0128871
	speed: 0.0206s/iter; left time: 813.9146s
	iters: 400, epoch: 16 | loss: 0.0308234
	speed: 0.0218s/iter; left time: 859.1087s
Epoch: 16 cost time: 10.29390287399292
Epoch: 16, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.976557).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0747173
	speed: 0.1133s/iter; left time: 4452.5025s
	iters: 200, epoch: 17 | loss: 0.0226706
	speed: 0.0214s/iter; left time: 838.3283s
	iters: 300, epoch: 17 | loss: 0.0140762
	speed: 0.0218s/iter; left time: 852.2646s
	iters: 400, epoch: 17 | loss: 0.0069960
	speed: 0.0219s/iter; left time: 855.4991s
Epoch: 17 cost time: 10.522236585617065
Epoch: 17, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0159747
	speed: 0.1134s/iter; left time: 4404.7372s
	iters: 200, epoch: 18 | loss: 0.0343730
	speed: 0.0218s/iter; left time: 844.5404s
	iters: 300, epoch: 18 | loss: 0.0112069
	speed: 0.0216s/iter; left time: 834.3510s
	iters: 400, epoch: 18 | loss: 0.0385872
	speed: 0.0231s/iter; left time: 890.8833s
Epoch: 18 cost time: 10.646725177764893
Epoch: 18, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976843).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0027812
	speed: 0.1121s/iter; left time: 4300.1143s
	iters: 200, epoch: 19 | loss: 0.2220619
	speed: 0.0207s/iter; left time: 791.7136s
	iters: 300, epoch: 19 | loss: 0.0299592
	speed: 0.0219s/iter; left time: 837.2426s
	iters: 400, epoch: 19 | loss: 0.0195217
	speed: 0.0210s/iter; left time: 800.4914s
Epoch: 19 cost time: 10.2362699508667
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0074374
	speed: 0.1073s/iter; left time: 4065.6800s
	iters: 200, epoch: 20 | loss: 0.0040951
	speed: 0.0209s/iter; left time: 788.4173s
	iters: 300, epoch: 20 | loss: 0.0167637
	speed: 0.0202s/iter; left time: 759.6317s
	iters: 400, epoch: 20 | loss: 0.0175754
	speed: 0.0204s/iter; left time: 767.3926s
Epoch: 20 cost time: 9.963775396347046
Epoch: 20, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0132190
	speed: 0.1108s/iter; left time: 4147.6784s
	iters: 200, epoch: 21 | loss: 0.0059765
	speed: 0.0210s/iter; left time: 782.1569s
	iters: 300, epoch: 21 | loss: 0.2022214
	speed: 0.0224s/iter; left time: 832.0285s
	iters: 400, epoch: 21 | loss: 0.2109297
	speed: 0.0214s/iter; left time: 792.5459s
Epoch: 21 cost time: 10.362083196640015
Epoch: 21, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0089596
	speed: 0.1197s/iter; left time: 4424.7361s
	iters: 200, epoch: 22 | loss: 0.3811825
	speed: 0.0223s/iter; left time: 820.1325s
	iters: 300, epoch: 22 | loss: 0.0093902
	speed: 0.0234s/iter; left time: 860.3543s
	iters: 400, epoch: 22 | loss: 0.0072150
	speed: 0.0217s/iter; left time: 797.0636s
Epoch: 22 cost time: 10.912764072418213
Epoch: 22, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.978272).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0063048
	speed: 0.1113s/iter; left time: 4060.3357s
	iters: 200, epoch: 23 | loss: 0.0083659
	speed: 0.0217s/iter; left time: 790.2907s
	iters: 300, epoch: 23 | loss: 0.0203271
	speed: 0.0214s/iter; left time: 778.0430s
	iters: 400, epoch: 23 | loss: 0.0014483
	speed: 0.0216s/iter; left time: 780.7110s
Epoch: 23 cost time: 10.463085651397705
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.979416).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.1436381
	speed: 0.1099s/iter; left time: 3958.3403s
	iters: 200, epoch: 24 | loss: 0.0758254
	speed: 0.0216s/iter; left time: 775.8204s
	iters: 300, epoch: 24 | loss: 0.0533979
	speed: 0.0212s/iter; left time: 758.9509s
	iters: 400, epoch: 24 | loss: 0.0789579
	speed: 0.0218s/iter; left time: 779.8787s
Epoch: 24 cost time: 10.369427680969238
Epoch: 24, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0032937
	speed: 0.1106s/iter; left time: 3931.0324s
	iters: 200, epoch: 25 | loss: 0.0171932
	speed: 0.0216s/iter; left time: 765.1160s
	iters: 300, epoch: 25 | loss: 0.1706879
	speed: 0.0209s/iter; left time: 738.9717s
	iters: 400, epoch: 25 | loss: 0.0175308
	speed: 0.0232s/iter; left time: 816.9880s
Epoch: 25 cost time: 10.5896635055542
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0528059
	speed: 0.1199s/iter; left time: 4204.3075s
	iters: 200, epoch: 26 | loss: 0.0149939
	speed: 0.0233s/iter; left time: 814.2367s
	iters: 300, epoch: 26 | loss: 0.0065395
	speed: 0.0240s/iter; left time: 835.3643s
	iters: 400, epoch: 26 | loss: 0.1284252
	speed: 0.0221s/iter; left time: 767.8072s
Epoch: 26 cost time: 11.06465458869934
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0334877
	speed: 0.1221s/iter; left time: 4224.4332s
	iters: 200, epoch: 27 | loss: 0.0013680
	speed: 0.0225s/iter; left time: 777.1887s
	iters: 300, epoch: 27 | loss: 0.1801030
	speed: 0.0217s/iter; left time: 746.4145s
	iters: 400, epoch: 27 | loss: 0.0024965
	speed: 0.0211s/iter; left time: 723.7449s
Epoch: 27 cost time: 10.66369342803955
Epoch: 27, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0085510
	speed: 0.1143s/iter; left time: 3902.0527s
	iters: 200, epoch: 28 | loss: 0.0391782
	speed: 0.0215s/iter; left time: 730.9926s
	iters: 300, epoch: 28 | loss: 0.0092684
	speed: 0.0218s/iter; left time: 738.7299s
	iters: 400, epoch: 28 | loss: 0.0109033
	speed: 0.0218s/iter; left time: 737.5587s
Epoch: 28 cost time: 10.634386539459229
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.1909157
	speed: 0.1146s/iter; left time: 3858.0816s
	iters: 200, epoch: 29 | loss: 0.1063214
	speed: 0.0225s/iter; left time: 756.3461s
	iters: 300, epoch: 29 | loss: 0.0797361
	speed: 0.0213s/iter; left time: 713.6925s
	iters: 400, epoch: 29 | loss: 0.0030652
	speed: 0.0204s/iter; left time: 681.7164s
Epoch: 29 cost time: 10.418628215789795
Epoch: 29, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0301346
	speed: 0.1086s/iter; left time: 3606.4880s
	iters: 200, epoch: 30 | loss: 0.0051230
	speed: 0.0216s/iter; left time: 714.3678s
	iters: 300, epoch: 30 | loss: 0.0037458
	speed: 0.0210s/iter; left time: 692.6120s
	iters: 400, epoch: 30 | loss: 0.0031588
	speed: 0.0219s/iter; left time: 720.2276s
Epoch: 30 cost time: 10.47926640510559
Epoch: 30, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0223430
	speed: 0.1233s/iter; left time: 4037.3145s
	iters: 200, epoch: 31 | loss: 0.0960390
	speed: 0.0225s/iter; left time: 733.5907s
	iters: 300, epoch: 31 | loss: 0.0373695
	speed: 0.0222s/iter; left time: 721.7049s
	iters: 400, epoch: 31 | loss: 0.0025638
	speed: 0.0224s/iter; left time: 726.9577s
Epoch: 31 cost time: 10.758010625839233
Epoch: 31, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
Validation loss decreased (-0.979416 --> -0.979416).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0007693
	speed: 0.1171s/iter; left time: 3778.8428s
	iters: 200, epoch: 32 | loss: 0.0074152
	speed: 0.0222s/iter; left time: 715.2834s
	iters: 300, epoch: 32 | loss: 0.0416459
	speed: 0.0224s/iter; left time: 717.0933s
	iters: 400, epoch: 32 | loss: 0.0028274
	speed: 0.0221s/iter; left time: 707.4699s
Epoch: 32 cost time: 10.90526008605957
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979416 --> -0.982561).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0013463
	speed: 0.1101s/iter; left time: 3499.1380s
	iters: 200, epoch: 33 | loss: 0.0324879
	speed: 0.0209s/iter; left time: 663.1689s
	iters: 300, epoch: 33 | loss: 0.0965925
	speed: 0.0213s/iter; left time: 673.0702s
	iters: 400, epoch: 33 | loss: 0.0164392
	speed: 0.0204s/iter; left time: 640.9231s
Epoch: 33 cost time: 10.278215885162354
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0064164
	speed: 0.1189s/iter; left time: 3723.5162s
	iters: 200, epoch: 34 | loss: 0.0013230
	speed: 0.0220s/iter; left time: 687.4131s
	iters: 300, epoch: 34 | loss: 0.0004513
	speed: 0.0213s/iter; left time: 664.4619s
	iters: 400, epoch: 34 | loss: 0.1541095
	speed: 0.0213s/iter; left time: 662.2097s
Epoch: 34 cost time: 10.512268543243408
Epoch: 34, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0278246
	speed: 0.1162s/iter; left time: 3585.1697s
	iters: 200, epoch: 35 | loss: 0.0647950
	speed: 0.0214s/iter; left time: 657.0180s
	iters: 300, epoch: 35 | loss: 0.0033540
	speed: 0.0199s/iter; left time: 610.2678s
	iters: 400, epoch: 35 | loss: 0.0751461
	speed: 0.0204s/iter; left time: 623.4237s
Epoch: 35 cost time: 10.1039457321167
Epoch: 35, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0018265
	speed: 0.1212s/iter; left time: 3682.7476s
	iters: 200, epoch: 36 | loss: 0.0043808
	speed: 0.0216s/iter; left time: 654.9445s
	iters: 300, epoch: 36 | loss: 0.0015945
	speed: 0.0226s/iter; left time: 680.9952s
	iters: 400, epoch: 36 | loss: 0.0016672
	speed: 0.0224s/iter; left time: 673.0457s
Epoch: 36 cost time: 10.84657073020935
Epoch: 36, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0117505
	speed: 0.1193s/iter; left time: 3568.7215s
	iters: 200, epoch: 37 | loss: 0.0267988
	speed: 0.0220s/iter; left time: 655.8971s
	iters: 300, epoch: 37 | loss: 0.0037236
	speed: 0.0222s/iter; left time: 659.0905s
	iters: 400, epoch: 37 | loss: 0.1371187
	speed: 0.0230s/iter; left time: 681.8055s
Epoch: 37 cost time: 10.886706590652466
Epoch: 37, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0163810
	speed: 0.1181s/iter; left time: 3478.8236s
	iters: 200, epoch: 38 | loss: 0.0069197
	speed: 0.0222s/iter; left time: 650.3936s
	iters: 300, epoch: 38 | loss: 0.0077888
	speed: 0.0218s/iter; left time: 637.9091s
	iters: 400, epoch: 38 | loss: 0.0538641
	speed: 0.0222s/iter; left time: 647.2053s
Epoch: 38 cost time: 10.743008852005005
Epoch: 38, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0083575
	speed: 0.1160s/iter; left time: 3362.5286s
	iters: 200, epoch: 39 | loss: 0.0012975
	speed: 0.0224s/iter; left time: 647.9901s
	iters: 300, epoch: 39 | loss: 0.0719416
	speed: 0.0219s/iter; left time: 630.9564s
	iters: 400, epoch: 39 | loss: 0.0013316
	speed: 0.0230s/iter; left time: 658.9389s
Epoch: 39 cost time: 10.84972882270813
Epoch: 39, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.0184756
	speed: 0.1167s/iter; left time: 3325.8549s
	iters: 200, epoch: 40 | loss: 0.0086469
	speed: 0.0223s/iter; left time: 633.8456s
	iters: 300, epoch: 40 | loss: 0.0306635
	speed: 0.0214s/iter; left time: 604.6977s
	iters: 400, epoch: 40 | loss: 0.0600614
	speed: 0.0224s/iter; left time: 630.5800s
Epoch: 40 cost time: 10.74786925315857
Epoch: 40, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0802940
	speed: 0.1243s/iter; left time: 3486.4345s
	iters: 200, epoch: 41 | loss: 0.0007261
	speed: 0.0227s/iter; left time: 634.2436s
	iters: 300, epoch: 41 | loss: 0.0493402
	speed: 0.0225s/iter; left time: 625.4092s
	iters: 400, epoch: 41 | loss: 0.3788269
	speed: 0.0215s/iter; left time: 596.2871s
Epoch: 41 cost time: 10.77647089958191
Epoch: 41, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.1185197
	speed: 0.1215s/iter; left time: 3349.5626s
	iters: 200, epoch: 42 | loss: 0.0100361
	speed: 0.0222s/iter; left time: 610.0475s
	iters: 300, epoch: 42 | loss: 0.0024471
	speed: 0.0226s/iter; left time: 619.7693s
	iters: 400, epoch: 42 | loss: 0.0051539
	speed: 0.0221s/iter; left time: 603.2447s
Epoch: 42 cost time: 10.956144332885742
Epoch: 42, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9825614636935391
model parameter : 70882
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5845973
	speed: 0.0398s/iter; left time: 1860.6845s
	iters: 200, epoch: 1 | loss: 1.1305318
	speed: 0.0215s/iter; left time: 1005.7281s
	iters: 300, epoch: 1 | loss: 0.5697874
	speed: 0.0207s/iter; left time: 965.2181s
	iters: 400, epoch: 1 | loss: 0.9054589
	speed: 0.0220s/iter; left time: 1024.0093s
Epoch: 1 cost time: 11.897463321685791
Epoch: 1, Steps: 469 | Train Loss: 1.192 Vali Loss: 0.580 Vali Acc: 0.820 Test Loss: 0.580 Test Acc: 0.820
Validation loss decreased (inf --> -0.820463).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2503158
	speed: 0.1095s/iter; left time: 5074.6234s
	iters: 200, epoch: 2 | loss: 0.1888268
	speed: 0.0211s/iter; left time: 975.5917s
	iters: 300, epoch: 2 | loss: 0.3139504
	speed: 0.0214s/iter; left time: 986.1813s
	iters: 400, epoch: 2 | loss: 0.4011876
	speed: 0.0223s/iter; left time: 1028.6386s
Epoch: 2 cost time: 10.523066520690918
Epoch: 2, Steps: 469 | Train Loss: 0.360 Vali Loss: 0.366 Vali Acc: 0.885 Test Loss: 0.366 Test Acc: 0.885
Validation loss decreased (-0.820463 --> -0.884788).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5463319
	speed: 0.1169s/iter; left time: 5361.5560s
	iters: 200, epoch: 3 | loss: 0.1980020
	speed: 0.0224s/iter; left time: 1023.4085s
	iters: 300, epoch: 3 | loss: 0.5044531
	speed: 0.0230s/iter; left time: 1050.6923s
	iters: 400, epoch: 3 | loss: 0.0486346
	speed: 0.0220s/iter; left time: 1003.3343s
Epoch: 3 cost time: 10.914491653442383
Epoch: 3, Steps: 469 | Train Loss: 0.239 Vali Loss: 0.274 Vali Acc: 0.920 Test Loss: 0.274 Test Acc: 0.920
Validation loss decreased (-0.884788 --> -0.920237).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1357630
	speed: 0.1222s/iter; left time: 5546.5320s
	iters: 200, epoch: 4 | loss: 0.1927135
	speed: 0.0226s/iter; left time: 1022.1063s
	iters: 300, epoch: 4 | loss: 0.2788799
	speed: 0.0233s/iter; left time: 1053.9317s
	iters: 400, epoch: 4 | loss: 0.1179863
	speed: 0.0212s/iter; left time: 957.1226s
Epoch: 4 cost time: 10.976658821105957
Epoch: 4, Steps: 469 | Train Loss: 0.176 Vali Loss: 0.239 Vali Acc: 0.938 Test Loss: 0.239 Test Acc: 0.938
Validation loss decreased (-0.920237 --> -0.937962).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1296508
	speed: 0.1174s/iter; left time: 5276.2285s
	iters: 200, epoch: 5 | loss: 0.1333905
	speed: 0.0220s/iter; left time: 985.7299s
	iters: 300, epoch: 5 | loss: 0.0731056
	speed: 0.0231s/iter; left time: 1034.8879s
	iters: 400, epoch: 5 | loss: 0.5099893
	speed: 0.0216s/iter; left time: 964.0782s
Epoch: 5 cost time: 10.750422239303589
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.209 Vali Acc: 0.947 Test Loss: 0.209 Test Acc: 0.947
Validation loss decreased (-0.937962 --> -0.947396).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0154979
	speed: 0.1118s/iter; left time: 4968.6659s
	iters: 200, epoch: 6 | loss: 0.1094066
	speed: 0.0208s/iter; left time: 922.4200s
	iters: 300, epoch: 6 | loss: 0.0348787
	speed: 0.0227s/iter; left time: 1002.7646s
	iters: 400, epoch: 6 | loss: 0.1303320
	speed: 0.0214s/iter; left time: 943.8178s
Epoch: 6 cost time: 10.501846075057983
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.176 Vali Acc: 0.955 Test Loss: 0.176 Test Acc: 0.955
Validation loss decreased (-0.947396 --> -0.955401).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1363324
	speed: 0.1100s/iter; left time: 4839.5369s
	iters: 200, epoch: 7 | loss: 0.0555238
	speed: 0.0227s/iter; left time: 994.0433s
	iters: 300, epoch: 7 | loss: 0.0290222
	speed: 0.0210s/iter; left time: 921.7140s
	iters: 400, epoch: 7 | loss: 0.1074883
	speed: 0.0228s/iter; left time: 995.3445s
Epoch: 7 cost time: 10.635258674621582
Epoch: 7, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.1001053
	speed: 0.1228s/iter; left time: 5345.0281s
	iters: 200, epoch: 8 | loss: 0.1093178
	speed: 0.0227s/iter; left time: 984.0260s
	iters: 300, epoch: 8 | loss: 0.1238597
	speed: 0.0227s/iter; left time: 981.5509s
	iters: 400, epoch: 8 | loss: 0.0311136
	speed: 0.0215s/iter; left time: 931.1211s
Epoch: 8 cost time: 10.94511079788208
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955401 --> -0.955973).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4099867
	speed: 0.1257s/iter; left time: 5412.5358s
	iters: 200, epoch: 9 | loss: 0.0829854
	speed: 0.0210s/iter; left time: 900.1737s
	iters: 300, epoch: 9 | loss: 0.0361191
	speed: 0.0224s/iter; left time: 960.6518s
	iters: 400, epoch: 9 | loss: 0.0188221
	speed: 0.0222s/iter; left time: 948.9628s
Epoch: 9 cost time: 10.551966667175293
Epoch: 9, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.955973 --> -0.956831).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0041614
	speed: 0.1122s/iter; left time: 4778.4500s
	iters: 200, epoch: 10 | loss: 0.0827210
	speed: 0.0205s/iter; left time: 871.9414s
	iters: 300, epoch: 10 | loss: 0.0908341
	speed: 0.0209s/iter; left time: 886.6271s
	iters: 400, epoch: 10 | loss: 0.0078387
	speed: 0.0201s/iter; left time: 850.9798s
Epoch: 10 cost time: 10.079726457595825
Epoch: 10, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.956831 --> -0.966837).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0434545
	speed: 0.1084s/iter; left time: 4566.1908s
	iters: 200, epoch: 11 | loss: 0.0243561
	speed: 0.0198s/iter; left time: 831.9031s
	iters: 300, epoch: 11 | loss: 0.0945311
	speed: 0.0209s/iter; left time: 874.1566s
	iters: 400, epoch: 11 | loss: 0.0352886
	speed: 0.0210s/iter; left time: 877.8143s
Epoch: 11 cost time: 10.112220764160156
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.966837 --> -0.968552).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0096860
	speed: 0.1105s/iter; left time: 4601.5592s
	iters: 200, epoch: 12 | loss: 0.1018754
	speed: 0.0214s/iter; left time: 890.3400s
	iters: 300, epoch: 12 | loss: 0.0278833
	speed: 0.0210s/iter; left time: 872.3502s
	iters: 400, epoch: 12 | loss: 0.3430206
	speed: 0.0209s/iter; left time: 864.1733s
Epoch: 12 cost time: 10.445589303970337
Epoch: 12, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0346691
	speed: 0.1243s/iter; left time: 5119.6043s
	iters: 200, epoch: 13 | loss: 0.0664640
	speed: 0.0222s/iter; left time: 913.0858s
	iters: 300, epoch: 13 | loss: 0.0393619
	speed: 0.0218s/iter; left time: 891.3762s
	iters: 400, epoch: 13 | loss: 0.1170124
	speed: 0.0219s/iter; left time: 894.2249s
Epoch: 13 cost time: 10.811762809753418
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.968552 --> -0.969410).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0744502
	speed: 0.1235s/iter; left time: 5028.9284s
	iters: 200, epoch: 14 | loss: 0.1113374
	speed: 0.0236s/iter; left time: 956.5421s
	iters: 300, epoch: 14 | loss: 0.0157141
	speed: 0.0227s/iter; left time: 918.3724s
	iters: 400, epoch: 14 | loss: 0.0238578
	speed: 0.0225s/iter; left time: 910.2882s
Epoch: 14 cost time: 11.026180267333984
Epoch: 14, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.972555).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0189564
	speed: 0.1184s/iter; left time: 4763.8574s
	iters: 200, epoch: 15 | loss: 0.0174053
	speed: 0.0210s/iter; left time: 843.3812s
	iters: 300, epoch: 15 | loss: 0.0966190
	speed: 0.0220s/iter; left time: 881.6849s
	iters: 400, epoch: 15 | loss: 0.0158417
	speed: 0.0224s/iter; left time: 894.0037s
Epoch: 15 cost time: 10.627133131027222
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.6491371
	speed: 0.1213s/iter; left time: 4823.0325s
	iters: 200, epoch: 16 | loss: 0.1165415
	speed: 0.0220s/iter; left time: 872.6425s
	iters: 300, epoch: 16 | loss: 0.0147373
	speed: 0.0226s/iter; left time: 892.8076s
	iters: 400, epoch: 16 | loss: 0.1451065
	speed: 0.0219s/iter; left time: 864.3153s
Epoch: 16 cost time: 10.900720596313477
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.0622776
	speed: 0.1188s/iter; left time: 4669.5007s
	iters: 200, epoch: 17 | loss: 0.0268672
	speed: 0.0232s/iter; left time: 910.5776s
	iters: 300, epoch: 17 | loss: 0.0062347
	speed: 0.0225s/iter; left time: 878.2891s
	iters: 400, epoch: 17 | loss: 0.0120354
	speed: 0.0215s/iter; left time: 839.7838s
Epoch: 17 cost time: 10.7686767578125
Epoch: 17, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0367293
	speed: 0.1238s/iter; left time: 4808.1982s
	iters: 200, epoch: 18 | loss: 0.0126500
	speed: 0.0221s/iter; left time: 854.5020s
	iters: 300, epoch: 18 | loss: 0.0111518
	speed: 0.0209s/iter; left time: 807.6460s
	iters: 400, epoch: 18 | loss: 0.1140196
	speed: 0.0206s/iter; left time: 792.9753s
Epoch: 18 cost time: 10.42869520187378
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.972555).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0050880
	speed: 0.1207s/iter; left time: 4628.6814s
	iters: 200, epoch: 19 | loss: 0.2300753
	speed: 0.0216s/iter; left time: 825.8404s
	iters: 300, epoch: 19 | loss: 0.0298261
	speed: 0.0218s/iter; left time: 831.6320s
	iters: 400, epoch: 19 | loss: 0.0234583
	speed: 0.0205s/iter; left time: 782.1036s
Epoch: 19 cost time: 10.587264776229858
Epoch: 19, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973698).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0386462
	speed: 0.1175s/iter; left time: 4450.8965s
	iters: 200, epoch: 20 | loss: 0.0593155
	speed: 0.0210s/iter; left time: 793.2964s
	iters: 300, epoch: 20 | loss: 0.0217905
	speed: 0.0212s/iter; left time: 800.1278s
	iters: 400, epoch: 20 | loss: 0.0205682
	speed: 0.0215s/iter; left time: 807.0702s
Epoch: 20 cost time: 10.278647422790527
Epoch: 20, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.1746359
	speed: 0.1107s/iter; left time: 4142.5981s
	iters: 200, epoch: 21 | loss: 0.0054958
	speed: 0.0216s/iter; left time: 804.6556s
	iters: 300, epoch: 21 | loss: 0.1203470
	speed: 0.0215s/iter; left time: 800.7210s
	iters: 400, epoch: 21 | loss: 0.0745258
	speed: 0.0207s/iter; left time: 766.9434s
Epoch: 21 cost time: 10.368283748626709
Epoch: 21, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.973698 --> -0.974556).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0150972
	speed: 0.1110s/iter; left time: 4102.4065s
	iters: 200, epoch: 22 | loss: 0.4496656
	speed: 0.0213s/iter; left time: 783.4277s
	iters: 300, epoch: 22 | loss: 0.0365344
	speed: 0.0221s/iter; left time: 811.2381s
	iters: 400, epoch: 22 | loss: 0.0046651
	speed: 0.0201s/iter; left time: 737.8622s
Epoch: 22 cost time: 10.297022581100464
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0057628
	speed: 0.1165s/iter; left time: 4250.6526s
	iters: 200, epoch: 23 | loss: 0.0045847
	speed: 0.0213s/iter; left time: 773.3535s
	iters: 300, epoch: 23 | loss: 0.0068723
	speed: 0.0216s/iter; left time: 785.4104s
	iters: 400, epoch: 23 | loss: 0.0084953
	speed: 0.0210s/iter; left time: 760.0736s
Epoch: 23 cost time: 10.420222759246826
Epoch: 23, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.975699).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0455232
	speed: 0.1225s/iter; left time: 4412.6803s
	iters: 200, epoch: 24 | loss: 0.0563043
	speed: 0.0216s/iter; left time: 774.9879s
	iters: 300, epoch: 24 | loss: 0.0954774
	speed: 0.0225s/iter; left time: 806.2095s
	iters: 400, epoch: 24 | loss: 0.1113716
	speed: 0.0217s/iter; left time: 773.3600s
Epoch: 24 cost time: 10.781869649887085
Epoch: 24, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0123194
	speed: 0.1138s/iter; left time: 4044.6426s
	iters: 200, epoch: 25 | loss: 0.0339374
	speed: 0.0214s/iter; left time: 758.3042s
	iters: 300, epoch: 25 | loss: 0.0515200
	speed: 0.0209s/iter; left time: 737.5406s
	iters: 400, epoch: 25 | loss: 0.0826247
	speed: 0.0209s/iter; left time: 738.3647s
Epoch: 25 cost time: 10.279349088668823
Epoch: 25, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0264997
	speed: 0.1101s/iter; left time: 3862.4049s
	iters: 200, epoch: 26 | loss: 0.0135562
	speed: 0.0210s/iter; left time: 735.9573s
	iters: 300, epoch: 26 | loss: 0.0083148
	speed: 0.0216s/iter; left time: 754.7504s
	iters: 400, epoch: 26 | loss: 0.0936802
	speed: 0.0210s/iter; left time: 730.3887s
Epoch: 26 cost time: 10.354862451553345
Epoch: 26, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977129).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0341195
	speed: 0.1177s/iter; left time: 4074.4804s
	iters: 200, epoch: 27 | loss: 0.0192331
	speed: 0.0213s/iter; left time: 733.3092s
	iters: 300, epoch: 27 | loss: 0.0361619
	speed: 0.0202s/iter; left time: 696.6402s
	iters: 400, epoch: 27 | loss: 0.0051044
	speed: 0.0204s/iter; left time: 699.9296s
Epoch: 27 cost time: 10.171342134475708
Epoch: 27, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977129 --> -0.978272).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.2122175
	speed: 0.1109s/iter; left time: 3785.1249s
	iters: 200, epoch: 28 | loss: 0.2598497
	speed: 0.0223s/iter; left time: 758.2691s
	iters: 300, epoch: 28 | loss: 0.0111549
	speed: 0.0218s/iter; left time: 739.2358s
	iters: 400, epoch: 28 | loss: 0.0072653
	speed: 0.0221s/iter; left time: 746.5158s
Epoch: 28 cost time: 10.754343032836914
Epoch: 28, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.978272 --> -0.978272).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0743263
	speed: 0.1199s/iter; left time: 4037.5945s
	iters: 200, epoch: 29 | loss: 0.2405785
	speed: 0.0213s/iter; left time: 713.6106s
	iters: 300, epoch: 29 | loss: 0.0807206
	speed: 0.0214s/iter; left time: 717.8796s
	iters: 400, epoch: 29 | loss: 0.0014350
	speed: 0.0222s/iter; left time: 739.9743s
Epoch: 29 cost time: 10.57715106010437
Epoch: 29, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.978272 --> -0.978558).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0336489
	speed: 0.1147s/iter; left time: 3809.5592s
	iters: 200, epoch: 30 | loss: 0.0778034
	speed: 0.0208s/iter; left time: 686.8304s
	iters: 300, epoch: 30 | loss: 0.0016118
	speed: 0.0224s/iter; left time: 739.7224s
	iters: 400, epoch: 30 | loss: 0.0392112
	speed: 0.0198s/iter; left time: 652.0597s
Epoch: 30 cost time: 10.292274475097656
Epoch: 30, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 31 | loss: 0.0142667
	speed: 0.1084s/iter; left time: 3548.3252s
	iters: 200, epoch: 31 | loss: 0.0561881
	speed: 0.0203s/iter; left time: 662.4744s
	iters: 300, epoch: 31 | loss: 0.0071881
	speed: 0.0207s/iter; left time: 672.8596s
	iters: 400, epoch: 31 | loss: 0.0014946
	speed: 0.0213s/iter; left time: 689.1976s
Epoch: 31 cost time: 10.174491167068481
Epoch: 31, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 32 | loss: 0.0002852
	speed: 0.1082s/iter; left time: 3489.5864s
	iters: 200, epoch: 32 | loss: 0.0061958
	speed: 0.0220s/iter; left time: 706.4354s
	iters: 300, epoch: 32 | loss: 0.0086795
	speed: 0.0218s/iter; left time: 700.0908s
	iters: 400, epoch: 32 | loss: 0.0068995
	speed: 0.0206s/iter; left time: 658.9280s
Epoch: 32 cost time: 10.331599235534668
Epoch: 32, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979988).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0012586
	speed: 0.1151s/iter; left time: 3657.9544s
	iters: 200, epoch: 33 | loss: 0.0204346
	speed: 0.0215s/iter; left time: 681.8986s
	iters: 300, epoch: 33 | loss: 0.0304851
	speed: 0.0213s/iter; left time: 673.2981s
	iters: 400, epoch: 33 | loss: 0.0085363
	speed: 0.0222s/iter; left time: 699.2344s
Epoch: 33 cost time: 10.339088439941406
Epoch: 33, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0067648
	speed: 0.1187s/iter; left time: 3717.2553s
	iters: 200, epoch: 34 | loss: 0.0042932
	speed: 0.0211s/iter; left time: 658.5070s
	iters: 300, epoch: 34 | loss: 0.0030636
	speed: 0.0213s/iter; left time: 664.3051s
	iters: 400, epoch: 34 | loss: 0.0815860
	speed: 0.0212s/iter; left time: 656.4007s
Epoch: 34 cost time: 10.354202270507812
Epoch: 34, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.979988).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0080497
	speed: 0.1180s/iter; left time: 3641.5348s
	iters: 200, epoch: 35 | loss: 0.1658089
	speed: 0.0220s/iter; left time: 676.4574s
	iters: 300, epoch: 35 | loss: 0.0074758
	speed: 0.0216s/iter; left time: 663.1797s
	iters: 400, epoch: 35 | loss: 0.0127393
	speed: 0.0216s/iter; left time: 659.7893s
Epoch: 35 cost time: 10.553786039352417
Epoch: 35, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 36 | loss: 0.0025427
	speed: 0.1127s/iter; left time: 3423.9580s
	iters: 200, epoch: 36 | loss: 0.0057572
	speed: 0.0204s/iter; left time: 617.3650s
	iters: 300, epoch: 36 | loss: 0.0098249
	speed: 0.0210s/iter; left time: 634.2877s
	iters: 400, epoch: 36 | loss: 0.0010766
	speed: 0.0216s/iter; left time: 648.9043s
Epoch: 36 cost time: 10.17128849029541
Epoch: 36, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 37 | loss: 0.0045095
	speed: 0.1133s/iter; left time: 3389.4948s
	iters: 200, epoch: 37 | loss: 0.1179590
	speed: 0.0212s/iter; left time: 632.8274s
	iters: 300, epoch: 37 | loss: 0.0104390
	speed: 0.0203s/iter; left time: 602.9052s
	iters: 400, epoch: 37 | loss: 0.0993207
	speed: 0.0211s/iter; left time: 624.5975s
Epoch: 37 cost time: 10.119647026062012
Epoch: 37, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979988 --> -0.980273).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0077021
	speed: 0.0992s/iter; left time: 2921.0873s
	iters: 200, epoch: 38 | loss: 0.0982593
	speed: 0.0199s/iter; left time: 583.8560s
	iters: 300, epoch: 38 | loss: 0.0034651
	speed: 0.0198s/iter; left time: 579.9374s
	iters: 400, epoch: 38 | loss: 0.0712289
	speed: 0.0210s/iter; left time: 612.4065s
Epoch: 38 cost time: 9.862630367279053
Epoch: 38, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 39 | loss: 0.0802395
	speed: 0.1036s/iter; left time: 3002.5371s
	iters: 200, epoch: 39 | loss: 0.0047187
	speed: 0.0208s/iter; left time: 601.5827s
	iters: 300, epoch: 39 | loss: 0.0092868
	speed: 0.0214s/iter; left time: 614.8547s
	iters: 400, epoch: 39 | loss: 0.0013134
	speed: 0.0211s/iter; left time: 605.8590s
Epoch: 39 cost time: 10.338504791259766
Epoch: 39, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 40 | loss: 0.0381306
	speed: 0.1150s/iter; left time: 3279.7796s
	iters: 200, epoch: 40 | loss: 0.0116021
	speed: 0.0202s/iter; left time: 574.8250s
	iters: 300, epoch: 40 | loss: 0.2725082
	speed: 0.0207s/iter; left time: 585.5625s
	iters: 400, epoch: 40 | loss: 0.0191738
	speed: 0.0187s/iter; left time: 526.2758s
Epoch: 40 cost time: 10.073789119720459
Epoch: 40, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.980273 --> -0.980273).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0185213
	speed: 0.1215s/iter; left time: 3406.1256s
	iters: 200, epoch: 41 | loss: 0.0010422
	speed: 0.0207s/iter; left time: 579.1611s
	iters: 300, epoch: 41 | loss: 0.0049902
	speed: 0.0203s/iter; left time: 564.2602s
	iters: 400, epoch: 41 | loss: 0.3420568
	speed: 0.0209s/iter; left time: 580.9180s
Epoch: 41 cost time: 10.324587106704712
Epoch: 41, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0236327
	speed: 0.1071s/iter; left time: 2952.7171s
	iters: 200, epoch: 42 | loss: 0.0140474
	speed: 0.0208s/iter; left time: 572.4168s
	iters: 300, epoch: 42 | loss: 0.0130819
	speed: 0.0202s/iter; left time: 552.9454s
	iters: 400, epoch: 42 | loss: 0.0155773
	speed: 0.0203s/iter; left time: 553.9434s
Epoch: 42 cost time: 9.987906455993652
Epoch: 42, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0083334
	speed: 0.1064s/iter; left time: 2883.3902s
	iters: 200, epoch: 43 | loss: 0.5339916
	speed: 0.0206s/iter; left time: 556.8017s
	iters: 300, epoch: 43 | loss: 0.0011047
	speed: 0.0200s/iter; left time: 537.5927s
	iters: 400, epoch: 43 | loss: 0.0040974
	speed: 0.0194s/iter; left time: 520.1679s
Epoch: 43 cost time: 9.954312801361084
Epoch: 43, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0031872
	speed: 0.1085s/iter; left time: 2890.0934s
	iters: 200, epoch: 44 | loss: 0.0143456
	speed: 0.0197s/iter; left time: 522.5166s
	iters: 300, epoch: 44 | loss: 0.0033396
	speed: 0.0199s/iter; left time: 525.3837s
	iters: 400, epoch: 44 | loss: 0.0013403
	speed: 0.0203s/iter; left time: 533.5620s
Epoch: 44 cost time: 9.8424072265625
Epoch: 44, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.1745271
	speed: 0.1093s/iter; left time: 2859.5775s
	iters: 200, epoch: 45 | loss: 0.0041000
	speed: 0.0197s/iter; left time: 514.0176s
	iters: 300, epoch: 45 | loss: 0.1732374
	speed: 0.0208s/iter; left time: 539.4228s
	iters: 400, epoch: 45 | loss: 0.0052777
	speed: 0.0209s/iter; left time: 541.0948s
Epoch: 45 cost time: 10.081022500991821
Epoch: 45, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0068766
	speed: 0.1174s/iter; left time: 3017.0950s
	iters: 200, epoch: 46 | loss: 0.1520341
	speed: 0.0200s/iter; left time: 511.3485s
	iters: 300, epoch: 46 | loss: 0.0079365
	speed: 0.0208s/iter; left time: 530.7219s
	iters: 400, epoch: 46 | loss: 0.2339791
	speed: 0.0204s/iter; left time: 518.1257s
Epoch: 46 cost time: 10.024272680282593
Epoch: 46, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0237223
	speed: 0.1193s/iter; left time: 3009.9209s
	iters: 200, epoch: 47 | loss: 0.0347883
	speed: 0.0199s/iter; left time: 500.2226s
	iters: 300, epoch: 47 | loss: 0.1938034
	speed: 0.0197s/iter; left time: 494.1611s
	iters: 400, epoch: 47 | loss: 0.0221688
	speed: 0.0207s/iter; left time: 515.1553s
Epoch: 47 cost time: 9.944401979446411
Epoch: 47, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0044550
	speed: 0.1078s/iter; left time: 2668.5501s
	iters: 200, epoch: 48 | loss: 0.0270118
	speed: 0.0204s/iter; left time: 502.6417s
	iters: 300, epoch: 48 | loss: 0.0021664
	speed: 0.0212s/iter; left time: 520.7043s
	iters: 400, epoch: 48 | loss: 0.0058336
	speed: 0.0203s/iter; left time: 497.1745s
Epoch: 48 cost time: 9.927883863449097
Epoch: 48, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0015631
	speed: 0.0949s/iter; left time: 2304.6936s
	iters: 200, epoch: 49 | loss: 0.0055708
	speed: 0.0182s/iter; left time: 439.7861s
	iters: 300, epoch: 49 | loss: 0.0074587
	speed: 0.0188s/iter; left time: 453.1608s
	iters: 400, epoch: 49 | loss: 0.0001331
	speed: 0.0189s/iter; left time: 453.0615s
Epoch: 49 cost time: 9.054043292999268
Epoch: 49, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.980273 --> -0.980559).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.1439433
	speed: 0.1108s/iter; left time: 2638.4839s
	iters: 200, epoch: 50 | loss: 0.0001994
	speed: 0.0211s/iter; left time: 500.4640s
	iters: 300, epoch: 50 | loss: 0.0580691
	speed: 0.0207s/iter; left time: 488.4937s
	iters: 400, epoch: 50 | loss: 0.0020527
	speed: 0.0217s/iter; left time: 510.5905s
Epoch: 50 cost time: 10.461988687515259
Epoch: 50, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0165251
	speed: 0.1127s/iter; left time: 2632.1772s
	iters: 200, epoch: 51 | loss: 0.0411099
	speed: 0.0206s/iter; left time: 479.4203s
	iters: 300, epoch: 51 | loss: 0.0509771
	speed: 0.0198s/iter; left time: 458.4236s
	iters: 400, epoch: 51 | loss: 0.0234483
	speed: 0.0198s/iter; left time: 457.2309s
Epoch: 51 cost time: 9.953101396560669
Epoch: 51, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0040018
	speed: 0.1072s/iter; left time: 2451.9733s
	iters: 200, epoch: 52 | loss: 0.2807689
	speed: 0.0193s/iter; left time: 440.3668s
	iters: 300, epoch: 52 | loss: 0.0412031
	speed: 0.0198s/iter; left time: 449.6701s
	iters: 400, epoch: 52 | loss: 0.0082258
	speed: 0.0191s/iter; left time: 431.0494s
Epoch: 52 cost time: 9.590753555297852
Epoch: 52, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0044512
	speed: 0.1204s/iter; left time: 2699.1392s
	iters: 200, epoch: 53 | loss: 0.0082544
	speed: 0.0211s/iter; left time: 469.8786s
	iters: 300, epoch: 53 | loss: 0.1552187
	speed: 0.0205s/iter; left time: 454.6391s
	iters: 400, epoch: 53 | loss: 0.0369265
	speed: 0.0202s/iter; left time: 447.3738s
Epoch: 53 cost time: 10.24198055267334
Epoch: 53, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.1435870
	speed: 0.1162s/iter; left time: 2549.9260s
	iters: 200, epoch: 54 | loss: 0.0134269
	speed: 0.0202s/iter; left time: 440.6148s
	iters: 300, epoch: 54 | loss: 0.0371378
	speed: 0.0206s/iter; left time: 448.2346s
	iters: 400, epoch: 54 | loss: 0.0148608
	speed: 0.0203s/iter; left time: 439.5851s
Epoch: 54 cost time: 10.149043321609497
Epoch: 54, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0012564
	speed: 0.1180s/iter; left time: 2534.6544s
	iters: 200, epoch: 55 | loss: 0.0092388
	speed: 0.0212s/iter; left time: 452.6257s
	iters: 300, epoch: 55 | loss: 0.0249579
	speed: 0.0200s/iter; left time: 425.1396s
	iters: 400, epoch: 55 | loss: 0.0001837
	speed: 0.0205s/iter; left time: 433.2573s
Epoch: 55 cost time: 10.02993893623352
Epoch: 55, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.1261607
	speed: 0.1033s/iter; left time: 2169.2528s
	iters: 200, epoch: 56 | loss: 0.0009231
	speed: 0.0203s/iter; left time: 424.1321s
	iters: 300, epoch: 56 | loss: 0.0048503
	speed: 0.0211s/iter; left time: 439.6857s
	iters: 400, epoch: 56 | loss: 0.0088684
	speed: 0.0195s/iter; left time: 404.1755s
Epoch: 56 cost time: 10.108913898468018
Epoch: 56, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 0.0386597
	speed: 0.1070s/iter; left time: 2197.2302s
	iters: 200, epoch: 57 | loss: 0.0017177
	speed: 0.0218s/iter; left time: 445.2824s
	iters: 300, epoch: 57 | loss: 0.0764234
	speed: 0.0202s/iter; left time: 411.2334s
	iters: 400, epoch: 57 | loss: 0.0023806
	speed: 0.0206s/iter; left time: 416.7487s
Epoch: 57 cost time: 10.230770826339722
Epoch: 57, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 0.0038648
	speed: 0.1093s/iter; left time: 2194.3640s
	iters: 200, epoch: 58 | loss: 0.0098944
	speed: 0.0228s/iter; left time: 454.4842s
	iters: 300, epoch: 58 | loss: 0.0018703
	speed: 0.0221s/iter; left time: 439.6189s
	iters: 400, epoch: 58 | loss: 0.0008577
	speed: 0.0220s/iter; left time: 434.4092s
Epoch: 58 cost time: 10.706727504730225
Epoch: 58, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.0396641
	speed: 0.1217s/iter; left time: 2384.5297s
	iters: 200, epoch: 59 | loss: 0.0001889
	speed: 0.0217s/iter; left time: 422.9780s
	iters: 300, epoch: 59 | loss: 0.0052208
	speed: 0.0215s/iter; left time: 417.3458s
	iters: 400, epoch: 59 | loss: 0.0003045
	speed: 0.0228s/iter; left time: 439.4419s
Epoch: 59 cost time: 10.506915092468262
Epoch: 59, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9805603201829617
model parameter : 70882
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6769812
	speed: 0.0379s/iter; left time: 1775.0219s
	iters: 200, epoch: 1 | loss: 1.3030794
	speed: 0.0212s/iter; left time: 992.3749s
	iters: 300, epoch: 1 | loss: 0.5980561
	speed: 0.0208s/iter; left time: 969.9113s
	iters: 400, epoch: 1 | loss: 0.9092612
	speed: 0.0206s/iter; left time: 959.4633s
Epoch: 1 cost time: 11.60067868232727
Epoch: 1, Steps: 469 | Train Loss: 1.264 Vali Loss: 0.577 Vali Acc: 0.826 Test Loss: 0.577 Test Acc: 0.826
Validation loss decreased (inf --> -0.826181).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2477052
	speed: 0.1070s/iter; left time: 4959.2167s
	iters: 200, epoch: 2 | loss: 0.3381867
	speed: 0.0215s/iter; left time: 995.6933s
	iters: 300, epoch: 2 | loss: 0.2645013
	speed: 0.0202s/iter; left time: 930.6005s
	iters: 400, epoch: 2 | loss: 0.3490887
	speed: 0.0209s/iter; left time: 961.8862s
Epoch: 2 cost time: 10.141117811203003
Epoch: 2, Steps: 469 | Train Loss: 0.363 Vali Loss: 0.329 Vali Acc: 0.908 Test Loss: 0.329 Test Acc: 0.908
Validation loss decreased (-0.826181 --> -0.907944).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5484470
	speed: 0.1117s/iter; left time: 5124.9481s
	iters: 200, epoch: 3 | loss: 0.0634976
	speed: 0.0211s/iter; left time: 966.2556s
	iters: 300, epoch: 3 | loss: 0.6655958
	speed: 0.0213s/iter; left time: 974.7032s
	iters: 400, epoch: 3 | loss: 0.0313819
	speed: 0.0218s/iter; left time: 991.4554s
Epoch: 3 cost time: 10.453449726104736
Epoch: 3, Steps: 469 | Train Loss: 0.233 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
Validation loss decreased (-0.907944 --> -0.942250).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1573388
	speed: 0.1245s/iter; left time: 5653.1041s
	iters: 200, epoch: 4 | loss: 0.1768701
	speed: 0.0232s/iter; left time: 1051.3361s
	iters: 300, epoch: 4 | loss: 0.3429290
	speed: 0.0219s/iter; left time: 991.7920s
	iters: 400, epoch: 4 | loss: 0.2868268
	speed: 0.0218s/iter; left time: 985.1023s
Epoch: 4 cost time: 10.901873350143433
Epoch: 4, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.942250 --> -0.951399).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2446503
	speed: 0.1174s/iter; left time: 5272.2945s
	iters: 200, epoch: 5 | loss: 0.0914914
	speed: 0.0223s/iter; left time: 1001.2520s
	iters: 300, epoch: 5 | loss: 0.0448710
	speed: 0.0221s/iter; left time: 986.6738s
	iters: 400, epoch: 5 | loss: 0.5189856
	speed: 0.0225s/iter; left time: 1005.0709s
Epoch: 5 cost time: 10.665019989013672
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.951399 --> -0.956259).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0117277
	speed: 0.1052s/iter; left time: 4676.4278s
	iters: 200, epoch: 6 | loss: 0.0340738
	speed: 0.0217s/iter; left time: 962.9889s
	iters: 300, epoch: 6 | loss: 0.0160841
	speed: 0.0215s/iter; left time: 950.4254s
	iters: 400, epoch: 6 | loss: 0.3435436
	speed: 0.0222s/iter; left time: 979.4127s
Epoch: 6 cost time: 10.683684587478638
Epoch: 6, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.956259 --> -0.962263).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2062668
	speed: 0.1138s/iter; left time: 5005.9876s
	iters: 200, epoch: 7 | loss: 0.0721922
	speed: 0.0209s/iter; left time: 916.7633s
	iters: 300, epoch: 7 | loss: 0.0206000
	speed: 0.0211s/iter; left time: 924.7226s
	iters: 400, epoch: 7 | loss: 0.1632923
	speed: 0.0219s/iter; left time: 955.3697s
Epoch: 7 cost time: 10.380987644195557
Epoch: 7, Steps: 469 | Train Loss: 0.114 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
Validation loss decreased (-0.962263 --> -0.966265).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0621916
	speed: 0.1131s/iter; left time: 4923.5646s
	iters: 200, epoch: 8 | loss: 0.0186832
	speed: 0.0206s/iter; left time: 894.3083s
	iters: 300, epoch: 8 | loss: 0.0588264
	speed: 0.0210s/iter; left time: 911.1620s
	iters: 400, epoch: 8 | loss: 0.0158787
	speed: 0.0215s/iter; left time: 929.4227s
Epoch: 8 cost time: 10.534381866455078
Epoch: 8, Steps: 469 | Train Loss: 0.097 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1660658
	speed: 0.1193s/iter; left time: 5135.8429s
	iters: 200, epoch: 9 | loss: 0.0592174
	speed: 0.0233s/iter; left time: 1001.7255s
	iters: 300, epoch: 9 | loss: 0.0167285
	speed: 0.0220s/iter; left time: 943.8832s
	iters: 400, epoch: 9 | loss: 0.0119129
	speed: 0.0211s/iter; left time: 903.6416s
Epoch: 9 cost time: 10.676687955856323
Epoch: 9, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.966265 --> -0.967695).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0231217
	speed: 0.1147s/iter; left time: 4885.9159s
	iters: 200, epoch: 10 | loss: 0.0584235
	speed: 0.0212s/iter; left time: 899.9549s
	iters: 300, epoch: 10 | loss: 0.0663065
	speed: 0.0216s/iter; left time: 917.2102s
	iters: 400, epoch: 10 | loss: 0.0032478
	speed: 0.0212s/iter; left time: 895.2890s
Epoch: 10 cost time: 10.404800653457642
Epoch: 10, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.967695 --> -0.973126).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0340337
	speed: 0.1069s/iter; left time: 4500.1473s
	iters: 200, epoch: 11 | loss: 0.0172297
	speed: 0.0218s/iter; left time: 916.2780s
	iters: 300, epoch: 11 | loss: 0.0887019
	speed: 0.0207s/iter; left time: 866.3687s
	iters: 400, epoch: 11 | loss: 0.1181634
	speed: 0.0212s/iter; left time: 885.5995s
Epoch: 11 cost time: 10.321257591247559
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0088943
	speed: 0.1155s/iter; left time: 4807.9900s
	iters: 200, epoch: 12 | loss: 0.1084443
	speed: 0.0214s/iter; left time: 887.4589s
	iters: 300, epoch: 12 | loss: 0.0419272
	speed: 0.0206s/iter; left time: 853.3859s
	iters: 400, epoch: 12 | loss: 0.0823305
	speed: 0.0216s/iter; left time: 893.3538s
Epoch: 12 cost time: 10.40708327293396
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.973126 --> -0.975128).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0096268
	speed: 0.1140s/iter; left time: 4692.2781s
	iters: 200, epoch: 13 | loss: 0.0788940
	speed: 0.0216s/iter; left time: 885.8921s
	iters: 300, epoch: 13 | loss: 0.0079964
	speed: 0.0207s/iter; left time: 847.9858s
	iters: 400, epoch: 13 | loss: 0.1336359
	speed: 0.0205s/iter; left time: 835.8583s
Epoch: 13 cost time: 10.201064348220825
Epoch: 13, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0404333
	speed: 0.1079s/iter; left time: 4391.6255s
	iters: 200, epoch: 14 | loss: 0.0864654
	speed: 0.0213s/iter; left time: 863.3176s
	iters: 300, epoch: 14 | loss: 0.0110101
	speed: 0.0205s/iter; left time: 832.2890s
	iters: 400, epoch: 14 | loss: 0.0044569
	speed: 0.0215s/iter; left time: 870.4336s
Epoch: 14 cost time: 10.45152997970581
Epoch: 14, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0668615
	speed: 0.1147s/iter; left time: 4613.3670s
	iters: 200, epoch: 15 | loss: 0.0101162
	speed: 0.0222s/iter; left time: 891.6328s
	iters: 300, epoch: 15 | loss: 0.1176980
	speed: 0.0223s/iter; left time: 892.3726s
	iters: 400, epoch: 15 | loss: 0.0082845
	speed: 0.0234s/iter; left time: 932.9495s
Epoch: 15 cost time: 10.918836116790771
Epoch: 15, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.6932231
	speed: 0.1155s/iter; left time: 4594.1111s
	iters: 200, epoch: 16 | loss: 0.0109313
	speed: 0.0222s/iter; left time: 880.7587s
	iters: 300, epoch: 16 | loss: 0.0219115
	speed: 0.0209s/iter; left time: 826.2770s
	iters: 400, epoch: 16 | loss: 0.1033125
	speed: 0.0221s/iter; left time: 870.6790s
Epoch: 16 cost time: 10.465099811553955
Epoch: 16, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0717797
	speed: 0.1104s/iter; left time: 4338.2060s
	iters: 200, epoch: 17 | loss: 0.0544203
	speed: 0.0213s/iter; left time: 835.4786s
	iters: 300, epoch: 17 | loss: 0.0183352
	speed: 0.0218s/iter; left time: 852.4415s
	iters: 400, epoch: 17 | loss: 0.0104282
	speed: 0.0217s/iter; left time: 847.1401s
Epoch: 17 cost time: 10.48142147064209
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0051853
	speed: 0.1103s/iter; left time: 4281.3707s
	iters: 200, epoch: 18 | loss: 0.0477441
	speed: 0.0212s/iter; left time: 821.9367s
	iters: 300, epoch: 18 | loss: 0.0060411
	speed: 0.0208s/iter; left time: 803.1001s
	iters: 400, epoch: 18 | loss: 0.1711099
	speed: 0.0216s/iter; left time: 832.7074s
Epoch: 18 cost time: 10.263568639755249
Epoch: 18, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0208060
	speed: 0.1079s/iter; left time: 4139.1729s
	iters: 200, epoch: 19 | loss: 0.0368379
	speed: 0.0201s/iter; left time: 768.9758s
	iters: 300, epoch: 19 | loss: 0.0540676
	speed: 0.0217s/iter; left time: 828.2755s
	iters: 400, epoch: 19 | loss: 0.0675018
	speed: 0.0216s/iter; left time: 823.4128s
Epoch: 19 cost time: 10.339318752288818
Epoch: 19, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0038890
	speed: 0.1143s/iter; left time: 4332.0991s
	iters: 200, epoch: 20 | loss: 0.0179340
	speed: 0.0219s/iter; left time: 826.3024s
	iters: 300, epoch: 20 | loss: 0.0277556
	speed: 0.0214s/iter; left time: 805.6161s
	iters: 400, epoch: 20 | loss: 0.2684380
	speed: 0.0207s/iter; left time: 779.8187s
Epoch: 20 cost time: 10.587356805801392
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0027724
	speed: 0.1190s/iter; left time: 4452.6365s
	iters: 200, epoch: 21 | loss: 0.0061403
	speed: 0.0215s/iter; left time: 804.2077s
	iters: 300, epoch: 21 | loss: 0.0774163
	speed: 0.0216s/iter; left time: 803.9376s
	iters: 400, epoch: 21 | loss: 0.1714718
	speed: 0.0213s/iter; left time: 789.2434s
Epoch: 21 cost time: 10.58512568473816
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.975128 --> -0.976843).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.1510919
	speed: 0.1103s/iter; left time: 4074.6573s
	iters: 200, epoch: 22 | loss: 0.2997773
	speed: 0.0206s/iter; left time: 760.7497s
	iters: 300, epoch: 22 | loss: 0.0055605
	speed: 0.0224s/iter; left time: 822.8266s
	iters: 400, epoch: 22 | loss: 0.0081086
	speed: 0.0218s/iter; left time: 797.6987s
Epoch: 22 cost time: 10.595305442810059
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0014981
	speed: 0.1137s/iter; left time: 4148.6616s
	iters: 200, epoch: 23 | loss: 0.0025377
	speed: 0.0210s/iter; left time: 763.3887s
	iters: 300, epoch: 23 | loss: 0.0165418
	speed: 0.0213s/iter; left time: 771.5595s
	iters: 400, epoch: 23 | loss: 0.0015190
	speed: 0.0208s/iter; left time: 754.4084s
Epoch: 23 cost time: 10.367595434188843
Epoch: 23, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977701).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0105372
	speed: 0.1124s/iter; left time: 4048.8891s
	iters: 200, epoch: 24 | loss: 0.0019103
	speed: 0.0211s/iter; left time: 757.5025s
	iters: 300, epoch: 24 | loss: 0.0229199
	speed: 0.0219s/iter; left time: 784.3124s
	iters: 400, epoch: 24 | loss: 0.2278687
	speed: 0.0208s/iter; left time: 742.9375s
Epoch: 24 cost time: 10.526098012924194
Epoch: 24, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0054063
	speed: 0.1187s/iter; left time: 4218.0909s
	iters: 200, epoch: 25 | loss: 0.2295620
	speed: 0.0216s/iter; left time: 764.4457s
	iters: 300, epoch: 25 | loss: 0.0285302
	speed: 0.0218s/iter; left time: 772.2388s
	iters: 400, epoch: 25 | loss: 0.0428098
	speed: 0.0208s/iter; left time: 732.6320s
Epoch: 25 cost time: 10.488085508346558
Epoch: 25, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0446717
	speed: 0.1185s/iter; left time: 4155.7997s
	iters: 200, epoch: 26 | loss: 0.0040152
	speed: 0.0219s/iter; left time: 767.0920s
	iters: 300, epoch: 26 | loss: 0.0544383
	speed: 0.0210s/iter; left time: 732.0403s
	iters: 400, epoch: 26 | loss: 0.4798086
	speed: 0.0217s/iter; left time: 755.0508s
Epoch: 26 cost time: 10.621042728424072
Epoch: 26, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.977986).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.3250949
	speed: 0.1111s/iter; left time: 3843.2541s
	iters: 200, epoch: 27 | loss: 0.0046812
	speed: 0.0216s/iter; left time: 744.5407s
	iters: 300, epoch: 27 | loss: 0.0478540
	speed: 0.0212s/iter; left time: 727.7253s
	iters: 400, epoch: 27 | loss: 0.0169813
	speed: 0.0208s/iter; left time: 714.6159s
Epoch: 27 cost time: 10.332011699676514
Epoch: 27, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0524953
	speed: 0.1131s/iter; left time: 3861.9608s
	iters: 200, epoch: 28 | loss: 0.1679574
	speed: 0.0207s/iter; left time: 705.0752s
	iters: 300, epoch: 28 | loss: 0.0589274
	speed: 0.0207s/iter; left time: 702.1241s
	iters: 400, epoch: 28 | loss: 0.0058560
	speed: 0.0211s/iter; left time: 715.3060s
Epoch: 28 cost time: 10.326784372329712
Epoch: 28, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.1329952
	speed: 0.1156s/iter; left time: 3891.6033s
	iters: 200, epoch: 29 | loss: 0.0331386
	speed: 0.0207s/iter; left time: 694.4864s
	iters: 300, epoch: 29 | loss: 0.0506391
	speed: 0.0206s/iter; left time: 688.5943s
	iters: 400, epoch: 29 | loss: 0.0130946
	speed: 0.0207s/iter; left time: 689.8777s
Epoch: 29 cost time: 10.268566370010376
Epoch: 29, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0385434
	speed: 0.1196s/iter; left time: 3971.1391s
	iters: 200, epoch: 30 | loss: 0.0462000
	speed: 0.0212s/iter; left time: 702.9048s
	iters: 300, epoch: 30 | loss: 0.1281643
	speed: 0.0205s/iter; left time: 676.0310s
	iters: 400, epoch: 30 | loss: 0.0042962
	speed: 0.0210s/iter; left time: 690.9936s
Epoch: 30 cost time: 10.426729202270508
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0029838
	speed: 0.1176s/iter; left time: 3849.1267s
	iters: 200, epoch: 31 | loss: 0.0102555
	speed: 0.0213s/iter; left time: 693.6532s
	iters: 300, epoch: 31 | loss: 0.1411010
	speed: 0.0215s/iter; left time: 697.9669s
	iters: 400, epoch: 31 | loss: 0.0295238
	speed: 0.0214s/iter; left time: 692.8870s
Epoch: 31 cost time: 10.588504552841187
Epoch: 31, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978558).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0014820
	speed: 0.1175s/iter; left time: 3792.2875s
	iters: 200, epoch: 32 | loss: 0.0717248
	speed: 0.0203s/iter; left time: 654.0577s
	iters: 300, epoch: 32 | loss: 0.3830847
	speed: 0.0208s/iter; left time: 667.6885s
	iters: 400, epoch: 32 | loss: 0.0242093
	speed: 0.0209s/iter; left time: 669.4135s
Epoch: 32 cost time: 10.225939750671387
Epoch: 32, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.978558 --> -0.981417).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0080334
	speed: 0.1143s/iter; left time: 3634.8551s
	iters: 200, epoch: 33 | loss: 0.0142147
	speed: 0.0212s/iter; left time: 671.7382s
	iters: 300, epoch: 33 | loss: 0.0356162
	speed: 0.0207s/iter; left time: 654.3741s
	iters: 400, epoch: 33 | loss: 0.0372221
	speed: 0.0217s/iter; left time: 681.9681s
Epoch: 33 cost time: 10.384145736694336
Epoch: 33, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 34 | loss: 0.0077223
	speed: 0.1117s/iter; left time: 3497.8875s
	iters: 200, epoch: 34 | loss: 0.0005412
	speed: 0.0210s/iter; left time: 655.9994s
	iters: 300, epoch: 34 | loss: 0.0118093
	speed: 0.0207s/iter; left time: 642.8065s
	iters: 400, epoch: 34 | loss: 0.0380270
	speed: 0.0207s/iter; left time: 642.0495s
Epoch: 34 cost time: 10.159768342971802
Epoch: 34, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 35 | loss: 0.0030888
	speed: 0.1130s/iter; left time: 3486.0851s
	iters: 200, epoch: 35 | loss: 0.0386697
	speed: 0.0202s/iter; left time: 622.2014s
	iters: 300, epoch: 35 | loss: 0.0006240
	speed: 0.0217s/iter; left time: 664.5786s
	iters: 400, epoch: 35 | loss: 0.0350319
	speed: 0.0217s/iter; left time: 664.2911s
Epoch: 35 cost time: 10.299192428588867
Epoch: 35, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 36 | loss: 0.0069455
	speed: 0.1179s/iter; left time: 3581.9787s
	iters: 200, epoch: 36 | loss: 0.0054835
	speed: 0.0222s/iter; left time: 672.7019s
	iters: 300, epoch: 36 | loss: 0.0104622
	speed: 0.0225s/iter; left time: 677.9203s
	iters: 400, epoch: 36 | loss: 0.2063510
	speed: 0.0219s/iter; left time: 658.2762s
Epoch: 36 cost time: 10.881518840789795
Epoch: 36, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 37 | loss: 0.0130687
	speed: 0.1130s/iter; left time: 3379.5745s
	iters: 200, epoch: 37 | loss: 0.3270314
	speed: 0.0207s/iter; left time: 618.4430s
	iters: 300, epoch: 37 | loss: 0.0800012
	speed: 0.0200s/iter; left time: 594.9235s
	iters: 400, epoch: 37 | loss: 0.0254715
	speed: 0.0208s/iter; left time: 614.9577s
Epoch: 37 cost time: 10.031201362609863
Epoch: 37, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 38 | loss: 0.0019438
	speed: 0.1127s/iter; left time: 3319.5861s
	iters: 200, epoch: 38 | loss: 0.0823127
	speed: 0.0211s/iter; left time: 617.9477s
	iters: 300, epoch: 38 | loss: 0.0975014
	speed: 0.0197s/iter; left time: 577.2888s
	iters: 400, epoch: 38 | loss: 0.2567243
	speed: 0.0211s/iter; left time: 614.8766s
Epoch: 38 cost time: 10.159842014312744
Epoch: 38, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 39 | loss: 0.0198672
	speed: 0.1140s/iter; left time: 3305.0100s
	iters: 200, epoch: 39 | loss: 0.0014638
	speed: 0.0214s/iter; left time: 618.2827s
	iters: 300, epoch: 39 | loss: 0.0248353
	speed: 0.0212s/iter; left time: 609.1562s
	iters: 400, epoch: 39 | loss: 0.0012308
	speed: 0.0201s/iter; left time: 575.4854s
Epoch: 39 cost time: 10.259817600250244
Epoch: 39, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 40 | loss: 0.2023227
	speed: 0.1172s/iter; left time: 3342.1309s
	iters: 200, epoch: 40 | loss: 0.0399940
	speed: 0.0220s/iter; left time: 624.2025s
	iters: 300, epoch: 40 | loss: 0.1109625
	speed: 0.0213s/iter; left time: 603.3924s
	iters: 400, epoch: 40 | loss: 0.0125476
	speed: 0.0216s/iter; left time: 609.6484s
Epoch: 40 cost time: 10.693058729171753
Epoch: 40, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 41 | loss: 0.0215759
	speed: 0.1187s/iter; left time: 3328.7961s
	iters: 200, epoch: 41 | loss: 0.0109198
	speed: 0.0223s/iter; left time: 623.8006s
	iters: 300, epoch: 41 | loss: 0.0023654
	speed: 0.0218s/iter; left time: 607.7785s
	iters: 400, epoch: 41 | loss: 0.2803060
	speed: 0.0223s/iter; left time: 618.6080s
Epoch: 41 cost time: 10.87144684791565
Epoch: 41, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 42 | loss: 0.0140356
	speed: 0.1185s/iter; left time: 3268.1853s
	iters: 200, epoch: 42 | loss: 0.0062484
	speed: 0.0207s/iter; left time: 569.4031s
	iters: 300, epoch: 42 | loss: 0.0212097
	speed: 0.0213s/iter; left time: 582.0170s
	iters: 400, epoch: 42 | loss: 0.0007316
	speed: 0.0206s/iter; left time: 560.7179s
Epoch: 42 cost time: 10.297408103942871
Epoch: 42, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9814179531160663
model parameter : 70882
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5266607
	speed: 0.0385s/iter; left time: 1802.8748s
	iters: 200, epoch: 1 | loss: 0.8539230
	speed: 0.0221s/iter; left time: 1033.1174s
	iters: 300, epoch: 1 | loss: 0.6073067
	speed: 0.0216s/iter; left time: 1005.8772s
	iters: 400, epoch: 1 | loss: 0.3196747
	speed: 0.0216s/iter; left time: 1002.2308s
Epoch: 1 cost time: 12.007063150405884
Epoch: 1, Steps: 469 | Train Loss: 1.061 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
Validation loss decreased (inf --> -0.844477).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5334585
	speed: 0.1224s/iter; left time: 5670.1616s
	iters: 200, epoch: 2 | loss: 0.3601921
	speed: 0.0232s/iter; left time: 1074.3594s
	iters: 300, epoch: 2 | loss: 0.2187023
	speed: 0.0233s/iter; left time: 1075.5900s
	iters: 400, epoch: 2 | loss: 0.1357061
	speed: 0.0211s/iter; left time: 971.9617s
Epoch: 2 cost time: 10.889399528503418
Epoch: 2, Steps: 469 | Train Loss: 0.335 Vali Loss: 0.352 Vali Acc: 0.898 Test Loss: 0.352 Test Acc: 0.898
Validation loss decreased (-0.844477 --> -0.897652).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2181363
	speed: 0.1240s/iter; left time: 5685.2171s
	iters: 200, epoch: 3 | loss: 0.3904582
	speed: 0.0208s/iter; left time: 951.0018s
	iters: 300, epoch: 3 | loss: 0.1353254
	speed: 0.0220s/iter; left time: 1005.1040s
	iters: 400, epoch: 3 | loss: 0.0926417
	speed: 0.0215s/iter; left time: 977.5459s
Epoch: 3 cost time: 10.59156608581543
Epoch: 3, Steps: 469 | Train Loss: 0.225 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
Validation loss decreased (-0.897652 --> -0.923954).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2123322
	speed: 0.1098s/iter; left time: 4983.3788s
	iters: 200, epoch: 4 | loss: 0.1940666
	speed: 0.0211s/iter; left time: 955.4457s
	iters: 300, epoch: 4 | loss: 0.1694510
	speed: 0.0216s/iter; left time: 978.2408s
	iters: 400, epoch: 4 | loss: 0.0810554
	speed: 0.0206s/iter; left time: 931.1323s
Epoch: 4 cost time: 10.430567026138306
Epoch: 4, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
Validation loss decreased (-0.923954 --> -0.942536).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2658153
	speed: 0.1079s/iter; left time: 4845.5067s
	iters: 200, epoch: 5 | loss: 0.2760752
	speed: 0.0209s/iter; left time: 935.7668s
	iters: 300, epoch: 5 | loss: 0.1869288
	speed: 0.0221s/iter; left time: 989.0028s
	iters: 400, epoch: 5 | loss: 0.0592161
	speed: 0.0212s/iter; left time: 944.5586s
Epoch: 5 cost time: 10.406829118728638
Epoch: 5, Steps: 469 | Train Loss: 0.141 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.942536 --> -0.949969).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0583741
	speed: 0.1111s/iter; left time: 4938.1339s
	iters: 200, epoch: 6 | loss: 0.0428472
	speed: 0.0207s/iter; left time: 917.8247s
	iters: 300, epoch: 6 | loss: 0.0365005
	speed: 0.0208s/iter; left time: 920.9004s
	iters: 400, epoch: 6 | loss: 0.0182702
	speed: 0.0209s/iter; left time: 922.9765s
Epoch: 6 cost time: 10.20203971862793
Epoch: 6, Steps: 469 | Train Loss: 0.123 Vali Loss: 0.182 Vali Acc: 0.955 Test Loss: 0.182 Test Acc: 0.955
Validation loss decreased (-0.949969 --> -0.954830).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0582990
	speed: 0.1198s/iter; left time: 5268.7403s
	iters: 200, epoch: 7 | loss: 0.2085014
	speed: 0.0210s/iter; left time: 923.5290s
	iters: 300, epoch: 7 | loss: 0.1549636
	speed: 0.0215s/iter; left time: 939.2585s
	iters: 400, epoch: 7 | loss: 0.0886303
	speed: 0.0213s/iter; left time: 931.6478s
Epoch: 7 cost time: 10.486398458480835
Epoch: 7, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.954830 --> -0.959118).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1195461
	speed: 0.1182s/iter; left time: 5142.8632s
	iters: 200, epoch: 8 | loss: 0.0276153
	speed: 0.0219s/iter; left time: 952.3093s
	iters: 300, epoch: 8 | loss: 0.0682086
	speed: 0.0233s/iter; left time: 1011.2961s
	iters: 400, epoch: 8 | loss: 0.1677271
	speed: 0.0225s/iter; left time: 973.2668s
Epoch: 8 cost time: 10.7381911277771
Epoch: 8, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.959118 --> -0.963978).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.4140136
	speed: 0.1041s/iter; left time: 4482.1561s
	iters: 200, epoch: 9 | loss: 0.2745142
	speed: 0.0217s/iter; left time: 932.7136s
	iters: 300, epoch: 9 | loss: 0.0841344
	speed: 0.0207s/iter; left time: 886.1617s
	iters: 400, epoch: 9 | loss: 0.0644065
	speed: 0.0211s/iter; left time: 901.7144s
Epoch: 9 cost time: 10.259711027145386
Epoch: 9, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0105154
	speed: 0.1080s/iter; left time: 4599.6652s
	iters: 200, epoch: 10 | loss: 0.1161349
	speed: 0.0218s/iter; left time: 925.3539s
	iters: 300, epoch: 10 | loss: 0.1069931
	speed: 0.0218s/iter; left time: 922.0236s
	iters: 400, epoch: 10 | loss: 0.2300890
	speed: 0.0223s/iter; left time: 944.6352s
Epoch: 10 cost time: 10.600175380706787
Epoch: 10, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.963978 --> -0.969696).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0228867
	speed: 0.1095s/iter; left time: 4609.1328s
	iters: 200, epoch: 11 | loss: 0.0200256
	speed: 0.0216s/iter; left time: 909.4263s
	iters: 300, epoch: 11 | loss: 0.0444944
	speed: 0.0218s/iter; left time: 912.6116s
	iters: 400, epoch: 11 | loss: 0.1886646
	speed: 0.0217s/iter; left time: 905.4086s
Epoch: 11 cost time: 10.591907978057861
Epoch: 11, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0376250
	speed: 0.1241s/iter; left time: 5168.5806s
	iters: 200, epoch: 12 | loss: 0.0428755
	speed: 0.0213s/iter; left time: 886.4801s
	iters: 300, epoch: 12 | loss: 0.1690928
	speed: 0.0221s/iter; left time: 917.9218s
	iters: 400, epoch: 12 | loss: 0.0299589
	speed: 0.0215s/iter; left time: 886.8172s
Epoch: 12 cost time: 10.654909610748291
Epoch: 12, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0659608
	speed: 0.1196s/iter; left time: 4924.5541s
	iters: 200, epoch: 13 | loss: 0.0264164
	speed: 0.0218s/iter; left time: 896.8255s
	iters: 300, epoch: 13 | loss: 0.0262740
	speed: 0.0223s/iter; left time: 914.7621s
	iters: 400, epoch: 13 | loss: 0.0416034
	speed: 0.0215s/iter; left time: 880.0713s
Epoch: 13 cost time: 10.724183320999146
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.970553).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0230348
	speed: 0.1081s/iter; left time: 4401.5187s
	iters: 200, epoch: 14 | loss: 0.1107108
	speed: 0.0212s/iter; left time: 859.6348s
	iters: 300, epoch: 14 | loss: 0.1685445
	speed: 0.0211s/iter; left time: 856.1413s
	iters: 400, epoch: 14 | loss: 0.0350888
	speed: 0.0218s/iter; left time: 882.0504s
Epoch: 14 cost time: 10.347628355026245
Epoch: 14, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.970553 --> -0.974270).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0096066
	speed: 0.1128s/iter; left time: 4539.6516s
	iters: 200, epoch: 15 | loss: 0.0617364
	speed: 0.0207s/iter; left time: 832.3325s
	iters: 300, epoch: 15 | loss: 0.1075118
	speed: 0.0217s/iter; left time: 869.6732s
	iters: 400, epoch: 15 | loss: 0.2032695
	speed: 0.0227s/iter; left time: 907.8120s
Epoch: 15 cost time: 10.685514450073242
Epoch: 15, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0399768
	speed: 0.1148s/iter; left time: 4566.6882s
	iters: 200, epoch: 16 | loss: 0.0121218
	speed: 0.0216s/iter; left time: 855.4448s
	iters: 300, epoch: 16 | loss: 0.0093898
	speed: 0.0216s/iter; left time: 855.6428s
	iters: 400, epoch: 16 | loss: 0.0106176
	speed: 0.0228s/iter; left time: 898.0107s
Epoch: 16 cost time: 10.605557203292847
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974270 --> -0.975985).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0041959
	speed: 0.1219s/iter; left time: 4791.5408s
	iters: 200, epoch: 17 | loss: 0.1197608
	speed: 0.0234s/iter; left time: 919.0699s
	iters: 300, epoch: 17 | loss: 0.0151884
	speed: 0.0231s/iter; left time: 901.8321s
	iters: 400, epoch: 17 | loss: 0.0917582
	speed: 0.0220s/iter; left time: 858.5405s
Epoch: 17 cost time: 11.067933320999146
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0379041
	speed: 0.1199s/iter; left time: 4654.3833s
	iters: 200, epoch: 18 | loss: 0.0180268
	speed: 0.0231s/iter; left time: 894.0786s
	iters: 300, epoch: 18 | loss: 0.0131699
	speed: 0.0233s/iter; left time: 899.6499s
	iters: 400, epoch: 18 | loss: 0.0189078
	speed: 0.0225s/iter; left time: 868.4052s
Epoch: 18 cost time: 11.074378967285156
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.977415).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0289083
	speed: 0.1092s/iter; left time: 4189.3455s
	iters: 200, epoch: 19 | loss: 0.0548109
	speed: 0.0225s/iter; left time: 860.9229s
	iters: 300, epoch: 19 | loss: 0.0182179
	speed: 0.0214s/iter; left time: 816.1458s
	iters: 400, epoch: 19 | loss: 0.2749417
	speed: 0.0225s/iter; left time: 856.7327s
Epoch: 19 cost time: 10.73660659790039
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0473504
	speed: 0.1109s/iter; left time: 4202.4622s
	iters: 200, epoch: 20 | loss: 0.0547167
	speed: 0.0208s/iter; left time: 785.6374s
	iters: 300, epoch: 20 | loss: 0.0330255
	speed: 0.0209s/iter; left time: 788.0629s
	iters: 400, epoch: 20 | loss: 0.0021959
	speed: 0.0198s/iter; left time: 743.5433s
Epoch: 20 cost time: 10.052037477493286
Epoch: 20, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0116112
	speed: 0.1179s/iter; left time: 4411.0020s
	iters: 200, epoch: 21 | loss: 0.1600736
	speed: 0.0216s/iter; left time: 806.1851s
	iters: 300, epoch: 21 | loss: 0.1389321
	speed: 0.0215s/iter; left time: 800.3414s
	iters: 400, epoch: 21 | loss: 0.0733422
	speed: 0.0205s/iter; left time: 762.5046s
Epoch: 21 cost time: 10.463756322860718
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.1598637
	speed: 0.1212s/iter; left time: 4480.1860s
	iters: 200, epoch: 22 | loss: 0.0346079
	speed: 0.0216s/iter; left time: 797.3326s
	iters: 300, epoch: 22 | loss: 0.0012876
	speed: 0.0218s/iter; left time: 799.9892s
	iters: 400, epoch: 22 | loss: 0.0169456
	speed: 0.0222s/iter; left time: 814.5556s
Epoch: 22 cost time: 10.622360706329346
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0467444
	speed: 0.1179s/iter; left time: 4302.7014s
	iters: 200, epoch: 23 | loss: 0.0168132
	speed: 0.0228s/iter; left time: 829.0519s
	iters: 300, epoch: 23 | loss: 0.0602646
	speed: 0.0221s/iter; left time: 801.9378s
	iters: 400, epoch: 23 | loss: 0.0162480
	speed: 0.0222s/iter; left time: 804.3353s
Epoch: 23 cost time: 10.90153455734253
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.978844).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0930311
	speed: 0.1114s/iter; left time: 4013.6111s
	iters: 200, epoch: 24 | loss: 0.0023267
	speed: 0.0203s/iter; left time: 730.5272s
	iters: 300, epoch: 24 | loss: 0.0036825
	speed: 0.0215s/iter; left time: 768.5720s
	iters: 400, epoch: 24 | loss: 0.2540958
	speed: 0.0219s/iter; left time: 780.3922s
Epoch: 24 cost time: 10.39626669883728
Epoch: 24, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0165624
	speed: 0.1094s/iter; left time: 3889.0395s
	iters: 200, epoch: 25 | loss: 0.0008788
	speed: 0.0203s/iter; left time: 719.2546s
	iters: 300, epoch: 25 | loss: 0.0346793
	speed: 0.0211s/iter; left time: 746.0353s
	iters: 400, epoch: 25 | loss: 0.4350500
	speed: 0.0214s/iter; left time: 753.0701s
Epoch: 25 cost time: 10.155475616455078
Epoch: 25, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.978844 --> -0.979416).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0022413
	speed: 0.1083s/iter; left time: 3797.3170s
	iters: 200, epoch: 26 | loss: 0.0016623
	speed: 0.0210s/iter; left time: 733.3038s
	iters: 300, epoch: 26 | loss: 0.0064732
	speed: 0.0214s/iter; left time: 747.1103s
	iters: 400, epoch: 26 | loss: 0.0331154
	speed: 0.0214s/iter; left time: 742.8085s
Epoch: 26 cost time: 10.213735580444336
Epoch: 26, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0054664
	speed: 0.1208s/iter; left time: 4181.1428s
	iters: 200, epoch: 27 | loss: 0.0086402
	speed: 0.0219s/iter; left time: 754.2047s
	iters: 300, epoch: 27 | loss: 0.0285003
	speed: 0.0228s/iter; left time: 784.1760s
	iters: 400, epoch: 27 | loss: 0.0246574
	speed: 0.0226s/iter; left time: 775.2069s
Epoch: 27 cost time: 11.020684480667114
Epoch: 27, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0031785
	speed: 0.1123s/iter; left time: 3835.3637s
	iters: 200, epoch: 28 | loss: 0.0064463
	speed: 0.0231s/iter; left time: 786.4205s
	iters: 300, epoch: 28 | loss: 0.0031213
	speed: 0.0280s/iter; left time: 950.1396s
	iters: 400, epoch: 28 | loss: 0.0024361
	speed: 0.0262s/iter; left time: 887.3234s
Epoch: 28 cost time: 12.160578727722168
Epoch: 28, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0165223
	speed: 0.1342s/iter; left time: 4519.8172s
	iters: 200, epoch: 29 | loss: 0.0017996
	speed: 0.0253s/iter; left time: 848.7405s
	iters: 300, epoch: 29 | loss: 0.2771032
	speed: 0.0259s/iter; left time: 865.6303s
	iters: 400, epoch: 29 | loss: 0.0176394
	speed: 0.0243s/iter; left time: 812.3302s
Epoch: 29 cost time: 12.32668399810791
Epoch: 29, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0307647
	speed: 0.1299s/iter; left time: 4313.4624s
	iters: 200, epoch: 30 | loss: 0.0040244
	speed: 0.0274s/iter; left time: 907.0113s
	iters: 300, epoch: 30 | loss: 0.0203612
	speed: 0.0264s/iter; left time: 869.6440s
	iters: 400, epoch: 30 | loss: 0.0081903
	speed: 0.0262s/iter; left time: 862.9484s
Epoch: 30 cost time: 12.510770082473755
Epoch: 30, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.980845).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0019769
	speed: 0.1350s/iter; left time: 4417.7103s
	iters: 200, epoch: 31 | loss: 0.0152631
	speed: 0.0258s/iter; left time: 843.1084s
	iters: 300, epoch: 31 | loss: 0.1658794
	speed: 0.0257s/iter; left time: 836.9047s
	iters: 400, epoch: 31 | loss: 0.0135282
	speed: 0.0250s/iter; left time: 811.4410s
Epoch: 31 cost time: 12.37380576133728
Epoch: 31, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0232499
	speed: 0.1388s/iter; left time: 4477.6725s
	iters: 200, epoch: 32 | loss: 0.1036318
	speed: 0.0257s/iter; left time: 827.9097s
	iters: 300, epoch: 32 | loss: 0.0159780
	speed: 0.0253s/iter; left time: 810.1411s
	iters: 400, epoch: 32 | loss: 0.0728536
	speed: 0.0263s/iter; left time: 841.8573s
Epoch: 32 cost time: 12.621904134750366
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0096907
	speed: 0.1376s/iter; left time: 4375.8572s
	iters: 200, epoch: 33 | loss: 0.0267126
	speed: 0.0254s/iter; left time: 805.0028s
	iters: 300, epoch: 33 | loss: 0.0047065
	speed: 0.0255s/iter; left time: 806.4351s
	iters: 400, epoch: 33 | loss: 0.0362602
	speed: 0.0262s/iter; left time: 824.8005s
Epoch: 33 cost time: 12.653783559799194
Epoch: 33, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0431848
	speed: 0.1307s/iter; left time: 4095.6031s
	iters: 200, epoch: 34 | loss: 0.3916159
	speed: 0.0259s/iter; left time: 807.8893s
	iters: 300, epoch: 34 | loss: 0.0938165
	speed: 0.0266s/iter; left time: 827.0825s
	iters: 400, epoch: 34 | loss: 0.0009729
	speed: 0.0259s/iter; left time: 804.8874s
Epoch: 34 cost time: 12.43922472000122
Epoch: 34, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0036666
	speed: 0.1308s/iter; left time: 4037.1417s
	iters: 200, epoch: 35 | loss: 0.0153231
	speed: 0.0261s/iter; left time: 803.5509s
	iters: 300, epoch: 35 | loss: 0.0066251
	speed: 0.0263s/iter; left time: 807.1303s
	iters: 400, epoch: 35 | loss: 0.0033897
	speed: 0.0262s/iter; left time: 799.6577s
Epoch: 35 cost time: 12.455189943313599
Epoch: 35, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0055844
	speed: 0.1290s/iter; left time: 3920.2302s
	iters: 200, epoch: 36 | loss: 0.0190423
	speed: 0.0267s/iter; left time: 807.2211s
	iters: 300, epoch: 36 | loss: 0.2257569
	speed: 0.0263s/iter; left time: 792.9541s
	iters: 400, epoch: 36 | loss: 0.2280911
	speed: 0.0248s/iter; left time: 746.8156s
Epoch: 36 cost time: 12.353392362594604
Epoch: 36, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0119987
	speed: 0.1420s/iter; left time: 4248.7662s
	iters: 200, epoch: 37 | loss: 0.0012657
	speed: 0.0275s/iter; left time: 819.6998s
	iters: 300, epoch: 37 | loss: 0.0377639
	speed: 0.0271s/iter; left time: 806.7614s
	iters: 400, epoch: 37 | loss: 0.0612903
	speed: 0.0247s/iter; left time: 732.6283s
Epoch: 37 cost time: 12.765519142150879
Epoch: 37, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0008233
	speed: 0.1450s/iter; left time: 4271.0320s
	iters: 200, epoch: 38 | loss: 0.0207932
	speed: 0.0267s/iter; left time: 782.3270s
	iters: 300, epoch: 38 | loss: 0.0086480
	speed: 0.0254s/iter; left time: 742.5129s
	iters: 400, epoch: 38 | loss: 0.0476112
	speed: 0.0238s/iter; left time: 695.0746s
Epoch: 38 cost time: 12.267848491668701
Epoch: 38, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0515315
	speed: 0.1346s/iter; left time: 3901.9183s
	iters: 200, epoch: 39 | loss: 0.0063880
	speed: 0.0262s/iter; left time: 756.9212s
	iters: 300, epoch: 39 | loss: 0.0712927
	speed: 0.0236s/iter; left time: 680.2585s
	iters: 400, epoch: 39 | loss: 0.0053376
	speed: 0.0239s/iter; left time: 685.1107s
Epoch: 39 cost time: 12.114869356155396
Epoch: 39, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0096984
	speed: 0.1370s/iter; left time: 3907.0801s
	iters: 200, epoch: 40 | loss: 0.0007926
	speed: 0.0239s/iter; left time: 678.1056s
	iters: 300, epoch: 40 | loss: 0.0757881
	speed: 0.0235s/iter; left time: 664.9805s
	iters: 400, epoch: 40 | loss: 0.0136161
	speed: 0.0230s/iter; left time: 649.7767s
Epoch: 40 cost time: 11.642147064208984
Epoch: 40, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 38114
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6419079
	speed: 0.0454s/iter; left time: 2126.6127s
	iters: 200, epoch: 1 | loss: 0.9135824
	speed: 0.0243s/iter; left time: 1133.7063s
	iters: 300, epoch: 1 | loss: 0.6791369
	speed: 0.0245s/iter; left time: 1142.0233s
	iters: 400, epoch: 1 | loss: 0.3322408
	speed: 0.0236s/iter; left time: 1097.9770s
Epoch: 1 cost time: 13.496827125549316
Epoch: 1, Steps: 469 | Train Loss: 1.101 Vali Loss: 0.541 Vali Acc: 0.836 Test Loss: 0.541 Test Acc: 0.836
Validation loss decreased (inf --> -0.835615).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4835951
	speed: 0.1370s/iter; left time: 6348.4274s
	iters: 200, epoch: 2 | loss: 0.3599365
	speed: 0.0255s/iter; left time: 1178.4098s
	iters: 300, epoch: 2 | loss: 0.2300586
	speed: 0.0248s/iter; left time: 1144.2715s
	iters: 400, epoch: 2 | loss: 0.1619141
	speed: 0.0245s/iter; left time: 1126.5779s
Epoch: 2 cost time: 12.121544122695923
Epoch: 2, Steps: 469 | Train Loss: 0.348 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
Validation loss decreased (-0.835615 --> -0.901083).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1553764
	speed: 0.1341s/iter; left time: 6148.7984s
	iters: 200, epoch: 3 | loss: 0.4285339
	speed: 0.0257s/iter; left time: 1175.2976s
	iters: 300, epoch: 3 | loss: 0.0848890
	speed: 0.0230s/iter; left time: 1049.0580s
	iters: 400, epoch: 3 | loss: 0.0708954
	speed: 0.0232s/iter; left time: 1055.0464s
Epoch: 3 cost time: 11.979921102523804
Epoch: 3, Steps: 469 | Train Loss: 0.227 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.901083 --> -0.927956).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3125304
	speed: 0.1450s/iter; left time: 6584.2640s
	iters: 200, epoch: 4 | loss: 0.2425666
	speed: 0.0250s/iter; left time: 1133.8385s
	iters: 300, epoch: 4 | loss: 0.1815417
	speed: 0.0252s/iter; left time: 1138.3198s
	iters: 400, epoch: 4 | loss: 0.0576753
	speed: 0.0238s/iter; left time: 1073.6490s
Epoch: 4 cost time: 12.316179990768433
Epoch: 4, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.211 Vali Acc: 0.945 Test Loss: 0.211 Test Acc: 0.945
Validation loss decreased (-0.927956 --> -0.945109).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2559357
	speed: 0.1423s/iter; left time: 6394.9015s
	iters: 200, epoch: 5 | loss: 0.2375494
	speed: 0.0244s/iter; left time: 1094.9325s
	iters: 300, epoch: 5 | loss: 0.1769700
	speed: 0.0242s/iter; left time: 1080.6223s
	iters: 400, epoch: 5 | loss: 0.0444472
	speed: 0.0250s/iter; left time: 1115.3811s
Epoch: 5 cost time: 12.090451002120972
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.201 Vali Acc: 0.947 Test Loss: 0.201 Test Acc: 0.947
Validation loss decreased (-0.945109 --> -0.946539).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2644889
	speed: 0.1445s/iter; left time: 6422.9020s
	iters: 200, epoch: 6 | loss: 0.0465336
	speed: 0.0247s/iter; left time: 1097.6279s
	iters: 300, epoch: 6 | loss: 0.0407432
	speed: 0.0237s/iter; left time: 1049.9150s
	iters: 400, epoch: 6 | loss: 0.0207516
	speed: 0.0246s/iter; left time: 1087.7883s
Epoch: 6 cost time: 11.92967176437378
Epoch: 6, Steps: 469 | Train Loss: 0.127 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.946539 --> -0.950541).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0590546
	speed: 0.1441s/iter; left time: 6337.9910s
	iters: 200, epoch: 7 | loss: 0.2230061
	speed: 0.0249s/iter; left time: 1090.6546s
	iters: 300, epoch: 7 | loss: 0.0983043
	speed: 0.0234s/iter; left time: 1025.5676s
	iters: 400, epoch: 7 | loss: 0.0814639
	speed: 0.0240s/iter; left time: 1050.0647s
Epoch: 7 cost time: 11.714404106140137
Epoch: 7, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.950541 --> -0.953400).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1248956
	speed: 0.1371s/iter; left time: 5965.7132s
	iters: 200, epoch: 8 | loss: 0.0478786
	speed: 0.0239s/iter; left time: 1039.7276s
	iters: 300, epoch: 8 | loss: 0.0413941
	speed: 0.0240s/iter; left time: 1041.6790s
	iters: 400, epoch: 8 | loss: 0.1512179
	speed: 0.0255s/iter; left time: 1100.5980s
Epoch: 8 cost time: 12.070374488830566
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.953400 --> -0.957403).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5218282
	speed: 0.1294s/iter; left time: 5572.5529s
	iters: 200, epoch: 9 | loss: 0.2364476
	speed: 0.0228s/iter; left time: 978.8454s
	iters: 300, epoch: 9 | loss: 0.0618041
	speed: 0.0258s/iter; left time: 1106.1344s
	iters: 400, epoch: 9 | loss: 0.0247889
	speed: 0.0256s/iter; left time: 1095.5260s
Epoch: 9 cost time: 11.85298752784729
Epoch: 9, Steps: 469 | Train Loss: 0.087 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.957403 --> -0.963692).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0189387
	speed: 0.1323s/iter; left time: 5633.5665s
	iters: 200, epoch: 10 | loss: 0.1111164
	speed: 0.0241s/iter; left time: 1024.0053s
	iters: 300, epoch: 10 | loss: 0.0870246
	speed: 0.0261s/iter; left time: 1105.8228s
	iters: 400, epoch: 10 | loss: 0.2562231
	speed: 0.0254s/iter; left time: 1071.8598s
Epoch: 10 cost time: 12.309105157852173
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
Validation loss decreased (-0.963692 --> -0.971125).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0359434
	speed: 0.1340s/iter; left time: 5644.5320s
	iters: 200, epoch: 11 | loss: 0.0144939
	speed: 0.0250s/iter; left time: 1052.0754s
	iters: 300, epoch: 11 | loss: 0.0703011
	speed: 0.0255s/iter; left time: 1068.3683s
	iters: 400, epoch: 11 | loss: 0.2422220
	speed: 0.0239s/iter; left time: 999.3290s
Epoch: 11 cost time: 11.993382453918457
Epoch: 11, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0567260
	speed: 0.1274s/iter; left time: 5305.3295s
	iters: 200, epoch: 12 | loss: 0.0691330
	speed: 0.0276s/iter; left time: 1145.0405s
	iters: 300, epoch: 12 | loss: 0.0346150
	speed: 0.0268s/iter; left time: 1110.3730s
	iters: 400, epoch: 12 | loss: 0.0323614
	speed: 0.0274s/iter; left time: 1132.1921s
Epoch: 12 cost time: 12.75813889503479
Epoch: 12, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0801484
	speed: 0.1193s/iter; left time: 4910.1257s
	iters: 200, epoch: 13 | loss: 0.1327858
	speed: 0.0219s/iter; left time: 898.4107s
	iters: 300, epoch: 13 | loss: 0.0181016
	speed: 0.0217s/iter; left time: 889.9820s
	iters: 400, epoch: 13 | loss: 0.0818627
	speed: 0.0214s/iter; left time: 875.0539s
Epoch: 13 cost time: 10.478578567504883
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0115216
	speed: 0.1283s/iter; left time: 5221.9230s
	iters: 200, epoch: 14 | loss: 0.0962768
	speed: 0.0261s/iter; left time: 1059.3303s
	iters: 300, epoch: 14 | loss: 0.1411396
	speed: 0.0270s/iter; left time: 1091.6779s
	iters: 400, epoch: 14 | loss: 0.0682566
	speed: 0.0272s/iter; left time: 1099.7661s
Epoch: 14 cost time: 12.724386930465698
Epoch: 14, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0137806
	speed: 0.1335s/iter; left time: 5371.3720s
	iters: 200, epoch: 15 | loss: 0.0779640
	speed: 0.0273s/iter; left time: 1097.2888s
	iters: 300, epoch: 15 | loss: 0.1714393
	speed: 0.0267s/iter; left time: 1067.4058s
	iters: 400, epoch: 15 | loss: 0.2053587
	speed: 0.0256s/iter; left time: 1021.1990s
Epoch: 15 cost time: 12.721609354019165
Epoch: 15, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0575326
	speed: 0.1155s/iter; left time: 4591.6756s
	iters: 200, epoch: 16 | loss: 0.0131308
	speed: 0.0220s/iter; left time: 870.8451s
	iters: 300, epoch: 16 | loss: 0.0071637
	speed: 0.0199s/iter; left time: 786.9261s
	iters: 400, epoch: 16 | loss: 0.0052636
	speed: 0.0202s/iter; left time: 796.2595s
Epoch: 16 cost time: 10.116089344024658
Epoch: 16, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.971125 --> -0.971411).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0263307
	speed: 0.1349s/iter; left time: 5300.4189s
	iters: 200, epoch: 17 | loss: 0.1446823
	speed: 0.0230s/iter; left time: 900.8156s
	iters: 300, epoch: 17 | loss: 0.0103317
	speed: 0.0232s/iter; left time: 905.6358s
	iters: 400, epoch: 17 | loss: 0.0441254
	speed: 0.0231s/iter; left time: 900.8955s
Epoch: 17 cost time: 11.475626230239868
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.971411 --> -0.971697).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0903883
	speed: 0.1359s/iter; left time: 5275.4682s
	iters: 200, epoch: 18 | loss: 0.0154905
	speed: 0.0236s/iter; left time: 912.1057s
	iters: 300, epoch: 18 | loss: 0.0129400
	speed: 0.0229s/iter; left time: 882.7871s
	iters: 400, epoch: 18 | loss: 0.0307528
	speed: 0.0233s/iter; left time: 895.8132s
Epoch: 18 cost time: 11.390058755874634
Epoch: 18, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.971697 --> -0.972555).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0496574
	speed: 0.1302s/iter; left time: 4993.6249s
	iters: 200, epoch: 19 | loss: 0.1082196
	speed: 0.0228s/iter; left time: 873.6428s
	iters: 300, epoch: 19 | loss: 0.0470017
	speed: 0.0226s/iter; left time: 863.9033s
	iters: 400, epoch: 19 | loss: 0.2973624
	speed: 0.0245s/iter; left time: 933.1053s
Epoch: 19 cost time: 11.443925619125366
Epoch: 19, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972555 --> -0.972840).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0720887
	speed: 0.1331s/iter; left time: 5041.3255s
	iters: 200, epoch: 20 | loss: 0.0616224
	speed: 0.0240s/iter; left time: 906.8820s
	iters: 300, epoch: 20 | loss: 0.0066453
	speed: 0.0238s/iter; left time: 896.7191s
	iters: 400, epoch: 20 | loss: 0.0077905
	speed: 0.0253s/iter; left time: 952.7200s
Epoch: 20 cost time: 11.903176307678223
Epoch: 20, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0127912
	speed: 0.1306s/iter; left time: 4886.2811s
	iters: 200, epoch: 21 | loss: 0.1812235
	speed: 0.0229s/iter; left time: 855.7973s
	iters: 300, epoch: 21 | loss: 0.0798265
	speed: 0.0232s/iter; left time: 865.0122s
	iters: 400, epoch: 21 | loss: 0.0816754
	speed: 0.0252s/iter; left time: 934.7347s
Epoch: 21 cost time: 11.709024906158447
Epoch: 21, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.976557).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0623164
	speed: 0.1380s/iter; left time: 5098.4668s
	iters: 200, epoch: 22 | loss: 0.0480828
	speed: 0.0256s/iter; left time: 941.7301s
	iters: 300, epoch: 22 | loss: 0.0059709
	speed: 0.0252s/iter; left time: 924.9451s
	iters: 400, epoch: 22 | loss: 0.0188184
	speed: 0.0244s/iter; left time: 894.9570s
Epoch: 22 cost time: 12.255563735961914
Epoch: 22, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0613613
	speed: 0.1318s/iter; left time: 4807.3868s
	iters: 200, epoch: 23 | loss: 0.0068152
	speed: 0.0258s/iter; left time: 937.2508s
	iters: 300, epoch: 23 | loss: 0.0494458
	speed: 0.0257s/iter; left time: 932.7598s
	iters: 400, epoch: 23 | loss: 0.0682820
	speed: 0.0239s/iter; left time: 866.3378s
Epoch: 23 cost time: 12.06804370880127
Epoch: 23, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.1088569
	speed: 0.1317s/iter; left time: 4742.9837s
	iters: 200, epoch: 24 | loss: 0.0383616
	speed: 0.0255s/iter; left time: 916.3242s
	iters: 300, epoch: 24 | loss: 0.0187076
	speed: 0.0253s/iter; left time: 906.3521s
	iters: 400, epoch: 24 | loss: 0.2722397
	speed: 0.0269s/iter; left time: 960.3520s
Epoch: 24 cost time: 12.550989151000977
Epoch: 24, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978844).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0082551
	speed: 0.1309s/iter; left time: 4653.2508s
	iters: 200, epoch: 25 | loss: 0.0048725
	speed: 0.0267s/iter; left time: 946.9091s
	iters: 300, epoch: 25 | loss: 0.0073621
	speed: 0.0254s/iter; left time: 898.7409s
	iters: 400, epoch: 25 | loss: 0.4127803
	speed: 0.0252s/iter; left time: 887.1201s
Epoch: 25 cost time: 12.385411262512207
Epoch: 25, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0018955
	speed: 0.1265s/iter; left time: 4437.3171s
	iters: 200, epoch: 26 | loss: 0.0008943
	speed: 0.0252s/iter; left time: 881.6677s
	iters: 300, epoch: 26 | loss: 0.0025428
	speed: 0.0250s/iter; left time: 870.2937s
	iters: 400, epoch: 26 | loss: 0.0560623
	speed: 0.0234s/iter; left time: 814.8554s
Epoch: 26 cost time: 11.692495107650757
Epoch: 26, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 27 | loss: 0.0026299
	speed: 0.1328s/iter; left time: 4594.1432s
	iters: 200, epoch: 27 | loss: 0.0063450
	speed: 0.0245s/iter; left time: 846.4515s
	iters: 300, epoch: 27 | loss: 0.0102529
	speed: 0.0239s/iter; left time: 820.9466s
	iters: 400, epoch: 27 | loss: 0.0475779
	speed: 0.0231s/iter; left time: 791.3682s
Epoch: 27 cost time: 11.712226867675781
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 28 | loss: 0.0080145
	speed: 0.1296s/iter; left time: 4425.2795s
	iters: 200, epoch: 28 | loss: 0.0065689
	speed: 0.0237s/iter; left time: 806.2360s
	iters: 300, epoch: 28 | loss: 0.0007107
	speed: 0.0219s/iter; left time: 743.6686s
	iters: 400, epoch: 28 | loss: 0.0072947
	speed: 0.0227s/iter; left time: 767.3528s
Epoch: 28 cost time: 11.395911931991577
Epoch: 28, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 29 | loss: 0.0027192
	speed: 0.1292s/iter; left time: 4348.5044s
	iters: 200, epoch: 29 | loss: 0.0015471
	speed: 0.0249s/iter; left time: 836.0018s
	iters: 300, epoch: 29 | loss: 0.0509797
	speed: 0.0222s/iter; left time: 743.0401s
	iters: 400, epoch: 29 | loss: 0.0107636
	speed: 0.0229s/iter; left time: 763.7910s
Epoch: 29 cost time: 11.460835218429565
Epoch: 29, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 30 | loss: 0.0564404
	speed: 0.1315s/iter; left time: 4366.6421s
	iters: 200, epoch: 30 | loss: 0.0113106
	speed: 0.0228s/iter; left time: 755.8912s
	iters: 300, epoch: 30 | loss: 0.0698319
	speed: 0.0233s/iter; left time: 768.8598s
	iters: 400, epoch: 30 | loss: 0.0028986
	speed: 0.0230s/iter; left time: 757.0985s
Epoch: 30 cost time: 11.569788455963135
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 31 | loss: 0.0015769
	speed: 0.1313s/iter; left time: 4297.8882s
	iters: 200, epoch: 31 | loss: 0.0441124
	speed: 0.0217s/iter; left time: 708.7268s
	iters: 300, epoch: 31 | loss: 0.1062214
	speed: 0.0241s/iter; left time: 785.0250s
	iters: 400, epoch: 31 | loss: 0.0028015
	speed: 0.0253s/iter; left time: 819.6493s
Epoch: 31 cost time: 11.599898338317871
Epoch: 31, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 32 | loss: 0.0016871
	speed: 0.1373s/iter; left time: 4428.4002s
	iters: 200, epoch: 32 | loss: 0.0058972
	speed: 0.0228s/iter; left time: 734.2111s
	iters: 300, epoch: 32 | loss: 0.0263378
	speed: 0.0230s/iter; left time: 738.9758s
	iters: 400, epoch: 32 | loss: 0.0296979
	speed: 0.0263s/iter; left time: 841.0658s
Epoch: 32 cost time: 11.769290685653687
Epoch: 32, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 33 | loss: 0.0071127
	speed: 0.1334s/iter; left time: 4242.7014s
	iters: 200, epoch: 33 | loss: 0.1086520
	speed: 0.0232s/iter; left time: 735.6275s
	iters: 300, epoch: 33 | loss: 0.0064438
	speed: 0.0260s/iter; left time: 821.7794s
	iters: 400, epoch: 33 | loss: 0.0356530
	speed: 0.0253s/iter; left time: 797.9348s
Epoch: 33 cost time: 11.931788206100464
Epoch: 33, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 34 | loss: 0.0241442
	speed: 0.1303s/iter; left time: 4082.0747s
	iters: 200, epoch: 34 | loss: 0.6194124
	speed: 0.0266s/iter; left time: 832.0395s
	iters: 300, epoch: 34 | loss: 0.0195228
	speed: 0.0263s/iter; left time: 819.8795s
	iters: 400, epoch: 34 | loss: 0.0024308
	speed: 0.0260s/iter; left time: 805.2177s
Epoch: 34 cost time: 12.422360897064209
Epoch: 34, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 38114
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7176070
	speed: 0.0413s/iter; left time: 1932.3208s
	iters: 200, epoch: 1 | loss: 1.0191096
	speed: 0.0231s/iter; left time: 1077.4448s
	iters: 300, epoch: 1 | loss: 0.6781584
	speed: 0.0240s/iter; left time: 1117.3063s
	iters: 400, epoch: 1 | loss: 0.3884598
	speed: 0.0243s/iter; left time: 1129.2440s
Epoch: 1 cost time: 13.011143445968628
Epoch: 1, Steps: 469 | Train Loss: 1.187 Vali Loss: 0.597 Vali Acc: 0.822 Test Loss: 0.597 Test Acc: 0.822
Validation loss decreased (inf --> -0.821892).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5132135
	speed: 0.1309s/iter; left time: 6063.6095s
	iters: 200, epoch: 2 | loss: 0.3595338
	speed: 0.0221s/iter; left time: 1022.5778s
	iters: 300, epoch: 2 | loss: 0.1928868
	speed: 0.0245s/iter; left time: 1130.3938s
	iters: 400, epoch: 2 | loss: 0.2377823
	speed: 0.0253s/iter; left time: 1166.5576s
Epoch: 2 cost time: 11.691468715667725
Epoch: 2, Steps: 469 | Train Loss: 0.368 Vali Loss: 0.313 Vali Acc: 0.909 Test Loss: 0.313 Test Acc: 0.909
Validation loss decreased (-0.821892 --> -0.908802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1372955
	speed: 0.1298s/iter; left time: 5951.3033s
	iters: 200, epoch: 3 | loss: 0.3425955
	speed: 0.0218s/iter; left time: 995.8493s
	iters: 300, epoch: 3 | loss: 0.0529540
	speed: 0.0238s/iter; left time: 1088.6037s
	iters: 400, epoch: 3 | loss: 0.0637422
	speed: 0.0239s/iter; left time: 1089.3240s
Epoch: 3 cost time: 11.241298198699951
Epoch: 3, Steps: 469 | Train Loss: 0.226 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.908802 --> -0.943680).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1153828
	speed: 0.1233s/iter; left time: 5595.0092s
	iters: 200, epoch: 4 | loss: 0.2283894
	speed: 0.0246s/iter; left time: 1112.2952s
	iters: 300, epoch: 4 | loss: 0.1582869
	speed: 0.0242s/iter; left time: 1094.4292s
	iters: 400, epoch: 4 | loss: 0.0445894
	speed: 0.0241s/iter; left time: 1087.5019s
Epoch: 4 cost time: 11.633549213409424
Epoch: 4, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.943680 --> -0.953972).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2672852
	speed: 0.1270s/iter; left time: 5705.9632s
	iters: 200, epoch: 5 | loss: 0.2834485
	speed: 0.0247s/iter; left time: 1105.7659s
	iters: 300, epoch: 5 | loss: 0.2297151
	speed: 0.0244s/iter; left time: 1089.3619s
	iters: 400, epoch: 5 | loss: 0.0781044
	speed: 0.0239s/iter; left time: 1065.5387s
Epoch: 5 cost time: 11.832653522491455
Epoch: 5, Steps: 469 | Train Loss: 0.136 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.953972 --> -0.959404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2445202
	speed: 0.1281s/iter; left time: 5696.6302s
	iters: 200, epoch: 6 | loss: 0.0741595
	speed: 0.0249s/iter; left time: 1104.3962s
	iters: 300, epoch: 6 | loss: 0.0207722
	speed: 0.0264s/iter; left time: 1166.5597s
	iters: 400, epoch: 6 | loss: 0.0490315
	speed: 0.0255s/iter; left time: 1124.1218s
Epoch: 6 cost time: 12.380561590194702
Epoch: 6, Steps: 469 | Train Loss: 0.121 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.959404 --> -0.965121).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0534105
	speed: 0.1307s/iter; left time: 5749.7448s
	iters: 200, epoch: 7 | loss: 0.4018912
	speed: 0.0243s/iter; left time: 1067.7561s
	iters: 300, epoch: 7 | loss: 0.0790227
	speed: 0.0267s/iter; left time: 1168.4679s
	iters: 400, epoch: 7 | loss: 0.1202831
	speed: 0.0265s/iter; left time: 1156.4887s
Epoch: 7 cost time: 12.330867290496826
Epoch: 7, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.965121 --> -0.968552).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1307060
	speed: 0.1382s/iter; left time: 6013.4325s
	iters: 200, epoch: 8 | loss: 0.1271187
	speed: 0.0246s/iter; left time: 1070.2041s
	iters: 300, epoch: 8 | loss: 0.0800157
	speed: 0.0257s/iter; left time: 1113.4364s
	iters: 400, epoch: 8 | loss: 0.2330253
	speed: 0.0261s/iter; left time: 1127.4360s
Epoch: 8 cost time: 12.308830738067627
Epoch: 8, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.3371339
	speed: 0.1312s/iter; left time: 5648.4267s
	iters: 200, epoch: 9 | loss: 0.2994047
	speed: 0.0260s/iter; left time: 1116.7431s
	iters: 300, epoch: 9 | loss: 0.0714895
	speed: 0.0258s/iter; left time: 1107.2622s
	iters: 400, epoch: 9 | loss: 0.0099088
	speed: 0.0236s/iter; left time: 1010.6894s
Epoch: 9 cost time: 12.106902837753296
Epoch: 9, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0412351
	speed: 0.1256s/iter; left time: 5348.9244s
	iters: 200, epoch: 10 | loss: 0.1410141
	speed: 0.0254s/iter; left time: 1077.1453s
	iters: 300, epoch: 10 | loss: 0.0733934
	speed: 0.0227s/iter; left time: 960.3970s
	iters: 400, epoch: 10 | loss: 0.1563062
	speed: 0.0220s/iter; left time: 930.6405s
Epoch: 10 cost time: 11.419564247131348
Epoch: 10, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0182712
	speed: 0.1252s/iter; left time: 5274.2651s
	iters: 200, epoch: 11 | loss: 0.0219241
	speed: 0.0250s/iter; left time: 1050.7731s
	iters: 300, epoch: 11 | loss: 0.1348229
	speed: 0.0228s/iter; left time: 957.0780s
	iters: 400, epoch: 11 | loss: 0.0589763
	speed: 0.0223s/iter; left time: 934.3150s
Epoch: 11 cost time: 11.457849979400635
Epoch: 11, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.970267).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0237922
	speed: 0.1302s/iter; left time: 5422.4312s
	iters: 200, epoch: 12 | loss: 0.0734308
	speed: 0.0236s/iter; left time: 982.0114s
	iters: 300, epoch: 12 | loss: 0.0196466
	speed: 0.0232s/iter; left time: 963.4284s
	iters: 400, epoch: 12 | loss: 0.0786854
	speed: 0.0228s/iter; left time: 942.0371s
Epoch: 12 cost time: 11.473177194595337
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0319792
	speed: 0.1332s/iter; left time: 5483.4510s
	iters: 200, epoch: 13 | loss: 0.1580701
	speed: 0.0229s/iter; left time: 939.3247s
	iters: 300, epoch: 13 | loss: 0.0098858
	speed: 0.0228s/iter; left time: 935.5619s
	iters: 400, epoch: 13 | loss: 0.0564748
	speed: 0.0228s/iter; left time: 933.0389s
Epoch: 13 cost time: 11.252328157424927
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
Validation loss decreased (-0.970267 --> -0.971983).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0472485
	speed: 0.1085s/iter; left time: 4415.3346s
	iters: 200, epoch: 14 | loss: 0.1135846
	speed: 0.0205s/iter; left time: 832.3324s
	iters: 300, epoch: 14 | loss: 0.0904836
	speed: 0.0230s/iter; left time: 930.6905s
	iters: 400, epoch: 14 | loss: 0.0156369
	speed: 0.0248s/iter; left time: 1001.0158s
Epoch: 14 cost time: 11.207711696624756
Epoch: 14, Steps: 469 | Train Loss: 0.077 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.971983 --> -0.972840).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0068656
	speed: 0.1261s/iter; left time: 5072.2415s
	iters: 200, epoch: 15 | loss: 0.0446247
	speed: 0.0236s/iter; left time: 947.0736s
	iters: 300, epoch: 15 | loss: 0.1340820
	speed: 0.0266s/iter; left time: 1065.8847s
	iters: 400, epoch: 15 | loss: 0.2314759
	speed: 0.0258s/iter; left time: 1031.0529s
Epoch: 15 cost time: 12.045464038848877
Epoch: 15, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.973126).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0286441
	speed: 0.1273s/iter; left time: 5061.8879s
	iters: 200, epoch: 16 | loss: 0.0128927
	speed: 0.0250s/iter; left time: 992.5463s
	iters: 300, epoch: 16 | loss: 0.0153296
	speed: 0.0255s/iter; left time: 1010.9058s
	iters: 400, epoch: 16 | loss: 0.0277866
	speed: 0.0248s/iter; left time: 978.7888s
Epoch: 16 cost time: 12.16624116897583
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0018037
	speed: 0.1252s/iter; left time: 4919.7418s
	iters: 200, epoch: 17 | loss: 0.0222532
	speed: 0.0244s/iter; left time: 958.1681s
	iters: 300, epoch: 17 | loss: 0.0603857
	speed: 0.0250s/iter; left time: 975.8638s
	iters: 400, epoch: 17 | loss: 0.1320919
	speed: 0.0250s/iter; left time: 972.9914s
Epoch: 17 cost time: 12.016704082489014
Epoch: 17, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.973126 --> -0.975985).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0460341
	speed: 0.1297s/iter; left time: 5037.9182s
	iters: 200, epoch: 18 | loss: 0.0020524
	speed: 0.0249s/iter; left time: 964.2385s
	iters: 300, epoch: 18 | loss: 0.0604641
	speed: 0.0264s/iter; left time: 1019.4463s
	iters: 400, epoch: 18 | loss: 0.0110001
	speed: 0.0252s/iter; left time: 970.7551s
Epoch: 18 cost time: 12.073832511901855
Epoch: 18, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0862766
	speed: 0.1236s/iter; left time: 4740.8047s
	iters: 200, epoch: 19 | loss: 0.0973485
	speed: 0.0254s/iter; left time: 973.5994s
	iters: 300, epoch: 19 | loss: 0.0215859
	speed: 0.0240s/iter; left time: 914.1214s
	iters: 400, epoch: 19 | loss: 0.1821420
	speed: 0.0225s/iter; left time: 857.5251s
Epoch: 19 cost time: 11.582065343856812
Epoch: 19, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0426318
	speed: 0.1267s/iter; left time: 4801.1403s
	iters: 200, epoch: 20 | loss: 0.0415403
	speed: 0.0244s/iter; left time: 921.7311s
	iters: 300, epoch: 20 | loss: 0.0259491
	speed: 0.0228s/iter; left time: 860.0795s
	iters: 400, epoch: 20 | loss: 0.0105129
	speed: 0.0224s/iter; left time: 841.4841s
Epoch: 20 cost time: 11.491549730300903
Epoch: 20, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0158529
	speed: 0.1278s/iter; left time: 4783.4575s
	iters: 200, epoch: 21 | loss: 0.2096631
	speed: 0.0228s/iter; left time: 851.3184s
	iters: 300, epoch: 21 | loss: 0.0024244
	speed: 0.0208s/iter; left time: 773.2717s
	iters: 400, epoch: 21 | loss: 0.0681742
	speed: 0.0235s/iter; left time: 871.1127s
Epoch: 21 cost time: 11.133509397506714
Epoch: 21, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 22 | loss: 0.0029852
	speed: 0.1256s/iter; left time: 4641.4317s
	iters: 200, epoch: 22 | loss: 0.0423439
	speed: 0.0230s/iter; left time: 847.0690s
	iters: 300, epoch: 22 | loss: 0.0619004
	speed: 0.0226s/iter; left time: 829.3976s
	iters: 400, epoch: 22 | loss: 0.0180186
	speed: 0.0240s/iter; left time: 879.3071s
Epoch: 22 cost time: 11.31352424621582
Epoch: 22, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 23 | loss: 0.0701643
	speed: 0.1280s/iter; left time: 4670.9597s
	iters: 200, epoch: 23 | loss: 0.0096253
	speed: 0.0227s/iter; left time: 826.6103s
	iters: 300, epoch: 23 | loss: 0.0072481
	speed: 0.0214s/iter; left time: 777.0842s
	iters: 400, epoch: 23 | loss: 0.0114200
	speed: 0.0236s/iter; left time: 853.0662s
Epoch: 23 cost time: 11.107536554336548
Epoch: 23, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 24 | loss: 0.0105163
	speed: 0.1293s/iter; left time: 4657.1069s
	iters: 200, epoch: 24 | loss: 0.0177356
	speed: 0.0234s/iter; left time: 840.8524s
	iters: 300, epoch: 24 | loss: 0.1418069
	speed: 0.0253s/iter; left time: 905.3561s
	iters: 400, epoch: 24 | loss: 0.2334132
	speed: 0.0261s/iter; left time: 933.8734s
Epoch: 24 cost time: 11.918004035949707
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 25 | loss: 0.0035426
	speed: 0.1285s/iter; left time: 4568.9582s
	iters: 200, epoch: 25 | loss: 0.0033227
	speed: 0.0260s/iter; left time: 921.2618s
	iters: 300, epoch: 25 | loss: 0.0207337
	speed: 0.0252s/iter; left time: 890.3359s
	iters: 400, epoch: 25 | loss: 0.3205395
	speed: 0.0256s/iter; left time: 901.6945s
Epoch: 25 cost time: 12.069401741027832
Epoch: 25, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 26 | loss: 0.0095174
	speed: 0.1290s/iter; left time: 4524.5710s
	iters: 200, epoch: 26 | loss: 0.0018678
	speed: 0.0254s/iter; left time: 886.9301s
	iters: 300, epoch: 26 | loss: 0.1205256
	speed: 0.0252s/iter; left time: 877.6115s
	iters: 400, epoch: 26 | loss: 0.0427584
	speed: 0.0263s/iter; left time: 915.1838s
Epoch: 26 cost time: 12.418828964233398
Epoch: 26, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975985 --> -0.977701).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0018274
	speed: 0.1323s/iter; left time: 4580.1560s
	iters: 200, epoch: 27 | loss: 0.0038554
	speed: 0.0252s/iter; left time: 868.5950s
	iters: 300, epoch: 27 | loss: 0.0084450
	speed: 0.0248s/iter; left time: 853.8924s
	iters: 400, epoch: 27 | loss: 0.1640639
	speed: 0.0251s/iter; left time: 862.3182s
Epoch: 27 cost time: 12.19156789779663
Epoch: 27, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.4560067
	speed: 0.1266s/iter; left time: 4323.3285s
	iters: 200, epoch: 28 | loss: 0.0684170
	speed: 0.0242s/iter; left time: 823.4681s
	iters: 300, epoch: 28 | loss: 0.0113772
	speed: 0.0237s/iter; left time: 805.3650s
	iters: 400, epoch: 28 | loss: 0.0115292
	speed: 0.0225s/iter; left time: 761.9207s
Epoch: 28 cost time: 11.317536354064941
Epoch: 28, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0020125
	speed: 0.1267s/iter; left time: 4266.0917s
	iters: 200, epoch: 29 | loss: 0.0074762
	speed: 0.0246s/iter; left time: 824.1689s
	iters: 300, epoch: 29 | loss: 0.2769143
	speed: 0.0226s/iter; left time: 755.3893s
	iters: 400, epoch: 29 | loss: 0.0802590
	speed: 0.0240s/iter; left time: 802.2406s
Epoch: 29 cost time: 11.595314741134644
Epoch: 29, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0826824
	speed: 0.1300s/iter; left time: 4317.0699s
	iters: 200, epoch: 30 | loss: 0.0175770
	speed: 0.0232s/iter; left time: 767.8865s
	iters: 300, epoch: 30 | loss: 0.0109697
	speed: 0.0221s/iter; left time: 730.2695s
	iters: 400, epoch: 30 | loss: 0.0007041
	speed: 0.0234s/iter; left time: 768.8585s
Epoch: 30 cost time: 11.252732276916504
Epoch: 30, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0086200
	speed: 0.1248s/iter; left time: 4084.9516s
	iters: 200, epoch: 31 | loss: 0.0503433
	speed: 0.0219s/iter; left time: 715.3238s
	iters: 300, epoch: 31 | loss: 0.0552556
	speed: 0.0222s/iter; left time: 720.7582s
	iters: 400, epoch: 31 | loss: 0.0033846
	speed: 0.0230s/iter; left time: 745.7983s
Epoch: 31 cost time: 11.054034948348999
Epoch: 31, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0612555
	speed: 0.1264s/iter; left time: 4078.7664s
	iters: 200, epoch: 32 | loss: 0.0261337
	speed: 0.0219s/iter; left time: 705.2366s
	iters: 300, epoch: 32 | loss: 0.0376488
	speed: 0.0223s/iter; left time: 716.3028s
	iters: 400, epoch: 32 | loss: 0.0433404
	speed: 0.0234s/iter; left time: 748.8536s
Epoch: 32 cost time: 11.136188983917236
Epoch: 32, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0026352
	speed: 0.1269s/iter; left time: 4034.6140s
	iters: 200, epoch: 33 | loss: 0.1487150
	speed: 0.0231s/iter; left time: 733.1146s
	iters: 300, epoch: 33 | loss: 0.0460004
	speed: 0.0226s/iter; left time: 712.5470s
	iters: 400, epoch: 33 | loss: 0.0072871
	speed: 0.0247s/iter; left time: 776.4206s
Epoch: 33 cost time: 11.343554735183716
Epoch: 33, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0044687
	speed: 0.1247s/iter; left time: 3904.5934s
	iters: 200, epoch: 34 | loss: 0.3871814
	speed: 0.0244s/iter; left time: 761.7041s
	iters: 300, epoch: 34 | loss: 0.0262409
	speed: 0.0245s/iter; left time: 763.2781s
	iters: 400, epoch: 34 | loss: 0.0033919
	speed: 0.0258s/iter; left time: 800.4187s
Epoch: 34 cost time: 12.004257678985596
Epoch: 34, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0574094
	speed: 0.1298s/iter; left time: 4003.4570s
	iters: 200, epoch: 35 | loss: 0.1453682
	speed: 0.0252s/iter; left time: 776.3997s
	iters: 300, epoch: 35 | loss: 0.0191218
	speed: 0.0263s/iter; left time: 807.4173s
	iters: 400, epoch: 35 | loss: 0.0017932
	speed: 0.0255s/iter; left time: 778.1742s
Epoch: 35 cost time: 12.293985843658447
Epoch: 35, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0023791
	speed: 0.1276s/iter; left time: 3878.3687s
	iters: 200, epoch: 36 | loss: 0.0246387
	speed: 0.0253s/iter; left time: 767.4871s
	iters: 300, epoch: 36 | loss: 0.3177361
	speed: 0.0250s/iter; left time: 754.7489s
	iters: 400, epoch: 36 | loss: 0.1755161
	speed: 0.0235s/iter; left time: 707.0342s
Epoch: 36 cost time: 12.174264907836914
Epoch: 36, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.977701 --> -0.977986).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0082373
	speed: 0.1337s/iter; left time: 4000.2960s
	iters: 200, epoch: 37 | loss: 0.0003521
	speed: 0.0257s/iter; left time: 765.8639s
	iters: 300, epoch: 37 | loss: 0.0022107
	speed: 0.0240s/iter; left time: 712.4856s
	iters: 400, epoch: 37 | loss: 0.2491359
	speed: 0.0232s/iter; left time: 687.2914s
Epoch: 37 cost time: 11.89862871170044
Epoch: 37, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 38 | loss: 0.0449457
	speed: 0.1307s/iter; left time: 3850.0980s
	iters: 200, epoch: 38 | loss: 0.0229053
	speed: 0.0239s/iter; left time: 701.1031s
	iters: 300, epoch: 38 | loss: 0.0779722
	speed: 0.0225s/iter; left time: 658.1649s
	iters: 400, epoch: 38 | loss: 0.2268969
	speed: 0.0211s/iter; left time: 615.2561s
Epoch: 38 cost time: 11.271007537841797
Epoch: 38, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
Validation loss decreased (-0.977986 --> -0.978844).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0140499
	speed: 0.1316s/iter; left time: 3814.0240s
	iters: 200, epoch: 39 | loss: 0.0181152
	speed: 0.0232s/iter; left time: 670.8799s
	iters: 300, epoch: 39 | loss: 0.0447942
	speed: 0.0217s/iter; left time: 625.3167s
	iters: 400, epoch: 39 | loss: 0.0049132
	speed: 0.0224s/iter; left time: 642.0997s
Epoch: 39 cost time: 11.277796745300293
Epoch: 39, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.1052908
	speed: 0.1319s/iter; left time: 3760.7052s
	iters: 200, epoch: 40 | loss: 0.0224209
	speed: 0.0227s/iter; left time: 644.1626s
	iters: 300, epoch: 40 | loss: 0.0367038
	speed: 0.0232s/iter; left time: 656.8413s
	iters: 400, epoch: 40 | loss: 0.0819505
	speed: 0.0232s/iter; left time: 653.1008s
Epoch: 40 cost time: 11.26602053642273
Epoch: 40, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0403401
	speed: 0.1365s/iter; left time: 3828.3079s
	iters: 200, epoch: 41 | loss: 0.0945906
	speed: 0.0223s/iter; left time: 622.6021s
	iters: 300, epoch: 41 | loss: 0.0732863
	speed: 0.0227s/iter; left time: 632.4342s
	iters: 400, epoch: 41 | loss: 0.2306886
	speed: 0.0244s/iter; left time: 675.6653s
Epoch: 41 cost time: 11.46323013305664
Epoch: 41, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0201398
	speed: 0.1311s/iter; left time: 3615.9679s
	iters: 200, epoch: 42 | loss: 0.0205828
	speed: 0.0222s/iter; left time: 610.5791s
	iters: 300, epoch: 42 | loss: 0.1904049
	speed: 0.0225s/iter; left time: 616.4485s
	iters: 400, epoch: 42 | loss: 0.2617634
	speed: 0.0243s/iter; left time: 662.6408s
Epoch: 42 cost time: 11.321788787841797
Epoch: 42, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.1991292
	speed: 0.1235s/iter; left time: 3345.9292s
	iters: 200, epoch: 43 | loss: 0.0373744
	speed: 0.0228s/iter; left time: 615.7890s
	iters: 300, epoch: 43 | loss: 0.0200487
	speed: 0.0236s/iter; left time: 636.0556s
	iters: 400, epoch: 43 | loss: 0.0091374
	speed: 0.0243s/iter; left time: 650.9701s
Epoch: 43 cost time: 11.355331659317017
Epoch: 43, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0251048
	speed: 0.1247s/iter; left time: 3320.0904s
	iters: 200, epoch: 44 | loss: 0.0038248
	speed: 0.0219s/iter; left time: 579.9142s
	iters: 300, epoch: 44 | loss: 0.0191279
	speed: 0.0203s/iter; left time: 535.9781s
	iters: 400, epoch: 44 | loss: 0.8539963
	speed: 0.0194s/iter; left time: 510.3925s
Epoch: 44 cost time: 10.202701568603516
Epoch: 44, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0213673
	speed: 0.1090s/iter; left time: 2851.0233s
	iters: 200, epoch: 45 | loss: 0.0123701
	speed: 0.0241s/iter; left time: 626.8872s
	iters: 300, epoch: 45 | loss: 0.0429969
	speed: 0.0244s/iter; left time: 632.4858s
	iters: 400, epoch: 45 | loss: 0.0027075
	speed: 0.0239s/iter; left time: 618.1149s
Epoch: 45 cost time: 11.65308403968811
Epoch: 45, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0373727
	speed: 0.1279s/iter; left time: 3287.5237s
	iters: 200, epoch: 46 | loss: 0.0481468
	speed: 0.0232s/iter; left time: 594.8694s
	iters: 300, epoch: 46 | loss: 0.0138772
	speed: 0.0243s/iter; left time: 620.4340s
	iters: 400, epoch: 46 | loss: 0.0339160
	speed: 0.0232s/iter; left time: 588.0642s
Epoch: 46 cost time: 11.589776754379272
Epoch: 46, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0033455
	speed: 0.1180s/iter; left time: 2977.0370s
	iters: 200, epoch: 47 | loss: 0.0080569
	speed: 0.0216s/iter; left time: 542.4273s
	iters: 300, epoch: 47 | loss: 0.0663766
	speed: 0.0222s/iter; left time: 556.4821s
	iters: 400, epoch: 47 | loss: 0.0949933
	speed: 0.0218s/iter; left time: 542.4017s
Epoch: 47 cost time: 10.760254383087158
Epoch: 47, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0138797
	speed: 0.1186s/iter; left time: 2935.2958s
	iters: 200, epoch: 48 | loss: 0.0003207
	speed: 0.0227s/iter; left time: 559.9908s
	iters: 300, epoch: 48 | loss: 0.0005806
	speed: 0.0226s/iter; left time: 553.9798s
	iters: 400, epoch: 48 | loss: 0.0328121
	speed: 0.0210s/iter; left time: 513.6873s
Epoch: 48 cost time: 10.781774997711182
Epoch: 48, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9788450543167524
model parameter : 38114
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6877391
	speed: 0.0403s/iter; left time: 1886.5205s
	iters: 200, epoch: 1 | loss: 0.9780375
	speed: 0.0221s/iter; left time: 1032.6679s
	iters: 300, epoch: 1 | loss: 0.7059944
	speed: 0.0225s/iter; left time: 1046.7966s
	iters: 400, epoch: 1 | loss: 0.6692533
	speed: 0.0241s/iter; left time: 1120.9300s
Epoch: 1 cost time: 12.627593994140625
Epoch: 1, Steps: 469 | Train Loss: 1.178 Vali Loss: 0.562 Vali Acc: 0.827 Test Loss: 0.562 Test Acc: 0.827
Validation loss decreased (inf --> -0.827038).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2548469
	speed: 0.1276s/iter; left time: 5913.5299s
	iters: 200, epoch: 2 | loss: 0.2854154
	speed: 0.0224s/iter; left time: 1037.8384s
	iters: 300, epoch: 2 | loss: 0.4170259
	speed: 0.0237s/iter; left time: 1092.3253s
	iters: 400, epoch: 2 | loss: 0.1939924
	speed: 0.0222s/iter; left time: 1023.3070s
Epoch: 2 cost time: 11.174590110778809
Epoch: 2, Steps: 469 | Train Loss: 0.341 Vali Loss: 0.359 Vali Acc: 0.899 Test Loss: 0.359 Test Acc: 0.899
Validation loss decreased (-0.827038 --> -0.899367).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2404408
	speed: 0.1307s/iter; left time: 5992.7484s
	iters: 200, epoch: 3 | loss: 0.2719968
	speed: 0.0244s/iter; left time: 1115.1934s
	iters: 300, epoch: 3 | loss: 0.1761569
	speed: 0.0249s/iter; left time: 1136.9085s
	iters: 400, epoch: 3 | loss: 0.2301510
	speed: 0.0228s/iter; left time: 1040.9893s
Epoch: 3 cost time: 11.716447830200195
Epoch: 3, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
Validation loss decreased (-0.899367 --> -0.924812).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3093233
	speed: 0.1234s/iter; left time: 5600.6575s
	iters: 200, epoch: 4 | loss: 0.1200662
	speed: 0.0248s/iter; left time: 1121.5469s
	iters: 300, epoch: 4 | loss: 0.1482940
	speed: 0.0248s/iter; left time: 1121.8831s
	iters: 400, epoch: 4 | loss: 0.9681060
	speed: 0.0253s/iter; left time: 1140.6669s
Epoch: 4 cost time: 11.96181583404541
Epoch: 4, Steps: 469 | Train Loss: 0.170 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.924812 --> -0.945967).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2339065
	speed: 0.1210s/iter; left time: 5435.3221s
	iters: 200, epoch: 5 | loss: 0.1338165
	speed: 0.0239s/iter; left time: 1073.3699s
	iters: 300, epoch: 5 | loss: 0.3835402
	speed: 0.0242s/iter; left time: 1082.7396s
	iters: 400, epoch: 5 | loss: 0.0269733
	speed: 0.0244s/iter; left time: 1087.6501s
Epoch: 5 cost time: 11.56583285331726
Epoch: 5, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.945967 --> -0.951971).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0382694
	speed: 0.1210s/iter; left time: 5379.4178s
	iters: 200, epoch: 6 | loss: 0.1058051
	speed: 0.0235s/iter; left time: 1044.3525s
	iters: 300, epoch: 6 | loss: 0.0596394
	speed: 0.0241s/iter; left time: 1066.7559s
	iters: 400, epoch: 6 | loss: 0.2024884
	speed: 0.0226s/iter; left time: 999.2860s
Epoch: 6 cost time: 11.367467641830444
Epoch: 6, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.2773367
	speed: 0.1274s/iter; left time: 5605.8091s
	iters: 200, epoch: 7 | loss: 0.0170292
	speed: 0.0222s/iter; left time: 976.0092s
	iters: 300, epoch: 7 | loss: 0.0530969
	speed: 0.0224s/iter; left time: 979.1976s
	iters: 400, epoch: 7 | loss: 0.0132302
	speed: 0.0216s/iter; left time: 943.3935s
Epoch: 7 cost time: 11.055902481079102
Epoch: 7, Steps: 469 | Train Loss: 0.103 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
Validation loss decreased (-0.951971 --> -0.960833).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0606939
	speed: 0.1259s/iter; left time: 5479.2071s
	iters: 200, epoch: 8 | loss: 0.2435719
	speed: 0.0214s/iter; left time: 928.1789s
	iters: 300, epoch: 8 | loss: 0.1121833
	speed: 0.0198s/iter; left time: 857.3733s
	iters: 400, epoch: 8 | loss: 0.2074338
	speed: 0.0231s/iter; left time: 996.8121s
Epoch: 8 cost time: 10.83931016921997
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0708094
	speed: 0.1282s/iter; left time: 5519.3185s
	iters: 200, epoch: 9 | loss: 0.0282675
	speed: 0.0197s/iter; left time: 844.6788s
	iters: 300, epoch: 9 | loss: 0.0221372
	speed: 0.0197s/iter; left time: 845.8843s
	iters: 400, epoch: 9 | loss: 0.0035051
	speed: 0.0197s/iter; left time: 841.5748s
Epoch: 9 cost time: 9.87542462348938
Epoch: 9, Steps: 469 | Train Loss: 0.082 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.960833 --> -0.963120).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.1141720
	speed: 0.1042s/iter; left time: 4435.2181s
	iters: 200, epoch: 10 | loss: 0.1287652
	speed: 0.0206s/iter; left time: 876.4062s
	iters: 300, epoch: 10 | loss: 0.1049563
	speed: 0.0215s/iter; left time: 911.1635s
	iters: 400, epoch: 10 | loss: 0.3039999
	speed: 0.0242s/iter; left time: 1023.8805s
Epoch: 10 cost time: 10.791264295578003
Epoch: 10, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0369719
	speed: 0.1168s/iter; left time: 4917.4837s
	iters: 200, epoch: 11 | loss: 0.0373129
	speed: 0.0215s/iter; left time: 902.5291s
	iters: 300, epoch: 11 | loss: 0.2194846
	speed: 0.0232s/iter; left time: 971.2539s
	iters: 400, epoch: 11 | loss: 0.0519430
	speed: 0.0198s/iter; left time: 826.0025s
Epoch: 11 cost time: 10.292020082473755
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.963120 --> -0.967409).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0084995
	speed: 0.0967s/iter; left time: 4028.5093s
	iters: 200, epoch: 12 | loss: 0.0132799
	speed: 0.0252s/iter; left time: 1045.7059s
	iters: 300, epoch: 12 | loss: 0.0084144
	speed: 0.0258s/iter; left time: 1068.6008s
	iters: 400, epoch: 12 | loss: 0.0198679
	speed: 0.0261s/iter; left time: 1080.6686s
Epoch: 12 cost time: 11.98968505859375
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.2536531
	speed: 0.1337s/iter; left time: 5506.0464s
	iters: 200, epoch: 13 | loss: 0.1065723
	speed: 0.0263s/iter; left time: 1080.4057s
	iters: 300, epoch: 13 | loss: 0.0079464
	speed: 0.0264s/iter; left time: 1079.8966s
	iters: 400, epoch: 13 | loss: 0.0150159
	speed: 0.0266s/iter; left time: 1088.2779s
Epoch: 13 cost time: 12.777103662490845
Epoch: 13, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.967409 --> -0.967694).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0655909
	speed: 0.1328s/iter; left time: 5404.5851s
	iters: 200, epoch: 14 | loss: 0.0316601
	speed: 0.0264s/iter; left time: 1073.6438s
	iters: 300, epoch: 14 | loss: 0.0720993
	speed: 0.0257s/iter; left time: 1040.5380s
	iters: 400, epoch: 14 | loss: 0.0583668
	speed: 0.0262s/iter; left time: 1058.0332s
Epoch: 14 cost time: 12.632795095443726
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0456982
	speed: 0.1296s/iter; left time: 5212.7044s
	iters: 200, epoch: 15 | loss: 0.0067181
	speed: 0.0244s/iter; left time: 978.8998s
	iters: 300, epoch: 15 | loss: 0.0325487
	speed: 0.0237s/iter; left time: 948.4133s
	iters: 400, epoch: 15 | loss: 0.0273969
	speed: 0.0245s/iter; left time: 977.0244s
Epoch: 15 cost time: 11.687145471572876
Epoch: 15, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967694 --> -0.967980).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0363601
	speed: 0.1225s/iter; left time: 4871.8947s
	iters: 200, epoch: 16 | loss: 0.0099728
	speed: 0.0250s/iter; left time: 990.2680s
	iters: 300, epoch: 16 | loss: 0.0112768
	speed: 0.0245s/iter; left time: 969.4915s
	iters: 400, epoch: 16 | loss: 0.0105183
	speed: 0.0226s/iter; left time: 893.5798s
Epoch: 16 cost time: 11.610475778579712
Epoch: 16, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.967980 --> -0.971411).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1892413
	speed: 0.1299s/iter; left time: 5106.5505s
	iters: 200, epoch: 17 | loss: 0.1772642
	speed: 0.0243s/iter; left time: 951.4293s
	iters: 300, epoch: 17 | loss: 0.0356533
	speed: 0.0219s/iter; left time: 856.3137s
	iters: 400, epoch: 17 | loss: 0.0219561
	speed: 0.0217s/iter; left time: 844.4021s
Epoch: 17 cost time: 11.404267072677612
Epoch: 17, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.971411 --> -0.973698).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0751738
	speed: 0.1385s/iter; left time: 5378.0671s
	iters: 200, epoch: 18 | loss: 0.0169577
	speed: 0.0244s/iter; left time: 943.7790s
	iters: 300, epoch: 18 | loss: 0.0321223
	speed: 0.0228s/iter; left time: 880.6139s
	iters: 400, epoch: 18 | loss: 0.0241005
	speed: 0.0225s/iter; left time: 865.6957s
Epoch: 18 cost time: 11.681041240692139
Epoch: 18, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0068456
	speed: 0.1372s/iter; left time: 5260.9501s
	iters: 200, epoch: 19 | loss: 0.0092606
	speed: 0.0221s/iter; left time: 844.9035s
	iters: 300, epoch: 19 | loss: 0.0215601
	speed: 0.0223s/iter; left time: 851.8603s
	iters: 400, epoch: 19 | loss: 0.1086926
	speed: 0.0243s/iter; left time: 923.9791s
Epoch: 19 cost time: 11.326045274734497
Epoch: 19, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0026453
	speed: 0.1256s/iter; left time: 4759.2335s
	iters: 200, epoch: 20 | loss: 0.0066693
	speed: 0.0241s/iter; left time: 909.8348s
	iters: 300, epoch: 20 | loss: 0.7793902
	speed: 0.0250s/iter; left time: 941.3812s
	iters: 400, epoch: 20 | loss: 0.0299599
	speed: 0.0242s/iter; left time: 909.2610s
Epoch: 20 cost time: 11.891645908355713
Epoch: 20, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0046858
	speed: 0.1354s/iter; left time: 5065.5748s
	iters: 200, epoch: 21 | loss: 0.0277799
	speed: 0.0264s/iter; left time: 985.5416s
	iters: 300, epoch: 21 | loss: 0.0064448
	speed: 0.0258s/iter; left time: 959.0280s
	iters: 400, epoch: 21 | loss: 0.0096716
	speed: 0.0250s/iter; left time: 927.7994s
Epoch: 21 cost time: 12.556828498840332
Epoch: 21, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
Validation loss decreased (-0.973698 --> -0.974270).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0200710
	speed: 0.1243s/iter; left time: 4593.5024s
	iters: 200, epoch: 22 | loss: 0.1510516
	speed: 0.0262s/iter; left time: 964.7261s
	iters: 300, epoch: 22 | loss: 0.1736858
	speed: 0.0261s/iter; left time: 958.2329s
	iters: 400, epoch: 22 | loss: 0.0085129
	speed: 0.0249s/iter; left time: 913.3747s
Epoch: 22 cost time: 12.379700183868408
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975128).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0345289
	speed: 0.1273s/iter; left time: 4642.6696s
	iters: 200, epoch: 23 | loss: 0.0150802
	speed: 0.0264s/iter; left time: 960.8743s
	iters: 300, epoch: 23 | loss: 0.1071469
	speed: 0.0264s/iter; left time: 957.6693s
	iters: 400, epoch: 23 | loss: 0.0226611
	speed: 0.0266s/iter; left time: 961.5658s
Epoch: 23 cost time: 12.62578296661377
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0046293
	speed: 0.1243s/iter; left time: 4475.4591s
	iters: 200, epoch: 24 | loss: 0.0112030
	speed: 0.0255s/iter; left time: 914.1813s
	iters: 300, epoch: 24 | loss: 0.2158296
	speed: 0.0254s/iter; left time: 909.9745s
	iters: 400, epoch: 24 | loss: 0.0081521
	speed: 0.0248s/iter; left time: 884.6113s
Epoch: 24 cost time: 12.069591045379639
Epoch: 24, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0666174
	speed: 0.1213s/iter; left time: 4310.2680s
	iters: 200, epoch: 25 | loss: 0.0059875
	speed: 0.0246s/iter; left time: 871.1776s
	iters: 300, epoch: 25 | loss: 0.0065732
	speed: 0.0250s/iter; left time: 883.0524s
	iters: 400, epoch: 25 | loss: 0.0458671
	speed: 0.0219s/iter; left time: 771.6426s
Epoch: 25 cost time: 11.552007913589478
Epoch: 25, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975128 --> -0.977701).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0803325
	speed: 0.1249s/iter; left time: 4382.3171s
	iters: 200, epoch: 26 | loss: 0.0437495
	speed: 0.0243s/iter; left time: 851.5543s
	iters: 300, epoch: 26 | loss: 0.0031903
	speed: 0.0237s/iter; left time: 825.6491s
	iters: 400, epoch: 26 | loss: 0.1432466
	speed: 0.0238s/iter; left time: 828.8150s
Epoch: 26 cost time: 11.660416841506958
Epoch: 26, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0628007
	speed: 0.1339s/iter; left time: 4632.7538s
	iters: 200, epoch: 27 | loss: 0.0350932
	speed: 0.0237s/iter; left time: 816.8126s
	iters: 300, epoch: 27 | loss: 0.0041865
	speed: 0.0237s/iter; left time: 814.5949s
	iters: 400, epoch: 27 | loss: 0.0033862
	speed: 0.0228s/iter; left time: 783.8060s
Epoch: 27 cost time: 11.462948322296143
Epoch: 27, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0062750
	speed: 0.1352s/iter; left time: 4616.9453s
	iters: 200, epoch: 28 | loss: 0.0032313
	speed: 0.0233s/iter; left time: 792.9817s
	iters: 300, epoch: 28 | loss: 0.0110196
	speed: 0.0216s/iter; left time: 732.1230s
	iters: 400, epoch: 28 | loss: 0.0011837
	speed: 0.0234s/iter; left time: 792.1713s
Epoch: 28 cost time: 11.240934133529663
Epoch: 28, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0053018
	speed: 0.1297s/iter; left time: 4366.8501s
	iters: 200, epoch: 29 | loss: 0.0467566
	speed: 0.0234s/iter; left time: 786.0326s
	iters: 300, epoch: 29 | loss: 0.0012144
	speed: 0.0237s/iter; left time: 793.4985s
	iters: 400, epoch: 29 | loss: 0.0031767
	speed: 0.0264s/iter; left time: 882.3505s
Epoch: 29 cost time: 12.045072793960571
Epoch: 29, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.1321242
	speed: 0.1316s/iter; left time: 4368.6179s
	iters: 200, epoch: 30 | loss: 0.0018259
	speed: 0.0231s/iter; left time: 763.8154s
	iters: 300, epoch: 30 | loss: 0.0018440
	speed: 0.0240s/iter; left time: 792.4239s
	iters: 400, epoch: 30 | loss: 0.0828741
	speed: 0.0263s/iter; left time: 865.4104s
Epoch: 30 cost time: 11.846717119216919
Epoch: 30, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0040820
	speed: 0.1268s/iter; left time: 4148.7665s
	iters: 200, epoch: 31 | loss: 0.0976604
	speed: 0.0236s/iter; left time: 769.1709s
	iters: 300, epoch: 31 | loss: 0.2176249
	speed: 0.0264s/iter; left time: 858.5355s
	iters: 400, epoch: 31 | loss: 0.0045588
	speed: 0.0261s/iter; left time: 845.6347s
Epoch: 31 cost time: 12.141930103302002
Epoch: 31, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.979416).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0226989
	speed: 0.1378s/iter; left time: 4445.8781s
	iters: 200, epoch: 32 | loss: 0.0401613
	speed: 0.0256s/iter; left time: 824.4580s
	iters: 300, epoch: 32 | loss: 0.0205213
	speed: 0.0266s/iter; left time: 851.7831s
	iters: 400, epoch: 32 | loss: 0.0313899
	speed: 0.0261s/iter; left time: 833.7388s
Epoch: 32 cost time: 12.610515356063843
Epoch: 32, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0363851
	speed: 0.1315s/iter; left time: 4181.5251s
	iters: 200, epoch: 33 | loss: 0.0473070
	speed: 0.0228s/iter; left time: 723.7578s
	iters: 300, epoch: 33 | loss: 0.0597838
	speed: 0.0249s/iter; left time: 787.3859s
	iters: 400, epoch: 33 | loss: 0.0018446
	speed: 0.0247s/iter; left time: 777.7324s
Epoch: 33 cost time: 11.976188898086548
Epoch: 33, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0411506
	speed: 0.1245s/iter; left time: 3901.2367s
	iters: 200, epoch: 34 | loss: 0.0271602
	speed: 0.0250s/iter; left time: 781.8272s
	iters: 300, epoch: 34 | loss: 0.0037003
	speed: 0.0249s/iter; left time: 775.9031s
	iters: 400, epoch: 34 | loss: 0.2982633
	speed: 0.0247s/iter; left time: 765.6748s
Epoch: 34 cost time: 12.062994241714478
Epoch: 34, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0089764
	speed: 0.1259s/iter; left time: 3885.4932s
	iters: 200, epoch: 35 | loss: 0.0739062
	speed: 0.0262s/iter; left time: 807.2313s
	iters: 300, epoch: 35 | loss: 0.0280058
	speed: 0.0246s/iter; left time: 753.9760s
	iters: 400, epoch: 35 | loss: 0.0010485
	speed: 0.0238s/iter; left time: 727.0469s
Epoch: 35 cost time: 12.036986589431763
Epoch: 35, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0065553
	speed: 0.1299s/iter; left time: 3945.6988s
	iters: 200, epoch: 36 | loss: 0.0005193
	speed: 0.0253s/iter; left time: 765.2336s
	iters: 300, epoch: 36 | loss: 0.0077153
	speed: 0.0247s/iter; left time: 744.6396s
	iters: 400, epoch: 36 | loss: 0.0069139
	speed: 0.0218s/iter; left time: 655.5756s
Epoch: 36 cost time: 11.652120590209961
Epoch: 36, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0002886
	speed: 0.1299s/iter; left time: 3886.8346s
	iters: 200, epoch: 37 | loss: 0.0378314
	speed: 0.0258s/iter; left time: 767.9865s
	iters: 300, epoch: 37 | loss: 0.0078053
	speed: 0.0221s/iter; left time: 656.1883s
	iters: 400, epoch: 37 | loss: 0.2604027
	speed: 0.0223s/iter; left time: 659.9832s
Epoch: 37 cost time: 11.473683834075928
Epoch: 37, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0440548
	speed: 0.1034s/iter; left time: 3044.3226s
	iters: 200, epoch: 38 | loss: 0.0184155
	speed: 0.0186s/iter; left time: 546.3426s
	iters: 300, epoch: 38 | loss: 0.0022667
	speed: 0.0200s/iter; left time: 583.5253s
	iters: 400, epoch: 38 | loss: 0.0182126
	speed: 0.0205s/iter; left time: 598.1347s
Epoch: 38 cost time: 10.016365766525269
Epoch: 38, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0277950
	speed: 0.1295s/iter; left time: 3753.6558s
	iters: 200, epoch: 39 | loss: 0.0467425
	speed: 0.0226s/iter; left time: 652.8498s
	iters: 300, epoch: 39 | loss: 0.0562981
	speed: 0.0235s/iter; left time: 677.3531s
	iters: 400, epoch: 39 | loss: 0.0046207
	speed: 0.0251s/iter; left time: 720.2499s
Epoch: 39 cost time: 11.549824714660645
Epoch: 39, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0434759
	speed: 0.1230s/iter; left time: 3507.9812s
	iters: 200, epoch: 40 | loss: 0.0083938
	speed: 0.0235s/iter; left time: 666.7995s
	iters: 300, epoch: 40 | loss: 0.0021917
	speed: 0.0251s/iter; left time: 709.9485s
	iters: 400, epoch: 40 | loss: 0.0097572
	speed: 0.0246s/iter; left time: 693.3768s
Epoch: 40 cost time: 11.689141511917114
Epoch: 40, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.979416 --> -0.981131).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0004020
	speed: 0.1233s/iter; left time: 3457.6703s
	iters: 200, epoch: 41 | loss: 0.0375127
	speed: 0.0255s/iter; left time: 712.1430s
	iters: 300, epoch: 41 | loss: 0.0267987
	speed: 0.0249s/iter; left time: 694.0268s
	iters: 400, epoch: 41 | loss: 0.0050898
	speed: 0.0250s/iter; left time: 693.2954s
Epoch: 41 cost time: 12.087154626846313
Epoch: 41, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 42 | loss: 0.0008195
	speed: 0.1281s/iter; left time: 3532.2933s
	iters: 200, epoch: 42 | loss: 0.0047472
	speed: 0.0244s/iter; left time: 671.3844s
	iters: 300, epoch: 42 | loss: 0.4082741
	speed: 0.0247s/iter; left time: 675.3886s
	iters: 400, epoch: 42 | loss: 0.0171287
	speed: 0.0248s/iter; left time: 676.1858s
Epoch: 42 cost time: 11.899144649505615
Epoch: 42, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 43 | loss: 0.0176810
	speed: 0.1263s/iter; left time: 3422.3519s
	iters: 200, epoch: 43 | loss: 0.0011328
	speed: 0.0236s/iter; left time: 637.8573s
	iters: 300, epoch: 43 | loss: 0.0162838
	speed: 0.0252s/iter; left time: 677.6585s
	iters: 400, epoch: 43 | loss: 0.0004061
	speed: 0.0243s/iter; left time: 650.7806s
Epoch: 43 cost time: 11.7592191696167
Epoch: 43, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 44 | loss: 0.0155630
	speed: 0.1238s/iter; left time: 3296.5377s
	iters: 200, epoch: 44 | loss: 0.0107799
	speed: 0.0243s/iter; left time: 643.8486s
	iters: 300, epoch: 44 | loss: 0.0075629
	speed: 0.0246s/iter; left time: 648.9691s
	iters: 400, epoch: 44 | loss: 0.0611079
	speed: 0.0223s/iter; left time: 586.5624s
Epoch: 44 cost time: 11.723693370819092
Epoch: 44, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 45 | loss: 0.0138584
	speed: 0.1280s/iter; left time: 3349.5056s
	iters: 200, epoch: 45 | loss: 0.0026209
	speed: 0.0242s/iter; left time: 630.1111s
	iters: 300, epoch: 45 | loss: 0.0013567
	speed: 0.0227s/iter; left time: 588.9110s
	iters: 400, epoch: 45 | loss: 0.0204696
	speed: 0.0224s/iter; left time: 578.3431s
Epoch: 45 cost time: 11.543564558029175
Epoch: 45, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 46 | loss: 0.0010592
	speed: 0.1269s/iter; left time: 3260.4426s
	iters: 200, epoch: 46 | loss: 0.0955490
	speed: 0.0214s/iter; left time: 546.7479s
	iters: 300, epoch: 46 | loss: 0.0177676
	speed: 0.0224s/iter; left time: 571.8756s
	iters: 400, epoch: 46 | loss: 0.0912816
	speed: 0.0219s/iter; left time: 555.4502s
Epoch: 46 cost time: 10.983196258544922
Epoch: 46, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 47 | loss: 0.0223887
	speed: 0.1323s/iter; left time: 3338.0025s
	iters: 200, epoch: 47 | loss: 0.0015909
	speed: 0.0231s/iter; left time: 580.8630s
	iters: 300, epoch: 47 | loss: 0.0497191
	speed: 0.0251s/iter; left time: 627.5204s
	iters: 400, epoch: 47 | loss: 0.0005138
	speed: 0.0260s/iter; left time: 647.8882s
Epoch: 47 cost time: 12.034403324127197
Epoch: 47, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 48 | loss: 0.0636089
	speed: 0.1266s/iter; left time: 3134.0697s
	iters: 200, epoch: 48 | loss: 0.2500678
	speed: 0.0249s/iter; left time: 614.6010s
	iters: 300, epoch: 48 | loss: 0.0232456
	speed: 0.0253s/iter; left time: 620.0992s
	iters: 400, epoch: 48 | loss: 0.0427353
	speed: 0.0243s/iter; left time: 594.6001s
Epoch: 48 cost time: 11.913838624954224
Epoch: 48, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 49 | loss: 0.0074945
	speed: 0.1249s/iter; left time: 3033.8042s
	iters: 200, epoch: 49 | loss: 0.0007691
	speed: 0.0253s/iter; left time: 611.6842s
	iters: 300, epoch: 49 | loss: 0.0015154
	speed: 0.0250s/iter; left time: 601.7516s
	iters: 400, epoch: 49 | loss: 0.0982274
	speed: 0.0250s/iter; left time: 599.7505s
Epoch: 49 cost time: 11.958751440048218
Epoch: 49, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.981131 --> -0.981131).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0045488
	speed: 0.1241s/iter; left time: 2955.0548s
	iters: 200, epoch: 50 | loss: 0.0479325
	speed: 0.0262s/iter; left time: 620.4398s
	iters: 300, epoch: 50 | loss: 0.0020320
	speed: 0.0265s/iter; left time: 626.2982s
	iters: 400, epoch: 50 | loss: 0.0015879
	speed: 0.0219s/iter; left time: 513.9276s
Epoch: 50 cost time: 11.904521226882935
Epoch: 50, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 51 | loss: 0.0291524
	speed: 0.1260s/iter; left time: 2942.5857s
	iters: 200, epoch: 51 | loss: 0.0067156
	speed: 0.0239s/iter; left time: 555.7010s
	iters: 300, epoch: 51 | loss: 0.0026768
	speed: 0.0235s/iter; left time: 543.1561s
	iters: 400, epoch: 51 | loss: 0.0016217
	speed: 0.0208s/iter; left time: 480.4851s
Epoch: 51 cost time: 10.993560314178467
Epoch: 51, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 52 | loss: 0.0010816
	speed: 0.1288s/iter; left time: 2946.5027s
	iters: 200, epoch: 52 | loss: 0.0518138
	speed: 0.0242s/iter; left time: 552.3660s
	iters: 300, epoch: 52 | loss: 0.0858869
	speed: 0.0224s/iter; left time: 507.1363s
	iters: 400, epoch: 52 | loss: 0.0044274
	speed: 0.0224s/iter; left time: 505.6265s
Epoch: 52 cost time: 11.336430311203003
Epoch: 52, Steps: 469 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 53 | loss: 0.0022317
	speed: 0.1269s/iter; left time: 2843.9480s
	iters: 200, epoch: 53 | loss: 0.0096293
	speed: 0.0225s/iter; left time: 503.1028s
	iters: 300, epoch: 53 | loss: 0.0034819
	speed: 0.0217s/iter; left time: 480.9404s
	iters: 400, epoch: 53 | loss: 0.1171841
	speed: 0.0222s/iter; left time: 491.5987s
Epoch: 53 cost time: 10.94106936454773
Epoch: 53, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 54 | loss: 0.0404114
	speed: 0.1264s/iter; left time: 2772.8907s
	iters: 200, epoch: 54 | loss: 0.0147461
	speed: 0.0222s/iter; left time: 484.2537s
	iters: 300, epoch: 54 | loss: 0.0062584
	speed: 0.0210s/iter; left time: 456.0875s
	iters: 400, epoch: 54 | loss: 0.0169671
	speed: 0.0217s/iter; left time: 470.7290s
Epoch: 54 cost time: 10.936397075653076
Epoch: 54, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 55 | loss: 0.0007389
	speed: 0.1287s/iter; left time: 2764.8038s
	iters: 200, epoch: 55 | loss: 0.0276540
	speed: 0.0221s/iter; left time: 472.7697s
	iters: 300, epoch: 55 | loss: 0.0148549
	speed: 0.0222s/iter; left time: 471.5501s
	iters: 400, epoch: 55 | loss: 0.0576573
	speed: 0.0246s/iter; left time: 521.7968s
Epoch: 55 cost time: 11.413635969161987
Epoch: 55, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 56 | loss: 0.1164489
	speed: 0.1328s/iter; left time: 2789.5440s
	iters: 200, epoch: 56 | loss: 0.0010656
	speed: 0.0237s/iter; left time: 494.5185s
	iters: 300, epoch: 56 | loss: 0.0292136
	speed: 0.0234s/iter; left time: 487.2942s
	iters: 400, epoch: 56 | loss: 0.0064363
	speed: 0.0254s/iter; left time: 525.5814s
Epoch: 56 cost time: 11.744272232055664
Epoch: 56, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 57 | loss: 0.0145780
	speed: 0.1348s/iter; left time: 2767.9079s
	iters: 200, epoch: 57 | loss: 0.0007016
	speed: 0.0236s/iter; left time: 483.0406s
	iters: 300, epoch: 57 | loss: 0.0142737
	speed: 0.0241s/iter; left time: 490.5050s
	iters: 400, epoch: 57 | loss: 0.0037487
	speed: 0.0255s/iter; left time: 517.0504s
Epoch: 57 cost time: 11.796631097793579
Epoch: 57, Steps: 469 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 58 | loss: 0.0365007
	speed: 0.1234s/iter; left time: 2476.0767s
	iters: 200, epoch: 58 | loss: 0.0050181
	speed: 0.0256s/iter; left time: 511.5995s
	iters: 300, epoch: 58 | loss: 0.0221773
	speed: 0.0262s/iter; left time: 519.5543s
	iters: 400, epoch: 58 | loss: 0.1301520
	speed: 0.0255s/iter; left time: 503.5529s
Epoch: 58 cost time: 12.13788652420044
Epoch: 58, Steps: 469 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 59 | loss: 0.0034771
	speed: 0.1264s/iter; left time: 2477.5822s
	iters: 200, epoch: 59 | loss: 0.0002275
	speed: 0.0250s/iter; left time: 487.7862s
	iters: 300, epoch: 59 | loss: 0.0002733
	speed: 0.0249s/iter; left time: 483.1612s
	iters: 400, epoch: 59 | loss: 0.0020103
	speed: 0.0253s/iter; left time: 488.2085s
Epoch: 59 cost time: 12.161795377731323
Epoch: 59, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9811320754716981
model parameter : 21730
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7393540
	speed: 0.0419s/iter; left time: 1962.4618s
	iters: 200, epoch: 1 | loss: 1.0594643
	speed: 0.0241s/iter; left time: 1123.8455s
	iters: 300, epoch: 1 | loss: 0.7488064
	speed: 0.0251s/iter; left time: 1167.9911s
	iters: 400, epoch: 1 | loss: 0.7499646
	speed: 0.0253s/iter; left time: 1177.5281s
Epoch: 1 cost time: 13.431690692901611
Epoch: 1, Steps: 469 | Train Loss: 1.204 Vali Loss: 0.578 Vali Acc: 0.820 Test Loss: 0.578 Test Acc: 0.820
Validation loss decreased (inf --> -0.820177).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2684096
	speed: 0.1244s/iter; left time: 5765.5560s
	iters: 200, epoch: 2 | loss: 0.3021788
	speed: 0.0229s/iter; left time: 1058.4838s
	iters: 300, epoch: 2 | loss: 0.4874252
	speed: 0.0250s/iter; left time: 1151.0791s
	iters: 400, epoch: 2 | loss: 0.1763805
	speed: 0.0249s/iter; left time: 1147.6146s
Epoch: 2 cost time: 11.700446128845215
Epoch: 2, Steps: 469 | Train Loss: 0.349 Vali Loss: 0.347 Vali Acc: 0.909 Test Loss: 0.347 Test Acc: 0.909
Validation loss decreased (-0.820177 --> -0.908516).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2096655
	speed: 0.1181s/iter; left time: 5417.8577s
	iters: 200, epoch: 3 | loss: 0.2699743
	speed: 0.0246s/iter; left time: 1125.6418s
	iters: 300, epoch: 3 | loss: 0.1167863
	speed: 0.0245s/iter; left time: 1120.1594s
	iters: 400, epoch: 3 | loss: 0.2006737
	speed: 0.0245s/iter; left time: 1118.3599s
Epoch: 3 cost time: 11.740466356277466
Epoch: 3, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.254 Vali Acc: 0.929 Test Loss: 0.254 Test Acc: 0.929
Validation loss decreased (-0.908516 --> -0.928814).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2226088
	speed: 0.1202s/iter; left time: 5457.6843s
	iters: 200, epoch: 4 | loss: 0.1263074
	speed: 0.0259s/iter; left time: 1170.9622s
	iters: 300, epoch: 4 | loss: 0.1589434
	speed: 0.0243s/iter; left time: 1099.8339s
	iters: 400, epoch: 4 | loss: 0.7913679
	speed: 0.0238s/iter; left time: 1074.7725s
Epoch: 4 cost time: 11.793644905090332
Epoch: 4, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.928814 --> -0.949683).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2118892
	speed: 0.1262s/iter; left time: 5670.6954s
	iters: 200, epoch: 5 | loss: 0.1727854
	speed: 0.0241s/iter; left time: 1080.7733s
	iters: 300, epoch: 5 | loss: 0.5791935
	speed: 0.0243s/iter; left time: 1088.3139s
	iters: 400, epoch: 5 | loss: 0.0428149
	speed: 0.0228s/iter; left time: 1017.2708s
Epoch: 5 cost time: 11.520741939544678
Epoch: 5, Steps: 469 | Train Loss: 0.142 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
Validation loss decreased (-0.949683 --> -0.957402).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0500970
	speed: 0.1252s/iter; left time: 5567.8668s
	iters: 200, epoch: 6 | loss: 0.0643379
	speed: 0.0250s/iter; left time: 1108.5353s
	iters: 300, epoch: 6 | loss: 0.0326248
	speed: 0.0238s/iter; left time: 1051.7667s
	iters: 400, epoch: 6 | loss: 0.4170735
	speed: 0.0227s/iter; left time: 1001.7821s
Epoch: 6 cost time: 11.670847177505493
Epoch: 6, Steps: 469 | Train Loss: 0.118 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.3294063
	speed: 0.1285s/iter; left time: 5652.9228s
	iters: 200, epoch: 7 | loss: 0.0209392
	speed: 0.0246s/iter; left time: 1078.5963s
	iters: 300, epoch: 7 | loss: 0.0637599
	speed: 0.0228s/iter; left time: 997.7787s
	iters: 400, epoch: 7 | loss: 0.0129842
	speed: 0.0208s/iter; left time: 907.3127s
Epoch: 7 cost time: 11.233921527862549
Epoch: 7, Steps: 469 | Train Loss: 0.105 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
Validation loss decreased (-0.957402 --> -0.960547).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0406822
	speed: 0.0981s/iter; left time: 4269.0544s
	iters: 200, epoch: 8 | loss: 0.2585883
	speed: 0.0199s/iter; left time: 863.9352s
	iters: 300, epoch: 8 | loss: 0.0338296
	speed: 0.0198s/iter; left time: 856.7247s
	iters: 400, epoch: 8 | loss: 0.3046870
	speed: 0.0211s/iter; left time: 914.0153s
Epoch: 8 cost time: 10.081886291503906
Epoch: 8, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.960547 --> -0.961977).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1019978
	speed: 0.1273s/iter; left time: 5479.0354s
	iters: 200, epoch: 9 | loss: 0.0443650
	speed: 0.0249s/iter; left time: 1068.6736s
	iters: 300, epoch: 9 | loss: 0.0427926
	speed: 0.0235s/iter; left time: 1005.9840s
	iters: 400, epoch: 9 | loss: 0.0042631
	speed: 0.0250s/iter; left time: 1067.8841s
Epoch: 9 cost time: 11.857523202896118
Epoch: 9, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.961977 --> -0.962548).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0638240
	speed: 0.1245s/iter; left time: 5302.4587s
	iters: 200, epoch: 10 | loss: 0.1651703
	speed: 0.0244s/iter; left time: 1035.5336s
	iters: 300, epoch: 10 | loss: 0.0603694
	speed: 0.0252s/iter; left time: 1066.8843s
	iters: 400, epoch: 10 | loss: 0.3334634
	speed: 0.0255s/iter; left time: 1077.5315s
Epoch: 10 cost time: 11.934371709823608
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.962548 --> -0.967123).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0428083
	speed: 0.1288s/iter; left time: 5422.5199s
	iters: 200, epoch: 11 | loss: 0.0777285
	speed: 0.0254s/iter; left time: 1067.1126s
	iters: 300, epoch: 11 | loss: 0.1202021
	speed: 0.0259s/iter; left time: 1084.9026s
	iters: 400, epoch: 11 | loss: 0.0460443
	speed: 0.0252s/iter; left time: 1053.8887s
Epoch: 11 cost time: 12.072219133377075
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0109533
	speed: 0.1242s/iter; left time: 5169.8574s
	iters: 200, epoch: 12 | loss: 0.0564425
	speed: 0.0246s/iter; left time: 1019.9447s
	iters: 300, epoch: 12 | loss: 0.0182897
	speed: 0.0248s/iter; left time: 1027.1746s
	iters: 400, epoch: 12 | loss: 0.0190410
	speed: 0.0242s/iter; left time: 1000.6183s
Epoch: 12 cost time: 11.832675695419312
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.2846962
	speed: 0.1186s/iter; left time: 4881.1845s
	iters: 200, epoch: 13 | loss: 0.0661232
	speed: 0.0237s/iter; left time: 974.1683s
	iters: 300, epoch: 13 | loss: 0.0224710
	speed: 0.0252s/iter; left time: 1032.6158s
	iters: 400, epoch: 13 | loss: 0.0145652
	speed: 0.0215s/iter; left time: 878.0253s
Epoch: 13 cost time: 11.374918222427368
Epoch: 13, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.967123 --> -0.968552).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0578163
	speed: 0.1214s/iter; left time: 4940.5396s
	iters: 200, epoch: 14 | loss: 0.0177446
	speed: 0.0227s/iter; left time: 920.5325s
	iters: 300, epoch: 14 | loss: 0.0817888
	speed: 0.0223s/iter; left time: 905.0162s
	iters: 400, epoch: 14 | loss: 0.0319414
	speed: 0.0217s/iter; left time: 875.6328s
Epoch: 14 cost time: 10.974417686462402
Epoch: 14, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.968552 --> -0.969696).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.1064676
	speed: 0.1280s/iter; left time: 5150.9230s
	iters: 200, epoch: 15 | loss: 0.0139080
	speed: 0.0227s/iter; left time: 910.0456s
	iters: 300, epoch: 15 | loss: 0.0246723
	speed: 0.0228s/iter; left time: 913.8986s
	iters: 400, epoch: 15 | loss: 0.0275425
	speed: 0.0219s/iter; left time: 876.5215s
Epoch: 15 cost time: 11.082226753234863
Epoch: 15, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.969696 --> -0.970839).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0108760
	speed: 0.1274s/iter; left time: 5065.3459s
	iters: 200, epoch: 16 | loss: 0.1169916
	speed: 0.0222s/iter; left time: 881.9992s
	iters: 300, epoch: 16 | loss: 0.0111523
	speed: 0.0210s/iter; left time: 832.6986s
	iters: 400, epoch: 16 | loss: 0.0074263
	speed: 0.0226s/iter; left time: 891.0040s
Epoch: 16 cost time: 10.948488235473633
Epoch: 16, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.970839 --> -0.971697).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.1353649
	speed: 0.1228s/iter; left time: 4825.5775s
	iters: 200, epoch: 17 | loss: 0.0800343
	speed: 0.0216s/iter; left time: 847.7651s
	iters: 300, epoch: 17 | loss: 0.0549889
	speed: 0.0233s/iter; left time: 909.7561s
	iters: 400, epoch: 17 | loss: 0.0476681
	speed: 0.0238s/iter; left time: 929.4595s
Epoch: 17 cost time: 11.2831289768219
Epoch: 17, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.974270).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0459259
	speed: 0.1222s/iter; left time: 4746.7005s
	iters: 200, epoch: 18 | loss: 0.0205482
	speed: 0.0226s/iter; left time: 875.1012s
	iters: 300, epoch: 18 | loss: 0.0059049
	speed: 0.0238s/iter; left time: 917.8402s
	iters: 400, epoch: 18 | loss: 0.0493073
	speed: 0.0237s/iter; left time: 914.0099s
Epoch: 18 cost time: 11.481619596481323
Epoch: 18, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 19 | loss: 0.0068882
	speed: 0.1258s/iter; left time: 4826.6950s
	iters: 200, epoch: 19 | loss: 0.0091672
	speed: 0.0232s/iter; left time: 886.9917s
	iters: 300, epoch: 19 | loss: 0.0429194
	speed: 0.0250s/iter; left time: 955.1173s
	iters: 400, epoch: 19 | loss: 0.0251883
	speed: 0.0250s/iter; left time: 951.3348s
Epoch: 19 cost time: 11.869081974029541
Epoch: 19, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 20 | loss: 0.0023516
	speed: 0.1278s/iter; left time: 4843.8864s
	iters: 200, epoch: 20 | loss: 0.0058173
	speed: 0.0227s/iter; left time: 859.4966s
	iters: 300, epoch: 20 | loss: 0.6874836
	speed: 0.0248s/iter; left time: 935.7016s
	iters: 400, epoch: 20 | loss: 0.0048741
	speed: 0.0246s/iter; left time: 924.0711s
Epoch: 20 cost time: 11.779819011688232
Epoch: 20, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 21 | loss: 0.0026674
	speed: 0.1251s/iter; left time: 4681.0942s
	iters: 200, epoch: 21 | loss: 0.1310744
	speed: 0.0235s/iter; left time: 877.5434s
	iters: 300, epoch: 21 | loss: 0.0148742
	speed: 0.0230s/iter; left time: 854.3635s
	iters: 400, epoch: 21 | loss: 0.0203843
	speed: 0.0243s/iter; left time: 901.7337s
Epoch: 21 cost time: 11.445053100585938
Epoch: 21, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974270 --> -0.975127).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0367968
	speed: 0.1224s/iter; left time: 4524.4467s
	iters: 200, epoch: 22 | loss: 0.1072739
	speed: 0.0241s/iter; left time: 889.7651s
	iters: 300, epoch: 22 | loss: 0.0694115
	speed: 0.0232s/iter; left time: 852.9482s
	iters: 400, epoch: 22 | loss: 0.0412754
	speed: 0.0217s/iter; left time: 794.2492s
Epoch: 22 cost time: 11.078674554824829
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.975127 --> -0.975128).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0255003
	speed: 0.1203s/iter; left time: 4387.7744s
	iters: 200, epoch: 23 | loss: 0.0434217
	speed: 0.0237s/iter; left time: 863.9093s
	iters: 300, epoch: 23 | loss: 0.2582754
	speed: 0.0221s/iter; left time: 800.7909s
	iters: 400, epoch: 23 | loss: 0.0036947
	speed: 0.0216s/iter; left time: 782.7074s
Epoch: 23 cost time: 11.083617687225342
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0352841
	speed: 0.1214s/iter; left time: 4373.7840s
	iters: 200, epoch: 24 | loss: 0.0214230
	speed: 0.0223s/iter; left time: 800.6010s
	iters: 300, epoch: 24 | loss: 0.3433993
	speed: 0.0223s/iter; left time: 798.8234s
	iters: 400, epoch: 24 | loss: 0.0485834
	speed: 0.0225s/iter; left time: 802.3349s
Epoch: 24 cost time: 10.926089525222778
Epoch: 24, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1477102
	speed: 0.1292s/iter; left time: 4593.1810s
	iters: 200, epoch: 25 | loss: 0.0049603
	speed: 0.0226s/iter; left time: 800.2947s
	iters: 300, epoch: 25 | loss: 0.0282534
	speed: 0.0225s/iter; left time: 795.7988s
	iters: 400, epoch: 25 | loss: 0.0055354
	speed: 0.0219s/iter; left time: 772.3756s
Epoch: 25 cost time: 11.13463830947876
Epoch: 25, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.975128 --> -0.978558).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0146010
	speed: 0.1294s/iter; left time: 4538.9563s
	iters: 200, epoch: 26 | loss: 0.1001445
	speed: 0.0221s/iter; left time: 772.7445s
	iters: 300, epoch: 26 | loss: 0.0089947
	speed: 0.0232s/iter; left time: 808.8675s
	iters: 400, epoch: 26 | loss: 0.0795284
	speed: 0.0233s/iter; left time: 810.5412s
Epoch: 26 cost time: 11.349429368972778
Epoch: 26, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0497926
	speed: 0.1232s/iter; left time: 4264.1354s
	iters: 200, epoch: 27 | loss: 0.0271157
	speed: 0.0223s/iter; left time: 768.2176s
	iters: 300, epoch: 27 | loss: 0.0033110
	speed: 0.0249s/iter; left time: 856.8093s
	iters: 400, epoch: 27 | loss: 0.0008237
	speed: 0.0239s/iter; left time: 821.1141s
Epoch: 27 cost time: 11.31485891342163
Epoch: 27, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0337255
	speed: 0.1213s/iter; left time: 4140.1767s
	iters: 200, epoch: 28 | loss: 0.0235012
	speed: 0.0244s/iter; left time: 829.1241s
	iters: 300, epoch: 28 | loss: 0.0377298
	speed: 0.0246s/iter; left time: 834.4904s
	iters: 400, epoch: 28 | loss: 0.0012853
	speed: 0.0245s/iter; left time: 827.7719s
Epoch: 28 cost time: 11.741717338562012
Epoch: 28, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0366219
	speed: 0.1175s/iter; left time: 3956.8861s
	iters: 200, epoch: 29 | loss: 0.0951431
	speed: 0.0249s/iter; left time: 834.8062s
	iters: 300, epoch: 29 | loss: 0.0029269
	speed: 0.0248s/iter; left time: 828.7224s
	iters: 400, epoch: 29 | loss: 0.0032538
	speed: 0.0232s/iter; left time: 774.7679s
Epoch: 29 cost time: 11.65637731552124
Epoch: 29, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0135900
	speed: 0.1212s/iter; left time: 4024.4464s
	iters: 200, epoch: 30 | loss: 0.0007729
	speed: 0.0242s/iter; left time: 801.5583s
	iters: 300, epoch: 30 | loss: 0.0014539
	speed: 0.0238s/iter; left time: 785.6926s
	iters: 400, epoch: 30 | loss: 0.0067084
	speed: 0.0243s/iter; left time: 799.1268s
Epoch: 30 cost time: 11.642962217330933
Epoch: 30, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 31 | loss: 0.0263349
	speed: 0.1260s/iter; left time: 4124.2634s
	iters: 200, epoch: 31 | loss: 0.1166417
	speed: 0.0235s/iter; left time: 765.6857s
	iters: 300, epoch: 31 | loss: 0.1709148
	speed: 0.0239s/iter; left time: 778.2064s
	iters: 400, epoch: 31 | loss: 0.0048437
	speed: 0.0237s/iter; left time: 767.7393s
Epoch: 31 cost time: 11.339071035385132
Epoch: 31, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.978558 --> -0.979702).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0807535
	speed: 0.1191s/iter; left time: 3843.2877s
	iters: 200, epoch: 32 | loss: 0.0913841
	speed: 0.0241s/iter; left time: 775.7156s
	iters: 300, epoch: 32 | loss: 0.0030841
	speed: 0.0257s/iter; left time: 824.3227s
	iters: 400, epoch: 32 | loss: 0.0202436
	speed: 0.0234s/iter; left time: 748.6034s
Epoch: 32 cost time: 11.717692136764526
Epoch: 32, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0222544
	speed: 0.1252s/iter; left time: 3980.0598s
	iters: 200, epoch: 33 | loss: 0.1240107
	speed: 0.0246s/iter; left time: 780.0398s
	iters: 300, epoch: 33 | loss: 0.0033849
	speed: 0.0223s/iter; left time: 704.3803s
	iters: 400, epoch: 33 | loss: 0.0014584
	speed: 0.0222s/iter; left time: 698.2664s
Epoch: 33 cost time: 11.396733045578003
Epoch: 33, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0250194
	speed: 0.1316s/iter; left time: 4121.7350s
	iters: 200, epoch: 34 | loss: 0.0022541
	speed: 0.0221s/iter; left time: 689.2966s
	iters: 300, epoch: 34 | loss: 0.0085263
	speed: 0.0223s/iter; left time: 695.1669s
	iters: 400, epoch: 34 | loss: 0.2526548
	speed: 0.0237s/iter; left time: 733.7412s
Epoch: 34 cost time: 11.378810405731201
Epoch: 34, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0093505
	speed: 0.1333s/iter; left time: 4112.5966s
	iters: 200, epoch: 35 | loss: 0.0114715
	speed: 0.0240s/iter; left time: 736.8950s
	iters: 300, epoch: 35 | loss: 0.0029282
	speed: 0.0232s/iter; left time: 712.3026s
	iters: 400, epoch: 35 | loss: 0.0018343
	speed: 0.0249s/iter; left time: 759.9047s
Epoch: 35 cost time: 11.430448293685913
Epoch: 35, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0261835
	speed: 0.1082s/iter; left time: 3288.1563s
	iters: 200, epoch: 36 | loss: 0.0002722
	speed: 0.0226s/iter; left time: 683.8807s
	iters: 300, epoch: 36 | loss: 0.0050845
	speed: 0.0254s/iter; left time: 766.9148s
	iters: 400, epoch: 36 | loss: 0.0152163
	speed: 0.0251s/iter; left time: 754.5802s
Epoch: 36 cost time: 11.656391859054565
Epoch: 36, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0031185
	speed: 0.1224s/iter; left time: 3660.9740s
	iters: 200, epoch: 37 | loss: 0.0795359
	speed: 0.0241s/iter; left time: 717.7605s
	iters: 300, epoch: 37 | loss: 0.0115002
	speed: 0.0242s/iter; left time: 719.8412s
	iters: 400, epoch: 37 | loss: 0.0433248
	speed: 0.0244s/iter; left time: 723.7599s
Epoch: 37 cost time: 11.604572772979736
Epoch: 37, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0042900
	speed: 0.1206s/iter; left time: 3550.3585s
	iters: 200, epoch: 38 | loss: 0.0406688
	speed: 0.0241s/iter; left time: 706.8511s
	iters: 300, epoch: 38 | loss: 0.0013799
	speed: 0.0246s/iter; left time: 718.2935s
	iters: 400, epoch: 38 | loss: 0.0194835
	speed: 0.0221s/iter; left time: 644.2609s
Epoch: 38 cost time: 11.22982144355774
Epoch: 38, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0121563
	speed: 0.1231s/iter; left time: 3566.7446s
	iters: 200, epoch: 39 | loss: 0.0957049
	speed: 0.0245s/iter; left time: 706.4255s
	iters: 300, epoch: 39 | loss: 0.1320566
	speed: 0.0236s/iter; left time: 678.9651s
	iters: 400, epoch: 39 | loss: 0.0017632
	speed: 0.0230s/iter; left time: 659.9250s
Epoch: 39 cost time: 11.5036461353302
Epoch: 39, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.2071248
	speed: 0.1289s/iter; left time: 3674.7365s
	iters: 200, epoch: 40 | loss: 0.0035492
	speed: 0.0232s/iter; left time: 657.7303s
	iters: 300, epoch: 40 | loss: 0.0068452
	speed: 0.0240s/iter; left time: 678.6570s
	iters: 400, epoch: 40 | loss: 0.0425102
	speed: 0.0229s/iter; left time: 646.4630s
Epoch: 40 cost time: 11.413800716400146
Epoch: 40, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0005109
	speed: 0.1189s/iter; left time: 3333.0847s
	iters: 200, epoch: 41 | loss: 0.0132525
	speed: 0.0236s/iter; left time: 658.0680s
	iters: 300, epoch: 41 | loss: 0.0082933
	speed: 0.0230s/iter; left time: 641.6745s
	iters: 400, epoch: 41 | loss: 0.0136419
	speed: 0.0219s/iter; left time: 608.0543s
Epoch: 41 cost time: 11.15718126296997
Epoch: 41, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 21730
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7262807
	speed: 0.0405s/iter; left time: 1896.9882s
	iters: 200, epoch: 1 | loss: 1.1631789
	speed: 0.0235s/iter; left time: 1096.2793s
	iters: 300, epoch: 1 | loss: 0.8327394
	speed: 0.0211s/iter; left time: 985.5527s
	iters: 400, epoch: 1 | loss: 0.7661216
	speed: 0.0218s/iter; left time: 1013.0722s
Epoch: 1 cost time: 12.3318612575531
Epoch: 1, Steps: 469 | Train Loss: 1.244 Vali Loss: 0.583 Vali Acc: 0.812 Test Loss: 0.583 Test Acc: 0.812
Validation loss decreased (inf --> -0.811887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4118064
	speed: 0.1267s/iter; left time: 5872.2237s
	iters: 200, epoch: 2 | loss: 0.3066046
	speed: 0.0232s/iter; left time: 1074.3852s
	iters: 300, epoch: 2 | loss: 0.5094071
	speed: 0.0215s/iter; left time: 994.0780s
	iters: 400, epoch: 2 | loss: 0.1348613
	speed: 0.0235s/iter; left time: 1080.3611s
Epoch: 2 cost time: 11.253331184387207
Epoch: 2, Steps: 469 | Train Loss: 0.345 Vali Loss: 0.315 Vali Acc: 0.914 Test Loss: 0.315 Test Acc: 0.914
Validation loss decreased (-0.811887 --> -0.913948).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2697078
	speed: 0.1312s/iter; left time: 6018.4373s
	iters: 200, epoch: 3 | loss: 0.1518471
	speed: 0.0231s/iter; left time: 1056.5845s
	iters: 300, epoch: 3 | loss: 0.1380139
	speed: 0.0219s/iter; left time: 998.4248s
	iters: 400, epoch: 3 | loss: 0.3220786
	speed: 0.0213s/iter; left time: 972.3439s
Epoch: 3 cost time: 10.8394775390625
Epoch: 3, Steps: 469 | Train Loss: 0.212 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.913948 --> -0.942536).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0844324
	speed: 0.1222s/iter; left time: 5547.6448s
	iters: 200, epoch: 4 | loss: 0.0749616
	speed: 0.0218s/iter; left time: 985.2486s
	iters: 300, epoch: 4 | loss: 0.0462471
	speed: 0.0224s/iter; left time: 1012.1721s
	iters: 400, epoch: 4 | loss: 0.5616677
	speed: 0.0249s/iter; left time: 1121.1961s
Epoch: 4 cost time: 11.246062278747559
Epoch: 4, Steps: 469 | Train Loss: 0.162 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.942536 --> -0.952828).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0625190
	speed: 0.1203s/iter; left time: 5403.9800s
	iters: 200, epoch: 5 | loss: 0.1139868
	speed: 0.0218s/iter; left time: 978.8012s
	iters: 300, epoch: 5 | loss: 0.1567555
	speed: 0.0233s/iter; left time: 1041.1890s
	iters: 400, epoch: 5 | loss: 0.0629173
	speed: 0.0229s/iter; left time: 1021.6431s
Epoch: 5 cost time: 11.00936245918274
Epoch: 5, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.952828 --> -0.961691).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0955423
	speed: 0.1179s/iter; left time: 5239.4204s
	iters: 200, epoch: 6 | loss: 0.0452033
	speed: 0.0227s/iter; left time: 1008.1594s
	iters: 300, epoch: 6 | loss: 0.0110645
	speed: 0.0249s/iter; left time: 1100.4933s
	iters: 400, epoch: 6 | loss: 0.4518528
	speed: 0.0233s/iter; left time: 1028.3838s
Epoch: 6 cost time: 11.463447332382202
Epoch: 6, Steps: 469 | Train Loss: 0.120 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.5078478
	speed: 0.1222s/iter; left time: 5376.3091s
	iters: 200, epoch: 7 | loss: 0.0893102
	speed: 0.0238s/iter; left time: 1043.3390s
	iters: 300, epoch: 7 | loss: 0.0449943
	speed: 0.0245s/iter; left time: 1073.9004s
	iters: 400, epoch: 7 | loss: 0.0130788
	speed: 0.0233s/iter; left time: 1018.0794s
Epoch: 7 cost time: 11.41262936592102
Epoch: 7, Steps: 469 | Train Loss: 0.108 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
Validation loss decreased (-0.961691 --> -0.965693).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0146888
	speed: 0.1278s/iter; left time: 5563.0723s
	iters: 200, epoch: 8 | loss: 0.3973817
	speed: 0.0193s/iter; left time: 836.5967s
	iters: 300, epoch: 8 | loss: 0.1263215
	speed: 0.0240s/iter; left time: 1039.4395s
	iters: 400, epoch: 8 | loss: 0.2347655
	speed: 0.0255s/iter; left time: 1100.3900s
Epoch: 8 cost time: 11.254518747329712
Epoch: 8, Steps: 469 | Train Loss: 0.099 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0374811
	speed: 0.1182s/iter; left time: 5087.6353s
	iters: 200, epoch: 9 | loss: 0.0071433
	speed: 0.0199s/iter; left time: 855.6757s
	iters: 300, epoch: 9 | loss: 0.0055140
	speed: 0.0197s/iter; left time: 842.4768s
	iters: 400, epoch: 9 | loss: 0.0191649
	speed: 0.0197s/iter; left time: 843.5239s
Epoch: 9 cost time: 9.618715047836304
Epoch: 9, Steps: 469 | Train Loss: 0.090 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0243281
	speed: 0.0994s/iter; left time: 4231.1800s
	iters: 200, epoch: 10 | loss: 0.1765193
	speed: 0.0243s/iter; left time: 1030.1954s
	iters: 300, epoch: 10 | loss: 0.0293741
	speed: 0.0239s/iter; left time: 1011.4426s
	iters: 400, epoch: 10 | loss: 0.1405477
	speed: 0.0244s/iter; left time: 1030.9845s
Epoch: 10 cost time: 11.334055423736572
Epoch: 10, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
Validation loss decreased (-0.965693 --> -0.968838).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0366793
	speed: 0.1203s/iter; left time: 5065.3584s
	iters: 200, epoch: 11 | loss: 0.0135090
	speed: 0.0235s/iter; left time: 986.0690s
	iters: 300, epoch: 11 | loss: 0.1573074
	speed: 0.0242s/iter; left time: 1014.7033s
	iters: 400, epoch: 11 | loss: 0.0848963
	speed: 0.0222s/iter; left time: 926.3076s
Epoch: 11 cost time: 11.375442266464233
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
Validation loss decreased (-0.968838 --> -0.971697).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0306679
	speed: 0.1177s/iter; left time: 4899.6044s
	iters: 200, epoch: 12 | loss: 0.0201570
	speed: 0.0241s/iter; left time: 1000.9244s
	iters: 300, epoch: 12 | loss: 0.0254953
	speed: 0.0225s/iter; left time: 931.8941s
	iters: 400, epoch: 12 | loss: 0.0212750
	speed: 0.0231s/iter; left time: 955.7952s
Epoch: 12 cost time: 11.215987920761108
Epoch: 12, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0827223
	speed: 0.1060s/iter; left time: 4365.2582s
	iters: 200, epoch: 13 | loss: 0.0145737
	speed: 0.0197s/iter; left time: 809.8828s
	iters: 300, epoch: 13 | loss: 0.0414729
	speed: 0.0194s/iter; left time: 795.4751s
	iters: 400, epoch: 13 | loss: 0.0370758
	speed: 0.0215s/iter; left time: 876.8360s
Epoch: 13 cost time: 10.01118516921997
Epoch: 13, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.2311296
	speed: 0.1271s/iter; left time: 5172.8771s
	iters: 200, epoch: 14 | loss: 0.0536947
	speed: 0.0222s/iter; left time: 900.9104s
	iters: 300, epoch: 14 | loss: 0.0354681
	speed: 0.0214s/iter; left time: 866.8049s
	iters: 400, epoch: 14 | loss: 0.1086706
	speed: 0.0218s/iter; left time: 880.0909s
Epoch: 14 cost time: 10.863379001617432
Epoch: 14, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.971697 --> -0.973984).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.3299392
	speed: 0.1297s/iter; left time: 5220.1805s
	iters: 200, epoch: 15 | loss: 0.0227697
	speed: 0.0217s/iter; left time: 870.8223s
	iters: 300, epoch: 15 | loss: 0.0087060
	speed: 0.0226s/iter; left time: 906.4029s
	iters: 400, epoch: 15 | loss: 0.0112378
	speed: 0.0251s/iter; left time: 1003.4453s
Epoch: 15 cost time: 11.229843616485596
Epoch: 15, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 16 | loss: 0.0491716
	speed: 0.1246s/iter; left time: 4956.4313s
	iters: 200, epoch: 16 | loss: 0.1735575
	speed: 0.0229s/iter; left time: 910.2695s
	iters: 300, epoch: 16 | loss: 0.0447454
	speed: 0.0237s/iter; left time: 935.8804s
	iters: 400, epoch: 16 | loss: 0.0126991
	speed: 0.0250s/iter; left time: 985.4446s
Epoch: 16 cost time: 11.460274696350098
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 17 | loss: 0.1706649
	speed: 0.1263s/iter; left time: 4961.6547s
	iters: 200, epoch: 17 | loss: 0.0152716
	speed: 0.0229s/iter; left time: 896.6729s
	iters: 300, epoch: 17 | loss: 0.1265403
	speed: 0.0255s/iter; left time: 996.4871s
	iters: 400, epoch: 17 | loss: 0.0410241
	speed: 0.0258s/iter; left time: 1006.0944s
Epoch: 17 cost time: 11.876198530197144
Epoch: 17, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 18 | loss: 0.0328528
	speed: 0.1248s/iter; left time: 4844.4466s
	iters: 200, epoch: 18 | loss: 0.0156385
	speed: 0.0255s/iter; left time: 986.8705s
	iters: 300, epoch: 18 | loss: 0.0111593
	speed: 0.0248s/iter; left time: 959.8936s
	iters: 400, epoch: 18 | loss: 0.0213159
	speed: 0.0242s/iter; left time: 934.2346s
Epoch: 18 cost time: 11.85852575302124
Epoch: 18, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 19 | loss: 0.0111847
	speed: 0.1271s/iter; left time: 4877.0719s
	iters: 200, epoch: 19 | loss: 0.0986713
	speed: 0.0265s/iter; left time: 1014.9540s
	iters: 300, epoch: 19 | loss: 0.3800893
	speed: 0.0262s/iter; left time: 999.3572s
	iters: 400, epoch: 19 | loss: 0.0318518
	speed: 0.0257s/iter; left time: 977.9509s
Epoch: 19 cost time: 12.388784885406494
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 20 | loss: 0.0159545
	speed: 0.1266s/iter; left time: 4796.1498s
	iters: 200, epoch: 20 | loss: 0.0068426
	speed: 0.0273s/iter; left time: 1030.0051s
	iters: 300, epoch: 20 | loss: 0.8017941
	speed: 0.0262s/iter; left time: 988.3351s
	iters: 400, epoch: 20 | loss: 0.0066825
	speed: 0.0259s/iter; left time: 973.2167s
Epoch: 20 cost time: 12.43407678604126
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.973984 --> -0.974556).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0088330
	speed: 0.1224s/iter; left time: 4580.1039s
	iters: 200, epoch: 21 | loss: 0.0941655
	speed: 0.0254s/iter; left time: 948.7594s
	iters: 300, epoch: 21 | loss: 0.0134311
	speed: 0.0261s/iter; left time: 970.6740s
	iters: 400, epoch: 21 | loss: 0.0461236
	speed: 0.0235s/iter; left time: 870.8122s
Epoch: 21 cost time: 12.025588750839233
Epoch: 21, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.974556 --> -0.976271).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0364182
	speed: 0.1280s/iter; left time: 4728.6568s
	iters: 200, epoch: 22 | loss: 0.0853913
	speed: 0.0259s/iter; left time: 953.4502s
	iters: 300, epoch: 22 | loss: 0.0399307
	speed: 0.0236s/iter; left time: 866.8125s
	iters: 400, epoch: 22 | loss: 0.0048271
	speed: 0.0224s/iter; left time: 820.3950s
Epoch: 22 cost time: 11.574549198150635
Epoch: 22, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.1013536
	speed: 0.1320s/iter; left time: 4815.3737s
	iters: 200, epoch: 23 | loss: 0.0636968
	speed: 0.0235s/iter; left time: 856.8027s
	iters: 300, epoch: 23 | loss: 0.0193134
	speed: 0.0224s/iter; left time: 811.5991s
	iters: 400, epoch: 23 | loss: 0.0031290
	speed: 0.0229s/iter; left time: 826.8023s
Epoch: 23 cost time: 11.281144857406616
Epoch: 23, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0094524
	speed: 0.1277s/iter; left time: 4599.7074s
	iters: 200, epoch: 24 | loss: 0.0641565
	speed: 0.0232s/iter; left time: 832.1665s
	iters: 300, epoch: 24 | loss: 0.2009384
	speed: 0.0223s/iter; left time: 800.2660s
	iters: 400, epoch: 24 | loss: 0.0233746
	speed: 0.0222s/iter; left time: 793.8217s
Epoch: 24 cost time: 10.95711612701416
Epoch: 24, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0207898
	speed: 0.1274s/iter; left time: 4529.5736s
	iters: 200, epoch: 25 | loss: 0.0069567
	speed: 0.0223s/iter; left time: 791.6876s
	iters: 300, epoch: 25 | loss: 0.0570751
	speed: 0.0227s/iter; left time: 802.3815s
	iters: 400, epoch: 25 | loss: 0.0845867
	speed: 0.0256s/iter; left time: 902.7970s
Epoch: 25 cost time: 11.470298051834106
Epoch: 25, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0790079
	speed: 0.1210s/iter; left time: 4244.5489s
	iters: 200, epoch: 26 | loss: 0.0834945
	speed: 0.0211s/iter; left time: 739.1152s
	iters: 300, epoch: 26 | loss: 0.0150187
	speed: 0.0250s/iter; left time: 873.2757s
	iters: 400, epoch: 26 | loss: 0.0360101
	speed: 0.0258s/iter; left time: 897.3332s
Epoch: 26 cost time: 11.47322154045105
Epoch: 26, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.1680362
	speed: 0.1228s/iter; left time: 4249.4379s
	iters: 200, epoch: 27 | loss: 0.0231078
	speed: 0.0215s/iter; left time: 742.3907s
	iters: 300, epoch: 27 | loss: 0.0073456
	speed: 0.0207s/iter; left time: 711.0338s
	iters: 400, epoch: 27 | loss: 0.0097798
	speed: 0.0205s/iter; left time: 702.6552s
Epoch: 27 cost time: 10.287653684616089
Epoch: 27, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0307767
	speed: 0.1057s/iter; left time: 3606.8207s
	iters: 200, epoch: 28 | loss: 0.0025452
	speed: 0.0259s/iter; left time: 882.5803s
	iters: 300, epoch: 28 | loss: 0.0803650
	speed: 0.0240s/iter; left time: 813.9595s
	iters: 400, epoch: 28 | loss: 0.0022843
	speed: 0.0254s/iter; left time: 858.0066s
Epoch: 28 cost time: 11.897391319274902
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0475418
	speed: 0.1261s/iter; left time: 4244.2316s
	iters: 200, epoch: 29 | loss: 0.0129502
	speed: 0.0247s/iter; left time: 829.3778s
	iters: 300, epoch: 29 | loss: 0.0034384
	speed: 0.0243s/iter; left time: 811.9626s
	iters: 400, epoch: 29 | loss: 0.0018764
	speed: 0.0252s/iter; left time: 840.2455s
Epoch: 29 cost time: 11.881543397903442
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0240472
	speed: 0.1228s/iter; left time: 4077.3346s
	iters: 200, epoch: 30 | loss: 0.0055322
	speed: 0.0257s/iter; left time: 849.1803s
	iters: 300, epoch: 30 | loss: 0.0354693
	speed: 0.0250s/iter; left time: 826.1157s
	iters: 400, epoch: 30 | loss: 0.0523899
	speed: 0.0245s/iter; left time: 805.2638s
Epoch: 30 cost time: 12.094342947006226
Epoch: 30, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0611929
	speed: 0.1247s/iter; left time: 4082.6615s
	iters: 200, epoch: 31 | loss: 0.2029648
	speed: 0.0245s/iter; left time: 801.0520s
	iters: 300, epoch: 31 | loss: 0.1205324
	speed: 0.0237s/iter; left time: 769.8034s
	iters: 400, epoch: 31 | loss: 0.0068083
	speed: 0.0227s/iter; left time: 736.2166s
Epoch: 31 cost time: 11.485547065734863
Epoch: 31, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.976271 --> -0.979130).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0047283
	speed: 0.1273s/iter; left time: 4108.4584s
	iters: 200, epoch: 32 | loss: 0.0378335
	speed: 0.0238s/iter; left time: 766.9938s
	iters: 300, epoch: 32 | loss: 0.0048391
	speed: 0.0224s/iter; left time: 716.8015s
	iters: 400, epoch: 32 | loss: 0.0412731
	speed: 0.0225s/iter; left time: 718.5322s
Epoch: 32 cost time: 11.379016160964966
Epoch: 32, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 33 | loss: 0.0418632
	speed: 0.1294s/iter; left time: 4114.4653s
	iters: 200, epoch: 33 | loss: 0.0363251
	speed: 0.0230s/iter; left time: 728.0777s
	iters: 300, epoch: 33 | loss: 0.0149311
	speed: 0.0224s/iter; left time: 706.9571s
	iters: 400, epoch: 33 | loss: 0.1135713
	speed: 0.0218s/iter; left time: 686.8501s
Epoch: 33 cost time: 10.96662712097168
Epoch: 33, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 34 | loss: 0.0952927
	speed: 0.1276s/iter; left time: 3995.5696s
	iters: 200, epoch: 34 | loss: 0.0051613
	speed: 0.0212s/iter; left time: 661.4152s
	iters: 300, epoch: 34 | loss: 0.0026881
	speed: 0.0214s/iter; left time: 666.7089s
	iters: 400, epoch: 34 | loss: 0.3894642
	speed: 0.0218s/iter; left time: 675.9891s
Epoch: 34 cost time: 10.786932468414307
Epoch: 34, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 35 | loss: 0.0194093
	speed: 0.1241s/iter; left time: 3828.9598s
	iters: 200, epoch: 35 | loss: 0.0055842
	speed: 0.0223s/iter; left time: 684.3206s
	iters: 300, epoch: 35 | loss: 0.0941703
	speed: 0.0226s/iter; left time: 691.4130s
	iters: 400, epoch: 35 | loss: 0.0127343
	speed: 0.0242s/iter; left time: 739.6781s
Epoch: 35 cost time: 11.168923377990723
Epoch: 35, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 36 | loss: 0.0752830
	speed: 0.1214s/iter; left time: 3689.4017s
	iters: 200, epoch: 36 | loss: 0.0009860
	speed: 0.0233s/iter; left time: 705.8057s
	iters: 300, epoch: 36 | loss: 0.0388678
	speed: 0.0248s/iter; left time: 749.6053s
	iters: 400, epoch: 36 | loss: 0.0112066
	speed: 0.0258s/iter; left time: 775.8335s
Epoch: 36 cost time: 11.716556072235107
Epoch: 36, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 37 | loss: 0.0006866
	speed: 0.1215s/iter; left time: 3635.1894s
	iters: 200, epoch: 37 | loss: 0.0053528
	speed: 0.0249s/iter; left time: 741.4328s
	iters: 300, epoch: 37 | loss: 0.0056801
	speed: 0.0249s/iter; left time: 738.8271s
	iters: 400, epoch: 37 | loss: 0.2264808
	speed: 0.0256s/iter; left time: 757.2539s
Epoch: 37 cost time: 11.887987852096558
Epoch: 37, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 38 | loss: 0.0303358
	speed: 0.1248s/iter; left time: 3674.2456s
	iters: 200, epoch: 38 | loss: 0.0412277
	speed: 0.0251s/iter; left time: 735.7159s
	iters: 300, epoch: 38 | loss: 0.0054465
	speed: 0.0249s/iter; left time: 727.3061s
	iters: 400, epoch: 38 | loss: 0.0013707
	speed: 0.0251s/iter; left time: 731.4711s
Epoch: 38 cost time: 12.023258209228516
Epoch: 38, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 39 | loss: 0.0040075
	speed: 0.1179s/iter; left time: 3417.0984s
	iters: 200, epoch: 39 | loss: 0.1453585
	speed: 0.0252s/iter; left time: 728.1671s
	iters: 300, epoch: 39 | loss: 0.0205922
	speed: 0.0248s/iter; left time: 715.0484s
	iters: 400, epoch: 39 | loss: 0.0033233
	speed: 0.0252s/iter; left time: 722.1374s
Epoch: 39 cost time: 11.853743553161621
Epoch: 39, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 40 | loss: 0.0963616
	speed: 0.1231s/iter; left time: 3509.8694s
	iters: 200, epoch: 40 | loss: 0.0207505
	speed: 0.0252s/iter; left time: 717.1772s
	iters: 300, epoch: 40 | loss: 0.0162482
	speed: 0.0244s/iter; left time: 690.7189s
	iters: 400, epoch: 40 | loss: 0.0298308
	speed: 0.0220s/iter; left time: 621.8571s
Epoch: 40 cost time: 11.490067720413208
Epoch: 40, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 41 | loss: 0.0043337
	speed: 0.1213s/iter; left time: 3402.2971s
	iters: 200, epoch: 41 | loss: 0.0118072
	speed: 0.0239s/iter; left time: 668.9976s
	iters: 300, epoch: 41 | loss: 0.0408560
	speed: 0.0220s/iter; left time: 612.3791s
	iters: 400, epoch: 41 | loss: 0.0116623
	speed: 0.0208s/iter; left time: 577.2054s
Epoch: 41 cost time: 11.079665660858154
Epoch: 41, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 21730
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7790078
	speed: 0.0412s/iter; left time: 1927.3660s
	iters: 200, epoch: 1 | loss: 0.8271461
	speed: 0.0204s/iter; left time: 954.7147s
	iters: 300, epoch: 1 | loss: 0.8586650
	speed: 0.0193s/iter; left time: 901.3766s
	iters: 400, epoch: 1 | loss: 0.5852754
	speed: 0.0200s/iter; left time: 931.2134s
Epoch: 1 cost time: 11.55741262435913
Epoch: 1, Steps: 469 | Train Loss: 1.068 Vali Loss: 0.543 Vali Acc: 0.837 Test Loss: 0.543 Test Acc: 0.837
Validation loss decreased (inf --> -0.836758).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2862198
	speed: 0.1102s/iter; left time: 5107.2971s
	iters: 200, epoch: 2 | loss: 0.3434585
	speed: 0.0249s/iter; left time: 1152.2193s
	iters: 300, epoch: 2 | loss: 0.3478016
	speed: 0.0245s/iter; left time: 1131.0429s
	iters: 400, epoch: 2 | loss: 0.1862031
	speed: 0.0216s/iter; left time: 992.3782s
Epoch: 2 cost time: 11.5514075756073
Epoch: 2, Steps: 469 | Train Loss: 0.336 Vali Loss: 0.364 Vali Acc: 0.895 Test Loss: 0.364 Test Acc: 0.895
Validation loss decreased (-0.836758 --> -0.894793).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1596693
	speed: 0.1223s/iter; left time: 5608.3607s
	iters: 200, epoch: 3 | loss: 0.3586693
	speed: 0.0242s/iter; left time: 1106.3827s
	iters: 300, epoch: 3 | loss: 0.2877152
	speed: 0.0224s/iter; left time: 1021.2369s
	iters: 400, epoch: 3 | loss: 0.6240929
	speed: 0.0216s/iter; left time: 985.1552s
Epoch: 3 cost time: 11.213172674179077
Epoch: 3, Steps: 469 | Train Loss: 0.219 Vali Loss: 0.281 Vali Acc: 0.910 Test Loss: 0.281 Test Acc: 0.910
Validation loss decreased (-0.894793 --> -0.910232).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3889530
	speed: 0.1303s/iter; left time: 5913.0837s
	iters: 200, epoch: 4 | loss: 0.1695228
	speed: 0.0232s/iter; left time: 1049.3988s
	iters: 300, epoch: 4 | loss: 0.2203601
	speed: 0.0221s/iter; left time: 1000.3246s
	iters: 400, epoch: 4 | loss: 0.1416338
	speed: 0.0233s/iter; left time: 1052.9312s
Epoch: 4 cost time: 11.551289558410645
Epoch: 4, Steps: 469 | Train Loss: 0.166 Vali Loss: 0.243 Vali Acc: 0.934 Test Loss: 0.243 Test Acc: 0.934
Validation loss decreased (-0.910232 --> -0.933674).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0675518
	speed: 0.1345s/iter; left time: 6042.3418s
	iters: 200, epoch: 5 | loss: 0.0749539
	speed: 0.0226s/iter; left time: 1011.1115s
	iters: 300, epoch: 5 | loss: 0.1740720
	speed: 0.0222s/iter; left time: 990.9655s
	iters: 400, epoch: 5 | loss: 0.0392624
	speed: 0.0243s/iter; left time: 1085.6782s
Epoch: 5 cost time: 11.286818742752075
Epoch: 5, Steps: 469 | Train Loss: 0.135 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
Validation loss decreased (-0.933674 --> -0.950827).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1757686
	speed: 0.1286s/iter; left time: 5715.1425s
	iters: 200, epoch: 6 | loss: 0.3541140
	speed: 0.0215s/iter; left time: 955.0461s
	iters: 300, epoch: 6 | loss: 0.0204180
	speed: 0.0235s/iter; left time: 1040.4912s
	iters: 400, epoch: 6 | loss: 0.0750869
	speed: 0.0239s/iter; left time: 1056.5831s
Epoch: 6 cost time: 11.065968036651611
Epoch: 6, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0258983
	speed: 0.1212s/iter; left time: 5331.5089s
	iters: 200, epoch: 7 | loss: 0.0668224
	speed: 0.0238s/iter; left time: 1043.5438s
	iters: 300, epoch: 7 | loss: 0.3394721
	speed: 0.0239s/iter; left time: 1047.2341s
	iters: 400, epoch: 7 | loss: 0.0265821
	speed: 0.0239s/iter; left time: 1042.8927s
Epoch: 7 cost time: 11.455223560333252
Epoch: 7, Steps: 469 | Train Loss: 0.102 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.950827 --> -0.957974).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0467039
	speed: 0.1159s/iter; left time: 5043.5196s
	iters: 200, epoch: 8 | loss: 0.3270501
	speed: 0.0240s/iter; left time: 1044.1428s
	iters: 300, epoch: 8 | loss: 0.0188561
	speed: 0.0236s/iter; left time: 1023.9990s
	iters: 400, epoch: 8 | loss: 0.0427172
	speed: 0.0230s/iter; left time: 993.3999s
Epoch: 8 cost time: 11.35266399383545
Epoch: 8, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.957974 --> -0.960547).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1098550
	speed: 0.1237s/iter; left time: 5325.0518s
	iters: 200, epoch: 9 | loss: 0.0029113
	speed: 0.0238s/iter; left time: 1022.1632s
	iters: 300, epoch: 9 | loss: 0.0240953
	speed: 0.0230s/iter; left time: 984.2909s
	iters: 400, epoch: 9 | loss: 0.0224448
	speed: 0.0211s/iter; left time: 903.6887s
Epoch: 9 cost time: 11.148497819900513
Epoch: 9, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
Validation loss decreased (-0.960547 --> -0.965979).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0114280
	speed: 0.1219s/iter; left time: 5192.0570s
	iters: 200, epoch: 10 | loss: 0.0841131
	speed: 0.0241s/iter; left time: 1023.9181s
	iters: 300, epoch: 10 | loss: 0.0779875
	speed: 0.0224s/iter; left time: 951.3772s
	iters: 400, epoch: 10 | loss: 0.0082121
	speed: 0.0211s/iter; left time: 890.0632s
Epoch: 10 cost time: 11.004809379577637
Epoch: 10, Steps: 469 | Train Loss: 0.079 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.965979 --> -0.971983).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0044312
	speed: 0.1240s/iter; left time: 5221.0335s
	iters: 200, epoch: 11 | loss: 0.0279135
	speed: 0.0234s/iter; left time: 981.2137s
	iters: 300, epoch: 11 | loss: 0.0711001
	speed: 0.0231s/iter; left time: 968.0169s
	iters: 400, epoch: 11 | loss: 0.1194435
	speed: 0.0231s/iter; left time: 964.3551s
Epoch: 11 cost time: 11.359071493148804
Epoch: 11, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0143521
	speed: 0.1245s/iter; left time: 5182.7132s
	iters: 200, epoch: 12 | loss: 0.0353819
	speed: 0.0228s/iter; left time: 945.6997s
	iters: 300, epoch: 12 | loss: 0.0412719
	speed: 0.0237s/iter; left time: 981.8951s
	iters: 400, epoch: 12 | loss: 0.0229311
	speed: 0.0242s/iter; left time: 1001.6478s
Epoch: 12 cost time: 11.434161901473999
Epoch: 12, Steps: 469 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1169755
	speed: 0.1221s/iter; left time: 5028.4297s
	iters: 200, epoch: 13 | loss: 0.0129575
	speed: 0.0233s/iter; left time: 956.7578s
	iters: 300, epoch: 13 | loss: 0.0088466
	speed: 0.0247s/iter; left time: 1013.8297s
	iters: 400, epoch: 13 | loss: 0.0816957
	speed: 0.0253s/iter; left time: 1035.8103s
Epoch: 13 cost time: 11.57874584197998
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0224457
	speed: 0.1283s/iter; left time: 5223.6495s
	iters: 200, epoch: 14 | loss: 0.1722535
	speed: 0.0250s/iter; left time: 1013.9212s
	iters: 300, epoch: 14 | loss: 0.0295972
	speed: 0.0246s/iter; left time: 996.0888s
	iters: 400, epoch: 14 | loss: 0.0671304
	speed: 0.0249s/iter; left time: 1004.5385s
Epoch: 14 cost time: 12.057579040527344
Epoch: 14, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0256602
	speed: 0.1250s/iter; left time: 5027.4827s
	iters: 200, epoch: 15 | loss: 0.0088148
	speed: 0.0240s/iter; left time: 963.6669s
	iters: 300, epoch: 15 | loss: 0.0112615
	speed: 0.0240s/iter; left time: 961.8939s
	iters: 400, epoch: 15 | loss: 0.0057735
	speed: 0.0246s/iter; left time: 983.2670s
Epoch: 15 cost time: 11.632590293884277
Epoch: 15, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0601833
	speed: 0.1223s/iter; left time: 4864.2793s
	iters: 200, epoch: 16 | loss: 0.0215433
	speed: 0.0235s/iter; left time: 930.2158s
	iters: 300, epoch: 16 | loss: 0.1083345
	speed: 0.0239s/iter; left time: 944.9590s
	iters: 400, epoch: 16 | loss: 0.0178762
	speed: 0.0217s/iter; left time: 858.1359s
Epoch: 16 cost time: 11.355986595153809
Epoch: 16, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.971983 --> -0.974842).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0699482
	speed: 0.1233s/iter; left time: 4844.4068s
	iters: 200, epoch: 17 | loss: 0.1276144
	speed: 0.0226s/iter; left time: 887.2806s
	iters: 300, epoch: 17 | loss: 0.0116833
	speed: 0.0216s/iter; left time: 843.4602s
	iters: 400, epoch: 17 | loss: 0.5006721
	speed: 0.0211s/iter; left time: 821.0113s
Epoch: 17 cost time: 10.817747592926025
Epoch: 17, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0483183
	speed: 0.1239s/iter; left time: 4812.3591s
	iters: 200, epoch: 18 | loss: 0.1224566
	speed: 0.0217s/iter; left time: 838.7483s
	iters: 300, epoch: 18 | loss: 0.0047067
	speed: 0.0215s/iter; left time: 829.9309s
	iters: 400, epoch: 18 | loss: 0.0086187
	speed: 0.0222s/iter; left time: 856.2814s
Epoch: 18 cost time: 10.8962881565094
Epoch: 18, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0268767
	speed: 0.1268s/iter; left time: 4862.7949s
	iters: 200, epoch: 19 | loss: 0.0446872
	speed: 0.0219s/iter; left time: 837.6505s
	iters: 300, epoch: 19 | loss: 0.0011585
	speed: 0.0226s/iter; left time: 862.5009s
	iters: 400, epoch: 19 | loss: 0.1231620
	speed: 0.0228s/iter; left time: 866.3251s
Epoch: 19 cost time: 10.914900064468384
Epoch: 19, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0301817
	speed: 0.1217s/iter; left time: 4612.7487s
	iters: 200, epoch: 20 | loss: 0.0350078
	speed: 0.0227s/iter; left time: 857.3295s
	iters: 300, epoch: 20 | loss: 0.0155323
	speed: 0.0257s/iter; left time: 967.1812s
	iters: 400, epoch: 20 | loss: 0.0226418
	speed: 0.0226s/iter; left time: 848.1834s
Epoch: 20 cost time: 11.455410957336426
Epoch: 20, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.974842 --> -0.975699).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0411129
	speed: 0.1222s/iter; left time: 4574.3499s
	iters: 200, epoch: 21 | loss: 0.1878601
	speed: 0.0251s/iter; left time: 935.6244s
	iters: 300, epoch: 21 | loss: 0.0066870
	speed: 0.0256s/iter; left time: 951.8142s
	iters: 400, epoch: 21 | loss: 0.0709431
	speed: 0.0237s/iter; left time: 878.5631s
Epoch: 21 cost time: 11.75730276107788
Epoch: 21, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.975699 --> -0.979130).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0098319
	speed: 0.1215s/iter; left time: 4490.5692s
	iters: 200, epoch: 22 | loss: 0.0148510
	speed: 0.0245s/iter; left time: 902.4873s
	iters: 300, epoch: 22 | loss: 0.0421222
	speed: 0.0240s/iter; left time: 883.4000s
	iters: 400, epoch: 22 | loss: 0.0266458
	speed: 0.0236s/iter; left time: 864.6911s
Epoch: 22 cost time: 11.775265455245972
Epoch: 22, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0011336
	speed: 0.1100s/iter; left time: 4012.3235s
	iters: 200, epoch: 23 | loss: 0.0527554
	speed: 0.0199s/iter; left time: 724.1347s
	iters: 300, epoch: 23 | loss: 0.0325689
	speed: 0.0199s/iter; left time: 721.2304s
	iters: 400, epoch: 23 | loss: 0.0055696
	speed: 0.0213s/iter; left time: 770.8952s
Epoch: 23 cost time: 10.005201578140259
Epoch: 23, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0106809
	speed: 0.1222s/iter; left time: 4400.3047s
	iters: 200, epoch: 24 | loss: 0.0079901
	speed: 0.0212s/iter; left time: 763.1251s
	iters: 300, epoch: 24 | loss: 0.0326182
	speed: 0.0227s/iter; left time: 813.3407s
	iters: 400, epoch: 24 | loss: 0.0139754
	speed: 0.0220s/iter; left time: 787.2049s
Epoch: 24 cost time: 10.929652214050293
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0074728
	speed: 0.1299s/iter; left time: 4617.0061s
	iters: 200, epoch: 25 | loss: 0.0004746
	speed: 0.0229s/iter; left time: 813.3691s
	iters: 300, epoch: 25 | loss: 0.0078659
	speed: 0.0220s/iter; left time: 776.5774s
	iters: 400, epoch: 25 | loss: 0.0223017
	speed: 0.0225s/iter; left time: 793.1132s
Epoch: 25 cost time: 11.122499227523804
Epoch: 25, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0027224
	speed: 0.1236s/iter; left time: 4335.0813s
	iters: 200, epoch: 26 | loss: 0.0135107
	speed: 0.0220s/iter; left time: 769.4024s
	iters: 300, epoch: 26 | loss: 0.0014798
	speed: 0.0222s/iter; left time: 775.5659s
	iters: 400, epoch: 26 | loss: 0.0837885
	speed: 0.0233s/iter; left time: 809.7455s
Epoch: 26 cost time: 10.9109365940094
Epoch: 26, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0995584
	speed: 0.1201s/iter; left time: 4157.7075s
	iters: 200, epoch: 27 | loss: 0.0202370
	speed: 0.0221s/iter; left time: 763.4121s
	iters: 300, epoch: 27 | loss: 0.0466787
	speed: 0.0243s/iter; left time: 835.4454s
	iters: 400, epoch: 27 | loss: 0.0207679
	speed: 0.0234s/iter; left time: 802.2851s
Epoch: 27 cost time: 11.183154106140137
Epoch: 27, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0220014
	speed: 0.1254s/iter; left time: 4279.8981s
	iters: 200, epoch: 28 | loss: 0.0040465
	speed: 0.0227s/iter; left time: 772.8850s
	iters: 300, epoch: 28 | loss: 0.0849723
	speed: 0.0231s/iter; left time: 785.1356s
	iters: 400, epoch: 28 | loss: 0.0471666
	speed: 0.0226s/iter; left time: 763.8381s
Epoch: 28 cost time: 11.211518049240112
Epoch: 28, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0120672
	speed: 0.1222s/iter; left time: 4113.4197s
	iters: 200, epoch: 29 | loss: 0.1254576
	speed: 0.0240s/iter; left time: 806.8179s
	iters: 300, epoch: 29 | loss: 0.0078594
	speed: 0.0246s/iter; left time: 821.7173s
	iters: 400, epoch: 29 | loss: 0.2836930
	speed: 0.0246s/iter; left time: 821.0917s
Epoch: 29 cost time: 11.861980438232422
Epoch: 29, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0097665
	speed: 0.1236s/iter; left time: 4104.1119s
	iters: 200, epoch: 30 | loss: 0.1047736
	speed: 0.0237s/iter; left time: 783.5687s
	iters: 300, epoch: 30 | loss: 0.0198705
	speed: 0.0236s/iter; left time: 779.9179s
	iters: 400, epoch: 30 | loss: 0.0115513
	speed: 0.0239s/iter; left time: 787.2668s
Epoch: 30 cost time: 11.518136978149414
Epoch: 30, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.979130 --> -0.979416).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0016531
	speed: 0.1179s/iter; left time: 3858.5902s
	iters: 200, epoch: 31 | loss: 0.0009016
	speed: 0.0242s/iter; left time: 789.1254s
	iters: 300, epoch: 31 | loss: 0.0408564
	speed: 0.0235s/iter; left time: 764.5807s
	iters: 400, epoch: 31 | loss: 0.0004105
	speed: 0.0231s/iter; left time: 747.8466s
Epoch: 31 cost time: 11.337913274765015
Epoch: 31, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0289130
	speed: 0.1172s/iter; left time: 3780.5713s
	iters: 200, epoch: 32 | loss: 0.0470092
	speed: 0.0235s/iter; left time: 754.2640s
	iters: 300, epoch: 32 | loss: 0.0332555
	speed: 0.0222s/iter; left time: 711.0861s
	iters: 400, epoch: 32 | loss: 0.0058152
	speed: 0.0223s/iter; left time: 714.3466s
Epoch: 32 cost time: 11.04085659980774
Epoch: 32, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0086446
	speed: 0.1184s/iter; left time: 3763.5161s
	iters: 200, epoch: 33 | loss: 0.2163799
	speed: 0.0217s/iter; left time: 687.4465s
	iters: 300, epoch: 33 | loss: 0.0005327
	speed: 0.0214s/iter; left time: 675.5273s
	iters: 400, epoch: 33 | loss: 0.1644336
	speed: 0.0207s/iter; left time: 651.5710s
Epoch: 33 cost time: 10.64807915687561
Epoch: 33, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0013656
	speed: 0.1259s/iter; left time: 3945.1600s
	iters: 200, epoch: 34 | loss: 0.0044682
	speed: 0.0209s/iter; left time: 653.2097s
	iters: 300, epoch: 34 | loss: 0.0052607
	speed: 0.0212s/iter; left time: 660.1468s
	iters: 400, epoch: 34 | loss: 0.0026781
	speed: 0.0220s/iter; left time: 681.4626s
Epoch: 34 cost time: 10.629188299179077
Epoch: 34, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0403127
	speed: 0.1185s/iter; left time: 3656.0273s
	iters: 200, epoch: 35 | loss: 0.0024657
	speed: 0.0221s/iter; left time: 680.9923s
	iters: 300, epoch: 35 | loss: 0.0083596
	speed: 0.0208s/iter; left time: 637.3142s
	iters: 400, epoch: 35 | loss: 0.0098418
	speed: 0.0217s/iter; left time: 662.3925s
Epoch: 35 cost time: 10.702857494354248
Epoch: 35, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0006664
	speed: 0.1196s/iter; left time: 3634.2276s
	iters: 200, epoch: 36 | loss: 0.0131689
	speed: 0.0214s/iter; left time: 647.6049s
	iters: 300, epoch: 36 | loss: 0.0001585
	speed: 0.0220s/iter; left time: 664.7659s
	iters: 400, epoch: 36 | loss: 0.0312273
	speed: 0.0231s/iter; left time: 694.5273s
Epoch: 36 cost time: 10.89324140548706
Epoch: 36, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0008782
	speed: 0.1194s/iter; left time: 3571.2733s
	iters: 200, epoch: 37 | loss: 0.0368371
	speed: 0.0223s/iter; left time: 666.2112s
	iters: 300, epoch: 37 | loss: 0.0285042
	speed: 0.0246s/iter; left time: 730.3145s
	iters: 400, epoch: 37 | loss: 0.0065346
	speed: 0.0251s/iter; left time: 744.5308s
Epoch: 37 cost time: 11.39856243133545
Epoch: 37, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0066827
	speed: 0.1244s/iter; left time: 3663.6731s
	iters: 200, epoch: 38 | loss: 0.3469946
	speed: 0.0236s/iter; left time: 692.6382s
	iters: 300, epoch: 38 | loss: 0.1199094
	speed: 0.0239s/iter; left time: 698.7577s
	iters: 400, epoch: 38 | loss: 0.0442289
	speed: 0.0244s/iter; left time: 710.2732s
Epoch: 38 cost time: 11.439115047454834
Epoch: 38, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979416 --> -0.979702).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.1826961
	speed: 0.1241s/iter; left time: 3596.7932s
	iters: 200, epoch: 39 | loss: 0.0022411
	speed: 0.0237s/iter; left time: 684.0948s
	iters: 300, epoch: 39 | loss: 0.0049798
	speed: 0.0236s/iter; left time: 678.1596s
	iters: 400, epoch: 39 | loss: 0.0061933
	speed: 0.0234s/iter; left time: 670.7494s
Epoch: 39 cost time: 11.375228643417358
Epoch: 39, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 40 | loss: 0.0050946
	speed: 0.1191s/iter; left time: 3395.1576s
	iters: 200, epoch: 40 | loss: 0.0088069
	speed: 0.0245s/iter; left time: 697.0671s
	iters: 300, epoch: 40 | loss: 0.0039322
	speed: 0.0238s/iter; left time: 672.7330s
	iters: 400, epoch: 40 | loss: 0.0076376
	speed: 0.0241s/iter; left time: 681.0181s
Epoch: 40 cost time: 11.705940246582031
Epoch: 40, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 41 | loss: 0.0012767
	speed: 0.1152s/iter; left time: 3231.5064s
	iters: 200, epoch: 41 | loss: 0.0016149
	speed: 0.0244s/iter; left time: 681.5316s
	iters: 300, epoch: 41 | loss: 0.0086058
	speed: 0.0238s/iter; left time: 663.0156s
	iters: 400, epoch: 41 | loss: 0.0112573
	speed: 0.0213s/iter; left time: 590.5902s
Epoch: 41 cost time: 11.144609212875366
Epoch: 41, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 42 | loss: 0.0096912
	speed: 0.1196s/iter; left time: 3296.8279s
	iters: 200, epoch: 42 | loss: 0.0012491
	speed: 0.0230s/iter; left time: 631.1705s
	iters: 300, epoch: 42 | loss: 0.0264044
	speed: 0.0228s/iter; left time: 624.0961s
	iters: 400, epoch: 42 | loss: 0.0050831
	speed: 0.0212s/iter; left time: 577.3722s
Epoch: 42 cost time: 10.990453958511353
Epoch: 42, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 43 | loss: 0.0168660
	speed: 0.1203s/iter; left time: 3259.8180s
	iters: 200, epoch: 43 | loss: 0.0015827
	speed: 0.0223s/iter; left time: 602.2333s
	iters: 300, epoch: 43 | loss: 0.0121457
	speed: 0.0213s/iter; left time: 571.6921s
	iters: 400, epoch: 43 | loss: 0.0079658
	speed: 0.0208s/iter; left time: 557.1781s
Epoch: 43 cost time: 10.617701053619385
Epoch: 43, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 44 | loss: 0.0003778
	speed: 0.1214s/iter; left time: 3233.8930s
	iters: 200, epoch: 44 | loss: 0.0225023
	speed: 0.0219s/iter; left time: 582.2432s
	iters: 300, epoch: 44 | loss: 0.0934829
	speed: 0.0223s/iter; left time: 588.4132s
	iters: 400, epoch: 44 | loss: 0.0270230
	speed: 0.0208s/iter; left time: 547.3035s
Epoch: 44 cost time: 10.816360235214233
Epoch: 44, Steps: 469 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 45 | loss: 0.0062290
	speed: 0.1204s/iter; left time: 3151.2057s
	iters: 200, epoch: 45 | loss: 0.0221213
	speed: 0.0227s/iter; left time: 591.1667s
	iters: 300, epoch: 45 | loss: 0.0041176
	speed: 0.0213s/iter; left time: 554.3180s
	iters: 400, epoch: 45 | loss: 0.0046965
	speed: 0.0226s/iter; left time: 585.5075s
Epoch: 45 cost time: 11.01002049446106
Epoch: 45, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 46 | loss: 0.0060850
	speed: 0.1209s/iter; left time: 3107.6850s
	iters: 200, epoch: 46 | loss: 0.0025210
	speed: 0.0219s/iter; left time: 560.8659s
	iters: 300, epoch: 46 | loss: 0.0005233
	speed: 0.0216s/iter; left time: 549.8445s
	iters: 400, epoch: 46 | loss: 0.0329444
	speed: 0.0240s/iter; left time: 608.3064s
Epoch: 46 cost time: 10.9744234085083
Epoch: 46, Steps: 469 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 47 | loss: 0.0475056
	speed: 0.1187s/iter; left time: 2994.1171s
	iters: 200, epoch: 47 | loss: 0.0218359
	speed: 0.0206s/iter; left time: 518.5178s
	iters: 300, epoch: 47 | loss: 0.0031074
	speed: 0.0236s/iter; left time: 590.4425s
	iters: 400, epoch: 47 | loss: 0.0040076
	speed: 0.0235s/iter; left time: 586.0564s
Epoch: 47 cost time: 11.140836000442505
Epoch: 47, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 48 | loss: 0.0018511
	speed: 0.1242s/iter; left time: 3075.1490s
	iters: 200, epoch: 48 | loss: 0.0128497
	speed: 0.0209s/iter; left time: 516.2205s
	iters: 300, epoch: 48 | loss: 0.0021515
	speed: 0.0213s/iter; left time: 523.1692s
	iters: 400, epoch: 48 | loss: 0.0220996
	speed: 0.0197s/iter; left time: 481.9038s
Epoch: 48 cost time: 10.219510793685913
Epoch: 48, Steps: 469 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9797026872498571
model parameter : 13538
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7482550
	speed: 0.0414s/iter; left time: 1938.8605s
	iters: 200, epoch: 1 | loss: 0.9081879
	speed: 0.0235s/iter; left time: 1098.3710s
	iters: 300, epoch: 1 | loss: 0.8488315
	speed: 0.0254s/iter; left time: 1185.5941s
	iters: 400, epoch: 1 | loss: 0.6573434
	speed: 0.0254s/iter; left time: 1182.2211s
Epoch: 1 cost time: 13.430852890014648
Epoch: 1, Steps: 469 | Train Loss: 1.097 Vali Loss: 0.561 Vali Acc: 0.833 Test Loss: 0.561 Test Acc: 0.833
Validation loss decreased (inf --> -0.832756).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2796912
	speed: 0.1249s/iter; left time: 5789.1016s
	iters: 200, epoch: 2 | loss: 0.3429222
	speed: 0.0239s/iter; left time: 1105.7123s
	iters: 300, epoch: 2 | loss: 0.3845254
	speed: 0.0246s/iter; left time: 1134.8736s
	iters: 400, epoch: 2 | loss: 0.1868095
	speed: 0.0248s/iter; left time: 1140.1960s
Epoch: 2 cost time: 11.799301385879517
Epoch: 2, Steps: 469 | Train Loss: 0.354 Vali Loss: 0.357 Vali Acc: 0.897 Test Loss: 0.357 Test Acc: 0.897
Validation loss decreased (-0.832756 --> -0.897080).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1729060
	speed: 0.1223s/iter; left time: 5606.9399s
	iters: 200, epoch: 3 | loss: 0.3081906
	speed: 0.0247s/iter; left time: 1131.8389s
	iters: 300, epoch: 3 | loss: 0.3177546
	speed: 0.0244s/iter; left time: 1113.2832s
	iters: 400, epoch: 3 | loss: 0.5471191
	speed: 0.0244s/iter; left time: 1113.2376s
Epoch: 3 cost time: 11.66913366317749
Epoch: 3, Steps: 469 | Train Loss: 0.225 Vali Loss: 0.265 Vali Acc: 0.920 Test Loss: 0.265 Test Acc: 0.920
Validation loss decreased (-0.897080 --> -0.919666).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4460114
	speed: 0.1304s/iter; left time: 5918.4974s
	iters: 200, epoch: 4 | loss: 0.2442216
	speed: 0.0248s/iter; left time: 1123.0817s
	iters: 300, epoch: 4 | loss: 0.2184842
	speed: 0.0252s/iter; left time: 1139.2032s
	iters: 400, epoch: 4 | loss: 0.1893153
	speed: 0.0238s/iter; left time: 1073.7838s
Epoch: 4 cost time: 12.000744819641113
Epoch: 4, Steps: 469 | Train Loss: 0.173 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
Validation loss decreased (-0.919666 --> -0.939106).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0699849
	speed: 0.1331s/iter; left time: 5979.9470s
	iters: 200, epoch: 5 | loss: 0.0806719
	speed: 0.0242s/iter; left time: 1085.4370s
	iters: 300, epoch: 5 | loss: 0.1917974
	speed: 0.0230s/iter; left time: 1030.8418s
	iters: 400, epoch: 5 | loss: 0.0378610
	speed: 0.0227s/iter; left time: 1012.2322s
Epoch: 5 cost time: 11.494947910308838
Epoch: 5, Steps: 469 | Train Loss: 0.140 Vali Loss: 0.177 Vali Acc: 0.955 Test Loss: 0.177 Test Acc: 0.955
Validation loss decreased (-0.939106 --> -0.955115).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2969671
	speed: 0.1333s/iter; left time: 5925.7866s
	iters: 200, epoch: 6 | loss: 0.2164119
	speed: 0.0239s/iter; left time: 1060.9410s
	iters: 300, epoch: 6 | loss: 0.0175030
	speed: 0.0238s/iter; left time: 1054.7330s
	iters: 400, epoch: 6 | loss: 0.0782214
	speed: 0.0251s/iter; left time: 1107.1859s
Epoch: 6 cost time: 12.027721881866455
Epoch: 6, Steps: 469 | Train Loss: 0.128 Vali Loss: 0.185 Vali Acc: 0.953 Test Loss: 0.185 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0220301
	speed: 0.1296s/iter; left time: 5699.9148s
	iters: 200, epoch: 7 | loss: 0.0643633
	speed: 0.0234s/iter; left time: 1027.0690s
	iters: 300, epoch: 7 | loss: 0.1915371
	speed: 0.0259s/iter; left time: 1135.4227s
	iters: 400, epoch: 7 | loss: 0.0359830
	speed: 0.0258s/iter; left time: 1126.6388s
Epoch: 7 cost time: 12.061679601669312
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.955115 --> -0.961119).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0491729
	speed: 0.1292s/iter; left time: 5620.6173s
	iters: 200, epoch: 8 | loss: 0.3527054
	speed: 0.0268s/iter; left time: 1164.8450s
	iters: 300, epoch: 8 | loss: 0.0110674
	speed: 0.0257s/iter; left time: 1111.4713s
	iters: 400, epoch: 8 | loss: 0.0187604
	speed: 0.0263s/iter; left time: 1137.3316s
Epoch: 8 cost time: 12.421922206878662
Epoch: 8, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.961119 --> -0.962263).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1267136
	speed: 0.1266s/iter; left time: 5452.0722s
	iters: 200, epoch: 9 | loss: 0.0143257
	speed: 0.0263s/iter; left time: 1129.6095s
	iters: 300, epoch: 9 | loss: 0.0644624
	speed: 0.0267s/iter; left time: 1142.0412s
	iters: 400, epoch: 9 | loss: 0.0136628
	speed: 0.0252s/iter; left time: 1078.2741s
Epoch: 9 cost time: 12.350059509277344
Epoch: 9, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.962263 --> -0.963978).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0161096
	speed: 0.1241s/iter; left time: 5282.2168s
	iters: 200, epoch: 10 | loss: 0.1029381
	speed: 0.0258s/iter; left time: 1097.5741s
	iters: 300, epoch: 10 | loss: 0.0505755
	speed: 0.0251s/iter; left time: 1063.1880s
	iters: 400, epoch: 10 | loss: 0.0126454
	speed: 0.0237s/iter; left time: 1002.8545s
Epoch: 10 cost time: 11.883727312088013
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.963978 --> -0.970839).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0058860
	speed: 0.1107s/iter; left time: 4661.0818s
	iters: 200, epoch: 11 | loss: 0.0141074
	speed: 0.0190s/iter; left time: 797.4402s
	iters: 300, epoch: 11 | loss: 0.0712697
	speed: 0.0204s/iter; left time: 854.6427s
	iters: 400, epoch: 11 | loss: 0.2034523
	speed: 0.0207s/iter; left time: 863.6754s
Epoch: 11 cost time: 10.017297267913818
Epoch: 11, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0078002
	speed: 0.1254s/iter; left time: 5222.0983s
	iters: 200, epoch: 12 | loss: 0.0388505
	speed: 0.0212s/iter; left time: 881.3672s
	iters: 300, epoch: 12 | loss: 0.0598590
	speed: 0.0219s/iter; left time: 908.3110s
	iters: 400, epoch: 12 | loss: 0.0367447
	speed: 0.0223s/iter; left time: 922.2824s
Epoch: 12 cost time: 10.833236694335938
Epoch: 12, Steps: 469 | Train Loss: 0.074 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1029762
	speed: 0.1310s/iter; left time: 5394.2270s
	iters: 200, epoch: 13 | loss: 0.0419368
	speed: 0.0221s/iter; left time: 906.8854s
	iters: 300, epoch: 13 | loss: 0.0090036
	speed: 0.0214s/iter; left time: 877.5957s
	iters: 400, epoch: 13 | loss: 0.1639509
	speed: 0.0233s/iter; left time: 953.9281s
Epoch: 13 cost time: 11.122507333755493
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0135852
	speed: 0.1277s/iter; left time: 5197.6925s
	iters: 200, epoch: 14 | loss: 0.0798164
	speed: 0.0222s/iter; left time: 901.9272s
	iters: 300, epoch: 14 | loss: 0.0318926
	speed: 0.0210s/iter; left time: 849.3813s
	iters: 400, epoch: 14 | loss: 0.0259319
	speed: 0.0228s/iter; left time: 921.2287s
Epoch: 14 cost time: 10.898993253707886
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0135601
	speed: 0.1209s/iter; left time: 4864.6161s
	iters: 200, epoch: 15 | loss: 0.0157359
	speed: 0.0211s/iter; left time: 844.9827s
	iters: 300, epoch: 15 | loss: 0.0098861
	speed: 0.0233s/iter; left time: 931.7953s
	iters: 400, epoch: 15 | loss: 0.0124603
	speed: 0.0233s/iter; left time: 931.5156s
Epoch: 15 cost time: 10.851238012313843
Epoch: 15, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0692773
	speed: 0.1211s/iter; left time: 4817.1666s
	iters: 200, epoch: 16 | loss: 0.0211667
	speed: 0.0239s/iter; left time: 949.5960s
	iters: 300, epoch: 16 | loss: 0.0722092
	speed: 0.0245s/iter; left time: 968.4860s
	iters: 400, epoch: 16 | loss: 0.0173141
	speed: 0.0246s/iter; left time: 971.0697s
Epoch: 16 cost time: 11.651544332504272
Epoch: 16, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.970839 --> -0.972555).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0384987
	speed: 0.1212s/iter; left time: 4760.9766s
	iters: 200, epoch: 17 | loss: 0.0783727
	speed: 0.0236s/iter; left time: 925.4768s
	iters: 300, epoch: 17 | loss: 0.0187567
	speed: 0.0239s/iter; left time: 936.1385s
	iters: 400, epoch: 17 | loss: 0.6561988
	speed: 0.0249s/iter; left time: 970.3528s
Epoch: 17 cost time: 11.615126609802246
Epoch: 17, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0159986
	speed: 0.1204s/iter; left time: 4673.3309s
	iters: 200, epoch: 18 | loss: 0.1830021
	speed: 0.0232s/iter; left time: 897.1130s
	iters: 300, epoch: 18 | loss: 0.0019262
	speed: 0.0233s/iter; left time: 901.3802s
	iters: 400, epoch: 18 | loss: 0.0855440
	speed: 0.0216s/iter; left time: 830.4067s
Epoch: 18 cost time: 11.159039735794067
Epoch: 18, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.972555 --> -0.973698).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.1376053
	speed: 0.1213s/iter; left time: 4652.5198s
	iters: 200, epoch: 19 | loss: 0.0363970
	speed: 0.0236s/iter; left time: 901.8637s
	iters: 300, epoch: 19 | loss: 0.0047335
	speed: 0.0236s/iter; left time: 898.7291s
	iters: 400, epoch: 19 | loss: 0.0215192
	speed: 0.0218s/iter; left time: 829.5713s
Epoch: 19 cost time: 11.178946018218994
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0182762
	speed: 0.1220s/iter; left time: 4624.3132s
	iters: 200, epoch: 20 | loss: 0.0686727
	speed: 0.0253s/iter; left time: 957.8710s
	iters: 300, epoch: 20 | loss: 0.0089225
	speed: 0.0240s/iter; left time: 903.7038s
	iters: 400, epoch: 20 | loss: 0.0434997
	speed: 0.0214s/iter; left time: 803.0283s
Epoch: 20 cost time: 11.2061185836792
Epoch: 20, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973698 --> -0.976557).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0213583
	speed: 0.1181s/iter; left time: 4418.4389s
	iters: 200, epoch: 21 | loss: 0.0534954
	speed: 0.0201s/iter; left time: 748.3123s
	iters: 300, epoch: 21 | loss: 0.0137849
	speed: 0.0190s/iter; left time: 707.1461s
	iters: 400, epoch: 21 | loss: 0.1228275
	speed: 0.0187s/iter; left time: 694.4638s
Epoch: 21 cost time: 9.494604587554932
Epoch: 21, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0017450
	speed: 0.1066s/iter; left time: 3940.5848s
	iters: 200, epoch: 22 | loss: 0.0105383
	speed: 0.0205s/iter; left time: 754.3295s
	iters: 300, epoch: 22 | loss: 0.0112916
	speed: 0.0196s/iter; left time: 720.8831s
	iters: 400, epoch: 22 | loss: 0.0343213
	speed: 0.0223s/iter; left time: 816.4556s
Epoch: 22 cost time: 10.441978931427002
Epoch: 22, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0017098
	speed: 0.1284s/iter; left time: 4685.5519s
	iters: 200, epoch: 23 | loss: 0.0205986
	speed: 0.0220s/iter; left time: 800.0399s
	iters: 300, epoch: 23 | loss: 0.0761850
	speed: 0.0226s/iter; left time: 818.7788s
	iters: 400, epoch: 23 | loss: 0.0424729
	speed: 0.0239s/iter; left time: 866.3826s
Epoch: 23 cost time: 11.273538827896118
Epoch: 23, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0359338
	speed: 0.1272s/iter; left time: 4579.3320s
	iters: 200, epoch: 24 | loss: 0.0308714
	speed: 0.0238s/iter; left time: 855.1783s
	iters: 300, epoch: 24 | loss: 0.0563680
	speed: 0.0255s/iter; left time: 912.7541s
	iters: 400, epoch: 24 | loss: 0.0081591
	speed: 0.0253s/iter; left time: 904.9268s
Epoch: 24 cost time: 11.869709014892578
Epoch: 24, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0100622
	speed: 0.1244s/iter; left time: 4421.6855s
	iters: 200, epoch: 25 | loss: 0.0009839
	speed: 0.0240s/iter; left time: 849.9046s
	iters: 300, epoch: 25 | loss: 0.0295132
	speed: 0.0257s/iter; left time: 907.8545s
	iters: 400, epoch: 25 | loss: 0.0266983
	speed: 0.0253s/iter; left time: 891.8871s
Epoch: 25 cost time: 12.108749628067017
Epoch: 25, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976557 --> -0.976557).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0479140
	speed: 0.1292s/iter; left time: 4532.3648s
	iters: 200, epoch: 26 | loss: 0.0070763
	speed: 0.0235s/iter; left time: 822.3892s
	iters: 300, epoch: 26 | loss: 0.0057989
	speed: 0.0254s/iter; left time: 886.2373s
	iters: 400, epoch: 26 | loss: 0.0247260
	speed: 0.0238s/iter; left time: 827.8026s
Epoch: 26 cost time: 11.893543243408203
Epoch: 26, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 27 | loss: 0.0234107
	speed: 0.1320s/iter; left time: 4567.5536s
	iters: 200, epoch: 27 | loss: 0.1515457
	speed: 0.0228s/iter; left time: 787.2709s
	iters: 300, epoch: 27 | loss: 0.0517353
	speed: 0.0224s/iter; left time: 771.9259s
	iters: 400, epoch: 27 | loss: 0.0043483
	speed: 0.0213s/iter; left time: 730.1958s
Epoch: 27 cost time: 11.176351547241211
Epoch: 27, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 28 | loss: 0.0831655
	speed: 0.1253s/iter; left time: 4276.2358s
	iters: 200, epoch: 28 | loss: 0.0019433
	speed: 0.0228s/iter; left time: 775.3262s
	iters: 300, epoch: 28 | loss: 0.0531272
	speed: 0.0213s/iter; left time: 722.8983s
	iters: 400, epoch: 28 | loss: 0.0117657
	speed: 0.0209s/iter; left time: 707.0733s
Epoch: 28 cost time: 10.930721521377563
Epoch: 28, Steps: 469 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 29 | loss: 0.0084454
	speed: 0.1294s/iter; left time: 4357.5620s
	iters: 200, epoch: 29 | loss: 0.1820812
	speed: 0.0221s/iter; left time: 741.8955s
	iters: 300, epoch: 29 | loss: 0.0017728
	speed: 0.0221s/iter; left time: 738.3567s
	iters: 400, epoch: 29 | loss: 0.2098700
	speed: 0.0249s/iter; left time: 829.7923s
Epoch: 29 cost time: 11.3152015209198
Epoch: 29, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 30 | loss: 0.0233923
	speed: 0.1236s/iter; left time: 4105.0970s
	iters: 200, epoch: 30 | loss: 0.1434994
	speed: 0.0215s/iter; left time: 710.9645s
	iters: 300, epoch: 30 | loss: 0.1237709
	speed: 0.0234s/iter; left time: 772.5565s
	iters: 400, epoch: 30 | loss: 0.0399397
	speed: 0.0238s/iter; left time: 782.2102s
Epoch: 30 cost time: 11.078753232955933
Epoch: 30, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.976557 --> -0.980845).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0247043
	speed: 0.1311s/iter; left time: 4289.5671s
	iters: 200, epoch: 31 | loss: 0.0014688
	speed: 0.0207s/iter; left time: 676.7345s
	iters: 300, epoch: 31 | loss: 0.0404501
	speed: 0.0208s/iter; left time: 677.7343s
	iters: 400, epoch: 31 | loss: 0.0048049
	speed: 0.0195s/iter; left time: 631.8732s
Epoch: 31 cost time: 10.226586818695068
Epoch: 31, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0803202
	speed: 0.1088s/iter; left time: 3509.8647s
	iters: 200, epoch: 32 | loss: 0.0247401
	speed: 0.0236s/iter; left time: 759.9746s
	iters: 300, epoch: 32 | loss: 0.0807456
	speed: 0.0221s/iter; left time: 709.4702s
	iters: 400, epoch: 32 | loss: 0.0117348
	speed: 0.0221s/iter; left time: 706.3063s
Epoch: 32 cost time: 11.056066989898682
Epoch: 32, Steps: 469 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0030609
	speed: 0.1150s/iter; left time: 3656.1428s
	iters: 200, epoch: 33 | loss: 0.0507096
	speed: 0.0243s/iter; left time: 771.1126s
	iters: 300, epoch: 33 | loss: 0.0018001
	speed: 0.0251s/iter; left time: 792.9664s
	iters: 400, epoch: 33 | loss: 0.2870353
	speed: 0.0241s/iter; left time: 759.5560s
Epoch: 33 cost time: 11.610740661621094
Epoch: 33, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0027755
	speed: 0.1196s/iter; left time: 3747.7811s
	iters: 200, epoch: 34 | loss: 0.0040674
	speed: 0.0239s/iter; left time: 747.0839s
	iters: 300, epoch: 34 | loss: 0.0723216
	speed: 0.0237s/iter; left time: 738.0066s
	iters: 400, epoch: 34 | loss: 0.0491280
	speed: 0.0216s/iter; left time: 670.6585s
Epoch: 34 cost time: 11.155745267868042
Epoch: 34, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0443336
	speed: 0.1218s/iter; left time: 3758.2315s
	iters: 200, epoch: 35 | loss: 0.0025759
	speed: 0.0234s/iter; left time: 720.4768s
	iters: 300, epoch: 35 | loss: 0.0013953
	speed: 0.0209s/iter; left time: 640.7440s
	iters: 400, epoch: 35 | loss: 0.0134682
	speed: 0.0217s/iter; left time: 663.6267s
Epoch: 35 cost time: 10.871690273284912
Epoch: 35, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0015020
	speed: 0.1306s/iter; left time: 3968.5614s
	iters: 200, epoch: 36 | loss: 0.0099882
	speed: 0.0231s/iter; left time: 700.6419s
	iters: 300, epoch: 36 | loss: 0.0013784
	speed: 0.0232s/iter; left time: 700.2326s
	iters: 400, epoch: 36 | loss: 0.0132903
	speed: 0.0216s/iter; left time: 651.0967s
Epoch: 36 cost time: 11.199043273925781
Epoch: 36, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0041421
	speed: 0.1304s/iter; left time: 3901.0285s
	iters: 200, epoch: 37 | loss: 0.1052426
	speed: 0.0224s/iter; left time: 667.7234s
	iters: 300, epoch: 37 | loss: 0.0070322
	speed: 0.0226s/iter; left time: 670.6726s
	iters: 400, epoch: 37 | loss: 0.0014970
	speed: 0.0237s/iter; left time: 701.9597s
Epoch: 37 cost time: 11.051960945129395
Epoch: 37, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0240575
	speed: 0.1246s/iter; left time: 3669.8739s
	iters: 200, epoch: 38 | loss: 0.2352262
	speed: 0.0217s/iter; left time: 636.6524s
	iters: 300, epoch: 38 | loss: 0.0458601
	speed: 0.0233s/iter; left time: 682.8708s
	iters: 400, epoch: 38 | loss: 0.1475846
	speed: 0.0242s/iter; left time: 704.7759s
Epoch: 38 cost time: 11.156664371490479
Epoch: 38, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0305831
	speed: 0.1213s/iter; left time: 3513.7670s
	iters: 200, epoch: 39 | loss: 0.0012325
	speed: 0.0242s/iter; left time: 699.1886s
	iters: 300, epoch: 39 | loss: 0.0095431
	speed: 0.0238s/iter; left time: 684.6827s
	iters: 400, epoch: 39 | loss: 0.0011126
	speed: 0.0264s/iter; left time: 756.7448s
Epoch: 39 cost time: 11.728832006454468
Epoch: 39, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0076717
	speed: 0.1175s/iter; left time: 3350.9179s
	iters: 200, epoch: 40 | loss: 0.0415214
	speed: 0.0242s/iter; left time: 687.1190s
	iters: 300, epoch: 40 | loss: 0.0007808
	speed: 0.0247s/iter; left time: 700.5409s
	iters: 400, epoch: 40 | loss: 0.0213084
	speed: 0.0228s/iter; left time: 643.8022s
Epoch: 40 cost time: 11.556983232498169
Epoch: 40, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.98084619782733
model parameter : 13538
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7462811
	speed: 0.0415s/iter; left time: 1940.9462s
	iters: 200, epoch: 1 | loss: 1.0237710
	speed: 0.0239s/iter; left time: 1114.1040s
	iters: 300, epoch: 1 | loss: 0.9162652
	speed: 0.0247s/iter; left time: 1150.4779s
	iters: 400, epoch: 1 | loss: 0.7092348
	speed: 0.0248s/iter; left time: 1154.4156s
Epoch: 1 cost time: 13.047148704528809
Epoch: 1, Steps: 469 | Train Loss: 1.178 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
Validation loss decreased (inf --> -0.822178).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2650308
	speed: 0.1193s/iter; left time: 5527.7181s
	iters: 200, epoch: 2 | loss: 0.2700245
	speed: 0.0246s/iter; left time: 1135.2489s
	iters: 300, epoch: 2 | loss: 0.3412586
	speed: 0.0255s/iter; left time: 1176.2872s
	iters: 400, epoch: 2 | loss: 0.1629701
	speed: 0.0230s/iter; left time: 1058.9021s
Epoch: 2 cost time: 11.507833242416382
Epoch: 2, Steps: 469 | Train Loss: 0.364 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
Validation loss decreased (-0.822178 --> -0.905943).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1641747
	speed: 0.1230s/iter; left time: 5641.2338s
	iters: 200, epoch: 3 | loss: 0.4111778
	speed: 0.0259s/iter; left time: 1183.2850s
	iters: 300, epoch: 3 | loss: 0.3953339
	speed: 0.0241s/iter; left time: 1098.8715s
	iters: 400, epoch: 3 | loss: 0.4520755
	speed: 0.0219s/iter; left time: 995.8605s
Epoch: 3 cost time: 11.694590330123901
Epoch: 3, Steps: 469 | Train Loss: 0.217 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
Validation loss decreased (-0.905943 --> -0.937962).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7118591
	speed: 0.1289s/iter; left time: 5850.6445s
	iters: 200, epoch: 4 | loss: 0.1398733
	speed: 0.0230s/iter; left time: 1043.0331s
	iters: 300, epoch: 4 | loss: 0.1860415
	speed: 0.0215s/iter; left time: 972.5686s
	iters: 400, epoch: 4 | loss: 0.0720791
	speed: 0.0220s/iter; left time: 991.3618s
Epoch: 4 cost time: 11.023229360580444
Epoch: 4, Steps: 469 | Train Loss: 0.167 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.937962 --> -0.949684).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0781699
	speed: 0.1250s/iter; left time: 5614.1604s
	iters: 200, epoch: 5 | loss: 0.0477065
	speed: 0.0235s/iter; left time: 1051.3009s
	iters: 300, epoch: 5 | loss: 0.1632310
	speed: 0.0235s/iter; left time: 1050.5386s
	iters: 400, epoch: 5 | loss: 0.0219979
	speed: 0.0231s/iter; left time: 1030.2803s
Epoch: 5 cost time: 11.294946432113647
Epoch: 5, Steps: 469 | Train Loss: 0.139 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.949684 --> -0.962834).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2106235
	speed: 0.1315s/iter; left time: 5846.5609s
	iters: 200, epoch: 6 | loss: 0.0402021
	speed: 0.0210s/iter; left time: 933.2696s
	iters: 300, epoch: 6 | loss: 0.0191378
	speed: 0.0217s/iter; left time: 960.9619s
	iters: 400, epoch: 6 | loss: 0.0222764
	speed: 0.0221s/iter; left time: 977.6305s
Epoch: 6 cost time: 10.74545693397522
Epoch: 6, Steps: 469 | Train Loss: 0.125 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
Validation loss decreased (-0.962834 --> -0.964264).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0511402
	speed: 0.1208s/iter; left time: 5314.7179s
	iters: 200, epoch: 7 | loss: 0.0472401
	speed: 0.0214s/iter; left time: 937.3472s
	iters: 300, epoch: 7 | loss: 0.1580356
	speed: 0.0218s/iter; left time: 956.5274s
	iters: 400, epoch: 7 | loss: 0.0335247
	speed: 0.0243s/iter; left time: 1061.3551s
Epoch: 7 cost time: 10.882179737091064
Epoch: 7, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
Validation loss decreased (-0.964264 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0266114
	speed: 0.1211s/iter; left time: 5269.4515s
	iters: 200, epoch: 8 | loss: 0.1747292
	speed: 0.0221s/iter; left time: 961.3063s
	iters: 300, epoch: 8 | loss: 0.0381784
	speed: 0.0231s/iter; left time: 1001.9412s
	iters: 400, epoch: 8 | loss: 0.0061211
	speed: 0.0244s/iter; left time: 1052.4195s
Epoch: 8 cost time: 11.27398681640625
Epoch: 8, Steps: 469 | Train Loss: 0.098 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0453892
	speed: 0.1168s/iter; left time: 5029.8435s
	iters: 200, epoch: 9 | loss: 0.0046517
	speed: 0.0234s/iter; left time: 1006.1966s
	iters: 300, epoch: 9 | loss: 0.1064163
	speed: 0.0244s/iter; left time: 1044.6393s
	iters: 400, epoch: 9 | loss: 0.0040830
	speed: 0.0232s/iter; left time: 990.0290s
Epoch: 9 cost time: 11.252028226852417
Epoch: 9, Steps: 469 | Train Loss: 0.091 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969410 --> -0.973126).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0435364
	speed: 0.1242s/iter; left time: 5287.2241s
	iters: 200, epoch: 10 | loss: 0.0121124
	speed: 0.0250s/iter; left time: 1060.1614s
	iters: 300, epoch: 10 | loss: 0.0482201
	speed: 0.0249s/iter; left time: 1053.7761s
	iters: 400, epoch: 10 | loss: 0.0071771
	speed: 0.0248s/iter; left time: 1048.0047s
Epoch: 10 cost time: 11.865194320678711
Epoch: 10, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0040220
	speed: 0.1250s/iter; left time: 5262.4890s
	iters: 200, epoch: 11 | loss: 0.0037087
	speed: 0.0252s/iter; left time: 1060.2672s
	iters: 300, epoch: 11 | loss: 0.1031525
	speed: 0.0254s/iter; left time: 1062.9758s
	iters: 400, epoch: 11 | loss: 0.2089138
	speed: 0.0237s/iter; left time: 992.0203s
Epoch: 11 cost time: 11.979278087615967
Epoch: 11, Steps: 469 | Train Loss: 0.083 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0143219
	speed: 0.1159s/iter; left time: 4828.1552s
	iters: 200, epoch: 12 | loss: 0.0339845
	speed: 0.0239s/iter; left time: 993.2896s
	iters: 300, epoch: 12 | loss: 0.1938190
	speed: 0.0256s/iter; left time: 1060.5716s
	iters: 400, epoch: 12 | loss: 0.0463682
	speed: 0.0239s/iter; left time: 987.4127s
Epoch: 12 cost time: 11.821027517318726
Epoch: 12, Steps: 469 | Train Loss: 0.076 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.973126 --> -0.973698).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0206636
	speed: 0.1240s/iter; left time: 5104.4301s
	iters: 200, epoch: 13 | loss: 0.0642202
	speed: 0.0246s/iter; left time: 1011.1101s
	iters: 300, epoch: 13 | loss: 0.0251179
	speed: 0.0235s/iter; left time: 963.6350s
	iters: 400, epoch: 13 | loss: 0.2549642
	speed: 0.0221s/iter; left time: 904.6916s
Epoch: 13 cost time: 11.248714447021484
Epoch: 13, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0117403
	speed: 0.1224s/iter; left time: 4982.9094s
	iters: 200, epoch: 14 | loss: 0.0861509
	speed: 0.0226s/iter; left time: 916.9295s
	iters: 300, epoch: 14 | loss: 0.0665618
	speed: 0.0230s/iter; left time: 933.1548s
	iters: 400, epoch: 14 | loss: 0.0301560
	speed: 0.0222s/iter; left time: 896.8720s
Epoch: 14 cost time: 11.143162250518799
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0116195
	speed: 0.1316s/iter; left time: 5293.2763s
	iters: 200, epoch: 15 | loss: 0.0109591
	speed: 0.0226s/iter; left time: 905.1062s
	iters: 300, epoch: 15 | loss: 0.0200006
	speed: 0.0216s/iter; left time: 865.2082s
	iters: 400, epoch: 15 | loss: 0.0739144
	speed: 0.0231s/iter; left time: 923.1841s
Epoch: 15 cost time: 11.246583461761475
Epoch: 15, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.973698 --> -0.975699).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.2252646
	speed: 0.1309s/iter; left time: 5204.5275s
	iters: 200, epoch: 16 | loss: 0.0025652
	speed: 0.0226s/iter; left time: 897.0268s
	iters: 300, epoch: 16 | loss: 0.0310778
	speed: 0.0218s/iter; left time: 861.5220s
	iters: 400, epoch: 16 | loss: 0.0113175
	speed: 0.0226s/iter; left time: 892.4653s
Epoch: 16 cost time: 11.013089418411255
Epoch: 16, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0230304
	speed: 0.1206s/iter; left time: 4739.4451s
	iters: 200, epoch: 17 | loss: 0.0555331
	speed: 0.0218s/iter; left time: 853.3135s
	iters: 300, epoch: 17 | loss: 0.0046991
	speed: 0.0242s/iter; left time: 947.0636s
	iters: 400, epoch: 17 | loss: 0.3994764
	speed: 0.0242s/iter; left time: 943.2651s
Epoch: 17 cost time: 11.222774982452393
Epoch: 17, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0015806
	speed: 0.1221s/iter; left time: 4741.8486s
	iters: 200, epoch: 18 | loss: 0.1752784
	speed: 0.0247s/iter; left time: 955.2045s
	iters: 300, epoch: 18 | loss: 0.0043749
	speed: 0.0250s/iter; left time: 967.1000s
	iters: 400, epoch: 18 | loss: 0.0740038
	speed: 0.0254s/iter; left time: 978.8770s
Epoch: 18 cost time: 11.964273691177368
Epoch: 18, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0127245
	speed: 0.1142s/iter; left time: 4379.6831s
	iters: 200, epoch: 19 | loss: 0.0151805
	speed: 0.0208s/iter; left time: 795.1517s
	iters: 300, epoch: 19 | loss: 0.0016832
	speed: 0.0214s/iter; left time: 817.9619s
	iters: 400, epoch: 19 | loss: 0.1407711
	speed: 0.0217s/iter; left time: 826.0706s
Epoch: 19 cost time: 10.221054315567017
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0023453
	speed: 0.1226s/iter; left time: 4644.8472s
	iters: 200, epoch: 20 | loss: 0.0037706
	speed: 0.0225s/iter; left time: 849.6888s
	iters: 300, epoch: 20 | loss: 0.0047061
	speed: 0.0231s/iter; left time: 871.4669s
	iters: 400, epoch: 20 | loss: 0.0381652
	speed: 0.0225s/iter; left time: 844.1864s
Epoch: 20 cost time: 11.224853277206421
Epoch: 20, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.977415).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0055512
	speed: 0.1260s/iter; left time: 4713.9525s
	iters: 200, epoch: 21 | loss: 0.0126889
	speed: 0.0200s/iter; left time: 745.5718s
	iters: 300, epoch: 21 | loss: 0.0083803
	speed: 0.0222s/iter; left time: 826.4647s
	iters: 400, epoch: 21 | loss: 0.4550175
	speed: 0.0213s/iter; left time: 789.5020s
Epoch: 21 cost time: 10.5915207862854
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 22 | loss: 0.0428776
	speed: 0.1205s/iter; left time: 4454.1222s
	iters: 200, epoch: 22 | loss: 0.0007925
	speed: 0.0209s/iter; left time: 771.3792s
	iters: 300, epoch: 22 | loss: 0.0483699
	speed: 0.0208s/iter; left time: 765.3595s
	iters: 400, epoch: 22 | loss: 0.0541764
	speed: 0.0218s/iter; left time: 798.2771s
Epoch: 22 cost time: 10.638675928115845
Epoch: 22, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 23 | loss: 0.0028212
	speed: 0.1220s/iter; left time: 4451.9267s
	iters: 200, epoch: 23 | loss: 0.0659682
	speed: 0.0210s/iter; left time: 764.3873s
	iters: 300, epoch: 23 | loss: 0.0223816
	speed: 0.0218s/iter; left time: 792.0898s
	iters: 400, epoch: 23 | loss: 0.0041278
	speed: 0.0231s/iter; left time: 837.5686s
Epoch: 23 cost time: 10.910875082015991
Epoch: 23, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 24 | loss: 0.0571333
	speed: 0.1214s/iter; left time: 4371.4963s
	iters: 200, epoch: 24 | loss: 0.0688674
	speed: 0.0222s/iter; left time: 797.8033s
	iters: 300, epoch: 24 | loss: 0.0075130
	speed: 0.0235s/iter; left time: 843.3307s
	iters: 400, epoch: 24 | loss: 0.0068120
	speed: 0.0237s/iter; left time: 845.2334s
Epoch: 24 cost time: 11.241858720779419
Epoch: 24, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 25 | loss: 0.0648294
	speed: 0.1253s/iter; left time: 4453.6782s
	iters: 200, epoch: 25 | loss: 0.0005156
	speed: 0.0205s/iter; left time: 727.0139s
	iters: 300, epoch: 25 | loss: 0.0231498
	speed: 0.0235s/iter; left time: 832.3650s
	iters: 400, epoch: 25 | loss: 0.0159965
	speed: 0.0227s/iter; left time: 801.7871s
Epoch: 25 cost time: 10.950299501419067
Epoch: 25, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 26 | loss: 0.0046549
	speed: 0.1220s/iter; left time: 4279.8072s
	iters: 200, epoch: 26 | loss: 0.0016124
	speed: 0.0214s/iter; left time: 750.1013s
	iters: 300, epoch: 26 | loss: 0.0057825
	speed: 0.0212s/iter; left time: 740.7358s
	iters: 400, epoch: 26 | loss: 0.1586851
	speed: 0.0221s/iter; left time: 766.8301s
Epoch: 26 cost time: 10.706775903701782
Epoch: 26, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 27 | loss: 0.0098894
	speed: 0.1158s/iter; left time: 4006.1929s
	iters: 200, epoch: 27 | loss: 0.0821724
	speed: 0.0235s/iter; left time: 809.5173s
	iters: 300, epoch: 27 | loss: 0.0913057
	speed: 0.0233s/iter; left time: 801.6216s
	iters: 400, epoch: 27 | loss: 0.0119649
	speed: 0.0238s/iter; left time: 815.8194s
Epoch: 27 cost time: 11.175748586654663
Epoch: 27, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 28 | loss: 0.0158762
	speed: 0.1194s/iter; left time: 4075.4857s
	iters: 200, epoch: 28 | loss: 0.0299467
	speed: 0.0236s/iter; left time: 804.5421s
	iters: 300, epoch: 28 | loss: 0.1195645
	speed: 0.0239s/iter; left time: 809.9233s
	iters: 400, epoch: 28 | loss: 0.2655278
	speed: 0.0240s/iter; left time: 810.4645s
Epoch: 28 cost time: 11.467216491699219
Epoch: 28, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 29 | loss: 0.0376144
	speed: 0.1158s/iter; left time: 3898.3970s
	iters: 200, epoch: 29 | loss: 0.0136021
	speed: 0.0233s/iter; left time: 780.6575s
	iters: 300, epoch: 29 | loss: 0.0139619
	speed: 0.0240s/iter; left time: 804.0376s
	iters: 400, epoch: 29 | loss: 0.2273785
	speed: 0.0212s/iter; left time: 706.5318s
Epoch: 29 cost time: 11.032010316848755
Epoch: 29, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 30 | loss: 0.0034319
	speed: 0.1240s/iter; left time: 4118.2294s
	iters: 200, epoch: 30 | loss: 0.0221629
	speed: 0.0235s/iter; left time: 777.2062s
	iters: 300, epoch: 30 | loss: 0.0254028
	speed: 0.0218s/iter; left time: 718.0387s
	iters: 400, epoch: 30 | loss: 0.0191772
	speed: 0.0218s/iter; left time: 717.1055s
Epoch: 30 cost time: 10.82256555557251
Epoch: 30, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
Validation loss decreased (-0.977415 --> -0.979130).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0005707
	speed: 0.1257s/iter; left time: 4113.4870s
	iters: 200, epoch: 31 | loss: 0.0248224
	speed: 0.0217s/iter; left time: 707.6553s
	iters: 300, epoch: 31 | loss: 0.1632611
	speed: 0.0211s/iter; left time: 687.7825s
	iters: 400, epoch: 31 | loss: 0.0102031
	speed: 0.0206s/iter; left time: 667.8475s
Epoch: 31 cost time: 10.68417477607727
Epoch: 31, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 32 | loss: 0.0154536
	speed: 0.1235s/iter; left time: 3984.3074s
	iters: 200, epoch: 32 | loss: 0.0034269
	speed: 0.0210s/iter; left time: 676.0767s
	iters: 300, epoch: 32 | loss: 0.0551455
	speed: 0.0205s/iter; left time: 658.6771s
	iters: 400, epoch: 32 | loss: 0.0015393
	speed: 0.0207s/iter; left time: 661.8983s
Epoch: 32 cost time: 10.59584093093872
Epoch: 32, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 33 | loss: 0.0034538
	speed: 0.1223s/iter; left time: 3887.6959s
	iters: 200, epoch: 33 | loss: 0.0040324
	speed: 0.0205s/iter; left time: 649.0612s
	iters: 300, epoch: 33 | loss: 0.0107671
	speed: 0.0213s/iter; left time: 673.3930s
	iters: 400, epoch: 33 | loss: 0.0246561
	speed: 0.0221s/iter; left time: 696.0843s
Epoch: 33 cost time: 10.529446363449097
Epoch: 33, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 34 | loss: 0.0014447
	speed: 0.1233s/iter; left time: 3863.7907s
	iters: 200, epoch: 34 | loss: 0.0029200
	speed: 0.0220s/iter; left time: 687.9433s
	iters: 300, epoch: 34 | loss: 0.0984047
	speed: 0.0217s/iter; left time: 675.6019s
	iters: 400, epoch: 34 | loss: 0.0039699
	speed: 0.0233s/iter; left time: 723.9600s
Epoch: 34 cost time: 10.95534873008728
Epoch: 34, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 35 | loss: 0.0046453
	speed: 0.1228s/iter; left time: 3788.7829s
	iters: 200, epoch: 35 | loss: 0.0015951
	speed: 0.0213s/iter; left time: 653.5528s
	iters: 300, epoch: 35 | loss: 0.0172385
	speed: 0.0228s/iter; left time: 697.9706s
	iters: 400, epoch: 35 | loss: 0.0107825
	speed: 0.0236s/iter; left time: 720.2201s
Epoch: 35 cost time: 10.884140729904175
Epoch: 35, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 36 | loss: 0.0002139
	speed: 0.1234s/iter; left time: 3749.2273s
	iters: 200, epoch: 36 | loss: 0.1213793
	speed: 0.0209s/iter; left time: 632.2413s
	iters: 300, epoch: 36 | loss: 0.0055234
	speed: 0.0238s/iter; left time: 719.5642s
	iters: 400, epoch: 36 | loss: 0.0134345
	speed: 0.0234s/iter; left time: 703.7679s
Epoch: 36 cost time: 11.02387547492981
Epoch: 36, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 37 | loss: 0.0021180
	speed: 0.1159s/iter; left time: 3466.6895s
	iters: 200, epoch: 37 | loss: 0.2836133
	speed: 0.0237s/iter; left time: 706.0376s
	iters: 300, epoch: 37 | loss: 0.0168390
	speed: 0.0244s/iter; left time: 724.8274s
	iters: 400, epoch: 37 | loss: 0.0037564
	speed: 0.0238s/iter; left time: 705.9084s
Epoch: 37 cost time: 11.486628293991089
Epoch: 37, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 38 | loss: 0.0265023
	speed: 0.1120s/iter; left time: 3298.7267s
	iters: 200, epoch: 38 | loss: 0.6540892
	speed: 0.0211s/iter; left time: 619.8030s
	iters: 300, epoch: 38 | loss: 0.1111806
	speed: 0.0200s/iter; left time: 584.4512s
	iters: 400, epoch: 38 | loss: 0.0009224
	speed: 0.0207s/iter; left time: 603.2722s
Epoch: 38 cost time: 10.045990943908691
Epoch: 38, Steps: 469 | Train Loss: 0.049 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 39 | loss: 0.0656743
	speed: 0.1219s/iter; left time: 3532.0141s
	iters: 200, epoch: 39 | loss: 0.0511799
	speed: 0.0251s/iter; left time: 723.8071s
	iters: 300, epoch: 39 | loss: 0.0167423
	speed: 0.0235s/iter; left time: 677.6084s
	iters: 400, epoch: 39 | loss: 0.0451408
	speed: 0.0244s/iter; left time: 698.8086s
Epoch: 39 cost time: 11.972579717636108
Epoch: 39, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 40 | loss: 0.0153268
	speed: 0.1339s/iter; left time: 3818.0075s
	iters: 200, epoch: 40 | loss: 0.0003560
	speed: 0.0229s/iter; left time: 649.4055s
	iters: 300, epoch: 40 | loss: 0.0045514
	speed: 0.0221s/iter; left time: 625.3976s
	iters: 400, epoch: 40 | loss: 0.0370155
	speed: 0.0216s/iter; left time: 608.3921s
Epoch: 40 cost time: 11.06931209564209
Epoch: 40, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 13538
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
Traceback (most recent call last):
  File "/home/yoom618/TSLib/run.py", line 282, in <module>
    exp.train(setting)
  File "/home/yoom618/TSLib/exp/exp_classification.py", line 111, in train
    outputs = self.model(batch_x, padding_mask, None, None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 108, in forward
    dec_out = self.classification(x_enc, x_mark_enc)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/models/ETSformer.py", line 82, in classification
    _, growths, seasons = self.encoder(res, x_enc, attn_mask=None)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 259, in forward
    res, level, growth, season = layer(res, level, attn_mask=None)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 231, in forward
    season = self._season_block(res)
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 245, in _season_block
    x = self.seasonal_layer(x)
        ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/.conda/envs/tslib/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 154, in forward
    x_freq, index_tuple = self.topk_freq(x_freq)
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/yoom618/TSLib/layers/ETSformer_EncDec.py", line 174, in topk_freq
    values, indices = torch.topk(x_freq.abs(), self.k, dim=1, largest=True, sorted=True)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: selected index k out of range
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.5984235
	speed: 0.0445s/iter; left time: 2082.3508s
	iters: 200, epoch: 1 | loss: 0.9990697
	speed: 0.0249s/iter; left time: 1160.9083s
	iters: 300, epoch: 1 | loss: 0.6341884
	speed: 0.0252s/iter; left time: 1174.9764s
	iters: 400, epoch: 1 | loss: 0.3785907
	speed: 0.0241s/iter; left time: 1122.8152s
Epoch: 1 cost time: 13.49644923210144
Epoch: 1, Steps: 469 | Train Loss: 1.061 Vali Loss: 0.526 Vali Acc: 0.840 Test Loss: 0.526 Test Acc: 0.840
Validation loss decreased (inf --> -0.840189).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1979164
	speed: 0.1246s/iter; left time: 5774.9355s
	iters: 200, epoch: 2 | loss: 0.4520218
	speed: 0.0255s/iter; left time: 1179.2034s
	iters: 300, epoch: 2 | loss: 0.2464160
	speed: 0.0232s/iter; left time: 1072.1237s
	iters: 400, epoch: 2 | loss: 0.1486957
	speed: 0.0229s/iter; left time: 1052.8979s
Epoch: 2 cost time: 11.576332092285156
Epoch: 2, Steps: 469 | Train Loss: 0.333 Vali Loss: 0.353 Vali Acc: 0.894 Test Loss: 0.353 Test Acc: 0.894
Validation loss decreased (-0.840189 --> -0.893650).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1783339
	speed: 0.1253s/iter; left time: 5745.7643s
	iters: 200, epoch: 3 | loss: 0.2159520
	speed: 0.0239s/iter; left time: 1093.2083s
	iters: 300, epoch: 3 | loss: 0.2742679
	speed: 0.0215s/iter; left time: 981.4965s
	iters: 400, epoch: 3 | loss: 0.1242184
	speed: 0.0219s/iter; left time: 1000.0668s
Epoch: 3 cost time: 11.342079162597656
Epoch: 3, Steps: 469 | Train Loss: 0.224 Vali Loss: 0.290 Vali Acc: 0.913 Test Loss: 0.290 Test Acc: 0.913
Validation loss decreased (-0.893650 --> -0.912804).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1179797
	speed: 0.1355s/iter; left time: 6149.3028s
	iters: 200, epoch: 4 | loss: 0.2805811
	speed: 0.0225s/iter; left time: 1020.9965s
	iters: 300, epoch: 4 | loss: 0.1287840
	speed: 0.0238s/iter; left time: 1077.5847s
	iters: 400, epoch: 4 | loss: 0.0463692
	speed: 0.0248s/iter; left time: 1116.5397s
Epoch: 4 cost time: 11.615680456161499
Epoch: 4, Steps: 469 | Train Loss: 0.169 Vali Loss: 0.234 Vali Acc: 0.942 Test Loss: 0.234 Test Acc: 0.942
Validation loss decreased (-0.912804 --> -0.942250).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0496929
	speed: 0.1367s/iter; left time: 6140.6972s
	iters: 200, epoch: 5 | loss: 0.2323698
	speed: 0.0218s/iter; left time: 976.2885s
	iters: 300, epoch: 5 | loss: 0.0524479
	speed: 0.0255s/iter; left time: 1140.0982s
	iters: 400, epoch: 5 | loss: 0.0227721
	speed: 0.0257s/iter; left time: 1146.4016s
Epoch: 5 cost time: 11.762775182723999
Epoch: 5, Steps: 469 | Train Loss: 0.137 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.942250 --> -0.953114).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2822637
	speed: 0.1307s/iter; left time: 5811.9511s
	iters: 200, epoch: 6 | loss: 0.1792726
	speed: 0.0270s/iter; left time: 1199.2501s
	iters: 300, epoch: 6 | loss: 0.0404287
	speed: 0.0261s/iter; left time: 1156.8302s
	iters: 400, epoch: 6 | loss: 0.0317779
	speed: 0.0258s/iter; left time: 1139.4098s
Epoch: 6 cost time: 12.510283470153809
Epoch: 6, Steps: 469 | Train Loss: 0.117 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1173711
	speed: 0.1284s/iter; left time: 5646.4721s
	iters: 200, epoch: 7 | loss: 0.0865981
	speed: 0.0259s/iter; left time: 1135.6192s
	iters: 300, epoch: 7 | loss: 0.1846306
	speed: 0.0251s/iter; left time: 1099.6428s
	iters: 400, epoch: 7 | loss: 0.1277322
	speed: 0.0231s/iter; left time: 1008.9772s
Epoch: 7 cost time: 11.885025024414062
Epoch: 7, Steps: 469 | Train Loss: 0.107 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0874134
	speed: 0.1213s/iter; left time: 5279.4273s
	iters: 200, epoch: 8 | loss: 0.0858139
	speed: 0.0258s/iter; left time: 1119.3666s
	iters: 300, epoch: 8 | loss: 0.0466763
	speed: 0.0239s/iter; left time: 1037.1312s
	iters: 400, epoch: 8 | loss: 0.1326837
	speed: 0.0226s/iter; left time: 974.6631s
Epoch: 8 cost time: 11.609765768051147
Epoch: 8, Steps: 469 | Train Loss: 0.094 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.953114 --> -0.962548).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0977272
	speed: 0.1309s/iter; left time: 5636.1732s
	iters: 200, epoch: 9 | loss: 0.0467856
	speed: 0.0231s/iter; left time: 993.8775s
	iters: 300, epoch: 9 | loss: 0.1900212
	speed: 0.0217s/iter; left time: 929.3830s
	iters: 400, epoch: 9 | loss: 0.0815235
	speed: 0.0228s/iter; left time: 973.3614s
Epoch: 9 cost time: 11.028845071792603
Epoch: 9, Steps: 469 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.1372672
	speed: 0.1313s/iter; left time: 5591.5397s
	iters: 200, epoch: 10 | loss: 0.0297310
	speed: 0.0218s/iter; left time: 924.4815s
	iters: 300, epoch: 10 | loss: 0.0480469
	speed: 0.0214s/iter; left time: 906.9200s
	iters: 400, epoch: 10 | loss: 0.0160702
	speed: 0.0226s/iter; left time: 955.7209s
Epoch: 10 cost time: 11.18151330947876
Epoch: 10, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.962548 --> -0.969410).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0070873
	speed: 0.1267s/iter; left time: 5335.8027s
	iters: 200, epoch: 11 | loss: 0.0128369
	speed: 0.0239s/iter; left time: 1001.9892s
	iters: 300, epoch: 11 | loss: 0.0409452
	speed: 0.0237s/iter; left time: 994.5231s
	iters: 400, epoch: 11 | loss: 0.0100076
	speed: 0.0252s/iter; left time: 1052.8361s
Epoch: 11 cost time: 11.6961088180542
Epoch: 11, Steps: 469 | Train Loss: 0.072 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0146460
	speed: 0.1284s/iter; left time: 5348.2862s
	iters: 200, epoch: 12 | loss: 0.1676230
	speed: 0.0240s/iter; left time: 995.2424s
	iters: 300, epoch: 12 | loss: 0.0717374
	speed: 0.0255s/iter; left time: 1058.6619s
	iters: 400, epoch: 12 | loss: 0.1051612
	speed: 0.0257s/iter; left time: 1061.5485s
Epoch: 12 cost time: 12.185433387756348
Epoch: 12, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0103020
	speed: 0.1300s/iter; left time: 5351.6980s
	iters: 200, epoch: 13 | loss: 0.0566244
	speed: 0.0254s/iter; left time: 1042.2997s
	iters: 300, epoch: 13 | loss: 0.0250831
	speed: 0.0260s/iter; left time: 1066.2788s
	iters: 400, epoch: 13 | loss: 0.0316060
	speed: 0.0261s/iter; left time: 1068.6894s
Epoch: 13 cost time: 12.349899768829346
Epoch: 13, Steps: 469 | Train Loss: 0.067 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0045527
	speed: 0.1299s/iter; left time: 5286.1874s
	iters: 200, epoch: 14 | loss: 0.0544912
	speed: 0.0259s/iter; left time: 1052.7135s
	iters: 300, epoch: 14 | loss: 0.0110629
	speed: 0.0257s/iter; left time: 1040.8505s
	iters: 400, epoch: 14 | loss: 0.0796067
	speed: 0.0257s/iter; left time: 1038.0836s
Epoch: 14 cost time: 12.271115779876709
Epoch: 14, Steps: 469 | Train Loss: 0.066 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0142952
	speed: 0.1304s/iter; left time: 5245.1188s
	iters: 200, epoch: 15 | loss: 0.0115311
	speed: 0.0272s/iter; left time: 1091.2385s
	iters: 300, epoch: 15 | loss: 0.0114775
	speed: 0.0240s/iter; left time: 960.2441s
	iters: 400, epoch: 15 | loss: 0.1326755
	speed: 0.0228s/iter; left time: 912.4511s
Epoch: 15 cost time: 11.915154933929443
Epoch: 15, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.969410 --> -0.975985).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0055655
	speed: 0.1296s/iter; left time: 5152.1284s
	iters: 200, epoch: 16 | loss: 0.0043823
	speed: 0.0232s/iter; left time: 919.4978s
	iters: 300, epoch: 16 | loss: 0.0205990
	speed: 0.0223s/iter; left time: 882.1218s
	iters: 400, epoch: 16 | loss: 0.0872492
	speed: 0.0222s/iter; left time: 874.2651s
Epoch: 16 cost time: 11.384900331497192
Epoch: 16, Steps: 469 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0170137
	speed: 0.1305s/iter; left time: 5128.4130s
	iters: 200, epoch: 17 | loss: 0.0118915
	speed: 0.0221s/iter; left time: 865.9437s
	iters: 300, epoch: 17 | loss: 0.3383805
	speed: 0.0235s/iter; left time: 919.4380s
	iters: 400, epoch: 17 | loss: 0.0409751
	speed: 0.0243s/iter; left time: 948.1526s
Epoch: 17 cost time: 11.34243631362915
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0076668
	speed: 0.1288s/iter; left time: 5001.7030s
	iters: 200, epoch: 18 | loss: 0.0045197
	speed: 0.0238s/iter; left time: 920.7359s
	iters: 300, epoch: 18 | loss: 0.0098772
	speed: 0.0257s/iter; left time: 991.7534s
	iters: 400, epoch: 18 | loss: 0.0407166
	speed: 0.0258s/iter; left time: 993.7887s
Epoch: 18 cost time: 12.138908624649048
Epoch: 18, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0268435
	speed: 0.1325s/iter; left time: 5082.2227s
	iters: 200, epoch: 19 | loss: 0.2134185
	speed: 0.0261s/iter; left time: 996.9274s
	iters: 300, epoch: 19 | loss: 0.0521826
	speed: 0.0258s/iter; left time: 984.9998s
	iters: 400, epoch: 19 | loss: 0.0063385
	speed: 0.0250s/iter; left time: 949.9268s
Epoch: 19 cost time: 12.286097526550293
Epoch: 19, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.975985 --> -0.976843).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0126552
	speed: 0.1342s/iter; left time: 5083.2369s
	iters: 200, epoch: 20 | loss: 0.0341482
	speed: 0.0261s/iter; left time: 984.5026s
	iters: 300, epoch: 20 | loss: 0.0627237
	speed: 0.0255s/iter; left time: 962.6372s
	iters: 400, epoch: 20 | loss: 0.0097753
	speed: 0.0259s/iter; left time: 975.2866s
Epoch: 20 cost time: 12.138575553894043
Epoch: 20, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0019649
	speed: 0.1264s/iter; left time: 4728.6811s
	iters: 200, epoch: 21 | loss: 0.0114540
	speed: 0.0250s/iter; left time: 934.2822s
	iters: 300, epoch: 21 | loss: 0.0034261
	speed: 0.0246s/iter; left time: 915.1150s
	iters: 400, epoch: 21 | loss: 0.0053724
	speed: 0.0239s/iter; left time: 886.7623s
Epoch: 21 cost time: 11.955763339996338
Epoch: 21, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.1281022
	speed: 0.1318s/iter; left time: 4871.1772s
	iters: 200, epoch: 22 | loss: 0.0468213
	speed: 0.0232s/iter; left time: 854.4570s
	iters: 300, epoch: 22 | loss: 0.3521397
	speed: 0.0224s/iter; left time: 823.3174s
	iters: 400, epoch: 22 | loss: 0.0360969
	speed: 0.0227s/iter; left time: 833.3970s
Epoch: 22 cost time: 11.506597995758057
Epoch: 22, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.976843 --> -0.979416).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0433073
	speed: 0.0988s/iter; left time: 3603.1636s
	iters: 200, epoch: 23 | loss: 0.0357953
	speed: 0.0196s/iter; left time: 711.3652s
	iters: 300, epoch: 23 | loss: 0.8949662
	speed: 0.0226s/iter; left time: 820.4211s
	iters: 400, epoch: 23 | loss: 0.0036126
	speed: 0.0260s/iter; left time: 939.9995s
Epoch: 23 cost time: 10.981140851974487
Epoch: 23, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.1247532
	speed: 0.1335s/iter; left time: 4806.8298s
	iters: 200, epoch: 24 | loss: 0.1752979
	speed: 0.0237s/iter; left time: 850.5206s
	iters: 300, epoch: 24 | loss: 0.0297355
	speed: 0.0263s/iter; left time: 940.8953s
	iters: 400, epoch: 24 | loss: 0.0545739
	speed: 0.0258s/iter; left time: 919.6427s
Epoch: 24 cost time: 12.376610517501831
Epoch: 24, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.0655759
	speed: 0.1252s/iter; left time: 4450.8897s
	iters: 200, epoch: 25 | loss: 0.0803669
	speed: 0.0245s/iter; left time: 867.2219s
	iters: 300, epoch: 25 | loss: 0.0009702
	speed: 0.0250s/iter; left time: 882.4875s
	iters: 400, epoch: 25 | loss: 0.0166691
	speed: 0.0246s/iter; left time: 867.6341s
Epoch: 25 cost time: 11.65877103805542
Epoch: 25, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.1852356
	speed: 0.1253s/iter; left time: 4394.6710s
	iters: 200, epoch: 26 | loss: 0.0053333
	speed: 0.0246s/iter; left time: 861.3662s
	iters: 300, epoch: 26 | loss: 0.3068036
	speed: 0.0248s/iter; left time: 866.3499s
	iters: 400, epoch: 26 | loss: 0.2575485
	speed: 0.0233s/iter; left time: 808.9218s
Epoch: 26 cost time: 11.620037078857422
Epoch: 26, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 27 | loss: 0.0495864
	speed: 0.1276s/iter; left time: 4414.3444s
	iters: 200, epoch: 27 | loss: 0.0198760
	speed: 0.0241s/iter; left time: 832.8717s
	iters: 300, epoch: 27 | loss: 0.0685275
	speed: 0.0224s/iter; left time: 770.0772s
	iters: 400, epoch: 27 | loss: 0.0174039
	speed: 0.0226s/iter; left time: 776.9991s
Epoch: 27 cost time: 11.200579166412354
Epoch: 27, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 28 | loss: 0.0057746
	speed: 0.1315s/iter; left time: 4488.8165s
	iters: 200, epoch: 28 | loss: 0.1312818
	speed: 0.0222s/iter; left time: 757.1030s
	iters: 300, epoch: 28 | loss: 0.0070480
	speed: 0.0226s/iter; left time: 767.4280s
	iters: 400, epoch: 28 | loss: 0.0087105
	speed: 0.0213s/iter; left time: 722.0786s
Epoch: 28 cost time: 11.23193621635437
Epoch: 28, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 29 | loss: 0.0070303
	speed: 0.1306s/iter; left time: 4398.3952s
	iters: 200, epoch: 29 | loss: 0.0022591
	speed: 0.0218s/iter; left time: 732.3244s
	iters: 300, epoch: 29 | loss: 0.0032780
	speed: 0.0219s/iter; left time: 734.5638s
	iters: 400, epoch: 29 | loss: 0.0102332
	speed: 0.0221s/iter; left time: 737.0767s
Epoch: 29 cost time: 10.987561464309692
Epoch: 29, Steps: 469 | Train Loss: 0.044 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 30 | loss: 0.0013461
	speed: 0.1289s/iter; left time: 4281.0653s
	iters: 200, epoch: 30 | loss: 0.1107754
	speed: 0.0185s/iter; left time: 610.8004s
	iters: 300, epoch: 30 | loss: 0.0223044
	speed: 0.0240s/iter; left time: 792.7107s
	iters: 400, epoch: 30 | loss: 0.0007401
	speed: 0.0256s/iter; left time: 842.4708s
Epoch: 30 cost time: 11.148226261138916
Epoch: 30, Steps: 469 | Train Loss: 0.039 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 31 | loss: 0.0145285
	speed: 0.1296s/iter; left time: 4241.3761s
	iters: 200, epoch: 31 | loss: 0.0566598
	speed: 0.0187s/iter; left time: 608.6701s
	iters: 300, epoch: 31 | loss: 0.0062946
	speed: 0.0189s/iter; left time: 613.9211s
	iters: 400, epoch: 31 | loss: 0.0350101
	speed: 0.0189s/iter; left time: 613.2636s
Epoch: 31 cost time: 9.24635624885559
Epoch: 31, Steps: 469 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 32 | loss: 0.0788026
	speed: 0.0970s/iter; left time: 3130.2810s
	iters: 200, epoch: 32 | loss: 0.0173679
	speed: 0.0174s/iter; left time: 559.5157s
	iters: 300, epoch: 32 | loss: 0.0132588
	speed: 0.0203s/iter; left time: 649.8526s
	iters: 400, epoch: 32 | loss: 0.0032251
	speed: 0.0239s/iter; left time: 762.7627s
Epoch: 32 cost time: 10.286203145980835
Epoch: 32, Steps: 469 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9794168096054888
model parameter : 9442
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.6784647
	speed: 0.0398s/iter; left time: 1863.5201s
	iters: 200, epoch: 1 | loss: 1.0113269
	speed: 0.0212s/iter; left time: 991.2373s
	iters: 300, epoch: 1 | loss: 0.6037076
	speed: 0.0246s/iter; left time: 1146.6328s
	iters: 400, epoch: 1 | loss: 0.3891368
	speed: 0.0234s/iter; left time: 1089.6742s
Epoch: 1 cost time: 12.64860200881958
Epoch: 1, Steps: 469 | Train Loss: 1.093 Vali Loss: 0.526 Vali Acc: 0.839 Test Loss: 0.526 Test Acc: 0.839
Validation loss decreased (inf --> -0.838760).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2197247
	speed: 0.1186s/iter; left time: 5495.3095s
	iters: 200, epoch: 2 | loss: 0.3985060
	speed: 0.0232s/iter; left time: 1071.6594s
	iters: 300, epoch: 2 | loss: 0.2549984
	speed: 0.0237s/iter; left time: 1093.3367s
	iters: 400, epoch: 2 | loss: 0.1397325
	speed: 0.0229s/iter; left time: 1054.9833s
Epoch: 2 cost time: 11.140236377716064
Epoch: 2, Steps: 469 | Train Loss: 0.344 Vali Loss: 0.343 Vali Acc: 0.901 Test Loss: 0.343 Test Acc: 0.901
Validation loss decreased (-0.838760 --> -0.900511).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1832219
	speed: 0.1253s/iter; left time: 5748.1358s
	iters: 200, epoch: 3 | loss: 0.1996655
	speed: 0.0242s/iter; left time: 1107.2347s
	iters: 300, epoch: 3 | loss: 0.1946764
	speed: 0.0242s/iter; left time: 1102.9350s
	iters: 400, epoch: 3 | loss: 0.1606697
	speed: 0.0242s/iter; left time: 1100.7391s
Epoch: 3 cost time: 11.482653141021729
Epoch: 3, Steps: 469 | Train Loss: 0.229 Vali Loss: 0.286 Vali Acc: 0.914 Test Loss: 0.286 Test Acc: 0.914
Validation loss decreased (-0.900511 --> -0.914234).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0786939
	speed: 0.1226s/iter; left time: 5564.3860s
	iters: 200, epoch: 4 | loss: 0.3171696
	speed: 0.0230s/iter; left time: 1043.0532s
	iters: 300, epoch: 4 | loss: 0.0904777
	speed: 0.0244s/iter; left time: 1103.7677s
	iters: 400, epoch: 4 | loss: 0.0827192
	speed: 0.0243s/iter; left time: 1093.9411s
Epoch: 4 cost time: 11.70641303062439
Epoch: 4, Steps: 469 | Train Loss: 0.178 Vali Loss: 0.232 Vali Acc: 0.943 Test Loss: 0.232 Test Acc: 0.943
Validation loss decreased (-0.914234 --> -0.943394).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0424971
	speed: 0.1213s/iter; left time: 5447.8482s
	iters: 200, epoch: 5 | loss: 0.2291830
	speed: 0.0241s/iter; left time: 1081.3854s
	iters: 300, epoch: 5 | loss: 0.0531940
	speed: 0.0238s/iter; left time: 1065.7591s
	iters: 400, epoch: 5 | loss: 0.0185700
	speed: 0.0227s/iter; left time: 1014.9134s
Epoch: 5 cost time: 11.287261962890625
Epoch: 5, Steps: 469 | Train Loss: 0.143 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
Validation loss decreased (-0.943394 --> -0.953686).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.2935542
	speed: 0.1165s/iter; left time: 5177.0949s
	iters: 200, epoch: 6 | loss: 0.1782928
	speed: 0.0239s/iter; left time: 1059.3510s
	iters: 300, epoch: 6 | loss: 0.0625760
	speed: 0.0239s/iter; left time: 1057.1344s
	iters: 400, epoch: 6 | loss: 0.0463975
	speed: 0.0237s/iter; left time: 1044.4680s
Epoch: 6 cost time: 11.463324308395386
Epoch: 6, Steps: 469 | Train Loss: 0.124 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1220476
	speed: 0.1172s/iter; left time: 5156.5455s
	iters: 200, epoch: 7 | loss: 0.0575820
	speed: 0.0263s/iter; left time: 1154.8582s
	iters: 300, epoch: 7 | loss: 0.0845113
	speed: 0.0247s/iter; left time: 1080.2260s
	iters: 400, epoch: 7 | loss: 0.1552064
	speed: 0.0235s/iter; left time: 1025.3330s
Epoch: 7 cost time: 11.790142059326172
Epoch: 7, Steps: 469 | Train Loss: 0.110 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
Validation loss decreased (-0.953686 --> -0.954544).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0785368
	speed: 0.1225s/iter; left time: 5332.6122s
	iters: 200, epoch: 8 | loss: 0.0346440
	speed: 0.0238s/iter; left time: 1033.4716s
	iters: 300, epoch: 8 | loss: 0.0586997
	speed: 0.0240s/iter; left time: 1037.7931s
	iters: 400, epoch: 8 | loss: 0.0906857
	speed: 0.0222s/iter; left time: 959.4952s
Epoch: 8 cost time: 11.321124076843262
Epoch: 8, Steps: 469 | Train Loss: 0.096 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
Validation loss decreased (-0.954544 --> -0.959690).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0733954
	speed: 0.1202s/iter; left time: 5174.1220s
	iters: 200, epoch: 9 | loss: 0.0326377
	speed: 0.0246s/iter; left time: 1056.4579s
	iters: 300, epoch: 9 | loss: 0.1298633
	speed: 0.0244s/iter; left time: 1044.6754s
	iters: 400, epoch: 9 | loss: 0.0559789
	speed: 0.0206s/iter; left time: 880.1716s
Epoch: 9 cost time: 11.181702613830566
Epoch: 9, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.959690 --> -0.961119).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0513416
	speed: 0.1187s/iter; left time: 5055.7174s
	iters: 200, epoch: 10 | loss: 0.0435498
	speed: 0.0237s/iter; left time: 1005.2937s
	iters: 300, epoch: 10 | loss: 0.0646865
	speed: 0.0226s/iter; left time: 955.9110s
	iters: 400, epoch: 10 | loss: 0.0128107
	speed: 0.0211s/iter; left time: 890.8924s
Epoch: 10 cost time: 10.90867018699646
Epoch: 10, Steps: 469 | Train Loss: 0.088 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
Validation loss decreased (-0.961119 --> -0.971983).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0081835
	speed: 0.1218s/iter; left time: 5129.3710s
	iters: 200, epoch: 11 | loss: 0.0288456
	speed: 0.0224s/iter; left time: 939.1040s
	iters: 300, epoch: 11 | loss: 0.0604856
	speed: 0.0225s/iter; left time: 941.3210s
	iters: 400, epoch: 11 | loss: 0.0045508
	speed: 0.0202s/iter; left time: 846.4665s
Epoch: 11 cost time: 10.714651107788086
Epoch: 11, Steps: 469 | Train Loss: 0.080 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0129535
	speed: 0.1233s/iter; left time: 5136.1766s
	iters: 200, epoch: 12 | loss: 0.2073610
	speed: 0.0206s/iter; left time: 854.6967s
	iters: 300, epoch: 12 | loss: 0.0463145
	speed: 0.0197s/iter; left time: 817.4911s
	iters: 400, epoch: 12 | loss: 0.1284238
	speed: 0.0216s/iter; left time: 893.8748s
Epoch: 12 cost time: 10.362690210342407
Epoch: 12, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0096642
	speed: 0.1241s/iter; left time: 5110.0479s
	iters: 200, epoch: 13 | loss: 0.0436402
	speed: 0.0212s/iter; left time: 870.8088s
	iters: 300, epoch: 13 | loss: 0.0343730
	speed: 0.0215s/iter; left time: 879.8345s
	iters: 400, epoch: 13 | loss: 0.0465263
	speed: 0.0211s/iter; left time: 860.7781s
Epoch: 13 cost time: 10.615902662277222
Epoch: 13, Steps: 469 | Train Loss: 0.073 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0023091
	speed: 0.1257s/iter; left time: 5118.3538s
	iters: 200, epoch: 14 | loss: 0.0705614
	speed: 0.0219s/iter; left time: 888.4232s
	iters: 300, epoch: 14 | loss: 0.0107795
	speed: 0.0206s/iter; left time: 835.1295s
	iters: 400, epoch: 14 | loss: 0.0362437
	speed: 0.0223s/iter; left time: 901.8403s
Epoch: 14 cost time: 10.67369818687439
Epoch: 14, Steps: 469 | Train Loss: 0.069 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0537507
	speed: 0.1244s/iter; left time: 5004.9727s
	iters: 200, epoch: 15 | loss: 0.0123684
	speed: 0.0224s/iter; left time: 900.1833s
	iters: 300, epoch: 15 | loss: 0.0247425
	speed: 0.0214s/iter; left time: 856.4145s
	iters: 400, epoch: 15 | loss: 0.0629778
	speed: 0.0224s/iter; left time: 894.3435s
Epoch: 15 cost time: 10.990305185317993
Epoch: 15, Steps: 469 | Train Loss: 0.070 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.971983 --> -0.976843).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0128642
	speed: 0.1254s/iter; left time: 4988.0485s
	iters: 200, epoch: 16 | loss: 0.0180665
	speed: 0.0223s/iter; left time: 885.5667s
	iters: 300, epoch: 16 | loss: 0.0100912
	speed: 0.0219s/iter; left time: 866.4431s
	iters: 400, epoch: 16 | loss: 0.0605319
	speed: 0.0232s/iter; left time: 916.5862s
Epoch: 16 cost time: 10.976333618164062
Epoch: 16, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0238610
	speed: 0.1213s/iter; left time: 4764.8015s
	iters: 200, epoch: 17 | loss: 0.0095576
	speed: 0.0218s/iter; left time: 854.0779s
	iters: 300, epoch: 17 | loss: 0.3022234
	speed: 0.0244s/iter; left time: 952.3372s
	iters: 400, epoch: 17 | loss: 0.0688199
	speed: 0.0233s/iter; left time: 906.8020s
Epoch: 17 cost time: 11.177862882614136
Epoch: 17, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0283903
	speed: 0.1231s/iter; left time: 4780.5405s
	iters: 200, epoch: 18 | loss: 0.0189120
	speed: 0.0222s/iter; left time: 861.4872s
	iters: 300, epoch: 18 | loss: 0.0061635
	speed: 0.0246s/iter; left time: 949.1997s
	iters: 400, epoch: 18 | loss: 0.0211317
	speed: 0.0230s/iter; left time: 885.1477s
Epoch: 18 cost time: 11.128446578979492
Epoch: 18, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0683879
	speed: 0.1235s/iter; left time: 4736.2666s
	iters: 200, epoch: 19 | loss: 0.1591901
	speed: 0.0206s/iter; left time: 787.5010s
	iters: 300, epoch: 19 | loss: 0.0234075
	speed: 0.0232s/iter; left time: 883.7905s
	iters: 400, epoch: 19 | loss: 0.0155833
	speed: 0.0225s/iter; left time: 854.8789s
Epoch: 19 cost time: 10.660839557647705
Epoch: 19, Steps: 469 | Train Loss: 0.059 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0164692
	speed: 0.1163s/iter; left time: 4405.0981s
	iters: 200, epoch: 20 | loss: 0.0837503
	speed: 0.0211s/iter; left time: 798.2581s
	iters: 300, epoch: 20 | loss: 0.0123123
	speed: 0.0226s/iter; left time: 851.3926s
	iters: 400, epoch: 20 | loss: 0.0211618
	speed: 0.0235s/iter; left time: 883.6135s
Epoch: 20 cost time: 10.957648754119873
Epoch: 20, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0052541
	speed: 0.1177s/iter; left time: 4406.0077s
	iters: 200, epoch: 21 | loss: 0.0089018
	speed: 0.0233s/iter; left time: 868.3416s
	iters: 300, epoch: 21 | loss: 0.0226546
	speed: 0.0232s/iter; left time: 863.8195s
	iters: 400, epoch: 21 | loss: 0.0065817
	speed: 0.0228s/iter; left time: 844.5844s
Epoch: 21 cost time: 11.032439947128296
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.2851238
	speed: 0.1206s/iter; left time: 4456.4932s
	iters: 200, epoch: 22 | loss: 0.0788560
	speed: 0.0235s/iter; left time: 866.4074s
	iters: 300, epoch: 22 | loss: 0.2839827
	speed: 0.0232s/iter; left time: 853.8938s
	iters: 400, epoch: 22 | loss: 0.0260650
	speed: 0.0221s/iter; left time: 810.8767s
Epoch: 22 cost time: 11.08057951927185
Epoch: 22, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.976843 --> -0.977701).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0200076
	speed: 0.1232s/iter; left time: 4494.0366s
	iters: 200, epoch: 23 | loss: 0.0132254
	speed: 0.0231s/iter; left time: 839.3670s
	iters: 300, epoch: 23 | loss: 0.8353399
	speed: 0.0238s/iter; left time: 863.0680s
	iters: 400, epoch: 23 | loss: 0.0083454
	speed: 0.0228s/iter; left time: 825.6375s
Epoch: 23 cost time: 11.06988000869751
Epoch: 23, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 24 | loss: 0.0512409
	speed: 0.1254s/iter; left time: 4515.5692s
	iters: 200, epoch: 24 | loss: 0.1596507
	speed: 0.0237s/iter; left time: 851.5991s
	iters: 300, epoch: 24 | loss: 0.1778964
	speed: 0.0238s/iter; left time: 854.0852s
	iters: 400, epoch: 24 | loss: 0.2312276
	speed: 0.0232s/iter; left time: 829.5337s
Epoch: 24 cost time: 11.401795387268066
Epoch: 24, Steps: 469 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 25 | loss: 0.1478665
	speed: 0.1190s/iter; left time: 4230.8773s
	iters: 200, epoch: 25 | loss: 0.1243533
	speed: 0.0252s/iter; left time: 891.6064s
	iters: 300, epoch: 25 | loss: 0.0019766
	speed: 0.0242s/iter; left time: 856.6330s
	iters: 400, epoch: 25 | loss: 0.0127269
	speed: 0.0245s/iter; left time: 862.5080s
Epoch: 25 cost time: 11.908181190490723
Epoch: 25, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 26 | loss: 0.0127117
	speed: 0.1197s/iter; left time: 4199.1539s
	iters: 200, epoch: 26 | loss: 0.0083436
	speed: 0.0257s/iter; left time: 898.7916s
	iters: 300, epoch: 26 | loss: 0.0787963
	speed: 0.0247s/iter; left time: 861.7421s
	iters: 400, epoch: 26 | loss: 0.7305527
	speed: 0.0245s/iter; left time: 852.6499s
Epoch: 26 cost time: 11.969711780548096
Epoch: 26, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.977701 --> -0.979130).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0129572
	speed: 0.1244s/iter; left time: 4304.0629s
	iters: 200, epoch: 27 | loss: 0.0055031
	speed: 0.0256s/iter; left time: 884.3311s
	iters: 300, epoch: 27 | loss: 0.0978569
	speed: 0.0227s/iter; left time: 782.3599s
	iters: 400, epoch: 27 | loss: 0.0105451
	speed: 0.0236s/iter; left time: 809.2529s
Epoch: 27 cost time: 11.657646417617798
Epoch: 27, Steps: 469 | Train Loss: 0.047 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0094311
	speed: 0.1253s/iter; left time: 4278.5402s
	iters: 200, epoch: 28 | loss: 0.2587860
	speed: 0.0242s/iter; left time: 823.1999s
	iters: 300, epoch: 28 | loss: 0.0474356
	speed: 0.0222s/iter; left time: 754.3945s
	iters: 400, epoch: 28 | loss: 0.0051971
	speed: 0.0226s/iter; left time: 766.0250s
Epoch: 28 cost time: 11.16591763496399
Epoch: 28, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0027282
	speed: 0.1308s/iter; left time: 4404.8144s
	iters: 200, epoch: 29 | loss: 0.0991246
	speed: 0.0240s/iter; left time: 804.6269s
	iters: 300, epoch: 29 | loss: 0.0035556
	speed: 0.0220s/iter; left time: 736.5466s
	iters: 400, epoch: 29 | loss: 0.0852305
	speed: 0.0213s/iter; left time: 710.9449s
Epoch: 29 cost time: 10.995343208312988
Epoch: 29, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0031550
	speed: 0.1067s/iter; left time: 3541.4278s
	iters: 200, epoch: 30 | loss: 0.3123969
	speed: 0.0193s/iter; left time: 638.8745s
	iters: 300, epoch: 30 | loss: 0.0954291
	speed: 0.0183s/iter; left time: 602.8596s
	iters: 400, epoch: 30 | loss: 0.0046949
	speed: 0.0199s/iter; left time: 655.7780s
Epoch: 30 cost time: 9.54622483253479
Epoch: 30, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0349857
	speed: 0.1196s/iter; left time: 3913.2382s
	iters: 200, epoch: 31 | loss: 0.0876780
	speed: 0.0215s/iter; left time: 701.6152s
	iters: 300, epoch: 31 | loss: 0.0061542
	speed: 0.0222s/iter; left time: 722.1477s
	iters: 400, epoch: 31 | loss: 0.0669822
	speed: 0.0227s/iter; left time: 734.5875s
Epoch: 31 cost time: 10.78661584854126
Epoch: 31, Steps: 469 | Train Loss: 0.040 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0820070
	speed: 0.1200s/iter; left time: 3871.5054s
	iters: 200, epoch: 32 | loss: 0.1679150
	speed: 0.0213s/iter; left time: 684.0984s
	iters: 300, epoch: 32 | loss: 0.0160955
	speed: 0.0210s/iter; left time: 673.7968s
	iters: 400, epoch: 32 | loss: 0.0006059
	speed: 0.0234s/iter; left time: 746.8836s
Epoch: 32 cost time: 10.824519872665405
Epoch: 32, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0087238
	speed: 0.1190s/iter; left time: 3782.1907s
	iters: 200, epoch: 33 | loss: 0.0037465
	speed: 0.0222s/iter; left time: 703.4771s
	iters: 300, epoch: 33 | loss: 0.0807934
	speed: 0.0225s/iter; left time: 710.2381s
	iters: 400, epoch: 33 | loss: 0.0117970
	speed: 0.0241s/iter; left time: 758.6555s
Epoch: 33 cost time: 11.152730703353882
Epoch: 33, Steps: 469 | Train Loss: 0.045 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0005481
	speed: 0.1260s/iter; left time: 3945.6006s
	iters: 200, epoch: 34 | loss: 0.0177574
	speed: 0.0230s/iter; left time: 719.6066s
	iters: 300, epoch: 34 | loss: 0.0822471
	speed: 0.0236s/iter; left time: 735.8155s
	iters: 400, epoch: 34 | loss: 0.0425659
	speed: 0.0247s/iter; left time: 767.6376s
Epoch: 34 cost time: 11.534564733505249
Epoch: 34, Steps: 469 | Train Loss: 0.043 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0020817
	speed: 0.1196s/iter; left time: 3690.0971s
	iters: 200, epoch: 35 | loss: 0.0325189
	speed: 0.0250s/iter; left time: 769.7525s
	iters: 300, epoch: 35 | loss: 0.0743678
	speed: 0.0257s/iter; left time: 786.5065s
	iters: 400, epoch: 35 | loss: 0.0182055
	speed: 0.0241s/iter; left time: 736.7185s
Epoch: 35 cost time: 11.854708433151245
Epoch: 35, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0004351
	speed: 0.1201s/iter; left time: 3648.7378s
	iters: 200, epoch: 36 | loss: 0.0007143
	speed: 0.0250s/iter; left time: 757.4148s
	iters: 300, epoch: 36 | loss: 0.0031012
	speed: 0.0245s/iter; left time: 738.7746s
	iters: 400, epoch: 36 | loss: 0.0020740
	speed: 0.0234s/iter; left time: 703.2616s
Epoch: 36 cost time: 11.627681970596313
Epoch: 36, Steps: 469 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9791309319611207
model parameter : 9442
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PenDigits       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PenDigits
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

7494
3498
>>>>>>>start training : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
7494
3498
3498
	iters: 100, epoch: 1 | loss: 1.7127513
	speed: 0.0408s/iter; left time: 1908.7084s
	iters: 200, epoch: 1 | loss: 1.1312383
	speed: 0.0231s/iter; left time: 1080.6632s
	iters: 300, epoch: 1 | loss: 0.7582280
	speed: 0.0218s/iter; left time: 1015.9216s
	iters: 400, epoch: 1 | loss: 0.3608028
	speed: 0.0213s/iter; left time: 991.5086s
Epoch: 1 cost time: 12.345617294311523
Epoch: 1, Steps: 469 | Train Loss: 1.166 Vali Loss: 0.529 Vali Acc: 0.847 Test Loss: 0.529 Test Acc: 0.847
Validation loss decreased (inf --> -0.847336).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2216139
	speed: 0.1181s/iter; left time: 5470.2874s
	iters: 200, epoch: 2 | loss: 0.3379179
	speed: 0.0222s/iter; left time: 1026.8505s
	iters: 300, epoch: 2 | loss: 0.2068432
	speed: 0.0222s/iter; left time: 1025.4536s
	iters: 400, epoch: 2 | loss: 0.1979622
	speed: 0.0212s/iter; left time: 975.9375s
Epoch: 2 cost time: 10.601267099380493
Epoch: 2, Steps: 469 | Train Loss: 0.346 Vali Loss: 0.292 Vali Acc: 0.915 Test Loss: 0.292 Test Acc: 0.915
Validation loss decreased (-0.847336 --> -0.915091).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1878145
	speed: 0.1102s/iter; left time: 5056.2742s
	iters: 200, epoch: 3 | loss: 0.1518400
	speed: 0.0208s/iter; left time: 954.1226s
	iters: 300, epoch: 3 | loss: 0.2213612
	speed: 0.0223s/iter; left time: 1019.6497s
	iters: 400, epoch: 3 | loss: 0.1357222
	speed: 0.0224s/iter; left time: 1022.3288s
Epoch: 3 cost time: 10.527767181396484
Epoch: 3, Steps: 469 | Train Loss: 0.218 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.915091 --> -0.930243).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0870193
	speed: 0.1097s/iter; left time: 4978.7369s
	iters: 200, epoch: 4 | loss: 0.3222815
	speed: 0.0220s/iter; left time: 997.4283s
	iters: 300, epoch: 4 | loss: 0.2004811
	speed: 0.0236s/iter; left time: 1065.2878s
	iters: 400, epoch: 4 | loss: 0.0374294
	speed: 0.0220s/iter; left time: 992.2183s
Epoch: 4 cost time: 10.842274904251099
Epoch: 4, Steps: 469 | Train Loss: 0.171 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.930243 --> -0.953114).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0372359
	speed: 0.1104s/iter; left time: 4959.2578s
	iters: 200, epoch: 5 | loss: 0.1757398
	speed: 0.0226s/iter; left time: 1013.5139s
	iters: 300, epoch: 5 | loss: 0.0520746
	speed: 0.0223s/iter; left time: 999.5950s
	iters: 400, epoch: 5 | loss: 0.0234094
	speed: 0.0222s/iter; left time: 988.7169s
Epoch: 5 cost time: 10.704790592193604
Epoch: 5, Steps: 469 | Train Loss: 0.144 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.953114 --> -0.961119).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.1963097
	speed: 0.1093s/iter; left time: 4857.6705s
	iters: 200, epoch: 6 | loss: 0.2852523
	speed: 0.0238s/iter; left time: 1054.8106s
	iters: 300, epoch: 6 | loss: 0.0280401
	speed: 0.0224s/iter; left time: 990.7602s
	iters: 400, epoch: 6 | loss: 0.0185537
	speed: 0.0229s/iter; left time: 1010.5580s
Epoch: 6 cost time: 11.043959617614746
Epoch: 6, Steps: 469 | Train Loss: 0.122 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.961119 --> -0.963406).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1393088
	speed: 0.1173s/iter; left time: 5157.4770s
	iters: 200, epoch: 7 | loss: 0.0797771
	speed: 0.0247s/iter; left time: 1085.6238s
	iters: 300, epoch: 7 | loss: 0.0229033
	speed: 0.0247s/iter; left time: 1082.5935s
	iters: 400, epoch: 7 | loss: 0.0135605
	speed: 0.0244s/iter; left time: 1066.6428s
Epoch: 7 cost time: 11.831271648406982
Epoch: 7, Steps: 469 | Train Loss: 0.106 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.963406 --> -0.969410).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0651300
	speed: 0.1182s/iter; left time: 5145.1086s
	iters: 200, epoch: 8 | loss: 0.1100232
	speed: 0.0233s/iter; left time: 1011.7276s
	iters: 300, epoch: 8 | loss: 0.0316684
	speed: 0.0234s/iter; left time: 1013.2767s
	iters: 400, epoch: 8 | loss: 0.0407073
	speed: 0.0225s/iter; left time: 971.1843s
Epoch: 8 cost time: 11.12878942489624
Epoch: 8, Steps: 469 | Train Loss: 0.095 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.1951359
	speed: 0.1142s/iter; left time: 4916.1457s
	iters: 200, epoch: 9 | loss: 0.0238417
	speed: 0.0230s/iter; left time: 988.0207s
	iters: 300, epoch: 9 | loss: 0.0323089
	speed: 0.0232s/iter; left time: 992.4414s
	iters: 400, epoch: 9 | loss: 0.1368094
	speed: 0.0211s/iter; left time: 903.6589s
Epoch: 9 cost time: 10.813106536865234
Epoch: 9, Steps: 469 | Train Loss: 0.089 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1287749
	speed: 0.1110s/iter; left time: 4726.6843s
	iters: 200, epoch: 10 | loss: 0.0383185
	speed: 0.0228s/iter; left time: 966.7254s
	iters: 300, epoch: 10 | loss: 0.0613468
	speed: 0.0223s/iter; left time: 945.1752s
	iters: 400, epoch: 10 | loss: 0.0120085
	speed: 0.0221s/iter; left time: 932.6140s
Epoch: 10 cost time: 10.815327167510986
Epoch: 10, Steps: 469 | Train Loss: 0.084 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
Validation loss decreased (-0.969410 --> -0.972269).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0105209
	speed: 0.1087s/iter; left time: 4578.8837s
	iters: 200, epoch: 11 | loss: 0.0217547
	speed: 0.0222s/iter; left time: 932.5286s
	iters: 300, epoch: 11 | loss: 0.0401693
	speed: 0.0222s/iter; left time: 929.8610s
	iters: 400, epoch: 11 | loss: 0.0088551
	speed: 0.0225s/iter; left time: 938.9883s
Epoch: 11 cost time: 10.773024559020996
Epoch: 11, Steps: 469 | Train Loss: 0.085 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0416652
	speed: 0.1126s/iter; left time: 4687.5385s
	iters: 200, epoch: 12 | loss: 0.1286054
	speed: 0.0232s/iter; left time: 961.9730s
	iters: 300, epoch: 12 | loss: 0.0416871
	speed: 0.0217s/iter; left time: 899.1351s
	iters: 400, epoch: 12 | loss: 0.0175245
	speed: 0.0225s/iter; left time: 931.8394s
Epoch: 12 cost time: 10.607401371002197
Epoch: 12, Steps: 469 | Train Loss: 0.078 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.1894837
	speed: 0.1115s/iter; left time: 4590.9760s
	iters: 200, epoch: 13 | loss: 0.0174995
	speed: 0.0198s/iter; left time: 814.9255s
	iters: 300, epoch: 13 | loss: 0.0131847
	speed: 0.0176s/iter; left time: 722.6691s
	iters: 400, epoch: 13 | loss: 0.0073378
	speed: 0.0185s/iter; left time: 755.0322s
Epoch: 13 cost time: 9.362104654312134
Epoch: 13, Steps: 469 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0057592
	speed: 0.0979s/iter; left time: 3984.9236s
	iters: 200, epoch: 14 | loss: 0.0884140
	speed: 0.0220s/iter; left time: 892.3727s
	iters: 300, epoch: 14 | loss: 0.0038900
	speed: 0.0216s/iter; left time: 873.2004s
	iters: 400, epoch: 14 | loss: 0.0667422
	speed: 0.0220s/iter; left time: 887.0061s
Epoch: 14 cost time: 10.558398008346558
Epoch: 14, Steps: 469 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0467089
	speed: 0.1101s/iter; left time: 4428.5722s
	iters: 200, epoch: 15 | loss: 0.0089859
	speed: 0.0230s/iter; left time: 921.8003s
	iters: 300, epoch: 15 | loss: 0.0090498
	speed: 0.0221s/iter; left time: 884.2729s
	iters: 400, epoch: 15 | loss: 0.1990560
	speed: 0.0225s/iter; left time: 897.6853s
Epoch: 15 cost time: 10.728281497955322
Epoch: 15, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.972269 --> -0.975699).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.1292998
	speed: 0.1131s/iter; left time: 4496.0152s
	iters: 200, epoch: 16 | loss: 0.0887622
	speed: 0.0224s/iter; left time: 888.2916s
	iters: 300, epoch: 16 | loss: 0.0146562
	speed: 0.0210s/iter; left time: 830.3839s
	iters: 400, epoch: 16 | loss: 0.0373133
	speed: 0.0225s/iter; left time: 889.7193s
Epoch: 16 cost time: 10.592257261276245
Epoch: 16, Steps: 469 | Train Loss: 0.075 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0161378
	speed: 0.1167s/iter; left time: 4585.9685s
	iters: 200, epoch: 17 | loss: 0.0459616
	speed: 0.0215s/iter; left time: 842.5493s
	iters: 300, epoch: 17 | loss: 0.1302022
	speed: 0.0215s/iter; left time: 842.3243s
	iters: 400, epoch: 17 | loss: 0.0354231
	speed: 0.0196s/iter; left time: 764.5144s
Epoch: 17 cost time: 10.163585662841797
Epoch: 17, Steps: 469 | Train Loss: 0.064 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0135108
	speed: 0.1166s/iter; left time: 4527.0853s
	iters: 200, epoch: 18 | loss: 0.0029924
	speed: 0.0219s/iter; left time: 848.5393s
	iters: 300, epoch: 18 | loss: 0.0102895
	speed: 0.0221s/iter; left time: 852.7829s
	iters: 400, epoch: 18 | loss: 0.0620988
	speed: 0.0214s/iter; left time: 824.8258s
Epoch: 18 cost time: 10.534936428070068
Epoch: 18, Steps: 469 | Train Loss: 0.063 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0011869
	speed: 0.1120s/iter; left time: 4296.3021s
	iters: 200, epoch: 19 | loss: 0.0193947
	speed: 0.0228s/iter; left time: 873.0169s
	iters: 300, epoch: 19 | loss: 0.0639152
	speed: 0.0233s/iter; left time: 887.6033s
	iters: 400, epoch: 19 | loss: 0.1105396
	speed: 0.0210s/iter; left time: 799.5470s
Epoch: 19 cost time: 10.779711961746216
Epoch: 19, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0753779
	speed: 0.1168s/iter; left time: 4425.2508s
	iters: 200, epoch: 20 | loss: 0.1379974
	speed: 0.0236s/iter; left time: 892.8186s
	iters: 300, epoch: 20 | loss: 0.0709129
	speed: 0.0212s/iter; left time: 799.5061s
	iters: 400, epoch: 20 | loss: 0.1125367
	speed: 0.0212s/iter; left time: 797.4912s
Epoch: 20 cost time: 10.938658475875854
Epoch: 20, Steps: 469 | Train Loss: 0.065 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0012123
	speed: 0.1176s/iter; left time: 4400.0071s
	iters: 200, epoch: 21 | loss: 0.0068369
	speed: 0.0200s/iter; left time: 745.7504s
	iters: 300, epoch: 21 | loss: 0.0083653
	speed: 0.0193s/iter; left time: 716.7330s
	iters: 400, epoch: 21 | loss: 0.0026804
	speed: 0.0202s/iter; left time: 750.3263s
Epoch: 21 cost time: 10.120408773422241
Epoch: 21, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.1910823
	speed: 0.1230s/iter; left time: 4544.1593s
	iters: 200, epoch: 22 | loss: 0.1556735
	speed: 0.0225s/iter; left time: 829.5798s
	iters: 300, epoch: 22 | loss: 0.3616900
	speed: 0.0211s/iter; left time: 776.9053s
	iters: 400, epoch: 22 | loss: 0.0312577
	speed: 0.0219s/iter; left time: 803.7285s
Epoch: 22 cost time: 10.681434392929077
Epoch: 22, Steps: 469 | Train Loss: 0.062 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0325061
	speed: 0.1248s/iter; left time: 4551.8843s
	iters: 200, epoch: 23 | loss: 0.0054784
	speed: 0.0214s/iter; left time: 777.2748s
	iters: 300, epoch: 23 | loss: 0.8791521
	speed: 0.0217s/iter; left time: 788.2350s
	iters: 400, epoch: 23 | loss: 0.0106763
	speed: 0.0211s/iter; left time: 763.4483s
Epoch: 23 cost time: 10.615872383117676
Epoch: 23, Steps: 469 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0041554
	speed: 0.1201s/iter; left time: 4323.8640s
	iters: 200, epoch: 24 | loss: 0.0198653
	speed: 0.0213s/iter; left time: 763.7342s
	iters: 300, epoch: 24 | loss: 0.0348041
	speed: 0.0228s/iter; left time: 815.9422s
	iters: 400, epoch: 24 | loss: 0.2992764
	speed: 0.0236s/iter; left time: 842.3030s
Epoch: 24 cost time: 10.990556478500366
Epoch: 24, Steps: 469 | Train Loss: 0.055 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.975699 --> -0.976557).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.1424986
	speed: 0.1188s/iter; left time: 4223.4942s
	iters: 200, epoch: 25 | loss: 0.1069446
	speed: 0.0215s/iter; left time: 763.7957s
	iters: 300, epoch: 25 | loss: 0.0086159
	speed: 0.0233s/iter; left time: 823.2430s
	iters: 400, epoch: 25 | loss: 0.0021582
	speed: 0.0230s/iter; left time: 809.0084s
Epoch: 25 cost time: 10.979686975479126
Epoch: 25, Steps: 469 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0127684
	speed: 0.1172s/iter; left time: 4109.3305s
	iters: 200, epoch: 26 | loss: 0.0097141
	speed: 0.0238s/iter; left time: 831.5352s
	iters: 300, epoch: 26 | loss: 0.4756612
	speed: 0.0234s/iter; left time: 815.0268s
	iters: 400, epoch: 26 | loss: 0.1823089
	speed: 0.0239s/iter; left time: 830.5355s
Epoch: 26 cost time: 11.349151849746704
Epoch: 26, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.976557 --> -0.978558).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0168694
	speed: 0.1177s/iter; left time: 4071.7023s
	iters: 200, epoch: 27 | loss: 0.0173246
	speed: 0.0229s/iter; left time: 788.6315s
	iters: 300, epoch: 27 | loss: 0.0237672
	speed: 0.0229s/iter; left time: 787.4598s
	iters: 400, epoch: 27 | loss: 0.0237733
	speed: 0.0230s/iter; left time: 790.2521s
Epoch: 27 cost time: 11.109318733215332
Epoch: 27, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0080643
	speed: 0.1152s/iter; left time: 3934.3677s
	iters: 200, epoch: 28 | loss: 0.0107172
	speed: 0.0216s/iter; left time: 736.1400s
	iters: 300, epoch: 28 | loss: 0.0581524
	speed: 0.0225s/iter; left time: 763.3144s
	iters: 400, epoch: 28 | loss: 0.0235346
	speed: 0.0228s/iter; left time: 772.0807s
Epoch: 28 cost time: 10.830735921859741
Epoch: 28, Steps: 469 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0054191
	speed: 0.1177s/iter; left time: 3963.2529s
	iters: 200, epoch: 29 | loss: 0.1432194
	speed: 0.0231s/iter; left time: 773.9009s
	iters: 300, epoch: 29 | loss: 0.0282069
	speed: 0.0245s/iter; left time: 818.9595s
	iters: 400, epoch: 29 | loss: 0.0021563
	speed: 0.0224s/iter; left time: 746.1019s
Epoch: 29 cost time: 11.24285340309143
Epoch: 29, Steps: 469 | Train Loss: 0.060 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0011317
	speed: 0.1192s/iter; left time: 3958.2415s
	iters: 200, epoch: 30 | loss: 0.0763447
	speed: 0.0224s/iter; left time: 743.0221s
	iters: 300, epoch: 30 | loss: 0.1083061
	speed: 0.0234s/iter; left time: 771.9706s
	iters: 400, epoch: 30 | loss: 0.0051743
	speed: 0.0230s/iter; left time: 755.6618s
Epoch: 30 cost time: 11.129682540893555
Epoch: 30, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0024603
	speed: 0.1189s/iter; left time: 3890.7821s
	iters: 200, epoch: 31 | loss: 0.0201036
	speed: 0.0226s/iter; left time: 735.9124s
	iters: 300, epoch: 31 | loss: 0.0963804
	speed: 0.0217s/iter; left time: 707.4413s
	iters: 400, epoch: 31 | loss: 0.0124669
	speed: 0.0222s/iter; left time: 721.2685s
Epoch: 31 cost time: 10.932236909866333
Epoch: 31, Steps: 469 | Train Loss: 0.057 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.4012413
	speed: 0.1254s/iter; left time: 4045.5072s
	iters: 200, epoch: 32 | loss: 0.0075414
	speed: 0.0224s/iter; left time: 721.0881s
	iters: 300, epoch: 32 | loss: 0.0218575
	speed: 0.0218s/iter; left time: 700.3588s
	iters: 400, epoch: 32 | loss: 0.0012748
	speed: 0.0215s/iter; left time: 685.6338s
Epoch: 32 cost time: 10.731405258178711
Epoch: 32, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0113995
	speed: 0.1208s/iter; left time: 3841.8392s
	iters: 200, epoch: 33 | loss: 0.0093523
	speed: 0.0213s/iter; left time: 676.0169s
	iters: 300, epoch: 33 | loss: 0.1320510
	speed: 0.0213s/iter; left time: 672.6434s
	iters: 400, epoch: 33 | loss: 0.0383802
	speed: 0.0211s/iter; left time: 663.3585s
Epoch: 33 cost time: 10.73436427116394
Epoch: 33, Steps: 469 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0006923
	speed: 0.1196s/iter; left time: 3745.9141s
	iters: 200, epoch: 34 | loss: 0.0024668
	speed: 0.0219s/iter; left time: 685.0051s
	iters: 300, epoch: 34 | loss: 0.1992603
	speed: 0.0216s/iter; left time: 672.6732s
	iters: 400, epoch: 34 | loss: 0.0098262
	speed: 0.0234s/iter; left time: 727.2476s
Epoch: 34 cost time: 11.039232730865479
Epoch: 34, Steps: 469 | Train Loss: 0.046 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0008533
	speed: 0.1188s/iter; left time: 3666.5407s
	iters: 200, epoch: 35 | loss: 0.1011015
	speed: 0.0218s/iter; left time: 671.2730s
	iters: 300, epoch: 35 | loss: 0.0087532
	speed: 0.0240s/iter; left time: 735.3042s
	iters: 400, epoch: 35 | loss: 0.0014552
	speed: 0.0242s/iter; left time: 738.1481s
Epoch: 35 cost time: 11.18773865699768
Epoch: 35, Steps: 469 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0003316
	speed: 0.1164s/iter; left time: 3536.8055s
	iters: 200, epoch: 36 | loss: 0.0015588
	speed: 0.0235s/iter; left time: 710.5888s
	iters: 300, epoch: 36 | loss: 0.3684129
	speed: 0.0236s/iter; left time: 711.8678s
	iters: 400, epoch: 36 | loss: 0.3376095
	speed: 0.0231s/iter; left time: 693.6901s
Epoch: 36 cost time: 11.119720220565796
Epoch: 36, Steps: 469 | Train Loss: 0.052 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PenDigits_ETSformer_UEA_ftM_sl8_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
3498
test shape: torch.Size([3498, 10]) torch.Size([3498, 1])
accuracy:0.9785591766723842
model parameter : 9442
model size : 0.66MB
