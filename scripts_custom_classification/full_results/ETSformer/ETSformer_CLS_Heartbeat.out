Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.095993995666504
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.681 Vali Acc: 0.741 Test Loss: 0.681 Test Acc: 0.741
Validation loss decreased (inf --> -0.741457).  Saving model ...
Epoch: 2 cost time: 2.556293249130249
Epoch: 2, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.975 Vali Acc: 0.722 Test Loss: 0.975 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.439436435699463
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.673 Vali Acc: 0.756 Test Loss: 0.673 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 2.462829351425171
Epoch: 4, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.069 Vali Acc: 0.454 Test Loss: 1.069 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5304322242736816
Epoch: 5, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.020 Vali Acc: 0.732 Test Loss: 1.020 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.569976806640625
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.862 Vali Acc: 0.732 Test Loss: 0.862 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5290064811706543
Epoch: 7, Steps: 13 | Train Loss: 0.380 Vali Loss: 1.592 Vali Acc: 0.576 Test Loss: 1.592 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4020135402679443
Epoch: 8, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.269 Vali Acc: 0.737 Test Loss: 1.269 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.273343801498413
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.292 Vali Acc: 0.737 Test Loss: 1.292 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4327871799468994
Epoch: 10, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.665 Vali Acc: 0.751 Test Loss: 1.665 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4286091327667236
Epoch: 11, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.406 Vali Acc: 0.673 Test Loss: 1.406 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.248303174972534
Epoch: 12, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.481 Vali Acc: 0.732 Test Loss: 1.481 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.297539234161377
Epoch: 13, Steps: 13 | Train Loss: 0.054 Vali Loss: 1.585 Vali Acc: 0.741 Test Loss: 1.585 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 5886986
model size : 32.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.878000259399414
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.646 Vali Acc: 0.751 Test Loss: 0.646 Test Acc: 0.751
Validation loss decreased (inf --> -0.751213).  Saving model ...
Epoch: 2 cost time: 2.341376543045044
Epoch: 2, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3158395290374756
Epoch: 3, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.346832513809204
Epoch: 4, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.690 Vali Acc: 0.698 Test Loss: 0.690 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4586126804351807
Epoch: 5, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.943 Vali Acc: 0.605 Test Loss: 0.943 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3746137619018555
Epoch: 6, Steps: 13 | Train Loss: 0.194 Vali Loss: 1.128 Vali Acc: 0.717 Test Loss: 1.128 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.437178611755371
Epoch: 7, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.125 Vali Acc: 0.639 Test Loss: 1.125 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5141372680664062
Epoch: 8, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.811 Vali Acc: 0.727 Test Loss: 1.811 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.417900800704956
Epoch: 9, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.309 Vali Acc: 0.585 Test Loss: 1.309 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.831820249557495
Epoch: 10, Steps: 13 | Train Loss: 0.145 Vali Loss: 2.290 Vali Acc: 0.727 Test Loss: 2.290 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.850393295288086
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.907 Vali Acc: 0.722 Test Loss: 1.907 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5886986
model size : 32.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.149723529815674
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3023428916931152
Epoch: 2, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.4960339069366455
Epoch: 3, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.614 Vali Acc: 0.746 Test Loss: 0.614 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.417491912841797
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.675 Vali Acc: 0.683 Test Loss: 0.675 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3979194164276123
Epoch: 5, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.800 Vali Acc: 0.634 Test Loss: 0.800 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2078778743743896
Epoch: 6, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.715 Vali Acc: 0.678 Test Loss: 0.715 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1059465408325195
Epoch: 7, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.245 Vali Acc: 0.561 Test Loss: 1.245 Test Acc: 0.561
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.255483627319336
Epoch: 8, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.410 Vali Acc: 0.737 Test Loss: 1.410 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.382746696472168
Epoch: 9, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.109 Vali Acc: 0.717 Test Loss: 1.109 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.167428970336914
Epoch: 10, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.907 Vali Acc: 0.741 Test Loss: 1.907 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.162771463394165
Epoch: 11, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.901 Vali Acc: 0.737 Test Loss: 1.901 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.121428966522217
Epoch: 12, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.123 Vali Acc: 0.722 Test Loss: 2.123 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5886986
model size : 32.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6201555728912354
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 2.138341188430786
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.590 Vali Acc: 0.741 Test Loss: 0.590 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1812400817871094
Epoch: 3, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0642330646514893
Epoch: 4, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.1781058311462402
Epoch: 5, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.814 Vali Acc: 0.561 Test Loss: 0.814 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.1786370277404785
Epoch: 6, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.029 Vali Acc: 0.746 Test Loss: 1.029 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.1059188842773438
Epoch: 7, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.960 Vali Acc: 0.615 Test Loss: 0.960 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.1508710384368896
Epoch: 8, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.867 Vali Acc: 0.751 Test Loss: 0.867 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.24468994140625
Epoch: 9, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.834 Vali Acc: 0.737 Test Loss: 1.834 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.27561616897583
Epoch: 10, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.234 Vali Acc: 0.722 Test Loss: 1.234 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.301927089691162
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 2.516 Vali Acc: 0.727 Test Loss: 2.516 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 5886986
model size : 32.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.188250541687012
Epoch: 1, Steps: 13 | Train Loss: 0.795 Vali Loss: 0.766 Vali Acc: 0.717 Test Loss: 0.766 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.6622986793518066
Epoch: 2, Steps: 13 | Train Loss: 0.741 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
Validation loss decreased (-0.717066 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.7636311054229736
Epoch: 3, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5976696014404297
Epoch: 4, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.673 Vali Acc: 0.722 Test Loss: 0.673 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6427769660949707
Epoch: 5, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.770 Vali Acc: 0.639 Test Loss: 0.770 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5479540824890137
Epoch: 6, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.797 Vali Acc: 0.673 Test Loss: 0.797 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5748660564422607
Epoch: 7, Steps: 13 | Train Loss: 0.283 Vali Loss: 1.042 Vali Acc: 0.644 Test Loss: 1.042 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.4415981769561768
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 1.630 Vali Acc: 0.746 Test Loss: 1.630 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.3844943046569824
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 1.282 Vali Acc: 0.649 Test Loss: 1.282 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5536932945251465
Epoch: 10, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.503 Vali Acc: 0.717 Test Loss: 1.503 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4961204528808594
Epoch: 11, Steps: 13 | Train Loss: 0.032 Vali Loss: 2.229 Vali Acc: 0.732 Test Loss: 2.229 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4782938957214355
Epoch: 12, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.666 Vali Acc: 0.702 Test Loss: 1.666 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3789834
model size : 24.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7701079845428467
Epoch: 1, Steps: 13 | Train Loss: 0.757 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.1589417457580566
Epoch: 2, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
Validation loss decreased (-0.717066 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.2206947803497314
Epoch: 3, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.643 Vali Acc: 0.751 Test Loss: 0.643 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 4 cost time: 2.3401854038238525
Epoch: 4, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.295128583908081
Epoch: 5, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.702 Vali Acc: 0.727 Test Loss: 0.702 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3155717849731445
Epoch: 6, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.786 Vali Acc: 0.629 Test Loss: 0.786 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4049148559570312
Epoch: 7, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.785 Vali Acc: 0.732 Test Loss: 1.785 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.169088840484619
Epoch: 8, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.475 Vali Acc: 0.732 Test Loss: 1.475 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.077324867248535
Epoch: 9, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1611664295196533
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 2.367 Vali Acc: 0.722 Test Loss: 2.367 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4516241550445557
Epoch: 11, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.361 Vali Acc: 0.727 Test Loss: 2.361 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.542102813720703
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.481 Vali Acc: 0.693 Test Loss: 1.481 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4882545471191406
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.703 Vali Acc: 0.683 Test Loss: 1.703 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 3789834
model size : 24.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.129328727722168
Epoch: 1, Steps: 13 | Train Loss: 0.738 Vali Loss: 0.675 Vali Acc: 0.722 Test Loss: 0.675 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 2.156890869140625
Epoch: 2, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (-0.721944 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.125562906265259
Epoch: 3, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.616 Vali Acc: 0.756 Test Loss: 0.616 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756091).  Saving model ...
Epoch: 4 cost time: 2.294856309890747
Epoch: 4, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.623 Vali Acc: 0.663 Test Loss: 0.623 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.151146411895752
Epoch: 5, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.194469451904297
Epoch: 6, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.829 Vali Acc: 0.722 Test Loss: 0.829 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9554369449615479
Epoch: 7, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.253 Vali Acc: 0.727 Test Loss: 1.253 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.060537338256836
Epoch: 8, Steps: 13 | Train Loss: 0.276 Vali Loss: 2.160 Vali Acc: 0.737 Test Loss: 2.160 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.864335298538208
Epoch: 9, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.249 Vali Acc: 0.668 Test Loss: 1.249 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1974804401397705
Epoch: 10, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.243 Vali Acc: 0.722 Test Loss: 2.243 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.107434034347534
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.934 Vali Acc: 0.712 Test Loss: 1.934 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.114424467086792
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 2.180 Vali Acc: 0.600 Test Loss: 2.180 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.171675205230713
Epoch: 13, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.084 Vali Acc: 0.717 Test Loss: 2.084 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3789834
model size : 24.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.673605442047119
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.656 Vali Acc: 0.722 Test Loss: 0.656 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.957249402999878
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.578 Vali Acc: 0.751 Test Loss: 0.578 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.1189157962799072
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.737 Vali Acc: 0.732 Test Loss: 0.737 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.93731689453125
Epoch: 4, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.678 Vali Acc: 0.639 Test Loss: 0.678 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.058040142059326
Epoch: 5, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.018723487854004
Epoch: 6, Steps: 13 | Train Loss: 0.327 Vali Loss: 1.169 Vali Acc: 0.444 Test Loss: 1.169 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9990520477294922
Epoch: 7, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.756 Vali Acc: 0.712 Test Loss: 0.756 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0262272357940674
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.999 Vali Acc: 0.756 Test Loss: 0.999 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756088).  Saving model ...
Epoch: 9 cost time: 1.9414899349212646
Epoch: 9, Steps: 13 | Train Loss: 0.125 Vali Loss: 1.503 Vali Acc: 0.737 Test Loss: 1.503 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0071065425872803
Epoch: 10, Steps: 13 | Train Loss: 0.080 Vali Loss: 2.040 Vali Acc: 0.741 Test Loss: 2.040 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2941648960113525
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.580 Vali Acc: 0.683 Test Loss: 1.580 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.081035852432251
Epoch: 12, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.636 Vali Acc: 0.634 Test Loss: 2.636 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.119218111038208
Epoch: 13, Steps: 13 | Train Loss: 0.049 Vali Loss: 2.280 Vali Acc: 0.712 Test Loss: 2.280 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.210024833679199
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 4.523 Vali Acc: 0.702 Test Loss: 4.523 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.03507399559021
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 3.215 Vali Acc: 0.722 Test Loss: 3.215 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0091042518615723
Epoch: 16, Steps: 13 | Train Loss: 0.050 Vali Loss: 3.866 Vali Acc: 0.727 Test Loss: 3.866 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7547526359558105
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 2.955 Vali Acc: 0.737 Test Loss: 2.955 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1143860816955566
Epoch: 18, Steps: 13 | Train Loss: 0.019 Vali Loss: 3.087 Vali Acc: 0.746 Test Loss: 3.087 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 3789834
model size : 24.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.29877233505249
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 1.103 Vali Acc: 0.278 Test Loss: 1.103 Test Acc: 0.278
Validation loss decreased (inf --> -0.278038).  Saving model ...
Epoch: 2 cost time: 2.2405693531036377
Epoch: 2, Steps: 13 | Train Loss: 0.688 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
Validation loss decreased (-0.278038 --> -0.717065).  Saving model ...
Epoch: 3 cost time: 2.2452895641326904
Epoch: 3, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.650 Vali Acc: 0.693 Test Loss: 0.650 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3641130924224854
Epoch: 4, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.717065 --> -0.736578).  Saving model ...
Epoch: 5 cost time: 2.3943629264831543
Epoch: 5, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.753 Vali Acc: 0.668 Test Loss: 0.753 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.412682056427002
Epoch: 6, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.767 Vali Acc: 0.688 Test Loss: 0.767 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2377853393554688
Epoch: 7, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.995 Vali Acc: 0.741 Test Loss: 0.995 Test Acc: 0.741
Validation loss decreased (-0.736578 --> -0.741453).  Saving model ...
Epoch: 8 cost time: 2.433621883392334
Epoch: 8, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.123 Vali Acc: 0.751 Test Loss: 1.123 Test Acc: 0.751
Validation loss decreased (-0.741453 --> -0.751208).  Saving model ...
Epoch: 9 cost time: 2.3634166717529297
Epoch: 9, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.398 Vali Acc: 0.737 Test Loss: 1.398 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2680094242095947
Epoch: 10, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.654 Test Loss: 1.222 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.310015916824341
Epoch: 11, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.651 Vali Acc: 0.737 Test Loss: 1.651 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.302199602127075
Epoch: 12, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.319 Vali Acc: 0.702 Test Loss: 1.319 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3929460048675537
Epoch: 13, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.758 Vali Acc: 0.702 Test Loss: 1.758 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3082478046417236
Epoch: 14, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.880 Vali Acc: 0.732 Test Loss: 2.880 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3400371074676514
Epoch: 15, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.243 Vali Acc: 0.698 Test Loss: 2.243 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3265137672424316
Epoch: 16, Steps: 13 | Train Loss: 0.026 Vali Loss: 3.217 Vali Acc: 0.732 Test Loss: 3.217 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.311455726623535
Epoch: 17, Steps: 13 | Train Loss: 0.028 Vali Loss: 2.568 Vali Acc: 0.639 Test Loss: 2.568 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.408966302871704
Epoch: 18, Steps: 13 | Train Loss: 0.012 Vali Loss: 3.382 Vali Acc: 0.537 Test Loss: 3.382 Test Acc: 0.537
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2741258
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.039916515350342
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.976 Vali Acc: 0.278 Test Loss: 0.976 Test Acc: 0.278
Validation loss decreased (inf --> -0.278039).  Saving model ...
Epoch: 2 cost time: 2.2661406993865967
Epoch: 2, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.863 Vali Acc: 0.717 Test Loss: 0.863 Test Acc: 0.717
Validation loss decreased (-0.278039 --> -0.717065).  Saving model ...
Epoch: 3 cost time: 2.40293025970459
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.731 Vali Acc: 0.571 Test Loss: 0.731 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2742056846618652
Epoch: 4, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
Validation loss decreased (-0.717065 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 2.432596445083618
Epoch: 5, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.398651123046875
Epoch: 6, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.813 Vali Acc: 0.727 Test Loss: 0.813 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.448462724685669
Epoch: 7, Steps: 13 | Train Loss: 0.249 Vali Loss: 1.005 Vali Acc: 0.717 Test Loss: 1.005 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.351757287979126
Epoch: 8, Steps: 13 | Train Loss: 0.144 Vali Loss: 1.652 Vali Acc: 0.727 Test Loss: 1.652 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5437350273132324
Epoch: 9, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.485 Vali Acc: 0.732 Test Loss: 1.485 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4434187412261963
Epoch: 10, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.279 Vali Acc: 0.678 Test Loss: 1.279 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.4863569736480713
Epoch: 11, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.424 Vali Acc: 0.737 Test Loss: 2.424 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2688376903533936
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.559 Vali Acc: 0.707 Test Loss: 1.559 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.209909677505493
Epoch: 13, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.597 Vali Acc: 0.678 Test Loss: 1.597 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.284177780151367
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.550 Vali Acc: 0.712 Test Loss: 1.550 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 2741258
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.856682538986206
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.894 Vali Acc: 0.278 Test Loss: 0.894 Test Acc: 0.278
Validation loss decreased (inf --> -0.278040).  Saving model ...
Epoch: 2 cost time: 1.9841599464416504
Epoch: 2, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.861 Vali Acc: 0.727 Test Loss: 0.861 Test Acc: 0.727
Validation loss decreased (-0.278040 --> -0.726821).  Saving model ...
Epoch: 3 cost time: 1.9892821311950684
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 1.273 Vali Acc: 0.283 Test Loss: 1.273 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9837801456451416
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
Validation loss decreased (-0.726821 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.9063446521759033
Epoch: 5, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.612 Vali Acc: 0.673 Test Loss: 0.612 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9599268436431885
Epoch: 6, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.743 Vali Acc: 0.732 Test Loss: 0.743 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.121969699859619
Epoch: 7, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.820 Vali Acc: 0.727 Test Loss: 0.820 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9839308261871338
Epoch: 8, Steps: 13 | Train Loss: 0.440 Vali Loss: 1.002 Vali Acc: 0.634 Test Loss: 1.002 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.083972215652466
Epoch: 9, Steps: 13 | Train Loss: 0.292 Vali Loss: 2.328 Vali Acc: 0.722 Test Loss: 2.328 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9680836200714111
Epoch: 10, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.409 Vali Acc: 0.663 Test Loss: 1.409 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9914698600769043
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.929 Vali Acc: 0.727 Test Loss: 1.929 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.036545753479004
Epoch: 12, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.427 Vali Acc: 0.707 Test Loss: 1.427 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0253260135650635
Epoch: 13, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.737 Vali Acc: 0.668 Test Loss: 1.737 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.9577617645263672
Epoch: 14, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.938 Vali Acc: 0.727 Test Loss: 1.938 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2741258
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6335699558258057
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.640 Vali Acc: 0.707 Test Loss: 0.640 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 1.986236333847046
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 1.166 Vali Acc: 0.717 Test Loss: 1.166 Test Acc: 0.717
Validation loss decreased (-0.707311 --> -0.717062).  Saving model ...
Epoch: 3 cost time: 2.0655202865600586
Epoch: 3, Steps: 13 | Train Loss: 0.797 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.717062 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.9945189952850342
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.884917974472046
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.597 Vali Acc: 0.678 Test Loss: 0.597 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9320940971374512
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9890265464782715
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.747 Vali Acc: 0.620 Test Loss: 0.747 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.107163429260254
Epoch: 8, Steps: 13 | Train Loss: 0.227 Vali Loss: 1.502 Vali Acc: 0.727 Test Loss: 1.502 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.0825233459472656
Epoch: 9, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.842 Vali Acc: 0.654 Test Loss: 0.842 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.958526849746704
Epoch: 10, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.943 Vali Acc: 0.698 Test Loss: 0.943 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8467915058135986
Epoch: 11, Steps: 13 | Train Loss: 0.031 Vali Loss: 2.237 Vali Acc: 0.732 Test Loss: 2.237 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8746068477630615
Epoch: 12, Steps: 13 | Train Loss: 0.135 Vali Loss: 1.299 Vali Acc: 0.702 Test Loss: 1.299 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8620014190673828
Epoch: 13, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.406 Vali Acc: 0.571 Test Loss: 2.406 Test Acc: 0.571
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 2741258
model size : 20.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.006932497024536
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.241245746612549
Epoch: 2, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.2198684215545654
Epoch: 3, Steps: 13 | Train Loss: 0.598 Vali Loss: 1.010 Vali Acc: 0.600 Test Loss: 1.010 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3633816242218018
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.711 Vali Acc: 0.712 Test Loss: 0.711 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.258787155151367
Epoch: 5, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.722 Vali Acc: 0.741 Test Loss: 0.722 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3755502700805664
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.779 Vali Acc: 0.732 Test Loss: 0.779 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4173765182495117
Epoch: 7, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.829 Vali Acc: 0.712 Test Loss: 0.829 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.333367109298706
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 1.046 Vali Acc: 0.639 Test Loss: 1.046 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.447096347808838
Epoch: 9, Steps: 13 | Train Loss: 0.233 Vali Loss: 1.507 Vali Acc: 0.727 Test Loss: 1.507 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1598575115203857
Epoch: 10, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.411 Vali Acc: 0.737 Test Loss: 1.411 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.307710886001587
Epoch: 11, Steps: 13 | Train Loss: 0.027 Vali Loss: 1.951 Vali Acc: 0.517 Test Loss: 1.951 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2195191383361816
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.812 Vali Acc: 0.741 Test Loss: 1.812 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2216970
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.938249111175537
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
Validation loss decreased (inf --> -0.741458).  Saving model ...
Epoch: 2 cost time: 2.206169843673706
Epoch: 2, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.1602487564086914
Epoch: 3, Steps: 13 | Train Loss: 0.629 Vali Loss: 1.067 Vali Acc: 0.551 Test Loss: 1.067 Test Acc: 0.551
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0179500579833984
Epoch: 4, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.742 Vali Acc: 0.741 Test Loss: 0.742 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.239332437515259
Epoch: 5, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.261422872543335
Epoch: 6, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.722 Vali Acc: 0.649 Test Loss: 0.722 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2415809631347656
Epoch: 7, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.356 Vali Acc: 0.620 Test Loss: 1.356 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.250084400177002
Epoch: 8, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.703 Vali Acc: 0.737 Test Loss: 1.703 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1840462684631348
Epoch: 9, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.359 Vali Acc: 0.634 Test Loss: 1.359 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.362359046936035
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.016 Vali Acc: 0.737 Test Loss: 2.016 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3759710788726807
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 2.239 Vali Acc: 0.741 Test Loss: 2.239 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.5533363819122314
Epoch: 12, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.363 Vali Acc: 0.688 Test Loss: 1.363 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2216970
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.285287618637085
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 1.623443365097046
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.537 Vali Acc: 0.746 Test Loss: 0.537 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5935847759246826
Epoch: 3, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.975 Vali Acc: 0.551 Test Loss: 0.975 Test Acc: 0.551
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7267539501190186
Epoch: 4, Steps: 13 | Train Loss: 0.725 Vali Loss: 0.646 Vali Acc: 0.746 Test Loss: 0.646 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8126647472381592
Epoch: 5, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.9794840812683105
Epoch: 6, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.653 Vali Acc: 0.659 Test Loss: 0.653 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0380160808563232
Epoch: 7, Steps: 13 | Train Loss: 0.168 Vali Loss: 1.149 Vali Acc: 0.698 Test Loss: 1.149 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.07234525680542
Epoch: 8, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.211 Vali Acc: 0.722 Test Loss: 1.211 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.06552791595459
Epoch: 9, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.227 Vali Acc: 0.678 Test Loss: 1.227 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0621142387390137
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.847 Vali Acc: 0.722 Test Loss: 1.847 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.075704574584961
Epoch: 11, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.107 Vali Acc: 0.600 Test Loss: 2.107 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0877304077148438
Epoch: 12, Steps: 13 | Train Loss: 0.135 Vali Loss: 2.506 Vali Acc: 0.620 Test Loss: 2.506 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9798963069915771
Epoch: 13, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.983 Vali Acc: 0.741 Test Loss: 1.983 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0979509353637695
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 2.597 Vali Acc: 0.741 Test Loss: 2.597 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.969670295715332
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 2.974 Vali Acc: 0.737 Test Loss: 2.974 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 2216970
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5856757164001465
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
Validation loss decreased (inf --> -0.751214).  Saving model ...
Epoch: 2 cost time: 1.9622642993927002
Epoch: 2, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.532 Vali Acc: 0.746 Test Loss: 0.532 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.959113597869873
Epoch: 3, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8873517513275146
Epoch: 4, Steps: 13 | Train Loss: 0.808 Vali Loss: 0.847 Vali Acc: 0.741 Test Loss: 0.847 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8656563758850098
Epoch: 5, Steps: 13 | Train Loss: 0.738 Vali Loss: 1.325 Vali Acc: 0.727 Test Loss: 1.325 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.860776424407959
Epoch: 6, Steps: 13 | Train Loss: 0.959 Vali Loss: 1.179 Vali Acc: 0.746 Test Loss: 1.179 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.808393955230713
Epoch: 7, Steps: 13 | Train Loss: 0.764 Vali Loss: 1.042 Vali Acc: 0.585 Test Loss: 1.042 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9329643249511719
Epoch: 8, Steps: 13 | Train Loss: 0.594 Vali Loss: 1.067 Vali Acc: 0.600 Test Loss: 1.067 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.922438144683838
Epoch: 9, Steps: 13 | Train Loss: 0.525 Vali Loss: 1.194 Vali Acc: 0.732 Test Loss: 1.194 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.9154541492462158
Epoch: 10, Steps: 13 | Train Loss: 0.147 Vali Loss: 2.128 Vali Acc: 0.722 Test Loss: 2.128 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.0482678413391113
Epoch: 11, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.268 Vali Acc: 0.702 Test Loss: 1.268 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2216970
model size : 18.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.009979248046875
Epoch: 1, Steps: 13 | Train Loss: 0.653 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3571510314941406
Epoch: 2, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.745 Vali Acc: 0.600 Test Loss: 0.745 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.372840642929077
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.831 Vali Acc: 0.746 Test Loss: 0.831 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746333).  Saving model ...
Epoch: 4 cost time: 2.322115659713745
Epoch: 4, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.953 Vali Acc: 0.727 Test Loss: 0.953 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.451664686203003
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.811 Vali Acc: 0.688 Test Loss: 0.811 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4533956050872803
Epoch: 6, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.003 Vali Acc: 0.595 Test Loss: 1.003 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.177889823913574
Epoch: 7, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.860 Vali Acc: 0.717 Test Loss: 0.860 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.305121660232544
Epoch: 8, Steps: 13 | Train Loss: 0.113 Vali Loss: 1.473 Vali Acc: 0.454 Test Loss: 1.473 Test Acc: 0.454
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.342437744140625
Epoch: 9, Steps: 13 | Train Loss: 0.376 Vali Loss: 3.288 Vali Acc: 0.351 Test Loss: 3.288 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.361706256866455
Epoch: 10, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.120 Vali Acc: 0.712 Test Loss: 1.120 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2308156490325928
Epoch: 11, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.469 Vali Acc: 0.717 Test Loss: 1.469 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.2732911109924316
Epoch: 12, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.785 Vali Acc: 0.629 Test Loss: 1.785 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1807525157928467
Epoch: 13, Steps: 13 | Train Loss: 0.018 Vali Loss: 2.052 Vali Acc: 0.732 Test Loss: 2.052 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1954826
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6948068141937256
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.896432638168335
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.896 Vali Acc: 0.376 Test Loss: 0.896 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.164715051651001
Epoch: 3, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746334).  Saving model ...
Epoch: 4 cost time: 2.1484298706054688
Epoch: 4, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.957 Vali Acc: 0.727 Test Loss: 0.957 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.132093667984009
Epoch: 5, Steps: 13 | Train Loss: 0.284 Vali Loss: 1.263 Vali Acc: 0.732 Test Loss: 1.263 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1787972450256348
Epoch: 6, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.869 Vali Acc: 0.712 Test Loss: 0.869 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.286558151245117
Epoch: 7, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.951 Vali Acc: 0.707 Test Loss: 0.951 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0518147945404053
Epoch: 8, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.631 Vali Acc: 0.439 Test Loss: 1.631 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.286369562149048
Epoch: 9, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.411 Vali Acc: 0.722 Test Loss: 1.411 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0831925868988037
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.122 Vali Acc: 0.693 Test Loss: 1.122 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.431417942047119
Epoch: 11, Steps: 13 | Train Loss: 0.119 Vali Loss: 2.101 Vali Acc: 0.688 Test Loss: 2.101 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.35563063621521
Epoch: 12, Steps: 13 | Train Loss: 0.164 Vali Loss: 2.335 Vali Acc: 0.751 Test Loss: 2.335 Test Acc: 0.751
Validation loss decreased (-0.746334 --> -0.751196).  Saving model ...
Epoch: 13 cost time: 2.3108930587768555
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 2.152 Vali Acc: 0.683 Test Loss: 2.152 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.303407907485962
Epoch: 14, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.933 Vali Acc: 0.678 Test Loss: 2.933 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.328289270401001
Epoch: 15, Steps: 13 | Train Loss: 0.021 Vali Loss: 2.874 Vali Acc: 0.683 Test Loss: 2.874 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3222875595092773
Epoch: 16, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.468 Vali Acc: 0.649 Test Loss: 2.468 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.336975574493408
Epoch: 17, Steps: 13 | Train Loss: 0.070 Vali Loss: 2.608 Vali Acc: 0.712 Test Loss: 2.608 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2633848190307617
Epoch: 18, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.376 Vali Acc: 0.732 Test Loss: 3.376 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.433110475540161
Epoch: 19, Steps: 13 | Train Loss: 0.010 Vali Loss: 3.191 Vali Acc: 0.727 Test Loss: 3.191 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.346561908721924
Epoch: 20, Steps: 13 | Train Loss: 0.058 Vali Loss: 3.456 Vali Acc: 0.732 Test Loss: 3.456 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.203514575958252
Epoch: 21, Steps: 13 | Train Loss: 0.029 Vali Loss: 3.566 Vali Acc: 0.722 Test Loss: 3.566 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.20967435836792
Epoch: 22, Steps: 13 | Train Loss: 0.120 Vali Loss: 3.144 Vali Acc: 0.702 Test Loss: 3.144 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1954826
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5802037715911865
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8926796913146973
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.757 Vali Acc: 0.556 Test Loss: 0.757 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.883143424987793
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746334).  Saving model ...
Epoch: 4 cost time: 1.8577101230621338
Epoch: 4, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.899 Vali Acc: 0.746 Test Loss: 0.899 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.93196702003479
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.678 Vali Acc: 0.683 Test Loss: 0.678 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8042569160461426
Epoch: 6, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.979 Vali Acc: 0.590 Test Loss: 0.979 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8026185035705566
Epoch: 7, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.105 Vali Acc: 0.522 Test Loss: 1.105 Test Acc: 0.522
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8972795009613037
Epoch: 8, Steps: 13 | Train Loss: 0.203 Vali Loss: 1.266 Vali Acc: 0.639 Test Loss: 1.266 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.838413953781128
Epoch: 9, Steps: 13 | Train Loss: 0.390 Vali Loss: 2.300 Vali Acc: 0.522 Test Loss: 2.300 Test Acc: 0.522
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8538720607757568
Epoch: 10, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.004 Vali Acc: 0.707 Test Loss: 1.004 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8532862663269043
Epoch: 11, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.130 Vali Acc: 0.683 Test Loss: 1.130 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8228046894073486
Epoch: 12, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.388 Vali Acc: 0.702 Test Loss: 1.388 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9468379020690918
Epoch: 13, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.552 Vali Acc: 0.727 Test Loss: 1.552 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1954826
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.313427209854126
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7137203216552734
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.7044916152954102
Epoch: 3, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.558 Vali Acc: 0.756 Test Loss: 0.558 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.8893189430236816
Epoch: 4, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.792 Vali Acc: 0.741 Test Loss: 0.792 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7830698490142822
Epoch: 5, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.797 Vali Acc: 0.732 Test Loss: 0.797 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.783003568649292
Epoch: 6, Steps: 13 | Train Loss: 0.268 Vali Loss: 1.021 Vali Acc: 0.737 Test Loss: 1.021 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8651692867279053
Epoch: 7, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.895 Vali Acc: 0.737 Test Loss: 0.895 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8630142211914062
Epoch: 8, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.412 Vali Acc: 0.478 Test Loss: 1.412 Test Acc: 0.478
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9092912673950195
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 2.350 Vali Acc: 0.473 Test Loss: 2.350 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.966766357421875
Epoch: 10, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.414 Vali Acc: 0.727 Test Loss: 1.414 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.856980323791504
Epoch: 11, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.468 Vali Acc: 0.722 Test Loss: 1.468 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0506749153137207
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.320 Vali Acc: 0.644 Test Loss: 1.320 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0134072303771973
Epoch: 13, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.370 Vali Acc: 0.673 Test Loss: 1.370 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1954826
model size : 17.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9939024448394775
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.293797492980957
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.956 Vali Acc: 0.737 Test Loss: 0.956 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736576).  Saving model ...
Epoch: 3 cost time: 2.2429163455963135
Epoch: 3, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.331726551055908
Epoch: 4, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.780 Vali Acc: 0.746 Test Loss: 0.780 Test Acc: 0.746
Validation loss decreased (-0.736576 --> -0.746334).  Saving model ...
Epoch: 5 cost time: 2.262941837310791
Epoch: 5, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.991 Vali Acc: 0.737 Test Loss: 0.991 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2619917392730713
Epoch: 6, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.003 Vali Acc: 0.722 Test Loss: 1.003 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.225166082382202
Epoch: 7, Steps: 13 | Train Loss: 0.322 Vali Loss: 1.092 Vali Acc: 0.576 Test Loss: 1.092 Test Acc: 0.576
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3230111598968506
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.089 Vali Acc: 0.639 Test Loss: 1.089 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3594367504119873
Epoch: 9, Steps: 13 | Train Loss: 0.153 Vali Loss: 1.302 Vali Acc: 0.722 Test Loss: 1.302 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2715234756469727
Epoch: 10, Steps: 13 | Train Loss: 0.047 Vali Loss: 2.129 Vali Acc: 0.732 Test Loss: 2.129 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.2483344078063965
Epoch: 11, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.982 Vali Acc: 0.741 Test Loss: 1.982 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.241312026977539
Epoch: 12, Steps: 13 | Train Loss: 0.125 Vali Loss: 2.269 Vali Acc: 0.663 Test Loss: 2.269 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3455710411071777
Epoch: 13, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.637 Vali Acc: 0.624 Test Loss: 1.637 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3205816745758057
Epoch: 14, Steps: 13 | Train Loss: 0.047 Vali Loss: 2.547 Vali Acc: 0.732 Test Loss: 2.547 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1823754
model size : 16.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.669188976287842
Epoch: 1, Steps: 13 | Train Loss: 0.598 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.937378168106079
Epoch: 2, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.953 Vali Acc: 0.722 Test Loss: 0.953 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721942).  Saving model ...
Epoch: 3 cost time: 2.1089305877685547
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.573 Vali Acc: 0.712 Test Loss: 0.573 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9353318214416504
Epoch: 4, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.622 Vali Acc: 0.727 Test Loss: 0.622 Test Acc: 0.727
Validation loss decreased (-0.721942 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 2.142200231552124
Epoch: 5, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.994 Vali Acc: 0.727 Test Loss: 0.994 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.232213020324707
Epoch: 6, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.921 Vali Acc: 0.722 Test Loss: 0.921 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.22084641456604
Epoch: 7, Steps: 13 | Train Loss: 0.438 Vali Loss: 1.396 Vali Acc: 0.532 Test Loss: 1.396 Test Acc: 0.532
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1747994422912598
Epoch: 8, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.151 Vali Acc: 0.600 Test Loss: 1.151 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.265045166015625
Epoch: 9, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.110 Vali Acc: 0.707 Test Loss: 1.110 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.091768741607666
Epoch: 10, Steps: 13 | Train Loss: 0.056 Vali Loss: 2.698 Vali Acc: 0.732 Test Loss: 2.698 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731680).  Saving model ...
Epoch: 11 cost time: 2.236419439315796
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 2.259 Vali Acc: 0.737 Test Loss: 2.259 Test Acc: 0.737
Validation loss decreased (-0.731680 --> -0.736563).  Saving model ...
Epoch: 12 cost time: 2.1190359592437744
Epoch: 12, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.716 Vali Acc: 0.737 Test Loss: 1.716 Test Acc: 0.737
Validation loss decreased (-0.736563 --> -0.736568).  Saving model ...
Epoch: 13 cost time: 2.0880026817321777
Epoch: 13, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.823 Vali Acc: 0.629 Test Loss: 1.823 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1695303916931152
Epoch: 14, Steps: 13 | Train Loss: 0.160 Vali Loss: 2.117 Vali Acc: 0.707 Test Loss: 2.117 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1875805854797363
Epoch: 15, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.273 Vali Acc: 0.717 Test Loss: 2.273 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1426103115081787
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.332 Vali Acc: 0.717 Test Loss: 2.332 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.164358139038086
Epoch: 17, Steps: 13 | Train Loss: 0.009 Vali Loss: 2.251 Vali Acc: 0.683 Test Loss: 2.251 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.125415086746216
Epoch: 18, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.444 Vali Acc: 0.610 Test Loss: 2.444 Test Acc: 0.610
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.919018268585205
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 2.717 Vali Acc: 0.683 Test Loss: 2.717 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9772660732269287
Epoch: 20, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.972 Vali Acc: 0.678 Test Loss: 2.972 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0826964378356934
Epoch: 21, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.042 Vali Acc: 0.678 Test Loss: 3.042 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0423004627227783
Epoch: 22, Steps: 13 | Train Loss: 0.000 Vali Loss: 3.080 Vali Acc: 0.673 Test Loss: 3.080 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1823754
model size : 16.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5718212127685547
Epoch: 1, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 1.906005859375
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.810 Vali Acc: 0.727 Test Loss: 0.810 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9509508609771729
Epoch: 3, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.933473825454712
Epoch: 4, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741456).  Saving model ...
Epoch: 5 cost time: 1.8922970294952393
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.922 Vali Acc: 0.741 Test Loss: 0.922 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0321991443634033
Epoch: 6, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.881 Vali Acc: 0.722 Test Loss: 0.881 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.00136137008667
Epoch: 7, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.836 Vali Acc: 0.717 Test Loss: 0.836 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9732692241668701
Epoch: 8, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.941 Vali Acc: 0.712 Test Loss: 0.941 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9514241218566895
Epoch: 9, Steps: 13 | Train Loss: 0.450 Vali Loss: 3.573 Vali Acc: 0.317 Test Loss: 3.573 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.026254892349243
Epoch: 10, Steps: 13 | Train Loss: 0.584 Vali Loss: 1.349 Vali Acc: 0.620 Test Loss: 1.349 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0349881649017334
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.231 Vali Acc: 0.683 Test Loss: 1.231 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9255452156066895
Epoch: 12, Steps: 13 | Train Loss: 0.081 Vali Loss: 2.301 Vali Acc: 0.737 Test Loss: 2.301 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9592399597167969
Epoch: 13, Steps: 13 | Train Loss: 0.066 Vali Loss: 2.572 Vali Acc: 0.629 Test Loss: 2.572 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8254320621490479
Epoch: 14, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.582 Vali Acc: 0.717 Test Loss: 2.582 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1823754
model size : 16.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.224762201309204
Epoch: 1, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.550 Vali Acc: 0.722 Test Loss: 0.550 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.748535394668579
Epoch: 2, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.8556244373321533
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.521 Vali Acc: 0.746 Test Loss: 0.521 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.8331944942474365
Epoch: 4, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9479682445526123
Epoch: 5, Steps: 13 | Train Loss: 0.287 Vali Loss: 1.056 Vali Acc: 0.737 Test Loss: 1.056 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.905930757522583
Epoch: 6, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.660 Vali Acc: 0.737 Test Loss: 0.660 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9091401100158691
Epoch: 7, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.927 Vali Acc: 0.644 Test Loss: 0.927 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8806791305541992
Epoch: 8, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.488 Vali Acc: 0.454 Test Loss: 1.488 Test Acc: 0.454
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.7948963642120361
Epoch: 9, Steps: 13 | Train Loss: 0.219 Vali Loss: 1.043 Vali Acc: 0.727 Test Loss: 1.043 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8833184242248535
Epoch: 10, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.036 Vali Acc: 0.702 Test Loss: 1.036 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8719639778137207
Epoch: 11, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.126 Vali Acc: 0.722 Test Loss: 1.126 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8651964664459229
Epoch: 12, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.266 Vali Acc: 0.741 Test Loss: 1.266 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.915618896484375
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.530 Vali Acc: 0.688 Test Loss: 1.530 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1823754
model size : 16.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2295384407043457
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.7212021350860596
Epoch: 2, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.621 Vali Acc: 0.756 Test Loss: 0.621 Test Acc: 0.756
Validation loss decreased (-0.721946 --> -0.756091).  Saving model ...
Epoch: 3 cost time: 1.8484630584716797
Epoch: 3, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.645 Vali Acc: 0.741 Test Loss: 0.645 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.718275785446167
Epoch: 4, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7217175960540771
Epoch: 5, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.586 Vali Acc: 0.761 Test Loss: 0.586 Test Acc: 0.761
Validation loss decreased (-0.756091 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.723604440689087
Epoch: 6, Steps: 13 | Train Loss: 0.324 Vali Loss: 1.129 Vali Acc: 0.737 Test Loss: 1.129 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6386899948120117
Epoch: 7, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6755363941192627
Epoch: 8, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.867 Vali Acc: 0.668 Test Loss: 0.867 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.750558853149414
Epoch: 9, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.923 Vali Acc: 0.741 Test Loss: 0.923 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7252094745635986
Epoch: 10, Steps: 13 | Train Loss: 0.180 Vali Loss: 1.381 Vali Acc: 0.732 Test Loss: 1.381 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8072197437286377
Epoch: 11, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.017 Vali Acc: 0.663 Test Loss: 1.017 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7350409030914307
Epoch: 12, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.984 Vali Acc: 0.702 Test Loss: 0.984 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9189372062683105
Epoch: 13, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.125 Vali Acc: 0.737 Test Loss: 1.125 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8168308734893799
Epoch: 14, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.524 Vali Acc: 0.732 Test Loss: 1.524 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.871464729309082
Epoch: 15, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.263 Vali Acc: 0.722 Test Loss: 1.263 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2681610
model size : 15.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3106703758239746
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.564 Vali Acc: 0.722 Test Loss: 0.564 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.7013747692108154
Epoch: 2, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.6542413234710693
Epoch: 3, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.643 Vali Acc: 0.741 Test Loss: 0.643 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 1.6733314990997314
Epoch: 4, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7283344268798828
Epoch: 5, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.568 Vali Acc: 0.751 Test Loss: 0.568 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.842902660369873
Epoch: 6, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.948 Vali Acc: 0.732 Test Loss: 0.948 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.705063819885254
Epoch: 7, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.925 Vali Acc: 0.727 Test Loss: 0.925 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7547428607940674
Epoch: 8, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.821 Vali Acc: 0.624 Test Loss: 0.821 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7292873859405518
Epoch: 9, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.782 Vali Acc: 0.707 Test Loss: 0.782 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7330143451690674
Epoch: 10, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.915 Vali Acc: 0.722 Test Loss: 0.915 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7773118019104004
Epoch: 11, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.146 Vali Acc: 0.722 Test Loss: 1.146 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6856720447540283
Epoch: 12, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.057 Vali Acc: 0.688 Test Loss: 1.057 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7139933109283447
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.125 Vali Acc: 0.688 Test Loss: 1.125 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.718306064605713
Epoch: 14, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.450 Vali Acc: 0.727 Test Loss: 1.450 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6020936965942383
Epoch: 15, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.362 Vali Acc: 0.688 Test Loss: 1.362 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2681610
model size : 15.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.0430619716644287
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.561 Vali Acc: 0.727 Test Loss: 0.561 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.4640777111053467
Epoch: 2, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.536184310913086
Epoch: 3, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.667 Vali Acc: 0.732 Test Loss: 0.667 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4800512790679932
Epoch: 4, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3925588130950928
Epoch: 5, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.768 Vali Acc: 0.590 Test Loss: 0.768 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4538304805755615
Epoch: 6, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.787 Vali Acc: 0.737 Test Loss: 0.787 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.547330617904663
Epoch: 7, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.719 Vali Acc: 0.678 Test Loss: 0.719 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.475109338760376
Epoch: 8, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.799 Vali Acc: 0.683 Test Loss: 0.799 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.522453784942627
Epoch: 9, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.912 Vali Acc: 0.737 Test Loss: 0.912 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.609652042388916
Epoch: 10, Steps: 13 | Train Loss: 0.220 Vali Loss: 1.619 Vali Acc: 0.732 Test Loss: 1.619 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.568774700164795
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.911 Vali Acc: 0.732 Test Loss: 0.911 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.580143928527832
Epoch: 12, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.981 Vali Acc: 0.654 Test Loss: 0.981 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 2681610
model size : 15.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.29396915435791
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.5909111499786377
Epoch: 2, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.546 Vali Acc: 0.751 Test Loss: 0.546 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.5266304016113281
Epoch: 3, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.602 Vali Acc: 0.751 Test Loss: 0.602 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8223776817321777
Epoch: 4, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.539 Vali Acc: 0.751 Test Loss: 0.539 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.6958131790161133
Epoch: 5, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.681 Vali Acc: 0.634 Test Loss: 0.681 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.737401008605957
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.609 Vali Acc: 0.761 Test Loss: 0.609 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 1.7907354831695557
Epoch: 7, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.980 Vali Acc: 0.512 Test Loss: 0.980 Test Acc: 0.512
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8355729579925537
Epoch: 8, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.673 Vali Acc: 0.727 Test Loss: 0.673 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8724758625030518
Epoch: 9, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8561184406280518
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.885 Vali Acc: 0.727 Test Loss: 0.885 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8427338600158691
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.041 Vali Acc: 0.629 Test Loss: 1.041 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.779231309890747
Epoch: 12, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.969 Vali Acc: 0.659 Test Loss: 0.969 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9389455318450928
Epoch: 13, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.289 Vali Acc: 0.737 Test Loss: 1.289 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.7418084144592285
Epoch: 14, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.173 Vali Acc: 0.727 Test Loss: 1.173 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6889028549194336
Epoch: 15, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.226 Vali Acc: 0.688 Test Loss: 1.226 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8497991561889648
Epoch: 16, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.345 Vali Acc: 0.668 Test Loss: 1.345 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 2681610
model size : 15.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.040872097015381
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.083672285079956
Epoch: 2, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.996155023574829
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.688 Vali Acc: 0.746 Test Loss: 0.688 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.9025897979736328
Epoch: 4, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.599 Vali Acc: 0.693 Test Loss: 0.599 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9736833572387695
Epoch: 5, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.879 Vali Acc: 0.732 Test Loss: 0.879 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8589036464691162
Epoch: 6, Steps: 13 | Train Loss: 0.498 Vali Loss: 1.221 Vali Acc: 0.737 Test Loss: 1.221 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8259904384613037
Epoch: 7, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.109 Vali Acc: 0.737 Test Loss: 1.109 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.888972282409668
Epoch: 8, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.749 Vali Acc: 0.663 Test Loss: 0.749 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8458411693572998
Epoch: 9, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.791 Vali Acc: 0.722 Test Loss: 0.791 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.916874647140503
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.866 Vali Acc: 0.673 Test Loss: 0.866 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9506869316101074
Epoch: 11, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.166 Vali Acc: 0.580 Test Loss: 1.166 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9593837261199951
Epoch: 12, Steps: 13 | Train Loss: 0.185 Vali Loss: 1.263 Vali Acc: 0.654 Test Loss: 1.263 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.107268810272217
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.346 Vali Acc: 0.746 Test Loss: 1.346 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1633034
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.710866689682007
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.7805747985839844
Epoch: 2, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.615 Vali Acc: 0.732 Test Loss: 0.615 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.8712823390960693
Epoch: 3, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.655 Vali Acc: 0.732 Test Loss: 0.655 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8966388702392578
Epoch: 4, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.796 Vali Acc: 0.585 Test Loss: 0.796 Test Acc: 0.585
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.847855567932129
Epoch: 5, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.867 Vali Acc: 0.737 Test Loss: 0.867 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736577).  Saving model ...
Epoch: 6 cost time: 1.8785769939422607
Epoch: 6, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.774 Vali Acc: 0.712 Test Loss: 0.774 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8421759605407715
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.802 Vali Acc: 0.673 Test Loss: 0.802 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0288829803466797
Epoch: 8, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.946 Vali Acc: 0.727 Test Loss: 0.946 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9028151035308838
Epoch: 9, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.947 Vali Acc: 0.727 Test Loss: 0.947 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9457817077636719
Epoch: 10, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.118 Vali Acc: 0.732 Test Loss: 1.118 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9262290000915527
Epoch: 11, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.025 Vali Acc: 0.649 Test Loss: 1.025 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8490893840789795
Epoch: 12, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.148 Vali Acc: 0.649 Test Loss: 1.148 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8075659275054932
Epoch: 13, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.380 Vali Acc: 0.722 Test Loss: 1.380 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.819242238998413
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.407 Vali Acc: 0.732 Test Loss: 1.407 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7938177585601807
Epoch: 15, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.411 Vali Acc: 0.737 Test Loss: 1.411 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1633034
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.64604115486145
Epoch: 1, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7576544284820557
Epoch: 2, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.800872564315796
Epoch: 3, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 1.8550171852111816
Epoch: 4, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.683 Vali Acc: 0.649 Test Loss: 0.683 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.733604907989502
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.189 Vali Acc: 0.732 Test Loss: 1.189 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.726802110671997
Epoch: 6, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.700 Vali Acc: 0.693 Test Loss: 0.700 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9852850437164307
Epoch: 7, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.640 Vali Acc: 0.732 Test Loss: 0.640 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8097455501556396
Epoch: 8, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.752 Vali Acc: 0.712 Test Loss: 0.752 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8502428531646729
Epoch: 9, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.845 Vali Acc: 0.741 Test Loss: 0.845 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8709053993225098
Epoch: 10, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8107271194458008
Epoch: 11, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.697251558303833
Epoch: 12, Steps: 13 | Train Loss: 0.051 Vali Loss: 1.428 Vali Acc: 0.741 Test Loss: 1.428 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7743587493896484
Epoch: 13, Steps: 13 | Train Loss: 0.102 Vali Loss: 2.050 Vali Acc: 0.737 Test Loss: 2.050 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1633034
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.696322202682495
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.7874634265899658
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.576 Vali Acc: 0.732 Test Loss: 0.576 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.8026843070983887
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.8027715682983398
Epoch: 4, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.9101231098175049
Epoch: 5, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7843363285064697
Epoch: 6, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.723 Vali Acc: 0.615 Test Loss: 0.723 Test Acc: 0.615
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.753913402557373
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.646 Vali Acc: 0.761 Test Loss: 0.646 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760969).  Saving model ...
Epoch: 8 cost time: 1.6211817264556885
Epoch: 8, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7511632442474365
Epoch: 9, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.837 Vali Acc: 0.756 Test Loss: 0.837 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.867084264755249
Epoch: 10, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.952 Vali Acc: 0.761 Test Loss: 0.952 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7839879989624023
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.855 Vali Acc: 0.712 Test Loss: 0.855 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8571412563323975
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.397 Vali Acc: 0.732 Test Loss: 1.397 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.885887861251831
Epoch: 13, Steps: 13 | Train Loss: 0.067 Vali Loss: 2.334 Vali Acc: 0.722 Test Loss: 2.334 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7946369647979736
Epoch: 14, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.509 Vali Acc: 0.746 Test Loss: 1.509 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8575537204742432
Epoch: 15, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.103 Vali Acc: 0.712 Test Loss: 1.103 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6672420501708984
Epoch: 16, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.346 Vali Acc: 0.727 Test Loss: 1.346 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7194023132324219
Epoch: 17, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.469 Vali Acc: 0.746 Test Loss: 1.469 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 1633034
model size : 11.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9607701301574707
Epoch: 1, Steps: 13 | Train Loss: 0.683 Vali Loss: 0.621 Vali Acc: 0.712 Test Loss: 0.621 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.9203808307647705
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.636 Vali Acc: 0.727 Test Loss: 0.636 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.1008715629577637
Epoch: 3, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.689 Vali Acc: 0.741 Test Loss: 0.689 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 2.235865592956543
Epoch: 4, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 2.124224901199341
Epoch: 5, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.587 Vali Acc: 0.751 Test Loss: 0.587 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 2.0197196006774902
Epoch: 6, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.864 Vali Acc: 0.741 Test Loss: 0.864 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9162111282348633
Epoch: 7, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0713584423065186
Epoch: 8, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.826 Vali Acc: 0.702 Test Loss: 0.826 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.913581132888794
Epoch: 9, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.086 Vali Acc: 0.741 Test Loss: 1.086 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9080679416656494
Epoch: 10, Steps: 13 | Train Loss: 0.089 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.018446207046509
Epoch: 11, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.051 Vali Acc: 0.732 Test Loss: 1.051 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8706095218658447
Epoch: 12, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.054 Vali Acc: 0.654 Test Loss: 1.054 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9814999103546143
Epoch: 13, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.272 Vali Acc: 0.727 Test Loss: 1.272 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9431602954864502
Epoch: 14, Steps: 13 | Train Loss: 0.024 Vali Loss: 1.608 Vali Acc: 0.737 Test Loss: 1.608 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.205601692199707
Epoch: 15, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.767 Vali Acc: 0.732 Test Loss: 1.767 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1108746
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.182504177093506
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.606 Vali Acc: 0.712 Test Loss: 0.606 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.0392463207244873
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.0965664386749268
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.846 Vali Acc: 0.737 Test Loss: 0.846 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 2.327782154083252
Epoch: 4, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.708 Vali Acc: 0.741 Test Loss: 0.708 Test Acc: 0.741
Validation loss decreased (-0.736577 --> -0.741456).  Saving model ...
Epoch: 5 cost time: 2.1599044799804688
Epoch: 5, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.985978126525879
Epoch: 6, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0692601203918457
Epoch: 7, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.872 Vali Acc: 0.732 Test Loss: 0.872 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.994231939315796
Epoch: 8, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.827 Vali Acc: 0.659 Test Loss: 0.827 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4359166622161865
Epoch: 9, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.872 Vali Acc: 0.717 Test Loss: 0.872 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3488028049468994
Epoch: 10, Steps: 13 | Train Loss: 0.088 Vali Loss: 0.807 Vali Acc: 0.663 Test Loss: 0.807 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.415562868118286
Epoch: 11, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.151 Vali Acc: 0.722 Test Loss: 1.151 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6865034103393555
Epoch: 12, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.025 Vali Acc: 0.663 Test Loss: 1.025 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3683090209960938
Epoch: 13, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.288 Vali Acc: 0.673 Test Loss: 1.288 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1275079250335693
Epoch: 14, Steps: 13 | Train Loss: 0.039 Vali Loss: 1.235 Vali Acc: 0.668 Test Loss: 1.235 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1108746
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.173769474029541
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.367295026779175
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5517828464508057
Epoch: 3, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.600 Vali Acc: 0.756 Test Loss: 0.600 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 2.4036457538604736
Epoch: 4, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.342374563217163
Epoch: 5, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1744401454925537
Epoch: 6, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.756948471069336
Epoch: 7, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.669 Vali Acc: 0.751 Test Loss: 0.669 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3655242919921875
Epoch: 8, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.692 Vali Acc: 0.693 Test Loss: 0.692 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.488615036010742
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.944 Vali Acc: 0.727 Test Loss: 0.944 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.835314989089966
Epoch: 10, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.071 Vali Acc: 0.732 Test Loss: 1.071 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.4460511207580566
Epoch: 11, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.905 Vali Acc: 0.707 Test Loss: 0.905 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0837807655334473
Epoch: 12, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.006 Vali Acc: 0.693 Test Loss: 1.006 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3697006702423096
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.161 Vali Acc: 0.698 Test Loss: 1.161 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1108746
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.066003084182739
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.6274511814117432
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.638 Vali Acc: 0.727 Test Loss: 0.638 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.8642997741699219
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.715 Vali Acc: 0.741 Test Loss: 0.715 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741456).  Saving model ...
Epoch: 4 cost time: 1.8490228652954102
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.749 Vali Acc: 0.732 Test Loss: 0.749 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7808115482330322
Epoch: 5, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.530 Vali Acc: 0.707 Test Loss: 0.530 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.06716251373291
Epoch: 6, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.585 Vali Acc: 0.707 Test Loss: 0.585 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9863877296447754
Epoch: 7, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.685 Vali Acc: 0.727 Test Loss: 0.685 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1370747089385986
Epoch: 8, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.685 Vali Acc: 0.727 Test Loss: 0.685 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.1258528232574463
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.377 Vali Acc: 0.722 Test Loss: 1.377 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0261526107788086
Epoch: 10, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.995 Vali Acc: 0.722 Test Loss: 0.995 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.772895336151123
Epoch: 11, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.898 Vali Acc: 0.654 Test Loss: 0.898 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8377470970153809
Epoch: 12, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.114 Vali Acc: 0.722 Test Loss: 1.114 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7724571228027344
Epoch: 13, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.360 Vali Acc: 0.712 Test Loss: 1.360 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1108746
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3848042488098145
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3931243419647217
Epoch: 2, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.182748794555664
Epoch: 3, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.708 Vali Acc: 0.600 Test Loss: 0.708 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2339816093444824
Epoch: 4, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.35789155960083
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.844 Vali Acc: 0.737 Test Loss: 0.844 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3119640350341797
Epoch: 6, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.654 Vali Acc: 0.727 Test Loss: 0.654 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0856263637542725
Epoch: 7, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.767 Vali Acc: 0.659 Test Loss: 0.767 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.02351450920105
Epoch: 8, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.862 Vali Acc: 0.746 Test Loss: 0.862 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746333).  Saving model ...
Epoch: 9 cost time: 2.1120052337646484
Epoch: 9, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.587 Vali Acc: 0.722 Test Loss: 1.587 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1886463165283203
Epoch: 10, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.955 Vali Acc: 0.707 Test Loss: 0.955 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.763253927230835
Epoch: 11, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.131 Vali Acc: 0.737 Test Loss: 1.131 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.301912784576416
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.356 Vali Acc: 0.732 Test Loss: 1.356 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.005821943283081
Epoch: 13, Steps: 13 | Train Loss: 0.050 Vali Loss: 1.145 Vali Acc: 0.683 Test Loss: 1.145 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.356113910675049
Epoch: 14, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.839 Vali Acc: 0.751 Test Loss: 1.839 Test Acc: 0.751
Validation loss decreased (-0.746333 --> -0.751201).  Saving model ...
Epoch: 15 cost time: 2.7486672401428223
Epoch: 15, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.448 Vali Acc: 0.702 Test Loss: 1.448 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.640561580657959
Epoch: 16, Steps: 13 | Train Loss: 0.016 Vali Loss: 1.990 Vali Acc: 0.741 Test Loss: 1.990 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3455452919006348
Epoch: 17, Steps: 13 | Train Loss: 0.017 Vali Loss: 1.717 Vali Acc: 0.702 Test Loss: 1.717 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6667709350585938
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.555 Vali Acc: 0.702 Test Loss: 1.555 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.39920973777771
Epoch: 19, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.558 Vali Acc: 0.698 Test Loss: 1.558 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4394357204437256
Epoch: 20, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.734 Vali Acc: 0.717 Test Loss: 1.734 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4497666358947754
Epoch: 21, Steps: 13 | Train Loss: 0.007 Vali Loss: 2.142 Vali Acc: 0.732 Test Loss: 2.142 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1005165576934814
Epoch: 22, Steps: 13 | Train Loss: 0.004 Vali Loss: 1.627 Vali Acc: 0.668 Test Loss: 1.627 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.525994300842285
Epoch: 23, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.707 Vali Acc: 0.698 Test Loss: 1.707 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3867712020874023
Epoch: 24, Steps: 13 | Train Loss: 0.008 Vali Loss: 2.274 Vali Acc: 0.732 Test Loss: 2.274 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 846602
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.853602886199951
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.662 Vali Acc: 0.654 Test Loss: 0.662 Test Acc: 0.654
Validation loss decreased (inf --> -0.653652).  Saving model ...
Epoch: 2 cost time: 2.158169984817505
Epoch: 2, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (-0.653652 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.9185144901275635
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.696 Vali Acc: 0.644 Test Loss: 0.696 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9362819194793701
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9970996379852295
Epoch: 5, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1131484508514404
Epoch: 6, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3723702430725098
Epoch: 7, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.852 Vali Acc: 0.668 Test Loss: 0.852 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1765100955963135
Epoch: 8, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.998 Vali Acc: 0.737 Test Loss: 0.998 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.292501211166382
Epoch: 9, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.764 Vali Acc: 0.683 Test Loss: 0.764 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.135331630706787
Epoch: 10, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.122 Vali Acc: 0.717 Test Loss: 1.122 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.327854871749878
Epoch: 11, Steps: 13 | Train Loss: 0.067 Vali Loss: 1.025 Vali Acc: 0.702 Test Loss: 1.025 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.199152708053589
Epoch: 12, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.118 Vali Acc: 0.702 Test Loss: 1.118 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 846602
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.0769572257995605
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.673 Vali Acc: 0.634 Test Loss: 0.673 Test Acc: 0.634
Validation loss decreased (inf --> -0.634140).  Saving model ...
Epoch: 2 cost time: 2.147916316986084
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
Validation loss decreased (-0.634140 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 2.23492693901062
Epoch: 3, Steps: 13 | Train Loss: 0.486 Vali Loss: 0.671 Vali Acc: 0.624 Test Loss: 0.671 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3036820888519287
Epoch: 4, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3880832195281982
Epoch: 5, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.837 Vali Acc: 0.741 Test Loss: 0.837 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.345618724822998
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.186397075653076
Epoch: 7, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.895 Vali Acc: 0.566 Test Loss: 0.895 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9752488136291504
Epoch: 8, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.774 Vali Acc: 0.678 Test Loss: 0.774 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.094114065170288
Epoch: 9, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.224231243133545
Epoch: 10, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.784 Vali Acc: 0.678 Test Loss: 0.784 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.221430778503418
Epoch: 11, Steps: 13 | Train Loss: 0.073 Vali Loss: 1.014 Vali Acc: 0.722 Test Loss: 1.014 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.1182785034179688
Epoch: 12, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.989 Vali Acc: 0.722 Test Loss: 0.989 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 846602
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7080869674682617
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.727 Vali Acc: 0.351 Test Loss: 0.727 Test Acc: 0.351
Validation loss decreased (inf --> -0.351212).  Saving model ...
Epoch: 2 cost time: 1.8501548767089844
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
Validation loss decreased (-0.351212 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.12868595123291
Epoch: 3, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.664 Vali Acc: 0.624 Test Loss: 0.664 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.056758403778076
Epoch: 4, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4347572326660156
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 1.065 Vali Acc: 0.722 Test Loss: 1.065 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.269000768661499
Epoch: 6, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1832990646362305
Epoch: 7, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.863 Vali Acc: 0.585 Test Loss: 0.863 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.306905746459961
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.847 Vali Acc: 0.600 Test Loss: 0.847 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2922885417938232
Epoch: 9, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.937 Vali Acc: 0.727 Test Loss: 0.937 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3738834857940674
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 1.131 Vali Acc: 0.571 Test Loss: 1.131 Test Acc: 0.571
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.270765542984009
Epoch: 11, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.017 Vali Acc: 0.712 Test Loss: 1.017 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.127342462539673
Epoch: 12, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.134 Vali Acc: 0.698 Test Loss: 1.134 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 846602
model size : 8.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.606962442398071
Epoch: 1, Steps: 13 | Train Loss: 0.711 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.617197275161743
Epoch: 2, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.654 Vali Acc: 0.649 Test Loss: 0.654 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.544403076171875
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.0522541999816895
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0675275325775146
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9725470542907715
Epoch: 6, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.064365863800049
Epoch: 7, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 2.2562077045440674
Epoch: 8, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.072 Vali Acc: 0.732 Test Loss: 1.072 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3089654445648193
Epoch: 9, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.810 Vali Acc: 0.693 Test Loss: 0.810 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1607720851898193
Epoch: 10, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.905 Vali Acc: 0.751 Test Loss: 0.905 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751210).  Saving model ...
Epoch: 11 cost time: 2.0943820476531982
Epoch: 11, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.164 Vali Acc: 0.727 Test Loss: 1.164 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.381793737411499
Epoch: 12, Steps: 13 | Train Loss: 0.038 Vali Loss: 1.061 Vali Acc: 0.722 Test Loss: 1.061 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5473716259002686
Epoch: 13, Steps: 13 | Train Loss: 0.026 Vali Loss: 1.110 Vali Acc: 0.727 Test Loss: 1.110 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0842225551605225
Epoch: 14, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.346 Vali Acc: 0.746 Test Loss: 1.346 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1171579360961914
Epoch: 15, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.228 Vali Acc: 0.673 Test Loss: 1.228 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.26420521736145
Epoch: 16, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.514 Vali Acc: 0.732 Test Loss: 1.514 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2836902141571045
Epoch: 17, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.091 Vali Acc: 0.732 Test Loss: 2.091 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.486341953277588
Epoch: 18, Steps: 13 | Train Loss: 0.003 Vali Loss: 1.512 Vali Acc: 0.707 Test Loss: 1.512 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.155878782272339
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.522 Vali Acc: 0.717 Test Loss: 1.522 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2562389373779297
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.847 Vali Acc: 0.727 Test Loss: 1.847 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 715530
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.513425588607788
Epoch: 1, Steps: 13 | Train Loss: 0.706 Vali Loss: 0.607 Vali Acc: 0.727 Test Loss: 0.607 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.288688898086548
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.661 Vali Acc: 0.620 Test Loss: 0.661 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5342726707458496
Epoch: 3, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.607 Vali Acc: 0.722 Test Loss: 0.607 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.657583236694336
Epoch: 4, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736578).  Saving model ...
Epoch: 5 cost time: 2.409292459487915
Epoch: 5, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.571 Vali Acc: 0.707 Test Loss: 0.571 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6284189224243164
Epoch: 6, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.617 Vali Acc: 0.712 Test Loss: 0.617 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2032546997070312
Epoch: 7, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.688 Vali Acc: 0.707 Test Loss: 0.688 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3691940307617188
Epoch: 8, Steps: 13 | Train Loss: 0.154 Vali Loss: 1.040 Vali Acc: 0.737 Test Loss: 1.040 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9440429210662842
Epoch: 9, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.875 Vali Acc: 0.707 Test Loss: 0.875 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0019803047180176
Epoch: 10, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0522239208221436
Epoch: 11, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.383 Vali Acc: 0.737 Test Loss: 1.383 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.2617805004119873
Epoch: 12, Steps: 13 | Train Loss: 0.044 Vali Loss: 1.075 Vali Acc: 0.702 Test Loss: 1.075 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.270925283432007
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.272 Vali Acc: 0.702 Test Loss: 1.272 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4096169471740723
Epoch: 14, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.509 Vali Acc: 0.737 Test Loss: 1.509 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 715530
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.418834447860718
Epoch: 1, Steps: 13 | Train Loss: 0.686 Vali Loss: 0.601 Vali Acc: 0.732 Test Loss: 0.601 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 2.200664758682251
Epoch: 2, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.656 Vali Acc: 0.620 Test Loss: 0.656 Test Acc: 0.620
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9117286205291748
Epoch: 3, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.0534024238586426
Epoch: 4, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.634 Vali Acc: 0.741 Test Loss: 0.634 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.92417311668396
Epoch: 5, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.580 Vali Acc: 0.737 Test Loss: 0.580 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2651755809783936
Epoch: 6, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.007258653640747
Epoch: 7, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.677 Vali Acc: 0.683 Test Loss: 0.677 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.924081802368164
Epoch: 8, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.965 Vali Acc: 0.727 Test Loss: 0.965 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1011390686035156
Epoch: 9, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.838 Vali Acc: 0.693 Test Loss: 0.838 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2785301208496094
Epoch: 10, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.860 Vali Acc: 0.693 Test Loss: 0.860 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1285319328308105
Epoch: 11, Steps: 13 | Train Loss: 0.057 Vali Loss: 0.978 Vali Acc: 0.712 Test Loss: 0.978 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.10245680809021
Epoch: 12, Steps: 13 | Train Loss: 0.031 Vali Loss: 1.026 Vali Acc: 0.727 Test Loss: 1.026 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.2437989711761475
Epoch: 13, Steps: 13 | Train Loss: 0.020 Vali Loss: 1.131 Vali Acc: 0.698 Test Loss: 1.131 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8290753364562988
Epoch: 14, Steps: 13 | Train Loss: 0.015 Vali Loss: 1.389 Vali Acc: 0.732 Test Loss: 1.389 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 715530
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7486140727996826
Epoch: 1, Steps: 13 | Train Loss: 0.702 Vali Loss: 0.617 Vali Acc: 0.712 Test Loss: 0.617 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.7922744750976562
Epoch: 2, Steps: 13 | Train Loss: 0.723 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
Validation loss decreased (-0.712189 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.093376636505127
Epoch: 3, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9133014678955078
Epoch: 4, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.8062610626220703
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0324289798736572
Epoch: 6, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8485369682312012
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.599 Vali Acc: 0.741 Test Loss: 0.599 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0977282524108887
Epoch: 8, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.127 Vali Acc: 0.737 Test Loss: 1.127 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.128081798553467
Epoch: 9, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.641 Vali Acc: 0.693 Test Loss: 0.641 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1596176624298096
Epoch: 10, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.700 Vali Acc: 0.683 Test Loss: 0.700 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0128333568573
Epoch: 11, Steps: 13 | Train Loss: 0.096 Vali Loss: 1.304 Vali Acc: 0.732 Test Loss: 1.304 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.330840587615967
Epoch: 12, Steps: 13 | Train Loss: 0.065 Vali Loss: 1.142 Vali Acc: 0.732 Test Loss: 1.142 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9289703369140625
Epoch: 13, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.378 Vali Acc: 0.683 Test Loss: 1.378 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.864060640335083
Epoch: 14, Steps: 13 | Train Loss: 0.028 Vali Loss: 1.316 Vali Acc: 0.712 Test Loss: 1.316 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 715530
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.991997480392456
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.1406853199005127
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.662 Vali Acc: 0.698 Test Loss: 0.662 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.112920045852661
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.1976821422576904
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.604 Vali Acc: 0.751 Test Loss: 0.604 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 2.154210329055786
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.843 Vali Acc: 0.532 Test Loss: 0.843 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.371736764907837
Epoch: 6, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.676 Vali Acc: 0.756 Test Loss: 0.676 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 2.4475696086883545
Epoch: 7, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.732 Vali Acc: 0.746 Test Loss: 0.732 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5645482540130615
Epoch: 8, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.764 Vali Acc: 0.702 Test Loss: 0.764 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2216882705688477
Epoch: 9, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.982 Vali Acc: 0.741 Test Loss: 0.982 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2745907306671143
Epoch: 10, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.892 Vali Acc: 0.737 Test Loss: 0.892 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.449963092803955
Epoch: 11, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.943 Vali Acc: 0.673 Test Loss: 0.943 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.255952835083008
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.290 Vali Acc: 0.737 Test Loss: 1.290 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4221391677856445
Epoch: 13, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.294 Vali Acc: 0.566 Test Loss: 1.294 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5396714210510254
Epoch: 14, Steps: 13 | Train Loss: 0.053 Vali Loss: 1.136 Vali Acc: 0.717 Test Loss: 1.136 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2115166187286377
Epoch: 15, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.543 Vali Acc: 0.746 Test Loss: 1.543 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3781633377075195
Epoch: 16, Steps: 13 | Train Loss: 0.046 Vali Loss: 1.611 Vali Acc: 0.751 Test Loss: 1.611 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 649994
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.766856670379639
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3954453468322754
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.670 Vali Acc: 0.673 Test Loss: 0.670 Test Acc: 0.673
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2205941677093506
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.217416763305664
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.623 Vali Acc: 0.746 Test Loss: 0.623 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 2.4789299964904785
Epoch: 5, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.095 Vali Acc: 0.337 Test Loss: 1.095 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.480686902999878
Epoch: 6, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.662 Vali Acc: 0.756 Test Loss: 0.662 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756091).  Saving model ...
Epoch: 7 cost time: 2.4969377517700195
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.903 Vali Acc: 0.732 Test Loss: 0.903 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2173080444335938
Epoch: 8, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.306577444076538
Epoch: 9, Steps: 13 | Train Loss: 0.169 Vali Loss: 1.066 Vali Acc: 0.727 Test Loss: 1.066 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.204920530319214
Epoch: 10, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.066 Vali Acc: 0.746 Test Loss: 1.066 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.140035390853882
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.198 Vali Acc: 0.732 Test Loss: 1.198 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.829676628112793
Epoch: 12, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.889 Vali Acc: 0.683 Test Loss: 0.889 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.2026844024658203
Epoch: 13, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.846 Vali Acc: 0.517 Test Loss: 1.846 Test Acc: 0.517
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9129276275634766
Epoch: 14, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.193 Vali Acc: 0.698 Test Loss: 1.193 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5372042655944824
Epoch: 15, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.663 Vali Acc: 0.746 Test Loss: 1.663 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.556732416152954
Epoch: 16, Steps: 13 | Train Loss: 0.019 Vali Loss: 1.706 Vali Acc: 0.746 Test Loss: 1.706 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 649994
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.718254566192627
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.135303497314453
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.696 Vali Acc: 0.595 Test Loss: 0.696 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1434080600738525
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.271819591522217
Epoch: 4, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.598 Vali Acc: 0.756 Test Loss: 0.598 Test Acc: 0.756
Validation loss decreased (-0.736579 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 2.2445712089538574
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 1.050 Vali Acc: 0.356 Test Loss: 1.050 Test Acc: 0.356
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1851329803466797
Epoch: 6, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.343862533569336
Epoch: 7, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.020580291748047
Epoch: 8, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.707 Vali Acc: 0.668 Test Loss: 0.707 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.2234697341918945
Epoch: 9, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.761 Vali Acc: 0.712 Test Loss: 0.761 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3169779777526855
Epoch: 10, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.957 Vali Acc: 0.727 Test Loss: 0.957 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0897622108459473
Epoch: 11, Steps: 13 | Train Loss: 0.315 Vali Loss: 1.249 Vali Acc: 0.737 Test Loss: 1.249 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.093261480331421
Epoch: 12, Steps: 13 | Train Loss: 0.129 Vali Loss: 1.350 Vali Acc: 0.727 Test Loss: 1.350 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.092939615249634
Epoch: 13, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.965 Vali Acc: 0.673 Test Loss: 0.965 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2761244773864746
Epoch: 14, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.079 Vali Acc: 0.712 Test Loss: 1.079 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 649994
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.18899941444397
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 2.640923261642456
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.693 Vali Acc: 0.566 Test Loss: 0.693 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5429599285125732
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.561 Vali Acc: 0.751 Test Loss: 0.561 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.384437084197998
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 2.280149459838867
Epoch: 5, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4134714603424072
Epoch: 6, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.688 Vali Acc: 0.644 Test Loss: 0.688 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.271989583969116
Epoch: 7, Steps: 13 | Train Loss: 0.437 Vali Loss: 1.192 Vali Acc: 0.341 Test Loss: 1.192 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.312082290649414
Epoch: 8, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.631 Vali Acc: 0.732 Test Loss: 0.631 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.321895122528076
Epoch: 9, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.640 Vali Acc: 0.717 Test Loss: 0.640 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.158379554748535
Epoch: 10, Steps: 13 | Train Loss: 0.120 Vali Loss: 1.195 Vali Acc: 0.732 Test Loss: 1.195 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3958942890167236
Epoch: 11, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.057 Vali Acc: 0.727 Test Loss: 1.057 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.428159236907959
Epoch: 12, Steps: 13 | Train Loss: 0.059 Vali Loss: 0.896 Vali Acc: 0.668 Test Loss: 0.896 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.506171941757202
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.279 Vali Acc: 0.668 Test Loss: 1.279 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.751776933670044
Epoch: 14, Steps: 13 | Train Loss: 0.076 Vali Loss: 1.026 Vali Acc: 0.683 Test Loss: 1.026 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 649994
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.008619070053101
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.302917957305908
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.600 Vali Acc: 0.727 Test Loss: 0.600 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.465531587600708
Epoch: 3, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 2.6862049102783203
Epoch: 4, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.586 Vali Acc: 0.746 Test Loss: 0.586 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.9220361709594727
Epoch: 5, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.645 Vali Acc: 0.746 Test Loss: 0.645 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6141486167907715
Epoch: 6, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.637 Vali Acc: 0.712 Test Loss: 0.637 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.781592607498169
Epoch: 7, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.755 Vali Acc: 0.737 Test Loss: 0.755 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.304776191711426
Epoch: 8, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.4487733840942383
Epoch: 9, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.736 Vali Acc: 0.722 Test Loss: 0.736 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7136051654815674
Epoch: 10, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.759 Vali Acc: 0.727 Test Loss: 0.759 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.5009756088256836
Epoch: 11, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.861 Vali Acc: 0.673 Test Loss: 0.861 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.521986961364746
Epoch: 12, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.906 Vali Acc: 0.737 Test Loss: 0.906 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8285131454467773
Epoch: 13, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.881 Vali Acc: 0.741 Test Loss: 0.881 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.941218614578247
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 0.889 Vali Acc: 0.707 Test Loss: 0.889 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1275530
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.820821046829224
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.628 Vali Acc: 0.722 Test Loss: 0.628 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.916435956954956
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.607 Vali Acc: 0.741 Test Loss: 0.607 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 2.4461140632629395
Epoch: 3, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.535 Vali Acc: 0.737 Test Loss: 0.535 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7021148204803467
Epoch: 4, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6114931106567383
Epoch: 5, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7378928661346436
Epoch: 6, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.594996213912964
Epoch: 7, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.747 Vali Acc: 0.737 Test Loss: 0.747 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8553857803344727
Epoch: 8, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.725 Vali Acc: 0.746 Test Loss: 0.725 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 2.778764247894287
Epoch: 9, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.705 Vali Acc: 0.698 Test Loss: 0.705 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8228743076324463
Epoch: 10, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.754 Vali Acc: 0.732 Test Loss: 0.754 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6697983741760254
Epoch: 11, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.839 Vali Acc: 0.727 Test Loss: 0.839 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6973180770874023
Epoch: 12, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.825 Vali Acc: 0.712 Test Loss: 0.825 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.048776388168335
Epoch: 13, Steps: 13 | Train Loss: 0.076 Vali Loss: 0.932 Vali Acc: 0.722 Test Loss: 0.932 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7865660190582275
Epoch: 14, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.878 Vali Acc: 0.727 Test Loss: 0.878 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.885828733444214
Epoch: 15, Steps: 13 | Train Loss: 0.031 Vali Loss: 0.981 Vali Acc: 0.717 Test Loss: 0.981 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.1859965324401855
Epoch: 16, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.101 Vali Acc: 0.717 Test Loss: 1.101 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.58565616607666
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 1.055 Vali Acc: 0.717 Test Loss: 1.055 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.437788248062134
Epoch: 18, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.084 Vali Acc: 0.722 Test Loss: 1.084 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1275530
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.413806915283203
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.3572652339935303
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.343890428543091
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.174306631088257
Epoch: 4, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.593 Vali Acc: 0.746 Test Loss: 0.593 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1761374473571777
Epoch: 5, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.751 Vali Acc: 0.746 Test Loss: 0.751 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0264105796813965
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.2573366165161133
Epoch: 7, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7322075366973877
Epoch: 8, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.702 Vali Acc: 0.727 Test Loss: 0.702 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7377429008483887
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.712 Vali Acc: 0.644 Test Loss: 0.712 Test Acc: 0.644
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7337756156921387
Epoch: 10, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.684 Vali Acc: 0.707 Test Loss: 0.684 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7794952392578125
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.722 Vali Acc: 0.702 Test Loss: 0.722 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.809323787689209
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.759 Vali Acc: 0.707 Test Loss: 0.759 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6956076622009277
Epoch: 13, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.879 Vali Acc: 0.712 Test Loss: 0.879 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1275530
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.698110818862915
Epoch: 1, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.52482271194458
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.5476133823394775
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 2.432217597961426
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.609 Vali Acc: 0.756 Test Loss: 0.609 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 5 cost time: 2.2172060012817383
Epoch: 5, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.772 Vali Acc: 0.737 Test Loss: 0.772 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.374295234680176
Epoch: 6, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.543 Vali Acc: 0.741 Test Loss: 0.543 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.407395839691162
Epoch: 7, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.665 Vali Acc: 0.751 Test Loss: 0.665 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4367926120758057
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.627 Vali Acc: 0.766 Test Loss: 0.627 Test Acc: 0.766
Validation loss decreased (-0.756091 --> -0.765847).  Saving model ...
Epoch: 9 cost time: 2.285895824432373
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.411825656890869
Epoch: 10, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.673 Vali Acc: 0.707 Test Loss: 0.673 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2722599506378174
Epoch: 11, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.729 Vali Acc: 0.741 Test Loss: 0.729 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.256159543991089
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.704 Vali Acc: 0.688 Test Loss: 0.704 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3766531944274902
Epoch: 13, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.760 Vali Acc: 0.722 Test Loss: 0.760 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1919572353363037
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.25693416595459
Epoch: 15, Steps: 13 | Train Loss: 0.040 Vali Loss: 0.915 Vali Acc: 0.751 Test Loss: 0.915 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4508543014526367
Epoch: 16, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.047 Vali Acc: 0.746 Test Loss: 1.047 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.543038845062256
Epoch: 17, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.018 Vali Acc: 0.722 Test Loss: 1.018 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.471874475479126
Epoch: 18, Steps: 13 | Train Loss: 0.009 Vali Loss: 1.062 Vali Acc: 0.732 Test Loss: 1.062 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 1275530
model size : 7.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.446044445037842
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5173733234405518
Epoch: 2, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.621 Vali Acc: 0.722 Test Loss: 0.621 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.798417091369629
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.704 Vali Acc: 0.717 Test Loss: 0.704 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2981040477752686
Epoch: 4, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.560 Vali Acc: 0.751 Test Loss: 0.560 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.588477611541748
Epoch: 5, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6933271884918213
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.670 Vali Acc: 0.741 Test Loss: 0.670 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.913773536682129
Epoch: 7, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.852 Vali Acc: 0.727 Test Loss: 0.852 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7834503650665283
Epoch: 8, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.963 Vali Acc: 0.722 Test Loss: 0.963 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6180107593536377
Epoch: 9, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.756 Vali Acc: 0.717 Test Loss: 0.756 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.727637529373169
Epoch: 10, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.194 Vali Acc: 0.722 Test Loss: 1.194 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.630509376525879
Epoch: 11, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.085 Vali Acc: 0.741 Test Loss: 1.085 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.8205032348632812
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 1.218 Vali Acc: 0.727 Test Loss: 1.218 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8737103939056396
Epoch: 13, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.080 Vali Acc: 0.727 Test Loss: 1.080 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4408957958221436
Epoch: 14, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.134 Vali Acc: 0.707 Test Loss: 1.134 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 751242
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.351882219314575
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.701202869415283
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.508369207382202
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7678401470184326
Epoch: 4, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 2.4829635620117188
Epoch: 5, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.638 Vali Acc: 0.693 Test Loss: 0.638 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.639482259750366
Epoch: 6, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.336028575897217
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.812 Vali Acc: 0.727 Test Loss: 0.812 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2866508960723877
Epoch: 8, Steps: 13 | Train Loss: 0.277 Vali Loss: 1.011 Vali Acc: 0.727 Test Loss: 1.011 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.326685667037964
Epoch: 9, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.753 Vali Acc: 0.741 Test Loss: 0.753 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2834949493408203
Epoch: 10, Steps: 13 | Train Loss: 0.261 Vali Loss: 1.000 Vali Acc: 0.737 Test Loss: 1.000 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.741025686264038
Epoch: 11, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.855 Vali Acc: 0.737 Test Loss: 0.855 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.6029415130615234
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 1.244 Vali Acc: 0.727 Test Loss: 1.244 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.643380880355835
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.004 Vali Acc: 0.732 Test Loss: 1.004 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.617420196533203
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.964 Vali Acc: 0.712 Test Loss: 0.964 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.958631992340088
Epoch: 15, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.065 Vali Acc: 0.727 Test Loss: 1.065 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7889881134033203
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.036 Vali Acc: 0.717 Test Loss: 1.036 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 751242
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.97627592086792
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.413008689880371
Epoch: 2, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.4164793491363525
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.700 Vali Acc: 0.712 Test Loss: 0.700 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.438807249069214
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.585 Vali Acc: 0.746 Test Loss: 0.585 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 2.6222779750823975
Epoch: 5, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.344182014465332
Epoch: 6, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3603086471557617
Epoch: 7, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6224722862243652
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.891 Vali Acc: 0.737 Test Loss: 0.891 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.630908489227295
Epoch: 9, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.757 Vali Acc: 0.722 Test Loss: 0.757 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.739854335784912
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.753 Vali Acc: 0.727 Test Loss: 0.753 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6776697635650635
Epoch: 11, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.721 Vali Acc: 0.746 Test Loss: 0.721 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.612269163131714
Epoch: 12, Steps: 13 | Train Loss: 0.092 Vali Loss: 1.044 Vali Acc: 0.722 Test Loss: 1.044 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.555044651031494
Epoch: 13, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.927 Vali Acc: 0.727 Test Loss: 0.927 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.54378080368042
Epoch: 14, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.968 Vali Acc: 0.727 Test Loss: 0.968 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 751242
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.476073265075684
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.1079063415527344
Epoch: 2, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.147956609725952
Epoch: 3, Steps: 13 | Train Loss: 0.593 Vali Loss: 0.734 Vali Acc: 0.727 Test Loss: 0.734 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726822).  Saving model ...
Epoch: 4 cost time: 2.482682704925537
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.594 Vali Acc: 0.751 Test Loss: 0.594 Test Acc: 0.751
Validation loss decreased (-0.726822 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.2942888736724854
Epoch: 5, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.534 Vali Acc: 0.727 Test Loss: 0.534 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5512921810150146
Epoch: 6, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.530 Vali Acc: 0.732 Test Loss: 0.530 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0890355110168457
Epoch: 7, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.728 Vali Acc: 0.746 Test Loss: 0.728 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0496606826782227
Epoch: 8, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.934 Vali Acc: 0.732 Test Loss: 0.934 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9597392082214355
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0914554595947266
Epoch: 10, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.191372871398926
Epoch: 11, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.613 Vali Acc: 0.751 Test Loss: 0.613 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.947850227355957
Epoch: 12, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.879 Vali Acc: 0.727 Test Loss: 0.879 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9352049827575684
Epoch: 13, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.677 Vali Acc: 0.732 Test Loss: 0.677 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2523422241210938
Epoch: 14, Steps: 13 | Train Loss: 0.067 Vali Loss: 0.768 Vali Acc: 0.751 Test Loss: 0.768 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 751242
model size : 5.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.092562913894653
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.576 Vali Acc: 0.707 Test Loss: 0.576 Test Acc: 0.707
Validation loss decreased (inf --> -0.707311).  Saving model ...
Epoch: 2 cost time: 2.6255455017089844
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.557 Vali Acc: 0.746 Test Loss: 0.557 Test Acc: 0.746
Validation loss decreased (-0.707311 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.4170618057250977
Epoch: 3, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.574 Vali Acc: 0.746 Test Loss: 0.574 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4999215602874756
Epoch: 4, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.604 Vali Acc: 0.746 Test Loss: 0.604 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.618896007537842
Epoch: 5, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.683 Vali Acc: 0.741 Test Loss: 0.683 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1819405555725098
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.871 Vali Acc: 0.732 Test Loss: 0.871 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.611158847808838
Epoch: 7, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.701 Vali Acc: 0.732 Test Loss: 0.701 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6855437755584717
Epoch: 8, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.669 Vali Acc: 0.741 Test Loss: 0.669 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.4951674938201904
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.780 Vali Acc: 0.654 Test Loss: 0.780 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0068838596343994
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.0223605632781982
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.076 Vali Acc: 0.727 Test Loss: 1.076 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.671346426010132
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.991 Vali Acc: 0.737 Test Loss: 0.991 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 489098
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.189603805541992
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.7648744583129883
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.727428436279297
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5905303955078125
Epoch: 4, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.591 Vali Acc: 0.751 Test Loss: 0.591 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.3057494163513184
Epoch: 5, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6157784461975098
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.889 Vali Acc: 0.737 Test Loss: 0.889 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.642392158508301
Epoch: 7, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.640 Vali Acc: 0.727 Test Loss: 0.640 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4490866661071777
Epoch: 8, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.014829158782959
Epoch: 9, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.698 Vali Acc: 0.673 Test Loss: 0.698 Test Acc: 0.673
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8483388423919678
Epoch: 10, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.793 Vali Acc: 0.707 Test Loss: 0.793 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.157285690307617
Epoch: 11, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.095 Vali Acc: 0.727 Test Loss: 1.095 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5973031520843506
Epoch: 12, Steps: 13 | Train Loss: 0.101 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.768385887145996
Epoch: 13, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.890 Vali Acc: 0.668 Test Loss: 0.890 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5206048488616943
Epoch: 14, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.943 Vali Acc: 0.654 Test Loss: 0.943 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 489098
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.703575611114502
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.3285977840423584
Epoch: 2, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.3852555751800537
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2304420471191406
Epoch: 4, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 2.123974561691284
Epoch: 5, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 6 cost time: 2.2305076122283936
Epoch: 6, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.838 Vali Acc: 0.737 Test Loss: 0.838 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1030919551849365
Epoch: 7, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0792481899261475
Epoch: 8, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0694162845611572
Epoch: 9, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8979682922363281
Epoch: 10, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.668 Vali Acc: 0.698 Test Loss: 0.668 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0333786010742188
Epoch: 11, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.877 Vali Acc: 0.732 Test Loss: 0.877 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.182283639907837
Epoch: 12, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.3026349544525146
Epoch: 13, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.821 Vali Acc: 0.639 Test Loss: 0.821 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3405039310455322
Epoch: 14, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.828 Vali Acc: 0.659 Test Loss: 0.828 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.49220871925354
Epoch: 15, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.965 Vali Acc: 0.702 Test Loss: 0.965 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 489098
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.758807420730591
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.0417566299438477
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.9751811027526855
Epoch: 3, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.350590944290161
Epoch: 4, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 2.09061598777771
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.663 Vali Acc: 0.732 Test Loss: 0.663 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.062387228012085
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.798 Vali Acc: 0.732 Test Loss: 0.798 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.097264051437378
Epoch: 7, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 8 cost time: 2.0653579235076904
Epoch: 8, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.558 Vali Acc: 0.702 Test Loss: 0.558 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2081379890441895
Epoch: 9, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.575 Vali Acc: 0.702 Test Loss: 0.575 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4481050968170166
Epoch: 10, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.911 Vali Acc: 0.737 Test Loss: 0.911 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9233667850494385
Epoch: 11, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.105 Vali Acc: 0.741 Test Loss: 1.105 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.215222120285034
Epoch: 12, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.914 Vali Acc: 0.732 Test Loss: 0.914 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3743183612823486
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.743 Vali Acc: 0.756 Test Loss: 0.743 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756090).  Saving model ...
Epoch: 14 cost time: 2.1554677486419678
Epoch: 14, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.786 Vali Acc: 0.649 Test Loss: 0.786 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1312222480773926
Epoch: 15, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.821 Vali Acc: 0.707 Test Loss: 0.821 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0724196434020996
Epoch: 16, Steps: 13 | Train Loss: 0.038 Vali Loss: 0.912 Vali Acc: 0.717 Test Loss: 0.912 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2803666591644287
Epoch: 17, Steps: 13 | Train Loss: 0.025 Vali Loss: 0.969 Vali Acc: 0.702 Test Loss: 0.969 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7896549701690674
Epoch: 18, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.120 Vali Acc: 0.741 Test Loss: 1.120 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.388637065887451
Epoch: 19, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.539 Vali Acc: 0.722 Test Loss: 1.539 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.269558906555176
Epoch: 20, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.388 Vali Acc: 0.722 Test Loss: 1.388 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.324845552444458
Epoch: 21, Steps: 13 | Train Loss: 0.005 Vali Loss: 1.222 Vali Acc: 0.722 Test Loss: 1.222 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.309370756149292
Epoch: 22, Steps: 13 | Train Loss: 0.005 Vali Loss: 2.098 Vali Acc: 0.727 Test Loss: 2.098 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1732497215270996
Epoch: 23, Steps: 13 | Train Loss: 0.006 Vali Loss: 1.433 Vali Acc: 0.678 Test Loss: 1.433 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 489098
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.612586498260498
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.683547019958496
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.6007487773895264
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7149219512939453
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.677 Vali Acc: 0.732 Test Loss: 0.677 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1095595359802246
Epoch: 5, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.288893461227417
Epoch: 6, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.778 Vali Acc: 0.727 Test Loss: 0.778 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5500199794769287
Epoch: 7, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736578).  Saving model ...
Epoch: 8 cost time: 2.459270715713501
Epoch: 8, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.956 Vali Acc: 0.727 Test Loss: 0.956 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8776333332061768
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.848 Vali Acc: 0.722 Test Loss: 0.848 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6237599849700928
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.734 Vali Acc: 0.727 Test Loss: 0.734 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.6125664710998535
Epoch: 11, Steps: 13 | Train Loss: 0.128 Vali Loss: 1.046 Vali Acc: 0.722 Test Loss: 1.046 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7948789596557617
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.903 Vali Acc: 0.688 Test Loss: 0.903 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3465566635131836
Epoch: 13, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.106 Vali Acc: 0.663 Test Loss: 1.106 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.2429680824279785
Epoch: 14, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.117 Vali Acc: 0.649 Test Loss: 1.117 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.525644302368164
Epoch: 15, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.062 Vali Acc: 0.663 Test Loss: 1.062 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.522294282913208
Epoch: 16, Steps: 13 | Train Loss: 0.037 Vali Loss: 1.055 Vali Acc: 0.707 Test Loss: 1.055 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6824100017547607
Epoch: 17, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.270 Vali Acc: 0.727 Test Loss: 1.270 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 358026
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.649822235107422
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.2771482467651367
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.560 Vali Acc: 0.717 Test Loss: 0.560 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2672600746154785
Epoch: 3, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.725 Vali Acc: 0.712 Test Loss: 0.725 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4312989711761475
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 2.5229852199554443
Epoch: 5, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 2.374401807785034
Epoch: 6, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.699 Vali Acc: 0.732 Test Loss: 0.699 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.234001636505127
Epoch: 7, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 8 cost time: 2.5132498741149902
Epoch: 8, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.983 Vali Acc: 0.737 Test Loss: 0.983 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1481311321258545
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.877 Vali Acc: 0.727 Test Loss: 0.877 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9470643997192383
Epoch: 10, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.709 Vali Acc: 0.707 Test Loss: 0.709 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1716041564941406
Epoch: 11, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.975 Vali Acc: 0.727 Test Loss: 0.975 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6102848052978516
Epoch: 12, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.833 Vali Acc: 0.678 Test Loss: 0.833 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3794054985046387
Epoch: 13, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.921 Vali Acc: 0.668 Test Loss: 0.921 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.572540521621704
Epoch: 14, Steps: 13 | Train Loss: 0.084 Vali Loss: 1.044 Vali Acc: 0.644 Test Loss: 1.044 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6390631198883057
Epoch: 15, Steps: 13 | Train Loss: 0.079 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.41603946685791
Epoch: 16, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.077 Vali Acc: 0.756 Test Loss: 1.077 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756087).  Saving model ...
Epoch: 17 cost time: 2.5763301849365234
Epoch: 17, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.350 Vali Acc: 0.732 Test Loss: 1.350 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4452099800109863
Epoch: 18, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.113 Vali Acc: 0.712 Test Loss: 1.113 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5122694969177246
Epoch: 19, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.223 Vali Acc: 0.732 Test Loss: 1.223 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.475492238998413
Epoch: 20, Steps: 13 | Train Loss: 0.007 Vali Loss: 1.584 Vali Acc: 0.727 Test Loss: 1.584 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4817075729370117
Epoch: 21, Steps: 13 | Train Loss: 0.012 Vali Loss: 1.433 Vali Acc: 0.722 Test Loss: 1.433 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.51802659034729
Epoch: 22, Steps: 13 | Train Loss: 0.011 Vali Loss: 1.334 Vali Acc: 0.654 Test Loss: 1.334 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6929879188537598
Epoch: 23, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.671 Vali Acc: 0.737 Test Loss: 1.671 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3857898712158203
Epoch: 24, Steps: 13 | Train Loss: 0.029 Vali Loss: 1.412 Vali Acc: 0.751 Test Loss: 1.412 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.780378818511963
Epoch: 25, Steps: 13 | Train Loss: 0.001 Vali Loss: 1.690 Vali Acc: 0.741 Test Loss: 1.690 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.67338490486145
Epoch: 26, Steps: 13 | Train Loss: 0.002 Vali Loss: 1.729 Vali Acc: 0.722 Test Loss: 1.729 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 358026
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.128315210342407
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.311245918273926
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 2.498500108718872
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.703 Vali Acc: 0.722 Test Loss: 0.703 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1272337436676025
Epoch: 4, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.721946 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 2.125150203704834
Epoch: 5, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.606379747390747
Epoch: 6, Steps: 13 | Train Loss: 0.359 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7612392902374268
Epoch: 7, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.569 Vali Acc: 0.751 Test Loss: 0.569 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.4600677490234375
Epoch: 8, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.935 Vali Acc: 0.732 Test Loss: 0.935 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.436818838119507
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.810 Vali Acc: 0.737 Test Loss: 0.810 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3952813148498535
Epoch: 10, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.640 Vali Acc: 0.698 Test Loss: 0.640 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3691256046295166
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.795 Vali Acc: 0.732 Test Loss: 0.795 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5060641765594482
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.704 Vali Acc: 0.688 Test Loss: 0.704 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3721354007720947
Epoch: 13, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.922 Vali Acc: 0.629 Test Loss: 0.922 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0831658840179443
Epoch: 14, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.852 Vali Acc: 0.683 Test Loss: 0.852 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.196200370788574
Epoch: 15, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.433717966079712
Epoch: 16, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.046 Vali Acc: 0.712 Test Loss: 1.046 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5629212856292725
Epoch: 17, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.311 Vali Acc: 0.717 Test Loss: 1.311 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 358026
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.529636383056641
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.0544984340667725
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.8461809158325195
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.004152536392212
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.925553560256958
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.632 Vali Acc: 0.746 Test Loss: 0.632 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8686983585357666
Epoch: 6, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.591 Vali Acc: 0.756 Test Loss: 0.591 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.721083641052246
Epoch: 7, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8187720775604248
Epoch: 8, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.863 Vali Acc: 0.732 Test Loss: 0.863 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6879069805145264
Epoch: 9, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.781031608581543
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.623 Vali Acc: 0.659 Test Loss: 0.623 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8475751876831055
Epoch: 11, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.804 Vali Acc: 0.741 Test Loss: 0.804 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8317933082580566
Epoch: 12, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.703 Vali Acc: 0.727 Test Loss: 0.703 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9975640773773193
Epoch: 13, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.693 Vali Acc: 0.673 Test Loss: 0.693 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0125813484191895
Epoch: 14, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.976 Vali Acc: 0.624 Test Loss: 0.976 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7928593158721924
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.898 Vali Acc: 0.668 Test Loss: 0.898 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.93101167678833
Epoch: 16, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.089 Vali Acc: 0.712 Test Loss: 1.089 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 358026
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.838742971420288
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.5148487091064453
Epoch: 2, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.352820873260498
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 2.4615767002105713
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.832 Vali Acc: 0.556 Test Loss: 0.832 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.310180902481079
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.743 Vali Acc: 0.659 Test Loss: 0.743 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8268542289733887
Epoch: 6, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 2.605823516845703
Epoch: 7, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.400916576385498
Epoch: 8, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.706 Vali Acc: 0.741 Test Loss: 0.706 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.249988079071045
Epoch: 9, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.776 Vali Acc: 0.741 Test Loss: 0.776 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3574438095092773
Epoch: 10, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.793 Vali Acc: 0.746 Test Loss: 0.793 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 11 cost time: 2.637166738510132
Epoch: 11, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.838 Vali Acc: 0.649 Test Loss: 0.838 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.359234094619751
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.860 Vali Acc: 0.712 Test Loss: 0.860 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6125173568725586
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.964 Vali Acc: 0.727 Test Loss: 0.964 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5230486392974854
Epoch: 14, Steps: 13 | Train Loss: 0.068 Vali Loss: 0.984 Vali Acc: 0.717 Test Loss: 0.984 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.422943115234375
Epoch: 15, Steps: 13 | Train Loss: 0.048 Vali Loss: 1.256 Vali Acc: 0.741 Test Loss: 1.256 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.968722343444824
Epoch: 16, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.149 Vali Acc: 0.659 Test Loss: 1.149 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.535395860671997
Epoch: 17, Steps: 13 | Train Loss: 0.036 Vali Loss: 1.189 Vali Acc: 0.717 Test Loss: 1.189 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3268516063690186
Epoch: 18, Steps: 13 | Train Loss: 0.022 Vali Loss: 1.309 Vali Acc: 0.722 Test Loss: 1.309 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.079537868499756
Epoch: 19, Steps: 13 | Train Loss: 0.023 Vali Loss: 1.324 Vali Acc: 0.717 Test Loss: 1.324 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.694462299346924
Epoch: 20, Steps: 13 | Train Loss: 0.013 Vali Loss: 1.315 Vali Acc: 0.707 Test Loss: 1.315 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 292490
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.054825782775879
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.282094955444336
Epoch: 2, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.2524540424346924
Epoch: 3, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.3827085494995117
Epoch: 4, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.801 Vali Acc: 0.561 Test Loss: 0.801 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.402916193008423
Epoch: 5, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.723 Vali Acc: 0.663 Test Loss: 0.723 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.276154041290283
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 2.45963191986084
Epoch: 7, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.589 Vali Acc: 0.698 Test Loss: 0.589 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.426604747772217
Epoch: 8, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.672 Vali Acc: 0.741 Test Loss: 0.672 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.168715715408325
Epoch: 9, Steps: 13 | Train Loss: 0.216 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9841699600219727
Epoch: 10, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.718 Vali Acc: 0.741 Test Loss: 0.718 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2164201736450195
Epoch: 11, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.684 Vali Acc: 0.693 Test Loss: 0.684 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0925116539001465
Epoch: 12, Steps: 13 | Train Loss: 0.108 Vali Loss: 0.772 Vali Acc: 0.707 Test Loss: 0.772 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0668447017669678
Epoch: 13, Steps: 13 | Train Loss: 0.105 Vali Loss: 0.830 Vali Acc: 0.712 Test Loss: 0.830 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1793200969696045
Epoch: 14, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.894 Vali Acc: 0.702 Test Loss: 0.894 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.495164155960083
Epoch: 15, Steps: 13 | Train Loss: 0.047 Vali Loss: 1.209 Vali Acc: 0.741 Test Loss: 1.209 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1751086711883545
Epoch: 16, Steps: 13 | Train Loss: 0.035 Vali Loss: 1.066 Vali Acc: 0.659 Test Loss: 1.066 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 292490
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5492844581604
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.307762861251831
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.3540048599243164
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1151931285858154
Epoch: 4, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.207608461380005
Epoch: 5, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 2.529437780380249
Epoch: 6, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 2.2607855796813965
Epoch: 7, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.661 Vali Acc: 0.741 Test Loss: 0.661 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3004050254821777
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.653 Vali Acc: 0.654 Test Loss: 0.653 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3030812740325928
Epoch: 9, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.604 Vali Acc: 0.707 Test Loss: 0.604 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4286036491394043
Epoch: 10, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6018338203430176
Epoch: 11, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.713 Vali Acc: 0.732 Test Loss: 0.713 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.511521339416504
Epoch: 12, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.786 Vali Acc: 0.737 Test Loss: 0.786 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3940024375915527
Epoch: 13, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.750 Vali Acc: 0.698 Test Loss: 0.750 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3381154537200928
Epoch: 14, Steps: 13 | Train Loss: 0.086 Vali Loss: 0.802 Vali Acc: 0.702 Test Loss: 0.802 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.425140380859375
Epoch: 15, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.334 Vali Acc: 0.727 Test Loss: 1.334 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.4877066612243652
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 0.971 Vali Acc: 0.717 Test Loss: 0.971 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 292490
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.7243568897247314
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.22713041305542
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.555 Vali Acc: 0.746 Test Loss: 0.555 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 2.173675537109375
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.567 Vali Acc: 0.746 Test Loss: 0.567 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.257101058959961
Epoch: 4, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.652 Vali Acc: 0.659 Test Loss: 0.652 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1921377182006836
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.552 Vali Acc: 0.707 Test Loss: 0.552 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0858774185180664
Epoch: 6, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.1599783897399902
Epoch: 7, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.576 Vali Acc: 0.766 Test Loss: 0.576 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765848).  Saving model ...
Epoch: 8 cost time: 1.9169402122497559
Epoch: 8, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.582 Vali Acc: 0.659 Test Loss: 0.582 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8635215759277344
Epoch: 9, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8546161651611328
Epoch: 10, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.064450740814209
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.686 Vali Acc: 0.732 Test Loss: 0.686 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.168445348739624
Epoch: 12, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.772 Vali Acc: 0.727 Test Loss: 0.772 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8872349262237549
Epoch: 13, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.663 Vali Acc: 0.751 Test Loss: 0.663 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.90289306640625
Epoch: 14, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.745 Vali Acc: 0.727 Test Loss: 0.745 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.925856590270996
Epoch: 15, Steps: 13 | Train Loss: 0.078 Vali Loss: 0.941 Vali Acc: 0.732 Test Loss: 0.941 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1357195377349854
Epoch: 16, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.019 Vali Acc: 0.668 Test Loss: 1.019 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.097308874130249
Epoch: 17, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 292490
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.6727423667907715
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.591 Vali Acc: 0.712 Test Loss: 0.591 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.5257043838500977
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
Validation loss decreased (-0.712189 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 2.250645399093628
Epoch: 3, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.348520278930664
Epoch: 4, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.090099811553955
Epoch: 5, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.602 Vali Acc: 0.746 Test Loss: 0.602 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.378405809402466
Epoch: 6, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.689 Vali Acc: 0.746 Test Loss: 0.689 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.325881242752075
Epoch: 7, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1168928146362305
Epoch: 8, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.735 Vali Acc: 0.746 Test Loss: 0.735 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2655274868011475
Epoch: 9, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.877 Vali Acc: 0.746 Test Loss: 0.877 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.0684642791748047
Epoch: 10, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.865 Vali Acc: 0.737 Test Loss: 0.865 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.363140344619751
Epoch: 11, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.930 Vali Acc: 0.737 Test Loss: 0.930 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.168607473373413
Epoch: 12, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.884 Vali Acc: 0.693 Test Loss: 0.884 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.154599905014038
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.891 Vali Acc: 0.673 Test Loss: 0.891 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 259722
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.647216081619263
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.147702932357788
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 2.012028694152832
Epoch: 3, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.555 Vali Acc: 0.756 Test Loss: 0.555 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.9976646900177002
Epoch: 4, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.643 Vali Acc: 0.737 Test Loss: 0.643 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2771167755126953
Epoch: 5, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.618 Vali Acc: 0.741 Test Loss: 0.618 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9238908290863037
Epoch: 6, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.638 Vali Acc: 0.741 Test Loss: 0.638 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.27502179145813
Epoch: 7, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.627 Vali Acc: 0.741 Test Loss: 0.627 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.121880292892456
Epoch: 8, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.145745038986206
Epoch: 9, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.831 Vali Acc: 0.737 Test Loss: 0.831 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1357553005218506
Epoch: 10, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.796 Vali Acc: 0.737 Test Loss: 0.796 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.434018611907959
Epoch: 11, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.721 Vali Acc: 0.722 Test Loss: 0.721 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5366506576538086
Epoch: 12, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.839 Vali Acc: 0.732 Test Loss: 0.839 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3056836128234863
Epoch: 13, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.958 Vali Acc: 0.741 Test Loss: 0.958 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 259722
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.548292398452759
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.951061487197876
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.588 Vali Acc: 0.751 Test Loss: 0.588 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 2.274702787399292
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8547589778900146
Epoch: 4, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.683 Vali Acc: 0.722 Test Loss: 0.683 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.05869460105896
Epoch: 5, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.986307144165039
Epoch: 6, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.555 Vali Acc: 0.732 Test Loss: 0.555 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0913052558898926
Epoch: 7, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8411543369293213
Epoch: 8, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.946 Vali Acc: 0.727 Test Loss: 0.946 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1524312496185303
Epoch: 9, Steps: 13 | Train Loss: 0.317 Vali Loss: 1.164 Vali Acc: 0.717 Test Loss: 1.164 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.088411808013916
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.812 Vali Acc: 0.732 Test Loss: 0.812 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.2366127967834473
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.770 Vali Acc: 0.732 Test Loss: 0.770 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.434380292892456
Epoch: 12, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.754 Vali Acc: 0.707 Test Loss: 0.754 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 259722
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.697926044464111
Epoch: 1, Steps: 13 | Train Loss: 0.617 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.093207359313965
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.570 Vali Acc: 0.751 Test Loss: 0.570 Test Acc: 0.751
Validation loss decreased (-0.717067 --> -0.751214).  Saving model ...
Epoch: 3 cost time: 1.8243250846862793
Epoch: 3, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 2.0003883838653564
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.677 Vali Acc: 0.727 Test Loss: 0.677 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0108704566955566
Epoch: 5, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.568 Vali Acc: 0.761 Test Loss: 0.568 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 6 cost time: 1.911231279373169
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.533 Vali Acc: 0.751 Test Loss: 0.533 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1603000164031982
Epoch: 7, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.574 Vali Acc: 0.751 Test Loss: 0.574 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.00264048576355
Epoch: 8, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.994 Vali Acc: 0.732 Test Loss: 0.994 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.0715348720550537
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 1.122 Vali Acc: 0.732 Test Loss: 1.122 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1169185638427734
Epoch: 10, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.800 Vali Acc: 0.737 Test Loss: 0.800 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1554038524627686
Epoch: 11, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.035269260406494
Epoch: 12, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.743 Vali Acc: 0.717 Test Loss: 0.743 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.962183952331543
Epoch: 13, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.0319619178771973
Epoch: 14, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.841 Vali Acc: 0.746 Test Loss: 0.841 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.9011621475219727
Epoch: 15, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.882 Vali Acc: 0.693 Test Loss: 0.882 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 259722
model size : 3.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.854318141937256
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.422010898590088
Epoch: 2, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.4573750495910645
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.630176067352295
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.615 Vali Acc: 0.751 Test Loss: 0.615 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 2.4541587829589844
Epoch: 5, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6000137329101562
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.588 Vali Acc: 0.732 Test Loss: 0.588 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3903963565826416
Epoch: 7, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.373710870742798
Epoch: 8, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.607 Vali Acc: 0.746 Test Loss: 0.607 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3107166290283203
Epoch: 9, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.46336030960083
Epoch: 10, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.371764659881592
Epoch: 11, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.718 Vali Acc: 0.722 Test Loss: 0.718 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.3796470165252686
Epoch: 12, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.704 Vali Acc: 0.693 Test Loss: 0.704 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3940517902374268
Epoch: 13, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.759 Vali Acc: 0.702 Test Loss: 0.759 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2980196475982666
Epoch: 14, Steps: 13 | Train Loss: 0.118 Vali Loss: 0.781 Vali Acc: 0.693 Test Loss: 0.781 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 621642
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.275461435317993
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.436000347137451
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1248135566711426
Epoch: 3, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 2.1676511764526367
Epoch: 4, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.608 Vali Acc: 0.732 Test Loss: 0.608 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.430551767349243
Epoch: 5, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4151692390441895
Epoch: 6, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.318943500518799
Epoch: 7, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.604 Vali Acc: 0.712 Test Loss: 0.604 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.3236777782440186
Epoch: 8, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.242011547088623
Epoch: 9, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.612 Vali Acc: 0.707 Test Loss: 0.612 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2283568382263184
Epoch: 10, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.648 Vali Acc: 0.717 Test Loss: 0.648 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.709904432296753
Epoch: 11, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.659 Vali Acc: 0.707 Test Loss: 0.659 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5194220542907715
Epoch: 12, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.678 Vali Acc: 0.693 Test Loss: 0.678 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.286067247390747
Epoch: 13, Steps: 13 | Train Loss: 0.157 Vali Loss: 0.677 Vali Acc: 0.707 Test Loss: 0.677 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 621642
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5592827796936035
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.608 Vali Acc: 0.722 Test Loss: 0.608 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.196404457092285
Epoch: 2, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.0386550426483154
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 2.399000644683838
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.721946 --> -0.760970).  Saving model ...
Epoch: 5 cost time: 2.076871156692505
Epoch: 5, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9907004833221436
Epoch: 6, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.542 Vali Acc: 0.761 Test Loss: 0.542 Test Acc: 0.761
Validation loss decreased (-0.760970 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.3374810218811035
Epoch: 7, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.550 Vali Acc: 0.717 Test Loss: 0.550 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1629867553710938
Epoch: 8, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.545 Vali Acc: 0.741 Test Loss: 0.545 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.097872734069824
Epoch: 9, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.581 Vali Acc: 0.746 Test Loss: 0.581 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.19018292427063
Epoch: 10, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1435718536376953
Epoch: 11, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.693 Vali Acc: 0.727 Test Loss: 0.693 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.211127758026123
Epoch: 12, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9087269306182861
Epoch: 13, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.703 Vali Acc: 0.707 Test Loss: 0.703 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0671591758728027
Epoch: 14, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.728 Vali Acc: 0.722 Test Loss: 0.728 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.117614269256592
Epoch: 15, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.714 Vali Acc: 0.698 Test Loss: 0.714 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.209564208984375
Epoch: 16, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.734 Vali Acc: 0.678 Test Loss: 0.734 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 621642
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.035456418991089
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8744840621948242
Epoch: 2, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 2.052988052368164
Epoch: 3, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.9771137237548828
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.544 Vali Acc: 0.771 Test Loss: 0.544 Test Acc: 0.771
Validation loss decreased (-0.736580 --> -0.770726).  Saving model ...
Epoch: 5 cost time: 2.4116873741149902
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.520 Vali Acc: 0.766 Test Loss: 0.520 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.274759292602539
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.507 Vali Acc: 0.766 Test Loss: 0.507 Test Acc: 0.766
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6422789096832275
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.506 Vali Acc: 0.741 Test Loss: 0.506 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1960341930389404
Epoch: 8, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.551 Vali Acc: 0.771 Test Loss: 0.551 Test Acc: 0.771
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.641071319580078
Epoch: 9, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
Validation loss decreased (-0.770726 --> -0.780482).  Saving model ...
Epoch: 10 cost time: 2.5491883754730225
Epoch: 10, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.557 Vali Acc: 0.751 Test Loss: 0.557 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1785573959350586
Epoch: 11, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.662 Vali Acc: 0.751 Test Loss: 0.662 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2550361156463623
Epoch: 12, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.563 Vali Acc: 0.746 Test Loss: 0.563 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3183865547180176
Epoch: 13, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.953810214996338
Epoch: 14, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.597 Vali Acc: 0.746 Test Loss: 0.597 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2213096618652344
Epoch: 15, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.189842700958252
Epoch: 16, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.622 Vali Acc: 0.683 Test Loss: 0.622 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.341935157775879
Epoch: 17, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.671 Vali Acc: 0.673 Test Loss: 0.671 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.388016939163208
Epoch: 18, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.706 Vali Acc: 0.668 Test Loss: 0.706 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.1850504875183105
Epoch: 19, Steps: 13 | Train Loss: 0.073 Vali Loss: 0.758 Vali Acc: 0.698 Test Loss: 0.758 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7804878048780488
model parameter : 621642
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.578228235244751
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.2867326736450195
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9253251552581787
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.598 Vali Acc: 0.746 Test Loss: 0.598 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 2.0115389823913574
Epoch: 4, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.606 Vali Acc: 0.756 Test Loss: 0.606 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.7164349555969238
Epoch: 5, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.569 Vali Acc: 0.732 Test Loss: 0.569 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9898648262023926
Epoch: 6, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.736 Vali Acc: 0.737 Test Loss: 0.736 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0771336555480957
Epoch: 7, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.619 Vali Acc: 0.751 Test Loss: 0.619 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1886961460113525
Epoch: 8, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1681299209594727
Epoch: 9, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.687 Vali Acc: 0.741 Test Loss: 0.687 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2200372219085693
Epoch: 10, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.677 Vali Acc: 0.737 Test Loss: 0.677 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0317745208740234
Epoch: 11, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.723 Vali Acc: 0.737 Test Loss: 0.723 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9425866603851318
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.754 Vali Acc: 0.741 Test Loss: 0.754 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.228593349456787
Epoch: 13, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.779 Vali Acc: 0.746 Test Loss: 0.779 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.792250156402588
Epoch: 14, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.807 Vali Acc: 0.741 Test Loss: 0.807 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 359498
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.512286424636841
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.050750494003296
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.254340171813965
Epoch: 3, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 2.107027530670166
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0956356525421143
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 2.027662754058838
Epoch: 6, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.713 Vali Acc: 0.727 Test Loss: 0.713 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.209968090057373
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.593 Vali Acc: 0.751 Test Loss: 0.593 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 1.9710776805877686
Epoch: 8, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.569 Vali Acc: 0.717 Test Loss: 0.569 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9569947719573975
Epoch: 9, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.956740379333496
Epoch: 10, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.623 Vali Acc: 0.741 Test Loss: 0.623 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8040335178375244
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.674 Vali Acc: 0.741 Test Loss: 0.674 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.86409592628479
Epoch: 12, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8278098106384277
Epoch: 13, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.746 Vali Acc: 0.702 Test Loss: 0.746 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7199242115020752
Epoch: 14, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.782 Vali Acc: 0.707 Test Loss: 0.782 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9454481601715088
Epoch: 15, Steps: 13 | Train Loss: 0.116 Vali Loss: 0.802 Vali Acc: 0.717 Test Loss: 0.802 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7541918754577637
Epoch: 16, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.789 Vali Acc: 0.732 Test Loss: 0.789 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.4273433685302734
Epoch: 17, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.894 Vali Acc: 0.737 Test Loss: 0.894 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 359498
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.321404933929443
Epoch: 1, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.934370994567871
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 2.14018177986145
Epoch: 3, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.9864826202392578
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.574 Vali Acc: 0.727 Test Loss: 0.574 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8981232643127441
Epoch: 5, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.540 Vali Acc: 0.746 Test Loss: 0.540 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.9833416938781738
Epoch: 6, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.740 Vali Acc: 0.746 Test Loss: 0.740 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1136348247528076
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.620 Vali Acc: 0.766 Test Loss: 0.620 Test Acc: 0.766
Validation loss decreased (-0.746336 --> -0.765847).  Saving model ...
Epoch: 8 cost time: 2.076120138168335
Epoch: 8, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.557 Vali Acc: 0.756 Test Loss: 0.557 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9945461750030518
Epoch: 9, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.099761962890625
Epoch: 10, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.647 Vali Acc: 0.732 Test Loss: 0.647 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.154630422592163
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0928542613983154
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.689 Vali Acc: 0.741 Test Loss: 0.689 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1070802211761475
Epoch: 13, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.705 Vali Acc: 0.707 Test Loss: 0.705 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9941675662994385
Epoch: 14, Steps: 13 | Train Loss: 0.145 Vali Loss: 0.753 Vali Acc: 0.727 Test Loss: 0.753 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1397197246551514
Epoch: 15, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.865 Vali Acc: 0.732 Test Loss: 0.865 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0699472427368164
Epoch: 16, Steps: 13 | Train Loss: 0.111 Vali Loss: 0.865 Vali Acc: 0.727 Test Loss: 0.865 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9895939826965332
Epoch: 17, Steps: 13 | Train Loss: 0.104 Vali Loss: 1.183 Vali Acc: 0.727 Test Loss: 1.183 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 359498
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.070319414138794
Epoch: 1, Steps: 13 | Train Loss: 0.601 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6912672519683838
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.8269076347351074
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 2.0528531074523926
Epoch: 4, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.0017738342285156
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.532 Vali Acc: 0.751 Test Loss: 0.532 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.858853816986084
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.703 Vali Acc: 0.732 Test Loss: 0.703 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9559082984924316
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.552 Vali Acc: 0.756 Test Loss: 0.552 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 2.0084052085876465
Epoch: 8, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.509 Vali Acc: 0.756 Test Loss: 0.509 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 1.992753505706787
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.658 Vali Acc: 0.751 Test Loss: 0.658 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.077298641204834
Epoch: 10, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.587 Vali Acc: 0.785 Test Loss: 0.587 Test Acc: 0.785
Validation loss decreased (-0.756092 --> -0.785360).  Saving model ...
Epoch: 11 cost time: 1.9404816627502441
Epoch: 11, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.689 Vali Acc: 0.766 Test Loss: 0.689 Test Acc: 0.766
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9002671241760254
Epoch: 12, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.713 Vali Acc: 0.756 Test Loss: 0.713 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1237716674804688
Epoch: 13, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7947089672088623
Epoch: 14, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.661 Vali Acc: 0.756 Test Loss: 0.661 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8537583351135254
Epoch: 15, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.844 Vali Acc: 0.751 Test Loss: 0.844 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8654754161834717
Epoch: 16, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.04594087600708
Epoch: 17, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.955 Vali Acc: 0.746 Test Loss: 0.955 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0692365169525146
Epoch: 18, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.847 Vali Acc: 0.737 Test Loss: 0.847 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0907068252563477
Epoch: 19, Steps: 13 | Train Loss: 0.078 Vali Loss: 1.095 Vali Acc: 0.741 Test Loss: 1.095 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9684207439422607
Epoch: 20, Steps: 13 | Train Loss: 0.091 Vali Loss: 1.135 Vali Acc: 0.741 Test Loss: 1.135 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7853658536585366
model parameter : 359498
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.41846776008606
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8902575969696045
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.648 Vali Acc: 0.712 Test Loss: 0.648 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.040973663330078
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.664 Vali Acc: 0.727 Test Loss: 0.664 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 2.0805091857910156
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.043595314025879
Epoch: 5, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.703 Vali Acc: 0.629 Test Loss: 0.703 Test Acc: 0.629
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1934335231781006
Epoch: 6, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.632 Vali Acc: 0.741 Test Loss: 0.632 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 2.2793960571289062
Epoch: 7, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.635 Vali Acc: 0.722 Test Loss: 0.635 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.182560682296753
Epoch: 8, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1100168228149414
Epoch: 9, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.640 Vali Acc: 0.707 Test Loss: 0.640 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9289867877960205
Epoch: 10, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.650 Vali Acc: 0.717 Test Loss: 0.650 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8029749393463135
Epoch: 11, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.744 Vali Acc: 0.639 Test Loss: 0.744 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3018033504486084
Epoch: 12, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.711 Vali Acc: 0.737 Test Loss: 0.711 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7676541805267334
Epoch: 13, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1728415489196777
Epoch: 14, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8752155303955078
Epoch: 15, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.910 Vali Acc: 0.620 Test Loss: 0.910 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.091848850250244
Epoch: 16, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.849 Vali Acc: 0.688 Test Loss: 0.849 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 228426
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.2551093101501465
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9719939231872559
Epoch: 2, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.648 Vali Acc: 0.712 Test Loss: 0.648 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9861209392547607
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.637 Vali Acc: 0.722 Test Loss: 0.637 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1531684398651123
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 5 cost time: 1.999009132385254
Epoch: 5, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.694 Vali Acc: 0.634 Test Loss: 0.694 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9642388820648193
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
Validation loss decreased (-0.721946 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 1.8453364372253418
Epoch: 7, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731701).  Saving model ...
Epoch: 8 cost time: 2.284668445587158
Epoch: 8, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 9 cost time: 1.7370905876159668
Epoch: 9, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.619 Vali Acc: 0.688 Test Loss: 0.619 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8382163047790527
Epoch: 10, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.633 Vali Acc: 0.707 Test Loss: 0.633 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7497460842132568
Epoch: 11, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.754 Vali Acc: 0.629 Test Loss: 0.754 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7418954372406006
Epoch: 12, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.695 Vali Acc: 0.741 Test Loss: 0.695 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741456).  Saving model ...
Epoch: 13 cost time: 1.6834287643432617
Epoch: 13, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.691 Vali Acc: 0.688 Test Loss: 0.691 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0462353229522705
Epoch: 14, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.722 Vali Acc: 0.688 Test Loss: 0.722 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8517932891845703
Epoch: 15, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.860 Vali Acc: 0.659 Test Loss: 0.860 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9443614482879639
Epoch: 16, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.806 Vali Acc: 0.712 Test Loss: 0.806 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.032449960708618
Epoch: 17, Steps: 13 | Train Loss: 0.127 Vali Loss: 1.067 Vali Acc: 0.741 Test Loss: 1.067 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9393205642700195
Epoch: 18, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.202 Vali Acc: 0.737 Test Loss: 1.202 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7888333797454834
Epoch: 19, Steps: 13 | Train Loss: 0.063 Vali Loss: 1.058 Vali Acc: 0.741 Test Loss: 1.058 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0540823936462402
Epoch: 20, Steps: 13 | Train Loss: 0.064 Vali Loss: 0.942 Vali Acc: 0.698 Test Loss: 0.942 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1782774925231934
Epoch: 21, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.977 Vali Acc: 0.688 Test Loss: 0.977 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0937159061431885
Epoch: 22, Steps: 13 | Train Loss: 0.021 Vali Loss: 1.156 Vali Acc: 0.727 Test Loss: 1.156 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 228426
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.508761167526245
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9657244682312012
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.850548267364502
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8663380146026611
Epoch: 4, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.5310993194580078
Epoch: 5, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.691 Vali Acc: 0.595 Test Loss: 0.691 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6962976455688477
Epoch: 6, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.669398307800293
Epoch: 7, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.7195022106170654
Epoch: 8, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.559 Vali Acc: 0.741 Test Loss: 0.559 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.794050693511963
Epoch: 9, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9154479503631592
Epoch: 10, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8271105289459229
Epoch: 11, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.612 Vali Acc: 0.663 Test Loss: 0.612 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9355409145355225
Epoch: 12, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8838038444519043
Epoch: 13, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.659 Vali Acc: 0.663 Test Loss: 0.659 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9687728881835938
Epoch: 14, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.95314621925354
Epoch: 15, Steps: 13 | Train Loss: 0.135 Vali Loss: 0.707 Vali Acc: 0.698 Test Loss: 0.707 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.839439868927002
Epoch: 16, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.731 Vali Acc: 0.688 Test Loss: 0.731 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9133458137512207
Epoch: 17, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.750 Vali Acc: 0.688 Test Loss: 0.750 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 228426
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.209291934967041
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8406620025634766
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.634 Vali Acc: 0.722 Test Loss: 0.634 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7741644382476807
Epoch: 3, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.590 Vali Acc: 0.727 Test Loss: 0.590 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.8198165893554688
Epoch: 4, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.591 Vali Acc: 0.741 Test Loss: 0.591 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.9204943180084229
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.627 Vali Acc: 0.688 Test Loss: 0.627 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.815089225769043
Epoch: 6, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.674595594406128
Epoch: 7, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 1.8261964321136475
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.544 Vali Acc: 0.761 Test Loss: 0.544 Test Acc: 0.761
Validation loss decreased (-0.756092 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 2.0414235591888428
Epoch: 9, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.519 Vali Acc: 0.722 Test Loss: 0.519 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7420217990875244
Epoch: 10, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.551 Vali Acc: 0.707 Test Loss: 0.551 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.728726863861084
Epoch: 11, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.578 Vali Acc: 0.668 Test Loss: 0.578 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.604534387588501
Epoch: 12, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.526 Vali Acc: 0.771 Test Loss: 0.526 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 13 cost time: 1.665658712387085
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.562 Vali Acc: 0.678 Test Loss: 0.562 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.903649091720581
Epoch: 14, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.567 Vali Acc: 0.722 Test Loss: 0.567 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8455376625061035
Epoch: 15, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.685 Vali Acc: 0.649 Test Loss: 0.685 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8822996616363525
Epoch: 16, Steps: 13 | Train Loss: 0.182 Vali Loss: 0.627 Vali Acc: 0.741 Test Loss: 0.627 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0953152179718018
Epoch: 17, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.760 Vali Acc: 0.732 Test Loss: 0.760 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8562233448028564
Epoch: 18, Steps: 13 | Train Loss: 0.092 Vali Loss: 0.990 Vali Acc: 0.737 Test Loss: 0.990 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.130988359451294
Epoch: 19, Steps: 13 | Train Loss: 0.058 Vali Loss: 0.843 Vali Acc: 0.732 Test Loss: 0.843 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.12330961227417
Epoch: 20, Steps: 13 | Train Loss: 0.049 Vali Loss: 0.880 Vali Acc: 0.732 Test Loss: 0.880 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9926414489746094
Epoch: 21, Steps: 13 | Train Loss: 0.037 Vali Loss: 0.930 Vali Acc: 0.727 Test Loss: 0.930 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.289745569229126
Epoch: 22, Steps: 13 | Train Loss: 0.018 Vali Loss: 1.032 Vali Acc: 0.722 Test Loss: 1.032 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 228426
model size : 2.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.739477872848511
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.030703067779541
Epoch: 2, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 2.259847402572632
Epoch: 3, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.597 Vali Acc: 0.727 Test Loss: 0.597 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3380067348480225
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 2.375842571258545
Epoch: 5, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.660 Vali Acc: 0.741 Test Loss: 0.660 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2684202194213867
Epoch: 6, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2862210273742676
Epoch: 7, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3662736415863037
Epoch: 8, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.624 Vali Acc: 0.746 Test Loss: 0.624 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 2.1432881355285645
Epoch: 9, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.841 Vali Acc: 0.590 Test Loss: 0.841 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.022282838821411
Epoch: 10, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.722 Vali Acc: 0.673 Test Loss: 0.722 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0895395278930664
Epoch: 11, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.721 Vali Acc: 0.727 Test Loss: 0.721 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.812939167022705
Epoch: 12, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.705 Vali Acc: 0.722 Test Loss: 0.705 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0315439701080322
Epoch: 13, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.717 Vali Acc: 0.722 Test Loss: 0.717 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.062497854232788
Epoch: 14, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.817 Vali Acc: 0.741 Test Loss: 0.817 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0578362941741943
Epoch: 15, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.814 Vali Acc: 0.717 Test Loss: 0.814 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.238798141479492
Epoch: 16, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.834 Vali Acc: 0.707 Test Loss: 0.834 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1977012157440186
Epoch: 17, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.891 Vali Acc: 0.712 Test Loss: 0.891 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.131704568862915
Epoch: 18, Steps: 13 | Train Loss: 0.069 Vali Loss: 0.956 Vali Acc: 0.707 Test Loss: 0.956 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 162890
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.010751962661743
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.806957721710205
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 2.069157361984253
Epoch: 3, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.7163348197937012
Epoch: 4, Steps: 13 | Train Loss: 0.476 Vali Loss: 0.591 Vali Acc: 0.741 Test Loss: 0.591 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.9096159934997559
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8295395374298096
Epoch: 6, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8022563457489014
Epoch: 7, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5298211574554443
Epoch: 8, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.9271974563598633
Epoch: 9, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.800 Vali Acc: 0.600 Test Loss: 0.800 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8911769390106201
Epoch: 10, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.684 Vali Acc: 0.639 Test Loss: 0.684 Test Acc: 0.639
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.91744065284729
Epoch: 11, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.649 Vali Acc: 0.737 Test Loss: 0.649 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.238785982131958
Epoch: 12, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.631 Vali Acc: 0.741 Test Loss: 0.631 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.9776215553283691
Epoch: 13, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.664 Vali Acc: 0.751 Test Loss: 0.664 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751213).  Saving model ...
Epoch: 14 cost time: 2.144554853439331
Epoch: 14, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9313185214996338
Epoch: 15, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.740 Vali Acc: 0.722 Test Loss: 0.740 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.367482900619507
Epoch: 16, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.755 Vali Acc: 0.683 Test Loss: 0.755 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.948167324066162
Epoch: 17, Steps: 13 | Train Loss: 0.084 Vali Loss: 0.826 Vali Acc: 0.707 Test Loss: 0.826 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9177095890045166
Epoch: 18, Steps: 13 | Train Loss: 0.065 Vali Loss: 0.932 Vali Acc: 0.737 Test Loss: 0.932 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9572365283966064
Epoch: 19, Steps: 13 | Train Loss: 0.066 Vali Loss: 0.999 Vali Acc: 0.727 Test Loss: 0.999 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1492257118225098
Epoch: 20, Steps: 13 | Train Loss: 0.048 Vali Loss: 0.993 Vali Acc: 0.702 Test Loss: 0.993 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0033390522003174
Epoch: 21, Steps: 13 | Train Loss: 0.042 Vali Loss: 0.973 Vali Acc: 0.707 Test Loss: 0.973 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0767786502838135
Epoch: 22, Steps: 13 | Train Loss: 0.045 Vali Loss: 1.036 Vali Acc: 0.707 Test Loss: 1.036 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1788926124572754
Epoch: 23, Steps: 13 | Train Loss: 0.033 Vali Loss: 1.138 Vali Acc: 0.717 Test Loss: 1.138 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 162890
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.472379684448242
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.1765549182891846
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0950891971588135
Epoch: 3, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0376944541931152
Epoch: 4, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.8188154697418213
Epoch: 5, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.605 Vali Acc: 0.746 Test Loss: 0.605 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.8696479797363281
Epoch: 6, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9064898490905762
Epoch: 7, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.565 Vali Acc: 0.702 Test Loss: 0.565 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9062495231628418
Epoch: 8, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.551 Vali Acc: 0.722 Test Loss: 0.551 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.972768783569336
Epoch: 9, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.690 Vali Acc: 0.624 Test Loss: 0.690 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.106719493865967
Epoch: 10, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.603 Vali Acc: 0.698 Test Loss: 0.603 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8677692413330078
Epoch: 11, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.613 Vali Acc: 0.717 Test Loss: 0.613 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8255305290222168
Epoch: 12, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.824737310409546
Epoch: 13, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.618 Vali Acc: 0.707 Test Loss: 0.618 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8418080806732178
Epoch: 14, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.92067289352417
Epoch: 15, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.674 Vali Acc: 0.707 Test Loss: 0.674 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 162890
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.5774383544921875
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9721949100494385
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.7891974449157715
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8467702865600586
Epoch: 4, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.7422754764556885
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.667 Vali Acc: 0.727 Test Loss: 0.667 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.001197099685669
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.540 Vali Acc: 0.761 Test Loss: 0.540 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 7 cost time: 2.0126590728759766
Epoch: 7, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.536 Vali Acc: 0.746 Test Loss: 0.536 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.001478910446167
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.532 Vali Acc: 0.732 Test Loss: 0.532 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7570440769195557
Epoch: 9, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.691 Vali Acc: 0.595 Test Loss: 0.691 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8536739349365234
Epoch: 10, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.542 Vali Acc: 0.727 Test Loss: 0.542 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1410953998565674
Epoch: 11, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.884190559387207
Epoch: 12, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.527 Vali Acc: 0.746 Test Loss: 0.527 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.08817195892334
Epoch: 13, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0275299549102783
Epoch: 14, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.660 Vali Acc: 0.751 Test Loss: 0.660 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.8721675872802734
Epoch: 15, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3097167015075684
Epoch: 16, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.612 Vali Acc: 0.746 Test Loss: 0.612 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 162890
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.757113695144653
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 2.0564732551574707
Epoch: 2, Steps: 13 | Train Loss: 0.594 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9683566093444824
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.701 Vali Acc: 0.722 Test Loss: 0.701 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721944).  Saving model ...
Epoch: 4 cost time: 1.9894766807556152
Epoch: 4, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.682 Vali Acc: 0.727 Test Loss: 0.682 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726822).  Saving model ...
Epoch: 5 cost time: 2.242814302444458
Epoch: 5, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.623 Vali Acc: 0.741 Test Loss: 0.623 Test Acc: 0.741
Validation loss decreased (-0.726822 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 2.0792713165283203
Epoch: 6, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2843730449676514
Epoch: 7, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0218191146850586
Epoch: 8, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8995912075042725
Epoch: 9, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.120352029800415
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3186280727386475
Epoch: 11, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.816 Vali Acc: 0.737 Test Loss: 0.816 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.185763120651245
Epoch: 12, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.777 Vali Acc: 0.746 Test Loss: 0.777 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746334).  Saving model ...
Epoch: 13 cost time: 2.3062546253204346
Epoch: 13, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.775 Vali Acc: 0.693 Test Loss: 0.775 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.125732421875
Epoch: 14, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.800 Vali Acc: 0.673 Test Loss: 0.800 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.405282974243164
Epoch: 15, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.809 Vali Acc: 0.683 Test Loss: 0.809 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.202686309814453
Epoch: 16, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.858 Vali Acc: 0.702 Test Loss: 0.858 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2896978855133057
Epoch: 17, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.211 Vali Acc: 0.546 Test Loss: 1.211 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.4043943881988525
Epoch: 18, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.960 Vali Acc: 0.683 Test Loss: 0.960 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.15657901763916
Epoch: 19, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.014 Vali Acc: 0.688 Test Loss: 1.014 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1021015644073486
Epoch: 20, Steps: 13 | Train Loss: 0.066 Vali Loss: 1.048 Vali Acc: 0.707 Test Loss: 1.048 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3595643043518066
Epoch: 21, Steps: 13 | Train Loss: 0.043 Vali Loss: 1.225 Vali Acc: 0.717 Test Loss: 1.225 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4105186462402344
Epoch: 22, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.142 Vali Acc: 0.663 Test Loss: 1.142 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 130122
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.120652437210083
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.030174970626831
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9524455070495605
Epoch: 3, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.695 Vali Acc: 0.707 Test Loss: 0.695 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9729688167572021
Epoch: 4, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.666 Vali Acc: 0.722 Test Loss: 0.666 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 1.8339862823486328
Epoch: 5, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.600 Vali Acc: 0.746 Test Loss: 0.600 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.9818367958068848
Epoch: 6, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9581298828125
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9276559352874756
Epoch: 8, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.128255844116211
Epoch: 9, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.660 Vali Acc: 0.732 Test Loss: 0.660 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8721568584442139
Epoch: 10, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.610 Vali Acc: 0.717 Test Loss: 0.610 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9978256225585938
Epoch: 11, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.754 Vali Acc: 0.741 Test Loss: 0.754 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.2584800720214844
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.708 Vali Acc: 0.722 Test Loss: 0.708 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.1668620109558105
Epoch: 13, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.753 Vali Acc: 0.673 Test Loss: 0.753 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8867714405059814
Epoch: 14, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.040078639984131
Epoch: 15, Steps: 13 | Train Loss: 0.172 Vali Loss: 0.746 Vali Acc: 0.673 Test Loss: 0.746 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 130122
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.013978719711304
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9108705520629883
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.97190523147583
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.675 Vali Acc: 0.678 Test Loss: 0.675 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8665454387664795
Epoch: 4, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0216758251190186
Epoch: 5, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.8036062717437744
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7964816093444824
Epoch: 7, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9046390056610107
Epoch: 8, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9247219562530518
Epoch: 9, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.667 Vali Acc: 0.746 Test Loss: 0.667 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9241173267364502
Epoch: 10, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0189003944396973
Epoch: 11, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.686 Vali Acc: 0.746 Test Loss: 0.686 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.948456048965454
Epoch: 12, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.631 Vali Acc: 0.702 Test Loss: 0.631 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.966850757598877
Epoch: 13, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.699 Vali Acc: 0.649 Test Loss: 0.699 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.818847894668579
Epoch: 14, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.688 Vali Acc: 0.712 Test Loss: 0.688 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.832732915878296
Epoch: 15, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.720 Vali Acc: 0.702 Test Loss: 0.720 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 130122
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.239375352859497
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6646044254302979
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6941354274749756
Epoch: 3, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.660 Vali Acc: 0.702 Test Loss: 0.660 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5650510787963867
Epoch: 4, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.605191946029663
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.594 Vali Acc: 0.732 Test Loss: 0.594 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 1.5937373638153076
Epoch: 6, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.8010270595550537
Epoch: 7, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7883477210998535
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 1.7275660037994385
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.847 Vali Acc: 0.727 Test Loss: 0.847 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7071387767791748
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.746335 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 1.624525547027588
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.720 Vali Acc: 0.741 Test Loss: 0.720 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7740046977996826
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.593 Vali Acc: 0.771 Test Loss: 0.593 Test Acc: 0.771
Validation loss decreased (-0.760970 --> -0.770726).  Saving model ...
Epoch: 13 cost time: 1.7239446640014648
Epoch: 13, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.561 Vali Acc: 0.771 Test Loss: 0.561 Test Acc: 0.771
Validation loss decreased (-0.770726 --> -0.770726).  Saving model ...
Epoch: 14 cost time: 1.69541335105896
Epoch: 14, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.050187110900879
Epoch: 15, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.696882963180542
Epoch: 16, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.624 Vali Acc: 0.761 Test Loss: 0.624 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.905393123626709
Epoch: 17, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.672 Vali Acc: 0.712 Test Loss: 0.672 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7720420360565186
Epoch: 18, Steps: 13 | Train Loss: 0.094 Vali Loss: 0.700 Vali Acc: 0.702 Test Loss: 0.700 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8023626804351807
Epoch: 19, Steps: 13 | Train Loss: 0.075 Vali Loss: 0.821 Vali Acc: 0.741 Test Loss: 0.821 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7395837306976318
Epoch: 20, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.851 Vali Acc: 0.727 Test Loss: 0.851 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7691221237182617
Epoch: 21, Steps: 13 | Train Loss: 0.033 Vali Loss: 0.937 Vali Acc: 0.741 Test Loss: 0.937 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.996279239654541
Epoch: 22, Steps: 13 | Train Loss: 0.028 Vali Loss: 0.936 Vali Acc: 0.702 Test Loss: 0.936 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.030071496963501
Epoch: 23, Steps: 13 | Train Loss: 0.030 Vali Loss: 1.012 Vali Acc: 0.727 Test Loss: 1.012 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7707317073170732
model parameter : 130122
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.198165416717529
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.959402322769165
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0747785568237305
Epoch: 3, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3412859439849854
Epoch: 4, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8624072074890137
Epoch: 5, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.661 Vali Acc: 0.727 Test Loss: 0.661 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 2.056267738342285
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.622 Vali Acc: 0.741 Test Loss: 0.622 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 7 cost time: 2.0505588054656982
Epoch: 7, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.107008934020996
Epoch: 8, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9664483070373535
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.642 Vali Acc: 0.732 Test Loss: 0.642 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8320996761322021
Epoch: 10, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.646 Vali Acc: 0.732 Test Loss: 0.646 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0207784175872803
Epoch: 11, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.678 Vali Acc: 0.698 Test Loss: 0.678 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1374433040618896
Epoch: 12, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.686 Vali Acc: 0.717 Test Loss: 0.686 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.882157325744629
Epoch: 13, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1242129802703857
Epoch: 14, Steps: 13 | Train Loss: 0.140 Vali Loss: 0.788 Vali Acc: 0.717 Test Loss: 0.788 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0619537830352783
Epoch: 15, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.861 Vali Acc: 0.688 Test Loss: 0.861 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8478808403015137
Epoch: 16, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.879 Vali Acc: 0.659 Test Loss: 0.879 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 113738
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.455913543701172
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.131586790084839
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.9504306316375732
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.612 Vali Acc: 0.717 Test Loss: 0.612 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 1.8600401878356934
Epoch: 4, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9646975994110107
Epoch: 5, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 1.8967692852020264
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9444563388824463
Epoch: 7, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.9642927646636963
Epoch: 8, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8761050701141357
Epoch: 9, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.701289176940918
Epoch: 10, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9180190563201904
Epoch: 11, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.689 Vali Acc: 0.683 Test Loss: 0.689 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.690598726272583
Epoch: 12, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.686 Vali Acc: 0.707 Test Loss: 0.686 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9384369850158691
Epoch: 13, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9849205017089844
Epoch: 14, Steps: 13 | Train Loss: 0.149 Vali Loss: 0.768 Vali Acc: 0.707 Test Loss: 0.768 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8550786972045898
Epoch: 15, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.822 Vali Acc: 0.698 Test Loss: 0.822 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.8558847904205322
Epoch: 16, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.800 Vali Acc: 0.683 Test Loss: 0.800 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.675290584564209
Epoch: 17, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.840 Vali Acc: 0.688 Test Loss: 0.840 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 113738
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.952763319015503
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7356956005096436
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.7701199054718018
Epoch: 3, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.7850825786590576
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.646 Vali Acc: 0.712 Test Loss: 0.646 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.878340482711792
Epoch: 5, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.8628613948822021
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.7779784202575684
Epoch: 7, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.719414472579956
Epoch: 8, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.583 Vali Acc: 0.702 Test Loss: 0.583 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0642309188842773
Epoch: 9, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.602 Vali Acc: 0.741 Test Loss: 0.602 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8060657978057861
Epoch: 10, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9522624015808105
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.673 Vali Acc: 0.683 Test Loss: 0.673 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9685368537902832
Epoch: 12, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.641 Vali Acc: 0.712 Test Loss: 0.641 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9126532077789307
Epoch: 13, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0372798442840576
Epoch: 14, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.726 Vali Acc: 0.717 Test Loss: 0.726 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.388536214828491
Epoch: 15, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.764 Vali Acc: 0.688 Test Loss: 0.764 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9846138954162598
Epoch: 16, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.758 Vali Acc: 0.707 Test Loss: 0.758 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 113738
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 5.010308504104614
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.944122314453125
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1151440143585205
Epoch: 3, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.577 Vali Acc: 0.712 Test Loss: 0.577 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4103469848632812
Epoch: 4, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.195876359939575
Epoch: 5, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.601 Vali Acc: 0.722 Test Loss: 0.601 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 2.308877468109131
Epoch: 6, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
Validation loss decreased (-0.721945 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 2.07836651802063
Epoch: 7, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.547 Vali Acc: 0.741 Test Loss: 0.547 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3365120887756348
Epoch: 8, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.549 Vali Acc: 0.732 Test Loss: 0.549 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.008607864379883
Epoch: 9, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.535 Vali Acc: 0.751 Test Loss: 0.535 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 1.7862968444824219
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.530 Vali Acc: 0.741 Test Loss: 0.530 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8554143905639648
Epoch: 11, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.635 Vali Acc: 0.668 Test Loss: 0.635 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2157583236694336
Epoch: 12, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.552 Vali Acc: 0.707 Test Loss: 0.552 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9339320659637451
Epoch: 13, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9935035705566406
Epoch: 14, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 15 cost time: 1.9279990196228027
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.634 Vali Acc: 0.678 Test Loss: 0.634 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6549153327941895
Epoch: 16, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.591 Vali Acc: 0.702 Test Loss: 0.591 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7274112701416016
Epoch: 17, Steps: 13 | Train Loss: 0.136 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8092503547668457
Epoch: 18, Steps: 13 | Train Loss: 0.119 Vali Loss: 0.701 Vali Acc: 0.712 Test Loss: 0.701 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.93882155418396
Epoch: 19, Steps: 13 | Train Loss: 0.083 Vali Loss: 0.804 Vali Acc: 0.722 Test Loss: 0.804 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9027528762817383
Epoch: 20, Steps: 13 | Train Loss: 0.071 Vali Loss: 0.939 Vali Acc: 0.732 Test Loss: 0.939 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8740477561950684
Epoch: 21, Steps: 13 | Train Loss: 0.052 Vali Loss: 0.866 Vali Acc: 0.712 Test Loss: 0.866 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8002400398254395
Epoch: 22, Steps: 13 | Train Loss: 0.045 Vali Loss: 0.933 Vali Acc: 0.707 Test Loss: 0.933 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.867187738418579
Epoch: 23, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.106 Vali Acc: 0.732 Test Loss: 1.106 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8154065608978271
Epoch: 24, Steps: 13 | Train Loss: 0.025 Vali Loss: 1.147 Vali Acc: 0.737 Test Loss: 1.147 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 113738
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.119804620742798
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.791679859161377
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.775019645690918
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.7897374629974365
Epoch: 4, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7460353374481201
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.619 Vali Acc: 0.732 Test Loss: 0.619 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.744884967803955
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8673367500305176
Epoch: 7, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 2.047224760055542
Epoch: 8, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9243605136871338
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.051919937133789
Epoch: 10, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 1.8937551975250244
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.570 Vali Acc: 0.741 Test Loss: 0.570 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 12 cost time: 2.003034830093384
Epoch: 12, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.378608226776123
Epoch: 13, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.693 Vali Acc: 0.727 Test Loss: 0.693 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3453562259674072
Epoch: 14, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.796 Vali Acc: 0.702 Test Loss: 0.796 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1127164363861084
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.797 Vali Acc: 0.678 Test Loss: 0.797 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1747467517852783
Epoch: 16, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4661221504211426
Epoch: 17, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.367396354675293
Epoch: 18, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.822 Vali Acc: 0.688 Test Loss: 0.822 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1653692722320557
Epoch: 19, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.803 Vali Acc: 0.673 Test Loss: 0.803 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.1545746326446533
Epoch: 20, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.821 Vali Acc: 0.707 Test Loss: 0.821 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.1009323596954346
Epoch: 21, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.815 Vali Acc: 0.693 Test Loss: 0.815 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 306986
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3297154903411865
Epoch: 1, Steps: 13 | Train Loss: 0.628 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.9714529514312744
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.611 Vali Acc: 0.702 Test Loss: 0.611 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.872159481048584
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.8703880310058594
Epoch: 4, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.610 Vali Acc: 0.707 Test Loss: 0.610 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9792392253875732
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 1.9735894203186035
Epoch: 6, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.754178524017334
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.591 Vali Acc: 0.741 Test Loss: 0.591 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8377656936645508
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.813990592956543
Epoch: 9, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7821943759918213
Epoch: 10, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.762486457824707
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7334568500518799
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9825050830841064
Epoch: 13, Steps: 13 | Train Loss: 0.253 Vali Loss: 0.613 Vali Acc: 0.702 Test Loss: 0.613 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8252754211425781
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.783888339996338
Epoch: 15, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.647 Vali Acc: 0.663 Test Loss: 0.647 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9743828773498535
Epoch: 16, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.652 Vali Acc: 0.693 Test Loss: 0.652 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 306986
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.808546781539917
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.6621453762054443
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.583 Vali Acc: 0.707 Test Loss: 0.583 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7155961990356445
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 1.6787617206573486
Epoch: 4, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6217293739318848
Epoch: 5, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 1.6638779640197754
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 7 cost time: 1.6491997241973877
Epoch: 7, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 1.7137815952301025
Epoch: 8, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.629 Vali Acc: 0.741 Test Loss: 0.629 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 9 cost time: 1.7699429988861084
Epoch: 9, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.656 Vali Acc: 0.741 Test Loss: 0.656 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0101842880249023
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9393310546875
Epoch: 11, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9322235584259033
Epoch: 12, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741457).  Saving model ...
Epoch: 13 cost time: 2.063093662261963
Epoch: 13, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.607 Vali Acc: 0.683 Test Loss: 0.607 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9649689197540283
Epoch: 14, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.718 Vali Acc: 0.737 Test Loss: 0.718 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9895565509796143
Epoch: 15, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.640 Vali Acc: 0.712 Test Loss: 0.640 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7447221279144287
Epoch: 16, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.680 Vali Acc: 0.707 Test Loss: 0.680 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0388431549072266
Epoch: 17, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.729 Vali Acc: 0.707 Test Loss: 0.729 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7605836391448975
Epoch: 18, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.726 Vali Acc: 0.673 Test Loss: 0.726 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8164710998535156
Epoch: 19, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.752 Vali Acc: 0.702 Test Loss: 0.752 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8953857421875
Epoch: 20, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.886 Vali Acc: 0.702 Test Loss: 0.886 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8648607730865479
Epoch: 21, Steps: 13 | Train Loss: 0.081 Vali Loss: 0.797 Vali Acc: 0.663 Test Loss: 0.797 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.028671979904175
Epoch: 22, Steps: 13 | Train Loss: 0.070 Vali Loss: 0.845 Vali Acc: 0.698 Test Loss: 0.845 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 306986
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.369343996047974
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9417104721069336
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.917675256729126
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9067158699035645
Epoch: 4, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.2778260707855225
Epoch: 5, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.9473605155944824
Epoch: 6, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.544 Vali Acc: 0.756 Test Loss: 0.544 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.6696789264678955
Epoch: 7, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.674722671508789
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.641 Vali Acc: 0.732 Test Loss: 0.641 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6743593215942383
Epoch: 9, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7561049461364746
Epoch: 10, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.538 Vali Acc: 0.756 Test Loss: 0.538 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 11 cost time: 1.8940086364746094
Epoch: 11, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.535 Vali Acc: 0.756 Test Loss: 0.535 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 12 cost time: 1.7361440658569336
Epoch: 12, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.516 Vali Acc: 0.756 Test Loss: 0.516 Test Acc: 0.756
Validation loss decreased (-0.756092 --> -0.756092).  Saving model ...
Epoch: 13 cost time: 1.7908508777618408
Epoch: 13, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.550 Vali Acc: 0.727 Test Loss: 0.550 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7118477821350098
Epoch: 14, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8987319469451904
Epoch: 15, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.575 Vali Acc: 0.756 Test Loss: 0.575 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9151637554168701
Epoch: 16, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.570 Vali Acc: 0.756 Test Loss: 0.570 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7510461807250977
Epoch: 17, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.611 Vali Acc: 0.737 Test Loss: 0.611 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.906775712966919
Epoch: 18, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.636 Vali Acc: 0.654 Test Loss: 0.636 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8651208877563477
Epoch: 19, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.660 Vali Acc: 0.722 Test Loss: 0.660 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9823167324066162
Epoch: 20, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.775 Vali Acc: 0.746 Test Loss: 0.775 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9824612140655518
Epoch: 21, Steps: 13 | Train Loss: 0.099 Vali Loss: 0.792 Vali Acc: 0.654 Test Loss: 0.792 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9806511402130127
Epoch: 22, Steps: 13 | Train Loss: 0.093 Vali Loss: 0.749 Vali Acc: 0.707 Test Loss: 0.749 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 306986
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.046966075897217
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7159693241119385
Epoch: 2, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.581 Vali Acc: 0.712 Test Loss: 0.581 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7065556049346924
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7454802989959717
Epoch: 4, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.627 Vali Acc: 0.741 Test Loss: 0.627 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.7667245864868164
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.577 Vali Acc: 0.746 Test Loss: 0.577 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.2491865158081055
Epoch: 6, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8965749740600586
Epoch: 7, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7869653701782227
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.610 Vali Acc: 0.727 Test Loss: 0.610 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.699927806854248
Epoch: 9, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.614 Vali Acc: 0.727 Test Loss: 0.614 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8867120742797852
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.651 Vali Acc: 0.741 Test Loss: 0.651 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.896695613861084
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.208075761795044
Epoch: 12, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.595 Vali Acc: 0.761 Test Loss: 0.595 Test Acc: 0.761
Validation loss decreased (-0.746336 --> -0.760970).  Saving model ...
Epoch: 13 cost time: 2.0247955322265625
Epoch: 13, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.628 Vali Acc: 0.741 Test Loss: 0.628 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.823265552520752
Epoch: 14, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.645 Vali Acc: 0.707 Test Loss: 0.645 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.824089527130127
Epoch: 15, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.687 Vali Acc: 0.693 Test Loss: 0.687 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.983212947845459
Epoch: 16, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.716 Vali Acc: 0.712 Test Loss: 0.716 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7841756343841553
Epoch: 17, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.731 Vali Acc: 0.707 Test Loss: 0.731 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.698197603225708
Epoch: 18, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.779 Vali Acc: 0.732 Test Loss: 0.779 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1380550861358643
Epoch: 19, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.019883155822754
Epoch: 20, Steps: 13 | Train Loss: 0.123 Vali Loss: 0.777 Vali Acc: 0.693 Test Loss: 0.777 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.9504756927490234
Epoch: 21, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.815 Vali Acc: 0.688 Test Loss: 0.815 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9508535861968994
Epoch: 22, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.937 Vali Acc: 0.712 Test Loss: 0.937 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 175914
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.940049409866333
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.9274711608886719
Epoch: 2, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.85129714012146
Epoch: 3, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7840077877044678
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.619 Vali Acc: 0.741 Test Loss: 0.619 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.7280707359313965
Epoch: 5, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8365318775177002
Epoch: 6, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.610 Vali Acc: 0.727 Test Loss: 0.610 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.834728717803955
Epoch: 7, Steps: 13 | Train Loss: 0.447 Vali Loss: 0.621 Vali Acc: 0.737 Test Loss: 0.621 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7927472591400146
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.631 Vali Acc: 0.746 Test Loss: 0.631 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 1.8178787231445312
Epoch: 9, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.630 Vali Acc: 0.732 Test Loss: 0.630 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7526063919067383
Epoch: 10, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.641 Vali Acc: 0.707 Test Loss: 0.641 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.754220724105835
Epoch: 11, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.679 Vali Acc: 0.688 Test Loss: 0.679 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.84476900100708
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.183842182159424
Epoch: 13, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.632 Vali Acc: 0.732 Test Loss: 0.632 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7713971138000488
Epoch: 14, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.653 Vali Acc: 0.698 Test Loss: 0.653 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.865243673324585
Epoch: 15, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.703 Vali Acc: 0.683 Test Loss: 0.703 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7206554412841797
Epoch: 16, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.704 Vali Acc: 0.741 Test Loss: 0.704 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9755792617797852
Epoch: 17, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.718 Vali Acc: 0.683 Test Loss: 0.718 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.0546436309814453
Epoch: 18, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.749 Vali Acc: 0.737 Test Loss: 0.749 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 175914
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.015069007873535
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7548985481262207
Epoch: 2, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.6951501369476318
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.574 Vali Acc: 0.707 Test Loss: 0.574 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6891975402832031
Epoch: 4, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.6820809841156006
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.9377858638763428
Epoch: 6, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.035637617111206
Epoch: 7, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7681331634521484
Epoch: 8, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8104431629180908
Epoch: 9, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8841214179992676
Epoch: 10, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.597 Vali Acc: 0.707 Test Loss: 0.597 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.740539789199829
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8595333099365234
Epoch: 12, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.920382022857666
Epoch: 13, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9799325466156006
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.2608745098114014
Epoch: 15, Steps: 13 | Train Loss: 0.205 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 175914
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.206664562225342
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8479785919189453
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.863032341003418
Epoch: 3, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.574 Vali Acc: 0.722 Test Loss: 0.574 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 2.031876564025879
Epoch: 4, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.199355363845825
Epoch: 5, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.085343360900879
Epoch: 6, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.9138414859771729
Epoch: 7, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 2.017472982406616
Epoch: 8, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.565 Vali Acc: 0.751 Test Loss: 0.565 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.011665105819702
Epoch: 9, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.647 Vali Acc: 0.727 Test Loss: 0.647 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8115019798278809
Epoch: 10, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.531 Vali Acc: 0.761 Test Loss: 0.531 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 2.029195547103882
Epoch: 11, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.531 Vali Acc: 0.756 Test Loss: 0.531 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.979898452758789
Epoch: 12, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.530 Vali Acc: 0.756 Test Loss: 0.530 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0288584232330322
Epoch: 13, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.676 Vali Acc: 0.732 Test Loss: 0.676 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9233028888702393
Epoch: 14, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.582 Vali Acc: 0.741 Test Loss: 0.582 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9834942817687988
Epoch: 15, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9889791011810303
Epoch: 16, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.639 Vali Acc: 0.732 Test Loss: 0.639 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9351210594177246
Epoch: 17, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.601 Vali Acc: 0.741 Test Loss: 0.601 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.884920597076416
Epoch: 18, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.721 Vali Acc: 0.741 Test Loss: 0.721 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8711345195770264
Epoch: 19, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8634872436523438
Epoch: 20, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.668 Vali Acc: 0.732 Test Loss: 0.668 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 175914
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.295167446136475
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8489630222320557
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.976576566696167
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.593 Vali Acc: 0.732 Test Loss: 0.593 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.8856558799743652
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1275858879089355
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 6 cost time: 1.8430819511413574
Epoch: 6, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.9103529453277588
Epoch: 7, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5941567420959473
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.593 Vali Acc: 0.727 Test Loss: 0.593 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9100830554962158
Epoch: 9, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9058592319488525
Epoch: 10, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.1117196083068848
Epoch: 11, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.614 Vali Acc: 0.746 Test Loss: 0.614 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9277455806732178
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.655 Vali Acc: 0.707 Test Loss: 0.655 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.07316517829895
Epoch: 13, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.657 Vali Acc: 0.707 Test Loss: 0.657 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.1487879753112793
Epoch: 14, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.687 Vali Acc: 0.727 Test Loss: 0.687 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.055389881134033
Epoch: 15, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.768 Vali Acc: 0.741 Test Loss: 0.768 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.0179622173309326
Epoch: 16, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.796 Vali Acc: 0.702 Test Loss: 0.796 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 110378
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.722494840621948
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.1233737468719482
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.589 Vali Acc: 0.712 Test Loss: 0.589 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.014226198196411
Epoch: 3, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.594 Vali Acc: 0.727 Test Loss: 0.594 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.9545340538024902
Epoch: 4, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.612 Vali Acc: 0.727 Test Loss: 0.612 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9944772720336914
Epoch: 5, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 1.9222915172576904
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 2.0130774974823
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 2.011108875274658
Epoch: 8, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 2.0069580078125
Epoch: 9, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9640798568725586
Epoch: 10, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0916762351989746
Epoch: 11, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9189636707305908
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8850007057189941
Epoch: 13, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9036359786987305
Epoch: 14, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9086229801177979
Epoch: 15, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.880305528640747
Epoch: 16, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.783 Vali Acc: 0.717 Test Loss: 0.783 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9625906944274902
Epoch: 17, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.758 Vali Acc: 0.693 Test Loss: 0.758 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7961914539337158
Epoch: 18, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.853 Vali Acc: 0.732 Test Loss: 0.853 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 110378
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.150039196014404
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7051255702972412
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5787203311920166
Epoch: 3, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.843127727508545
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8202273845672607
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.6285693645477295
Epoch: 6, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 1.8844177722930908
Epoch: 7, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.8947570323944092
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.7978250980377197
Epoch: 9, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.690683364868164
Epoch: 10, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.588 Vali Acc: 0.741 Test Loss: 0.588 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6756868362426758
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.583 Vali Acc: 0.756 Test Loss: 0.583 Test Acc: 0.756
Validation loss decreased (-0.741458 --> -0.756092).  Saving model ...
Epoch: 12 cost time: 1.81996488571167
Epoch: 12, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.768064022064209
Epoch: 13, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.594 Vali Acc: 0.698 Test Loss: 0.594 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7622015476226807
Epoch: 14, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.803800344467163
Epoch: 15, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.716 Vali Acc: 0.741 Test Loss: 0.716 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1416122913360596
Epoch: 16, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0485732555389404
Epoch: 17, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.719 Vali Acc: 0.707 Test Loss: 0.719 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9587373733520508
Epoch: 18, Steps: 13 | Train Loss: 0.156 Vali Loss: 0.759 Vali Acc: 0.688 Test Loss: 0.759 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.977092981338501
Epoch: 19, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.925 Vali Acc: 0.732 Test Loss: 0.925 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7946908473968506
Epoch: 20, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.877 Vali Acc: 0.683 Test Loss: 0.877 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.0565342903137207
Epoch: 21, Steps: 13 | Train Loss: 0.132 Vali Loss: 1.001 Vali Acc: 0.615 Test Loss: 1.001 Test Acc: 0.615
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 110378
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.473754644393921
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.846785306930542
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.579 Vali Acc: 0.712 Test Loss: 0.579 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0781636238098145
Epoch: 3, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.7616732120513916
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.629 Vali Acc: 0.712 Test Loss: 0.629 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7954435348510742
Epoch: 5, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.8323750495910645
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.6394996643066406
Epoch: 7, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6658353805541992
Epoch: 8, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.619 Vali Acc: 0.741 Test Loss: 0.619 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.818467378616333
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7966985702514648
Epoch: 10, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7793049812316895
Epoch: 11, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.0202534198760986
Epoch: 12, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.528 Vali Acc: 0.732 Test Loss: 0.528 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8410959243774414
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.527 Vali Acc: 0.756 Test Loss: 0.527 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 14 cost time: 1.6743419170379639
Epoch: 14, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.603 Vali Acc: 0.732 Test Loss: 0.603 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0131568908691406
Epoch: 15, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.693 Vali Acc: 0.727 Test Loss: 0.693 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9524238109588623
Epoch: 16, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9854021072387695
Epoch: 17, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.592 Vali Acc: 0.683 Test Loss: 0.592 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9693670272827148
Epoch: 18, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.645 Vali Acc: 0.707 Test Loss: 0.645 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8848342895507812
Epoch: 19, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7189245223999023
Epoch: 20, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.828 Vali Acc: 0.732 Test Loss: 0.828 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7302124500274658
Epoch: 21, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.892 Vali Acc: 0.663 Test Loss: 0.892 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7624475955963135
Epoch: 22, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.822 Vali Acc: 0.668 Test Loss: 0.822 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8305206298828125
Epoch: 23, Steps: 13 | Train Loss: 0.079 Vali Loss: 1.066 Vali Acc: 0.693 Test Loss: 1.066 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 110378
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.356232643127441
Epoch: 1, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.848884105682373
Epoch: 2, Steps: 13 | Train Loss: 0.580 Vali Loss: 0.601 Vali Acc: 0.717 Test Loss: 0.601 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7686734199523926
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.605 Vali Acc: 0.712 Test Loss: 0.605 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9071736335754395
Epoch: 4, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 1.9204909801483154
Epoch: 5, Steps: 13 | Train Loss: 0.462 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.901578426361084
Epoch: 6, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.633 Vali Acc: 0.727 Test Loss: 0.633 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 1.8910937309265137
Epoch: 7, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 8 cost time: 1.8711161613464355
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 9 cost time: 1.9668431282043457
Epoch: 9, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.602 Vali Acc: 0.737 Test Loss: 0.602 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8676507472991943
Epoch: 10, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.772167444229126
Epoch: 11, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7087445259094238
Epoch: 12, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.766209602355957
Epoch: 13, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.637 Vali Acc: 0.741 Test Loss: 0.637 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 14 cost time: 1.7619202136993408
Epoch: 14, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.622 Vali Acc: 0.712 Test Loss: 0.622 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.695859670639038
Epoch: 15, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8115341663360596
Epoch: 16, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.702 Vali Acc: 0.732 Test Loss: 0.702 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8793864250183105
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.731 Vali Acc: 0.663 Test Loss: 0.731 Test Acc: 0.663
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.066129684448242
Epoch: 18, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.751 Vali Acc: 0.634 Test Loss: 0.751 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.043861150741577
Epoch: 19, Steps: 13 | Train Loss: 0.153 Vali Loss: 0.828 Vali Acc: 0.722 Test Loss: 0.828 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9207990169525146
Epoch: 20, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.825 Vali Acc: 0.722 Test Loss: 0.825 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.086974620819092
Epoch: 21, Steps: 13 | Train Loss: 0.129 Vali Loss: 0.925 Vali Acc: 0.654 Test Loss: 0.925 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8512308597564697
Epoch: 22, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.859 Vali Acc: 0.741 Test Loss: 0.859 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.916154146194458
Epoch: 23, Steps: 13 | Train Loss: 0.104 Vali Loss: 0.894 Vali Acc: 0.717 Test Loss: 0.894 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 77610
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.395513296127319
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 2.2219643592834473
Epoch: 2, Steps: 13 | Train Loss: 0.584 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0625996589660645
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.591 Vali Acc: 0.712 Test Loss: 0.591 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7725834846496582
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.8290419578552246
Epoch: 5, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9135258197784424
Epoch: 6, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.616 Vali Acc: 0.727 Test Loss: 0.616 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8696751594543457
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.575 Vali Acc: 0.746 Test Loss: 0.575 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.6910667419433594
Epoch: 8, Steps: 13 | Train Loss: 0.419 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.237761974334717
Epoch: 9, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 10 cost time: 1.898993730545044
Epoch: 10, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 1.8957960605621338
Epoch: 11, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.963972568511963
Epoch: 12, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.601 Vali Acc: 0.746 Test Loss: 0.601 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8920989036560059
Epoch: 13, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.611 Vali Acc: 0.737 Test Loss: 0.611 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8677213191986084
Epoch: 14, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.592 Vali Acc: 0.732 Test Loss: 0.592 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7359294891357422
Epoch: 15, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.599 Vali Acc: 0.732 Test Loss: 0.599 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7059454917907715
Epoch: 16, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.826843500137329
Epoch: 17, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.669 Vali Acc: 0.707 Test Loss: 0.669 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6475377082824707
Epoch: 18, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.722 Vali Acc: 0.654 Test Loss: 0.722 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7233195304870605
Epoch: 19, Steps: 13 | Train Loss: 0.160 Vali Loss: 0.767 Vali Acc: 0.732 Test Loss: 0.767 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8400442600250244
Epoch: 20, Steps: 13 | Train Loss: 0.115 Vali Loss: 0.775 Vali Acc: 0.727 Test Loss: 0.775 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 77610
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.843345880508423
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.7102365493774414
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.583 Vali Acc: 0.702 Test Loss: 0.583 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.689807653427124
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.592 Vali Acc: 0.712 Test Loss: 0.592 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6010494232177734
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 5 cost time: 1.591271162033081
Epoch: 5, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.883521556854248
Epoch: 6, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.601 Vali Acc: 0.707 Test Loss: 0.601 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6897294521331787
Epoch: 7, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.8550586700439453
Epoch: 8, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7867681980133057
Epoch: 9, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7627828121185303
Epoch: 10, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.769148588180542
Epoch: 11, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8561878204345703
Epoch: 12, Steps: 13 | Train Loss: 0.323 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.773857831954956
Epoch: 13, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.587 Vali Acc: 0.741 Test Loss: 0.587 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 14 cost time: 1.7776310443878174
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.559 Vali Acc: 0.761 Test Loss: 0.559 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 15 cost time: 1.6775116920471191
Epoch: 15, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7795436382293701
Epoch: 16, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.621 Vali Acc: 0.741 Test Loss: 0.621 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.810762882232666
Epoch: 17, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.668 Vali Acc: 0.698 Test Loss: 0.668 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9864459037780762
Epoch: 18, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.667 Vali Acc: 0.698 Test Loss: 0.667 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.931501865386963
Epoch: 19, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.729 Vali Acc: 0.727 Test Loss: 0.729 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9385063648223877
Epoch: 20, Steps: 13 | Train Loss: 0.114 Vali Loss: 0.728 Vali Acc: 0.722 Test Loss: 0.728 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9614717960357666
Epoch: 21, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.770 Vali Acc: 0.678 Test Loss: 0.770 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8854775428771973
Epoch: 22, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.772 Vali Acc: 0.727 Test Loss: 0.772 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9979832172393799
Epoch: 23, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.822 Vali Acc: 0.727 Test Loss: 0.822 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.9576032161712646
Epoch: 24, Steps: 13 | Train Loss: 0.072 Vali Loss: 0.867 Vali Acc: 0.727 Test Loss: 0.867 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 77610
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8926994800567627
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8818109035491943
Epoch: 2, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9136121273040771
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7216954231262207
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7703485488891602
Epoch: 5, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8148746490478516
Epoch: 6, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 1.7136096954345703
Epoch: 7, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.547 Vali Acc: 0.737 Test Loss: 0.547 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.7068893909454346
Epoch: 8, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.6676616668701172
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7296571731567383
Epoch: 10, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7980897426605225
Epoch: 11, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.528 Vali Acc: 0.761 Test Loss: 0.528 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 1.551344871520996
Epoch: 12, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.535 Vali Acc: 0.766 Test Loss: 0.535 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765848).  Saving model ...
Epoch: 13 cost time: 1.66298246383667
Epoch: 13, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.596 Vali Acc: 0.741 Test Loss: 0.596 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7032740116119385
Epoch: 14, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.558 Vali Acc: 0.746 Test Loss: 0.558 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6291313171386719
Epoch: 15, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.562 Vali Acc: 0.732 Test Loss: 0.562 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6327815055847168
Epoch: 16, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.601 Vali Acc: 0.737 Test Loss: 0.601 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.772334337234497
Epoch: 17, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.890648365020752
Epoch: 18, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8090245723724365
Epoch: 19, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.736 Vali Acc: 0.727 Test Loss: 0.736 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8478121757507324
Epoch: 20, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7755496501922607
Epoch: 21, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.746 Vali Acc: 0.663 Test Loss: 0.746 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.737595796585083
Epoch: 22, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.752 Vali Acc: 0.732 Test Loss: 0.752 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 77610
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.085179805755615
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.792501449584961
Epoch: 2, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.571 Vali Acc: 0.722 Test Loss: 0.571 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.7124454975128174
Epoch: 3, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.723010778427124
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.718555212020874
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.605 Vali Acc: 0.707 Test Loss: 0.605 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6852834224700928
Epoch: 6, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 1.7583999633789062
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.576 Vali Acc: 0.741 Test Loss: 0.576 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.8382625579833984
Epoch: 8, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.74289870262146
Epoch: 9, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.8310189247131348
Epoch: 10, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.571 Vali Acc: 0.746 Test Loss: 0.571 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 11 cost time: 1.6618218421936035
Epoch: 11, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.593 Vali Acc: 0.741 Test Loss: 0.593 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8701915740966797
Epoch: 12, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.618 Vali Acc: 0.746 Test Loss: 0.618 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9447989463806152
Epoch: 13, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.668 Vali Acc: 0.688 Test Loss: 0.668 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7224929332733154
Epoch: 14, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.916809320449829
Epoch: 15, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.671 Vali Acc: 0.756 Test Loss: 0.671 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756091).  Saving model ...
Epoch: 16 cost time: 1.8428404331207275
Epoch: 16, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7849986553192139
Epoch: 17, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.938 Vali Acc: 0.580 Test Loss: 0.938 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9889886379241943
Epoch: 18, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8108768463134766
Epoch: 19, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.792 Vali Acc: 0.727 Test Loss: 0.792 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8279361724853516
Epoch: 20, Steps: 13 | Train Loss: 0.121 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8039729595184326
Epoch: 21, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.841 Vali Acc: 0.678 Test Loss: 0.841 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8037347793579102
Epoch: 22, Steps: 13 | Train Loss: 0.106 Vali Loss: 0.841 Vali Acc: 0.707 Test Loss: 0.841 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7865967750549316
Epoch: 23, Steps: 13 | Train Loss: 0.095 Vali Loss: 0.881 Vali Acc: 0.712 Test Loss: 0.881 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.953660249710083
Epoch: 24, Steps: 13 | Train Loss: 0.074 Vali Loss: 0.964 Vali Acc: 0.624 Test Loss: 0.964 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8269212245941162
Epoch: 25, Steps: 13 | Train Loss: 0.090 Vali Loss: 0.936 Vali Acc: 0.712 Test Loss: 0.936 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 61226
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.20607852935791
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9469428062438965
Epoch: 2, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.8163566589355469
Epoch: 3, Steps: 13 | Train Loss: 0.569 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9712157249450684
Epoch: 4, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 2.0442209243774414
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9437062740325928
Epoch: 6, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 1.9049100875854492
Epoch: 7, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.8855292797088623
Epoch: 8, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9580581188201904
Epoch: 9, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.7297353744506836
Epoch: 10, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.722595453262329
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.579 Vali Acc: 0.741 Test Loss: 0.579 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7788841724395752
Epoch: 12, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.843043565750122
Epoch: 13, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.625 Vali Acc: 0.722 Test Loss: 0.625 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7805812358856201
Epoch: 14, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.994375228881836
Epoch: 15, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751213).  Saving model ...
Epoch: 16 cost time: 1.7710778713226318
Epoch: 16, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.953812837600708
Epoch: 17, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.882 Vali Acc: 0.576 Test Loss: 0.882 Test Acc: 0.576
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8136379718780518
Epoch: 18, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.723 Vali Acc: 0.717 Test Loss: 0.723 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8070120811462402
Epoch: 19, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.796 Vali Acc: 0.727 Test Loss: 0.796 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.878706932067871
Epoch: 20, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6343333721160889
Epoch: 21, Steps: 13 | Train Loss: 0.109 Vali Loss: 0.769 Vali Acc: 0.707 Test Loss: 0.769 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6912992000579834
Epoch: 22, Steps: 13 | Train Loss: 0.102 Vali Loss: 0.809 Vali Acc: 0.693 Test Loss: 0.809 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6675810813903809
Epoch: 23, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.876 Vali Acc: 0.693 Test Loss: 0.876 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7816815376281738
Epoch: 24, Steps: 13 | Train Loss: 0.082 Vali Loss: 0.940 Vali Acc: 0.668 Test Loss: 0.940 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7814414501190186
Epoch: 25, Steps: 13 | Train Loss: 0.091 Vali Loss: 0.892 Vali Acc: 0.673 Test Loss: 0.892 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 61226
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.225569725036621
Epoch: 1, Steps: 13 | Train Loss: 0.635 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6748642921447754
Epoch: 2, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.6668035984039307
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8318533897399902
Epoch: 4, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.9638264179229736
Epoch: 5, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8303167819976807
Epoch: 6, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.558 Vali Acc: 0.732 Test Loss: 0.558 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 2.031975746154785
Epoch: 7, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 1.9679241180419922
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.8764476776123047
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.7849533557891846
Epoch: 10, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9671919345855713
Epoch: 11, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.879012107849121
Epoch: 12, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0305464267730713
Epoch: 13, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.611 Vali Acc: 0.698 Test Loss: 0.611 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7928638458251953
Epoch: 14, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.626 Vali Acc: 0.732 Test Loss: 0.626 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.766972541809082
Epoch: 15, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7877061367034912
Epoch: 16, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.712 Vali Acc: 0.727 Test Loss: 0.712 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9439606666564941
Epoch: 17, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.790 Vali Acc: 0.629 Test Loss: 0.790 Test Acc: 0.629
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.0241665840148926
Epoch: 18, Steps: 13 | Train Loss: 0.188 Vali Loss: 0.689 Vali Acc: 0.683 Test Loss: 0.689 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.879453182220459
Epoch: 19, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.753 Vali Acc: 0.732 Test Loss: 0.753 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 61226
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.026172161102295
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.604 Vali Acc: 0.722 Test Loss: 0.604 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5947680473327637
Epoch: 2, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.570 Vali Acc: 0.722 Test Loss: 0.570 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.6271593570709229
Epoch: 3, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5912039279937744
Epoch: 4, Steps: 13 | Train Loss: 0.560 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.6758413314819336
Epoch: 5, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.631 Vali Acc: 0.717 Test Loss: 0.631 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.878833532333374
Epoch: 6, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.549 Vali Acc: 0.756 Test Loss: 0.549 Test Acc: 0.756
Validation loss decreased (-0.726824 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.771235466003418
Epoch: 7, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7296249866485596
Epoch: 8, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.548 Vali Acc: 0.741 Test Loss: 0.548 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.617950439453125
Epoch: 9, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5743720531463623
Epoch: 10, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.537 Vali Acc: 0.741 Test Loss: 0.537 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6649305820465088
Epoch: 11, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.556 Vali Acc: 0.732 Test Loss: 0.556 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7184484004974365
Epoch: 12, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.688310146331787
Epoch: 13, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.542 Vali Acc: 0.746 Test Loss: 0.542 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.684523344039917
Epoch: 14, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.611 Vali Acc: 0.746 Test Loss: 0.611 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6286180019378662
Epoch: 15, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7978057861328125
Epoch: 16, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.715 Vali Acc: 0.722 Test Loss: 0.715 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 61226
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.888742208480835
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.7465195655822754
Epoch: 2, Steps: 13 | Train Loss: 0.604 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.5656492710113525
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.561 Vali Acc: 0.722 Test Loss: 0.561 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.7906882762908936
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.7954740524291992
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 2.065187454223633
Epoch: 6, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.792499303817749
Epoch: 7, Steps: 13 | Train Loss: 0.423 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1121699810028076
Epoch: 8, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8520326614379883
Epoch: 9, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9002771377563477
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.592 Vali Acc: 0.751 Test Loss: 0.592 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 1.8474292755126953
Epoch: 11, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7477705478668213
Epoch: 12, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.644 Vali Acc: 0.707 Test Loss: 0.644 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.003371238708496
Epoch: 13, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.023329257965088
Epoch: 14, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.761 Vali Acc: 0.732 Test Loss: 0.761 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8269364833831787
Epoch: 15, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.690 Vali Acc: 0.732 Test Loss: 0.690 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8945047855377197
Epoch: 16, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.673 Vali Acc: 0.717 Test Loss: 0.673 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0016303062438965
Epoch: 17, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.709 Vali Acc: 0.698 Test Loss: 0.709 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8314173221588135
Epoch: 18, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.738985300064087
Epoch: 19, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.730 Vali Acc: 0.741 Test Loss: 0.730 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7712273597717285
Epoch: 20, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.722 Vali Acc: 0.702 Test Loss: 0.722 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 53034
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.071897029876709
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.961688756942749
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.7260971069335938
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 1.6672756671905518
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.6397321224212646
Epoch: 5, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.5765001773834229
Epoch: 6, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6297059059143066
Epoch: 7, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7656123638153076
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7650275230407715
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.591 Vali Acc: 0.741 Test Loss: 0.591 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7455816268920898
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.583 Vali Acc: 0.741 Test Loss: 0.583 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8723781108856201
Epoch: 11, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.584 Vali Acc: 0.741 Test Loss: 0.584 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.6503589153289795
Epoch: 12, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.646 Vali Acc: 0.668 Test Loss: 0.646 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.740947961807251
Epoch: 13, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.691115140914917
Epoch: 14, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.766 Vali Acc: 0.737 Test Loss: 0.766 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8328440189361572
Epoch: 15, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 53034
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9129889011383057
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6703665256500244
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.8436787128448486
Epoch: 3, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.562 Vali Acc: 0.722 Test Loss: 0.562 Test Acc: 0.722
Validation loss decreased (-0.721946 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.7480478286743164
Epoch: 4, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8413479328155518
Epoch: 5, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.566 Vali Acc: 0.741 Test Loss: 0.566 Test Acc: 0.741
Validation loss decreased (-0.721946 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.909592628479004
Epoch: 6, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9316956996917725
Epoch: 7, Steps: 13 | Train Loss: 0.446 Vali Loss: 0.572 Vali Acc: 0.727 Test Loss: 0.572 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.863407850265503
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6781933307647705
Epoch: 9, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.586 Vali Acc: 0.741 Test Loss: 0.586 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8406028747558594
Epoch: 10, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.558 Vali Acc: 0.741 Test Loss: 0.558 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 11 cost time: 1.7796859741210938
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.557 Vali Acc: 0.732 Test Loss: 0.557 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6994702816009521
Epoch: 12, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.598 Vali Acc: 0.678 Test Loss: 0.598 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9224729537963867
Epoch: 13, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0365147590637207
Epoch: 14, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.708 Vali Acc: 0.746 Test Loss: 0.708 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746334).  Saving model ...
Epoch: 15 cost time: 1.8071496486663818
Epoch: 15, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.629 Vali Acc: 0.746 Test Loss: 0.629 Test Acc: 0.746
Validation loss decreased (-0.746334 --> -0.746335).  Saving model ...
Epoch: 16 cost time: 1.9100594520568848
Epoch: 16, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9540269374847412
Epoch: 17, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.657 Vali Acc: 0.659 Test Loss: 0.657 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8102750778198242
Epoch: 18, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.622 Vali Acc: 0.712 Test Loss: 0.622 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8033313751220703
Epoch: 19, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.649 Vali Acc: 0.727 Test Loss: 0.649 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8150010108947754
Epoch: 20, Steps: 13 | Train Loss: 0.150 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7044217586517334
Epoch: 21, Steps: 13 | Train Loss: 0.128 Vali Loss: 0.684 Vali Acc: 0.717 Test Loss: 0.684 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8403232097625732
Epoch: 22, Steps: 13 | Train Loss: 0.107 Vali Loss: 0.813 Vali Acc: 0.746 Test Loss: 0.813 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9413394927978516
Epoch: 23, Steps: 13 | Train Loss: 0.096 Vali Loss: 0.750 Vali Acc: 0.668 Test Loss: 0.750 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8717682361602783
Epoch: 24, Steps: 13 | Train Loss: 0.098 Vali Loss: 0.745 Vali Acc: 0.668 Test Loss: 0.745 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8753669261932373
Epoch: 25, Steps: 13 | Train Loss: 0.077 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 53034
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8706727027893066
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6779534816741943
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.77992844581604
Epoch: 3, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.719921588897705
Epoch: 4, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7235140800476074
Epoch: 5, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.5842642784118652
Epoch: 6, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.583 Vali Acc: 0.727 Test Loss: 0.583 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.555537462234497
Epoch: 7, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.7756426334381104
Epoch: 8, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.566 Vali Acc: 0.751 Test Loss: 0.566 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 1.6421589851379395
Epoch: 9, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6228182315826416
Epoch: 10, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.561 Vali Acc: 0.766 Test Loss: 0.561 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 11 cost time: 1.8130342960357666
Epoch: 11, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.600 Vali Acc: 0.751 Test Loss: 0.600 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.770911455154419
Epoch: 12, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.557 Vali Acc: 0.717 Test Loss: 0.557 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6207730770111084
Epoch: 13, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7572448253631592
Epoch: 14, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.791 Vali Acc: 0.741 Test Loss: 0.791 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8200550079345703
Epoch: 15, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.589799165725708
Epoch: 16, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.6318047046661377
Epoch: 17, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.577 Vali Acc: 0.693 Test Loss: 0.577 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7179691791534424
Epoch: 18, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7612369060516357
Epoch: 19, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8263397216796875
Epoch: 20, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.602 Vali Acc: 0.727 Test Loss: 0.602 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 53034
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.482948303222656
Epoch: 1, Steps: 13 | Train Loss: 0.680 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
Validation loss decreased (inf --> -0.736580).  Saving model ...
Epoch: 2 cost time: 2.3897533416748047
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2651329040527344
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2107996940612793
Epoch: 4, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.733 Vali Acc: 0.746 Test Loss: 0.733 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746334).  Saving model ...
Epoch: 5 cost time: 2.2094805240631104
Epoch: 5, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.695 Vali Acc: 0.659 Test Loss: 0.695 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.162513494491577
Epoch: 6, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.949 Vali Acc: 0.722 Test Loss: 0.949 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.192085027694702
Epoch: 7, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.001 Vali Acc: 0.663 Test Loss: 1.001 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.079730272293091
Epoch: 8, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.204 Vali Acc: 0.727 Test Loss: 1.204 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0502469539642334
Epoch: 9, Steps: 13 | Train Loss: 0.555 Vali Loss: 2.377 Vali Acc: 0.317 Test Loss: 2.377 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.1321730613708496
Epoch: 10, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.071 Vali Acc: 0.673 Test Loss: 1.071 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.249101161956787
Epoch: 11, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.534 Vali Acc: 0.566 Test Loss: 1.534 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.226592540740967
Epoch: 12, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.468 Vali Acc: 0.698 Test Loss: 1.468 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.406830072402954
Epoch: 13, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.821 Vali Acc: 0.620 Test Loss: 1.821 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2819643020629883
Epoch: 14, Steps: 13 | Train Loss: 0.824 Vali Loss: 5.842 Vali Acc: 0.298 Test Loss: 5.842 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3198726
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.129594564437866
Epoch: 1, Steps: 13 | Train Loss: 0.699 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
Validation loss decreased (inf --> -0.731702).  Saving model ...
Epoch: 2 cost time: 2.0722806453704834
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0750958919525146
Epoch: 3, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.885 Vali Acc: 0.737 Test Loss: 0.885 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736577).  Saving model ...
Epoch: 4 cost time: 2.178832530975342
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.737 Vali Acc: 0.746 Test Loss: 0.737 Test Acc: 0.746
Validation loss decreased (-0.736577 --> -0.746334).  Saving model ...
Epoch: 5 cost time: 2.0006134510040283
Epoch: 5, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.731 Vali Acc: 0.737 Test Loss: 0.731 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.136526584625244
Epoch: 6, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.173 Vali Acc: 0.741 Test Loss: 1.173 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2572312355041504
Epoch: 7, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.950 Vali Acc: 0.712 Test Loss: 0.950 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1511361598968506
Epoch: 8, Steps: 13 | Train Loss: 0.586 Vali Loss: 1.576 Vali Acc: 0.473 Test Loss: 1.576 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1826438903808594
Epoch: 9, Steps: 13 | Train Loss: 0.323 Vali Loss: 1.176 Vali Acc: 0.693 Test Loss: 1.176 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.2897214889526367
Epoch: 10, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.733 Vali Acc: 0.537 Test Loss: 1.733 Test Acc: 0.537
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.274492025375366
Epoch: 11, Steps: 13 | Train Loss: 0.190 Vali Loss: 2.383 Vali Acc: 0.722 Test Loss: 2.383 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.1798481941223145
Epoch: 12, Steps: 13 | Train Loss: 0.208 Vali Loss: 2.415 Vali Acc: 0.712 Test Loss: 2.415 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.244619846343994
Epoch: 13, Steps: 13 | Train Loss: 0.058 Vali Loss: 2.520 Vali Acc: 0.551 Test Loss: 2.520 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.1991093158721924
Epoch: 14, Steps: 13 | Train Loss: 0.280 Vali Loss: 1.947 Vali Acc: 0.673 Test Loss: 1.947 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3198726
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.393845319747925
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.968306303024292
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1126868724823
Epoch: 3, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0345964431762695
Epoch: 4, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.848 Vali Acc: 0.746 Test Loss: 0.848 Test Acc: 0.746
Validation loss decreased (-0.726824 --> -0.746333).  Saving model ...
Epoch: 5 cost time: 2.0032107830047607
Epoch: 5, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.783 Vali Acc: 0.722 Test Loss: 0.783 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.018824815750122
Epoch: 6, Steps: 13 | Train Loss: 0.274 Vali Loss: 1.169 Vali Acc: 0.741 Test Loss: 1.169 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2513182163238525
Epoch: 7, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.877 Vali Acc: 0.717 Test Loss: 0.877 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.0842552185058594
Epoch: 8, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.935 Vali Acc: 0.712 Test Loss: 0.935 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.21120023727417
Epoch: 9, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.961 Vali Acc: 0.317 Test Loss: 1.961 Test Acc: 0.317
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9889042377471924
Epoch: 10, Steps: 13 | Train Loss: 0.321 Vali Loss: 1.736 Vali Acc: 0.727 Test Loss: 1.736 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.072841167449951
Epoch: 11, Steps: 13 | Train Loss: 0.133 Vali Loss: 1.388 Vali Acc: 0.693 Test Loss: 1.388 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.863741397857666
Epoch: 12, Steps: 13 | Train Loss: 0.113 Vali Loss: 2.383 Vali Acc: 0.702 Test Loss: 2.383 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.8918190002441406
Epoch: 13, Steps: 13 | Train Loss: 0.302 Vali Loss: 2.254 Vali Acc: 0.439 Test Loss: 2.254 Test Acc: 0.439
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.366849184036255
Epoch: 14, Steps: 13 | Train Loss: 0.512 Vali Loss: 2.396 Vali Acc: 0.576 Test Loss: 2.396 Test Acc: 0.576
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 3198726
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.510648012161255
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.964824914932251
Epoch: 2, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.552 Vali Acc: 0.737 Test Loss: 0.552 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.161972999572754
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0543689727783203
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.649 Vali Acc: 0.741 Test Loss: 0.649 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.899738073348999
Epoch: 5, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8791394233703613
Epoch: 6, Steps: 13 | Train Loss: 0.309 Vali Loss: 1.073 Vali Acc: 0.732 Test Loss: 1.073 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.215608835220337
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.908 Vali Acc: 0.649 Test Loss: 0.908 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.045504331588745
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 1.092 Vali Acc: 0.727 Test Loss: 1.092 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0137970447540283
Epoch: 9, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.475 Vali Acc: 0.463 Test Loss: 1.475 Test Acc: 0.463
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.874441385269165
Epoch: 10, Steps: 13 | Train Loss: 0.129 Vali Loss: 2.074 Vali Acc: 0.712 Test Loss: 2.074 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.87846040725708
Epoch: 11, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.322 Vali Acc: 0.615 Test Loss: 1.322 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.9073247909545898
Epoch: 12, Steps: 13 | Train Loss: 0.082 Vali Loss: 2.171 Vali Acc: 0.702 Test Loss: 2.171 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.008901834487915
Epoch: 13, Steps: 13 | Train Loss: 0.250 Vali Loss: 1.664 Vali Acc: 0.639 Test Loss: 1.664 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.2105395793914795
Epoch: 14, Steps: 13 | Train Loss: 0.150 Vali Loss: 2.628 Vali Acc: 0.712 Test Loss: 2.628 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 3198726
model size : 21.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.349987506866455
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.9502530097961426
Epoch: 2, Steps: 13 | Train Loss: 0.768 Vali Loss: 1.269 Vali Acc: 0.722 Test Loss: 1.269 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9115610122680664
Epoch: 3, Steps: 13 | Train Loss: 0.790 Vali Loss: 1.006 Vali Acc: 0.741 Test Loss: 1.006 Test Acc: 0.741
Validation loss decreased (-0.721944 --> -0.741453).  Saving model ...
Epoch: 4 cost time: 1.9148476123809814
Epoch: 4, Steps: 13 | Train Loss: 0.592 Vali Loss: 1.561 Vali Acc: 0.293 Test Loss: 1.561 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9471349716186523
Epoch: 5, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.968 Vali Acc: 0.737 Test Loss: 0.968 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2711451053619385
Epoch: 6, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.828 Vali Acc: 0.693 Test Loss: 0.828 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.181372880935669
Epoch: 7, Steps: 13 | Train Loss: 0.258 Vali Loss: 1.658 Vali Acc: 0.727 Test Loss: 1.658 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.1924264430999756
Epoch: 8, Steps: 13 | Train Loss: 0.515 Vali Loss: 2.007 Vali Acc: 0.439 Test Loss: 2.007 Test Acc: 0.439
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.2414305210113525
Epoch: 9, Steps: 13 | Train Loss: 0.223 Vali Loss: 1.098 Vali Acc: 0.693 Test Loss: 1.098 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.1918869018554688
Epoch: 10, Steps: 13 | Train Loss: 0.139 Vali Loss: 1.277 Vali Acc: 0.654 Test Loss: 1.277 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.1904296875
Epoch: 11, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.570 Vali Acc: 0.712 Test Loss: 1.570 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.1206252574920654
Epoch: 12, Steps: 13 | Train Loss: 0.055 Vali Loss: 1.836 Vali Acc: 0.712 Test Loss: 1.836 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1374425888061523
Epoch: 13, Steps: 13 | Train Loss: 0.179 Vali Loss: 2.317 Vali Acc: 0.712 Test Loss: 2.317 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2150150
model size : 17.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.151142358779907
Epoch: 1, Steps: 13 | Train Loss: 0.625 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.0422286987304688
Epoch: 2, Steps: 13 | Train Loss: 1.096 Vali Loss: 0.569 Vali Acc: 0.737 Test Loss: 0.569 Test Acc: 0.737
Validation loss decreased (-0.717066 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 2.0481622219085693
Epoch: 3, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.564 Vali Acc: 0.698 Test Loss: 0.564 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9714593887329102
Epoch: 4, Steps: 13 | Train Loss: 0.776 Vali Loss: 1.396 Vali Acc: 0.283 Test Loss: 1.396 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1501622200012207
Epoch: 5, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.783 Vali Acc: 0.737 Test Loss: 0.783 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.977367639541626
Epoch: 6, Steps: 13 | Train Loss: 0.349 Vali Loss: 0.869 Vali Acc: 0.741 Test Loss: 0.869 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741455).  Saving model ...
Epoch: 7 cost time: 2.02941632270813
Epoch: 7, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.186 Vali Acc: 0.732 Test Loss: 1.186 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1670515537261963
Epoch: 8, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.114 Vali Acc: 0.546 Test Loss: 1.114 Test Acc: 0.546
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.19970703125
Epoch: 9, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.221 Vali Acc: 0.732 Test Loss: 1.221 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2185585498809814
Epoch: 10, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.681 Vali Acc: 0.737 Test Loss: 1.681 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8501181602478027
Epoch: 11, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.599 Vali Acc: 0.693 Test Loss: 1.599 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.9240303039550781
Epoch: 12, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.604 Vali Acc: 0.707 Test Loss: 1.604 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0258586406707764
Epoch: 13, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.603 Vali Acc: 0.659 Test Loss: 1.603 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.0141162872314453
Epoch: 14, Steps: 13 | Train Loss: 0.149 Vali Loss: 2.781 Vali Acc: 0.580 Test Loss: 2.781 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.0085835456848145
Epoch: 15, Steps: 13 | Train Loss: 0.140 Vali Loss: 2.741 Vali Acc: 0.688 Test Loss: 2.741 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.9646825790405273
Epoch: 16, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.614 Vali Acc: 0.663 Test Loss: 2.614 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2150150
model size : 17.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.3238747119903564
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.658 Vali Acc: 0.722 Test Loss: 0.658 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 2.130411386489868
Epoch: 2, Steps: 13 | Train Loss: 0.869 Vali Loss: 0.683 Vali Acc: 0.741 Test Loss: 0.683 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 2.0958356857299805
Epoch: 3, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9585857391357422
Epoch: 4, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.611 Vali Acc: 0.683 Test Loss: 0.611 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8994286060333252
Epoch: 5, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.692 Vali Acc: 0.727 Test Loss: 1.692 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.026625871658325
Epoch: 6, Steps: 13 | Train Loss: 0.704 Vali Loss: 1.322 Vali Acc: 0.746 Test Loss: 1.322 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746328).  Saving model ...
Epoch: 7 cost time: 2.128824472427368
Epoch: 7, Steps: 13 | Train Loss: 0.742 Vali Loss: 1.192 Vali Acc: 0.571 Test Loss: 1.192 Test Acc: 0.571
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0570168495178223
Epoch: 8, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.811 Vali Acc: 0.707 Test Loss: 0.811 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9664437770843506
Epoch: 9, Steps: 13 | Train Loss: 0.441 Vali Loss: 1.254 Vali Acc: 0.605 Test Loss: 1.254 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0174267292022705
Epoch: 10, Steps: 13 | Train Loss: 0.161 Vali Loss: 1.108 Vali Acc: 0.683 Test Loss: 1.108 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9592061042785645
Epoch: 11, Steps: 13 | Train Loss: 0.126 Vali Loss: 1.330 Vali Acc: 0.702 Test Loss: 1.330 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8672280311584473
Epoch: 12, Steps: 13 | Train Loss: 0.093 Vali Loss: 1.238 Vali Acc: 0.693 Test Loss: 1.238 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8596584796905518
Epoch: 13, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.478 Vali Acc: 0.702 Test Loss: 1.478 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9020030498504639
Epoch: 14, Steps: 13 | Train Loss: 0.082 Vali Loss: 1.541 Vali Acc: 0.688 Test Loss: 1.541 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.9278302192687988
Epoch: 15, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.966 Vali Acc: 0.629 Test Loss: 1.966 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8614580631256104
Epoch: 16, Steps: 13 | Train Loss: 0.086 Vali Loss: 2.820 Vali Acc: 0.712 Test Loss: 2.820 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 2150150
model size : 17.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.00705623626709
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.654 Vali Acc: 0.722 Test Loss: 0.654 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.9820144176483154
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 1.037 Vali Acc: 0.717 Test Loss: 1.037 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9385883808135986
Epoch: 3, Steps: 13 | Train Loss: 0.720 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.8076035976409912
Epoch: 4, Steps: 13 | Train Loss: 0.734 Vali Loss: 1.056 Vali Acc: 0.293 Test Loss: 1.056 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7896535396575928
Epoch: 5, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.597 Vali Acc: 0.683 Test Loss: 0.597 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7489871978759766
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.810 Vali Acc: 0.741 Test Loss: 0.810 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9114105701446533
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.754 Vali Acc: 0.732 Test Loss: 0.754 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7392516136169434
Epoch: 8, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.755 Vali Acc: 0.722 Test Loss: 0.755 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8721027374267578
Epoch: 9, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.629 Vali Acc: 0.551 Test Loss: 1.629 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9748363494873047
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 2.188 Vali Acc: 0.722 Test Loss: 2.188 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8933167457580566
Epoch: 11, Steps: 13 | Train Loss: 0.556 Vali Loss: 2.958 Vali Acc: 0.727 Test Loss: 2.958 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.031508445739746
Epoch: 12, Steps: 13 | Train Loss: 0.735 Vali Loss: 3.069 Vali Acc: 0.488 Test Loss: 3.069 Test Acc: 0.488
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.001927614212036
Epoch: 13, Steps: 13 | Train Loss: 0.103 Vali Loss: 2.530 Vali Acc: 0.722 Test Loss: 2.530 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 2150150
model size : 17.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.659757137298584
Epoch: 1, Steps: 13 | Train Loss: 0.964 Vali Loss: 2.038 Vali Acc: 0.278 Test Loss: 2.038 Test Acc: 0.278
Validation loss decreased (inf --> -0.278028).  Saving model ...
Epoch: 2 cost time: 1.9725854396820068
Epoch: 2, Steps: 13 | Train Loss: 0.773 Vali Loss: 0.957 Vali Acc: 0.722 Test Loss: 0.957 Test Acc: 0.722
Validation loss decreased (-0.278028 --> -0.721942).  Saving model ...
Epoch: 3 cost time: 2.138979434967041
Epoch: 3, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.608 Vali Acc: 0.668 Test Loss: 0.608 Test Acc: 0.668
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1138787269592285
Epoch: 4, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.989 Vali Acc: 0.361 Test Loss: 0.989 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3396573066711426
Epoch: 5, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.702 Vali Acc: 0.678 Test Loss: 0.702 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4028847217559814
Epoch: 6, Steps: 13 | Train Loss: 0.204 Vali Loss: 1.086 Vali Acc: 0.444 Test Loss: 1.086 Test Acc: 0.444
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.2034289836883545
Epoch: 7, Steps: 13 | Train Loss: 0.193 Vali Loss: 1.474 Vali Acc: 0.356 Test Loss: 1.474 Test Acc: 0.356
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.252718210220337
Epoch: 8, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.932 Vali Acc: 0.663 Test Loss: 0.932 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.0904934406280518
Epoch: 9, Steps: 13 | Train Loss: 0.885 Vali Loss: 1.852 Vali Acc: 0.722 Test Loss: 1.852 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.090470314025879
Epoch: 10, Steps: 13 | Train Loss: 0.632 Vali Loss: 2.530 Vali Acc: 0.707 Test Loss: 2.530 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0728964805603027
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 1.989 Vali Acc: 0.380 Test Loss: 1.989 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.971189260482788
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 1.944 Vali Acc: 0.639 Test Loss: 1.944 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 1625862
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.24831485748291
Epoch: 1, Steps: 13 | Train Loss: 0.953 Vali Loss: 2.005 Vali Acc: 0.278 Test Loss: 2.005 Test Acc: 0.278
Validation loss decreased (inf --> -0.278029).  Saving model ...
Epoch: 2 cost time: 2.1482486724853516
Epoch: 2, Steps: 13 | Train Loss: 0.769 Vali Loss: 0.940 Vali Acc: 0.717 Test Loss: 0.940 Test Acc: 0.717
Validation loss decreased (-0.278029 --> -0.717064).  Saving model ...
Epoch: 3 cost time: 2.114880323410034
Epoch: 3, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.589 Vali Acc: 0.688 Test Loss: 0.589 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.153824806213379
Epoch: 4, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.640 Vali Acc: 0.678 Test Loss: 0.640 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.120640277862549
Epoch: 5, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.671 Vali Acc: 0.673 Test Loss: 0.671 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.364758014678955
Epoch: 6, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.914 Vali Acc: 0.732 Test Loss: 0.914 Test Acc: 0.732
Validation loss decreased (-0.717064 --> -0.731698).  Saving model ...
Epoch: 7 cost time: 2.0882954597473145
Epoch: 7, Steps: 13 | Train Loss: 0.428 Vali Loss: 1.830 Vali Acc: 0.317 Test Loss: 1.830 Test Acc: 0.317
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9443280696868896
Epoch: 8, Steps: 13 | Train Loss: 0.573 Vali Loss: 3.169 Vali Acc: 0.288 Test Loss: 3.169 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.054670810699463
Epoch: 9, Steps: 13 | Train Loss: 0.436 Vali Loss: 1.665 Vali Acc: 0.727 Test Loss: 1.665 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0876388549804688
Epoch: 10, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.493 Vali Acc: 0.585 Test Loss: 1.493 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0055084228515625
Epoch: 11, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.446 Vali Acc: 0.663 Test Loss: 1.446 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.152711868286133
Epoch: 12, Steps: 13 | Train Loss: 0.237 Vali Loss: 1.871 Vali Acc: 0.659 Test Loss: 1.871 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.960860013961792
Epoch: 13, Steps: 13 | Train Loss: 0.891 Vali Loss: 2.540 Vali Acc: 0.673 Test Loss: 2.540 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.2867672443389893
Epoch: 14, Steps: 13 | Train Loss: 0.326 Vali Loss: 2.381 Vali Acc: 0.732 Test Loss: 2.381 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.002960681915283
Epoch: 15, Steps: 13 | Train Loss: 0.060 Vali Loss: 2.441 Vali Acc: 0.649 Test Loss: 2.441 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.142692804336548
Epoch: 16, Steps: 13 | Train Loss: 0.044 Vali Loss: 2.355 Vali Acc: 0.717 Test Loss: 2.355 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 1625862
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.262902021408081
Epoch: 1, Steps: 13 | Train Loss: 0.949 Vali Loss: 2.101 Vali Acc: 0.278 Test Loss: 2.101 Test Acc: 0.278
Validation loss decreased (inf --> -0.278028).  Saving model ...
Epoch: 2 cost time: 1.8581047058105469
Epoch: 2, Steps: 13 | Train Loss: 0.775 Vali Loss: 0.880 Vali Acc: 0.722 Test Loss: 0.880 Test Acc: 0.722
Validation loss decreased (-0.278028 --> -0.721942).  Saving model ...
Epoch: 3 cost time: 1.8294517993927002
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.579 Vali Acc: 0.727 Test Loss: 0.579 Test Acc: 0.727
Validation loss decreased (-0.721942 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.9844181537628174
Epoch: 4, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.719 Vali Acc: 0.644 Test Loss: 0.719 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.062067747116089
Epoch: 5, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.663 Vali Acc: 0.707 Test Loss: 0.663 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.880613088607788
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.751 Vali Acc: 0.712 Test Loss: 0.751 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9118201732635498
Epoch: 7, Steps: 13 | Train Loss: 0.587 Vali Loss: 2.582 Vali Acc: 0.288 Test Loss: 2.582 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.055070400238037
Epoch: 8, Steps: 13 | Train Loss: 1.248 Vali Loss: 0.983 Vali Acc: 0.629 Test Loss: 0.983 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8185787200927734
Epoch: 9, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.983 Vali Acc: 0.654 Test Loss: 0.983 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.042792320251465
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.241 Vali Acc: 0.702 Test Loss: 1.241 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9181935787200928
Epoch: 11, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.309 Vali Acc: 0.620 Test Loss: 1.309 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.9818851947784424
Epoch: 12, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.505 Vali Acc: 0.751 Test Loss: 1.505 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751204).  Saving model ...
Epoch: 13 cost time: 1.8819804191589355
Epoch: 13, Steps: 13 | Train Loss: 0.355 Vali Loss: 2.172 Vali Acc: 0.746 Test Loss: 2.172 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0165772438049316
Epoch: 14, Steps: 13 | Train Loss: 0.436 Vali Loss: 2.383 Vali Acc: 0.737 Test Loss: 2.383 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.186448335647583
Epoch: 15, Steps: 13 | Train Loss: 0.203 Vali Loss: 3.110 Vali Acc: 0.756 Test Loss: 3.110 Test Acc: 0.756
Validation loss decreased (-0.751204 --> -0.756066).  Saving model ...
Epoch: 16 cost time: 2.102198839187622
Epoch: 16, Steps: 13 | Train Loss: 0.170 Vali Loss: 2.774 Vali Acc: 0.732 Test Loss: 2.774 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.91796875
Epoch: 17, Steps: 13 | Train Loss: 0.144 Vali Loss: 2.302 Vali Acc: 0.693 Test Loss: 2.302 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2402589321136475
Epoch: 18, Steps: 13 | Train Loss: 0.041 Vali Loss: 3.655 Vali Acc: 0.746 Test Loss: 3.655 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.124737501144409
Epoch: 19, Steps: 13 | Train Loss: 0.108 Vali Loss: 3.335 Vali Acc: 0.732 Test Loss: 3.335 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0576648712158203
Epoch: 20, Steps: 13 | Train Loss: 0.159 Vali Loss: 4.482 Vali Acc: 0.746 Test Loss: 4.482 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9666552543640137
Epoch: 21, Steps: 13 | Train Loss: 0.127 Vali Loss: 3.809 Vali Acc: 0.659 Test Loss: 3.809 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9527361392974854
Epoch: 22, Steps: 13 | Train Loss: 0.059 Vali Loss: 4.648 Vali Acc: 0.698 Test Loss: 4.648 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.0184166431427
Epoch: 23, Steps: 13 | Train Loss: 0.039 Vali Loss: 4.259 Vali Acc: 0.673 Test Loss: 4.259 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.1220805644989014
Epoch: 24, Steps: 13 | Train Loss: 0.089 Vali Loss: 4.430 Vali Acc: 0.644 Test Loss: 4.430 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1873419284820557
Epoch: 25, Steps: 13 | Train Loss: 0.003 Vali Loss: 5.042 Vali Acc: 0.663 Test Loss: 5.042 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1625862
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9490301609039307
Epoch: 1, Steps: 13 | Train Loss: 0.870 Vali Loss: 1.907 Vali Acc: 0.288 Test Loss: 1.907 Test Acc: 0.288
Validation loss decreased (inf --> -0.287786).  Saving model ...
Epoch: 2 cost time: 1.9713478088378906
Epoch: 2, Steps: 13 | Train Loss: 0.788 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
Validation loss decreased (-0.287786 --> -0.717065).  Saving model ...
Epoch: 3 cost time: 1.9520421028137207
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.602 Vali Acc: 0.707 Test Loss: 0.602 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9363820552825928
Epoch: 4, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.741 Vali Acc: 0.605 Test Loss: 0.741 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.664839267730713
Epoch: 5, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.701 Vali Acc: 0.727 Test Loss: 0.701 Test Acc: 0.727
Validation loss decreased (-0.717065 --> -0.726822).  Saving model ...
Epoch: 6 cost time: 1.9138171672821045
Epoch: 6, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.053 Vali Acc: 0.322 Test Loss: 1.053 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8108348846435547
Epoch: 7, Steps: 13 | Train Loss: 0.282 Vali Loss: 1.043 Vali Acc: 0.532 Test Loss: 1.043 Test Acc: 0.532
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.805574655532837
Epoch: 8, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.021 Vali Acc: 0.698 Test Loss: 1.021 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.581702709197998
Epoch: 9, Steps: 13 | Train Loss: 0.355 Vali Loss: 1.379 Vali Acc: 0.712 Test Loss: 1.379 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9240028858184814
Epoch: 10, Steps: 13 | Train Loss: 0.378 Vali Loss: 1.805 Vali Acc: 0.546 Test Loss: 1.805 Test Acc: 0.546
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9610774517059326
Epoch: 11, Steps: 13 | Train Loss: 0.146 Vali Loss: 1.174 Vali Acc: 0.615 Test Loss: 1.174 Test Acc: 0.615
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8241097927093506
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.895 Vali Acc: 0.727 Test Loss: 1.895 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8371648788452148
Epoch: 13, Steps: 13 | Train Loss: 0.110 Vali Loss: 2.099 Vali Acc: 0.712 Test Loss: 2.099 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.8414394855499268
Epoch: 14, Steps: 13 | Train Loss: 0.152 Vali Loss: 1.993 Vali Acc: 0.663 Test Loss: 1.993 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.81117582321167
Epoch: 15, Steps: 13 | Train Loss: 0.024 Vali Loss: 2.858 Vali Acc: 0.698 Test Loss: 2.858 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 1625862
model size : 15.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.167412281036377
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.020979881286621
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.624 Vali Acc: 0.751 Test Loss: 0.624 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 2.007401943206787
Epoch: 3, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0342719554901123
Epoch: 4, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.689 Vali Acc: 0.741 Test Loss: 0.689 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1123104095458984
Epoch: 5, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.711 Vali Acc: 0.732 Test Loss: 0.711 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.15071702003479
Epoch: 6, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.769 Vali Acc: 0.722 Test Loss: 0.769 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.255247116088867
Epoch: 7, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.286 Vali Acc: 0.483 Test Loss: 1.286 Test Acc: 0.483
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.088278293609619
Epoch: 8, Steps: 13 | Train Loss: 0.209 Vali Loss: 1.261 Vali Acc: 0.517 Test Loss: 1.261 Test Acc: 0.517
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.131951332092285
Epoch: 9, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.883 Vali Acc: 0.737 Test Loss: 1.883 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.128796100616455
Epoch: 10, Steps: 13 | Train Loss: 0.565 Vali Loss: 2.575 Vali Acc: 0.737 Test Loss: 2.575 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8411674499511719
Epoch: 11, Steps: 13 | Train Loss: 0.548 Vali Loss: 3.195 Vali Acc: 0.717 Test Loss: 3.195 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8847758769989014
Epoch: 12, Steps: 13 | Train Loss: 0.934 Vali Loss: 2.939 Vali Acc: 0.732 Test Loss: 2.939 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 1363718
model size : 14.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.069326877593994
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.708 Vali Acc: 0.717 Test Loss: 0.708 Test Acc: 0.717
Validation loss decreased (inf --> -0.717066).  Saving model ...
Epoch: 2 cost time: 2.056730031967163
Epoch: 2, Steps: 13 | Train Loss: 0.538 Vali Loss: 0.592 Vali Acc: 0.756 Test Loss: 0.592 Test Acc: 0.756
Validation loss decreased (-0.717066 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.910130500793457
Epoch: 3, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.044166326522827
Epoch: 4, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.604 Vali Acc: 0.707 Test Loss: 0.604 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2168095111846924
Epoch: 5, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.712 Vali Acc: 0.654 Test Loss: 0.712 Test Acc: 0.654
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1701955795288086
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 2.738 Vali Acc: 0.288 Test Loss: 2.738 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0186195373535156
Epoch: 7, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.825 Vali Acc: 0.707 Test Loss: 0.825 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0721986293792725
Epoch: 8, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.105 Vali Acc: 0.717 Test Loss: 1.105 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.071161985397339
Epoch: 9, Steps: 13 | Train Loss: 0.140 Vali Loss: 1.415 Vali Acc: 0.722 Test Loss: 1.415 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.162055015563965
Epoch: 10, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.357 Vali Acc: 0.644 Test Loss: 1.357 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0505857467651367
Epoch: 11, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.978 Vali Acc: 0.722 Test Loss: 1.978 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2288031578063965
Epoch: 12, Steps: 13 | Train Loss: 0.226 Vali Loss: 3.185 Vali Acc: 0.707 Test Loss: 3.185 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1363718
model size : 14.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9810235500335693
Epoch: 1, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.680 Vali Acc: 0.746 Test Loss: 0.680 Test Acc: 0.746
Validation loss decreased (inf --> -0.746335).  Saving model ...
Epoch: 2 cost time: 1.942741870880127
Epoch: 2, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751213).  Saving model ...
Epoch: 3 cost time: 1.9942619800567627
Epoch: 3, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.761 Vali Acc: 0.756 Test Loss: 0.761 Test Acc: 0.756
Validation loss decreased (-0.751213 --> -0.756090).  Saving model ...
Epoch: 4 cost time: 1.8018977642059326
Epoch: 4, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6403799057006836
Epoch: 5, Steps: 13 | Train Loss: 0.387 Vali Loss: 1.536 Vali Acc: 0.293 Test Loss: 1.536 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0013067722320557
Epoch: 6, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.886 Vali Acc: 0.741 Test Loss: 0.886 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.8231213092803955
Epoch: 7, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.788 Vali Acc: 0.659 Test Loss: 0.788 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.7810401916503906
Epoch: 8, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.890 Vali Acc: 0.629 Test Loss: 0.890 Test Acc: 0.629
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9173390865325928
Epoch: 9, Steps: 13 | Train Loss: 0.310 Vali Loss: 2.236 Vali Acc: 0.732 Test Loss: 2.236 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9403150081634521
Epoch: 10, Steps: 13 | Train Loss: 0.531 Vali Loss: 1.943 Vali Acc: 0.741 Test Loss: 1.943 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.8271543979644775
Epoch: 11, Steps: 13 | Train Loss: 0.221 Vali Loss: 1.372 Vali Acc: 0.698 Test Loss: 1.372 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8437931537628174
Epoch: 12, Steps: 13 | Train Loss: 0.172 Vali Loss: 2.392 Vali Acc: 0.678 Test Loss: 2.392 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7758386135101318
Epoch: 13, Steps: 13 | Train Loss: 0.297 Vali Loss: 1.509 Vali Acc: 0.717 Test Loss: 1.509 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1363718
model size : 14.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.303030729293823
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
Validation loss decreased (inf --> -0.736579).  Saving model ...
Epoch: 2 cost time: 2.0170352458953857
Epoch: 2, Steps: 13 | Train Loss: 0.657 Vali Loss: 1.017 Vali Acc: 0.288 Test Loss: 1.017 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9216556549072266
Epoch: 3, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.778 Vali Acc: 0.732 Test Loss: 0.778 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9427392482757568
Epoch: 4, Steps: 13 | Train Loss: 0.458 Vali Loss: 0.601 Vali Acc: 0.712 Test Loss: 0.601 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9961488246917725
Epoch: 5, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.984 Vali Acc: 0.302 Test Loss: 0.984 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.8470416069030762
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7950012683868408
Epoch: 7, Steps: 13 | Train Loss: 0.246 Vali Loss: 1.309 Vali Acc: 0.298 Test Loss: 1.309 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.763272762298584
Epoch: 8, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.8124983310699463
Epoch: 9, Steps: 13 | Train Loss: 0.251 Vali Loss: 1.821 Vali Acc: 0.707 Test Loss: 1.821 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7955756187438965
Epoch: 10, Steps: 13 | Train Loss: 0.648 Vali Loss: 2.177 Vali Acc: 0.722 Test Loss: 2.177 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.726060390472412
Epoch: 11, Steps: 13 | Train Loss: 0.192 Vali Loss: 1.721 Vali Acc: 0.668 Test Loss: 1.721 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1363718
model size : 14.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.420407772064209
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 2.1449220180511475
Epoch: 2, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.635 Vali Acc: 0.741 Test Loss: 0.635 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 2.3004095554351807
Epoch: 3, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.176387310028076
Epoch: 4, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.687 Vali Acc: 0.732 Test Loss: 0.687 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3037779331207275
Epoch: 5, Steps: 13 | Train Loss: 0.214 Vali Loss: 0.684 Vali Acc: 0.693 Test Loss: 0.684 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.105116367340088
Epoch: 6, Steps: 13 | Train Loss: 0.244 Vali Loss: 1.274 Vali Acc: 0.732 Test Loss: 1.274 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.178828477859497
Epoch: 7, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.905 Vali Acc: 0.659 Test Loss: 0.905 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3246400356292725
Epoch: 8, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.087 Vali Acc: 0.722 Test Loss: 1.087 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9346885681152344
Epoch: 9, Steps: 13 | Train Loss: 0.149 Vali Loss: 1.532 Vali Acc: 0.741 Test Loss: 1.532 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.080709457397461
Epoch: 10, Steps: 13 | Train Loss: 0.220 Vali Loss: 2.498 Vali Acc: 0.385 Test Loss: 2.498 Test Acc: 0.385
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.0101585388183594
Epoch: 11, Steps: 13 | Train Loss: 0.105 Vali Loss: 1.364 Vali Acc: 0.707 Test Loss: 1.364 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.134061813354492
Epoch: 12, Steps: 13 | Train Loss: 0.305 Vali Loss: 4.027 Vali Acc: 0.356 Test Loss: 4.027 Test Acc: 0.356
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1232646
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.334119558334351
Epoch: 1, Steps: 13 | Train Loss: 0.657 Vali Loss: 0.622 Vali Acc: 0.717 Test Loss: 0.622 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.8457045555114746
Epoch: 2, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.7889761924743652
Epoch: 3, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.896200180053711
Epoch: 4, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.717 Vali Acc: 0.737 Test Loss: 0.717 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3453707695007324
Epoch: 5, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.697 Vali Acc: 0.712 Test Loss: 0.697 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.0343713760375977
Epoch: 6, Steps: 13 | Train Loss: 0.201 Vali Loss: 0.718 Vali Acc: 0.678 Test Loss: 0.718 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0197970867156982
Epoch: 7, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.939 Vali Acc: 0.727 Test Loss: 0.939 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.043386697769165
Epoch: 8, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.225 Vali Acc: 0.727 Test Loss: 1.225 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.042748212814331
Epoch: 9, Steps: 13 | Train Loss: 0.226 Vali Loss: 1.454 Vali Acc: 0.527 Test Loss: 1.454 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2730355262756348
Epoch: 10, Steps: 13 | Train Loss: 0.262 Vali Loss: 2.253 Vali Acc: 0.580 Test Loss: 2.253 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0672388076782227
Epoch: 11, Steps: 13 | Train Loss: 0.095 Vali Loss: 1.485 Vali Acc: 0.561 Test Loss: 1.485 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.10630202293396
Epoch: 12, Steps: 13 | Train Loss: 0.189 Vali Loss: 1.629 Vali Acc: 0.717 Test Loss: 1.629 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.1889896392822266
Epoch: 13, Steps: 13 | Train Loss: 0.104 Vali Loss: 2.107 Vali Acc: 0.732 Test Loss: 2.107 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1232646
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.243342161178589
Epoch: 1, Steps: 13 | Train Loss: 0.685 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.848470687866211
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.779 Vali Acc: 0.727 Test Loss: 0.779 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726821).  Saving model ...
Epoch: 3 cost time: 1.9198925495147705
Epoch: 3, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.697 Vali Acc: 0.722 Test Loss: 0.697 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8639583587646484
Epoch: 4, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
Validation loss decreased (-0.726821 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.977790117263794
Epoch: 5, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.676 Vali Acc: 0.649 Test Loss: 0.676 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9319591522216797
Epoch: 6, Steps: 13 | Train Loss: 0.381 Vali Loss: 1.328 Vali Acc: 0.737 Test Loss: 1.328 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736572).  Saving model ...
Epoch: 7 cost time: 1.9320855140686035
Epoch: 7, Steps: 13 | Train Loss: 0.366 Vali Loss: 1.522 Vali Acc: 0.390 Test Loss: 1.522 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7011477947235107
Epoch: 8, Steps: 13 | Train Loss: 0.228 Vali Loss: 1.084 Vali Acc: 0.727 Test Loss: 1.084 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.850367546081543
Epoch: 9, Steps: 13 | Train Loss: 0.274 Vali Loss: 2.507 Vali Acc: 0.298 Test Loss: 2.507 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.865020751953125
Epoch: 10, Steps: 13 | Train Loss: 0.747 Vali Loss: 3.743 Vali Acc: 0.302 Test Loss: 3.743 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8100330829620361
Epoch: 11, Steps: 13 | Train Loss: 0.530 Vali Loss: 4.790 Vali Acc: 0.293 Test Loss: 4.790 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8813707828521729
Epoch: 12, Steps: 13 | Train Loss: 0.497 Vali Loss: 2.365 Vali Acc: 0.649 Test Loss: 2.365 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.8819751739501953
Epoch: 13, Steps: 13 | Train Loss: 0.141 Vali Loss: 2.030 Vali Acc: 0.678 Test Loss: 2.030 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9162309169769287
Epoch: 14, Steps: 13 | Train Loss: 0.202 Vali Loss: 2.527 Vali Acc: 0.698 Test Loss: 2.527 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.030136823654175
Epoch: 15, Steps: 13 | Train Loss: 0.395 Vali Loss: 1.853 Vali Acc: 0.717 Test Loss: 1.853 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.889946460723877
Epoch: 16, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.192 Vali Acc: 0.590 Test Loss: 2.192 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1232646
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9600563049316406
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.627 Vali Acc: 0.722 Test Loss: 0.627 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.8646035194396973
Epoch: 2, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8456783294677734
Epoch: 3, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.854 Vali Acc: 0.600 Test Loss: 0.854 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.925410509109497
Epoch: 4, Steps: 13 | Train Loss: 0.708 Vali Loss: 0.645 Vali Acc: 0.722 Test Loss: 0.645 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.92936372756958
Epoch: 5, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.685 Vali Acc: 0.727 Test Loss: 0.685 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726822).  Saving model ...
Epoch: 6 cost time: 1.9324891567230225
Epoch: 6, Steps: 13 | Train Loss: 0.450 Vali Loss: 1.579 Vali Acc: 0.717 Test Loss: 1.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.677811622619629
Epoch: 7, Steps: 13 | Train Loss: 0.467 Vali Loss: 1.454 Vali Acc: 0.293 Test Loss: 1.454 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.713876724243164
Epoch: 8, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.013 Vali Acc: 0.717 Test Loss: 1.013 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9986963272094727
Epoch: 9, Steps: 13 | Train Loss: 0.267 Vali Loss: 1.087 Vali Acc: 0.546 Test Loss: 1.087 Test Acc: 0.546
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9955236911773682
Epoch: 10, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.378 Vali Acc: 0.732 Test Loss: 1.378 Test Acc: 0.732
Validation loss decreased (-0.726822 --> -0.731694).  Saving model ...
Epoch: 11 cost time: 2.0870089530944824
Epoch: 11, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.355 Vali Acc: 0.707 Test Loss: 1.355 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8597464561462402
Epoch: 12, Steps: 13 | Train Loss: 0.525 Vali Loss: 3.261 Vali Acc: 0.727 Test Loss: 3.261 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0108840465545654
Epoch: 13, Steps: 13 | Train Loss: 0.706 Vali Loss: 2.353 Vali Acc: 0.727 Test Loss: 2.353 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9952256679534912
Epoch: 14, Steps: 13 | Train Loss: 0.098 Vali Loss: 2.094 Vali Acc: 0.639 Test Loss: 2.094 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9023401737213135
Epoch: 15, Steps: 13 | Train Loss: 0.052 Vali Loss: 2.538 Vali Acc: 0.654 Test Loss: 2.538 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8571946620941162
Epoch: 16, Steps: 13 | Train Loss: 0.041 Vali Loss: 2.827 Vali Acc: 0.717 Test Loss: 2.827 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8262951374053955
Epoch: 17, Steps: 13 | Train Loss: 0.014 Vali Loss: 3.286 Vali Acc: 0.712 Test Loss: 3.286 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8075783252716064
Epoch: 18, Steps: 13 | Train Loss: 0.025 Vali Loss: 3.387 Vali Acc: 0.688 Test Loss: 3.387 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7980122566223145
Epoch: 19, Steps: 13 | Train Loss: 0.002 Vali Loss: 3.566 Vali Acc: 0.668 Test Loss: 3.566 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.907665491104126
Epoch: 20, Steps: 13 | Train Loss: 0.001 Vali Loss: 3.811 Vali Acc: 0.702 Test Loss: 3.811 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 1232646
model size : 14.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.431821584701538
Epoch: 1, Steps: 13 | Train Loss: 0.687 Vali Loss: 0.837 Vali Acc: 0.722 Test Loss: 0.837 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 2.145747184753418
Epoch: 2, Steps: 13 | Train Loss: 0.732 Vali Loss: 0.756 Vali Acc: 0.741 Test Loss: 0.756 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741456).  Saving model ...
Epoch: 3 cost time: 2.1790661811828613
Epoch: 3, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.832 Vali Acc: 0.434 Test Loss: 0.832 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1309211254119873
Epoch: 4, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.710 Vali Acc: 0.649 Test Loss: 0.710 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.1327571868896484
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.238189458847046
Epoch: 6, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.679 Vali Acc: 0.693 Test Loss: 0.679 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0626749992370605
Epoch: 7, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.815 Vali Acc: 0.707 Test Loss: 0.815 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1137800216674805
Epoch: 8, Steps: 13 | Train Loss: 0.208 Vali Loss: 1.076 Vali Acc: 0.693 Test Loss: 1.076 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.2187373638153076
Epoch: 9, Steps: 13 | Train Loss: 0.473 Vali Loss: 2.534 Vali Acc: 0.322 Test Loss: 2.534 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.320112943649292
Epoch: 10, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.567 Vali Acc: 0.712 Test Loss: 1.567 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.1702682971954346
Epoch: 11, Steps: 13 | Train Loss: 0.121 Vali Loss: 1.607 Vali Acc: 0.620 Test Loss: 1.607 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.263624668121338
Epoch: 12, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.820 Vali Acc: 0.639 Test Loss: 1.820 Test Acc: 0.639
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 1167110
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.463709354400635
Epoch: 1, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.823 Vali Acc: 0.722 Test Loss: 0.823 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 1.984370470046997
Epoch: 2, Steps: 13 | Train Loss: 0.743 Vali Loss: 0.711 Vali Acc: 0.741 Test Loss: 0.711 Test Acc: 0.741
Validation loss decreased (-0.721943 --> -0.741456).  Saving model ...
Epoch: 3 cost time: 1.955437183380127
Epoch: 3, Steps: 13 | Train Loss: 0.487 Vali Loss: 0.835 Vali Acc: 0.390 Test Loss: 0.835 Test Acc: 0.390
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9442312717437744
Epoch: 4, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.726 Vali Acc: 0.629 Test Loss: 0.726 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9467310905456543
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.740 Vali Acc: 0.629 Test Loss: 0.740 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0403010845184326
Epoch: 6, Steps: 13 | Train Loss: 0.365 Vali Loss: 1.079 Vali Acc: 0.746 Test Loss: 1.079 Test Acc: 0.746
Validation loss decreased (-0.741456 --> -0.746331).  Saving model ...
Epoch: 7 cost time: 2.0594277381896973
Epoch: 7, Steps: 13 | Train Loss: 0.325 Vali Loss: 1.266 Vali Acc: 0.415 Test Loss: 1.266 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.048116683959961
Epoch: 8, Steps: 13 | Train Loss: 0.339 Vali Loss: 1.014 Vali Acc: 0.737 Test Loss: 1.014 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.079277992248535
Epoch: 9, Steps: 13 | Train Loss: 0.160 Vali Loss: 1.173 Vali Acc: 0.620 Test Loss: 1.173 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2278289794921875
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.728 Vali Acc: 0.741 Test Loss: 1.728 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2452821731567383
Epoch: 11, Steps: 13 | Train Loss: 0.453 Vali Loss: 2.074 Vali Acc: 0.634 Test Loss: 2.074 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1871557235717773
Epoch: 12, Steps: 13 | Train Loss: 0.206 Vali Loss: 1.690 Vali Acc: 0.688 Test Loss: 1.690 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0736136436462402
Epoch: 13, Steps: 13 | Train Loss: 0.075 Vali Loss: 2.327 Vali Acc: 0.712 Test Loss: 2.327 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.347913980484009
Epoch: 14, Steps: 13 | Train Loss: 0.148 Vali Loss: 2.281 Vali Acc: 0.649 Test Loss: 2.281 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.1288065910339355
Epoch: 15, Steps: 13 | Train Loss: 0.472 Vali Loss: 2.653 Vali Acc: 0.707 Test Loss: 2.653 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.1491312980651855
Epoch: 16, Steps: 13 | Train Loss: 0.647 Vali Loss: 2.853 Vali Acc: 0.751 Test Loss: 2.853 Test Acc: 0.751
Validation loss decreased (-0.746331 --> -0.751191).  Saving model ...
Epoch: 17 cost time: 2.078665256500244
Epoch: 17, Steps: 13 | Train Loss: 0.200 Vali Loss: 3.042 Vali Acc: 0.756 Test Loss: 3.042 Test Acc: 0.756
Validation loss decreased (-0.751191 --> -0.756067).  Saving model ...
Epoch: 18 cost time: 1.8943815231323242
Epoch: 18, Steps: 13 | Train Loss: 0.143 Vali Loss: 2.739 Vali Acc: 0.741 Test Loss: 2.739 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.981081485748291
Epoch: 19, Steps: 13 | Train Loss: 0.008 Vali Loss: 1.981 Vali Acc: 0.698 Test Loss: 1.981 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1816282272338867
Epoch: 20, Steps: 13 | Train Loss: 0.006 Vali Loss: 2.272 Vali Acc: 0.649 Test Loss: 2.272 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0631635189056396
Epoch: 21, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.238 Vali Acc: 0.693 Test Loss: 2.238 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0703816413879395
Epoch: 22, Steps: 13 | Train Loss: 0.003 Vali Loss: 2.440 Vali Acc: 0.649 Test Loss: 2.440 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.161172866821289
Epoch: 23, Steps: 13 | Train Loss: 0.022 Vali Loss: 2.858 Vali Acc: 0.717 Test Loss: 2.858 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1641252040863037
Epoch: 24, Steps: 13 | Train Loss: 0.001 Vali Loss: 2.557 Vali Acc: 0.707 Test Loss: 2.557 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3440966606140137
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.700 Vali Acc: 0.727 Test Loss: 2.700 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1656806468963623
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.694 Vali Acc: 0.732 Test Loss: 2.694 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.202559471130371
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 2.714 Vali Acc: 0.727 Test Loss: 2.714 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1167110
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.328972339630127
Epoch: 1, Steps: 13 | Train Loss: 0.675 Vali Loss: 0.807 Vali Acc: 0.722 Test Loss: 0.807 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 2.0058116912841797
Epoch: 2, Steps: 13 | Train Loss: 0.784 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.721943 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.8202552795410156
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.038 Vali Acc: 0.293 Test Loss: 1.038 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9365057945251465
Epoch: 4, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8635432720184326
Epoch: 5, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.636 Vali Acc: 0.741 Test Loss: 0.636 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 2.069344997406006
Epoch: 6, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.900 Vali Acc: 0.410 Test Loss: 0.900 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9904258251190186
Epoch: 7, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.946 Vali Acc: 0.439 Test Loss: 0.946 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.0395267009735107
Epoch: 8, Steps: 13 | Train Loss: 0.254 Vali Loss: 1.159 Vali Acc: 0.737 Test Loss: 1.159 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8795182704925537
Epoch: 9, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.185 Vali Acc: 0.634 Test Loss: 1.185 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.9389257431030273
Epoch: 10, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.377 Vali Acc: 0.741 Test Loss: 1.377 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9168083667755127
Epoch: 11, Steps: 13 | Train Loss: 0.120 Vali Loss: 2.006 Vali Acc: 0.624 Test Loss: 2.006 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.023277521133423
Epoch: 12, Steps: 13 | Train Loss: 0.189 Vali Loss: 2.197 Vali Acc: 0.751 Test Loss: 2.197 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751198).  Saving model ...
Epoch: 13 cost time: 2.0017380714416504
Epoch: 13, Steps: 13 | Train Loss: 0.342 Vali Loss: 1.751 Vali Acc: 0.688 Test Loss: 1.751 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9181077480316162
Epoch: 14, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.727 Vali Acc: 0.605 Test Loss: 1.727 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8579936027526855
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 3.072 Vali Acc: 0.751 Test Loss: 3.072 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.001260995864868
Epoch: 16, Steps: 13 | Train Loss: 0.063 Vali Loss: 2.392 Vali Acc: 0.693 Test Loss: 2.392 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9458541870117188
Epoch: 17, Steps: 13 | Train Loss: 0.121 Vali Loss: 2.761 Vali Acc: 0.678 Test Loss: 2.761 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.970306634902954
Epoch: 18, Steps: 13 | Train Loss: 0.030 Vali Loss: 4.140 Vali Acc: 0.434 Test Loss: 4.140 Test Acc: 0.434
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.076216220855713
Epoch: 19, Steps: 13 | Train Loss: 0.145 Vali Loss: 4.647 Vali Acc: 0.424 Test Loss: 4.647 Test Acc: 0.424
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9898107051849365
Epoch: 20, Steps: 13 | Train Loss: 0.173 Vali Loss: 3.867 Vali Acc: 0.585 Test Loss: 3.867 Test Acc: 0.585
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.041886806488037
Epoch: 21, Steps: 13 | Train Loss: 0.081 Vali Loss: 5.133 Vali Acc: 0.756 Test Loss: 5.133 Test Acc: 0.756
Validation loss decreased (-0.751198 --> -0.756046).  Saving model ...
Epoch: 22 cost time: 1.8920834064483643
Epoch: 22, Steps: 13 | Train Loss: 0.007 Vali Loss: 4.800 Vali Acc: 0.712 Test Loss: 4.800 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8927922248840332
Epoch: 23, Steps: 13 | Train Loss: 0.001 Vali Loss: 5.116 Vali Acc: 0.659 Test Loss: 5.116 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.979771375656128
Epoch: 24, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.379 Vali Acc: 0.702 Test Loss: 5.379 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.84364652633667
Epoch: 25, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.376 Vali Acc: 0.678 Test Loss: 5.376 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8528106212615967
Epoch: 26, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.446 Vali Acc: 0.668 Test Loss: 5.446 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0849719047546387
Epoch: 27, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.459 Vali Acc: 0.693 Test Loss: 5.459 Test Acc: 0.693
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9242830276489258
Epoch: 28, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.467 Vali Acc: 0.698 Test Loss: 5.467 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.960108995437622
Epoch: 29, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.471 Vali Acc: 0.698 Test Loss: 5.471 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1965601444244385
Epoch: 30, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.479 Vali Acc: 0.702 Test Loss: 5.479 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.090909004211426
Epoch: 31, Steps: 13 | Train Loss: 0.000 Vali Loss: 5.477 Vali Acc: 0.698 Test Loss: 5.477 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 1167110
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.099604368209839
Epoch: 1, Steps: 13 | Train Loss: 0.649 Vali Loss: 0.872 Vali Acc: 0.722 Test Loss: 0.872 Test Acc: 0.722
Validation loss decreased (inf --> -0.721943).  Saving model ...
Epoch: 2 cost time: 1.7136690616607666
Epoch: 2, Steps: 13 | Train Loss: 0.713 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
Validation loss decreased (-0.721943 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.7891383171081543
Epoch: 3, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.791 Vali Acc: 0.332 Test Loss: 0.791 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.652630090713501
Epoch: 4, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.997 Vali Acc: 0.293 Test Loss: 0.997 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7539784908294678
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.888 Vali Acc: 0.737 Test Loss: 0.888 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736576).  Saving model ...
Epoch: 6 cost time: 1.7804956436157227
Epoch: 6, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.596 Vali Acc: 0.722 Test Loss: 0.596 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7519493103027344
Epoch: 7, Steps: 13 | Train Loss: 0.294 Vali Loss: 1.186 Vali Acc: 0.737 Test Loss: 1.186 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9153733253479004
Epoch: 8, Steps: 13 | Train Loss: 0.642 Vali Loss: 1.637 Vali Acc: 0.727 Test Loss: 1.637 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.742422103881836
Epoch: 9, Steps: 13 | Train Loss: 0.403 Vali Loss: 2.043 Vali Acc: 0.273 Test Loss: 2.043 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.795468807220459
Epoch: 10, Steps: 13 | Train Loss: 0.423 Vali Loss: 2.367 Vali Acc: 0.678 Test Loss: 2.367 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.000211715698242
Epoch: 11, Steps: 13 | Train Loss: 0.279 Vali Loss: 1.719 Vali Acc: 0.585 Test Loss: 1.719 Test Acc: 0.585
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7703015804290771
Epoch: 12, Steps: 13 | Train Loss: 0.177 Vali Loss: 1.602 Vali Acc: 0.727 Test Loss: 1.602 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.788377285003662
Epoch: 13, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.666 Vali Acc: 0.707 Test Loss: 1.666 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7969520092010498
Epoch: 14, Steps: 13 | Train Loss: 0.151 Vali Loss: 2.338 Vali Acc: 0.732 Test Loss: 2.338 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.758409023284912
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.255 Vali Acc: 0.722 Test Loss: 2.255 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 1167110
model size : 14.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.819904327392578
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5707542896270752
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.572 Vali Acc: 0.746 Test Loss: 0.572 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.4584627151489258
Epoch: 3, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.612 Vali Acc: 0.698 Test Loss: 0.612 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.549821376800537
Epoch: 4, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.592 Vali Acc: 0.688 Test Loss: 0.592 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6478593349456787
Epoch: 5, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.710 Vali Acc: 0.741 Test Loss: 0.710 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.748225212097168
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6134867668151855
Epoch: 7, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.708 Vali Acc: 0.644 Test Loss: 0.708 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5564894676208496
Epoch: 8, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.719 Vali Acc: 0.737 Test Loss: 0.719 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7303619384765625
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.730 Vali Acc: 0.712 Test Loss: 0.730 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6870076656341553
Epoch: 10, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.949 Vali Acc: 0.561 Test Loss: 0.949 Test Acc: 0.561
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.678879976272583
Epoch: 11, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.880 Vali Acc: 0.688 Test Loss: 0.880 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6151490211486816
Epoch: 12, Steps: 13 | Train Loss: 0.172 Vali Loss: 1.085 Vali Acc: 0.727 Test Loss: 1.085 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1468422
model size : 10.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.648265838623047
Epoch: 1, Steps: 13 | Train Loss: 0.652 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.5775997638702393
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
Validation loss decreased (-0.717067 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.6562438011169434
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.667 Vali Acc: 0.659 Test Loss: 0.667 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.653123140335083
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.615 Vali Acc: 0.673 Test Loss: 0.615 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6062510013580322
Epoch: 5, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7024586200714111
Epoch: 6, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.601 Vali Acc: 0.732 Test Loss: 0.601 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.80450439453125
Epoch: 7, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.706 Vali Acc: 0.639 Test Loss: 0.706 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.790475845336914
Epoch: 8, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7008640766143799
Epoch: 9, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.704 Vali Acc: 0.693 Test Loss: 0.704 Test Acc: 0.693
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.726567029953003
Epoch: 10, Steps: 13 | Train Loss: 0.138 Vali Loss: 0.777 Vali Acc: 0.654 Test Loss: 0.777 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9297080039978027
Epoch: 11, Steps: 13 | Train Loss: 0.269 Vali Loss: 1.843 Vali Acc: 0.732 Test Loss: 1.843 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8083534240722656
Epoch: 12, Steps: 13 | Train Loss: 0.191 Vali Loss: 1.489 Vali Acc: 0.717 Test Loss: 1.489 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1468422
model size : 10.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.569319248199463
Epoch: 1, Steps: 13 | Train Loss: 0.634 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (inf --> -0.721946).  Saving model ...
Epoch: 2 cost time: 1.5506465435028076
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746336).  Saving model ...
Epoch: 3 cost time: 1.490164041519165
Epoch: 3, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.764 Vali Acc: 0.537 Test Loss: 0.764 Test Acc: 0.537
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6530442237854004
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.991 Vali Acc: 0.298 Test Loss: 0.991 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7153983116149902
Epoch: 5, Steps: 13 | Train Loss: 0.533 Vali Loss: 0.550 Vali Acc: 0.737 Test Loss: 0.550 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5757555961608887
Epoch: 6, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.879 Vali Acc: 0.746 Test Loss: 0.879 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5611536502838135
Epoch: 7, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.766 Vali Acc: 0.639 Test Loss: 0.766 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5978331565856934
Epoch: 8, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.854 Vali Acc: 0.732 Test Loss: 0.854 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6561944484710693
Epoch: 9, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.691 Vali Acc: 0.722 Test Loss: 0.691 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.702415943145752
Epoch: 10, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.756 Vali Acc: 0.688 Test Loss: 0.756 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6244208812713623
Epoch: 11, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.954 Vali Acc: 0.722 Test Loss: 0.954 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5585148334503174
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.306 Vali Acc: 0.717 Test Loss: 1.306 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 1468422
model size : 10.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9496872425079346
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5757286548614502
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.5311048030853271
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.844 Vali Acc: 0.283 Test Loss: 0.844 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4047722816467285
Epoch: 4, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.837 Vali Acc: 0.298 Test Loss: 0.837 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5069975852966309
Epoch: 5, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.558 Vali Acc: 0.712 Test Loss: 0.558 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.559739351272583
Epoch: 6, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.835 Vali Acc: 0.732 Test Loss: 0.835 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731699).  Saving model ...
Epoch: 7 cost time: 1.5337333679199219
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 1.331 Vali Acc: 0.288 Test Loss: 1.331 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.380145788192749
Epoch: 8, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.723 Vali Acc: 0.629 Test Loss: 0.723 Test Acc: 0.629
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6188881397247314
Epoch: 9, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5489931106567383
Epoch: 10, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.893 Vali Acc: 0.615 Test Loss: 0.893 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6750788688659668
Epoch: 11, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.971 Vali Acc: 0.668 Test Loss: 0.971 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6164391040802002
Epoch: 12, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.233 Vali Acc: 0.698 Test Loss: 1.233 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4377467632293701
Epoch: 13, Steps: 13 | Train Loss: 0.114 Vali Loss: 1.647 Vali Acc: 0.702 Test Loss: 1.647 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5820913314819336
Epoch: 14, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.827 Vali Acc: 0.595 Test Loss: 1.827 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6106061935424805
Epoch: 15, Steps: 13 | Train Loss: 0.092 Vali Loss: 2.169 Vali Acc: 0.698 Test Loss: 2.169 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4219841957092285
Epoch: 16, Steps: 13 | Train Loss: 0.051 Vali Loss: 2.621 Vali Acc: 0.498 Test Loss: 2.621 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 1468422
model size : 10.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7648327350616455
Epoch: 1, Steps: 13 | Train Loss: 0.651 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
Validation loss decreased (inf --> -0.731701).  Saving model ...
Epoch: 2 cost time: 1.592804193496704
Epoch: 2, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.666 Vali Acc: 0.678 Test Loss: 0.666 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6328225135803223
Epoch: 3, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.5977272987365723
Epoch: 4, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.800 Vali Acc: 0.746 Test Loss: 0.800 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746333).  Saving model ...
Epoch: 5 cost time: 1.4410736560821533
Epoch: 5, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.617 Vali Acc: 0.688 Test Loss: 0.617 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6466701030731201
Epoch: 6, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.633 Vali Acc: 0.707 Test Loss: 0.633 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.57570219039917
Epoch: 7, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.636 Vali Acc: 0.698 Test Loss: 0.636 Test Acc: 0.698
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7671608924865723
Epoch: 8, Steps: 13 | Train Loss: 0.272 Vali Loss: 0.894 Vali Acc: 0.741 Test Loss: 0.894 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8383471965789795
Epoch: 9, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.779 Vali Acc: 0.639 Test Loss: 0.779 Test Acc: 0.639
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.8054978847503662
Epoch: 10, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6321065425872803
Epoch: 11, Steps: 13 | Train Loss: 0.281 Vali Loss: 1.213 Vali Acc: 0.737 Test Loss: 1.213 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.7835402488708496
Epoch: 12, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.949 Vali Acc: 0.678 Test Loss: 0.949 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.915234088897705
Epoch: 13, Steps: 13 | Train Loss: 0.085 Vali Loss: 1.129 Vali Acc: 0.712 Test Loss: 1.129 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.832123041152954
Epoch: 14, Steps: 13 | Train Loss: 0.211 Vali Loss: 1.336 Vali Acc: 0.620 Test Loss: 1.336 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 944134
model size : 8.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.9053151607513428
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.6078531742095947
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.662 Vali Acc: 0.654 Test Loss: 0.662 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6939630508422852
Epoch: 3, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.559 Vali Acc: 0.751 Test Loss: 0.559 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751214).  Saving model ...
Epoch: 4 cost time: 1.5752286911010742
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6858510971069336
Epoch: 5, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.624 Vali Acc: 0.668 Test Loss: 0.624 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7832252979278564
Epoch: 6, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.616 Vali Acc: 0.702 Test Loss: 0.616 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6600914001464844
Epoch: 7, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.636 Vali Acc: 0.722 Test Loss: 0.636 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6686723232269287
Epoch: 8, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.764 Vali Acc: 0.741 Test Loss: 0.764 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6635212898254395
Epoch: 9, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.718 Vali Acc: 0.683 Test Loss: 0.718 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5906059741973877
Epoch: 10, Steps: 13 | Train Loss: 0.156 Vali Loss: 1.097 Vali Acc: 0.527 Test Loss: 1.097 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.838972568511963
Epoch: 11, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.918 Vali Acc: 0.668 Test Loss: 0.918 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8044061660766602
Epoch: 12, Steps: 13 | Train Loss: 0.087 Vali Loss: 1.040 Vali Acc: 0.678 Test Loss: 1.040 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.7150685787200928
Epoch: 13, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.539 Vali Acc: 0.663 Test Loss: 1.539 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 944134
model size : 8.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.594054698944092
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (inf --> -0.726824).  Saving model ...
Epoch: 2 cost time: 1.4982731342315674
Epoch: 2, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.645 Vali Acc: 0.654 Test Loss: 0.645 Test Acc: 0.654
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4930810928344727
Epoch: 3, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.3865199089050293
Epoch: 4, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.546 Vali Acc: 0.722 Test Loss: 0.546 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4323389530181885
Epoch: 5, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.624 Vali Acc: 0.741 Test Loss: 0.624 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 6 cost time: 1.4880199432373047
Epoch: 6, Steps: 13 | Train Loss: 0.358 Vali Loss: 1.093 Vali Acc: 0.322 Test Loss: 1.093 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5932908058166504
Epoch: 7, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.762 Vali Acc: 0.610 Test Loss: 0.762 Test Acc: 0.610
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5950350761413574
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.898 Vali Acc: 0.741 Test Loss: 0.898 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6399164199829102
Epoch: 9, Steps: 13 | Train Loss: 0.338 Vali Loss: 0.766 Vali Acc: 0.634 Test Loss: 0.766 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5350980758666992
Epoch: 10, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.874 Vali Acc: 0.722 Test Loss: 0.874 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4094784259796143
Epoch: 11, Steps: 13 | Train Loss: 0.300 Vali Loss: 1.333 Vali Acc: 0.732 Test Loss: 1.333 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3194150924682617
Epoch: 12, Steps: 13 | Train Loss: 0.182 Vali Loss: 1.221 Vali Acc: 0.722 Test Loss: 1.221 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3996591567993164
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.647 Vali Acc: 0.663 Test Loss: 1.647 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.552213191986084
Epoch: 14, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.605 Vali Acc: 0.668 Test Loss: 1.605 Test Acc: 0.668
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.560274600982666
Epoch: 15, Steps: 13 | Train Loss: 0.108 Vali Loss: 2.027 Vali Acc: 0.585 Test Loss: 2.027 Test Acc: 0.585
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 944134
model size : 8.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.601832151412964
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5062026977539062
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.471224308013916
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.3472065925598145
Epoch: 4, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.543 Vali Acc: 0.737 Test Loss: 0.543 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.3644509315490723
Epoch: 5, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4187443256378174
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.824 Vali Acc: 0.541 Test Loss: 0.824 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5209920406341553
Epoch: 7, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.632 Vali Acc: 0.683 Test Loss: 0.632 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4471569061279297
Epoch: 8, Steps: 13 | Train Loss: 0.326 Vali Loss: 1.010 Vali Acc: 0.732 Test Loss: 1.010 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5418822765350342
Epoch: 9, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4959733486175537
Epoch: 10, Steps: 13 | Train Loss: 0.270 Vali Loss: 1.671 Vali Acc: 0.298 Test Loss: 1.671 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5551567077636719
Epoch: 11, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.348 Vali Acc: 0.673 Test Loss: 1.348 Test Acc: 0.673
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4225213527679443
Epoch: 12, Steps: 13 | Train Loss: 0.099 Vali Loss: 1.366 Vali Acc: 0.702 Test Loss: 1.366 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4054780006408691
Epoch: 13, Steps: 13 | Train Loss: 0.059 Vali Loss: 1.632 Vali Acc: 0.678 Test Loss: 1.632 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6390275955200195
Epoch: 14, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.646 Vali Acc: 0.673 Test Loss: 1.646 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 944134
model size : 8.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.031773567199707
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.629 Vali Acc: 0.717 Test Loss: 0.629 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.6621253490447998
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.7705214023590088
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.931 Vali Acc: 0.322 Test Loss: 0.931 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6805624961853027
Epoch: 4, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8510124683380127
Epoch: 5, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.0007143020629883
Epoch: 6, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.836 Vali Acc: 0.576 Test Loss: 0.836 Test Acc: 0.576
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.815141201019287
Epoch: 7, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.860597848892212
Epoch: 8, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.704 Vali Acc: 0.707 Test Loss: 0.704 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8223552703857422
Epoch: 9, Steps: 13 | Train Loss: 0.215 Vali Loss: 1.252 Vali Acc: 0.454 Test Loss: 1.252 Test Acc: 0.454
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6089677810668945
Epoch: 10, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.845 Vali Acc: 0.688 Test Loss: 0.845 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6553819179534912
Epoch: 11, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.994 Vali Acc: 0.702 Test Loss: 0.994 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6739966869354248
Epoch: 12, Steps: 13 | Train Loss: 0.187 Vali Loss: 1.072 Vali Acc: 0.668 Test Loss: 1.072 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 681990
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.031402349472046
Epoch: 1, Steps: 13 | Train Loss: 0.671 Vali Loss: 0.627 Vali Acc: 0.717 Test Loss: 0.627 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.6551995277404785
Epoch: 2, Steps: 13 | Train Loss: 0.605 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.7224180698394775
Epoch: 3, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.676 Vali Acc: 0.702 Test Loss: 0.676 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6590347290039062
Epoch: 4, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.671 Vali Acc: 0.751 Test Loss: 0.671 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3951013088226318
Epoch: 5, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5649473667144775
Epoch: 6, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.719 Vali Acc: 0.615 Test Loss: 0.719 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6003162860870361
Epoch: 7, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5346858501434326
Epoch: 8, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.703 Vali Acc: 0.654 Test Loss: 0.703 Test Acc: 0.654
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4948675632476807
Epoch: 9, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.731 Vali Acc: 0.678 Test Loss: 0.731 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4241259098052979
Epoch: 10, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.961 Vali Acc: 0.722 Test Loss: 0.961 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4836182594299316
Epoch: 11, Steps: 13 | Train Loss: 0.124 Vali Loss: 0.878 Vali Acc: 0.683 Test Loss: 0.878 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6240520477294922
Epoch: 12, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.204 Vali Acc: 0.707 Test Loss: 1.204 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 681990
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7334067821502686
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.629 Vali Acc: 0.722 Test Loss: 0.629 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5999879837036133
Epoch: 2, Steps: 13 | Train Loss: 0.611 Vali Loss: 0.550 Vali Acc: 0.756 Test Loss: 0.550 Test Acc: 0.756
Validation loss decreased (-0.721945 --> -0.756092).  Saving model ...
Epoch: 3 cost time: 1.584913969039917
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.666 Vali Acc: 0.698 Test Loss: 0.666 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5582849979400635
Epoch: 4, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.692 Vali Acc: 0.741 Test Loss: 0.692 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.619443416595459
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6027045249938965
Epoch: 6, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.837 Vali Acc: 0.512 Test Loss: 0.837 Test Acc: 0.512
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4070844650268555
Epoch: 7, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4335658550262451
Epoch: 8, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.647 Vali Acc: 0.707 Test Loss: 0.647 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5672097206115723
Epoch: 9, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.727 Vali Acc: 0.683 Test Loss: 0.727 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.620713710784912
Epoch: 10, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.890 Vali Acc: 0.707 Test Loss: 0.890 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5367827415466309
Epoch: 11, Steps: 13 | Train Loss: 0.113 Vali Loss: 0.957 Vali Acc: 0.698 Test Loss: 0.957 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.460684061050415
Epoch: 12, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.506 Vali Acc: 0.717 Test Loss: 1.506 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 681990
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.043521404266357
Epoch: 1, Steps: 13 | Train Loss: 0.701 Vali Loss: 0.640 Vali Acc: 0.722 Test Loss: 0.640 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4110798835754395
Epoch: 2, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 3 cost time: 1.386709451675415
Epoch: 3, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.797 Vali Acc: 0.293 Test Loss: 0.797 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4074828624725342
Epoch: 4, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.744 Vali Acc: 0.727 Test Loss: 0.744 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3656408786773682
Epoch: 5, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3385670185089111
Epoch: 6, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.611 Vali Acc: 0.702 Test Loss: 0.611 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.441798448562622
Epoch: 7, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.673 Vali Acc: 0.722 Test Loss: 0.673 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.51847243309021
Epoch: 8, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.651 Vali Acc: 0.702 Test Loss: 0.651 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6631925106048584
Epoch: 9, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.829 Vali Acc: 0.624 Test Loss: 0.829 Test Acc: 0.624
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5451014041900635
Epoch: 10, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.919 Vali Acc: 0.712 Test Loss: 0.919 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.417814016342163
Epoch: 11, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.362 Vali Acc: 0.615 Test Loss: 1.362 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6608552932739258
Epoch: 12, Steps: 13 | Train Loss: 0.116 Vali Loss: 1.119 Vali Acc: 0.712 Test Loss: 1.119 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 681990
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8066959381103516
Epoch: 1, Steps: 13 | Train Loss: 0.647 Vali Loss: 0.679 Vali Acc: 0.668 Test Loss: 0.679 Test Acc: 0.668
Validation loss decreased (inf --> -0.668286).  Saving model ...
Epoch: 2 cost time: 1.6889185905456543
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.906 Vali Acc: 0.283 Test Loss: 0.906 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6078753471374512
Epoch: 3, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.619 Vali Acc: 0.707 Test Loss: 0.619 Test Acc: 0.707
Validation loss decreased (-0.668286 --> -0.707311).  Saving model ...
Epoch: 4 cost time: 1.4267537593841553
Epoch: 4, Steps: 13 | Train Loss: 0.557 Vali Loss: 1.222 Vali Acc: 0.283 Test Loss: 1.222 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.601583480834961
Epoch: 5, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.648 Vali Acc: 0.732 Test Loss: 0.648 Test Acc: 0.732
Validation loss decreased (-0.707311 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 1.5667295455932617
Epoch: 6, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.694 Vali Acc: 0.732 Test Loss: 0.694 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7652792930603027
Epoch: 7, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.691 Vali Acc: 0.732 Test Loss: 0.691 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6758487224578857
Epoch: 8, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.687 Vali Acc: 0.693 Test Loss: 0.687 Test Acc: 0.693
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6538188457489014
Epoch: 9, Steps: 13 | Train Loss: 0.176 Vali Loss: 0.881 Vali Acc: 0.732 Test Loss: 0.881 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6482985019683838
Epoch: 10, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.928 Vali Acc: 0.634 Test Loss: 0.928 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.704188585281372
Epoch: 11, Steps: 13 | Train Loss: 0.103 Vali Loss: 0.968 Vali Acc: 0.707 Test Loss: 0.968 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.7367033958435059
Epoch: 12, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.985 Vali Acc: 0.639 Test Loss: 0.985 Test Acc: 0.639
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5388081073760986
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.466 Vali Acc: 0.683 Test Loss: 1.466 Test Acc: 0.683
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6518120765686035
Epoch: 14, Steps: 13 | Train Loss: 0.057 Vali Loss: 1.180 Vali Acc: 0.678 Test Loss: 1.180 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6873703002929688
Epoch: 15, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.665 Vali Acc: 0.517 Test Loss: 1.665 Test Acc: 0.517
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 550918
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.654996871948242
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.677 Vali Acc: 0.722 Test Loss: 0.677 Test Acc: 0.722
Validation loss decreased (inf --> -0.721944).  Saving model ...
Epoch: 2 cost time: 1.330554723739624
Epoch: 2, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.930 Vali Acc: 0.283 Test Loss: 0.930 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3117005825042725
Epoch: 3, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
Validation loss decreased (-0.721944 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.3361756801605225
Epoch: 4, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.919 Vali Acc: 0.298 Test Loss: 0.919 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3957860469818115
Epoch: 5, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5390667915344238
Epoch: 6, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4539377689361572
Epoch: 7, Steps: 13 | Train Loss: 0.288 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4559571743011475
Epoch: 8, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.678 Vali Acc: 0.683 Test Loss: 0.678 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6674811840057373
Epoch: 9, Steps: 13 | Train Loss: 0.259 Vali Loss: 1.547 Vali Acc: 0.732 Test Loss: 1.547 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731692).  Saving model ...
Epoch: 10 cost time: 1.5093820095062256
Epoch: 10, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.979 Vali Acc: 0.605 Test Loss: 0.979 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5644607543945312
Epoch: 11, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.171 Vali Acc: 0.717 Test Loss: 1.171 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.449099063873291
Epoch: 12, Steps: 13 | Train Loss: 0.141 Vali Loss: 1.192 Vali Acc: 0.717 Test Loss: 1.192 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.468198299407959
Epoch: 13, Steps: 13 | Train Loss: 0.115 Vali Loss: 1.254 Vali Acc: 0.620 Test Loss: 1.254 Test Acc: 0.620
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5468108654022217
Epoch: 14, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.436 Vali Acc: 0.693 Test Loss: 1.436 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.452784538269043
Epoch: 15, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.778 Vali Acc: 0.507 Test Loss: 1.778 Test Acc: 0.507
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.558032512664795
Epoch: 16, Steps: 13 | Train Loss: 0.610 Vali Loss: 3.556 Vali Acc: 0.317 Test Loss: 3.556 Test Acc: 0.317
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.561206340789795
Epoch: 17, Steps: 13 | Train Loss: 0.347 Vali Loss: 2.927 Vali Acc: 0.439 Test Loss: 2.927 Test Acc: 0.439
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4397506713867188
Epoch: 18, Steps: 13 | Train Loss: 0.179 Vali Loss: 1.755 Vali Acc: 0.654 Test Loss: 1.755 Test Acc: 0.654
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4704184532165527
Epoch: 19, Steps: 13 | Train Loss: 0.041 Vali Loss: 1.943 Vali Acc: 0.693 Test Loss: 1.943 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 550918
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7360646724700928
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.656 Vali Acc: 0.727 Test Loss: 0.656 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.541060447692871
Epoch: 2, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.885 Vali Acc: 0.278 Test Loss: 0.885 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6704745292663574
Epoch: 3, Steps: 13 | Train Loss: 0.602 Vali Loss: 0.874 Vali Acc: 0.288 Test Loss: 0.874 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6301753520965576
Epoch: 4, Steps: 13 | Train Loss: 0.641 Vali Loss: 1.577 Vali Acc: 0.283 Test Loss: 1.577 Test Acc: 0.283
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7024610042572021
Epoch: 5, Steps: 13 | Train Loss: 0.814 Vali Loss: 1.274 Vali Acc: 0.278 Test Loss: 1.274 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.6412010192871094
Epoch: 6, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.612 Vali Acc: 0.712 Test Loss: 0.612 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6012115478515625
Epoch: 7, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 8 cost time: 1.716292381286621
Epoch: 8, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.635 Vali Acc: 0.693 Test Loss: 0.635 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.571131706237793
Epoch: 9, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.043 Vali Acc: 0.737 Test Loss: 1.043 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736575).  Saving model ...
Epoch: 10 cost time: 1.4325852394104004
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.763 Vali Acc: 0.698 Test Loss: 0.763 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4415020942687988
Epoch: 11, Steps: 13 | Train Loss: 0.152 Vali Loss: 0.975 Vali Acc: 0.717 Test Loss: 0.975 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5414009094238281
Epoch: 12, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.283 Vali Acc: 0.722 Test Loss: 1.283 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5576305389404297
Epoch: 13, Steps: 13 | Train Loss: 0.087 Vali Loss: 2.023 Vali Acc: 0.605 Test Loss: 2.023 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6195588111877441
Epoch: 14, Steps: 13 | Train Loss: 0.174 Vali Loss: 2.813 Vali Acc: 0.517 Test Loss: 2.813 Test Acc: 0.517
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4555790424346924
Epoch: 15, Steps: 13 | Train Loss: 0.631 Vali Loss: 2.646 Vali Acc: 0.580 Test Loss: 2.646 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7659263610839844
Epoch: 16, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.589 Vali Acc: 0.683 Test Loss: 1.589 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6676466464996338
Epoch: 17, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.796 Vali Acc: 0.673 Test Loss: 1.796 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.694122552871704
Epoch: 18, Steps: 13 | Train Loss: 0.203 Vali Loss: 2.541 Vali Acc: 0.512 Test Loss: 2.541 Test Acc: 0.512
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6246225833892822
Epoch: 19, Steps: 13 | Train Loss: 0.069 Vali Loss: 4.539 Vali Acc: 0.629 Test Loss: 4.539 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 550918
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6129045486450195
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.660 Vali Acc: 0.727 Test Loss: 0.660 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.5305085182189941
Epoch: 2, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.896 Vali Acc: 0.278 Test Loss: 0.896 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.520829677581787
Epoch: 3, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.857 Vali Acc: 0.288 Test Loss: 0.857 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6110382080078125
Epoch: 4, Steps: 13 | Train Loss: 0.670 Vali Loss: 1.600 Vali Acc: 0.278 Test Loss: 1.600 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6336708068847656
Epoch: 5, Steps: 13 | Train Loss: 0.876 Vali Loss: 1.288 Vali Acc: 0.278 Test Loss: 1.288 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3504638671875
Epoch: 6, Steps: 13 | Train Loss: 0.639 Vali Loss: 0.648 Vali Acc: 0.702 Test Loss: 0.648 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4234387874603271
Epoch: 7, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.947 Vali Acc: 0.722 Test Loss: 0.947 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5474836826324463
Epoch: 8, Steps: 13 | Train Loss: 0.839 Vali Loss: 0.963 Vali Acc: 0.732 Test Loss: 0.963 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731698).  Saving model ...
Epoch: 9 cost time: 1.6060051918029785
Epoch: 9, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.679 Vali Acc: 0.717 Test Loss: 0.679 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5946629047393799
Epoch: 10, Steps: 13 | Train Loss: 0.293 Vali Loss: 1.265 Vali Acc: 0.424 Test Loss: 1.265 Test Acc: 0.424
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5272574424743652
Epoch: 11, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.375 Vali Acc: 0.717 Test Loss: 1.375 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4932279586791992
Epoch: 12, Steps: 13 | Train Loss: 0.231 Vali Loss: 1.858 Vali Acc: 0.707 Test Loss: 1.858 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.362163782119751
Epoch: 13, Steps: 13 | Train Loss: 0.416 Vali Loss: 1.902 Vali Acc: 0.722 Test Loss: 1.902 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4251983165740967
Epoch: 14, Steps: 13 | Train Loss: 0.146 Vali Loss: 2.281 Vali Acc: 0.717 Test Loss: 2.281 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.577927827835083
Epoch: 15, Steps: 13 | Train Loss: 0.100 Vali Loss: 2.399 Vali Acc: 0.566 Test Loss: 2.399 Test Acc: 0.566
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5452985763549805
Epoch: 16, Steps: 13 | Train Loss: 0.061 Vali Loss: 2.514 Vali Acc: 0.688 Test Loss: 2.514 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5258774757385254
Epoch: 17, Steps: 13 | Train Loss: 0.107 Vali Loss: 3.494 Vali Acc: 0.517 Test Loss: 3.494 Test Acc: 0.517
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4922518730163574
Epoch: 18, Steps: 13 | Train Loss: 0.183 Vali Loss: 3.180 Vali Acc: 0.605 Test Loss: 3.180 Test Acc: 0.605
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 550918
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.04598593711853
Epoch: 1, Steps: 13 | Train Loss: 0.627 Vali Loss: 0.814 Vali Acc: 0.278 Test Loss: 0.814 Test Acc: 0.278
Validation loss decreased (inf --> -0.278041).  Saving model ...
Epoch: 2 cost time: 1.5829660892486572
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.623 Vali Acc: 0.722 Test Loss: 0.623 Test Acc: 0.722
Validation loss decreased (-0.278041 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.771820306777954
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.6316592693328857
Epoch: 4, Steps: 13 | Train Loss: 0.357 Vali Loss: 0.630 Vali Acc: 0.741 Test Loss: 0.630 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.6093778610229492
Epoch: 5, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.866 Vali Acc: 0.732 Test Loss: 0.866 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.74550199508667
Epoch: 6, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.711 Vali Acc: 0.663 Test Loss: 0.711 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7047195434570312
Epoch: 7, Steps: 13 | Train Loss: 0.318 Vali Loss: 0.946 Vali Acc: 0.605 Test Loss: 0.946 Test Acc: 0.605
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5570452213287354
Epoch: 8, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.754 Vali Acc: 0.702 Test Loss: 0.754 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.732356071472168
Epoch: 9, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.853 Vali Acc: 0.649 Test Loss: 0.853 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.674192190170288
Epoch: 10, Steps: 13 | Train Loss: 0.134 Vali Loss: 1.244 Vali Acc: 0.551 Test Loss: 1.244 Test Acc: 0.551
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6509222984313965
Epoch: 11, Steps: 13 | Train Loss: 0.286 Vali Loss: 1.002 Vali Acc: 0.668 Test Loss: 1.002 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.758465051651001
Epoch: 12, Steps: 13 | Train Loss: 0.218 Vali Loss: 1.423 Vali Acc: 0.722 Test Loss: 1.423 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.680119276046753
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.278 Vali Acc: 0.712 Test Loss: 1.278 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.8029654026031494
Epoch: 14, Steps: 13 | Train Loss: 0.049 Vali Loss: 1.667 Vali Acc: 0.727 Test Loss: 1.667 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 485382
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7866296768188477
Epoch: 1, Steps: 13 | Train Loss: 0.646 Vali Loss: 0.807 Vali Acc: 0.278 Test Loss: 0.807 Test Acc: 0.278
Validation loss decreased (inf --> -0.278041).  Saving model ...
Epoch: 2 cost time: 1.4999117851257324
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
Validation loss decreased (-0.278041 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.457343339920044
Epoch: 3, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.565 Vali Acc: 0.727 Test Loss: 0.565 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 1.5518651008605957
Epoch: 4, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
Validation loss decreased (-0.726824 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.5032610893249512
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5052990913391113
Epoch: 6, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.727 Vali Acc: 0.634 Test Loss: 0.727 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5525925159454346
Epoch: 7, Steps: 13 | Train Loss: 0.429 Vali Loss: 1.133 Vali Acc: 0.493 Test Loss: 1.133 Test Acc: 0.493
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4363937377929688
Epoch: 8, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.901 Vali Acc: 0.727 Test Loss: 0.901 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.374312400817871
Epoch: 9, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.737 Vali Acc: 0.678 Test Loss: 0.737 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6476268768310547
Epoch: 10, Steps: 13 | Train Loss: 0.151 Vali Loss: 1.098 Vali Acc: 0.576 Test Loss: 1.098 Test Acc: 0.576
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4226353168487549
Epoch: 11, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.687 Vali Acc: 0.737 Test Loss: 1.687 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.635364055633545
Epoch: 12, Steps: 13 | Train Loss: 0.296 Vali Loss: 1.943 Vali Acc: 0.727 Test Loss: 1.943 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4120149612426758
Epoch: 13, Steps: 13 | Train Loss: 0.145 Vali Loss: 1.460 Vali Acc: 0.702 Test Loss: 1.460 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4466474056243896
Epoch: 14, Steps: 13 | Train Loss: 0.056 Vali Loss: 1.664 Vali Acc: 0.707 Test Loss: 1.664 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 485382
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6441376209259033
Epoch: 1, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.782 Vali Acc: 0.283 Test Loss: 0.782 Test Acc: 0.283
Validation loss decreased (inf --> -0.282919).  Saving model ...
Epoch: 2 cost time: 1.5208520889282227
Epoch: 2, Steps: 13 | Train Loss: 0.587 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
Validation loss decreased (-0.282919 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.3178162574768066
Epoch: 3, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.574 Vali Acc: 0.756 Test Loss: 0.574 Test Acc: 0.756
Validation loss decreased (-0.717067 --> -0.756092).  Saving model ...
Epoch: 4 cost time: 1.3407111167907715
Epoch: 4, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.584 Vali Acc: 0.746 Test Loss: 0.584 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2777559757232666
Epoch: 5, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.786 Vali Acc: 0.746 Test Loss: 0.786 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5376465320587158
Epoch: 6, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.728 Vali Acc: 0.624 Test Loss: 0.728 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6629376411437988
Epoch: 7, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.967 Vali Acc: 0.537 Test Loss: 0.967 Test Acc: 0.537
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5172395706176758
Epoch: 8, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5313496589660645
Epoch: 9, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.738 Vali Acc: 0.673 Test Loss: 0.738 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3813297748565674
Epoch: 10, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.867 Vali Acc: 0.654 Test Loss: 0.867 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4379751682281494
Epoch: 11, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.303 Vali Acc: 0.727 Test Loss: 1.303 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.456178903579712
Epoch: 12, Steps: 13 | Train Loss: 0.174 Vali Loss: 1.297 Vali Acc: 0.712 Test Loss: 1.297 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3822813034057617
Epoch: 13, Steps: 13 | Train Loss: 0.097 Vali Loss: 1.783 Vali Acc: 0.698 Test Loss: 1.783 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 485382
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.755631923675537
Epoch: 1, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.751 Vali Acc: 0.288 Test Loss: 0.751 Test Acc: 0.288
Validation loss decreased (inf --> -0.287797).  Saving model ...
Epoch: 2 cost time: 1.4691197872161865
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.692 Vali Acc: 0.702 Test Loss: 0.692 Test Acc: 0.702
Validation loss decreased (-0.287797 --> -0.702432).  Saving model ...
Epoch: 3 cost time: 1.3964130878448486
Epoch: 3, Steps: 13 | Train Loss: 0.526 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
Validation loss decreased (-0.702432 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.3868627548217773
Epoch: 4, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.581 Vali Acc: 0.741 Test Loss: 0.581 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.4175002574920654
Epoch: 5, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.728 Vali Acc: 0.741 Test Loss: 0.728 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.434596061706543
Epoch: 6, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.663 Vali Acc: 0.741 Test Loss: 0.663 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.330899953842163
Epoch: 7, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.595 Vali Acc: 0.707 Test Loss: 0.595 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.382129192352295
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.793 Vali Acc: 0.605 Test Loss: 0.793 Test Acc: 0.605
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.347322702407837
Epoch: 9, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.758 Vali Acc: 0.659 Test Loss: 0.758 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3517284393310547
Epoch: 10, Steps: 13 | Train Loss: 0.183 Vali Loss: 1.199 Vali Acc: 0.502 Test Loss: 1.199 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.7258074283599854
Epoch: 11, Steps: 13 | Train Loss: 0.162 Vali Loss: 1.466 Vali Acc: 0.707 Test Loss: 1.466 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5587785243988037
Epoch: 12, Steps: 13 | Train Loss: 0.308 Vali Loss: 1.343 Vali Acc: 0.707 Test Loss: 1.343 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.533806562423706
Epoch: 13, Steps: 13 | Train Loss: 0.106 Vali Loss: 1.535 Vali Acc: 0.693 Test Loss: 1.535 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3544666767120361
Epoch: 14, Steps: 13 | Train Loss: 0.062 Vali Loss: 2.423 Vali Acc: 0.712 Test Loss: 2.423 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 485382
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.177299737930298
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.462378740310669
Epoch: 2, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.6858234405517578
Epoch: 3, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.545 Vali Acc: 0.746 Test Loss: 0.545 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.6550557613372803
Epoch: 4, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.678 Vali Acc: 0.722 Test Loss: 0.678 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6227564811706543
Epoch: 5, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.927 Vali Acc: 0.732 Test Loss: 0.927 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5450263023376465
Epoch: 6, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.777 Vali Acc: 0.634 Test Loss: 0.777 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6649389266967773
Epoch: 7, Steps: 13 | Train Loss: 0.229 Vali Loss: 1.119 Vali Acc: 0.551 Test Loss: 1.119 Test Acc: 0.551
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5193359851837158
Epoch: 8, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.803 Vali Acc: 0.663 Test Loss: 0.803 Test Acc: 0.663
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.695164442062378
Epoch: 9, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.352 Vali Acc: 0.737 Test Loss: 1.352 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5588281154632568
Epoch: 10, Steps: 13 | Train Loss: 0.212 Vali Loss: 1.145 Vali Acc: 0.707 Test Loss: 1.145 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.578493356704712
Epoch: 11, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.138 Vali Acc: 0.590 Test Loss: 1.138 Test Acc: 0.590
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6392929553985596
Epoch: 12, Steps: 13 | Train Loss: 0.110 Vali Loss: 1.092 Vali Acc: 0.624 Test Loss: 1.092 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5537335872650146
Epoch: 13, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.426 Vali Acc: 0.732 Test Loss: 1.426 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 452614
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.087073564529419
Epoch: 1, Steps: 13 | Train Loss: 0.678 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.6226723194122314
Epoch: 2, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.665 Vali Acc: 0.732 Test Loss: 0.665 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.548159122467041
Epoch: 3, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.580 Vali Acc: 0.693 Test Loss: 0.580 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4591164588928223
Epoch: 4, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.591 Vali Acc: 0.698 Test Loss: 0.591 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.547849416732788
Epoch: 5, Steps: 13 | Train Loss: 0.329 Vali Loss: 1.221 Vali Acc: 0.737 Test Loss: 1.221 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736573).  Saving model ...
Epoch: 6 cost time: 1.66097092628479
Epoch: 6, Steps: 13 | Train Loss: 0.753 Vali Loss: 0.804 Vali Acc: 0.741 Test Loss: 0.804 Test Acc: 0.741
Validation loss decreased (-0.736573 --> -0.741455).  Saving model ...
Epoch: 7 cost time: 1.5774803161621094
Epoch: 7, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.782 Vali Acc: 0.615 Test Loss: 0.782 Test Acc: 0.615
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.572190761566162
Epoch: 8, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.739 Vali Acc: 0.654 Test Loss: 0.739 Test Acc: 0.654
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7646350860595703
Epoch: 9, Steps: 13 | Train Loss: 0.310 Vali Loss: 1.154 Vali Acc: 0.746 Test Loss: 1.154 Test Acc: 0.746
Validation loss decreased (-0.741455 --> -0.746330).  Saving model ...
Epoch: 10 cost time: 1.4552552700042725
Epoch: 10, Steps: 13 | Train Loss: 0.362 Vali Loss: 1.886 Vali Acc: 0.741 Test Loss: 1.886 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5469071865081787
Epoch: 11, Steps: 13 | Train Loss: 0.661 Vali Loss: 1.813 Vali Acc: 0.737 Test Loss: 1.813 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5914857387542725
Epoch: 12, Steps: 13 | Train Loss: 0.575 Vali Loss: 1.713 Vali Acc: 0.732 Test Loss: 1.713 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7029151916503906
Epoch: 13, Steps: 13 | Train Loss: 0.138 Vali Loss: 1.377 Vali Acc: 0.693 Test Loss: 1.377 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6304752826690674
Epoch: 14, Steps: 13 | Train Loss: 0.074 Vali Loss: 1.210 Vali Acc: 0.688 Test Loss: 1.210 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5898621082305908
Epoch: 15, Steps: 13 | Train Loss: 0.061 Vali Loss: 1.612 Vali Acc: 0.722 Test Loss: 1.612 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.620236873626709
Epoch: 16, Steps: 13 | Train Loss: 0.036 Vali Loss: 2.325 Vali Acc: 0.532 Test Loss: 2.325 Test Acc: 0.532
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6818993091583252
Epoch: 17, Steps: 13 | Train Loss: 0.134 Vali Loss: 2.727 Vali Acc: 0.517 Test Loss: 2.727 Test Acc: 0.517
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5471627712249756
Epoch: 18, Steps: 13 | Train Loss: 0.138 Vali Loss: 2.577 Vali Acc: 0.561 Test Loss: 2.577 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.6221652030944824
Epoch: 19, Steps: 13 | Train Loss: 0.055 Vali Loss: 2.500 Vali Acc: 0.620 Test Loss: 2.500 Test Acc: 0.620
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 452614
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6927382946014404
Epoch: 1, Steps: 13 | Train Loss: 0.676 Vali Loss: 0.573 Vali Acc: 0.722 Test Loss: 0.573 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5600061416625977
Epoch: 2, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.634 Vali Acc: 0.727 Test Loss: 0.634 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.566751480102539
Epoch: 3, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 4 cost time: 1.6747417449951172
Epoch: 4, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.611 Vali Acc: 0.722 Test Loss: 0.611 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.817812204360962
Epoch: 5, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.837 Vali Acc: 0.751 Test Loss: 0.837 Test Acc: 0.751
Validation loss decreased (-0.731701 --> -0.751211).  Saving model ...
Epoch: 6 cost time: 1.6308331489562988
Epoch: 6, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.604 Vali Acc: 0.727 Test Loss: 0.604 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.630528211593628
Epoch: 7, Steps: 13 | Train Loss: 0.418 Vali Loss: 1.216 Vali Acc: 0.337 Test Loss: 1.216 Test Acc: 0.337
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6118459701538086
Epoch: 8, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.983 Vali Acc: 0.522 Test Loss: 0.983 Test Acc: 0.522
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7588939666748047
Epoch: 9, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4877848625183105
Epoch: 10, Steps: 13 | Train Loss: 0.195 Vali Loss: 0.843 Vali Acc: 0.707 Test Loss: 0.843 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5829451084136963
Epoch: 11, Steps: 13 | Train Loss: 0.157 Vali Loss: 1.022 Vali Acc: 0.629 Test Loss: 1.022 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5387213230133057
Epoch: 12, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.315 Vali Acc: 0.732 Test Loss: 1.315 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8014793395996094
Epoch: 13, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.515 Vali Acc: 0.644 Test Loss: 1.515 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.6483402252197266
Epoch: 14, Steps: 13 | Train Loss: 0.135 Vali Loss: 2.087 Vali Acc: 0.615 Test Loss: 2.087 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.6346228122711182
Epoch: 15, Steps: 13 | Train Loss: 0.468 Vali Loss: 1.366 Vali Acc: 0.712 Test Loss: 1.366 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 452614
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8133652210235596
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.596 Vali Acc: 0.727 Test Loss: 0.596 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.3878421783447266
Epoch: 2, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.754 Vali Acc: 0.712 Test Loss: 0.754 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7139430046081543
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.561 Vali Acc: 0.741 Test Loss: 0.561 Test Acc: 0.741
Validation loss decreased (-0.726823 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.275364875793457
Epoch: 4, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3710522651672363
Epoch: 5, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.728 Vali Acc: 0.732 Test Loss: 0.728 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3358283042907715
Epoch: 6, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3437204360961914
Epoch: 7, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.994 Vali Acc: 0.332 Test Loss: 0.994 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.466355800628662
Epoch: 8, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.649 Vali Acc: 0.702 Test Loss: 0.649 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4581565856933594
Epoch: 9, Steps: 13 | Train Loss: 0.279 Vali Loss: 0.970 Vali Acc: 0.727 Test Loss: 0.970 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4925830364227295
Epoch: 10, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.820 Vali Acc: 0.702 Test Loss: 0.820 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3471572399139404
Epoch: 11, Steps: 13 | Train Loss: 0.158 Vali Loss: 1.057 Vali Acc: 0.678 Test Loss: 1.057 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4654676914215088
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.356 Vali Acc: 0.727 Test Loss: 1.356 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4165761470794678
Epoch: 13, Steps: 13 | Train Loss: 0.173 Vali Loss: 1.717 Vali Acc: 0.629 Test Loss: 1.717 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 452614
model size : 6.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7571349143981934
Epoch: 1, Steps: 13 | Train Loss: 0.665 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2370567321777344
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.560 Vali Acc: 0.732 Test Loss: 0.560 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.3531568050384521
Epoch: 3, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4941890239715576
Epoch: 4, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.621 Vali Acc: 0.727 Test Loss: 0.621 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5830514430999756
Epoch: 5, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.496995449066162
Epoch: 6, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6274657249450684
Epoch: 7, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.643 Vali Acc: 0.727 Test Loss: 0.643 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5953865051269531
Epoch: 8, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.683 Vali Acc: 0.707 Test Loss: 0.683 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3282976150512695
Epoch: 9, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.798 Vali Acc: 0.629 Test Loss: 0.798 Test Acc: 0.629
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.407043218612671
Epoch: 10, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.882 Vali Acc: 0.639 Test Loss: 0.882 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5734195709228516
Epoch: 11, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.875 Vali Acc: 0.722 Test Loss: 0.875 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6931166648864746
Epoch: 12, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.958 Vali Acc: 0.722 Test Loss: 0.958 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 701574
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5143935680389404
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.5335052013397217
Epoch: 2, Steps: 13 | Train Loss: 0.576 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.453188419342041
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.685 Vali Acc: 0.698 Test Loss: 0.685 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.356860876083374
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.4752044677734375
Epoch: 5, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.440769910812378
Epoch: 6, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4084012508392334
Epoch: 7, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.596 Vali Acc: 0.737 Test Loss: 0.596 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6308331489562988
Epoch: 8, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.606 Vali Acc: 0.683 Test Loss: 0.606 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6629235744476318
Epoch: 9, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.692 Vali Acc: 0.615 Test Loss: 0.692 Test Acc: 0.615
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6635472774505615
Epoch: 10, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.692 Vali Acc: 0.688 Test Loss: 0.692 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5354478359222412
Epoch: 11, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.083 Vali Acc: 0.737 Test Loss: 1.083 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5230953693389893
Epoch: 12, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.840 Vali Acc: 0.717 Test Loss: 0.840 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3642947673797607
Epoch: 13, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.981 Vali Acc: 0.727 Test Loss: 0.981 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2319607734680176
Epoch: 14, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.952 Vali Acc: 0.702 Test Loss: 0.952 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3278923034667969
Epoch: 15, Steps: 13 | Train Loss: 0.109 Vali Loss: 1.228 Vali Acc: 0.702 Test Loss: 1.228 Test Acc: 0.702
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 701574
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.793494701385498
Epoch: 1, Steps: 13 | Train Loss: 0.660 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.446035623550415
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.3395140171051025
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.676 Vali Acc: 0.712 Test Loss: 0.676 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5250625610351562
Epoch: 4, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.617 Vali Acc: 0.746 Test Loss: 0.617 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 5 cost time: 1.3227651119232178
Epoch: 5, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.552 Vali Acc: 0.741 Test Loss: 0.552 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4486515522003174
Epoch: 6, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.553 Vali Acc: 0.732 Test Loss: 0.553 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7004153728485107
Epoch: 7, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3064651489257812
Epoch: 8, Steps: 13 | Train Loss: 0.299 Vali Loss: 0.643 Vali Acc: 0.673 Test Loss: 0.643 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2440969944000244
Epoch: 9, Steps: 13 | Train Loss: 0.311 Vali Loss: 0.790 Vali Acc: 0.590 Test Loss: 0.790 Test Acc: 0.590
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4395391941070557
Epoch: 10, Steps: 13 | Train Loss: 0.328 Vali Loss: 1.027 Vali Acc: 0.390 Test Loss: 1.027 Test Acc: 0.390
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4770381450653076
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.327378273010254
Epoch: 12, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.782 Vali Acc: 0.712 Test Loss: 0.782 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.338329792022705
Epoch: 13, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.839 Vali Acc: 0.683 Test Loss: 0.839 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4400038719177246
Epoch: 14, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.020 Vali Acc: 0.683 Test Loss: 1.020 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 701574
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4103612899780273
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.245844841003418
Epoch: 2, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.3375508785247803
Epoch: 3, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.667 Vali Acc: 0.688 Test Loss: 0.667 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3633699417114258
Epoch: 4, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 1.2662014961242676
Epoch: 5, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 1.3705964088439941
Epoch: 6, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 7 cost time: 1.2681572437286377
Epoch: 7, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.569 Vali Acc: 0.741 Test Loss: 0.569 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.3911411762237549
Epoch: 8, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.584 Vali Acc: 0.698 Test Loss: 0.584 Test Acc: 0.698
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3154890537261963
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.644 Vali Acc: 0.683 Test Loss: 0.644 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2471048831939697
Epoch: 10, Steps: 13 | Train Loss: 0.306 Vali Loss: 0.719 Vali Acc: 0.644 Test Loss: 0.719 Test Acc: 0.644
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2370085716247559
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2900688648223877
Epoch: 12, Steps: 13 | Train Loss: 0.276 Vali Loss: 0.814 Vali Acc: 0.668 Test Loss: 0.814 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.260828971862793
Epoch: 13, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.818 Vali Acc: 0.717 Test Loss: 0.818 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3497939109802246
Epoch: 14, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.898 Vali Acc: 0.707 Test Loss: 0.898 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.248981237411499
Epoch: 15, Steps: 13 | Train Loss: 0.112 Vali Loss: 1.396 Vali Acc: 0.707 Test Loss: 1.396 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3584380149841309
Epoch: 16, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.304 Vali Acc: 0.688 Test Loss: 1.304 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4413502216339111
Epoch: 17, Steps: 13 | Train Loss: 0.077 Vali Loss: 1.734 Vali Acc: 0.673 Test Loss: 1.734 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 701574
model size : 5.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3564810752868652
Epoch: 1, Steps: 13 | Train Loss: 0.624 Vali Loss: 0.589 Vali Acc: 0.727 Test Loss: 0.589 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.4335453510284424
Epoch: 2, Steps: 13 | Train Loss: 0.578 Vali Loss: 0.554 Vali Acc: 0.732 Test Loss: 0.554 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.308556079864502
Epoch: 3, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4474983215332031
Epoch: 4, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3651084899902344
Epoch: 5, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5290718078613281
Epoch: 6, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.641 Vali Acc: 0.663 Test Loss: 0.641 Test Acc: 0.663
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5059802532196045
Epoch: 7, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.708287000656128
Epoch: 8, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.774 Vali Acc: 0.732 Test Loss: 0.774 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5054147243499756
Epoch: 9, Steps: 13 | Train Loss: 0.286 Vali Loss: 0.812 Vali Acc: 0.727 Test Loss: 0.812 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6184055805206299
Epoch: 10, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.760 Vali Acc: 0.678 Test Loss: 0.760 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6406831741333008
Epoch: 11, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.830 Vali Acc: 0.620 Test Loss: 0.830 Test Acc: 0.620
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6620738506317139
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.923 Vali Acc: 0.644 Test Loss: 0.923 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.510235071182251
Epoch: 13, Steps: 13 | Train Loss: 0.159 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 439430
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.552847385406494
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.529759168624878
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.3077590465545654
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.541 Vali Acc: 0.741 Test Loss: 0.541 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4435901641845703
Epoch: 4, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.547 Vali Acc: 0.746 Test Loss: 0.547 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.548149824142456
Epoch: 5, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.565 Vali Acc: 0.707 Test Loss: 0.565 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5704224109649658
Epoch: 6, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.611 Vali Acc: 0.673 Test Loss: 0.611 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4461851119995117
Epoch: 7, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.39298677444458
Epoch: 8, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.705 Vali Acc: 0.732 Test Loss: 0.705 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3803455829620361
Epoch: 9, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.755 Vali Acc: 0.732 Test Loss: 0.755 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4390230178833008
Epoch: 10, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5202922821044922
Epoch: 11, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.804 Vali Acc: 0.620 Test Loss: 0.804 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2831039428710938
Epoch: 12, Steps: 13 | Train Loss: 0.291 Vali Loss: 0.795 Vali Acc: 0.624 Test Loss: 0.795 Test Acc: 0.624
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.337378978729248
Epoch: 13, Steps: 13 | Train Loss: 0.142 Vali Loss: 0.840 Vali Acc: 0.659 Test Loss: 0.840 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.461555004119873
Epoch: 14, Steps: 13 | Train Loss: 0.167 Vali Loss: 1.038 Vali Acc: 0.624 Test Loss: 1.038 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 439430
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6113078594207764
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3913440704345703
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.4292562007904053
Epoch: 3, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3651745319366455
Epoch: 4, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 5 cost time: 1.368992805480957
Epoch: 5, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5097830295562744
Epoch: 6, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.549 Vali Acc: 0.722 Test Loss: 0.549 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4305939674377441
Epoch: 7, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.610 Vali Acc: 0.668 Test Loss: 0.610 Test Acc: 0.668
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5454003810882568
Epoch: 8, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.653 Vali Acc: 0.746 Test Loss: 0.653 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 9 cost time: 1.451369047164917
Epoch: 9, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4022951126098633
Epoch: 10, Steps: 13 | Train Loss: 0.263 Vali Loss: 0.634 Vali Acc: 0.639 Test Loss: 0.634 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.399765968322754
Epoch: 11, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.697 Vali Acc: 0.629 Test Loss: 0.697 Test Acc: 0.629
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3642964363098145
Epoch: 12, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.743 Vali Acc: 0.639 Test Loss: 0.743 Test Acc: 0.639
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3616344928741455
Epoch: 13, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.754 Vali Acc: 0.634 Test Loss: 0.754 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4110443592071533
Epoch: 14, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.305 Vali Acc: 0.502 Test Loss: 1.305 Test Acc: 0.502
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.393073320388794
Epoch: 15, Steps: 13 | Train Loss: 0.243 Vali Loss: 1.110 Vali Acc: 0.615 Test Loss: 1.110 Test Acc: 0.615
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.445540428161621
Epoch: 16, Steps: 13 | Train Loss: 0.102 Vali Loss: 1.119 Vali Acc: 0.663 Test Loss: 1.119 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.344313383102417
Epoch: 17, Steps: 13 | Train Loss: 0.118 Vali Loss: 1.628 Vali Acc: 0.580 Test Loss: 1.628 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.45843505859375
Epoch: 18, Steps: 13 | Train Loss: 0.070 Vali Loss: 1.482 Vali Acc: 0.590 Test Loss: 1.482 Test Acc: 0.590
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 439430
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4936890602111816
Epoch: 1, Steps: 13 | Train Loss: 0.626 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3274219036102295
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.348229169845581
Epoch: 3, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.4060313701629639
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.32499098777771
Epoch: 5, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3335309028625488
Epoch: 6, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.610 Vali Acc: 0.673 Test Loss: 0.610 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3727240562438965
Epoch: 7, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.586 Vali Acc: 0.732 Test Loss: 0.586 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3616271018981934
Epoch: 8, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.706 Vali Acc: 0.746 Test Loss: 0.706 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746334).  Saving model ...
Epoch: 9 cost time: 1.2616636753082275
Epoch: 9, Steps: 13 | Train Loss: 0.376 Vali Loss: 0.809 Vali Acc: 0.746 Test Loss: 0.809 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3749322891235352
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.768 Vali Acc: 0.732 Test Loss: 0.768 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3340749740600586
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.767 Vali Acc: 0.590 Test Loss: 0.767 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4110233783721924
Epoch: 12, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.751 Vali Acc: 0.727 Test Loss: 0.751 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1631641387939453
Epoch: 13, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.713 Vali Acc: 0.702 Test Loss: 0.713 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.291290044784546
Epoch: 14, Steps: 13 | Train Loss: 0.244 Vali Loss: 0.840 Vali Acc: 0.688 Test Loss: 0.840 Test Acc: 0.688
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.401911735534668
Epoch: 15, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.009 Vali Acc: 0.683 Test Loss: 1.009 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.351907730102539
Epoch: 16, Steps: 13 | Train Loss: 0.184 Vali Loss: 1.518 Vali Acc: 0.483 Test Loss: 1.518 Test Acc: 0.483
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3847522735595703
Epoch: 17, Steps: 13 | Train Loss: 0.361 Vali Loss: 1.469 Vali Acc: 0.629 Test Loss: 1.469 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3557169437408447
Epoch: 18, Steps: 13 | Train Loss: 0.142 Vali Loss: 1.335 Vali Acc: 0.693 Test Loss: 1.335 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 439430
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.912325382232666
Epoch: 1, Steps: 13 | Train Loss: 0.631 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3708419799804688
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.4272921085357666
Epoch: 3, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.590 Vali Acc: 0.746 Test Loss: 0.590 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.485947608947754
Epoch: 4, Steps: 13 | Train Loss: 0.530 Vali Loss: 0.555 Vali Acc: 0.751 Test Loss: 0.555 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.3366734981536865
Epoch: 5, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.569 Vali Acc: 0.746 Test Loss: 0.569 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3905797004699707
Epoch: 6, Steps: 13 | Train Loss: 0.382 Vali Loss: 0.736 Vali Acc: 0.746 Test Loss: 0.736 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.321028709411621
Epoch: 7, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3599934577941895
Epoch: 8, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3485627174377441
Epoch: 9, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.881 Vali Acc: 0.620 Test Loss: 0.881 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3077819347381592
Epoch: 10, Steps: 13 | Train Loss: 0.290 Vali Loss: 1.186 Vali Acc: 0.371 Test Loss: 1.186 Test Acc: 0.371
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4120326042175293
Epoch: 11, Steps: 13 | Train Loss: 0.466 Vali Loss: 1.003 Vali Acc: 0.741 Test Loss: 1.003 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3767001628875732
Epoch: 12, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.788 Vali Acc: 0.707 Test Loss: 0.788 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4206056594848633
Epoch: 13, Steps: 13 | Train Loss: 0.217 Vali Loss: 1.046 Vali Acc: 0.610 Test Loss: 1.046 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4867491722106934
Epoch: 14, Steps: 13 | Train Loss: 0.196 Vali Loss: 1.020 Vali Acc: 0.663 Test Loss: 1.020 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 308358
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4808056354522705
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.3497564792633057
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.3183708190917969
Epoch: 3, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741457).  Saving model ...
Epoch: 4 cost time: 1.3211069107055664
Epoch: 4, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.556 Vali Acc: 0.756 Test Loss: 0.556 Test Acc: 0.756
Validation loss decreased (-0.741457 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.323751449584961
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.555 Vali Acc: 0.741 Test Loss: 0.555 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.458650827407837
Epoch: 6, Steps: 13 | Train Loss: 0.403 Vali Loss: 0.697 Vali Acc: 0.751 Test Loss: 0.697 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3569977283477783
Epoch: 7, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.338385820388794
Epoch: 8, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.608 Vali Acc: 0.698 Test Loss: 0.608 Test Acc: 0.698
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3754911422729492
Epoch: 9, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.627 Vali Acc: 0.678 Test Loss: 0.627 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3124399185180664
Epoch: 10, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.707 Vali Acc: 0.620 Test Loss: 0.707 Test Acc: 0.620
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4066953659057617
Epoch: 11, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.771 Vali Acc: 0.727 Test Loss: 0.771 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4035069942474365
Epoch: 12, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.890 Vali Acc: 0.732 Test Loss: 0.890 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3774359226226807
Epoch: 13, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.945 Vali Acc: 0.639 Test Loss: 0.945 Test Acc: 0.639
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3832590579986572
Epoch: 14, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.943 Vali Acc: 0.678 Test Loss: 0.943 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 308358
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.85912823677063
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.368227243423462
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.3638107776641846
Epoch: 3, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.2758514881134033
Epoch: 4, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3728868961334229
Epoch: 5, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.3976514339447021
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.654 Vali Acc: 0.751 Test Loss: 0.654 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4253814220428467
Epoch: 7, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.650 Vali Acc: 0.756 Test Loss: 0.650 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756091).  Saving model ...
Epoch: 8 cost time: 1.3116607666015625
Epoch: 8, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.571 Vali Acc: 0.712 Test Loss: 0.571 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3736135959625244
Epoch: 9, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.592 Vali Acc: 0.698 Test Loss: 0.592 Test Acc: 0.698
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.327772617340088
Epoch: 10, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.625 Vali Acc: 0.707 Test Loss: 0.625 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4808673858642578
Epoch: 11, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.729 Vali Acc: 0.722 Test Loss: 0.729 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3968281745910645
Epoch: 12, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.937 Vali Acc: 0.712 Test Loss: 0.937 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4687280654907227
Epoch: 13, Steps: 13 | Train Loss: 0.202 Vali Loss: 1.021 Vali Acc: 0.629 Test Loss: 1.021 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3175065517425537
Epoch: 14, Steps: 13 | Train Loss: 0.195 Vali Loss: 1.204 Vali Acc: 0.610 Test Loss: 1.204 Test Acc: 0.610
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3849763870239258
Epoch: 15, Steps: 13 | Train Loss: 0.186 Vali Loss: 1.098 Vali Acc: 0.605 Test Loss: 1.098 Test Acc: 0.605
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4849615097045898
Epoch: 16, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.450 Vali Acc: 0.620 Test Loss: 1.450 Test Acc: 0.620
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6088054180145264
Epoch: 17, Steps: 13 | Train Loss: 0.107 Vali Loss: 1.420 Vali Acc: 0.624 Test Loss: 1.420 Test Acc: 0.624
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 308358
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6422572135925293
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2681210041046143
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.567 Vali Acc: 0.732 Test Loss: 0.567 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.137235403060913
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.588 Vali Acc: 0.727 Test Loss: 0.588 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2715423107147217
Epoch: 4, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.583 Vali Acc: 0.707 Test Loss: 0.583 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.344712257385254
Epoch: 5, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.538 Vali Acc: 0.732 Test Loss: 0.538 Test Acc: 0.732
Validation loss decreased (-0.731702 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.2071876525878906
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.612 Vali Acc: 0.751 Test Loss: 0.612 Test Acc: 0.751
Validation loss decreased (-0.731702 --> -0.751213).  Saving model ...
Epoch: 7 cost time: 1.141906499862671
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2532131671905518
Epoch: 8, Steps: 13 | Train Loss: 0.468 Vali Loss: 0.621 Vali Acc: 0.751 Test Loss: 0.621 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2473018169403076
Epoch: 9, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.681 Vali Acc: 0.639 Test Loss: 0.681 Test Acc: 0.639
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2979390621185303
Epoch: 10, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.666 Vali Acc: 0.668 Test Loss: 0.666 Test Acc: 0.668
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3170192241668701
Epoch: 11, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3220438957214355
Epoch: 12, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.685 Vali Acc: 0.717 Test Loss: 0.685 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2705752849578857
Epoch: 13, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.951 Vali Acc: 0.663 Test Loss: 0.951 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2409162521362305
Epoch: 14, Steps: 13 | Train Loss: 0.288 Vali Loss: 1.011 Vali Acc: 0.668 Test Loss: 1.011 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.343461036682129
Epoch: 15, Steps: 13 | Train Loss: 0.216 Vali Loss: 1.012 Vali Acc: 0.659 Test Loss: 1.012 Test Acc: 0.659
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1998441219329834
Epoch: 16, Steps: 13 | Train Loss: 0.159 Vali Loss: 1.421 Vali Acc: 0.649 Test Loss: 1.421 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 308358
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6438474655151367
Epoch: 1, Steps: 13 | Train Loss: 0.669 Vali Loss: 0.622 Vali Acc: 0.722 Test Loss: 0.622 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3939075469970703
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.613 Vali Acc: 0.741 Test Loss: 0.613 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.3632807731628418
Epoch: 3, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.598 Vali Acc: 0.737 Test Loss: 0.598 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.411712408065796
Epoch: 4, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.704 Vali Acc: 0.732 Test Loss: 0.704 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3614678382873535
Epoch: 5, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4000284671783447
Epoch: 6, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.713 Vali Acc: 0.741 Test Loss: 0.713 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.4284875392913818
Epoch: 7, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3865842819213867
Epoch: 8, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.680 Vali Acc: 0.712 Test Loss: 0.680 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4197418689727783
Epoch: 9, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.706 Vali Acc: 0.683 Test Loss: 0.706 Test Acc: 0.683
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3528354167938232
Epoch: 10, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.771 Vali Acc: 0.668 Test Loss: 0.771 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4068725109100342
Epoch: 11, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.886 Vali Acc: 0.615 Test Loss: 0.886 Test Acc: 0.615
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.387263536453247
Epoch: 12, Steps: 13 | Train Loss: 0.143 Vali Loss: 0.961 Vali Acc: 0.732 Test Loss: 0.961 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 242822
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.619492292404175
Epoch: 1, Steps: 13 | Train Loss: 0.677 Vali Loss: 0.618 Vali Acc: 0.722 Test Loss: 0.618 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.38132905960083
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.5008254051208496
Epoch: 3, Steps: 13 | Train Loss: 0.502 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4029514789581299
Epoch: 4, Steps: 13 | Train Loss: 0.477 Vali Loss: 0.696 Vali Acc: 0.741 Test Loss: 0.696 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.364617109298706
Epoch: 5, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.556 Vali Acc: 0.717 Test Loss: 0.556 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4582874774932861
Epoch: 6, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.671 Vali Acc: 0.741 Test Loss: 0.671 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4082229137420654
Epoch: 7, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.578 Vali Acc: 0.707 Test Loss: 0.578 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.479337453842163
Epoch: 8, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.675 Vali Acc: 0.741 Test Loss: 0.675 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5400352478027344
Epoch: 9, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.654 Vali Acc: 0.629 Test Loss: 0.654 Test Acc: 0.629
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5055642127990723
Epoch: 10, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.704 Vali Acc: 0.634 Test Loss: 0.704 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5606327056884766
Epoch: 11, Steps: 13 | Train Loss: 0.214 Vali Loss: 1.042 Vali Acc: 0.527 Test Loss: 1.042 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5146777629852295
Epoch: 12, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.813 Vali Acc: 0.707 Test Loss: 0.813 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.47764253616333
Epoch: 13, Steps: 13 | Train Loss: 0.122 Vali Loss: 0.913 Vali Acc: 0.629 Test Loss: 0.913 Test Acc: 0.629
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 242822
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.386896848678589
Epoch: 1, Steps: 13 | Train Loss: 0.666 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2639167308807373
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.613 Vali Acc: 0.732 Test Loss: 0.613 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.3132915496826172
Epoch: 3, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.565 Vali Acc: 0.741 Test Loss: 0.565 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.331939935684204
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.287954568862915
Epoch: 5, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.545 Vali Acc: 0.722 Test Loss: 0.545 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.252734899520874
Epoch: 6, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.640 Vali Acc: 0.746 Test Loss: 0.640 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 7 cost time: 1.2885499000549316
Epoch: 7, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.556 Vali Acc: 0.727 Test Loss: 0.556 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3157823085784912
Epoch: 8, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.268136739730835
Epoch: 9, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.624 Vali Acc: 0.673 Test Loss: 0.624 Test Acc: 0.673
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3084096908569336
Epoch: 10, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.667 Vali Acc: 0.649 Test Loss: 0.667 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3817057609558105
Epoch: 11, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.808 Vali Acc: 0.585 Test Loss: 0.808 Test Acc: 0.585
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3281617164611816
Epoch: 12, Steps: 13 | Train Loss: 0.170 Vali Loss: 0.807 Vali Acc: 0.727 Test Loss: 0.807 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4804906845092773
Epoch: 13, Steps: 13 | Train Loss: 0.206 Vali Loss: 0.878 Vali Acc: 0.712 Test Loss: 0.878 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4292011260986328
Epoch: 14, Steps: 13 | Train Loss: 0.131 Vali Loss: 1.019 Vali Acc: 0.712 Test Loss: 1.019 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3626883029937744
Epoch: 15, Steps: 13 | Train Loss: 0.103 Vali Loss: 1.184 Vali Acc: 0.551 Test Loss: 1.184 Test Acc: 0.551
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3710134029388428
Epoch: 16, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.380 Vali Acc: 0.717 Test Loss: 1.380 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 242822
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5496253967285156
Epoch: 1, Steps: 13 | Train Loss: 0.644 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2609167098999023
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.197587013244629
Epoch: 3, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.0870051383972168
Epoch: 4, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.707 Vali Acc: 0.732 Test Loss: 0.707 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2310965061187744
Epoch: 5, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.546 Vali Acc: 0.746 Test Loss: 0.546 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.1756227016448975
Epoch: 6, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.636 Vali Acc: 0.746 Test Loss: 0.636 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2448859214782715
Epoch: 7, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.548 Vali Acc: 0.712 Test Loss: 0.548 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2515268325805664
Epoch: 8, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.576 Vali Acc: 0.712 Test Loss: 0.576 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2838971614837646
Epoch: 9, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.603 Vali Acc: 0.717 Test Loss: 0.603 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.327303409576416
Epoch: 10, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.600 Vali Acc: 0.717 Test Loss: 0.600 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3063442707061768
Epoch: 11, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2408483028411865
Epoch: 12, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.726 Vali Acc: 0.712 Test Loss: 0.726 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.140406608581543
Epoch: 13, Steps: 13 | Train Loss: 0.194 Vali Loss: 0.928 Vali Acc: 0.663 Test Loss: 0.928 Test Acc: 0.663
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.216278314590454
Epoch: 14, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.919 Vali Acc: 0.712 Test Loss: 0.919 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1572294235229492
Epoch: 15, Steps: 13 | Train Loss: 0.124 Vali Loss: 1.124 Vali Acc: 0.663 Test Loss: 1.124 Test Acc: 0.663
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 242822
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.898946762084961
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.40415358543396
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.645 Vali Acc: 0.707 Test Loss: 0.645 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.367238998413086
Epoch: 3, Steps: 13 | Train Loss: 0.589 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.1695125102996826
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.559 Vali Acc: 0.727 Test Loss: 0.559 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4853606224060059
Epoch: 5, Steps: 13 | Train Loss: 0.482 Vali Loss: 0.840 Vali Acc: 0.361 Test Loss: 0.840 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.374478816986084
Epoch: 6, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5318129062652588
Epoch: 7, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.610 Vali Acc: 0.722 Test Loss: 0.610 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6456143856048584
Epoch: 8, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4545204639434814
Epoch: 9, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.738 Vali Acc: 0.673 Test Loss: 0.738 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5360238552093506
Epoch: 10, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.698 Vali Acc: 0.722 Test Loss: 0.698 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5366268157958984
Epoch: 11, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.746 Vali Acc: 0.722 Test Loss: 0.746 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4229600429534912
Epoch: 12, Steps: 13 | Train Loss: 0.209 Vali Loss: 0.799 Vali Acc: 0.693 Test Loss: 0.799 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6218194961547852
Epoch: 13, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.942 Vali Acc: 0.654 Test Loss: 0.942 Test Acc: 0.654
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 210054
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7385952472686768
Epoch: 1, Steps: 13 | Train Loss: 0.672 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3761730194091797
Epoch: 2, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.660 Vali Acc: 0.712 Test Loss: 0.660 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.39316987991333
Epoch: 3, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.2835187911987305
Epoch: 4, Steps: 13 | Train Loss: 0.469 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5342535972595215
Epoch: 5, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.842 Vali Acc: 0.341 Test Loss: 0.842 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5344295501708984
Epoch: 6, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.552 Vali Acc: 0.732 Test Loss: 0.552 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.295292854309082
Epoch: 7, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3344693183898926
Epoch: 8, Steps: 13 | Train Loss: 0.369 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.444488763809204
Epoch: 9, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1896874904632568
Epoch: 10, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.683 Vali Acc: 0.732 Test Loss: 0.683 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.275514841079712
Epoch: 11, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.706 Vali Acc: 0.722 Test Loss: 0.706 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2180149555206299
Epoch: 12, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.772 Vali Acc: 0.624 Test Loss: 0.772 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2889087200164795
Epoch: 13, Steps: 13 | Train Loss: 0.199 Vali Loss: 1.008 Vali Acc: 0.610 Test Loss: 1.008 Test Acc: 0.610
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 210054
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3427236080169678
Epoch: 1, Steps: 13 | Train Loss: 0.667 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3475868701934814
Epoch: 2, Steps: 13 | Train Loss: 0.537 Vali Loss: 0.655 Vali Acc: 0.727 Test Loss: 0.655 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.2255635261535645
Epoch: 3, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.386003017425537
Epoch: 4, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.3751940727233887
Epoch: 5, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.782 Vali Acc: 0.346 Test Loss: 0.782 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3731861114501953
Epoch: 6, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.548 Vali Acc: 0.737 Test Loss: 0.548 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2428395748138428
Epoch: 7, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3210971355438232
Epoch: 8, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.391228199005127
Epoch: 9, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.624 Vali Acc: 0.727 Test Loss: 0.624 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3318164348602295
Epoch: 10, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.639 Vali Acc: 0.717 Test Loss: 0.639 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3553814888000488
Epoch: 11, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.677 Vali Acc: 0.668 Test Loss: 0.677 Test Acc: 0.668
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.40895414352417
Epoch: 12, Steps: 13 | Train Loss: 0.189 Vali Loss: 0.760 Vali Acc: 0.639 Test Loss: 0.760 Test Acc: 0.639
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.39003586769104
Epoch: 13, Steps: 13 | Train Loss: 0.125 Vali Loss: 0.972 Vali Acc: 0.610 Test Loss: 0.972 Test Acc: 0.610
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2234151363372803
Epoch: 14, Steps: 13 | Train Loss: 0.175 Vali Loss: 1.604 Vali Acc: 0.371 Test Loss: 1.604 Test Acc: 0.371
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 210054
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2635180950164795
Epoch: 1, Steps: 13 | Train Loss: 0.670 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3375251293182373
Epoch: 2, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.642 Vali Acc: 0.746 Test Loss: 0.642 Test Acc: 0.746
Validation loss decreased (-0.721945 --> -0.746335).  Saving model ...
Epoch: 3 cost time: 1.2672512531280518
Epoch: 3, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1467161178588867
Epoch: 4, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.248016357421875
Epoch: 5, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.678 Vali Acc: 0.620 Test Loss: 0.678 Test Acc: 0.620
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.239516019821167
Epoch: 6, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
Validation loss decreased (-0.746335 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.229851245880127
Epoch: 7, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3112246990203857
Epoch: 8, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.622 Vali Acc: 0.751 Test Loss: 0.622 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2425787448883057
Epoch: 9, Steps: 13 | Train Loss: 0.392 Vali Loss: 0.595 Vali Acc: 0.702 Test Loss: 0.595 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2617499828338623
Epoch: 10, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2988355159759521
Epoch: 11, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.615 Vali Acc: 0.712 Test Loss: 0.615 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.324944019317627
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.856 Vali Acc: 0.605 Test Loss: 0.856 Test Acc: 0.605
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3481886386871338
Epoch: 13, Steps: 13 | Train Loss: 0.207 Vali Loss: 1.368 Vali Acc: 0.507 Test Loss: 1.368 Test Acc: 0.507
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2239041328430176
Epoch: 14, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.437 Vali Acc: 0.488 Test Loss: 1.437 Test Acc: 0.488
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2403271198272705
Epoch: 15, Steps: 13 | Train Loss: 0.262 Vali Loss: 1.754 Vali Acc: 0.634 Test Loss: 1.754 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3389217853546143
Epoch: 16, Steps: 13 | Train Loss: 0.398 Vali Loss: 1.754 Vali Acc: 0.717 Test Loss: 1.754 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 210054
model size : 3.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 4.160171985626221
Epoch: 1, Steps: 13 | Train Loss: 0.640 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
Validation loss decreased (inf --> -0.726823).  Saving model ...
Epoch: 2 cost time: 1.3566398620605469
Epoch: 2, Steps: 13 | Train Loss: 0.543 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.426537036895752
Epoch: 3, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3919427394866943
Epoch: 4, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
Validation loss decreased (-0.726823 --> -0.751213).  Saving model ...
Epoch: 5 cost time: 1.3209152221679688
Epoch: 5, Steps: 13 | Train Loss: 0.681 Vali Loss: 0.836 Vali Acc: 0.493 Test Loss: 0.836 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5323963165283203
Epoch: 6, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.922 Vali Acc: 0.410 Test Loss: 0.922 Test Acc: 0.410
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4000921249389648
Epoch: 7, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.719 Vali Acc: 0.659 Test Loss: 0.719 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6391689777374268
Epoch: 8, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.672 Vali Acc: 0.707 Test Loss: 0.672 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3826279640197754
Epoch: 9, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.664 Vali Acc: 0.712 Test Loss: 0.664 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.485074520111084
Epoch: 10, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.743 Vali Acc: 0.698 Test Loss: 0.743 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4779183864593506
Epoch: 11, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.915 Vali Acc: 0.717 Test Loss: 0.915 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4046306610107422
Epoch: 12, Steps: 13 | Train Loss: 0.186 Vali Loss: 0.885 Vali Acc: 0.712 Test Loss: 0.885 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4458863735198975
Epoch: 13, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.982 Vali Acc: 0.629 Test Loss: 0.982 Test Acc: 0.629
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.414928913116455
Epoch: 14, Steps: 13 | Train Loss: 0.143 Vali Loss: 1.034 Vali Acc: 0.741 Test Loss: 1.034 Test Acc: 0.741
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 193670
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4775948524475098
Epoch: 1, Steps: 13 | Train Loss: 0.636 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3743088245391846
Epoch: 2, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4573941230773926
Epoch: 3, Steps: 13 | Train Loss: 0.532 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.4241058826446533
Epoch: 4, Steps: 13 | Train Loss: 0.438 Vali Loss: 0.673 Vali Acc: 0.741 Test Loss: 0.673 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6324081420898438
Epoch: 5, Steps: 13 | Train Loss: 0.620 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5211873054504395
Epoch: 6, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.999 Vali Acc: 0.298 Test Loss: 0.999 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4409310817718506
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.673 Vali Acc: 0.659 Test Loss: 0.673 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.518357753753662
Epoch: 8, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.680 Vali Acc: 0.654 Test Loss: 0.680 Test Acc: 0.654
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5743412971496582
Epoch: 9, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.648 Vali Acc: 0.737 Test Loss: 0.648 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5127406120300293
Epoch: 10, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.669 Vali Acc: 0.727 Test Loss: 0.669 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.7704999446868896
Epoch: 11, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.782 Vali Acc: 0.737 Test Loss: 0.782 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.52683687210083
Epoch: 12, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.770 Vali Acc: 0.663 Test Loss: 0.770 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.448869228363037
Epoch: 13, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.831 Vali Acc: 0.673 Test Loss: 0.831 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 193670
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7209153175354004
Epoch: 1, Steps: 13 | Train Loss: 0.622 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3525292873382568
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.687 Vali Acc: 0.722 Test Loss: 0.687 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1861395835876465
Epoch: 3, Steps: 13 | Train Loss: 0.565 Vali Loss: 0.580 Vali Acc: 0.727 Test Loss: 0.580 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.3728997707366943
Epoch: 4, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.3883516788482666
Epoch: 5, Steps: 13 | Train Loss: 0.633 Vali Loss: 0.550 Vali Acc: 0.751 Test Loss: 0.550 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.3173129558563232
Epoch: 6, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.897 Vali Acc: 0.293 Test Loss: 0.897 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4491236209869385
Epoch: 7, Steps: 13 | Train Loss: 0.396 Vali Loss: 0.671 Vali Acc: 0.634 Test Loss: 0.671 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4767661094665527
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.401737928390503
Epoch: 9, Steps: 13 | Train Loss: 0.284 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4179332256317139
Epoch: 10, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.452016830444336
Epoch: 11, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.717 Vali Acc: 0.732 Test Loss: 0.717 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4539179801940918
Epoch: 12, Steps: 13 | Train Loss: 0.181 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.332474946975708
Epoch: 13, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.956 Vali Acc: 0.576 Test Loss: 0.956 Test Acc: 0.576
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2637231349945068
Epoch: 14, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.974 Vali Acc: 0.717 Test Loss: 0.974 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.278235673904419
Epoch: 15, Steps: 13 | Train Loss: 0.111 Vali Loss: 1.449 Vali Acc: 0.688 Test Loss: 1.449 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 193670
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.367231607437134
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.581 Vali Acc: 0.722 Test Loss: 0.581 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3353121280670166
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.642 Vali Acc: 0.722 Test Loss: 0.642 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.457550287246704
Epoch: 3, Steps: 13 | Train Loss: 0.545 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.4022648334503174
Epoch: 4, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.641 Vali Acc: 0.722 Test Loss: 0.641 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.473329782485962
Epoch: 5, Steps: 13 | Train Loss: 0.654 Vali Loss: 0.573 Vali Acc: 0.702 Test Loss: 0.573 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.350543737411499
Epoch: 6, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.837 Vali Acc: 0.302 Test Loss: 0.837 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4696636199951172
Epoch: 7, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.603 Vali Acc: 0.712 Test Loss: 0.603 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3669888973236084
Epoch: 8, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.583 Vali Acc: 0.732 Test Loss: 0.583 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 9 cost time: 1.2938923835754395
Epoch: 9, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.773 Vali Acc: 0.746 Test Loss: 0.773 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746334).  Saving model ...
Epoch: 10 cost time: 1.2240161895751953
Epoch: 10, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.646 Vali Acc: 0.707 Test Loss: 0.646 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.264418125152588
Epoch: 11, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.692 Vali Acc: 0.712 Test Loss: 0.692 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.33137845993042
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 1.038 Vali Acc: 0.512 Test Loss: 1.038 Test Acc: 0.512
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2348854541778564
Epoch: 13, Steps: 13 | Train Loss: 0.332 Vali Loss: 1.128 Vali Acc: 0.420 Test Loss: 1.128 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.382636547088623
Epoch: 14, Steps: 13 | Train Loss: 0.230 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2380707263946533
Epoch: 15, Steps: 13 | Train Loss: 0.164 Vali Loss: 1.486 Vali Acc: 0.580 Test Loss: 1.486 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4077208042144775
Epoch: 16, Steps: 13 | Train Loss: 0.181 Vali Loss: 1.209 Vali Acc: 0.654 Test Loss: 1.209 Test Acc: 0.654
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1944935321807861
Epoch: 17, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.306 Vali Acc: 0.644 Test Loss: 1.306 Test Acc: 0.644
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2992868423461914
Epoch: 18, Steps: 13 | Train Loss: 0.068 Vali Loss: 1.350 Vali Acc: 0.693 Test Loss: 1.350 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2432959079742432
Epoch: 19, Steps: 13 | Train Loss: 0.043 Vali Loss: 2.022 Vali Acc: 0.556 Test Loss: 2.022 Test Acc: 0.556
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 193670
model size : 3.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.8306527137756348
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.589 Vali Acc: 0.717 Test Loss: 0.589 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.429387092590332
Epoch: 2, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.594 Vali Acc: 0.741 Test Loss: 0.594 Test Acc: 0.741
Validation loss decreased (-0.717067 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.3618345260620117
Epoch: 3, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
Validation loss decreased (-0.741457 --> -0.741458).  Saving model ...
Epoch: 4 cost time: 1.233691692352295
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.1929819583892822
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.573 Vali Acc: 0.746 Test Loss: 0.573 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.293663740158081
Epoch: 6, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.2179811000823975
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.544 Vali Acc: 0.727 Test Loss: 0.544 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1803429126739502
Epoch: 8, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2128217220306396
Epoch: 9, Steps: 13 | Train Loss: 0.336 Vali Loss: 0.625 Vali Acc: 0.678 Test Loss: 0.625 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3512094020843506
Epoch: 10, Steps: 13 | Train Loss: 0.309 Vali Loss: 0.636 Vali Acc: 0.659 Test Loss: 0.636 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3032143115997314
Epoch: 11, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.644 Vali Acc: 0.732 Test Loss: 0.644 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3011329174041748
Epoch: 12, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.692 Vali Acc: 0.727 Test Loss: 0.692 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2747642993927002
Epoch: 13, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.803 Vali Acc: 0.727 Test Loss: 0.803 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2536406517028809
Epoch: 14, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.724 Vali Acc: 0.702 Test Loss: 0.724 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1974358558654785
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.834 Vali Acc: 0.624 Test Loss: 0.834 Test Acc: 0.624
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.236386775970459
Epoch: 16, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.811 Vali Acc: 0.673 Test Loss: 0.811 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 342726
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3671553134918213
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3026959896087646
Epoch: 2, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.2153656482696533
Epoch: 3, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.591 Vali Acc: 0.732 Test Loss: 0.591 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.40545654296875
Epoch: 4, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.567 Vali Acc: 0.751 Test Loss: 0.567 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 5 cost time: 1.2620861530303955
Epoch: 5, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.568 Vali Acc: 0.746 Test Loss: 0.568 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3230550289154053
Epoch: 6, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.553 Vali Acc: 0.741 Test Loss: 0.553 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2850332260131836
Epoch: 7, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.553 Vali Acc: 0.746 Test Loss: 0.553 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2882335186004639
Epoch: 8, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.595 Vali Acc: 0.673 Test Loss: 0.595 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3404579162597656
Epoch: 9, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.637 Vali Acc: 0.668 Test Loss: 0.637 Test Acc: 0.668
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4568636417388916
Epoch: 10, Steps: 13 | Train Loss: 0.334 Vali Loss: 0.642 Vali Acc: 0.668 Test Loss: 0.642 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4602115154266357
Epoch: 11, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.634 Vali Acc: 0.741 Test Loss: 0.634 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2951545715332031
Epoch: 12, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.675 Vali Acc: 0.732 Test Loss: 0.675 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3585388660430908
Epoch: 13, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.750 Vali Acc: 0.732 Test Loss: 0.750 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3244867324829102
Epoch: 14, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 342726
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6701221466064453
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.591 Vali Acc: 0.722 Test Loss: 0.591 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3718559741973877
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.602 Vali Acc: 0.732 Test Loss: 0.602 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.3875453472137451
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.588 Vali Acc: 0.746 Test Loss: 0.588 Test Acc: 0.746
Validation loss decreased (-0.731701 --> -0.746336).  Saving model ...
Epoch: 4 cost time: 1.3432567119598389
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.562 Vali Acc: 0.741 Test Loss: 0.562 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1449074745178223
Epoch: 5, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.2809746265411377
Epoch: 6, Steps: 13 | Train Loss: 0.437 Vali Loss: 0.534 Vali Acc: 0.756 Test Loss: 0.534 Test Acc: 0.756
Validation loss decreased (-0.746336 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.2515616416931152
Epoch: 7, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.534 Vali Acc: 0.751 Test Loss: 0.534 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2408576011657715
Epoch: 8, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.320833683013916
Epoch: 9, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.590 Vali Acc: 0.683 Test Loss: 0.590 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2907307147979736
Epoch: 10, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.602 Vali Acc: 0.673 Test Loss: 0.602 Test Acc: 0.673
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3912193775177002
Epoch: 11, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3589489459991455
Epoch: 12, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.620 Vali Acc: 0.746 Test Loss: 0.620 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2837131023406982
Epoch: 13, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.705 Vali Acc: 0.737 Test Loss: 0.705 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1915524005889893
Epoch: 14, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.622 Vali Acc: 0.702 Test Loss: 0.622 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.314786672592163
Epoch: 15, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.786 Vali Acc: 0.590 Test Loss: 0.786 Test Acc: 0.590
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.301969289779663
Epoch: 16, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.665 Vali Acc: 0.698 Test Loss: 0.665 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 342726
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.58111834526062
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3303210735321045
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.599 Vali Acc: 0.727 Test Loss: 0.599 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.3278543949127197
Epoch: 3, Steps: 13 | Train Loss: 0.541 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3398797512054443
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.179184913635254
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.262317419052124
Epoch: 6, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.25905442237854
Epoch: 7, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.3431065082550049
Epoch: 8, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.593 Vali Acc: 0.693 Test Loss: 0.593 Test Acc: 0.693
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.261197566986084
Epoch: 9, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.611 Vali Acc: 0.688 Test Loss: 0.611 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2741408348083496
Epoch: 10, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.608 Vali Acc: 0.683 Test Loss: 0.608 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.263611078262329
Epoch: 11, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.374772548675537
Epoch: 12, Steps: 13 | Train Loss: 0.319 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3927836418151855
Epoch: 13, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.670 Vali Acc: 0.722 Test Loss: 0.670 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.2821509838104248
Epoch: 14, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.622 Vali Acc: 0.712 Test Loss: 0.622 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3727355003356934
Epoch: 15, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.784 Vali Acc: 0.556 Test Loss: 0.784 Test Acc: 0.556
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3398005962371826
Epoch: 16, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.689 Vali Acc: 0.727 Test Loss: 0.689 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2361700534820557
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.755 Vali Acc: 0.688 Test Loss: 0.755 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 342726
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5541093349456787
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3215858936309814
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.5919702053070068
Epoch: 3, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 4 cost time: 1.6621735095977783
Epoch: 4, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.3534595966339111
Epoch: 5, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.611 Vali Acc: 0.732 Test Loss: 0.611 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2782859802246094
Epoch: 6, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.672 Vali Acc: 0.668 Test Loss: 0.672 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4552826881408691
Epoch: 7, Steps: 13 | Train Loss: 0.395 Vali Loss: 0.572 Vali Acc: 0.741 Test Loss: 0.572 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.3293812274932861
Epoch: 8, Steps: 13 | Train Loss: 0.343 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2649974822998047
Epoch: 9, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4653372764587402
Epoch: 10, Steps: 13 | Train Loss: 0.269 Vali Loss: 0.743 Vali Acc: 0.741 Test Loss: 0.743 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3177037239074707
Epoch: 11, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.647 Vali Acc: 0.707 Test Loss: 0.647 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3547170162200928
Epoch: 12, Steps: 13 | Train Loss: 0.235 Vali Loss: 0.658 Vali Acc: 0.712 Test Loss: 0.658 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4726026058197021
Epoch: 13, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4601290225982666
Epoch: 14, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.868 Vali Acc: 0.634 Test Loss: 0.868 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5702769756317139
Epoch: 15, Steps: 13 | Train Loss: 0.198 Vali Loss: 0.740 Vali Acc: 0.707 Test Loss: 0.740 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3157029151916504
Epoch: 16, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.822 Vali Acc: 0.702 Test Loss: 0.822 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.4932868480682373
Epoch: 17, Steps: 13 | Train Loss: 0.130 Vali Loss: 0.907 Vali Acc: 0.698 Test Loss: 0.907 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 211654
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.383882522583008
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3338944911956787
Epoch: 2, Steps: 13 | Train Loss: 0.550 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.1867647171020508
Epoch: 3, Steps: 13 | Train Loss: 0.523 Vali Loss: 0.556 Vali Acc: 0.737 Test Loss: 0.556 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.295473337173462
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.560 Vali Acc: 0.727 Test Loss: 0.560 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.304314374923706
Epoch: 5, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.601 Vali Acc: 0.732 Test Loss: 0.601 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2485949993133545
Epoch: 6, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.651 Vali Acc: 0.683 Test Loss: 0.651 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.323455572128296
Epoch: 7, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3920974731445312
Epoch: 8, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1482372283935547
Epoch: 9, Steps: 13 | Train Loss: 0.342 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.294724464416504
Epoch: 10, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.1563336849212646
Epoch: 11, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.707 Vali Acc: 0.668 Test Loss: 0.707 Test Acc: 0.668
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2544586658477783
Epoch: 12, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.660 Vali Acc: 0.688 Test Loss: 0.660 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.280350923538208
Epoch: 13, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.662 Vali Acc: 0.732 Test Loss: 0.662 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 211654
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.624480724334717
Epoch: 1, Steps: 13 | Train Loss: 0.614 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2600131034851074
Epoch: 2, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2635002136230469
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.563 Vali Acc: 0.717 Test Loss: 0.563 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3757448196411133
Epoch: 4, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.548 Vali Acc: 0.732 Test Loss: 0.548 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.233828067779541
Epoch: 5, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2874581813812256
Epoch: 6, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.648 Vali Acc: 0.659 Test Loss: 0.648 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0973646640777588
Epoch: 7, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.548 Vali Acc: 0.756 Test Loss: 0.548 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 1.2760722637176514
Epoch: 8, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2433533668518066
Epoch: 9, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.566 Vali Acc: 0.746 Test Loss: 0.566 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2495629787445068
Epoch: 10, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.670 Vali Acc: 0.756 Test Loss: 0.670 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2485036849975586
Epoch: 11, Steps: 13 | Train Loss: 0.339 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2817234992980957
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2135465145111084
Epoch: 13, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.597 Vali Acc: 0.741 Test Loss: 0.597 Test Acc: 0.741
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.374162197113037
Epoch: 14, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.790 Vali Acc: 0.620 Test Loss: 0.790 Test Acc: 0.620
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2723863124847412
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.630 Vali Acc: 0.712 Test Loss: 0.630 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2861042022705078
Epoch: 16, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.713 Vali Acc: 0.722 Test Loss: 0.713 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3316028118133545
Epoch: 17, Steps: 13 | Train Loss: 0.141 Vali Loss: 0.765 Vali Acc: 0.717 Test Loss: 0.765 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 211654
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.586455821990967
Epoch: 1, Steps: 13 | Train Loss: 0.615 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2663421630859375
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1849634647369385
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.575 Vali Acc: 0.712 Test Loss: 0.575 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.288339376449585
Epoch: 4, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.573 Vali Acc: 0.717 Test Loss: 0.573 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.478438377380371
Epoch: 5, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.619 Vali Acc: 0.717 Test Loss: 0.619 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3202004432678223
Epoch: 6, Steps: 13 | Train Loss: 0.490 Vali Loss: 0.655 Vali Acc: 0.659 Test Loss: 0.655 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.250272274017334
Epoch: 7, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.570 Vali Acc: 0.732 Test Loss: 0.570 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 8 cost time: 1.270190715789795
Epoch: 8, Steps: 13 | Train Loss: 0.418 Vali Loss: 0.580 Vali Acc: 0.732 Test Loss: 0.580 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2782516479492188
Epoch: 9, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.605 Vali Acc: 0.741 Test Loss: 0.605 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741457).  Saving model ...
Epoch: 10 cost time: 1.2067465782165527
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.656 Vali Acc: 0.746 Test Loss: 0.656 Test Acc: 0.746
Validation loss decreased (-0.741457 --> -0.746335).  Saving model ...
Epoch: 11 cost time: 1.2662105560302734
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.553 Vali Acc: 0.737 Test Loss: 0.553 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3111555576324463
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2797811031341553
Epoch: 13, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.619 Vali Acc: 0.727 Test Loss: 0.619 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2222533226013184
Epoch: 14, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.808 Vali Acc: 0.585 Test Loss: 0.808 Test Acc: 0.585
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2339298725128174
Epoch: 15, Steps: 13 | Train Loss: 0.227 Vali Loss: 0.653 Vali Acc: 0.722 Test Loss: 0.653 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4413459300994873
Epoch: 16, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.774 Vali Acc: 0.707 Test Loss: 0.774 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2672557830810547
Epoch: 17, Steps: 13 | Train Loss: 0.146 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.378615140914917
Epoch: 18, Steps: 13 | Train Loss: 0.126 Vali Loss: 0.988 Vali Acc: 0.702 Test Loss: 0.988 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.403134822845459
Epoch: 19, Steps: 13 | Train Loss: 0.100 Vali Loss: 1.115 Vali Acc: 0.693 Test Loss: 1.115 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3700239658355713
Epoch: 20, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.082 Vali Acc: 0.673 Test Loss: 1.082 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 211654
model size : 2.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.420358180999756
Epoch: 1, Steps: 13 | Train Loss: 0.662 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2588410377502441
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 1.1864004135131836
Epoch: 3, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.484114646911621
Epoch: 4, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.629 Vali Acc: 0.732 Test Loss: 0.629 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3784222602844238
Epoch: 5, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.591 Vali Acc: 0.756 Test Loss: 0.591 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.3227035999298096
Epoch: 6, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.572 Vali Acc: 0.732 Test Loss: 0.572 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.448674201965332
Epoch: 7, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4600462913513184
Epoch: 8, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.618 Vali Acc: 0.717 Test Loss: 0.618 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3187239170074463
Epoch: 9, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.620 Vali Acc: 0.722 Test Loss: 0.620 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3700792789459229
Epoch: 10, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.622 Vali Acc: 0.732 Test Loss: 0.622 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2325825691223145
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.610 Vali Acc: 0.727 Test Loss: 0.610 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3924822807312012
Epoch: 12, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.648 Vali Acc: 0.722 Test Loss: 0.648 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.372230052947998
Epoch: 13, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2038991451263428
Epoch: 14, Steps: 13 | Train Loss: 0.177 Vali Loss: 0.788 Vali Acc: 0.644 Test Loss: 0.788 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2865912914276123
Epoch: 15, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.788 Vali Acc: 0.678 Test Loss: 0.788 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 146118
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.7794923782348633
Epoch: 1, Steps: 13 | Train Loss: 0.663 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2780847549438477
Epoch: 2, Steps: 13 | Train Loss: 0.574 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.2816486358642578
Epoch: 3, Steps: 13 | Train Loss: 0.521 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3511314392089844
Epoch: 4, Steps: 13 | Train Loss: 0.479 Vali Loss: 0.635 Vali Acc: 0.727 Test Loss: 0.635 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3811347484588623
Epoch: 5, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.3893396854400635
Epoch: 6, Steps: 13 | Train Loss: 0.410 Vali Loss: 0.563 Vali Acc: 0.722 Test Loss: 0.563 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3850643634796143
Epoch: 7, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1787924766540527
Epoch: 8, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.615 Vali Acc: 0.702 Test Loss: 0.615 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3968517780303955
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.613 Vali Acc: 0.712 Test Loss: 0.613 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3174810409545898
Epoch: 10, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.618 Vali Acc: 0.737 Test Loss: 0.618 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3047149181365967
Epoch: 11, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.566321611404419
Epoch: 12, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.274231195449829
Epoch: 13, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.722 Vali Acc: 0.732 Test Loss: 0.722 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.544020175933838
Epoch: 14, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.728 Vali Acc: 0.644 Test Loss: 0.728 Test Acc: 0.644
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1691348552703857
Epoch: 15, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.685 Vali Acc: 0.673 Test Loss: 0.685 Test Acc: 0.673
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 146118
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.726412296295166
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2883641719818115
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.587 Vali Acc: 0.732 Test Loss: 0.587 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.343843936920166
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3132648468017578
Epoch: 4, Steps: 13 | Train Loss: 0.503 Vali Loss: 0.612 Vali Acc: 0.727 Test Loss: 0.612 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3621768951416016
Epoch: 5, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.564 Vali Acc: 0.732 Test Loss: 0.564 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.1926038265228271
Epoch: 6, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 1.2676568031311035
Epoch: 7, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.539 Vali Acc: 0.741 Test Loss: 0.539 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.3597242832183838
Epoch: 8, Steps: 13 | Train Loss: 0.390 Vali Loss: 0.597 Vali Acc: 0.707 Test Loss: 0.597 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3267452716827393
Epoch: 9, Steps: 13 | Train Loss: 0.417 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3179843425750732
Epoch: 10, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.579 Vali Acc: 0.761 Test Loss: 0.579 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 11 cost time: 1.1776304244995117
Epoch: 11, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1684160232543945
Epoch: 12, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2464218139648438
Epoch: 13, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2237718105316162
Epoch: 14, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.679 Vali Acc: 0.659 Test Loss: 0.679 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3038525581359863
Epoch: 15, Steps: 13 | Train Loss: 0.260 Vali Loss: 0.625 Vali Acc: 0.732 Test Loss: 0.625 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3676042556762695
Epoch: 16, Steps: 13 | Train Loss: 0.199 Vali Loss: 0.670 Vali Acc: 0.727 Test Loss: 0.670 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.36684250831604
Epoch: 17, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.760 Vali Acc: 0.722 Test Loss: 0.760 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5495953559875488
Epoch: 18, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.756 Vali Acc: 0.732 Test Loss: 0.756 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4169862270355225
Epoch: 19, Steps: 13 | Train Loss: 0.112 Vali Loss: 0.895 Vali Acc: 0.737 Test Loss: 0.895 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.51426100730896
Epoch: 20, Steps: 13 | Train Loss: 0.097 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 146118
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3810532093048096
Epoch: 1, Steps: 13 | Train Loss: 0.637 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1305005550384521
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.180140495300293
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.568 Vali Acc: 0.712 Test Loss: 0.568 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2434704303741455
Epoch: 4, Steps: 13 | Train Loss: 0.528 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2572672367095947
Epoch: 5, Steps: 13 | Train Loss: 0.505 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.15028977394104
Epoch: 6, Steps: 13 | Train Loss: 0.471 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.736580 --> -0.756092).  Saving model ...
Epoch: 7 cost time: 1.2715685367584229
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.556 Vali Acc: 0.751 Test Loss: 0.556 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1978111267089844
Epoch: 8, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1411728858947754
Epoch: 9, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.587 Vali Acc: 0.727 Test Loss: 0.587 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2171366214752197
Epoch: 10, Steps: 13 | Train Loss: 0.374 Vali Loss: 0.628 Vali Acc: 0.732 Test Loss: 0.628 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1882717609405518
Epoch: 11, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.559 Vali Acc: 0.732 Test Loss: 0.559 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1765761375427246
Epoch: 12, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2374460697174072
Epoch: 13, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.645 Vali Acc: 0.727 Test Loss: 0.645 Test Acc: 0.727
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1595981121063232
Epoch: 14, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.697 Vali Acc: 0.673 Test Loss: 0.697 Test Acc: 0.673
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1601536273956299
Epoch: 15, Steps: 13 | Train Loss: 0.257 Vali Loss: 0.725 Vali Acc: 0.717 Test Loss: 0.725 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.25162672996521
Epoch: 16, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.807 Vali Acc: 0.722 Test Loss: 0.807 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 146118
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1005241870880127
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.607 Vali Acc: 0.712 Test Loss: 0.607 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.3601243495941162
Epoch: 2, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.611 Vali Acc: 0.737 Test Loss: 0.611 Test Acc: 0.737
Validation loss decreased (-0.712189 --> -0.736579).  Saving model ...
Epoch: 3 cost time: 1.3400096893310547
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.612 Vali Acc: 0.737 Test Loss: 0.612 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.351778268814087
Epoch: 4, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.603 Vali Acc: 0.737 Test Loss: 0.603 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.3357210159301758
Epoch: 5, Steps: 13 | Train Loss: 0.456 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.286752462387085
Epoch: 6, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.582 Vali Acc: 0.751 Test Loss: 0.582 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.3521087169647217
Epoch: 7, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.581 Vali Acc: 0.732 Test Loss: 0.581 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.350914478302002
Epoch: 8, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.608 Vali Acc: 0.746 Test Loss: 0.608 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4839601516723633
Epoch: 9, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.600 Vali Acc: 0.722 Test Loss: 0.600 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3028109073638916
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.663 Vali Acc: 0.693 Test Loss: 0.663 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2959086894989014
Epoch: 11, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.620 Vali Acc: 0.732 Test Loss: 0.620 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.538985252380371
Epoch: 12, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.714 Vali Acc: 0.663 Test Loss: 0.714 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4421296119689941
Epoch: 13, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4247140884399414
Epoch: 14, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.728 Vali Acc: 0.712 Test Loss: 0.728 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.274632453918457
Epoch: 15, Steps: 13 | Train Loss: 0.201 Vali Loss: 1.152 Vali Acc: 0.507 Test Loss: 1.152 Test Acc: 0.507
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.255542516708374
Epoch: 16, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.806 Vali Acc: 0.668 Test Loss: 0.806 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 113350
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5128211975097656
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.3382413387298584
Epoch: 2, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.602 Vali Acc: 0.727 Test Loss: 0.602 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.1853022575378418
Epoch: 3, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.617 Vali Acc: 0.727 Test Loss: 0.617 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2958660125732422
Epoch: 4, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.1993441581726074
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 6 cost time: 1.2557618618011475
Epoch: 6, Steps: 13 | Train Loss: 0.408 Vali Loss: 0.573 Vali Acc: 0.751 Test Loss: 0.573 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.2742383480072021
Epoch: 7, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.568 Vali Acc: 0.722 Test Loss: 0.568 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3616795539855957
Epoch: 8, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2915441989898682
Epoch: 9, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2733075618743896
Epoch: 10, Steps: 13 | Train Loss: 0.322 Vali Loss: 0.645 Vali Acc: 0.688 Test Loss: 0.645 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4771897792816162
Epoch: 11, Steps: 13 | Train Loss: 0.303 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4191772937774658
Epoch: 12, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.669 Vali Acc: 0.663 Test Loss: 0.669 Test Acc: 0.663
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3729913234710693
Epoch: 13, Steps: 13 | Train Loss: 0.224 Vali Loss: 0.660 Vali Acc: 0.707 Test Loss: 0.660 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2124357223510742
Epoch: 14, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3381962776184082
Epoch: 15, Steps: 13 | Train Loss: 0.197 Vali Loss: 0.970 Vali Acc: 0.561 Test Loss: 0.970 Test Acc: 0.561
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4419410228729248
Epoch: 16, Steps: 13 | Train Loss: 0.179 Vali Loss: 0.781 Vali Acc: 0.668 Test Loss: 0.781 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 113350
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3488175868988037
Epoch: 1, Steps: 13 | Train Loss: 0.612 Vali Loss: 0.599 Vali Acc: 0.717 Test Loss: 0.599 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.341336727142334
Epoch: 2, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.598 Vali Acc: 0.727 Test Loss: 0.598 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.3255445957183838
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.21614408493042
Epoch: 4, Steps: 13 | Train Loss: 0.493 Vali Loss: 0.577 Vali Acc: 0.732 Test Loss: 0.577 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.381467342376709
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.541 Vali Acc: 0.756 Test Loss: 0.541 Test Acc: 0.756
Validation loss decreased (-0.731702 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.2863953113555908
Epoch: 6, Steps: 13 | Train Loss: 0.430 Vali Loss: 0.548 Vali Acc: 0.751 Test Loss: 0.548 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2338731288909912
Epoch: 7, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2136197090148926
Epoch: 8, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.565 Vali Acc: 0.746 Test Loss: 0.565 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3190736770629883
Epoch: 9, Steps: 13 | Train Loss: 0.363 Vali Loss: 0.541 Vali Acc: 0.732 Test Loss: 0.541 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.261671781539917
Epoch: 10, Steps: 13 | Train Loss: 0.360 Vali Loss: 0.635 Vali Acc: 0.678 Test Loss: 0.635 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3272292613983154
Epoch: 11, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.548 Vali Acc: 0.746 Test Loss: 0.548 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1698565483093262
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.602 Vali Acc: 0.678 Test Loss: 0.602 Test Acc: 0.678
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2743356227874756
Epoch: 13, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.610 Vali Acc: 0.746 Test Loss: 0.610 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2953062057495117
Epoch: 14, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.658 Vali Acc: 0.732 Test Loss: 0.658 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2965567111968994
Epoch: 15, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.945 Vali Acc: 0.498 Test Loss: 0.945 Test Acc: 0.498
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 113350
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.4064996242523193
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2162365913391113
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.273651361465454
Epoch: 3, Steps: 13 | Train Loss: 0.549 Vali Loss: 0.600 Vali Acc: 0.712 Test Loss: 0.600 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2182447910308838
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1966876983642578
Epoch: 5, Steps: 13 | Train Loss: 0.511 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.1536765098571777
Epoch: 6, Steps: 13 | Train Loss: 0.472 Vali Loss: 0.564 Vali Acc: 0.741 Test Loss: 0.564 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.20131254196167
Epoch: 7, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3107988834381104
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.580 Vali Acc: 0.746 Test Loss: 0.580 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 1.173283576965332
Epoch: 9, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2459514141082764
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.656 Vali Acc: 0.668 Test Loss: 0.656 Test Acc: 0.668
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.260037899017334
Epoch: 11, Steps: 13 | Train Loss: 0.401 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4276106357574463
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.617 Vali Acc: 0.693 Test Loss: 0.617 Test Acc: 0.693
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2166521549224854
Epoch: 13, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.641 Vali Acc: 0.741 Test Loss: 0.641 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1426091194152832
Epoch: 14, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3589978218078613
Epoch: 15, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.884 Vali Acc: 0.576 Test Loss: 0.884 Test Acc: 0.576
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3211612701416016
Epoch: 16, Steps: 13 | Train Loss: 0.210 Vali Loss: 0.728 Vali Acc: 0.698 Test Loss: 0.728 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3370611667633057
Epoch: 17, Steps: 13 | Train Loss: 0.253 Vali Loss: 1.128 Vali Acc: 0.712 Test Loss: 1.128 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.10746431350708
Epoch: 18, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.960 Vali Acc: 0.717 Test Loss: 0.960 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 113350
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.606677293777466
Epoch: 1, Steps: 13 | Train Loss: 0.608 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.4689030647277832
Epoch: 2, Steps: 13 | Train Loss: 0.581 Vali Loss: 0.604 Vali Acc: 0.732 Test Loss: 0.604 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.3000688552856445
Epoch: 3, Steps: 13 | Train Loss: 0.519 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 4 cost time: 1.3626549243927002
Epoch: 4, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.618 Vali Acc: 0.688 Test Loss: 0.618 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3159966468811035
Epoch: 5, Steps: 13 | Train Loss: 0.460 Vali Loss: 0.552 Vali Acc: 0.751 Test Loss: 0.552 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.4500017166137695
Epoch: 6, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.716 Vali Acc: 0.737 Test Loss: 0.716 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3251099586486816
Epoch: 7, Steps: 13 | Train Loss: 0.494 Vali Loss: 0.843 Vali Acc: 0.420 Test Loss: 0.843 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4343993663787842
Epoch: 8, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.595 Vali Acc: 0.746 Test Loss: 0.595 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3791706562042236
Epoch: 9, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2681279182434082
Epoch: 10, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.664 Vali Acc: 0.693 Test Loss: 0.664 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.286604404449463
Epoch: 11, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.770 Vali Acc: 0.624 Test Loss: 0.770 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.26609206199646
Epoch: 12, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.752 Vali Acc: 0.644 Test Loss: 0.752 Test Acc: 0.644
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3042666912078857
Epoch: 13, Steps: 13 | Train Loss: 0.280 Vali Loss: 0.685 Vali Acc: 0.702 Test Loss: 0.685 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.3086280822753906
Epoch: 14, Steps: 13 | Train Loss: 0.212 Vali Loss: 0.754 Vali Acc: 0.693 Test Loss: 0.754 Test Acc: 0.693
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4990968704223633
Epoch: 15, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.844 Vali Acc: 0.722 Test Loss: 0.844 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 96966
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.283482551574707
Epoch: 1, Steps: 13 | Train Loss: 0.613 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2326750755310059
Epoch: 2, Steps: 13 | Train Loss: 0.588 Vali Loss: 0.601 Vali Acc: 0.732 Test Loss: 0.601 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 3 cost time: 1.188108205795288
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.564 Vali Acc: 0.727 Test Loss: 0.564 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3024187088012695
Epoch: 4, Steps: 13 | Train Loss: 0.478 Vali Loss: 0.623 Vali Acc: 0.693 Test Loss: 0.623 Test Acc: 0.693
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.306826114654541
Epoch: 5, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.551 Vali Acc: 0.756 Test Loss: 0.551 Test Acc: 0.756
Validation loss decreased (-0.731701 --> -0.756092).  Saving model ...
Epoch: 6 cost time: 1.1979870796203613
Epoch: 6, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3126592636108398
Epoch: 7, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.869 Vali Acc: 0.366 Test Loss: 0.869 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2498455047607422
Epoch: 8, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.592 Vali Acc: 0.746 Test Loss: 0.592 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1568529605865479
Epoch: 9, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.589 Vali Acc: 0.702 Test Loss: 0.589 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2327229976654053
Epoch: 10, Steps: 13 | Train Loss: 0.310 Vali Loss: 0.689 Vali Acc: 0.649 Test Loss: 0.689 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3619844913482666
Epoch: 11, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.732 Vali Acc: 0.634 Test Loss: 0.732 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.336024522781372
Epoch: 12, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.713 Vali Acc: 0.659 Test Loss: 0.713 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3110451698303223
Epoch: 13, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.748 Vali Acc: 0.741 Test Loss: 0.748 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.249047040939331
Epoch: 14, Steps: 13 | Train Loss: 0.220 Vali Loss: 0.777 Vali Acc: 0.727 Test Loss: 0.777 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3730769157409668
Epoch: 15, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.811 Vali Acc: 0.732 Test Loss: 0.811 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 96966
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.6927387714385986
Epoch: 1, Steps: 13 | Train Loss: 0.609 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2758278846740723
Epoch: 2, Steps: 13 | Train Loss: 0.592 Vali Loss: 0.598 Vali Acc: 0.741 Test Loss: 0.598 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 3 cost time: 1.2349143028259277
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1840300559997559
Epoch: 4, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.650 Vali Acc: 0.707 Test Loss: 0.650 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1898481845855713
Epoch: 5, Steps: 13 | Train Loss: 0.500 Vali Loss: 0.545 Vali Acc: 0.751 Test Loss: 0.545 Test Acc: 0.751
Validation loss decreased (-0.741457 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.2446329593658447
Epoch: 6, Steps: 13 | Train Loss: 0.450 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.198998212814331
Epoch: 7, Steps: 13 | Train Loss: 0.535 Vali Loss: 0.854 Vali Acc: 0.278 Test Loss: 0.854 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2379693984985352
Epoch: 8, Steps: 13 | Train Loss: 0.414 Vali Loss: 0.572 Vali Acc: 0.751 Test Loss: 0.572 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5911357402801514
Epoch: 9, Steps: 13 | Train Loss: 0.365 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5467348098754883
Epoch: 10, Steps: 13 | Train Loss: 0.335 Vali Loss: 0.592 Vali Acc: 0.707 Test Loss: 0.592 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.408066987991333
Epoch: 11, Steps: 13 | Train Loss: 0.341 Vali Loss: 0.659 Vali Acc: 0.673 Test Loss: 0.659 Test Acc: 0.673
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4762017726898193
Epoch: 12, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.677 Vali Acc: 0.649 Test Loss: 0.677 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.448390245437622
Epoch: 13, Steps: 13 | Train Loss: 0.321 Vali Loss: 0.578 Vali Acc: 0.732 Test Loss: 0.578 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2494988441467285
Epoch: 14, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.372673511505127
Epoch: 15, Steps: 13 | Train Loss: 0.222 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756090).  Saving model ...
Epoch: 16 cost time: 1.5755791664123535
Epoch: 16, Steps: 13 | Train Loss: 0.217 Vali Loss: 0.786 Vali Acc: 0.751 Test Loss: 0.786 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4144134521484375
Epoch: 17, Steps: 13 | Train Loss: 0.166 Vali Loss: 0.708 Vali Acc: 0.659 Test Loss: 0.708 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3395497798919678
Epoch: 18, Steps: 13 | Train Loss: 0.178 Vali Loss: 0.751 Vali Acc: 0.712 Test Loss: 0.751 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3483645915985107
Epoch: 19, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.813 Vali Acc: 0.722 Test Loss: 0.813 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3002614974975586
Epoch: 20, Steps: 13 | Train Loss: 0.110 Vali Loss: 0.873 Vali Acc: 0.683 Test Loss: 0.873 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3734657764434814
Epoch: 21, Steps: 13 | Train Loss: 0.086 Vali Loss: 1.180 Vali Acc: 0.722 Test Loss: 1.180 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3987596035003662
Epoch: 22, Steps: 13 | Train Loss: 0.089 Vali Loss: 1.262 Vali Acc: 0.722 Test Loss: 1.262 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4518482685089111
Epoch: 23, Steps: 13 | Train Loss: 0.094 Vali Loss: 1.196 Vali Acc: 0.615 Test Loss: 1.196 Test Acc: 0.615
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.820446491241455
Epoch: 24, Steps: 13 | Train Loss: 0.040 Vali Loss: 1.230 Vali Acc: 0.746 Test Loss: 1.230 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4304461479187012
Epoch: 25, Steps: 13 | Train Loss: 0.032 Vali Loss: 1.244 Vali Acc: 0.712 Test Loss: 1.244 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 96966
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2391204833984375
Epoch: 1, Steps: 13 | Train Loss: 0.606 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0829734802246094
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.601 Vali Acc: 0.727 Test Loss: 0.601 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 3 cost time: 1.0783848762512207
Epoch: 3, Steps: 13 | Train Loss: 0.546 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0461554527282715
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.666 Vali Acc: 0.673 Test Loss: 0.666 Test Acc: 0.673
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1923773288726807
Epoch: 5, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.1617364883422852
Epoch: 6, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.653 Vali Acc: 0.712 Test Loss: 0.653 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2146718502044678
Epoch: 7, Steps: 13 | Train Loss: 0.554 Vali Loss: 0.737 Vali Acc: 0.537 Test Loss: 0.737 Test Acc: 0.537
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1614925861358643
Epoch: 8, Steps: 13 | Train Loss: 0.441 Vali Loss: 0.576 Vali Acc: 0.746 Test Loss: 0.576 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 1.112846851348877
Epoch: 9, Steps: 13 | Train Loss: 0.402 Vali Loss: 0.571 Vali Acc: 0.751 Test Loss: 0.571 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 10 cost time: 1.0866234302520752
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.573 Vali Acc: 0.707 Test Loss: 0.573 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0907583236694336
Epoch: 11, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.645 Vali Acc: 0.649 Test Loss: 0.645 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0787475109100342
Epoch: 12, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.733 Vali Acc: 0.580 Test Loss: 0.733 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0131969451904297
Epoch: 13, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.625 Vali Acc: 0.746 Test Loss: 0.625 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0930883884429932
Epoch: 14, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.654 Vali Acc: 0.717 Test Loss: 0.654 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1417016983032227
Epoch: 15, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.704 Vali Acc: 0.712 Test Loss: 0.704 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0319571495056152
Epoch: 16, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.796 Vali Acc: 0.707 Test Loss: 0.796 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1960809230804443
Epoch: 17, Steps: 13 | Train Loss: 0.167 Vali Loss: 0.801 Vali Acc: 0.693 Test Loss: 0.801 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.091146469116211
Epoch: 18, Steps: 13 | Train Loss: 0.162 Vali Loss: 0.898 Vali Acc: 0.717 Test Loss: 0.898 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0979194641113281
Epoch: 19, Steps: 13 | Train Loss: 0.147 Vali Loss: 1.097 Vali Acc: 0.712 Test Loss: 1.097 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 96966
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.406012773513794
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.411510944366455
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.565 Vali Acc: 0.722 Test Loss: 0.565 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 3 cost time: 1.2724683284759521
Epoch: 3, Steps: 13 | Train Loss: 0.548 Vali Loss: 0.603 Vali Acc: 0.746 Test Loss: 0.603 Test Acc: 0.746
Validation loss decreased (-0.721946 --> -0.746335).  Saving model ...
Epoch: 4 cost time: 1.2515714168548584
Epoch: 4, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.547 Vali Acc: 0.756 Test Loss: 0.547 Test Acc: 0.756
Validation loss decreased (-0.746335 --> -0.756092).  Saving model ...
Epoch: 5 cost time: 1.170708179473877
Epoch: 5, Steps: 13 | Train Loss: 0.443 Vali Loss: 0.564 Vali Acc: 0.751 Test Loss: 0.564 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2498126029968262
Epoch: 6, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.553 Vali Acc: 0.756 Test Loss: 0.553 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.360370397567749
Epoch: 7, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.146047830581665
Epoch: 8, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.567 Vali Acc: 0.741 Test Loss: 0.567 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3829331398010254
Epoch: 9, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.567 Vali Acc: 0.727 Test Loss: 0.567 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2574231624603271
Epoch: 10, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.599 Vali Acc: 0.698 Test Loss: 0.599 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.4414122104644775
Epoch: 11, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3727493286132812
Epoch: 12, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.689 Vali Acc: 0.732 Test Loss: 0.689 Test Acc: 0.732
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3146679401397705
Epoch: 13, Steps: 13 | Train Loss: 0.248 Vali Loss: 0.701 Vali Acc: 0.737 Test Loss: 0.701 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.410830020904541
Epoch: 14, Steps: 13 | Train Loss: 0.240 Vali Loss: 0.752 Vali Acc: 0.732 Test Loss: 0.752 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 88774
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.103217601776123
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2506396770477295
Epoch: 2, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.2359938621520996
Epoch: 3, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.3671152591705322
Epoch: 4, Steps: 13 | Train Loss: 0.501 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.23099684715271
Epoch: 5, Steps: 13 | Train Loss: 0.452 Vali Loss: 0.579 Vali Acc: 0.751 Test Loss: 0.579 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.3911986351013184
Epoch: 6, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.549 Vali Acc: 0.751 Test Loss: 0.549 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.4234602451324463
Epoch: 7, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.626 Vali Acc: 0.751 Test Loss: 0.626 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.254464864730835
Epoch: 8, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 9 cost time: 1.2714221477508545
Epoch: 9, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.566 Vali Acc: 0.712 Test Loss: 0.566 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3434414863586426
Epoch: 10, Steps: 13 | Train Loss: 0.354 Vali Loss: 0.710 Vali Acc: 0.624 Test Loss: 0.710 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4784178733825684
Epoch: 11, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.601 Vali Acc: 0.688 Test Loss: 0.601 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4110238552093506
Epoch: 12, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.647 Vali Acc: 0.751 Test Loss: 0.647 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3186910152435303
Epoch: 13, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.665 Vali Acc: 0.746 Test Loss: 0.665 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2133815288543701
Epoch: 14, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.728 Vali Acc: 0.751 Test Loss: 0.728 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.258664608001709
Epoch: 15, Steps: 13 | Train Loss: 0.219 Vali Loss: 0.680 Vali Acc: 0.712 Test Loss: 0.680 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2460894584655762
Epoch: 16, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.704 Vali Acc: 0.678 Test Loss: 0.704 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3279814720153809
Epoch: 17, Steps: 13 | Train Loss: 0.161 Vali Loss: 0.735 Vali Acc: 0.678 Test Loss: 0.735 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2969615459442139
Epoch: 18, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.839 Vali Acc: 0.707 Test Loss: 0.839 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 88774
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.167233467102051
Epoch: 1, Steps: 13 | Train Loss: 0.645 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.0029668807983398
Epoch: 2, Steps: 13 | Train Loss: 0.570 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.189298391342163
Epoch: 3, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.613 Vali Acc: 0.737 Test Loss: 0.613 Test Acc: 0.737
Validation loss decreased (-0.717067 --> -0.736579).  Saving model ...
Epoch: 4 cost time: 1.1282775402069092
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.550 Vali Acc: 0.746 Test Loss: 0.550 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.0594847202301025
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.603 Vali Acc: 0.741 Test Loss: 0.603 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.192920446395874
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.538 Vali Acc: 0.751 Test Loss: 0.538 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.187307596206665
Epoch: 7, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.590 Vali Acc: 0.751 Test Loss: 0.590 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3374881744384766
Epoch: 8, Steps: 13 | Train Loss: 0.381 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.751214 --> -0.760970).  Saving model ...
Epoch: 9 cost time: 1.2012641429901123
Epoch: 9, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.524 Vali Acc: 0.732 Test Loss: 0.524 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.178579568862915
Epoch: 10, Steps: 13 | Train Loss: 0.366 Vali Loss: 0.602 Vali Acc: 0.702 Test Loss: 0.602 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0979828834533691
Epoch: 11, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1573636531829834
Epoch: 12, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.630 Vali Acc: 0.766 Test Loss: 0.630 Test Acc: 0.766
Validation loss decreased (-0.760970 --> -0.765847).  Saving model ...
Epoch: 13 cost time: 1.1385700702667236
Epoch: 13, Steps: 13 | Train Loss: 0.264 Vali Loss: 0.589 Vali Acc: 0.741 Test Loss: 0.589 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.204030990600586
Epoch: 14, Steps: 13 | Train Loss: 0.246 Vali Loss: 0.633 Vali Acc: 0.741 Test Loss: 0.633 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1886708736419678
Epoch: 15, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.727 Vali Acc: 0.746 Test Loss: 0.727 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1894822120666504
Epoch: 16, Steps: 13 | Train Loss: 0.185 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2311985492706299
Epoch: 17, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.686 Vali Acc: 0.678 Test Loss: 0.686 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2041511535644531
Epoch: 18, Steps: 13 | Train Loss: 0.132 Vali Loss: 0.717 Vali Acc: 0.707 Test Loss: 0.717 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2288873195648193
Epoch: 19, Steps: 13 | Train Loss: 0.100 Vali Loss: 0.830 Vali Acc: 0.717 Test Loss: 0.830 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1005408763885498
Epoch: 20, Steps: 13 | Train Loss: 0.085 Vali Loss: 0.878 Vali Acc: 0.727 Test Loss: 0.878 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1397504806518555
Epoch: 21, Steps: 13 | Train Loss: 0.060 Vali Loss: 0.957 Vali Acc: 0.732 Test Loss: 0.957 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2354185581207275
Epoch: 22, Steps: 13 | Train Loss: 0.052 Vali Loss: 1.053 Vali Acc: 0.693 Test Loss: 1.053 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 88774
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.211346387863159
Epoch: 1, Steps: 13 | Train Loss: 0.630 Vali Loss: 0.582 Vali Acc: 0.722 Test Loss: 0.582 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.181518793106079
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.580 Vali Acc: 0.717 Test Loss: 0.580 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1417975425720215
Epoch: 3, Steps: 13 | Train Loss: 0.564 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 4 cost time: 1.1163439750671387
Epoch: 4, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.564 Vali Acc: 0.746 Test Loss: 0.564 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746336).  Saving model ...
Epoch: 5 cost time: 1.0660851001739502
Epoch: 5, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.627 Vali Acc: 0.727 Test Loss: 0.627 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2046003341674805
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.561 Vali Acc: 0.746 Test Loss: 0.561 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.1123645305633545
Epoch: 7, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1245286464691162
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.557 Vali Acc: 0.741 Test Loss: 0.557 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1360461711883545
Epoch: 9, Steps: 13 | Train Loss: 0.427 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3193914890289307
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.730 Vali Acc: 0.644 Test Loss: 0.730 Test Acc: 0.644
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1238415241241455
Epoch: 11, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.576 Vali Acc: 0.702 Test Loss: 0.576 Test Acc: 0.702
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0802814960479736
Epoch: 12, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1925134658813477
Epoch: 13, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.600 Vali Acc: 0.732 Test Loss: 0.600 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1978347301483154
Epoch: 14, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.774 Vali Acc: 0.741 Test Loss: 0.774 Test Acc: 0.741
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1079213619232178
Epoch: 15, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.751 Vali Acc: 0.712 Test Loss: 0.751 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0634024143218994
Epoch: 16, Steps: 13 | Train Loss: 0.213 Vali Loss: 0.731 Vali Acc: 0.678 Test Loss: 0.731 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 88774
model size : 1.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.410531997680664
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.1624479293823242
Epoch: 2, Steps: 13 | Train Loss: 0.582 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.3014655113220215
Epoch: 3, Steps: 13 | Train Loss: 0.553 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.2724573612213135
Epoch: 4, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.582 Vali Acc: 0.727 Test Loss: 0.582 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 1.219731330871582
Epoch: 5, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.606 Vali Acc: 0.746 Test Loss: 0.606 Test Acc: 0.746
Validation loss decreased (-0.726823 --> -0.746335).  Saving model ...
Epoch: 6 cost time: 1.1740233898162842
Epoch: 6, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.584 Vali Acc: 0.732 Test Loss: 0.584 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3848917484283447
Epoch: 7, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.554 Vali Acc: 0.746 Test Loss: 0.554 Test Acc: 0.746
Validation loss decreased (-0.746335 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.1928133964538574
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.568 Vali Acc: 0.741 Test Loss: 0.568 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1362240314483643
Epoch: 9, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2060823440551758
Epoch: 10, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.583 Vali Acc: 0.751 Test Loss: 0.583 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 1.215324878692627
Epoch: 11, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.587 Vali Acc: 0.746 Test Loss: 0.587 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2633483409881592
Epoch: 12, Steps: 13 | Train Loss: 0.302 Vali Loss: 0.640 Vali Acc: 0.727 Test Loss: 0.640 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1530663967132568
Epoch: 13, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2793529033660889
Epoch: 14, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.643 Vali Acc: 0.732 Test Loss: 0.643 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.110591173171997
Epoch: 15, Steps: 13 | Train Loss: 0.237 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2450668811798096
Epoch: 16, Steps: 13 | Train Loss: 0.225 Vali Loss: 0.722 Vali Acc: 0.722 Test Loss: 0.722 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2547485828399658
Epoch: 17, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.735 Vali Acc: 0.732 Test Loss: 0.735 Test Acc: 0.732
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1609318256378174
Epoch: 18, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.754 Vali Acc: 0.693 Test Loss: 0.754 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1977331638336182
Epoch: 19, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.774 Vali Acc: 0.707 Test Loss: 0.774 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1324121952056885
Epoch: 20, Steps: 13 | Train Loss: 0.137 Vali Loss: 0.843 Vali Acc: 0.732 Test Loss: 0.843 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 169446
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3582687377929688
Epoch: 1, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.078456163406372
Epoch: 2, Steps: 13 | Train Loss: 0.590 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.1492815017700195
Epoch: 3, Steps: 13 | Train Loss: 0.551 Vali Loss: 0.584 Vali Acc: 0.722 Test Loss: 0.584 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.3029613494873047
Epoch: 4, Steps: 13 | Train Loss: 0.515 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.447866678237915
Epoch: 5, Steps: 13 | Train Loss: 0.496 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.2830922603607178
Epoch: 6, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.578 Vali Acc: 0.741 Test Loss: 0.578 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.1342012882232666
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.560 Vali Acc: 0.741 Test Loss: 0.560 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 8 cost time: 1.2067182064056396
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.583 Vali Acc: 0.746 Test Loss: 0.583 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746336).  Saving model ...
Epoch: 9 cost time: 1.0663251876831055
Epoch: 9, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.572 Vali Acc: 0.717 Test Loss: 0.572 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1896753311157227
Epoch: 10, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.093740701675415
Epoch: 11, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.576 Vali Acc: 0.717 Test Loss: 0.576 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.200425624847412
Epoch: 12, Steps: 13 | Train Loss: 0.331 Vali Loss: 0.630 Vali Acc: 0.746 Test Loss: 0.630 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2624695301055908
Epoch: 13, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1578466892242432
Epoch: 14, Steps: 13 | Train Loss: 0.285 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1553490161895752
Epoch: 15, Steps: 13 | Train Loss: 0.254 Vali Loss: 0.626 Vali Acc: 0.722 Test Loss: 0.626 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1371264457702637
Epoch: 16, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.651 Vali Acc: 0.707 Test Loss: 0.651 Test Acc: 0.707
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.191598653793335
Epoch: 17, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.682 Vali Acc: 0.722 Test Loss: 0.682 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1086673736572266
Epoch: 18, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.723 Vali Acc: 0.693 Test Loss: 0.723 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 169446
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.207475423812866
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.585 Vali Acc: 0.712 Test Loss: 0.585 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.338935375213623
Epoch: 2, Steps: 13 | Train Loss: 0.591 Vali Loss: 0.576 Vali Acc: 0.727 Test Loss: 0.576 Test Acc: 0.727
Validation loss decreased (-0.712189 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.1347877979278564
Epoch: 3, Steps: 13 | Train Loss: 0.561 Vali Loss: 0.578 Vali Acc: 0.722 Test Loss: 0.578 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3205511569976807
Epoch: 4, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.579 Vali Acc: 0.722 Test Loss: 0.579 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.184622049331665
Epoch: 5, Steps: 13 | Train Loss: 0.509 Vali Loss: 0.573 Vali Acc: 0.732 Test Loss: 0.573 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.2074661254882812
Epoch: 6, Steps: 13 | Train Loss: 0.480 Vali Loss: 0.570 Vali Acc: 0.746 Test Loss: 0.570 Test Acc: 0.746
Validation loss decreased (-0.731702 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.206669807434082
Epoch: 7, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.541 Vali Acc: 0.746 Test Loss: 0.541 Test Acc: 0.746
Validation loss decreased (-0.746336 --> -0.746336).  Saving model ...
Epoch: 8 cost time: 1.2109992504119873
Epoch: 8, Steps: 13 | Train Loss: 0.429 Vali Loss: 0.547 Vali Acc: 0.751 Test Loss: 0.547 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 1.260380744934082
Epoch: 9, Steps: 13 | Train Loss: 0.415 Vali Loss: 0.536 Vali Acc: 0.737 Test Loss: 0.536 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4406421184539795
Epoch: 10, Steps: 13 | Train Loss: 0.385 Vali Loss: 0.542 Vali Acc: 0.732 Test Loss: 0.542 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.191620111465454
Epoch: 11, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.551 Vali Acc: 0.746 Test Loss: 0.551 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.119220495223999
Epoch: 12, Steps: 13 | Train Loss: 0.344 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0916454792022705
Epoch: 13, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.546 Vali Acc: 0.766 Test Loss: 0.546 Test Acc: 0.766
Validation loss decreased (-0.751214 --> -0.765848).  Saving model ...
Epoch: 14 cost time: 1.1135189533233643
Epoch: 14, Steps: 13 | Train Loss: 0.308 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1146857738494873
Epoch: 15, Steps: 13 | Train Loss: 0.278 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.187572717666626
Epoch: 16, Steps: 13 | Train Loss: 0.252 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.123656988143921
Epoch: 17, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.652 Vali Acc: 0.741 Test Loss: 0.652 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1807754039764404
Epoch: 18, Steps: 13 | Train Loss: 0.207 Vali Loss: 0.649 Vali Acc: 0.707 Test Loss: 0.649 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.109445333480835
Epoch: 19, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.715 Vali Acc: 0.698 Test Loss: 0.715 Test Acc: 0.698
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1598055362701416
Epoch: 20, Steps: 13 | Train Loss: 0.164 Vali Loss: 0.794 Vali Acc: 0.707 Test Loss: 0.794 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2019281387329102
Epoch: 21, Steps: 13 | Train Loss: 0.169 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2116117477416992
Epoch: 22, Steps: 13 | Train Loss: 0.158 Vali Loss: 0.917 Vali Acc: 0.663 Test Loss: 0.917 Test Acc: 0.663
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2027223110198975
Epoch: 23, Steps: 13 | Train Loss: 0.134 Vali Loss: 0.946 Vali Acc: 0.668 Test Loss: 0.946 Test Acc: 0.668
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7658536585365854
model parameter : 169446
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1570940017700195
Epoch: 1, Steps: 13 | Train Loss: 0.595 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.224919080734253
Epoch: 2, Steps: 13 | Train Loss: 0.586 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
Validation loss decreased (-0.712189 --> -0.712189).  Saving model ...
Epoch: 3 cost time: 1.2752771377563477
Epoch: 3, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 1.1357924938201904
Epoch: 4, Steps: 13 | Train Loss: 0.539 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0722081661224365
Epoch: 5, Steps: 13 | Train Loss: 0.525 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 1.2075562477111816
Epoch: 6, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.620 Vali Acc: 0.712 Test Loss: 0.620 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1058309078216553
Epoch: 7, Steps: 13 | Train Loss: 0.470 Vali Loss: 0.595 Vali Acc: 0.712 Test Loss: 0.595 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1008234024047852
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.593 Vali Acc: 0.722 Test Loss: 0.593 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 9 cost time: 1.085878610610962
Epoch: 9, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 10 cost time: 1.0928857326507568
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.601 Vali Acc: 0.741 Test Loss: 0.601 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741457).  Saving model ...
Epoch: 11 cost time: 1.1417961120605469
Epoch: 11, Steps: 13 | Train Loss: 0.389 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0852854251861572
Epoch: 12, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.650 Vali Acc: 0.712 Test Loss: 0.650 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0725231170654297
Epoch: 13, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1761934757232666
Epoch: 14, Steps: 13 | Train Loss: 0.347 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2304401397705078
Epoch: 15, Steps: 13 | Train Loss: 0.304 Vali Loss: 0.683 Vali Acc: 0.727 Test Loss: 0.683 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0886971950531006
Epoch: 16, Steps: 13 | Train Loss: 0.277 Vali Loss: 0.735 Vali Acc: 0.712 Test Loss: 0.735 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1501102447509766
Epoch: 17, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.751 Vali Acc: 0.712 Test Loss: 0.751 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.118882417678833
Epoch: 18, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.808 Vali Acc: 0.712 Test Loss: 0.808 Test Acc: 0.712
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1605181694030762
Epoch: 19, Steps: 13 | Train Loss: 0.202 Vali Loss: 0.920 Vali Acc: 0.698 Test Loss: 0.920 Test Acc: 0.698
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0787460803985596
Epoch: 20, Steps: 13 | Train Loss: 0.173 Vali Loss: 0.972 Vali Acc: 0.712 Test Loss: 0.972 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 169446
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.14441180229187
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.1639153957366943
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.606 Vali Acc: 0.717 Test Loss: 0.606 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.0509159564971924
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.179856538772583
Epoch: 4, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.623 Vali Acc: 0.727 Test Loss: 0.623 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 0.9773433208465576
Epoch: 5, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.614 Vali Acc: 0.732 Test Loss: 0.614 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 1.0598089694976807
Epoch: 6, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 7 cost time: 1.2064013481140137
Epoch: 7, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
Validation loss decreased (-0.736579 --> -0.736579).  Saving model ...
Epoch: 8 cost time: 1.07832670211792
Epoch: 8, Steps: 13 | Train Loss: 0.394 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0880138874053955
Epoch: 9, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.575 Vali Acc: 0.727 Test Loss: 0.575 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0604231357574463
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.638 Vali Acc: 0.732 Test Loss: 0.638 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.052358865737915
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.575 Vali Acc: 0.746 Test Loss: 0.575 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746336).  Saving model ...
Epoch: 12 cost time: 1.0847487449645996
Epoch: 12, Steps: 13 | Train Loss: 0.313 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0939388275146484
Epoch: 13, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.621 Vali Acc: 0.732 Test Loss: 0.621 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1404063701629639
Epoch: 14, Steps: 13 | Train Loss: 0.261 Vali Loss: 0.643 Vali Acc: 0.741 Test Loss: 0.643 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1419646739959717
Epoch: 15, Steps: 13 | Train Loss: 0.259 Vali Loss: 0.668 Vali Acc: 0.707 Test Loss: 0.668 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1055402755737305
Epoch: 16, Steps: 13 | Train Loss: 0.239 Vali Loss: 0.723 Vali Acc: 0.698 Test Loss: 0.723 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1445188522338867
Epoch: 17, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.756 Vali Acc: 0.737 Test Loss: 0.756 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1427421569824219
Epoch: 18, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.703 Vali Acc: 0.737 Test Loss: 0.703 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.147174596786499
Epoch: 19, Steps: 13 | Train Loss: 0.171 Vali Loss: 0.774 Vali Acc: 0.698 Test Loss: 0.774 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2131729125976562
Epoch: 20, Steps: 13 | Train Loss: 0.174 Vali Loss: 0.803 Vali Acc: 0.737 Test Loss: 0.803 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.281914234161377
Epoch: 21, Steps: 13 | Train Loss: 0.163 Vali Loss: 0.835 Vali Acc: 0.712 Test Loss: 0.835 Test Acc: 0.712
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 103910
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.5979299545288086
Epoch: 1, Steps: 13 | Train Loss: 0.664 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.3203685283660889
Epoch: 2, Steps: 13 | Train Loss: 0.585 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (-0.712189 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.278613567352295
Epoch: 3, Steps: 13 | Train Loss: 0.558 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.286961555480957
Epoch: 4, Steps: 13 | Train Loss: 0.520 Vali Loss: 0.599 Vali Acc: 0.727 Test Loss: 0.599 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 5 cost time: 1.196131706237793
Epoch: 5, Steps: 13 | Train Loss: 0.498 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 6 cost time: 1.288907527923584
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 7 cost time: 1.2284126281738281
Epoch: 7, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2421395778656006
Epoch: 8, Steps: 13 | Train Loss: 0.404 Vali Loss: 0.563 Vali Acc: 0.727 Test Loss: 0.563 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.273033618927002
Epoch: 9, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.566 Vali Acc: 0.732 Test Loss: 0.566 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2777493000030518
Epoch: 10, Steps: 13 | Train Loss: 0.368 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1717476844787598
Epoch: 11, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.574 Vali Acc: 0.741 Test Loss: 0.574 Test Acc: 0.741
Validation loss decreased (-0.736579 --> -0.741458).  Saving model ...
Epoch: 12 cost time: 1.293210506439209
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.613 Vali Acc: 0.727 Test Loss: 0.613 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3962197303771973
Epoch: 13, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.602 Vali Acc: 0.722 Test Loss: 0.602 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3315114974975586
Epoch: 14, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.616 Vali Acc: 0.737 Test Loss: 0.616 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.227269172668457
Epoch: 15, Steps: 13 | Train Loss: 0.273 Vali Loss: 0.628 Vali Acc: 0.702 Test Loss: 0.628 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2197768688201904
Epoch: 16, Steps: 13 | Train Loss: 0.247 Vali Loss: 0.663 Vali Acc: 0.688 Test Loss: 0.663 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.244051456451416
Epoch: 17, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.684 Vali Acc: 0.722 Test Loss: 0.684 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.28080153465271
Epoch: 18, Steps: 13 | Train Loss: 0.226 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.214590311050415
Epoch: 19, Steps: 13 | Train Loss: 0.192 Vali Loss: 0.724 Vali Acc: 0.678 Test Loss: 0.724 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2318625450134277
Epoch: 20, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.767 Vali Acc: 0.712 Test Loss: 0.767 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2126569747924805
Epoch: 21, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.801 Vali Acc: 0.707 Test Loss: 0.801 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 103910
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3644001483917236
Epoch: 1, Steps: 13 | Train Loss: 0.659 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1915979385375977
Epoch: 2, Steps: 13 | Train Loss: 0.583 Vali Loss: 0.582 Vali Acc: 0.712 Test Loss: 0.582 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1560330390930176
Epoch: 3, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.578 Vali Acc: 0.717 Test Loss: 0.578 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2223711013793945
Epoch: 4, Steps: 13 | Train Loss: 0.522 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 5 cost time: 1.2723579406738281
Epoch: 5, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.580 Vali Acc: 0.732 Test Loss: 0.580 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731702).  Saving model ...
Epoch: 6 cost time: 1.1008579730987549
Epoch: 6, Steps: 13 | Train Loss: 0.473 Vali Loss: 0.563 Vali Acc: 0.741 Test Loss: 0.563 Test Acc: 0.741
Validation loss decreased (-0.731702 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.1395950317382812
Epoch: 7, Steps: 13 | Train Loss: 0.439 Vali Loss: 0.546 Vali Acc: 0.732 Test Loss: 0.546 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0802326202392578
Epoch: 8, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.532 Vali Acc: 0.727 Test Loss: 0.532 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0684707164764404
Epoch: 9, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.531 Vali Acc: 0.741 Test Loss: 0.531 Test Acc: 0.741
Validation loss decreased (-0.741458 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.0578975677490234
Epoch: 10, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.561 Vali Acc: 0.732 Test Loss: 0.561 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2654213905334473
Epoch: 11, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.534 Vali Acc: 0.761 Test Loss: 0.534 Test Acc: 0.761
Validation loss decreased (-0.741458 --> -0.760970).  Saving model ...
Epoch: 12 cost time: 1.1161048412322998
Epoch: 12, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.117518424987793
Epoch: 13, Steps: 13 | Train Loss: 0.346 Vali Loss: 0.558 Vali Acc: 0.751 Test Loss: 0.558 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1678369045257568
Epoch: 14, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.181459665298462
Epoch: 15, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.152498483657837
Epoch: 16, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.202939510345459
Epoch: 17, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3170888423919678
Epoch: 18, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.653 Vali Acc: 0.702 Test Loss: 0.653 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1991794109344482
Epoch: 19, Steps: 13 | Train Loss: 0.204 Vali Loss: 0.678 Vali Acc: 0.693 Test Loss: 0.678 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1134042739868164
Epoch: 20, Steps: 13 | Train Loss: 0.200 Vali Loss: 0.744 Vali Acc: 0.707 Test Loss: 0.744 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1689469814300537
Epoch: 21, Steps: 13 | Train Loss: 0.175 Vali Loss: 0.776 Vali Acc: 0.698 Test Loss: 0.776 Test Acc: 0.698
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7609756097560976
model parameter : 103910
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.252248525619507
Epoch: 1, Steps: 13 | Train Loss: 0.656 Vali Loss: 0.583 Vali Acc: 0.717 Test Loss: 0.583 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.381077527999878
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.580 Vali Acc: 0.712 Test Loss: 0.580 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1992545127868652
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.582 Vali Acc: 0.717 Test Loss: 0.582 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 1.2278902530670166
Epoch: 4, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.593 Vali Acc: 0.712 Test Loss: 0.593 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1676361560821533
Epoch: 5, Steps: 13 | Train Loss: 0.512 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (-0.717067 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 1.1358880996704102
Epoch: 6, Steps: 13 | Train Loss: 0.483 Vali Loss: 0.602 Vali Acc: 0.712 Test Loss: 0.602 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1073861122131348
Epoch: 7, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.083998680114746
Epoch: 8, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.595 Vali Acc: 0.732 Test Loss: 0.595 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 9 cost time: 1.1507980823516846
Epoch: 9, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.586 Vali Acc: 0.727 Test Loss: 0.586 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1718108654022217
Epoch: 10, Steps: 13 | Train Loss: 0.424 Vali Loss: 0.627 Vali Acc: 0.712 Test Loss: 0.627 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0968780517578125
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.609 Vali Acc: 0.727 Test Loss: 0.609 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1492905616760254
Epoch: 12, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.661 Vali Acc: 0.683 Test Loss: 0.661 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.223252773284912
Epoch: 13, Steps: 13 | Train Loss: 0.377 Vali Loss: 0.629 Vali Acc: 0.698 Test Loss: 0.629 Test Acc: 0.698
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1100928783416748
Epoch: 14, Steps: 13 | Train Loss: 0.325 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736579).  Saving model ...
Epoch: 15 cost time: 1.0949335098266602
Epoch: 15, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.660 Vali Acc: 0.702 Test Loss: 0.660 Test Acc: 0.702
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2650635242462158
Epoch: 16, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.715 Vali Acc: 0.702 Test Loss: 0.715 Test Acc: 0.702
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2866370677947998
Epoch: 17, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.725 Vali Acc: 0.707 Test Loss: 0.725 Test Acc: 0.707
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5165574550628662
Epoch: 18, Steps: 13 | Train Loss: 0.238 Vali Loss: 0.784 Vali Acc: 0.707 Test Loss: 0.784 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1337835788726807
Epoch: 19, Steps: 13 | Train Loss: 0.211 Vali Loss: 0.799 Vali Acc: 0.688 Test Loss: 0.799 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3719418048858643
Epoch: 20, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.787 Vali Acc: 0.702 Test Loss: 0.787 Test Acc: 0.702
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1492023468017578
Epoch: 21, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.882 Vali Acc: 0.707 Test Loss: 0.882 Test Acc: 0.707
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.082435131072998
Epoch: 22, Steps: 13 | Train Loss: 0.136 Vali Loss: 1.014 Vali Acc: 0.693 Test Loss: 1.014 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1354119777679443
Epoch: 23, Steps: 13 | Train Loss: 0.122 Vali Loss: 1.166 Vali Acc: 0.688 Test Loss: 1.166 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.135535478591919
Epoch: 24, Steps: 13 | Train Loss: 0.130 Vali Loss: 1.071 Vali Acc: 0.717 Test Loss: 1.071 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7365853658536585
model parameter : 103910
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.474551200866699
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.1979198455810547
Epoch: 2, Steps: 13 | Train Loss: 0.603 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.183769702911377
Epoch: 3, Steps: 13 | Train Loss: 0.529 Vali Loss: 0.592 Vali Acc: 0.717 Test Loss: 0.592 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1809446811676025
Epoch: 4, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.616 Vali Acc: 0.722 Test Loss: 0.616 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1163668632507324
Epoch: 5, Steps: 13 | Train Loss: 0.475 Vali Loss: 0.599 Vali Acc: 0.722 Test Loss: 0.599 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 6 cost time: 1.0982582569122314
Epoch: 6, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.603 Vali Acc: 0.727 Test Loss: 0.603 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 7 cost time: 1.0624816417694092
Epoch: 7, Steps: 13 | Train Loss: 0.435 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2203354835510254
Epoch: 8, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.016449213027954
Epoch: 9, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.026430606842041
Epoch: 10, Steps: 13 | Train Loss: 0.355 Vali Loss: 0.591 Vali Acc: 0.727 Test Loss: 0.591 Test Acc: 0.727
Validation loss decreased (-0.726823 --> -0.726823).  Saving model ...
Epoch: 11 cost time: 1.1372828483581543
Epoch: 11, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.644 Vali Acc: 0.727 Test Loss: 0.644 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1524555683135986
Epoch: 12, Steps: 13 | Train Loss: 0.301 Vali Loss: 0.642 Vali Acc: 0.737 Test Loss: 0.642 Test Acc: 0.737
Validation loss decreased (-0.726823 --> -0.736579).  Saving model ...
Epoch: 13 cost time: 1.274146556854248
Epoch: 13, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.667 Vali Acc: 0.727 Test Loss: 0.667 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2087514400482178
Epoch: 14, Steps: 13 | Train Loss: 0.255 Vali Loss: 0.692 Vali Acc: 0.737 Test Loss: 0.692 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.153069019317627
Epoch: 15, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0782604217529297
Epoch: 16, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1531157493591309
Epoch: 17, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.807 Vali Acc: 0.620 Test Loss: 0.807 Test Acc: 0.620
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1815173625946045
Epoch: 18, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.767 Vali Acc: 0.668 Test Loss: 0.767 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9891200065612793
Epoch: 19, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.895 Vali Acc: 0.737 Test Loss: 0.895 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1091761589050293
Epoch: 20, Steps: 13 | Train Loss: 0.144 Vali Loss: 0.843 Vali Acc: 0.693 Test Loss: 0.843 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1123194694519043
Epoch: 21, Steps: 13 | Train Loss: 0.133 Vali Loss: 0.856 Vali Acc: 0.717 Test Loss: 0.856 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1367607116699219
Epoch: 22, Steps: 13 | Train Loss: 0.120 Vali Loss: 0.925 Vali Acc: 0.746 Test Loss: 0.925 Test Acc: 0.746
Validation loss decreased (-0.736579 --> -0.746332).  Saving model ...
Epoch: 23 cost time: 1.0515458583831787
Epoch: 23, Steps: 13 | Train Loss: 0.117 Vali Loss: 1.019 Vali Acc: 0.663 Test Loss: 1.019 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1621372699737549
Epoch: 24, Steps: 13 | Train Loss: 0.123 Vali Loss: 1.139 Vali Acc: 0.712 Test Loss: 1.139 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1450526714324951
Epoch: 25, Steps: 13 | Train Loss: 0.090 Vali Loss: 1.135 Vali Acc: 0.741 Test Loss: 1.135 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2743926048278809
Epoch: 26, Steps: 13 | Train Loss: 0.080 Vali Loss: 1.165 Vali Acc: 0.678 Test Loss: 1.165 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2270684242248535
Epoch: 27, Steps: 13 | Train Loss: 0.083 Vali Loss: 1.050 Vali Acc: 0.678 Test Loss: 1.050 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.167323112487793
Epoch: 28, Steps: 13 | Train Loss: 0.072 Vali Loss: 1.147 Vali Acc: 0.668 Test Loss: 1.147 Test Acc: 0.668
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0983686447143555
Epoch: 29, Steps: 13 | Train Loss: 0.058 Vali Loss: 1.265 Vali Acc: 0.741 Test Loss: 1.265 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1436727046966553
Epoch: 30, Steps: 13 | Train Loss: 0.119 Vali Loss: 1.282 Vali Acc: 0.654 Test Loss: 1.282 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0801925659179688
Epoch: 31, Steps: 13 | Train Loss: 0.060 Vali Loss: 1.176 Vali Acc: 0.688 Test Loss: 1.176 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.3570332527160645
Epoch: 32, Steps: 13 | Train Loss: 0.042 Vali Loss: 1.275 Vali Acc: 0.732 Test Loss: 1.275 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 71142
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2866573333740234
Epoch: 1, Steps: 13 | Train Loss: 0.607 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.290855884552002
Epoch: 2, Steps: 13 | Train Loss: 0.597 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.057682752609253
Epoch: 3, Steps: 13 | Train Loss: 0.534 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.228708267211914
Epoch: 4, Steps: 13 | Train Loss: 0.506 Vali Loss: 0.604 Vali Acc: 0.717 Test Loss: 0.604 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0734174251556396
Epoch: 5, Steps: 13 | Train Loss: 0.484 Vali Loss: 0.589 Vali Acc: 0.732 Test Loss: 0.589 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 1.104123592376709
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.592 Vali Acc: 0.727 Test Loss: 0.592 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1279785633087158
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.565 Vali Acc: 0.717 Test Loss: 0.565 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1052517890930176
Epoch: 8, Steps: 13 | Train Loss: 0.405 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1267650127410889
Epoch: 9, Steps: 13 | Train Loss: 0.372 Vali Loss: 0.563 Vali Acc: 0.712 Test Loss: 0.563 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.253067970275879
Epoch: 10, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.574 Vali Acc: 0.717 Test Loss: 0.574 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.037877082824707
Epoch: 11, Steps: 13 | Train Loss: 0.330 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.0251972675323486
Epoch: 12, Steps: 13 | Train Loss: 0.314 Vali Loss: 0.600 Vali Acc: 0.741 Test Loss: 0.600 Test Acc: 0.741
Validation loss decreased (-0.731701 --> -0.741457).  Saving model ...
Epoch: 13 cost time: 1.0744056701660156
Epoch: 13, Steps: 13 | Train Loss: 0.283 Vali Loss: 0.610 Vali Acc: 0.741 Test Loss: 0.610 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1941592693328857
Epoch: 14, Steps: 13 | Train Loss: 0.268 Vali Loss: 0.633 Vali Acc: 0.712 Test Loss: 0.633 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0647740364074707
Epoch: 15, Steps: 13 | Train Loss: 0.245 Vali Loss: 0.647 Vali Acc: 0.717 Test Loss: 0.647 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2102940082550049
Epoch: 16, Steps: 13 | Train Loss: 0.287 Vali Loss: 0.672 Vali Acc: 0.722 Test Loss: 0.672 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2207105159759521
Epoch: 17, Steps: 13 | Train Loss: 0.234 Vali Loss: 0.733 Vali Acc: 0.649 Test Loss: 0.733 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.224576711654663
Epoch: 18, Steps: 13 | Train Loss: 0.196 Vali Loss: 0.740 Vali Acc: 0.678 Test Loss: 0.740 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1441118717193604
Epoch: 19, Steps: 13 | Train Loss: 0.190 Vali Loss: 0.840 Vali Acc: 0.722 Test Loss: 0.840 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3248028755187988
Epoch: 20, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.816 Vali Acc: 0.698 Test Loss: 0.816 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0888328552246094
Epoch: 21, Steps: 13 | Train Loss: 0.147 Vali Loss: 0.833 Vali Acc: 0.707 Test Loss: 0.833 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2820849418640137
Epoch: 22, Steps: 13 | Train Loss: 0.131 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 71142
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.25443696975708
Epoch: 1, Steps: 13 | Train Loss: 0.616 Vali Loss: 0.606 Vali Acc: 0.722 Test Loss: 0.606 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.298604965209961
Epoch: 2, Steps: 13 | Train Loss: 0.600 Vali Loss: 0.586 Vali Acc: 0.712 Test Loss: 0.586 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1689937114715576
Epoch: 3, Steps: 13 | Train Loss: 0.544 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2022535800933838
Epoch: 4, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736579).  Saving model ...
Epoch: 5 cost time: 1.1492116451263428
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.571 Vali Acc: 0.717 Test Loss: 0.571 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0818753242492676
Epoch: 6, Steps: 13 | Train Loss: 0.465 Vali Loss: 0.573 Vali Acc: 0.727 Test Loss: 0.573 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0961811542510986
Epoch: 7, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.555 Vali Acc: 0.722 Test Loss: 0.555 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1649162769317627
Epoch: 8, Steps: 13 | Train Loss: 0.425 Vali Loss: 0.549 Vali Acc: 0.712 Test Loss: 0.549 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.086524486541748
Epoch: 9, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.541 Vali Acc: 0.727 Test Loss: 0.541 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0400002002716064
Epoch: 10, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.537 Vali Acc: 0.751 Test Loss: 0.537 Test Acc: 0.751
Validation loss decreased (-0.736579 --> -0.751214).  Saving model ...
Epoch: 11 cost time: 1.055509090423584
Epoch: 11, Steps: 13 | Train Loss: 0.356 Vali Loss: 0.551 Vali Acc: 0.741 Test Loss: 0.551 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.305048942565918
Epoch: 12, Steps: 13 | Train Loss: 0.333 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2057304382324219
Epoch: 13, Steps: 13 | Train Loss: 0.305 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0583593845367432
Epoch: 14, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.575 Vali Acc: 0.741 Test Loss: 0.575 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0460474491119385
Epoch: 15, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1171865463256836
Epoch: 16, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.624 Vali Acc: 0.722 Test Loss: 0.624 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.186349868774414
Epoch: 17, Steps: 13 | Train Loss: 0.250 Vali Loss: 0.704 Vali Acc: 0.663 Test Loss: 0.704 Test Acc: 0.663
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1647169589996338
Epoch: 18, Steps: 13 | Train Loss: 0.208 Vali Loss: 0.689 Vali Acc: 0.678 Test Loss: 0.689 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1114568710327148
Epoch: 19, Steps: 13 | Train Loss: 0.203 Vali Loss: 0.756 Vali Acc: 0.707 Test Loss: 0.756 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1519660949707031
Epoch: 20, Steps: 13 | Train Loss: 0.165 Vali Loss: 0.815 Vali Acc: 0.659 Test Loss: 0.815 Test Acc: 0.659
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 71142
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1042213439941406
Epoch: 1, Steps: 13 | Train Loss: 0.623 Vali Loss: 0.597 Vali Acc: 0.722 Test Loss: 0.597 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.089907169342041
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.091944694519043
Epoch: 3, Steps: 13 | Train Loss: 0.559 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.978172779083252
Epoch: 4, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.615 Vali Acc: 0.712 Test Loss: 0.615 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1667354106903076
Epoch: 5, Steps: 13 | Train Loss: 0.517 Vali Loss: 0.610 Vali Acc: 0.707 Test Loss: 0.610 Test Acc: 0.707
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0856773853302002
Epoch: 6, Steps: 13 | Train Loss: 0.488 Vali Loss: 0.606 Vali Acc: 0.707 Test Loss: 0.606 Test Acc: 0.707
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.15116286277771
Epoch: 7, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.613 Vali Acc: 0.722 Test Loss: 0.613 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1963787078857422
Epoch: 8, Steps: 13 | Train Loss: 0.440 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0520048141479492
Epoch: 9, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0665278434753418
Epoch: 10, Steps: 13 | Train Loss: 0.399 Vali Loss: 0.617 Vali Acc: 0.717 Test Loss: 0.617 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2309136390686035
Epoch: 11, Steps: 13 | Train Loss: 0.386 Vali Loss: 0.672 Vali Acc: 0.693 Test Loss: 0.672 Test Acc: 0.693
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 71142
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.870326280593872
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3533694744110107
Epoch: 2, Steps: 13 | Train Loss: 0.572 Vali Loss: 0.595 Vali Acc: 0.722 Test Loss: 0.595 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3727986812591553
Epoch: 3, Steps: 13 | Train Loss: 0.557 Vali Loss: 0.558 Vali Acc: 0.722 Test Loss: 0.558 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.1951913833618164
Epoch: 4, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
Validation loss decreased (-0.721946 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.2096586227416992
Epoch: 5, Steps: 13 | Train Loss: 0.495 Vali Loss: 0.566 Vali Acc: 0.727 Test Loss: 0.566 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 6 cost time: 1.105907917022705
Epoch: 6, Steps: 13 | Train Loss: 0.444 Vali Loss: 0.544 Vali Acc: 0.751 Test Loss: 0.544 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.2727148532867432
Epoch: 7, Steps: 13 | Train Loss: 0.428 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.751214 --> -0.756092).  Saving model ...
Epoch: 8 cost time: 1.232712745666504
Epoch: 8, Steps: 13 | Train Loss: 0.407 Vali Loss: 0.539 Vali Acc: 0.746 Test Loss: 0.539 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1762804985046387
Epoch: 9, Steps: 13 | Train Loss: 0.397 Vali Loss: 0.565 Vali Acc: 0.732 Test Loss: 0.565 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5521345138549805
Epoch: 10, Steps: 13 | Train Loss: 0.371 Vali Loss: 0.598 Vali Acc: 0.732 Test Loss: 0.598 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3226268291473389
Epoch: 11, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.294637680053711
Epoch: 12, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.599 Vali Acc: 0.727 Test Loss: 0.599 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4071435928344727
Epoch: 13, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.659 Vali Acc: 0.727 Test Loss: 0.659 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4688599109649658
Epoch: 14, Steps: 13 | Train Loss: 0.289 Vali Loss: 0.609 Vali Acc: 0.722 Test Loss: 0.609 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2979552745819092
Epoch: 15, Steps: 13 | Train Loss: 0.242 Vali Loss: 0.669 Vali Acc: 0.737 Test Loss: 0.669 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.17061185836792
Epoch: 16, Steps: 13 | Train Loss: 0.231 Vali Loss: 0.643 Vali Acc: 0.712 Test Loss: 0.643 Test Acc: 0.712
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1885709762573242
Epoch: 17, Steps: 13 | Train Loss: 0.228 Vali Loss: 0.715 Vali Acc: 0.717 Test Loss: 0.715 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7560975609756098
model parameter : 54758
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3213798999786377
Epoch: 1, Steps: 13 | Train Loss: 0.648 Vali Loss: 0.580 Vali Acc: 0.722 Test Loss: 0.580 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2294623851776123
Epoch: 2, Steps: 13 | Train Loss: 0.567 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.185351848602295
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.562 Vali Acc: 0.727 Test Loss: 0.562 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726824).  Saving model ...
Epoch: 4 cost time: 1.2051959037780762
Epoch: 4, Steps: 13 | Train Loss: 0.514 Vali Loss: 0.568 Vali Acc: 0.732 Test Loss: 0.568 Test Acc: 0.732
Validation loss decreased (-0.726824 --> -0.731702).  Saving model ...
Epoch: 5 cost time: 1.0776629447937012
Epoch: 5, Steps: 13 | Train Loss: 0.497 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.067950963973999
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.556 Vali Acc: 0.741 Test Loss: 0.556 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 7 cost time: 1.1357159614562988
Epoch: 7, Steps: 13 | Train Loss: 0.432 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1836903095245361
Epoch: 8, Steps: 13 | Train Loss: 0.413 Vali Loss: 0.551 Vali Acc: 0.732 Test Loss: 0.551 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1746618747711182
Epoch: 9, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.574 Vali Acc: 0.712 Test Loss: 0.574 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0927212238311768
Epoch: 10, Steps: 13 | Train Loss: 0.380 Vali Loss: 0.597 Vali Acc: 0.717 Test Loss: 0.597 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0581231117248535
Epoch: 11, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2429640293121338
Epoch: 12, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2993221282958984
Epoch: 13, Steps: 13 | Train Loss: 0.298 Vali Loss: 0.635 Vali Acc: 0.698 Test Loss: 0.635 Test Acc: 0.698
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1166093349456787
Epoch: 14, Steps: 13 | Train Loss: 0.295 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1279938220977783
Epoch: 15, Steps: 13 | Train Loss: 0.258 Vali Loss: 0.661 Vali Acc: 0.727 Test Loss: 0.661 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1021356582641602
Epoch: 16, Steps: 13 | Train Loss: 0.243 Vali Loss: 0.640 Vali Acc: 0.727 Test Loss: 0.640 Test Acc: 0.727
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 54758
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.354853630065918
Epoch: 1, Steps: 13 | Train Loss: 0.638 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.3201830387115479
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3801918029785156
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.570 Vali Acc: 0.717 Test Loss: 0.570 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1456589698791504
Epoch: 4, Steps: 13 | Train Loss: 0.518 Vali Loss: 0.577 Vali Acc: 0.741 Test Loss: 0.577 Test Acc: 0.741
Validation loss decreased (-0.721945 --> -0.741458).  Saving model ...
Epoch: 5 cost time: 1.2036552429199219
Epoch: 5, Steps: 13 | Train Loss: 0.510 Vali Loss: 0.570 Vali Acc: 0.727 Test Loss: 0.570 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.219757080078125
Epoch: 6, Steps: 13 | Train Loss: 0.461 Vali Loss: 0.551 Vali Acc: 0.751 Test Loss: 0.551 Test Acc: 0.751
Validation loss decreased (-0.741458 --> -0.751214).  Saving model ...
Epoch: 7 cost time: 1.3615739345550537
Epoch: 7, Steps: 13 | Train Loss: 0.445 Vali Loss: 0.544 Vali Acc: 0.746 Test Loss: 0.544 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2985804080963135
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.535 Vali Acc: 0.741 Test Loss: 0.535 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.217721939086914
Epoch: 9, Steps: 13 | Train Loss: 0.426 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1584906578063965
Epoch: 10, Steps: 13 | Train Loss: 0.393 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.977419376373291
Epoch: 11, Steps: 13 | Train Loss: 0.362 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1796045303344727
Epoch: 12, Steps: 13 | Train Loss: 0.370 Vali Loss: 0.587 Vali Acc: 0.707 Test Loss: 0.587 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5988285541534424
Epoch: 13, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2922418117523193
Epoch: 14, Steps: 13 | Train Loss: 0.324 Vali Loss: 0.562 Vali Acc: 0.746 Test Loss: 0.562 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2614548206329346
Epoch: 15, Steps: 13 | Train Loss: 0.290 Vali Loss: 0.665 Vali Acc: 0.741 Test Loss: 0.665 Test Acc: 0.741
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4121501445770264
Epoch: 16, Steps: 13 | Train Loss: 0.265 Vali Loss: 0.607 Vali Acc: 0.732 Test Loss: 0.607 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 54758
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.408492088317871
Epoch: 1, Steps: 13 | Train Loss: 0.632 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
Validation loss decreased (inf --> -0.712189).  Saving model ...
Epoch: 2 cost time: 1.0117487907409668
Epoch: 2, Steps: 13 | Train Loss: 0.563 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
Validation loss decreased (-0.712189 --> -0.717067).  Saving model ...
Epoch: 3 cost time: 1.1641480922698975
Epoch: 3, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.578 Vali Acc: 0.712 Test Loss: 0.578 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0863282680511475
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.584 Vali Acc: 0.712 Test Loss: 0.584 Test Acc: 0.712
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.056368112564087
Epoch: 5, Steps: 13 | Train Loss: 0.524 Vali Loss: 0.587 Vali Acc: 0.712 Test Loss: 0.587 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1834931373596191
Epoch: 6, Steps: 13 | Train Loss: 0.481 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2166948318481445
Epoch: 7, Steps: 13 | Train Loss: 0.466 Vali Loss: 0.585 Vali Acc: 0.727 Test Loss: 0.585 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726823).  Saving model ...
Epoch: 8 cost time: 1.0853302478790283
Epoch: 8, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
Validation loss decreased (-0.726823 --> -0.731701).  Saving model ...
Epoch: 9 cost time: 1.1898512840270996
Epoch: 9, Steps: 13 | Train Loss: 0.454 Vali Loss: 0.606 Vali Acc: 0.732 Test Loss: 0.606 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1128220558166504
Epoch: 10, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.647 Vali Acc: 0.722 Test Loss: 0.647 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1362385749816895
Epoch: 11, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.059004783630371
Epoch: 12, Steps: 13 | Train Loss: 0.379 Vali Loss: 0.652 Vali Acc: 0.712 Test Loss: 0.652 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0465164184570312
Epoch: 13, Steps: 13 | Train Loss: 0.364 Vali Loss: 0.686 Vali Acc: 0.693 Test Loss: 0.686 Test Acc: 0.693
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.13655424118042
Epoch: 14, Steps: 13 | Train Loss: 0.345 Vali Loss: 0.677 Vali Acc: 0.712 Test Loss: 0.677 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1194188594818115
Epoch: 15, Steps: 13 | Train Loss: 0.312 Vali Loss: 0.731 Vali Acc: 0.717 Test Loss: 0.731 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.071706771850586
Epoch: 16, Steps: 13 | Train Loss: 0.292 Vali Loss: 0.680 Vali Acc: 0.702 Test Loss: 0.680 Test Acc: 0.702
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9975042343139648
Epoch: 17, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.715 Vali Acc: 0.722 Test Loss: 0.715 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1381139755249023
Epoch: 18, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.776 Vali Acc: 0.707 Test Loss: 0.776 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7317073170731707
model parameter : 54758
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.2646334171295166
Epoch: 1, Steps: 13 | Train Loss: 0.658 Vali Loss: 0.586 Vali Acc: 0.722 Test Loss: 0.586 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.066772222518921
Epoch: 2, Steps: 13 | Train Loss: 0.577 Vali Loss: 0.574 Vali Acc: 0.732 Test Loss: 0.574 Test Acc: 0.732
Validation loss decreased (-0.721945 --> -0.731702).  Saving model ...
Epoch: 3 cost time: 0.9287614822387695
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0421593189239502
Epoch: 4, Steps: 13 | Train Loss: 0.536 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0284698009490967
Epoch: 5, Steps: 13 | Train Loss: 0.491 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
Validation loss decreased (-0.731702 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.1655573844909668
Epoch: 6, Steps: 13 | Train Loss: 0.459 Vali Loss: 0.555 Vali Acc: 0.727 Test Loss: 0.555 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1148369312286377
Epoch: 7, Steps: 13 | Train Loss: 0.422 Vali Loss: 0.547 Vali Acc: 0.732 Test Loss: 0.547 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2164056301116943
Epoch: 8, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.588 Vali Acc: 0.741 Test Loss: 0.588 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 9 cost time: 1.0733439922332764
Epoch: 9, Steps: 13 | Train Loss: 0.373 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2529149055480957
Epoch: 10, Steps: 13 | Train Loss: 0.353 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1076853275299072
Epoch: 11, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.116835594177246
Epoch: 12, Steps: 13 | Train Loss: 0.320 Vali Loss: 0.649 Vali Acc: 0.746 Test Loss: 0.649 Test Acc: 0.746
Validation loss decreased (-0.741458 --> -0.746335).  Saving model ...
Epoch: 13 cost time: 1.0823752880096436
Epoch: 13, Steps: 13 | Train Loss: 0.296 Vali Loss: 0.649 Vali Acc: 0.712 Test Loss: 0.649 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0996975898742676
Epoch: 14, Steps: 13 | Train Loss: 0.270 Vali Loss: 0.632 Vali Acc: 0.727 Test Loss: 0.632 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1163945198059082
Epoch: 15, Steps: 13 | Train Loss: 0.249 Vali Loss: 0.629 Vali Acc: 0.727 Test Loss: 0.629 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0871632099151611
Epoch: 16, Steps: 13 | Train Loss: 0.232 Vali Loss: 0.679 Vali Acc: 0.712 Test Loss: 0.679 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0827968120574951
Epoch: 17, Steps: 13 | Train Loss: 0.191 Vali Loss: 0.709 Vali Acc: 0.722 Test Loss: 0.709 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2215402126312256
Epoch: 18, Steps: 13 | Train Loss: 0.183 Vali Loss: 0.762 Vali Acc: 0.683 Test Loss: 0.762 Test Acc: 0.683
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0295405387878418
Epoch: 19, Steps: 13 | Train Loss: 0.180 Vali Loss: 0.937 Vali Acc: 0.741 Test Loss: 0.937 Test Acc: 0.741
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0662736892700195
Epoch: 20, Steps: 13 | Train Loss: 0.154 Vali Loss: 0.839 Vali Acc: 0.722 Test Loss: 0.839 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1909904479980469
Epoch: 21, Steps: 13 | Train Loss: 0.139 Vali Loss: 0.863 Vali Acc: 0.683 Test Loss: 0.863 Test Acc: 0.683
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0676064491271973
Epoch: 22, Steps: 13 | Train Loss: 0.127 Vali Loss: 0.893 Vali Acc: 0.707 Test Loss: 0.893 Test Acc: 0.707
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7463414634146341
model parameter : 46566
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.289719343185425
Epoch: 1, Steps: 13 | Train Loss: 0.655 Vali Loss: 0.588 Vali Acc: 0.722 Test Loss: 0.588 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.146913766860962
Epoch: 2, Steps: 13 | Train Loss: 0.573 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.2511508464813232
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.575 Vali Acc: 0.722 Test Loss: 0.575 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2384157180786133
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3503718376159668
Epoch: 5, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.571 Vali Acc: 0.741 Test Loss: 0.571 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 6 cost time: 1.2692766189575195
Epoch: 6, Steps: 13 | Train Loss: 0.467 Vali Loss: 0.563 Vali Acc: 0.732 Test Loss: 0.563 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3395047187805176
Epoch: 7, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2421042919158936
Epoch: 8, Steps: 13 | Train Loss: 0.421 Vali Loss: 0.592 Vali Acc: 0.741 Test Loss: 0.592 Test Acc: 0.741
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2116496562957764
Epoch: 9, Steps: 13 | Train Loss: 0.383 Vali Loss: 0.558 Vali Acc: 0.717 Test Loss: 0.558 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.143129825592041
Epoch: 10, Steps: 13 | Train Loss: 0.367 Vali Loss: 0.584 Vali Acc: 0.717 Test Loss: 0.584 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2762820720672607
Epoch: 11, Steps: 13 | Train Loss: 0.340 Vali Loss: 0.590 Vali Acc: 0.722 Test Loss: 0.590 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.194119930267334
Epoch: 12, Steps: 13 | Train Loss: 0.326 Vali Loss: 0.623 Vali Acc: 0.702 Test Loss: 0.623 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2075583934783936
Epoch: 13, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.608 Vali Acc: 0.727 Test Loss: 0.608 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5029327869415283
Epoch: 14, Steps: 13 | Train Loss: 0.300 Vali Loss: 0.622 Vali Acc: 0.702 Test Loss: 0.622 Test Acc: 0.702
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.302577018737793
Epoch: 15, Steps: 13 | Train Loss: 0.267 Vali Loss: 0.623 Vali Acc: 0.732 Test Loss: 0.623 Test Acc: 0.732
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 46566
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1889193058013916
Epoch: 1, Steps: 13 | Train Loss: 0.650 Vali Loss: 0.589 Vali Acc: 0.722 Test Loss: 0.589 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.123140573501587
Epoch: 2, Steps: 13 | Train Loss: 0.579 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
Validation loss decreased (-0.721945 --> -0.736580).  Saving model ...
Epoch: 3 cost time: 1.2968695163726807
Epoch: 3, Steps: 13 | Train Loss: 0.547 Vali Loss: 0.569 Vali Acc: 0.727 Test Loss: 0.569 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1330411434173584
Epoch: 4, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.576 Vali Acc: 0.737 Test Loss: 0.576 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.279376745223999
Epoch: 5, Steps: 13 | Train Loss: 0.504 Vali Loss: 0.564 Vali Acc: 0.737 Test Loss: 0.564 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 6 cost time: 1.304633378982544
Epoch: 6, Steps: 13 | Train Loss: 0.474 Vali Loss: 0.549 Vali Acc: 0.746 Test Loss: 0.549 Test Acc: 0.746
Validation loss decreased (-0.736580 --> -0.746336).  Saving model ...
Epoch: 7 cost time: 1.1459624767303467
Epoch: 7, Steps: 13 | Train Loss: 0.442 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1894190311431885
Epoch: 8, Steps: 13 | Train Loss: 0.434 Vali Loss: 0.562 Vali Acc: 0.751 Test Loss: 0.562 Test Acc: 0.751
Validation loss decreased (-0.746336 --> -0.751214).  Saving model ...
Epoch: 9 cost time: 1.3279197216033936
Epoch: 9, Steps: 13 | Train Loss: 0.398 Vali Loss: 0.538 Vali Acc: 0.741 Test Loss: 0.538 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1563143730163574
Epoch: 10, Steps: 13 | Train Loss: 0.378 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1391785144805908
Epoch: 11, Steps: 13 | Train Loss: 0.358 Vali Loss: 0.552 Vali Acc: 0.746 Test Loss: 0.552 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4570679664611816
Epoch: 12, Steps: 13 | Train Loss: 0.351 Vali Loss: 0.571 Vali Acc: 0.732 Test Loss: 0.571 Test Acc: 0.732
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3338651657104492
Epoch: 13, Steps: 13 | Train Loss: 0.329 Vali Loss: 0.554 Vali Acc: 0.751 Test Loss: 0.554 Test Acc: 0.751
Validation loss decreased (-0.751214 --> -0.751214).  Saving model ...
Epoch: 14 cost time: 1.3538665771484375
Epoch: 14, Steps: 13 | Train Loss: 0.293 Vali Loss: 0.582 Vali Acc: 0.732 Test Loss: 0.582 Test Acc: 0.732
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2667415142059326
Epoch: 15, Steps: 13 | Train Loss: 0.274 Vali Loss: 0.606 Vali Acc: 0.727 Test Loss: 0.606 Test Acc: 0.727
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3936588764190674
Epoch: 16, Steps: 13 | Train Loss: 0.266 Vali Loss: 0.642 Vali Acc: 0.702 Test Loss: 0.642 Test Acc: 0.702
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2577898502349854
Epoch: 17, Steps: 13 | Train Loss: 0.241 Vali Loss: 0.677 Vali Acc: 0.702 Test Loss: 0.677 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.261584758758545
Epoch: 18, Steps: 13 | Train Loss: 0.223 Vali Loss: 0.733 Vali Acc: 0.683 Test Loss: 0.733 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2472445964813232
Epoch: 19, Steps: 13 | Train Loss: 0.215 Vali Loss: 0.868 Vali Acc: 0.727 Test Loss: 0.868 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4857861995697021
Epoch: 20, Steps: 13 | Train Loss: 0.184 Vali Loss: 0.824 Vali Acc: 0.702 Test Loss: 0.824 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2728354930877686
Epoch: 21, Steps: 13 | Train Loss: 0.155 Vali Loss: 0.954 Vali Acc: 0.654 Test Loss: 0.954 Test Acc: 0.654
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3958804607391357
Epoch: 22, Steps: 13 | Train Loss: 0.148 Vali Loss: 0.949 Vali Acc: 0.673 Test Loss: 0.949 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2516536712646484
Epoch: 23, Steps: 13 | Train Loss: 0.200 Vali Loss: 1.015 Vali Acc: 0.688 Test Loss: 1.015 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 46566
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.291080951690674
Epoch: 1, Steps: 13 | Train Loss: 0.661 Vali Loss: 0.592 Vali Acc: 0.722 Test Loss: 0.592 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2537941932678223
Epoch: 2, Steps: 13 | Train Loss: 0.596 Vali Loss: 0.579 Vali Acc: 0.717 Test Loss: 0.579 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1299858093261719
Epoch: 3, Steps: 13 | Train Loss: 0.556 Vali Loss: 0.577 Vali Acc: 0.722 Test Loss: 0.577 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 4 cost time: 1.0760526657104492
Epoch: 4, Steps: 13 | Train Loss: 0.552 Vali Loss: 0.587 Vali Acc: 0.722 Test Loss: 0.587 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0714411735534668
Epoch: 5, Steps: 13 | Train Loss: 0.513 Vali Loss: 0.588 Vali Acc: 0.717 Test Loss: 0.588 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.141315221786499
Epoch: 6, Steps: 13 | Train Loss: 0.492 Vali Loss: 0.587 Vali Acc: 0.717 Test Loss: 0.587 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1682536602020264
Epoch: 7, Steps: 13 | Train Loss: 0.464 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1050596237182617
Epoch: 8, Steps: 13 | Train Loss: 0.453 Vali Loss: 0.615 Vali Acc: 0.722 Test Loss: 0.615 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2796130180358887
Epoch: 9, Steps: 13 | Train Loss: 0.420 Vali Loss: 0.598 Vali Acc: 0.722 Test Loss: 0.598 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.24477219581604
Epoch: 10, Steps: 13 | Train Loss: 0.412 Vali Loss: 0.625 Vali Acc: 0.727 Test Loss: 0.625 Test Acc: 0.727
Validation loss decreased (-0.721945 --> -0.726823).  Saving model ...
Epoch: 11 cost time: 1.144906759262085
Epoch: 11, Steps: 13 | Train Loss: 0.388 Vali Loss: 0.631 Vali Acc: 0.712 Test Loss: 0.631 Test Acc: 0.712
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1443140506744385
Epoch: 12, Steps: 13 | Train Loss: 0.384 Vali Loss: 0.666 Vali Acc: 0.663 Test Loss: 0.666 Test Acc: 0.663
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.158508062362671
Epoch: 13, Steps: 13 | Train Loss: 0.361 Vali Loss: 0.647 Vali Acc: 0.712 Test Loss: 0.647 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.113755702972412
Epoch: 14, Steps: 13 | Train Loss: 0.332 Vali Loss: 0.688 Vali Acc: 0.702 Test Loss: 0.688 Test Acc: 0.702
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.117475986480713
Epoch: 15, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.724 Vali Acc: 0.683 Test Loss: 0.724 Test Acc: 0.683
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1172237396240234
Epoch: 16, Steps: 13 | Train Loss: 0.294 Vali Loss: 0.748 Vali Acc: 0.678 Test Loss: 0.748 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2438545227050781
Epoch: 17, Steps: 13 | Train Loss: 0.262 Vali Loss: 0.724 Vali Acc: 0.712 Test Loss: 0.724 Test Acc: 0.712
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1602487564086914
Epoch: 18, Steps: 13 | Train Loss: 0.221 Vali Loss: 0.753 Vali Acc: 0.698 Test Loss: 0.753 Test Acc: 0.698
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.252662181854248
Epoch: 19, Steps: 13 | Train Loss: 0.229 Vali Loss: 0.890 Vali Acc: 0.727 Test Loss: 0.890 Test Acc: 0.727
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3129208087921143
Epoch: 20, Steps: 13 | Train Loss: 0.171 Vali Loss: 1.074 Vali Acc: 0.688 Test Loss: 1.074 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7268292682926829
model parameter : 46566
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.315920114517212
Epoch: 1, Steps: 13 | Train Loss: 0.618 Vali Loss: 0.590 Vali Acc: 0.717 Test Loss: 0.590 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.2445309162139893
Epoch: 2, Steps: 13 | Train Loss: 0.568 Vali Loss: 0.594 Vali Acc: 0.717 Test Loss: 0.594 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.187394618988037
Epoch: 3, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.581 Vali Acc: 0.717 Test Loss: 0.581 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 4 cost time: 1.1985142230987549
Epoch: 4, Steps: 13 | Train Loss: 0.507 Vali Loss: 0.575 Vali Acc: 0.717 Test Loss: 0.575 Test Acc: 0.717
Validation loss decreased (-0.717067 --> -0.717067).  Saving model ...
Epoch: 5 cost time: 1.0729260444641113
Epoch: 5, Steps: 13 | Train Loss: 0.485 Vali Loss: 0.597 Vali Acc: 0.732 Test Loss: 0.597 Test Acc: 0.732
Validation loss decreased (-0.717067 --> -0.731701).  Saving model ...
Epoch: 6 cost time: 1.0828890800476074
Epoch: 6, Steps: 13 | Train Loss: 0.449 Vali Loss: 0.590 Vali Acc: 0.732 Test Loss: 0.590 Test Acc: 0.732
Validation loss decreased (-0.731701 --> -0.731701).  Saving model ...
Epoch: 7 cost time: 1.0560216903686523
Epoch: 7, Steps: 13 | Train Loss: 0.411 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (-0.731701 --> -0.736580).  Saving model ...
Epoch: 8 cost time: 1.1961050033569336
Epoch: 8, Steps: 13 | Train Loss: 0.406 Vali Loss: 0.611 Vali Acc: 0.727 Test Loss: 0.611 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.01578950881958
Epoch: 9, Steps: 13 | Train Loss: 0.391 Vali Loss: 0.591 Vali Acc: 0.741 Test Loss: 0.591 Test Acc: 0.741
Validation loss decreased (-0.736580 --> -0.741458).  Saving model ...
Epoch: 10 cost time: 1.1926686763763428
Epoch: 10, Steps: 13 | Train Loss: 0.348 Vali Loss: 0.631 Vali Acc: 0.722 Test Loss: 0.631 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1681187152862549
Epoch: 11, Steps: 13 | Train Loss: 0.328 Vali Loss: 0.594 Vali Acc: 0.722 Test Loss: 0.594 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1892130374908447
Epoch: 12, Steps: 13 | Train Loss: 0.315 Vali Loss: 0.626 Vali Acc: 0.717 Test Loss: 0.626 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2107927799224854
Epoch: 13, Steps: 13 | Train Loss: 0.275 Vali Loss: 0.617 Vali Acc: 0.722 Test Loss: 0.617 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1384692192077637
Epoch: 14, Steps: 13 | Train Loss: 0.271 Vali Loss: 0.686 Vali Acc: 0.727 Test Loss: 0.686 Test Acc: 0.727
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2295644283294678
Epoch: 15, Steps: 13 | Train Loss: 0.236 Vali Loss: 0.726 Vali Acc: 0.707 Test Loss: 0.726 Test Acc: 0.707
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1988880634307861
Epoch: 16, Steps: 13 | Train Loss: 0.218 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1724903583526611
Epoch: 17, Steps: 13 | Train Loss: 0.193 Vali Loss: 0.727 Vali Acc: 0.727 Test Loss: 0.727 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1381580829620361
Epoch: 18, Steps: 13 | Train Loss: 0.187 Vali Loss: 0.799 Vali Acc: 0.673 Test Loss: 0.799 Test Acc: 0.673
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1525094509124756
Epoch: 19, Steps: 13 | Train Loss: 0.168 Vali Loss: 0.789 Vali Acc: 0.678 Test Loss: 0.789 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7414634146341463
model parameter : 42470
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.1543338298797607
Epoch: 1, Steps: 13 | Train Loss: 0.629 Vali Loss: 0.586 Vali Acc: 0.717 Test Loss: 0.586 Test Acc: 0.717
Validation loss decreased (inf --> -0.717067).  Saving model ...
Epoch: 2 cost time: 1.099895715713501
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.577 Vali Acc: 0.727 Test Loss: 0.577 Test Acc: 0.727
Validation loss decreased (-0.717067 --> -0.726824).  Saving model ...
Epoch: 3 cost time: 1.1879677772521973
Epoch: 3, Steps: 13 | Train Loss: 0.531 Vali Loss: 0.572 Vali Acc: 0.722 Test Loss: 0.572 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1067264080047607
Epoch: 4, Steps: 13 | Train Loss: 0.508 Vali Loss: 0.571 Vali Acc: 0.727 Test Loss: 0.571 Test Acc: 0.727
Validation loss decreased (-0.726824 --> -0.726824).  Saving model ...
Epoch: 5 cost time: 1.1194300651550293
Epoch: 5, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.568 Vali Acc: 0.751 Test Loss: 0.568 Test Acc: 0.751
Validation loss decreased (-0.726824 --> -0.751214).  Saving model ...
Epoch: 6 cost time: 1.0450050830841064
Epoch: 6, Steps: 13 | Train Loss: 0.448 Vali Loss: 0.568 Vali Acc: 0.727 Test Loss: 0.568 Test Acc: 0.727
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.046173334121704
Epoch: 7, Steps: 13 | Train Loss: 0.416 Vali Loss: 0.567 Vali Acc: 0.737 Test Loss: 0.567 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.009401559829712
Epoch: 8, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.575 Vali Acc: 0.732 Test Loss: 0.575 Test Acc: 0.732
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1237716674804688
Epoch: 9, Steps: 13 | Train Loss: 0.400 Vali Loss: 0.591 Vali Acc: 0.737 Test Loss: 0.591 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1946935653686523
Epoch: 10, Steps: 13 | Train Loss: 0.352 Vali Loss: 0.605 Vali Acc: 0.722 Test Loss: 0.605 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1563372611999512
Epoch: 11, Steps: 13 | Train Loss: 0.327 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.180544376373291
Epoch: 12, Steps: 13 | Train Loss: 0.316 Vali Loss: 0.603 Vali Acc: 0.722 Test Loss: 0.603 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0125651359558105
Epoch: 13, Steps: 13 | Train Loss: 0.281 Vali Loss: 0.615 Vali Acc: 0.727 Test Loss: 0.615 Test Acc: 0.727
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0957038402557373
Epoch: 14, Steps: 13 | Train Loss: 0.297 Vali Loss: 0.634 Vali Acc: 0.732 Test Loss: 0.634 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0769762992858887
Epoch: 15, Steps: 13 | Train Loss: 0.251 Vali Loss: 0.733 Vali Acc: 0.678 Test Loss: 0.733 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 42470
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.179095506668091
Epoch: 1, Steps: 13 | Train Loss: 0.619 Vali Loss: 0.583 Vali Acc: 0.722 Test Loss: 0.583 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.2167437076568604
Epoch: 2, Steps: 13 | Train Loss: 0.575 Vali Loss: 0.576 Vali Acc: 0.722 Test Loss: 0.576 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721945).  Saving model ...
Epoch: 3 cost time: 1.1177785396575928
Epoch: 3, Steps: 13 | Train Loss: 0.542 Vali Loss: 0.566 Vali Acc: 0.722 Test Loss: 0.566 Test Acc: 0.722
Validation loss decreased (-0.721945 --> -0.721946).  Saving model ...
Epoch: 4 cost time: 1.173964023590088
Epoch: 4, Steps: 13 | Train Loss: 0.527 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
Validation loss decreased (-0.721946 --> -0.736580).  Saving model ...
Epoch: 5 cost time: 1.1390995979309082
Epoch: 5, Steps: 13 | Train Loss: 0.499 Vali Loss: 0.573 Vali Acc: 0.737 Test Loss: 0.573 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2120225429534912
Epoch: 6, Steps: 13 | Train Loss: 0.463 Vali Loss: 0.557 Vali Acc: 0.737 Test Loss: 0.557 Test Acc: 0.737
Validation loss decreased (-0.736580 --> -0.736580).  Saving model ...
Epoch: 7 cost time: 1.1291782855987549
Epoch: 7, Steps: 13 | Train Loss: 0.436 Vali Loss: 0.541 Vali Acc: 0.751 Test Loss: 0.541 Test Acc: 0.751
Validation loss decreased (-0.736580 --> -0.751214).  Saving model ...
Epoch: 8 cost time: 1.0630595684051514
Epoch: 8, Steps: 13 | Train Loss: 0.431 Vali Loss: 0.554 Vali Acc: 0.741 Test Loss: 0.554 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9905581474304199
Epoch: 9, Steps: 13 | Train Loss: 0.433 Vali Loss: 0.579 Vali Acc: 0.732 Test Loss: 0.579 Test Acc: 0.732
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0785274505615234
Epoch: 10, Steps: 13 | Train Loss: 0.375 Vali Loss: 0.581 Vali Acc: 0.727 Test Loss: 0.581 Test Acc: 0.727
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1988887786865234
Epoch: 11, Steps: 13 | Train Loss: 0.350 Vali Loss: 0.534 Vali Acc: 0.741 Test Loss: 0.534 Test Acc: 0.741
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.204345941543579
Epoch: 12, Steps: 13 | Train Loss: 0.337 Vali Loss: 0.549 Vali Acc: 0.741 Test Loss: 0.549 Test Acc: 0.741
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3190116882324219
Epoch: 13, Steps: 13 | Train Loss: 0.307 Vali Loss: 0.578 Vali Acc: 0.727 Test Loss: 0.578 Test Acc: 0.727
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3191685676574707
Epoch: 14, Steps: 13 | Train Loss: 0.317 Vali Loss: 0.596 Vali Acc: 0.746 Test Loss: 0.596 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1752464771270752
Epoch: 15, Steps: 13 | Train Loss: 0.282 Vali Loss: 0.622 Vali Acc: 0.693 Test Loss: 0.622 Test Acc: 0.693
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2847590446472168
Epoch: 16, Steps: 13 | Train Loss: 0.256 Vali Loss: 0.610 Vali Acc: 0.732 Test Loss: 0.610 Test Acc: 0.732
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2241206169128418
Epoch: 17, Steps: 13 | Train Loss: 0.233 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.751219512195122
model parameter : 42470
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Heartbeat       Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Heartbeat/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             61                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

204
205
>>>>>>>start training : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
204
205
205
Epoch: 1 cost time: 3.3165102005004883
Epoch: 1, Steps: 13 | Train Loss: 0.610 Vali Loss: 0.585 Vali Acc: 0.722 Test Loss: 0.585 Test Acc: 0.722
Validation loss decreased (inf --> -0.721945).  Saving model ...
Epoch: 2 cost time: 1.0166211128234863
Epoch: 2, Steps: 13 | Train Loss: 0.571 Vali Loss: 0.585 Vali Acc: 0.717 Test Loss: 0.585 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1028926372528076
Epoch: 3, Steps: 13 | Train Loss: 0.555 Vali Loss: 0.579 Vali Acc: 0.707 Test Loss: 0.579 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.197723150253296
Epoch: 4, Steps: 13 | Train Loss: 0.540 Vali Loss: 0.588 Vali Acc: 0.712 Test Loss: 0.588 Test Acc: 0.712
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.158965826034546
Epoch: 5, Steps: 13 | Train Loss: 0.516 Vali Loss: 0.596 Vali Acc: 0.712 Test Loss: 0.596 Test Acc: 0.712
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0162053108215332
Epoch: 6, Steps: 13 | Train Loss: 0.489 Vali Loss: 0.598 Vali Acc: 0.712 Test Loss: 0.598 Test Acc: 0.712
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.12890625
Epoch: 7, Steps: 13 | Train Loss: 0.457 Vali Loss: 0.608 Vali Acc: 0.712 Test Loss: 0.608 Test Acc: 0.712
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.181647777557373
Epoch: 8, Steps: 13 | Train Loss: 0.455 Vali Loss: 0.626 Vali Acc: 0.702 Test Loss: 0.626 Test Acc: 0.702
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2972054481506348
Epoch: 9, Steps: 13 | Train Loss: 0.451 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4489319324493408
Epoch: 10, Steps: 13 | Train Loss: 0.409 Vali Loss: 0.692 Vali Acc: 0.707 Test Loss: 0.692 Test Acc: 0.707
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2347302436828613
Epoch: 11, Steps: 13 | Train Loss: 0.387 Vali Loss: 0.650 Vali Acc: 0.722 Test Loss: 0.650 Test Acc: 0.722
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Heartbeat_ETSformer_UEA_ftM_sl405_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
205
test shape: torch.Size([205, 2]) torch.Size([205, 1])
accuracy:0.7219512195121951
model parameter : 42470
model size : 0.78MB
