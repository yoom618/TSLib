Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8781654834747314
Epoch: 1, Steps: 17 | Train Loss: 2.085 Vali Loss: 1.618 Vali Acc: 0.673 Test Loss: 1.618 Test Acc: 0.673
Validation loss decreased (inf --> -0.672957).  Saving model ...
Epoch: 2 cost time: 1.5108959674835205
Epoch: 2, Steps: 17 | Train Loss: 1.142 Vali Loss: 0.841 Vali Acc: 0.870 Test Loss: 0.841 Test Acc: 0.870
Validation loss decreased (-0.672957 --> -0.870262).  Saving model ...
Epoch: 3 cost time: 1.5384447574615479
Epoch: 3, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.457 Vali Acc: 0.922 Test Loss: 0.457 Test Acc: 0.922
Validation loss decreased (-0.870262 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 1.5210306644439697
Epoch: 4, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932429).  Saving model ...
Epoch: 5 cost time: 1.6586732864379883
Epoch: 5, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
Validation loss decreased (-0.932429 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.6649577617645264
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.7221741676330566
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.684391736984253
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.6951606273651123
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 1.6360077857971191
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.826585054397583
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6438453197479248
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.458695888519287
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7095057964324951
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9308719635009766
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.259798049926758
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.8324453830718994
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8823778629302979
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7625436782836914
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6805922985076904
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.854468822479248
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.647719383239746
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7256317138671875
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5666041374206543
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9068045616149902
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9457597732543945
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.674325942993164
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7305350303649902
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6943964958190918
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8402526378631592
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9196534156799316
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 5429897
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.464850425720215
Epoch: 1, Steps: 17 | Train Loss: 2.091 Vali Loss: 1.620 Vali Acc: 0.665 Test Loss: 1.620 Test Acc: 0.665
Validation loss decreased (inf --> -0.664849).  Saving model ...
Epoch: 2 cost time: 1.595217227935791
Epoch: 2, Steps: 17 | Train Loss: 1.155 Vali Loss: 0.845 Vali Acc: 0.876 Test Loss: 0.845 Test Acc: 0.876
Validation loss decreased (-0.664849 --> -0.875667).  Saving model ...
Epoch: 3 cost time: 1.7410805225372314
Epoch: 3, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.454 Vali Acc: 0.911 Test Loss: 0.454 Test Acc: 0.911
Validation loss decreased (-0.875667 --> -0.910806).  Saving model ...
Epoch: 4 cost time: 1.7417147159576416
Epoch: 4, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.910806 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.7362055778503418
Epoch: 5, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
Validation loss decreased (-0.929727 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.734253168106079
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.6732401847839355
Epoch: 7, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.170 Vali Acc: 0.938 Test Loss: 0.170 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.808919906616211
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.6546111106872559
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.5466010570526123
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6518089771270752
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7432656288146973
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.8981802463531494
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.7527010440826416
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0474298000335693
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.205892562866211
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1256656646728516
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.195582866668701
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1138837337493896
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.283477783203125
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7728686332702637
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6844844818115234
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6783018112182617
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 5429897
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.866340398788452
Epoch: 1, Steps: 17 | Train Loss: 2.088 Vali Loss: 1.614 Vali Acc: 0.676 Test Loss: 1.614 Test Acc: 0.676
Validation loss decreased (inf --> -0.675660).  Saving model ...
Epoch: 2 cost time: 1.987180471420288
Epoch: 2, Steps: 17 | Train Loss: 1.173 Vali Loss: 0.827 Vali Acc: 0.876 Test Loss: 0.827 Test Acc: 0.876
Validation loss decreased (-0.675660 --> -0.875667).  Saving model ...
Epoch: 3 cost time: 1.6925981044769287
Epoch: 3, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.443 Vali Acc: 0.919 Test Loss: 0.443 Test Acc: 0.919
Validation loss decreased (-0.875667 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 1.6631455421447754
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.918914 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.6710317134857178
Epoch: 5, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.8558783531188965
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.8170139789581299
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8337419033050537
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.70674729347229
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 1.7014837265014648
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.964864 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.6079075336456299
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5827722549438477
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.722303867340088
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5693728923797607
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7470524311065674
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8341891765594482
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7100818157196045
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8535575866699219
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8266949653625488
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6911509037017822
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 5429897
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.969574451446533
Epoch: 1, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.616 Vali Acc: 0.692 Test Loss: 1.616 Test Acc: 0.692
Validation loss decreased (inf --> -0.691876).  Saving model ...
Epoch: 2 cost time: 2.0627517700195312
Epoch: 2, Steps: 17 | Train Loss: 1.158 Vali Loss: 0.807 Vali Acc: 0.873 Test Loss: 0.807 Test Acc: 0.873
Validation loss decreased (-0.691876 --> -0.872965).  Saving model ...
Epoch: 3 cost time: 1.7044923305511475
Epoch: 3, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.417 Vali Acc: 0.924 Test Loss: 0.417 Test Acc: 0.924
Validation loss decreased (-0.872965 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.9395968914031982
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 1.7516233921051025
Epoch: 5, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.929727 --> -0.951350).  Saving model ...
Epoch: 6 cost time: 1.8542418479919434
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.6007905006408691
Epoch: 7, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7188329696655273
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.875901460647583
Epoch: 9, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.915858268737793
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.9705560207366943
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.084432363510132
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 2.039991617202759
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.058453321456909
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.110079526901245
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.470597505569458
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.317007064819336
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1196444034576416
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.1042063236236572
Epoch: 19, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0223569869995117
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.3258490562438965
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9920759201049805
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 5429897
model size : 30.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.234430551528931
Epoch: 1, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.574 Vali Acc: 0.751 Test Loss: 1.574 Test Acc: 0.751
Validation loss decreased (inf --> -0.751336).  Saving model ...
Epoch: 2 cost time: 2.3429574966430664
Epoch: 2, Steps: 17 | Train Loss: 1.144 Vali Loss: 0.789 Vali Acc: 0.895 Test Loss: 0.789 Test Acc: 0.895
Validation loss decreased (-0.751336 --> -0.894587).  Saving model ...
Epoch: 3 cost time: 2.1079165935516357
Epoch: 3, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.408 Vali Acc: 0.935 Test Loss: 0.408 Test Acc: 0.935
Validation loss decreased (-0.894587 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 2.289381742477417
Epoch: 4, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.327 Vali Acc: 0.903 Test Loss: 0.327 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9739067554473877
Epoch: 5, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
Validation loss decreased (-0.935131 --> -0.962160).  Saving model ...
Epoch: 6 cost time: 2.6562340259552
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.308199167251587
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4058749675750732
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 1.9106526374816895
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4364845752716064
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.899622917175293
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3572192192077637
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9638090133666992
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 1.8360862731933594
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0124053955078125
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.824265480041504
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.211465358734131
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.019620656967163
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.092881441116333
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.831843376159668
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.9618549346923828
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.070929527282715
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6021983623504639
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3332745
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.248950481414795
Epoch: 1, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.575 Vali Acc: 0.751 Test Loss: 1.575 Test Acc: 0.751
Validation loss decreased (inf --> -0.751336).  Saving model ...
Epoch: 2 cost time: 2.2875630855560303
Epoch: 2, Steps: 17 | Train Loss: 1.154 Vali Loss: 0.791 Vali Acc: 0.897 Test Loss: 0.791 Test Acc: 0.897
Validation loss decreased (-0.751336 --> -0.897289).  Saving model ...
Epoch: 3 cost time: 2.1640734672546387
Epoch: 3, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.409 Vali Acc: 0.930 Test Loss: 0.409 Test Acc: 0.930
Validation loss decreased (-0.897289 --> -0.929726).  Saving model ...
Epoch: 4 cost time: 1.8410091400146484
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0469367504119873
Epoch: 5, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
Validation loss decreased (-0.929726 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.0127968788146973
Epoch: 6, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.104005813598633
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.935 Test Loss: 0.175 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2306509017944336
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.6831917762756348
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.711850643157959
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.373058795928955
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.598250150680542
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7531545162200928
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.542868137359619
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.639397621154785
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5542426109313965
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3966264724731445
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0962252616882324
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.133852243423462
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3730807304382324
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.048283815383911
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.038426637649536
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.3444607257843018
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3332745
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.348712205886841
Epoch: 1, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.565 Vali Acc: 0.743 Test Loss: 1.565 Test Acc: 0.743
Validation loss decreased (inf --> -0.743228).  Saving model ...
Epoch: 2 cost time: 2.208632469177246
Epoch: 2, Steps: 17 | Train Loss: 1.168 Vali Loss: 0.779 Vali Acc: 0.886 Test Loss: 0.779 Test Acc: 0.886
Validation loss decreased (-0.743228 --> -0.886479).  Saving model ...
Epoch: 3 cost time: 2.0511226654052734
Epoch: 3, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.402 Vali Acc: 0.927 Test Loss: 0.402 Test Acc: 0.927
Validation loss decreased (-0.886479 --> -0.927023).  Saving model ...
Epoch: 4 cost time: 2.2925775051116943
Epoch: 4, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.333 Vali Acc: 0.900 Test Loss: 0.333 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.174814224243164
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
Validation loss decreased (-0.927023 --> -0.964863).  Saving model ...
Epoch: 6 cost time: 2.2555086612701416
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 1.8464453220367432
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.925105094909668
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.0575878620147705
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 2.181813955307007
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3099536895751953
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2742831707000732
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1786510944366455
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.2978713512420654
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.146134614944458
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.370535135269165
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5207087993621826
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4478697776794434
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0704708099365234
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 3332745
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.124155521392822
Epoch: 1, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.573 Vali Acc: 0.738 Test Loss: 1.573 Test Acc: 0.738
Validation loss decreased (inf --> -0.737822).  Saving model ...
Epoch: 2 cost time: 1.9549403190612793
Epoch: 2, Steps: 17 | Train Loss: 1.179 Vali Loss: 0.768 Vali Acc: 0.903 Test Loss: 0.768 Test Acc: 0.903
Validation loss decreased (-0.737822 --> -0.902695).  Saving model ...
Epoch: 3 cost time: 2.094430685043335
Epoch: 3, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.388 Vali Acc: 0.935 Test Loss: 0.388 Test Acc: 0.935
Validation loss decreased (-0.902695 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 2.0223631858825684
Epoch: 4, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.310 Vali Acc: 0.905 Test Loss: 0.310 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8210790157318115
Epoch: 5, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.935131 --> -0.959458).  Saving model ...
Epoch: 6 cost time: 2.1583638191223145
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 2.0111136436462402
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.946 Test Loss: 0.138 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1421167850494385
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.1368935108184814
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.7732720375061035
Epoch: 10, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9763333797454834
Epoch: 11, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0204005241394043
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.33549165725708
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.697960615158081
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3593907356262207
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.1935839653015137
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.902547836303711
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9377925395965576
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.984354019165039
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 3332745
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.417149305343628
Epoch: 1, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.653 Vali Acc: 0.576 Test Loss: 1.653 Test Acc: 0.576
Validation loss decreased (inf --> -0.575659).  Saving model ...
Epoch: 2 cost time: 2.3890979290008545
Epoch: 2, Steps: 17 | Train Loss: 1.167 Vali Loss: 0.802 Vali Acc: 0.897 Test Loss: 0.802 Test Acc: 0.897
Validation loss decreased (-0.575659 --> -0.897289).  Saving model ...
Epoch: 3 cost time: 2.0359036922454834
Epoch: 3, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.447 Vali Acc: 0.919 Test Loss: 0.447 Test Acc: 0.919
Validation loss decreased (-0.897289 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 2.0518085956573486
Epoch: 4, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.287 Vali Acc: 0.924 Test Loss: 0.287 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 2.2942633628845215
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.251 Vali Acc: 0.924 Test Loss: 0.251 Test Acc: 0.924
Validation loss decreased (-0.924321 --> -0.924322).  Saving model ...
Epoch: 6 cost time: 1.8798887729644775
Epoch: 6, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.924322 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.8540534973144531
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.146353244781494
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8650522232055664
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.0006940364837646
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9486873149871826
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0300142765045166
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.149574041366577
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3600685596466064
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3133950233459473
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4369962215423584
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.1905062198638916
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9379355907440186
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.13553786277771
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.060683012008667
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1808292865753174
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.539700508117676
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2284169
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.103372097015381
Epoch: 1, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.654 Vali Acc: 0.578 Test Loss: 1.654 Test Acc: 0.578
Validation loss decreased (inf --> -0.578362).  Saving model ...
Epoch: 2 cost time: 2.0861189365386963
Epoch: 2, Steps: 17 | Train Loss: 1.179 Vali Loss: 0.804 Vali Acc: 0.895 Test Loss: 0.804 Test Acc: 0.895
Validation loss decreased (-0.578362 --> -0.894587).  Saving model ...
Epoch: 3 cost time: 2.000288963317871
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.894587 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 2.1741459369659424
Epoch: 4, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.287 Vali Acc: 0.927 Test Loss: 0.287 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 2.1745505332946777
Epoch: 5, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1381523609161377
Epoch: 6, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.946 Test Loss: 0.170 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945944).  Saving model ...
Epoch: 7 cost time: 1.7816808223724365
Epoch: 7, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.945944 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.9635534286499023
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1614296436309814
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.0290164947509766
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.034208297729492
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1447174549102783
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.8492906093597412
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7675881385803223
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.309628963470459
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1123976707458496
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.97434663772583
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0578620433807373
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.025146245956421
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.079044818878174
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.351614236831665
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.2386815547943115
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2284169
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8329086303710938
Epoch: 1, Steps: 17 | Train Loss: 2.072 Vali Loss: 1.645 Vali Acc: 0.589 Test Loss: 1.645 Test Acc: 0.589
Validation loss decreased (inf --> -0.589173).  Saving model ...
Epoch: 2 cost time: 1.725013256072998
Epoch: 2, Steps: 17 | Train Loss: 1.194 Vali Loss: 0.800 Vali Acc: 0.889 Test Loss: 0.800 Test Acc: 0.889
Validation loss decreased (-0.589173 --> -0.889181).  Saving model ...
Epoch: 3 cost time: 2.042752742767334
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.442 Vali Acc: 0.916 Test Loss: 0.442 Test Acc: 0.916
Validation loss decreased (-0.889181 --> -0.916212).  Saving model ...
Epoch: 4 cost time: 1.8645198345184326
Epoch: 4, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.916212 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.938568115234375
Epoch: 5, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.243 Vali Acc: 0.914 Test Loss: 0.243 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1445367336273193
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.163 Vali Acc: 0.951 Test Loss: 0.163 Test Acc: 0.951
Validation loss decreased (-0.921619 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.9962682723999023
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.951350 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.9101755619049072
Epoch: 8, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.215803861618042
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.0684263706207275
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.03865647315979
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.97495436668396
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.035478115081787
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2381179332733154
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2914211750030518
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.184176445007324
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2383437156677246
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.088585376739502
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.225717544555664
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.534104108810425
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2284169
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.438483476638794
Epoch: 1, Steps: 17 | Train Loss: 2.051 Vali Loss: 1.640 Vali Acc: 0.605 Test Loss: 1.640 Test Acc: 0.605
Validation loss decreased (inf --> -0.605389).  Saving model ...
Epoch: 2 cost time: 2.1266250610351562
Epoch: 2, Steps: 17 | Train Loss: 1.192 Vali Loss: 0.791 Vali Acc: 0.905 Test Loss: 0.791 Test Acc: 0.905
Validation loss decreased (-0.605389 --> -0.905397).  Saving model ...
Epoch: 3 cost time: 1.9403669834136963
Epoch: 3, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.905397 --> -0.918915).  Saving model ...
Epoch: 4 cost time: 1.964874029159546
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921619).  Saving model ...
Epoch: 5 cost time: 1.9756886959075928
Epoch: 5, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.921619 --> -0.929728).  Saving model ...
Epoch: 6 cost time: 1.9605627059936523
Epoch: 6, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.929728 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.777249813079834
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.0076653957366943
Epoch: 8, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.118037700653076
Epoch: 9, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.1287384033203125
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 2.0554463863372803
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8265705108642578
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.956270694732666
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9717442989349365
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1092758178710938
Epoch: 15, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1944799423217773
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.268998146057129
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.324312448501587
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5515737533569336
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.248006582260132
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2284169
model size : 18.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.526766061782837
Epoch: 1, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.566 Vali Acc: 0.665 Test Loss: 1.566 Test Acc: 0.665
Validation loss decreased (inf --> -0.664849).  Saving model ...
Epoch: 2 cost time: 2.0865707397460938
Epoch: 2, Steps: 17 | Train Loss: 1.102 Vali Loss: 0.794 Vali Acc: 0.857 Test Loss: 0.794 Test Acc: 0.857
Validation loss decreased (-0.664849 --> -0.856749).  Saving model ...
Epoch: 3 cost time: 2.135915756225586
Epoch: 3, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.399 Vali Acc: 0.930 Test Loss: 0.399 Test Acc: 0.930
Validation loss decreased (-0.856749 --> -0.929726).  Saving model ...
Epoch: 4 cost time: 2.2877817153930664
Epoch: 4, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.282 Vali Acc: 0.927 Test Loss: 0.282 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5882210731506348
Epoch: 5, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.595066785812378
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.935133 --> -0.970269).  Saving model ...
Epoch: 7 cost time: 2.364673614501953
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4434118270874023
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6983070373535156
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.4434826374053955
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.4606752395629883
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6432764530181885
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8078036308288574
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.7077178955078125
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.589426040649414
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.5834670066833496
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.428433895111084
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.4741039276123047
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.750270366668701
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.761855125427246
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.674833297729492
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.606649398803711
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.600353717803955
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5237739086151123
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.738222122192383
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1759881
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.828517436981201
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.571 Vali Acc: 0.659 Test Loss: 1.571 Test Acc: 0.659
Validation loss decreased (inf --> -0.659444).  Saving model ...
Epoch: 2 cost time: 2.44523024559021
Epoch: 2, Steps: 17 | Train Loss: 1.108 Vali Loss: 0.802 Vali Acc: 0.851 Test Loss: 0.802 Test Acc: 0.851
Validation loss decreased (-0.659444 --> -0.851343).  Saving model ...
Epoch: 3 cost time: 2.30472993850708
Epoch: 3, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.401 Vali Acc: 0.924 Test Loss: 0.401 Test Acc: 0.924
Validation loss decreased (-0.851343 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 2.62119722366333
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929727).  Saving model ...
Epoch: 5 cost time: 2.540177822113037
Epoch: 5, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.226 Vali Acc: 0.935 Test Loss: 0.226 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.8015804290771484
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.935133 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.5072193145751953
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7069389820098877
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.8462412357330322
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8935084342956543
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9155821800231934
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.959 Test Loss: 0.116 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.801696300506592
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.854299545288086
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.689701795578003
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.805626392364502
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 2.5570497512817383
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.547922372817993
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.581450939178467
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5411360263824463
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9244837760925293
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8275043964385986
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 2.6114413738250732
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8710172176361084
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 24 cost time: 2.4851725101470947
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7037503719329834
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.714386463165283
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.804075002670288
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.9435977935791016
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.768662214279175
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.769656181335449
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.486461639404297
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.9270594120025635
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.7748329639434814
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1759881
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.299573183059692
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.570 Vali Acc: 0.657 Test Loss: 1.570 Test Acc: 0.657
Validation loss decreased (inf --> -0.656741).  Saving model ...
Epoch: 2 cost time: 2.4266929626464844
Epoch: 2, Steps: 17 | Train Loss: 1.121 Vali Loss: 0.806 Vali Acc: 0.846 Test Loss: 0.806 Test Acc: 0.846
Validation loss decreased (-0.656741 --> -0.845938).  Saving model ...
Epoch: 3 cost time: 2.6391048431396484
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.402 Vali Acc: 0.927 Test Loss: 0.402 Test Acc: 0.927
Validation loss decreased (-0.845938 --> -0.927023).  Saving model ...
Epoch: 4 cost time: 1.9476475715637207
Epoch: 4, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.282 Vali Acc: 0.924 Test Loss: 0.282 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.335977792739868
Epoch: 5, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.233 Vali Acc: 0.938 Test Loss: 0.233 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 2.478346109390259
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.937836 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.684666395187378
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8425822257995605
Epoch: 8, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.096083164215088
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.604865312576294
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.4385619163513184
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.957 Test Loss: 0.110 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.798844575881958
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7621958255767822
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.8379592895507812
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8328773975372314
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 16 cost time: 2.741772413253784
Epoch: 16, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8127927780151367
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8154959678649902
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.419013500213623
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9956107139587402
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8815906047821045
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.753960132598877
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7475337982177734
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5472805500030518
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7789292335510254
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1759881
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.241679668426514
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.569 Vali Acc: 0.678 Test Loss: 1.569 Test Acc: 0.678
Validation loss decreased (inf --> -0.678363).  Saving model ...
Epoch: 2 cost time: 2.4329514503479004
Epoch: 2, Steps: 17 | Train Loss: 1.125 Vali Loss: 0.792 Vali Acc: 0.862 Test Loss: 0.792 Test Acc: 0.862
Validation loss decreased (-0.678363 --> -0.862154).  Saving model ...
Epoch: 3 cost time: 2.294128179550171
Epoch: 3, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.386 Vali Acc: 0.932 Test Loss: 0.386 Test Acc: 0.932
Validation loss decreased (-0.862154 --> -0.932429).  Saving model ...
Epoch: 4 cost time: 2.5755980014801025
Epoch: 4, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.268 Vali Acc: 0.932 Test Loss: 0.268 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 5 cost time: 2.610461473464966
Epoch: 5, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.714306116104126
Epoch: 6, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.935133 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 2.569007396697998
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.699916362762451
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6498663425445557
Epoch: 9, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7671899795532227
Epoch: 10, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.7318694591522217
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7812156677246094
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.499408721923828
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.3269286155700684
Epoch: 14, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.4926106929779053
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.633113384246826
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 2.869455575942993
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.662015438079834
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.859527587890625
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7699391841888428
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.774186611175537
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.7071447372436523
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4592151641845703
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.573124885559082
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5647664070129395
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.6452207565307617
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1759881
model size : 16.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.120490074157715
Epoch: 1, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.580 Vali Acc: 0.684 Test Loss: 1.580 Test Acc: 0.684
Validation loss decreased (inf --> -0.683768).  Saving model ...
Epoch: 2 cost time: 2.641984462738037
Epoch: 2, Steps: 17 | Train Loss: 1.115 Vali Loss: 0.821 Vali Acc: 0.859 Test Loss: 0.821 Test Acc: 0.859
Validation loss decreased (-0.683768 --> -0.859451).  Saving model ...
Epoch: 3 cost time: 2.621349334716797
Epoch: 3, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.859451 --> -0.910806).  Saving model ...
Epoch: 4 cost time: 2.5043742656707764
Epoch: 4, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.305 Vali Acc: 0.914 Test Loss: 0.305 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913510).  Saving model ...
Epoch: 5 cost time: 2.3549790382385254
Epoch: 5, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.219 Vali Acc: 0.938 Test Loss: 0.219 Test Acc: 0.938
Validation loss decreased (-0.913510 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 2.159717321395874
Epoch: 6, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.937836 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 2.270193576812744
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 2.3858141899108887
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 2.390500068664551
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.321861505508423
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4430596828460693
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 2.2879602909088135
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6884169578552246
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.876880168914795
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.000986337661743
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8007919788360596
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.925140619277954
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.960982084274292
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.800560474395752
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5701239109039307
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3621408939361572
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3580803871154785
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6795260906219482
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.67061448097229
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.661163330078125
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.629281997680664
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8906075954437256
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7851104736328125
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1497737
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.383176565170288
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.578 Vali Acc: 0.686 Test Loss: 1.578 Test Acc: 0.686
Validation loss decreased (inf --> -0.686471).  Saving model ...
Epoch: 2 cost time: 2.654942274093628
Epoch: 2, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.825 Vali Acc: 0.849 Test Loss: 0.825 Test Acc: 0.849
Validation loss decreased (-0.686471 --> -0.848640).  Saving model ...
Epoch: 3 cost time: 2.871149778366089
Epoch: 3, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.460 Vali Acc: 0.914 Test Loss: 0.460 Test Acc: 0.914
Validation loss decreased (-0.848640 --> -0.913509).  Saving model ...
Epoch: 4 cost time: 2.3299896717071533
Epoch: 4, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918916).  Saving model ...
Epoch: 5 cost time: 2.1688108444213867
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.918916 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 2.7085440158843994
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.945944 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 2.5672497749328613
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 2.5587193965911865
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.3604953289031982
Epoch: 9, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 2.35516095161438
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3936045169830322
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 12 cost time: 2.264167547225952
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.285944938659668
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5293517112731934
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6762733459472656
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4348714351654053
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5170934200286865
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6222667694091797
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978378).  Saving model ...
Epoch: 19 cost time: 2.6739277839660645
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7963356971740723
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.737919330596924
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6665091514587402
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.728259801864624
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.7826485633850098
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3847241401672363
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3744125366210938
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.855663537979126
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8026845455169678
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1497737
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.396034240722656
Epoch: 1, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.579 Vali Acc: 0.692 Test Loss: 1.579 Test Acc: 0.692
Validation loss decreased (inf --> -0.691876).  Saving model ...
Epoch: 2 cost time: 2.7546191215515137
Epoch: 2, Steps: 17 | Train Loss: 1.151 Vali Loss: 0.823 Vali Acc: 0.843 Test Loss: 0.823 Test Acc: 0.843
Validation loss decreased (-0.691876 --> -0.843235).  Saving model ...
Epoch: 3 cost time: 2.7953174114227295
Epoch: 3, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.843235 --> -0.899995).  Saving model ...
Epoch: 4 cost time: 2.581871271133423
Epoch: 4, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.298 Vali Acc: 0.916 Test Loss: 0.298 Test Acc: 0.916
Validation loss decreased (-0.899995 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 2.455760955810547
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
Validation loss decreased (-0.916213 --> -0.935133).  Saving model ...
Epoch: 6 cost time: 2.6981587409973145
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.935133 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.836733818054199
Epoch: 7, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 2.754321813583374
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 2.7510647773742676
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 2.2609026432037354
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.959 Test Loss: 0.114 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4001011848449707
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 12 cost time: 2.4660818576812744
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4819881916046143
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.56913685798645
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.616669178009033
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.326843023300171
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.981080 --> -0.981080).  Saving model ...
Epoch: 17 cost time: 2.3727214336395264
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3710951805114746
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8067755699157715
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3588807582855225
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.571920156478882
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9501750469207764
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.690551280975342
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6277201175689697
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5880260467529297
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.6009883880615234
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1497737
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.063410043716431
Epoch: 1, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.582 Vali Acc: 0.724 Test Loss: 1.582 Test Acc: 0.724
Validation loss decreased (inf --> -0.724309).  Saving model ...
Epoch: 2 cost time: 2.4417710304260254
Epoch: 2, Steps: 17 | Train Loss: 1.162 Vali Loss: 0.826 Vali Acc: 0.859 Test Loss: 0.826 Test Acc: 0.859
Validation loss decreased (-0.724309 --> -0.859451).  Saving model ...
Epoch: 3 cost time: 2.292551279067993
Epoch: 3, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.457 Vali Acc: 0.914 Test Loss: 0.457 Test Acc: 0.914
Validation loss decreased (-0.859451 --> -0.913509).  Saving model ...
Epoch: 4 cost time: 2.561715602874756
Epoch: 4, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.287 Vali Acc: 0.924 Test Loss: 0.287 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924321).  Saving model ...
Epoch: 5 cost time: 2.419283390045166
Epoch: 5, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
Validation loss decreased (-0.924321 --> -0.937836).  Saving model ...
Epoch: 6 cost time: 2.500991106033325
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.937836 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 2.0597283840179443
Epoch: 7, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.5531702041625977
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 9 cost time: 2.811432361602783
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.35795259475708
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5471367835998535
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6789727210998535
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 13 cost time: 2.7642478942871094
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8792917728424072
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.802544593811035
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8445894718170166
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7464938163757324
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.90254545211792
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.724135160446167
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.797804355621338
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.937278985977173
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.67360782623291
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1497737
model size : 15.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.312065362930298
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.588 Vali Acc: 0.730 Test Loss: 1.588 Test Acc: 0.730
Validation loss decreased (inf --> -0.729714).  Saving model ...
Epoch: 2 cost time: 2.5963408946990967
Epoch: 2, Steps: 17 | Train Loss: 1.117 Vali Loss: 0.800 Vali Acc: 0.873 Test Loss: 0.800 Test Acc: 0.873
Validation loss decreased (-0.729714 --> -0.872965).  Saving model ...
Epoch: 3 cost time: 2.4991092681884766
Epoch: 3, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.461 Vali Acc: 0.900 Test Loss: 0.461 Test Acc: 0.900
Validation loss decreased (-0.872965 --> -0.899995).  Saving model ...
Epoch: 4 cost time: 2.5909430980682373
Epoch: 4, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
Validation loss decreased (-0.899995 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 2.4673097133636475
Epoch: 5, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 2.409149408340454
Epoch: 6, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 2.4451727867126465
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.8720345497131348
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 2.8176040649414062
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.6802239418029785
Epoch: 10, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.739014148712158
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 2.6119728088378906
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.405446767807007
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8763267993927
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 2.9606070518493652
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 16 cost time: 2.880409002304077
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.7173666954040527
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5437703132629395
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.984621524810791
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.802492618560791
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.0491271018981934
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1760361194610596
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.0264554023742676
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5776052474975586
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0630171298980713
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.0084877014160156
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1366665
model size : 15.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.648638963699341
Epoch: 1, Steps: 17 | Train Loss: 2.034 Vali Loss: 1.588 Vali Acc: 0.711 Test Loss: 1.588 Test Acc: 0.711
Validation loss decreased (inf --> -0.710795).  Saving model ...
Epoch: 2 cost time: 2.5428178310394287
Epoch: 2, Steps: 17 | Train Loss: 1.135 Vali Loss: 0.805 Vali Acc: 0.892 Test Loss: 0.805 Test Acc: 0.892
Validation loss decreased (-0.710795 --> -0.891884).  Saving model ...
Epoch: 3 cost time: 2.4198379516601562
Epoch: 3, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.464 Vali Acc: 0.905 Test Loss: 0.464 Test Acc: 0.905
Validation loss decreased (-0.891884 --> -0.905401).  Saving model ...
Epoch: 4 cost time: 2.543883800506592
Epoch: 4, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
Validation loss decreased (-0.905401 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 2.4819979667663574
Epoch: 5, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 6 cost time: 2.4118597507476807
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 2.372443437576294
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5320262908935547
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 2.4074716567993164
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 2.3207004070281982
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.393275260925293
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.6713008880615234
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.473546266555786
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.049173593521118
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1014864444732666
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1430037021636963
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 2.3830769062042236
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1947147846221924
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3269155025482178
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.478968381881714
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.510695695877075
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.651419162750244
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.45870304107666
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.542876720428467
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.655076265335083
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.825594425201416
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1366665
model size : 15.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.143176794052124
Epoch: 1, Steps: 17 | Train Loss: 2.030 Vali Loss: 1.593 Vali Acc: 0.714 Test Loss: 1.593 Test Acc: 0.714
Validation loss decreased (inf --> -0.713498).  Saving model ...
Epoch: 2 cost time: 2.5328876972198486
Epoch: 2, Steps: 17 | Train Loss: 1.155 Vali Loss: 0.807 Vali Acc: 0.878 Test Loss: 0.807 Test Acc: 0.878
Validation loss decreased (-0.713498 --> -0.878370).  Saving model ...
Epoch: 3 cost time: 2.6284725666046143
Epoch: 3, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.878370 --> -0.899995).  Saving model ...
Epoch: 4 cost time: 2.4893734455108643
Epoch: 4, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.258 Vali Acc: 0.951 Test Loss: 0.258 Test Acc: 0.951
Validation loss decreased (-0.899995 --> -0.951349).  Saving model ...
Epoch: 5 cost time: 2.611891269683838
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 2.24249267578125
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 2.1289196014404297
Epoch: 7, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964864).  Saving model ...
Epoch: 8 cost time: 2.2742152214050293
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3316171169281006
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.5695221424102783
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.647254705429077
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.6659977436065674
Epoch: 12, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.625560760498047
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.586446762084961
Epoch: 14, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3853201866149902
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.2037363052368164
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.177295446395874
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 2.2616891860961914
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3974709510803223
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.414412260055542
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.27140736579895
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3679323196411133
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2194230556488037
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.668522596359253
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.321204662322998
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5617589950561523
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.309720754623413
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1366665
model size : 15.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.66330885887146
Epoch: 1, Steps: 17 | Train Loss: 2.031 Vali Loss: 1.613 Vali Acc: 0.700 Test Loss: 1.613 Test Acc: 0.700
Validation loss decreased (inf --> -0.699984).  Saving model ...
Epoch: 2 cost time: 2.4523701667785645
Epoch: 2, Steps: 17 | Train Loss: 1.186 Vali Loss: 0.821 Vali Acc: 0.895 Test Loss: 0.821 Test Acc: 0.895
Validation loss decreased (-0.699984 --> -0.894586).  Saving model ...
Epoch: 3 cost time: 2.540417432785034
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.465 Vali Acc: 0.900 Test Loss: 0.465 Test Acc: 0.900
Validation loss decreased (-0.894586 --> -0.899995).  Saving model ...
Epoch: 4 cost time: 2.5438530445098877
Epoch: 4, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
Validation loss decreased (-0.899995 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 2.3371264934539795
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 2.4382317066192627
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 7 cost time: 1.9204773902893066
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 2.830435037612915
Epoch: 8, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1388161182403564
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 2.837428092956543
Epoch: 10, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6544034481048584
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.52424693107605
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.641575336456299
Epoch: 13, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.455232858657837
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.456495523452759
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.201655626296997
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.110792398452759
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 2.3785226345062256
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2514665126800537
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.15413761138916
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2085533142089844
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 2.318758487701416
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0450339317321777
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2183456420898438
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.7205259799957275
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.581806182861328
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4055709838867188
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.388235092163086
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3882782459259033
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4042129516601562
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.4918723106384277
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1366665
model size : 15.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.125994443893433
Epoch: 1, Steps: 17 | Train Loss: 2.125 Vali Loss: 1.857 Vali Acc: 0.503 Test Loss: 1.857 Test Acc: 0.503
Validation loss decreased (inf --> -0.502684).  Saving model ...
Epoch: 2 cost time: 2.5642426013946533
Epoch: 2, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.307 Vali Acc: 0.805 Test Loss: 1.307 Test Acc: 0.805
Validation loss decreased (-0.502684 --> -0.805392).  Saving model ...
Epoch: 3 cost time: 2.6762783527374268
Epoch: 3, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.804 Vali Acc: 0.881 Test Loss: 0.804 Test Acc: 0.881
Validation loss decreased (-0.805392 --> -0.881073).  Saving model ...
Epoch: 4 cost time: 2.5650603771209717
Epoch: 4, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.546 Vali Acc: 0.908 Test Loss: 0.546 Test Acc: 0.908
Validation loss decreased (-0.881073 --> -0.908103).  Saving model ...
Epoch: 5 cost time: 2.48158597946167
Epoch: 5, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.908103 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 2.469860076904297
Epoch: 6, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 2.319711208343506
Epoch: 7, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.433304786682129
Epoch: 8, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.948647 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 2.4137837886810303
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.570444345474243
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.682298183441162
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.6829190254211426
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.657569169998169
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.4181735515594482
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4149112701416016
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.515146493911743
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.558316946029663
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.649567127227783
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8235280513763428
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.46746563911438
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3759400844573975
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.069582939147949
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.188271999359131
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 2452873
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.56967568397522
Epoch: 1, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.847 Vali Acc: 0.519 Test Loss: 1.847 Test Acc: 0.519
Validation loss decreased (inf --> -0.518900).  Saving model ...
Epoch: 2 cost time: 2.2200708389282227
Epoch: 2, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.302 Vali Acc: 0.786 Test Loss: 1.302 Test Acc: 0.786
Validation loss decreased (-0.518900 --> -0.786473).  Saving model ...
Epoch: 3 cost time: 2.147512197494507
Epoch: 3, Steps: 17 | Train Loss: 0.984 Vali Loss: 0.803 Vali Acc: 0.886 Test Loss: 0.803 Test Acc: 0.886
Validation loss decreased (-0.786473 --> -0.886478).  Saving model ...
Epoch: 4 cost time: 2.0732269287109375
Epoch: 4, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.544 Vali Acc: 0.914 Test Loss: 0.544 Test Acc: 0.914
Validation loss decreased (-0.886478 --> -0.913508).  Saving model ...
Epoch: 5 cost time: 1.9640905857086182
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.332 Vali Acc: 0.932 Test Loss: 0.332 Test Acc: 0.932
Validation loss decreased (-0.913508 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 2.288386821746826
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.258 Vali Acc: 0.938 Test Loss: 0.258 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 7 cost time: 2.2230584621429443
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.2576992511749268
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.338425397872925
Epoch: 9, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0443780422210693
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 2.333405017852783
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.956755 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.4520373344421387
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.951 Test Loss: 0.127 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3660905361175537
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.972972 --> -0.981080).  Saving model ...
Epoch: 14 cost time: 2.2069592475891113
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.527146816253662
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5719497203826904
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3874521255493164
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.208850860595703
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.6267919540405273
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4025025367736816
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3498454093933105
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.413905382156372
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2798831462860107
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 2452873
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.388307332992554
Epoch: 1, Steps: 17 | Train Loss: 2.128 Vali Loss: 1.839 Vali Acc: 0.535 Test Loss: 1.839 Test Acc: 0.535
Validation loss decreased (inf --> -0.535117).  Saving model ...
Epoch: 2 cost time: 2.2127649784088135
Epoch: 2, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.289 Vali Acc: 0.789 Test Loss: 1.289 Test Acc: 0.789
Validation loss decreased (-0.535117 --> -0.789176).  Saving model ...
Epoch: 3 cost time: 2.4706060886383057
Epoch: 3, Steps: 17 | Train Loss: 0.993 Vali Loss: 0.785 Vali Acc: 0.889 Test Loss: 0.785 Test Acc: 0.889
Validation loss decreased (-0.789176 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.471280813217163
Epoch: 4, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.528 Vali Acc: 0.908 Test Loss: 0.528 Test Acc: 0.908
Validation loss decreased (-0.889181 --> -0.908103).  Saving model ...
Epoch: 5 cost time: 2.3509433269500732
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
Validation loss decreased (-0.908103 --> -0.943240).  Saving model ...
Epoch: 6 cost time: 2.206223964691162
Epoch: 6, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 2.0863430500030518
Epoch: 7, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0789971351623535
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.148348569869995
Epoch: 9, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.136659622192383
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0381951332092285
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.1777353286743164
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8274405002593994
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.374210834503174
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.516772508621216
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6286795139312744
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4818010330200195
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.539163589477539
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4748198986053467
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3741109371185303
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4523818492889404
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.401752471923828
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.622447967529297
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2452873
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.346841335296631
Epoch: 1, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.834 Vali Acc: 0.595 Test Loss: 1.834 Test Acc: 0.595
Validation loss decreased (inf --> -0.594576).  Saving model ...
Epoch: 2 cost time: 2.026393413543701
Epoch: 2, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.274 Vali Acc: 0.805 Test Loss: 1.274 Test Acc: 0.805
Validation loss decreased (-0.594576 --> -0.805393).  Saving model ...
Epoch: 3 cost time: 1.9085915088653564
Epoch: 3, Steps: 17 | Train Loss: 0.998 Vali Loss: 0.751 Vali Acc: 0.905 Test Loss: 0.751 Test Acc: 0.905
Validation loss decreased (-0.805393 --> -0.905398).  Saving model ...
Epoch: 4 cost time: 2.1776747703552246
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.494 Vali Acc: 0.919 Test Loss: 0.494 Test Acc: 0.919
Validation loss decreased (-0.905398 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.173229932785034
Epoch: 5, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.284 Vali Acc: 0.949 Test Loss: 0.284 Test Acc: 0.949
Validation loss decreased (-0.918914 --> -0.948646).  Saving model ...
Epoch: 6 cost time: 2.1150362491607666
Epoch: 6, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.555272102355957
Epoch: 7, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 8 cost time: 2.551959991455078
Epoch: 8, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.951350 --> -0.964864).  Saving model ...
Epoch: 9 cost time: 2.7616820335388184
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.2567849159240723
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4505391120910645
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 2.4794766902923584
Epoch: 12, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3279662132263184
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6639599800109863
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6337645053863525
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.696244716644287
Epoch: 16, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.453817129135132
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.601264476776123
Epoch: 18, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7381317615509033
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4222443103790283
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4404640197753906
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2452873
model size : 14.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.770731449127197
Epoch: 1, Steps: 17 | Train Loss: 2.101 Vali Loss: 1.861 Vali Acc: 0.465 Test Loss: 1.861 Test Acc: 0.465
Validation loss decreased (inf --> -0.464846).  Saving model ...
Epoch: 2 cost time: 2.1677374839782715
Epoch: 2, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.328 Vali Acc: 0.773 Test Loss: 1.328 Test Acc: 0.773
Validation loss decreased (-0.464846 --> -0.772960).  Saving model ...
Epoch: 3 cost time: 2.2676937580108643
Epoch: 3, Steps: 17 | Train Loss: 0.985 Vali Loss: 0.835 Vali Acc: 0.876 Test Loss: 0.835 Test Acc: 0.876
Validation loss decreased (-0.772960 --> -0.875667).  Saving model ...
Epoch: 4 cost time: 2.3690619468688965
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.541 Vali Acc: 0.911 Test Loss: 0.541 Test Acc: 0.911
Validation loss decreased (-0.875667 --> -0.910805).  Saving model ...
Epoch: 5 cost time: 2.3781769275665283
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.375 Vali Acc: 0.943 Test Loss: 0.375 Test Acc: 0.943
Validation loss decreased (-0.910805 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.753281593322754
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.257 Vali Acc: 0.959 Test Loss: 0.257 Test Acc: 0.959
Validation loss decreased (-0.943239 --> -0.959457).  Saving model ...
Epoch: 7 cost time: 2.0869081020355225
Epoch: 7, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.202716112136841
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0606937408447266
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 2.0001566410064697
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.7973010540008545
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.962161 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.918945074081421
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9292676448822021
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2378499507904053
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1755897998809814
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0739355087280273
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.094787836074829
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.131632089614868
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9898133277893066
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0668082237243652
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.034099578857422
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1404297
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.44276237487793
Epoch: 1, Steps: 17 | Train Loss: 2.098 Vali Loss: 1.857 Vali Acc: 0.470 Test Loss: 1.857 Test Acc: 0.470
Validation loss decreased (inf --> -0.470252).  Saving model ...
Epoch: 2 cost time: 2.232088088989258
Epoch: 2, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.328 Vali Acc: 0.768 Test Loss: 1.328 Test Acc: 0.768
Validation loss decreased (-0.470252 --> -0.767554).  Saving model ...
Epoch: 3 cost time: 2.223217248916626
Epoch: 3, Steps: 17 | Train Loss: 1.004 Vali Loss: 0.835 Vali Acc: 0.873 Test Loss: 0.835 Test Acc: 0.873
Validation loss decreased (-0.767554 --> -0.872965).  Saving model ...
Epoch: 4 cost time: 2.088359832763672
Epoch: 4, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.547 Vali Acc: 0.905 Test Loss: 0.547 Test Acc: 0.905
Validation loss decreased (-0.872965 --> -0.905400).  Saving model ...
Epoch: 5 cost time: 2.0544986724853516
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.905400 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 2.1113855838775635
Epoch: 6, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.255 Vali Acc: 0.957 Test Loss: 0.255 Test Acc: 0.957
Validation loss decreased (-0.929726 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 2.042395830154419
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0435256958007812
Epoch: 8, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1462533473968506
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 2.3794455528259277
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.51942777633667
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 2.5498764514923096
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.332916736602783
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2726969718933105
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4599835872650146
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7153851985931396
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.396632671356201
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6994190216064453
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2960920333862305
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.356168270111084
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5473053455352783
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3479700088500977
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4809160232543945
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.371030807495117
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2207961082458496
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.538775682449341
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.4811532497406006
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.3963210582733154
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4679763317108154
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1404297
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.407810926437378
Epoch: 1, Steps: 17 | Train Loss: 2.094 Vali Loss: 1.853 Vali Acc: 0.465 Test Loss: 1.853 Test Acc: 0.465
Validation loss decreased (inf --> -0.464846).  Saving model ...
Epoch: 2 cost time: 2.070063829421997
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.319 Vali Acc: 0.768 Test Loss: 1.319 Test Acc: 0.768
Validation loss decreased (-0.464846 --> -0.767554).  Saving model ...
Epoch: 3 cost time: 2.2881767749786377
Epoch: 3, Steps: 17 | Train Loss: 1.022 Vali Loss: 0.831 Vali Acc: 0.873 Test Loss: 0.831 Test Acc: 0.873
Validation loss decreased (-0.767554 --> -0.872965).  Saving model ...
Epoch: 4 cost time: 2.1632044315338135
Epoch: 4, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.872965 --> -0.899995).  Saving model ...
Epoch: 5 cost time: 2.2851920127868652
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.899995 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 2.104670286178589
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
Validation loss decreased (-0.929726 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 2.1428449153900146
Epoch: 7, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0285348892211914
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.143519639968872
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 2.2467756271362305
Epoch: 10, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.074836254119873
Epoch: 11, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.964863 --> -0.975674).  Saving model ...
Epoch: 12 cost time: 1.925086498260498
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0217933654785156
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1712043285369873
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 2.3435213565826416
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.574965000152588
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.498534679412842
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.414926052093506
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4165737628936768
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0919175148010254
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3387539386749268
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.4070074558258057
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.401089906692505
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.421321153640747
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1404297
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.604993581771851
Epoch: 1, Steps: 17 | Train Loss: 2.082 Vali Loss: 1.855 Vali Acc: 0.516 Test Loss: 1.855 Test Acc: 0.516
Validation loss decreased (inf --> -0.516198).  Saving model ...
Epoch: 2 cost time: 2.0940685272216797
Epoch: 2, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.319 Vali Acc: 0.768 Test Loss: 1.319 Test Acc: 0.768
Validation loss decreased (-0.516198 --> -0.767554).  Saving model ...
Epoch: 3 cost time: 1.9344282150268555
Epoch: 3, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.817 Vali Acc: 0.865 Test Loss: 0.817 Test Acc: 0.865
Validation loss decreased (-0.767554 --> -0.864857).  Saving model ...
Epoch: 4 cost time: 2.004152297973633
Epoch: 4, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.519 Vali Acc: 0.886 Test Loss: 0.519 Test Acc: 0.886
Validation loss decreased (-0.864857 --> -0.886481).  Saving model ...
Epoch: 5 cost time: 2.1084980964660645
Epoch: 5, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.350 Vali Acc: 0.932 Test Loss: 0.350 Test Acc: 0.932
Validation loss decreased (-0.886481 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 2.1925556659698486
Epoch: 6, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.932429 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 2.2759511470794678
Epoch: 7, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4277634620666504
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 9 cost time: 2.4407880306243896
Epoch: 9, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.251967668533325
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.4011776447296143
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.0397205352783203
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0594890117645264
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.160053253173828
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.200791358947754
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.282914638519287
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0526294708251953
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.23749041557312
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3706984519958496
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.2560360431671143
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.104457139968872
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3035736083984375
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3058876991271973
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1370582580566406
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2767043113708496
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.251805305480957
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1467838287353516
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.311896562576294
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0595080852508545
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1404297
model size : 10.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.164768218994141
Epoch: 1, Steps: 17 | Train Loss: 2.111 Vali Loss: 1.880 Vali Acc: 0.516 Test Loss: 1.880 Test Acc: 0.516
Validation loss decreased (inf --> -0.516197).  Saving model ...
Epoch: 2 cost time: 1.9811480045318604
Epoch: 2, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.292 Vali Acc: 0.816 Test Loss: 1.292 Test Acc: 0.816
Validation loss decreased (-0.516197 --> -0.816203).  Saving model ...
Epoch: 3 cost time: 1.9033496379852295
Epoch: 3, Steps: 17 | Train Loss: 0.958 Vali Loss: 0.832 Vali Acc: 0.892 Test Loss: 0.832 Test Acc: 0.892
Validation loss decreased (-0.816203 --> -0.891884).  Saving model ...
Epoch: 4 cost time: 1.9418184757232666
Epoch: 4, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.535 Vali Acc: 0.919 Test Loss: 0.535 Test Acc: 0.919
Validation loss decreased (-0.891884 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.025566816329956
Epoch: 5, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.368 Vali Acc: 0.946 Test Loss: 0.368 Test Acc: 0.946
Validation loss decreased (-0.918914 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 1.9110443592071533
Epoch: 6, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 2.331068754196167
Epoch: 7, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.427272319793701
Epoch: 8, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
Validation loss decreased (-0.948646 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.544398546218872
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0917348861694336
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.257956027984619
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2290279865264893
Epoch: 12, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.023301601409912
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2510826587677
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 2.414639711380005
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.005509853363037
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1076502799987793
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 2.329496383666992
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2385313510894775
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 2.336240768432617
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2978134155273438
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 2.2874577045440674
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.081511974334717
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.9966962337493896
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.902392864227295
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.899942398071289
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.256021499633789
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3203470706939697
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3968982696533203
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.4513328075408936
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.364706039428711
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0943331718444824
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.025559902191162
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.137418508529663
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0391039848327637
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1583988666534424
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 880009
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.32483172416687
Epoch: 1, Steps: 17 | Train Loss: 2.112 Vali Loss: 1.884 Vali Acc: 0.511 Test Loss: 1.884 Test Acc: 0.511
Validation loss decreased (inf --> -0.510792).  Saving model ...
Epoch: 2 cost time: 2.099093437194824
Epoch: 2, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.298 Vali Acc: 0.827 Test Loss: 1.298 Test Acc: 0.827
Validation loss decreased (-0.510792 --> -0.827014).  Saving model ...
Epoch: 3 cost time: 2.232367515563965
Epoch: 3, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.837 Vali Acc: 0.903 Test Loss: 0.837 Test Acc: 0.903
Validation loss decreased (-0.827014 --> -0.902694).  Saving model ...
Epoch: 4 cost time: 2.0302889347076416
Epoch: 4, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.538 Vali Acc: 0.924 Test Loss: 0.538 Test Acc: 0.924
Validation loss decreased (-0.902694 --> -0.924319).  Saving model ...
Epoch: 5 cost time: 2.0879554748535156
Epoch: 5, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.372 Vali Acc: 0.941 Test Loss: 0.372 Test Acc: 0.941
Validation loss decreased (-0.924319 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 2.4655396938323975
Epoch: 6, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.273 Vali Acc: 0.951 Test Loss: 0.273 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 2.112409830093384
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 2.2191314697265625
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.306178331375122
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 2.3049118518829346
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2427821159362793
Epoch: 11, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.3256289958953857
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.384192705154419
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.245513439178467
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.455306053161621
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3035457134246826
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.215404987335205
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2332301139831543
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1002862453460693
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4096758365631104
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7563486099243164
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.2206428050994873
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.063356876373291
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.2459957599639893
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 880009
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.156819820404053
Epoch: 1, Steps: 17 | Train Loss: 2.116 Vali Loss: 1.889 Vali Acc: 0.497 Test Loss: 1.889 Test Acc: 0.497
Validation loss decreased (inf --> -0.497278).  Saving model ...
Epoch: 2 cost time: 2.1467268466949463
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.297 Vali Acc: 0.832 Test Loss: 1.297 Test Acc: 0.832
Validation loss decreased (-0.497278 --> -0.832419).  Saving model ...
Epoch: 3 cost time: 1.890547752380371
Epoch: 3, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.834 Vali Acc: 0.889 Test Loss: 0.834 Test Acc: 0.889
Validation loss decreased (-0.832419 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.0722076892852783
Epoch: 4, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.533 Vali Acc: 0.930 Test Loss: 0.533 Test Acc: 0.930
Validation loss decreased (-0.889181 --> -0.929724).  Saving model ...
Epoch: 5 cost time: 1.9176058769226074
Epoch: 5, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.365 Vali Acc: 0.935 Test Loss: 0.365 Test Acc: 0.935
Validation loss decreased (-0.929724 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 1.9638359546661377
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.269 Vali Acc: 0.949 Test Loss: 0.269 Test Acc: 0.949
Validation loss decreased (-0.935131 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 2.0875580310821533
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 8 cost time: 2.156771421432495
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
Validation loss decreased (-0.948647 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.1747708320617676
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9469282627105713
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1617236137390137
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2900917530059814
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.0726895332336426
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.284660577774048
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 2.4434845447540283
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5612761974334717
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.3899590969085693
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6612892150878906
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7464165687561035
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.716383218765259
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.644629955291748
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.570787191390991
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.444779634475708
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.789022207260132
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.577993154525757
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.664905309677124
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4748153686523438
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.564882278442383
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.4486286640167236
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.323258876800537
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4019992351531982
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.606767177581787
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 880009
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.4296770095825195
Epoch: 1, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.904 Vali Acc: 0.527 Test Loss: 1.904 Test Acc: 0.527
Validation loss decreased (inf --> -0.527008).  Saving model ...
Epoch: 2 cost time: 2.042970657348633
Epoch: 2, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.316 Vali Acc: 0.832 Test Loss: 1.316 Test Acc: 0.832
Validation loss decreased (-0.527008 --> -0.832419).  Saving model ...
Epoch: 3 cost time: 2.05338978767395
Epoch: 3, Steps: 17 | Train Loss: 1.021 Vali Loss: 0.837 Vali Acc: 0.889 Test Loss: 0.837 Test Acc: 0.889
Validation loss decreased (-0.832419 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.021430253982544
Epoch: 4, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.529 Vali Acc: 0.922 Test Loss: 0.529 Test Acc: 0.922
Validation loss decreased (-0.889181 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 2.1413729190826416
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.921616 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 2.32855486869812
Epoch: 6, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 2.1447861194610596
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 2.1548848152160645
Epoch: 8, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.306812286376953
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1695706844329834
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.247838258743286
Epoch: 11, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0809521675109863
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.0381052494049072
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9150135517120361
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.0859792232513428
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5055594444274902
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.599949598312378
Epoch: 17, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4592363834381104
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4240641593933105
Epoch: 19, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3366293907165527
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.552473306655884
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.50020170211792
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.358051300048828
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.3119733333587646
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 880009
model size : 8.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.178107500076294
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 1.885 Vali Acc: 0.468 Test Loss: 1.885 Test Acc: 0.468
Validation loss decreased (inf --> -0.467549).  Saving model ...
Epoch: 2 cost time: 2.14096736907959
Epoch: 2, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.297 Vali Acc: 0.819 Test Loss: 1.297 Test Acc: 0.819
Validation loss decreased (-0.467549 --> -0.818906).  Saving model ...
Epoch: 3 cost time: 2.3597936630249023
Epoch: 3, Steps: 17 | Train Loss: 1.011 Vali Loss: 0.876 Vali Acc: 0.862 Test Loss: 0.876 Test Acc: 0.862
Validation loss decreased (-0.818906 --> -0.862153).  Saving model ...
Epoch: 4 cost time: 2.256169319152832
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.525 Vali Acc: 0.919 Test Loss: 0.525 Test Acc: 0.919
Validation loss decreased (-0.862153 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.0788304805755615
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.375 Vali Acc: 0.946 Test Loss: 0.375 Test Acc: 0.946
Validation loss decreased (-0.918914 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 2.123293399810791
Epoch: 6, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2712371349334717
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
Validation loss decreased (-0.945942 --> -0.964863).  Saving model ...
Epoch: 8 cost time: 2.168576717376709
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 2.0347607135772705
Epoch: 9, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9668543338775635
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1235132217407227
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.185382127761841
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.282426357269287
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0618515014648438
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8769545555114746
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9686532020568848
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.963263750076294
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4233529567718506
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 617865
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.330966472625732
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 1.886 Vali Acc: 0.478 Test Loss: 1.886 Test Acc: 0.478
Validation loss decreased (inf --> -0.478360).  Saving model ...
Epoch: 2 cost time: 2.11474609375
Epoch: 2, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.297 Vali Acc: 0.830 Test Loss: 1.297 Test Acc: 0.830
Validation loss decreased (-0.478360 --> -0.829717).  Saving model ...
Epoch: 3 cost time: 2.111828088760376
Epoch: 3, Steps: 17 | Train Loss: 1.031 Vali Loss: 0.879 Vali Acc: 0.859 Test Loss: 0.879 Test Acc: 0.859
Validation loss decreased (-0.829717 --> -0.859451).  Saving model ...
Epoch: 4 cost time: 2.336254835128784
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.527 Vali Acc: 0.919 Test Loss: 0.527 Test Acc: 0.919
Validation loss decreased (-0.859451 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.2549240589141846
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.378 Vali Acc: 0.935 Test Loss: 0.378 Test Acc: 0.935
Validation loss decreased (-0.918914 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 2.519216537475586
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 2.456268548965454
Epoch: 7, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
Validation loss decreased (-0.940538 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 2.469270706176758
Epoch: 8, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.8936381340026855
Epoch: 9, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.287994861602783
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5891380310058594
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5578882694244385
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.3274426460266113
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.951 Test Loss: 0.135 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.4559826850891113
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4940185546875
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5441205501556396
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3098018169403076
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.334768056869507
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3210227489471436
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 2.299588441848755
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 2.1232194900512695
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1468379497528076
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.06097149848938
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.9310832023620605
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4874954223632812
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.091883420944214
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1371188163757324
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1889801025390625
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.698925256729126
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3426809310913086
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.056206703186035
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.100022792816162
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9858508110046387
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 617865
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.876299619674683
Epoch: 1, Steps: 17 | Train Loss: 2.170 Vali Loss: 1.888 Vali Acc: 0.462 Test Loss: 1.888 Test Acc: 0.462
Validation loss decreased (inf --> -0.462143).  Saving model ...
Epoch: 2 cost time: 2.2290515899658203
Epoch: 2, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.295 Vali Acc: 0.814 Test Loss: 1.295 Test Acc: 0.814
Validation loss decreased (-0.462143 --> -0.813501).  Saving model ...
Epoch: 3 cost time: 2.2498111724853516
Epoch: 3, Steps: 17 | Train Loss: 1.031 Vali Loss: 0.876 Vali Acc: 0.859 Test Loss: 0.876 Test Acc: 0.859
Validation loss decreased (-0.813501 --> -0.859451).  Saving model ...
Epoch: 4 cost time: 2.170684576034546
Epoch: 4, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.519 Vali Acc: 0.919 Test Loss: 0.519 Test Acc: 0.919
Validation loss decreased (-0.859451 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 2.2567672729492188
Epoch: 5, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.373 Vali Acc: 0.927 Test Loss: 0.373 Test Acc: 0.927
Validation loss decreased (-0.918914 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 2.135648727416992
Epoch: 6, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 2.2338132858276367
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.208 Vali Acc: 0.959 Test Loss: 0.208 Test Acc: 0.959
Validation loss decreased (-0.935132 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 2.3392512798309326
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.0994715690612793
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.317897319793701
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.22064208984375
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1537671089172363
Epoch: 12, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.2555418014526367
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3802051544189453
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 2.616762638092041
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.495206832885742
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.3806819915771484
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3788325786590576
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6057000160217285
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.3070192337036133
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.257098436355591
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.354557752609253
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.519322395324707
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 2.252347230911255
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.320991039276123
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4748315811157227
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5016303062438965
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.254230499267578
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.3741159439086914
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.5435240268707275
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.432309627532959
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2621066570281982
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.1431703567504883
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 617865
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.120487689971924
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 1.909 Vali Acc: 0.424 Test Loss: 1.909 Test Acc: 0.424
Validation loss decreased (inf --> -0.424305).  Saving model ...
Epoch: 2 cost time: 2.3392069339752197
Epoch: 2, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.322 Vali Acc: 0.805 Test Loss: 1.322 Test Acc: 0.805
Validation loss decreased (-0.424305 --> -0.805392).  Saving model ...
Epoch: 3 cost time: 2.170290946960449
Epoch: 3, Steps: 17 | Train Loss: 1.057 Vali Loss: 0.894 Vali Acc: 0.865 Test Loss: 0.894 Test Acc: 0.865
Validation loss decreased (-0.805392 --> -0.864856).  Saving model ...
Epoch: 4 cost time: 2.496324062347412
Epoch: 4, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.531 Vali Acc: 0.927 Test Loss: 0.531 Test Acc: 0.927
Validation loss decreased (-0.864856 --> -0.927022).  Saving model ...
Epoch: 5 cost time: 2.4272594451904297
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.373 Vali Acc: 0.941 Test Loss: 0.373 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 2.1991591453552246
Epoch: 6, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0177817344665527
Epoch: 7, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.940537 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 2.1403584480285645
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.508472442626953
Epoch: 9, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.223527193069458
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.337118148803711
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.198502540588379
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5086703300476074
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3028173446655273
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 2.1378705501556396
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0328614711761475
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 17 cost time: 2.308323860168457
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 2.2685554027557373
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0067479610443115
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.086897850036621
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 2.185445785522461
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.011937379837036
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.179593801498413
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 2.2917158603668213
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.275027275085449
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.055387496948242
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.12206768989563
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.293800115585327
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.970 Test Loss: 0.082 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.2686760425567627
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.2461583614349365
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.135192632675171
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2045795917510986
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3770031929016113
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.968 Test Loss: 0.088 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 617865
model size : 7.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.032766819000244
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 1.900 Vali Acc: 0.492 Test Loss: 1.900 Test Acc: 0.492
Validation loss decreased (inf --> -0.491873).  Saving model ...
Epoch: 2 cost time: 2.1624915599823
Epoch: 2, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.312 Vali Acc: 0.797 Test Loss: 1.312 Test Acc: 0.797
Validation loss decreased (-0.491873 --> -0.797284).  Saving model ...
Epoch: 3 cost time: 2.113920211791992
Epoch: 3, Steps: 17 | Train Loss: 1.002 Vali Loss: 0.846 Vali Acc: 0.876 Test Loss: 0.846 Test Acc: 0.876
Validation loss decreased (-0.797284 --> -0.875667).  Saving model ...
Epoch: 4 cost time: 2.169142007827759
Epoch: 4, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.555 Vali Acc: 0.905 Test Loss: 0.555 Test Acc: 0.905
Validation loss decreased (-0.875667 --> -0.905400).  Saving model ...
Epoch: 5 cost time: 1.9668405055999756
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.388 Vali Acc: 0.927 Test Loss: 0.388 Test Acc: 0.927
Validation loss decreased (-0.905400 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 2.0365748405456543
Epoch: 6, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 2.0374832153320312
Epoch: 7, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
Validation loss decreased (-0.940538 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 2.199744462966919
Epoch: 8, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.1852333545684814
Epoch: 9, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 2.0523414611816406
Epoch: 10, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.2458157539367676
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1234772205352783
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2881476879119873
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.1470675468444824
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.022017478942871
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1301729679107666
Epoch: 16, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1980319023132324
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2400166988372803
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.127488851547241
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.208014965057373
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4465737342834473
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.155060291290283
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2764291763305664
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.3264591693878174
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2248144149780273
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0654296875
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8888092041015625
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.145414113998413
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.181884288787842
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 486793
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.735346555709839
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 1.896 Vali Acc: 0.519 Test Loss: 1.896 Test Acc: 0.519
Validation loss decreased (inf --> -0.518900).  Saving model ...
Epoch: 2 cost time: 2.095024824142456
Epoch: 2, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.309 Vali Acc: 0.786 Test Loss: 1.309 Test Acc: 0.786
Validation loss decreased (-0.518900 --> -0.786473).  Saving model ...
Epoch: 3 cost time: 1.8872127532958984
Epoch: 3, Steps: 17 | Train Loss: 1.012 Vali Loss: 0.846 Vali Acc: 0.876 Test Loss: 0.846 Test Acc: 0.876
Validation loss decreased (-0.786473 --> -0.875667).  Saving model ...
Epoch: 4 cost time: 1.951706886291504
Epoch: 4, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.556 Vali Acc: 0.903 Test Loss: 0.556 Test Acc: 0.903
Validation loss decreased (-0.875667 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 2.256089448928833
Epoch: 5, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.385 Vali Acc: 0.924 Test Loss: 0.385 Test Acc: 0.924
Validation loss decreased (-0.902697 --> -0.924320).  Saving model ...
Epoch: 6 cost time: 2.251584529876709
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935132).  Saving model ...
Epoch: 7 cost time: 2.249199390411377
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 2.1854796409606934
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
Validation loss decreased (-0.943241 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.174837589263916
Epoch: 9, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.9941003322601318
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1555724143981934
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9058518409729004
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 2.033362627029419
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 2.239591121673584
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.524656295776367
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.348529815673828
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4370617866516113
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 2.368187665939331
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.553297519683838
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 2.178593873977661
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.429525136947632
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.412182331085205
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6255996227264404
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.63588809967041
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.5373523235321045
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2482380867004395
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3202342987060547
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.4841361045837402
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.4756062030792236
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 486793
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.463136434555054
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 1.895 Vali Acc: 0.503 Test Loss: 1.895 Test Acc: 0.503
Validation loss decreased (inf --> -0.502684).  Saving model ...
Epoch: 2 cost time: 2.2120862007141113
Epoch: 2, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.306 Vali Acc: 0.784 Test Loss: 1.306 Test Acc: 0.784
Validation loss decreased (-0.502684 --> -0.783771).  Saving model ...
Epoch: 3 cost time: 2.294882297515869
Epoch: 3, Steps: 17 | Train Loss: 1.016 Vali Loss: 0.840 Vali Acc: 0.868 Test Loss: 0.840 Test Acc: 0.868
Validation loss decreased (-0.783771 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 2.3692739009857178
Epoch: 4, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
Validation loss decreased (-0.867559 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 2.593050718307495
Epoch: 5, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
Validation loss decreased (-0.899994 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 2.455536127090454
Epoch: 6, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.281 Vali Acc: 0.943 Test Loss: 0.281 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 2.4467270374298096
Epoch: 7, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5850279331207275
Epoch: 8, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
Validation loss decreased (-0.943240 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 2.5563626289367676
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3754689693450928
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 2.5488104820251465
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 2.4260127544403076
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 2.2518458366394043
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 14 cost time: 2.5548715591430664
Epoch: 14, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3015451431274414
Epoch: 15, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1093130111694336
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4449045658111572
Epoch: 17, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.222531795501709
Epoch: 18, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.079019069671631
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.161240577697754
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0378153324127197
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3299612998962402
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 2.0674915313720703
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3056650161743164
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.092325210571289
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2142200469970703
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.1706244945526123
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.2167065143585205
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.400052070617676
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.308290719985962
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.499807834625244
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.3305883407592773
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 486793
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.598609209060669
Epoch: 1, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.918 Vali Acc: 0.468 Test Loss: 1.918 Test Acc: 0.468
Validation loss decreased (inf --> -0.467548).  Saving model ...
Epoch: 2 cost time: 2.139874219894409
Epoch: 2, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.325 Vali Acc: 0.795 Test Loss: 1.325 Test Acc: 0.795
Validation loss decreased (-0.467548 --> -0.794581).  Saving model ...
Epoch: 3 cost time: 2.0429725646972656
Epoch: 3, Steps: 17 | Train Loss: 1.033 Vali Loss: 0.851 Vali Acc: 0.873 Test Loss: 0.851 Test Acc: 0.873
Validation loss decreased (-0.794581 --> -0.872964).  Saving model ...
Epoch: 4 cost time: 2.151494264602661
Epoch: 4, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.553 Vali Acc: 0.908 Test Loss: 0.553 Test Acc: 0.908
Validation loss decreased (-0.872964 --> -0.908103).  Saving model ...
Epoch: 5 cost time: 1.946187973022461
Epoch: 5, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
Validation loss decreased (-0.908103 --> -0.929726).  Saving model ...
Epoch: 6 cost time: 2.06961727142334
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.278 Vali Acc: 0.943 Test Loss: 0.278 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 2.2081124782562256
Epoch: 7, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.207 Vali Acc: 0.943 Test Loss: 0.207 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 8 cost time: 2.34686279296875
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 9 cost time: 2.0829713344573975
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.951350 --> -0.962161).  Saving model ...
Epoch: 10 cost time: 2.1102182865142822
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 1.9284415245056152
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 2.0659687519073486
Epoch: 12, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 2.048637866973877
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.9870779514312744
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 2.1883296966552734
Epoch: 15, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3051917552948
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.5346477031707764
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.704420804977417
Epoch: 18, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.470857858657837
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 2.7761270999908447
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.531259059906006
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.337711811065674
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.3291165828704834
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4122557640075684
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3475759029388428
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.2509043216705322
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.4039504528045654
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.357569932937622
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3534629344940186
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2343297004699707
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.274897813796997
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.2316415309906006
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.4438931941986084
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.577385425567627
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.112548351287842
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1450371742248535
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 486793
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.415784120559692
Epoch: 1, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.830 Vali Acc: 0.546 Test Loss: 1.830 Test Acc: 0.546
Validation loss decreased (inf --> -0.545928).  Saving model ...
Epoch: 2 cost time: 2.1642513275146484
Epoch: 2, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.248 Vali Acc: 0.838 Test Loss: 1.248 Test Acc: 0.838
Validation loss decreased (-0.545928 --> -0.837825).  Saving model ...
Epoch: 3 cost time: 2.3695526123046875
Epoch: 3, Steps: 17 | Train Loss: 0.965 Vali Loss: 0.810 Vali Acc: 0.889 Test Loss: 0.810 Test Acc: 0.889
Validation loss decreased (-0.837825 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.2722203731536865
Epoch: 4, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.547 Vali Acc: 0.927 Test Loss: 0.547 Test Acc: 0.927
Validation loss decreased (-0.889181 --> -0.927022).  Saving model ...
Epoch: 5 cost time: 2.0766513347625732
Epoch: 5, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.372 Vali Acc: 0.946 Test Loss: 0.372 Test Acc: 0.946
Validation loss decreased (-0.927022 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 2.419297218322754
Epoch: 6, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.304 Vali Acc: 0.935 Test Loss: 0.304 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.11950945854187
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2272398471832275
Epoch: 8, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
Validation loss decreased (-0.945942 --> -0.978377).  Saving model ...
Epoch: 9 cost time: 2.5598442554473877
Epoch: 9, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6275808811187744
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3262197971343994
Epoch: 11, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.266170024871826
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.027463436126709
Epoch: 13, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2605092525482178
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.312532663345337
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.480011224746704
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.495877265930176
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.370652437210083
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 421257
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8767051696777344
Epoch: 1, Steps: 17 | Train Loss: 2.087 Vali Loss: 1.832 Vali Acc: 0.549 Test Loss: 1.832 Test Acc: 0.549
Validation loss decreased (inf --> -0.548630).  Saving model ...
Epoch: 2 cost time: 2.0302515029907227
Epoch: 2, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.253 Vali Acc: 0.814 Test Loss: 1.253 Test Acc: 0.814
Validation loss decreased (-0.548630 --> -0.813501).  Saving model ...
Epoch: 3 cost time: 1.9982116222381592
Epoch: 3, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.817 Vali Acc: 0.886 Test Loss: 0.817 Test Acc: 0.886
Validation loss decreased (-0.813501 --> -0.886478).  Saving model ...
Epoch: 4 cost time: 1.9047179222106934
Epoch: 4, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.544 Vali Acc: 0.919 Test Loss: 0.544 Test Acc: 0.919
Validation loss decreased (-0.886478 --> -0.918913).  Saving model ...
Epoch: 5 cost time: 2.0550549030303955
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.377 Vali Acc: 0.943 Test Loss: 0.377 Test Acc: 0.943
Validation loss decreased (-0.918913 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.9479625225067139
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9867479801177979
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9697678089141846
Epoch: 8, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
Validation loss decreased (-0.943239 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 2.159959077835083
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1904921531677246
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9422681331634521
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.041393756866455
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1670475006103516
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4288253784179688
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.0656585693359375
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1688427925109863
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.324751615524292
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2501614093780518
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 421257
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.78605580329895
Epoch: 1, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.826 Vali Acc: 0.559 Test Loss: 1.826 Test Acc: 0.559
Validation loss decreased (inf --> -0.559441).  Saving model ...
Epoch: 2 cost time: 1.995502233505249
Epoch: 2, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.246 Vali Acc: 0.824 Test Loss: 1.246 Test Acc: 0.824
Validation loss decreased (-0.559441 --> -0.824312).  Saving model ...
Epoch: 3 cost time: 2.2155420780181885
Epoch: 3, Steps: 17 | Train Loss: 0.994 Vali Loss: 0.809 Vali Acc: 0.884 Test Loss: 0.809 Test Acc: 0.884
Validation loss decreased (-0.824312 --> -0.883776).  Saving model ...
Epoch: 4 cost time: 2.182906150817871
Epoch: 4, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.540 Vali Acc: 0.919 Test Loss: 0.540 Test Acc: 0.919
Validation loss decreased (-0.883776 --> -0.918914).  Saving model ...
Epoch: 5 cost time: 1.964965581893921
Epoch: 5, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.375 Vali Acc: 0.932 Test Loss: 0.375 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932429).  Saving model ...
Epoch: 6 cost time: 2.299485445022583
Epoch: 6, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 7 cost time: 2.2070090770721436
Epoch: 7, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1850240230560303
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.940538 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 2.204709529876709
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0282299518585205
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 2.119725227355957
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.044858932495117
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1955556869506836
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9901010990142822
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.001680612564087
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 2.09688663482666
Epoch: 16, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.49084734916687
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.1907238960266113
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.318709135055542
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.1626672744750977
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0269663333892822
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0061497688293457
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1774871349334717
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 2.170555353164673
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1533281803131104
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.103577136993408
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0642693042755127
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.182623863220215
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.2210140228271484
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9119341373443604
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.2990899085998535
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.978907823562622
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.23002028465271
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 421257
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1090264320373535
Epoch: 1, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.831 Vali Acc: 0.565 Test Loss: 1.831 Test Acc: 0.565
Validation loss decreased (inf --> -0.564847).  Saving model ...
Epoch: 2 cost time: 2.2218105792999268
Epoch: 2, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.267 Vali Acc: 0.808 Test Loss: 1.267 Test Acc: 0.808
Validation loss decreased (-0.564847 --> -0.808095).  Saving model ...
Epoch: 3 cost time: 2.3396143913269043
Epoch: 3, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.825 Vali Acc: 0.889 Test Loss: 0.825 Test Acc: 0.889
Validation loss decreased (-0.808095 --> -0.889181).  Saving model ...
Epoch: 4 cost time: 2.1760613918304443
Epoch: 4, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.547 Vali Acc: 0.908 Test Loss: 0.547 Test Acc: 0.908
Validation loss decreased (-0.889181 --> -0.908103).  Saving model ...
Epoch: 5 cost time: 2.178682565689087
Epoch: 5, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.379 Vali Acc: 0.946 Test Loss: 0.379 Test Acc: 0.946
Validation loss decreased (-0.908103 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 2.2503914833068848
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.306 Vali Acc: 0.946 Test Loss: 0.306 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 2.0846197605133057
Epoch: 7, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 8 cost time: 2.2977383136749268
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
Validation loss decreased (-0.948646 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 2.2767410278320312
Epoch: 9, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 2.000190019607544
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 2.1481056213378906
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 2.3071985244750977
Epoch: 12, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 2.149475574493408
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 2.143707036972046
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1539993286132812
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.568371534347534
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2352490425109863
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 2.0964088439941406
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.962559461593628
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 20 cost time: 2.035261392593384
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9401862621307373
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.286449909210205
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0616939067840576
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9392650127410889
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9926602840423584
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.072181224822998
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0304274559020996
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9736971855163574
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.095107078552246
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 2.332448959350586
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3018290996551514
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.4592037200927734
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.4195971488952637
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.277665853500366
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.6099371910095215
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.6913232803344727
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.965 Test Loss: 0.088 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.6400396823883057
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 2.3491828441619873
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.538163900375366
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.647458553314209
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.5623462200164795
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.5717012882232666
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.5901455879211426
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.5329902172088623
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.425060749053955
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.2366604804992676
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.717848062515259
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 421257
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.162022590637207
Epoch: 1, Steps: 17 | Train Loss: 2.253 Vali Loss: 2.086 Vali Acc: 0.205 Test Loss: 2.086 Test Acc: 0.205
Validation loss decreased (inf --> -0.205385).  Saving model ...
Epoch: 2 cost time: 1.938061237335205
Epoch: 2, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.737 Vali Acc: 0.638 Test Loss: 1.737 Test Acc: 0.638
Validation loss decreased (-0.205385 --> -0.637820).  Saving model ...
Epoch: 3 cost time: 1.7629411220550537
Epoch: 3, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.363 Vali Acc: 0.781 Test Loss: 1.363 Test Acc: 0.781
Validation loss decreased (-0.637820 --> -0.781067).  Saving model ...
Epoch: 4 cost time: 1.8818883895874023
Epoch: 4, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.058 Vali Acc: 0.846 Test Loss: 1.058 Test Acc: 0.846
Validation loss decreased (-0.781067 --> -0.845935).  Saving model ...
Epoch: 5 cost time: 1.6696836948394775
Epoch: 5, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.784 Vali Acc: 0.889 Test Loss: 0.784 Test Acc: 0.889
Validation loss decreased (-0.845935 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 1.6031863689422607
Epoch: 6, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.581 Vali Acc: 0.916 Test Loss: 0.581 Test Acc: 0.916
Validation loss decreased (-0.889181 --> -0.916210).  Saving model ...
Epoch: 7 cost time: 1.6121628284454346
Epoch: 7, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.442 Vali Acc: 0.922 Test Loss: 0.442 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 1.913572072982788
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.348 Vali Acc: 0.935 Test Loss: 0.348 Test Acc: 0.935
Validation loss decreased (-0.921617 --> -0.935132).  Saving model ...
Epoch: 9 cost time: 1.6685848236083984
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 2.0061135292053223
Epoch: 10, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0657262802124023
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 2.1945905685424805
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.187 Vali Acc: 0.949 Test Loss: 0.187 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3163533210754395
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3575053215026855
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2183475494384766
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.9598276615142822
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2977280616760254
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1663527488708496
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 2.1394155025482178
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3268182277679443
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.950451135635376
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0142061710357666
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.199357509613037
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 2.0630245208740234
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9586055278778076
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.448712110519409
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.275719404220581
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.093747615814209
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9974067211151123
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0400729179382324
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0030221939086914
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 2.1077470779418945
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.191772937774658
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0071215629577637
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.178255558013916
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8227009773254395
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.69940185546875
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8319377899169922
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.0369763374328613
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1270225048065186
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.033090591430664
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1160969
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1912150382995605
Epoch: 1, Steps: 17 | Train Loss: 2.251 Vali Loss: 2.079 Vali Acc: 0.241 Test Loss: 2.079 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 1.9136137962341309
Epoch: 2, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.734 Vali Acc: 0.624 Test Loss: 1.734 Test Acc: 0.624
Validation loss decreased (-0.240520 --> -0.624307).  Saving model ...
Epoch: 3 cost time: 1.8869061470031738
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.363 Vali Acc: 0.776 Test Loss: 1.363 Test Acc: 0.776
Validation loss decreased (-0.624307 --> -0.775662).  Saving model ...
Epoch: 4 cost time: 1.7508540153503418
Epoch: 4, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.058 Vali Acc: 0.835 Test Loss: 1.058 Test Acc: 0.835
Validation loss decreased (-0.775662 --> -0.835125).  Saving model ...
Epoch: 5 cost time: 1.6997108459472656
Epoch: 5, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.783 Vali Acc: 0.892 Test Loss: 0.783 Test Acc: 0.892
Validation loss decreased (-0.835125 --> -0.891884).  Saving model ...
Epoch: 6 cost time: 1.8458735942840576
Epoch: 6, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.578 Vali Acc: 0.908 Test Loss: 0.578 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908102).  Saving model ...
Epoch: 7 cost time: 2.1584160327911377
Epoch: 7, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.441 Vali Acc: 0.916 Test Loss: 0.441 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916212).  Saving model ...
Epoch: 8 cost time: 2.050710916519165
Epoch: 8, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.349 Vali Acc: 0.932 Test Loss: 0.349 Test Acc: 0.932
Validation loss decreased (-0.916212 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 2.221339702606201
Epoch: 9, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.8461129665374756
Epoch: 10, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 2.103842258453369
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6799321174621582
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9143824577331543
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.8634331226348877
Epoch: 14, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7645483016967773
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7392640113830566
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.5447924137115479
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 2.1275014877319336
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.9270062446594238
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7932775020599365
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.7888460159301758
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8132598400115967
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7288541793823242
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.7975244522094727
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9500868320465088
Epoch: 25, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.007018566131592
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6564509868621826
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5806715488433838
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.9610252380371094
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9551918506622314
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8322608470916748
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 1.9883148670196533
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8859472274780273
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0511200428009033
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6564579010009766
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8615224361419678
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.931081771850586
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7126026153564453
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 1.8531880378723145
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.904780626296997
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.044309616088867
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.2758758068084717
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.3025095462799072
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.019329309463501
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0655548572540283
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.05391526222229
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.1880319118499756
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.879368543624878
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1160969
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.573683500289917
Epoch: 1, Steps: 17 | Train Loss: 2.233 Vali Loss: 2.070 Vali Acc: 0.254 Test Loss: 2.070 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 2.3483705520629883
Epoch: 2, Steps: 17 | Train Loss: 1.903 Vali Loss: 1.721 Vali Acc: 0.646 Test Loss: 1.721 Test Acc: 0.646
Validation loss decreased (-0.254033 --> -0.645929).  Saving model ...
Epoch: 3 cost time: 2.3404672145843506
Epoch: 3, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.342 Vali Acc: 0.792 Test Loss: 1.342 Test Acc: 0.792
Validation loss decreased (-0.645929 --> -0.791878).  Saving model ...
Epoch: 4 cost time: 1.9929029941558838
Epoch: 4, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.035 Vali Acc: 0.830 Test Loss: 1.035 Test Acc: 0.830
Validation loss decreased (-0.791878 --> -0.829719).  Saving model ...
Epoch: 5 cost time: 1.3576436042785645
Epoch: 5, Steps: 17 | Train Loss: 0.829 Vali Loss: 0.761 Vali Acc: 0.876 Test Loss: 0.761 Test Acc: 0.876
Validation loss decreased (-0.829719 --> -0.875668).  Saving model ...
Epoch: 6 cost time: 1.6496562957763672
Epoch: 6, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.557 Vali Acc: 0.914 Test Loss: 0.557 Test Acc: 0.914
Validation loss decreased (-0.875668 --> -0.913508).  Saving model ...
Epoch: 7 cost time: 2.1109540462493896
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.425 Vali Acc: 0.914 Test Loss: 0.425 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913509).  Saving model ...
Epoch: 8 cost time: 1.9749176502227783
Epoch: 8, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.334 Vali Acc: 0.927 Test Loss: 0.334 Test Acc: 0.927
Validation loss decreased (-0.913509 --> -0.927024).  Saving model ...
Epoch: 9 cost time: 1.9441006183624268
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.272 Vali Acc: 0.946 Test Loss: 0.272 Test Acc: 0.946
Validation loss decreased (-0.927024 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.9451546669006348
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.86869215965271
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 2.038619041442871
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 2.3001046180725098
Epoch: 13, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 14 cost time: 2.1997873783111572
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 2.295050621032715
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 16 cost time: 2.092287302017212
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 2.279179334640503
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.9275808334350586
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7229459285736084
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6445188522338867
Epoch: 20, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 21 cost time: 1.8674993515014648
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8180854320526123
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0518438816070557
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.978377 --> -0.981080).  Saving model ...
Epoch: 24 cost time: 2.0172863006591797
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8566222190856934
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.111140251159668
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3669986724853516
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2207248210906982
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.354736566543579
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9522500038146973
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.881117343902588
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5565094947814941
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9140028953552246
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 1160969
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0573484897613525
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.049 Vali Acc: 0.300 Test Loss: 2.049 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 1.935741901397705
Epoch: 2, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.695 Vali Acc: 0.700 Test Loss: 1.695 Test Acc: 0.700
Validation loss decreased (-0.299980 --> -0.699983).  Saving model ...
Epoch: 3 cost time: 1.927140474319458
Epoch: 3, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.308 Vali Acc: 0.814 Test Loss: 1.308 Test Acc: 0.814
Validation loss decreased (-0.699983 --> -0.813500).  Saving model ...
Epoch: 4 cost time: 1.7409250736236572
Epoch: 4, Steps: 17 | Train Loss: 1.127 Vali Loss: 0.993 Vali Acc: 0.841 Test Loss: 0.993 Test Acc: 0.841
Validation loss decreased (-0.813500 --> -0.840531).  Saving model ...
Epoch: 5 cost time: 1.7913951873779297
Epoch: 5, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.719 Vali Acc: 0.892 Test Loss: 0.719 Test Acc: 0.892
Validation loss decreased (-0.840531 --> -0.891885).  Saving model ...
Epoch: 6 cost time: 1.8762338161468506
Epoch: 6, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.525 Vali Acc: 0.914 Test Loss: 0.525 Test Acc: 0.914
Validation loss decreased (-0.891885 --> -0.913508).  Saving model ...
Epoch: 7 cost time: 2.11214017868042
Epoch: 7, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.913508 --> -0.929726).  Saving model ...
Epoch: 8 cost time: 1.9729516506195068
Epoch: 8, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.317 Vali Acc: 0.943 Test Loss: 0.317 Test Acc: 0.943
Validation loss decreased (-0.929726 --> -0.943240).  Saving model ...
Epoch: 9 cost time: 1.6296653747558594
Epoch: 9, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.903792142868042
Epoch: 10, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 11 cost time: 1.666043758392334
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 2.0562572479248047
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9666740894317627
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 1.6966876983642578
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.651451587677002
Epoch: 15, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7556793689727783
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.7138323783874512
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.9073574542999268
Epoch: 18, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.678884506225586
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.758455514907837
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.710601568222046
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.90879487991333
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.986006498336792
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8870799541473389
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.8464434146881104
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.714818000793457
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 1.8092477321624756
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6319539546966553
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8552608489990234
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.5672962665557861
Epoch: 30, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6610360145568848
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 32 cost time: 1.7275032997131348
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.679011344909668
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.015085458755493
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0002222061157227
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9419505596160889
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0659468173980713
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.923645257949829
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.1469876766204834
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.9241969585418701
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7383179664611816
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1160969
model size : 6.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.199071645736694
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.008 Vali Acc: 0.349 Test Loss: 2.008 Test Acc: 0.349
Validation loss decreased (inf --> -0.348629).  Saving model ...
Epoch: 2 cost time: 1.7687551975250244
Epoch: 2, Steps: 17 | Train Loss: 1.832 Vali Loss: 1.662 Vali Acc: 0.703 Test Loss: 1.662 Test Acc: 0.703
Validation loss decreased (-0.348629 --> -0.702686).  Saving model ...
Epoch: 3 cost time: 1.7538254261016846
Epoch: 3, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.292 Vali Acc: 0.797 Test Loss: 1.292 Test Acc: 0.797
Validation loss decreased (-0.702686 --> -0.797284).  Saving model ...
Epoch: 4 cost time: 1.955254316329956
Epoch: 4, Steps: 17 | Train Loss: 1.077 Vali Loss: 0.995 Vali Acc: 0.854 Test Loss: 0.995 Test Acc: 0.854
Validation loss decreased (-0.797284 --> -0.854044).  Saving model ...
Epoch: 5 cost time: 1.9673502445220947
Epoch: 5, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.731 Vali Acc: 0.886 Test Loss: 0.731 Test Acc: 0.886
Validation loss decreased (-0.854044 --> -0.886479).  Saving model ...
Epoch: 6 cost time: 2.1642069816589355
Epoch: 6, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.562 Vali Acc: 0.911 Test Loss: 0.562 Test Acc: 0.911
Validation loss decreased (-0.886479 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.694695234298706
Epoch: 7, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.426 Vali Acc: 0.932 Test Loss: 0.426 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932428).  Saving model ...
Epoch: 8 cost time: 1.8400492668151855
Epoch: 8, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.322 Vali Acc: 0.946 Test Loss: 0.322 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945943).  Saving model ...
Epoch: 9 cost time: 1.920623779296875
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 2.2129969596862793
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 11 cost time: 2.0792572498321533
Epoch: 11, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8197176456451416
Epoch: 12, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7252719402313232
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0517773628234863
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.988981008529663
Epoch: 15, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.855177640914917
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.8022246360778809
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8705544471740723
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8445112705230713
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.9591162204742432
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.020195484161377
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 2.040159225463867
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.966583251953125
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8952949047088623
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.707446813583374
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3212058544158936
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9046883583068848
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.875213623046875
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 2.003437042236328
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.773047685623169
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8674688339233398
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.7412772178649902
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9443395137786865
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0997490882873535
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8441264629364014
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.032155990600586
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 2.481668472290039
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.056574821472168
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.1328630447387695
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.164801836013794
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.1431984901428223
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9174234867095947
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8198871612548828
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.76893949508667
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.6573293209075928
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4967167377471924
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 636681
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.172637224197388
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.004 Vali Acc: 0.365 Test Loss: 2.004 Test Acc: 0.365
Validation loss decreased (inf --> -0.364845).  Saving model ...
Epoch: 2 cost time: 1.8328614234924316
Epoch: 2, Steps: 17 | Train Loss: 1.844 Vali Loss: 1.660 Vali Acc: 0.711 Test Loss: 1.660 Test Acc: 0.711
Validation loss decreased (-0.364845 --> -0.710794).  Saving model ...
Epoch: 3 cost time: 1.791515588760376
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.293 Vali Acc: 0.800 Test Loss: 1.293 Test Acc: 0.800
Validation loss decreased (-0.710794 --> -0.799987).  Saving model ...
Epoch: 4 cost time: 1.7575595378875732
Epoch: 4, Steps: 17 | Train Loss: 1.098 Vali Loss: 0.997 Vali Acc: 0.854 Test Loss: 0.997 Test Acc: 0.854
Validation loss decreased (-0.799987 --> -0.854044).  Saving model ...
Epoch: 5 cost time: 1.7850799560546875
Epoch: 5, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.735 Vali Acc: 0.889 Test Loss: 0.735 Test Acc: 0.889
Validation loss decreased (-0.854044 --> -0.889182).  Saving model ...
Epoch: 6 cost time: 2.0172884464263916
Epoch: 6, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.563 Vali Acc: 0.905 Test Loss: 0.563 Test Acc: 0.905
Validation loss decreased (-0.889182 --> -0.905400).  Saving model ...
Epoch: 7 cost time: 2.0142929553985596
Epoch: 7, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.429 Vali Acc: 0.935 Test Loss: 0.429 Test Acc: 0.935
Validation loss decreased (-0.905400 --> -0.935131).  Saving model ...
Epoch: 8 cost time: 1.709897756576538
Epoch: 8, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.322 Vali Acc: 0.943 Test Loss: 0.322 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 9 cost time: 1.8309776782989502
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.279 Vali Acc: 0.946 Test Loss: 0.279 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 2.0091066360473633
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.226 Vali Acc: 0.965 Test Loss: 0.226 Test Acc: 0.965
Validation loss decreased (-0.945943 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 1.8716232776641846
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.746131420135498
Epoch: 12, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8020930290222168
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8032479286193848
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7157881259918213
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7360820770263672
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.7109696865081787
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5829262733459473
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7776808738708496
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1083617210388184
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9346039295196533
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 2.018855333328247
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 2.0278236865997314
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2794711589813232
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0473036766052246
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4388811588287354
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.3065378665924072
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1027684211730957
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 2.0543782711029053
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.5065250396728516
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1910600662231445
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.2500624656677246
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.2121503353118896
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.001333713531494
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.262669324874878
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.423417329788208
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.9545865058898926
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.0647683143615723
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 636681
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.681859016418457
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 1.996 Vali Acc: 0.384 Test Loss: 1.996 Test Acc: 0.384
Validation loss decreased (inf --> -0.383764).  Saving model ...
Epoch: 2 cost time: 1.868981122970581
Epoch: 2, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.650 Vali Acc: 0.689 Test Loss: 1.650 Test Acc: 0.689
Validation loss decreased (-0.383764 --> -0.689173).  Saving model ...
Epoch: 3 cost time: 1.9602880477905273
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.283 Vali Acc: 0.803 Test Loss: 1.283 Test Acc: 0.803
Validation loss decreased (-0.689173 --> -0.802690).  Saving model ...
Epoch: 4 cost time: 1.7539582252502441
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.987 Vali Acc: 0.857 Test Loss: 0.987 Test Acc: 0.857
Validation loss decreased (-0.802690 --> -0.856747).  Saving model ...
Epoch: 5 cost time: 1.9218177795410156
Epoch: 5, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.728 Vali Acc: 0.886 Test Loss: 0.728 Test Acc: 0.886
Validation loss decreased (-0.856747 --> -0.886479).  Saving model ...
Epoch: 6 cost time: 2.0831856727600098
Epoch: 6, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.560 Vali Acc: 0.897 Test Loss: 0.560 Test Acc: 0.897
Validation loss decreased (-0.886479 --> -0.897292).  Saving model ...
Epoch: 7 cost time: 2.2449517250061035
Epoch: 7, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
Validation loss decreased (-0.897292 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 2.092545747756958
Epoch: 8, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.319 Vali Acc: 0.932 Test Loss: 0.319 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 1.9438011646270752
Epoch: 9, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.273 Vali Acc: 0.951 Test Loss: 0.273 Test Acc: 0.951
Validation loss decreased (-0.932429 --> -0.951349).  Saving model ...
Epoch: 10 cost time: 1.6662089824676514
Epoch: 10, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6739108562469482
Epoch: 11, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.8406999111175537
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 1.8926920890808105
Epoch: 13, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.8901267051696777
Epoch: 14, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.751046895980835
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.063173294067383
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 2.0733566284179688
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4561543464660645
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0259084701538086
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.7386672496795654
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.927473545074463
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.93794846534729
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6956872940063477
Epoch: 23, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7914633750915527
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.721987009048462
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.959 Test Loss: 0.101 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7985985279083252
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.959 Test Loss: 0.097 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8426105976104736
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.112243175506592
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1400444507598877
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 636681
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.397571563720703
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.001 Vali Acc: 0.424 Test Loss: 2.001 Test Acc: 0.424
Validation loss decreased (inf --> -0.424304).  Saving model ...
Epoch: 2 cost time: 1.898866891860962
Epoch: 2, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.654 Vali Acc: 0.697 Test Loss: 1.654 Test Acc: 0.697
Validation loss decreased (-0.424304 --> -0.697281).  Saving model ...
Epoch: 3 cost time: 1.8256404399871826
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.278 Vali Acc: 0.824 Test Loss: 1.278 Test Acc: 0.824
Validation loss decreased (-0.697281 --> -0.824312).  Saving model ...
Epoch: 4 cost time: 1.8050222396850586
Epoch: 4, Steps: 17 | Train Loss: 1.110 Vali Loss: 0.968 Vali Acc: 0.868 Test Loss: 0.968 Test Acc: 0.868
Validation loss decreased (-0.824312 --> -0.867558).  Saving model ...
Epoch: 5 cost time: 1.743278980255127
Epoch: 5, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.867558 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 1.721620798110962
Epoch: 6, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.531 Vali Acc: 0.905 Test Loss: 0.531 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905400).  Saving model ...
Epoch: 7 cost time: 1.983501672744751
Epoch: 7, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.401 Vali Acc: 0.924 Test Loss: 0.401 Test Acc: 0.924
Validation loss decreased (-0.905400 --> -0.924320).  Saving model ...
Epoch: 8 cost time: 1.9654579162597656
Epoch: 8, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.924320 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.8717918395996094
Epoch: 9, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.262 Vali Acc: 0.954 Test Loss: 0.262 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 10 cost time: 1.908905029296875
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9863102436065674
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.7078301906585693
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 1.944392442703247
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 2.064192771911621
Epoch: 14, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.606088638305664
Epoch: 15, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7784297466278076
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.810804843902588
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6783924102783203
Epoch: 18, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9914777278900146
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9931626319885254
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.026564121246338
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0247106552124023
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 2.0225021839141846
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9909775257110596
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8698461055755615
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0109708309173584
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9870805740356445
Epoch: 27, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9255187511444092
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.679494857788086
Epoch: 29, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7117981910705566
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8077754974365234
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.0678207874298096
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 33 cost time: 1.9754548072814941
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.0648398399353027
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.1047308444976807
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.8658270835876465
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.1108198165893555
Epoch: 37, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.944040060043335
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8966484069824219
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.914304494857788
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.2722513675689697
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6815221309661865
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.7474746704101562
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.7580816745758057
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6263420581817627
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 636681
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.65200138092041
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.034 Vali Acc: 0.289 Test Loss: 2.034 Test Acc: 0.289
Validation loss decreased (inf --> -0.289169).  Saving model ...
Epoch: 2 cost time: 1.9510433673858643
Epoch: 2, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.694 Vali Acc: 0.638 Test Loss: 1.694 Test Acc: 0.638
Validation loss decreased (-0.289169 --> -0.637821).  Saving model ...
Epoch: 3 cost time: 1.7521395683288574
Epoch: 3, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.346 Vali Acc: 0.776 Test Loss: 1.346 Test Acc: 0.776
Validation loss decreased (-0.637821 --> -0.775662).  Saving model ...
Epoch: 4 cost time: 1.8845112323760986
Epoch: 4, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.032 Vali Acc: 0.862 Test Loss: 1.032 Test Acc: 0.862
Validation loss decreased (-0.775662 --> -0.862152).  Saving model ...
Epoch: 5 cost time: 1.930518388748169
Epoch: 5, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.782 Vali Acc: 0.873 Test Loss: 0.782 Test Acc: 0.873
Validation loss decreased (-0.862152 --> -0.872965).  Saving model ...
Epoch: 6 cost time: 1.7274348735809326
Epoch: 6, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.872965 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 1.7593820095062256
Epoch: 7, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.455 Vali Acc: 0.919 Test Loss: 0.455 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918914).  Saving model ...
Epoch: 8 cost time: 1.7717998027801514
Epoch: 8, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.357 Vali Acc: 0.932 Test Loss: 0.357 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 1.8186464309692383
Epoch: 9, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.313 Vali Acc: 0.938 Test Loss: 0.313 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 1.6337463855743408
Epoch: 10, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.8024804592132568
Epoch: 11, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.3589985370635986
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9722914695739746
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.9049460887908936
Epoch: 14, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.9414470195770264
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.034949779510498
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6604812145233154
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.688072919845581
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 1.6533639430999756
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.8415274620056152
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0032272338867188
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.975590705871582
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6837844848632812
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7499351501464844
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.6980876922607422
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8585803508758545
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.65584135055542
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6751959323883057
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5911309719085693
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 30 cost time: 1.716522455215454
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7012131214141846
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8530664443969727
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9859893321990967
Epoch: 33, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 34 cost time: 1.7908082008361816
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.638383150100708
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.147153377532959
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.955773115158081
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.362574815750122
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.0437211990356445
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 40 cost time: 1.9763860702514648
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 1.8304128646850586
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.041454553604126
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9195919036865234
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.798736572265625
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8862571716308594
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.7490549087524414
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.7435646057128906
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.7918334007263184
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.9362094402313232
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 50 cost time: 1.9728643894195557
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 51 cost time: 2.1980912685394287
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.8925061225891113
Epoch: 52, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.9154646396636963
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.7685387134552002
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.6729736328125
Epoch: 55, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.9231984615325928
Epoch: 56, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.7613205909729004
Epoch: 57, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.7811260223388672
Epoch: 58, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.089111804962158
Epoch: 59, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.9905133247375488
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 374537
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.221894264221191
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.037 Vali Acc: 0.300 Test Loss: 2.037 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 1.8031790256500244
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.694 Vali Acc: 0.646 Test Loss: 1.694 Test Acc: 0.646
Validation loss decreased (-0.299980 --> -0.645929).  Saving model ...
Epoch: 3 cost time: 1.9408714771270752
Epoch: 3, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.346 Vali Acc: 0.781 Test Loss: 1.346 Test Acc: 0.781
Validation loss decreased (-0.645929 --> -0.781068).  Saving model ...
Epoch: 4 cost time: 1.7000551223754883
Epoch: 4, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.034 Vali Acc: 0.849 Test Loss: 1.034 Test Acc: 0.849
Validation loss decreased (-0.781068 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 1.9763731956481934
Epoch: 5, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.782 Vali Acc: 0.886 Test Loss: 0.782 Test Acc: 0.886
Validation loss decreased (-0.848638 --> -0.886479).  Saving model ...
Epoch: 6 cost time: 1.8412890434265137
Epoch: 6, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.582 Vali Acc: 0.903 Test Loss: 0.582 Test Acc: 0.903
Validation loss decreased (-0.886479 --> -0.902697).  Saving model ...
Epoch: 7 cost time: 2.147458076477051
Epoch: 7, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.455 Vali Acc: 0.924 Test Loss: 0.455 Test Acc: 0.924
Validation loss decreased (-0.902697 --> -0.924320).  Saving model ...
Epoch: 8 cost time: 2.2056713104248047
Epoch: 8, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.356 Vali Acc: 0.935 Test Loss: 0.356 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935132).  Saving model ...
Epoch: 9 cost time: 1.986459493637085
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 1.7776968479156494
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.8954896926879883
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.9240095615386963
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9632532596588135
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.7317607402801514
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.7922937870025635
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.690579891204834
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.08327579498291
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.897385597229004
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 1.9073479175567627
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.97357177734375
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.876619577407837
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1332175731658936
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.105823516845703
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.111025333404541
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.6344125270843506
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6959216594696045
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.011599540710449
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 28 cost time: 1.833498477935791
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.959031105041504
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.52321195602417
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.033770799636841
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 32 cost time: 1.9577083587646484
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0209224224090576
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.141195774078369
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0202531814575195
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0248446464538574
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 1.8486709594726562
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0317416191101074
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0992746353149414
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0129408836364746
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.0262787342071533
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.172778844833374
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.040083646774292
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.982625961303711
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.006427764892578
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.0857560634613037
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 374537
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.226202011108398
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.046 Vali Acc: 0.308 Test Loss: 2.046 Test Acc: 0.308
Validation loss decreased (inf --> -0.308088).  Saving model ...
Epoch: 2 cost time: 2.2539215087890625
Epoch: 2, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.698 Vali Acc: 0.624 Test Loss: 1.698 Test Acc: 0.624
Validation loss decreased (-0.308088 --> -0.624307).  Saving model ...
Epoch: 3 cost time: 1.8884499073028564
Epoch: 3, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.348 Vali Acc: 0.789 Test Loss: 1.348 Test Acc: 0.789
Validation loss decreased (-0.624307 --> -0.789176).  Saving model ...
Epoch: 4 cost time: 1.9803857803344727
Epoch: 4, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.035 Vali Acc: 0.849 Test Loss: 1.035 Test Acc: 0.849
Validation loss decreased (-0.789176 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 2.0030577182769775
Epoch: 5, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.780 Vali Acc: 0.876 Test Loss: 0.780 Test Acc: 0.876
Validation loss decreased (-0.848638 --> -0.875668).  Saving model ...
Epoch: 6 cost time: 1.996654748916626
Epoch: 6, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.579 Vali Acc: 0.908 Test Loss: 0.579 Test Acc: 0.908
Validation loss decreased (-0.875668 --> -0.908102).  Saving model ...
Epoch: 7 cost time: 2.0930678844451904
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.908102 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 2.0489389896392822
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.352 Vali Acc: 0.932 Test Loss: 0.352 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 1.6798393726348877
Epoch: 9, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
Validation loss decreased (-0.932429 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.9492146968841553
Epoch: 10, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 1.8936657905578613
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 2.1990807056427
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9645500183105469
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 2.0964226722717285
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.9977951049804688
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0147111415863037
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.975921630859375
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.802150011062622
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 19 cost time: 1.6646678447723389
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 1.6626927852630615
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.985499382019043
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9418599605560303
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5574867725372314
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0120458602905273
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7202532291412354
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0800204277038574
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9141411781311035
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.1551239490509033
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9271879196166992
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 374537
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.492591381072998
Epoch: 1, Steps: 17 | Train Loss: 2.193 Vali Loss: 2.035 Vali Acc: 0.295 Test Loss: 2.035 Test Acc: 0.295
Validation loss decreased (inf --> -0.294574).  Saving model ...
Epoch: 2 cost time: 1.6581997871398926
Epoch: 2, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.693 Vali Acc: 0.638 Test Loss: 1.693 Test Acc: 0.638
Validation loss decreased (-0.294574 --> -0.637821).  Saving model ...
Epoch: 3 cost time: 1.7862253189086914
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.343 Vali Acc: 0.800 Test Loss: 1.343 Test Acc: 0.800
Validation loss decreased (-0.637821 --> -0.799987).  Saving model ...
Epoch: 4 cost time: 1.5100681781768799
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.021 Vali Acc: 0.862 Test Loss: 1.021 Test Acc: 0.862
Validation loss decreased (-0.799987 --> -0.862152).  Saving model ...
Epoch: 5 cost time: 1.8385918140411377
Epoch: 5, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.764 Vali Acc: 0.889 Test Loss: 0.764 Test Acc: 0.889
Validation loss decreased (-0.862152 --> -0.889182).  Saving model ...
Epoch: 6 cost time: 1.9176785945892334
Epoch: 6, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.555 Vali Acc: 0.911 Test Loss: 0.555 Test Acc: 0.911
Validation loss decreased (-0.889182 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.9802191257476807
Epoch: 7, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.427 Vali Acc: 0.938 Test Loss: 0.427 Test Acc: 0.938
Validation loss decreased (-0.910805 --> -0.937834).  Saving model ...
Epoch: 8 cost time: 1.7935330867767334
Epoch: 8, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.335 Vali Acc: 0.941 Test Loss: 0.335 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.77915620803833
Epoch: 9, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9594597816467285
Epoch: 10, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 1.6954891681671143
Epoch: 11, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.8025660514831543
Epoch: 12, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.6523001194000244
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 1.5679831504821777
Epoch: 14, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7551593780517578
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7723560333251953
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.7931387424468994
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7058618068695068
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9435968399047852
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.846658706665039
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 21 cost time: 1.6638410091400146
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 1.6314728260040283
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.705641269683838
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7261548042297363
Epoch: 24, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 25 cost time: 1.7688543796539307
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6171863079071045
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8082408905029297
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 2.04758358001709
Epoch: 28, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9194304943084717
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9305565357208252
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 1.902665615081787
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7806217670440674
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8815021514892578
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6739084720611572
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8531534671783447
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7785868644714355
Epoch: 36, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 37 cost time: 1.8965513706207275
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8292014598846436
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0308985710144043
Epoch: 39, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8939642906188965
Epoch: 40, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 41 cost time: 1.809067726135254
Epoch: 41, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9549622535705566
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8410687446594238
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9549851417541504
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6409456729888916
Epoch: 45, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.754775047302246
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.117872476577759
Epoch: 47, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8553810119628906
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.748647928237915
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.0545926094055176
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 374537
model size : 3.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9405293464660645
Epoch: 1, Steps: 17 | Train Loss: 2.220 Vali Loss: 2.105 Vali Acc: 0.235 Test Loss: 2.105 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 1.6163051128387451
Epoch: 2, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.732 Vali Acc: 0.592 Test Loss: 1.732 Test Acc: 0.592
Validation loss decreased (-0.235114 --> -0.591875).  Saving model ...
Epoch: 3 cost time: 1.8082542419433594
Epoch: 3, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.363 Vali Acc: 0.792 Test Loss: 1.363 Test Acc: 0.792
Validation loss decreased (-0.591875 --> -0.791878).  Saving model ...
Epoch: 4 cost time: 2.037475109100342
Epoch: 4, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.030 Vali Acc: 0.862 Test Loss: 1.030 Test Acc: 0.862
Validation loss decreased (-0.791878 --> -0.862152).  Saving model ...
Epoch: 5 cost time: 1.7359516620635986
Epoch: 5, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.777 Vali Acc: 0.884 Test Loss: 0.777 Test Acc: 0.884
Validation loss decreased (-0.862152 --> -0.883776).  Saving model ...
Epoch: 6 cost time: 1.7926619052886963
Epoch: 6, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.592 Vali Acc: 0.908 Test Loss: 0.592 Test Acc: 0.908
Validation loss decreased (-0.883776 --> -0.908102).  Saving model ...
Epoch: 7 cost time: 1.8923287391662598
Epoch: 7, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.462 Vali Acc: 0.927 Test Loss: 0.462 Test Acc: 0.927
Validation loss decreased (-0.908102 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.9981863498687744
Epoch: 8, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.9141838550567627
Epoch: 9, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.296 Vali Acc: 0.943 Test Loss: 0.296 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 2.231147527694702
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 2.0423471927642822
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6750996112823486
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 1.8626353740692139
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.851745843887329
Epoch: 14, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.962160 --> -0.972971).  Saving model ...
Epoch: 15 cost time: 1.4253733158111572
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.990900993347168
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.762418508529663
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.60048246383667
Epoch: 18, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5479545593261719
Epoch: 19, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9894514083862305
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.067831516265869
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 1.860771656036377
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6509697437286377
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5674958229064941
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.781564474105835
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.932776689529419
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8233613967895508
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7102782726287842
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5243070125579834
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.742967128753662
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.6238999366760254
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8803672790527344
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6701321601867676
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7625370025634766
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6322617530822754
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8492956161499023
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.9056100845336914
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.9343137741088867
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.7461621761322021
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6689729690551758
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.7137079238891602
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7866201400756836
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6772053241729736
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7634224891662598
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9983587265014648
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 2.0689470767974854
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.178480863571167
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 48 cost time: 2.200355052947998
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.060795783996582
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.640932559967041
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.7405016422271729
Epoch: 51, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.8598663806915283
Epoch: 52, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.6739559173583984
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.841843843460083
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.9463889598846436
Epoch: 55, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.8657104969024658
Epoch: 56, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 2.0884273052215576
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 243465
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.991086959838867
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.102 Vali Acc: 0.238 Test Loss: 2.102 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.8746922016143799
Epoch: 2, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.731 Vali Acc: 0.600 Test Loss: 1.731 Test Acc: 0.600
Validation loss decreased (-0.237817 --> -0.599983).  Saving model ...
Epoch: 3 cost time: 1.9931254386901855
Epoch: 3, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.365 Vali Acc: 0.797 Test Loss: 1.365 Test Acc: 0.797
Validation loss decreased (-0.599983 --> -0.797284).  Saving model ...
Epoch: 4 cost time: 1.8313443660736084
Epoch: 4, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.033 Vali Acc: 0.865 Test Loss: 1.033 Test Acc: 0.865
Validation loss decreased (-0.797284 --> -0.864855).  Saving model ...
Epoch: 5 cost time: 1.7376818656921387
Epoch: 5, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.777 Vali Acc: 0.870 Test Loss: 0.777 Test Acc: 0.870
Validation loss decreased (-0.864855 --> -0.870262).  Saving model ...
Epoch: 6 cost time: 1.8110666275024414
Epoch: 6, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
Validation loss decreased (-0.870262 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 1.689145565032959
Epoch: 7, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.463 Vali Acc: 0.922 Test Loss: 0.463 Test Acc: 0.922
Validation loss decreased (-0.899994 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 1.9660189151763916
Epoch: 8, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.921617 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.8124608993530273
Epoch: 9, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.9544892311096191
Epoch: 10, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.247 Vali Acc: 0.951 Test Loss: 0.247 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.984809160232544
Epoch: 11, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6744294166564941
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 1.9172029495239258
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0029637813568115
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.8571727275848389
Epoch: 15, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0900118350982666
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.699472427368164
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.6500427722930908
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.5987672805786133
Epoch: 19, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.89622163772583
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6796448230743408
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.8546063899993896
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4947798252105713
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.136202335357666
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.7011444568634033
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.6371550559997559
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.034938097000122
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.7621686458587646
Epoch: 28, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.972545862197876
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7589361667633057
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.958380937576294
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.107771873474121
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.8773577213287354
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.9885826110839844
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9417681694030762
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8074052333831787
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7335166931152344
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.8442811965942383
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8776206970214844
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7871489524841309
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.7257587909698486
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9602677822113037
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9060711860656738
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6827197074890137
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 45 cost time: 1.69212007522583
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.512056589126587
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7990920543670654
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 48 cost time: 1.9050734043121338
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8517203330993652
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6951286792755127
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.7172133922576904
Epoch: 51, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 2.0040180683135986
Epoch: 52, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.8466095924377441
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 2.0968942642211914
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.9099175930023193
Epoch: 55, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 2.0610454082489014
Epoch: 56, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.8096423149108887
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 243465
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8764665126800537
Epoch: 1, Steps: 17 | Train Loss: 2.224 Vali Loss: 2.105 Vali Acc: 0.232 Test Loss: 2.105 Test Acc: 0.232
Validation loss decreased (inf --> -0.232411).  Saving model ...
Epoch: 2 cost time: 1.5353662967681885
Epoch: 2, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.729 Vali Acc: 0.600 Test Loss: 1.729 Test Acc: 0.600
Validation loss decreased (-0.232411 --> -0.599983).  Saving model ...
Epoch: 3 cost time: 1.9547743797302246
Epoch: 3, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.359 Vali Acc: 0.792 Test Loss: 1.359 Test Acc: 0.792
Validation loss decreased (-0.599983 --> -0.791878).  Saving model ...
Epoch: 4 cost time: 2.009620428085327
Epoch: 4, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.029 Vali Acc: 0.854 Test Loss: 1.029 Test Acc: 0.854
Validation loss decreased (-0.791878 --> -0.854044).  Saving model ...
Epoch: 5 cost time: 2.172013282775879
Epoch: 5, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.774 Vali Acc: 0.870 Test Loss: 0.774 Test Acc: 0.870
Validation loss decreased (-0.854044 --> -0.870263).  Saving model ...
Epoch: 6 cost time: 2.0704939365386963
Epoch: 6, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.593 Vali Acc: 0.895 Test Loss: 0.593 Test Acc: 0.895
Validation loss decreased (-0.870263 --> -0.894589).  Saving model ...
Epoch: 7 cost time: 2.1143596172332764
Epoch: 7, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.461 Vali Acc: 0.919 Test Loss: 0.461 Test Acc: 0.919
Validation loss decreased (-0.894589 --> -0.918914).  Saving model ...
Epoch: 8 cost time: 1.9931933879852295
Epoch: 8, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.356 Vali Acc: 0.935 Test Loss: 0.356 Test Acc: 0.935
Validation loss decreased (-0.918914 --> -0.935132).  Saving model ...
Epoch: 9 cost time: 1.6114370822906494
Epoch: 9, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.501904010772705
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.243 Vali Acc: 0.954 Test Loss: 0.243 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 11 cost time: 1.9689738750457764
Epoch: 11, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7814176082611084
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 13 cost time: 1.8302979469299316
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 2.064913511276245
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 15 cost time: 2.0206785202026367
Epoch: 15, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9127559661865234
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 1.902372121810913
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 18 cost time: 1.8752846717834473
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.7200632095336914
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8307855129241943
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.6798310279846191
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.911696434020996
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.8777074813842773
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.7258071899414062
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.8286983966827393
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.9151802062988281
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.9532113075256348
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 1.8777203559875488
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.982435703277588
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.9975643157958984
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.7636463642120361
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.957742691040039
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6823079586029053
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.6837587356567383
Epoch: 34, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8099424839019775
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7795133590698242
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.7097229957580566
Epoch: 37, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7006151676177979
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4791910648345947
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.7750053405761719
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.69223952293396
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8409559726715088
Epoch: 42, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.77767014503479
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9369277954101562
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8383853435516357
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.0091121196746826
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.783888339996338
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.0991265773773193
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.784221887588501
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4792213439941406
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 243465
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9074411392211914
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.114 Vali Acc: 0.227 Test Loss: 2.114 Test Acc: 0.227
Validation loss decreased (inf --> -0.227006).  Saving model ...
Epoch: 2 cost time: 1.8235929012298584
Epoch: 2, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.746 Vali Acc: 0.592 Test Loss: 1.746 Test Acc: 0.592
Validation loss decreased (-0.227006 --> -0.591874).  Saving model ...
Epoch: 3 cost time: 1.637171745300293
Epoch: 3, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.376 Vali Acc: 0.800 Test Loss: 1.376 Test Acc: 0.800
Validation loss decreased (-0.591874 --> -0.799986).  Saving model ...
Epoch: 4 cost time: 1.701533317565918
Epoch: 4, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.042 Vali Acc: 0.859 Test Loss: 1.042 Test Acc: 0.859
Validation loss decreased (-0.799986 --> -0.859449).  Saving model ...
Epoch: 5 cost time: 1.91554594039917
Epoch: 5, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.781 Vali Acc: 0.876 Test Loss: 0.781 Test Acc: 0.876
Validation loss decreased (-0.859449 --> -0.875668).  Saving model ...
Epoch: 6 cost time: 1.7633728981018066
Epoch: 6, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
Validation loss decreased (-0.875668 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 1.7017767429351807
Epoch: 7, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.461 Vali Acc: 0.911 Test Loss: 0.461 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.910806).  Saving model ...
Epoch: 8 cost time: 1.6955773830413818
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.910806 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 1.7165663242340088
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.705496072769165
Epoch: 10, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.5723333358764648
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5361249446868896
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.605039358139038
Epoch: 13, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.5712099075317383
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7519407272338867
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 16 cost time: 1.9559104442596436
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.8521013259887695
Epoch: 17, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7403790950775146
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7746803760528564
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 1.6899199485778809
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7559154033660889
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 1.6257123947143555
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8613052368164062
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.926933765411377
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8413856029510498
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 26 cost time: 1.7376258373260498
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8626718521118164
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 1.887679100036621
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9409828186035156
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.959 Test Loss: 0.102 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9446136951446533
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 2.03979229927063
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8182148933410645
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8374247550964355
Epoch: 33, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8739452362060547
Epoch: 34, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.7912588119506836
Epoch: 35, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.959 Test Loss: 0.108 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8614592552185059
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.666703701019287
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.8648722171783447
Epoch: 38, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9931659698486328
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8922576904296875
Epoch: 40, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 243465
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9987595081329346
Epoch: 1, Steps: 17 | Train Loss: 2.274 Vali Loss: 2.121 Vali Acc: 0.173 Test Loss: 2.121 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 1.8853225708007812
Epoch: 2, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.743 Vali Acc: 0.608 Test Loss: 1.743 Test Acc: 0.608
Validation loss decreased (-0.172952 --> -0.608091).  Saving model ...
Epoch: 3 cost time: 1.7184703350067139
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.343 Vali Acc: 0.795 Test Loss: 1.343 Test Acc: 0.795
Validation loss decreased (-0.608091 --> -0.794581).  Saving model ...
Epoch: 4 cost time: 1.8395562171936035
Epoch: 4, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.044 Vali Acc: 0.841 Test Loss: 1.044 Test Acc: 0.841
Validation loss decreased (-0.794581 --> -0.840530).  Saving model ...
Epoch: 5 cost time: 1.6139392852783203
Epoch: 5, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.784 Vali Acc: 0.892 Test Loss: 0.784 Test Acc: 0.892
Validation loss decreased (-0.840530 --> -0.891884).  Saving model ...
Epoch: 6 cost time: 1.7952489852905273
Epoch: 6, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.891884 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 1.813863754272461
Epoch: 7, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.899994 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.9683582782745361
Epoch: 8, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.369 Vali Acc: 0.935 Test Loss: 0.369 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.7246274948120117
Epoch: 9, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.325 Vali Acc: 0.927 Test Loss: 0.325 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6449060440063477
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.935131 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.8433668613433838
Epoch: 11, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.8115029335021973
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 13 cost time: 1.5683605670928955
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.056107997894287
Epoch: 14, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8898961544036865
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.923764944076538
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 2.2704360485076904
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0579261779785156
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 2.055462121963501
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.941901683807373
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.148252248764038
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8345677852630615
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.792909860610962
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.892174482345581
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7942602634429932
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 2.0222620964050293
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1382522583007812
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4131476879119873
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0080738067626953
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.154524803161621
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.004423141479492
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.266512632369995
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8377904891967773
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0948128700256348
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.114915609359741
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 177929
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.391634941101074
Epoch: 1, Steps: 17 | Train Loss: 2.272 Vali Loss: 2.129 Vali Acc: 0.170 Test Loss: 2.129 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 1.9098169803619385
Epoch: 2, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.752 Vali Acc: 0.600 Test Loss: 1.752 Test Acc: 0.600
Validation loss decreased (-0.170249 --> -0.599982).  Saving model ...
Epoch: 3 cost time: 1.6038331985473633
Epoch: 3, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.353 Vali Acc: 0.789 Test Loss: 1.353 Test Acc: 0.789
Validation loss decreased (-0.599982 --> -0.789176).  Saving model ...
Epoch: 4 cost time: 1.6509652137756348
Epoch: 4, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.053 Vali Acc: 0.830 Test Loss: 1.053 Test Acc: 0.830
Validation loss decreased (-0.789176 --> -0.829719).  Saving model ...
Epoch: 5 cost time: 1.781512975692749
Epoch: 5, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.794 Vali Acc: 0.881 Test Loss: 0.794 Test Acc: 0.881
Validation loss decreased (-0.829719 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 1.8063788414001465
Epoch: 6, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.604 Vali Acc: 0.897 Test Loss: 0.604 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897291).  Saving model ...
Epoch: 7 cost time: 1.6670866012573242
Epoch: 7, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.462 Vali Acc: 0.930 Test Loss: 0.462 Test Acc: 0.930
Validation loss decreased (-0.897291 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.6695032119750977
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.734691858291626
Epoch: 9, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0496160984039307
Epoch: 10, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.253 Vali Acc: 0.943 Test Loss: 0.253 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.8236806392669678
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (-0.943241 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.7536532878875732
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 13 cost time: 1.7084813117980957
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5770339965820312
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7946298122406006
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8204243183135986
Epoch: 16, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.6830973625183105
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6743993759155273
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 1.6439392566680908
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8527135848999023
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7695443630218506
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8954863548278809
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.531163215637207
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6408989429473877
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8335285186767578
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.7721083164215088
Epoch: 26, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9401440620422363
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8145182132720947
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.934185266494751
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.701282024383545
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7055132389068604
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.7188670635223389
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7051877975463867
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7786338329315186
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4616799354553223
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7116444110870361
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5317740440368652
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7821464538574219
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8027186393737793
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.9009356498718262
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.8257200717926025
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 177929
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.888383626937866
Epoch: 1, Steps: 17 | Train Loss: 2.278 Vali Loss: 2.134 Vali Acc: 0.181 Test Loss: 2.134 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 1.780355453491211
Epoch: 2, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.754 Vali Acc: 0.592 Test Loss: 1.754 Test Acc: 0.592
Validation loss decreased (-0.181060 --> -0.591874).  Saving model ...
Epoch: 3 cost time: 1.7192108631134033
Epoch: 3, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.353 Vali Acc: 0.789 Test Loss: 1.353 Test Acc: 0.789
Validation loss decreased (-0.591874 --> -0.789176).  Saving model ...
Epoch: 4 cost time: 1.5281364917755127
Epoch: 4, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.055 Vali Acc: 0.830 Test Loss: 1.055 Test Acc: 0.830
Validation loss decreased (-0.789176 --> -0.829719).  Saving model ...
Epoch: 5 cost time: 1.5823276042938232
Epoch: 5, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.796 Vali Acc: 0.881 Test Loss: 0.796 Test Acc: 0.881
Validation loss decreased (-0.829719 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 2.0780203342437744
Epoch: 6, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.607 Vali Acc: 0.895 Test Loss: 0.607 Test Acc: 0.895
Validation loss decreased (-0.881073 --> -0.894589).  Saving model ...
Epoch: 7 cost time: 1.670605182647705
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.463 Vali Acc: 0.927 Test Loss: 0.463 Test Acc: 0.927
Validation loss decreased (-0.894589 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.6554064750671387
Epoch: 8, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 1.7408990859985352
Epoch: 9, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 10 cost time: 1.6998488903045654
Epoch: 10, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 1.717961311340332
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.682321310043335
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.9262797832489014
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.5173661708831787
Epoch: 14, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7518768310546875
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.8346986770629883
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.6441247463226318
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.8839538097381592
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975674).  Saving model ...
Epoch: 19 cost time: 1.7935435771942139
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.772871971130371
Epoch: 20, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8786242008209229
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.89420485496521
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6030521392822266
Epoch: 23, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7382464408874512
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.981156826019287
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.940958023071289
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7433829307556152
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.891800880432129
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5827100276947021
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1927103996276855
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.022336483001709
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.103440761566162
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0325660705566406
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6405789852142334
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5532958507537842
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 177929
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.0404582023620605
Epoch: 1, Steps: 17 | Train Loss: 2.258 Vali Loss: 2.126 Vali Acc: 0.181 Test Loss: 2.126 Test Acc: 0.181
Validation loss decreased (inf --> -0.181060).  Saving model ...
Epoch: 2 cost time: 1.7386445999145508
Epoch: 2, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.758 Vali Acc: 0.632 Test Loss: 1.758 Test Acc: 0.632
Validation loss decreased (-0.181060 --> -0.632415).  Saving model ...
Epoch: 3 cost time: 1.8275535106658936
Epoch: 3, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.365 Vali Acc: 0.803 Test Loss: 1.365 Test Acc: 0.803
Validation loss decreased (-0.632415 --> -0.802689).  Saving model ...
Epoch: 4 cost time: 1.7431058883666992
Epoch: 4, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.062 Vali Acc: 0.832 Test Loss: 1.062 Test Acc: 0.832
Validation loss decreased (-0.802689 --> -0.832422).  Saving model ...
Epoch: 5 cost time: 1.751887321472168
Epoch: 5, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.800 Vali Acc: 0.881 Test Loss: 0.800 Test Acc: 0.881
Validation loss decreased (-0.832422 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 1.76495361328125
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.608 Vali Acc: 0.897 Test Loss: 0.608 Test Acc: 0.897
Validation loss decreased (-0.881073 --> -0.897291).  Saving model ...
Epoch: 7 cost time: 1.8223645687103271
Epoch: 7, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.897291 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 1.859614372253418
Epoch: 8, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.374 Vali Acc: 0.927 Test Loss: 0.374 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 9 cost time: 1.6567614078521729
Epoch: 9, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 10 cost time: 1.5375120639801025
Epoch: 10, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.259 Vali Acc: 0.946 Test Loss: 0.259 Test Acc: 0.946
Validation loss decreased (-0.929726 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 1.5660250186920166
Epoch: 11, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.7444589138031006
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959457).  Saving model ...
Epoch: 13 cost time: 1.5207054615020752
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6660802364349365
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.537724256515503
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.5050647258758545
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.8359451293945312
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.685197353363037
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 1.6935930252075195
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.685166597366333
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7239046096801758
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6111252307891846
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6587717533111572
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7382864952087402
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4504656791687012
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.6136260032653809
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.774580478668213
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.567920446395874
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.780832052230835
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.796011209487915
Epoch: 30, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8195271492004395
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 1.8231468200683594
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.860015869140625
Epoch: 33, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.749161958694458
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.647420883178711
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 36 cost time: 1.7040808200836182
Epoch: 36, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 1.4919941425323486
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.766430377960205
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8761494159698486
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9057276248931885
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.763038158416748
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9458038806915283
Epoch: 42, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7425029277801514
Epoch: 43, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 2.010754346847534
Epoch: 44, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 45 cost time: 1.893287181854248
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.7767412662506104
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.037431240081787
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8620522022247314
Epoch: 48, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.7085397243499756
Epoch: 49, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.850963830947876
Epoch: 50, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.767641305923462
Epoch: 51, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.02239727973938
Epoch: 52, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.9466173648834229
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.9976780414581299
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 177929
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5850396156311035
Epoch: 1, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.046 Vali Acc: 0.257 Test Loss: 2.046 Test Acc: 0.257
Validation loss decreased (inf --> -0.256736).  Saving model ...
Epoch: 2 cost time: 1.691441297531128
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.721 Vali Acc: 0.662 Test Loss: 1.721 Test Acc: 0.662
Validation loss decreased (-0.256736 --> -0.662145).  Saving model ...
Epoch: 3 cost time: 1.577688217163086
Epoch: 3, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.370 Vali Acc: 0.795 Test Loss: 1.370 Test Acc: 0.795
Validation loss decreased (-0.662145 --> -0.794581).  Saving model ...
Epoch: 4 cost time: 1.5492527484893799
Epoch: 4, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.038 Vali Acc: 0.851 Test Loss: 1.038 Test Acc: 0.851
Validation loss decreased (-0.794581 --> -0.851341).  Saving model ...
Epoch: 5 cost time: 1.4793682098388672
Epoch: 5, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.789 Vali Acc: 0.881 Test Loss: 0.789 Test Acc: 0.881
Validation loss decreased (-0.851341 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 1.5502405166625977
Epoch: 6, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.585 Vali Acc: 0.905 Test Loss: 0.585 Test Acc: 0.905
Validation loss decreased (-0.881073 --> -0.905400).  Saving model ...
Epoch: 7 cost time: 1.7071127891540527
Epoch: 7, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.455 Vali Acc: 0.924 Test Loss: 0.455 Test Acc: 0.924
Validation loss decreased (-0.905400 --> -0.924320).  Saving model ...
Epoch: 8 cost time: 1.7080535888671875
Epoch: 8, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.366 Vali Acc: 0.935 Test Loss: 0.366 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.8319385051727295
Epoch: 9, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.295 Vali Acc: 0.946 Test Loss: 0.295 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.6921582221984863
Epoch: 10, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.8064906597137451
Epoch: 11, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.6777892112731934
Epoch: 12, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6075663566589355
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.6125009059906006
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6957035064697266
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.6276021003723145
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.473071575164795
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8735058307647705
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5505173206329346
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5851271152496338
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7652769088745117
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7373766899108887
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.84023118019104
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.6813020706176758
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8612632751464844
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.6693129539489746
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3951902389526367
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5905733108520508
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.507458209991455
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4313113689422607
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5312330722808838
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4659757614135742
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4886908531188965
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4968485832214355
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6407389640808105
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 145161
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6661899089813232
Epoch: 1, Steps: 17 | Train Loss: 2.184 Vali Loss: 2.061 Vali Acc: 0.241 Test Loss: 2.061 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 1.7560858726501465
Epoch: 2, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.735 Vali Acc: 0.638 Test Loss: 1.735 Test Acc: 0.638
Validation loss decreased (-0.240520 --> -0.637820).  Saving model ...
Epoch: 3 cost time: 1.475449562072754
Epoch: 3, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.381 Vali Acc: 0.778 Test Loss: 1.381 Test Acc: 0.778
Validation loss decreased (-0.637820 --> -0.778365).  Saving model ...
Epoch: 4 cost time: 1.5252716541290283
Epoch: 4, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.050 Vali Acc: 0.841 Test Loss: 1.050 Test Acc: 0.841
Validation loss decreased (-0.778365 --> -0.840530).  Saving model ...
Epoch: 5 cost time: 1.457448959350586
Epoch: 5, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.800 Vali Acc: 0.886 Test Loss: 0.800 Test Acc: 0.886
Validation loss decreased (-0.840530 --> -0.886478).  Saving model ...
Epoch: 6 cost time: 1.6472132205963135
Epoch: 6, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.596 Vali Acc: 0.903 Test Loss: 0.596 Test Acc: 0.903
Validation loss decreased (-0.886478 --> -0.902697).  Saving model ...
Epoch: 7 cost time: 1.76242995262146
Epoch: 7, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.462 Vali Acc: 0.919 Test Loss: 0.462 Test Acc: 0.919
Validation loss decreased (-0.902697 --> -0.918914).  Saving model ...
Epoch: 8 cost time: 1.6949529647827148
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.372 Vali Acc: 0.938 Test Loss: 0.372 Test Acc: 0.938
Validation loss decreased (-0.918914 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 1.7374815940856934
Epoch: 9, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.298 Vali Acc: 0.951 Test Loss: 0.298 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951348).  Saving model ...
Epoch: 10 cost time: 1.773634433746338
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.257 Vali Acc: 0.951 Test Loss: 0.257 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.7585177421569824
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 12 cost time: 1.8755168914794922
Epoch: 12, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.832815408706665
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.184 Vali Acc: 0.962 Test Loss: 0.184 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.5064988136291504
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5125062465667725
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5442461967468262
Epoch: 16, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.632526159286499
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.4974825382232666
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.6444146633148193
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 20 cost time: 2.1447267532348633
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.015502452850342
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 2.13859486579895
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0639166831970215
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0886213779449463
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.147962808609009
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 2.1844849586486816
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1515145301818848
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7221920490264893
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8807697296142578
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7606592178344727
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8740642070770264
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.9528934955596924
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9020884037017822
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0651962757110596
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9431288242340088
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 2.0937163829803467
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 2.254150390625
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9517648220062256
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8400964736938477
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8798165321350098
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7330477237701416
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9302763938903809
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.1475443840026855
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8297703266143799
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.9688293933868408
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.1608080863952637
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.1977384090423584
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.0700838565826416
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0988423824310303
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8284921646118164
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8502397537231445
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.8874449729919434
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.11694598197937
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.1930243968963623
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 145161
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.575382471084595
Epoch: 1, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.058 Vali Acc: 0.262 Test Loss: 2.058 Test Acc: 0.262
Validation loss decreased (inf --> -0.262142).  Saving model ...
Epoch: 2 cost time: 1.7043004035949707
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.727 Vali Acc: 0.643 Test Loss: 1.727 Test Acc: 0.643
Validation loss decreased (-0.262142 --> -0.643226).  Saving model ...
Epoch: 3 cost time: 1.8005735874176025
Epoch: 3, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.372 Vali Acc: 0.776 Test Loss: 1.372 Test Acc: 0.776
Validation loss decreased (-0.643226 --> -0.775662).  Saving model ...
Epoch: 4 cost time: 1.5017845630645752
Epoch: 4, Steps: 17 | Train Loss: 1.124 Vali Loss: 1.046 Vali Acc: 0.843 Test Loss: 1.046 Test Acc: 0.843
Validation loss decreased (-0.775662 --> -0.843233).  Saving model ...
Epoch: 5 cost time: 1.580894947052002
Epoch: 5, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.799 Vali Acc: 0.878 Test Loss: 0.799 Test Acc: 0.878
Validation loss decreased (-0.843233 --> -0.878370).  Saving model ...
Epoch: 6 cost time: 1.651130199432373
Epoch: 6, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.594 Vali Acc: 0.903 Test Loss: 0.594 Test Acc: 0.903
Validation loss decreased (-0.878370 --> -0.902697).  Saving model ...
Epoch: 7 cost time: 1.39107346534729
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.466 Vali Acc: 0.919 Test Loss: 0.466 Test Acc: 0.919
Validation loss decreased (-0.902697 --> -0.918914).  Saving model ...
Epoch: 8 cost time: 1.411902904510498
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.375 Vali Acc: 0.914 Test Loss: 0.375 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8244976997375488
Epoch: 9, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.300 Vali Acc: 0.932 Test Loss: 0.300 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932429).  Saving model ...
Epoch: 10 cost time: 1.8097975254058838
Epoch: 10, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 1.7381141185760498
Epoch: 11, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.7681865692138672
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.9013934135437012
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.7606499195098877
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 1.6624865531921387
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3505842685699463
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5071346759796143
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5538828372955322
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 1.581425428390503
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.689523696899414
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.9574933052062988
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6942038536071777
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7950224876403809
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.484571933746338
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6611111164093018
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.6763269901275635
Epoch: 26, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7323358058929443
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.671623945236206
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.688530683517456
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6031036376953125
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5895068645477295
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 1.6976923942565918
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9135723114013672
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7093544006347656
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9010863304138184
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4898316860198975
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8403866291046143
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.599597692489624
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7746105194091797
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7357563972473145
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.7088828086853027
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6114165782928467
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.8047230243682861
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8374454975128174
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.8213346004486084
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.166421890258789
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.9199111461639404
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 145161
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9965503215789795
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.055 Vali Acc: 0.273 Test Loss: 2.055 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 1.6238806247711182
Epoch: 2, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.732 Vali Acc: 0.665 Test Loss: 1.732 Test Acc: 0.665
Validation loss decreased (-0.272952 --> -0.664848).  Saving model ...
Epoch: 3 cost time: 1.7776427268981934
Epoch: 3, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.381 Vali Acc: 0.784 Test Loss: 1.381 Test Acc: 0.784
Validation loss decreased (-0.664848 --> -0.783770).  Saving model ...
Epoch: 4 cost time: 1.5770213603973389
Epoch: 4, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.050 Vali Acc: 0.838 Test Loss: 1.050 Test Acc: 0.838
Validation loss decreased (-0.783770 --> -0.837827).  Saving model ...
Epoch: 5 cost time: 1.9639294147491455
Epoch: 5, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.800 Vali Acc: 0.881 Test Loss: 0.800 Test Acc: 0.881
Validation loss decreased (-0.837827 --> -0.881073).  Saving model ...
Epoch: 6 cost time: 1.7147586345672607
Epoch: 6, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.592 Vali Acc: 0.911 Test Loss: 0.592 Test Acc: 0.911
Validation loss decreased (-0.881073 --> -0.910805).  Saving model ...
Epoch: 7 cost time: 1.9248089790344238
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.464 Vali Acc: 0.924 Test Loss: 0.464 Test Acc: 0.924
Validation loss decreased (-0.910805 --> -0.924320).  Saving model ...
Epoch: 8 cost time: 1.7381696701049805
Epoch: 8, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 1.7720820903778076
Epoch: 9, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940538).  Saving model ...
Epoch: 10 cost time: 1.6991972923278809
Epoch: 10, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.267 Vali Acc: 0.943 Test Loss: 0.267 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 11 cost time: 1.5170466899871826
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.5740606784820557
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.6326186656951904
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.722520112991333
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.6839501857757568
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.5845108032226562
Epoch: 16, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7825398445129395
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.7414770126342773
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8358204364776611
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.789032220840454
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.6273596286773682
Epoch: 21, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5561864376068115
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.6230881214141846
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7486846446990967
Epoch: 24, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6564762592315674
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.520056962966919
Epoch: 26, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6842422485351562
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 28 cost time: 1.405841588973999
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7285630702972412
Epoch: 29, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.873659610748291
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.806807041168213
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.8586249351501465
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6622600555419922
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.772322416305542
Epoch: 34, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.679840087890625
Epoch: 35, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.651968240737915
Epoch: 36, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.4542410373687744
Epoch: 37, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5659608840942383
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.646423101425171
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.492765188217163
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7601871490478516
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 145161
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.2562713623046875
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.152 Vali Acc: 0.178 Test Loss: 2.152 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 1.6083664894104004
Epoch: 2, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.933 Vali Acc: 0.430 Test Loss: 1.933 Test Acc: 0.430
Validation loss decreased (-0.178357 --> -0.429710).  Saving model ...
Epoch: 3 cost time: 1.8519442081451416
Epoch: 3, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.693 Vali Acc: 0.608 Test Loss: 1.693 Test Acc: 0.608
Validation loss decreased (-0.429710 --> -0.608091).  Saving model ...
Epoch: 4 cost time: 1.3682026863098145
Epoch: 4, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.441 Vali Acc: 0.727 Test Loss: 1.441 Test Acc: 0.727
Validation loss decreased (-0.608091 --> -0.727013).  Saving model ...
Epoch: 5 cost time: 1.8213341236114502
Epoch: 5, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.199 Vali Acc: 0.816 Test Loss: 1.199 Test Acc: 0.816
Validation loss decreased (-0.727013 --> -0.816204).  Saving model ...
Epoch: 6 cost time: 1.7185757160186768
Epoch: 6, Steps: 17 | Train Loss: 1.036 Vali Loss: 0.992 Vali Acc: 0.827 Test Loss: 0.992 Test Acc: 0.827
Validation loss decreased (-0.816204 --> -0.827017).  Saving model ...
Epoch: 7 cost time: 1.7994301319122314
Epoch: 7, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.810 Vali Acc: 0.854 Test Loss: 0.810 Test Acc: 0.854
Validation loss decreased (-0.827017 --> -0.854046).  Saving model ...
Epoch: 8 cost time: 1.8284022808074951
Epoch: 8, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.660 Vali Acc: 0.886 Test Loss: 0.660 Test Acc: 0.886
Validation loss decreased (-0.854046 --> -0.886480).  Saving model ...
Epoch: 9 cost time: 1.8988802433013916
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.886480 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 1.831369161605835
Epoch: 10, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.469 Vali Acc: 0.911 Test Loss: 0.469 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.910806).  Saving model ...
Epoch: 11 cost time: 1.6762292385101318
Epoch: 11, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.910806 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.7148869037628174
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 1.78826904296875
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 14 cost time: 1.6667401790618896
Epoch: 14, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.252 Vali Acc: 0.949 Test Loss: 0.252 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 1.7894868850708008
Epoch: 15, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.252 Vali Acc: 0.938 Test Loss: 0.252 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7218639850616455
Epoch: 16, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.208 Vali Acc: 0.957 Test Loss: 0.208 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.7133569717407227
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.78279709815979
Epoch: 18, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.7521426677703857
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.7514841556549072
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7418229579925537
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.8137190341949463
Epoch: 22, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8007912635803223
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.423415184020996
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.7761714458465576
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7466356754302979
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 1.7458570003509521
Epoch: 27, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 1.9540605545043945
Epoch: 28, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.7222425937652588
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.469238042831421
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.827775478363037
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9363603591918945
Epoch: 32, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 2.03369402885437
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9376282691955566
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.6802330017089844
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.677725076675415
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7194018363952637
Epoch: 37, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.5661208629608154
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8915066719055176
Epoch: 39, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7497210502624512
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.9057223796844482
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.855008840560913
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9056191444396973
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9112803936004639
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8437354564666748
Epoch: 45, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.9332270622253418
Epoch: 46, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8877489566802979
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.7495765686035156
Epoch: 48, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.661778450012207
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7283120155334473
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 564169
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.12744927406311
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.155 Vali Acc: 0.170 Test Loss: 2.155 Test Acc: 0.170
Validation loss decreased (inf --> -0.170249).  Saving model ...
Epoch: 2 cost time: 1.8233797550201416
Epoch: 2, Steps: 17 | Train Loss: 2.048 Vali Loss: 1.935 Vali Acc: 0.422 Test Loss: 1.935 Test Acc: 0.422
Validation loss decreased (-0.170249 --> -0.421602).  Saving model ...
Epoch: 3 cost time: 1.815112829208374
Epoch: 3, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.697 Vali Acc: 0.592 Test Loss: 1.697 Test Acc: 0.592
Validation loss decreased (-0.421602 --> -0.591875).  Saving model ...
Epoch: 4 cost time: 1.9120087623596191
Epoch: 4, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.445 Vali Acc: 0.724 Test Loss: 1.445 Test Acc: 0.724
Validation loss decreased (-0.591875 --> -0.724310).  Saving model ...
Epoch: 5 cost time: 1.6712768077850342
Epoch: 5, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.202 Vali Acc: 0.811 Test Loss: 1.202 Test Acc: 0.811
Validation loss decreased (-0.724310 --> -0.810799).  Saving model ...
Epoch: 6 cost time: 1.6811292171478271
Epoch: 6, Steps: 17 | Train Loss: 1.047 Vali Loss: 0.994 Vali Acc: 0.819 Test Loss: 0.994 Test Acc: 0.819
Validation loss decreased (-0.810799 --> -0.818909).  Saving model ...
Epoch: 7 cost time: 1.8318097591400146
Epoch: 7, Steps: 17 | Train Loss: 0.831 Vali Loss: 0.806 Vali Acc: 0.854 Test Loss: 0.806 Test Acc: 0.854
Validation loss decreased (-0.818909 --> -0.854046).  Saving model ...
Epoch: 8 cost time: 1.6362998485565186
Epoch: 8, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.654 Vali Acc: 0.889 Test Loss: 0.654 Test Acc: 0.889
Validation loss decreased (-0.854046 --> -0.889183).  Saving model ...
Epoch: 9 cost time: 1.8572945594787598
Epoch: 9, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.533 Vali Acc: 0.911 Test Loss: 0.533 Test Acc: 0.911
Validation loss decreased (-0.889183 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 1.675870418548584
Epoch: 10, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.466 Vali Acc: 0.914 Test Loss: 0.466 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913509).  Saving model ...
Epoch: 11 cost time: 1.8624753952026367
Epoch: 11, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.913509 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.8639826774597168
Epoch: 12, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.327 Vali Acc: 0.938 Test Loss: 0.327 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 1.974694013595581
Epoch: 13, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 14 cost time: 2.043562412261963
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 1.6975984573364258
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7567803859710693
Epoch: 16, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.9243927001953125
Epoch: 17, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5805492401123047
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.77384352684021
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.164 Vali Acc: 0.968 Test Loss: 0.164 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.7138924598693848
Epoch: 20, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.88533616065979
Epoch: 21, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.7205188274383545
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8452658653259277
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9243648052215576
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.959355115890503
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.729912519454956
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.923344612121582
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7810773849487305
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.4934136867523193
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5741174221038818
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7819263935089111
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.5676867961883545
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.854814052581787
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8589754104614258
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 2.0130486488342285
Epoch: 35, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9784612655639648
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6745834350585938
Epoch: 37, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.6120483875274658
Epoch: 38, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7163028717041016
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 1.4554412364959717
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.737821340560913
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.124685287475586
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5999817848205566
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8651037216186523
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.720587968826294
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 46 cost time: 1.9003870487213135
Epoch: 46, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8573994636535645
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6845574378967285
Epoch: 48, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8664124011993408
Epoch: 49, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.7104525566101074
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 51 cost time: 1.6822431087493896
Epoch: 51, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 52 cost time: 2.0970447063446045
Epoch: 52, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.9319872856140137
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.9964873790740967
Epoch: 54, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.933068037033081
Epoch: 55, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.8724772930145264
Epoch: 56, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.1145577430725098
Epoch: 57, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.107339859008789
Epoch: 58, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.9424808025360107
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 60 cost time: 1.9783525466918945
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 61 cost time: 1.624413013458252
Epoch: 61, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.012004852294922
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.12764835357666
Epoch: 63, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.8181591033935547
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.5703628063201904
Epoch: 65, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.932114601135254
Epoch: 66, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 2.093860387802124
Epoch: 67, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 2.0
Epoch: 68, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 2.000688314437866
Epoch: 69, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.9395852088928223
Epoch: 70, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 564169
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.234790325164795
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.151 Vali Acc: 0.195 Test Loss: 2.151 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 1.6438491344451904
Epoch: 2, Steps: 17 | Train Loss: 2.041 Vali Loss: 1.929 Vali Acc: 0.419 Test Loss: 1.929 Test Acc: 0.419
Validation loss decreased (-0.194573 --> -0.418900).  Saving model ...
Epoch: 3 cost time: 1.517082691192627
Epoch: 3, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.688 Vali Acc: 0.597 Test Loss: 1.688 Test Acc: 0.597
Validation loss decreased (-0.418900 --> -0.597280).  Saving model ...
Epoch: 4 cost time: 1.6095411777496338
Epoch: 4, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.432 Vali Acc: 0.732 Test Loss: 1.432 Test Acc: 0.732
Validation loss decreased (-0.597280 --> -0.732418).  Saving model ...
Epoch: 5 cost time: 1.5878100395202637
Epoch: 5, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.188 Vali Acc: 0.811 Test Loss: 1.188 Test Acc: 0.811
Validation loss decreased (-0.732418 --> -0.810799).  Saving model ...
Epoch: 6 cost time: 1.5812382698059082
Epoch: 6, Steps: 17 | Train Loss: 1.040 Vali Loss: 0.978 Vali Acc: 0.822 Test Loss: 0.978 Test Acc: 0.822
Validation loss decreased (-0.810799 --> -0.821612).  Saving model ...
Epoch: 7 cost time: 1.7700550556182861
Epoch: 7, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.793 Vali Acc: 0.865 Test Loss: 0.793 Test Acc: 0.865
Validation loss decreased (-0.821612 --> -0.864857).  Saving model ...
Epoch: 8 cost time: 1.6557252407073975
Epoch: 8, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.643 Vali Acc: 0.870 Test Loss: 0.643 Test Acc: 0.870
Validation loss decreased (-0.864857 --> -0.870264).  Saving model ...
Epoch: 9 cost time: 1.5681202411651611
Epoch: 9, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.521 Vali Acc: 0.908 Test Loss: 0.521 Test Acc: 0.908
Validation loss decreased (-0.870264 --> -0.908103).  Saving model ...
Epoch: 10 cost time: 1.3441169261932373
Epoch: 10, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.453 Vali Acc: 0.914 Test Loss: 0.453 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 11 cost time: 1.492436408996582
Epoch: 11, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.368 Vali Acc: 0.938 Test Loss: 0.368 Test Acc: 0.938
Validation loss decreased (-0.913509 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 1.4400548934936523
Epoch: 12, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.319 Vali Acc: 0.943 Test Loss: 0.319 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.5301620960235596
Epoch: 13, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.286 Vali Acc: 0.951 Test Loss: 0.286 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951348).  Saving model ...
Epoch: 14 cost time: 1.521019458770752
Epoch: 14, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 1.4358069896697998
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7932450771331787
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 17 cost time: 1.6133670806884766
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.190 Vali Acc: 0.965 Test Loss: 0.190 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.6990795135498047
Epoch: 18, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 1.7327733039855957
Epoch: 19, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6428875923156738
Epoch: 20, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7393882274627686
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.6450440883636475
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 1.5176944732666016
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 24 cost time: 1.601485252380371
Epoch: 24, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.601222038269043
Epoch: 25, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.6437265872955322
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8469796180725098
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6582772731781006
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7187583446502686
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.712191104888916
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9763071537017822
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7129406929016113
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.6302356719970703
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6102700233459473
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.596972942352295
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6911234855651855
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8490886688232422
Epoch: 37, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.767594575881958
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.971998929977417
Epoch: 39, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 1.7687926292419434
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 1.9078755378723145
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.9297904968261719
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6229503154754639
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.8280751705169678
Epoch: 44, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8027887344360352
Epoch: 45, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 46 cost time: 1.7726008892059326
Epoch: 46, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.818845510482788
Epoch: 47, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8938188552856445
Epoch: 48, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.826333999633789
Epoch: 49, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.7679719924926758
Epoch: 50, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7084856033325195
Epoch: 51, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 52 cost time: 1.912482500076294
Epoch: 52, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.8553240299224854
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.7759671211242676
Epoch: 54, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 55 cost time: 1.5447008609771729
Epoch: 55, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.643153429031372
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.5362632274627686
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.7426252365112305
Epoch: 58, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.8766989707946777
Epoch: 59, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.7291769981384277
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.633277416229248
Epoch: 61, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.8379037380218506
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.8161392211914062
Epoch: 63, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.6232719421386719
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 564169
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8492701053619385
Epoch: 1, Steps: 17 | Train Loss: 2.201 Vali Loss: 2.137 Vali Acc: 0.216 Test Loss: 2.137 Test Acc: 0.216
Validation loss decreased (inf --> -0.216195).  Saving model ...
Epoch: 2 cost time: 1.525792121887207
Epoch: 2, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.915 Vali Acc: 0.508 Test Loss: 1.915 Test Acc: 0.508
Validation loss decreased (-0.216195 --> -0.508089).  Saving model ...
Epoch: 3 cost time: 1.4484775066375732
Epoch: 3, Steps: 17 | Train Loss: 1.796 Vali Loss: 1.664 Vali Acc: 0.635 Test Loss: 1.664 Test Acc: 0.635
Validation loss decreased (-0.508089 --> -0.635118).  Saving model ...
Epoch: 4 cost time: 1.6373374462127686
Epoch: 4, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.396 Vali Acc: 0.749 Test Loss: 1.396 Test Acc: 0.749
Validation loss decreased (-0.635118 --> -0.748635).  Saving model ...
Epoch: 5 cost time: 1.4818620681762695
Epoch: 5, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.141 Vali Acc: 0.803 Test Loss: 1.141 Test Acc: 0.803
Validation loss decreased (-0.748635 --> -0.802691).  Saving model ...
Epoch: 6 cost time: 1.5736172199249268
Epoch: 6, Steps: 17 | Train Loss: 1.015 Vali Loss: 0.925 Vali Acc: 0.827 Test Loss: 0.925 Test Acc: 0.827
Validation loss decreased (-0.802691 --> -0.827018).  Saving model ...
Epoch: 7 cost time: 1.5329973697662354
Epoch: 7, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.746 Vali Acc: 0.857 Test Loss: 0.746 Test Acc: 0.857
Validation loss decreased (-0.827018 --> -0.856749).  Saving model ...
Epoch: 8 cost time: 1.708451271057129
Epoch: 8, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.603 Vali Acc: 0.889 Test Loss: 0.603 Test Acc: 0.889
Validation loss decreased (-0.856749 --> -0.889183).  Saving model ...
Epoch: 9 cost time: 1.4085729122161865
Epoch: 9, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.488 Vali Acc: 0.908 Test Loss: 0.488 Test Acc: 0.908
Validation loss decreased (-0.889183 --> -0.908103).  Saving model ...
Epoch: 10 cost time: 1.5186419486999512
Epoch: 10, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.423 Vali Acc: 0.908 Test Loss: 0.423 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908104).  Saving model ...
Epoch: 11 cost time: 1.4282042980194092
Epoch: 11, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.908104 --> -0.929726).  Saving model ...
Epoch: 12 cost time: 1.4725449085235596
Epoch: 12, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.300 Vali Acc: 0.946 Test Loss: 0.300 Test Acc: 0.946
Validation loss decreased (-0.929726 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.6085805892944336
Epoch: 13, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.271 Vali Acc: 0.959 Test Loss: 0.271 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 1.6710970401763916
Epoch: 14, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 15 cost time: 1.6936724185943604
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5121972560882568
Epoch: 16, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.777777910232544
Epoch: 17, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.665832757949829
Epoch: 18, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5210647583007812
Epoch: 19, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.454709768295288
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.4889962673187256
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.536867380142212
Epoch: 22, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.6189026832580566
Epoch: 23, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.570054292678833
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.7371461391448975
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7155218124389648
Epoch: 26, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7442822456359863
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6129894256591797
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7029328346252441
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.653693675994873
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.4782288074493408
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5372443199157715
Epoch: 32, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.4230899810791016
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6628119945526123
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5982487201690674
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.740656852722168
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6437721252441406
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6361267566680908
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.6514859199523926
Epoch: 39, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.5536320209503174
Epoch: 40, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6824939250946045
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8422658443450928
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 43 cost time: 1.6921882629394531
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.438429594039917
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5189659595489502
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.7422709465026855
Epoch: 46, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.5179064273834229
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.6168086528778076
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.832970380783081
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.7559008598327637
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.7893052101135254
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.6499395370483398
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 564169
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9686551094055176
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 2.135 Vali Acc: 0.130 Test Loss: 2.135 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 1.6544501781463623
Epoch: 2, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.936 Vali Acc: 0.454 Test Loss: 1.936 Test Acc: 0.454
Validation loss decreased (-0.129708 --> -0.454035).  Saving model ...
Epoch: 3 cost time: 1.7278335094451904
Epoch: 3, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.690 Vali Acc: 0.681 Test Loss: 1.690 Test Acc: 0.681
Validation loss decreased (-0.454035 --> -0.681064).  Saving model ...
Epoch: 4 cost time: 1.6109614372253418
Epoch: 4, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.444 Vali Acc: 0.730 Test Loss: 1.444 Test Acc: 0.730
Validation loss decreased (-0.681064 --> -0.729715).  Saving model ...
Epoch: 5 cost time: 1.6623775959014893
Epoch: 5, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.219 Vali Acc: 0.795 Test Loss: 1.219 Test Acc: 0.795
Validation loss decreased (-0.729715 --> -0.794582).  Saving model ...
Epoch: 6 cost time: 1.9063868522644043
Epoch: 6, Steps: 17 | Train Loss: 1.007 Vali Loss: 0.995 Vali Acc: 0.835 Test Loss: 0.995 Test Acc: 0.835
Validation loss decreased (-0.794582 --> -0.835125).  Saving model ...
Epoch: 7 cost time: 1.8283140659332275
Epoch: 7, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.812 Vali Acc: 0.878 Test Loss: 0.812 Test Acc: 0.878
Validation loss decreased (-0.835125 --> -0.878370).  Saving model ...
Epoch: 8 cost time: 1.7559971809387207
Epoch: 8, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.667 Vali Acc: 0.900 Test Loss: 0.667 Test Acc: 0.900
Validation loss decreased (-0.878370 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 1.485224962234497
Epoch: 9, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.540 Vali Acc: 0.916 Test Loss: 0.540 Test Acc: 0.916
Validation loss decreased (-0.899993 --> -0.916211).  Saving model ...
Epoch: 10 cost time: 1.5084702968597412
Epoch: 10, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.444 Vali Acc: 0.927 Test Loss: 0.444 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 1.7308921813964844
Epoch: 11, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.380 Vali Acc: 0.935 Test Loss: 0.380 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.3848578929901123
Epoch: 12, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.328 Vali Acc: 0.935 Test Loss: 0.328 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 13 cost time: 1.5020596981048584
Epoch: 13, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.280 Vali Acc: 0.951 Test Loss: 0.280 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.7801141738891602
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4559736251831055
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 16 cost time: 1.8452184200286865
Epoch: 16, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 17 cost time: 1.7993366718292236
Epoch: 17, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 18 cost time: 1.8165819644927979
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7758753299713135
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.697690725326538
Epoch: 20, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.4857420921325684
Epoch: 21, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4346809387207031
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.589914083480835
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4524877071380615
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6324162483215332
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5935254096984863
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.556633710861206
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7889611721038818
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.8446953296661377
Epoch: 29, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 2.1694939136505127
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7979614734649658
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7824664115905762
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9119915962219238
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.6743767261505127
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8356640338897705
Epoch: 35, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8376333713531494
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7146317958831787
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7776498794555664
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.821864128112793
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.049567461013794
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 2.060472249984741
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7511334419250488
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6209197044372559
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 44 cost time: 1.6577811241149902
Epoch: 44, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7827513217926025
Epoch: 45, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.8480925559997559
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.744640827178955
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 2.0547215938568115
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 1.900702953338623
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.9084527492523193
Epoch: 50, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.981933355331421
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8874719142913818
Epoch: 52, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7111852169036865
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7237987518310547
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7951290607452393
Epoch: 55, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.965975046157837
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.931549310684204
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7514238357543945
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.7660293579101562
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.7865822315216064
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.6758537292480469
Epoch: 61, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.7421255111694336
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.9183142185211182
Epoch: 63, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.6796612739562988
Epoch: 64, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 2.072469711303711
Epoch: 65, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 302025
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.007557153701782
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 2.140 Vali Acc: 0.124 Test Loss: 2.140 Test Acc: 0.124
Validation loss decreased (inf --> -0.124303).  Saving model ...
Epoch: 2 cost time: 1.4724082946777344
Epoch: 2, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.942 Vali Acc: 0.416 Test Loss: 1.942 Test Acc: 0.416
Validation loss decreased (-0.124303 --> -0.416197).  Saving model ...
Epoch: 3 cost time: 1.4854974746704102
Epoch: 3, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.695 Vali Acc: 0.649 Test Loss: 1.695 Test Acc: 0.649
Validation loss decreased (-0.416197 --> -0.648632).  Saving model ...
Epoch: 4 cost time: 1.457817554473877
Epoch: 4, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.448 Vali Acc: 0.730 Test Loss: 1.448 Test Acc: 0.730
Validation loss decreased (-0.648632 --> -0.729715).  Saving model ...
Epoch: 5 cost time: 1.341233730316162
Epoch: 5, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.221 Vali Acc: 0.784 Test Loss: 1.221 Test Acc: 0.784
Validation loss decreased (-0.729715 --> -0.783772).  Saving model ...
Epoch: 6 cost time: 1.5240824222564697
Epoch: 6, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.995 Vali Acc: 0.835 Test Loss: 0.995 Test Acc: 0.835
Validation loss decreased (-0.783772 --> -0.835125).  Saving model ...
Epoch: 7 cost time: 1.7367465496063232
Epoch: 7, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.810 Vali Acc: 0.862 Test Loss: 0.810 Test Acc: 0.862
Validation loss decreased (-0.835125 --> -0.862154).  Saving model ...
Epoch: 8 cost time: 1.483595371246338
Epoch: 8, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.667 Vali Acc: 0.895 Test Loss: 0.667 Test Acc: 0.895
Validation loss decreased (-0.862154 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 1.685734748840332
Epoch: 9, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.539 Vali Acc: 0.914 Test Loss: 0.539 Test Acc: 0.914
Validation loss decreased (-0.894588 --> -0.913508).  Saving model ...
Epoch: 10 cost time: 1.7144742012023926
Epoch: 10, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.442 Vali Acc: 0.927 Test Loss: 0.442 Test Acc: 0.927
Validation loss decreased (-0.913508 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 1.7609636783599854
Epoch: 11, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.379 Vali Acc: 0.935 Test Loss: 0.379 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.7704904079437256
Epoch: 12, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.328 Vali Acc: 0.941 Test Loss: 0.328 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 1.746854305267334
Epoch: 13, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.282 Vali Acc: 0.954 Test Loss: 0.282 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 14 cost time: 1.8447182178497314
Epoch: 14, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.263 Vali Acc: 0.949 Test Loss: 0.263 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7749390602111816
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.223 Vali Acc: 0.965 Test Loss: 0.223 Test Acc: 0.965
Validation loss decreased (-0.954051 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.725959300994873
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7532134056091309
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.5802733898162842
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.525670051574707
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7169127464294434
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.804234504699707
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.595020055770874
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 1.7808165550231934
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7810325622558594
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4577229022979736
Epoch: 25, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6005806922912598
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5906322002410889
Epoch: 27, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.531599760055542
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.693396806716919
Epoch: 29, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8418865203857422
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.6553561687469482
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.811018466949463
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8434484004974365
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.8766863346099854
Epoch: 34, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7155265808105469
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.5227668285369873
Epoch: 36, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5525367259979248
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7007770538330078
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.765345811843872
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.5309054851531982
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 1.6947741508483887
Epoch: 41, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.414191484451294
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.8411993980407715
Epoch: 43, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.706221103668213
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8290152549743652
Epoch: 45, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.7413218021392822
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.4493179321289062
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.649620532989502
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 1.6067571640014648
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4898338317871094
Epoch: 50, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.5408897399902344
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.6684527397155762
Epoch: 52, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.8896973133087158
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7866475582122803
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.7573857307434082
Epoch: 55, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.8707690238952637
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7762162685394287
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7922284603118896
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.6353485584259033
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.662675142288208
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.662719964981079
Epoch: 61, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.6778523921966553
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.793661117553711
Epoch: 63, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.6576569080352783
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.78303861618042
Epoch: 65, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 302025
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6151671409606934
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.140 Vali Acc: 0.097 Test Loss: 2.140 Test Acc: 0.097
Validation loss decreased (inf --> -0.097276).  Saving model ...
Epoch: 2 cost time: 1.686943769454956
Epoch: 2, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.939 Vali Acc: 0.427 Test Loss: 1.939 Test Acc: 0.427
Validation loss decreased (-0.097276 --> -0.427008).  Saving model ...
Epoch: 3 cost time: 1.505070686340332
Epoch: 3, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.690 Vali Acc: 0.670 Test Loss: 1.690 Test Acc: 0.670
Validation loss decreased (-0.427008 --> -0.670253).  Saving model ...
Epoch: 4 cost time: 1.6848573684692383
Epoch: 4, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.440 Vali Acc: 0.727 Test Loss: 1.440 Test Acc: 0.727
Validation loss decreased (-0.670253 --> -0.727013).  Saving model ...
Epoch: 5 cost time: 1.487332820892334
Epoch: 5, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.213 Vali Acc: 0.784 Test Loss: 1.213 Test Acc: 0.784
Validation loss decreased (-0.727013 --> -0.783772).  Saving model ...
Epoch: 6 cost time: 1.549455165863037
Epoch: 6, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.984 Vali Acc: 0.822 Test Loss: 0.984 Test Acc: 0.822
Validation loss decreased (-0.783772 --> -0.821612).  Saving model ...
Epoch: 7 cost time: 1.505120038986206
Epoch: 7, Steps: 17 | Train Loss: 0.836 Vali Loss: 0.799 Vali Acc: 0.857 Test Loss: 0.799 Test Acc: 0.857
Validation loss decreased (-0.821612 --> -0.856749).  Saving model ...
Epoch: 8 cost time: 1.615142822265625
Epoch: 8, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.657 Vali Acc: 0.889 Test Loss: 0.657 Test Acc: 0.889
Validation loss decreased (-0.856749 --> -0.889183).  Saving model ...
Epoch: 9 cost time: 1.6141016483306885
Epoch: 9, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.531 Vali Acc: 0.916 Test Loss: 0.531 Test Acc: 0.916
Validation loss decreased (-0.889183 --> -0.916211).  Saving model ...
Epoch: 10 cost time: 1.4633939266204834
Epoch: 10, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.436 Vali Acc: 0.927 Test Loss: 0.436 Test Acc: 0.927
Validation loss decreased (-0.916211 --> -0.927023).  Saving model ...
Epoch: 11 cost time: 1.6916048526763916
Epoch: 11, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.374 Vali Acc: 0.938 Test Loss: 0.374 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 1.510932207107544
Epoch: 12, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.319 Vali Acc: 0.943 Test Loss: 0.319 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.4739530086517334
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.282 Vali Acc: 0.951 Test Loss: 0.282 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.6974492073059082
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.263 Vali Acc: 0.949 Test Loss: 0.263 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4272847175598145
Epoch: 15, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.584953784942627
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 17 cost time: 1.5822393894195557
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6086463928222656
Epoch: 18, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 1.692535638809204
Epoch: 19, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7587039470672607
Epoch: 20, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7109298706054688
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5292396545410156
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 1.752368450164795
Epoch: 23, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6682465076446533
Epoch: 24, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5891156196594238
Epoch: 25, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.6414861679077148
Epoch: 26, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6147911548614502
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6250782012939453
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6431994438171387
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.540095329284668
Epoch: 30, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9411487579345703
Epoch: 31, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5925219058990479
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.5166749954223633
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6038477420806885
Epoch: 34, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6949882507324219
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6337554454803467
Epoch: 36, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.5744941234588623
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5574731826782227
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.6065673828125
Epoch: 39, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7673907279968262
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.5808448791503906
Epoch: 41, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.610901117324829
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7162909507751465
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 1.60325026512146
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6362898349761963
Epoch: 45, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6629374027252197
Epoch: 46, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5089232921600342
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.606022596359253
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 1.5216460227966309
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.7482564449310303
Epoch: 50, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6391868591308594
Epoch: 51, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.7578585147857666
Epoch: 52, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.7099223136901855
Epoch: 53, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.7871594429016113
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.367713212966919
Epoch: 55, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.6174075603485107
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.8067777156829834
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.6124508380889893
Epoch: 58, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.634441614151001
Epoch: 59, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.7835993766784668
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.5980346202850342
Epoch: 61, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.8728666305541992
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.8813071250915527
Epoch: 63, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.491764783859253
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.7822203636169434
Epoch: 65, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 302025
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.579604387283325
Epoch: 1, Steps: 17 | Train Loss: 2.229 Vali Loss: 2.125 Vali Acc: 0.149 Test Loss: 2.125 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 1.5244786739349365
Epoch: 2, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.927 Vali Acc: 0.454 Test Loss: 1.927 Test Acc: 0.454
Validation loss decreased (-0.148627 --> -0.454035).  Saving model ...
Epoch: 3 cost time: 1.4862360954284668
Epoch: 3, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.676 Vali Acc: 0.684 Test Loss: 1.676 Test Acc: 0.684
Validation loss decreased (-0.454035 --> -0.683767).  Saving model ...
Epoch: 4 cost time: 1.51597261428833
Epoch: 4, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.417 Vali Acc: 0.741 Test Loss: 1.417 Test Acc: 0.741
Validation loss decreased (-0.683767 --> -0.740526).  Saving model ...
Epoch: 5 cost time: 1.537151575088501
Epoch: 5, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.177 Vali Acc: 0.792 Test Loss: 1.177 Test Acc: 0.792
Validation loss decreased (-0.740526 --> -0.791880).  Saving model ...
Epoch: 6 cost time: 1.5922889709472656
Epoch: 6, Steps: 17 | Train Loss: 1.007 Vali Loss: 0.942 Vali Acc: 0.851 Test Loss: 0.942 Test Acc: 0.851
Validation loss decreased (-0.791880 --> -0.851342).  Saving model ...
Epoch: 7 cost time: 1.6303253173828125
Epoch: 7, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.752 Vali Acc: 0.884 Test Loss: 0.752 Test Acc: 0.884
Validation loss decreased (-0.851342 --> -0.883776).  Saving model ...
Epoch: 8 cost time: 1.5013608932495117
Epoch: 8, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.619 Vali Acc: 0.889 Test Loss: 0.619 Test Acc: 0.889
Validation loss decreased (-0.883776 --> -0.889183).  Saving model ...
Epoch: 9 cost time: 1.5460665225982666
Epoch: 9, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.500 Vali Acc: 0.914 Test Loss: 0.500 Test Acc: 0.914
Validation loss decreased (-0.889183 --> -0.913509).  Saving model ...
Epoch: 10 cost time: 1.5120611190795898
Epoch: 10, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.410 Vali Acc: 0.924 Test Loss: 0.410 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924320).  Saving model ...
Epoch: 11 cost time: 1.5975964069366455
Epoch: 11, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.351 Vali Acc: 0.935 Test Loss: 0.351 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935132).  Saving model ...
Epoch: 12 cost time: 1.5636413097381592
Epoch: 12, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.3622667789459229
Epoch: 13, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 14 cost time: 1.5633864402770996
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.57466721534729
Epoch: 15, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 1.5343208312988281
Epoch: 16, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.192 Vali Acc: 0.954 Test Loss: 0.192 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.5588858127593994
Epoch: 17, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.5176875591278076
Epoch: 18, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 1.6260137557983398
Epoch: 19, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.7199468612670898
Epoch: 20, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.5460691452026367
Epoch: 21, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5252459049224854
Epoch: 22, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.539475679397583
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.5803966522216797
Epoch: 24, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5603961944580078
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.4768879413604736
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.5599372386932373
Epoch: 27, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6388931274414062
Epoch: 28, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975674).  Saving model ...
Epoch: 29 cost time: 1.5822298526763916
Epoch: 29, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6262309551239014
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.5555438995361328
Epoch: 31, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4496128559112549
Epoch: 32, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6739342212677002
Epoch: 33, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.7809727191925049
Epoch: 34, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4114973545074463
Epoch: 35, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.568809986114502
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 1.4153859615325928
Epoch: 37, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5351529121398926
Epoch: 38, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7236096858978271
Epoch: 39, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6901803016662598
Epoch: 40, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.463669776916504
Epoch: 41, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6545031070709229
Epoch: 42, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3755555152893066
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 1.4023759365081787
Epoch: 44, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5132055282592773
Epoch: 45, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3010215759277344
Epoch: 46, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.572939395904541
Epoch: 47, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4859423637390137
Epoch: 48, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5468339920043945
Epoch: 49, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.4743657112121582
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 51 cost time: 1.6068196296691895
Epoch: 51, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.5930240154266357
Epoch: 52, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.618274211883545
Epoch: 53, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 54 cost time: 1.5023884773254395
Epoch: 54, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 55 cost time: 1.3026070594787598
Epoch: 55, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 56 cost time: 1.5288691520690918
Epoch: 56, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.4251043796539307
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7294166088104248
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.5723912715911865
Epoch: 59, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.6103665828704834
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.4249212741851807
Epoch: 61, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.6350374221801758
Epoch: 62, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.5662343502044678
Epoch: 63, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.5359234809875488
Epoch: 64, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.685682773590088
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 302025
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7874510288238525
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.150 Vali Acc: 0.157 Test Loss: 2.150 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 1.828382968902588
Epoch: 2, Steps: 17 | Train Loss: 2.078 Vali Loss: 1.942 Vali Acc: 0.443 Test Loss: 1.942 Test Acc: 0.443
Validation loss decreased (-0.156735 --> -0.443224).  Saving model ...
Epoch: 3 cost time: 1.710042953491211
Epoch: 3, Steps: 17 | Train Loss: 1.846 Vali Loss: 1.710 Vali Acc: 0.641 Test Loss: 1.710 Test Acc: 0.641
Validation loss decreased (-0.443224 --> -0.640523).  Saving model ...
Epoch: 4 cost time: 1.6246943473815918
Epoch: 4, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.484 Vali Acc: 0.751 Test Loss: 1.484 Test Acc: 0.751
Validation loss decreased (-0.640523 --> -0.751337).  Saving model ...
Epoch: 5 cost time: 1.6929187774658203
Epoch: 5, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.264 Vali Acc: 0.781 Test Loss: 1.264 Test Acc: 0.781
Validation loss decreased (-0.751337 --> -0.781068).  Saving model ...
Epoch: 6 cost time: 1.8374435901641846
Epoch: 6, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.056 Vali Acc: 0.835 Test Loss: 1.056 Test Acc: 0.835
Validation loss decreased (-0.781068 --> -0.835125).  Saving model ...
Epoch: 7 cost time: 1.8485107421875
Epoch: 7, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.869 Vali Acc: 0.857 Test Loss: 0.869 Test Acc: 0.857
Validation loss decreased (-0.835125 --> -0.856748).  Saving model ...
Epoch: 8 cost time: 1.7048804759979248
Epoch: 8, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.694 Vali Acc: 0.905 Test Loss: 0.694 Test Acc: 0.905
Validation loss decreased (-0.856748 --> -0.905398).  Saving model ...
Epoch: 9 cost time: 1.6023166179656982
Epoch: 9, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.578 Vali Acc: 0.911 Test Loss: 0.578 Test Acc: 0.911
Validation loss decreased (-0.905398 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 1.6867961883544922
Epoch: 10, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.481 Vali Acc: 0.927 Test Loss: 0.481 Test Acc: 0.927
Validation loss decreased (-0.910805 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 1.662376880645752
Epoch: 11, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.413 Vali Acc: 0.935 Test Loss: 0.413 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.56773042678833
Epoch: 12, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.348 Vali Acc: 0.946 Test Loss: 0.348 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.6236152648925781
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 1.5105507373809814
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.280 Vali Acc: 0.954 Test Loss: 0.280 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954051).  Saving model ...
Epoch: 15 cost time: 1.6758265495300293
Epoch: 15, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.245 Vali Acc: 0.962 Test Loss: 0.245 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 1.5798461437225342
Epoch: 16, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.227 Vali Acc: 0.949 Test Loss: 0.227 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7002296447753906
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5449192523956299
Epoch: 18, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6696856021881104
Epoch: 19, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.429830551147461
Epoch: 20, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5486164093017578
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6136698722839355
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7048149108886719
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 1.5860419273376465
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0102925300598145
Epoch: 25, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.6525847911834717
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.6680645942687988
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5661919116973877
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.590233564376831
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5771546363830566
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.6684834957122803
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7533717155456543
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.6849632263183594
Epoch: 33, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.7339792251586914
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8431015014648438
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6377785205841064
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.760087490081787
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6074469089508057
Epoch: 38, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5172951221466064
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7756705284118652
Epoch: 40, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 1.546990156173706
Epoch: 41, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 42 cost time: 1.5467357635498047
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 43 cost time: 1.7250125408172607
Epoch: 43, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.722663402557373
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.6530225276947021
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.5845386981964111
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.631589412689209
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 1.5510931015014648
Epoch: 48, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.614583969116211
Epoch: 49, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.733530044555664
Epoch: 50, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.5968773365020752
Epoch: 51, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.680525302886963
Epoch: 52, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.7818036079406738
Epoch: 53, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.6630301475524902
Epoch: 54, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.7037346363067627
Epoch: 55, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.6943986415863037
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5523064136505127
Epoch: 57, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.5458381175994873
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 59 cost time: 1.7804536819458008
Epoch: 59, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.8189542293548584
Epoch: 60, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.6232118606567383
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.641883134841919
Epoch: 62, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.553419828414917
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.7291581630706787
Epoch: 64, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.7870187759399414
Epoch: 65, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.8843579292297363
Epoch: 66, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.7783434391021729
Epoch: 67, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.6920602321624756
Epoch: 68, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 170953
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.583930730819702
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.150 Vali Acc: 0.141 Test Loss: 2.150 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 1.6426477432250977
Epoch: 2, Steps: 17 | Train Loss: 2.077 Vali Loss: 1.939 Vali Acc: 0.438 Test Loss: 1.939 Test Acc: 0.438
Validation loss decreased (-0.140519 --> -0.437818).  Saving model ...
Epoch: 3 cost time: 1.6041007041931152
Epoch: 3, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.708 Vali Acc: 0.643 Test Loss: 1.708 Test Acc: 0.643
Validation loss decreased (-0.437818 --> -0.643226).  Saving model ...
Epoch: 4 cost time: 1.7472498416900635
Epoch: 4, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.481 Vali Acc: 0.759 Test Loss: 1.481 Test Acc: 0.759
Validation loss decreased (-0.643226 --> -0.759445).  Saving model ...
Epoch: 5 cost time: 1.6810567378997803
Epoch: 5, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.259 Vali Acc: 0.784 Test Loss: 1.259 Test Acc: 0.784
Validation loss decreased (-0.759445 --> -0.783771).  Saving model ...
Epoch: 6 cost time: 1.6805295944213867
Epoch: 6, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.050 Vali Acc: 0.827 Test Loss: 1.050 Test Acc: 0.827
Validation loss decreased (-0.783771 --> -0.827017).  Saving model ...
Epoch: 7 cost time: 1.6789357662200928
Epoch: 7, Steps: 17 | Train Loss: 0.900 Vali Loss: 0.864 Vali Acc: 0.851 Test Loss: 0.864 Test Acc: 0.851
Validation loss decreased (-0.827017 --> -0.851343).  Saving model ...
Epoch: 8 cost time: 1.755467414855957
Epoch: 8, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.689 Vali Acc: 0.900 Test Loss: 0.689 Test Acc: 0.900
Validation loss decreased (-0.851343 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 1.7312617301940918
Epoch: 9, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.574 Vali Acc: 0.908 Test Loss: 0.574 Test Acc: 0.908
Validation loss decreased (-0.899993 --> -0.908102).  Saving model ...
Epoch: 10 cost time: 1.6016714572906494
Epoch: 10, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.477 Vali Acc: 0.919 Test Loss: 0.477 Test Acc: 0.919
Validation loss decreased (-0.908102 --> -0.918914).  Saving model ...
Epoch: 11 cost time: 1.5215768814086914
Epoch: 11, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.409 Vali Acc: 0.932 Test Loss: 0.409 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.5093393325805664
Epoch: 12, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.345 Vali Acc: 0.949 Test Loss: 0.345 Test Acc: 0.949
Validation loss decreased (-0.932428 --> -0.948645).  Saving model ...
Epoch: 13 cost time: 1.493379831314087
Epoch: 13, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7292490005493164
Epoch: 14, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.276 Vali Acc: 0.959 Test Loss: 0.276 Test Acc: 0.959
Validation loss decreased (-0.948645 --> -0.959457).  Saving model ...
Epoch: 15 cost time: 1.636124849319458
Epoch: 15, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.244 Vali Acc: 0.959 Test Loss: 0.244 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 16 cost time: 1.770075798034668
Epoch: 16, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.226 Vali Acc: 0.957 Test Loss: 0.226 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.481358289718628
Epoch: 17, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9939332008361816
Epoch: 18, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.004988193511963
Epoch: 19, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5374805927276611
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6075100898742676
Epoch: 21, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5137145519256592
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7285025119781494
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.6756260395050049
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5953152179718018
Epoch: 25, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.017728805541992
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 1.5634734630584717
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8705554008483887
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6650090217590332
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.618652105331421
Epoch: 30, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5350265502929688
Epoch: 31, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6371042728424072
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6694633960723877
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5849180221557617
Epoch: 34, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4675416946411133
Epoch: 35, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6095619201660156
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 170953
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.599691152572632
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.154 Vali Acc: 0.151 Test Loss: 2.154 Test Acc: 0.151
Validation loss decreased (inf --> -0.151330).  Saving model ...
Epoch: 2 cost time: 1.5687243938446045
Epoch: 2, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.942 Vali Acc: 0.443 Test Loss: 1.942 Test Acc: 0.443
Validation loss decreased (-0.151330 --> -0.443224).  Saving model ...
Epoch: 3 cost time: 1.557574987411499
Epoch: 3, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.707 Vali Acc: 0.651 Test Loss: 1.707 Test Acc: 0.651
Validation loss decreased (-0.443224 --> -0.651334).  Saving model ...
Epoch: 4 cost time: 1.3918778896331787
Epoch: 4, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.478 Vali Acc: 0.746 Test Loss: 1.478 Test Acc: 0.746
Validation loss decreased (-0.651334 --> -0.745931).  Saving model ...
Epoch: 5 cost time: 1.372615098953247
Epoch: 5, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.254 Vali Acc: 0.786 Test Loss: 1.254 Test Acc: 0.786
Validation loss decreased (-0.745931 --> -0.786474).  Saving model ...
Epoch: 6 cost time: 1.3705952167510986
Epoch: 6, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.044 Vali Acc: 0.824 Test Loss: 1.044 Test Acc: 0.824
Validation loss decreased (-0.786474 --> -0.824314).  Saving model ...
Epoch: 7 cost time: 1.462996244430542
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.853 Vali Acc: 0.841 Test Loss: 0.853 Test Acc: 0.841
Validation loss decreased (-0.824314 --> -0.840532).  Saving model ...
Epoch: 8 cost time: 1.601522445678711
Epoch: 8, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.678 Vali Acc: 0.892 Test Loss: 0.678 Test Acc: 0.892
Validation loss decreased (-0.840532 --> -0.891885).  Saving model ...
Epoch: 9 cost time: 1.6415290832519531
Epoch: 9, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.568 Vali Acc: 0.903 Test Loss: 0.568 Test Acc: 0.903
Validation loss decreased (-0.891885 --> -0.902697).  Saving model ...
Epoch: 10 cost time: 1.6023926734924316
Epoch: 10, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.471 Vali Acc: 0.927 Test Loss: 0.471 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 1.5912156105041504
Epoch: 11, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.402 Vali Acc: 0.938 Test Loss: 0.402 Test Acc: 0.938
Validation loss decreased (-0.927022 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 1.4399142265319824
Epoch: 12, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.342 Vali Acc: 0.943 Test Loss: 0.342 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.4730610847473145
Epoch: 13, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.295 Vali Acc: 0.946 Test Loss: 0.295 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 1.5593507289886475
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.271 Vali Acc: 0.949 Test Loss: 0.271 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 1.6417524814605713
Epoch: 15, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.4607698917388916
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.220 Vali Acc: 0.957 Test Loss: 0.220 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.6373419761657715
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 18 cost time: 1.5013573169708252
Epoch: 18, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.7251026630401611
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6262669563293457
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5664312839508057
Epoch: 21, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7687244415283203
Epoch: 22, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.653613567352295
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.4786252975463867
Epoch: 24, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3935418128967285
Epoch: 25, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.5221893787384033
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5118529796600342
Epoch: 27, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5269837379455566
Epoch: 28, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.4048845767974854
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.3858823776245117
Epoch: 30, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7186238765716553
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6623008251190186
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7324542999267578
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5995304584503174
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.4920573234558105
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 170953
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6960699558258057
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.144 Vali Acc: 0.200 Test Loss: 2.144 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.3797457218170166
Epoch: 2, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.939 Vali Acc: 0.462 Test Loss: 1.939 Test Acc: 0.462
Validation loss decreased (-0.199979 --> -0.462143).  Saving model ...
Epoch: 3 cost time: 1.330263376235962
Epoch: 3, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.709 Vali Acc: 0.662 Test Loss: 1.709 Test Acc: 0.662
Validation loss decreased (-0.462143 --> -0.662145).  Saving model ...
Epoch: 4 cost time: 1.665771484375
Epoch: 4, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.478 Vali Acc: 0.781 Test Loss: 1.478 Test Acc: 0.781
Validation loss decreased (-0.662145 --> -0.781066).  Saving model ...
Epoch: 5 cost time: 1.5907361507415771
Epoch: 5, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.248 Vali Acc: 0.816 Test Loss: 1.248 Test Acc: 0.816
Validation loss decreased (-0.781066 --> -0.816204).  Saving model ...
Epoch: 6 cost time: 1.5712389945983887
Epoch: 6, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.033 Vali Acc: 0.841 Test Loss: 1.033 Test Acc: 0.841
Validation loss decreased (-0.816204 --> -0.840530).  Saving model ...
Epoch: 7 cost time: 1.6148741245269775
Epoch: 7, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.842 Vali Acc: 0.857 Test Loss: 0.842 Test Acc: 0.857
Validation loss decreased (-0.840530 --> -0.856748).  Saving model ...
Epoch: 8 cost time: 1.6356983184814453
Epoch: 8, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.666 Vali Acc: 0.895 Test Loss: 0.666 Test Acc: 0.895
Validation loss decreased (-0.856748 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 1.7338356971740723
Epoch: 9, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.553 Vali Acc: 0.897 Test Loss: 0.553 Test Acc: 0.897
Validation loss decreased (-0.894588 --> -0.897292).  Saving model ...
Epoch: 10 cost time: 1.6818873882293701
Epoch: 10, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.461 Vali Acc: 0.914 Test Loss: 0.461 Test Acc: 0.914
Validation loss decreased (-0.897292 --> -0.913509).  Saving model ...
Epoch: 11 cost time: 1.556684970855713
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.394 Vali Acc: 0.932 Test Loss: 0.394 Test Acc: 0.932
Validation loss decreased (-0.913509 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.675825834274292
Epoch: 12, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.337 Vali Acc: 0.938 Test Loss: 0.337 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 13 cost time: 1.456822156906128
Epoch: 13, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 1.4882876873016357
Epoch: 14, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.268 Vali Acc: 0.951 Test Loss: 0.268 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 1.6439290046691895
Epoch: 15, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 1.6319243907928467
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.5940601825714111
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.515146255493164
Epoch: 18, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.4752352237701416
Epoch: 19, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4887850284576416
Epoch: 20, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4662485122680664
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.5204505920410156
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 1.6501877307891846
Epoch: 23, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.7339398860931396
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3996772766113281
Epoch: 25, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.6410999298095703
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6397969722747803
Epoch: 27, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.6889452934265137
Epoch: 28, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 1.5915169715881348
Epoch: 29, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5169854164123535
Epoch: 30, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6102514266967773
Epoch: 31, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4832251071929932
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5691356658935547
Epoch: 33, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5747087001800537
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 1.571375846862793
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 1.4271106719970703
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.687009572982788
Epoch: 37, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4438767433166504
Epoch: 38, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5430500507354736
Epoch: 39, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.6195523738861084
Epoch: 40, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.577014446258545
Epoch: 41, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9003021717071533
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6601262092590332
Epoch: 43, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.549705982208252
Epoch: 44, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6770880222320557
Epoch: 45, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 170953
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.996997356414795
Epoch: 1, Steps: 17 | Train Loss: 2.182 Vali Loss: 2.108 Vali Acc: 0.203 Test Loss: 2.108 Test Acc: 0.203
Validation loss decreased (inf --> -0.202682).  Saving model ...
Epoch: 2 cost time: 1.7797877788543701
Epoch: 2, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.906 Vali Acc: 0.508 Test Loss: 1.906 Test Acc: 0.508
Validation loss decreased (-0.202682 --> -0.508089).  Saving model ...
Epoch: 3 cost time: 1.7183570861816406
Epoch: 3, Steps: 17 | Train Loss: 1.761 Vali Loss: 1.673 Vali Acc: 0.711 Test Loss: 1.673 Test Acc: 0.711
Validation loss decreased (-0.508089 --> -0.710794).  Saving model ...
Epoch: 4 cost time: 1.6405634880065918
Epoch: 4, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.440 Vali Acc: 0.770 Test Loss: 1.440 Test Acc: 0.770
Validation loss decreased (-0.710794 --> -0.770256).  Saving model ...
Epoch: 5 cost time: 1.6173508167266846
Epoch: 5, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.218 Vali Acc: 0.786 Test Loss: 1.218 Test Acc: 0.786
Validation loss decreased (-0.770256 --> -0.786474).  Saving model ...
Epoch: 6 cost time: 1.665099859237671
Epoch: 6, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.005 Vali Acc: 0.849 Test Loss: 1.005 Test Acc: 0.849
Validation loss decreased (-0.786474 --> -0.848639).  Saving model ...
Epoch: 7 cost time: 1.7254316806793213
Epoch: 7, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.840 Vali Acc: 0.862 Test Loss: 0.840 Test Acc: 0.862
Validation loss decreased (-0.848639 --> -0.862154).  Saving model ...
Epoch: 8 cost time: 1.5804738998413086
Epoch: 8, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.702 Vali Acc: 0.876 Test Loss: 0.702 Test Acc: 0.876
Validation loss decreased (-0.862154 --> -0.875669).  Saving model ...
Epoch: 9 cost time: 1.431474208831787
Epoch: 9, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.569 Vali Acc: 0.911 Test Loss: 0.569 Test Acc: 0.911
Validation loss decreased (-0.875669 --> -0.910805).  Saving model ...
Epoch: 10 cost time: 1.7198667526245117
Epoch: 10, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.483 Vali Acc: 0.932 Test Loss: 0.483 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932428).  Saving model ...
Epoch: 11 cost time: 1.7152981758117676
Epoch: 11, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.424 Vali Acc: 0.932 Test Loss: 0.424 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.679697036743164
Epoch: 12, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.363 Vali Acc: 0.943 Test Loss: 0.363 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.6774780750274658
Epoch: 13, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.322 Vali Acc: 0.946 Test Loss: 0.322 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 14 cost time: 1.629366159439087
Epoch: 14, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6008949279785156
Epoch: 15, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.263 Vali Acc: 0.946 Test Loss: 0.263 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 1.4565401077270508
Epoch: 16, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 1.583190679550171
Epoch: 17, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.220 Vali Acc: 0.943 Test Loss: 0.220 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5635457038879395
Epoch: 18, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 19 cost time: 1.5068588256835938
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.197 Vali Acc: 0.949 Test Loss: 0.197 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5922582149505615
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.522883653640747
Epoch: 21, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 2.0082361698150635
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7992501258850098
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8130030632019043
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.6588935852050781
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5800416469573975
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5721936225891113
Epoch: 27, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6540095806121826
Epoch: 28, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.643367052078247
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.7577970027923584
Epoch: 30, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9742920398712158
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8880960941314697
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.7326359748840332
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7757759094238281
Epoch: 34, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6957507133483887
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.7654705047607422
Epoch: 36, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6265687942504883
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5346934795379639
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5944817066192627
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7142233848571777
Epoch: 40, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.721127986907959
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.06827712059021
Epoch: 42, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 105417
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5041568279266357
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.100 Vali Acc: 0.200 Test Loss: 2.100 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.5929572582244873
Epoch: 2, Steps: 17 | Train Loss: 2.020 Vali Loss: 1.899 Vali Acc: 0.530 Test Loss: 1.899 Test Acc: 0.530
Validation loss decreased (-0.199979 --> -0.529711).  Saving model ...
Epoch: 3 cost time: 1.4645500183105469
Epoch: 3, Steps: 17 | Train Loss: 1.774 Vali Loss: 1.667 Vali Acc: 0.703 Test Loss: 1.667 Test Acc: 0.703
Validation loss decreased (-0.529711 --> -0.702686).  Saving model ...
Epoch: 4 cost time: 1.574563980102539
Epoch: 4, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.436 Vali Acc: 0.765 Test Loss: 1.436 Test Acc: 0.765
Validation loss decreased (-0.702686 --> -0.764851).  Saving model ...
Epoch: 5 cost time: 1.4446828365325928
Epoch: 5, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.218 Vali Acc: 0.797 Test Loss: 1.218 Test Acc: 0.797
Validation loss decreased (-0.764851 --> -0.797285).  Saving model ...
Epoch: 6 cost time: 1.5221571922302246
Epoch: 6, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.006 Vali Acc: 0.841 Test Loss: 1.006 Test Acc: 0.841
Validation loss decreased (-0.797285 --> -0.840530).  Saving model ...
Epoch: 7 cost time: 1.3950409889221191
Epoch: 7, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.837 Vali Acc: 0.862 Test Loss: 0.837 Test Acc: 0.862
Validation loss decreased (-0.840530 --> -0.862154).  Saving model ...
Epoch: 8 cost time: 1.645883560180664
Epoch: 8, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.702 Vali Acc: 0.881 Test Loss: 0.702 Test Acc: 0.881
Validation loss decreased (-0.862154 --> -0.881074).  Saving model ...
Epoch: 9 cost time: 1.6848633289337158
Epoch: 9, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.568 Vali Acc: 0.916 Test Loss: 0.568 Test Acc: 0.916
Validation loss decreased (-0.881074 --> -0.916211).  Saving model ...
Epoch: 10 cost time: 1.6436786651611328
Epoch: 10, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.480 Vali Acc: 0.932 Test Loss: 0.480 Test Acc: 0.932
Validation loss decreased (-0.916211 --> -0.932428).  Saving model ...
Epoch: 11 cost time: 1.6157190799713135
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.420 Vali Acc: 0.938 Test Loss: 0.420 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 1.5966148376464844
Epoch: 12, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.358 Vali Acc: 0.943 Test Loss: 0.358 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.54644775390625
Epoch: 13, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.313 Vali Acc: 0.949 Test Loss: 0.313 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 14 cost time: 1.5516650676727295
Epoch: 14, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 1.5931508541107178
Epoch: 15, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.256 Vali Acc: 0.951 Test Loss: 0.256 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 1.6698660850524902
Epoch: 16, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 1.6693272590637207
Epoch: 17, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.215 Vali Acc: 0.946 Test Loss: 0.215 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6749145984649658
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.203 Vali Acc: 0.949 Test Loss: 0.203 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.714383602142334
Epoch: 19, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.6848399639129639
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 1.5343451499938965
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.412714958190918
Epoch: 22, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5085947513580322
Epoch: 23, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 24 cost time: 1.573216438293457
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 1.5310389995574951
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 1.676713466644287
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.5805988311767578
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6469135284423828
Epoch: 28, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7882952690124512
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.6681771278381348
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.692925214767456
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7287065982818604
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 1.3828239440917969
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.465529441833496
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6100702285766602
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.552664041519165
Epoch: 36, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4952137470245361
Epoch: 37, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.419520378112793
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5035014152526855
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.6757311820983887
Epoch: 40, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.8755102157592773
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8876826763153076
Epoch: 42, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.7806942462921143
Epoch: 43, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 105417
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.683911085128784
Epoch: 1, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.103 Vali Acc: 0.200 Test Loss: 2.103 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 1.3865594863891602
Epoch: 2, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.900 Vali Acc: 0.538 Test Loss: 1.900 Test Acc: 0.538
Validation loss decreased (-0.199979 --> -0.537819).  Saving model ...
Epoch: 3 cost time: 1.4719562530517578
Epoch: 3, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.668 Vali Acc: 0.727 Test Loss: 1.668 Test Acc: 0.727
Validation loss decreased (-0.537819 --> -0.727010).  Saving model ...
Epoch: 4 cost time: 1.6171715259552002
Epoch: 4, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.436 Vali Acc: 0.762 Test Loss: 1.436 Test Acc: 0.762
Validation loss decreased (-0.727010 --> -0.762148).  Saving model ...
Epoch: 5 cost time: 1.606112003326416
Epoch: 5, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.216 Vali Acc: 0.805 Test Loss: 1.216 Test Acc: 0.805
Validation loss decreased (-0.762148 --> -0.805393).  Saving model ...
Epoch: 6 cost time: 1.6530232429504395
Epoch: 6, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.004 Vali Acc: 0.851 Test Loss: 1.004 Test Acc: 0.851
Validation loss decreased (-0.805393 --> -0.851341).  Saving model ...
Epoch: 7 cost time: 1.4016106128692627
Epoch: 7, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.834 Vali Acc: 0.868 Test Loss: 0.834 Test Acc: 0.868
Validation loss decreased (-0.851341 --> -0.867559).  Saving model ...
Epoch: 8 cost time: 1.533994436264038
Epoch: 8, Steps: 17 | Train Loss: 0.675 Vali Loss: 0.697 Vali Acc: 0.881 Test Loss: 0.697 Test Acc: 0.881
Validation loss decreased (-0.867559 --> -0.881074).  Saving model ...
Epoch: 9 cost time: 1.6977272033691406
Epoch: 9, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.565 Vali Acc: 0.914 Test Loss: 0.565 Test Acc: 0.914
Validation loss decreased (-0.881074 --> -0.913508).  Saving model ...
Epoch: 10 cost time: 1.4179461002349854
Epoch: 10, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.478 Vali Acc: 0.927 Test Loss: 0.478 Test Acc: 0.927
Validation loss decreased (-0.913508 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 1.4608674049377441
Epoch: 11, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.418 Vali Acc: 0.938 Test Loss: 0.418 Test Acc: 0.938
Validation loss decreased (-0.927022 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 1.4900221824645996
Epoch: 12, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.356 Vali Acc: 0.938 Test Loss: 0.356 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 13 cost time: 1.6005544662475586
Epoch: 13, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.311 Vali Acc: 0.954 Test Loss: 0.311 Test Acc: 0.954
Validation loss decreased (-0.937834 --> -0.954051).  Saving model ...
Epoch: 14 cost time: 1.6092309951782227
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.284 Vali Acc: 0.946 Test Loss: 0.284 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6246898174285889
Epoch: 15, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.256 Vali Acc: 0.949 Test Loss: 0.256 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7354249954223633
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.225 Vali Acc: 0.954 Test Loss: 0.225 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.9224627017974854
Epoch: 17, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7764742374420166
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.8610146045684814
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.661449670791626
Epoch: 20, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.8202834129333496
Epoch: 21, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8373050689697266
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.931464672088623
Epoch: 23, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7865052223205566
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.582123279571533
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.473921775817871
Epoch: 26, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 2.13362979888916
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7800047397613525
Epoch: 28, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.517698049545288
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 2.5053305625915527
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0133144855499268
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3404459953308105
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3132498264312744
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.9494366645812988
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9502825736999512
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.221226453781128
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.886622667312622
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9801380634307861
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.171339750289917
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8692350387573242
Epoch: 40, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6961233615875244
Epoch: 41, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 1.8474583625793457
Epoch: 42, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.8364851474761963
Epoch: 43, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7995564937591553
Epoch: 44, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.0640015602111816
Epoch: 45, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.8918464183807373
Epoch: 46, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.0083601474761963
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.941065788269043
Epoch: 48, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 49 cost time: 1.7555124759674072
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.908691644668579
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.22820782661438
Epoch: 51, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.982670783996582
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.1538968086242676
Epoch: 53, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.1520514488220215
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.6362216472625732
Epoch: 55, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.0443766117095947
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.0113613605499268
Epoch: 57, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.8661119937896729
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 105417
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7157158851623535
Epoch: 1, Steps: 17 | Train Loss: 2.190 Vali Loss: 2.099 Vali Acc: 0.197 Test Loss: 2.099 Test Acc: 0.197
Validation loss decreased (inf --> -0.197276).  Saving model ...
Epoch: 2 cost time: 1.6691267490386963
Epoch: 2, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.904 Vali Acc: 0.530 Test Loss: 1.904 Test Acc: 0.530
Validation loss decreased (-0.197276 --> -0.529711).  Saving model ...
Epoch: 3 cost time: 1.480727195739746
Epoch: 3, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.677 Vali Acc: 0.732 Test Loss: 1.677 Test Acc: 0.732
Validation loss decreased (-0.529711 --> -0.732416).  Saving model ...
Epoch: 4 cost time: 1.532999038696289
Epoch: 4, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.449 Vali Acc: 0.789 Test Loss: 1.449 Test Acc: 0.789
Validation loss decreased (-0.732416 --> -0.789175).  Saving model ...
Epoch: 5 cost time: 1.5754575729370117
Epoch: 5, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.228 Vali Acc: 0.808 Test Loss: 1.228 Test Acc: 0.808
Validation loss decreased (-0.789175 --> -0.808096).  Saving model ...
Epoch: 6 cost time: 1.6349570751190186
Epoch: 6, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.008 Vali Acc: 0.857 Test Loss: 1.008 Test Acc: 0.857
Validation loss decreased (-0.808096 --> -0.856747).  Saving model ...
Epoch: 7 cost time: 1.48274827003479
Epoch: 7, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.834 Vali Acc: 0.865 Test Loss: 0.834 Test Acc: 0.865
Validation loss decreased (-0.856747 --> -0.864857).  Saving model ...
Epoch: 8 cost time: 1.5632023811340332
Epoch: 8, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.695 Vali Acc: 0.895 Test Loss: 0.695 Test Acc: 0.895
Validation loss decreased (-0.864857 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 1.5495400428771973
Epoch: 9, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.560 Vali Acc: 0.927 Test Loss: 0.560 Test Acc: 0.927
Validation loss decreased (-0.894588 --> -0.927021).  Saving model ...
Epoch: 10 cost time: 1.3818895816802979
Epoch: 10, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
Validation loss decreased (-0.927021 --> -0.929725).  Saving model ...
Epoch: 11 cost time: 1.4756324291229248
Epoch: 11, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.413 Vali Acc: 0.932 Test Loss: 0.413 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.6343133449554443
Epoch: 12, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.351 Vali Acc: 0.949 Test Loss: 0.351 Test Acc: 0.949
Validation loss decreased (-0.932428 --> -0.948645).  Saving model ...
Epoch: 13 cost time: 1.4839046001434326
Epoch: 13, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.304 Vali Acc: 0.949 Test Loss: 0.304 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 14 cost time: 1.4640774726867676
Epoch: 14, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956754).  Saving model ...
Epoch: 15 cost time: 1.3880066871643066
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 1.450962781906128
Epoch: 16, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3359808921813965
Epoch: 17, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.618192434310913
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 1.5414299964904785
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6025259494781494
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.4267611503601074
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.4174413681030273
Epoch: 22, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.4938900470733643
Epoch: 23, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4674036502838135
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.415830135345459
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.521665334701538
Epoch: 26, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.590806245803833
Epoch: 27, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2885003089904785
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5697953701019287
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.5264956951141357
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5660467147827148
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6203291416168213
Epoch: 32, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4131009578704834
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.567479133605957
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5396203994750977
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4780631065368652
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5633947849273682
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5335190296173096
Epoch: 38, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.5521636009216309
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7118000984191895
Epoch: 40, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4908647537231445
Epoch: 41, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 1.5153372287750244
Epoch: 42, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6081428527832031
Epoch: 43, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5559513568878174
Epoch: 44, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.5201544761657715
Epoch: 45, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6007745265960693
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 47 cost time: 1.5416393280029297
Epoch: 47, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.6218152046203613
Epoch: 48, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978378).  Saving model ...
Epoch: 49 cost time: 1.581953525543213
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.4185261726379395
Epoch: 50, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.4633572101593018
Epoch: 51, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.4772746562957764
Epoch: 52, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.4211244583129883
Epoch: 53, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5144472122192383
Epoch: 54, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2799158096313477
Epoch: 55, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.4333248138427734
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.4262280464172363
Epoch: 57, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.5838682651519775
Epoch: 58, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 105417
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2669196128845215
Epoch: 1, Steps: 17 | Train Loss: 2.260 Vali Loss: 2.177 Vali Acc: 0.122 Test Loss: 2.177 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 1.5214300155639648
Epoch: 2, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.968 Vali Acc: 0.332 Test Loss: 1.968 Test Acc: 0.332
Validation loss decreased (-0.121600 --> -0.332413).  Saving model ...
Epoch: 3 cost time: 1.470590353012085
Epoch: 3, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.736 Vali Acc: 0.597 Test Loss: 1.736 Test Acc: 0.597
Validation loss decreased (-0.332413 --> -0.597280).  Saving model ...
Epoch: 4 cost time: 1.5608737468719482
Epoch: 4, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.502 Vali Acc: 0.722 Test Loss: 1.502 Test Acc: 0.722
Validation loss decreased (-0.597280 --> -0.721607).  Saving model ...
Epoch: 5 cost time: 1.7460613250732422
Epoch: 5, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.263 Vali Acc: 0.800 Test Loss: 1.263 Test Acc: 0.800
Validation loss decreased (-0.721607 --> -0.799987).  Saving model ...
Epoch: 6 cost time: 1.517334222793579
Epoch: 6, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.053 Vali Acc: 0.819 Test Loss: 1.053 Test Acc: 0.819
Validation loss decreased (-0.799987 --> -0.818908).  Saving model ...
Epoch: 7 cost time: 1.5454189777374268
Epoch: 7, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.858 Vali Acc: 0.884 Test Loss: 0.858 Test Acc: 0.884
Validation loss decreased (-0.818908 --> -0.883775).  Saving model ...
Epoch: 8 cost time: 1.3283421993255615
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.698 Vali Acc: 0.903 Test Loss: 0.698 Test Acc: 0.903
Validation loss decreased (-0.883775 --> -0.902696).  Saving model ...
Epoch: 9 cost time: 1.5450010299682617
Epoch: 9, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.584 Vali Acc: 0.908 Test Loss: 0.584 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 10 cost time: 1.5709106922149658
Epoch: 10, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.480 Vali Acc: 0.930 Test Loss: 0.480 Test Acc: 0.930
Validation loss decreased (-0.908102 --> -0.929725).  Saving model ...
Epoch: 11 cost time: 1.706632375717163
Epoch: 11, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.408 Vali Acc: 0.946 Test Loss: 0.408 Test Acc: 0.946
Validation loss decreased (-0.929725 --> -0.945942).  Saving model ...
Epoch: 12 cost time: 1.636913537979126
Epoch: 12, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.359 Vali Acc: 0.943 Test Loss: 0.359 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5760483741760254
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.310 Vali Acc: 0.959 Test Loss: 0.310 Test Acc: 0.959
Validation loss decreased (-0.945942 --> -0.959456).  Saving model ...
Epoch: 14 cost time: 1.4723997116088867
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.275 Vali Acc: 0.954 Test Loss: 0.275 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4564907550811768
Epoch: 15, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.247 Vali Acc: 0.951 Test Loss: 0.247 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5526971817016602
Epoch: 16, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.243 Vali Acc: 0.954 Test Loss: 0.243 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.472651720046997
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.199 Vali Acc: 0.968 Test Loss: 0.199 Test Acc: 0.968
Validation loss decreased (-0.959456 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.6582403182983398
Epoch: 18, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6530263423919678
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5622663497924805
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6677274703979492
Epoch: 21, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.681070327758789
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7391295433044434
Epoch: 23, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.7093486785888672
Epoch: 24, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6018316745758057
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.5281174182891846
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.606659173965454
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.630744457244873
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.484551191329956
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.638739824295044
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4685680866241455
Epoch: 31, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6495225429534912
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6099159717559814
Epoch: 33, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.6062042713165283
Epoch: 34, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 1.6620080471038818
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 36 cost time: 1.7154791355133057
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.636267900466919
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 38 cost time: 1.6519832611083984
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.494779109954834
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5608346462249756
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5881617069244385
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.725780725479126
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.694455862045288
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.8350250720977783
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 45 cost time: 1.8126394748687744
Epoch: 45, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 46 cost time: 1.7846205234527588
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 47 cost time: 1.8196542263031006
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.905449390411377
Epoch: 48, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 1.8318545818328857
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.8230347633361816
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.7770719528198242
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 52 cost time: 1.5031373500823975
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.6971135139465332
Epoch: 53, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 1.5244576930999756
Epoch: 54, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.3462309837341309
Epoch: 55, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.508507251739502
Epoch: 56, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5705270767211914
Epoch: 57, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 58 cost time: 1.6068453788757324
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.766399621963501
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.6630122661590576
Epoch: 60, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 61 cost time: 1.414046049118042
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 62 cost time: 1.4355499744415283
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.5803661346435547
Epoch: 63, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.6729190349578857
Epoch: 64, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.5331058502197266
Epoch: 65, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.7702741622924805
Epoch: 66, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.2241551876068115
Epoch: 67, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.6466901302337646
Epoch: 68, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.620410680770874
Epoch: 69, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.580134391784668
Epoch: 70, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.746809482574463
Epoch: 71, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 72649
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3162405490875244
Epoch: 1, Steps: 17 | Train Loss: 2.267 Vali Loss: 2.179 Vali Acc: 0.119 Test Loss: 2.179 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 1.743408441543579
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.970 Vali Acc: 0.341 Test Loss: 1.970 Test Acc: 0.341
Validation loss decreased (-0.118897 --> -0.340521).  Saving model ...
Epoch: 3 cost time: 1.73539137840271
Epoch: 3, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.740 Vali Acc: 0.586 Test Loss: 1.740 Test Acc: 0.586
Validation loss decreased (-0.340521 --> -0.586469).  Saving model ...
Epoch: 4 cost time: 1.6427333354949951
Epoch: 4, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.507 Vali Acc: 0.727 Test Loss: 1.507 Test Acc: 0.727
Validation loss decreased (-0.586469 --> -0.727012).  Saving model ...
Epoch: 5 cost time: 1.6819179058074951
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.268 Vali Acc: 0.792 Test Loss: 1.268 Test Acc: 0.792
Validation loss decreased (-0.727012 --> -0.791879).  Saving model ...
Epoch: 6 cost time: 1.6049442291259766
Epoch: 6, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.057 Vali Acc: 0.816 Test Loss: 1.057 Test Acc: 0.816
Validation loss decreased (-0.791879 --> -0.816206).  Saving model ...
Epoch: 7 cost time: 1.7828917503356934
Epoch: 7, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.862 Vali Acc: 0.873 Test Loss: 0.862 Test Acc: 0.873
Validation loss decreased (-0.816206 --> -0.872964).  Saving model ...
Epoch: 8 cost time: 1.5865709781646729
Epoch: 8, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.702 Vali Acc: 0.889 Test Loss: 0.702 Test Acc: 0.889
Validation loss decreased (-0.872964 --> -0.889182).  Saving model ...
Epoch: 9 cost time: 1.3883042335510254
Epoch: 9, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.583 Vali Acc: 0.903 Test Loss: 0.583 Test Acc: 0.903
Validation loss decreased (-0.889182 --> -0.902697).  Saving model ...
Epoch: 10 cost time: 1.507415533065796
Epoch: 10, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.479 Vali Acc: 0.927 Test Loss: 0.479 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 1.6825714111328125
Epoch: 11, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.405 Vali Acc: 0.946 Test Loss: 0.405 Test Acc: 0.946
Validation loss decreased (-0.927022 --> -0.945942).  Saving model ...
Epoch: 12 cost time: 1.6044223308563232
Epoch: 12, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.358 Vali Acc: 0.943 Test Loss: 0.358 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.603180170059204
Epoch: 13, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.309 Vali Acc: 0.957 Test Loss: 0.309 Test Acc: 0.957
Validation loss decreased (-0.945942 --> -0.956754).  Saving model ...
Epoch: 14 cost time: 1.552919864654541
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.274 Vali Acc: 0.954 Test Loss: 0.274 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6624350547790527
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.246 Vali Acc: 0.954 Test Loss: 0.246 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5225634574890137
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.71112060546875
Epoch: 17, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.197 Vali Acc: 0.962 Test Loss: 0.197 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 18 cost time: 1.7320311069488525
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 1.655153751373291
Epoch: 19, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.7872300148010254
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7104883193969727
Epoch: 21, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.555652379989624
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 23 cost time: 1.626363754272461
Epoch: 23, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.571620225906372
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6062650680541992
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.6169054508209229
Epoch: 26, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.6335442066192627
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6960327625274658
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8844873905181885
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.79205322265625
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7863404750823975
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5765621662139893
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6932439804077148
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.624830722808838
Epoch: 34, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6058523654937744
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.4849827289581299
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7433195114135742
Epoch: 37, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.5961101055145264
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.7632739543914795
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.557429552078247
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.6275193691253662
Epoch: 41, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6399736404418945
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7752468585968018
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.622270107269287
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6143438816070557
Epoch: 45, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.5926368236541748
Epoch: 46, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.566131353378296
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.6406619548797607
Epoch: 48, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.7804820537567139
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.6082141399383545
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 72649
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.651854991912842
Epoch: 1, Steps: 17 | Train Loss: 2.259 Vali Loss: 2.180 Vali Acc: 0.122 Test Loss: 2.180 Test Acc: 0.122
Validation loss decreased (inf --> -0.121600).  Saving model ...
Epoch: 2 cost time: 1.4210329055786133
Epoch: 2, Steps: 17 | Train Loss: 2.071 Vali Loss: 1.970 Vali Acc: 0.338 Test Loss: 1.970 Test Acc: 0.338
Validation loss decreased (-0.121600 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 1.6276307106018066
Epoch: 3, Steps: 17 | Train Loss: 1.839 Vali Loss: 1.739 Vali Acc: 0.597 Test Loss: 1.739 Test Acc: 0.597
Validation loss decreased (-0.337818 --> -0.597280).  Saving model ...
Epoch: 4 cost time: 1.58134126663208
Epoch: 4, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.503 Vali Acc: 0.751 Test Loss: 1.503 Test Acc: 0.751
Validation loss decreased (-0.597280 --> -0.751336).  Saving model ...
Epoch: 5 cost time: 1.5730745792388916
Epoch: 5, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.263 Vali Acc: 0.795 Test Loss: 1.263 Test Acc: 0.795
Validation loss decreased (-0.751336 --> -0.794582).  Saving model ...
Epoch: 6 cost time: 1.4079296588897705
Epoch: 6, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.051 Vali Acc: 0.808 Test Loss: 1.051 Test Acc: 0.808
Validation loss decreased (-0.794582 --> -0.808098).  Saving model ...
Epoch: 7 cost time: 1.4935612678527832
Epoch: 7, Steps: 17 | Train Loss: 0.875 Vali Loss: 0.859 Vali Acc: 0.873 Test Loss: 0.859 Test Acc: 0.873
Validation loss decreased (-0.808098 --> -0.872964).  Saving model ...
Epoch: 8 cost time: 1.3880577087402344
Epoch: 8, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.698 Vali Acc: 0.889 Test Loss: 0.698 Test Acc: 0.889
Validation loss decreased (-0.872964 --> -0.889182).  Saving model ...
Epoch: 9 cost time: 1.4582276344299316
Epoch: 9, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.581 Vali Acc: 0.892 Test Loss: 0.581 Test Acc: 0.892
Validation loss decreased (-0.889182 --> -0.891886).  Saving model ...
Epoch: 10 cost time: 1.4994287490844727
Epoch: 10, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.483 Vali Acc: 0.914 Test Loss: 0.483 Test Acc: 0.914
Validation loss decreased (-0.891886 --> -0.913509).  Saving model ...
Epoch: 11 cost time: 1.6617567539215088
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.404 Vali Acc: 0.941 Test Loss: 0.404 Test Acc: 0.941
Validation loss decreased (-0.913509 --> -0.940537).  Saving model ...
Epoch: 12 cost time: 1.55717134475708
Epoch: 12, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.359 Vali Acc: 0.943 Test Loss: 0.359 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 13 cost time: 1.6660363674163818
Epoch: 13, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.311 Vali Acc: 0.954 Test Loss: 0.311 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954051).  Saving model ...
Epoch: 14 cost time: 1.5984437465667725
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.275 Vali Acc: 0.954 Test Loss: 0.275 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 15 cost time: 1.4104502201080322
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 16 cost time: 1.5449674129486084
Epoch: 16, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5562334060668945
Epoch: 17, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.196 Vali Acc: 0.968 Test Loss: 0.196 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.6034374237060547
Epoch: 18, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4705946445465088
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5799970626831055
Epoch: 20, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7840650081634521
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.744661808013916
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.808424711227417
Epoch: 23, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.7895429134368896
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9713950157165527
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.6357440948486328
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.65584135055542
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6744778156280518
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.6492784023284912
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.667123794555664
Epoch: 30, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 1.5857317447662354
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8389899730682373
Epoch: 32, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.653233528137207
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8262348175048828
Epoch: 34, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.77876615524292
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.6819744110107422
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 37 cost time: 1.7955987453460693
Epoch: 37, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8019652366638184
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9340009689331055
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9301226139068604
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 41 cost time: 1.7312443256378174
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9992876052856445
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.9672653675079346
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 44 cost time: 1.8079125881195068
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9823353290557861
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6239409446716309
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8254258632659912
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 48 cost time: 1.882852554321289
Epoch: 48, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.790614128112793
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 50 cost time: 1.8134446144104004
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.8376388549804688
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.7066209316253662
Epoch: 52, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 53 cost time: 1.5290489196777344
Epoch: 53, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5237412452697754
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.4274945259094238
Epoch: 55, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.1967945098876953
Epoch: 56, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.4516453742980957
Epoch: 57, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.45505952835083
Epoch: 58, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.4041430950164795
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.683835506439209
Epoch: 60, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.0413622856140137
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.9283726215362549
Epoch: 62, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 72649
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8333828449249268
Epoch: 1, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.171 Vali Acc: 0.130 Test Loss: 2.171 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 1.624448537826538
Epoch: 2, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.972 Vali Acc: 0.338 Test Loss: 1.972 Test Acc: 0.338
Validation loss decreased (-0.129708 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 1.7424798011779785
Epoch: 3, Steps: 17 | Train Loss: 1.855 Vali Loss: 1.747 Vali Acc: 0.611 Test Loss: 1.747 Test Acc: 0.611
Validation loss decreased (-0.337818 --> -0.610793).  Saving model ...
Epoch: 4 cost time: 1.7266900539398193
Epoch: 4, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.515 Vali Acc: 0.738 Test Loss: 1.515 Test Acc: 0.738
Validation loss decreased (-0.610793 --> -0.737823).  Saving model ...
Epoch: 5 cost time: 1.7546555995941162
Epoch: 5, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.273 Vali Acc: 0.789 Test Loss: 1.273 Test Acc: 0.789
Validation loss decreased (-0.737823 --> -0.789176).  Saving model ...
Epoch: 6 cost time: 1.6922111511230469
Epoch: 6, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.057 Vali Acc: 0.811 Test Loss: 1.057 Test Acc: 0.811
Validation loss decreased (-0.789176 --> -0.810800).  Saving model ...
Epoch: 7 cost time: 1.91282057762146
Epoch: 7, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.864 Vali Acc: 0.870 Test Loss: 0.864 Test Acc: 0.870
Validation loss decreased (-0.810800 --> -0.870262).  Saving model ...
Epoch: 8 cost time: 1.8188714981079102
Epoch: 8, Steps: 17 | Train Loss: 0.727 Vali Loss: 0.701 Vali Acc: 0.903 Test Loss: 0.701 Test Acc: 0.903
Validation loss decreased (-0.870262 --> -0.902696).  Saving model ...
Epoch: 9 cost time: 1.849773645401001
Epoch: 9, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.582 Vali Acc: 0.908 Test Loss: 0.582 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 10 cost time: 2.007350444793701
Epoch: 10, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.484 Vali Acc: 0.927 Test Loss: 0.484 Test Acc: 0.927
Validation loss decreased (-0.908102 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 2.236571788787842
Epoch: 11, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.412 Vali Acc: 0.943 Test Loss: 0.412 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943239).  Saving model ...
Epoch: 12 cost time: 1.8190441131591797
Epoch: 12, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.365 Vali Acc: 0.941 Test Loss: 0.365 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8918836116790771
Epoch: 13, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.315 Vali Acc: 0.949 Test Loss: 0.315 Test Acc: 0.949
Validation loss decreased (-0.943239 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 1.8117032051086426
Epoch: 14, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 15 cost time: 2.412402629852295
Epoch: 15, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.258 Vali Acc: 0.951 Test Loss: 0.258 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 2.292766809463501
Epoch: 16, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.247 Vali Acc: 0.954 Test Loss: 0.247 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 2.3485195636749268
Epoch: 17, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 2.1569912433624268
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3832991123199463
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 2.242180585861206
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 1.9650871753692627
Epoch: 21, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5803980827331543
Epoch: 22, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8078463077545166
Epoch: 23, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 2.4410183429718018
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7656724452972412
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3509228229522705
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 2.271145820617676
Epoch: 27, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 2.3426458835601807
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 2.016950845718384
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6743040084838867
Epoch: 30, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 2.156888008117676
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.4629623889923096
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1257569789886475
Epoch: 33, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.557124614715576
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.4987988471984863
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.3768198490142822
Epoch: 36, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.3759384155273438
Epoch: 37, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.5272927284240723
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.25356125831604
Epoch: 39, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.4678590297698975
Epoch: 40, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 72649
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.149281978607178
Epoch: 1, Steps: 17 | Train Loss: 2.265 Vali Loss: 2.080 Vali Acc: 0.292 Test Loss: 2.080 Test Acc: 0.292
Validation loss decreased (inf --> -0.291871).  Saving model ...
Epoch: 2 cost time: 2.341334581375122
Epoch: 2, Steps: 17 | Train Loss: 2.062 Vali Loss: 1.901 Vali Acc: 0.532 Test Loss: 1.901 Test Acc: 0.532
Validation loss decreased (-0.291871 --> -0.532413).  Saving model ...
Epoch: 3 cost time: 2.700705051422119
Epoch: 3, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.685 Vali Acc: 0.716 Test Loss: 1.685 Test Acc: 0.716
Validation loss decreased (-0.532413 --> -0.716199).  Saving model ...
Epoch: 4 cost time: 2.2674002647399902
Epoch: 4, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.471 Vali Acc: 0.778 Test Loss: 1.471 Test Acc: 0.778
Validation loss decreased (-0.716199 --> -0.778364).  Saving model ...
Epoch: 5 cost time: 2.4476613998413086
Epoch: 5, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.233 Vali Acc: 0.827 Test Loss: 1.233 Test Acc: 0.827
Validation loss decreased (-0.778364 --> -0.827015).  Saving model ...
Epoch: 6 cost time: 2.6222305297851562
Epoch: 6, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.031 Vali Acc: 0.846 Test Loss: 1.031 Test Acc: 0.846
Validation loss decreased (-0.827015 --> -0.845936).  Saving model ...
Epoch: 7 cost time: 1.9906420707702637
Epoch: 7, Steps: 17 | Train Loss: 0.832 Vali Loss: 0.844 Vali Acc: 0.878 Test Loss: 0.844 Test Acc: 0.878
Validation loss decreased (-0.845936 --> -0.878370).  Saving model ...
Epoch: 8 cost time: 2.1781749725341797
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.686 Vali Acc: 0.900 Test Loss: 0.686 Test Acc: 0.900
Validation loss decreased (-0.878370 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 2.1194794178009033
Epoch: 9, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.580 Vali Acc: 0.897 Test Loss: 0.580 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3978583812713623
Epoch: 10, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.477 Vali Acc: 0.919 Test Loss: 0.477 Test Acc: 0.919
Validation loss decreased (-0.899993 --> -0.918914).  Saving model ...
Epoch: 11 cost time: 2.548928737640381
Epoch: 11, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.411 Vali Acc: 0.941 Test Loss: 0.411 Test Acc: 0.941
Validation loss decreased (-0.918914 --> -0.940536).  Saving model ...
Epoch: 12 cost time: 2.5790278911590576
Epoch: 12, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.367 Vali Acc: 0.951 Test Loss: 0.367 Test Acc: 0.951
Validation loss decreased (-0.940536 --> -0.951348).  Saving model ...
Epoch: 13 cost time: 2.420459032058716
Epoch: 13, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.317 Vali Acc: 0.951 Test Loss: 0.317 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 14 cost time: 2.4877421855926514
Epoch: 14, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.288 Vali Acc: 0.951 Test Loss: 0.288 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 2.59957218170166
Epoch: 15, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.256 Vali Acc: 0.951 Test Loss: 0.256 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 2.510467767715454
Epoch: 16, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 2.0351526737213135
Epoch: 17, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 2.3739013671875
Epoch: 18, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 2.2905869483947754
Epoch: 19, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.191 Vali Acc: 0.965 Test Loss: 0.191 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 2.3981921672821045
Epoch: 20, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.333364725112915
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1899666786193848
Epoch: 22, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 2.504542827606201
Epoch: 23, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.7151882648468018
Epoch: 24, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.46923828125
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.364790201187134
Epoch: 26, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.6509194374084473
Epoch: 27, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9985086917877197
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.116942882537842
Epoch: 29, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.7833385467529297
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.182006597518921
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.576685905456543
Epoch: 32, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.163257122039795
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 34 cost time: 2.0007762908935547
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5548934936523438
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.445465564727783
Epoch: 36, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2316951751708984
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.3782613277435303
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.4592299461364746
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.4105920791625977
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.9974241256713867
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.3156487941741943
Epoch: 42, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.905071973800659
Epoch: 43, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 56265
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.141992568969727
Epoch: 1, Steps: 17 | Train Loss: 2.265 Vali Loss: 2.079 Vali Acc: 0.305 Test Loss: 2.079 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 2.3358078002929688
Epoch: 2, Steps: 17 | Train Loss: 2.061 Vali Loss: 1.899 Vali Acc: 0.535 Test Loss: 1.899 Test Acc: 0.535
Validation loss decreased (-0.305385 --> -0.535116).  Saving model ...
Epoch: 3 cost time: 2.2404732704162598
Epoch: 3, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.683 Vali Acc: 0.722 Test Loss: 1.683 Test Acc: 0.722
Validation loss decreased (-0.535116 --> -0.721605).  Saving model ...
Epoch: 4 cost time: 2.561609983444214
Epoch: 4, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.467 Vali Acc: 0.768 Test Loss: 1.467 Test Acc: 0.768
Validation loss decreased (-0.721605 --> -0.767553).  Saving model ...
Epoch: 5 cost time: 2.548574447631836
Epoch: 5, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.229 Vali Acc: 0.816 Test Loss: 1.229 Test Acc: 0.816
Validation loss decreased (-0.767553 --> -0.816204).  Saving model ...
Epoch: 6 cost time: 2.4014840126037598
Epoch: 6, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.027 Vali Acc: 0.843 Test Loss: 1.027 Test Acc: 0.843
Validation loss decreased (-0.816204 --> -0.843233).  Saving model ...
Epoch: 7 cost time: 2.198762893676758
Epoch: 7, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.842 Vali Acc: 0.884 Test Loss: 0.842 Test Acc: 0.884
Validation loss decreased (-0.843233 --> -0.883775).  Saving model ...
Epoch: 8 cost time: 2.6328463554382324
Epoch: 8, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.684 Vali Acc: 0.911 Test Loss: 0.684 Test Acc: 0.911
Validation loss decreased (-0.883775 --> -0.910804).  Saving model ...
Epoch: 9 cost time: 2.460908889770508
Epoch: 9, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.579 Vali Acc: 0.905 Test Loss: 0.579 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.618950605392456
Epoch: 10, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.475 Vali Acc: 0.922 Test Loss: 0.475 Test Acc: 0.922
Validation loss decreased (-0.910804 --> -0.921617).  Saving model ...
Epoch: 11 cost time: 2.446959972381592
Epoch: 11, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.410 Vali Acc: 0.938 Test Loss: 0.410 Test Acc: 0.938
Validation loss decreased (-0.921617 --> -0.937834).  Saving model ...
Epoch: 12 cost time: 2.179175853729248
Epoch: 12, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.369 Vali Acc: 0.954 Test Loss: 0.369 Test Acc: 0.954
Validation loss decreased (-0.937834 --> -0.954050).  Saving model ...
Epoch: 13 cost time: 2.7527081966400146
Epoch: 13, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.318 Vali Acc: 0.951 Test Loss: 0.318 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3824222087860107
Epoch: 14, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8906495571136475
Epoch: 15, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
Validation loss decreased (-0.954050 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 2.325887680053711
Epoch: 16, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.658936023712158
Epoch: 17, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 2.5180771350860596
Epoch: 18, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 2.5393550395965576
Epoch: 19, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 2.0650060176849365
Epoch: 20, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0888993740081787
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9518756866455078
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 2.540212631225586
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.559739112854004
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 2.1883890628814697
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 2.504337787628174
Epoch: 26, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 27 cost time: 2.2723066806793213
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.483118772506714
Epoch: 28, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8082163333892822
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.855259895324707
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1312167644500732
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3846330642700195
Epoch: 32, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.6833367347717285
Epoch: 33, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 2.6837518215179443
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 2.203977346420288
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.8148961067199707
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4989068508148193
Epoch: 37, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.647064685821533
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.681272029876709
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.4039275646209717
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 2.3714215755462646
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.871384620666504
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.375750780105591
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.9647636413574219
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.9805128574371338
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.660452365875244
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.2894539833068848
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.474149703979492
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.548567056655884
Epoch: 49, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.2614712715148926
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 56265
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.584813356399536
Epoch: 1, Steps: 17 | Train Loss: 2.262 Vali Loss: 2.075 Vali Acc: 0.330 Test Loss: 2.075 Test Acc: 0.330
Validation loss decreased (inf --> -0.329709).  Saving model ...
Epoch: 2 cost time: 2.1086013317108154
Epoch: 2, Steps: 17 | Train Loss: 2.069 Vali Loss: 1.893 Vali Acc: 0.524 Test Loss: 1.893 Test Acc: 0.524
Validation loss decreased (-0.329709 --> -0.524305).  Saving model ...
Epoch: 3 cost time: 1.8152923583984375
Epoch: 3, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.675 Vali Acc: 0.719 Test Loss: 1.675 Test Acc: 0.719
Validation loss decreased (-0.524305 --> -0.718902).  Saving model ...
Epoch: 4 cost time: 2.2963733673095703
Epoch: 4, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.459 Vali Acc: 0.789 Test Loss: 1.459 Test Acc: 0.789
Validation loss decreased (-0.718902 --> -0.789175).  Saving model ...
Epoch: 5 cost time: 2.0555660724639893
Epoch: 5, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.220 Vali Acc: 0.811 Test Loss: 1.220 Test Acc: 0.811
Validation loss decreased (-0.789175 --> -0.810799).  Saving model ...
Epoch: 6 cost time: 1.9743993282318115
Epoch: 6, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.016 Vali Acc: 0.832 Test Loss: 1.016 Test Acc: 0.832
Validation loss decreased (-0.810799 --> -0.832422).  Saving model ...
Epoch: 7 cost time: 2.1088719367980957
Epoch: 7, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.835 Vali Acc: 0.859 Test Loss: 0.835 Test Acc: 0.859
Validation loss decreased (-0.832422 --> -0.859451).  Saving model ...
Epoch: 8 cost time: 2.2320828437805176
Epoch: 8, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.676 Vali Acc: 0.892 Test Loss: 0.676 Test Acc: 0.892
Validation loss decreased (-0.859451 --> -0.891885).  Saving model ...
Epoch: 9 cost time: 1.968707799911499
Epoch: 9, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.574 Vali Acc: 0.895 Test Loss: 0.574 Test Acc: 0.895
Validation loss decreased (-0.891885 --> -0.894589).  Saving model ...
Epoch: 10 cost time: 1.9612901210784912
Epoch: 10, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.471 Vali Acc: 0.919 Test Loss: 0.471 Test Acc: 0.919
Validation loss decreased (-0.894589 --> -0.918914).  Saving model ...
Epoch: 11 cost time: 1.767341136932373
Epoch: 11, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.407 Vali Acc: 0.941 Test Loss: 0.407 Test Acc: 0.941
Validation loss decreased (-0.918914 --> -0.940536).  Saving model ...
Epoch: 12 cost time: 1.9645936489105225
Epoch: 12, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 1.897404670715332
Epoch: 13, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.316 Vali Acc: 0.954 Test Loss: 0.316 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 14 cost time: 1.9910392761230469
Epoch: 14, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.287 Vali Acc: 0.949 Test Loss: 0.287 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.677415370941162
Epoch: 15, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.257 Vali Acc: 0.951 Test Loss: 0.257 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7354669570922852
Epoch: 16, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.662107229232788
Epoch: 17, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1369643211364746
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 2.3191754817962646
Epoch: 19, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 20 cost time: 2.141136407852173
Epoch: 20, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 1.8654365539550781
Epoch: 21, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.30509614944458
Epoch: 22, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 2.3663828372955322
Epoch: 23, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 2.136589288711548
Epoch: 24, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 2.2993416786193848
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1340267658233643
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 2.2573976516723633
Epoch: 27, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0536086559295654
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.306027412414551
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.8204867839813232
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4269254207611084
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1708767414093018
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.8050477504730225
Epoch: 33, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9215986728668213
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 2.313089370727539
Epoch: 35, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4272148609161377
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.132841110229492
Epoch: 37, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.319078207015991
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9856483936309814
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.2962896823883057
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 2.0929579734802246
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9892909526824951
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.995441198348999
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.229276418685913
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.2668542861938477
Epoch: 45, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.3582942485809326
Epoch: 46, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.289547920227051
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8795912265777588
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.239623785018921
Epoch: 49, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 50 cost time: 1.9380064010620117
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.94978666305542
Epoch: 51, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.149906635284424
Epoch: 52, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.9909334182739258
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.0309062004089355
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 2.1161649227142334
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 2.2982630729675293
Epoch: 56, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 2.212324380874634
Epoch: 57, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 2.439884901046753
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 2.1369965076446533
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 56265
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9024577140808105
Epoch: 1, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.091 Vali Acc: 0.332 Test Loss: 2.091 Test Acc: 0.332
Validation loss decreased (inf --> -0.332412).  Saving model ...
Epoch: 2 cost time: 2.1900219917297363
Epoch: 2, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.913 Vali Acc: 0.562 Test Loss: 1.913 Test Acc: 0.562
Validation loss decreased (-0.332412 --> -0.562143).  Saving model ...
Epoch: 3 cost time: 2.221404552459717
Epoch: 3, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.697 Vali Acc: 0.727 Test Loss: 1.697 Test Acc: 0.727
Validation loss decreased (-0.562143 --> -0.727010).  Saving model ...
Epoch: 4 cost time: 1.7949073314666748
Epoch: 4, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.483 Vali Acc: 0.770 Test Loss: 1.483 Test Acc: 0.770
Validation loss decreased (-0.727010 --> -0.770255).  Saving model ...
Epoch: 5 cost time: 1.5771458148956299
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.240 Vali Acc: 0.841 Test Loss: 1.240 Test Acc: 0.841
Validation loss decreased (-0.770255 --> -0.840528).  Saving model ...
Epoch: 6 cost time: 2.018395185470581
Epoch: 6, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.032 Vali Acc: 0.851 Test Loss: 1.032 Test Acc: 0.851
Validation loss decreased (-0.840528 --> -0.851341).  Saving model ...
Epoch: 7 cost time: 2.2798819541931152
Epoch: 7, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.847 Vali Acc: 0.870 Test Loss: 0.847 Test Acc: 0.870
Validation loss decreased (-0.851341 --> -0.870262).  Saving model ...
Epoch: 8 cost time: 2.358978033065796
Epoch: 8, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.686 Vali Acc: 0.895 Test Loss: 0.686 Test Acc: 0.895
Validation loss decreased (-0.870262 --> -0.894588).  Saving model ...
Epoch: 9 cost time: 1.9153597354888916
Epoch: 9, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.583 Vali Acc: 0.905 Test Loss: 0.583 Test Acc: 0.905
Validation loss decreased (-0.894588 --> -0.905400).  Saving model ...
Epoch: 10 cost time: 2.496574640274048
Epoch: 10, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.480 Vali Acc: 0.924 Test Loss: 0.480 Test Acc: 0.924
Validation loss decreased (-0.905400 --> -0.924320).  Saving model ...
Epoch: 11 cost time: 2.402693271636963
Epoch: 11, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.416 Vali Acc: 0.932 Test Loss: 0.416 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 2.5637881755828857
Epoch: 12, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.372 Vali Acc: 0.932 Test Loss: 0.372 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 13 cost time: 2.1843814849853516
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.322 Vali Acc: 0.943 Test Loss: 0.322 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 14 cost time: 2.2405946254730225
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.293 Vali Acc: 0.946 Test Loss: 0.293 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 15 cost time: 2.598376512527466
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.264 Vali Acc: 0.949 Test Loss: 0.264 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 16 cost time: 2.454406499862671
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2968759536743164
Epoch: 17, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 18 cost time: 2.428490400314331
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 2.2595601081848145
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.199489116668701
Epoch: 20, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 1.7313275337219238
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2956013679504395
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 2.153273344039917
Epoch: 23, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 2.436803102493286
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 2.3941590785980225
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0939693450927734
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 2.145862579345703
Epoch: 27, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7457695007324219
Epoch: 28, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.113145351409912
Epoch: 29, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 2.157581329345703
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 2.2408642768859863
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2629263401031494
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.581629991531372
Epoch: 33, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 2.005174398422241
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.3140273094177246
Epoch: 35, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.243166208267212
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.3154098987579346
Epoch: 37, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.1833815574645996
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.214367151260376
Epoch: 39, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.3196425437927246
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 2.0728261470794678
Epoch: 41, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.295128345489502
Epoch: 42, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0217738151550293
Epoch: 43, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.114406108856201
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.0952353477478027
Epoch: 45, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.430968761444092
Epoch: 46, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 2.388354539871216
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.959 Test Loss: 0.105 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 2.4228827953338623
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 2.3832552433013916
Epoch: 49, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 50 cost time: 2.1776697635650635
Epoch: 50, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.2975575923919678
Epoch: 51, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.4719443321228027
Epoch: 52, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.962 Test Loss: 0.094 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 2.1674768924713135
Epoch: 53, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 2.2380051612854004
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 55 cost time: 1.907050371170044
Epoch: 55, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.8770840167999268
Epoch: 56, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.962 Test Loss: 0.090 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 2.068960428237915
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.8697397708892822
Epoch: 58, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 2.315330982208252
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.9588794708251953
Epoch: 60, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.962 Test Loss: 0.095 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 2.6177291870117188
Epoch: 61, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.962 Test Loss: 0.093 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 2.5342791080474854
Epoch: 62, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.962 Test Loss: 0.092 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 2.309061050415039
Epoch: 63, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.965 Test Loss: 0.090 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 2.434142827987671
Epoch: 64, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 56265
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.56340479850769
Epoch: 1, Steps: 17 | Train Loss: 2.323 Vali Loss: 2.252 Vali Acc: 0.124 Test Loss: 2.252 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 2.5230553150177
Epoch: 2, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.131 Vali Acc: 0.197 Test Loss: 2.131 Test Acc: 0.197
Validation loss decreased (-0.124302 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 2.2540528774261475
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.972 Vali Acc: 0.335 Test Loss: 1.972 Test Acc: 0.335
Validation loss decreased (-0.197276 --> -0.335115).  Saving model ...
Epoch: 4 cost time: 2.3299753665924072
Epoch: 4, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.809 Vali Acc: 0.495 Test Loss: 1.809 Test Acc: 0.495
Validation loss decreased (-0.335115 --> -0.494577).  Saving model ...
Epoch: 5 cost time: 2.5348846912384033
Epoch: 5, Steps: 17 | Train Loss: 1.709 Vali Loss: 1.636 Vali Acc: 0.695 Test Loss: 1.636 Test Acc: 0.695
Validation loss decreased (-0.494577 --> -0.694578).  Saving model ...
Epoch: 6 cost time: 2.362837314605713
Epoch: 6, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.466 Vali Acc: 0.789 Test Loss: 1.466 Test Acc: 0.789
Validation loss decreased (-0.694578 --> -0.789175).  Saving model ...
Epoch: 7 cost time: 2.164567470550537
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.294 Vali Acc: 0.841 Test Loss: 1.294 Test Acc: 0.841
Validation loss decreased (-0.789175 --> -0.840528).  Saving model ...
Epoch: 8 cost time: 2.033374071121216
Epoch: 8, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.127 Vali Acc: 0.851 Test Loss: 1.127 Test Acc: 0.851
Validation loss decreased (-0.840528 --> -0.851340).  Saving model ...
Epoch: 9 cost time: 2.2052576541900635
Epoch: 9, Steps: 17 | Train Loss: 0.989 Vali Loss: 0.987 Vali Acc: 0.876 Test Loss: 0.987 Test Acc: 0.876
Validation loss decreased (-0.851340 --> -0.875666).  Saving model ...
Epoch: 10 cost time: 1.957019567489624
Epoch: 10, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.849 Vali Acc: 0.892 Test Loss: 0.849 Test Acc: 0.892
Validation loss decreased (-0.875666 --> -0.891883).  Saving model ...
Epoch: 11 cost time: 2.0897507667541504
Epoch: 11, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.744 Vali Acc: 0.895 Test Loss: 0.744 Test Acc: 0.895
Validation loss decreased (-0.891883 --> -0.894587).  Saving model ...
Epoch: 12 cost time: 2.3245646953582764
Epoch: 12, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.650 Vali Acc: 0.905 Test Loss: 0.650 Test Acc: 0.905
Validation loss decreased (-0.894587 --> -0.905399).  Saving model ...
Epoch: 13 cost time: 2.2446725368499756
Epoch: 13, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.579 Vali Acc: 0.916 Test Loss: 0.579 Test Acc: 0.916
Validation loss decreased (-0.905399 --> -0.916210).  Saving model ...
Epoch: 14 cost time: 2.3466789722442627
Epoch: 14, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.509 Vali Acc: 0.922 Test Loss: 0.509 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921617).  Saving model ...
Epoch: 15 cost time: 2.1424996852874756
Epoch: 15, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.464 Vali Acc: 0.924 Test Loss: 0.464 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 16 cost time: 1.9252426624298096
Epoch: 16, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.407 Vali Acc: 0.932 Test Loss: 0.407 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932428).  Saving model ...
Epoch: 17 cost time: 2.3087170124053955
Epoch: 17, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.381 Vali Acc: 0.932 Test Loss: 0.381 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 2.1970438957214355
Epoch: 18, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.340 Vali Acc: 0.943 Test Loss: 0.340 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 19 cost time: 2.0962934494018555
Epoch: 19, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.319 Vali Acc: 0.935 Test Loss: 0.319 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1854662895202637
Epoch: 20, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.301 Vali Acc: 0.943 Test Loss: 0.301 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 2.241203546524048
Epoch: 21, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.269 Vali Acc: 0.951 Test Loss: 0.269 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951349).  Saving model ...
Epoch: 22 cost time: 2.1567180156707764
Epoch: 22, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.113870859146118
Epoch: 23, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.251 Vali Acc: 0.938 Test Loss: 0.251 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0493004322052
Epoch: 24, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.385523557662964
Epoch: 25, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 2.3936996459960938
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 27 cost time: 1.941756010055542
Epoch: 27, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 2.1656363010406494
Epoch: 28, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.188 Vali Acc: 0.957 Test Loss: 0.188 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1481969356536865
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 30 cost time: 2.322420358657837
Epoch: 30, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3910510540008545
Epoch: 31, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 32 cost time: 2.1587657928466797
Epoch: 32, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.24466609954834
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8219492435455322
Epoch: 34, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.9681189060211182
Epoch: 35, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 2.0213265419006348
Epoch: 36, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.21817684173584
Epoch: 37, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.1115472316741943
Epoch: 38, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.369699001312256
Epoch: 39, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.1758365631103516
Epoch: 40, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.4664368629455566
Epoch: 41, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 2.1848978996276855
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.3222768306732178
Epoch: 43, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.0746710300445557
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.5025265216827393
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.1505589485168457
Epoch: 46, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.132159948348999
Epoch: 47, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.0947914123535156
Epoch: 48, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 2.4053831100463867
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.4057891368865967
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.6598777770996094
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 52 cost time: 2.5791091918945312
Epoch: 52, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 2.0040171146392822
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.2379672527313232
Epoch: 54, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.0513827800750732
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.9019503593444824
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 2.1255390644073486
Epoch: 57, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 58 cost time: 2.2772467136383057
Epoch: 58, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.370011568069458
Epoch: 59, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 2.5405733585357666
Epoch: 60, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.3011372089385986
Epoch: 61, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 62 cost time: 2.1372804641723633
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.1226513385772705
Epoch: 63, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.4295454025268555
Epoch: 64, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.2124266624450684
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 2.322021722793579
Epoch: 66, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.860030174255371
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.8426342010498047
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.31487774848938
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.4647786617279053
Epoch: 70, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.6757843494415283
Epoch: 71, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 278057
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.116277694702148
Epoch: 1, Steps: 17 | Train Loss: 2.327 Vali Loss: 2.246 Vali Acc: 0.127 Test Loss: 2.246 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 2.0416476726531982
Epoch: 2, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.123 Vali Acc: 0.197 Test Loss: 2.123 Test Acc: 0.197
Validation loss decreased (-0.127005 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 2.1939589977264404
Epoch: 3, Steps: 17 | Train Loss: 2.072 Vali Loss: 1.964 Vali Acc: 0.338 Test Loss: 1.964 Test Acc: 0.338
Validation loss decreased (-0.197276 --> -0.337818).  Saving model ...
Epoch: 4 cost time: 2.177104949951172
Epoch: 4, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.801 Vali Acc: 0.530 Test Loss: 1.801 Test Acc: 0.530
Validation loss decreased (-0.337818 --> -0.529712).  Saving model ...
Epoch: 5 cost time: 2.153876781463623
Epoch: 5, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.627 Vali Acc: 0.730 Test Loss: 1.627 Test Acc: 0.730
Validation loss decreased (-0.529712 --> -0.729713).  Saving model ...
Epoch: 6 cost time: 1.8590381145477295
Epoch: 6, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.455 Vali Acc: 0.803 Test Loss: 1.455 Test Acc: 0.803
Validation loss decreased (-0.729713 --> -0.802688).  Saving model ...
Epoch: 7 cost time: 2.192249059677124
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.283 Vali Acc: 0.838 Test Loss: 1.283 Test Acc: 0.838
Validation loss decreased (-0.802688 --> -0.837825).  Saving model ...
Epoch: 8 cost time: 2.3228108882904053
Epoch: 8, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.113 Vali Acc: 0.854 Test Loss: 1.113 Test Acc: 0.854
Validation loss decreased (-0.837825 --> -0.854043).  Saving model ...
Epoch: 9 cost time: 2.0618693828582764
Epoch: 9, Steps: 17 | Train Loss: 1.003 Vali Loss: 0.975 Vali Acc: 0.868 Test Loss: 0.975 Test Acc: 0.868
Validation loss decreased (-0.854043 --> -0.867558).  Saving model ...
Epoch: 10 cost time: 2.3507587909698486
Epoch: 10, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.836 Vali Acc: 0.895 Test Loss: 0.836 Test Acc: 0.895
Validation loss decreased (-0.867558 --> -0.894586).  Saving model ...
Epoch: 11 cost time: 2.2700107097625732
Epoch: 11, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.732 Vali Acc: 0.897 Test Loss: 0.732 Test Acc: 0.897
Validation loss decreased (-0.894586 --> -0.897290).  Saving model ...
Epoch: 12 cost time: 2.20184326171875
Epoch: 12, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.641 Vali Acc: 0.908 Test Loss: 0.641 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 13 cost time: 1.9201161861419678
Epoch: 13, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.575 Vali Acc: 0.916 Test Loss: 0.575 Test Acc: 0.916
Validation loss decreased (-0.908102 --> -0.916210).  Saving model ...
Epoch: 14 cost time: 1.8682856559753418
Epoch: 14, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.507 Vali Acc: 0.930 Test Loss: 0.507 Test Acc: 0.930
Validation loss decreased (-0.916210 --> -0.929725).  Saving model ...
Epoch: 15 cost time: 2.033597707748413
Epoch: 15, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.459 Vali Acc: 0.941 Test Loss: 0.459 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940536).  Saving model ...
Epoch: 16 cost time: 2.11798357963562
Epoch: 16, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.402 Vali Acc: 0.932 Test Loss: 0.402 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6649136543273926
Epoch: 17, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.382 Vali Acc: 0.943 Test Loss: 0.382 Test Acc: 0.943
Validation loss decreased (-0.940536 --> -0.943239).  Saving model ...
Epoch: 18 cost time: 1.960853099822998
Epoch: 18, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.335 Vali Acc: 0.943 Test Loss: 0.335 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 19 cost time: 1.6337928771972656
Epoch: 19, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.320 Vali Acc: 0.943 Test Loss: 0.320 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 2.5754263401031494
Epoch: 20, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.305 Vali Acc: 0.954 Test Loss: 0.305 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954051).  Saving model ...
Epoch: 21 cost time: 2.3010547161102295
Epoch: 21, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.268 Vali Acc: 0.951 Test Loss: 0.268 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4352753162384033
Epoch: 22, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.601764678955078
Epoch: 23, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.980842113494873
Epoch: 24, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 2.1556804180145264
Epoch: 25, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1132991313934326
Epoch: 26, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970268).  Saving model ...
Epoch: 27 cost time: 2.004605770111084
Epoch: 27, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.318331241607666
Epoch: 28, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.7849514484405518
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1194591522216797
Epoch: 30, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.156712055206299
Epoch: 31, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.049055814743042
Epoch: 32, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0178442001342773
Epoch: 33, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8559026718139648
Epoch: 34, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0975868701934814
Epoch: 35, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 2.10693097114563
Epoch: 36, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9759199619293213
Epoch: 37, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.9692838191986084
Epoch: 38, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0727312564849854
Epoch: 39, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 1.9864075183868408
Epoch: 40, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.1862802505493164
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 42 cost time: 2.306170701980591
Epoch: 42, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.043337345123291
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.523054599761963
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.2634997367858887
Epoch: 45, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 46 cost time: 2.217661142349243
Epoch: 46, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.2134385108947754
Epoch: 47, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.219247817993164
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7603366374969482
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.3687691688537598
Epoch: 50, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7893633842468262
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.040522336959839
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.2033028602600098
Epoch: 53, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 2.318673849105835
Epoch: 54, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.335757255554199
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 2.2694077491760254
Epoch: 56, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 57 cost time: 2.279536485671997
Epoch: 57, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 58 cost time: 2.080319881439209
Epoch: 58, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 2.3138482570648193
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.8360333442687988
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.021681308746338
Epoch: 61, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 62 cost time: 2.2802889347076416
Epoch: 62, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.8235929012298584
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.072770595550537
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 65 cost time: 1.9398787021636963
Epoch: 65, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.8598909378051758
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 67 cost time: 2.067214012145996
Epoch: 67, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 2.4139821529388428
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.409472703933716
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.609905481338501
Epoch: 70, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 2.3232314586639404
Epoch: 71, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 2.432673931121826
Epoch: 72, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 2.2348408699035645
Epoch: 73, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 74 cost time: 2.2211430072784424
Epoch: 74, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.446598768234253
Epoch: 75, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 76 cost time: 2.109022378921509
Epoch: 76, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 2.547555923461914
Epoch: 77, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 2.3148038387298584
Epoch: 78, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 2.630580425262451
Epoch: 79, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 2.131337881088257
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.8183465003967285
Epoch: 81, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 2.300417900085449
Epoch: 82, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 2.406947612762451
Epoch: 83, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 84 cost time: 2.2698028087615967
Epoch: 84, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 2.2390663623809814
Epoch: 85, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 2.487854480743408
Epoch: 86, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 2.1490354537963867
Epoch: 87, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.95186185836792
Epoch: 88, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 2.3006792068481445
Epoch: 89, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 2.3063158988952637
Epoch: 90, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 2.159632444381714
Epoch: 91, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 1.8869986534118652
Epoch: 92, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 2.406602382659912
Epoch: 93, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 278057
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.574204683303833
Epoch: 1, Steps: 17 | Train Loss: 2.328 Vali Loss: 2.246 Vali Acc: 0.124 Test Loss: 2.246 Test Acc: 0.124
Validation loss decreased (inf --> -0.124302).  Saving model ...
Epoch: 2 cost time: 2.4687674045562744
Epoch: 2, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.123 Vali Acc: 0.200 Test Loss: 2.123 Test Acc: 0.200
Validation loss decreased (-0.124302 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 2.10554575920105
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.960 Vali Acc: 0.332 Test Loss: 1.960 Test Acc: 0.332
Validation loss decreased (-0.199979 --> -0.332413).  Saving model ...
Epoch: 4 cost time: 2.119170904159546
Epoch: 4, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.792 Vali Acc: 0.546 Test Loss: 1.792 Test Acc: 0.546
Validation loss decreased (-0.332413 --> -0.545928).  Saving model ...
Epoch: 5 cost time: 2.2137956619262695
Epoch: 5, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.610 Vali Acc: 0.708 Test Loss: 1.610 Test Acc: 0.708
Validation loss decreased (-0.545928 --> -0.708092).  Saving model ...
Epoch: 6 cost time: 2.299579620361328
Epoch: 6, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.433 Vali Acc: 0.792 Test Loss: 1.433 Test Acc: 0.792
Validation loss decreased (-0.708092 --> -0.791878).  Saving model ...
Epoch: 7 cost time: 2.348973274230957
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.261 Vali Acc: 0.832 Test Loss: 1.261 Test Acc: 0.832
Validation loss decreased (-0.791878 --> -0.832420).  Saving model ...
Epoch: 8 cost time: 2.18977689743042
Epoch: 8, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.098 Vali Acc: 0.851 Test Loss: 1.098 Test Acc: 0.851
Validation loss decreased (-0.832420 --> -0.851340).  Saving model ...
Epoch: 9 cost time: 1.9910163879394531
Epoch: 9, Steps: 17 | Train Loss: 1.002 Vali Loss: 0.960 Vali Acc: 0.865 Test Loss: 0.960 Test Acc: 0.865
Validation loss decreased (-0.851340 --> -0.864855).  Saving model ...
Epoch: 10 cost time: 2.1214497089385986
Epoch: 10, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.822 Vali Acc: 0.873 Test Loss: 0.822 Test Acc: 0.873
Validation loss decreased (-0.864855 --> -0.872965).  Saving model ...
Epoch: 11 cost time: 1.7219228744506836
Epoch: 11, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.719 Vali Acc: 0.895 Test Loss: 0.719 Test Acc: 0.895
Validation loss decreased (-0.872965 --> -0.894587).  Saving model ...
Epoch: 12 cost time: 2.158912181854248
Epoch: 12, Steps: 17 | Train Loss: 0.635 Vali Loss: 0.631 Vali Acc: 0.903 Test Loss: 0.631 Test Acc: 0.903
Validation loss decreased (-0.894587 --> -0.902696).  Saving model ...
Epoch: 13 cost time: 2.074181079864502
Epoch: 13, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.571 Vali Acc: 0.897 Test Loss: 0.571 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.221113443374634
Epoch: 14, Steps: 17 | Train Loss: 0.484 Vali Loss: 0.502 Vali Acc: 0.911 Test Loss: 0.502 Test Acc: 0.911
Validation loss decreased (-0.902696 --> -0.910806).  Saving model ...
Epoch: 15 cost time: 2.3880677223205566
Epoch: 15, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.452 Vali Acc: 0.924 Test Loss: 0.452 Test Acc: 0.924
Validation loss decreased (-0.910806 --> -0.924320).  Saving model ...
Epoch: 16 cost time: 2.1021981239318848
Epoch: 16, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.395 Vali Acc: 0.938 Test Loss: 0.395 Test Acc: 0.938
Validation loss decreased (-0.924320 --> -0.937834).  Saving model ...
Epoch: 17 cost time: 2.231760025024414
Epoch: 17, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4861106872558594
Epoch: 18, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.335 Vali Acc: 0.935 Test Loss: 0.335 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.211322546005249
Epoch: 19, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.313 Vali Acc: 0.938 Test Loss: 0.313 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 2.328606128692627
Epoch: 20, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.301 Vali Acc: 0.932 Test Loss: 0.301 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.991447925567627
Epoch: 21, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.265 Vali Acc: 0.946 Test Loss: 0.265 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 1.7357745170593262
Epoch: 22, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.243 Vali Acc: 0.949 Test Loss: 0.243 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 2.090183973312378
Epoch: 23, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 24 cost time: 2.1826040744781494
Epoch: 24, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.217831611633301
Epoch: 25, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.137847423553467
Epoch: 26, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 2.2873446941375732
Epoch: 27, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 1.9036598205566406
Epoch: 28, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0915589332580566
Epoch: 29, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 2.4498848915100098
Epoch: 30, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 2.4059677124023438
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.216460943222046
Epoch: 32, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972971).  Saving model ...
Epoch: 33 cost time: 2.2585694789886475
Epoch: 33, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8551089763641357
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 2.104337453842163
Epoch: 35, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9648518562316895
Epoch: 36, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.159842014312744
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.2293050289154053
Epoch: 38, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.2554590702056885
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.460437774658203
Epoch: 40, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.7848031520843506
Epoch: 41, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.8971073627471924
Epoch: 42, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.9632296562194824
Epoch: 43, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9951622486114502
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.0113627910614014
Epoch: 45, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.657196044921875
Epoch: 46, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6607170104980469
Epoch: 47, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.8524751663208008
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.324037790298462
Epoch: 49, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.2369072437286377
Epoch: 50, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.7620697021484375
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 278057
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.730213642120361
Epoch: 1, Steps: 17 | Train Loss: 2.302 Vali Loss: 2.237 Vali Acc: 0.103 Test Loss: 2.237 Test Acc: 0.103
Validation loss decreased (inf --> -0.102680).  Saving model ...
Epoch: 2 cost time: 1.9677634239196777
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.111 Vali Acc: 0.211 Test Loss: 2.111 Test Acc: 0.211
Validation loss decreased (-0.102680 --> -0.210790).  Saving model ...
Epoch: 3 cost time: 2.086703062057495
Epoch: 3, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.945 Vali Acc: 0.443 Test Loss: 1.945 Test Acc: 0.443
Validation loss decreased (-0.210790 --> -0.443224).  Saving model ...
Epoch: 4 cost time: 2.0167551040649414
Epoch: 4, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.776 Vali Acc: 0.622 Test Loss: 1.776 Test Acc: 0.622
Validation loss decreased (-0.443224 --> -0.621604).  Saving model ...
Epoch: 5 cost time: 2.23331618309021
Epoch: 5, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.586 Vali Acc: 0.770 Test Loss: 1.586 Test Acc: 0.770
Validation loss decreased (-0.621604 --> -0.770254).  Saving model ...
Epoch: 6 cost time: 2.273341417312622
Epoch: 6, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.403 Vali Acc: 0.827 Test Loss: 1.403 Test Acc: 0.827
Validation loss decreased (-0.770254 --> -0.827013).  Saving model ...
Epoch: 7 cost time: 2.0195839405059814
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.227 Vali Acc: 0.859 Test Loss: 1.227 Test Acc: 0.859
Validation loss decreased (-0.827013 --> -0.859447).  Saving model ...
Epoch: 8 cost time: 2.116776943206787
Epoch: 8, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.059 Vali Acc: 0.862 Test Loss: 1.059 Test Acc: 0.862
Validation loss decreased (-0.859447 --> -0.862152).  Saving model ...
Epoch: 9 cost time: 2.018115282058716
Epoch: 9, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.928 Vali Acc: 0.873 Test Loss: 0.928 Test Acc: 0.873
Validation loss decreased (-0.862152 --> -0.872964).  Saving model ...
Epoch: 10 cost time: 2.3723227977752686
Epoch: 10, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.789 Vali Acc: 0.886 Test Loss: 0.789 Test Acc: 0.886
Validation loss decreased (-0.872964 --> -0.886479).  Saving model ...
Epoch: 11 cost time: 1.9268031120300293
Epoch: 11, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.687 Vali Acc: 0.903 Test Loss: 0.687 Test Acc: 0.903
Validation loss decreased (-0.886479 --> -0.902696).  Saving model ...
Epoch: 12 cost time: 2.0546648502349854
Epoch: 12, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.604 Vali Acc: 0.908 Test Loss: 0.604 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 13 cost time: 2.0727627277374268
Epoch: 13, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.539 Vali Acc: 0.908 Test Loss: 0.539 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908103).  Saving model ...
Epoch: 14 cost time: 2.287696599960327
Epoch: 14, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.467 Vali Acc: 0.908 Test Loss: 0.467 Test Acc: 0.908
Validation loss decreased (-0.908103 --> -0.908103).  Saving model ...
Epoch: 15 cost time: 2.1683969497680664
Epoch: 15, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.418 Vali Acc: 0.914 Test Loss: 0.418 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 16 cost time: 2.318791389465332
Epoch: 16, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.369 Vali Acc: 0.916 Test Loss: 0.369 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916213).  Saving model ...
Epoch: 17 cost time: 2.17537260055542
Epoch: 17, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.347 Vali Acc: 0.914 Test Loss: 0.347 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6711814403533936
Epoch: 18, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
Validation loss decreased (-0.916213 --> -0.921619).  Saving model ...
Epoch: 19 cost time: 2.202186107635498
Epoch: 19, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2972168922424316
Epoch: 20, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.226728916168213
Epoch: 21, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
Validation loss decreased (-0.921619 --> -0.927025).  Saving model ...
Epoch: 22 cost time: 2.215364694595337
Epoch: 22, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.927025 --> -0.929727).  Saving model ...
Epoch: 23 cost time: 2.071545124053955
Epoch: 23, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2589080333709717
Epoch: 24, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.929727 --> -0.929728).  Saving model ...
Epoch: 25 cost time: 2.320836067199707
Epoch: 25, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
Validation loss decreased (-0.929728 --> -0.929728).  Saving model ...
Epoch: 26 cost time: 2.2862792015075684
Epoch: 26, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.929728 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 2.308952808380127
Epoch: 27, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 2.1158528327941895
Epoch: 28, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 2.1328558921813965
Epoch: 29, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 2.0472161769866943
Epoch: 30, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 1.8819999694824219
Epoch: 31, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8651623725891113
Epoch: 32, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.2044191360473633
Epoch: 33, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9981920719146729
Epoch: 34, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.178013324737549
Epoch: 35, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.1191182136535645
Epoch: 36, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.207953929901123
Epoch: 37, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.3157541751861572
Epoch: 38, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.957 Test Loss: 0.135 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.6522934436798096
Epoch: 39, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.949 Test Loss: 0.139 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.2458877563476562
Epoch: 40, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.949 Test Loss: 0.135 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 278057
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.488894939422607
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.059 Vali Acc: 0.268 Test Loss: 2.059 Test Acc: 0.268
Validation loss decreased (inf --> -0.267547).  Saving model ...
Epoch: 2 cost time: 1.8019237518310547
Epoch: 2, Steps: 17 | Train Loss: 2.057 Vali Loss: 1.956 Vali Acc: 0.395 Test Loss: 1.956 Test Acc: 0.395
Validation loss decreased (-0.267547 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 1.4936344623565674
Epoch: 3, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.815 Vali Acc: 0.589 Test Loss: 1.815 Test Acc: 0.589
Validation loss decreased (-0.394575 --> -0.589171).  Saving model ...
Epoch: 4 cost time: 1.991762638092041
Epoch: 4, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.675 Vali Acc: 0.730 Test Loss: 1.675 Test Acc: 0.730
Validation loss decreased (-0.589171 --> -0.729713).  Saving model ...
Epoch: 5 cost time: 2.091477632522583
Epoch: 5, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.520 Vali Acc: 0.797 Test Loss: 1.520 Test Acc: 0.797
Validation loss decreased (-0.729713 --> -0.797282).  Saving model ...
Epoch: 6 cost time: 1.991642951965332
Epoch: 6, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.352 Vali Acc: 0.832 Test Loss: 1.352 Test Acc: 0.832
Validation loss decreased (-0.797282 --> -0.832419).  Saving model ...
Epoch: 7 cost time: 2.0338308811187744
Epoch: 7, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.191 Vali Acc: 0.843 Test Loss: 1.191 Test Acc: 0.843
Validation loss decreased (-0.832419 --> -0.843231).  Saving model ...
Epoch: 8 cost time: 2.239330291748047
Epoch: 8, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.040 Vali Acc: 0.859 Test Loss: 1.040 Test Acc: 0.859
Validation loss decreased (-0.843231 --> -0.859449).  Saving model ...
Epoch: 9 cost time: 2.009693145751953
Epoch: 9, Steps: 17 | Train Loss: 0.927 Vali Loss: 0.923 Vali Acc: 0.884 Test Loss: 0.923 Test Acc: 0.884
Validation loss decreased (-0.859449 --> -0.883775).  Saving model ...
Epoch: 10 cost time: 1.7987158298492432
Epoch: 10, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.798 Vali Acc: 0.892 Test Loss: 0.798 Test Acc: 0.892
Validation loss decreased (-0.883775 --> -0.891884).  Saving model ...
Epoch: 11 cost time: 1.9368805885314941
Epoch: 11, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.704 Vali Acc: 0.908 Test Loss: 0.704 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908101).  Saving model ...
Epoch: 12 cost time: 2.022063732147217
Epoch: 12, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.620 Vali Acc: 0.914 Test Loss: 0.620 Test Acc: 0.914
Validation loss decreased (-0.908101 --> -0.913507).  Saving model ...
Epoch: 13 cost time: 2.3559811115264893
Epoch: 13, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.551 Vali Acc: 0.922 Test Loss: 0.551 Test Acc: 0.922
Validation loss decreased (-0.913507 --> -0.921616).  Saving model ...
Epoch: 14 cost time: 2.3088293075561523
Epoch: 14, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.487 Vali Acc: 0.927 Test Loss: 0.487 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 15 cost time: 2.474853754043579
Epoch: 15, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.447 Vali Acc: 0.935 Test Loss: 0.447 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 16 cost time: 1.8707454204559326
Epoch: 16, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.403 Vali Acc: 0.935 Test Loss: 0.403 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 17 cost time: 2.376422882080078
Epoch: 17, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.376 Vali Acc: 0.935 Test Loss: 0.376 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 2.2865965366363525
Epoch: 18, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.336 Vali Acc: 0.938 Test Loss: 0.336 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 19 cost time: 2.534729242324829
Epoch: 19, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.305 Vali Acc: 0.951 Test Loss: 0.305 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951348).  Saving model ...
Epoch: 20 cost time: 2.336289882659912
Epoch: 20, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.293 Vali Acc: 0.951 Test Loss: 0.293 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 21 cost time: 2.1973135471343994
Epoch: 21, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.280 Vali Acc: 0.951 Test Loss: 0.280 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 22 cost time: 2.002591848373413
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 23 cost time: 1.9717960357666016
Epoch: 23, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 24 cost time: 2.1316425800323486
Epoch: 24, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.229 Vali Acc: 0.959 Test Loss: 0.229 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 25 cost time: 2.3690896034240723
Epoch: 25, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 26 cost time: 2.4326393604278564
Epoch: 26, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.203 Vali Acc: 0.957 Test Loss: 0.203 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.15624737739563
Epoch: 27, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 28 cost time: 2.138556957244873
Epoch: 28, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.151634931564331
Epoch: 29, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970268).  Saving model ...
Epoch: 30 cost time: 2.3801462650299072
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3753678798675537
Epoch: 31, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1614279747009277
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.808034896850586
Epoch: 33, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2480149269104004
Epoch: 34, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.1400818824768066
Epoch: 35, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.5065388679504395
Epoch: 36, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.183048963546753
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 2.0381898880004883
Epoch: 38, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3494393825531006
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 2.3800947666168213
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8174426555633545
Epoch: 41, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.850874662399292
Epoch: 42, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.7528800964355469
Epoch: 43, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.234203577041626
Epoch: 44, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 2.1618714332580566
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9301912784576416
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.8762848377227783
Epoch: 47, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.8879354000091553
Epoch: 48, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.2305965423583984
Epoch: 49, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.8321669101715088
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8552441596984863
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.9631459712982178
Epoch: 52, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.926603078842163
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.982748031616211
Epoch: 54, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 146985
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 5.21153450012207
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.061 Vali Acc: 0.281 Test Loss: 2.061 Test Acc: 0.281
Validation loss decreased (inf --> -0.281060).  Saving model ...
Epoch: 2 cost time: 1.878239393234253
Epoch: 2, Steps: 17 | Train Loss: 2.059 Vali Loss: 1.957 Vali Acc: 0.408 Test Loss: 1.957 Test Acc: 0.408
Validation loss decreased (-0.281060 --> -0.408089).  Saving model ...
Epoch: 3 cost time: 2.0260446071624756
Epoch: 3, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.817 Vali Acc: 0.573 Test Loss: 1.817 Test Acc: 0.573
Validation loss decreased (-0.408089 --> -0.572955).  Saving model ...
Epoch: 4 cost time: 2.064771890640259
Epoch: 4, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.677 Vali Acc: 0.714 Test Loss: 1.677 Test Acc: 0.714
Validation loss decreased (-0.572955 --> -0.713497).  Saving model ...
Epoch: 5 cost time: 2.2484145164489746
Epoch: 5, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.519 Vali Acc: 0.778 Test Loss: 1.519 Test Acc: 0.778
Validation loss decreased (-0.713497 --> -0.778363).  Saving model ...
Epoch: 6 cost time: 1.957533359527588
Epoch: 6, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.353 Vali Acc: 0.822 Test Loss: 1.353 Test Acc: 0.822
Validation loss decreased (-0.778363 --> -0.821608).  Saving model ...
Epoch: 7 cost time: 1.4937055110931396
Epoch: 7, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.189 Vali Acc: 0.857 Test Loss: 1.189 Test Acc: 0.857
Validation loss decreased (-0.821608 --> -0.856745).  Saving model ...
Epoch: 8 cost time: 1.8343555927276611
Epoch: 8, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.038 Vali Acc: 0.865 Test Loss: 1.038 Test Acc: 0.865
Validation loss decreased (-0.856745 --> -0.864854).  Saving model ...
Epoch: 9 cost time: 1.9479546546936035
Epoch: 9, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.922 Vali Acc: 0.873 Test Loss: 0.922 Test Acc: 0.873
Validation loss decreased (-0.864854 --> -0.872964).  Saving model ...
Epoch: 10 cost time: 1.7945349216461182
Epoch: 10, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.800 Vali Acc: 0.886 Test Loss: 0.800 Test Acc: 0.886
Validation loss decreased (-0.872964 --> -0.886478).  Saving model ...
Epoch: 11 cost time: 1.7972407341003418
Epoch: 11, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.705 Vali Acc: 0.903 Test Loss: 0.705 Test Acc: 0.903
Validation loss decreased (-0.886478 --> -0.902696).  Saving model ...
Epoch: 12 cost time: 1.9472520351409912
Epoch: 12, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.621 Vali Acc: 0.919 Test Loss: 0.621 Test Acc: 0.919
Validation loss decreased (-0.902696 --> -0.918913).  Saving model ...
Epoch: 13 cost time: 2.096038818359375
Epoch: 13, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.554 Vali Acc: 0.922 Test Loss: 0.554 Test Acc: 0.922
Validation loss decreased (-0.918913 --> -0.921616).  Saving model ...
Epoch: 14 cost time: 2.3724186420440674
Epoch: 14, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.487 Vali Acc: 0.935 Test Loss: 0.487 Test Acc: 0.935
Validation loss decreased (-0.921616 --> -0.935130).  Saving model ...
Epoch: 15 cost time: 2.2219836711883545
Epoch: 15, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.448 Vali Acc: 0.932 Test Loss: 0.448 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.891979455947876
Epoch: 16, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.402 Vali Acc: 0.938 Test Loss: 0.402 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937834).  Saving model ...
Epoch: 17 cost time: 2.032711982727051
Epoch: 17, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7442584037780762
Epoch: 18, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 1.6800620555877686
Epoch: 19, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.307 Vali Acc: 0.951 Test Loss: 0.307 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951348).  Saving model ...
Epoch: 20 cost time: 2.2863552570343018
Epoch: 20, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.293 Vali Acc: 0.949 Test Loss: 0.293 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.724440336227417
Epoch: 21, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.275 Vali Acc: 0.954 Test Loss: 0.275 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 22 cost time: 1.5501830577850342
Epoch: 22, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.248 Vali Acc: 0.954 Test Loss: 0.248 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 23 cost time: 1.961059331893921
Epoch: 23, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.233 Vali Acc: 0.959 Test Loss: 0.233 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 24 cost time: 2.085236072540283
Epoch: 24, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 25 cost time: 1.9939002990722656
Epoch: 25, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.189923048019409
Epoch: 26, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 27 cost time: 1.6590983867645264
Epoch: 27, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.9055078029632568
Epoch: 28, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 2.008213996887207
Epoch: 29, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 30 cost time: 2.0652880668640137
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 1.9794578552246094
Epoch: 31, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972971).  Saving model ...
Epoch: 32 cost time: 1.7294631004333496
Epoch: 32, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8656179904937744
Epoch: 33, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.916046142578125
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8754894733428955
Epoch: 35, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.4000349044799805
Epoch: 36, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1714529991149902
Epoch: 37, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.9137330055236816
Epoch: 38, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.239902973175049
Epoch: 39, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1657590866088867
Epoch: 40, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.193694829940796
Epoch: 41, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 146985
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.283671855926514
Epoch: 1, Steps: 17 | Train Loss: 2.166 Vali Loss: 2.052 Vali Acc: 0.281 Test Loss: 2.052 Test Acc: 0.281
Validation loss decreased (inf --> -0.281061).  Saving model ...
Epoch: 2 cost time: 1.7395243644714355
Epoch: 2, Steps: 17 | Train Loss: 2.058 Vali Loss: 1.949 Vali Acc: 0.422 Test Loss: 1.949 Test Acc: 0.422
Validation loss decreased (-0.281061 --> -0.421602).  Saving model ...
Epoch: 3 cost time: 1.4912660121917725
Epoch: 3, Steps: 17 | Train Loss: 1.919 Vali Loss: 1.806 Vali Acc: 0.592 Test Loss: 1.806 Test Acc: 0.592
Validation loss decreased (-0.421602 --> -0.591874).  Saving model ...
Epoch: 4 cost time: 1.39341139793396
Epoch: 4, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.663 Vali Acc: 0.692 Test Loss: 1.663 Test Acc: 0.692
Validation loss decreased (-0.591874 --> -0.691875).  Saving model ...
Epoch: 5 cost time: 1.7836668491363525
Epoch: 5, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.502 Vali Acc: 0.762 Test Loss: 1.502 Test Acc: 0.762
Validation loss decreased (-0.691875 --> -0.762147).  Saving model ...
Epoch: 6 cost time: 2.1752893924713135
Epoch: 6, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.331 Vali Acc: 0.811 Test Loss: 1.331 Test Acc: 0.811
Validation loss decreased (-0.762147 --> -0.810798).  Saving model ...
Epoch: 7 cost time: 2.4099819660186768
Epoch: 7, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.169 Vali Acc: 0.822 Test Loss: 1.169 Test Acc: 0.822
Validation loss decreased (-0.810798 --> -0.821610).  Saving model ...
Epoch: 8 cost time: 2.209123373031616
Epoch: 8, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.019 Vali Acc: 0.843 Test Loss: 1.019 Test Acc: 0.843
Validation loss decreased (-0.821610 --> -0.843233).  Saving model ...
Epoch: 9 cost time: 2.7342171669006348
Epoch: 9, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.904 Vali Acc: 0.862 Test Loss: 0.904 Test Acc: 0.862
Validation loss decreased (-0.843233 --> -0.862153).  Saving model ...
Epoch: 10 cost time: 2.2352142333984375
Epoch: 10, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.786 Vali Acc: 0.868 Test Loss: 0.786 Test Acc: 0.868
Validation loss decreased (-0.862153 --> -0.867560).  Saving model ...
Epoch: 11 cost time: 2.4106085300445557
Epoch: 11, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.697 Vali Acc: 0.876 Test Loss: 0.697 Test Acc: 0.876
Validation loss decreased (-0.867560 --> -0.875669).  Saving model ...
Epoch: 12 cost time: 2.3888721466064453
Epoch: 12, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.612 Vali Acc: 0.897 Test Loss: 0.612 Test Acc: 0.897
Validation loss decreased (-0.875669 --> -0.897291).  Saving model ...
Epoch: 13 cost time: 2.5869052410125732
Epoch: 13, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.545 Vali Acc: 0.908 Test Loss: 0.545 Test Acc: 0.908
Validation loss decreased (-0.897291 --> -0.908103).  Saving model ...
Epoch: 14 cost time: 2.3033809661865234
Epoch: 14, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
Validation loss decreased (-0.908103 --> -0.921617).  Saving model ...
Epoch: 15 cost time: 1.9563803672790527
Epoch: 15, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921617).  Saving model ...
Epoch: 16 cost time: 2.5672006607055664
Epoch: 16, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 17 cost time: 2.5697288513183594
Epoch: 17, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.368 Vali Acc: 0.924 Test Loss: 0.368 Test Acc: 0.924
Validation loss decreased (-0.921618 --> -0.924321).  Saving model ...
Epoch: 18 cost time: 2.5628020763397217
Epoch: 18, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929726).  Saving model ...
Epoch: 19 cost time: 1.8393816947937012
Epoch: 19, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 20 cost time: 2.1250698566436768
Epoch: 20, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.287 Vali Acc: 0.943 Test Loss: 0.287 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 2.0740535259246826
Epoch: 21, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.271 Vali Acc: 0.943 Test Loss: 0.271 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943241).  Saving model ...
Epoch: 22 cost time: 2.5316405296325684
Epoch: 22, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.290238857269287
Epoch: 23, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 24 cost time: 1.8385400772094727
Epoch: 24, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 25 cost time: 2.392120599746704
Epoch: 25, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 26 cost time: 2.2932019233703613
Epoch: 26, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 2.2183408737182617
Epoch: 27, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 28 cost time: 2.290849447250366
Epoch: 28, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8469784259796143
Epoch: 29, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 2.385915517807007
Epoch: 30, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.443984031677246
Epoch: 31, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.353754758834839
Epoch: 32, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.354686975479126
Epoch: 33, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.227627754211426
Epoch: 34, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.263232707977295
Epoch: 35, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.361842632293701
Epoch: 36, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 37 cost time: 2.586820602416992
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 2.2072532176971436
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.318148612976074
Epoch: 39, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 2.0675888061523438
Epoch: 40, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.307243585586548
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.4067461490631104
Epoch: 42, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.178590774536133
Epoch: 43, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.362151622772217
Epoch: 44, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 45 cost time: 1.9283103942871094
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.4384632110595703
Epoch: 46, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.5453522205352783
Epoch: 47, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.1368589401245117
Epoch: 48, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.12333083152771
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.662220001220703
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.4757490158081055
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.1599442958831787
Epoch: 52, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.705021381378174
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.490196943283081
Epoch: 54, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 146985
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.844663381576538
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.056 Vali Acc: 0.300 Test Loss: 2.056 Test Acc: 0.300
Validation loss decreased (inf --> -0.299979).  Saving model ...
Epoch: 2 cost time: 2.2799055576324463
Epoch: 2, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.950 Vali Acc: 0.457 Test Loss: 1.950 Test Acc: 0.457
Validation loss decreased (-0.299979 --> -0.456737).  Saving model ...
Epoch: 3 cost time: 2.274559259414673
Epoch: 3, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.806 Vali Acc: 0.638 Test Loss: 1.806 Test Acc: 0.638
Validation loss decreased (-0.456737 --> -0.637820).  Saving model ...
Epoch: 4 cost time: 1.8581478595733643
Epoch: 4, Steps: 17 | Train Loss: 1.782 Vali Loss: 1.657 Vali Acc: 0.754 Test Loss: 1.657 Test Acc: 0.754
Validation loss decreased (-0.637820 --> -0.754037).  Saving model ...
Epoch: 5 cost time: 1.7905240058898926
Epoch: 5, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.488 Vali Acc: 0.800 Test Loss: 1.488 Test Acc: 0.800
Validation loss decreased (-0.754037 --> -0.799985).  Saving model ...
Epoch: 6 cost time: 1.9514808654785156
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.314 Vali Acc: 0.827 Test Loss: 1.314 Test Acc: 0.827
Validation loss decreased (-0.799985 --> -0.827014).  Saving model ...
Epoch: 7 cost time: 2.0020012855529785
Epoch: 7, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.149 Vali Acc: 0.824 Test Loss: 1.149 Test Acc: 0.824
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8518729209899902
Epoch: 8, Steps: 17 | Train Loss: 1.086 Vali Loss: 0.999 Vali Acc: 0.865 Test Loss: 0.999 Test Acc: 0.865
Validation loss decreased (-0.827014 --> -0.864855).  Saving model ...
Epoch: 9 cost time: 2.1887853145599365
Epoch: 9, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.882 Vali Acc: 0.884 Test Loss: 0.882 Test Acc: 0.884
Validation loss decreased (-0.864855 --> -0.883775).  Saving model ...
Epoch: 10 cost time: 1.9366395473480225
Epoch: 10, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.765 Vali Acc: 0.908 Test Loss: 0.765 Test Acc: 0.908
Validation loss decreased (-0.883775 --> -0.908100).  Saving model ...
Epoch: 11 cost time: 1.7483317852020264
Epoch: 11, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.676 Vali Acc: 0.908 Test Loss: 0.676 Test Acc: 0.908
Validation loss decreased (-0.908100 --> -0.908101).  Saving model ...
Epoch: 12 cost time: 2.0560195446014404
Epoch: 12, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.595 Vali Acc: 0.914 Test Loss: 0.595 Test Acc: 0.914
Validation loss decreased (-0.908101 --> -0.913508).  Saving model ...
Epoch: 13 cost time: 2.3184216022491455
Epoch: 13, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.531 Vali Acc: 0.914 Test Loss: 0.531 Test Acc: 0.914
Validation loss decreased (-0.913508 --> -0.913508).  Saving model ...
Epoch: 14 cost time: 2.1109700202941895
Epoch: 14, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.464 Vali Acc: 0.919 Test Loss: 0.464 Test Acc: 0.919
Validation loss decreased (-0.913508 --> -0.918914).  Saving model ...
Epoch: 15 cost time: 2.1929550170898438
Epoch: 15, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
Validation loss decreased (-0.918914 --> -0.921617).  Saving model ...
Epoch: 16 cost time: 2.155066967010498
Epoch: 16, Steps: 17 | Train Loss: 0.358 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921618).  Saving model ...
Epoch: 17 cost time: 2.262563705444336
Epoch: 17, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.360 Vali Acc: 0.927 Test Loss: 0.360 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 1.8943283557891846
Epoch: 18, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.326 Vali Acc: 0.938 Test Loss: 0.326 Test Acc: 0.938
Validation loss decreased (-0.927023 --> -0.937835).  Saving model ...
Epoch: 19 cost time: 1.9825494289398193
Epoch: 19, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 2.241335868835449
Epoch: 20, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.280 Vali Acc: 0.932 Test Loss: 0.280 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1945879459381104
Epoch: 21, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8926010131835938
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3395769596099854
Epoch: 23, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.228 Vali Acc: 0.949 Test Loss: 0.228 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 24 cost time: 2.1948459148406982
Epoch: 24, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.016533374786377
Epoch: 25, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1407439708709717
Epoch: 26, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0295426845550537
Epoch: 27, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8650100231170654
Epoch: 28, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 1.7695872783660889
Epoch: 29, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.020212411880493
Epoch: 30, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.085033655166626
Epoch: 31, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.143293857574463
Epoch: 32, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 2.2823870182037354
Epoch: 33, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.2297375202178955
Epoch: 34, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.946 Test Loss: 0.159 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.419145107269287
Epoch: 35, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0711958408355713
Epoch: 36, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 37 cost time: 2.322624921798706
Epoch: 37, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 38 cost time: 2.2345197200775146
Epoch: 38, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.954 Test Loss: 0.140 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.0957605838775635
Epoch: 39, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 2.5899484157562256
Epoch: 40, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.4489731788635254
Epoch: 41, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.416778087615967
Epoch: 42, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.949 Test Loss: 0.133 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.249865770339966
Epoch: 43, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.1401288509368896
Epoch: 44, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.517869472503662
Epoch: 45, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9645459651947021
Epoch: 46, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.8295700550079346
Epoch: 47, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.420954942703247
Epoch: 48, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 49 cost time: 2.3496599197387695
Epoch: 49, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.500885009765625
Epoch: 50, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.208932876586914
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.8958203792572021
Epoch: 52, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.8822906017303467
Epoch: 53, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.8142921924591064
Epoch: 54, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.783961534500122
Epoch: 55, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.8493921756744385
Epoch: 56, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 57 cost time: 2.0623250007629395
Epoch: 57, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.954 Test Loss: 0.123 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.0573787689208984
Epoch: 58, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.6552116870880127
Epoch: 59, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.844735860824585
Epoch: 60, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 61 cost time: 1.5956952571868896
Epoch: 61, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.964864 --> -0.975675).  Saving model ...
Epoch: 62 cost time: 1.8391211032867432
Epoch: 62, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 2.1157100200653076
Epoch: 63, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 2.2658722400665283
Epoch: 64, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 2.463942050933838
Epoch: 65, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.811927318572998
Epoch: 66, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 2.4005918502807617
Epoch: 67, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 2.182178020477295
Epoch: 68, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 2.2498769760131836
Epoch: 69, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 2.189136028289795
Epoch: 70, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.7654056549072266
Epoch: 71, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 146985
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.346284627914429
Epoch: 1, Steps: 17 | Train Loss: 2.340 Vali Loss: 2.313 Vali Acc: 0.078 Test Loss: 2.313 Test Acc: 0.078
Validation loss decreased (inf --> -0.078355).  Saving model ...
Epoch: 2 cost time: 2.154499053955078
Epoch: 2, Steps: 17 | Train Loss: 2.246 Vali Loss: 2.191 Vali Acc: 0.119 Test Loss: 2.191 Test Acc: 0.119
Validation loss decreased (-0.078355 --> -0.118897).  Saving model ...
Epoch: 3 cost time: 2.1279067993164062
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 2.031 Vali Acc: 0.278 Test Loss: 2.031 Test Acc: 0.278
Validation loss decreased (-0.118897 --> -0.278358).  Saving model ...
Epoch: 4 cost time: 2.023101329803467
Epoch: 4, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.853 Vali Acc: 0.543 Test Loss: 1.853 Test Acc: 0.543
Validation loss decreased (-0.278358 --> -0.543225).  Saving model ...
Epoch: 5 cost time: 1.9075782299041748
Epoch: 5, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.684 Vali Acc: 0.678 Test Loss: 1.684 Test Acc: 0.678
Validation loss decreased (-0.543225 --> -0.678362).  Saving model ...
Epoch: 6 cost time: 1.6028189659118652
Epoch: 6, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.515 Vali Acc: 0.768 Test Loss: 1.515 Test Acc: 0.768
Validation loss decreased (-0.678362 --> -0.767552).  Saving model ...
Epoch: 7 cost time: 1.8266208171844482
Epoch: 7, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.341 Vali Acc: 0.819 Test Loss: 1.341 Test Acc: 0.819
Validation loss decreased (-0.767552 --> -0.818906).  Saving model ...
Epoch: 8 cost time: 1.7592029571533203
Epoch: 8, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.171 Vali Acc: 0.859 Test Loss: 1.171 Test Acc: 0.859
Validation loss decreased (-0.818906 --> -0.859448).  Saving model ...
Epoch: 9 cost time: 2.1657309532165527
Epoch: 9, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.018 Vali Acc: 0.881 Test Loss: 1.018 Test Acc: 0.881
Validation loss decreased (-0.859448 --> -0.881071).  Saving model ...
Epoch: 10 cost time: 1.9057211875915527
Epoch: 10, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.899 Vali Acc: 0.876 Test Loss: 0.899 Test Acc: 0.876
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0410220623016357
Epoch: 11, Steps: 17 | Train Loss: 0.745 Vali Loss: 0.773 Vali Acc: 0.903 Test Loss: 0.773 Test Acc: 0.903
Validation loss decreased (-0.881071 --> -0.902695).  Saving model ...
Epoch: 12 cost time: 2.126132011413574
Epoch: 12, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.678 Vali Acc: 0.911 Test Loss: 0.678 Test Acc: 0.911
Validation loss decreased (-0.902695 --> -0.910804).  Saving model ...
Epoch: 13 cost time: 2.0336875915527344
Epoch: 13, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.598 Vali Acc: 0.919 Test Loss: 0.598 Test Acc: 0.919
Validation loss decreased (-0.910804 --> -0.918913).  Saving model ...
Epoch: 14 cost time: 2.317394733428955
Epoch: 14, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.541 Vali Acc: 0.924 Test Loss: 0.541 Test Acc: 0.924
Validation loss decreased (-0.918913 --> -0.924319).  Saving model ...
Epoch: 15 cost time: 1.9865443706512451
Epoch: 15, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.495 Vali Acc: 0.922 Test Loss: 0.495 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2691164016723633
Epoch: 16, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.434 Vali Acc: 0.935 Test Loss: 0.434 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935131).  Saving model ...
Epoch: 17 cost time: 1.7464375495910645
Epoch: 17, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 18 cost time: 2.128094434738159
Epoch: 18, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.368 Vali Acc: 0.943 Test Loss: 0.368 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 19 cost time: 1.8534574508666992
Epoch: 19, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.339 Vali Acc: 0.946 Test Loss: 0.339 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 1.9017138481140137
Epoch: 20, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.311 Vali Acc: 0.957 Test Loss: 0.311 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956754).  Saving model ...
Epoch: 21 cost time: 2.0932037830352783
Epoch: 21, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.282 Vali Acc: 0.954 Test Loss: 0.282 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9344120025634766
Epoch: 22, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.267 Vali Acc: 0.954 Test Loss: 0.267 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1352121829986572
Epoch: 23, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.245 Vali Acc: 0.962 Test Loss: 0.245 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 24 cost time: 1.9682364463806152
Epoch: 24, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.233 Vali Acc: 0.957 Test Loss: 0.233 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9285964965820312
Epoch: 25, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1978256702423096
Epoch: 26, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 2.2666783332824707
Epoch: 27, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8903062343597412
Epoch: 28, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.0200369358062744
Epoch: 29, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9775586128234863
Epoch: 30, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8579795360565186
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8810515403747559
Epoch: 32, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 33 cost time: 1.9058818817138672
Epoch: 33, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.8591535091400146
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.013483762741089
Epoch: 35, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6148226261138916
Epoch: 36, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 1.7907295227050781
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.131682872772217
Epoch: 38, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.839108943939209
Epoch: 39, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6763978004455566
Epoch: 40, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.091890811920166
Epoch: 41, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.0303421020507812
Epoch: 42, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8896198272705078
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.9158811569213867
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.1000254154205322
Epoch: 45, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.6825675964355469
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 81449
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.800525188446045
Epoch: 1, Steps: 17 | Train Loss: 2.325 Vali Loss: 2.302 Vali Acc: 0.084 Test Loss: 2.302 Test Acc: 0.084
Validation loss decreased (inf --> -0.083761).  Saving model ...
Epoch: 2 cost time: 2.1268270015716553
Epoch: 2, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.182 Vali Acc: 0.111 Test Loss: 2.182 Test Acc: 0.111
Validation loss decreased (-0.083761 --> -0.110789).  Saving model ...
Epoch: 3 cost time: 1.980480432510376
Epoch: 3, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.023 Vali Acc: 0.295 Test Loss: 2.023 Test Acc: 0.295
Validation loss decreased (-0.110789 --> -0.294574).  Saving model ...
Epoch: 4 cost time: 2.07810378074646
Epoch: 4, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.847 Vali Acc: 0.557 Test Loss: 1.847 Test Acc: 0.557
Validation loss decreased (-0.294574 --> -0.556738).  Saving model ...
Epoch: 5 cost time: 1.7087206840515137
Epoch: 5, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.680 Vali Acc: 0.697 Test Loss: 1.680 Test Acc: 0.697
Validation loss decreased (-0.556738 --> -0.697280).  Saving model ...
Epoch: 6 cost time: 1.5294530391693115
Epoch: 6, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.510 Vali Acc: 0.781 Test Loss: 1.510 Test Acc: 0.781
Validation loss decreased (-0.697280 --> -0.781066).  Saving model ...
Epoch: 7 cost time: 1.7389848232269287
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.338 Vali Acc: 0.816 Test Loss: 1.338 Test Acc: 0.816
Validation loss decreased (-0.781066 --> -0.816203).  Saving model ...
Epoch: 8 cost time: 1.958508014678955
Epoch: 8, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.172 Vali Acc: 0.846 Test Loss: 1.172 Test Acc: 0.846
Validation loss decreased (-0.816203 --> -0.845934).  Saving model ...
Epoch: 9 cost time: 2.308277130126953
Epoch: 9, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.019 Vali Acc: 0.878 Test Loss: 1.019 Test Acc: 0.878
Validation loss decreased (-0.845934 --> -0.878368).  Saving model ...
Epoch: 10 cost time: 2.328282117843628
Epoch: 10, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.899 Vali Acc: 0.881 Test Loss: 0.899 Test Acc: 0.881
Validation loss decreased (-0.878368 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 2.2187583446502686
Epoch: 11, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.770 Vali Acc: 0.897 Test Loss: 0.770 Test Acc: 0.897
Validation loss decreased (-0.881072 --> -0.897290).  Saving model ...
Epoch: 12 cost time: 2.086941719055176
Epoch: 12, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.679 Vali Acc: 0.908 Test Loss: 0.679 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908101).  Saving model ...
Epoch: 13 cost time: 2.096147060394287
Epoch: 13, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.598 Vali Acc: 0.916 Test Loss: 0.598 Test Acc: 0.916
Validation loss decreased (-0.908101 --> -0.916210).  Saving model ...
Epoch: 14 cost time: 2.3842532634735107
Epoch: 14, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.540 Vali Acc: 0.916 Test Loss: 0.540 Test Acc: 0.916
Validation loss decreased (-0.916210 --> -0.916211).  Saving model ...
Epoch: 15 cost time: 2.218555212020874
Epoch: 15, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.497 Vali Acc: 0.916 Test Loss: 0.497 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 2.4764187335968018
Epoch: 16, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.434 Vali Acc: 0.930 Test Loss: 0.434 Test Acc: 0.930
Validation loss decreased (-0.916211 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 1.8804848194122314
Epoch: 17, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.402 Vali Acc: 0.943 Test Loss: 0.402 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943239).  Saving model ...
Epoch: 18 cost time: 2.1840667724609375
Epoch: 18, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.368 Vali Acc: 0.938 Test Loss: 0.368 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.311755895614624
Epoch: 19, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.338 Vali Acc: 0.943 Test Loss: 0.338 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 2.2381081581115723
Epoch: 20, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.306 Vali Acc: 0.954 Test Loss: 0.306 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954051).  Saving model ...
Epoch: 21 cost time: 2.0879151821136475
Epoch: 21, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.275 Vali Acc: 0.962 Test Loss: 0.275 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962159).  Saving model ...
Epoch: 22 cost time: 1.6630828380584717
Epoch: 22, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.263 Vali Acc: 0.954 Test Loss: 0.263 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.42392635345459
Epoch: 23, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.240 Vali Acc: 0.962 Test Loss: 0.240 Test Acc: 0.962
Validation loss decreased (-0.962159 --> -0.962160).  Saving model ...
Epoch: 24 cost time: 1.719372272491455
Epoch: 24, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.262096405029297
Epoch: 25, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.027775764465332
Epoch: 26, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.201 Vali Acc: 0.968 Test Loss: 0.201 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 2.243792772293091
Epoch: 27, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.200 Vali Acc: 0.965 Test Loss: 0.200 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0809664726257324
Epoch: 28, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.7736506462097168
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.184 Vali Acc: 0.965 Test Loss: 0.184 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.146974563598633
Epoch: 30, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 2.2198598384857178
Epoch: 31, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.7907962799072266
Epoch: 32, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.170376777648926
Epoch: 33, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.018735408782959
Epoch: 34, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0295188426971436
Epoch: 35, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.054989814758301
Epoch: 36, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 2.1887741088867188
Epoch: 37, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.915245771408081
Epoch: 38, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.349700689315796
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.1931650638580322
Epoch: 40, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.119844913482666
Epoch: 41, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.3381502628326416
Epoch: 42, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.1932244300842285
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.2762813568115234
Epoch: 44, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.293252468109131
Epoch: 45, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.0192649364471436
Epoch: 46, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 81449
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9454996585845947
Epoch: 1, Steps: 17 | Train Loss: 2.312 Vali Loss: 2.296 Vali Acc: 0.084 Test Loss: 2.296 Test Acc: 0.084
Validation loss decreased (inf --> -0.083761).  Saving model ...
Epoch: 2 cost time: 1.9052846431732178
Epoch: 2, Steps: 17 | Train Loss: 2.231 Vali Loss: 2.174 Vali Acc: 0.119 Test Loss: 2.174 Test Acc: 0.119
Validation loss decreased (-0.083761 --> -0.118897).  Saving model ...
Epoch: 3 cost time: 2.179283857345581
Epoch: 3, Steps: 17 | Train Loss: 2.055 Vali Loss: 2.016 Vali Acc: 0.314 Test Loss: 2.016 Test Acc: 0.314
Validation loss decreased (-0.118897 --> -0.313493).  Saving model ...
Epoch: 4 cost time: 1.905747890472412
Epoch: 4, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.836 Vali Acc: 0.603 Test Loss: 1.836 Test Acc: 0.603
Validation loss decreased (-0.313493 --> -0.602684).  Saving model ...
Epoch: 5 cost time: 2.1964361667633057
Epoch: 5, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.670 Vali Acc: 0.689 Test Loss: 1.670 Test Acc: 0.689
Validation loss decreased (-0.602684 --> -0.689172).  Saving model ...
Epoch: 6 cost time: 2.1592230796813965
Epoch: 6, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.499 Vali Acc: 0.776 Test Loss: 1.499 Test Acc: 0.776
Validation loss decreased (-0.689172 --> -0.775661).  Saving model ...
Epoch: 7 cost time: 2.0251216888427734
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.325 Vali Acc: 0.819 Test Loss: 1.325 Test Acc: 0.819
Validation loss decreased (-0.775661 --> -0.818906).  Saving model ...
Epoch: 8 cost time: 1.8862524032592773
Epoch: 8, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.160 Vali Acc: 0.846 Test Loss: 1.160 Test Acc: 0.846
Validation loss decreased (-0.818906 --> -0.845934).  Saving model ...
Epoch: 9 cost time: 1.998417615890503
Epoch: 9, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.011 Vali Acc: 0.868 Test Loss: 1.011 Test Acc: 0.868
Validation loss decreased (-0.845934 --> -0.867557).  Saving model ...
Epoch: 10 cost time: 2.177241086959839
Epoch: 10, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.893 Vali Acc: 0.878 Test Loss: 0.893 Test Acc: 0.878
Validation loss decreased (-0.867557 --> -0.878369).  Saving model ...
Epoch: 11 cost time: 1.7530772686004639
Epoch: 11, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.766 Vali Acc: 0.897 Test Loss: 0.766 Test Acc: 0.897
Validation loss decreased (-0.878369 --> -0.897290).  Saving model ...
Epoch: 12 cost time: 1.8953611850738525
Epoch: 12, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.673 Vali Acc: 0.897 Test Loss: 0.673 Test Acc: 0.897
Validation loss decreased (-0.897290 --> -0.897291).  Saving model ...
Epoch: 13 cost time: 2.2249438762664795
Epoch: 13, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.595 Vali Acc: 0.908 Test Loss: 0.595 Test Acc: 0.908
Validation loss decreased (-0.897291 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 1.6357429027557373
Epoch: 14, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.538 Vali Acc: 0.908 Test Loss: 0.538 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908103).  Saving model ...
Epoch: 15 cost time: 1.9373283386230469
Epoch: 15, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.498 Vali Acc: 0.905 Test Loss: 0.498 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6794426441192627
Epoch: 16, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.434 Vali Acc: 0.916 Test Loss: 0.434 Test Acc: 0.916
Validation loss decreased (-0.908103 --> -0.916212).  Saving model ...
Epoch: 17 cost time: 1.6803185939788818
Epoch: 17, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.402 Vali Acc: 0.927 Test Loss: 0.402 Test Acc: 0.927
Validation loss decreased (-0.916212 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 1.7322824001312256
Epoch: 18, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.367 Vali Acc: 0.935 Test Loss: 0.367 Test Acc: 0.935
Validation loss decreased (-0.927023 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 2.5109915733337402
Epoch: 19, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.340 Vali Acc: 0.938 Test Loss: 0.340 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 20 cost time: 1.9834349155426025
Epoch: 20, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.313 Vali Acc: 0.951 Test Loss: 0.313 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951348).  Saving model ...
Epoch: 21 cost time: 2.0016422271728516
Epoch: 21, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.282 Vali Acc: 0.946 Test Loss: 0.282 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.1621603965759277
Epoch: 22, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.266 Vali Acc: 0.951 Test Loss: 0.266 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 23 cost time: 2.003697633743286
Epoch: 23, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956754).  Saving model ...
Epoch: 24 cost time: 2.0023460388183594
Epoch: 24, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.234 Vali Acc: 0.954 Test Loss: 0.234 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9907071590423584
Epoch: 25, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.234 Vali Acc: 0.949 Test Loss: 0.234 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.126427173614502
Epoch: 26, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 27 cost time: 2.044153928756714
Epoch: 27, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.1489431858062744
Epoch: 28, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 29 cost time: 2.2441465854644775
Epoch: 29, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 1.8710334300994873
Epoch: 30, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.907132863998413
Epoch: 31, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 2.254915237426758
Epoch: 32, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1690070629119873
Epoch: 33, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.94419527053833
Epoch: 34, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.3518943786621094
Epoch: 35, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2591757774353027
Epoch: 36, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.1356000900268555
Epoch: 37, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.244220733642578
Epoch: 38, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.0982234477996826
Epoch: 39, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.114466905593872
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.361477851867676
Epoch: 41, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 81449
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.640751600265503
Epoch: 1, Steps: 17 | Train Loss: 2.291 Vali Loss: 2.265 Vali Acc: 0.070 Test Loss: 2.265 Test Acc: 0.070
Validation loss decreased (inf --> -0.070248).  Saving model ...
Epoch: 2 cost time: 2.0115623474121094
Epoch: 2, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.149 Vali Acc: 0.146 Test Loss: 2.149 Test Acc: 0.146
Validation loss decreased (-0.070248 --> -0.145924).  Saving model ...
Epoch: 3 cost time: 2.285263776779175
Epoch: 3, Steps: 17 | Train Loss: 2.038 Vali Loss: 1.998 Vali Acc: 0.357 Test Loss: 1.998 Test Acc: 0.357
Validation loss decreased (-0.145924 --> -0.356737).  Saving model ...
Epoch: 4 cost time: 1.82861328125
Epoch: 4, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.823 Vali Acc: 0.624 Test Loss: 1.823 Test Acc: 0.624
Validation loss decreased (-0.356737 --> -0.624306).  Saving model ...
Epoch: 5 cost time: 2.087388515472412
Epoch: 5, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.653 Vali Acc: 0.735 Test Loss: 1.653 Test Acc: 0.735
Validation loss decreased (-0.624306 --> -0.735119).  Saving model ...
Epoch: 6 cost time: 2.076948642730713
Epoch: 6, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.479 Vali Acc: 0.797 Test Loss: 1.479 Test Acc: 0.797
Validation loss decreased (-0.735119 --> -0.797283).  Saving model ...
Epoch: 7 cost time: 1.8038794994354248
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.301 Vali Acc: 0.841 Test Loss: 1.301 Test Acc: 0.841
Validation loss decreased (-0.797283 --> -0.840528).  Saving model ...
Epoch: 8 cost time: 1.6556549072265625
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.133 Vali Acc: 0.868 Test Loss: 1.133 Test Acc: 0.868
Validation loss decreased (-0.840528 --> -0.867556).  Saving model ...
Epoch: 9 cost time: 1.9876580238342285
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 0.986 Vali Acc: 0.868 Test Loss: 0.986 Test Acc: 0.868
Validation loss decreased (-0.867556 --> -0.867558).  Saving model ...
Epoch: 10 cost time: 2.128549337387085
Epoch: 10, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.875 Vali Acc: 0.865 Test Loss: 0.875 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9089467525482178
Epoch: 11, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.753 Vali Acc: 0.889 Test Loss: 0.753 Test Acc: 0.889
Validation loss decreased (-0.867558 --> -0.889182).  Saving model ...
Epoch: 12 cost time: 2.3032965660095215
Epoch: 12, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.663 Vali Acc: 0.895 Test Loss: 0.663 Test Acc: 0.895
Validation loss decreased (-0.889182 --> -0.894588).  Saving model ...
Epoch: 13 cost time: 2.1307365894317627
Epoch: 13, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.894588 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.9396131038665771
Epoch: 14, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.535 Vali Acc: 0.903 Test Loss: 0.535 Test Acc: 0.903
Validation loss decreased (-0.899994 --> -0.902697).  Saving model ...
Epoch: 15 cost time: 1.9340698719024658
Epoch: 15, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3159537315368652
Epoch: 16, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.435 Vali Acc: 0.914 Test Loss: 0.435 Test Acc: 0.914
Validation loss decreased (-0.902697 --> -0.913509).  Saving model ...
Epoch: 17 cost time: 2.2499046325683594
Epoch: 17, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.404 Vali Acc: 0.916 Test Loss: 0.404 Test Acc: 0.916
Validation loss decreased (-0.913509 --> -0.916212).  Saving model ...
Epoch: 18 cost time: 1.960848093032837
Epoch: 18, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.370 Vali Acc: 0.927 Test Loss: 0.370 Test Acc: 0.927
Validation loss decreased (-0.916212 --> -0.927023).  Saving model ...
Epoch: 19 cost time: 2.174511194229126
Epoch: 19, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.344 Vali Acc: 0.932 Test Loss: 0.344 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 20 cost time: 2.013888120651245
Epoch: 20, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.314 Vali Acc: 0.932 Test Loss: 0.314 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932429).  Saving model ...
Epoch: 21 cost time: 1.860734224319458
Epoch: 21, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940538).  Saving model ...
Epoch: 22 cost time: 2.080291986465454
Epoch: 22, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.274 Vali Acc: 0.938 Test Loss: 0.274 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4471302032470703
Epoch: 23, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 24 cost time: 2.4365391731262207
Epoch: 24, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1766397953033447
Epoch: 25, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3059728145599365
Epoch: 26, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.213 Vali Acc: 0.954 Test Loss: 0.213 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 2.0035743713378906
Epoch: 27, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 2.0360734462738037
Epoch: 28, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5374717712402344
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5411572456359863
Epoch: 30, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 1.6150784492492676
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 2.0039000511169434
Epoch: 32, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.932849645614624
Epoch: 33, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.188842535018921
Epoch: 34, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 2.3006696701049805
Epoch: 35, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9361822605133057
Epoch: 36, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 37 cost time: 1.995652198791504
Epoch: 37, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 38 cost time: 1.8659827709197998
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8895468711853027
Epoch: 39, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 1.9654359817504883
Epoch: 40, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.1819074153900146
Epoch: 41, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.954 Test Loss: 0.125 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.093334197998047
Epoch: 42, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 43 cost time: 2.2400588989257812
Epoch: 43, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.9173827171325684
Epoch: 44, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.011126756668091
Epoch: 45, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.946 Test Loss: 0.133 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.8249320983886719
Epoch: 46, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.2282402515411377
Epoch: 47, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.0989584922790527
Epoch: 48, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.016901731491089
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.957 Test Loss: 0.117 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.1885533332824707
Epoch: 50, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.951 Test Loss: 0.119 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.9062047004699707
Epoch: 51, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.9356403350830078
Epoch: 52, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 81449
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.240113258361816
Epoch: 1, Steps: 17 | Train Loss: 2.319 Vali Loss: 2.287 Vali Acc: 0.086 Test Loss: 2.287 Test Acc: 0.086
Validation loss decreased (inf --> -0.086464).  Saving model ...
Epoch: 2 cost time: 1.8290519714355469
Epoch: 2, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.157 Vali Acc: 0.159 Test Loss: 2.157 Test Acc: 0.159
Validation loss decreased (-0.086464 --> -0.159438).  Saving model ...
Epoch: 3 cost time: 2.1076533794403076
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 2.005 Vali Acc: 0.311 Test Loss: 2.005 Test Acc: 0.311
Validation loss decreased (-0.159438 --> -0.310791).  Saving model ...
Epoch: 4 cost time: 2.1334404945373535
Epoch: 4, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.825 Vali Acc: 0.549 Test Loss: 1.825 Test Acc: 0.549
Validation loss decreased (-0.310791 --> -0.548630).  Saving model ...
Epoch: 5 cost time: 2.319462776184082
Epoch: 5, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.647 Vali Acc: 0.686 Test Loss: 1.647 Test Acc: 0.686
Validation loss decreased (-0.548630 --> -0.686470).  Saving model ...
Epoch: 6 cost time: 2.1356945037841797
Epoch: 6, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.471 Vali Acc: 0.765 Test Loss: 1.471 Test Acc: 0.765
Validation loss decreased (-0.686470 --> -0.764850).  Saving model ...
Epoch: 7 cost time: 2.2905359268188477
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.303 Vali Acc: 0.797 Test Loss: 1.303 Test Acc: 0.797
Validation loss decreased (-0.764850 --> -0.797284).  Saving model ...
Epoch: 8 cost time: 2.144031047821045
Epoch: 8, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.144 Vali Acc: 0.857 Test Loss: 1.144 Test Acc: 0.857
Validation loss decreased (-0.797284 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 1.6085758209228516
Epoch: 9, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.000 Vali Acc: 0.870 Test Loss: 1.000 Test Acc: 0.870
Validation loss decreased (-0.856745 --> -0.870260).  Saving model ...
Epoch: 10 cost time: 2.081798553466797
Epoch: 10, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.874 Vali Acc: 0.881 Test Loss: 0.874 Test Acc: 0.881
Validation loss decreased (-0.870260 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 2.1446664333343506
Epoch: 11, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.765 Vali Acc: 0.908 Test Loss: 0.765 Test Acc: 0.908
Validation loss decreased (-0.881072 --> -0.908100).  Saving model ...
Epoch: 12 cost time: 2.181764841079712
Epoch: 12, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.678 Vali Acc: 0.905 Test Loss: 0.678 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.115837574005127
Epoch: 13, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.606 Vali Acc: 0.911 Test Loss: 0.606 Test Acc: 0.911
Validation loss decreased (-0.908100 --> -0.910805).  Saving model ...
Epoch: 14 cost time: 2.1576154232025146
Epoch: 14, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.539 Vali Acc: 0.922 Test Loss: 0.539 Test Acc: 0.922
Validation loss decreased (-0.910805 --> -0.921616).  Saving model ...
Epoch: 15 cost time: 1.6712703704833984
Epoch: 15, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.486 Vali Acc: 0.927 Test Loss: 0.486 Test Acc: 0.927
Validation loss decreased (-0.921616 --> -0.927022).  Saving model ...
Epoch: 16 cost time: 1.8917927742004395
Epoch: 16, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 2.2070374488830566
Epoch: 17, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.399 Vali Acc: 0.935 Test Loss: 0.399 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 2.3137989044189453
Epoch: 18, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.362 Vali Acc: 0.935 Test Loss: 0.362 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 2.4497454166412354
Epoch: 19, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.337 Vali Acc: 0.938 Test Loss: 0.337 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937834).  Saving model ...
Epoch: 20 cost time: 2.3798415660858154
Epoch: 20, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 21 cost time: 2.2594518661499023
Epoch: 21, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.285 Vali Acc: 0.943 Test Loss: 0.285 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 22 cost time: 1.9745957851409912
Epoch: 22, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.272 Vali Acc: 0.946 Test Loss: 0.272 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 23 cost time: 2.368375301361084
Epoch: 23, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 24 cost time: 1.7984898090362549
Epoch: 24, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.238 Vali Acc: 0.949 Test Loss: 0.238 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3469762802124023
Epoch: 25, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.7694628238677979
Epoch: 26, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 2.0669596195220947
Epoch: 27, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0706398487091064
Epoch: 28, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 29 cost time: 2.1716043949127197
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.185 Vali Acc: 0.968 Test Loss: 0.185 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.9877519607543945
Epoch: 30, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0113413333892822
Epoch: 31, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.968 Test Loss: 0.172 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 32 cost time: 2.068824052810669
Epoch: 32, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 2.2186992168426514
Epoch: 33, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.837728500366211
Epoch: 34, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 2.2635178565979004
Epoch: 35, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9264400005340576
Epoch: 36, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 2.182206153869629
Epoch: 37, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.8105087280273438
Epoch: 38, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 2.1141700744628906
Epoch: 39, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 40 cost time: 2.0111005306243896
Epoch: 40, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.07964825630188
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0891637802124023
Epoch: 42, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.240447998046875
Epoch: 43, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8502624034881592
Epoch: 44, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.8514673709869385
Epoch: 45, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.8724753856658936
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.9965369701385498
Epoch: 47, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.808915376663208
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.1572039127349854
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 48681
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.976768732070923
Epoch: 1, Steps: 17 | Train Loss: 2.305 Vali Loss: 2.291 Vali Acc: 0.073 Test Loss: 2.291 Test Acc: 0.073
Validation loss decreased (inf --> -0.072950).  Saving model ...
Epoch: 2 cost time: 2.230937957763672
Epoch: 2, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.162 Vali Acc: 0.157 Test Loss: 2.162 Test Acc: 0.157
Validation loss decreased (-0.072950 --> -0.156735).  Saving model ...
Epoch: 3 cost time: 1.9479622840881348
Epoch: 3, Steps: 17 | Train Loss: 2.076 Vali Loss: 2.009 Vali Acc: 0.330 Test Loss: 2.009 Test Acc: 0.330
Validation loss decreased (-0.156735 --> -0.329710).  Saving model ...
Epoch: 4 cost time: 1.897303819656372
Epoch: 4, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.829 Vali Acc: 0.535 Test Loss: 1.829 Test Acc: 0.535
Validation loss decreased (-0.329710 --> -0.535117).  Saving model ...
Epoch: 5 cost time: 1.8416476249694824
Epoch: 5, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.652 Vali Acc: 0.662 Test Loss: 1.652 Test Acc: 0.662
Validation loss decreased (-0.535117 --> -0.662146).  Saving model ...
Epoch: 6 cost time: 1.8510849475860596
Epoch: 6, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.476 Vali Acc: 0.754 Test Loss: 1.476 Test Acc: 0.754
Validation loss decreased (-0.662146 --> -0.754039).  Saving model ...
Epoch: 7 cost time: 1.853982925415039
Epoch: 7, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.309 Vali Acc: 0.792 Test Loss: 1.309 Test Acc: 0.792
Validation loss decreased (-0.754039 --> -0.791879).  Saving model ...
Epoch: 8 cost time: 2.1002249717712402
Epoch: 8, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.150 Vali Acc: 0.843 Test Loss: 1.150 Test Acc: 0.843
Validation loss decreased (-0.791879 --> -0.843232).  Saving model ...
Epoch: 9 cost time: 1.703676700592041
Epoch: 9, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.007 Vali Acc: 0.862 Test Loss: 1.007 Test Acc: 0.862
Validation loss decreased (-0.843232 --> -0.862152).  Saving model ...
Epoch: 10 cost time: 1.9663805961608887
Epoch: 10, Steps: 17 | Train Loss: 0.889 Vali Loss: 0.882 Vali Acc: 0.876 Test Loss: 0.882 Test Acc: 0.876
Validation loss decreased (-0.862152 --> -0.875667).  Saving model ...
Epoch: 11 cost time: 1.8527519702911377
Epoch: 11, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.771 Vali Acc: 0.892 Test Loss: 0.771 Test Acc: 0.892
Validation loss decreased (-0.875667 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 2.2013778686523438
Epoch: 12, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.685 Vali Acc: 0.905 Test Loss: 0.685 Test Acc: 0.905
Validation loss decreased (-0.891884 --> -0.905399).  Saving model ...
Epoch: 13 cost time: 1.9770698547363281
Epoch: 13, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.612 Vali Acc: 0.908 Test Loss: 0.612 Test Acc: 0.908
Validation loss decreased (-0.905399 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 2.3139004707336426
Epoch: 14, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.543 Vali Acc: 0.919 Test Loss: 0.543 Test Acc: 0.919
Validation loss decreased (-0.908102 --> -0.918913).  Saving model ...
Epoch: 15 cost time: 2.1456212997436523
Epoch: 15, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.488 Vali Acc: 0.927 Test Loss: 0.488 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 16 cost time: 2.159140110015869
Epoch: 16, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.441 Vali Acc: 0.930 Test Loss: 0.441 Test Acc: 0.930
Validation loss decreased (-0.927022 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 2.1299495697021484
Epoch: 17, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.402 Vali Acc: 0.932 Test Loss: 0.402 Test Acc: 0.932
Validation loss decreased (-0.929725 --> -0.932428).  Saving model ...
Epoch: 18 cost time: 1.819258213043213
Epoch: 18, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.932428 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 1.7893602848052979
Epoch: 19, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.338 Vali Acc: 0.938 Test Loss: 0.338 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7462842464447021
Epoch: 20, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.316 Vali Acc: 0.938 Test Loss: 0.316 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8327722549438477
Epoch: 21, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.289 Vali Acc: 0.946 Test Loss: 0.289 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 1.7351162433624268
Epoch: 22, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.273 Vali Acc: 0.951 Test Loss: 0.273 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 23 cost time: 1.8401005268096924
Epoch: 23, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954051).  Saving model ...
Epoch: 24 cost time: 1.5682196617126465
Epoch: 24, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.877558708190918
Epoch: 25, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6282188892364502
Epoch: 26, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8890788555145264
Epoch: 27, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9711871147155762
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.197 Vali Acc: 0.954 Test Loss: 0.197 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 1.8114466667175293
Epoch: 29, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 30 cost time: 1.8001675605773926
Epoch: 30, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.185 Vali Acc: 0.951 Test Loss: 0.185 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7095768451690674
Epoch: 31, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 32 cost time: 1.8269894123077393
Epoch: 32, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7205288410186768
Epoch: 33, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 34 cost time: 1.7367503643035889
Epoch: 34, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 1.8809666633605957
Epoch: 35, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8469712734222412
Epoch: 36, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 2.076394557952881
Epoch: 37, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.7672905921936035
Epoch: 38, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.8566193580627441
Epoch: 39, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.722313642501831
Epoch: 40, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9585790634155273
Epoch: 41, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8548033237457275
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.0012500286102295
Epoch: 43, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7974135875701904
Epoch: 44, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.8736567497253418
Epoch: 45, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.6012985706329346
Epoch: 46, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.5702002048492432
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 1.7821285724639893
Epoch: 48, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 1.8851847648620605
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 50 cost time: 2.1872215270996094
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 2.2957754135131836
Epoch: 51, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.04508638381958
Epoch: 52, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 53 cost time: 2.297126054763794
Epoch: 53, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 2.1039187908172607
Epoch: 54, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 2.0670547485351562
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.9082419872283936
Epoch: 56, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.1925876140594482
Epoch: 57, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 2.073793888092041
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 2.1058850288391113
Epoch: 59, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 2.1764917373657227
Epoch: 60, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 2.0259976387023926
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.193293571472168
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.0657763481140137
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 48681
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.3904969692230225
Epoch: 1, Steps: 17 | Train Loss: 2.320 Vali Loss: 2.281 Vali Acc: 0.073 Test Loss: 2.281 Test Acc: 0.073
Validation loss decreased (inf --> -0.072950).  Saving model ...
Epoch: 2 cost time: 2.0674901008605957
Epoch: 2, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.152 Vali Acc: 0.165 Test Loss: 2.152 Test Acc: 0.165
Validation loss decreased (-0.072950 --> -0.164843).  Saving model ...
Epoch: 3 cost time: 1.9466636180877686
Epoch: 3, Steps: 17 | Train Loss: 2.075 Vali Loss: 1.997 Vali Acc: 0.346 Test Loss: 1.997 Test Acc: 0.346
Validation loss decreased (-0.164843 --> -0.345926).  Saving model ...
Epoch: 4 cost time: 2.1419973373413086
Epoch: 4, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.818 Vali Acc: 0.532 Test Loss: 1.818 Test Acc: 0.532
Validation loss decreased (-0.345926 --> -0.532414).  Saving model ...
Epoch: 5 cost time: 1.8058712482452393
Epoch: 5, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.638 Vali Acc: 0.665 Test Loss: 1.638 Test Acc: 0.665
Validation loss decreased (-0.532414 --> -0.664848).  Saving model ...
Epoch: 6 cost time: 2.1512129306793213
Epoch: 6, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.464 Vali Acc: 0.754 Test Loss: 1.464 Test Acc: 0.754
Validation loss decreased (-0.664848 --> -0.754039).  Saving model ...
Epoch: 7 cost time: 1.9302699565887451
Epoch: 7, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.297 Vali Acc: 0.789 Test Loss: 1.297 Test Acc: 0.789
Validation loss decreased (-0.754039 --> -0.789176).  Saving model ...
Epoch: 8 cost time: 1.9359104633331299
Epoch: 8, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.143 Vali Acc: 0.832 Test Loss: 1.143 Test Acc: 0.832
Validation loss decreased (-0.789176 --> -0.832421).  Saving model ...
Epoch: 9 cost time: 2.0089313983917236
Epoch: 9, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.003 Vali Acc: 0.857 Test Loss: 1.003 Test Acc: 0.857
Validation loss decreased (-0.832421 --> -0.856747).  Saving model ...
Epoch: 10 cost time: 1.893012285232544
Epoch: 10, Steps: 17 | Train Loss: 0.902 Vali Loss: 0.878 Vali Acc: 0.878 Test Loss: 0.878 Test Acc: 0.878
Validation loss decreased (-0.856747 --> -0.878370).  Saving model ...
Epoch: 11 cost time: 2.066150188446045
Epoch: 11, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.770 Vali Acc: 0.886 Test Loss: 0.770 Test Acc: 0.886
Validation loss decreased (-0.878370 --> -0.886479).  Saving model ...
Epoch: 12 cost time: 2.124553680419922
Epoch: 12, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
Validation loss decreased (-0.886479 --> -0.889182).  Saving model ...
Epoch: 13 cost time: 1.9460861682891846
Epoch: 13, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.615 Vali Acc: 0.897 Test Loss: 0.615 Test Acc: 0.897
Validation loss decreased (-0.889182 --> -0.897291).  Saving model ...
Epoch: 14 cost time: 2.014822006225586
Epoch: 14, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.546 Vali Acc: 0.911 Test Loss: 0.546 Test Acc: 0.911
Validation loss decreased (-0.897291 --> -0.910805).  Saving model ...
Epoch: 15 cost time: 2.123089075088501
Epoch: 15, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.490 Vali Acc: 0.916 Test Loss: 0.490 Test Acc: 0.916
Validation loss decreased (-0.910805 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 2.052060127258301
Epoch: 16, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.443 Vali Acc: 0.924 Test Loss: 0.443 Test Acc: 0.924
Validation loss decreased (-0.916211 --> -0.924320).  Saving model ...
Epoch: 17 cost time: 2.0358190536499023
Epoch: 17, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.407 Vali Acc: 0.924 Test Loss: 0.407 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 1.995856523513794
Epoch: 18, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.370 Vali Acc: 0.932 Test Loss: 0.370 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932429).  Saving model ...
Epoch: 19 cost time: 2.183622360229492
Epoch: 19, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.344 Vali Acc: 0.935 Test Loss: 0.344 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 20 cost time: 2.0641376972198486
Epoch: 20, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.322 Vali Acc: 0.932 Test Loss: 0.322 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.014617919921875
Epoch: 21, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.290 Vali Acc: 0.932 Test Loss: 0.290 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2138988971710205
Epoch: 22, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.276 Vali Acc: 0.938 Test Loss: 0.276 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 2.077543258666992
Epoch: 23, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.268 Vali Acc: 0.935 Test Loss: 0.268 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.956669807434082
Epoch: 24, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.248 Vali Acc: 0.946 Test Loss: 0.248 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945943).  Saving model ...
Epoch: 25 cost time: 1.8283648490905762
Epoch: 25, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0561938285827637
Epoch: 26, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 27 cost time: 1.8685965538024902
Epoch: 27, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.175065040588379
Epoch: 28, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.199 Vali Acc: 0.957 Test Loss: 0.199 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 2.016575813293457
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 1.9312026500701904
Epoch: 30, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9311132431030273
Epoch: 31, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 32 cost time: 2.199589490890503
Epoch: 32, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0272529125213623
Epoch: 33, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9002561569213867
Epoch: 34, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.9544572830200195
Epoch: 35, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7256460189819336
Epoch: 36, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.928318738937378
Epoch: 37, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.117401361465454
Epoch: 38, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.9549095630645752
Epoch: 39, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975674).  Saving model ...
Epoch: 40 cost time: 1.7716658115386963
Epoch: 40, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9332685470581055
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.9976637363433838
Epoch: 42, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.214019775390625
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7385950088500977
Epoch: 44, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.144075870513916
Epoch: 45, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.886413335800171
Epoch: 46, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.8042378425598145
Epoch: 47, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.838871717453003
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.0411760807037354
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 48681
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.26732873916626
Epoch: 1, Steps: 17 | Train Loss: 2.294 Vali Loss: 2.239 Vali Acc: 0.095 Test Loss: 2.239 Test Acc: 0.095
Validation loss decreased (inf --> -0.094572).  Saving model ...
Epoch: 2 cost time: 1.831857681274414
Epoch: 2, Steps: 17 | Train Loss: 2.197 Vali Loss: 2.117 Vali Acc: 0.224 Test Loss: 2.117 Test Acc: 0.224
Validation loss decreased (-0.094572 --> -0.224303).  Saving model ...
Epoch: 3 cost time: 1.7884972095489502
Epoch: 3, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.973 Vali Acc: 0.381 Test Loss: 1.973 Test Acc: 0.381
Validation loss decreased (-0.224303 --> -0.381061).  Saving model ...
Epoch: 4 cost time: 1.7926666736602783
Epoch: 4, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.802 Vali Acc: 0.611 Test Loss: 1.802 Test Acc: 0.611
Validation loss decreased (-0.381061 --> -0.610793).  Saving model ...
Epoch: 5 cost time: 2.0275959968566895
Epoch: 5, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.631 Vali Acc: 0.730 Test Loss: 1.631 Test Acc: 0.730
Validation loss decreased (-0.610793 --> -0.729713).  Saving model ...
Epoch: 6 cost time: 1.9628040790557861
Epoch: 6, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.459 Vali Acc: 0.814 Test Loss: 1.459 Test Acc: 0.814
Validation loss decreased (-0.729713 --> -0.813499).  Saving model ...
Epoch: 7 cost time: 1.6863245964050293
Epoch: 7, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.297 Vali Acc: 0.827 Test Loss: 1.297 Test Acc: 0.827
Validation loss decreased (-0.813499 --> -0.827014).  Saving model ...
Epoch: 8 cost time: 1.9892189502716064
Epoch: 8, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.141 Vali Acc: 0.859 Test Loss: 1.141 Test Acc: 0.859
Validation loss decreased (-0.827014 --> -0.859448).  Saving model ...
Epoch: 9 cost time: 2.1252803802490234
Epoch: 9, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.002 Vali Acc: 0.876 Test Loss: 1.002 Test Acc: 0.876
Validation loss decreased (-0.859448 --> -0.875666).  Saving model ...
Epoch: 10 cost time: 2.1020562648773193
Epoch: 10, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.879 Vali Acc: 0.873 Test Loss: 0.879 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7737984657287598
Epoch: 11, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.773 Vali Acc: 0.884 Test Loss: 0.773 Test Acc: 0.884
Validation loss decreased (-0.875666 --> -0.883776).  Saving model ...
Epoch: 12 cost time: 2.04252028465271
Epoch: 12, Steps: 17 | Train Loss: 0.694 Vali Loss: 0.685 Vali Acc: 0.884 Test Loss: 0.685 Test Acc: 0.884
Validation loss decreased (-0.883776 --> -0.883777).  Saving model ...
Epoch: 13 cost time: 2.079019546508789
Epoch: 13, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.615 Vali Acc: 0.886 Test Loss: 0.615 Test Acc: 0.886
Validation loss decreased (-0.883777 --> -0.886480).  Saving model ...
Epoch: 14 cost time: 1.85249924659729
Epoch: 14, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.886480 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.7922122478485107
Epoch: 15, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.490 Vali Acc: 0.916 Test Loss: 0.490 Test Acc: 0.916
Validation loss decreased (-0.899995 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 1.7974910736083984
Epoch: 16, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.445 Vali Acc: 0.922 Test Loss: 0.445 Test Acc: 0.922
Validation loss decreased (-0.916211 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 1.897263765335083
Epoch: 17, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.411 Vali Acc: 0.930 Test Loss: 0.411 Test Acc: 0.930
Validation loss decreased (-0.921617 --> -0.929726).  Saving model ...
Epoch: 18 cost time: 1.6615655422210693
Epoch: 18, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.370 Vali Acc: 0.935 Test Loss: 0.370 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 2.1705963611602783
Epoch: 19, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 1.9603183269500732
Epoch: 20, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.325 Vali Acc: 0.932 Test Loss: 0.325 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7321796417236328
Epoch: 21, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.701026201248169
Epoch: 22, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.286 Vali Acc: 0.935 Test Loss: 0.286 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0850136280059814
Epoch: 23, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0522608757019043
Epoch: 24, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.250 Vali Acc: 0.938 Test Loss: 0.250 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.847642183303833
Epoch: 25, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.243 Vali Acc: 0.938 Test Loss: 0.243 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0815188884735107
Epoch: 26, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 1.8634560108184814
Epoch: 27, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6496174335479736
Epoch: 28, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8776941299438477
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9615864753723145
Epoch: 30, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 1.7838540077209473
Epoch: 31, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 32 cost time: 1.5759210586547852
Epoch: 32, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7483296394348145
Epoch: 33, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.175971269607544
Epoch: 34, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 2.1263844966888428
Epoch: 35, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9526095390319824
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.0443127155303955
Epoch: 37, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0257387161254883
Epoch: 38, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.166821241378784
Epoch: 39, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 2.1847517490386963
Epoch: 40, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0621769428253174
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.315309762954712
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.3312747478485107
Epoch: 43, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.8618874549865723
Epoch: 44, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.192775011062622
Epoch: 45, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 1.8983941078186035
Epoch: 46, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 2.2049171924591064
Epoch: 47, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 2.0065877437591553
Epoch: 48, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.152651071548462
Epoch: 49, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 2.0934174060821533
Epoch: 50, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 2.146599054336548
Epoch: 51, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 52 cost time: 1.988520860671997
Epoch: 52, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 53 cost time: 2.1669583320617676
Epoch: 53, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.9694304466247559
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.8521082401275635
Epoch: 55, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.0454728603363037
Epoch: 56, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.8628900051116943
Epoch: 57, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.0802409648895264
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.1339468955993652
Epoch: 59, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 60 cost time: 2.2259058952331543
Epoch: 60, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 2.1602962017059326
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.9939134120941162
Epoch: 62, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.996049165725708
Epoch: 63, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 2.1857852935791016
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.8070087432861328
Epoch: 65, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 2.021451711654663
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.8893845081329346
Epoch: 67, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 2.032020330429077
Epoch: 68, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.728118658065796
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 48681
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1447813510894775
Epoch: 1, Steps: 17 | Train Loss: 2.347 Vali Loss: 2.267 Vali Acc: 0.073 Test Loss: 2.267 Test Acc: 0.073
Validation loss decreased (inf --> -0.072950).  Saving model ...
Epoch: 2 cost time: 2.0215022563934326
Epoch: 2, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.143 Vali Acc: 0.103 Test Loss: 2.143 Test Acc: 0.103
Validation loss decreased (-0.072950 --> -0.102681).  Saving model ...
Epoch: 3 cost time: 1.8448882102966309
Epoch: 3, Steps: 17 | Train Loss: 2.096 Vali Loss: 1.992 Vali Acc: 0.303 Test Loss: 1.992 Test Acc: 0.303
Validation loss decreased (-0.102681 --> -0.302683).  Saving model ...
Epoch: 4 cost time: 2.082618236541748
Epoch: 4, Steps: 17 | Train Loss: 1.926 Vali Loss: 1.826 Vali Acc: 0.503 Test Loss: 1.826 Test Acc: 0.503
Validation loss decreased (-0.302683 --> -0.502684).  Saving model ...
Epoch: 5 cost time: 1.7156198024749756
Epoch: 5, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.663 Vali Acc: 0.662 Test Loss: 1.663 Test Acc: 0.662
Validation loss decreased (-0.502684 --> -0.662146).  Saving model ...
Epoch: 6 cost time: 1.8752038478851318
Epoch: 6, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.500 Vali Acc: 0.743 Test Loss: 1.500 Test Acc: 0.743
Validation loss decreased (-0.662146 --> -0.743228).  Saving model ...
Epoch: 7 cost time: 1.8573112487792969
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.335 Vali Acc: 0.778 Test Loss: 1.335 Test Acc: 0.778
Validation loss decreased (-0.743228 --> -0.778365).  Saving model ...
Epoch: 8 cost time: 1.9074676036834717
Epoch: 8, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.160 Vali Acc: 0.835 Test Loss: 1.160 Test Acc: 0.835
Validation loss decreased (-0.778365 --> -0.835124).  Saving model ...
Epoch: 9 cost time: 1.6083860397338867
Epoch: 9, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.007 Vali Acc: 0.857 Test Loss: 1.007 Test Acc: 0.857
Validation loss decreased (-0.835124 --> -0.856747).  Saving model ...
Epoch: 10 cost time: 2.1299853324890137
Epoch: 10, Steps: 17 | Train Loss: 0.900 Vali Loss: 0.872 Vali Acc: 0.876 Test Loss: 0.872 Test Acc: 0.876
Validation loss decreased (-0.856747 --> -0.875667).  Saving model ...
Epoch: 11 cost time: 2.085531234741211
Epoch: 11, Steps: 17 | Train Loss: 0.750 Vali Loss: 0.759 Vali Acc: 0.892 Test Loss: 0.759 Test Acc: 0.892
Validation loss decreased (-0.875667 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 1.72127103805542
Epoch: 12, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.661 Vali Acc: 0.900 Test Loss: 0.661 Test Acc: 0.900
Validation loss decreased (-0.891884 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.436037302017212
Epoch: 13, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.590 Vali Acc: 0.889 Test Loss: 0.590 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3483071327209473
Epoch: 14, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.910806).  Saving model ...
Epoch: 15 cost time: 1.2113425731658936
Epoch: 15, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.447 Vali Acc: 0.916 Test Loss: 0.447 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 16 cost time: 1.6906518936157227
Epoch: 16, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
Validation loss decreased (-0.916212 --> -0.929726).  Saving model ...
Epoch: 17 cost time: 2.1125433444976807
Epoch: 17, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.373 Vali Acc: 0.932 Test Loss: 0.373 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 2.0669000148773193
Epoch: 18, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9676525592803955
Epoch: 19, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
Validation loss decreased (-0.932429 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 1.7892730236053467
Epoch: 20, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.047394275665283
Epoch: 21, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.279 Vali Acc: 0.943 Test Loss: 0.279 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 22 cost time: 1.6059651374816895
Epoch: 22, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.252 Vali Acc: 0.946 Test Loss: 0.252 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 23 cost time: 1.7221336364746094
Epoch: 23, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.252 Vali Acc: 0.943 Test Loss: 0.252 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.663196325302124
Epoch: 24, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0315136909484863
Epoch: 25, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7609100341796875
Epoch: 26, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 1.6744656562805176
Epoch: 27, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 2.093477487564087
Epoch: 28, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.195 Vali Acc: 0.954 Test Loss: 0.195 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 2.141855239868164
Epoch: 29, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.191 Vali Acc: 0.954 Test Loss: 0.191 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 2.088256597518921
Epoch: 30, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 31 cost time: 2.0296714305877686
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.943084478378296
Epoch: 32, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 33 cost time: 2.0326616764068604
Epoch: 33, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 1.6602692604064941
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.1422231197357178
Epoch: 35, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7173314094543457
Epoch: 36, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 2.0661630630493164
Epoch: 37, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 2.0233540534973145
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 1.9646806716918945
Epoch: 39, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.957 Test Loss: 0.134 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.052906036376953
Epoch: 40, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 1.9615049362182617
Epoch: 41, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.9982366561889648
Epoch: 42, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 1.7988553047180176
Epoch: 43, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 44 cost time: 2.044706344604492
Epoch: 44, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7383620738983154
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 46 cost time: 1.848501205444336
Epoch: 46, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.9310393333435059
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.6498057842254639
Epoch: 48, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.8391838073730469
Epoch: 49, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.949 Test Loss: 0.125 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.7624404430389404
Epoch: 50, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.164405345916748
Epoch: 51, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.029383659362793
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 53 cost time: 2.060150384902954
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5943176746368408
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.541534423828125
Epoch: 55, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.75435471534729
Epoch: 56, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 2.0496416091918945
Epoch: 57, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 58 cost time: 1.9656434059143066
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 59 cost time: 1.9821279048919678
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.9975864887237549
Epoch: 60, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.967567 --> -0.975675).  Saving model ...
Epoch: 61 cost time: 1.94000244140625
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.1595277786254883
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 2.253267765045166
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 64 cost time: 2.0615222454071045
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.2302017211914062
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 66 cost time: 2.1294209957122803
Epoch: 66, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.9223341941833496
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 2.0369012355804443
Epoch: 68, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 2.0722997188568115
Epoch: 69, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.585554599761963
Epoch: 70, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.9698338508605957
Epoch: 71, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 2.0650153160095215
Epoch: 72, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 2.035217523574829
Epoch: 73, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.9939184188842773
Epoch: 74, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 2.059263229370117
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 32297
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.306467056274414
Epoch: 1, Steps: 17 | Train Loss: 2.331 Vali Loss: 2.265 Vali Acc: 0.059 Test Loss: 2.265 Test Acc: 0.059
Validation loss decreased (inf --> -0.059437).  Saving model ...
Epoch: 2 cost time: 1.8193244934082031
Epoch: 2, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.140 Vali Acc: 0.108 Test Loss: 2.140 Test Acc: 0.108
Validation loss decreased (-0.059437 --> -0.108087).  Saving model ...
Epoch: 3 cost time: 1.9305803775787354
Epoch: 3, Steps: 17 | Train Loss: 2.101 Vali Loss: 1.988 Vali Acc: 0.286 Test Loss: 1.988 Test Acc: 0.286
Validation loss decreased (-0.108087 --> -0.286467).  Saving model ...
Epoch: 4 cost time: 1.9913532733917236
Epoch: 4, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.823 Vali Acc: 0.489 Test Loss: 1.823 Test Acc: 0.489
Validation loss decreased (-0.286467 --> -0.489171).  Saving model ...
Epoch: 5 cost time: 2.0755207538604736
Epoch: 5, Steps: 17 | Train Loss: 1.751 Vali Loss: 1.661 Vali Acc: 0.651 Test Loss: 1.661 Test Acc: 0.651
Validation loss decreased (-0.489171 --> -0.651335).  Saving model ...
Epoch: 6 cost time: 2.051050901412964
Epoch: 6, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.498 Vali Acc: 0.730 Test Loss: 1.498 Test Acc: 0.730
Validation loss decreased (-0.651335 --> -0.729715).  Saving model ...
Epoch: 7 cost time: 1.962188482284546
Epoch: 7, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.334 Vali Acc: 0.792 Test Loss: 1.334 Test Acc: 0.792
Validation loss decreased (-0.729715 --> -0.791879).  Saving model ...
Epoch: 8 cost time: 1.7978346347808838
Epoch: 8, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.162 Vali Acc: 0.830 Test Loss: 1.162 Test Acc: 0.830
Validation loss decreased (-0.791879 --> -0.829718).  Saving model ...
Epoch: 9 cost time: 1.6708800792694092
Epoch: 9, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.010 Vali Acc: 0.854 Test Loss: 1.010 Test Acc: 0.854
Validation loss decreased (-0.829718 --> -0.854044).  Saving model ...
Epoch: 10 cost time: 1.7178993225097656
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 0.875 Vali Acc: 0.873 Test Loss: 0.875 Test Acc: 0.873
Validation loss decreased (-0.854044 --> -0.872964).  Saving model ...
Epoch: 11 cost time: 1.7770893573760986
Epoch: 11, Steps: 17 | Train Loss: 0.761 Vali Loss: 0.764 Vali Acc: 0.881 Test Loss: 0.764 Test Acc: 0.881
Validation loss decreased (-0.872964 --> -0.881073).  Saving model ...
Epoch: 12 cost time: 1.8120074272155762
Epoch: 12, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.881073 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.8029303550720215
Epoch: 13, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.595 Vali Acc: 0.897 Test Loss: 0.595 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7567639350891113
Epoch: 14, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.910806).  Saving model ...
Epoch: 15 cost time: 1.8538661003112793
Epoch: 15, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.452 Vali Acc: 0.916 Test Loss: 0.452 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916212).  Saving model ...
Epoch: 16 cost time: 1.69057035446167
Epoch: 16, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.421 Vali Acc: 0.924 Test Loss: 0.421 Test Acc: 0.924
Validation loss decreased (-0.916212 --> -0.924320).  Saving model ...
Epoch: 17 cost time: 1.631485939025879
Epoch: 17, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.374 Vali Acc: 0.932 Test Loss: 0.374 Test Acc: 0.932
Validation loss decreased (-0.924320 --> -0.932429).  Saving model ...
Epoch: 18 cost time: 1.6516647338867188
Epoch: 18, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.346 Vali Acc: 0.935 Test Loss: 0.346 Test Acc: 0.935
Validation loss decreased (-0.932429 --> -0.935132).  Saving model ...
Epoch: 19 cost time: 2.0033252239227295
Epoch: 19, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.324 Vali Acc: 0.943 Test Loss: 0.324 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 2.029498338699341
Epoch: 20, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.295 Vali Acc: 0.935 Test Loss: 0.295 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1610848903656006
Epoch: 21, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.277 Vali Acc: 0.943 Test Loss: 0.277 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 22 cost time: 2.01340651512146
Epoch: 22, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.250 Vali Acc: 0.949 Test Loss: 0.250 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 2.1148269176483154
Epoch: 23, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6581201553344727
Epoch: 24, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1297287940979004
Epoch: 25, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.216 Vali Acc: 0.946 Test Loss: 0.216 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7101330757141113
Epoch: 26, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.2041642665863037
Epoch: 27, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 28 cost time: 1.909745216369629
Epoch: 28, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 2.1340532302856445
Epoch: 29, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7634985446929932
Epoch: 30, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9808478355407715
Epoch: 31, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.9943163394927979
Epoch: 32, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 2.075634479522705
Epoch: 33, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 2.149052619934082
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6071417331695557
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.042752265930176
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 1.630932092666626
Epoch: 37, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 38 cost time: 2.0055174827575684
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 1.89316725730896
Epoch: 39, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7125377655029297
Epoch: 40, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6805715560913086
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 42 cost time: 2.140244722366333
Epoch: 42, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.1215550899505615
Epoch: 43, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9036576747894287
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.0124683380126953
Epoch: 45, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 1.8400437831878662
Epoch: 46, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.733654260635376
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7460815906524658
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7887167930603027
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.774343490600586
Epoch: 50, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7587862014770508
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.7974073886871338
Epoch: 52, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.5669362545013428
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.9011478424072266
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.9935884475708008
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 32297
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.734163761138916
Epoch: 1, Steps: 17 | Train Loss: 2.321 Vali Loss: 2.260 Vali Acc: 0.065 Test Loss: 2.260 Test Acc: 0.065
Validation loss decreased (inf --> -0.064842).  Saving model ...
Epoch: 2 cost time: 1.8066833019256592
Epoch: 2, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.136 Vali Acc: 0.086 Test Loss: 2.136 Test Acc: 0.086
Validation loss decreased (-0.064842 --> -0.086465).  Saving model ...
Epoch: 3 cost time: 1.606905460357666
Epoch: 3, Steps: 17 | Train Loss: 2.102 Vali Loss: 1.984 Vali Acc: 0.281 Test Loss: 1.984 Test Acc: 0.281
Validation loss decreased (-0.086465 --> -0.281061).  Saving model ...
Epoch: 4 cost time: 2.0448343753814697
Epoch: 4, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.816 Vali Acc: 0.514 Test Loss: 1.816 Test Acc: 0.514
Validation loss decreased (-0.281061 --> -0.513495).  Saving model ...
Epoch: 5 cost time: 1.9327189922332764
Epoch: 5, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.654 Vali Acc: 0.668 Test Loss: 1.654 Test Acc: 0.668
Validation loss decreased (-0.513495 --> -0.667551).  Saving model ...
Epoch: 6 cost time: 1.5511243343353271
Epoch: 6, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.489 Vali Acc: 0.749 Test Loss: 1.489 Test Acc: 0.749
Validation loss decreased (-0.667551 --> -0.748634).  Saving model ...
Epoch: 7 cost time: 2.077086925506592
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.325 Vali Acc: 0.800 Test Loss: 1.325 Test Acc: 0.800
Validation loss decreased (-0.748634 --> -0.799987).  Saving model ...
Epoch: 8 cost time: 2.0676543712615967
Epoch: 8, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.153 Vali Acc: 0.854 Test Loss: 1.153 Test Acc: 0.854
Validation loss decreased (-0.799987 --> -0.854043).  Saving model ...
Epoch: 9 cost time: 2.120220899581909
Epoch: 9, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.002 Vali Acc: 0.868 Test Loss: 1.002 Test Acc: 0.868
Validation loss decreased (-0.854043 --> -0.867558).  Saving model ...
Epoch: 10 cost time: 1.8879384994506836
Epoch: 10, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.867 Vali Acc: 0.878 Test Loss: 0.867 Test Acc: 0.878
Validation loss decreased (-0.867558 --> -0.878370).  Saving model ...
Epoch: 11 cost time: 1.7607765197753906
Epoch: 11, Steps: 17 | Train Loss: 0.774 Vali Loss: 0.758 Vali Acc: 0.878 Test Loss: 0.758 Test Acc: 0.878
Validation loss decreased (-0.878370 --> -0.878371).  Saving model ...
Epoch: 12 cost time: 1.4633917808532715
Epoch: 12, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.660 Vali Acc: 0.897 Test Loss: 0.660 Test Acc: 0.897
Validation loss decreased (-0.878371 --> -0.897291).  Saving model ...
Epoch: 13 cost time: 1.8915905952453613
Epoch: 13, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.586 Vali Acc: 0.892 Test Loss: 0.586 Test Acc: 0.892
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0677361488342285
Epoch: 14, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.518 Vali Acc: 0.905 Test Loss: 0.518 Test Acc: 0.905
Validation loss decreased (-0.897291 --> -0.905400).  Saving model ...
Epoch: 15 cost time: 1.9355502128601074
Epoch: 15, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.448 Vali Acc: 0.914 Test Loss: 0.448 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913509).  Saving model ...
Epoch: 16 cost time: 2.088872194290161
Epoch: 16, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.418 Vali Acc: 0.922 Test Loss: 0.418 Test Acc: 0.922
Validation loss decreased (-0.913509 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 1.6143300533294678
Epoch: 17, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.370 Vali Acc: 0.930 Test Loss: 0.370 Test Acc: 0.930
Validation loss decreased (-0.921617 --> -0.929726).  Saving model ...
Epoch: 18 cost time: 1.8782553672790527
Epoch: 18, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.343 Vali Acc: 0.927 Test Loss: 0.343 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0892364978790283
Epoch: 19, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.323 Vali Acc: 0.935 Test Loss: 0.323 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 20 cost time: 2.0300326347351074
Epoch: 20, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.299 Vali Acc: 0.932 Test Loss: 0.299 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9364919662475586
Epoch: 21, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 2.0214338302612305
Epoch: 22, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.252 Vali Acc: 0.949 Test Loss: 0.252 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 2.0456652641296387
Epoch: 23, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.255 Vali Acc: 0.938 Test Loss: 0.255 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8715195655822754
Epoch: 24, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9715397357940674
Epoch: 25, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6978094577789307
Epoch: 26, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 27 cost time: 1.8087515830993652
Epoch: 27, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 1.638775110244751
Epoch: 28, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.196 Vali Acc: 0.949 Test Loss: 0.196 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5866742134094238
Epoch: 29, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.719451904296875
Epoch: 30, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.174 Vali Acc: 0.949 Test Loss: 0.174 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9493372440338135
Epoch: 31, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.983989953994751
Epoch: 32, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8077588081359863
Epoch: 33, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.965003490447998
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 35 cost time: 1.8179543018341064
Epoch: 35, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.8612778186798096
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 1.9619569778442383
Epoch: 37, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.907034158706665
Epoch: 38, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 1.7569501399993896
Epoch: 39, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 1.7536489963531494
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.9130136966705322
Epoch: 41, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.912968635559082
Epoch: 42, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 1.820533275604248
Epoch: 43, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 44 cost time: 1.7705614566802979
Epoch: 44, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 45 cost time: 1.9337265491485596
Epoch: 45, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 46 cost time: 1.9194416999816895
Epoch: 46, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.080716848373413
Epoch: 47, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.0447092056274414
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.9895341396331787
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.446977138519287
Epoch: 50, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 51 cost time: 2.2283828258514404
Epoch: 51, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 1.968942403793335
Epoch: 52, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 53 cost time: 2.4738752841949463
Epoch: 53, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 2.0566134452819824
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0750999450683594
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.1451642513275146
Epoch: 56, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.833085060119629
Epoch: 57, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 58 cost time: 1.9747564792633057
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.9374966621398926
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.7987439632415771
Epoch: 60, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 2.0605125427246094
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.878633737564087
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 2.116323709487915
Epoch: 63, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 64 cost time: 2.202697515487671
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 2.013275623321533
Epoch: 65, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 2.0353097915649414
Epoch: 66, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.9546010494232178
Epoch: 67, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 68 cost time: 1.8687899112701416
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.842559576034546
Epoch: 69, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 70 cost time: 2.12467885017395
Epoch: 70, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 2.120572090148926
Epoch: 71, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 72 cost time: 2.01035213470459
Epoch: 72, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 2.0136003494262695
Epoch: 73, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 74 cost time: 2.0165464878082275
Epoch: 74, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.3395211696624756
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.0030853748321533
Epoch: 76, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 77 cost time: 2.107606887817383
Epoch: 77, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.8281021118164062
Epoch: 78, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 2.2309975624084473
Epoch: 79, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 2.2833127975463867
Epoch: 80, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.999645709991455
Epoch: 81, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 2.0209968090057373
Epoch: 82, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.8473737239837646
Epoch: 83, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 2.2092387676239014
Epoch: 84, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 2.2125301361083984
Epoch: 85, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 2.236433982849121
Epoch: 86, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 32297
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.806941270828247
Epoch: 1, Steps: 17 | Train Loss: 2.287 Vali Loss: 2.232 Vali Acc: 0.081 Test Loss: 2.232 Test Acc: 0.081
Validation loss decreased (inf --> -0.081059).  Saving model ...
Epoch: 2 cost time: 1.920058012008667
Epoch: 2, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.115 Vali Acc: 0.127 Test Loss: 2.115 Test Acc: 0.127
Validation loss decreased (-0.081059 --> -0.127006).  Saving model ...
Epoch: 3 cost time: 1.708888053894043
Epoch: 3, Steps: 17 | Train Loss: 2.066 Vali Loss: 1.971 Vali Acc: 0.330 Test Loss: 1.971 Test Acc: 0.330
Validation loss decreased (-0.127006 --> -0.329710).  Saving model ...
Epoch: 4 cost time: 1.9132041931152344
Epoch: 4, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.810 Vali Acc: 0.551 Test Loss: 1.810 Test Acc: 0.551
Validation loss decreased (-0.329710 --> -0.551333).  Saving model ...
Epoch: 5 cost time: 1.6193788051605225
Epoch: 5, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.650 Vali Acc: 0.732 Test Loss: 1.650 Test Acc: 0.732
Validation loss decreased (-0.551333 --> -0.732416).  Saving model ...
Epoch: 6 cost time: 1.8387410640716553
Epoch: 6, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.485 Vali Acc: 0.797 Test Loss: 1.485 Test Acc: 0.797
Validation loss decreased (-0.732416 --> -0.797282).  Saving model ...
Epoch: 7 cost time: 2.0278513431549072
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.317 Vali Acc: 0.830 Test Loss: 1.317 Test Acc: 0.830
Validation loss decreased (-0.797282 --> -0.829717).  Saving model ...
Epoch: 8 cost time: 2.0148582458496094
Epoch: 8, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.149 Vali Acc: 0.854 Test Loss: 1.149 Test Acc: 0.854
Validation loss decreased (-0.829717 --> -0.854043).  Saving model ...
Epoch: 9 cost time: 1.8816349506378174
Epoch: 9, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.999 Vali Acc: 0.859 Test Loss: 0.999 Test Acc: 0.859
Validation loss decreased (-0.854043 --> -0.859449).  Saving model ...
Epoch: 10 cost time: 1.6064708232879639
Epoch: 10, Steps: 17 | Train Loss: 0.922 Vali Loss: 0.868 Vali Acc: 0.859 Test Loss: 0.868 Test Acc: 0.859
Validation loss decreased (-0.859449 --> -0.859451).  Saving model ...
Epoch: 11 cost time: 1.4296996593475342
Epoch: 11, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.759 Vali Acc: 0.884 Test Loss: 0.759 Test Acc: 0.884
Validation loss decreased (-0.859451 --> -0.883776).  Saving model ...
Epoch: 12 cost time: 1.6687843799591064
Epoch: 12, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.662 Vali Acc: 0.908 Test Loss: 0.662 Test Acc: 0.908
Validation loss decreased (-0.883776 --> -0.908101).  Saving model ...
Epoch: 13 cost time: 1.982123851776123
Epoch: 13, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.588 Vali Acc: 0.903 Test Loss: 0.588 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6967778205871582
Epoch: 14, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.517 Vali Acc: 0.914 Test Loss: 0.517 Test Acc: 0.914
Validation loss decreased (-0.908101 --> -0.913508).  Saving model ...
Epoch: 15 cost time: 1.882096290588379
Epoch: 15, Steps: 17 | Train Loss: 0.433 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
Validation loss decreased (-0.913508 --> -0.918914).  Saving model ...
Epoch: 16 cost time: 2.081939458847046
Epoch: 16, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.416 Vali Acc: 0.924 Test Loss: 0.416 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 17 cost time: 2.1848831176757812
Epoch: 17, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.372 Vali Acc: 0.927 Test Loss: 0.372 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 18 cost time: 1.9829096794128418
Epoch: 18, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.341 Vali Acc: 0.932 Test Loss: 0.341 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932429).  Saving model ...
Epoch: 19 cost time: 2.0759260654449463
Epoch: 19, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.318 Vali Acc: 0.946 Test Loss: 0.318 Test Acc: 0.946
Validation loss decreased (-0.932429 --> -0.945943).  Saving model ...
Epoch: 20 cost time: 2.1265921592712402
Epoch: 20, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0728726387023926
Epoch: 21, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.272 Vali Acc: 0.946 Test Loss: 0.272 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 1.7906920909881592
Epoch: 22, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 23 cost time: 1.714836597442627
Epoch: 23, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.251 Vali Acc: 0.943 Test Loss: 0.251 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0995774269104004
Epoch: 24, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.229 Vali Acc: 0.949 Test Loss: 0.229 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 25 cost time: 2.0545270442962646
Epoch: 25, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 1.923654317855835
Epoch: 26, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 1.8713488578796387
Epoch: 27, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.198 Vali Acc: 0.954 Test Loss: 0.198 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 2.047905445098877
Epoch: 28, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.176602840423584
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.062187671661377
Epoch: 30, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 31 cost time: 2.42099666595459
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9003052711486816
Epoch: 32, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.1915476322174072
Epoch: 33, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.163 Vali Acc: 0.949 Test Loss: 0.163 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.0435516834259033
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.176154613494873
Epoch: 35, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.949 Test Loss: 0.153 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.337162971496582
Epoch: 36, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.8942556381225586
Epoch: 37, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.106792449951172
Epoch: 38, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.922253131866455
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 2.3246967792510986
Epoch: 40, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.2527263164520264
Epoch: 41, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8998034000396729
Epoch: 42, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.954 Test Loss: 0.135 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.062762498855591
Epoch: 43, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 44 cost time: 1.8716914653778076
Epoch: 44, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.851104497909546
Epoch: 45, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 46 cost time: 1.5670876502990723
Epoch: 46, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8483386039733887
Epoch: 47, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.951 Test Loss: 0.128 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.8534157276153564
Epoch: 48, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.4542152881622314
Epoch: 49, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4566211700439453
Epoch: 50, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4462571144104004
Epoch: 51, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 1.6153979301452637
Epoch: 52, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 53 cost time: 1.6453814506530762
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.5331089496612549
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.8771696090698242
Epoch: 55, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.0390868186950684
Epoch: 56, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.8328773975372314
Epoch: 57, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.0384628772735596
Epoch: 58, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 2.0676281452178955
Epoch: 59, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.957 Test Loss: 0.111 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 2.112520933151245
Epoch: 60, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.954 Test Loss: 0.113 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 2.2412564754486084
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.766524314880371
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 32297
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.1234290599823
Epoch: 1, Steps: 17 | Train Loss: 2.205 Vali Loss: 2.148 Vali Acc: 0.100 Test Loss: 2.148 Test Acc: 0.100
Validation loss decreased (inf --> -0.099979).  Saving model ...
Epoch: 2 cost time: 1.9027466773986816
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.027 Vali Acc: 0.265 Test Loss: 2.027 Test Acc: 0.265
Validation loss decreased (-0.099979 --> -0.264845).  Saving model ...
Epoch: 3 cost time: 1.9625911712646484
Epoch: 3, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.888 Vali Acc: 0.432 Test Loss: 1.888 Test Acc: 0.432
Validation loss decreased (-0.264845 --> -0.432414).  Saving model ...
Epoch: 4 cost time: 1.5509076118469238
Epoch: 4, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.736 Vali Acc: 0.597 Test Loss: 1.736 Test Acc: 0.597
Validation loss decreased (-0.432414 --> -0.597280).  Saving model ...
Epoch: 5 cost time: 1.744520902633667
Epoch: 5, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.573 Vali Acc: 0.714 Test Loss: 1.573 Test Acc: 0.714
Validation loss decreased (-0.597280 --> -0.713498).  Saving model ...
Epoch: 6 cost time: 1.921687126159668
Epoch: 6, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.421 Vali Acc: 0.781 Test Loss: 1.421 Test Acc: 0.781
Validation loss decreased (-0.713498 --> -0.781067).  Saving model ...
Epoch: 7 cost time: 1.7543001174926758
Epoch: 7, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.251 Vali Acc: 0.830 Test Loss: 1.251 Test Acc: 0.830
Validation loss decreased (-0.781067 --> -0.829717).  Saving model ...
Epoch: 8 cost time: 1.846174716949463
Epoch: 8, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.096 Vali Acc: 0.849 Test Loss: 1.096 Test Acc: 0.849
Validation loss decreased (-0.829717 --> -0.848638).  Saving model ...
Epoch: 9 cost time: 1.7766821384429932
Epoch: 9, Steps: 17 | Train Loss: 0.953 Vali Loss: 0.958 Vali Acc: 0.870 Test Loss: 0.958 Test Acc: 0.870
Validation loss decreased (-0.848638 --> -0.870261).  Saving model ...
Epoch: 10 cost time: 1.7656021118164062
Epoch: 10, Steps: 17 | Train Loss: 0.822 Vali Loss: 0.844 Vali Acc: 0.865 Test Loss: 0.844 Test Acc: 0.865
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.054702043533325
Epoch: 11, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.740 Vali Acc: 0.884 Test Loss: 0.740 Test Acc: 0.884
Validation loss decreased (-0.870261 --> -0.883776).  Saving model ...
Epoch: 12 cost time: 1.9207284450531006
Epoch: 12, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.883776 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.883575201034546
Epoch: 13, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.589 Vali Acc: 0.905 Test Loss: 0.589 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905400).  Saving model ...
Epoch: 14 cost time: 1.7324106693267822
Epoch: 14, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 15 cost time: 1.7172179222106934
Epoch: 15, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
Validation loss decreased (-0.910806 --> -0.921617).  Saving model ...
Epoch: 16 cost time: 1.5424389839172363
Epoch: 16, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.442 Vali Acc: 0.927 Test Loss: 0.442 Test Acc: 0.927
Validation loss decreased (-0.921617 --> -0.927023).  Saving model ...
Epoch: 17 cost time: 1.6760754585266113
Epoch: 17, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940537).  Saving model ...
Epoch: 18 cost time: 1.6504454612731934
Epoch: 18, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.361 Vali Acc: 0.943 Test Loss: 0.361 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 19 cost time: 1.9255397319793701
Epoch: 19, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.342 Vali Acc: 0.951 Test Loss: 0.342 Test Acc: 0.951
Validation loss decreased (-0.943240 --> -0.951348).  Saving model ...
Epoch: 20 cost time: 1.87908935546875
Epoch: 20, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.317 Vali Acc: 0.949 Test Loss: 0.317 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.849395751953125
Epoch: 21, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.295 Vali Acc: 0.949 Test Loss: 0.295 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.663858413696289
Epoch: 22, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 23 cost time: 1.6147799491882324
Epoch: 23, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.262 Vali Acc: 0.949 Test Loss: 0.262 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.852524995803833
Epoch: 24, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.249 Vali Acc: 0.951 Test Loss: 0.249 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 2.0151937007904053
Epoch: 25, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.237 Vali Acc: 0.959 Test Loss: 0.237 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 26 cost time: 1.8240902423858643
Epoch: 26, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.223 Vali Acc: 0.959 Test Loss: 0.223 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 27 cost time: 1.9471144676208496
Epoch: 27, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 28 cost time: 1.9782145023345947
Epoch: 28, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.983522891998291
Epoch: 29, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 30 cost time: 1.8773882389068604
Epoch: 30, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 31 cost time: 1.7334043979644775
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.6671273708343506
Epoch: 32, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.968 Test Loss: 0.177 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 1.8162920475006104
Epoch: 33, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.968 Test Loss: 0.172 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.875023603439331
Epoch: 34, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.112517833709717
Epoch: 35, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.844313621520996
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 1.8535206317901611
Epoch: 37, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7097880840301514
Epoch: 38, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.019066333770752
Epoch: 39, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.964625358581543
Epoch: 40, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8934388160705566
Epoch: 41, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6990077495574951
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5909485816955566
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8839945793151855
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.953904628753662
Epoch: 45, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.9337568283081055
Epoch: 46, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 24105
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9166100025177
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.152 Vali Acc: 0.089 Test Loss: 2.152 Test Acc: 0.089
Validation loss decreased (inf --> -0.089168).  Saving model ...
Epoch: 2 cost time: 1.7129557132720947
Epoch: 2, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.031 Vali Acc: 0.243 Test Loss: 2.031 Test Acc: 0.243
Validation loss decreased (-0.089168 --> -0.243223).  Saving model ...
Epoch: 3 cost time: 1.911515474319458
Epoch: 3, Steps: 17 | Train Loss: 1.981 Vali Loss: 1.892 Vali Acc: 0.441 Test Loss: 1.892 Test Acc: 0.441
Validation loss decreased (-0.243223 --> -0.440522).  Saving model ...
Epoch: 4 cost time: 1.6142427921295166
Epoch: 4, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.741 Vali Acc: 0.573 Test Loss: 1.741 Test Acc: 0.573
Validation loss decreased (-0.440522 --> -0.572956).  Saving model ...
Epoch: 5 cost time: 1.8040707111358643
Epoch: 5, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.577 Vali Acc: 0.714 Test Loss: 1.577 Test Acc: 0.714
Validation loss decreased (-0.572956 --> -0.713498).  Saving model ...
Epoch: 6 cost time: 1.7746129035949707
Epoch: 6, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.426 Vali Acc: 0.757 Test Loss: 1.426 Test Acc: 0.757
Validation loss decreased (-0.713498 --> -0.756742).  Saving model ...
Epoch: 7 cost time: 1.9220762252807617
Epoch: 7, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.256 Vali Acc: 0.827 Test Loss: 1.256 Test Acc: 0.827
Validation loss decreased (-0.756742 --> -0.827014).  Saving model ...
Epoch: 8 cost time: 1.8922812938690186
Epoch: 8, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.100 Vali Acc: 0.846 Test Loss: 1.100 Test Acc: 0.846
Validation loss decreased (-0.827014 --> -0.845935).  Saving model ...
Epoch: 9 cost time: 1.764540433883667
Epoch: 9, Steps: 17 | Train Loss: 0.972 Vali Loss: 0.962 Vali Acc: 0.859 Test Loss: 0.962 Test Acc: 0.859
Validation loss decreased (-0.845935 --> -0.859450).  Saving model ...
Epoch: 10 cost time: 1.7987275123596191
Epoch: 10, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.847 Vali Acc: 0.868 Test Loss: 0.847 Test Acc: 0.868
Validation loss decreased (-0.859450 --> -0.867559).  Saving model ...
Epoch: 11 cost time: 1.6398794651031494
Epoch: 11, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.743 Vali Acc: 0.878 Test Loss: 0.743 Test Acc: 0.878
Validation loss decreased (-0.867559 --> -0.878371).  Saving model ...
Epoch: 12 cost time: 1.7038147449493408
Epoch: 12, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.657 Vali Acc: 0.889 Test Loss: 0.657 Test Acc: 0.889
Validation loss decreased (-0.878371 --> -0.889183).  Saving model ...
Epoch: 13 cost time: 1.8459336757659912
Epoch: 13, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.590 Vali Acc: 0.892 Test Loss: 0.590 Test Acc: 0.892
Validation loss decreased (-0.889183 --> -0.891886).  Saving model ...
Epoch: 14 cost time: 1.8057441711425781
Epoch: 14, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.525 Vali Acc: 0.897 Test Loss: 0.525 Test Acc: 0.897
Validation loss decreased (-0.891886 --> -0.897292).  Saving model ...
Epoch: 15 cost time: 1.7742371559143066
Epoch: 15, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.470 Vali Acc: 0.914 Test Loss: 0.470 Test Acc: 0.914
Validation loss decreased (-0.897292 --> -0.913509).  Saving model ...
Epoch: 16 cost time: 1.9979498386383057
Epoch: 16, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.441 Vali Acc: 0.924 Test Loss: 0.441 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924320).  Saving model ...
Epoch: 17 cost time: 1.7807855606079102
Epoch: 17, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.397 Vali Acc: 0.935 Test Loss: 0.397 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 1.9890434741973877
Epoch: 18, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.362 Vali Acc: 0.943 Test Loss: 0.362 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 19 cost time: 1.6481266021728516
Epoch: 19, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.341 Vali Acc: 0.943 Test Loss: 0.341 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 20 cost time: 2.0593557357788086
Epoch: 20, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.316 Vali Acc: 0.949 Test Loss: 0.316 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948645).  Saving model ...
Epoch: 21 cost time: 1.7621357440948486
Epoch: 21, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.295 Vali Acc: 0.949 Test Loss: 0.295 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 22 cost time: 1.9185154438018799
Epoch: 22, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.278 Vali Acc: 0.946 Test Loss: 0.278 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.006753444671631
Epoch: 23, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.267 Vali Acc: 0.943 Test Loss: 0.267 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.075906753540039
Epoch: 24, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 2.1224441528320312
Epoch: 25, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.241 Vali Acc: 0.954 Test Loss: 0.241 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 1.7988228797912598
Epoch: 26, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.225 Vali Acc: 0.962 Test Loss: 0.225 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 27 cost time: 2.1834304332733154
Epoch: 27, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.221 Vali Acc: 0.962 Test Loss: 0.221 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 28 cost time: 1.873039960861206
Epoch: 28, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0942394733428955
Epoch: 29, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8086609840393066
Epoch: 30, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.921401023864746
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 32 cost time: 1.9330308437347412
Epoch: 32, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 33 cost time: 2.0824103355407715
Epoch: 33, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9271254539489746
Epoch: 34, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.170 Vali Acc: 0.962 Test Loss: 0.170 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7877352237701416
Epoch: 35, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 36 cost time: 1.724787950515747
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8227818012237549
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.9489445686340332
Epoch: 38, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.0139970779418945
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 40 cost time: 1.9174284934997559
Epoch: 40, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.8175568580627441
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 42 cost time: 1.745279312133789
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.87473464012146
Epoch: 43, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.1372015476226807
Epoch: 44, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.7644343376159668
Epoch: 45, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 1.9195058345794678
Epoch: 46, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7885160446166992
Epoch: 47, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9200611114501953
Epoch: 48, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 49 cost time: 2.003109931945801
Epoch: 49, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 50 cost time: 1.7294838428497314
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9719271659851074
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.9805490970611572
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.717071771621704
Epoch: 53, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.8626952171325684
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8228988647460938
Epoch: 55, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.7823772430419922
Epoch: 56, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.7124831676483154
Epoch: 57, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 58 cost time: 1.3691112995147705
Epoch: 58, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.370765209197998
Epoch: 59, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.4402759075164795
Epoch: 60, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 61 cost time: 1.9095511436462402
Epoch: 61, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.0413076877593994
Epoch: 62, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.8850252628326416
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 64 cost time: 1.7186412811279297
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.759983777999878
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.7027838230133057
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.929250717163086
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.8900868892669678
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 2.0096588134765625
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 2.0607428550720215
Epoch: 70, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.9392523765563965
Epoch: 71, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 72 cost time: 1.8232758045196533
Epoch: 72, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.8690454959869385
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 74 cost time: 1.8040194511413574
Epoch: 74, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 2.2525808811187744
Epoch: 75, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 2.14224910736084
Epoch: 76, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.7939445972442627
Epoch: 77, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.8956098556518555
Epoch: 78, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.6299529075622559
Epoch: 79, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.797450304031372
Epoch: 80, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.8628365993499756
Epoch: 81, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 2.0317540168762207
Epoch: 82, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 2.0048930644989014
Epoch: 83, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 24105
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.995633125305176
Epoch: 1, Steps: 17 | Train Loss: 2.204 Vali Loss: 2.146 Vali Acc: 0.103 Test Loss: 2.146 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 1.882462978363037
Epoch: 2, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.025 Vali Acc: 0.235 Test Loss: 2.025 Test Acc: 0.235
Validation loss decreased (-0.102681 --> -0.235115).  Saving model ...
Epoch: 3 cost time: 1.8084185123443604
Epoch: 3, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.884 Vali Acc: 0.468 Test Loss: 1.884 Test Acc: 0.468
Validation loss decreased (-0.235115 --> -0.467549).  Saving model ...
Epoch: 4 cost time: 1.758819341659546
Epoch: 4, Steps: 17 | Train Loss: 1.831 Vali Loss: 1.732 Vali Acc: 0.624 Test Loss: 1.732 Test Acc: 0.624
Validation loss decreased (-0.467549 --> -0.624307).  Saving model ...
Epoch: 5 cost time: 1.9429435729980469
Epoch: 5, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.569 Vali Acc: 0.714 Test Loss: 1.569 Test Acc: 0.714
Validation loss decreased (-0.624307 --> -0.713498).  Saving model ...
Epoch: 6 cost time: 1.9257967472076416
Epoch: 6, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.416 Vali Acc: 0.768 Test Loss: 1.416 Test Acc: 0.768
Validation loss decreased (-0.713498 --> -0.767553).  Saving model ...
Epoch: 7 cost time: 1.6686418056488037
Epoch: 7, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.246 Vali Acc: 0.803 Test Loss: 1.246 Test Acc: 0.803
Validation loss decreased (-0.767553 --> -0.802690).  Saving model ...
Epoch: 8 cost time: 1.7229974269866943
Epoch: 8, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.094 Vali Acc: 0.830 Test Loss: 1.094 Test Acc: 0.830
Validation loss decreased (-0.802690 --> -0.829719).  Saving model ...
Epoch: 9 cost time: 1.8353266716003418
Epoch: 9, Steps: 17 | Train Loss: 0.992 Vali Loss: 0.959 Vali Acc: 0.857 Test Loss: 0.959 Test Acc: 0.857
Validation loss decreased (-0.829719 --> -0.856747).  Saving model ...
Epoch: 10 cost time: 1.87666654586792
Epoch: 10, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.844 Vali Acc: 0.873 Test Loss: 0.844 Test Acc: 0.873
Validation loss decreased (-0.856747 --> -0.872965).  Saving model ...
Epoch: 11 cost time: 1.6630260944366455
Epoch: 11, Steps: 17 | Train Loss: 0.746 Vali Loss: 0.740 Vali Acc: 0.886 Test Loss: 0.740 Test Acc: 0.886
Validation loss decreased (-0.872965 --> -0.886479).  Saving model ...
Epoch: 12 cost time: 1.8668973445892334
Epoch: 12, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.655 Vali Acc: 0.897 Test Loss: 0.655 Test Acc: 0.897
Validation loss decreased (-0.886479 --> -0.897291).  Saving model ...
Epoch: 13 cost time: 1.9172818660736084
Epoch: 13, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.897291 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 1.8102936744689941
Epoch: 14, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 1.8256030082702637
Epoch: 15, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.468 Vali Acc: 0.911 Test Loss: 0.468 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.910806).  Saving model ...
Epoch: 16 cost time: 2.0392887592315674
Epoch: 16, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.441 Vali Acc: 0.914 Test Loss: 0.441 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 17 cost time: 1.7521154880523682
Epoch: 17, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.396 Vali Acc: 0.924 Test Loss: 0.396 Test Acc: 0.924
Validation loss decreased (-0.913509 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 1.5928740501403809
Epoch: 18, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9310035705566406
Epoch: 19, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.338 Vali Acc: 0.924 Test Loss: 0.338 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924321).  Saving model ...
Epoch: 20 cost time: 1.6921072006225586
Epoch: 20, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.924321 --> -0.929727).  Saving model ...
Epoch: 21 cost time: 1.7002534866333008
Epoch: 21, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.294 Vali Acc: 0.935 Test Loss: 0.294 Test Acc: 0.935
Validation loss decreased (-0.929727 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 1.6391043663024902
Epoch: 22, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
Validation loss decreased (-0.935132 --> -0.943240).  Saving model ...
Epoch: 23 cost time: 1.8869884014129639
Epoch: 23, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.265 Vali Acc: 0.938 Test Loss: 0.265 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1164534091949463
Epoch: 24, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9031808376312256
Epoch: 25, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 26 cost time: 2.048938274383545
Epoch: 26, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956754).  Saving model ...
Epoch: 27 cost time: 1.9887197017669678
Epoch: 27, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 28 cost time: 1.8597915172576904
Epoch: 28, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7818360328674316
Epoch: 29, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7434203624725342
Epoch: 30, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 2.104490280151367
Epoch: 31, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 32 cost time: 1.916769027709961
Epoch: 32, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.181 Vali Acc: 0.959 Test Loss: 0.181 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1343324184417725
Epoch: 33, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.167874813079834
Epoch: 34, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9411909580230713
Epoch: 35, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 36 cost time: 2.0827796459198
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.965113878250122
Epoch: 37, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4835114479064941
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6230833530426025
Epoch: 39, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 40 cost time: 1.5655291080474854
Epoch: 40, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.941896677017212
Epoch: 41, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.000986099243164
Epoch: 42, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.1668412685394287
Epoch: 43, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.0101523399353027
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.2429215908050537
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.31484317779541
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.5334455966949463
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 48 cost time: 1.8212594985961914
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.6494569778442383
Epoch: 49, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 50 cost time: 1.3628811836242676
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.9796035289764404
Epoch: 51, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 2.0042145252227783
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 53 cost time: 2.023569345474243
Epoch: 53, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.826263189315796
Epoch: 54, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 2.0391955375671387
Epoch: 55, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 2.042175531387329
Epoch: 56, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.778167486190796
Epoch: 57, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 2.1039645671844482
Epoch: 58, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.799778938293457
Epoch: 59, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.8725917339324951
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 61 cost time: 1.724841594696045
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 2.0187392234802246
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.8210902214050293
Epoch: 63, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.911698341369629
Epoch: 64, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.9623463153839111
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.8767807483673096
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 67 cost time: 2.0551605224609375
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.8039758205413818
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 2.0432028770446777
Epoch: 69, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 2.000364303588867
Epoch: 70, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.931255578994751
Epoch: 71, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 72 cost time: 1.9590306282043457
Epoch: 72, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.8582170009613037
Epoch: 73, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 74 cost time: 1.9881339073181152
Epoch: 74, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.8118171691894531
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.9720008373260498
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 1.7107701301574707
Epoch: 77, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.9122302532196045
Epoch: 78, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 2.2322638034820557
Epoch: 79, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 80 cost time: 1.775813341140747
Epoch: 80, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.9631872177124023
Epoch: 81, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 1.9630584716796875
Epoch: 82, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 1.5843429565429688
Epoch: 83, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 1.5916485786437988
Epoch: 84, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 1.6079001426696777
Epoch: 85, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 2.129110813140869
Epoch: 86, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.9773485660552979
Epoch: 87, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 1.9103031158447266
Epoch: 88, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 1.9757542610168457
Epoch: 89, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 24105
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.186803817749023
Epoch: 1, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.174 Vali Acc: 0.068 Test Loss: 2.174 Test Acc: 0.068
Validation loss decreased (inf --> -0.067546).  Saving model ...
Epoch: 2 cost time: 1.5617201328277588
Epoch: 2, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.056 Vali Acc: 0.222 Test Loss: 2.056 Test Acc: 0.222
Validation loss decreased (-0.067546 --> -0.221601).  Saving model ...
Epoch: 3 cost time: 1.8052220344543457
Epoch: 3, Steps: 17 | Train Loss: 2.008 Vali Loss: 1.920 Vali Acc: 0.416 Test Loss: 1.920 Test Acc: 0.416
Validation loss decreased (-0.221601 --> -0.416197).  Saving model ...
Epoch: 4 cost time: 1.437293291091919
Epoch: 4, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.770 Vali Acc: 0.568 Test Loss: 1.770 Test Acc: 0.568
Validation loss decreased (-0.416197 --> -0.567550).  Saving model ...
Epoch: 5 cost time: 1.772413969039917
Epoch: 5, Steps: 17 | Train Loss: 1.668 Vali Loss: 1.608 Vali Acc: 0.695 Test Loss: 1.608 Test Acc: 0.695
Validation loss decreased (-0.567550 --> -0.694579).  Saving model ...
Epoch: 6 cost time: 1.8449180126190186
Epoch: 6, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.451 Vali Acc: 0.781 Test Loss: 1.451 Test Acc: 0.781
Validation loss decreased (-0.694579 --> -0.781067).  Saving model ...
Epoch: 7 cost time: 1.8533275127410889
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.279 Vali Acc: 0.814 Test Loss: 1.279 Test Acc: 0.814
Validation loss decreased (-0.781067 --> -0.813501).  Saving model ...
Epoch: 8 cost time: 1.7120230197906494
Epoch: 8, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.128 Vali Acc: 0.838 Test Loss: 1.128 Test Acc: 0.838
Validation loss decreased (-0.813501 --> -0.837827).  Saving model ...
Epoch: 9 cost time: 1.9111597537994385
Epoch: 9, Steps: 17 | Train Loss: 1.043 Vali Loss: 0.989 Vali Acc: 0.854 Test Loss: 0.989 Test Acc: 0.854
Validation loss decreased (-0.837827 --> -0.854044).  Saving model ...
Epoch: 10 cost time: 1.6038320064544678
Epoch: 10, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.874 Vali Acc: 0.862 Test Loss: 0.874 Test Acc: 0.862
Validation loss decreased (-0.854044 --> -0.862153).  Saving model ...
Epoch: 11 cost time: 1.869643211364746
Epoch: 11, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.766 Vali Acc: 0.876 Test Loss: 0.766 Test Acc: 0.876
Validation loss decreased (-0.862153 --> -0.875668).  Saving model ...
Epoch: 12 cost time: 1.7399330139160156
Epoch: 12, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.677 Vali Acc: 0.884 Test Loss: 0.677 Test Acc: 0.884
Validation loss decreased (-0.875668 --> -0.883777).  Saving model ...
Epoch: 13 cost time: 1.7976818084716797
Epoch: 13, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.610 Vali Acc: 0.881 Test Loss: 0.610 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.936004400253296
Epoch: 14, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.546 Vali Acc: 0.889 Test Loss: 0.546 Test Acc: 0.889
Validation loss decreased (-0.883777 --> -0.889184).  Saving model ...
Epoch: 15 cost time: 1.598417043685913
Epoch: 15, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.484 Vali Acc: 0.914 Test Loss: 0.484 Test Acc: 0.914
Validation loss decreased (-0.889184 --> -0.913509).  Saving model ...
Epoch: 16 cost time: 1.6382129192352295
Epoch: 16, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9782464504241943
Epoch: 17, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.415 Vali Acc: 0.919 Test Loss: 0.415 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 18 cost time: 1.7524125576019287
Epoch: 18, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.374 Vali Acc: 0.919 Test Loss: 0.374 Test Acc: 0.919
Validation loss decreased (-0.918915 --> -0.918915).  Saving model ...
Epoch: 19 cost time: 1.9422228336334229
Epoch: 19, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
Validation loss decreased (-0.918915 --> -0.921618).  Saving model ...
Epoch: 20 cost time: 1.9165141582489014
Epoch: 20, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.326 Vali Acc: 0.927 Test Loss: 0.326 Test Acc: 0.927
Validation loss decreased (-0.921618 --> -0.927024).  Saving model ...
Epoch: 21 cost time: 1.825892448425293
Epoch: 21, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.302 Vali Acc: 0.932 Test Loss: 0.302 Test Acc: 0.932
Validation loss decreased (-0.927024 --> -0.932429).  Saving model ...
Epoch: 22 cost time: 2.0977635383605957
Epoch: 22, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.282 Vali Acc: 0.932 Test Loss: 0.282 Test Acc: 0.932
Validation loss decreased (-0.932429 --> -0.932430).  Saving model ...
Epoch: 23 cost time: 1.6329915523529053
Epoch: 23, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 24 cost time: 1.8447179794311523
Epoch: 24, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940538).  Saving model ...
Epoch: 25 cost time: 1.6145455837249756
Epoch: 25, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 26 cost time: 1.448291540145874
Epoch: 26, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.233 Vali Acc: 0.935 Test Loss: 0.233 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6715900897979736
Epoch: 27, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8656086921691895
Epoch: 28, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.906259298324585
Epoch: 29, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 30 cost time: 1.9602012634277344
Epoch: 30, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 31 cost time: 2.140227794647217
Epoch: 31, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 32 cost time: 2.2146389484405518
Epoch: 32, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 1.769162893295288
Epoch: 33, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.8679776191711426
Epoch: 34, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.829869031906128
Epoch: 35, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 36 cost time: 1.8435235023498535
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 37 cost time: 1.7876982688903809
Epoch: 37, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 38 cost time: 1.7084832191467285
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 1.8062007427215576
Epoch: 39, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 1.987478494644165
Epoch: 40, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.0304102897644043
Epoch: 41, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.8533689975738525
Epoch: 42, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 1.938187837600708
Epoch: 43, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.73299241065979
Epoch: 44, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.5567638874053955
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 2.022019624710083
Epoch: 46, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 1.946901559829712
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 1.5681262016296387
Epoch: 48, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.4951119422912598
Epoch: 49, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6002497673034668
Epoch: 50, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.861363410949707
Epoch: 51, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.9034311771392822
Epoch: 52, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 2.20609974861145
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.9081621170043945
Epoch: 54, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.6962659358978271
Epoch: 55, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 56 cost time: 1.6595373153686523
Epoch: 56, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5419189929962158
Epoch: 57, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 58 cost time: 1.9038069248199463
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.8072876930236816
Epoch: 59, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 60 cost time: 1.8175535202026367
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.8416082859039307
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.984250783920288
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.7634530067443848
Epoch: 63, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.920285940170288
Epoch: 64, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.6465153694152832
Epoch: 65, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.8971829414367676
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.8671526908874512
Epoch: 67, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.6664643287658691
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.6434755325317383
Epoch: 69, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 24105
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.632246494293213
Epoch: 1, Steps: 17 | Train Loss: 2.026 Vali Loss: 1.604 Vali Acc: 0.730 Test Loss: 1.604 Test Acc: 0.730
Validation loss decreased (inf --> -0.729714).  Saving model ...
Epoch: 2 cost time: 1.4724769592285156
Epoch: 2, Steps: 17 | Train Loss: 1.148 Vali Loss: 0.846 Vali Acc: 0.886 Test Loss: 0.846 Test Acc: 0.886
Validation loss decreased (-0.729714 --> -0.886478).  Saving model ...
Epoch: 3 cost time: 1.8185715675354004
Epoch: 3, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.472 Vali Acc: 0.922 Test Loss: 0.472 Test Acc: 0.922
Validation loss decreased (-0.886478 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 1.6079058647155762
Epoch: 4, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.284 Vali Acc: 0.943 Test Loss: 0.284 Test Acc: 0.943
Validation loss decreased (-0.921617 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.668386459350586
Epoch: 5, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.670269250869751
Epoch: 6, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.3578524589538574
Epoch: 7, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6125779151916504
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.6926326751708984
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4904890060424805
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.461460828781128
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4599812030792236
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4151792526245117
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.5212140083312988
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7470676898956299
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.4450550079345703
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.64082932472229
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6511776447296143
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.492152452468872
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4648449420928955
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.4723711013793945
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5865886211395264
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.313004493713379
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6606345176696777
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.4634451866149902
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.448564052581787
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.54777193069458
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4472768306732178
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.4063670635223389
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6793532371520996
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5475554466247559
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4380245208740234
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.686441421508789
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.665794849395752
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2792009
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1897637844085693
Epoch: 1, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.602 Vali Acc: 0.724 Test Loss: 1.602 Test Acc: 0.724
Validation loss decreased (inf --> -0.724308).  Saving model ...
Epoch: 2 cost time: 1.5597283840179443
Epoch: 2, Steps: 17 | Train Loss: 1.156 Vali Loss: 0.848 Vali Acc: 0.886 Test Loss: 0.848 Test Acc: 0.886
Validation loss decreased (-0.724308 --> -0.886478).  Saving model ...
Epoch: 3 cost time: 1.4783875942230225
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.477 Vali Acc: 0.916 Test Loss: 0.477 Test Acc: 0.916
Validation loss decreased (-0.886478 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.3327293395996094
Epoch: 4, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
Validation loss decreased (-0.916211 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.6303179264068604
Epoch: 5, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
Validation loss decreased (-0.940538 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.3738219738006592
Epoch: 6, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.6281814575195312
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6482839584350586
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.6013829708099365
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.511265516281128
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978377).  Saving model ...
Epoch: 11 cost time: 1.531301736831665
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6356995105743408
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4181900024414062
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6956934928894043
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6637847423553467
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.660583734512329
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3614938259124756
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5319702625274658
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8628597259521484
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5461652278900146
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 2792009
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7357969284057617
Epoch: 1, Steps: 17 | Train Loss: 2.015 Vali Loss: 1.610 Vali Acc: 0.754 Test Loss: 1.610 Test Acc: 0.754
Validation loss decreased (inf --> -0.754038).  Saving model ...
Epoch: 2 cost time: 1.481762409210205
Epoch: 2, Steps: 17 | Train Loss: 1.172 Vali Loss: 0.863 Vali Acc: 0.889 Test Loss: 0.863 Test Acc: 0.889
Validation loss decreased (-0.754038 --> -0.889181).  Saving model ...
Epoch: 3 cost time: 1.5199410915374756
Epoch: 3, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
Validation loss decreased (-0.889181 --> -0.921617).  Saving model ...
Epoch: 4 cost time: 1.2199323177337646
Epoch: 4, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.286 Vali Acc: 0.946 Test Loss: 0.286 Test Acc: 0.946
Validation loss decreased (-0.921617 --> -0.945943).  Saving model ...
Epoch: 5 cost time: 1.8839714527130127
Epoch: 5, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.9158496856689453
Epoch: 6, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.7369966506958008
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.802626609802246
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.4780690670013428
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9057433605194092
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.7077465057373047
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8178341388702393
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8315792083740234
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.753641128540039
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6316776275634766
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6511282920837402
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8701322078704834
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4452219009399414
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6031696796417236
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5813624858856201
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2792009
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8532493114471436
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.688 Vali Acc: 0.778 Test Loss: 1.688 Test Acc: 0.778
Validation loss decreased (inf --> -0.778362).  Saving model ...
Epoch: 2 cost time: 1.5640885829925537
Epoch: 2, Steps: 17 | Train Loss: 1.256 Vali Loss: 0.957 Vali Acc: 0.900 Test Loss: 0.957 Test Acc: 0.900
Validation loss decreased (-0.778362 --> -0.899990).  Saving model ...
Epoch: 3 cost time: 1.830000638961792
Epoch: 3, Steps: 17 | Train Loss: 0.639 Vali Loss: 0.537 Vali Acc: 0.916 Test Loss: 0.537 Test Acc: 0.916
Validation loss decreased (-0.899990 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.7419593334197998
Epoch: 4, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.313 Vali Acc: 0.946 Test Loss: 0.313 Test Acc: 0.946
Validation loss decreased (-0.916211 --> -0.945943).  Saving model ...
Epoch: 5 cost time: 1.6666004657745361
Epoch: 5, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.227 Vali Acc: 0.946 Test Loss: 0.227 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 6 cost time: 1.768423318862915
Epoch: 6, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.945944 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.6617863178253174
Epoch: 7, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7324533462524414
Epoch: 8, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.5690178871154785
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6548149585723877
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 11 cost time: 1.5221211910247803
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6099095344543457
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 13 cost time: 1.5812451839447021
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7431106567382812
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5584914684295654
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7491474151611328
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4994382858276367
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.670762300491333
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.682124137878418
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6341190338134766
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.576746940612793
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.388521432876587
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 2792009
model size : 20.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 4.101653575897217
Epoch: 1, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.543 Vali Acc: 0.751 Test Loss: 1.543 Test Acc: 0.751
Validation loss decreased (inf --> -0.751336).  Saving model ...
Epoch: 2 cost time: 1.7958669662475586
Epoch: 2, Steps: 17 | Train Loss: 1.122 Vali Loss: 0.842 Vali Acc: 0.865 Test Loss: 0.842 Test Acc: 0.865
Validation loss decreased (-0.751336 --> -0.864856).  Saving model ...
Epoch: 3 cost time: 1.8494317531585693
Epoch: 3, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.468 Vali Acc: 0.924 Test Loss: 0.468 Test Acc: 0.924
Validation loss decreased (-0.864856 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.5702769756317139
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.924320 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.5006358623504639
Epoch: 5, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.732287883758545
Epoch: 6, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.624577522277832
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.359431266784668
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.706756353378296
Epoch: 9, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.5893957614898682
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.770073652267456
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4870076179504395
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6373848915100098
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5522606372833252
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.595005750656128
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4101307392120361
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3826255798339844
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.403503179550171
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5613222122192383
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1743433
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8338253498077393
Epoch: 1, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.539 Vali Acc: 0.765 Test Loss: 1.539 Test Acc: 0.765
Validation loss decreased (inf --> -0.764849).  Saving model ...
Epoch: 2 cost time: 1.5890698432922363
Epoch: 2, Steps: 17 | Train Loss: 1.130 Vali Loss: 0.842 Vali Acc: 0.868 Test Loss: 0.842 Test Acc: 0.868
Validation loss decreased (-0.764849 --> -0.867559).  Saving model ...
Epoch: 3 cost time: 1.4976370334625244
Epoch: 3, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.467 Vali Acc: 0.924 Test Loss: 0.467 Test Acc: 0.924
Validation loss decreased (-0.867559 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.449547290802002
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.288 Vali Acc: 0.949 Test Loss: 0.288 Test Acc: 0.949
Validation loss decreased (-0.924320 --> -0.948646).  Saving model ...
Epoch: 5 cost time: 1.520819902420044
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.5921545028686523
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.622791051864624
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.6154119968414307
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.946 Test Loss: 0.150 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5550596714019775
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.576488733291626
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6842949390411377
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 12 cost time: 1.8137085437774658
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7398786544799805
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5854623317718506
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.694425344467163
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5226001739501953
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6720845699310303
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.765388011932373
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5876586437225342
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6864526271820068
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8605542182922363
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7151048183441162
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7980031967163086
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.7242653369903564
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1743433
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7569973468780518
Epoch: 1, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.559 Vali Acc: 0.778 Test Loss: 1.559 Test Acc: 0.778
Validation loss decreased (inf --> -0.778363).  Saving model ...
Epoch: 2 cost time: 1.7078015804290771
Epoch: 2, Steps: 17 | Train Loss: 1.150 Vali Loss: 0.857 Vali Acc: 0.884 Test Loss: 0.857 Test Acc: 0.884
Validation loss decreased (-0.778363 --> -0.883775).  Saving model ...
Epoch: 3 cost time: 1.6096160411834717
Epoch: 3, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.475 Vali Acc: 0.930 Test Loss: 0.475 Test Acc: 0.930
Validation loss decreased (-0.883775 --> -0.929725).  Saving model ...
Epoch: 4 cost time: 1.5032751560211182
Epoch: 4, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.291 Vali Acc: 0.943 Test Loss: 0.291 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.384103775024414
Epoch: 5, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.577925682067871
Epoch: 6, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6881742477416992
Epoch: 7, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.954052 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.6408696174621582
Epoch: 8, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.635918140411377
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975675).  Saving model ...
Epoch: 10 cost time: 1.6020514965057373
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7602107524871826
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3660547733306885
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6660735607147217
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7571818828582764
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.5796048641204834
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.551621913909912
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6386220455169678
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6689202785491943
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.430361032485962
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1743433
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.649942636489868
Epoch: 1, Steps: 17 | Train Loss: 1.999 Vali Loss: 1.639 Vali Acc: 0.795 Test Loss: 1.639 Test Acc: 0.795
Validation loss decreased (inf --> -0.794578).  Saving model ...
Epoch: 2 cost time: 1.5024514198303223
Epoch: 2, Steps: 17 | Train Loss: 1.237 Vali Loss: 0.949 Vali Acc: 0.886 Test Loss: 0.949 Test Acc: 0.886
Validation loss decreased (-0.794578 --> -0.886477).  Saving model ...
Epoch: 3 cost time: 1.363614797592163
Epoch: 3, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.529 Vali Acc: 0.916 Test Loss: 0.529 Test Acc: 0.916
Validation loss decreased (-0.886477 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.5778136253356934
Epoch: 4, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.325 Vali Acc: 0.935 Test Loss: 0.325 Test Acc: 0.935
Validation loss decreased (-0.916211 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.457491159439087
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.220 Vali Acc: 0.951 Test Loss: 0.220 Test Acc: 0.951
Validation loss decreased (-0.935132 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.5431649684906006
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.4222252368927002
Epoch: 7, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.3469536304473877
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3554246425628662
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.3325533866882324
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4854469299316406
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.4332470893859863
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.3080477714538574
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5687828063964844
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.56549072265625
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.615919828414917
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7223336696624756
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6429567337036133
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6204462051391602
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8111233711242676
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7265281677246094
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6901168823242188
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1743433
model size : 16.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2491660118103027
Epoch: 1, Steps: 17 | Train Loss: 2.102 Vali Loss: 1.690 Vali Acc: 0.649 Test Loss: 1.690 Test Acc: 0.649
Validation loss decreased (inf --> -0.648632).  Saving model ...
Epoch: 2 cost time: 1.581672191619873
Epoch: 2, Steps: 17 | Train Loss: 1.236 Vali Loss: 0.890 Vali Acc: 0.854 Test Loss: 0.890 Test Acc: 0.854
Validation loss decreased (-0.648632 --> -0.854045).  Saving model ...
Epoch: 3 cost time: 1.721625804901123
Epoch: 3, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.491 Vali Acc: 0.919 Test Loss: 0.491 Test Acc: 0.919
Validation loss decreased (-0.854045 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 1.7168166637420654
Epoch: 4, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.357 Vali Acc: 0.908 Test Loss: 0.357 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4686641693115234
Epoch: 5, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
Validation loss decreased (-0.918914 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.6951508522033691
Epoch: 6, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.48063325881958
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.7234981060028076
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6344795227050781
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.457932472229004
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5058419704437256
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6670122146606445
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.728654384613037
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.3528685569763184
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.5877864360809326
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6248910427093506
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.474433183670044
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.571284294128418
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.399498701095581
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 1.3694400787353516
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6750288009643555
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.60312819480896
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 1.479261875152588
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5783357620239258
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4420890808105469
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6167552471160889
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.545619010925293
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.324019432067871
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4387307167053223
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7005271911621094
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.46012544631958
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.576094388961792
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1219145
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.8020424842834473
Epoch: 1, Steps: 17 | Train Loss: 2.100 Vali Loss: 1.689 Vali Acc: 0.662 Test Loss: 1.689 Test Acc: 0.662
Validation loss decreased (inf --> -0.662145).  Saving model ...
Epoch: 2 cost time: 1.6657171249389648
Epoch: 2, Steps: 17 | Train Loss: 1.240 Vali Loss: 0.890 Vali Acc: 0.857 Test Loss: 0.890 Test Acc: 0.857
Validation loss decreased (-0.662145 --> -0.856748).  Saving model ...
Epoch: 3 cost time: 1.453787088394165
Epoch: 3, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.495 Vali Acc: 0.916 Test Loss: 0.495 Test Acc: 0.916
Validation loss decreased (-0.856748 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.5904695987701416
Epoch: 4, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918915).  Saving model ...
Epoch: 5 cost time: 1.5722970962524414
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.918915 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.3056254386901855
Epoch: 6, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.935 Test Loss: 0.208 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3176162242889404
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.951349 --> -0.972972).  Saving model ...
Epoch: 8 cost time: 1.2050402164459229
Epoch: 8, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.226288080215454
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4051759243011475
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4731392860412598
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3722963333129883
Epoch: 12, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.639707088470459
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.4962859153747559
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5327119827270508
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5462851524353027
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5419814586639404
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 1219145
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.648388147354126
Epoch: 1, Steps: 17 | Train Loss: 2.086 Vali Loss: 1.695 Vali Acc: 0.689 Test Loss: 1.695 Test Acc: 0.689
Validation loss decreased (inf --> -0.689172).  Saving model ...
Epoch: 2 cost time: 1.59309720993042
Epoch: 2, Steps: 17 | Train Loss: 1.245 Vali Loss: 0.902 Vali Acc: 0.870 Test Loss: 0.902 Test Acc: 0.870
Validation loss decreased (-0.689172 --> -0.870261).  Saving model ...
Epoch: 3 cost time: 1.3804049491882324
Epoch: 3, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.503 Vali Acc: 0.916 Test Loss: 0.503 Test Acc: 0.916
Validation loss decreased (-0.870261 --> -0.916211).  Saving model ...
Epoch: 4 cost time: 1.5650684833526611
Epoch: 4, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.356 Vali Acc: 0.916 Test Loss: 0.356 Test Acc: 0.916
Validation loss decreased (-0.916211 --> -0.916213).  Saving model ...
Epoch: 5 cost time: 1.6061887741088867
Epoch: 5, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
Validation loss decreased (-0.916213 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.6156086921691895
Epoch: 6, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5602436065673828
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.951349 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.5615606307983398
Epoch: 8, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7238116264343262
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 10 cost time: 1.6703295707702637
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5428745746612549
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 1.3639121055603027
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6039166450500488
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5170557498931885
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.566983938217163
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 16 cost time: 1.4142887592315674
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6341240406036377
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 18 cost time: 1.2702841758728027
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5609149932861328
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.329906702041626
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.515507698059082
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7764942646026611
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 23 cost time: 1.7488555908203125
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.3442957401275635
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5646798610687256
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5296788215637207
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.742238998413086
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.5312771797180176
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3886687755584717
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4914026260375977
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3794138431549072
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4045133590698242
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4800972938537598
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5042946338653564
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4852252006530762
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.433894157409668
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.962 Test Loss: 0.097 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3752195835113525
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4842429161071777
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.236743450164795
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.438018798828125
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.481123447418213
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5064020156860352
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3137378692626953
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.3392279148101807
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2357392311096191
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 1219145
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.244313955307007
Epoch: 1, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.738 Vali Acc: 0.700 Test Loss: 1.738 Test Acc: 0.700
Validation loss decreased (inf --> -0.699983).  Saving model ...
Epoch: 2 cost time: 1.5536861419677734
Epoch: 2, Steps: 17 | Train Loss: 1.294 Vali Loss: 0.978 Vali Acc: 0.876 Test Loss: 0.978 Test Acc: 0.876
Validation loss decreased (-0.699983 --> -0.875666).  Saving model ...
Epoch: 3 cost time: 1.5445919036865234
Epoch: 3, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.551 Vali Acc: 0.905 Test Loss: 0.551 Test Acc: 0.905
Validation loss decreased (-0.875666 --> -0.905400).  Saving model ...
Epoch: 4 cost time: 1.5871751308441162
Epoch: 4, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
Validation loss decreased (-0.905400 --> -0.918915).  Saving model ...
Epoch: 5 cost time: 1.5458922386169434
Epoch: 5, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.226 Vali Acc: 0.951 Test Loss: 0.226 Test Acc: 0.951
Validation loss decreased (-0.918915 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.234400987625122
Epoch: 6, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2688488960266113
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.951349 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.4058175086975098
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.505718469619751
Epoch: 9, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.4466402530670166
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7367117404937744
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 12 cost time: 1.5854613780975342
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7038238048553467
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4916362762451172
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 15 cost time: 1.7150065898895264
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.5238587856292725
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6109535694122314
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3678176403045654
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5931649208068848
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 20 cost time: 1.6087501049041748
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.434596061706543
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 1.5215909481048584
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 1.406766414642334
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.6227922439575195
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4825725555419922
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3632333278656006
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.357689380645752
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3571994304656982
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 29 cost time: 1.3352396488189697
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3980591297149658
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3526208400726318
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.538095474243164
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4102530479431152
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.317418098449707
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.2304797172546387
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.19663667678833
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.271047830581665
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.424147367477417
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1219145
model size : 14.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5515124797821045
Epoch: 1, Steps: 17 | Train Loss: 2.088 Vali Loss: 1.637 Vali Acc: 0.689 Test Loss: 1.637 Test Acc: 0.689
Validation loss decreased (inf --> -0.689173).  Saving model ...
Epoch: 2 cost time: 1.452153205871582
Epoch: 2, Steps: 17 | Train Loss: 1.199 Vali Loss: 0.833 Vali Acc: 0.876 Test Loss: 0.833 Test Acc: 0.876
Validation loss decreased (-0.689173 --> -0.875667).  Saving model ...
Epoch: 3 cost time: 1.4030630588531494
Epoch: 3, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.463 Vali Acc: 0.935 Test Loss: 0.463 Test Acc: 0.935
Validation loss decreased (-0.875667 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 1.397951364517212
Epoch: 4, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.299 Vali Acc: 0.938 Test Loss: 0.299 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.5695610046386719
Epoch: 5, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4536349773406982
Epoch: 6, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.345200538635254
Epoch: 7, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.951350 --> -0.959458).  Saving model ...
Epoch: 8 cost time: 1.2397282123565674
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 9 cost time: 1.5599522590637207
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.5908806324005127
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 11 cost time: 1.4004323482513428
Epoch: 11, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7365734577178955
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.448173999786377
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.325131893157959
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3759024143218994
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3863136768341064
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2876043319702148
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2246687412261963
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.3373637199401855
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4747984409332275
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.6521899700164795
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2871649265289307
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4652214050292969
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5309784412384033
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2962937355041504
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1707804203033447
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978378).  Saving model ...
Epoch: 27 cost time: 1.4369440078735352
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4007093906402588
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5384330749511719
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.537672996520996
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5463285446166992
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3586790561676025
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.4200286865234375
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5871367454528809
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.4358065128326416
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.435603380203247
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 957001
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.540544033050537
Epoch: 1, Steps: 17 | Train Loss: 2.080 Vali Loss: 1.638 Vali Acc: 0.681 Test Loss: 1.638 Test Acc: 0.681
Validation loss decreased (inf --> -0.681065).  Saving model ...
Epoch: 2 cost time: 1.4806675910949707
Epoch: 2, Steps: 17 | Train Loss: 1.200 Vali Loss: 0.834 Vali Acc: 0.884 Test Loss: 0.834 Test Acc: 0.884
Validation loss decreased (-0.681065 --> -0.883775).  Saving model ...
Epoch: 3 cost time: 1.2696425914764404
Epoch: 3, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.462 Vali Acc: 0.935 Test Loss: 0.462 Test Acc: 0.935
Validation loss decreased (-0.883775 --> -0.935131).  Saving model ...
Epoch: 4 cost time: 1.5752129554748535
Epoch: 4, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.308579921722412
Epoch: 5, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.540968656539917
Epoch: 6, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
Validation loss decreased (-0.940538 --> -0.954052).  Saving model ...
Epoch: 7 cost time: 1.390214204788208
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 8 cost time: 1.6083180904388428
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.954053 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.4852657318115234
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.3797543048858643
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.4057557582855225
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4308693408966064
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.2448365688323975
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.446821928024292
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3587143421173096
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5650372505187988
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.385202407836914
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4255552291870117
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.6038124561309814
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.466292381286621
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 1.6622092723846436
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3681135177612305
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6094229221343994
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6009905338287354
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5711250305175781
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6929049491882324
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 1.2882647514343262
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4835741519927979
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5347180366516113
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.532581090927124
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3818063735961914
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6066596508026123
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.5436508655548096
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6132783889770508
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.318007230758667
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.5098774433135986
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 957001
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4861855506896973
Epoch: 1, Steps: 17 | Train Loss: 2.083 Vali Loss: 1.654 Vali Acc: 0.684 Test Loss: 1.654 Test Acc: 0.684
Validation loss decreased (inf --> -0.683767).  Saving model ...
Epoch: 2 cost time: 1.6210646629333496
Epoch: 2, Steps: 17 | Train Loss: 1.220 Vali Loss: 0.851 Vali Acc: 0.892 Test Loss: 0.851 Test Acc: 0.892
Validation loss decreased (-0.683767 --> -0.891883).  Saving model ...
Epoch: 3 cost time: 1.3733224868774414
Epoch: 3, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.473 Vali Acc: 0.941 Test Loss: 0.473 Test Acc: 0.941
Validation loss decreased (-0.891883 --> -0.940536).  Saving model ...
Epoch: 4 cost time: 1.2599694728851318
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.299 Vali Acc: 0.938 Test Loss: 0.299 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3232431411743164
Epoch: 5, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.244 Vali Acc: 0.927 Test Loss: 0.244 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4583792686462402
Epoch: 6, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
Validation loss decreased (-0.940536 --> -0.951350).  Saving model ...
Epoch: 7 cost time: 1.4444997310638428
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 8 cost time: 1.4989380836486816
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 9 cost time: 1.3677401542663574
Epoch: 9, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.5048880577087402
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3194961547851562
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6667368412017822
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.5835449695587158
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3694195747375488
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3878679275512695
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4958229064941406
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4979312419891357
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4867165088653564
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4159905910491943
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4108531475067139
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5948317050933838
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6363787651062012
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4625740051269531
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5674450397491455
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 957001
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7567532062530518
Epoch: 1, Steps: 17 | Train Loss: 2.071 Vali Loss: 1.704 Vali Acc: 0.730 Test Loss: 1.704 Test Acc: 0.730
Validation loss decreased (inf --> -0.729713).  Saving model ...
Epoch: 2 cost time: 1.50655198097229
Epoch: 2, Steps: 17 | Train Loss: 1.289 Vali Loss: 0.933 Vali Acc: 0.895 Test Loss: 0.933 Test Acc: 0.895
Validation loss decreased (-0.729713 --> -0.894585).  Saving model ...
Epoch: 3 cost time: 1.6664867401123047
Epoch: 3, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.527 Vali Acc: 0.924 Test Loss: 0.527 Test Acc: 0.924
Validation loss decreased (-0.894585 --> -0.924319).  Saving model ...
Epoch: 4 cost time: 1.487147331237793
Epoch: 4, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.323 Vali Acc: 0.927 Test Loss: 0.323 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927024).  Saving model ...
Epoch: 5 cost time: 1.5919437408447266
Epoch: 5, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.256 Vali Acc: 0.927 Test Loss: 0.256 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927024).  Saving model ...
Epoch: 6 cost time: 1.6506671905517578
Epoch: 6, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
Validation loss decreased (-0.927024 --> -0.956755).  Saving model ...
Epoch: 7 cost time: 1.599074363708496
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 8 cost time: 1.6292505264282227
Epoch: 8, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 9 cost time: 1.508803129196167
Epoch: 9, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5045671463012695
Epoch: 10, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2920093536376953
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5465061664581299
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.6194875240325928
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4302546977996826
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.6527752876281738
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6159634590148926
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5476593971252441
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6911671161651611
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.4328248500823975
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5811166763305664
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 21 cost time: 1.4330730438232422
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.252490758895874
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1850097179412842
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 1.1788280010223389
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2819406986236572
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.551020860671997
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4312469959259033
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4422669410705566
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3421516418457031
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4494540691375732
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.542504072189331
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5025882720947266
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4366872310638428
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.328324317932129
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 1.4271636009216309
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.33656907081604
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5440962314605713
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5382015705108643
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4554834365844727
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.387465238571167
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.334890604019165
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6438267230987549
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4010181427001953
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.61979341506958
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 957001
model size : 13.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3925302028656006
Epoch: 1, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.583 Vali Acc: 0.670 Test Loss: 1.583 Test Acc: 0.670
Validation loss decreased (inf --> -0.670254).  Saving model ...
Epoch: 2 cost time: 1.4512441158294678
Epoch: 2, Steps: 17 | Train Loss: 1.154 Vali Loss: 0.855 Vali Acc: 0.870 Test Loss: 0.855 Test Acc: 0.870
Validation loss decreased (-0.670254 --> -0.870262).  Saving model ...
Epoch: 3 cost time: 1.525871992111206
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.493 Vali Acc: 0.908 Test Loss: 0.493 Test Acc: 0.908
Validation loss decreased (-0.870262 --> -0.908103).  Saving model ...
Epoch: 4 cost time: 1.4878158569335938
Epoch: 4, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.306 Vali Acc: 0.935 Test Loss: 0.306 Test Acc: 0.935
Validation loss decreased (-0.908103 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.4772040843963623
Epoch: 5, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.401233434677124
Epoch: 6, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 7 cost time: 1.51324462890625
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.180 Vali Acc: 0.943 Test Loss: 0.180 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4852879047393799
Epoch: 8, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.967566 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 1.268165111541748
Epoch: 9, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4278624057769775
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.273252010345459
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6606755256652832
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4639699459075928
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5691959857940674
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.636566162109375
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5229549407958984
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.440840244293213
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5249569416046143
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 825929
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5955567359924316
Epoch: 1, Steps: 17 | Train Loss: 1.959 Vali Loss: 1.583 Vali Acc: 0.684 Test Loss: 1.583 Test Acc: 0.684
Validation loss decreased (inf --> -0.683768).  Saving model ...
Epoch: 2 cost time: 1.2396514415740967
Epoch: 2, Steps: 17 | Train Loss: 1.161 Vali Loss: 0.857 Vali Acc: 0.870 Test Loss: 0.857 Test Acc: 0.870
Validation loss decreased (-0.683768 --> -0.870262).  Saving model ...
Epoch: 3 cost time: 1.5770690441131592
Epoch: 3, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.496 Vali Acc: 0.897 Test Loss: 0.496 Test Acc: 0.897
Validation loss decreased (-0.870262 --> -0.897292).  Saving model ...
Epoch: 4 cost time: 1.4646711349487305
Epoch: 4, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.308 Vali Acc: 0.938 Test Loss: 0.308 Test Acc: 0.938
Validation loss decreased (-0.897292 --> -0.937835).  Saving model ...
Epoch: 5 cost time: 1.442443609237671
Epoch: 5, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
Validation loss decreased (-0.937835 --> -0.951349).  Saving model ...
Epoch: 6 cost time: 1.5735204219818115
Epoch: 6, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
Validation loss decreased (-0.951349 --> -0.964863).  Saving model ...
Epoch: 7 cost time: 1.44099760055542
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.430589199066162
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
Validation loss decreased (-0.964863 --> -0.981080).  Saving model ...
Epoch: 9 cost time: 1.4129843711853027
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3557446002960205
Epoch: 10, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3479254245758057
Epoch: 11, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2472424507141113
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2158355712890625
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.320713996887207
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1796998977661133
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.357694387435913
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4606640338897705
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5477123260498047
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 825929
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.804124116897583
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.594 Vali Acc: 0.722 Test Loss: 1.594 Test Acc: 0.722
Validation loss decreased (inf --> -0.721606).  Saving model ...
Epoch: 2 cost time: 1.6711359024047852
Epoch: 2, Steps: 17 | Train Loss: 1.177 Vali Loss: 0.869 Vali Acc: 0.881 Test Loss: 0.869 Test Acc: 0.881
Validation loss decreased (-0.721606 --> -0.881072).  Saving model ...
Epoch: 3 cost time: 1.5985181331634521
Epoch: 3, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.501 Vali Acc: 0.905 Test Loss: 0.501 Test Acc: 0.905
Validation loss decreased (-0.881072 --> -0.905400).  Saving model ...
Epoch: 4 cost time: 1.634305477142334
Epoch: 4, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.310 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
Validation loss decreased (-0.905400 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.5680656433105469
Epoch: 5, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.6351237297058105
Epoch: 6, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 7 cost time: 1.4701991081237793
Epoch: 7, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.935 Test Loss: 0.173 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6917543411254883
Epoch: 8, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.962161 --> -0.975674).  Saving model ...
Epoch: 9 cost time: 1.6148254871368408
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5715229511260986
Epoch: 10, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4064915180206299
Epoch: 11, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.648242712020874
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.551124095916748
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.551586389541626
Epoch: 14, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4201650619506836
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4877314567565918
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.579477310180664
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.6779077053070068
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 825929
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.322946786880493
Epoch: 1, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.661 Vali Acc: 0.759 Test Loss: 1.661 Test Acc: 0.759
Validation loss decreased (inf --> -0.759443).  Saving model ...
Epoch: 2 cost time: 1.5001366138458252
Epoch: 2, Steps: 17 | Train Loss: 1.258 Vali Loss: 0.951 Vali Acc: 0.878 Test Loss: 0.951 Test Acc: 0.878
Validation loss decreased (-0.759443 --> -0.878369).  Saving model ...
Epoch: 3 cost time: 1.6733975410461426
Epoch: 3, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.542 Vali Acc: 0.897 Test Loss: 0.542 Test Acc: 0.897
Validation loss decreased (-0.878369 --> -0.897292).  Saving model ...
Epoch: 4 cost time: 1.6862156391143799
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.897292 --> -0.929726).  Saving model ...
Epoch: 5 cost time: 1.4921505451202393
Epoch: 5, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.929726 --> -0.954052).  Saving model ...
Epoch: 6 cost time: 1.521660327911377
Epoch: 6, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 7 cost time: 1.4985506534576416
Epoch: 7, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4118847846984863
Epoch: 8, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.962160 --> -0.975675).  Saving model ...
Epoch: 9 cost time: 1.2404718399047852
Epoch: 9, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2954440116882324
Epoch: 10, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6566498279571533
Epoch: 11, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3334167003631592
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4171583652496338
Epoch: 13, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5770020484924316
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5261569023132324
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4061172008514404
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2098350524902344
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3380255699157715
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 825929
model size : 12.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7229225635528564
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.581 Vali Acc: 0.719 Test Loss: 1.581 Test Acc: 0.719
Validation loss decreased (inf --> -0.718903).  Saving model ...
Epoch: 2 cost time: 1.3405842781066895
Epoch: 2, Steps: 17 | Train Loss: 1.133 Vali Loss: 0.833 Vali Acc: 0.876 Test Loss: 0.833 Test Acc: 0.876
Validation loss decreased (-0.718903 --> -0.875667).  Saving model ...
Epoch: 3 cost time: 1.409364938735962
Epoch: 3, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.449 Vali Acc: 0.924 Test Loss: 0.449 Test Acc: 0.924
Validation loss decreased (-0.875667 --> -0.924320).  Saving model ...
Epoch: 4 cost time: 1.341822862625122
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.301 Vali Acc: 0.943 Test Loss: 0.301 Test Acc: 0.943
Validation loss decreased (-0.924320 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.3349008560180664
Epoch: 5, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.3536968231201172
Epoch: 6, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3070344924926758
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.3764903545379639
Epoch: 8, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3662199974060059
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.967566 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.5535836219787598
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5310802459716797
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3191897869110107
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3637781143188477
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5116100311279297
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.602806806564331
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4542388916015625
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4627289772033691
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4575457572937012
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4902973175048828
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 760393
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.358858108520508
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.591 Vali Acc: 0.724 Test Loss: 1.591 Test Acc: 0.724
Validation loss decreased (inf --> -0.724308).  Saving model ...
Epoch: 2 cost time: 1.3043313026428223
Epoch: 2, Steps: 17 | Train Loss: 1.140 Vali Loss: 0.840 Vali Acc: 0.870 Test Loss: 0.840 Test Acc: 0.870
Validation loss decreased (-0.724308 --> -0.870262).  Saving model ...
Epoch: 3 cost time: 1.480879783630371
Epoch: 3, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.451 Vali Acc: 0.927 Test Loss: 0.451 Test Acc: 0.927
Validation loss decreased (-0.870262 --> -0.927023).  Saving model ...
Epoch: 4 cost time: 1.5459849834442139
Epoch: 4, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.927023 --> -0.940538).  Saving model ...
Epoch: 5 cost time: 1.6627025604248047
Epoch: 5, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.940538 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.632889986038208
Epoch: 6, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.186 Vali Acc: 0.932 Test Loss: 0.186 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.514331340789795
Epoch: 7, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.956755 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.376709222793579
Epoch: 8, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4257993698120117
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.4103832244873047
Epoch: 10, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.957 Test Loss: 0.122 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5035226345062256
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4236383438110352
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3955376148223877
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.478027105331421
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.606447458267212
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3339951038360596
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3445580005645752
Epoch: 17, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5388259887695312
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.379598617553711
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.965 Test Loss: 0.094 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 760393
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3178470134735107
Epoch: 1, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.614 Vali Acc: 0.741 Test Loss: 1.614 Test Acc: 0.741
Validation loss decreased (inf --> -0.740524).  Saving model ...
Epoch: 2 cost time: 1.445749282836914
Epoch: 2, Steps: 17 | Train Loss: 1.160 Vali Loss: 0.862 Vali Acc: 0.884 Test Loss: 0.862 Test Acc: 0.884
Validation loss decreased (-0.740524 --> -0.883775).  Saving model ...
Epoch: 3 cost time: 1.3385038375854492
Epoch: 3, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
Validation loss decreased (-0.883775 --> -0.918914).  Saving model ...
Epoch: 4 cost time: 1.403280258178711
Epoch: 4, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.305 Vali Acc: 0.935 Test Loss: 0.305 Test Acc: 0.935
Validation loss decreased (-0.918914 --> -0.935132).  Saving model ...
Epoch: 5 cost time: 1.4311327934265137
Epoch: 5, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
Validation loss decreased (-0.935132 --> -0.956755).  Saving model ...
Epoch: 6 cost time: 1.2545630931854248
Epoch: 6, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.489192008972168
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 8 cost time: 1.492156744003296
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.569120168685913
Epoch: 9, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 10 cost time: 1.452451467514038
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.428086280822754
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.35788893699646
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4500062465667725
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.527899980545044
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3794679641723633
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.352658987045288
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.370276689529419
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.483870267868042
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.482332706451416
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 760393
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4251480102539062
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.681 Vali Acc: 0.751 Test Loss: 1.681 Test Acc: 0.751
Validation loss decreased (inf --> -0.751335).  Saving model ...
Epoch: 2 cost time: 1.4740409851074219
Epoch: 2, Steps: 17 | Train Loss: 1.236 Vali Loss: 0.946 Vali Acc: 0.897 Test Loss: 0.946 Test Acc: 0.897
Validation loss decreased (-0.751335 --> -0.897288).  Saving model ...
Epoch: 3 cost time: 1.4177935123443604
Epoch: 3, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.524 Vali Acc: 0.911 Test Loss: 0.524 Test Acc: 0.911
Validation loss decreased (-0.897288 --> -0.910806).  Saving model ...
Epoch: 4 cost time: 1.329164743423462
Epoch: 4, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.316 Vali Acc: 0.943 Test Loss: 0.316 Test Acc: 0.943
Validation loss decreased (-0.910806 --> -0.943240).  Saving model ...
Epoch: 5 cost time: 1.261983871459961
Epoch: 5, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 6 cost time: 1.5535826683044434
Epoch: 6, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.187 Vali Acc: 0.946 Test Loss: 0.187 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3494153022766113
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.948646 --> -0.970269).  Saving model ...
Epoch: 8 cost time: 1.4090447425842285
Epoch: 8, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.330815076828003
Epoch: 9, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.970269 --> -0.978377).  Saving model ...
Epoch: 10 cost time: 1.373906135559082
Epoch: 10, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3729453086853027
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.321707010269165
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3971529006958008
Epoch: 13, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3710989952087402
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.45648193359375
Epoch: 15, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3827581405639648
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4479827880859375
Epoch: 17, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4646828174591064
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3959276676177979
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 760393
model size : 12.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7066755294799805
Epoch: 1, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.815 Vali Acc: 0.554 Test Loss: 1.815 Test Acc: 0.554
Validation loss decreased (inf --> -0.554036).  Saving model ...
Epoch: 2 cost time: 1.4165136814117432
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.288 Vali Acc: 0.792 Test Loss: 1.288 Test Acc: 0.792
Validation loss decreased (-0.554036 --> -0.791879).  Saving model ...
Epoch: 3 cost time: 1.2858331203460693
Epoch: 3, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.854 Vali Acc: 0.873 Test Loss: 0.854 Test Acc: 0.873
Validation loss decreased (-0.791879 --> -0.872964).  Saving model ...
Epoch: 4 cost time: 1.2502682209014893
Epoch: 4, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
Validation loss decreased (-0.872964 --> -0.910805).  Saving model ...
Epoch: 5 cost time: 1.3658177852630615
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.398 Vali Acc: 0.932 Test Loss: 0.398 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932428).  Saving model ...
Epoch: 6 cost time: 1.2390317916870117
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.296 Vali Acc: 0.957 Test Loss: 0.296 Test Acc: 0.957
Validation loss decreased (-0.932428 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.319575309753418
Epoch: 7, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.3298954963684082
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 9 cost time: 1.441880226135254
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 1.5016262531280518
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.4558546543121338
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.427511215209961
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.3937454223632812
Epoch: 13, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.471078872680664
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.470696210861206
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.279153823852539
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.301924705505371
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.3516266345977783
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1004912853240967
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4848828315734863
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2186803817749023
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.3624670505523682
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2695155143737793
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2364792823791504
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2798421382904053
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.301072120666504
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.391733169555664
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2781579494476318
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2538902759552002
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3702480792999268
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3457283973693848
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1264969
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.398439884185791
Epoch: 1, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.812 Vali Acc: 0.557 Test Loss: 1.812 Test Acc: 0.557
Validation loss decreased (inf --> -0.556739).  Saving model ...
Epoch: 2 cost time: 1.4991693496704102
Epoch: 2, Steps: 17 | Train Loss: 1.514 Vali Loss: 1.290 Vali Acc: 0.803 Test Loss: 1.290 Test Acc: 0.803
Validation loss decreased (-0.556739 --> -0.802690).  Saving model ...
Epoch: 3 cost time: 1.4309568405151367
Epoch: 3, Steps: 17 | Train Loss: 0.988 Vali Loss: 0.860 Vali Acc: 0.868 Test Loss: 0.860 Test Acc: 0.868
Validation loss decreased (-0.802690 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 1.4128718376159668
Epoch: 4, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.565 Vali Acc: 0.916 Test Loss: 0.565 Test Acc: 0.916
Validation loss decreased (-0.867559 --> -0.916211).  Saving model ...
Epoch: 5 cost time: 1.434955358505249
Epoch: 5, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.402 Vali Acc: 0.935 Test Loss: 0.402 Test Acc: 0.935
Validation loss decreased (-0.916211 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 1.3427166938781738
Epoch: 6, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.298 Vali Acc: 0.959 Test Loss: 0.298 Test Acc: 0.959
Validation loss decreased (-0.935131 --> -0.959456).  Saving model ...
Epoch: 7 cost time: 1.3617429733276367
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.38413405418396
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
Validation loss decreased (-0.959456 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 1.6973233222961426
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4464824199676514
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.4577629566192627
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4375073909759521
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.4280283451080322
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4259960651397705
Epoch: 14, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.537585735321045
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4219090938568115
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 1.3426480293273926
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.4500541687011719
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4678480625152588
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4636404514312744
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4135513305664062
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3706305027008057
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3157126903533936
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3638579845428467
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2743594646453857
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4385297298431396
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3908936977386475
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1264969
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.413830280303955
Epoch: 1, Steps: 17 | Train Loss: 2.036 Vali Loss: 1.819 Vali Acc: 0.573 Test Loss: 1.819 Test Acc: 0.573
Validation loss decreased (inf --> -0.572955).  Saving model ...
Epoch: 2 cost time: 1.2963805198669434
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.312 Vali Acc: 0.814 Test Loss: 1.312 Test Acc: 0.814
Validation loss decreased (-0.572955 --> -0.813500).  Saving model ...
Epoch: 3 cost time: 1.4110081195831299
Epoch: 3, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.881 Vali Acc: 0.881 Test Loss: 0.881 Test Acc: 0.881
Validation loss decreased (-0.813500 --> -0.881072).  Saving model ...
Epoch: 4 cost time: 1.3498508930206299
Epoch: 4, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.577 Vali Acc: 0.916 Test Loss: 0.577 Test Acc: 0.916
Validation loss decreased (-0.881072 --> -0.916210).  Saving model ...
Epoch: 5 cost time: 1.2655997276306152
Epoch: 5, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.411 Vali Acc: 0.935 Test Loss: 0.411 Test Acc: 0.935
Validation loss decreased (-0.916210 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 1.3069462776184082
Epoch: 6, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.301 Vali Acc: 0.954 Test Loss: 0.301 Test Acc: 0.954
Validation loss decreased (-0.935131 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 1.2312915325164795
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.315397024154663
Epoch: 8, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.954051 --> -0.970268).  Saving model ...
Epoch: 9 cost time: 1.0993235111236572
Epoch: 9, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1665058135986328
Epoch: 10, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.155991554260254
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3287413120269775
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.970268 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.3820555210113525
Epoch: 13, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4277193546295166
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 15 cost time: 1.3296840190887451
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.48569655418396
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4152674674987793
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3510408401489258
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3487350940704346
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4525423049926758
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.482874870300293
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4526333808898926
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4010374546051025
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3316404819488525
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 1264969
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4735615253448486
Epoch: 1, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.880 Vali Acc: 0.554 Test Loss: 1.880 Test Acc: 0.554
Validation loss decreased (inf --> -0.554035).  Saving model ...
Epoch: 2 cost time: 1.2541522979736328
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.416 Vali Acc: 0.830 Test Loss: 1.416 Test Acc: 0.830
Validation loss decreased (-0.554035 --> -0.829716).  Saving model ...
Epoch: 3 cost time: 1.5263092517852783
Epoch: 3, Steps: 17 | Train Loss: 1.101 Vali Loss: 0.982 Vali Acc: 0.886 Test Loss: 0.982 Test Acc: 0.886
Validation loss decreased (-0.829716 --> -0.886477).  Saving model ...
Epoch: 4 cost time: 1.6338036060333252
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.647 Vali Acc: 0.919 Test Loss: 0.647 Test Acc: 0.919
Validation loss decreased (-0.886477 --> -0.918912).  Saving model ...
Epoch: 5 cost time: 1.7091522216796875
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.458 Vali Acc: 0.941 Test Loss: 0.458 Test Acc: 0.941
Validation loss decreased (-0.918912 --> -0.940536).  Saving model ...
Epoch: 6 cost time: 1.749356746673584
Epoch: 6, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.327 Vali Acc: 0.943 Test Loss: 0.327 Test Acc: 0.943
Validation loss decreased (-0.940536 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 1.6698124408721924
Epoch: 7, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.269 Vali Acc: 0.946 Test Loss: 0.269 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 8 cost time: 1.6290857791900635
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
Validation loss decreased (-0.945943 --> -0.972971).  Saving model ...
Epoch: 9 cost time: 1.6145520210266113
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6295886039733887
Epoch: 10, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4629709720611572
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972971).  Saving model ...
Epoch: 12 cost time: 1.33854079246521
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1003553867340088
Epoch: 13, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.1657872200012207
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.4002580642700195
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5063207149505615
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4477827548980713
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.532250165939331
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7093029022216797
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6921067237854004
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6036789417266846
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5837275981903076
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7069556713104248
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5418846607208252
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 1264969
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4092044830322266
Epoch: 1, Steps: 17 | Train Loss: 2.116 Vali Loss: 1.827 Vali Acc: 0.562 Test Loss: 1.827 Test Acc: 0.562
Validation loss decreased (inf --> -0.562144).  Saving model ...
Epoch: 2 cost time: 1.2813806533813477
Epoch: 2, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.315 Vali Acc: 0.800 Test Loss: 1.315 Test Acc: 0.800
Validation loss decreased (-0.562144 --> -0.799987).  Saving model ...
Epoch: 3 cost time: 1.487551212310791
Epoch: 3, Steps: 17 | Train Loss: 1.005 Vali Loss: 0.858 Vali Acc: 0.870 Test Loss: 0.858 Test Acc: 0.870
Validation loss decreased (-0.799987 --> -0.870262).  Saving model ...
Epoch: 4 cost time: 1.3956048488616943
Epoch: 4, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.557 Vali Acc: 0.916 Test Loss: 0.557 Test Acc: 0.916
Validation loss decreased (-0.870262 --> -0.916211).  Saving model ...
Epoch: 5 cost time: 1.5457417964935303
Epoch: 5, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.397 Vali Acc: 0.943 Test Loss: 0.397 Test Acc: 0.943
Validation loss decreased (-0.916211 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.438504934310913
Epoch: 6, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.943239 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.0974366664886475
Epoch: 7, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.556666374206543
Epoch: 8, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 1.401059627532959
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 10 cost time: 1.5078716278076172
Epoch: 10, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.5156259536743164
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 12 cost time: 1.3132095336914062
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.275303840637207
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.2740318775177002
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.4397861957550049
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.4387147426605225
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.338318109512329
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.5761356353759766
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.6007862091064453
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5094656944274902
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6440293788909912
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 1.4890806674957275
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4010114669799805
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.4738845825195312
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3613057136535645
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3462121486663818
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4684033393859863
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 1.6745750904083252
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.645068883895874
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.4239394664764404
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6111295223236084
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4837300777435303
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4734609127044678
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.4162707328796387
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7133572101593018
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5387778282165527
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.522294521331787
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.491743564605713
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.6231975555419922
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3205249309539795
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.516998052597046
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.5947794914245605
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.6341235637664795
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.613724946975708
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.5542182922363281
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4016635417938232
Epoch: 46, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.140439510345459
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 740681
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5148122310638428
Epoch: 1, Steps: 17 | Train Loss: 2.122 Vali Loss: 1.830 Vali Acc: 0.570 Test Loss: 1.830 Test Acc: 0.570
Validation loss decreased (inf --> -0.570252).  Saving model ...
Epoch: 2 cost time: 1.3481721878051758
Epoch: 2, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.321 Vali Acc: 0.803 Test Loss: 1.321 Test Acc: 0.803
Validation loss decreased (-0.570252 --> -0.802689).  Saving model ...
Epoch: 3 cost time: 1.487529993057251
Epoch: 3, Steps: 17 | Train Loss: 1.015 Vali Loss: 0.863 Vali Acc: 0.876 Test Loss: 0.863 Test Acc: 0.876
Validation loss decreased (-0.802689 --> -0.875667).  Saving model ...
Epoch: 4 cost time: 1.5502092838287354
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.561 Vali Acc: 0.924 Test Loss: 0.561 Test Acc: 0.924
Validation loss decreased (-0.875667 --> -0.924319).  Saving model ...
Epoch: 5 cost time: 1.3626272678375244
Epoch: 5, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
Validation loss decreased (-0.924319 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 1.6170310974121094
Epoch: 6, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.279 Vali Acc: 0.957 Test Loss: 0.279 Test Acc: 0.957
Validation loss decreased (-0.945942 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.4729156494140625
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.250 Vali Acc: 0.946 Test Loss: 0.250 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5171382427215576
Epoch: 8, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.194 Vali Acc: 0.962 Test Loss: 0.194 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 1.4791011810302734
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.3802523612976074
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.486480951309204
Epoch: 11, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.5423569679260254
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.33549165725708
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4081659317016602
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.4812262058258057
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3687503337860107
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3290727138519287
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2201578617095947
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.430093765258789
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2974753379821777
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4899742603302002
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5706419944763184
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4288463592529297
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 1.6787350177764893
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5790514945983887
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2210087776184082
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4329192638397217
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5635590553283691
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.478804111480713
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.55401611328125
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6162705421447754
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3879776000976562
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.6398894786834717
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 740681
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.76949405670166
Epoch: 1, Steps: 17 | Train Loss: 2.128 Vali Loss: 1.846 Vali Acc: 0.576 Test Loss: 1.846 Test Acc: 0.576
Validation loss decreased (inf --> -0.575657).  Saving model ...
Epoch: 2 cost time: 1.3395233154296875
Epoch: 2, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.345 Vali Acc: 0.827 Test Loss: 1.345 Test Acc: 0.827
Validation loss decreased (-0.575657 --> -0.827014).  Saving model ...
Epoch: 3 cost time: 1.550569772720337
Epoch: 3, Steps: 17 | Train Loss: 1.044 Vali Loss: 0.888 Vali Acc: 0.868 Test Loss: 0.888 Test Acc: 0.868
Validation loss decreased (-0.827014 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 1.182882308959961
Epoch: 4, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.577 Vali Acc: 0.922 Test Loss: 0.577 Test Acc: 0.922
Validation loss decreased (-0.867559 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 1.281810998916626
Epoch: 5, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.411 Vali Acc: 0.946 Test Loss: 0.411 Test Acc: 0.946
Validation loss decreased (-0.921616 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 1.5107133388519287
Epoch: 6, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.287 Vali Acc: 0.959 Test Loss: 0.287 Test Acc: 0.959
Validation loss decreased (-0.945942 --> -0.959457).  Saving model ...
Epoch: 7 cost time: 1.4550673961639404
Epoch: 7, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1689651012420654
Epoch: 8, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.621147632598877
Epoch: 9, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 1.6439754962921143
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5529582500457764
Epoch: 11, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5222187042236328
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 13 cost time: 1.424739122390747
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.690932035446167
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.461632490158081
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.4594264030456543
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6287720203399658
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.542248010635376
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.4183158874511719
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3399062156677246
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.3881402015686035
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5392327308654785
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.638376235961914
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5106651782989502
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.5133953094482422
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4617018699645996
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3566792011260986
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2809054851531982
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3106493949890137
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2485988140106201
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.293874740600586
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.4234881401062012
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4813973903656006
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.5587012767791748
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3997535705566406
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6677136421203613
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3721544742584229
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.472519874572754
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.547295331954956
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7303962707519531
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6116971969604492
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6021728515625
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4342021942138672
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 740681
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5136237144470215
Epoch: 1, Steps: 17 | Train Loss: 2.108 Vali Loss: 1.882 Vali Acc: 0.584 Test Loss: 1.882 Test Acc: 0.584
Validation loss decreased (inf --> -0.583765).  Saving model ...
Epoch: 2 cost time: 1.425145149230957
Epoch: 2, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.431 Vali Acc: 0.846 Test Loss: 1.431 Test Acc: 0.846
Validation loss decreased (-0.583765 --> -0.845932).  Saving model ...
Epoch: 3 cost time: 1.4901890754699707
Epoch: 3, Steps: 17 | Train Loss: 1.134 Vali Loss: 0.984 Vali Acc: 0.895 Test Loss: 0.984 Test Acc: 0.895
Validation loss decreased (-0.845932 --> -0.894585).  Saving model ...
Epoch: 4 cost time: 1.3227088451385498
Epoch: 4, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.642 Vali Acc: 0.930 Test Loss: 0.642 Test Acc: 0.930
Validation loss decreased (-0.894585 --> -0.929723).  Saving model ...
Epoch: 5 cost time: 1.5390362739562988
Epoch: 5, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.452 Vali Acc: 0.938 Test Loss: 0.452 Test Acc: 0.938
Validation loss decreased (-0.929723 --> -0.937833).  Saving model ...
Epoch: 6 cost time: 1.6397392749786377
Epoch: 6, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.314 Vali Acc: 0.959 Test Loss: 0.314 Test Acc: 0.959
Validation loss decreased (-0.937833 --> -0.959456).  Saving model ...
Epoch: 7 cost time: 1.5577363967895508
Epoch: 7, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4512593746185303
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.959456 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.2398545742034912
Epoch: 9, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.263077974319458
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5147700309753418
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4599182605743408
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.563697338104248
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4723122119903564
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5221331119537354
Epoch: 15, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.401451826095581
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4281291961669922
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4823639392852783
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4005534648895264
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3600893020629883
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.573826789855957
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5613927841186523
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 740681
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5162246227264404
Epoch: 1, Steps: 17 | Train Loss: 2.141 Vali Loss: 1.859 Vali Acc: 0.516 Test Loss: 1.859 Test Acc: 0.516
Validation loss decreased (inf --> -0.516198).  Saving model ...
Epoch: 2 cost time: 1.47127103805542
Epoch: 2, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.296 Vali Acc: 0.803 Test Loss: 1.296 Test Acc: 0.803
Validation loss decreased (-0.516198 --> -0.802690).  Saving model ...
Epoch: 3 cost time: 1.420797348022461
Epoch: 3, Steps: 17 | Train Loss: 1.019 Vali Loss: 0.854 Vali Acc: 0.870 Test Loss: 0.854 Test Acc: 0.870
Validation loss decreased (-0.802690 --> -0.870262).  Saving model ...
Epoch: 4 cost time: 1.4184412956237793
Epoch: 4, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.575 Vali Acc: 0.903 Test Loss: 0.575 Test Acc: 0.903
Validation loss decreased (-0.870262 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 1.1982409954071045
Epoch: 5, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.404 Vali Acc: 0.927 Test Loss: 0.404 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 1.2374439239501953
Epoch: 6, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.302 Vali Acc: 0.946 Test Loss: 0.302 Test Acc: 0.946
Validation loss decreased (-0.927023 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 1.5883309841156006
Epoch: 7, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
Validation loss decreased (-0.945943 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.5021378993988037
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 1.413264513015747
Epoch: 9, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5821433067321777
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.2950100898742676
Epoch: 11, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 12 cost time: 1.3783156871795654
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6775989532470703
Epoch: 13, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.509251356124878
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4405512809753418
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.6446893215179443
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4580726623535156
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 18 cost time: 1.6535375118255615
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.626685380935669
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.484032154083252
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7444732189178467
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.6806304454803467
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.862318754196167
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5116088390350342
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.4580187797546387
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.728179693222046
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7098405361175537
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.564182996749878
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8750431537628174
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.672605276107788
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6213476657867432
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8569092750549316
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 1.5871095657348633
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6683142185211182
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6457254886627197
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6998775005340576
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6707267761230469
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3272039890289307
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4606657028198242
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.4485127925872803
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.279710054397583
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7033724784851074
Epoch: 42, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.688957929611206
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5662641525268555
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.593951940536499
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.4828033447265625
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6318514347076416
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.708578109741211
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.5919818878173828
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.5905883312225342
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 478537
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.770514726638794
Epoch: 1, Steps: 17 | Train Loss: 2.140 Vali Loss: 1.859 Vali Acc: 0.535 Test Loss: 1.859 Test Acc: 0.535
Validation loss decreased (inf --> -0.535117).  Saving model ...
Epoch: 2 cost time: 1.479555606842041
Epoch: 2, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.297 Vali Acc: 0.797 Test Loss: 1.297 Test Acc: 0.797
Validation loss decreased (-0.535117 --> -0.797284).  Saving model ...
Epoch: 3 cost time: 1.4590866565704346
Epoch: 3, Steps: 17 | Train Loss: 1.030 Vali Loss: 0.855 Vali Acc: 0.868 Test Loss: 0.855 Test Acc: 0.868
Validation loss decreased (-0.797284 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 1.4017460346221924
Epoch: 4, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.574 Vali Acc: 0.903 Test Loss: 0.574 Test Acc: 0.903
Validation loss decreased (-0.867559 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 1.6391136646270752
Epoch: 5, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.406 Vali Acc: 0.927 Test Loss: 0.406 Test Acc: 0.927
Validation loss decreased (-0.902697 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 1.7444469928741455
Epoch: 6, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
Validation loss decreased (-0.927023 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 1.3259203433990479
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.408818244934082
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.4311697483062744
Epoch: 9, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 10 cost time: 1.5132677555084229
Epoch: 10, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6945476531982422
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 12 cost time: 1.6504859924316406
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4393765926361084
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.443472146987915
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2416274547576904
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.4781098365783691
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.352022409439087
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 18 cost time: 1.4731025695800781
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5120606422424316
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.508256196975708
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3181309700012207
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3965578079223633
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4743218421936035
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5823254585266113
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.48740553855896
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6140244007110596
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5324656963348389
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 478537
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.7775344848632812
Epoch: 1, Steps: 17 | Train Loss: 2.133 Vali Loss: 1.867 Vali Acc: 0.546 Test Loss: 1.867 Test Acc: 0.546
Validation loss decreased (inf --> -0.545927).  Saving model ...
Epoch: 2 cost time: 1.428830623626709
Epoch: 2, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.316 Vali Acc: 0.805 Test Loss: 1.316 Test Acc: 0.805
Validation loss decreased (-0.545927 --> -0.805392).  Saving model ...
Epoch: 3 cost time: 1.5435914993286133
Epoch: 3, Steps: 17 | Train Loss: 1.048 Vali Loss: 0.873 Vali Acc: 0.878 Test Loss: 0.873 Test Acc: 0.878
Validation loss decreased (-0.805392 --> -0.878370).  Saving model ...
Epoch: 4 cost time: 1.3826801776885986
Epoch: 4, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.588 Vali Acc: 0.908 Test Loss: 0.588 Test Acc: 0.908
Validation loss decreased (-0.878370 --> -0.908102).  Saving model ...
Epoch: 5 cost time: 1.4737398624420166
Epoch: 5, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.415 Vali Acc: 0.927 Test Loss: 0.415 Test Acc: 0.927
Validation loss decreased (-0.908102 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 1.4227473735809326
Epoch: 6, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.307 Vali Acc: 0.957 Test Loss: 0.307 Test Acc: 0.957
Validation loss decreased (-0.927023 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.5602209568023682
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.4467885494232178
Epoch: 8, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.333622694015503
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 1.317946434020996
Epoch: 10, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6146972179412842
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4237065315246582
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4781928062438965
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.957 Test Loss: 0.130 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.5925796031951904
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.342050313949585
Epoch: 15, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.538604974746704
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3256235122680664
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.4116649627685547
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4877772331237793
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.260091781616211
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.53122878074646
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.4528193473815918
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5538249015808105
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6402256488800049
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.4947481155395508
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3358869552612305
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.153167724609375
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1494169235229492
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.447510004043579
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.3815538883209229
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4910767078399658
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3027665615081787
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5849847793579102
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.437408447265625
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5868988037109375
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.6359107494354248
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5700304508209229
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6284420490264893
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.771604299545288
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 478537
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6381497383117676
Epoch: 1, Steps: 17 | Train Loss: 2.141 Vali Loss: 1.922 Vali Acc: 0.549 Test Loss: 1.922 Test Acc: 0.549
Validation loss decreased (inf --> -0.548629).  Saving model ...
Epoch: 2 cost time: 1.4647104740142822
Epoch: 2, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.421 Vali Acc: 0.832 Test Loss: 1.421 Test Acc: 0.832
Validation loss decreased (-0.548629 --> -0.832418).  Saving model ...
Epoch: 3 cost time: 1.534595251083374
Epoch: 3, Steps: 17 | Train Loss: 1.139 Vali Loss: 0.969 Vali Acc: 0.884 Test Loss: 0.969 Test Acc: 0.884
Validation loss decreased (-0.832418 --> -0.883774).  Saving model ...
Epoch: 4 cost time: 1.573256015777588
Epoch: 4, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.659 Vali Acc: 0.911 Test Loss: 0.659 Test Acc: 0.911
Validation loss decreased (-0.883774 --> -0.910804).  Saving model ...
Epoch: 5 cost time: 1.3800699710845947
Epoch: 5, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.456 Vali Acc: 0.930 Test Loss: 0.456 Test Acc: 0.930
Validation loss decreased (-0.910804 --> -0.929725).  Saving model ...
Epoch: 6 cost time: 1.4258332252502441
Epoch: 6, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.331 Vali Acc: 0.943 Test Loss: 0.331 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943240).  Saving model ...
Epoch: 7 cost time: 1.2266497611999512
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.265 Vali Acc: 0.959 Test Loss: 0.265 Test Acc: 0.959
Validation loss decreased (-0.943240 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.3925104141235352
Epoch: 8, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5999348163604736
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 1.5166540145874023
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.166 Vali Acc: 0.968 Test Loss: 0.166 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.4327878952026367
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.4144108295440674
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.5320789813995361
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.575488805770874
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4708423614501953
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5761351585388184
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5241663455963135
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 1.5416297912597656
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3147327899932861
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2634780406951904
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2794392108917236
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2394697666168213
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 1.2824351787567139
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.346247911453247
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.424231767654419
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5971136093139648
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5314056873321533
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 1.510521411895752
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6110801696777344
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4707574844360352
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4990229606628418
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6032586097717285
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.396942377090454
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.482025146484375
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.432995319366455
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6352674961090088
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6477560997009277
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.6596486568450928
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.535588264465332
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3120031356811523
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2489533424377441
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.418527364730835
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.363929271697998
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5433635711669922
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 45 cost time: 1.4833660125732422
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.584007978439331
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7110192775726318
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.541813850402832
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.697847843170166
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.6123385429382324
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.618969440460205
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.4676952362060547
Epoch: 52, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.4771678447723389
Epoch: 53, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.6326100826263428
Epoch: 54, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 478537
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.491859197616577
Epoch: 1, Steps: 17 | Train Loss: 2.145 Vali Loss: 1.900 Vali Acc: 0.500 Test Loss: 1.900 Test Acc: 0.500
Validation loss decreased (inf --> -0.499981).  Saving model ...
Epoch: 2 cost time: 1.441080093383789
Epoch: 2, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.317 Vali Acc: 0.781 Test Loss: 1.317 Test Acc: 0.781
Validation loss decreased (-0.499981 --> -0.781068).  Saving model ...
Epoch: 3 cost time: 1.2932777404785156
Epoch: 3, Steps: 17 | Train Loss: 1.017 Vali Loss: 0.866 Vali Acc: 0.854 Test Loss: 0.866 Test Acc: 0.854
Validation loss decreased (-0.781068 --> -0.854045).  Saving model ...
Epoch: 4 cost time: 1.3573079109191895
Epoch: 4, Steps: 17 | Train Loss: 0.613 Vali Loss: 0.571 Vali Acc: 0.922 Test Loss: 0.571 Test Acc: 0.922
Validation loss decreased (-0.854045 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 1.5566611289978027
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.377 Vali Acc: 0.943 Test Loss: 0.377 Test Acc: 0.943
Validation loss decreased (-0.921616 --> -0.943239).  Saving model ...
Epoch: 6 cost time: 1.6104698181152344
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.287 Vali Acc: 0.954 Test Loss: 0.287 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 1.4691674709320068
Epoch: 7, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.615898847579956
Epoch: 8, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.194 Vali Acc: 0.951 Test Loss: 0.194 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4376275539398193
Epoch: 9, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.954052 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.6837821006774902
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5800964832305908
Epoch: 11, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.489548921585083
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.6656994819641113
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4859750270843506
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3199663162231445
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5308401584625244
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 17 cost time: 1.3032214641571045
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5964155197143555
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.5952982902526855
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.498600959777832
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.598658561706543
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.6446702480316162
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6259822845458984
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 24 cost time: 1.5026397705078125
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.576850414276123
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4579291343688965
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5194520950317383
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5085735321044922
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.541276216506958
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.601299524307251
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7353990077972412
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 32 cost time: 1.566941261291504
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6127007007598877
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.4696989059448242
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 1.5169665813446045
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4215946197509766
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6285178661346436
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4783496856689453
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6467955112457275
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4923796653747559
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4474093914031982
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 1.4552292823791504
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.535644292831421
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3731236457824707
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3349723815917969
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.369070053100586
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4535951614379883
Epoch: 47, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.6996564865112305
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.565551519393921
Epoch: 49, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.5369737148284912
Epoch: 50, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.6523103713989258
Epoch: 51, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 347465
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4148898124694824
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 1.906 Vali Acc: 0.492 Test Loss: 1.906 Test Acc: 0.492
Validation loss decreased (inf --> -0.491873).  Saving model ...
Epoch: 2 cost time: 1.558941125869751
Epoch: 2, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.323 Vali Acc: 0.789 Test Loss: 1.323 Test Acc: 0.789
Validation loss decreased (-0.491873 --> -0.789176).  Saving model ...
Epoch: 3 cost time: 1.486541509628296
Epoch: 3, Steps: 17 | Train Loss: 1.030 Vali Loss: 0.872 Vali Acc: 0.859 Test Loss: 0.872 Test Acc: 0.859
Validation loss decreased (-0.789176 --> -0.859451).  Saving model ...
Epoch: 4 cost time: 1.581322431564331
Epoch: 4, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.575 Vali Acc: 0.924 Test Loss: 0.575 Test Acc: 0.924
Validation loss decreased (-0.859451 --> -0.924319).  Saving model ...
Epoch: 5 cost time: 1.55080246925354
Epoch: 5, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.378 Vali Acc: 0.951 Test Loss: 0.378 Test Acc: 0.951
Validation loss decreased (-0.924319 --> -0.951348).  Saving model ...
Epoch: 6 cost time: 1.2930960655212402
Epoch: 6, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.289 Vali Acc: 0.951 Test Loss: 0.289 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 7 cost time: 1.4506680965423584
Epoch: 7, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.238 Vali Acc: 0.954 Test Loss: 0.238 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954052).  Saving model ...
Epoch: 8 cost time: 1.254650592803955
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.193 Vali Acc: 0.962 Test Loss: 0.193 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 9 cost time: 1.4778110980987549
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 10 cost time: 1.4264919757843018
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4612514972686768
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 12 cost time: 1.3371481895446777
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2562651634216309
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.3293213844299316
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5900344848632812
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4973278045654297
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 1.3993737697601318
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3031067848205566
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2703447341918945
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4438183307647705
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4351599216461182
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 22 cost time: 1.293511152267456
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3483257293701172
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4866523742675781
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3807740211486816
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.34749174118042
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3682866096496582
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 28 cost time: 1.3437235355377197
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.334737777709961
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5038893222808838
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3867623805999756
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.406395435333252
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4580106735229492
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5816106796264648
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5355157852172852
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.436141014099121
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5018186569213867
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 347465
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3523240089416504
Epoch: 1, Steps: 17 | Train Loss: 2.152 Vali Loss: 1.922 Vali Acc: 0.473 Test Loss: 1.922 Test Acc: 0.473
Validation loss decreased (inf --> -0.472954).  Saving model ...
Epoch: 2 cost time: 1.386657953262329
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.349 Vali Acc: 0.808 Test Loss: 1.349 Test Acc: 0.808
Validation loss decreased (-0.472954 --> -0.808095).  Saving model ...
Epoch: 3 cost time: 1.5941245555877686
Epoch: 3, Steps: 17 | Train Loss: 1.060 Vali Loss: 0.897 Vali Acc: 0.870 Test Loss: 0.897 Test Acc: 0.870
Validation loss decreased (-0.808095 --> -0.870261).  Saving model ...
Epoch: 4 cost time: 1.3764064311981201
Epoch: 4, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.593 Vali Acc: 0.922 Test Loss: 0.593 Test Acc: 0.922
Validation loss decreased (-0.870261 --> -0.921616).  Saving model ...
Epoch: 5 cost time: 1.364783763885498
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.392 Vali Acc: 0.949 Test Loss: 0.392 Test Acc: 0.949
Validation loss decreased (-0.921616 --> -0.948645).  Saving model ...
Epoch: 6 cost time: 1.4432008266448975
Epoch: 6, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.294 Vali Acc: 0.957 Test Loss: 0.294 Test Acc: 0.957
Validation loss decreased (-0.948645 --> -0.956754).  Saving model ...
Epoch: 7 cost time: 1.2383816242218018
Epoch: 7, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.246 Vali Acc: 0.951 Test Loss: 0.246 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.389340877532959
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.4734547138214111
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.6305217742919922
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.3856852054595947
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.3090076446533203
Epoch: 12, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.3769185543060303
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.3083572387695312
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.637364387512207
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.552537202835083
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 17 cost time: 1.4217188358306885
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.459047555923462
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4438107013702393
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6449353694915771
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6530587673187256
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 22 cost time: 1.5306031703948975
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4690134525299072
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5173423290252686
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5712928771972656
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3847641944885254
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4058668613433838
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.4244754314422607
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.576150894165039
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6142418384552002
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4877986907958984
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 347465
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4391586780548096
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 1.933 Vali Acc: 0.532 Test Loss: 1.933 Test Acc: 0.532
Validation loss decreased (inf --> -0.532413).  Saving model ...
Epoch: 2 cost time: 1.3272583484649658
Epoch: 2, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.430 Vali Acc: 0.846 Test Loss: 1.430 Test Acc: 0.846
Validation loss decreased (-0.532413 --> -0.845932).  Saving model ...
Epoch: 3 cost time: 1.1175928115844727
Epoch: 3, Steps: 17 | Train Loss: 1.131 Vali Loss: 0.983 Vali Acc: 0.881 Test Loss: 0.983 Test Acc: 0.881
Validation loss decreased (-0.845932 --> -0.881071).  Saving model ...
Epoch: 4 cost time: 1.2580926418304443
Epoch: 4, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.657 Vali Acc: 0.924 Test Loss: 0.657 Test Acc: 0.924
Validation loss decreased (-0.881071 --> -0.924318).  Saving model ...
Epoch: 5 cost time: 1.3897874355316162
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.432 Vali Acc: 0.946 Test Loss: 0.432 Test Acc: 0.946
Validation loss decreased (-0.924318 --> -0.945942).  Saving model ...
Epoch: 6 cost time: 1.507227897644043
Epoch: 6, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.326 Vali Acc: 0.946 Test Loss: 0.326 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 1.3059282302856445
Epoch: 7, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.4193925857543945
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.214 Vali Acc: 0.959 Test Loss: 0.214 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 9 cost time: 1.3752782344818115
Epoch: 9, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.959457 --> -0.970268).  Saving model ...
Epoch: 10 cost time: 1.4218263626098633
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.970268 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.3034634590148926
Epoch: 11, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.3302011489868164
Epoch: 12, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.175426721572876
Epoch: 13, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 14 cost time: 1.1722831726074219
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 15 cost time: 1.3713231086730957
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.486257791519165
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 17 cost time: 1.4349329471588135
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4784111976623535
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2538552284240723
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2547173500061035
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3865606784820557
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4159538745880127
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2086889743804932
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3001201152801514
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5903043746948242
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.3913345336914062
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 347465
model size : 6.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6023404598236084
Epoch: 1, Steps: 17 | Train Loss: 2.084 Vali Loss: 1.825 Vali Acc: 0.573 Test Loss: 1.825 Test Acc: 0.573
Validation loss decreased (inf --> -0.572955).  Saving model ...
Epoch: 2 cost time: 1.432995319366455
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.307 Vali Acc: 0.757 Test Loss: 1.307 Test Acc: 0.757
Validation loss decreased (-0.572955 --> -0.756744).  Saving model ...
Epoch: 3 cost time: 1.359959363937378
Epoch: 3, Steps: 17 | Train Loss: 1.005 Vali Loss: 0.855 Vali Acc: 0.881 Test Loss: 0.855 Test Acc: 0.881
Validation loss decreased (-0.756744 --> -0.881073).  Saving model ...
Epoch: 4 cost time: 1.3168010711669922
Epoch: 4, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.560 Vali Acc: 0.903 Test Loss: 0.560 Test Acc: 0.903
Validation loss decreased (-0.881073 --> -0.902697).  Saving model ...
Epoch: 5 cost time: 1.2832839488983154
Epoch: 5, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.902697 --> -0.940537).  Saving model ...
Epoch: 6 cost time: 1.3481097221374512
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 7 cost time: 1.5201468467712402
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.239 Vali Acc: 0.962 Test Loss: 0.239 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 8 cost time: 1.4488136768341064
Epoch: 8, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.207 Vali Acc: 0.949 Test Loss: 0.207 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5011684894561768
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.2335546016693115
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4250905513763428
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.449437141418457
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.26914644241333
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.5244126319885254
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3553109169006348
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.2560760974884033
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.350428581237793
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 18 cost time: 1.4684069156646729
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.54524827003479
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4687597751617432
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.5501956939697266
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4004480838775635
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 1.286468267440796
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4191739559173584
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4066298007965088
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3648710250854492
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4456262588500977
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5410122871398926
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.490830421447754
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.4934289455413818
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4188966751098633
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3785042762756348
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2906911373138428
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2767705917358398
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3617751598358154
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3721070289611816
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 1.3125948905944824
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3830337524414062
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.451507568359375
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4567208290100098
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4036946296691895
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4389574527740479
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.5072667598724365
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.282188892364502
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4001717567443848
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4585206508636475
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 281929
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6687633991241455
Epoch: 1, Steps: 17 | Train Loss: 2.076 Vali Loss: 1.826 Vali Acc: 0.570 Test Loss: 1.826 Test Acc: 0.570
Validation loss decreased (inf --> -0.570252).  Saving model ...
Epoch: 2 cost time: 1.3305432796478271
Epoch: 2, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.309 Vali Acc: 0.762 Test Loss: 1.309 Test Acc: 0.762
Validation loss decreased (-0.570252 --> -0.762149).  Saving model ...
Epoch: 3 cost time: 1.293116569519043
Epoch: 3, Steps: 17 | Train Loss: 1.016 Vali Loss: 0.859 Vali Acc: 0.881 Test Loss: 0.859 Test Acc: 0.881
Validation loss decreased (-0.762149 --> -0.881072).  Saving model ...
Epoch: 4 cost time: 1.228163719177246
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.563 Vali Acc: 0.905 Test Loss: 0.563 Test Acc: 0.905
Validation loss decreased (-0.881072 --> -0.905400).  Saving model ...
Epoch: 5 cost time: 1.340306043624878
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.401 Vali Acc: 0.938 Test Loss: 0.401 Test Acc: 0.938
Validation loss decreased (-0.905400 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 1.4306440353393555
Epoch: 6, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951349).  Saving model ...
Epoch: 7 cost time: 1.481663703918457
Epoch: 7, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.240 Vali Acc: 0.957 Test Loss: 0.240 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.4706673622131348
Epoch: 8, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1744332313537598
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
Validation loss decreased (-0.956754 --> -0.964863).  Saving model ...
Epoch: 10 cost time: 1.2890715599060059
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3855679035186768
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2485129833221436
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.391284704208374
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.386589527130127
Epoch: 14, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4850380420684814
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3723978996276855
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4092686176300049
Epoch: 17, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.346369743347168
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.423609972000122
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5087776184082031
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.3429396152496338
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1384987831115723
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.341148853302002
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2541024684906006
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.229311466217041
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2492890357971191
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4833197593688965
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.458045244216919
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3781867027282715
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 30 cost time: 1.5633111000061035
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5204968452453613
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3116984367370605
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5998034477233887
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3591525554656982
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4136154651641846
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4615168571472168
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 1.26100754737854
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.451345682144165
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5302391052246094
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6629409790039062
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.421494960784912
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4609298706054688
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4465136528015137
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3309450149536133
Epoch: 44, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3819403648376465
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4465808868408203
Epoch: 46, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 281929
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.460216522216797
Epoch: 1, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.843 Vali Acc: 0.589 Test Loss: 1.843 Test Acc: 0.589
Validation loss decreased (inf --> -0.589171).  Saving model ...
Epoch: 2 cost time: 1.3311643600463867
Epoch: 2, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.332 Vali Acc: 0.770 Test Loss: 1.332 Test Acc: 0.770
Validation loss decreased (-0.589171 --> -0.770257).  Saving model ...
Epoch: 3 cost time: 1.5009257793426514
Epoch: 3, Steps: 17 | Train Loss: 1.036 Vali Loss: 0.880 Vali Acc: 0.886 Test Loss: 0.880 Test Acc: 0.886
Validation loss decreased (-0.770257 --> -0.886478).  Saving model ...
Epoch: 4 cost time: 1.4274177551269531
Epoch: 4, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.886478 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 1.3961284160614014
Epoch: 5, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.409 Vali Acc: 0.938 Test Loss: 0.409 Test Acc: 0.938
Validation loss decreased (-0.899994 --> -0.937834).  Saving model ...
Epoch: 6 cost time: 1.5574791431427002
Epoch: 6, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.282 Vali Acc: 0.959 Test Loss: 0.282 Test Acc: 0.959
Validation loss decreased (-0.937834 --> -0.959457).  Saving model ...
Epoch: 7 cost time: 1.2680556774139404
Epoch: 7, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 8 cost time: 1.4036660194396973
Epoch: 8, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2037105560302734
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 10 cost time: 1.2296936511993408
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4011476039886475
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.3404929637908936
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 13 cost time: 1.3219764232635498
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 14 cost time: 1.352827787399292
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.333406925201416
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.286867380142212
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.38319730758667
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3920409679412842
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3345310688018799
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2934863567352295
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4801361560821533
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.390110969543457
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.236891508102417
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.579930067062378
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4181029796600342
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 281929
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4508931636810303
Epoch: 1, Steps: 17 | Train Loss: 2.076 Vali Loss: 1.885 Vali Acc: 0.592 Test Loss: 1.885 Test Acc: 0.592
Validation loss decreased (inf --> -0.591873).  Saving model ...
Epoch: 2 cost time: 1.1898963451385498
Epoch: 2, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.423 Vali Acc: 0.805 Test Loss: 1.423 Test Acc: 0.805
Validation loss decreased (-0.591873 --> -0.805391).  Saving model ...
Epoch: 3 cost time: 1.4907143115997314
Epoch: 3, Steps: 17 | Train Loss: 1.112 Vali Loss: 0.976 Vali Acc: 0.889 Test Loss: 0.976 Test Acc: 0.889
Validation loss decreased (-0.805391 --> -0.889179).  Saving model ...
Epoch: 4 cost time: 1.6106185913085938
Epoch: 4, Steps: 17 | Train Loss: 0.717 Vali Loss: 0.640 Vali Acc: 0.908 Test Loss: 0.640 Test Acc: 0.908
Validation loss decreased (-0.889179 --> -0.908102).  Saving model ...
Epoch: 5 cost time: 1.5477442741394043
Epoch: 5, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.453 Vali Acc: 0.930 Test Loss: 0.453 Test Acc: 0.930
Validation loss decreased (-0.908102 --> -0.929725).  Saving model ...
Epoch: 6 cost time: 1.4734132289886475
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.314 Vali Acc: 0.951 Test Loss: 0.314 Test Acc: 0.951
Validation loss decreased (-0.929725 --> -0.951348).  Saving model ...
Epoch: 7 cost time: 1.5337817668914795
Epoch: 7, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.261 Vali Acc: 0.957 Test Loss: 0.261 Test Acc: 0.957
Validation loss decreased (-0.951348 --> -0.956754).  Saving model ...
Epoch: 8 cost time: 1.3789129257202148
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2768287658691406
Epoch: 9, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
Validation loss decreased (-0.956754 --> -0.967566).  Saving model ...
Epoch: 10 cost time: 1.279602289199829
Epoch: 10, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.3543009757995605
Epoch: 11, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2457444667816162
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.258725881576538
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2770426273345947
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3412740230560303
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3763906955718994
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.334690809249878
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.425365686416626
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5964624881744385
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4307258129119873
Epoch: 20, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4979074001312256
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4450340270996094
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 281929
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.128176689147949
Epoch: 1, Steps: 17 | Train Loss: 2.198 Vali Loss: 1.894 Vali Acc: 0.481 Test Loss: 1.894 Test Acc: 0.481
Validation loss decreased (inf --> -0.481062).  Saving model ...
Epoch: 2 cost time: 1.3929543495178223
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.352 Vali Acc: 0.784 Test Loss: 1.352 Test Acc: 0.784
Validation loss decreased (-0.481062 --> -0.783770).  Saving model ...
Epoch: 3 cost time: 1.4377069473266602
Epoch: 3, Steps: 17 | Train Loss: 1.049 Vali Loss: 0.878 Vali Acc: 0.868 Test Loss: 0.878 Test Acc: 0.868
Validation loss decreased (-0.783770 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 1.4245069026947021
Epoch: 4, Steps: 17 | Train Loss: 0.657 Vali Loss: 0.600 Vali Acc: 0.895 Test Loss: 0.600 Test Acc: 0.895
Validation loss decreased (-0.867559 --> -0.894589).  Saving model ...
Epoch: 5 cost time: 1.354778528213501
Epoch: 5, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.414 Vali Acc: 0.927 Test Loss: 0.414 Test Acc: 0.927
Validation loss decreased (-0.894589 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 1.4464600086212158
Epoch: 6, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.300 Vali Acc: 0.951 Test Loss: 0.300 Test Acc: 0.951
Validation loss decreased (-0.927023 --> -0.951348).  Saving model ...
Epoch: 7 cost time: 1.51188325881958
Epoch: 7, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5875256061553955
Epoch: 8, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.4347331523895264
Epoch: 9, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.25537109375
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 11 cost time: 1.3504204750061035
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 12 cost time: 1.4538464546203613
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2748875617980957
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 14 cost time: 1.3992226123809814
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.964864 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3540544509887695
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 16 cost time: 1.376305341720581
Epoch: 16, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.568497896194458
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.533418893814087
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4982376098632812
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.455604076385498
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5172593593597412
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5351173877716064
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 23 cost time: 1.336832046508789
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2243821620941162
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.298853874206543
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1857070922851562
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4266948699951172
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5555524826049805
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3652000427246094
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.3894877433776855
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5873522758483887
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6869053840637207
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 249161
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.440307378768921
Epoch: 1, Steps: 17 | Train Loss: 2.197 Vali Loss: 1.895 Vali Acc: 0.478 Test Loss: 1.895 Test Acc: 0.478
Validation loss decreased (inf --> -0.478359).  Saving model ...
Epoch: 2 cost time: 1.431687831878662
Epoch: 2, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.356 Vali Acc: 0.773 Test Loss: 1.356 Test Acc: 0.773
Validation loss decreased (-0.478359 --> -0.772959).  Saving model ...
Epoch: 3 cost time: 1.3183531761169434
Epoch: 3, Steps: 17 | Train Loss: 1.060 Vali Loss: 0.883 Vali Acc: 0.868 Test Loss: 0.883 Test Acc: 0.868
Validation loss decreased (-0.772959 --> -0.867559).  Saving model ...
Epoch: 4 cost time: 1.350440263748169
Epoch: 4, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.606 Vali Acc: 0.897 Test Loss: 0.606 Test Acc: 0.897
Validation loss decreased (-0.867559 --> -0.897291).  Saving model ...
Epoch: 5 cost time: 1.3330297470092773
Epoch: 5, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.418 Vali Acc: 0.927 Test Loss: 0.418 Test Acc: 0.927
Validation loss decreased (-0.897291 --> -0.927023).  Saving model ...
Epoch: 6 cost time: 1.3330318927764893
Epoch: 6, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.302 Vali Acc: 0.949 Test Loss: 0.302 Test Acc: 0.949
Validation loss decreased (-0.927023 --> -0.948646).  Saving model ...
Epoch: 7 cost time: 1.4319915771484375
Epoch: 7, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.247 Vali Acc: 0.949 Test Loss: 0.247 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 8 cost time: 1.2710657119750977
Epoch: 8, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.948646 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.4643409252166748
Epoch: 9, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 10 cost time: 1.4270236492156982
Epoch: 10, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 11 cost time: 1.4998250007629395
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6695010662078857
Epoch: 12, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5882489681243896
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.445044994354248
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 15 cost time: 1.3367748260498047
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.482748031616211
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3128528594970703
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.374955177307129
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 19 cost time: 1.2764568328857422
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3632009029388428
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 21 cost time: 1.4158248901367188
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 22 cost time: 1.2478611469268799
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2174873352050781
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6899123191833496
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3416705131530762
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3443248271942139
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 1.297180414199829
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3190031051635742
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4561216831207275
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.372610092163086
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.469569444656372
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.231250524520874
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.429330825805664
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.3662440776824951
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5778279304504395
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4332513809204102
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3231959342956543
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4109694957733154
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.416322946548462
Epoch: 39, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2860107421875
Epoch: 40, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.4731183052062988
Epoch: 41, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4339747428894043
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3757600784301758
Epoch: 43, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 249161
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.512537956237793
Epoch: 1, Steps: 17 | Train Loss: 2.189 Vali Loss: 1.902 Vali Acc: 0.481 Test Loss: 1.902 Test Acc: 0.481
Validation loss decreased (inf --> -0.481062).  Saving model ...
Epoch: 2 cost time: 1.4596874713897705
Epoch: 2, Steps: 17 | Train Loss: 1.640 Vali Loss: 1.374 Vali Acc: 0.786 Test Loss: 1.374 Test Acc: 0.786
Validation loss decreased (-0.481062 --> -0.786473).  Saving model ...
Epoch: 3 cost time: 1.4387218952178955
Epoch: 3, Steps: 17 | Train Loss: 1.078 Vali Loss: 0.903 Vali Acc: 0.865 Test Loss: 0.903 Test Acc: 0.865
Validation loss decreased (-0.786473 --> -0.864856).  Saving model ...
Epoch: 4 cost time: 1.4642832279205322
Epoch: 4, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
Validation loss decreased (-0.864856 --> -0.899994).  Saving model ...
Epoch: 5 cost time: 1.4239883422851562
Epoch: 5, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.425 Vali Acc: 0.930 Test Loss: 0.425 Test Acc: 0.930
Validation loss decreased (-0.899994 --> -0.929725).  Saving model ...
Epoch: 6 cost time: 1.4420056343078613
Epoch: 6, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
Validation loss decreased (-0.929725 --> -0.951348).  Saving model ...
Epoch: 7 cost time: 1.4902076721191406
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 8 cost time: 1.4952256679534912
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.195 Vali Acc: 0.959 Test Loss: 0.195 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 9 cost time: 1.5155115127563477
Epoch: 9, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 10 cost time: 1.249197244644165
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 11 cost time: 1.367762565612793
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 12 cost time: 1.3247716426849365
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3230221271514893
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4490647315979004
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 15 cost time: 1.4152252674102783
Epoch: 15, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.400251865386963
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3301079273223877
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4162354469299316
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5101842880249023
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4441323280334473
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.366955280303955
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4101862907409668
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 23 cost time: 1.317272424697876
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.3880531787872314
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3083009719848633
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.30348539352417
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3204615116119385
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 1.2904179096221924
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3226780891418457
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4672095775604248
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.345353126525879
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3590006828308105
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.369600772857666
Epoch: 33, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2447919845581055
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4387357234954834
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4824821949005127
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2714219093322754
Epoch: 37, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 249161
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8660728931427
Epoch: 1, Steps: 17 | Train Loss: 2.170 Vali Loss: 1.947 Vali Acc: 0.508 Test Loss: 1.947 Test Acc: 0.508
Validation loss decreased (inf --> -0.508089).  Saving model ...
Epoch: 2 cost time: 1.2590126991271973
Epoch: 2, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.464 Vali Acc: 0.808 Test Loss: 1.464 Test Acc: 0.808
Validation loss decreased (-0.508089 --> -0.808093).  Saving model ...
Epoch: 3 cost time: 1.3844363689422607
Epoch: 3, Steps: 17 | Train Loss: 1.156 Vali Loss: 0.999 Vali Acc: 0.884 Test Loss: 0.999 Test Acc: 0.884
Validation loss decreased (-0.808093 --> -0.883774).  Saving model ...
Epoch: 4 cost time: 1.3473200798034668
Epoch: 4, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.682 Vali Acc: 0.905 Test Loss: 0.682 Test Acc: 0.905
Validation loss decreased (-0.883774 --> -0.905399).  Saving model ...
Epoch: 5 cost time: 1.362191915512085
Epoch: 5, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.463 Vali Acc: 0.935 Test Loss: 0.463 Test Acc: 0.935
Validation loss decreased (-0.905399 --> -0.935131).  Saving model ...
Epoch: 6 cost time: 1.2758944034576416
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.330 Vali Acc: 0.946 Test Loss: 0.330 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945943).  Saving model ...
Epoch: 7 cost time: 1.5453417301177979
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3223745822906494
Epoch: 8, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
Validation loss decreased (-0.945943 --> -0.967565).  Saving model ...
Epoch: 9 cost time: 1.3952784538269043
Epoch: 9, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.431934118270874
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.967565 --> -0.967566).  Saving model ...
Epoch: 11 cost time: 1.3033580780029297
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 12 cost time: 1.2702796459197998
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 13 cost time: 1.4020094871520996
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4532604217529297
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4472835063934326
Epoch: 15, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 16 cost time: 1.4400076866149902
Epoch: 16, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2823596000671387
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2876949310302734
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 19 cost time: 1.3119051456451416
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.429464340209961
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3236668109893799
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2846412658691406
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3167123794555664
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3360576629638672
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3712401390075684
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2556037902832031
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2807016372680664
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2894086837768555
Epoch: 28, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 249161
model size : 5.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5261268615722656
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.025 Vali Acc: 0.314 Test Loss: 2.025 Test Acc: 0.314
Validation loss decreased (inf --> -0.313493).  Saving model ...
Epoch: 2 cost time: 1.2367384433746338
Epoch: 2, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.692 Vali Acc: 0.711 Test Loss: 1.692 Test Acc: 0.711
Validation loss decreased (-0.313493 --> -0.710794).  Saving model ...
Epoch: 3 cost time: 1.1806762218475342
Epoch: 3, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.350 Vali Acc: 0.824 Test Loss: 1.350 Test Acc: 0.824
Validation loss decreased (-0.710794 --> -0.824311).  Saving model ...
Epoch: 4 cost time: 1.182518720626831
Epoch: 4, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.047 Vali Acc: 0.859 Test Loss: 1.047 Test Acc: 0.859
Validation loss decreased (-0.824311 --> -0.859449).  Saving model ...
Epoch: 5 cost time: 1.1889042854309082
Epoch: 5, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.779 Vali Acc: 0.897 Test Loss: 0.779 Test Acc: 0.897
Validation loss decreased (-0.859449 --> -0.897290).  Saving model ...
Epoch: 6 cost time: 1.191404104232788
Epoch: 6, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.611 Vali Acc: 0.916 Test Loss: 0.611 Test Acc: 0.916
Validation loss decreased (-0.897290 --> -0.916210).  Saving model ...
Epoch: 7 cost time: 1.348681926727295
Epoch: 7, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.489 Vali Acc: 0.930 Test Loss: 0.489 Test Acc: 0.930
Validation loss decreased (-0.916210 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.2689142227172852
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.385 Vali Acc: 0.943 Test Loss: 0.385 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943239).  Saving model ...
Epoch: 9 cost time: 1.1413557529449463
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.323 Vali Acc: 0.943 Test Loss: 0.323 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 1.1990993022918701
Epoch: 10, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.278 Vali Acc: 0.957 Test Loss: 0.278 Test Acc: 0.957
Validation loss decreased (-0.943240 --> -0.956754).  Saving model ...
Epoch: 11 cost time: 1.2137529850006104
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.259 Vali Acc: 0.954 Test Loss: 0.259 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4511008262634277
Epoch: 12, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 1.3817501068115234
Epoch: 13, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3800837993621826
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.184 Vali Acc: 0.965 Test Loss: 0.184 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 15 cost time: 1.2178397178649902
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 1.2542665004730225
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2475194931030273
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.2783119678497314
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1231486797332764
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.312650203704834
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.294447898864746
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.140702247619629
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2185277938842773
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3436052799224854
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3534390926361084
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 1.0420069694519043
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1281547546386719
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2081665992736816
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.166297435760498
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9068818092346191
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1664307117462158
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0747854709625244
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.132181167602539
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2555432319641113
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.385521411895752
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 599753
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.760869264602661
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.033 Vali Acc: 0.319 Test Loss: 2.033 Test Acc: 0.319
Validation loss decreased (inf --> -0.318899).  Saving model ...
Epoch: 2 cost time: 1.0880377292633057
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.702 Vali Acc: 0.719 Test Loss: 1.702 Test Acc: 0.719
Validation loss decreased (-0.318899 --> -0.718902).  Saving model ...
Epoch: 3 cost time: 0.9765617847442627
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.359 Vali Acc: 0.830 Test Loss: 1.359 Test Acc: 0.830
Validation loss decreased (-0.718902 --> -0.829716).  Saving model ...
Epoch: 4 cost time: 1.1580400466918945
Epoch: 4, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.057 Vali Acc: 0.859 Test Loss: 1.057 Test Acc: 0.859
Validation loss decreased (-0.829716 --> -0.859449).  Saving model ...
Epoch: 5 cost time: 1.1434974670410156
Epoch: 5, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.785 Vali Acc: 0.903 Test Loss: 0.785 Test Acc: 0.903
Validation loss decreased (-0.859449 --> -0.902695).  Saving model ...
Epoch: 6 cost time: 1.1633639335632324
Epoch: 6, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.616 Vali Acc: 0.922 Test Loss: 0.616 Test Acc: 0.922
Validation loss decreased (-0.902695 --> -0.921615).  Saving model ...
Epoch: 7 cost time: 1.3976819515228271
Epoch: 7, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.495 Vali Acc: 0.922 Test Loss: 0.495 Test Acc: 0.922
Validation loss decreased (-0.921615 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 1.3388700485229492
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.921617 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.3104248046875
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.323 Vali Acc: 0.943 Test Loss: 0.323 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 1.2821850776672363
Epoch: 10, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.280 Vali Acc: 0.954 Test Loss: 0.280 Test Acc: 0.954
Validation loss decreased (-0.943240 --> -0.954051).  Saving model ...
Epoch: 11 cost time: 1.4471166133880615
Epoch: 11, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.244985580444336
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.213 Vali Acc: 0.962 Test Loss: 0.213 Test Acc: 0.962
Validation loss decreased (-0.954051 --> -0.962160).  Saving model ...
Epoch: 13 cost time: 1.2703492641448975
Epoch: 13, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2311878204345703
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 15 cost time: 1.2785084247589111
Epoch: 15, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.173 Vali Acc: 0.968 Test Loss: 0.173 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 1.145817518234253
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2830829620361328
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.1070818901062012
Epoch: 18, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0989058017730713
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.1252338886260986
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1530325412750244
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 1.1922571659088135
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2284326553344727
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.367798089981079
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2650032043457031
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 1.2569892406463623
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3862063884735107
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2089946269989014
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.325758934020996
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2534806728363037
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1570191383361816
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2002203464508057
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2179338932037354
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3361616134643555
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3202235698699951
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 1.320197582244873
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1758885383605957
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2578861713409424
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1661841869354248
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 40 cost time: 1.1020915508270264
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1922311782836914
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.292295217514038
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2890233993530273
Epoch: 43, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1379175186157227
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0470836162567139
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2474141120910645
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1216042041778564
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1527211666107178
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4331188201904297
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 50 cost time: 1.2708196640014648
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.263227939605713
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.3145322799682617
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.349106788635254
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2555878162384033
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.1888401508331299
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.124800205230713
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.090430736541748
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.179384708404541
Epoch: 58, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.213071584701538
Epoch: 59, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 60 cost time: 1.223710536956787
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.157151699066162
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0718343257904053
Epoch: 62, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.3201448917388916
Epoch: 63, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.1508522033691406
Epoch: 64, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.182584524154663
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.2516124248504639
Epoch: 66, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.1754989624023438
Epoch: 67, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.355713129043579
Epoch: 68, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 1.3558056354522705
Epoch: 69, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 599753
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1357080936431885
Epoch: 1, Steps: 17 | Train Loss: 2.182 Vali Loss: 2.042 Vali Acc: 0.281 Test Loss: 2.042 Test Acc: 0.281
Validation loss decreased (inf --> -0.281061).  Saving model ...
Epoch: 2 cost time: 1.0957751274108887
Epoch: 2, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.722 Vali Acc: 0.716 Test Loss: 1.722 Test Acc: 0.716
Validation loss decreased (-0.281061 --> -0.716199).  Saving model ...
Epoch: 3 cost time: 1.065946340560913
Epoch: 3, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.387 Vali Acc: 0.827 Test Loss: 1.387 Test Acc: 0.827
Validation loss decreased (-0.716199 --> -0.827013).  Saving model ...
Epoch: 4 cost time: 1.0961666107177734
Epoch: 4, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.084 Vali Acc: 0.870 Test Loss: 1.084 Test Acc: 0.870
Validation loss decreased (-0.827013 --> -0.870259).  Saving model ...
Epoch: 5 cost time: 1.0650029182434082
Epoch: 5, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.807 Vali Acc: 0.908 Test Loss: 0.807 Test Acc: 0.908
Validation loss decreased (-0.870259 --> -0.908100).  Saving model ...
Epoch: 6 cost time: 1.3391072750091553
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.632 Vali Acc: 0.919 Test Loss: 0.632 Test Acc: 0.919
Validation loss decreased (-0.908100 --> -0.918913).  Saving model ...
Epoch: 7 cost time: 1.284980058670044
Epoch: 7, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.512 Vali Acc: 0.927 Test Loss: 0.512 Test Acc: 0.927
Validation loss decreased (-0.918913 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.2850604057312012
Epoch: 8, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.402 Vali Acc: 0.943 Test Loss: 0.402 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943239).  Saving model ...
Epoch: 9 cost time: 1.1964550018310547
Epoch: 9, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.336 Vali Acc: 0.946 Test Loss: 0.336 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945943).  Saving model ...
Epoch: 10 cost time: 1.207174301147461
Epoch: 10, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.1520228385925293
Epoch: 11, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.270 Vali Acc: 0.954 Test Loss: 0.270 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954051).  Saving model ...
Epoch: 12 cost time: 1.2075083255767822
Epoch: 12, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 13 cost time: 1.2133657932281494
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 1.0989725589752197
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 1.1588044166564941
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 1.2687454223632812
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.2149226665496826
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.0861291885375977
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1549856662750244
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.1387174129486084
Epoch: 20, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1702919006347656
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2226502895355225
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.196819543838501
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1461706161499023
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.443791151046753
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.1555123329162598
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1623950004577637
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2137761116027832
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.1690616607666016
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.07084059715271
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.032041311264038
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0628831386566162
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0757513046264648
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1022303104400635
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1664860248565674
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2739901542663574
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2113022804260254
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2917985916137695
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.2048938274383545
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 1.295238971710205
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1349866390228271
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1969633102416992
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2898414134979248
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1120972633361816
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 45 cost time: 1.1631031036376953
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1084787845611572
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1557590961456299
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1535632610321045
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.241619348526001
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1933801174163818
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.1513378620147705
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1231369972229004
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1401879787445068
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.156989574432373
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 599753
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1977274417877197
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.062 Vali Acc: 0.249 Test Loss: 2.062 Test Acc: 0.249
Validation loss decreased (inf --> -0.248628).  Saving model ...
Epoch: 2 cost time: 0.998234748840332
Epoch: 2, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.784 Vali Acc: 0.692 Test Loss: 1.784 Test Acc: 0.692
Validation loss decreased (-0.248628 --> -0.691874).  Saving model ...
Epoch: 3 cost time: 1.0287048816680908
Epoch: 3, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.477 Vali Acc: 0.816 Test Loss: 1.477 Test Acc: 0.816
Validation loss decreased (-0.691874 --> -0.816201).  Saving model ...
Epoch: 4 cost time: 1.0731086730957031
Epoch: 4, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.185 Vali Acc: 0.878 Test Loss: 1.185 Test Acc: 0.878
Validation loss decreased (-0.816201 --> -0.878367).  Saving model ...
Epoch: 5 cost time: 1.149245262145996
Epoch: 5, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.902 Vali Acc: 0.900 Test Loss: 0.902 Test Acc: 0.900
Validation loss decreased (-0.878367 --> -0.899991).  Saving model ...
Epoch: 6 cost time: 0.9817206859588623
Epoch: 6, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.707 Vali Acc: 0.916 Test Loss: 0.707 Test Acc: 0.916
Validation loss decreased (-0.899991 --> -0.916209).  Saving model ...
Epoch: 7 cost time: 1.1135523319244385
Epoch: 7, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.581 Vali Acc: 0.922 Test Loss: 0.581 Test Acc: 0.922
Validation loss decreased (-0.916209 --> -0.921616).  Saving model ...
Epoch: 8 cost time: 1.1556856632232666
Epoch: 8, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.459 Vali Acc: 0.930 Test Loss: 0.459 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 9 cost time: 1.3110599517822266
Epoch: 9, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.380 Vali Acc: 0.935 Test Loss: 0.380 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 1.1794767379760742
Epoch: 10, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 11 cost time: 1.2928779125213623
Epoch: 11, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.296 Vali Acc: 0.949 Test Loss: 0.296 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.1223371028900146
Epoch: 12, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.1900067329406738
Epoch: 13, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.232 Vali Acc: 0.946 Test Loss: 0.232 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0916247367858887
Epoch: 14, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.0913491249084473
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.0729515552520752
Epoch: 16, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0931801795959473
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1510818004608154
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0778181552886963
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.0481672286987305
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.160264492034912
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1980624198913574
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2713127136230469
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2956655025482178
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2418415546417236
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.2812387943267822
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2079298496246338
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2967987060546875
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.0560157299041748
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 0.9843878746032715
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0061078071594238
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.099064826965332
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1254563331604004
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2069523334503174
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 1.1608920097351074
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 36 cost time: 1.084765911102295
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9889693260192871
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.202284574508667
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.311131477355957
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 40 cost time: 1.4257702827453613
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.4324243068695068
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4046380519866943
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2920053005218506
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3324031829833984
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3426382541656494
Epoch: 45, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3789453506469727
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3497016429901123
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3426291942596436
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.2842326164245605
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.237786054611206
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 599753
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.348069429397583
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.039 Vali Acc: 0.297 Test Loss: 2.039 Test Acc: 0.297
Validation loss decreased (inf --> -0.297277).  Saving model ...
Epoch: 2 cost time: 1.1756529808044434
Epoch: 2, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.714 Vali Acc: 0.654 Test Loss: 1.714 Test Acc: 0.654
Validation loss decreased (-0.297277 --> -0.654037).  Saving model ...
Epoch: 3 cost time: 1.2985756397247314
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.360 Vali Acc: 0.819 Test Loss: 1.360 Test Acc: 0.819
Validation loss decreased (-0.654037 --> -0.818905).  Saving model ...
Epoch: 4 cost time: 1.1808347702026367
Epoch: 4, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.056 Vali Acc: 0.878 Test Loss: 1.056 Test Acc: 0.878
Validation loss decreased (-0.818905 --> -0.878368).  Saving model ...
Epoch: 5 cost time: 0.9332029819488525
Epoch: 5, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.808 Vali Acc: 0.892 Test Loss: 0.808 Test Acc: 0.892
Validation loss decreased (-0.878368 --> -0.891884).  Saving model ...
Epoch: 6 cost time: 1.0589890480041504
Epoch: 6, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.623 Vali Acc: 0.908 Test Loss: 0.623 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908102).  Saving model ...
Epoch: 7 cost time: 0.9565067291259766
Epoch: 7, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.484 Vali Acc: 0.930 Test Loss: 0.484 Test Acc: 0.930
Validation loss decreased (-0.908102 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.278630256652832
Epoch: 8, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.394 Vali Acc: 0.943 Test Loss: 0.394 Test Acc: 0.943
Validation loss decreased (-0.929725 --> -0.943239).  Saving model ...
Epoch: 9 cost time: 1.2122416496276855
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.329 Vali Acc: 0.951 Test Loss: 0.329 Test Acc: 0.951
Validation loss decreased (-0.943239 --> -0.951348).  Saving model ...
Epoch: 10 cost time: 1.1497883796691895
Epoch: 10, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.276 Vali Acc: 0.949 Test Loss: 0.276 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1706960201263428
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.254 Vali Acc: 0.951 Test Loss: 0.254 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.086799144744873
Epoch: 12, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 13 cost time: 1.3710949420928955
Epoch: 13, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.188 Vali Acc: 0.968 Test Loss: 0.188 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 1.2887680530548096
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.198591947555542
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 1.0637812614440918
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2130253314971924
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.160731554031372
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1173865795135498
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1877336502075195
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.255805253982544
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1439266204833984
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2360610961914062
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.1557347774505615
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.1453101634979248
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.2727508544921875
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2184619903564453
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.1524360179901123
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1306049823760986
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2584056854248047
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 0.9988481998443604
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0242767333984375
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1740813255310059
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1982529163360596
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.240617036819458
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1620051860809326
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3054776191711426
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.171595811843872
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0989961624145508
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1970295906066895
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 337609
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.171215057373047
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.039 Vali Acc: 0.305 Test Loss: 2.039 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.1105401515960693
Epoch: 2, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.718 Vali Acc: 0.654 Test Loss: 1.718 Test Acc: 0.654
Validation loss decreased (-0.305385 --> -0.654037).  Saving model ...
Epoch: 3 cost time: 1.133244276046753
Epoch: 3, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.366 Vali Acc: 0.830 Test Loss: 1.366 Test Acc: 0.830
Validation loss decreased (-0.654037 --> -0.829716).  Saving model ...
Epoch: 4 cost time: 1.2212018966674805
Epoch: 4, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.061 Vali Acc: 0.870 Test Loss: 1.061 Test Acc: 0.870
Validation loss decreased (-0.829716 --> -0.870260).  Saving model ...
Epoch: 5 cost time: 1.2857866287231445
Epoch: 5, Steps: 17 | Train Loss: 0.869 Vali Loss: 0.813 Vali Acc: 0.889 Test Loss: 0.813 Test Acc: 0.889
Validation loss decreased (-0.870260 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 1.3670504093170166
Epoch: 6, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.625 Vali Acc: 0.914 Test Loss: 0.625 Test Acc: 0.914
Validation loss decreased (-0.889181 --> -0.913507).  Saving model ...
Epoch: 7 cost time: 1.2578704357147217
Epoch: 7, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.486 Vali Acc: 0.927 Test Loss: 0.486 Test Acc: 0.927
Validation loss decreased (-0.913507 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.1583826541900635
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.396 Vali Acc: 0.938 Test Loss: 0.396 Test Acc: 0.938
Validation loss decreased (-0.927022 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 1.1418023109436035
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.332 Vali Acc: 0.951 Test Loss: 0.332 Test Acc: 0.951
Validation loss decreased (-0.937834 --> -0.951348).  Saving model ...
Epoch: 10 cost time: 1.039276123046875
Epoch: 10, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 11 cost time: 1.0325927734375
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.2884151935577393
Epoch: 12, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.170506238937378
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
Validation loss decreased (-0.954052 --> -0.964863).  Saving model ...
Epoch: 14 cost time: 1.0621259212493896
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.192 Vali Acc: 0.965 Test Loss: 0.192 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2982680797576904
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 16 cost time: 1.1348226070404053
Epoch: 16, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2540678977966309
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3396880626678467
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.305168628692627
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3522605895996094
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2887370586395264
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.1537954807281494
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2025847434997559
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1599476337432861
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0864901542663574
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1308531761169434
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1611323356628418
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2144389152526855
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.205143928527832
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1662209033966064
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 31 cost time: 1.1899282932281494
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0325937271118164
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1765649318695068
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1736915111541748
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1250841617584229
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2116539478302002
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2251617908477783
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0914111137390137
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.050938606262207
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.138094425201416
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 337609
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1863367557525635
Epoch: 1, Steps: 17 | Train Loss: 2.208 Vali Loss: 2.044 Vali Acc: 0.295 Test Loss: 2.044 Test Acc: 0.295
Validation loss decreased (inf --> -0.294574).  Saving model ...
Epoch: 2 cost time: 1.1696772575378418
Epoch: 2, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.736 Vali Acc: 0.646 Test Loss: 1.736 Test Acc: 0.646
Validation loss decreased (-0.294574 --> -0.645929).  Saving model ...
Epoch: 3 cost time: 1.1251389980316162
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.393 Vali Acc: 0.827 Test Loss: 1.393 Test Acc: 0.827
Validation loss decreased (-0.645929 --> -0.827013).  Saving model ...
Epoch: 4 cost time: 1.2362284660339355
Epoch: 4, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.090 Vali Acc: 0.868 Test Loss: 1.090 Test Acc: 0.868
Validation loss decreased (-0.827013 --> -0.867557).  Saving model ...
Epoch: 5 cost time: 1.3049888610839844
Epoch: 5, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.836 Vali Acc: 0.889 Test Loss: 0.836 Test Acc: 0.889
Validation loss decreased (-0.867557 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 1.3320229053497314
Epoch: 6, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.646 Vali Acc: 0.911 Test Loss: 0.646 Test Acc: 0.911
Validation loss decreased (-0.889181 --> -0.910804).  Saving model ...
Epoch: 7 cost time: 1.2236061096191406
Epoch: 7, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.502 Vali Acc: 0.935 Test Loss: 0.502 Test Acc: 0.935
Validation loss decreased (-0.910804 --> -0.935130).  Saving model ...
Epoch: 8 cost time: 1.259253978729248
Epoch: 8, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.408 Vali Acc: 0.935 Test Loss: 0.408 Test Acc: 0.935
Validation loss decreased (-0.935130 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.2699756622314453
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.347 Vali Acc: 0.946 Test Loss: 0.347 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945942).  Saving model ...
Epoch: 10 cost time: 1.2302370071411133
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.289 Vali Acc: 0.938 Test Loss: 0.289 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3017516136169434
Epoch: 11, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.264 Vali Acc: 0.951 Test Loss: 0.264 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.1799812316894531
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 1.3068385124206543
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.2973108291625977
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2557041645050049
Epoch: 15, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.176 Vali Acc: 0.968 Test Loss: 0.176 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 16 cost time: 1.4276738166809082
Epoch: 16, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3454399108886719
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3800652027130127
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.3858706951141357
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2934937477111816
Epoch: 20, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2164397239685059
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.2896173000335693
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0941994190216064
Epoch: 23, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1545865535736084
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0342512130737305
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2811040878295898
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2131798267364502
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2479329109191895
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1738560199737549
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.235917329788208
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2174384593963623
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 337609
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2185990810394287
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.073 Vali Acc: 0.243 Test Loss: 2.073 Test Acc: 0.243
Validation loss decreased (inf --> -0.243223).  Saving model ...
Epoch: 2 cost time: 1.120523452758789
Epoch: 2, Steps: 17 | Train Loss: 1.938 Vali Loss: 1.799 Vali Acc: 0.649 Test Loss: 1.799 Test Acc: 0.649
Validation loss decreased (-0.243223 --> -0.648631).  Saving model ...
Epoch: 3 cost time: 1.1025362014770508
Epoch: 3, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.485 Vali Acc: 0.824 Test Loss: 1.485 Test Acc: 0.824
Validation loss decreased (-0.648631 --> -0.824309).  Saving model ...
Epoch: 4 cost time: 1.0622751712799072
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.185 Vali Acc: 0.862 Test Loss: 1.185 Test Acc: 0.862
Validation loss decreased (-0.824309 --> -0.862150).  Saving model ...
Epoch: 5 cost time: 1.1694855690002441
Epoch: 5, Steps: 17 | Train Loss: 0.967 Vali Loss: 0.923 Vali Acc: 0.878 Test Loss: 0.923 Test Acc: 0.878
Validation loss decreased (-0.862150 --> -0.878369).  Saving model ...
Epoch: 6 cost time: 1.0413539409637451
Epoch: 6, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.721 Vali Acc: 0.911 Test Loss: 0.721 Test Acc: 0.911
Validation loss decreased (-0.878369 --> -0.910804).  Saving model ...
Epoch: 7 cost time: 1.0948021411895752
Epoch: 7, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.568 Vali Acc: 0.927 Test Loss: 0.568 Test Acc: 0.927
Validation loss decreased (-0.910804 --> -0.927021).  Saving model ...
Epoch: 8 cost time: 0.999852180480957
Epoch: 8, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.466 Vali Acc: 0.930 Test Loss: 0.466 Test Acc: 0.930
Validation loss decreased (-0.927021 --> -0.929725).  Saving model ...
Epoch: 9 cost time: 1.21787691116333
Epoch: 9, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.392 Vali Acc: 0.935 Test Loss: 0.392 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 1.0437533855438232
Epoch: 10, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.331 Vali Acc: 0.935 Test Loss: 0.331 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.2554354667663574
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940538).  Saving model ...
Epoch: 12 cost time: 1.1886534690856934
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945943).  Saving model ...
Epoch: 13 cost time: 1.2008225917816162
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.213 Vali Acc: 0.959 Test Loss: 0.213 Test Acc: 0.959
Validation loss decreased (-0.945943 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 1.283179759979248
Epoch: 14, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 15 cost time: 1.1974539756774902
Epoch: 15, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3049943447113037
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2721843719482422
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1910278797149658
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 1.1968507766723633
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 20 cost time: 1.233597755432129
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2767736911773682
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.2145912647247314
Epoch: 22, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.1425976753234863
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1776769161224365
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.2412710189819336
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.2430517673492432
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2782962322235107
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.285602331161499
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.159184455871582
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1960854530334473
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.2278544902801514
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2367935180664062
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0520298480987549
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0849204063415527
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0612614154815674
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1188938617706299
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2960057258605957
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1142258644104004
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.228398084640503
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1450021266937256
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 337609
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9037492275238037
Epoch: 1, Steps: 17 | Train Loss: 2.243 Vali Loss: 2.078 Vali Acc: 0.268 Test Loss: 2.078 Test Acc: 0.268
Validation loss decreased (inf --> -0.267547).  Saving model ...
Epoch: 2 cost time: 1.0763001441955566
Epoch: 2, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.724 Vali Acc: 0.619 Test Loss: 1.724 Test Acc: 0.619
Validation loss decreased (-0.267547 --> -0.618902).  Saving model ...
Epoch: 3 cost time: 1.2084927558898926
Epoch: 3, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.385 Vali Acc: 0.762 Test Loss: 1.385 Test Acc: 0.762
Validation loss decreased (-0.618902 --> -0.762148).  Saving model ...
Epoch: 4 cost time: 1.1684656143188477
Epoch: 4, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.060 Vali Acc: 0.849 Test Loss: 1.060 Test Acc: 0.849
Validation loss decreased (-0.762148 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 1.3260300159454346
Epoch: 5, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.825 Vali Acc: 0.878 Test Loss: 0.825 Test Acc: 0.878
Validation loss decreased (-0.848638 --> -0.878370).  Saving model ...
Epoch: 6 cost time: 1.140721321105957
Epoch: 6, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.624 Vali Acc: 0.903 Test Loss: 0.624 Test Acc: 0.903
Validation loss decreased (-0.878370 --> -0.902696).  Saving model ...
Epoch: 7 cost time: 1.3433213233947754
Epoch: 7, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.487 Vali Acc: 0.930 Test Loss: 0.487 Test Acc: 0.930
Validation loss decreased (-0.902696 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.2707347869873047
Epoch: 8, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 1.198413372039795
Epoch: 9, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.324 Vali Acc: 0.938 Test Loss: 0.324 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 10 cost time: 1.2565486431121826
Epoch: 10, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.286 Vali Acc: 0.949 Test Loss: 0.286 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.2431590557098389
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.247 Vali Acc: 0.951 Test Loss: 0.247 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.1424248218536377
Epoch: 12, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 1.1824698448181152
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.3150932788848877
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.133300542831421
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1630702018737793
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2540287971496582
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.962 Test Loss: 0.150 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.1195509433746338
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 19 cost time: 1.1392285823822021
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.2052457332611084
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1776049137115479
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.1099369525909424
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.205991506576538
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.967566 --> -0.975674).  Saving model ...
Epoch: 24 cost time: 1.149718999862671
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2257611751556396
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3391647338867188
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1738393306732178
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1620569229125977
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.112837791442871
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3473434448242188
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.316335916519165
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2254738807678223
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 1.2627263069152832
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4109313488006592
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.209122896194458
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2705376148223877
Epoch: 36, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0153722763061523
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.0439112186431885
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 1.1034622192382812
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.165712833404541
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1103503704071045
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2683606147766113
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 43 cost time: 1.2488389015197754
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 1.2032203674316406
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8967893123626709
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 46 cost time: 1.24558687210083
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0967686176300049
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2635037899017334
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2650270462036133
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.175215244293213
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.2186667919158936
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.138801097869873
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1282627582550049
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3185956478118896
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2101123332977295
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 206537
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1550424098968506
Epoch: 1, Steps: 17 | Train Loss: 2.247 Vali Loss: 2.083 Vali Acc: 0.265 Test Loss: 2.083 Test Acc: 0.265
Validation loss decreased (inf --> -0.264844).  Saving model ...
Epoch: 2 cost time: 1.1360983848571777
Epoch: 2, Steps: 17 | Train Loss: 1.932 Vali Loss: 1.731 Vali Acc: 0.622 Test Loss: 1.731 Test Acc: 0.622
Validation loss decreased (-0.264844 --> -0.621604).  Saving model ...
Epoch: 3 cost time: 1.2178599834442139
Epoch: 3, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.393 Vali Acc: 0.770 Test Loss: 1.393 Test Acc: 0.770
Validation loss decreased (-0.621604 --> -0.770256).  Saving model ...
Epoch: 4 cost time: 1.3498239517211914
Epoch: 4, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.067 Vali Acc: 0.849 Test Loss: 1.067 Test Acc: 0.849
Validation loss decreased (-0.770256 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 1.18888521194458
Epoch: 5, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.832 Vali Acc: 0.878 Test Loss: 0.832 Test Acc: 0.878
Validation loss decreased (-0.848638 --> -0.878370).  Saving model ...
Epoch: 6 cost time: 1.166013479232788
Epoch: 6, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.629 Vali Acc: 0.903 Test Loss: 0.629 Test Acc: 0.903
Validation loss decreased (-0.878370 --> -0.902696).  Saving model ...
Epoch: 7 cost time: 1.1824419498443604
Epoch: 7, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.902696 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.1102321147918701
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.390 Vali Acc: 0.930 Test Loss: 0.390 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 9 cost time: 0.9953336715698242
Epoch: 9, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.929726 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 1.100879430770874
Epoch: 10, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.287 Vali Acc: 0.949 Test Loss: 0.287 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.0466842651367188
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.250 Vali Acc: 0.954 Test Loss: 0.250 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 12 cost time: 1.1137995719909668
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 0.9570271968841553
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.197 Vali Acc: 0.962 Test Loss: 0.197 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.2345941066741943
Epoch: 14, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2954931259155273
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.3220622539520264
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 17 cost time: 1.1784718036651611
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.2980225086212158
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.2764017581939697
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.1454055309295654
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.197843313217163
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 22 cost time: 1.1068477630615234
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0160412788391113
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975674).  Saving model ...
Epoch: 24 cost time: 0.9801814556121826
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.975674 --> -0.975675).  Saving model ...
Epoch: 25 cost time: 1.1790645122528076
Epoch: 25, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.156752109527588
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.248063564300537
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 28 cost time: 1.2574949264526367
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3469667434692383
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2012865543365479
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.276137351989746
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0967304706573486
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 1.183838129043579
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.1817872524261475
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3503525257110596
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.109208106994629
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.209134578704834
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.2573246955871582
Epoch: 38, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1639063358306885
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.156526803970337
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.3253438472747803
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3216817378997803
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2104358673095703
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2394051551818848
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3091683387756348
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.1853821277618408
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0135314464569092
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0743236541748047
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1552801132202148
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.113783836364746
Epoch: 50, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1206908226013184
Epoch: 51, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 52 cost time: 1.123584508895874
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1709411144256592
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.253375768661499
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 55 cost time: 1.2107605934143066
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 56 cost time: 1.2040185928344727
Epoch: 56, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3353986740112305
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.2607717514038086
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9521427154541016
Epoch: 59, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.1474509239196777
Epoch: 60, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1119716167449951
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1262757778167725
Epoch: 62, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.1308445930480957
Epoch: 63, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.059354305267334
Epoch: 64, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.0872135162353516
Epoch: 65, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 206537
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0323591232299805
Epoch: 1, Steps: 17 | Train Loss: 2.258 Vali Loss: 2.103 Vali Acc: 0.238 Test Loss: 2.103 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.0142388343811035
Epoch: 2, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.761 Vali Acc: 0.605 Test Loss: 1.761 Test Acc: 0.605
Validation loss decreased (-0.237817 --> -0.605388).  Saving model ...
Epoch: 3 cost time: 0.9707469940185547
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.428 Vali Acc: 0.789 Test Loss: 1.428 Test Acc: 0.789
Validation loss decreased (-0.605388 --> -0.789175).  Saving model ...
Epoch: 4 cost time: 0.9582169055938721
Epoch: 4, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.103 Vali Acc: 0.857 Test Loss: 1.103 Test Acc: 0.857
Validation loss decreased (-0.789175 --> -0.856746).  Saving model ...
Epoch: 5 cost time: 0.9447400569915771
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.862 Vali Acc: 0.895 Test Loss: 0.862 Test Acc: 0.895
Validation loss decreased (-0.856746 --> -0.894586).  Saving model ...
Epoch: 6 cost time: 1.038301706314087
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.652 Vali Acc: 0.914 Test Loss: 0.652 Test Acc: 0.914
Validation loss decreased (-0.894586 --> -0.913507).  Saving model ...
Epoch: 7 cost time: 1.0909204483032227
Epoch: 7, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.509 Vali Acc: 0.927 Test Loss: 0.509 Test Acc: 0.927
Validation loss decreased (-0.913507 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.1336679458618164
Epoch: 8, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.406 Vali Acc: 0.932 Test Loss: 0.406 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 1.1063573360443115
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.343 Vali Acc: 0.938 Test Loss: 0.343 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 10 cost time: 1.1776671409606934
Epoch: 10, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.299 Vali Acc: 0.946 Test Loss: 0.299 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 1.0443682670593262
Epoch: 11, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.260 Vali Acc: 0.949 Test Loss: 0.260 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 0.9903743267059326
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 0.9710915088653564
Epoch: 13, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 1.0995054244995117
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.0134034156799316
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 16 cost time: 1.0776817798614502
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0964319705963135
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.2385749816894531
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0941493511199951
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.0507404804229736
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.272540807723999
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.1250889301300049
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2293119430541992
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.1983821392059326
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 1.0491595268249512
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.152083396911621
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1001098155975342
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1570158004760742
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1399781703948975
Epoch: 29, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.139404296875
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1271216869354248
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.065828561782837
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.1330347061157227
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.1356310844421387
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1346790790557861
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.127516269683838
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9008748531341553
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0258703231811523
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9642167091369629
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9604055881500244
Epoch: 40, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0333123207092285
Epoch: 41, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9721879959106445
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0604817867279053
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 206537
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.047410011291504
Epoch: 1, Steps: 17 | Train Loss: 2.252 Vali Loss: 2.128 Vali Acc: 0.224 Test Loss: 2.128 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 1.081408977508545
Epoch: 2, Steps: 17 | Train Loss: 1.969 Vali Loss: 1.829 Vali Acc: 0.581 Test Loss: 1.829 Test Acc: 0.581
Validation loss decreased (-0.224303 --> -0.581063).  Saving model ...
Epoch: 3 cost time: 0.9561526775360107
Epoch: 3, Steps: 17 | Train Loss: 1.633 Vali Loss: 1.521 Vali Acc: 0.789 Test Loss: 1.521 Test Acc: 0.789
Validation loss decreased (-0.581063 --> -0.789174).  Saving model ...
Epoch: 4 cost time: 1.0834553241729736
Epoch: 4, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.203 Vali Acc: 0.862 Test Loss: 1.203 Test Acc: 0.862
Validation loss decreased (-0.789174 --> -0.862150).  Saving model ...
Epoch: 5 cost time: 0.9642283916473389
Epoch: 5, Steps: 17 | Train Loss: 0.993 Vali Loss: 0.949 Vali Acc: 0.870 Test Loss: 0.949 Test Acc: 0.870
Validation loss decreased (-0.862150 --> -0.870261).  Saving model ...
Epoch: 6 cost time: 0.9797775745391846
Epoch: 6, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.870261 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.8561477661132812
Epoch: 7, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.580 Vali Acc: 0.911 Test Loss: 0.580 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.910805).  Saving model ...
Epoch: 8 cost time: 1.0099773406982422
Epoch: 8, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.467 Vali Acc: 0.932 Test Loss: 0.467 Test Acc: 0.932
Validation loss decreased (-0.910805 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 1.0024290084838867
Epoch: 9, Steps: 17 | Train Loss: 0.340 Vali Loss: 0.390 Vali Acc: 0.927 Test Loss: 0.390 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9884865283966064
Epoch: 10, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9724550247192383
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937835).  Saving model ...
Epoch: 12 cost time: 1.0648462772369385
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
Validation loss decreased (-0.937835 --> -0.948646).  Saving model ...
Epoch: 13 cost time: 1.0535924434661865
Epoch: 13, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.0630338191986084
Epoch: 14, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 15 cost time: 1.0981340408325195
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 16 cost time: 1.0171802043914795
Epoch: 16, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0061357021331787
Epoch: 17, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 18 cost time: 1.0581886768341064
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1386668682098389
Epoch: 19, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9631960391998291
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.0281951427459717
Epoch: 21, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 22 cost time: 1.0572175979614258
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.072934627532959
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.004511833190918
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.1598000526428223
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.1203641891479492
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.043919563293457
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.0651309490203857
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9744246006011963
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.0700273513793945
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9553742408752441
Epoch: 31, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.074117660522461
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 0.9551661014556885
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 0.9865195751190186
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9952719211578369
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9782254695892334
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 0.9502558708190918
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 0.9384820461273193
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 1.0911295413970947
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9639649391174316
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0828583240509033
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.055433750152588
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.007950782775879
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 0.9938356876373291
Epoch: 44, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9892525672912598
Epoch: 45, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0434660911560059
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9717807769775391
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0786242485046387
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0441079139709473
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0131311416625977
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9679758548736572
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 52 cost time: 1.0265297889709473
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.1171143054962158
Epoch: 53, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0787413120269775
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.0442664623260498
Epoch: 55, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0924673080444336
Epoch: 56, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0033259391784668
Epoch: 57, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 58 cost time: 0.9874334335327148
Epoch: 58, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0474474430084229
Epoch: 59, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9861493110656738
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9943773746490479
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0698375701904297
Epoch: 62, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.982757568359375
Epoch: 63, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.006906270980835
Epoch: 64, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9272105693817139
Epoch: 65, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8965902328491211
Epoch: 66, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.0795822143554688
Epoch: 67, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 206537
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.751190423965454
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 1.997 Vali Acc: 0.351 Test Loss: 1.997 Test Acc: 0.351
Validation loss decreased (inf --> -0.351331).  Saving model ...
Epoch: 2 cost time: 1.096421241760254
Epoch: 2, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.686 Vali Acc: 0.724 Test Loss: 1.686 Test Acc: 0.724
Validation loss decreased (-0.351331 --> -0.724307).  Saving model ...
Epoch: 3 cost time: 1.1067752838134766
Epoch: 3, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.347 Vali Acc: 0.805 Test Loss: 1.347 Test Acc: 0.805
Validation loss decreased (-0.724307 --> -0.805392).  Saving model ...
Epoch: 4 cost time: 1.0930323600769043
Epoch: 4, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.045 Vali Acc: 0.868 Test Loss: 1.045 Test Acc: 0.868
Validation loss decreased (-0.805392 --> -0.867557).  Saving model ...
Epoch: 5 cost time: 1.191995620727539
Epoch: 5, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.785 Vali Acc: 0.895 Test Loss: 0.785 Test Acc: 0.895
Validation loss decreased (-0.867557 --> -0.894587).  Saving model ...
Epoch: 6 cost time: 1.146240234375
Epoch: 6, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.613 Vali Acc: 0.924 Test Loss: 0.613 Test Acc: 0.924
Validation loss decreased (-0.894587 --> -0.924318).  Saving model ...
Epoch: 7 cost time: 1.1415801048278809
Epoch: 7, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.479 Vali Acc: 0.935 Test Loss: 0.479 Test Acc: 0.935
Validation loss decreased (-0.924318 --> -0.935130).  Saving model ...
Epoch: 8 cost time: 1.026348352432251
Epoch: 8, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.386 Vali Acc: 0.938 Test Loss: 0.386 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 1.079282283782959
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 1.1581063270568848
Epoch: 10, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.291 Vali Acc: 0.938 Test Loss: 0.291 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.181424856185913
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.242 Vali Acc: 0.965 Test Loss: 0.242 Test Acc: 0.965
Validation loss decreased (-0.943240 --> -0.964862).  Saving model ...
Epoch: 12 cost time: 1.06705904006958
Epoch: 12, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.227 Vali Acc: 0.957 Test Loss: 0.227 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1612753868103027
Epoch: 13, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1350553035736084
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2323322296142578
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2422640323638916
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.964862 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.1168155670166016
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.108461856842041
Epoch: 18, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 19 cost time: 1.1530826091766357
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0638277530670166
Epoch: 20, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 21 cost time: 1.0788676738739014
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2369399070739746
Epoch: 22, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.0959267616271973
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.073826551437378
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0641202926635742
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 26 cost time: 0.988044261932373
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0220370292663574
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.057283639907837
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0088741779327393
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.027791976928711
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.07869553565979
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0273385047912598
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 33 cost time: 1.1131713390350342
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0114383697509766
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1633214950561523
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1889476776123047
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1962082386016846
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1059794425964355
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.050321102142334
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9504659175872803
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.035160779953003
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0254814624786377
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 141001
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9124414920806885
Epoch: 1, Steps: 17 | Train Loss: 2.138 Vali Loss: 1.991 Vali Acc: 0.357 Test Loss: 1.991 Test Acc: 0.357
Validation loss decreased (inf --> -0.356737).  Saving model ...
Epoch: 2 cost time: 1.1864967346191406
Epoch: 2, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.683 Vali Acc: 0.749 Test Loss: 1.683 Test Acc: 0.749
Validation loss decreased (-0.356737 --> -0.748632).  Saving model ...
Epoch: 3 cost time: 1.1355209350585938
Epoch: 3, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.345 Vali Acc: 0.822 Test Loss: 1.345 Test Acc: 0.822
Validation loss decreased (-0.748632 --> -0.821608).  Saving model ...
Epoch: 4 cost time: 1.1321032047271729
Epoch: 4, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.046 Vali Acc: 0.870 Test Loss: 1.046 Test Acc: 0.870
Validation loss decreased (-0.821608 --> -0.870260).  Saving model ...
Epoch: 5 cost time: 1.1107447147369385
Epoch: 5, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.786 Vali Acc: 0.897 Test Loss: 0.786 Test Acc: 0.897
Validation loss decreased (-0.870260 --> -0.897289).  Saving model ...
Epoch: 6 cost time: 1.1117503643035889
Epoch: 6, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.615 Vali Acc: 0.927 Test Loss: 0.615 Test Acc: 0.927
Validation loss decreased (-0.897289 --> -0.927021).  Saving model ...
Epoch: 7 cost time: 0.9505066871643066
Epoch: 7, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.480 Vali Acc: 0.927 Test Loss: 0.480 Test Acc: 0.927
Validation loss decreased (-0.927021 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 0.9768445491790771
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.0027942657470703
Epoch: 9, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 0.924736738204956
Epoch: 10, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1923818588256836
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.243 Vali Acc: 0.962 Test Loss: 0.243 Test Acc: 0.962
Validation loss decreased (-0.943240 --> -0.962160).  Saving model ...
Epoch: 12 cost time: 1.0463528633117676
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0498063564300537
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0541436672210693
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 1.0144903659820557
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1217291355133057
Epoch: 16, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.962160 --> -0.970269).  Saving model ...
Epoch: 17 cost time: 1.1145305633544922
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2021660804748535
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 19 cost time: 1.2118487358093262
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.161116361618042
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 21 cost time: 1.255671739578247
Epoch: 21, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0446124076843262
Epoch: 22, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0279176235198975
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.1258347034454346
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0200080871582031
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 26 cost time: 1.1120684146881104
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 27 cost time: 1.0722084045410156
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0529119968414307
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0998642444610596
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0539686679840088
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1399905681610107
Epoch: 31, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.149764060974121
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0617799758911133
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1083519458770752
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0370073318481445
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9994759559631348
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 141001
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.15419864654541
Epoch: 1, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.005 Vali Acc: 0.354 Test Loss: 2.005 Test Acc: 0.354
Validation loss decreased (inf --> -0.354034).  Saving model ...
Epoch: 2 cost time: 1.1027696132659912
Epoch: 2, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.704 Vali Acc: 0.741 Test Loss: 1.704 Test Acc: 0.741
Validation loss decreased (-0.354034 --> -0.740524).  Saving model ...
Epoch: 3 cost time: 1.1460754871368408
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.374 Vali Acc: 0.811 Test Loss: 1.374 Test Acc: 0.811
Validation loss decreased (-0.740524 --> -0.810797).  Saving model ...
Epoch: 4 cost time: 0.975043535232544
Epoch: 4, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.076 Vali Acc: 0.868 Test Loss: 1.076 Test Acc: 0.868
Validation loss decreased (-0.810797 --> -0.867557).  Saving model ...
Epoch: 5 cost time: 1.0371465682983398
Epoch: 5, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.810 Vali Acc: 0.889 Test Loss: 0.810 Test Acc: 0.889
Validation loss decreased (-0.867557 --> -0.889181).  Saving model ...
Epoch: 6 cost time: 1.1140999794006348
Epoch: 6, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.635 Vali Acc: 0.919 Test Loss: 0.635 Test Acc: 0.919
Validation loss decreased (-0.889181 --> -0.918913).  Saving model ...
Epoch: 7 cost time: 1.0406286716461182
Epoch: 7, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.497 Vali Acc: 0.930 Test Loss: 0.497 Test Acc: 0.930
Validation loss decreased (-0.918913 --> -0.929725).  Saving model ...
Epoch: 8 cost time: 1.0775234699249268
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.402 Vali Acc: 0.935 Test Loss: 0.402 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 0.9830260276794434
Epoch: 9, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 1.0550382137298584
Epoch: 10, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 1.0790278911590576
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.254 Vali Acc: 0.951 Test Loss: 0.254 Test Acc: 0.951
Validation loss decreased (-0.940538 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.20387864112854
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.239 Vali Acc: 0.946 Test Loss: 0.239 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2790908813476562
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.216 Vali Acc: 0.954 Test Loss: 0.216 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.1190922260284424
Epoch: 14, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 15 cost time: 1.0838737487792969
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.178 Vali Acc: 0.957 Test Loss: 0.178 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 1.1592192649841309
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 17 cost time: 1.1289093494415283
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1628553867340088
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.2446177005767822
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.076047420501709
Epoch: 20, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.26102876663208
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2607643604278564
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 23 cost time: 1.0429415702819824
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.1994619369506836
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1619577407836914
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1533021926879883
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.129866600036621
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0367708206176758
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.199782133102417
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0789375305175781
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0220756530761719
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0857350826263428
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9685566425323486
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 141001
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9426698684692383
Epoch: 1, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.015 Vali Acc: 0.376 Test Loss: 2.015 Test Acc: 0.376
Validation loss decreased (inf --> -0.375656).  Saving model ...
Epoch: 2 cost time: 1.038090467453003
Epoch: 2, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.747 Vali Acc: 0.746 Test Loss: 1.747 Test Acc: 0.746
Validation loss decreased (-0.375656 --> -0.745928).  Saving model ...
Epoch: 3 cost time: 1.1080081462860107
Epoch: 3, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.448 Vali Acc: 0.843 Test Loss: 1.448 Test Acc: 0.843
Validation loss decreased (-0.745928 --> -0.843229).  Saving model ...
Epoch: 4 cost time: 1.0700247287750244
Epoch: 4, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.163 Vali Acc: 0.884 Test Loss: 1.163 Test Acc: 0.884
Validation loss decreased (-0.843229 --> -0.883772).  Saving model ...
Epoch: 5 cost time: 0.9252305030822754
Epoch: 5, Steps: 17 | Train Loss: 0.946 Vali Loss: 0.894 Vali Acc: 0.903 Test Loss: 0.894 Test Acc: 0.903
Validation loss decreased (-0.883772 --> -0.902694).  Saving model ...
Epoch: 6 cost time: 1.0220108032226562
Epoch: 6, Steps: 17 | Train Loss: 0.707 Vali Loss: 0.709 Vali Acc: 0.914 Test Loss: 0.709 Test Acc: 0.914
Validation loss decreased (-0.902694 --> -0.913506).  Saving model ...
Epoch: 7 cost time: 1.0106439590454102
Epoch: 7, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.567 Vali Acc: 0.914 Test Loss: 0.567 Test Acc: 0.914
Validation loss decreased (-0.913506 --> -0.913508).  Saving model ...
Epoch: 8 cost time: 0.9942257404327393
Epoch: 8, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.455 Vali Acc: 0.935 Test Loss: 0.455 Test Acc: 0.935
Validation loss decreased (-0.913508 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.0311355590820312
Epoch: 9, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.384 Vali Acc: 0.938 Test Loss: 0.384 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 10 cost time: 1.0018515586853027
Epoch: 10, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.343 Vali Acc: 0.932 Test Loss: 0.343 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0436131954193115
Epoch: 11, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.284 Vali Acc: 0.957 Test Loss: 0.284 Test Acc: 0.957
Validation loss decreased (-0.937834 --> -0.956754).  Saving model ...
Epoch: 12 cost time: 1.1672437191009521
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.259 Vali Acc: 0.949 Test Loss: 0.259 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0126760005950928
Epoch: 13, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.236 Vali Acc: 0.951 Test Loss: 0.236 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.120255947113037
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0484368801116943
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 0.990178108215332
Epoch: 16, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 1.0865468978881836
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0112462043762207
Epoch: 18, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 0.9564852714538574
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 0.9601757526397705
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 21 cost time: 1.0122642517089844
Epoch: 21, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 22 cost time: 1.0050373077392578
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9758992195129395
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.150087833404541
Epoch: 24, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.0282292366027832
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0499072074890137
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9755852222442627
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 1.0919899940490723
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.0049457550048828
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9304046630859375
Epoch: 30, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 0.9182620048522949
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 0.959599494934082
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9718255996704102
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0245158672332764
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9358210563659668
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 1.028860092163086
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1387534141540527
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1962146759033203
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 0.9792270660400391
Epoch: 39, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.022334337234497
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9186275005340576
Epoch: 41, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9949665069580078
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0508997440338135
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2427692413330078
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.131448745727539
Epoch: 45, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 0.9615154266357422
Epoch: 46, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1187119483947754
Epoch: 47, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 48 cost time: 0.9502692222595215
Epoch: 48, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 49 cost time: 1.0383546352386475
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0407118797302246
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9830400943756104
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0811514854431152
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.124922752380371
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1077940464019775
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0894999504089355
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.0324292182922363
Epoch: 56, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 57 cost time: 1.033275842666626
Epoch: 57, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.104163646697998
Epoch: 58, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1018781661987305
Epoch: 59, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.040985345840454
Epoch: 60, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.062556266784668
Epoch: 61, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.099109411239624
Epoch: 62, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0454540252685547
Epoch: 63, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.0121994018554688
Epoch: 64, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.0755517482757568
Epoch: 65, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.9858260154724121
Epoch: 66, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 141001
model size : 2.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.596630811691284
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.014 Vali Acc: 0.246 Test Loss: 2.014 Test Acc: 0.246
Validation loss decreased (inf --> -0.245926).  Saving model ...
Epoch: 2 cost time: 1.1103065013885498
Epoch: 2, Steps: 17 | Train Loss: 1.880 Vali Loss: 1.686 Vali Acc: 0.746 Test Loss: 1.686 Test Acc: 0.746
Validation loss decreased (-0.245926 --> -0.745929).  Saving model ...
Epoch: 3 cost time: 1.119619607925415
Epoch: 3, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.337 Vali Acc: 0.832 Test Loss: 1.337 Test Acc: 0.832
Validation loss decreased (-0.745929 --> -0.832419).  Saving model ...
Epoch: 4 cost time: 1.1457397937774658
Epoch: 4, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.054 Vali Acc: 0.862 Test Loss: 1.054 Test Acc: 0.862
Validation loss decreased (-0.832419 --> -0.862152).  Saving model ...
Epoch: 5 cost time: 1.0930142402648926
Epoch: 5, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.804 Vali Acc: 0.897 Test Loss: 0.804 Test Acc: 0.897
Validation loss decreased (-0.862152 --> -0.897289).  Saving model ...
Epoch: 6 cost time: 1.1563527584075928
Epoch: 6, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.611 Vali Acc: 0.914 Test Loss: 0.611 Test Acc: 0.914
Validation loss decreased (-0.897289 --> -0.913507).  Saving model ...
Epoch: 7 cost time: 0.9922325611114502
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.481 Vali Acc: 0.927 Test Loss: 0.481 Test Acc: 0.927
Validation loss decreased (-0.913507 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 0.9949085712432861
Epoch: 8, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.388 Vali Acc: 0.941 Test Loss: 0.388 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 9 cost time: 1.0748622417449951
Epoch: 9, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.329 Vali Acc: 0.943 Test Loss: 0.329 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 10 cost time: 0.9080686569213867
Epoch: 10, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.271 Vali Acc: 0.949 Test Loss: 0.271 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 11 cost time: 1.106436014175415
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956754).  Saving model ...
Epoch: 12 cost time: 1.116745948791504
Epoch: 12, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.223 Vali Acc: 0.949 Test Loss: 0.223 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1569328308105469
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 14 cost time: 1.170058012008667
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.068108320236206
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1503958702087402
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1858491897583008
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.1168007850646973
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.0284008979797363
Epoch: 19, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0184495449066162
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 1.0297486782073975
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 22 cost time: 1.0446724891662598
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 1.1130189895629883
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1082286834716797
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9798648357391357
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.067897081375122
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0295472145080566
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1957001686096191
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2240850925445557
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1203551292419434
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1048142910003662
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.0779414176940918
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1429417133331299
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1757287979125977
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0223667621612549
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1913495063781738
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9997167587280273
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0496582984924316
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0649604797363281
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0737600326538086
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.046036958694458
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 108233
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.954289436340332
Epoch: 1, Steps: 17 | Train Loss: 2.215 Vali Loss: 2.013 Vali Acc: 0.232 Test Loss: 2.013 Test Acc: 0.232
Validation loss decreased (inf --> -0.232412).  Saving model ...
Epoch: 2 cost time: 0.9079656600952148
Epoch: 2, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.688 Vali Acc: 0.751 Test Loss: 1.688 Test Acc: 0.751
Validation loss decreased (-0.232412 --> -0.751334).  Saving model ...
Epoch: 3 cost time: 1.0508263111114502
Epoch: 3, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.342 Vali Acc: 0.843 Test Loss: 1.342 Test Acc: 0.843
Validation loss decreased (-0.751334 --> -0.843230).  Saving model ...
Epoch: 4 cost time: 1.0164589881896973
Epoch: 4, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.058 Vali Acc: 0.868 Test Loss: 1.058 Test Acc: 0.868
Validation loss decreased (-0.843230 --> -0.867557).  Saving model ...
Epoch: 5 cost time: 0.9869403839111328
Epoch: 5, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.809 Vali Acc: 0.892 Test Loss: 0.809 Test Acc: 0.892
Validation loss decreased (-0.867557 --> -0.891884).  Saving model ...
Epoch: 6 cost time: 1.0229570865631104
Epoch: 6, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.615 Vali Acc: 0.908 Test Loss: 0.615 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908102).  Saving model ...
Epoch: 7 cost time: 0.9533746242523193
Epoch: 7, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.482 Vali Acc: 0.922 Test Loss: 0.482 Test Acc: 0.922
Validation loss decreased (-0.908102 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 0.9154706001281738
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.392 Vali Acc: 0.932 Test Loss: 0.392 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932429).  Saving model ...
Epoch: 9 cost time: 0.9596700668334961
Epoch: 9, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.932429 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 0.9930543899536133
Epoch: 10, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.940537 --> -0.954051).  Saving model ...
Epoch: 11 cost time: 0.9598994255065918
Epoch: 11, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 12 cost time: 1.0930566787719727
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.226 Vali Acc: 0.949 Test Loss: 0.226 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9595932960510254
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.196 Vali Acc: 0.968 Test Loss: 0.196 Test Acc: 0.968
Validation loss decreased (-0.959457 --> -0.967566).  Saving model ...
Epoch: 14 cost time: 0.9471375942230225
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0087611675262451
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8990383148193359
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0081779956817627
Epoch: 17, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9608359336853027
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9567856788635254
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9952218532562256
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9458053112030029
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.018723964691162
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.0363667011260986
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0450236797332764
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.007227897644043
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.020803689956665
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9501607418060303
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.946584939956665
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 29 cost time: 0.9616203308105469
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9390745162963867
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0592358112335205
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9899210929870605
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9840855598449707
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 0.991098165512085
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.029341459274292
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0775480270385742
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1504015922546387
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0944714546203613
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.001983642578125
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0544543266296387
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.065434217453003
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.047133207321167
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9694614410400391
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 108233
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8998708724975586
Epoch: 1, Steps: 17 | Train Loss: 2.209 Vali Loss: 2.031 Vali Acc: 0.224 Test Loss: 2.031 Test Acc: 0.224
Validation loss decreased (inf --> -0.224304).  Saving model ...
Epoch: 2 cost time: 1.1233890056610107
Epoch: 2, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.716 Vali Acc: 0.738 Test Loss: 1.716 Test Acc: 0.738
Validation loss decreased (-0.224304 --> -0.737821).  Saving model ...
Epoch: 3 cost time: 1.1238884925842285
Epoch: 3, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.375 Vali Acc: 0.827 Test Loss: 1.375 Test Acc: 0.827
Validation loss decreased (-0.737821 --> -0.827013).  Saving model ...
Epoch: 4 cost time: 1.0769002437591553
Epoch: 4, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.092 Vali Acc: 0.862 Test Loss: 1.092 Test Acc: 0.862
Validation loss decreased (-0.827013 --> -0.862151).  Saving model ...
Epoch: 5 cost time: 1.0548410415649414
Epoch: 5, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.838 Vali Acc: 0.892 Test Loss: 0.838 Test Acc: 0.892
Validation loss decreased (-0.862151 --> -0.891884).  Saving model ...
Epoch: 6 cost time: 0.9896116256713867
Epoch: 6, Steps: 17 | Train Loss: 0.659 Vali Loss: 0.639 Vali Acc: 0.916 Test Loss: 0.639 Test Acc: 0.916
Validation loss decreased (-0.891884 --> -0.916210).  Saving model ...
Epoch: 7 cost time: 1.0603139400482178
Epoch: 7, Steps: 17 | Train Loss: 0.478 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
Validation loss decreased (-0.916210 --> -0.921617).  Saving model ...
Epoch: 8 cost time: 1.0418903827667236
Epoch: 8, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.410 Vali Acc: 0.938 Test Loss: 0.410 Test Acc: 0.938
Validation loss decreased (-0.921617 --> -0.937834).  Saving model ...
Epoch: 9 cost time: 1.0134904384613037
Epoch: 9, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.347 Vali Acc: 0.935 Test Loss: 0.347 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.984076738357544
Epoch: 10, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.284 Vali Acc: 0.946 Test Loss: 0.284 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 1.015275001525879
Epoch: 11, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.253 Vali Acc: 0.949 Test Loss: 0.253 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.05033278465271
Epoch: 12, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2155306339263916
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.253913402557373
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1596901416778564
Epoch: 15, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 1.1716632843017578
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0325493812561035
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 18 cost time: 1.1514742374420166
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 19 cost time: 1.0921409130096436
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.0772879123687744
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.27297043800354
Epoch: 21, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.1910793781280518
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1728966236114502
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2166576385498047
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2136797904968262
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.2347049713134766
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2338268756866455
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0992374420166016
Epoch: 28, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 1.2155051231384277
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2330000400543213
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0660972595214844
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2459921836853027
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1896562576293945
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.1248488426208496
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1399176120758057
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1938807964324951
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1372675895690918
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2540373802185059
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3004157543182373
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.209778070449829
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0844697952270508
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1417973041534424
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.1497817039489746
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 108233
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.220477342605591
Epoch: 1, Steps: 17 | Train Loss: 2.194 Vali Loss: 2.059 Vali Acc: 0.208 Test Loss: 2.059 Test Acc: 0.208
Validation loss decreased (inf --> -0.208088).  Saving model ...
Epoch: 2 cost time: 1.0560553073883057
Epoch: 2, Steps: 17 | Train Loss: 1.917 Vali Loss: 1.787 Vali Acc: 0.727 Test Loss: 1.787 Test Acc: 0.727
Validation loss decreased (-0.208088 --> -0.727009).  Saving model ...
Epoch: 3 cost time: 1.008976697921753
Epoch: 3, Steps: 17 | Train Loss: 1.584 Vali Loss: 1.478 Vali Acc: 0.814 Test Loss: 1.478 Test Acc: 0.814
Validation loss decreased (-0.727009 --> -0.813499).  Saving model ...
Epoch: 4 cost time: 0.9191935062408447
Epoch: 4, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.196 Vali Acc: 0.878 Test Loss: 1.196 Test Acc: 0.878
Validation loss decreased (-0.813499 --> -0.878366).  Saving model ...
Epoch: 5 cost time: 1.1258490085601807
Epoch: 5, Steps: 17 | Train Loss: 0.974 Vali Loss: 0.937 Vali Acc: 0.895 Test Loss: 0.937 Test Acc: 0.895
Validation loss decreased (-0.878366 --> -0.894585).  Saving model ...
Epoch: 6 cost time: 0.9468958377838135
Epoch: 6, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.724 Vali Acc: 0.916 Test Loss: 0.724 Test Acc: 0.916
Validation loss decreased (-0.894585 --> -0.916209).  Saving model ...
Epoch: 7 cost time: 1.002182960510254
Epoch: 7, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.571 Vali Acc: 0.927 Test Loss: 0.571 Test Acc: 0.927
Validation loss decreased (-0.916209 --> -0.927021).  Saving model ...
Epoch: 8 cost time: 0.9514648914337158
Epoch: 8, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.473 Vali Acc: 0.935 Test Loss: 0.473 Test Acc: 0.935
Validation loss decreased (-0.927021 --> -0.935130).  Saving model ...
Epoch: 9 cost time: 0.9362430572509766
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.393 Vali Acc: 0.938 Test Loss: 0.393 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937834).  Saving model ...
Epoch: 10 cost time: 0.9182260036468506
Epoch: 10, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.325 Vali Acc: 0.946 Test Loss: 0.325 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 11 cost time: 1.0016093254089355
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.287 Vali Acc: 0.954 Test Loss: 0.287 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954051).  Saving model ...
Epoch: 12 cost time: 1.0156965255737305
Epoch: 12, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0004181861877441
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.220 Vali Acc: 0.957 Test Loss: 0.220 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 1.0966248512268066
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9731793403625488
Epoch: 15, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 16 cost time: 0.9817469120025635
Epoch: 16, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.0737884044647217
Epoch: 17, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 0.9473977088928223
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 0.8695354461669922
Epoch: 19, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.0104799270629883
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 21 cost time: 1.057596206665039
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 1.0429017543792725
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 23 cost time: 1.0405819416046143
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0269296169281006
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0274028778076172
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.059382677078247
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 0.9334521293640137
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.0394411087036133
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0755949020385742
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9946246147155762
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.0826103687286377
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.1024878025054932
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0854368209838867
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.0592105388641357
Epoch: 34, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0753746032714844
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0602929592132568
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.080472707748413
Epoch: 37, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0137169361114502
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0239644050598145
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0712146759033203
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0317659378051758
Epoch: 41, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9877488613128662
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0990378856658936
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 108233
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.769865036010742
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.073 Vali Acc: 0.270 Test Loss: 2.073 Test Acc: 0.270
Validation loss decreased (inf --> -0.270250).  Saving model ...
Epoch: 2 cost time: 1.076216459274292
Epoch: 2, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.738 Vali Acc: 0.608 Test Loss: 1.738 Test Acc: 0.608
Validation loss decreased (-0.270250 --> -0.608091).  Saving model ...
Epoch: 3 cost time: 0.9737145900726318
Epoch: 3, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.388 Vali Acc: 0.800 Test Loss: 1.388 Test Acc: 0.800
Validation loss decreased (-0.608091 --> -0.799986).  Saving model ...
Epoch: 4 cost time: 1.0186431407928467
Epoch: 4, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.074 Vali Acc: 0.849 Test Loss: 1.074 Test Acc: 0.849
Validation loss decreased (-0.799986 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 0.9896895885467529
Epoch: 5, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.820 Vali Acc: 0.862 Test Loss: 0.820 Test Acc: 0.862
Validation loss decreased (-0.848638 --> -0.862154).  Saving model ...
Epoch: 6 cost time: 1.0089199542999268
Epoch: 6, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.634 Vali Acc: 0.903 Test Loss: 0.634 Test Acc: 0.903
Validation loss decreased (-0.862154 --> -0.902696).  Saving model ...
Epoch: 7 cost time: 0.9173910617828369
Epoch: 7, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.492 Vali Acc: 0.924 Test Loss: 0.492 Test Acc: 0.924
Validation loss decreased (-0.902696 --> -0.924319).  Saving model ...
Epoch: 8 cost time: 0.9857544898986816
Epoch: 8, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.397 Vali Acc: 0.946 Test Loss: 0.397 Test Acc: 0.946
Validation loss decreased (-0.924319 --> -0.945942).  Saving model ...
Epoch: 9 cost time: 1.0364875793457031
Epoch: 9, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.343 Vali Acc: 0.941 Test Loss: 0.343 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9534120559692383
Epoch: 10, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8277709484100342
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.254 Vali Acc: 0.951 Test Loss: 0.254 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951349).  Saving model ...
Epoch: 12 cost time: 1.0560615062713623
Epoch: 12, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.226 Vali Acc: 0.954 Test Loss: 0.226 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 13 cost time: 0.9627842903137207
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 14 cost time: 1.152766466140747
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1633381843566895
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 16 cost time: 0.9797916412353516
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 1.0484981536865234
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 0.9963068962097168
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9745848178863525
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.0605041980743408
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0324287414550781
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 0.998255729675293
Epoch: 22, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.0010132789611816
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 24 cost time: 1.046360731124878
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.0319359302520752
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0565781593322754
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8857941627502441
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9621772766113281
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.0392708778381348
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 0.8764739036560059
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9257392883300781
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 0.8903560638427734
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9303100109100342
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.0226080417633057
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 1.1084880828857422
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1015346050262451
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.968846321105957
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9759650230407715
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 1.0179572105407715
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8491692543029785
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9972085952758789
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.077787160873413
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1614320278167725
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1939456462860107
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2492525577545166
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.2063474655151367
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0564897060394287
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0906529426574707
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1029057502746582
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9314107894897461
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.030693531036377
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0666728019714355
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0012555122375488
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.0001013278961182
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0412302017211914
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 91849
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8350939750671387
Epoch: 1, Steps: 17 | Train Loss: 2.218 Vali Loss: 2.067 Vali Acc: 0.276 Test Loss: 2.067 Test Acc: 0.276
Validation loss decreased (inf --> -0.275655).  Saving model ...
Epoch: 2 cost time: 0.9508495330810547
Epoch: 2, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.737 Vali Acc: 0.595 Test Loss: 1.737 Test Acc: 0.595
Validation loss decreased (-0.275655 --> -0.594577).  Saving model ...
Epoch: 3 cost time: 1.0770411491394043
Epoch: 3, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.389 Vali Acc: 0.811 Test Loss: 1.389 Test Acc: 0.811
Validation loss decreased (-0.594577 --> -0.810797).  Saving model ...
Epoch: 4 cost time: 1.090205430984497
Epoch: 4, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.078 Vali Acc: 0.849 Test Loss: 1.078 Test Acc: 0.849
Validation loss decreased (-0.810797 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 1.0810143947601318
Epoch: 5, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.823 Vali Acc: 0.865 Test Loss: 0.823 Test Acc: 0.865
Validation loss decreased (-0.848638 --> -0.864857).  Saving model ...
Epoch: 6 cost time: 0.942833662033081
Epoch: 6, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.637 Vali Acc: 0.897 Test Loss: 0.637 Test Acc: 0.897
Validation loss decreased (-0.864857 --> -0.897291).  Saving model ...
Epoch: 7 cost time: 1.0763328075408936
Epoch: 7, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.497 Vali Acc: 0.919 Test Loss: 0.497 Test Acc: 0.919
Validation loss decreased (-0.897291 --> -0.918914).  Saving model ...
Epoch: 8 cost time: 0.9430503845214844
Epoch: 8, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.400 Vali Acc: 0.932 Test Loss: 0.400 Test Acc: 0.932
Validation loss decreased (-0.918914 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 1.0150201320648193
Epoch: 9, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.346 Vali Acc: 0.938 Test Loss: 0.346 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 10 cost time: 1.0248093605041504
Epoch: 10, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940538).  Saving model ...
Epoch: 11 cost time: 1.1046109199523926
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.257 Vali Acc: 0.949 Test Loss: 0.257 Test Acc: 0.949
Validation loss decreased (-0.940538 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.1106376647949219
Epoch: 12, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 13 cost time: 0.8724730014801025
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 14 cost time: 1.0787088871002197
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 15 cost time: 1.0463528633117676
Epoch: 15, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0188944339752197
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 17 cost time: 1.122253656387329
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.1153671741485596
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0540330410003662
Epoch: 19, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 20 cost time: 1.064737319946289
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1098406314849854
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.020690679550171
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0846896171569824
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1632213592529297
Epoch: 24, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1331915855407715
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1558887958526611
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 27 cost time: 1.0614635944366455
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0429978370666504
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 29 cost time: 1.0526812076568604
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0587530136108398
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.089608907699585
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0009305477142334
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 33 cost time: 0.9678540229797363
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.07722806930542
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 35 cost time: 1.047532320022583
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0837557315826416
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1596534252166748
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.0515296459197998
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1185543537139893
Epoch: 39, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0817651748657227
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1390066146850586
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 0.9874489307403564
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0691120624542236
Epoch: 43, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0650255680084229
Epoch: 44, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0451288223266602
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.0829827785491943
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8398504257202148
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9389593601226807
Epoch: 48, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9778444766998291
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9754445552825928
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0810222625732422
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0646147727966309
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9831621646881104
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.964653730392456
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.970982551574707
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 91849
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7663912773132324
Epoch: 1, Steps: 17 | Train Loss: 2.202 Vali Loss: 2.067 Vali Acc: 0.273 Test Loss: 2.067 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 1.0780508518218994
Epoch: 2, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.750 Vali Acc: 0.608 Test Loss: 1.750 Test Acc: 0.608
Validation loss decreased (-0.272952 --> -0.608091).  Saving model ...
Epoch: 3 cost time: 1.141434907913208
Epoch: 3, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.411 Vali Acc: 0.816 Test Loss: 1.411 Test Acc: 0.816
Validation loss decreased (-0.608091 --> -0.816202).  Saving model ...
Epoch: 4 cost time: 1.1245818138122559
Epoch: 4, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.100 Vali Acc: 0.849 Test Loss: 1.100 Test Acc: 0.849
Validation loss decreased (-0.816202 --> -0.848638).  Saving model ...
Epoch: 5 cost time: 1.0936198234558105
Epoch: 5, Steps: 17 | Train Loss: 0.903 Vali Loss: 0.843 Vali Acc: 0.876 Test Loss: 0.843 Test Acc: 0.876
Validation loss decreased (-0.848638 --> -0.875667).  Saving model ...
Epoch: 6 cost time: 1.132098913192749
Epoch: 6, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.654 Vali Acc: 0.914 Test Loss: 0.654 Test Acc: 0.914
Validation loss decreased (-0.875667 --> -0.913507).  Saving model ...
Epoch: 7 cost time: 1.120779275894165
Epoch: 7, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.512 Vali Acc: 0.927 Test Loss: 0.512 Test Acc: 0.927
Validation loss decreased (-0.913507 --> -0.927022).  Saving model ...
Epoch: 8 cost time: 1.0297796726226807
Epoch: 8, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.412 Vali Acc: 0.935 Test Loss: 0.412 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 9 cost time: 1.0516667366027832
Epoch: 9, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 10 cost time: 1.0552096366882324
Epoch: 10, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.308 Vali Acc: 0.941 Test Loss: 0.308 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 11 cost time: 1.0253973007202148
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.263 Vali Acc: 0.943 Test Loss: 0.263 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 1.0590009689331055
Epoch: 12, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
Validation loss decreased (-0.943241 --> -0.956754).  Saving model ...
Epoch: 13 cost time: 1.1380157470703125
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0922157764434814
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.1058382987976074
Epoch: 15, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2214841842651367
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 17 cost time: 1.0925965309143066
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 18 cost time: 1.232757806777954
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0079147815704346
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.130490779876709
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0553300380706787
Epoch: 21, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 0.9703507423400879
Epoch: 22, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.0855050086975098
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 24 cost time: 1.496345043182373
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.26544189453125
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4734344482421875
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3938121795654297
Epoch: 27, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.5245182514190674
Epoch: 28, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 1.4513888359069824
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0704545974731445
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.393280267715454
Epoch: 31, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1824312210083008
Epoch: 32, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.441114902496338
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.2065930366516113
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9966573715209961
Epoch: 35, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4428772926330566
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3240435123443604
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3335716724395752
Epoch: 38, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4159636497497559
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.058281660079956
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5660927295684814
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.2653248310089111
Epoch: 42, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5349700450897217
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4881689548492432
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.492278814315796
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 46 cost time: 1.409386157989502
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.18642258644104
Epoch: 47, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.345266342163086
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0998592376708984
Epoch: 49, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3834733963012695
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.1243925094604492
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0633540153503418
Epoch: 52, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0823192596435547
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1383826732635498
Epoch: 54, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0799384117126465
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 91849
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.988220691680908
Epoch: 1, Steps: 17 | Train Loss: 2.178 Vali Loss: 2.066 Vali Acc: 0.254 Test Loss: 2.066 Test Acc: 0.254
Validation loss decreased (inf --> -0.254033).  Saving model ...
Epoch: 2 cost time: 1.2962148189544678
Epoch: 2, Steps: 17 | Train Loss: 1.932 Vali Loss: 1.795 Vali Acc: 0.614 Test Loss: 1.795 Test Acc: 0.614
Validation loss decreased (-0.254033 --> -0.613496).  Saving model ...
Epoch: 3 cost time: 0.9935033321380615
Epoch: 3, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.491 Vali Acc: 0.784 Test Loss: 1.491 Test Acc: 0.784
Validation loss decreased (-0.613496 --> -0.783769).  Saving model ...
Epoch: 4 cost time: 1.2803707122802734
Epoch: 4, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.195 Vali Acc: 0.865 Test Loss: 1.195 Test Acc: 0.865
Validation loss decreased (-0.783769 --> -0.864853).  Saving model ...
Epoch: 5 cost time: 1.1793906688690186
Epoch: 5, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.933 Vali Acc: 0.878 Test Loss: 0.933 Test Acc: 0.878
Validation loss decreased (-0.864853 --> -0.878369).  Saving model ...
Epoch: 6 cost time: 0.9618878364562988
Epoch: 6, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.730 Vali Acc: 0.897 Test Loss: 0.730 Test Acc: 0.897
Validation loss decreased (-0.878369 --> -0.897290).  Saving model ...
Epoch: 7 cost time: 1.1459507942199707
Epoch: 7, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.582 Vali Acc: 0.908 Test Loss: 0.582 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 8 cost time: 1.2336740493774414
Epoch: 8, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.471 Vali Acc: 0.932 Test Loss: 0.471 Test Acc: 0.932
Validation loss decreased (-0.908102 --> -0.932428).  Saving model ...
Epoch: 9 cost time: 1.071686029434204
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.401 Vali Acc: 0.935 Test Loss: 0.401 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 10 cost time: 1.2299981117248535
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.349 Vali Acc: 0.935 Test Loss: 0.349 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 11 cost time: 1.2379937171936035
Epoch: 11, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.292 Vali Acc: 0.949 Test Loss: 0.292 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.148664951324463
Epoch: 12, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.259 Vali Acc: 0.954 Test Loss: 0.259 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954051).  Saving model ...
Epoch: 13 cost time: 1.2280921936035156
Epoch: 13, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.238 Vali Acc: 0.951 Test Loss: 0.238 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0066440105438232
Epoch: 14, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.211 Vali Acc: 0.957 Test Loss: 0.211 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 15 cost time: 1.2522597312927246
Epoch: 15, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2352049350738525
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 17 cost time: 1.0515220165252686
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 18 cost time: 1.2089617252349854
Epoch: 18, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.954 Test Loss: 0.164 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1284873485565186
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 20 cost time: 1.0481746196746826
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.229398488998413
Epoch: 21, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2913806438446045
Epoch: 22, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 23 cost time: 1.2191236019134521
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 24 cost time: 1.2333483695983887
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 25 cost time: 0.9951221942901611
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3031604290008545
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0258545875549316
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9660801887512207
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1014301776885986
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9630084037780762
Epoch: 30, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.281409740447998
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.286573886871338
Epoch: 32, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2755765914916992
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.1283044815063477
Epoch: 34, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2194113731384277
Epoch: 35, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2241194248199463
Epoch: 36, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1305389404296875
Epoch: 37, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8950092792510986
Epoch: 38, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1859302520751953
Epoch: 39, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8502621650695801
Epoch: 40, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2139534950256348
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.0414459705352783
Epoch: 42, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2826030254364014
Epoch: 43, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.206010103225708
Epoch: 44, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2807378768920898
Epoch: 45, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 46 cost time: 1.2721621990203857
Epoch: 46, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.376849889755249
Epoch: 47, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.174501657485962
Epoch: 48, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0263826847076416
Epoch: 49, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2795498371124268
Epoch: 50, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0897247791290283
Epoch: 51, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0710010528564453
Epoch: 52, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.1177265644073486
Epoch: 53, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.96244215965271
Epoch: 54, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2107863426208496
Epoch: 55, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 91849
model size : 2.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.2849385738372803
Epoch: 1, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.136 Vali Acc: 0.173 Test Loss: 2.136 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 1.121778964996338
Epoch: 2, Steps: 17 | Train Loss: 1.997 Vali Loss: 1.926 Vali Acc: 0.349 Test Loss: 1.926 Test Acc: 0.349
Validation loss decreased (-0.172952 --> -0.348629).  Saving model ...
Epoch: 3 cost time: 1.4073011875152588
Epoch: 3, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.705 Vali Acc: 0.608 Test Loss: 1.705 Test Acc: 0.608
Validation loss decreased (-0.348629 --> -0.608091).  Saving model ...
Epoch: 4 cost time: 0.9862194061279297
Epoch: 4, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.476 Vali Acc: 0.738 Test Loss: 1.476 Test Acc: 0.738
Validation loss decreased (-0.608091 --> -0.737823).  Saving model ...
Epoch: 5 cost time: 0.9350697994232178
Epoch: 5, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.258 Vali Acc: 0.770 Test Loss: 1.258 Test Acc: 0.770
Validation loss decreased (-0.737823 --> -0.770258).  Saving model ...
Epoch: 6 cost time: 0.9804131984710693
Epoch: 6, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.070 Vali Acc: 0.808 Test Loss: 1.070 Test Acc: 0.808
Validation loss decreased (-0.770258 --> -0.808097).  Saving model ...
Epoch: 7 cost time: 0.939171552658081
Epoch: 7, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.892 Vali Acc: 0.846 Test Loss: 0.892 Test Acc: 0.846
Validation loss decreased (-0.808097 --> -0.845937).  Saving model ...
Epoch: 8 cost time: 0.9981515407562256
Epoch: 8, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.750 Vali Acc: 0.854 Test Loss: 0.750 Test Acc: 0.854
Validation loss decreased (-0.845937 --> -0.854047).  Saving model ...
Epoch: 9 cost time: 1.1301696300506592
Epoch: 9, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.635 Vali Acc: 0.897 Test Loss: 0.635 Test Acc: 0.897
Validation loss decreased (-0.854047 --> -0.897291).  Saving model ...
Epoch: 10 cost time: 1.320385456085205
Epoch: 10, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.529 Vali Acc: 0.908 Test Loss: 0.529 Test Acc: 0.908
Validation loss decreased (-0.897291 --> -0.908103).  Saving model ...
Epoch: 11 cost time: 1.2690529823303223
Epoch: 11, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.464 Vali Acc: 0.927 Test Loss: 0.464 Test Acc: 0.927
Validation loss decreased (-0.908103 --> -0.927022).  Saving model ...
Epoch: 12 cost time: 1.4088122844696045
Epoch: 12, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.402 Vali Acc: 0.932 Test Loss: 0.402 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 13 cost time: 1.282153844833374
Epoch: 13, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.360 Vali Acc: 0.943 Test Loss: 0.360 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943240).  Saving model ...
Epoch: 14 cost time: 1.3874218463897705
Epoch: 14, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.316 Vali Acc: 0.949 Test Loss: 0.316 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948645).  Saving model ...
Epoch: 15 cost time: 1.1121845245361328
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.286 Vali Acc: 0.951 Test Loss: 0.286 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 16 cost time: 1.3554909229278564
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.261 Vali Acc: 0.951 Test Loss: 0.261 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 1.2668147087097168
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 0.9806408882141113
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.218 Vali Acc: 0.954 Test Loss: 0.218 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.2861828804016113
Epoch: 19, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.05659818649292
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.197 Vali Acc: 0.951 Test Loss: 0.197 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.212632417678833
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1638867855072021
Epoch: 22, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2054846286773682
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.165 Vali Acc: 0.954 Test Loss: 0.165 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 24 cost time: 0.9560167789459229
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 1.2063686847686768
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 0.9917788505554199
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 27 cost time: 1.3023240566253662
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 0.9446704387664795
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 29 cost time: 1.3473830223083496
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 1.3444366455078125
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.398848533630371
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.954 Test Loss: 0.131 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3122656345367432
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 33 cost time: 1.2705175876617432
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.2501952648162842
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3078603744506836
Epoch: 35, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 1.2376930713653564
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 1.2114291191101074
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.150059461593628
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 1.1829545497894287
Epoch: 39, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3612079620361328
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.299410343170166
Epoch: 41, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.4203073978424072
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 43 cost time: 1.294431209564209
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3753247261047363
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.1851551532745361
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.460120439529419
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 47 cost time: 0.9771084785461426
Epoch: 47, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 48 cost time: 1.3415818214416504
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0149188041687012
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.4341678619384766
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 51 cost time: 1.0209476947784424
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.380436658859253
Epoch: 52, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0375280380249023
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1150739192962646
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0415034294128418
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 56 cost time: 1.1593289375305176
Epoch: 56, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1498687267303467
Epoch: 57, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4436101913452148
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3554871082305908
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.3580198287963867
Epoch: 60, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.4959163665771484
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.5191764831542969
Epoch: 62, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.4444284439086914
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.4143800735473633
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.3972394466400146
Epoch: 65, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 291721
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6362617015838623
Epoch: 1, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.131 Vali Acc: 0.173 Test Loss: 2.131 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 1.451284408569336
Epoch: 2, Steps: 17 | Train Loss: 2.002 Vali Loss: 1.925 Vali Acc: 0.351 Test Loss: 1.925 Test Acc: 0.351
Validation loss decreased (-0.172952 --> -0.351332).  Saving model ...
Epoch: 3 cost time: 1.4238998889923096
Epoch: 3, Steps: 17 | Train Loss: 1.786 Vali Loss: 1.708 Vali Acc: 0.600 Test Loss: 1.708 Test Acc: 0.600
Validation loss decreased (-0.351332 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 1.5404860973358154
Epoch: 4, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.481 Vali Acc: 0.743 Test Loss: 1.481 Test Acc: 0.743
Validation loss decreased (-0.599983 --> -0.743228).  Saving model ...
Epoch: 5 cost time: 1.3340189456939697
Epoch: 5, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.263 Vali Acc: 0.773 Test Loss: 1.263 Test Acc: 0.773
Validation loss decreased (-0.743228 --> -0.772960).  Saving model ...
Epoch: 6 cost time: 1.1276593208312988
Epoch: 6, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.077 Vali Acc: 0.816 Test Loss: 1.077 Test Acc: 0.816
Validation loss decreased (-0.772960 --> -0.816205).  Saving model ...
Epoch: 7 cost time: 1.2508971691131592
Epoch: 7, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.898 Vali Acc: 0.849 Test Loss: 0.898 Test Acc: 0.849
Validation loss decreased (-0.816205 --> -0.848640).  Saving model ...
Epoch: 8 cost time: 1.0104930400848389
Epoch: 8, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.756 Vali Acc: 0.859 Test Loss: 0.756 Test Acc: 0.859
Validation loss decreased (-0.848640 --> -0.859452).  Saving model ...
Epoch: 9 cost time: 1.0341711044311523
Epoch: 9, Steps: 17 | Train Loss: 0.610 Vali Loss: 0.641 Vali Acc: 0.884 Test Loss: 0.641 Test Acc: 0.884
Validation loss decreased (-0.859452 --> -0.883777).  Saving model ...
Epoch: 10 cost time: 1.1981499195098877
Epoch: 10, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.534 Vali Acc: 0.914 Test Loss: 0.534 Test Acc: 0.914
Validation loss decreased (-0.883777 --> -0.913508).  Saving model ...
Epoch: 11 cost time: 1.2693016529083252
Epoch: 11, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.470 Vali Acc: 0.927 Test Loss: 0.470 Test Acc: 0.927
Validation loss decreased (-0.913508 --> -0.927022).  Saving model ...
Epoch: 12 cost time: 1.178870677947998
Epoch: 12, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.407 Vali Acc: 0.932 Test Loss: 0.407 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 13 cost time: 1.0595338344573975
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
Validation loss decreased (-0.932428 --> -0.940537).  Saving model ...
Epoch: 14 cost time: 1.415858268737793
Epoch: 14, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.320 Vali Acc: 0.946 Test Loss: 0.320 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 15 cost time: 1.3023655414581299
Epoch: 15, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.288 Vali Acc: 0.949 Test Loss: 0.288 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 16 cost time: 1.4802563190460205
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.262 Vali Acc: 0.951 Test Loss: 0.262 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 1.495823860168457
Epoch: 17, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.241 Vali Acc: 0.954 Test Loss: 0.241 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.2823102474212646
Epoch: 18, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.4983954429626465
Epoch: 19, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.997887134552002
Epoch: 20, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
Validation loss decreased (-0.954052 --> -0.962160).  Saving model ...
Epoch: 21 cost time: 1.40330171585083
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.109809160232544
Epoch: 22, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4087491035461426
Epoch: 23, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2528674602508545
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4776675701141357
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3306138515472412
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0933334827423096
Epoch: 27, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1902413368225098
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 1.1952855587005615
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.962161 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.1878993511199951
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.021772861480713
Epoch: 31, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0736536979675293
Epoch: 32, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.070324182510376
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.4636521339416504
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1049983501434326
Epoch: 35, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 36 cost time: 1.415996789932251
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 37 cost time: 1.111856460571289
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 38 cost time: 1.4649789333343506
Epoch: 38, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 39 cost time: 1.1702327728271484
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4614965915679932
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0301709175109863
Epoch: 41, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4666669368743896
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.338219404220581
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.516127109527588
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.4058821201324463
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.5016369819641113
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.422361135482788
Epoch: 47, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.5329563617706299
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 291721
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.079240322113037
Epoch: 1, Steps: 17 | Train Loss: 2.168 Vali Loss: 2.144 Vali Acc: 0.173 Test Loss: 2.144 Test Acc: 0.173
Validation loss decreased (inf --> -0.172952).  Saving model ...
Epoch: 2 cost time: 1.186455488204956
Epoch: 2, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.950 Vali Acc: 0.338 Test Loss: 1.950 Test Acc: 0.338
Validation loss decreased (-0.172952 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 1.0214574337005615
Epoch: 3, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.742 Vali Acc: 0.576 Test Loss: 1.742 Test Acc: 0.576
Validation loss decreased (-0.337818 --> -0.575658).  Saving model ...
Epoch: 4 cost time: 1.1781857013702393
Epoch: 4, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.521 Vali Acc: 0.730 Test Loss: 1.521 Test Acc: 0.730
Validation loss decreased (-0.575658 --> -0.729715).  Saving model ...
Epoch: 5 cost time: 1.3814873695373535
Epoch: 5, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.306 Vali Acc: 0.768 Test Loss: 1.306 Test Acc: 0.768
Validation loss decreased (-0.729715 --> -0.767555).  Saving model ...
Epoch: 6 cost time: 1.2261855602264404
Epoch: 6, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.116 Vali Acc: 0.805 Test Loss: 1.116 Test Acc: 0.805
Validation loss decreased (-0.767555 --> -0.805394).  Saving model ...
Epoch: 7 cost time: 1.3234350681304932
Epoch: 7, Steps: 17 | Train Loss: 0.917 Vali Loss: 0.936 Vali Acc: 0.843 Test Loss: 0.936 Test Acc: 0.843
Validation loss decreased (-0.805394 --> -0.843234).  Saving model ...
Epoch: 8 cost time: 1.281407356262207
Epoch: 8, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.789 Vali Acc: 0.862 Test Loss: 0.789 Test Acc: 0.862
Validation loss decreased (-0.843234 --> -0.862154).  Saving model ...
Epoch: 9 cost time: 1.2828304767608643
Epoch: 9, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.673 Vali Acc: 0.903 Test Loss: 0.673 Test Acc: 0.903
Validation loss decreased (-0.862154 --> -0.902696).  Saving model ...
Epoch: 10 cost time: 0.8825218677520752
Epoch: 10, Steps: 17 | Train Loss: 0.512 Vali Loss: 0.563 Vali Acc: 0.908 Test Loss: 0.563 Test Acc: 0.908
Validation loss decreased (-0.902696 --> -0.908102).  Saving model ...
Epoch: 11 cost time: 1.185250997543335
Epoch: 11, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.495 Vali Acc: 0.932 Test Loss: 0.495 Test Acc: 0.932
Validation loss decreased (-0.908102 --> -0.932427).  Saving model ...
Epoch: 12 cost time: 0.9115335941314697
Epoch: 12, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.429 Vali Acc: 0.941 Test Loss: 0.429 Test Acc: 0.941
Validation loss decreased (-0.932427 --> -0.940536).  Saving model ...
Epoch: 13 cost time: 0.9184942245483398
Epoch: 13, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.384 Vali Acc: 0.949 Test Loss: 0.384 Test Acc: 0.949
Validation loss decreased (-0.940536 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 0.9630956649780273
Epoch: 14, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.339 Vali Acc: 0.951 Test Loss: 0.339 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.0118827819824219
Epoch: 15, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.304 Vali Acc: 0.951 Test Loss: 0.304 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 16 cost time: 1.2907021045684814
Epoch: 16, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951349).  Saving model ...
Epoch: 17 cost time: 1.232280969619751
Epoch: 17, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.253 Vali Acc: 0.954 Test Loss: 0.253 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.2246131896972656
Epoch: 18, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 1.153503656387329
Epoch: 19, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.221 Vali Acc: 0.954 Test Loss: 0.221 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3201448917388916
Epoch: 20, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 21 cost time: 1.218409776687622
Epoch: 21, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2883975505828857
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.163700819015503
Epoch: 23, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.1441421508789062
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.0584709644317627
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 1.2294416427612305
Epoch: 26, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0644395351409912
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 28 cost time: 1.3023135662078857
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9931223392486572
Epoch: 29, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 30 cost time: 1.2063207626342773
Epoch: 30, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 31 cost time: 1.011747121810913
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.954 Test Loss: 0.130 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2278952598571777
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 33 cost time: 1.0732321739196777
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.2402617931365967
Epoch: 34, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2348415851593018
Epoch: 35, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2925093173980713
Epoch: 36, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 37 cost time: 1.290161371231079
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.2553834915161133
Epoch: 38, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2242724895477295
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.010594129562378
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9336307048797607
Epoch: 41, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0080671310424805
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9676287174224854
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8987812995910645
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1187560558319092
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1599433422088623
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 1.3326914310455322
Epoch: 47, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1110901832580566
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2492539882659912
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0343003273010254
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.296220064163208
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1645903587341309
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.1832482814788818
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.186525583267212
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 55 cost time: 1.2617108821868896
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 56 cost time: 1.1116321086883545
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0778961181640625
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.1849865913391113
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.270488977432251
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9178218841552734
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1804192066192627
Epoch: 61, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9685423374176025
Epoch: 62, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.965 Test Loss: 0.092 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.150376558303833
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0047481060028076
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.1325831413269043
Epoch: 65, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 291721
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.90934681892395
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.167 Vali Acc: 0.111 Test Loss: 2.167 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 1.0963852405548096
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 2.006 Vali Acc: 0.316 Test Loss: 2.006 Test Acc: 0.316
Validation loss decreased (-0.110789 --> -0.316196).  Saving model ...
Epoch: 3 cost time: 1.0976617336273193
Epoch: 3, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.821 Vali Acc: 0.565 Test Loss: 1.821 Test Acc: 0.565
Validation loss decreased (-0.316196 --> -0.564847).  Saving model ...
Epoch: 4 cost time: 1.1044299602508545
Epoch: 4, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.617 Vali Acc: 0.722 Test Loss: 1.617 Test Acc: 0.722
Validation loss decreased (-0.564847 --> -0.721605).  Saving model ...
Epoch: 5 cost time: 0.9302959442138672
Epoch: 5, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.407 Vali Acc: 0.778 Test Loss: 1.407 Test Acc: 0.778
Validation loss decreased (-0.721605 --> -0.778364).  Saving model ...
Epoch: 6 cost time: 1.1171436309814453
Epoch: 6, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.213 Vali Acc: 0.830 Test Loss: 1.213 Test Acc: 0.830
Validation loss decreased (-0.778364 --> -0.829718).  Saving model ...
Epoch: 7 cost time: 0.9943346977233887
Epoch: 7, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.029 Vali Acc: 0.846 Test Loss: 1.029 Test Acc: 0.846
Validation loss decreased (-0.829718 --> -0.845936).  Saving model ...
Epoch: 8 cost time: 1.1329116821289062
Epoch: 8, Steps: 17 | Train Loss: 0.849 Vali Loss: 0.876 Vali Acc: 0.870 Test Loss: 0.876 Test Acc: 0.870
Validation loss decreased (-0.845936 --> -0.870262).  Saving model ...
Epoch: 9 cost time: 1.0846283435821533
Epoch: 9, Steps: 17 | Train Loss: 0.721 Vali Loss: 0.749 Vali Acc: 0.900 Test Loss: 0.749 Test Acc: 0.900
Validation loss decreased (-0.870262 --> -0.899993).  Saving model ...
Epoch: 10 cost time: 1.1989631652832031
Epoch: 10, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.626 Vali Acc: 0.914 Test Loss: 0.626 Test Acc: 0.914
Validation loss decreased (-0.899993 --> -0.913507).  Saving model ...
Epoch: 11 cost time: 1.2506179809570312
Epoch: 11, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.544 Vali Acc: 0.922 Test Loss: 0.544 Test Acc: 0.922
Validation loss decreased (-0.913507 --> -0.921616).  Saving model ...
Epoch: 12 cost time: 1.2305383682250977
Epoch: 12, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 13 cost time: 1.2455785274505615
Epoch: 13, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.419 Vali Acc: 0.935 Test Loss: 0.419 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 14 cost time: 0.9403939247131348
Epoch: 14, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.371 Vali Acc: 0.941 Test Loss: 0.371 Test Acc: 0.941
Validation loss decreased (-0.935131 --> -0.940537).  Saving model ...
Epoch: 15 cost time: 0.918267011642456
Epoch: 15, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.329 Vali Acc: 0.946 Test Loss: 0.329 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 0.8771696090698242
Epoch: 16, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.294 Vali Acc: 0.949 Test Loss: 0.294 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 0.9154047966003418
Epoch: 17, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.270 Vali Acc: 0.946 Test Loss: 0.270 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2514948844909668
Epoch: 18, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2414042949676514
Epoch: 19, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.232 Vali Acc: 0.954 Test Loss: 0.232 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 0.9697003364562988
Epoch: 20, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0610723495483398
Epoch: 21, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 22 cost time: 1.1567277908325195
Epoch: 22, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 1.297332763671875
Epoch: 23, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.176 Vali Acc: 0.965 Test Loss: 0.176 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 1.2193982601165771
Epoch: 24, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 1.2694926261901855
Epoch: 25, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0856988430023193
Epoch: 26, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.3173859119415283
Epoch: 27, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2546272277832031
Epoch: 28, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.2209675312042236
Epoch: 29, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.1422793865203857
Epoch: 30, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9386756420135498
Epoch: 31, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9616279602050781
Epoch: 32, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.1399130821228027
Epoch: 33, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1423630714416504
Epoch: 34, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1760869026184082
Epoch: 35, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2819523811340332
Epoch: 36, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9374511241912842
Epoch: 37, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.2845909595489502
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.282930850982666
Epoch: 39, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 40 cost time: 0.9372012615203857
Epoch: 40, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 1.1952769756317139
Epoch: 41, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0924091339111328
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0318470001220703
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1916766166687012
Epoch: 44, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1775665283203125
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 46 cost time: 1.1368086338043213
Epoch: 46, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 1.2742598056793213
Epoch: 47, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1087098121643066
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 49 cost time: 1.2808849811553955
Epoch: 49, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 50 cost time: 0.9395527839660645
Epoch: 50, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 51 cost time: 1.259091854095459
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0415101051330566
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2503125667572021
Epoch: 53, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.256399154663086
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0327227115631104
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 56 cost time: 1.2336201667785645
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.0429201126098633
Epoch: 57, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0919513702392578
Epoch: 58, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0965425968170166
Epoch: 59, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8682045936584473
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.13043212890625
Epoch: 61, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1639692783355713
Epoch: 62, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.210827112197876
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.1139814853668213
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.9314615726470947
Epoch: 65, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 291721
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.211178779602051
Epoch: 1, Steps: 17 | Train Loss: 2.235 Vali Loss: 2.164 Vali Acc: 0.154 Test Loss: 2.164 Test Acc: 0.154
Validation loss decreased (inf --> -0.154032).  Saving model ...
Epoch: 2 cost time: 1.4425992965698242
Epoch: 2, Steps: 17 | Train Loss: 2.074 Vali Loss: 1.972 Vali Acc: 0.419 Test Loss: 1.972 Test Acc: 0.419
Validation loss decreased (-0.154032 --> -0.418899).  Saving model ...
Epoch: 3 cost time: 1.0555670261383057
Epoch: 3, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.744 Vali Acc: 0.668 Test Loss: 1.744 Test Acc: 0.668
Validation loss decreased (-0.418899 --> -0.667550).  Saving model ...
Epoch: 4 cost time: 1.343714952468872
Epoch: 4, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.499 Vali Acc: 0.754 Test Loss: 1.499 Test Acc: 0.754
Validation loss decreased (-0.667550 --> -0.754039).  Saving model ...
Epoch: 5 cost time: 1.1993191242218018
Epoch: 5, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.291 Vali Acc: 0.786 Test Loss: 1.291 Test Acc: 0.786
Validation loss decreased (-0.754039 --> -0.786474).  Saving model ...
Epoch: 6 cost time: 0.938584566116333
Epoch: 6, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.079 Vali Acc: 0.824 Test Loss: 1.079 Test Acc: 0.824
Validation loss decreased (-0.786474 --> -0.824314).  Saving model ...
Epoch: 7 cost time: 1.2415156364440918
Epoch: 7, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.889 Vali Acc: 0.849 Test Loss: 0.889 Test Acc: 0.849
Validation loss decreased (-0.824314 --> -0.848640).  Saving model ...
Epoch: 8 cost time: 1.058537483215332
Epoch: 8, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.742 Vali Acc: 0.870 Test Loss: 0.742 Test Acc: 0.870
Validation loss decreased (-0.848640 --> -0.870263).  Saving model ...
Epoch: 9 cost time: 1.2432069778442383
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.623 Vali Acc: 0.897 Test Loss: 0.623 Test Acc: 0.897
Validation loss decreased (-0.870263 --> -0.897291).  Saving model ...
Epoch: 10 cost time: 1.0477256774902344
Epoch: 10, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.525 Vali Acc: 0.919 Test Loss: 0.525 Test Acc: 0.919
Validation loss decreased (-0.897291 --> -0.918914).  Saving model ...
Epoch: 11 cost time: 1.2180120944976807
Epoch: 11, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.466 Vali Acc: 0.941 Test Loss: 0.466 Test Acc: 0.941
Validation loss decreased (-0.918914 --> -0.940536).  Saving model ...
Epoch: 12 cost time: 1.0216991901397705
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.402 Vali Acc: 0.946 Test Loss: 0.402 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 0.9940009117126465
Epoch: 13, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.361 Vali Acc: 0.943 Test Loss: 0.361 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.246730089187622
Epoch: 14, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.313 Vali Acc: 0.957 Test Loss: 0.313 Test Acc: 0.957
Validation loss decreased (-0.945942 --> -0.956754).  Saving model ...
Epoch: 15 cost time: 0.9373514652252197
Epoch: 15, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.281 Vali Acc: 0.957 Test Loss: 0.281 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 16 cost time: 1.0154480934143066
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8123879432678223
Epoch: 17, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.236 Vali Acc: 0.954 Test Loss: 0.236 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9795017242431641
Epoch: 18, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.224 Vali Acc: 0.954 Test Loss: 0.224 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4134650230407715
Epoch: 19, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2145860195159912
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.4086296558380127
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.0855326652526855
Epoch: 22, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 1.3070111274719238
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.0846834182739258
Epoch: 24, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.0292792320251465
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.035386323928833
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.340911626815796
Epoch: 27, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9794597625732422
Epoch: 28, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.3344168663024902
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 0.9680678844451904
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 1.0874083042144775
Epoch: 31, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3419034481048584
Epoch: 32, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 1.2125208377838135
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.0703890323638916
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3470349311828613
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1196086406707764
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 1.3087477684020996
Epoch: 37, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.080920696258545
Epoch: 38, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 1.1941876411437988
Epoch: 39, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2629902362823486
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.1937282085418701
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0959720611572266
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.180067777633667
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9948840141296387
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3045494556427002
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9850261211395264
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3746793270111084
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.2489571571350098
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.4686005115509033
Epoch: 49, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 50 cost time: 1.3361146450042725
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 51 cost time: 1.3848965167999268
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0735187530517578
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3269145488739014
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8489532470703125
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.142775058746338
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.1264467239379883
Epoch: 56, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0723185539245605
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2088613510131836
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.21372652053833
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1044583320617676
Epoch: 60, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 160649
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.644113540649414
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.164 Vali Acc: 0.146 Test Loss: 2.164 Test Acc: 0.146
Validation loss decreased (inf --> -0.145924).  Saving model ...
Epoch: 2 cost time: 0.9991137981414795
Epoch: 2, Steps: 17 | Train Loss: 2.073 Vali Loss: 1.973 Vali Acc: 0.405 Test Loss: 1.973 Test Acc: 0.405
Validation loss decreased (-0.145924 --> -0.405386).  Saving model ...
Epoch: 3 cost time: 0.9571025371551514
Epoch: 3, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.746 Vali Acc: 0.673 Test Loss: 1.746 Test Acc: 0.673
Validation loss decreased (-0.405386 --> -0.672956).  Saving model ...
Epoch: 4 cost time: 0.9801087379455566
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.502 Vali Acc: 0.746 Test Loss: 1.502 Test Acc: 0.746
Validation loss decreased (-0.672956 --> -0.745931).  Saving model ...
Epoch: 5 cost time: 1.016181230545044
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.296 Vali Acc: 0.776 Test Loss: 1.296 Test Acc: 0.776
Validation loss decreased (-0.745931 --> -0.775663).  Saving model ...
Epoch: 6 cost time: 1.3354480266571045
Epoch: 6, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.086 Vali Acc: 0.822 Test Loss: 1.086 Test Acc: 0.822
Validation loss decreased (-0.775663 --> -0.821611).  Saving model ...
Epoch: 7 cost time: 1.2848601341247559
Epoch: 7, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.895 Vali Acc: 0.854 Test Loss: 0.895 Test Acc: 0.854
Validation loss decreased (-0.821611 --> -0.854045).  Saving model ...
Epoch: 8 cost time: 1.4016268253326416
Epoch: 8, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.749 Vali Acc: 0.862 Test Loss: 0.749 Test Acc: 0.862
Validation loss decreased (-0.854045 --> -0.862155).  Saving model ...
Epoch: 9 cost time: 1.4081501960754395
Epoch: 9, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.630 Vali Acc: 0.889 Test Loss: 0.630 Test Acc: 0.889
Validation loss decreased (-0.862155 --> -0.889183).  Saving model ...
Epoch: 10 cost time: 1.1915223598480225
Epoch: 10, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.532 Vali Acc: 0.924 Test Loss: 0.532 Test Acc: 0.924
Validation loss decreased (-0.889183 --> -0.924319).  Saving model ...
Epoch: 11 cost time: 1.561413288116455
Epoch: 11, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.472 Vali Acc: 0.935 Test Loss: 0.472 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935130).  Saving model ...
Epoch: 12 cost time: 1.2841224670410156
Epoch: 12, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.407 Vali Acc: 0.946 Test Loss: 0.407 Test Acc: 0.946
Validation loss decreased (-0.935130 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.2058322429656982
Epoch: 13, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.365 Vali Acc: 0.938 Test Loss: 0.365 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3226301670074463
Epoch: 14, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.317 Vali Acc: 0.951 Test Loss: 0.317 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.250568151473999
Epoch: 15, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.285 Vali Acc: 0.954 Test Loss: 0.285 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 1.3469741344451904
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.268 Vali Acc: 0.949 Test Loss: 0.268 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.057706356048584
Epoch: 17, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.240 Vali Acc: 0.954 Test Loss: 0.240 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.3567943572998047
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.227 Vali Acc: 0.954 Test Loss: 0.227 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.0837900638580322
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.4676556587219238
Epoch: 20, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.194 Vali Acc: 0.954 Test Loss: 0.194 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.3595614433288574
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.2747445106506348
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.290205478668213
Epoch: 23, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.4127869606018066
Epoch: 24, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.4544792175292969
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.959458 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 0.9699349403381348
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0459940433502197
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.141 Vali Acc: 0.965 Test Loss: 0.141 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.076317310333252
Epoch: 28, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0535144805908203
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.3247742652893066
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.3275377750396729
Epoch: 31, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3018198013305664
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2769765853881836
Epoch: 33, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 34 cost time: 1.2241871356964111
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2489306926727295
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0643033981323242
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4104323387145996
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3363678455352783
Epoch: 38, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 1.2337937355041504
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9996695518493652
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3045201301574707
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1582105159759521
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2884879112243652
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0079689025878906
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2292201519012451
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.2892796993255615
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 47 cost time: 1.2809362411499023
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4223442077636719
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2137460708618164
Epoch: 49, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 50 cost time: 1.395432472229004
Epoch: 50, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9976198673248291
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.4089329242706299
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1693923473358154
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.2646679878234863
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2130324840545654
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0293257236480713
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.2216453552246094
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.082615613937378
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.0774188041687012
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 160649
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.548679828643799
Epoch: 1, Steps: 17 | Train Loss: 2.232 Vali Loss: 2.157 Vali Acc: 0.178 Test Loss: 2.157 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 0.9648640155792236
Epoch: 2, Steps: 17 | Train Loss: 2.072 Vali Loss: 1.974 Vali Acc: 0.432 Test Loss: 1.974 Test Acc: 0.432
Validation loss decreased (-0.178357 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 0.9818763732910156
Epoch: 3, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.755 Vali Acc: 0.681 Test Loss: 1.755 Test Acc: 0.681
Validation loss decreased (-0.432413 --> -0.681064).  Saving model ...
Epoch: 4 cost time: 0.7729132175445557
Epoch: 4, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.518 Vali Acc: 0.776 Test Loss: 1.518 Test Acc: 0.776
Validation loss decreased (-0.681064 --> -0.775660).  Saving model ...
Epoch: 5 cost time: 0.9665677547454834
Epoch: 5, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.315 Vali Acc: 0.797 Test Loss: 1.315 Test Acc: 0.797
Validation loss decreased (-0.775660 --> -0.797284).  Saving model ...
Epoch: 6 cost time: 1.2540600299835205
Epoch: 6, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.104 Vali Acc: 0.832 Test Loss: 1.104 Test Acc: 0.832
Validation loss decreased (-0.797284 --> -0.832421).  Saving model ...
Epoch: 7 cost time: 1.050917148590088
Epoch: 7, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.913 Vali Acc: 0.857 Test Loss: 0.913 Test Acc: 0.857
Validation loss decreased (-0.832421 --> -0.856748).  Saving model ...
Epoch: 8 cost time: 1.2997827529907227
Epoch: 8, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.769 Vali Acc: 0.889 Test Loss: 0.769 Test Acc: 0.889
Validation loss decreased (-0.856748 --> -0.889182).  Saving model ...
Epoch: 9 cost time: 1.0332047939300537
Epoch: 9, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.648 Vali Acc: 0.895 Test Loss: 0.648 Test Acc: 0.895
Validation loss decreased (-0.889182 --> -0.894588).  Saving model ...
Epoch: 10 cost time: 1.3238272666931152
Epoch: 10, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.551 Vali Acc: 0.916 Test Loss: 0.551 Test Acc: 0.916
Validation loss decreased (-0.894588 --> -0.916211).  Saving model ...
Epoch: 11 cost time: 1.1730015277862549
Epoch: 11, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.489 Vali Acc: 0.930 Test Loss: 0.489 Test Acc: 0.930
Validation loss decreased (-0.916211 --> -0.929725).  Saving model ...
Epoch: 12 cost time: 1.3461966514587402
Epoch: 12, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.422 Vali Acc: 0.941 Test Loss: 0.422 Test Acc: 0.941
Validation loss decreased (-0.929725 --> -0.940536).  Saving model ...
Epoch: 13 cost time: 1.234389066696167
Epoch: 13, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 14 cost time: 1.0872673988342285
Epoch: 14, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.330 Vali Acc: 0.951 Test Loss: 0.330 Test Acc: 0.951
Validation loss decreased (-0.940537 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.1642050743103027
Epoch: 15, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.296 Vali Acc: 0.959 Test Loss: 0.296 Test Acc: 0.959
Validation loss decreased (-0.951348 --> -0.959456).  Saving model ...
Epoch: 16 cost time: 0.9567875862121582
Epoch: 16, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.279 Vali Acc: 0.949 Test Loss: 0.279 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.104128360748291
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.249 Vali Acc: 0.954 Test Loss: 0.249 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1619610786437988
Epoch: 18, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0721936225891113
Epoch: 19, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.220 Vali Acc: 0.957 Test Loss: 0.220 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.237088918685913
Epoch: 20, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.959456 --> -0.959457).  Saving model ...
Epoch: 21 cost time: 1.2335453033447266
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.3077926635742188
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.332258939743042
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9768612384796143
Epoch: 24, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2407259941101074
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 1.1962239742279053
Epoch: 26, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 1.2096352577209473
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1880004405975342
Epoch: 28, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0120811462402344
Epoch: 29, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.1164307594299316
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.0861213207244873
Epoch: 31, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0137500762939453
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1525914669036865
Epoch: 33, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.3342573642730713
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9863412380218506
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3022675514221191
Epoch: 36, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.117372751235962
Epoch: 37, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2658381462097168
Epoch: 38, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 39 cost time: 1.148820400238037
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3195264339447021
Epoch: 40, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.0748963356018066
Epoch: 41, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 1.34246826171875
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2249155044555664
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1877892017364502
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2368526458740234
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.987938404083252
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2584013938903809
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0504307746887207
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0958456993103027
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 50 cost time: 1.1787700653076172
Epoch: 50, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 51 cost time: 0.9689223766326904
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3247723579406738
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.274057149887085
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.232262372970581
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2562127113342285
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.335749864578247
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2341618537902832
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1270415782928467
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.2764451503753662
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.0298724174499512
Epoch: 60, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 160649
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8705174922943115
Epoch: 1, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.133 Vali Acc: 0.232 Test Loss: 2.133 Test Acc: 0.232
Validation loss decreased (inf --> -0.232411).  Saving model ...
Epoch: 2 cost time: 1.2862792015075684
Epoch: 2, Steps: 17 | Train Loss: 2.064 Vali Loss: 1.983 Vali Acc: 0.484 Test Loss: 1.983 Test Acc: 0.484
Validation loss decreased (-0.232411 --> -0.483764).  Saving model ...
Epoch: 3 cost time: 1.0814406871795654
Epoch: 3, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.795 Vali Acc: 0.686 Test Loss: 1.795 Test Acc: 0.686
Validation loss decreased (-0.483764 --> -0.686469).  Saving model ...
Epoch: 4 cost time: 1.3117492198944092
Epoch: 4, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.583 Vali Acc: 0.781 Test Loss: 1.583 Test Acc: 0.781
Validation loss decreased (-0.686469 --> -0.781065).  Saving model ...
Epoch: 5 cost time: 0.9546873569488525
Epoch: 5, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.386 Vali Acc: 0.814 Test Loss: 1.386 Test Acc: 0.814
Validation loss decreased (-0.781065 --> -0.813500).  Saving model ...
Epoch: 6 cost time: 1.2513384819030762
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.186 Vali Acc: 0.846 Test Loss: 1.186 Test Acc: 0.846
Validation loss decreased (-0.813500 --> -0.845934).  Saving model ...
Epoch: 7 cost time: 0.9703226089477539
Epoch: 7, Steps: 17 | Train Loss: 1.014 Vali Loss: 0.998 Vali Acc: 0.876 Test Loss: 0.998 Test Acc: 0.876
Validation loss decreased (-0.845934 --> -0.875666).  Saving model ...
Epoch: 8 cost time: 1.0238044261932373
Epoch: 8, Steps: 17 | Train Loss: 0.842 Vali Loss: 0.847 Vali Acc: 0.892 Test Loss: 0.847 Test Acc: 0.892
Validation loss decreased (-0.875666 --> -0.891883).  Saving model ...
Epoch: 9 cost time: 0.9678268432617188
Epoch: 9, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.719 Vali Acc: 0.914 Test Loss: 0.719 Test Acc: 0.914
Validation loss decreased (-0.891883 --> -0.913506).  Saving model ...
Epoch: 10 cost time: 1.0035266876220703
Epoch: 10, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.610 Vali Acc: 0.924 Test Loss: 0.610 Test Acc: 0.924
Validation loss decreased (-0.913506 --> -0.924318).  Saving model ...
Epoch: 11 cost time: 1.2016677856445312
Epoch: 11, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.530 Vali Acc: 0.938 Test Loss: 0.530 Test Acc: 0.938
Validation loss decreased (-0.924318 --> -0.937833).  Saving model ...
Epoch: 12 cost time: 1.0425875186920166
Epoch: 12, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.461 Vali Acc: 0.932 Test Loss: 0.461 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2920937538146973
Epoch: 13, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.411 Vali Acc: 0.935 Test Loss: 0.411 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.118720531463623
Epoch: 14, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940537).  Saving model ...
Epoch: 15 cost time: 1.2514111995697021
Epoch: 15, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 16 cost time: 1.2815415859222412
Epoch: 16, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.296 Vali Acc: 0.949 Test Loss: 0.296 Test Acc: 0.949
Validation loss decreased (-0.940537 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 0.9815959930419922
Epoch: 17, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.265 Vali Acc: 0.954 Test Loss: 0.265 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954051).  Saving model ...
Epoch: 18 cost time: 1.180741310119629
Epoch: 18, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.248 Vali Acc: 0.951 Test Loss: 0.248 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0081326961517334
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.230 Vali Acc: 0.957 Test Loss: 0.230 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 20 cost time: 1.144134283065796
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0344486236572266
Epoch: 21, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.194 Vali Acc: 0.959 Test Loss: 0.194 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 0.9431803226470947
Epoch: 22, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 23 cost time: 1.1729156970977783
Epoch: 23, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.175 Vali Acc: 0.965 Test Loss: 0.175 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 1.3136887550354004
Epoch: 24, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1814088821411133
Epoch: 25, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.3111026287078857
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0735812187194824
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 1.2317514419555664
Epoch: 28, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0529048442840576
Epoch: 29, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2664799690246582
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2451605796813965
Epoch: 31, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1584281921386719
Epoch: 32, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1633026599884033
Epoch: 33, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 0.969390869140625
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 0.988640546798706
Epoch: 35, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1235504150390625
Epoch: 36, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1118876934051514
Epoch: 37, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1975035667419434
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.243842601776123
Epoch: 39, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9855997562408447
Epoch: 40, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3303239345550537
Epoch: 41, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2524662017822266
Epoch: 42, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.030545711517334
Epoch: 43, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2246675491333008
Epoch: 44, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.0969805717468262
Epoch: 45, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8727641105651855
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1449806690216064
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.27679443359375
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9093656539916992
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2986342906951904
Epoch: 50, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.2364048957824707
Epoch: 51, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.995203971862793
Epoch: 52, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1509833335876465
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.1623094081878662
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 160649
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.6202149391174316
Epoch: 1, Steps: 17 | Train Loss: 2.269 Vali Loss: 2.160 Vali Acc: 0.168 Test Loss: 2.160 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.0559699535369873
Epoch: 2, Steps: 17 | Train Loss: 2.080 Vali Loss: 1.973 Vali Acc: 0.419 Test Loss: 1.973 Test Acc: 0.419
Validation loss decreased (-0.167546 --> -0.418899).  Saving model ...
Epoch: 3 cost time: 1.3981833457946777
Epoch: 3, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.746 Vali Acc: 0.654 Test Loss: 1.746 Test Acc: 0.654
Validation loss decreased (-0.418899 --> -0.654037).  Saving model ...
Epoch: 4 cost time: 1.0645480155944824
Epoch: 4, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.508 Vali Acc: 0.778 Test Loss: 1.508 Test Acc: 0.778
Validation loss decreased (-0.654037 --> -0.778363).  Saving model ...
Epoch: 5 cost time: 1.4389374256134033
Epoch: 5, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.297 Vali Acc: 0.803 Test Loss: 1.297 Test Acc: 0.803
Validation loss decreased (-0.778363 --> -0.802690).  Saving model ...
Epoch: 6 cost time: 1.2544918060302734
Epoch: 6, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.081 Vali Acc: 0.838 Test Loss: 1.081 Test Acc: 0.838
Validation loss decreased (-0.802690 --> -0.837827).  Saving model ...
Epoch: 7 cost time: 1.279162883758545
Epoch: 7, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.892 Vali Acc: 0.859 Test Loss: 0.892 Test Acc: 0.859
Validation loss decreased (-0.837827 --> -0.859451).  Saving model ...
Epoch: 8 cost time: 1.0948309898376465
Epoch: 8, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.745 Vali Acc: 0.881 Test Loss: 0.745 Test Acc: 0.881
Validation loss decreased (-0.859451 --> -0.881074).  Saving model ...
Epoch: 9 cost time: 1.3144123554229736
Epoch: 9, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.621 Vali Acc: 0.895 Test Loss: 0.621 Test Acc: 0.895
Validation loss decreased (-0.881074 --> -0.894588).  Saving model ...
Epoch: 10 cost time: 1.1875464916229248
Epoch: 10, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.533 Vali Acc: 0.908 Test Loss: 0.533 Test Acc: 0.908
Validation loss decreased (-0.894588 --> -0.908103).  Saving model ...
Epoch: 11 cost time: 1.362102746963501
Epoch: 11, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.448 Vali Acc: 0.943 Test Loss: 0.448 Test Acc: 0.943
Validation loss decreased (-0.908103 --> -0.943239).  Saving model ...
Epoch: 12 cost time: 1.1459174156188965
Epoch: 12, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.938 Test Loss: 0.393 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.397533655166626
Epoch: 13, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.355 Vali Acc: 0.946 Test Loss: 0.355 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 0.7903885841369629
Epoch: 14, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.315 Vali Acc: 0.951 Test Loss: 0.315 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.3368115425109863
Epoch: 15, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.285 Vali Acc: 0.951 Test Loss: 0.285 Test Acc: 0.951
Validation loss decreased (-0.951348 --> -0.951348).  Saving model ...
Epoch: 16 cost time: 1.1096100807189941
Epoch: 16, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
Validation loss decreased (-0.951348 --> -0.962160).  Saving model ...
Epoch: 17 cost time: 1.2992329597473145
Epoch: 17, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2592647075653076
Epoch: 18, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 19 cost time: 1.2906877994537354
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 20 cost time: 1.1883461475372314
Epoch: 20, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.332256555557251
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.2622745037078857
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2531745433807373
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2855157852172852
Epoch: 24, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.964863 --> -0.970269).  Saving model ...
Epoch: 25 cost time: 1.1593513488769531
Epoch: 25, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 1.0682060718536377
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2153022289276123
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 0.970543622970581
Epoch: 28, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2338831424713135
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0919806957244873
Epoch: 30, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.24147367477417
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.079996109008789
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2746591567993164
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.341644287109375
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 35 cost time: 1.182525634765625
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.439413070678711
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9759304523468018
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.4178192615509033
Epoch: 38, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0345733165740967
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2937321662902832
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.030937671661377
Epoch: 41, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.3569447994232178
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.097017765045166
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 1.1003694534301758
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.0316483974456787
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.0573906898498535
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.891913652420044
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1446771621704102
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.96219801902771
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.21028470993042
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.3820421695709229
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.4275474548339844
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0724635124206543
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3619508743286133
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.2651793956756592
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 95113
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.114450693130493
Epoch: 1, Steps: 17 | Train Loss: 2.262 Vali Loss: 2.154 Vali Acc: 0.168 Test Loss: 2.154 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.3466715812683105
Epoch: 2, Steps: 17 | Train Loss: 2.070 Vali Loss: 1.969 Vali Acc: 0.416 Test Loss: 1.969 Test Acc: 0.416
Validation loss decreased (-0.167546 --> -0.416197).  Saving model ...
Epoch: 3 cost time: 1.239537239074707
Epoch: 3, Steps: 17 | Train Loss: 1.828 Vali Loss: 1.744 Vali Acc: 0.641 Test Loss: 1.744 Test Acc: 0.641
Validation loss decreased (-0.416197 --> -0.640523).  Saving model ...
Epoch: 4 cost time: 1.3766863346099854
Epoch: 4, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.508 Vali Acc: 0.770 Test Loss: 1.508 Test Acc: 0.770
Validation loss decreased (-0.640523 --> -0.770255).  Saving model ...
Epoch: 5 cost time: 1.2371137142181396
Epoch: 5, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.299 Vali Acc: 0.803 Test Loss: 1.299 Test Acc: 0.803
Validation loss decreased (-0.770255 --> -0.802690).  Saving model ...
Epoch: 6 cost time: 1.0246567726135254
Epoch: 6, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.084 Vali Acc: 0.832 Test Loss: 1.084 Test Acc: 0.832
Validation loss decreased (-0.802690 --> -0.832422).  Saving model ...
Epoch: 7 cost time: 1.1577963829040527
Epoch: 7, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.898 Vali Acc: 0.851 Test Loss: 0.898 Test Acc: 0.851
Validation loss decreased (-0.832422 --> -0.851342).  Saving model ...
Epoch: 8 cost time: 1.2807223796844482
Epoch: 8, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.750 Vali Acc: 0.878 Test Loss: 0.750 Test Acc: 0.878
Validation loss decreased (-0.851342 --> -0.878371).  Saving model ...
Epoch: 9 cost time: 1.0851068496704102
Epoch: 9, Steps: 17 | Train Loss: 0.592 Vali Loss: 0.628 Vali Acc: 0.892 Test Loss: 0.628 Test Acc: 0.892
Validation loss decreased (-0.878371 --> -0.891886).  Saving model ...
Epoch: 10 cost time: 1.0950267314910889
Epoch: 10, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.542 Vali Acc: 0.903 Test Loss: 0.542 Test Acc: 0.903
Validation loss decreased (-0.891886 --> -0.902697).  Saving model ...
Epoch: 11 cost time: 1.3428144454956055
Epoch: 11, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.456 Vali Acc: 0.946 Test Loss: 0.456 Test Acc: 0.946
Validation loss decreased (-0.902697 --> -0.945941).  Saving model ...
Epoch: 12 cost time: 1.1164064407348633
Epoch: 12, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.399 Vali Acc: 0.941 Test Loss: 0.399 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2823107242584229
Epoch: 13, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.360 Vali Acc: 0.949 Test Loss: 0.360 Test Acc: 0.949
Validation loss decreased (-0.945941 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 1.0144803524017334
Epoch: 14, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.317 Vali Acc: 0.951 Test Loss: 0.317 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.0389137268066406
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.288 Vali Acc: 0.954 Test Loss: 0.288 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 1.0293407440185547
Epoch: 16, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 17 cost time: 1.0445890426635742
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.234 Vali Acc: 0.962 Test Loss: 0.234 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 18 cost time: 1.0488595962524414
Epoch: 18, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2287123203277588
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.3617761135101318
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3009226322174072
Epoch: 21, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.3377399444580078
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0196402072906494
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3854589462280273
Epoch: 24, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.1960945129394531
Epoch: 25, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 26 cost time: 0.8670933246612549
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1313695907592773
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.1189467906951904
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.0308301448822021
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2425587177276611
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.4169926643371582
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.236243724822998
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4517569541931152
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.0485048294067383
Epoch: 34, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.3362727165222168
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 1.3125994205474854
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 1.337251901626587
Epoch: 37, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.1344985961914062
Epoch: 38, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8846263885498047
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1208715438842773
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 1.1590468883514404
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1290385723114014
Epoch: 42, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3383898735046387
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 1.1008872985839844
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.312408685684204
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0042288303375244
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9988791942596436
Epoch: 47, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9448826313018799
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 49 cost time: 0.8972980976104736
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8740229606628418
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.227900743484497
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1704285144805908
Epoch: 52, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 53 cost time: 1.3167915344238281
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2651102542877197
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 55 cost time: 1.3155338764190674
Epoch: 55, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2525839805603027
Epoch: 56, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.4061014652252197
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 58 cost time: 1.3010447025299072
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.4072637557983398
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.283071517944336
Epoch: 60, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.3281753063201904
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1808717250823975
Epoch: 62, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 1.3627195358276367
Epoch: 63, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 1.2698426246643066
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 1.323119878768921
Epoch: 65, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 1.2886261940002441
Epoch: 66, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.1747536659240723
Epoch: 67, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 95113
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.555307388305664
Epoch: 1, Steps: 17 | Train Loss: 2.249 Vali Loss: 2.144 Vali Acc: 0.195 Test Loss: 2.144 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 1.1406683921813965
Epoch: 2, Steps: 17 | Train Loss: 2.059 Vali Loss: 1.970 Vali Acc: 0.432 Test Loss: 1.970 Test Acc: 0.432
Validation loss decreased (-0.194573 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 0.891141414642334
Epoch: 3, Steps: 17 | Train Loss: 1.834 Vali Loss: 1.755 Vali Acc: 0.654 Test Loss: 1.755 Test Acc: 0.654
Validation loss decreased (-0.432413 --> -0.654037).  Saving model ...
Epoch: 4 cost time: 1.1586885452270508
Epoch: 4, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.527 Vali Acc: 0.773 Test Loss: 1.527 Test Acc: 0.773
Validation loss decreased (-0.654037 --> -0.772958).  Saving model ...
Epoch: 5 cost time: 1.0249907970428467
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.320 Vali Acc: 0.808 Test Loss: 1.320 Test Acc: 0.808
Validation loss decreased (-0.772958 --> -0.808095).  Saving model ...
Epoch: 6 cost time: 1.2486248016357422
Epoch: 6, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.109 Vali Acc: 0.830 Test Loss: 1.109 Test Acc: 0.830
Validation loss decreased (-0.808095 --> -0.829719).  Saving model ...
Epoch: 7 cost time: 1.16347074508667
Epoch: 7, Steps: 17 | Train Loss: 0.926 Vali Loss: 0.920 Vali Acc: 0.865 Test Loss: 0.920 Test Acc: 0.865
Validation loss decreased (-0.829719 --> -0.864856).  Saving model ...
Epoch: 8 cost time: 1.3033034801483154
Epoch: 8, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.770 Vali Acc: 0.881 Test Loss: 0.770 Test Acc: 0.881
Validation loss decreased (-0.864856 --> -0.881073).  Saving model ...
Epoch: 9 cost time: 1.1737875938415527
Epoch: 9, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.650 Vali Acc: 0.889 Test Loss: 0.650 Test Acc: 0.889
Validation loss decreased (-0.881073 --> -0.889183).  Saving model ...
Epoch: 10 cost time: 1.110701560974121
Epoch: 10, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.563 Vali Acc: 0.922 Test Loss: 0.563 Test Acc: 0.922
Validation loss decreased (-0.889183 --> -0.921616).  Saving model ...
Epoch: 11 cost time: 1.1659278869628906
Epoch: 11, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.474 Vali Acc: 0.943 Test Loss: 0.474 Test Acc: 0.943
Validation loss decreased (-0.921616 --> -0.943239).  Saving model ...
Epoch: 12 cost time: 0.977973461151123
Epoch: 12, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.414 Vali Acc: 0.946 Test Loss: 0.414 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.1091578006744385
Epoch: 13, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.374 Vali Acc: 0.954 Test Loss: 0.374 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954050).  Saving model ...
Epoch: 14 cost time: 0.9157710075378418
Epoch: 14, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.329 Vali Acc: 0.951 Test Loss: 0.329 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.174166202545166
Epoch: 15, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.299 Vali Acc: 0.951 Test Loss: 0.299 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9975588321685791
Epoch: 16, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
Validation loss decreased (-0.954050 --> -0.959457).  Saving model ...
Epoch: 17 cost time: 1.2083604335784912
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.243 Vali Acc: 0.957 Test Loss: 0.243 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1443839073181152
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.227 Vali Acc: 0.959 Test Loss: 0.227 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 19 cost time: 1.0202975273132324
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.210 Vali Acc: 0.957 Test Loss: 0.210 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2098233699798584
Epoch: 20, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.201 Vali Acc: 0.957 Test Loss: 0.201 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9828085899353027
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.1021299362182617
Epoch: 22, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.326195240020752
Epoch: 23, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.257521390914917
Epoch: 24, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.205578327178955
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.1230590343475342
Epoch: 26, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3716375827789307
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0545377731323242
Epoch: 28, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.286862850189209
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.14155912399292
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9285588264465332
Epoch: 31, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1570794582366943
Epoch: 32, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.876640796661377
Epoch: 33, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 0.9996662139892578
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.122394323348999
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8841044902801514
Epoch: 36, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1053016185760498
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.2580235004425049
Epoch: 38, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0475504398345947
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1945135593414307
Epoch: 40, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 0.934821605682373
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.239288330078125
Epoch: 42, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0748441219329834
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2332284450531006
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1902186870574951
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1195275783538818
Epoch: 46, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2255632877349854
Epoch: 47, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0053374767303467
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1513774394989014
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 50 cost time: 1.1047205924987793
Epoch: 50, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1086957454681396
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0886149406433105
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9099950790405273
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.1805305480957031
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.251957893371582
Epoch: 55, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.193627119064331
Epoch: 56, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.3208370208740234
Epoch: 57, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.183406114578247
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.965 Test Loss: 0.093 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.2717890739440918
Epoch: 59, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 95113
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.630598783493042
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.123 Vali Acc: 0.238 Test Loss: 2.123 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 1.1061980724334717
Epoch: 2, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.977 Vali Acc: 0.489 Test Loss: 1.977 Test Acc: 0.489
Validation loss decreased (-0.237817 --> -0.489169).  Saving model ...
Epoch: 3 cost time: 0.93345046043396
Epoch: 3, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.793 Vali Acc: 0.668 Test Loss: 1.793 Test Acc: 0.668
Validation loss decreased (-0.489169 --> -0.667550).  Saving model ...
Epoch: 4 cost time: 0.9369606971740723
Epoch: 4, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.591 Vali Acc: 0.773 Test Loss: 1.591 Test Acc: 0.773
Validation loss decreased (-0.667550 --> -0.772957).  Saving model ...
Epoch: 5 cost time: 0.8258991241455078
Epoch: 5, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.391 Vali Acc: 0.827 Test Loss: 1.391 Test Acc: 0.827
Validation loss decreased (-0.772957 --> -0.827013).  Saving model ...
Epoch: 6 cost time: 0.9187960624694824
Epoch: 6, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.187 Vali Acc: 0.851 Test Loss: 1.187 Test Acc: 0.851
Validation loss decreased (-0.827013 --> -0.851339).  Saving model ...
Epoch: 7 cost time: 0.9433071613311768
Epoch: 7, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.999 Vali Acc: 0.873 Test Loss: 0.999 Test Acc: 0.873
Validation loss decreased (-0.851339 --> -0.872963).  Saving model ...
Epoch: 8 cost time: 1.1350469589233398
Epoch: 8, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.846 Vali Acc: 0.892 Test Loss: 0.846 Test Acc: 0.892
Validation loss decreased (-0.872963 --> -0.891883).  Saving model ...
Epoch: 9 cost time: 1.0312378406524658
Epoch: 9, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.716 Vali Acc: 0.903 Test Loss: 0.716 Test Acc: 0.903
Validation loss decreased (-0.891883 --> -0.902696).  Saving model ...
Epoch: 10 cost time: 1.1360714435577393
Epoch: 10, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.618 Vali Acc: 0.914 Test Loss: 0.618 Test Acc: 0.914
Validation loss decreased (-0.902696 --> -0.913507).  Saving model ...
Epoch: 11 cost time: 0.8543064594268799
Epoch: 11, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.525 Vali Acc: 0.941 Test Loss: 0.525 Test Acc: 0.941
Validation loss decreased (-0.913507 --> -0.940535).  Saving model ...
Epoch: 12 cost time: 1.122363805770874
Epoch: 12, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.455 Vali Acc: 0.943 Test Loss: 0.455 Test Acc: 0.943
Validation loss decreased (-0.940535 --> -0.943239).  Saving model ...
Epoch: 13 cost time: 0.9193413257598877
Epoch: 13, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.407 Vali Acc: 0.943 Test Loss: 0.407 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943239).  Saving model ...
Epoch: 14 cost time: 1.2192671298980713
Epoch: 14, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.357 Vali Acc: 0.954 Test Loss: 0.357 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954050).  Saving model ...
Epoch: 15 cost time: 1.0197663307189941
Epoch: 15, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.325 Vali Acc: 0.941 Test Loss: 0.325 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2239530086517334
Epoch: 16, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.288 Vali Acc: 0.954 Test Loss: 0.288 Test Acc: 0.954
Validation loss decreased (-0.954050 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 1.0587711334228516
Epoch: 17, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.263 Vali Acc: 0.954 Test Loss: 0.263 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 18 cost time: 1.0901353359222412
Epoch: 18, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.0871737003326416
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.2188799381256104
Epoch: 20, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.212 Vali Acc: 0.954 Test Loss: 0.212 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0984413623809814
Epoch: 21, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.196 Vali Acc: 0.965 Test Loss: 0.196 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 1.2051639556884766
Epoch: 22, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1192700862884521
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 1.1888644695281982
Epoch: 24, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0777878761291504
Epoch: 25, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.1849148273468018
Epoch: 26, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.16623854637146
Epoch: 27, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 1.1794097423553467
Epoch: 28, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.127678394317627
Epoch: 29, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0874083042144775
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 1.1354877948760986
Epoch: 31, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 32 cost time: 1.1580250263214111
Epoch: 32, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1105597019195557
Epoch: 33, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 1.186967372894287
Epoch: 34, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 35 cost time: 1.1134424209594727
Epoch: 35, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.213381052017212
Epoch: 36, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0456552505493164
Epoch: 37, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2010259628295898
Epoch: 38, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1099975109100342
Epoch: 39, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9153475761413574
Epoch: 40, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 41 cost time: 0.7458868026733398
Epoch: 41, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8506753444671631
Epoch: 42, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.873232364654541
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8895506858825684
Epoch: 44, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1583964824676514
Epoch: 45, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8697376251220703
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1543080806732178
Epoch: 47, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 1.172818660736084
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 49 cost time: 1.2343218326568604
Epoch: 49, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2389099597930908
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9839222431182861
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.976689338684082
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.117661714553833
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8885655403137207
Epoch: 54, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 55 cost time: 1.0792551040649414
Epoch: 55, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9836537837982178
Epoch: 56, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1126708984375
Epoch: 57, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 58 cost time: 1.1021208763122559
Epoch: 58, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 59 cost time: 1.0746667385101318
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.218865156173706
Epoch: 60, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1320056915283203
Epoch: 61, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.2869970798492432
Epoch: 62, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1539764404296875
Epoch: 63, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0092535018920898
Epoch: 64, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1854667663574219
Epoch: 65, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.179626226425171
Epoch: 66, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0236191749572754
Epoch: 67, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.0873517990112305
Epoch: 68, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 95113
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.324596405029297
Epoch: 1, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.132 Vali Acc: 0.235 Test Loss: 2.132 Test Acc: 0.235
Validation loss decreased (inf --> -0.235114).  Saving model ...
Epoch: 2 cost time: 1.033379316329956
Epoch: 2, Steps: 17 | Train Loss: 2.016 Vali Loss: 1.928 Vali Acc: 0.368 Test Loss: 1.928 Test Acc: 0.368
Validation loss decreased (-0.235114 --> -0.367548).  Saving model ...
Epoch: 3 cost time: 1.028838872909546
Epoch: 3, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.700 Vali Acc: 0.568 Test Loss: 1.700 Test Acc: 0.568
Validation loss decreased (-0.367548 --> -0.567551).  Saving model ...
Epoch: 4 cost time: 1.050391674041748
Epoch: 4, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.469 Vali Acc: 0.724 Test Loss: 1.469 Test Acc: 0.724
Validation loss decreased (-0.567551 --> -0.724310).  Saving model ...
Epoch: 5 cost time: 0.9421210289001465
Epoch: 5, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.255 Vali Acc: 0.792 Test Loss: 1.255 Test Acc: 0.792
Validation loss decreased (-0.724310 --> -0.791879).  Saving model ...
Epoch: 6 cost time: 0.9142413139343262
Epoch: 6, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.068 Vali Acc: 0.803 Test Loss: 1.068 Test Acc: 0.803
Validation loss decreased (-0.791879 --> -0.802692).  Saving model ...
Epoch: 7 cost time: 1.0414316654205322
Epoch: 7, Steps: 17 | Train Loss: 0.895 Vali Loss: 0.895 Vali Acc: 0.859 Test Loss: 0.895 Test Acc: 0.859
Validation loss decreased (-0.802692 --> -0.859451).  Saving model ...
Epoch: 8 cost time: 1.1385324001312256
Epoch: 8, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.742 Vali Acc: 0.886 Test Loss: 0.742 Test Acc: 0.886
Validation loss decreased (-0.859451 --> -0.886479).  Saving model ...
Epoch: 9 cost time: 1.3325409889221191
Epoch: 9, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.619 Vali Acc: 0.908 Test Loss: 0.619 Test Acc: 0.908
Validation loss decreased (-0.886479 --> -0.908102).  Saving model ...
Epoch: 10 cost time: 1.4414496421813965
Epoch: 10, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.537 Vali Acc: 0.914 Test Loss: 0.537 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913508).  Saving model ...
Epoch: 11 cost time: 1.3705925941467285
Epoch: 11, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.460 Vali Acc: 0.941 Test Loss: 0.460 Test Acc: 0.941
Validation loss decreased (-0.913508 --> -0.940536).  Saving model ...
Epoch: 12 cost time: 1.3410301208496094
Epoch: 12, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 13 cost time: 1.3058981895446777
Epoch: 13, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.354 Vali Acc: 0.943 Test Loss: 0.354 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 14 cost time: 1.3341951370239258
Epoch: 14, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.317 Vali Acc: 0.949 Test Loss: 0.317 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948645).  Saving model ...
Epoch: 15 cost time: 1.3535113334655762
Epoch: 15, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.284 Vali Acc: 0.946 Test Loss: 0.284 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4613316059112549
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 1.1709187030792236
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.241 Vali Acc: 0.951 Test Loss: 0.241 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3450632095336914
Epoch: 18, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2219452857971191
Epoch: 19, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.477013349533081
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.055433988571167
Epoch: 21, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.4335017204284668
Epoch: 22, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2568607330322266
Epoch: 23, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.3101072311401367
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.3291270732879639
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4505994319915771
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.3383417129516602
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4603700637817383
Epoch: 28, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 29 cost time: 1.4139394760131836
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.4446020126342773
Epoch: 30, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.330064058303833
Epoch: 31, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.379338264465332
Epoch: 32, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2833342552185059
Epoch: 33, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2954847812652588
Epoch: 34, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2487072944641113
Epoch: 35, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 36 cost time: 1.3456661701202393
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.330514669418335
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.448108196258545
Epoch: 38, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.395667552947998
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4289615154266357
Epoch: 40, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4686744213104248
Epoch: 41, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 42 cost time: 1.3738172054290771
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 43 cost time: 1.3374950885772705
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 1.1204721927642822
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.235321283340454
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.391526222229004
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2168242931365967
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.001194715499878
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 49 cost time: 0.9938135147094727
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9617307186126709
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0139613151550293
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.0556650161743164
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1457617282867432
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.9929671287536621
Epoch: 54, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2460346221923828
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.27815842628479
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.2441811561584473
Epoch: 57, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 1.24446439743042
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 62345
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9942479133605957
Epoch: 1, Steps: 17 | Train Loss: 2.156 Vali Loss: 2.136 Vali Acc: 0.230 Test Loss: 2.136 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 1.159440279006958
Epoch: 2, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.933 Vali Acc: 0.365 Test Loss: 1.933 Test Acc: 0.365
Validation loss decreased (-0.229708 --> -0.364846).  Saving model ...
Epoch: 3 cost time: 1.2425479888916016
Epoch: 3, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.707 Vali Acc: 0.581 Test Loss: 1.707 Test Acc: 0.581
Validation loss decreased (-0.364846 --> -0.581064).  Saving model ...
Epoch: 4 cost time: 1.0906217098236084
Epoch: 4, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.477 Vali Acc: 0.714 Test Loss: 1.477 Test Acc: 0.714
Validation loss decreased (-0.581064 --> -0.713499).  Saving model ...
Epoch: 5 cost time: 1.2860255241394043
Epoch: 5, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.264 Vali Acc: 0.786 Test Loss: 1.264 Test Acc: 0.786
Validation loss decreased (-0.713499 --> -0.786474).  Saving model ...
Epoch: 6 cost time: 1.027099609375
Epoch: 6, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.078 Vali Acc: 0.819 Test Loss: 1.078 Test Acc: 0.819
Validation loss decreased (-0.786474 --> -0.818908).  Saving model ...
Epoch: 7 cost time: 1.2972187995910645
Epoch: 7, Steps: 17 | Train Loss: 0.909 Vali Loss: 0.904 Vali Acc: 0.865 Test Loss: 0.904 Test Acc: 0.865
Validation loss decreased (-0.818908 --> -0.864856).  Saving model ...
Epoch: 8 cost time: 1.096803903579712
Epoch: 8, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.749 Vali Acc: 0.884 Test Loss: 0.749 Test Acc: 0.884
Validation loss decreased (-0.864856 --> -0.883776).  Saving model ...
Epoch: 9 cost time: 1.249504804611206
Epoch: 9, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.625 Vali Acc: 0.905 Test Loss: 0.625 Test Acc: 0.905
Validation loss decreased (-0.883776 --> -0.905399).  Saving model ...
Epoch: 10 cost time: 1.109673261642456
Epoch: 10, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.542 Vali Acc: 0.916 Test Loss: 0.542 Test Acc: 0.916
Validation loss decreased (-0.905399 --> -0.916211).  Saving model ...
Epoch: 11 cost time: 1.3140876293182373
Epoch: 11, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.466 Vali Acc: 0.932 Test Loss: 0.466 Test Acc: 0.932
Validation loss decreased (-0.916211 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.1861674785614014
Epoch: 12, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.399 Vali Acc: 0.946 Test Loss: 0.399 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.2781000137329102
Epoch: 13, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.359 Vali Acc: 0.949 Test Loss: 0.359 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 1.1338040828704834
Epoch: 14, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.320 Vali Acc: 0.951 Test Loss: 0.320 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 15 cost time: 1.3342041969299316
Epoch: 15, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.289 Vali Acc: 0.949 Test Loss: 0.289 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.501056432723999
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 1.3844459056854248
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 1.4540016651153564
Epoch: 18, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 1.1826953887939453
Epoch: 19, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3775274753570557
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.082671880722046
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.425180196762085
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.067821741104126
Epoch: 23, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3801190853118896
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.0041875839233398
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 1.3221290111541748
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.1180617809295654
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.394432544708252
Epoch: 28, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 29 cost time: 1.1173853874206543
Epoch: 29, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 30 cost time: 1.3867723941802979
Epoch: 30, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9581291675567627
Epoch: 31, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9155585765838623
Epoch: 32, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9803359508514404
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.062453031539917
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1854274272918701
Epoch: 35, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 36 cost time: 1.3566231727600098
Epoch: 36, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1286001205444336
Epoch: 37, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.031036615371704
Epoch: 38, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 39 cost time: 1.3285853862762451
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.477001667022705
Epoch: 40, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 1.0696067810058594
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.4176406860351562
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1984848976135254
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 44 cost time: 1.2531569004058838
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1800498962402344
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2058947086334229
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2418477535247803
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.26473069190979
Epoch: 48, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4622747898101807
Epoch: 49, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1614108085632324
Epoch: 50, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.323584794998169
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.0435867309570312
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.383866786956787
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 62345
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.657566785812378
Epoch: 1, Steps: 17 | Train Loss: 2.148 Vali Loss: 2.136 Vali Acc: 0.230 Test Loss: 2.136 Test Acc: 0.230
Validation loss decreased (inf --> -0.229708).  Saving model ...
Epoch: 2 cost time: 1.1123275756835938
Epoch: 2, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.943 Vali Acc: 0.343 Test Loss: 1.943 Test Acc: 0.343
Validation loss decreased (-0.229708 --> -0.343224).  Saving model ...
Epoch: 3 cost time: 0.9243097305297852
Epoch: 3, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.726 Vali Acc: 0.546 Test Loss: 1.726 Test Acc: 0.546
Validation loss decreased (-0.343224 --> -0.545929).  Saving model ...
Epoch: 4 cost time: 1.140763759613037
Epoch: 4, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.501 Vali Acc: 0.705 Test Loss: 1.501 Test Acc: 0.705
Validation loss decreased (-0.545929 --> -0.705390).  Saving model ...
Epoch: 5 cost time: 0.8760595321655273
Epoch: 5, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.292 Vali Acc: 0.784 Test Loss: 1.292 Test Acc: 0.784
Validation loss decreased (-0.705390 --> -0.783771).  Saving model ...
Epoch: 6 cost time: 1.121047019958496
Epoch: 6, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.108 Vali Acc: 0.816 Test Loss: 1.108 Test Acc: 0.816
Validation loss decreased (-0.783771 --> -0.816205).  Saving model ...
Epoch: 7 cost time: 0.9811246395111084
Epoch: 7, Steps: 17 | Train Loss: 0.926 Vali Loss: 0.933 Vali Acc: 0.873 Test Loss: 0.933 Test Acc: 0.873
Validation loss decreased (-0.816205 --> -0.872964).  Saving model ...
Epoch: 8 cost time: 1.215869426727295
Epoch: 8, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.776 Vali Acc: 0.878 Test Loss: 0.776 Test Acc: 0.878
Validation loss decreased (-0.872964 --> -0.878371).  Saving model ...
Epoch: 9 cost time: 1.1315057277679443
Epoch: 9, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.652 Vali Acc: 0.908 Test Loss: 0.652 Test Acc: 0.908
Validation loss decreased (-0.878371 --> -0.908102).  Saving model ...
Epoch: 10 cost time: 1.1715772151947021
Epoch: 10, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
Validation loss decreased (-0.908102 --> -0.921616).  Saving model ...
Epoch: 11 cost time: 1.0616731643676758
Epoch: 11, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.486 Vali Acc: 0.935 Test Loss: 0.486 Test Acc: 0.935
Validation loss decreased (-0.921616 --> -0.935130).  Saving model ...
Epoch: 12 cost time: 1.1203975677490234
Epoch: 12, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.419 Vali Acc: 0.949 Test Loss: 0.419 Test Acc: 0.949
Validation loss decreased (-0.935130 --> -0.948644).  Saving model ...
Epoch: 13 cost time: 0.8866984844207764
Epoch: 13, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.377 Vali Acc: 0.943 Test Loss: 0.377 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8930196762084961
Epoch: 14, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.337 Vali Acc: 0.949 Test Loss: 0.337 Test Acc: 0.949
Validation loss decreased (-0.948644 --> -0.948645).  Saving model ...
Epoch: 15 cost time: 0.9351212978363037
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.302 Vali Acc: 0.946 Test Loss: 0.302 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.902874231338501
Epoch: 16, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.276 Vali Acc: 0.949 Test Loss: 0.276 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 0.8929460048675537
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 18 cost time: 1.138746738433838
Epoch: 18, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.14992356300354
Epoch: 19, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 1.1255617141723633
Epoch: 20, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2344791889190674
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 22 cost time: 1.041905403137207
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.07377028465271
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.126283884048462
Epoch: 24, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 0.8324165344238281
Epoch: 25, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 26 cost time: 1.0613014698028564
Epoch: 26, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.0395677089691162
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0357484817504883
Epoch: 28, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 1.131420612335205
Epoch: 29, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0079472064971924
Epoch: 30, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1544039249420166
Epoch: 31, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9678869247436523
Epoch: 32, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.080395221710205
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 34 cost time: 0.884636402130127
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.09523344039917
Epoch: 35, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 36 cost time: 0.8680469989776611
Epoch: 36, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1178977489471436
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 0.86269211769104
Epoch: 38, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 1.1031365394592285
Epoch: 39, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.977820873260498
Epoch: 40, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1935157775878906
Epoch: 41, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0890164375305176
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2388513088226318
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0871679782867432
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1479003429412842
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1318857669830322
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 47 cost time: 1.0965800285339355
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2147653102874756
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0815894603729248
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.198460578918457
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.018968105316162
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2067091464996338
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9998893737792969
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.2374107837677002
Epoch: 54, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9308435916900635
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.0500133037567139
Epoch: 56, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 62345
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8419525623321533
Epoch: 1, Steps: 17 | Train Loss: 2.149 Vali Loss: 2.136 Vali Acc: 0.265 Test Loss: 2.136 Test Acc: 0.265
Validation loss decreased (inf --> -0.264844).  Saving model ...
Epoch: 2 cost time: 1.166344404220581
Epoch: 2, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.975 Vali Acc: 0.422 Test Loss: 1.975 Test Acc: 0.422
Validation loss decreased (-0.264844 --> -0.421602).  Saving model ...
Epoch: 3 cost time: 1.0487682819366455
Epoch: 3, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.787 Vali Acc: 0.568 Test Loss: 1.787 Test Acc: 0.568
Validation loss decreased (-0.421602 --> -0.567550).  Saving model ...
Epoch: 4 cost time: 1.0637602806091309
Epoch: 4, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.581 Vali Acc: 0.749 Test Loss: 1.581 Test Acc: 0.749
Validation loss decreased (-0.567550 --> -0.748633).  Saving model ...
Epoch: 5 cost time: 1.03786039352417
Epoch: 5, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.378 Vali Acc: 0.808 Test Loss: 1.378 Test Acc: 0.808
Validation loss decreased (-0.748633 --> -0.808094).  Saving model ...
Epoch: 6 cost time: 1.156574010848999
Epoch: 6, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.189 Vali Acc: 0.841 Test Loss: 1.189 Test Acc: 0.841
Validation loss decreased (-0.808094 --> -0.840529).  Saving model ...
Epoch: 7 cost time: 1.1837732791900635
Epoch: 7, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.012 Vali Acc: 0.881 Test Loss: 1.012 Test Acc: 0.881
Validation loss decreased (-0.840529 --> -0.881071).  Saving model ...
Epoch: 8 cost time: 1.0351099967956543
Epoch: 8, Steps: 17 | Train Loss: 0.827 Vali Loss: 0.856 Vali Acc: 0.873 Test Loss: 0.856 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1702749729156494
Epoch: 9, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.722 Vali Acc: 0.905 Test Loss: 0.722 Test Acc: 0.905
Validation loss decreased (-0.881071 --> -0.905398).  Saving model ...
Epoch: 10 cost time: 1.0845587253570557
Epoch: 10, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.623 Vali Acc: 0.916 Test Loss: 0.623 Test Acc: 0.916
Validation loss decreased (-0.905398 --> -0.916210).  Saving model ...
Epoch: 11 cost time: 1.2154443264007568
Epoch: 11, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.537 Vali Acc: 0.924 Test Loss: 0.537 Test Acc: 0.924
Validation loss decreased (-0.916210 --> -0.924319).  Saving model ...
Epoch: 12 cost time: 1.1433467864990234
Epoch: 12, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.463 Vali Acc: 0.935 Test Loss: 0.463 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935131).  Saving model ...
Epoch: 13 cost time: 0.957228422164917
Epoch: 13, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.415 Vali Acc: 0.946 Test Loss: 0.415 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 1.212688684463501
Epoch: 14, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.369 Vali Acc: 0.935 Test Loss: 0.369 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0297555923461914
Epoch: 15, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.329 Vali Acc: 0.949 Test Loss: 0.329 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 16 cost time: 1.034501552581787
Epoch: 16, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.302 Vali Acc: 0.946 Test Loss: 0.302 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.071772575378418
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.277 Vali Acc: 0.951 Test Loss: 0.277 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 18 cost time: 1.127049446105957
Epoch: 18, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.252 Vali Acc: 0.951 Test Loss: 0.252 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 19 cost time: 1.1767160892486572
Epoch: 19, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.231 Vali Acc: 0.954 Test Loss: 0.231 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 0.982074499130249
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.215 Vali Acc: 0.954 Test Loss: 0.215 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.2705020904541016
Epoch: 21, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.125108003616333
Epoch: 22, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 1.2339749336242676
Epoch: 23, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 0.9897708892822266
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 1.1776478290557861
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2276554107666016
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 1.0233793258666992
Epoch: 27, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 28 cost time: 0.9834709167480469
Epoch: 28, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 0.970991849899292
Epoch: 29, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.1097378730773926
Epoch: 30, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3123373985290527
Epoch: 31, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 32 cost time: 1.1065294742584229
Epoch: 32, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 33 cost time: 1.1798412799835205
Epoch: 33, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 34 cost time: 1.1146671772003174
Epoch: 34, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.103478193283081
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.224682092666626
Epoch: 36, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9374806880950928
Epoch: 37, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1818172931671143
Epoch: 38, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1218156814575195
Epoch: 39, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0184526443481445
Epoch: 40, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.966367244720459
Epoch: 41, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0683465003967285
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9872245788574219
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 44 cost time: 1.0049498081207275
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.007822036743164
Epoch: 45, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0987553596496582
Epoch: 46, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 1.0110137462615967
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 1.1748404502868652
Epoch: 48, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.262178897857666
Epoch: 49, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.888880729675293
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1961116790771484
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.3292195796966553
Epoch: 52, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.2372119426727295
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.1852214336395264
Epoch: 54, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2755892276763916
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0441479682922363
Epoch: 56, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.1811869144439697
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 62345
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.753960371017456
Epoch: 1, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.038 Vali Acc: 0.305 Test Loss: 2.038 Test Acc: 0.305
Validation loss decreased (inf --> -0.305385).  Saving model ...
Epoch: 2 cost time: 1.0719983577728271
Epoch: 2, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.866 Vali Acc: 0.481 Test Loss: 1.866 Test Acc: 0.481
Validation loss decreased (-0.305385 --> -0.481062).  Saving model ...
Epoch: 3 cost time: 1.0238537788391113
Epoch: 3, Steps: 17 | Train Loss: 1.759 Vali Loss: 1.655 Vali Acc: 0.662 Test Loss: 1.655 Test Acc: 0.662
Validation loss decreased (-0.481062 --> -0.662146).  Saving model ...
Epoch: 4 cost time: 1.204707145690918
Epoch: 4, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.451 Vali Acc: 0.730 Test Loss: 1.451 Test Acc: 0.730
Validation loss decreased (-0.662146 --> -0.729715).  Saving model ...
Epoch: 5 cost time: 1.2229642868041992
Epoch: 5, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.233 Vali Acc: 0.784 Test Loss: 1.233 Test Acc: 0.784
Validation loss decreased (-0.729715 --> -0.783771).  Saving model ...
Epoch: 6 cost time: 0.9621381759643555
Epoch: 6, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.030 Vali Acc: 0.835 Test Loss: 1.030 Test Acc: 0.835
Validation loss decreased (-0.783771 --> -0.835125).  Saving model ...
Epoch: 7 cost time: 1.0045616626739502
Epoch: 7, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.858 Vali Acc: 0.876 Test Loss: 0.858 Test Acc: 0.876
Validation loss decreased (-0.835125 --> -0.875667).  Saving model ...
Epoch: 8 cost time: 0.9887964725494385
Epoch: 8, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.715 Vali Acc: 0.897 Test Loss: 0.715 Test Acc: 0.897
Validation loss decreased (-0.875667 --> -0.897290).  Saving model ...
Epoch: 9 cost time: 0.9995496273040771
Epoch: 9, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.602 Vali Acc: 0.924 Test Loss: 0.602 Test Acc: 0.924
Validation loss decreased (-0.897290 --> -0.924318).  Saving model ...
Epoch: 10 cost time: 0.9688014984130859
Epoch: 10, Steps: 17 | Train Loss: 0.472 Vali Loss: 0.518 Vali Acc: 0.932 Test Loss: 0.518 Test Acc: 0.932
Validation loss decreased (-0.924318 --> -0.932427).  Saving model ...
Epoch: 11 cost time: 0.9350318908691406
Epoch: 11, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.448 Vali Acc: 0.938 Test Loss: 0.448 Test Acc: 0.938
Validation loss decreased (-0.932427 --> -0.937833).  Saving model ...
Epoch: 12 cost time: 1.1164686679840088
Epoch: 12, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.395 Vali Acc: 0.946 Test Loss: 0.395 Test Acc: 0.946
Validation loss decreased (-0.937833 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.2768900394439697
Epoch: 13, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.356 Vali Acc: 0.946 Test Loss: 0.356 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 1.2064712047576904
Epoch: 14, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.309 Vali Acc: 0.949 Test Loss: 0.309 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 1.2122840881347656
Epoch: 15, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.280 Vali Acc: 0.954 Test Loss: 0.280 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 1.1919541358947754
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 1.1305949687957764
Epoch: 17, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.234 Vali Acc: 0.951 Test Loss: 0.234 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0481758117675781
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.2631444931030273
Epoch: 19, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.202 Vali Acc: 0.954 Test Loss: 0.202 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 20 cost time: 1.157078742980957
Epoch: 20, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.03424072265625
Epoch: 21, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0005974769592285
Epoch: 22, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9997692108154297
Epoch: 23, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.109149694442749
Epoch: 24, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 0.987419605255127
Epoch: 25, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.957 Test Loss: 0.158 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9794845581054688
Epoch: 26, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 0.9319250583648682
Epoch: 27, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9612438678741455
Epoch: 28, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 0.8697502613067627
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 30 cost time: 0.9417374134063721
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.054807424545288
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 32 cost time: 1.2202281951904297
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.3276777267456055
Epoch: 33, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1553535461425781
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0054669380187988
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 36 cost time: 0.9748892784118652
Epoch: 36, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 37 cost time: 1.1832201480865479
Epoch: 37, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.136911392211914
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1268706321716309
Epoch: 39, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.1471283435821533
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2541677951812744
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 1.2093656063079834
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 43 cost time: 1.2294375896453857
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0920023918151855
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0532503128051758
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 1.1578505039215088
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 47 cost time: 1.1968703269958496
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.975675 --> -0.978377).  Saving model ...
Epoch: 48 cost time: 1.1482601165771484
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2321593761444092
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.200249433517456
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8967704772949219
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9681551456451416
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9390721321105957
Epoch: 53, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0057659149169922
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.2996435165405273
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.2226927280426025
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978377 --> -0.978377).  Saving model ...
Epoch: 57 cost time: 0.8789424896240234
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1038994789123535
Epoch: 58, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.051964521408081
Epoch: 59, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.1810433864593506
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9909148216247559
Epoch: 61, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.2074124813079834
Epoch: 62, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.1852505207061768
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.0943291187286377
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.1407368183135986
Epoch: 65, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.280766487121582
Epoch: 66, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 45961
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1094160079956055
Epoch: 1, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.040 Vali Acc: 0.297 Test Loss: 2.040 Test Acc: 0.297
Validation loss decreased (inf --> -0.297277).  Saving model ...
Epoch: 2 cost time: 1.1235873699188232
Epoch: 2, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.869 Vali Acc: 0.489 Test Loss: 1.869 Test Acc: 0.489
Validation loss decreased (-0.297277 --> -0.489170).  Saving model ...
Epoch: 3 cost time: 1.1463720798492432
Epoch: 3, Steps: 17 | Train Loss: 1.763 Vali Loss: 1.659 Vali Acc: 0.657 Test Loss: 1.659 Test Acc: 0.657
Validation loss decreased (-0.489170 --> -0.656740).  Saving model ...
Epoch: 4 cost time: 1.0979537963867188
Epoch: 4, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.457 Vali Acc: 0.719 Test Loss: 1.457 Test Acc: 0.719
Validation loss decreased (-0.656740 --> -0.718904).  Saving model ...
Epoch: 5 cost time: 0.9350380897521973
Epoch: 5, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.241 Vali Acc: 0.776 Test Loss: 1.241 Test Acc: 0.776
Validation loss decreased (-0.718904 --> -0.775663).  Saving model ...
Epoch: 6 cost time: 1.1878187656402588
Epoch: 6, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.039 Vali Acc: 0.846 Test Loss: 1.039 Test Acc: 0.846
Validation loss decreased (-0.775663 --> -0.845936).  Saving model ...
Epoch: 7 cost time: 1.1562397480010986
Epoch: 7, Steps: 17 | Train Loss: 0.872 Vali Loss: 0.867 Vali Acc: 0.881 Test Loss: 0.867 Test Acc: 0.881
Validation loss decreased (-0.845936 --> -0.881072).  Saving model ...
Epoch: 8 cost time: 0.8679933547973633
Epoch: 8, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.727 Vali Acc: 0.892 Test Loss: 0.727 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891885).  Saving model ...
Epoch: 9 cost time: 1.0878944396972656
Epoch: 9, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.612 Vali Acc: 0.927 Test Loss: 0.612 Test Acc: 0.927
Validation loss decreased (-0.891885 --> -0.927021).  Saving model ...
Epoch: 10 cost time: 1.2608065605163574
Epoch: 10, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.525 Vali Acc: 0.932 Test Loss: 0.525 Test Acc: 0.932
Validation loss decreased (-0.927021 --> -0.932427).  Saving model ...
Epoch: 11 cost time: 1.2190923690795898
Epoch: 11, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.457 Vali Acc: 0.938 Test Loss: 0.457 Test Acc: 0.938
Validation loss decreased (-0.932427 --> -0.937833).  Saving model ...
Epoch: 12 cost time: 0.9867322444915771
Epoch: 12, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.400 Vali Acc: 0.946 Test Loss: 0.400 Test Acc: 0.946
Validation loss decreased (-0.937833 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 0.9768056869506836
Epoch: 13, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.361 Vali Acc: 0.946 Test Loss: 0.361 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 0.8653302192687988
Epoch: 14, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.311 Vali Acc: 0.949 Test Loss: 0.311 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 0.883232831954956
Epoch: 15, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.283 Vali Acc: 0.954 Test Loss: 0.283 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 1.0172033309936523
Epoch: 16, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 17 cost time: 0.895172119140625
Epoch: 17, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.237 Vali Acc: 0.957 Test Loss: 0.237 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 18 cost time: 1.1424119472503662
Epoch: 18, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9972376823425293
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.182185411453247
Epoch: 20, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2418498992919922
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.24302077293396
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1419484615325928
Epoch: 23, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.218585729598999
Epoch: 24, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 0.9768338203430176
Epoch: 25, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 1.0998256206512451
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.0335218906402588
Epoch: 27, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1002724170684814
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1382405757904053
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.1804943084716797
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1554539203643799
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2198257446289062
Epoch: 32, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 0.9416530132293701
Epoch: 33, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0983061790466309
Epoch: 34, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0428376197814941
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2009999752044678
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2368910312652588
Epoch: 37, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2556681632995605
Epoch: 38, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9576046466827393
Epoch: 39, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.1344151496887207
Epoch: 40, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 41 cost time: 0.9882869720458984
Epoch: 41, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9792354106903076
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9421679973602295
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1397302150726318
Epoch: 44, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2308743000030518
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 46 cost time: 0.9106380939483643
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 47 cost time: 1.1596705913543701
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0021958351135254
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9314396381378174
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9466218948364258
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9998626708984375
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.2468852996826172
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2111096382141113
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1633012294769287
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.2464330196380615
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1961302757263184
Epoch: 56, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 45961
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.9626054763793945
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.053 Vali Acc: 0.273 Test Loss: 2.053 Test Acc: 0.273
Validation loss decreased (inf --> -0.272952).  Saving model ...
Epoch: 2 cost time: 1.1241450309753418
Epoch: 2, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.888 Vali Acc: 0.492 Test Loss: 1.888 Test Acc: 0.492
Validation loss decreased (-0.272952 --> -0.491873).  Saving model ...
Epoch: 3 cost time: 1.0637977123260498
Epoch: 3, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.683 Vali Acc: 0.651 Test Loss: 1.683 Test Acc: 0.651
Validation loss decreased (-0.491873 --> -0.651335).  Saving model ...
Epoch: 4 cost time: 1.136474847793579
Epoch: 4, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.485 Vali Acc: 0.703 Test Loss: 1.485 Test Acc: 0.703
Validation loss decreased (-0.651335 --> -0.702688).  Saving model ...
Epoch: 5 cost time: 1.066023349761963
Epoch: 5, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.270 Vali Acc: 0.781 Test Loss: 1.270 Test Acc: 0.781
Validation loss decreased (-0.702688 --> -0.781068).  Saving model ...
Epoch: 6 cost time: 0.8840556144714355
Epoch: 6, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.067 Vali Acc: 0.835 Test Loss: 1.067 Test Acc: 0.835
Validation loss decreased (-0.781068 --> -0.835124).  Saving model ...
Epoch: 7 cost time: 1.0925555229187012
Epoch: 7, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.896 Vali Acc: 0.881 Test Loss: 0.896 Test Acc: 0.881
Validation loss decreased (-0.835124 --> -0.881072).  Saving model ...
Epoch: 8 cost time: 0.8597877025604248
Epoch: 8, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.755 Vali Acc: 0.905 Test Loss: 0.755 Test Acc: 0.905
Validation loss decreased (-0.881072 --> -0.905398).  Saving model ...
Epoch: 9 cost time: 1.0276341438293457
Epoch: 9, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.638 Vali Acc: 0.927 Test Loss: 0.638 Test Acc: 0.927
Validation loss decreased (-0.905398 --> -0.927021).  Saving model ...
Epoch: 10 cost time: 0.8503315448760986
Epoch: 10, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.549 Vali Acc: 0.927 Test Loss: 0.549 Test Acc: 0.927
Validation loss decreased (-0.927021 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 0.9629096984863281
Epoch: 11, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.476 Vali Acc: 0.932 Test Loss: 0.476 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.0250556468963623
Epoch: 12, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.419 Vali Acc: 0.943 Test Loss: 0.419 Test Acc: 0.943
Validation loss decreased (-0.932428 --> -0.943239).  Saving model ...
Epoch: 13 cost time: 1.0147576332092285
Epoch: 13, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.378 Vali Acc: 0.946 Test Loss: 0.378 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 1.0150501728057861
Epoch: 14, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.327 Vali Acc: 0.954 Test Loss: 0.327 Test Acc: 0.954
Validation loss decreased (-0.945942 --> -0.954051).  Saving model ...
Epoch: 15 cost time: 1.1572551727294922
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.298 Vali Acc: 0.954 Test Loss: 0.298 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 16 cost time: 0.9390575885772705
Epoch: 16, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 1.045783281326294
Epoch: 17, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 18 cost time: 1.1246514320373535
Epoch: 18, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.226 Vali Acc: 0.957 Test Loss: 0.226 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 0.9104466438293457
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 20 cost time: 1.041755199432373
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.092813491821289
Epoch: 21, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9424896240234375
Epoch: 22, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.177 Vali Acc: 0.959 Test Loss: 0.177 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.035168170928955
Epoch: 23, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.087465763092041
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 25 cost time: 1.09688138961792
Epoch: 25, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 26 cost time: 1.1153302192687988
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.0617549419403076
Epoch: 27, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8644263744354248
Epoch: 28, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 29 cost time: 0.8111631870269775
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8430156707763672
Epoch: 30, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.885326623916626
Epoch: 31, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9273993968963623
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9080173969268799
Epoch: 33, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9328954219818115
Epoch: 34, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9632585048675537
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9958901405334473
Epoch: 36, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9747512340545654
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 1.0540473461151123
Epoch: 38, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0830349922180176
Epoch: 39, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 40 cost time: 1.0222079753875732
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 41 cost time: 1.092477560043335
Epoch: 41, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0102949142456055
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 43 cost time: 1.0045733451843262
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0609712600708008
Epoch: 44, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.080115556716919
Epoch: 45, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9616646766662598
Epoch: 46, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 47 cost time: 1.0188658237457275
Epoch: 47, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 48 cost time: 1.1279551982879639
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0772271156311035
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.1068110466003418
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.140033483505249
Epoch: 51, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0766077041625977
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1343448162078857
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.968 Test Loss: 0.094 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0787267684936523
Epoch: 54, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.965 Test Loss: 0.096 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.0608701705932617
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.030651569366455
Epoch: 56, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.194448471069336
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 45961
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6415047645568848
Epoch: 1, Steps: 17 | Train Loss: 2.181 Vali Loss: 2.083 Vali Acc: 0.278 Test Loss: 2.083 Test Acc: 0.278
Validation loss decreased (inf --> -0.278358).  Saving model ...
Epoch: 2 cost time: 1.1634082794189453
Epoch: 2, Steps: 17 | Train Loss: 2.053 Vali Loss: 1.941 Vali Acc: 0.532 Test Loss: 1.941 Test Acc: 0.532
Validation loss decreased (-0.278358 --> -0.532413).  Saving model ...
Epoch: 3 cost time: 0.886286735534668
Epoch: 3, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.759 Vali Acc: 0.695 Test Loss: 1.759 Test Acc: 0.695
Validation loss decreased (-0.532413 --> -0.694577).  Saving model ...
Epoch: 4 cost time: 1.0759742259979248
Epoch: 4, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.573 Vali Acc: 0.757 Test Loss: 1.573 Test Acc: 0.757
Validation loss decreased (-0.694577 --> -0.756741).  Saving model ...
Epoch: 5 cost time: 0.9577617645263672
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.370 Vali Acc: 0.808 Test Loss: 1.370 Test Acc: 0.808
Validation loss decreased (-0.756741 --> -0.808094).  Saving model ...
Epoch: 6 cost time: 1.203578233718872
Epoch: 6, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.169 Vali Acc: 0.849 Test Loss: 1.169 Test Acc: 0.849
Validation loss decreased (-0.808094 --> -0.848637).  Saving model ...
Epoch: 7 cost time: 1.1783447265625
Epoch: 7, Steps: 17 | Train Loss: 0.996 Vali Loss: 0.996 Vali Acc: 0.868 Test Loss: 0.996 Test Acc: 0.868
Validation loss decreased (-0.848637 --> -0.867558).  Saving model ...
Epoch: 8 cost time: 1.146303415298462
Epoch: 8, Steps: 17 | Train Loss: 0.835 Vali Loss: 0.846 Vali Acc: 0.897 Test Loss: 0.846 Test Acc: 0.897
Validation loss decreased (-0.867558 --> -0.897289).  Saving model ...
Epoch: 9 cost time: 1.0320179462432861
Epoch: 9, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.714 Vali Acc: 0.905 Test Loss: 0.714 Test Acc: 0.905
Validation loss decreased (-0.897289 --> -0.905398).  Saving model ...
Epoch: 10 cost time: 1.1228160858154297
Epoch: 10, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.614 Vali Acc: 0.930 Test Loss: 0.614 Test Acc: 0.930
Validation loss decreased (-0.905398 --> -0.929724).  Saving model ...
Epoch: 11 cost time: 1.0466499328613281
Epoch: 11, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.530 Vali Acc: 0.935 Test Loss: 0.530 Test Acc: 0.935
Validation loss decreased (-0.929724 --> -0.935130).  Saving model ...
Epoch: 12 cost time: 1.0691065788269043
Epoch: 12, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.460 Vali Acc: 0.938 Test Loss: 0.460 Test Acc: 0.938
Validation loss decreased (-0.935130 --> -0.937833).  Saving model ...
Epoch: 13 cost time: 0.9910140037536621
Epoch: 13, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.410 Vali Acc: 0.935 Test Loss: 0.410 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0562350749969482
Epoch: 14, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.355 Vali Acc: 0.954 Test Loss: 0.355 Test Acc: 0.954
Validation loss decreased (-0.937833 --> -0.954051).  Saving model ...
Epoch: 15 cost time: 1.2220818996429443
Epoch: 15, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.327 Vali Acc: 0.949 Test Loss: 0.327 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0940184593200684
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.296 Vali Acc: 0.957 Test Loss: 0.296 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 17 cost time: 1.0682768821716309
Epoch: 17, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.268 Vali Acc: 0.954 Test Loss: 0.268 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.23805832862854
Epoch: 18, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.244 Vali Acc: 0.957 Test Loss: 0.244 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 1.0428991317749023
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 20 cost time: 0.9322917461395264
Epoch: 20, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 0.8880519866943359
Epoch: 21, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 22 cost time: 1.0873770713806152
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 23 cost time: 1.1461966037750244
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 1.0235438346862793
Epoch: 24, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 1.0067222118377686
Epoch: 25, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 26 cost time: 1.1326558589935303
Epoch: 26, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 1.0803942680358887
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.231947422027588
Epoch: 28, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.186075210571289
Epoch: 29, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1688430309295654
Epoch: 30, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 31 cost time: 1.227224349975586
Epoch: 31, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0859217643737793
Epoch: 32, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9494788646697998
Epoch: 33, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 34 cost time: 1.234072208404541
Epoch: 34, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 1.0389761924743652
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.885995626449585
Epoch: 36, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.039583683013916
Epoch: 37, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 38 cost time: 1.072979211807251
Epoch: 38, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2389516830444336
Epoch: 39, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.116546392440796
Epoch: 40, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.188781976699829
Epoch: 41, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 42 cost time: 1.1676478385925293
Epoch: 42, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 43 cost time: 1.1881823539733887
Epoch: 43, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0066509246826172
Epoch: 44, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9130246639251709
Epoch: 45, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9598760604858398
Epoch: 46, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9547269344329834
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 0.9758138656616211
Epoch: 48, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1732449531555176
Epoch: 49, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.2275493144989014
Epoch: 50, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.173006296157837
Epoch: 51, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0884099006652832
Epoch: 52, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 53 cost time: 1.1772146224975586
Epoch: 53, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 1.132382869720459
Epoch: 54, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9975273609161377
Epoch: 55, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.2259509563446045
Epoch: 56, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.162121295928955
Epoch: 57, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0527429580688477
Epoch: 58, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.1626570224761963
Epoch: 59, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.1566429138183594
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.8369693756103516
Epoch: 61, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.1147558689117432
Epoch: 62, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.0776934623718262
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 64 cost time: 1.0119194984436035
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 65 cost time: 1.1834282875061035
Epoch: 65, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 66 cost time: 1.14155912399292
Epoch: 66, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0425310134887695
Epoch: 67, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 68 cost time: 1.1222236156463623
Epoch: 68, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.965 Test Loss: 0.095 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9626696109771729
Epoch: 69, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.125849723815918
Epoch: 70, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.0342156887054443
Epoch: 71, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 72 cost time: 1.1509220600128174
Epoch: 72, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 73 cost time: 1.1217758655548096
Epoch: 73, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.0841519832611084
Epoch: 74, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9568831920623779
Epoch: 75, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9565508365631104
Epoch: 76, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 77 cost time: 0.949779748916626
Epoch: 77, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.999152421951294
Epoch: 78, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9479224681854248
Epoch: 79, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.1917800903320312
Epoch: 80, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 1.2486670017242432
Epoch: 81, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 1.2232356071472168
Epoch: 82, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 1.150784969329834
Epoch: 83, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 1.2654190063476562
Epoch: 84, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 1.091256856918335
Epoch: 85, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.9621963500976562
Epoch: 86, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 45961
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.829536199569702
Epoch: 1, Steps: 17 | Train Loss: 2.196 Vali Loss: 2.173 Vali Acc: 0.130 Test Loss: 2.173 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 0.9382057189941406
Epoch: 2, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.970 Vali Acc: 0.351 Test Loss: 1.970 Test Acc: 0.351
Validation loss decreased (-0.129708 --> -0.351332).  Saving model ...
Epoch: 3 cost time: 0.9676117897033691
Epoch: 3, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.732 Vali Acc: 0.589 Test Loss: 1.732 Test Acc: 0.589
Validation loss decreased (-0.351332 --> -0.589172).  Saving model ...
Epoch: 4 cost time: 0.9652853012084961
Epoch: 4, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.506 Vali Acc: 0.689 Test Loss: 1.506 Test Acc: 0.689
Validation loss decreased (-0.589172 --> -0.689174).  Saving model ...
Epoch: 5 cost time: 1.083069086074829
Epoch: 5, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.278 Vali Acc: 0.749 Test Loss: 1.278 Test Acc: 0.749
Validation loss decreased (-0.689174 --> -0.748636).  Saving model ...
Epoch: 6 cost time: 1.2821295261383057
Epoch: 6, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.087 Vali Acc: 0.797 Test Loss: 1.087 Test Acc: 0.797
Validation loss decreased (-0.748636 --> -0.797286).  Saving model ...
Epoch: 7 cost time: 1.3092224597930908
Epoch: 7, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.920 Vali Acc: 0.827 Test Loss: 0.920 Test Acc: 0.827
Validation loss decreased (-0.797286 --> -0.827018).  Saving model ...
Epoch: 8 cost time: 1.156125545501709
Epoch: 8, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.754 Vali Acc: 0.878 Test Loss: 0.754 Test Acc: 0.878
Validation loss decreased (-0.827018 --> -0.878371).  Saving model ...
Epoch: 9 cost time: 1.1017546653747559
Epoch: 9, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.632 Vali Acc: 0.903 Test Loss: 0.632 Test Acc: 0.903
Validation loss decreased (-0.878371 --> -0.902696).  Saving model ...
Epoch: 10 cost time: 1.0754187107086182
Epoch: 10, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.537 Vali Acc: 0.924 Test Loss: 0.537 Test Acc: 0.924
Validation loss decreased (-0.902696 --> -0.924319).  Saving model ...
Epoch: 11 cost time: 1.1721901893615723
Epoch: 11, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.469 Vali Acc: 0.930 Test Loss: 0.469 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929725).  Saving model ...
Epoch: 12 cost time: 1.2595231533050537
Epoch: 12, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.410 Vali Acc: 0.935 Test Loss: 0.410 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 13 cost time: 1.1401331424713135
Epoch: 13, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.357 Vali Acc: 0.943 Test Loss: 0.357 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 14 cost time: 1.2604639530181885
Epoch: 14, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.322 Vali Acc: 0.943 Test Loss: 0.322 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 15 cost time: 1.1806416511535645
Epoch: 15, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 16 cost time: 1.1639642715454102
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.261 Vali Acc: 0.946 Test Loss: 0.261 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 1.197739601135254
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2887976169586182
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3148698806762695
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 1.2898433208465576
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.199 Vali Acc: 0.949 Test Loss: 0.199 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 1.0802288055419922
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 0.9354696273803711
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 0.933396577835083
Epoch: 23, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 0.9435923099517822
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 25 cost time: 1.0612633228302002
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.1259500980377197
Epoch: 26, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 27 cost time: 1.0169765949249268
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 28 cost time: 1.223353624343872
Epoch: 28, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.232032299041748
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 30 cost time: 1.0836772918701172
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0053443908691406
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.2325019836425781
Epoch: 32, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 33 cost time: 1.1159989833831787
Epoch: 33, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 0.9419827461242676
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0345542430877686
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.266648530960083
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 1.1038062572479248
Epoch: 37, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0191054344177246
Epoch: 38, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9074609279632568
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.1879420280456543
Epoch: 40, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.225339651107788
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1815543174743652
Epoch: 42, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 43 cost time: 1.0411994457244873
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 44 cost time: 1.260861873626709
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 1.1999990940093994
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1220619678497314
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0372898578643799
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 48 cost time: 1.2512891292572021
Epoch: 48, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.1927828788757324
Epoch: 49, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.114896535873413
Epoch: 50, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 51 cost time: 1.106731653213501
Epoch: 51, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2467927932739258
Epoch: 52, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 53 cost time: 1.209653377532959
Epoch: 53, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 54 cost time: 1.1512608528137207
Epoch: 54, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.093977451324463
Epoch: 55, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.302668571472168
Epoch: 56, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.126981258392334
Epoch: 57, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.099538803100586
Epoch: 58, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 59 cost time: 0.9402406215667725
Epoch: 59, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9779713153839111
Epoch: 60, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9505934715270996
Epoch: 61, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8978478908538818
Epoch: 62, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0222930908203125
Epoch: 63, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.2706661224365234
Epoch: 64, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.2839372158050537
Epoch: 65, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.2723255157470703
Epoch: 66, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.2992119789123535
Epoch: 67, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.3327827453613281
Epoch: 68, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 37769
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.088376522064209
Epoch: 1, Steps: 17 | Train Loss: 2.187 Vali Loss: 2.168 Vali Acc: 0.135 Test Loss: 2.168 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 1.0108509063720703
Epoch: 2, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.967 Vali Acc: 0.346 Test Loss: 1.967 Test Acc: 0.346
Validation loss decreased (-0.135113 --> -0.345926).  Saving model ...
Epoch: 3 cost time: 1.0897016525268555
Epoch: 3, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.732 Vali Acc: 0.600 Test Loss: 1.732 Test Acc: 0.600
Validation loss decreased (-0.345926 --> -0.599983).  Saving model ...
Epoch: 4 cost time: 1.0658938884735107
Epoch: 4, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.507 Vali Acc: 0.705 Test Loss: 1.507 Test Acc: 0.705
Validation loss decreased (-0.599983 --> -0.705390).  Saving model ...
Epoch: 5 cost time: 1.0979211330413818
Epoch: 5, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.280 Vali Acc: 0.765 Test Loss: 1.280 Test Acc: 0.765
Validation loss decreased (-0.705390 --> -0.764852).  Saving model ...
Epoch: 6 cost time: 1.187382459640503
Epoch: 6, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.090 Vali Acc: 0.805 Test Loss: 1.090 Test Acc: 0.805
Validation loss decreased (-0.764852 --> -0.805395).  Saving model ...
Epoch: 7 cost time: 1.1686623096466064
Epoch: 7, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.924 Vali Acc: 0.838 Test Loss: 0.924 Test Acc: 0.838
Validation loss decreased (-0.805395 --> -0.837829).  Saving model ...
Epoch: 8 cost time: 1.0265917778015137
Epoch: 8, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.759 Vali Acc: 0.870 Test Loss: 0.759 Test Acc: 0.870
Validation loss decreased (-0.837829 --> -0.870263).  Saving model ...
Epoch: 9 cost time: 1.2987098693847656
Epoch: 9, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.637 Vali Acc: 0.903 Test Loss: 0.637 Test Acc: 0.903
Validation loss decreased (-0.870263 --> -0.902696).  Saving model ...
Epoch: 10 cost time: 1.1607186794281006
Epoch: 10, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.543 Vali Acc: 0.927 Test Loss: 0.543 Test Acc: 0.927
Validation loss decreased (-0.902696 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 1.1725656986236572
Epoch: 11, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.474 Vali Acc: 0.922 Test Loss: 0.474 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2246990203857422
Epoch: 12, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.415 Vali Acc: 0.943 Test Loss: 0.415 Test Acc: 0.943
Validation loss decreased (-0.927022 --> -0.943239).  Saving model ...
Epoch: 13 cost time: 1.0377287864685059
Epoch: 13, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.360 Vali Acc: 0.949 Test Loss: 0.360 Test Acc: 0.949
Validation loss decreased (-0.943239 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 0.9994804859161377
Epoch: 14, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.323 Vali Acc: 0.946 Test Loss: 0.323 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9157509803771973
Epoch: 15, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.292 Vali Acc: 0.946 Test Loss: 0.292 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9245650768280029
Epoch: 16, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.263 Vali Acc: 0.946 Test Loss: 0.263 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8749980926513672
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 18 cost time: 0.899538516998291
Epoch: 18, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.221 Vali Acc: 0.949 Test Loss: 0.221 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 19 cost time: 0.8858034610748291
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 1.013038158416748
Epoch: 20, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.027285099029541
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 1.2992510795593262
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1340727806091309
Epoch: 23, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 24 cost time: 1.196221113204956
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 1.1423070430755615
Epoch: 25, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 1.1626145839691162
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.150 Vali Acc: 0.965 Test Loss: 0.150 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0894546508789062
Epoch: 27, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 28 cost time: 1.0261762142181396
Epoch: 28, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0017979145050049
Epoch: 29, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0041348934173584
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 31 cost time: 1.0875613689422607
Epoch: 31, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 32 cost time: 1.1536664962768555
Epoch: 32, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1578328609466553
Epoch: 33, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 0.9500641822814941
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.189657211303711
Epoch: 35, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2255375385284424
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 37 cost time: 1.2380666732788086
Epoch: 37, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 38 cost time: 1.3965034484863281
Epoch: 38, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 39 cost time: 1.2329072952270508
Epoch: 39, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 40 cost time: 1.2320764064788818
Epoch: 40, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.324002742767334
Epoch: 41, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.2363340854644775
Epoch: 42, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2301263809204102
Epoch: 43, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2974915504455566
Epoch: 44, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2175049781799316
Epoch: 45, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1891098022460938
Epoch: 46, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.261742353439331
Epoch: 47, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1473045349121094
Epoch: 48, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2389581203460693
Epoch: 49, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 37769
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3995227813720703
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.165 Vali Acc: 0.141 Test Loss: 2.165 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 0.832496166229248
Epoch: 2, Steps: 17 | Train Loss: 2.049 Vali Loss: 1.973 Vali Acc: 0.338 Test Loss: 1.973 Test Acc: 0.338
Validation loss decreased (-0.140519 --> -0.337818).  Saving model ...
Epoch: 3 cost time: 1.1856231689453125
Epoch: 3, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.746 Vali Acc: 0.597 Test Loss: 1.746 Test Acc: 0.597
Validation loss decreased (-0.337818 --> -0.597280).  Saving model ...
Epoch: 4 cost time: 1.1665394306182861
Epoch: 4, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.527 Vali Acc: 0.708 Test Loss: 1.527 Test Acc: 0.708
Validation loss decreased (-0.597280 --> -0.708093).  Saving model ...
Epoch: 5 cost time: 1.1731035709381104
Epoch: 5, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.304 Vali Acc: 0.776 Test Loss: 1.304 Test Acc: 0.776
Validation loss decreased (-0.708093 --> -0.775663).  Saving model ...
Epoch: 6 cost time: 1.1819543838500977
Epoch: 6, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.113 Vali Acc: 0.803 Test Loss: 1.113 Test Acc: 0.803
Validation loss decreased (-0.775663 --> -0.802692).  Saving model ...
Epoch: 7 cost time: 1.034536600112915
Epoch: 7, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.946 Vali Acc: 0.843 Test Loss: 0.946 Test Acc: 0.843
Validation loss decreased (-0.802692 --> -0.843234).  Saving model ...
Epoch: 8 cost time: 1.0295031070709229
Epoch: 8, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.780 Vali Acc: 0.895 Test Loss: 0.780 Test Acc: 0.895
Validation loss decreased (-0.843234 --> -0.894587).  Saving model ...
Epoch: 9 cost time: 1.0041992664337158
Epoch: 9, Steps: 17 | Train Loss: 0.609 Vali Loss: 0.655 Vali Acc: 0.916 Test Loss: 0.655 Test Acc: 0.916
Validation loss decreased (-0.894587 --> -0.916210).  Saving model ...
Epoch: 10 cost time: 1.1844947338104248
Epoch: 10, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.557 Vali Acc: 0.927 Test Loss: 0.557 Test Acc: 0.927
Validation loss decreased (-0.916210 --> -0.927021).  Saving model ...
Epoch: 11 cost time: 1.1375656127929688
Epoch: 11, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.489 Vali Acc: 0.932 Test Loss: 0.489 Test Acc: 0.932
Validation loss decreased (-0.927021 --> -0.932428).  Saving model ...
Epoch: 12 cost time: 1.0296928882598877
Epoch: 12, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.430 Vali Acc: 0.946 Test Loss: 0.430 Test Acc: 0.946
Validation loss decreased (-0.932428 --> -0.945942).  Saving model ...
Epoch: 13 cost time: 1.1452491283416748
Epoch: 13, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.372 Vali Acc: 0.946 Test Loss: 0.372 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 0.9957356452941895
Epoch: 14, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.332 Vali Acc: 0.946 Test Loss: 0.332 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 15 cost time: 0.9472713470458984
Epoch: 15, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.301 Vali Acc: 0.946 Test Loss: 0.301 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 1.007889986038208
Epoch: 16, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.272 Vali Acc: 0.946 Test Loss: 0.272 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 1.2749030590057373
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 18 cost time: 1.1358931064605713
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.231 Vali Acc: 0.949 Test Loss: 0.231 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1367104053497314
Epoch: 19, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 20 cost time: 1.166234016418457
Epoch: 20, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 21 cost time: 1.0833253860473633
Epoch: 21, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.0663843154907227
Epoch: 22, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.057579755783081
Epoch: 23, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.175 Vali Acc: 0.954 Test Loss: 0.175 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9975874423980713
Epoch: 24, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 25 cost time: 1.1021032333374023
Epoch: 25, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 26 cost time: 0.9815363883972168
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.956755 --> -0.964863).  Saving model ...
Epoch: 27 cost time: 1.1901912689208984
Epoch: 27, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 28 cost time: 1.073075532913208
Epoch: 28, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0977580547332764
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2552125453948975
Epoch: 30, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 31 cost time: 1.165328025817871
Epoch: 31, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 32 cost time: 1.1824872493743896
Epoch: 32, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2048513889312744
Epoch: 33, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 34 cost time: 1.1097111701965332
Epoch: 34, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1082580089569092
Epoch: 35, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.170793056488037
Epoch: 36, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.198023796081543
Epoch: 37, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0039525032043457
Epoch: 38, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.249162197113037
Epoch: 39, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1156220436096191
Epoch: 40, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0089991092681885
Epoch: 41, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.966733455657959
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9161691665649414
Epoch: 43, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 37769
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.818024158477783
Epoch: 1, Steps: 17 | Train Loss: 2.173 Vali Loss: 2.163 Vali Acc: 0.173 Test Loss: 2.163 Test Acc: 0.173
Validation loss decreased (inf --> -0.172951).  Saving model ...
Epoch: 2 cost time: 1.0216171741485596
Epoch: 2, Steps: 17 | Train Loss: 2.059 Vali Loss: 2.002 Vali Acc: 0.346 Test Loss: 2.002 Test Acc: 0.346
Validation loss decreased (-0.172951 --> -0.345926).  Saving model ...
Epoch: 3 cost time: 1.099909782409668
Epoch: 3, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.804 Vali Acc: 0.622 Test Loss: 1.804 Test Acc: 0.622
Validation loss decreased (-0.345926 --> -0.621604).  Saving model ...
Epoch: 4 cost time: 1.0933802127838135
Epoch: 4, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.603 Vali Acc: 0.743 Test Loss: 1.603 Test Acc: 0.743
Validation loss decreased (-0.621604 --> -0.743227).  Saving model ...
Epoch: 5 cost time: 1.0746243000030518
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.391 Vali Acc: 0.805 Test Loss: 1.391 Test Acc: 0.805
Validation loss decreased (-0.743227 --> -0.805391).  Saving model ...
Epoch: 6 cost time: 1.0074708461761475
Epoch: 6, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.200 Vali Acc: 0.835 Test Loss: 1.200 Test Acc: 0.835
Validation loss decreased (-0.805391 --> -0.835123).  Saving model ...
Epoch: 7 cost time: 1.1245050430297852
Epoch: 7, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.034 Vali Acc: 0.851 Test Loss: 1.034 Test Acc: 0.851
Validation loss decreased (-0.835123 --> -0.851341).  Saving model ...
Epoch: 8 cost time: 1.1174507141113281
Epoch: 8, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.865 Vali Acc: 0.892 Test Loss: 0.865 Test Acc: 0.892
Validation loss decreased (-0.851341 --> -0.891883).  Saving model ...
Epoch: 9 cost time: 1.0611517429351807
Epoch: 9, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.730 Vali Acc: 0.905 Test Loss: 0.730 Test Acc: 0.905
Validation loss decreased (-0.891883 --> -0.905398).  Saving model ...
Epoch: 10 cost time: 1.1988508701324463
Epoch: 10, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.622 Vali Acc: 0.911 Test Loss: 0.622 Test Acc: 0.911
Validation loss decreased (-0.905398 --> -0.910805).  Saving model ...
Epoch: 11 cost time: 1.0425403118133545
Epoch: 11, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.544 Vali Acc: 0.927 Test Loss: 0.544 Test Acc: 0.927
Validation loss decreased (-0.910805 --> -0.927022).  Saving model ...
Epoch: 12 cost time: 1.0459349155426025
Epoch: 12, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.476 Vali Acc: 0.932 Test Loss: 0.476 Test Acc: 0.932
Validation loss decreased (-0.927022 --> -0.932428).  Saving model ...
Epoch: 13 cost time: 1.0380501747131348
Epoch: 13, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.412 Vali Acc: 0.949 Test Loss: 0.412 Test Acc: 0.949
Validation loss decreased (-0.932428 --> -0.948645).  Saving model ...
Epoch: 14 cost time: 1.0169260501861572
Epoch: 14, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.368 Vali Acc: 0.943 Test Loss: 0.368 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0569567680358887
Epoch: 15, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.332 Vali Acc: 0.946 Test Loss: 0.332 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.120680570602417
Epoch: 16, Steps: 17 | Train Loss: 0.220 Vali Loss: 0.298 Vali Acc: 0.946 Test Loss: 0.298 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9511308670043945
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 18 cost time: 0.9443144798278809
Epoch: 18, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 19 cost time: 0.8802776336669922
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 20 cost time: 0.953864574432373
Epoch: 20, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 21 cost time: 1.1504058837890625
Epoch: 21, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.200 Vali Acc: 0.957 Test Loss: 0.200 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.104768991470337
Epoch: 22, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 1.0428557395935059
Epoch: 23, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962160).  Saving model ...
Epoch: 24 cost time: 1.0915439128875732
Epoch: 24, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 0.9061956405639648
Epoch: 25, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0571813583374023
Epoch: 26, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0286140441894531
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.137760877609253
Epoch: 28, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 1.0500106811523438
Epoch: 29, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 30 cost time: 1.0207688808441162
Epoch: 30, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0301659107208252
Epoch: 31, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9295651912689209
Epoch: 32, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1040306091308594
Epoch: 33, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1567885875701904
Epoch: 34, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.190441370010376
Epoch: 35, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.99420166015625
Epoch: 36, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.959 Test Loss: 0.118 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1639647483825684
Epoch: 37, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 0.9235656261444092
Epoch: 38, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0906305313110352
Epoch: 39, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9483211040496826
Epoch: 40, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0827796459197998
Epoch: 41, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1397993564605713
Epoch: 42, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0464730262756348
Epoch: 43, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9823753833770752
Epoch: 44, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.953425407409668
Epoch: 45, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0741021633148193
Epoch: 46, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0368776321411133
Epoch: 47, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 37769
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1615829467773438
Epoch: 1, Steps: 17 | Train Loss: 2.182 Vali Loss: 2.188 Vali Acc: 0.195 Test Loss: 2.188 Test Acc: 0.195
Validation loss decreased (inf --> -0.194573).  Saving model ...
Epoch: 2 cost time: 1.0495691299438477
Epoch: 2, Steps: 17 | Train Loss: 2.108 Vali Loss: 2.078 Vali Acc: 0.254 Test Loss: 2.078 Test Acc: 0.254
Validation loss decreased (-0.194573 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 1.118175983428955
Epoch: 3, Steps: 17 | Train Loss: 1.967 Vali Loss: 1.938 Vali Acc: 0.351 Test Loss: 1.938 Test Acc: 0.351
Validation loss decreased (-0.254033 --> -0.351332).  Saving model ...
Epoch: 4 cost time: 1.071458339691162
Epoch: 4, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.776 Vali Acc: 0.551 Test Loss: 1.776 Test Acc: 0.551
Validation loss decreased (-0.351332 --> -0.551334).  Saving model ...
Epoch: 5 cost time: 0.9967818260192871
Epoch: 5, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.613 Vali Acc: 0.689 Test Loss: 1.613 Test Acc: 0.689
Validation loss decreased (-0.551334 --> -0.689173).  Saving model ...
Epoch: 6 cost time: 1.1038293838500977
Epoch: 6, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.456 Vali Acc: 0.795 Test Loss: 1.456 Test Acc: 0.795
Validation loss decreased (-0.689173 --> -0.794580).  Saving model ...
Epoch: 7 cost time: 1.0400550365447998
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.304 Vali Acc: 0.851 Test Loss: 1.304 Test Acc: 0.851
Validation loss decreased (-0.794580 --> -0.851338).  Saving model ...
Epoch: 8 cost time: 1.0015246868133545
Epoch: 8, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.162 Vali Acc: 0.868 Test Loss: 1.162 Test Acc: 0.868
Validation loss decreased (-0.851338 --> -0.867556).  Saving model ...
Epoch: 9 cost time: 0.9290628433227539
Epoch: 9, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.030 Vali Acc: 0.873 Test Loss: 1.030 Test Acc: 0.873
Validation loss decreased (-0.867556 --> -0.872963).  Saving model ...
Epoch: 10 cost time: 1.0002598762512207
Epoch: 10, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.909 Vali Acc: 0.884 Test Loss: 0.909 Test Acc: 0.884
Validation loss decreased (-0.872963 --> -0.883775).  Saving model ...
Epoch: 11 cost time: 1.1380960941314697
Epoch: 11, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.820 Vali Acc: 0.895 Test Loss: 0.820 Test Acc: 0.895
Validation loss decreased (-0.883775 --> -0.894586).  Saving model ...
Epoch: 12 cost time: 0.9990036487579346
Epoch: 12, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.727 Vali Acc: 0.903 Test Loss: 0.727 Test Acc: 0.903
Validation loss decreased (-0.894586 --> -0.902695).  Saving model ...
Epoch: 13 cost time: 1.0731425285339355
Epoch: 13, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0795414447784424
Epoch: 14, Steps: 17 | Train Loss: 0.548 Vali Loss: 0.589 Vali Acc: 0.914 Test Loss: 0.589 Test Acc: 0.914
Validation loss decreased (-0.902695 --> -0.913508).  Saving model ...
Epoch: 15 cost time: 1.0138044357299805
Epoch: 15, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.531 Vali Acc: 0.924 Test Loss: 0.531 Test Acc: 0.924
Validation loss decreased (-0.913508 --> -0.924319).  Saving model ...
Epoch: 16 cost time: 0.8948900699615479
Epoch: 16, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.493 Vali Acc: 0.932 Test Loss: 0.493 Test Acc: 0.932
Validation loss decreased (-0.924319 --> -0.932428).  Saving model ...
Epoch: 17 cost time: 1.1047403812408447
Epoch: 17, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.441 Vali Acc: 0.935 Test Loss: 0.441 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 1.0090110301971436
Epoch: 18, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.416 Vali Acc: 0.938 Test Loss: 0.416 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 19 cost time: 0.8639700412750244
Epoch: 19, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.383 Vali Acc: 0.943 Test Loss: 0.383 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943239).  Saving model ...
Epoch: 20 cost time: 0.8421130180358887
Epoch: 20, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.353 Vali Acc: 0.949 Test Loss: 0.353 Test Acc: 0.949
Validation loss decreased (-0.943239 --> -0.948645).  Saving model ...
Epoch: 21 cost time: 0.9156899452209473
Epoch: 21, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.323 Vali Acc: 0.957 Test Loss: 0.323 Test Acc: 0.957
Validation loss decreased (-0.948645 --> -0.956754).  Saving model ...
Epoch: 22 cost time: 0.9408526420593262
Epoch: 22, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.302 Vali Acc: 0.957 Test Loss: 0.302 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 23 cost time: 0.9340715408325195
Epoch: 23, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.290 Vali Acc: 0.951 Test Loss: 0.290 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9554016590118408
Epoch: 24, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.270 Vali Acc: 0.957 Test Loss: 0.270 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 25 cost time: 0.7646768093109131
Epoch: 25, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.255 Vali Acc: 0.954 Test Loss: 0.255 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9525725841522217
Epoch: 26, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.251 Vali Acc: 0.954 Test Loss: 0.251 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0336759090423584
Epoch: 27, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 28 cost time: 1.1207165718078613
Epoch: 28, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.225 Vali Acc: 0.959 Test Loss: 0.225 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 29 cost time: 1.0732035636901855
Epoch: 29, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 30 cost time: 1.0394556522369385
Epoch: 30, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0771806240081787
Epoch: 31, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.201 Vali Acc: 0.959 Test Loss: 0.201 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.098083734512329
Epoch: 32, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 33 cost time: 1.1192755699157715
Epoch: 33, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.178 Vali Acc: 0.965 Test Loss: 0.178 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 34 cost time: 1.1021087169647217
Epoch: 34, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1512062549591064
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 36 cost time: 1.124192476272583
Epoch: 36, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 37 cost time: 0.8915040493011475
Epoch: 37, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 38 cost time: 1.1153264045715332
Epoch: 38, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.160 Vali Acc: 0.968 Test Loss: 0.160 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 39 cost time: 1.1030585765838623
Epoch: 39, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 40 cost time: 1.1600103378295898
Epoch: 40, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.229144811630249
Epoch: 41, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 42 cost time: 1.1536891460418701
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 43 cost time: 1.1330113410949707
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.136444091796875
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2053754329681396
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.170208215713501
Epoch: 46, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.21240234375
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.040473222732544
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0825855731964111
Epoch: 49, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0543394088745117
Epoch: 50, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 51 cost time: 1.119006633758545
Epoch: 51, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.1517233848571777
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0848028659820557
Epoch: 53, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.211496353149414
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.1418745517730713
Epoch: 55, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9728305339813232
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0851624011993408
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.972966194152832
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.0332982540130615
Epoch: 59, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.0421409606933594
Epoch: 60, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 143849
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.61261248588562
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.196 Vali Acc: 0.189 Test Loss: 2.196 Test Acc: 0.189
Validation loss decreased (inf --> -0.189167).  Saving model ...
Epoch: 2 cost time: 0.9454355239868164
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.085 Vali Acc: 0.259 Test Loss: 2.085 Test Acc: 0.259
Validation loss decreased (-0.189167 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 1.0996811389923096
Epoch: 3, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.945 Vali Acc: 0.370 Test Loss: 1.945 Test Acc: 0.370
Validation loss decreased (-0.259439 --> -0.370251).  Saving model ...
Epoch: 4 cost time: 1.0129234790802002
Epoch: 4, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.784 Vali Acc: 0.538 Test Loss: 1.784 Test Acc: 0.538
Validation loss decreased (-0.370251 --> -0.537820).  Saving model ...
Epoch: 5 cost time: 1.0761322975158691
Epoch: 5, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.622 Vali Acc: 0.700 Test Loss: 1.622 Test Acc: 0.700
Validation loss decreased (-0.537820 --> -0.699984).  Saving model ...
Epoch: 6 cost time: 1.201899766921997
Epoch: 6, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.465 Vali Acc: 0.784 Test Loss: 1.465 Test Acc: 0.784
Validation loss decreased (-0.699984 --> -0.783769).  Saving model ...
Epoch: 7 cost time: 1.2059593200683594
Epoch: 7, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.313 Vali Acc: 0.846 Test Loss: 1.313 Test Acc: 0.846
Validation loss decreased (-0.783769 --> -0.845933).  Saving model ...
Epoch: 8 cost time: 1.1104822158813477
Epoch: 8, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.171 Vali Acc: 0.857 Test Loss: 1.171 Test Acc: 0.857
Validation loss decreased (-0.845933 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 1.0517864227294922
Epoch: 9, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.040 Vali Acc: 0.859 Test Loss: 1.040 Test Acc: 0.859
Validation loss decreased (-0.856745 --> -0.859449).  Saving model ...
Epoch: 10 cost time: 0.9504826068878174
Epoch: 10, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.920 Vali Acc: 0.876 Test Loss: 0.920 Test Acc: 0.876
Validation loss decreased (-0.859449 --> -0.875666).  Saving model ...
Epoch: 11 cost time: 0.8689923286437988
Epoch: 11, Steps: 17 | Train Loss: 0.793 Vali Loss: 0.830 Vali Acc: 0.892 Test Loss: 0.830 Test Acc: 0.892
Validation loss decreased (-0.875666 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 1.0532283782958984
Epoch: 12, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.737 Vali Acc: 0.903 Test Loss: 0.737 Test Acc: 0.903
Validation loss decreased (-0.891884 --> -0.902695).  Saving model ...
Epoch: 13 cost time: 1.0492701530456543
Epoch: 13, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.665 Vali Acc: 0.905 Test Loss: 0.665 Test Acc: 0.905
Validation loss decreased (-0.902695 --> -0.905399).  Saving model ...
Epoch: 14 cost time: 1.030287504196167
Epoch: 14, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.601 Vali Acc: 0.916 Test Loss: 0.601 Test Acc: 0.916
Validation loss decreased (-0.905399 --> -0.916210).  Saving model ...
Epoch: 15 cost time: 1.0724678039550781
Epoch: 15, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.542 Vali Acc: 0.930 Test Loss: 0.542 Test Acc: 0.930
Validation loss decreased (-0.916210 --> -0.929724).  Saving model ...
Epoch: 16 cost time: 1.1337203979492188
Epoch: 16, Steps: 17 | Train Loss: 0.443 Vali Loss: 0.503 Vali Acc: 0.935 Test Loss: 0.503 Test Acc: 0.935
Validation loss decreased (-0.929724 --> -0.935130).  Saving model ...
Epoch: 17 cost time: 1.053400993347168
Epoch: 17, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.448 Vali Acc: 0.943 Test Loss: 0.448 Test Acc: 0.943
Validation loss decreased (-0.935130 --> -0.943239).  Saving model ...
Epoch: 18 cost time: 1.0797264575958252
Epoch: 18, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.423 Vali Acc: 0.938 Test Loss: 0.423 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9565823078155518
Epoch: 19, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.391 Vali Acc: 0.946 Test Loss: 0.391 Test Acc: 0.946
Validation loss decreased (-0.943239 --> -0.945942).  Saving model ...
Epoch: 20 cost time: 0.973433256149292
Epoch: 20, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.360 Vali Acc: 0.949 Test Loss: 0.360 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 21 cost time: 1.0060374736785889
Epoch: 21, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.329 Vali Acc: 0.954 Test Loss: 0.329 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 22 cost time: 0.8476452827453613
Epoch: 22, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.308 Vali Acc: 0.954 Test Loss: 0.308 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 23 cost time: 0.9740321636199951
Epoch: 23, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.294 Vali Acc: 0.951 Test Loss: 0.294 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.007755994796753
Epoch: 24, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 25 cost time: 1.0546083450317383
Epoch: 25, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.258 Vali Acc: 0.957 Test Loss: 0.258 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0474326610565186
Epoch: 26, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.255 Vali Acc: 0.951 Test Loss: 0.255 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.07741379737854
Epoch: 27, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.233 Vali Acc: 0.959 Test Loss: 0.233 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 28 cost time: 0.975677490234375
Epoch: 28, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 29 cost time: 1.1040964126586914
Epoch: 29, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.219 Vali Acc: 0.959 Test Loss: 0.219 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 30 cost time: 1.2397935390472412
Epoch: 30, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 31 cost time: 1.0684964656829834
Epoch: 31, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.155508041381836
Epoch: 32, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 1.1789684295654297
Epoch: 33, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 34 cost time: 1.231062889099121
Epoch: 34, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 35 cost time: 1.0661463737487793
Epoch: 35, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1982378959655762
Epoch: 36, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 37 cost time: 1.118896245956421
Epoch: 37, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9301028251647949
Epoch: 38, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9521539211273193
Epoch: 39, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.953352689743042
Epoch: 40, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0105578899383545
Epoch: 41, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 42 cost time: 0.9358546733856201
Epoch: 42, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 43 cost time: 1.1502296924591064
Epoch: 43, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.214144229888916
Epoch: 44, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.000288963317871
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 46 cost time: 1.208449125289917
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 1.2602436542510986
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1237242221832275
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1157042980194092
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2330842018127441
Epoch: 50, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.968 Test Loss: 0.118 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 51 cost time: 1.069338083267212
Epoch: 51, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9568753242492676
Epoch: 52, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0888357162475586
Epoch: 53, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0786972045898438
Epoch: 54, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 55 cost time: 1.1247282028198242
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.2792606353759766
Epoch: 56, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.962 Test Loss: 0.120 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1416022777557373
Epoch: 57, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.9866039752960205
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 59 cost time: 1.0111408233642578
Epoch: 59, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.049428939819336
Epoch: 60, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9800968170166016
Epoch: 61, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9555232524871826
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.9908485412597656
Epoch: 63, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0482521057128906
Epoch: 64, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.009636402130127
Epoch: 65, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9967138767242432
Epoch: 66, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.033236026763916
Epoch: 67, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.0787174701690674
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 69 cost time: 1.0099353790283203
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 70 cost time: 1.066075086593628
Epoch: 70, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9627530574798584
Epoch: 71, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.962 Test Loss: 0.099 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9680886268615723
Epoch: 72, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9775762557983398
Epoch: 73, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 74 cost time: 0.957575798034668
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.984769344329834
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.1316251754760742
Epoch: 76, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9876785278320312
Epoch: 77, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.091 Vali Acc: 0.968 Test Loss: 0.091 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.0638399124145508
Epoch: 78, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.965 Test Loss: 0.097 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.0427827835083008
Epoch: 79, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.962 Test Loss: 0.098 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.1477980613708496
Epoch: 80, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.0961074829101562
Epoch: 81, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.0486373901367188
Epoch: 82, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.962 Test Loss: 0.096 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.0944883823394775
Epoch: 83, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.968 Test Loss: 0.092 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 143849
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.970163345336914
Epoch: 1, Steps: 17 | Train Loss: 2.175 Vali Loss: 2.184 Vali Acc: 0.192 Test Loss: 2.184 Test Acc: 0.192
Validation loss decreased (inf --> -0.191870).  Saving model ...
Epoch: 2 cost time: 0.9607367515563965
Epoch: 2, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.079 Vali Acc: 0.246 Test Loss: 2.079 Test Acc: 0.246
Validation loss decreased (-0.191870 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 1.0053365230560303
Epoch: 3, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.946 Vali Acc: 0.362 Test Loss: 1.946 Test Acc: 0.362
Validation loss decreased (-0.245925 --> -0.362143).  Saving model ...
Epoch: 4 cost time: 0.9113948345184326
Epoch: 4, Steps: 17 | Train Loss: 1.816 Vali Loss: 1.793 Vali Acc: 0.549 Test Loss: 1.793 Test Acc: 0.549
Validation loss decreased (-0.362143 --> -0.548631).  Saving model ...
Epoch: 5 cost time: 0.9747872352600098
Epoch: 5, Steps: 17 | Train Loss: 1.672 Vali Loss: 1.638 Vali Acc: 0.673 Test Loss: 1.638 Test Acc: 0.673
Validation loss decreased (-0.548631 --> -0.672957).  Saving model ...
Epoch: 6 cost time: 1.0105962753295898
Epoch: 6, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.486 Vali Acc: 0.797 Test Loss: 1.486 Test Acc: 0.797
Validation loss decreased (-0.672957 --> -0.797282).  Saving model ...
Epoch: 7 cost time: 1.0394535064697266
Epoch: 7, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.337 Vali Acc: 0.835 Test Loss: 1.337 Test Acc: 0.835
Validation loss decreased (-0.797282 --> -0.835122).  Saving model ...
Epoch: 8 cost time: 1.122377872467041
Epoch: 8, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.199 Vali Acc: 0.857 Test Loss: 1.199 Test Acc: 0.857
Validation loss decreased (-0.835122 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 1.1249487400054932
Epoch: 9, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.073 Vali Acc: 0.857 Test Loss: 1.073 Test Acc: 0.857
Validation loss decreased (-0.856745 --> -0.856746).  Saving model ...
Epoch: 10 cost time: 0.8722450733184814
Epoch: 10, Steps: 17 | Train Loss: 0.927 Vali Loss: 0.957 Vali Acc: 0.873 Test Loss: 0.957 Test Acc: 0.873
Validation loss decreased (-0.856746 --> -0.872963).  Saving model ...
Epoch: 11 cost time: 0.8997714519500732
Epoch: 11, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.865 Vali Acc: 0.886 Test Loss: 0.865 Test Acc: 0.886
Validation loss decreased (-0.872963 --> -0.886478).  Saving model ...
Epoch: 12 cost time: 0.8341939449310303
Epoch: 12, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.771 Vali Acc: 0.895 Test Loss: 0.771 Test Acc: 0.895
Validation loss decreased (-0.886478 --> -0.894587).  Saving model ...
Epoch: 13 cost time: 0.8430919647216797
Epoch: 13, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.696 Vali Acc: 0.900 Test Loss: 0.696 Test Acc: 0.900
Validation loss decreased (-0.894587 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.9060828685760498
Epoch: 14, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.631 Vali Acc: 0.908 Test Loss: 0.631 Test Acc: 0.908
Validation loss decreased (-0.899993 --> -0.908102).  Saving model ...
Epoch: 15 cost time: 1.0851571559906006
Epoch: 15, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.573 Vali Acc: 0.919 Test Loss: 0.573 Test Acc: 0.919
Validation loss decreased (-0.908102 --> -0.918913).  Saving model ...
Epoch: 16 cost time: 1.0359938144683838
Epoch: 16, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.530 Vali Acc: 0.922 Test Loss: 0.530 Test Acc: 0.922
Validation loss decreased (-0.918913 --> -0.921616).  Saving model ...
Epoch: 17 cost time: 0.9960112571716309
Epoch: 17, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.474 Vali Acc: 0.924 Test Loss: 0.474 Test Acc: 0.924
Validation loss decreased (-0.921616 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 0.9685652256011963
Epoch: 18, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929725).  Saving model ...
Epoch: 19 cost time: 0.9169952869415283
Epoch: 19, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.410 Vali Acc: 0.938 Test Loss: 0.410 Test Acc: 0.938
Validation loss decreased (-0.929725 --> -0.937834).  Saving model ...
Epoch: 20 cost time: 0.9701180458068848
Epoch: 20, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.376 Vali Acc: 0.938 Test Loss: 0.376 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 21 cost time: 1.1706926822662354
Epoch: 21, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.346 Vali Acc: 0.949 Test Loss: 0.346 Test Acc: 0.949
Validation loss decreased (-0.937834 --> -0.948645).  Saving model ...
Epoch: 22 cost time: 1.1309010982513428
Epoch: 22, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.323 Vali Acc: 0.943 Test Loss: 0.323 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9963295459747314
Epoch: 23, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.018484354019165
Epoch: 24, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9553589820861816
Epoch: 25, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.271 Vali Acc: 0.957 Test Loss: 0.271 Test Acc: 0.957
Validation loss decreased (-0.948645 --> -0.956754).  Saving model ...
Epoch: 26 cost time: 1.0230388641357422
Epoch: 26, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1557624340057373
Epoch: 27, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.243 Vali Acc: 0.954 Test Loss: 0.243 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1140708923339844
Epoch: 28, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.234 Vali Acc: 0.957 Test Loss: 0.234 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956754).  Saving model ...
Epoch: 29 cost time: 1.1302354335784912
Epoch: 29, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 1.1993303298950195
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.218 Vali Acc: 0.959 Test Loss: 0.218 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 31 cost time: 1.1291139125823975
Epoch: 31, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.211 Vali Acc: 0.959 Test Loss: 0.211 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 32 cost time: 1.153141736984253
Epoch: 32, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 33 cost time: 1.0909204483032227
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.188 Vali Acc: 0.959 Test Loss: 0.188 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0949201583862305
Epoch: 34, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0874760150909424
Epoch: 35, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0891268253326416
Epoch: 36, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.178 Vali Acc: 0.959 Test Loss: 0.178 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.127485990524292
Epoch: 37, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1170823574066162
Epoch: 38, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.015502691268921
Epoch: 39, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0254814624786377
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9861905574798584
Epoch: 41, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9560744762420654
Epoch: 42, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 143849
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7436344623565674
Epoch: 1, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.182 Vali Acc: 0.162 Test Loss: 2.182 Test Acc: 0.162
Validation loss decreased (inf --> -0.162140).  Saving model ...
Epoch: 2 cost time: 1.005514144897461
Epoch: 2, Steps: 17 | Train Loss: 2.111 Vali Loss: 2.091 Vali Acc: 0.230 Test Loss: 2.091 Test Acc: 0.230
Validation loss decreased (-0.162140 --> -0.229709).  Saving model ...
Epoch: 3 cost time: 1.031585454940796
Epoch: 3, Steps: 17 | Train Loss: 1.990 Vali Loss: 1.976 Vali Acc: 0.322 Test Loss: 1.976 Test Acc: 0.322
Validation loss decreased (-0.229709 --> -0.321602).  Saving model ...
Epoch: 4 cost time: 0.9835240840911865
Epoch: 4, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.845 Vali Acc: 0.511 Test Loss: 1.845 Test Acc: 0.511
Validation loss decreased (-0.321602 --> -0.510792).  Saving model ...
Epoch: 5 cost time: 1.0670185089111328
Epoch: 5, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.709 Vali Acc: 0.662 Test Loss: 1.709 Test Acc: 0.662
Validation loss decreased (-0.510792 --> -0.662145).  Saving model ...
Epoch: 6 cost time: 1.0675749778747559
Epoch: 6, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.571 Vali Acc: 0.762 Test Loss: 1.571 Test Acc: 0.762
Validation loss decreased (-0.662145 --> -0.762146).  Saving model ...
Epoch: 7 cost time: 1.0866703987121582
Epoch: 7, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.432 Vali Acc: 0.811 Test Loss: 1.432 Test Acc: 0.811
Validation loss decreased (-0.762146 --> -0.810796).  Saving model ...
Epoch: 8 cost time: 1.005077838897705
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.299 Vali Acc: 0.857 Test Loss: 1.299 Test Acc: 0.857
Validation loss decreased (-0.810796 --> -0.856744).  Saving model ...
Epoch: 9 cost time: 1.0018951892852783
Epoch: 9, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.173 Vali Acc: 0.865 Test Loss: 1.173 Test Acc: 0.865
Validation loss decreased (-0.856744 --> -0.864853).  Saving model ...
Epoch: 10 cost time: 0.9107956886291504
Epoch: 10, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.052 Vali Acc: 0.878 Test Loss: 1.052 Test Acc: 0.878
Validation loss decreased (-0.864853 --> -0.878368).  Saving model ...
Epoch: 11 cost time: 0.9128990173339844
Epoch: 11, Steps: 17 | Train Loss: 0.920 Vali Loss: 0.954 Vali Acc: 0.878 Test Loss: 0.954 Test Acc: 0.878
Validation loss decreased (-0.878368 --> -0.878369).  Saving model ...
Epoch: 12 cost time: 0.8338541984558105
Epoch: 12, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.854 Vali Acc: 0.884 Test Loss: 0.854 Test Acc: 0.884
Validation loss decreased (-0.878369 --> -0.883775).  Saving model ...
Epoch: 13 cost time: 0.905686616897583
Epoch: 13, Steps: 17 | Train Loss: 0.713 Vali Loss: 0.772 Vali Acc: 0.892 Test Loss: 0.772 Test Acc: 0.892
Validation loss decreased (-0.883775 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 1.0568113327026367
Epoch: 14, Steps: 17 | Train Loss: 0.640 Vali Loss: 0.694 Vali Acc: 0.895 Test Loss: 0.694 Test Acc: 0.895
Validation loss decreased (-0.891884 --> -0.894588).  Saving model ...
Epoch: 15 cost time: 1.0759897232055664
Epoch: 15, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.626 Vali Acc: 0.905 Test Loss: 0.626 Test Acc: 0.905
Validation loss decreased (-0.894588 --> -0.905399).  Saving model ...
Epoch: 16 cost time: 1.0318832397460938
Epoch: 16, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.577 Vali Acc: 0.905 Test Loss: 0.577 Test Acc: 0.905
Validation loss decreased (-0.905399 --> -0.905400).  Saving model ...
Epoch: 17 cost time: 1.140021562576294
Epoch: 17, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.520 Vali Acc: 0.911 Test Loss: 0.520 Test Acc: 0.911
Validation loss decreased (-0.905400 --> -0.910806).  Saving model ...
Epoch: 18 cost time: 1.037923812866211
Epoch: 18, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.485 Vali Acc: 0.916 Test Loss: 0.485 Test Acc: 0.916
Validation loss decreased (-0.910806 --> -0.916211).  Saving model ...
Epoch: 19 cost time: 0.9908099174499512
Epoch: 19, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.446 Vali Acc: 0.919 Test Loss: 0.446 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 20 cost time: 0.9553298950195312
Epoch: 20, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.414 Vali Acc: 0.924 Test Loss: 0.414 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 21 cost time: 1.0376431941986084
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.381 Vali Acc: 0.927 Test Loss: 0.381 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 22 cost time: 1.0751805305480957
Epoch: 22, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 23 cost time: 1.1775493621826172
Epoch: 23, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.338 Vali Acc: 0.935 Test Loss: 0.338 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 24 cost time: 1.0038700103759766
Epoch: 24, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.316 Vali Acc: 0.949 Test Loss: 0.316 Test Acc: 0.949
Validation loss decreased (-0.935132 --> -0.948645).  Saving model ...
Epoch: 25 cost time: 1.0950169563293457
Epoch: 25, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.097175121307373
Epoch: 26, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0885801315307617
Epoch: 27, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.274 Vali Acc: 0.951 Test Loss: 0.274 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 1.206383466720581
Epoch: 28, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.260 Vali Acc: 0.951 Test Loss: 0.260 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 29 cost time: 1.1149568557739258
Epoch: 29, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.250 Vali Acc: 0.943 Test Loss: 0.250 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0426132678985596
Epoch: 30, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1458029747009277
Epoch: 31, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.237 Vali Acc: 0.943 Test Loss: 0.237 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1008636951446533
Epoch: 32, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1555635929107666
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.0585191249847412
Epoch: 34, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.203 Vali Acc: 0.954 Test Loss: 0.203 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 35 cost time: 0.9627575874328613
Epoch: 35, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 36 cost time: 0.9909179210662842
Epoch: 36, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.199 Vali Acc: 0.951 Test Loss: 0.199 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0732409954071045
Epoch: 37, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.188 Vali Acc: 0.954 Test Loss: 0.188 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 0.9253368377685547
Epoch: 38, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 0.9968152046203613
Epoch: 39, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9563171863555908
Epoch: 40, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1015973091125488
Epoch: 41, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 42 cost time: 1.0371313095092773
Epoch: 42, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 43 cost time: 1.0761528015136719
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.162 Vali Acc: 0.954 Test Loss: 0.162 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.19285249710083
Epoch: 44, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.191434621810913
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0528197288513184
Epoch: 46, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.035423755645752
Epoch: 47, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.954 Test Loss: 0.150 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1488687992095947
Epoch: 48, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 49 cost time: 0.8615071773529053
Epoch: 49, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.954 Test Loss: 0.142 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.044100046157837
Epoch: 50, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 51 cost time: 1.0554933547973633
Epoch: 51, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.0068044662475586
Epoch: 52, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.957 Test Loss: 0.141 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1891822814941406
Epoch: 53, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0668089389801025
Epoch: 54, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 55 cost time: 1.1683533191680908
Epoch: 55, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 56 cost time: 1.0392277240753174
Epoch: 56, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1096830368041992
Epoch: 57, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8883061408996582
Epoch: 58, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0260179042816162
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.100898265838623
Epoch: 60, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8823990821838379
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.9926080703735352
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.049637794494629
Epoch: 63, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.0075576305389404
Epoch: 64, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.1611604690551758
Epoch: 65, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 66 cost time: 1.0493662357330322
Epoch: 66, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.1276187896728516
Epoch: 67, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 68 cost time: 0.9202048778533936
Epoch: 68, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9255259037017822
Epoch: 69, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.976637601852417
Epoch: 70, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.9613504409790039
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.959 Test Loss: 0.112 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9051318168640137
Epoch: 72, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.9425222873687744
Epoch: 73, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.9488785266876221
Epoch: 74, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.167771816253662
Epoch: 75, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.0299689769744873
Epoch: 76, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 77 cost time: 1.0703730583190918
Epoch: 77, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 78 cost time: 1.092951774597168
Epoch: 78, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 79 cost time: 1.0074832439422607
Epoch: 79, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 1.053877592086792
Epoch: 80, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 1.140688180923462
Epoch: 81, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9685516357421875
Epoch: 82, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 1.0849273204803467
Epoch: 83, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.9267528057098389
Epoch: 84, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.106985330581665
Epoch: 85, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 1.0580384731292725
Epoch: 86, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.9108071327209473
Epoch: 87, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 1.1369969844818115
Epoch: 88, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 143849
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.694753885269165
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.154 Vali Acc: 0.168 Test Loss: 2.154 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 0.9062016010284424
Epoch: 2, Steps: 17 | Train Loss: 2.134 Vali Loss: 2.046 Vali Acc: 0.270 Test Loss: 2.046 Test Acc: 0.270
Validation loss decreased (-0.167546 --> -0.270250).  Saving model ...
Epoch: 3 cost time: 0.8494937419891357
Epoch: 3, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.907 Vali Acc: 0.451 Test Loss: 1.907 Test Acc: 0.451
Validation loss decreased (-0.270250 --> -0.451332).  Saving model ...
Epoch: 4 cost time: 0.8553211688995361
Epoch: 4, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.757 Vali Acc: 0.627 Test Loss: 1.757 Test Acc: 0.627
Validation loss decreased (-0.451332 --> -0.627009).  Saving model ...
Epoch: 5 cost time: 0.9071619510650635
Epoch: 5, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.597 Vali Acc: 0.732 Test Loss: 1.597 Test Acc: 0.732
Validation loss decreased (-0.627009 --> -0.732416).  Saving model ...
Epoch: 6 cost time: 1.1548666954040527
Epoch: 6, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.435 Vali Acc: 0.795 Test Loss: 1.435 Test Acc: 0.795
Validation loss decreased (-0.732416 --> -0.794580).  Saving model ...
Epoch: 7 cost time: 0.9448916912078857
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.287 Vali Acc: 0.832 Test Loss: 1.287 Test Acc: 0.832
Validation loss decreased (-0.794580 --> -0.832420).  Saving model ...
Epoch: 8 cost time: 1.038867473602295
Epoch: 8, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.138 Vali Acc: 0.843 Test Loss: 1.138 Test Acc: 0.843
Validation loss decreased (-0.832420 --> -0.843232).  Saving model ...
Epoch: 9 cost time: 1.1583924293518066
Epoch: 9, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.002 Vali Acc: 0.878 Test Loss: 1.002 Test Acc: 0.878
Validation loss decreased (-0.843232 --> -0.878368).  Saving model ...
Epoch: 10 cost time: 1.0937881469726562
Epoch: 10, Steps: 17 | Train Loss: 0.868 Vali Loss: 0.885 Vali Acc: 0.886 Test Loss: 0.885 Test Acc: 0.886
Validation loss decreased (-0.878368 --> -0.886478).  Saving model ...
Epoch: 11 cost time: 1.1404645442962646
Epoch: 11, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.801 Vali Acc: 0.892 Test Loss: 0.801 Test Acc: 0.892
Validation loss decreased (-0.886478 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 0.9819455146789551
Epoch: 12, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.709 Vali Acc: 0.900 Test Loss: 0.709 Test Acc: 0.900
Validation loss decreased (-0.891884 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.0898725986480713
Epoch: 13, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.631 Vali Acc: 0.911 Test Loss: 0.631 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.910804).  Saving model ...
Epoch: 14 cost time: 0.9719045162200928
Epoch: 14, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.568 Vali Acc: 0.922 Test Loss: 0.568 Test Acc: 0.922
Validation loss decreased (-0.910804 --> -0.921616).  Saving model ...
Epoch: 15 cost time: 1.0741937160491943
Epoch: 15, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.521 Vali Acc: 0.930 Test Loss: 0.521 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 16 cost time: 1.0847134590148926
Epoch: 16, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.476 Vali Acc: 0.938 Test Loss: 0.476 Test Acc: 0.938
Validation loss decreased (-0.929725 --> -0.937833).  Saving model ...
Epoch: 17 cost time: 1.0195872783660889
Epoch: 17, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.434 Vali Acc: 0.941 Test Loss: 0.434 Test Acc: 0.941
Validation loss decreased (-0.937833 --> -0.940536).  Saving model ...
Epoch: 18 cost time: 1.0434887409210205
Epoch: 18, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.940536 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 0.940432071685791
Epoch: 19, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.374 Vali Acc: 0.941 Test Loss: 0.374 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940537).  Saving model ...
Epoch: 20 cost time: 0.9600841999053955
Epoch: 20, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.344 Vali Acc: 0.943 Test Loss: 0.344 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 0.9343781471252441
Epoch: 21, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.322 Vali Acc: 0.946 Test Loss: 0.322 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 1.014420747756958
Epoch: 22, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.301 Vali Acc: 0.943 Test Loss: 0.301 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9449799060821533
Epoch: 23, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.288 Vali Acc: 0.943 Test Loss: 0.288 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1504900455474854
Epoch: 24, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.273 Vali Acc: 0.949 Test Loss: 0.273 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 25 cost time: 1.1315557956695557
Epoch: 25, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.255 Vali Acc: 0.949 Test Loss: 0.255 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 1.0520286560058594
Epoch: 26, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.242 Vali Acc: 0.951 Test Loss: 0.242 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 27 cost time: 0.9306819438934326
Epoch: 27, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.234 Vali Acc: 0.951 Test Loss: 0.234 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 0.9821200370788574
Epoch: 28, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 0.9618880748748779
Epoch: 29, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9574956893920898
Epoch: 30, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9782981872558594
Epoch: 31, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9146525859832764
Epoch: 32, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0326769351959229
Epoch: 33, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 0.9179165363311768
Epoch: 34, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 0.8975369930267334
Epoch: 35, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 0.9326930046081543
Epoch: 36, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9003205299377441
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9716665744781494
Epoch: 38, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 0.9837856292724609
Epoch: 39, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 0.9909751415252686
Epoch: 40, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 0.9738101959228516
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 42 cost time: 0.9671487808227539
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0915780067443848
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9747107028961182
Epoch: 44, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0854806900024414
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 1.0785408020019531
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 47 cost time: 0.9445836544036865
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1461601257324219
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 49 cost time: 0.9607522487640381
Epoch: 49, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 50 cost time: 0.8646306991577148
Epoch: 50, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9879710674285889
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9287614822387695
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 53 cost time: 1.0269973278045654
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.127089262008667
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.024791955947876
Epoch: 55, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.934666633605957
Epoch: 56, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 57 cost time: 1.1234707832336426
Epoch: 57, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 58 cost time: 1.1064975261688232
Epoch: 58, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 59 cost time: 0.9932751655578613
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9501147270202637
Epoch: 60, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.0644333362579346
Epoch: 61, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0135176181793213
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 63 cost time: 1.1592323780059814
Epoch: 63, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1101160049438477
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 65 cost time: 0.9053733348846436
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.060502290725708
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 67 cost time: 1.1384351253509521
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0813102722167969
Epoch: 68, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0552594661712646
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 70 cost time: 0.8960528373718262
Epoch: 70, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 71 cost time: 1.0220389366149902
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 72 cost time: 1.117750644683838
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0573115348815918
Epoch: 73, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 1.023833990097046
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9664716720581055
Epoch: 75, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 1.0013515949249268
Epoch: 76, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.9483792781829834
Epoch: 77, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.962 Test Loss: 0.103 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 1.0163962841033936
Epoch: 78, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.9652278423309326
Epoch: 79, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 1.1398913860321045
Epoch: 80, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.9591214656829834
Epoch: 81, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 78313
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7524852752685547
Epoch: 1, Steps: 17 | Train Loss: 2.240 Vali Loss: 2.149 Vali Acc: 0.165 Test Loss: 2.149 Test Acc: 0.165
Validation loss decreased (inf --> -0.164843).  Saving model ...
Epoch: 2 cost time: 1.047769546508789
Epoch: 2, Steps: 17 | Train Loss: 2.132 Vali Loss: 2.043 Vali Acc: 0.259 Test Loss: 2.043 Test Acc: 0.259
Validation loss decreased (-0.164843 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 0.9209051132202148
Epoch: 3, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.905 Vali Acc: 0.449 Test Loss: 1.905 Test Acc: 0.449
Validation loss decreased (-0.259439 --> -0.448630).  Saving model ...
Epoch: 4 cost time: 1.0176305770874023
Epoch: 4, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.756 Vali Acc: 0.651 Test Loss: 1.756 Test Acc: 0.651
Validation loss decreased (-0.448630 --> -0.651334).  Saving model ...
Epoch: 5 cost time: 1.1608574390411377
Epoch: 5, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.597 Vali Acc: 0.751 Test Loss: 1.597 Test Acc: 0.751
Validation loss decreased (-0.651334 --> -0.751335).  Saving model ...
Epoch: 6 cost time: 0.9711775779724121
Epoch: 6, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.436 Vali Acc: 0.808 Test Loss: 1.436 Test Acc: 0.808
Validation loss decreased (-0.751335 --> -0.808094).  Saving model ...
Epoch: 7 cost time: 1.0800564289093018
Epoch: 7, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.290 Vali Acc: 0.822 Test Loss: 1.290 Test Acc: 0.822
Validation loss decreased (-0.808094 --> -0.821609).  Saving model ...
Epoch: 8 cost time: 0.9233565330505371
Epoch: 8, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.143 Vali Acc: 0.857 Test Loss: 1.143 Test Acc: 0.857
Validation loss decreased (-0.821609 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 1.0524094104766846
Epoch: 9, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.008 Vali Acc: 0.878 Test Loss: 1.008 Test Acc: 0.878
Validation loss decreased (-0.856745 --> -0.878368).  Saving model ...
Epoch: 10 cost time: 1.0641803741455078
Epoch: 10, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.893 Vali Acc: 0.895 Test Loss: 0.893 Test Acc: 0.895
Validation loss decreased (-0.878368 --> -0.894586).  Saving model ...
Epoch: 11 cost time: 1.1276297569274902
Epoch: 11, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.809 Vali Acc: 0.895 Test Loss: 0.809 Test Acc: 0.895
Validation loss decreased (-0.894586 --> -0.894587).  Saving model ...
Epoch: 12 cost time: 1.044924259185791
Epoch: 12, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.894587 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.1027672290802002
Epoch: 13, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.639 Vali Acc: 0.897 Test Loss: 0.639 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0170211791992188
Epoch: 14, Steps: 17 | Train Loss: 0.559 Vali Loss: 0.575 Vali Acc: 0.916 Test Loss: 0.575 Test Acc: 0.916
Validation loss decreased (-0.899993 --> -0.916210).  Saving model ...
Epoch: 15 cost time: 1.1213443279266357
Epoch: 15, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.528 Vali Acc: 0.930 Test Loss: 0.528 Test Acc: 0.930
Validation loss decreased (-0.916210 --> -0.929724).  Saving model ...
Epoch: 16 cost time: 0.9509227275848389
Epoch: 16, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.929724 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 0.8707656860351562
Epoch: 17, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.440 Vali Acc: 0.938 Test Loss: 0.440 Test Acc: 0.938
Validation loss decreased (-0.929725 --> -0.937833).  Saving model ...
Epoch: 18 cost time: 0.9629485607147217
Epoch: 18, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.401 Vali Acc: 0.938 Test Loss: 0.401 Test Acc: 0.938
Validation loss decreased (-0.937833 --> -0.937834).  Saving model ...
Epoch: 19 cost time: 0.9551458358764648
Epoch: 19, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.378 Vali Acc: 0.935 Test Loss: 0.378 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0270979404449463
Epoch: 20, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 21 cost time: 1.118943214416504
Epoch: 21, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.326 Vali Acc: 0.943 Test Loss: 0.326 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 22 cost time: 1.0919606685638428
Epoch: 22, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.305 Vali Acc: 0.941 Test Loss: 0.305 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.100407361984253
Epoch: 23, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.290 Vali Acc: 0.943 Test Loss: 0.290 Test Acc: 0.943
Validation loss decreased (-0.943240 --> -0.943240).  Saving model ...
Epoch: 24 cost time: 1.0543713569641113
Epoch: 24, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.275 Vali Acc: 0.946 Test Loss: 0.275 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 25 cost time: 1.0809011459350586
Epoch: 25, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 26 cost time: 1.0098328590393066
Epoch: 26, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 1.0264208316802979
Epoch: 27, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 1.0829999446868896
Epoch: 28, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 29 cost time: 1.1096785068511963
Epoch: 29, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 30 cost time: 1.015178918838501
Epoch: 30, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 31 cost time: 1.0358457565307617
Epoch: 31, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 32 cost time: 0.9743514060974121
Epoch: 32, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.195 Vali Acc: 0.949 Test Loss: 0.195 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.108492136001587
Epoch: 33, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.187 Vali Acc: 0.954 Test Loss: 0.187 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.115312099456787
Epoch: 34, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 0.9229621887207031
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.0388548374176025
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9001891613006592
Epoch: 37, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9609627723693848
Epoch: 38, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9355826377868652
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 0.9981281757354736
Epoch: 40, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0355992317199707
Epoch: 41, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 1.108656644821167
Epoch: 42, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.973865270614624
Epoch: 43, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0512049198150635
Epoch: 44, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.000891923904419
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 0.9384951591491699
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 47 cost time: 0.9739170074462891
Epoch: 47, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0120470523834229
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 0.9599204063415527
Epoch: 49, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 50 cost time: 1.1765415668487549
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 51 cost time: 1.0200486183166504
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 52 cost time: 1.0405781269073486
Epoch: 52, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.0640110969543457
Epoch: 53, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9847166538238525
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9016923904418945
Epoch: 55, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9328563213348389
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.0630416870117188
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.8691935539245605
Epoch: 58, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0432124137878418
Epoch: 59, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.8427162170410156
Epoch: 60, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 61 cost time: 1.0938122272491455
Epoch: 61, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.967566 --> -0.972972).  Saving model ...
Epoch: 62 cost time: 0.930821418762207
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0301868915557861
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9892227649688721
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.9377317428588867
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9199235439300537
Epoch: 66, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8580930233001709
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.8546547889709473
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.959 Test Loss: 0.103 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.9018781185150146
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.8503706455230713
Epoch: 70, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.9372937679290771
Epoch: 71, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 78313
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.713186025619507
Epoch: 1, Steps: 17 | Train Loss: 2.243 Vali Loss: 2.145 Vali Acc: 0.162 Test Loss: 2.145 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 0.9650554656982422
Epoch: 2, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.043 Vali Acc: 0.262 Test Loss: 2.043 Test Acc: 0.262
Validation loss decreased (-0.162141 --> -0.262142).  Saving model ...
Epoch: 3 cost time: 1.0324397087097168
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.912 Vali Acc: 0.481 Test Loss: 1.912 Test Acc: 0.481
Validation loss decreased (-0.262142 --> -0.481062).  Saving model ...
Epoch: 4 cost time: 0.9714343547821045
Epoch: 4, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.770 Vali Acc: 0.665 Test Loss: 1.770 Test Acc: 0.665
Validation loss decreased (-0.481062 --> -0.664847).  Saving model ...
Epoch: 5 cost time: 1.0989317893981934
Epoch: 5, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.617 Vali Acc: 0.781 Test Loss: 1.617 Test Acc: 0.781
Validation loss decreased (-0.664847 --> -0.781065).  Saving model ...
Epoch: 6 cost time: 1.081364631652832
Epoch: 6, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.463 Vali Acc: 0.811 Test Loss: 1.463 Test Acc: 0.811
Validation loss decreased (-0.781065 --> -0.810796).  Saving model ...
Epoch: 7 cost time: 1.0062644481658936
Epoch: 7, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.321 Vali Acc: 0.824 Test Loss: 1.321 Test Acc: 0.824
Validation loss decreased (-0.810796 --> -0.824311).  Saving model ...
Epoch: 8 cost time: 0.9767024517059326
Epoch: 8, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.176 Vali Acc: 0.843 Test Loss: 1.176 Test Acc: 0.843
Validation loss decreased (-0.824311 --> -0.843231).  Saving model ...
Epoch: 9 cost time: 0.9614543914794922
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.042 Vali Acc: 0.876 Test Loss: 1.042 Test Acc: 0.876
Validation loss decreased (-0.843231 --> -0.875665).  Saving model ...
Epoch: 10 cost time: 0.9626622200012207
Epoch: 10, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.926 Vali Acc: 0.889 Test Loss: 0.926 Test Acc: 0.889
Validation loss decreased (-0.875665 --> -0.889180).  Saving model ...
Epoch: 11 cost time: 1.0744950771331787
Epoch: 11, Steps: 17 | Train Loss: 0.828 Vali Loss: 0.838 Vali Acc: 0.892 Test Loss: 0.838 Test Acc: 0.892
Validation loss decreased (-0.889180 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 1.034738540649414
Epoch: 12, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.747 Vali Acc: 0.889 Test Loss: 0.747 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.962587833404541
Epoch: 13, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.667 Vali Acc: 0.908 Test Loss: 0.667 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908101).  Saving model ...
Epoch: 14 cost time: 1.085737705230713
Epoch: 14, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.601 Vali Acc: 0.916 Test Loss: 0.601 Test Acc: 0.916
Validation loss decreased (-0.908101 --> -0.916210).  Saving model ...
Epoch: 15 cost time: 1.0153040885925293
Epoch: 15, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.551 Vali Acc: 0.924 Test Loss: 0.551 Test Acc: 0.924
Validation loss decreased (-0.916210 --> -0.924319).  Saving model ...
Epoch: 16 cost time: 0.9394927024841309
Epoch: 16, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.503 Vali Acc: 0.927 Test Loss: 0.503 Test Acc: 0.927
Validation loss decreased (-0.924319 --> -0.927022).  Saving model ...
Epoch: 17 cost time: 0.9101617336273193
Epoch: 17, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.455 Vali Acc: 0.935 Test Loss: 0.455 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 0.9972622394561768
Epoch: 18, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.416 Vali Acc: 0.930 Test Loss: 0.416 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9918928146362305
Epoch: 19, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.391 Vali Acc: 0.935 Test Loss: 0.391 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 20 cost time: 0.8697969913482666
Epoch: 20, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.358 Vali Acc: 0.935 Test Loss: 0.358 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 21 cost time: 0.8317544460296631
Epoch: 21, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.337 Vali Acc: 0.935 Test Loss: 0.337 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 0.9079477787017822
Epoch: 22, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 23 cost time: 0.908684253692627
Epoch: 23, Steps: 17 | Train Loss: 0.240 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 0.9703121185302734
Epoch: 24, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 25 cost time: 1.0797853469848633
Epoch: 25, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 26 cost time: 1.0576674938201904
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 27 cost time: 0.9455268383026123
Epoch: 27, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 28 cost time: 1.0747711658477783
Epoch: 28, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 29 cost time: 0.9671363830566406
Epoch: 29, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0245919227600098
Epoch: 30, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 31 cost time: 1.0530412197113037
Epoch: 31, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.951349 --> -0.959457).  Saving model ...
Epoch: 32 cost time: 1.0050370693206787
Epoch: 32, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0666775703430176
Epoch: 33, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9333059787750244
Epoch: 34, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 35 cost time: 1.0649149417877197
Epoch: 35, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9956960678100586
Epoch: 36, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0597319602966309
Epoch: 37, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.09641432762146
Epoch: 38, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 39 cost time: 1.0410823822021484
Epoch: 39, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9425811767578125
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0696260929107666
Epoch: 41, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 0.9809932708740234
Epoch: 42, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0641264915466309
Epoch: 43, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.150 Vali Acc: 0.951 Test Loss: 0.150 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8904983997344971
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1087286472320557
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9398508071899414
Epoch: 46, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0447924137115479
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9801425933837891
Epoch: 48, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 49 cost time: 0.96875
Epoch: 49, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 50 cost time: 0.93080735206604
Epoch: 50, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 51 cost time: 0.8886821269989014
Epoch: 51, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 52 cost time: 0.8828017711639404
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9567160606384277
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.9542827606201172
Epoch: 54, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.086207628250122
Epoch: 55, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9362168312072754
Epoch: 56, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1132733821868896
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 58 cost time: 1.0671210289001465
Epoch: 58, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0009679794311523
Epoch: 59, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.959 Test Loss: 0.122 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0375776290893555
Epoch: 60, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 61 cost time: 1.0060768127441406
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0162954330444336
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.954 Test Loss: 0.119 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.033029556274414
Epoch: 63, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.954 Test Loss: 0.120 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9402830600738525
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.113 Vali Acc: 0.959 Test Loss: 0.113 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.0746495723724365
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.959 Test Loss: 0.115 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9013817310333252
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 67 cost time: 1.064760446548462
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0308961868286133
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0239872932434082
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 70 cost time: 0.912236213684082
Epoch: 70, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967567).  Saving model ...
Epoch: 71 cost time: 0.9000058174133301
Epoch: 71, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 72 cost time: 0.9420676231384277
Epoch: 72, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 73 cost time: 0.9556591510772705
Epoch: 73, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9502758979797363
Epoch: 74, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9522709846496582
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9470479488372803
Epoch: 76, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.9660205841064453
Epoch: 77, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.9923505783081055
Epoch: 78, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.0247745513916016
Epoch: 79, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.0279288291931152
Epoch: 80, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.9342508316040039
Epoch: 81, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.9584150314331055
Epoch: 82, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 78313
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.84656023979187
Epoch: 1, Steps: 17 | Train Loss: 2.242 Vali Loss: 2.165 Vali Acc: 0.162 Test Loss: 2.165 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 1.0233314037322998
Epoch: 2, Steps: 17 | Train Loss: 2.159 Vali Loss: 2.077 Vali Acc: 0.246 Test Loss: 2.077 Test Acc: 0.246
Validation loss decreased (-0.162141 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 1.0345642566680908
Epoch: 3, Steps: 17 | Train Loss: 2.056 Vali Loss: 1.964 Vali Acc: 0.403 Test Loss: 1.964 Test Acc: 0.403
Validation loss decreased (-0.245925 --> -0.402683).  Saving model ...
Epoch: 4 cost time: 1.0685718059539795
Epoch: 4, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.841 Vali Acc: 0.635 Test Loss: 1.841 Test Acc: 0.635
Validation loss decreased (-0.402683 --> -0.635117).  Saving model ...
Epoch: 5 cost time: 0.9691932201385498
Epoch: 5, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.706 Vali Acc: 0.757 Test Loss: 1.706 Test Acc: 0.757
Validation loss decreased (-0.635117 --> -0.756740).  Saving model ...
Epoch: 6 cost time: 0.9843549728393555
Epoch: 6, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.566 Vali Acc: 0.800 Test Loss: 1.566 Test Acc: 0.800
Validation loss decreased (-0.756740 --> -0.799984).  Saving model ...
Epoch: 7 cost time: 0.8819940090179443
Epoch: 7, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.432 Vali Acc: 0.824 Test Loss: 1.432 Test Acc: 0.824
Validation loss decreased (-0.799984 --> -0.824310).  Saving model ...
Epoch: 8 cost time: 1.1811630725860596
Epoch: 8, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.292 Vali Acc: 0.846 Test Loss: 1.292 Test Acc: 0.846
Validation loss decreased (-0.824310 --> -0.845933).  Saving model ...
Epoch: 9 cost time: 0.9198031425476074
Epoch: 9, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.159 Vali Acc: 0.865 Test Loss: 1.159 Test Acc: 0.865
Validation loss decreased (-0.845933 --> -0.864853).  Saving model ...
Epoch: 10 cost time: 1.0468974113464355
Epoch: 10, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.038 Vali Acc: 0.878 Test Loss: 1.038 Test Acc: 0.878
Validation loss decreased (-0.864853 --> -0.878368).  Saving model ...
Epoch: 11 cost time: 0.9565138816833496
Epoch: 11, Steps: 17 | Train Loss: 0.926 Vali Loss: 0.938 Vali Acc: 0.878 Test Loss: 0.938 Test Acc: 0.878
Validation loss decreased (-0.878368 --> -0.878369).  Saving model ...
Epoch: 12 cost time: 0.9997613430023193
Epoch: 12, Steps: 17 | Train Loss: 0.808 Vali Loss: 0.838 Vali Acc: 0.881 Test Loss: 0.838 Test Acc: 0.881
Validation loss decreased (-0.878369 --> -0.881073).  Saving model ...
Epoch: 13 cost time: 0.9813666343688965
Epoch: 13, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.749 Vali Acc: 0.895 Test Loss: 0.749 Test Acc: 0.895
Validation loss decreased (-0.881073 --> -0.894587).  Saving model ...
Epoch: 14 cost time: 0.9244019985198975
Epoch: 14, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.676 Vali Acc: 0.905 Test Loss: 0.676 Test Acc: 0.905
Validation loss decreased (-0.894587 --> -0.905399).  Saving model ...
Epoch: 15 cost time: 0.9086239337921143
Epoch: 15, Steps: 17 | Train Loss: 0.575 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0199503898620605
Epoch: 16, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.561 Vali Acc: 0.911 Test Loss: 0.561 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910805).  Saving model ...
Epoch: 17 cost time: 0.9857597351074219
Epoch: 17, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.510 Vali Acc: 0.914 Test Loss: 0.510 Test Acc: 0.914
Validation loss decreased (-0.910805 --> -0.913508).  Saving model ...
Epoch: 18 cost time: 0.9511091709136963
Epoch: 18, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.463 Vali Acc: 0.922 Test Loss: 0.463 Test Acc: 0.922
Validation loss decreased (-0.913508 --> -0.921617).  Saving model ...
Epoch: 19 cost time: 0.9211716651916504
Epoch: 19, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921617).  Saving model ...
Epoch: 20 cost time: 0.948737621307373
Epoch: 20, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.401 Vali Acc: 0.932 Test Loss: 0.401 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932428).  Saving model ...
Epoch: 21 cost time: 0.9163432121276855
Epoch: 21, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0951814651489258
Epoch: 22, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.347 Vali Acc: 0.938 Test Loss: 0.347 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 23 cost time: 1.108144998550415
Epoch: 23, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.322 Vali Acc: 0.935 Test Loss: 0.322 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0298597812652588
Epoch: 24, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.307 Vali Acc: 0.932 Test Loss: 0.307 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9180347919464111
Epoch: 25, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.288 Vali Acc: 0.935 Test Loss: 0.288 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1183149814605713
Epoch: 26, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940538).  Saving model ...
Epoch: 27 cost time: 1.1461899280548096
Epoch: 27, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 28 cost time: 0.9050705432891846
Epoch: 28, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 29 cost time: 0.9257242679595947
Epoch: 29, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.235 Vali Acc: 0.946 Test Loss: 0.235 Test Acc: 0.946
Validation loss decreased (-0.940538 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 1.127821922302246
Epoch: 30, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 1.0214171409606934
Epoch: 31, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 32 cost time: 1.0380637645721436
Epoch: 32, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0825836658477783
Epoch: 33, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 34 cost time: 1.0305254459381104
Epoch: 34, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.193 Vali Acc: 0.946 Test Loss: 0.193 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 35 cost time: 1.1060340404510498
Epoch: 35, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.192 Vali Acc: 0.951 Test Loss: 0.192 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 36 cost time: 1.0315024852752686
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8702270984649658
Epoch: 37, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.176 Vali Acc: 0.949 Test Loss: 0.176 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9514071941375732
Epoch: 38, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1366076469421387
Epoch: 39, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 40 cost time: 0.9223887920379639
Epoch: 40, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9467885494232178
Epoch: 41, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9107437133789062
Epoch: 42, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9894256591796875
Epoch: 43, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1339879035949707
Epoch: 44, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8708679676055908
Epoch: 45, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.926114559173584
Epoch: 46, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 47 cost time: 1.0053308010101318
Epoch: 47, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.005005121231079
Epoch: 48, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1064598560333252
Epoch: 49, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.949 Test Loss: 0.136 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0216224193572998
Epoch: 50, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0905346870422363
Epoch: 51, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.951 Test Loss: 0.129 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0004749298095703
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 53 cost time: 1.1360702514648438
Epoch: 53, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0582630634307861
Epoch: 54, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 55 cost time: 1.0722711086273193
Epoch: 55, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9897043704986572
Epoch: 56, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.957 Test Loss: 0.131 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 57 cost time: 1.12510347366333
Epoch: 57, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.957 Test Loss: 0.126 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 58 cost time: 1.155285358428955
Epoch: 58, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0663366317749023
Epoch: 59, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.142925500869751
Epoch: 60, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956756).  Saving model ...
Epoch: 61 cost time: 1.1077580451965332
Epoch: 61, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.956756 --> -0.962161).  Saving model ...
Epoch: 62 cost time: 1.0563764572143555
Epoch: 62, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.954 Test Loss: 0.124 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.1467747688293457
Epoch: 63, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.0660614967346191
Epoch: 64, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.055666446685791
Epoch: 65, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 1.0085208415985107
Epoch: 66, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.962 Test Loss: 0.117 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 67 cost time: 1.043163537979126
Epoch: 67, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.2278378009796143
Epoch: 68, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.145881175994873
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.2528116703033447
Epoch: 70, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 71 cost time: 1.21524977684021
Epoch: 71, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 72 cost time: 1.2488648891448975
Epoch: 72, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.2347984313964844
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 74 cost time: 1.203202724456787
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 1.1670386791229248
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 1.0627830028533936
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9900388717651367
Epoch: 77, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 1.049828290939331
Epoch: 78, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.9634745121002197
Epoch: 79, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.957 Test Loss: 0.119 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 1.0448546409606934
Epoch: 80, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.1545896530151367
Epoch: 81, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.0555157661437988
Epoch: 82, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.959 Test Loss: 0.111 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.9947764873504639
Epoch: 83, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 78313
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.896881103515625
Epoch: 1, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.143 Vali Acc: 0.116 Test Loss: 2.143 Test Acc: 0.116
Validation loss decreased (inf --> -0.116195).  Saving model ...
Epoch: 2 cost time: 0.959050178527832
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.025 Vali Acc: 0.249 Test Loss: 2.025 Test Acc: 0.249
Validation loss decreased (-0.116195 --> -0.248628).  Saving model ...
Epoch: 3 cost time: 1.0804259777069092
Epoch: 3, Steps: 17 | Train Loss: 1.953 Vali Loss: 1.886 Vali Acc: 0.435 Test Loss: 1.886 Test Acc: 0.435
Validation loss decreased (-0.248628 --> -0.435116).  Saving model ...
Epoch: 4 cost time: 0.9906508922576904
Epoch: 4, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.729 Vali Acc: 0.624 Test Loss: 1.729 Test Acc: 0.624
Validation loss decreased (-0.435116 --> -0.624307).  Saving model ...
Epoch: 5 cost time: 1.0307555198669434
Epoch: 5, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.580 Vali Acc: 0.724 Test Loss: 1.580 Test Acc: 0.724
Validation loss decreased (-0.624307 --> -0.724309).  Saving model ...
Epoch: 6 cost time: 1.0131299495697021
Epoch: 6, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.418 Vali Acc: 0.776 Test Loss: 1.418 Test Acc: 0.776
Validation loss decreased (-0.724309 --> -0.775661).  Saving model ...
Epoch: 7 cost time: 0.8518741130828857
Epoch: 7, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.273 Vali Acc: 0.800 Test Loss: 1.273 Test Acc: 0.800
Validation loss decreased (-0.775661 --> -0.799987).  Saving model ...
Epoch: 8 cost time: 0.9961457252502441
Epoch: 8, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.126 Vali Acc: 0.838 Test Loss: 1.126 Test Acc: 0.838
Validation loss decreased (-0.799987 --> -0.837827).  Saving model ...
Epoch: 9 cost time: 0.9182887077331543
Epoch: 9, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.011 Vali Acc: 0.859 Test Loss: 1.011 Test Acc: 0.859
Validation loss decreased (-0.837827 --> -0.859449).  Saving model ...
Epoch: 10 cost time: 1.0524883270263672
Epoch: 10, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.895 Vali Acc: 0.884 Test Loss: 0.895 Test Acc: 0.884
Validation loss decreased (-0.859449 --> -0.883775).  Saving model ...
Epoch: 11 cost time: 1.1404294967651367
Epoch: 11, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.797 Vali Acc: 0.903 Test Loss: 0.797 Test Acc: 0.903
Validation loss decreased (-0.883775 --> -0.902695).  Saving model ...
Epoch: 12 cost time: 1.0776240825653076
Epoch: 12, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.715 Vali Acc: 0.908 Test Loss: 0.715 Test Acc: 0.908
Validation loss decreased (-0.902695 --> -0.908101).  Saving model ...
Epoch: 13 cost time: 0.895704984664917
Epoch: 13, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.645 Vali Acc: 0.919 Test Loss: 0.645 Test Acc: 0.919
Validation loss decreased (-0.908101 --> -0.918912).  Saving model ...
Epoch: 14 cost time: 0.9545021057128906
Epoch: 14, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.592 Vali Acc: 0.911 Test Loss: 0.592 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8888833522796631
Epoch: 15, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.533 Vali Acc: 0.922 Test Loss: 0.533 Test Acc: 0.922
Validation loss decreased (-0.918912 --> -0.921616).  Saving model ...
Epoch: 16 cost time: 0.8828494548797607
Epoch: 16, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.495 Vali Acc: 0.922 Test Loss: 0.495 Test Acc: 0.922
Validation loss decreased (-0.921616 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 1.0097846984863281
Epoch: 17, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.454 Vali Acc: 0.924 Test Loss: 0.454 Test Acc: 0.924
Validation loss decreased (-0.921617 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 0.8602542877197266
Epoch: 18, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.416 Vali Acc: 0.935 Test Loss: 0.416 Test Acc: 0.935
Validation loss decreased (-0.924320 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 0.9104740619659424
Epoch: 19, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.393 Vali Acc: 0.938 Test Loss: 0.393 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 20 cost time: 0.9497165679931641
Epoch: 20, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.367 Vali Acc: 0.938 Test Loss: 0.367 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 21 cost time: 0.9079418182373047
Epoch: 21, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.339 Vali Acc: 0.935 Test Loss: 0.339 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9404914379119873
Epoch: 22, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 23 cost time: 0.9902634620666504
Epoch: 23, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 24 cost time: 0.9722139835357666
Epoch: 24, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.285 Vali Acc: 0.938 Test Loss: 0.285 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1097161769866943
Epoch: 25, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 26 cost time: 0.9272336959838867
Epoch: 26, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.256 Vali Acc: 0.943 Test Loss: 0.256 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 27 cost time: 1.0449631214141846
Epoch: 27, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.240 Vali Acc: 0.943 Test Loss: 0.240 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 28 cost time: 0.9332196712493896
Epoch: 28, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 1.0829708576202393
Epoch: 29, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 0.9447219371795654
Epoch: 30, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.210 Vali Acc: 0.946 Test Loss: 0.210 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 1.1171150207519531
Epoch: 31, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.202 Vali Acc: 0.949 Test Loss: 0.202 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 32 cost time: 0.9584474563598633
Epoch: 32, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.204 Vali Acc: 0.946 Test Loss: 0.204 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0745081901550293
Epoch: 33, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 34 cost time: 1.068711519241333
Epoch: 34, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0389869213104248
Epoch: 35, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 36 cost time: 1.0983376502990723
Epoch: 36, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 1.0854589939117432
Epoch: 37, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.023256540298462
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0193970203399658
Epoch: 39, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 1.1088201999664307
Epoch: 40, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 0.9753885269165039
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 42 cost time: 1.019209384918213
Epoch: 42, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 43 cost time: 0.9192190170288086
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.013138771057129
Epoch: 44, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 45 cost time: 0.9469547271728516
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.013561725616455
Epoch: 46, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.05173659324646
Epoch: 47, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 48 cost time: 1.108285903930664
Epoch: 48, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 1.0434575080871582
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0807697772979736
Epoch: 50, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1061413288116455
Epoch: 51, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 1.04750394821167
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 53 cost time: 1.1196701526641846
Epoch: 53, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 54 cost time: 0.9946048259735107
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 55 cost time: 1.0218229293823242
Epoch: 55, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 56 cost time: 1.0927789211273193
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 57 cost time: 0.9779441356658936
Epoch: 57, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.1549711227416992
Epoch: 58, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0690059661865234
Epoch: 59, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9729223251342773
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.1645379066467285
Epoch: 61, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.192108154296875
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 63 cost time: 1.0981206893920898
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.0138769149780273
Epoch: 64, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 65 cost time: 0.9882714748382568
Epoch: 65, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 66 cost time: 0.9384276866912842
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9120533466339111
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9339866638183594
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0743467807769775
Epoch: 69, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.8580303192138672
Epoch: 70, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.0127480030059814
Epoch: 71, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0566880702972412
Epoch: 72, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 73 cost time: 1.1835803985595703
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.157656192779541
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.0949795246124268
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 1.1222374439239502
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 77 cost time: 1.0795729160308838
Epoch: 77, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.9905493259429932
Epoch: 78, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.1166772842407227
Epoch: 79, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 80 cost time: 1.0879063606262207
Epoch: 80, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.972972 --> -0.978377).  Saving model ...
Epoch: 81 cost time: 1.1144037246704102
Epoch: 81, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9658410549163818
Epoch: 82, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.1231658458709717
Epoch: 83, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0343832969665527
Epoch: 84, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.1471412181854248
Epoch: 85, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 1.1361520290374756
Epoch: 86, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 1.040855884552002
Epoch: 87, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.0084095001220703
Epoch: 88, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.119096040725708
Epoch: 89, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.9524626731872559
Epoch: 90, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9783783783783784
model parameter : 45545
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.4281868934631348
Epoch: 1, Steps: 17 | Train Loss: 2.212 Vali Loss: 2.152 Vali Acc: 0.103 Test Loss: 2.152 Test Acc: 0.103
Validation loss decreased (inf --> -0.102681).  Saving model ...
Epoch: 2 cost time: 0.9578993320465088
Epoch: 2, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.036 Vali Acc: 0.238 Test Loss: 2.036 Test Acc: 0.238
Validation loss decreased (-0.102681 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 1.0824458599090576
Epoch: 3, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.898 Vali Acc: 0.443 Test Loss: 1.898 Test Acc: 0.443
Validation loss decreased (-0.237817 --> -0.443224).  Saving model ...
Epoch: 4 cost time: 1.081451654434204
Epoch: 4, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.742 Vali Acc: 0.643 Test Loss: 1.742 Test Acc: 0.643
Validation loss decreased (-0.443224 --> -0.643226).  Saving model ...
Epoch: 5 cost time: 1.1461782455444336
Epoch: 5, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.593 Vali Acc: 0.700 Test Loss: 1.593 Test Acc: 0.700
Validation loss decreased (-0.643226 --> -0.699984).  Saving model ...
Epoch: 6 cost time: 1.049213171005249
Epoch: 6, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.431 Vali Acc: 0.765 Test Loss: 1.431 Test Acc: 0.765
Validation loss decreased (-0.699984 --> -0.764851).  Saving model ...
Epoch: 7 cost time: 1.0088143348693848
Epoch: 7, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.287 Vali Acc: 0.800 Test Loss: 1.287 Test Acc: 0.800
Validation loss decreased (-0.764851 --> -0.799987).  Saving model ...
Epoch: 8 cost time: 1.0695676803588867
Epoch: 8, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.141 Vali Acc: 0.830 Test Loss: 1.141 Test Acc: 0.830
Validation loss decreased (-0.799987 --> -0.829718).  Saving model ...
Epoch: 9 cost time: 0.9827444553375244
Epoch: 9, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.024 Vali Acc: 0.857 Test Loss: 1.024 Test Acc: 0.857
Validation loss decreased (-0.829718 --> -0.856747).  Saving model ...
Epoch: 10 cost time: 0.9771881103515625
Epoch: 10, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.911 Vali Acc: 0.878 Test Loss: 0.911 Test Acc: 0.878
Validation loss decreased (-0.856747 --> -0.878369).  Saving model ...
Epoch: 11 cost time: 0.9455564022064209
Epoch: 11, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.813 Vali Acc: 0.892 Test Loss: 0.813 Test Acc: 0.892
Validation loss decreased (-0.878369 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 1.0581209659576416
Epoch: 12, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.891884 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.0997881889343262
Epoch: 13, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.659 Vali Acc: 0.908 Test Loss: 0.659 Test Acc: 0.908
Validation loss decreased (-0.899993 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 0.928617000579834
Epoch: 14, Steps: 17 | Train Loss: 0.571 Vali Loss: 0.603 Vali Acc: 0.914 Test Loss: 0.603 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913507).  Saving model ...
Epoch: 15 cost time: 0.9894065856933594
Epoch: 15, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.544 Vali Acc: 0.916 Test Loss: 0.544 Test Acc: 0.916
Validation loss decreased (-0.913507 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 1.0496876239776611
Epoch: 16, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.504 Vali Acc: 0.919 Test Loss: 0.504 Test Acc: 0.919
Validation loss decreased (-0.916211 --> -0.918914).  Saving model ...
Epoch: 17 cost time: 1.0511057376861572
Epoch: 17, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.461 Vali Acc: 0.924 Test Loss: 0.461 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 1.0737993717193604
Epoch: 18, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.423 Vali Acc: 0.930 Test Loss: 0.423 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 19 cost time: 0.9114089012145996
Epoch: 19, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.400 Vali Acc: 0.932 Test Loss: 0.400 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932428).  Saving model ...
Epoch: 20 cost time: 0.9322185516357422
Epoch: 20, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.373 Vali Acc: 0.932 Test Loss: 0.373 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932429).  Saving model ...
Epoch: 21 cost time: 1.005328893661499
Epoch: 21, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.345 Vali Acc: 0.938 Test Loss: 0.345 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937834).  Saving model ...
Epoch: 22 cost time: 0.9996294975280762
Epoch: 22, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.323 Vali Acc: 0.938 Test Loss: 0.323 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 0.9549157619476318
Epoch: 23, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.301 Vali Acc: 0.938 Test Loss: 0.301 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 1.079322338104248
Epoch: 24, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.290 Vali Acc: 0.938 Test Loss: 0.290 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 25 cost time: 0.9701690673828125
Epoch: 25, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 26 cost time: 1.008241891860962
Epoch: 26, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 27 cost time: 0.9297745227813721
Epoch: 27, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 28 cost time: 0.9805827140808105
Epoch: 28, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 29 cost time: 1.0078952312469482
Epoch: 29, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 30 cost time: 0.9732913970947266
Epoch: 30, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951349).  Saving model ...
Epoch: 31 cost time: 1.1262586116790771
Epoch: 31, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1336309909820557
Epoch: 32, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.207 Vali Acc: 0.946 Test Loss: 0.207 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0344462394714355
Epoch: 33, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0499706268310547
Epoch: 34, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 35 cost time: 1.0031147003173828
Epoch: 35, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 0.9169120788574219
Epoch: 36, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 37 cost time: 0.9477193355560303
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9867703914642334
Epoch: 38, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 39 cost time: 0.8690412044525146
Epoch: 39, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 40 cost time: 1.0352821350097656
Epoch: 40, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 0.887763500213623
Epoch: 41, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 42 cost time: 1.0385701656341553
Epoch: 42, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9584343433380127
Epoch: 43, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 44 cost time: 0.9808964729309082
Epoch: 44, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 45 cost time: 0.9424231052398682
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9321820735931396
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1021697521209717
Epoch: 47, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0896086692810059
Epoch: 48, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.965 Test Loss: 0.131 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 0.9633722305297852
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0578153133392334
Epoch: 50, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0405209064483643
Epoch: 51, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 0.9499752521514893
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 53 cost time: 1.086855173110962
Epoch: 53, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 54 cost time: 1.0210390090942383
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 55 cost time: 1.0081980228424072
Epoch: 55, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 56 cost time: 1.1146068572998047
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 57 cost time: 1.0184237957000732
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0495243072509766
Epoch: 58, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0930418968200684
Epoch: 59, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.079169511795044
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9766077995300293
Epoch: 61, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.0524840354919434
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 63 cost time: 1.075190782546997
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9227688312530518
Epoch: 64, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 65 cost time: 1.159923791885376
Epoch: 65, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 66 cost time: 1.0258924961090088
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9913604259490967
Epoch: 67, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.0045456886291504
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.1646122932434082
Epoch: 69, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.9987843036651611
Epoch: 70, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.0606508255004883
Epoch: 71, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.0105180740356445
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.0116868019104004
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.193209171295166
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9593067169189453
Epoch: 75, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 45545
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7668373584747314
Epoch: 1, Steps: 17 | Train Loss: 2.210 Vali Loss: 2.149 Vali Acc: 0.124 Test Loss: 2.149 Test Acc: 0.124
Validation loss decreased (inf --> -0.124303).  Saving model ...
Epoch: 2 cost time: 0.8966629505157471
Epoch: 2, Steps: 17 | Train Loss: 2.112 Vali Loss: 2.038 Vali Acc: 0.259 Test Loss: 2.038 Test Acc: 0.259
Validation loss decreased (-0.124303 --> -0.259439).  Saving model ...
Epoch: 3 cost time: 0.8907918930053711
Epoch: 3, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.906 Vali Acc: 0.484 Test Loss: 1.906 Test Acc: 0.484
Validation loss decreased (-0.259439 --> -0.483765).  Saving model ...
Epoch: 4 cost time: 1.0003199577331543
Epoch: 4, Steps: 17 | Train Loss: 1.822 Vali Loss: 1.757 Vali Acc: 0.632 Test Loss: 1.757 Test Acc: 0.632
Validation loss decreased (-0.483765 --> -0.632415).  Saving model ...
Epoch: 5 cost time: 1.168630838394165
Epoch: 5, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.613 Vali Acc: 0.711 Test Loss: 1.613 Test Acc: 0.711
Validation loss decreased (-0.632415 --> -0.710795).  Saving model ...
Epoch: 6 cost time: 1.0395896434783936
Epoch: 6, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.458 Vali Acc: 0.778 Test Loss: 1.458 Test Acc: 0.778
Validation loss decreased (-0.710795 --> -0.778364).  Saving model ...
Epoch: 7 cost time: 1.1140422821044922
Epoch: 7, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.317 Vali Acc: 0.808 Test Loss: 1.317 Test Acc: 0.808
Validation loss decreased (-0.778364 --> -0.808095).  Saving model ...
Epoch: 8 cost time: 0.9828922748565674
Epoch: 8, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.173 Vali Acc: 0.835 Test Loss: 1.173 Test Acc: 0.835
Validation loss decreased (-0.808095 --> -0.835123).  Saving model ...
Epoch: 9 cost time: 1.1003367900848389
Epoch: 9, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.055 Vali Acc: 0.851 Test Loss: 1.055 Test Acc: 0.851
Validation loss decreased (-0.835123 --> -0.851341).  Saving model ...
Epoch: 10 cost time: 0.9650776386260986
Epoch: 10, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.939 Vali Acc: 0.886 Test Loss: 0.939 Test Acc: 0.886
Validation loss decreased (-0.851341 --> -0.886477).  Saving model ...
Epoch: 11 cost time: 1.1012539863586426
Epoch: 11, Steps: 17 | Train Loss: 0.812 Vali Loss: 0.840 Vali Acc: 0.895 Test Loss: 0.840 Test Acc: 0.895
Validation loss decreased (-0.886477 --> -0.894586).  Saving model ...
Epoch: 12 cost time: 1.031841516494751
Epoch: 12, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.758 Vali Acc: 0.897 Test Loss: 0.758 Test Acc: 0.897
Validation loss decreased (-0.894586 --> -0.897290).  Saving model ...
Epoch: 13 cost time: 1.1172494888305664
Epoch: 13, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.685 Vali Acc: 0.897 Test Loss: 0.685 Test Acc: 0.897
Validation loss decreased (-0.897290 --> -0.897290).  Saving model ...
Epoch: 14 cost time: 0.9655373096466064
Epoch: 14, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.625 Vali Acc: 0.908 Test Loss: 0.625 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 15 cost time: 0.9941251277923584
Epoch: 15, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.565 Vali Acc: 0.905 Test Loss: 0.565 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0779621601104736
Epoch: 16, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.524 Vali Acc: 0.914 Test Loss: 0.524 Test Acc: 0.914
Validation loss decreased (-0.908102 --> -0.913508).  Saving model ...
Epoch: 17 cost time: 1.0334489345550537
Epoch: 17, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.913508 --> -0.918914).  Saving model ...
Epoch: 18 cost time: 1.1755883693695068
Epoch: 18, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.438 Vali Acc: 0.924 Test Loss: 0.438 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 19 cost time: 1.015817403793335
Epoch: 19, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.413 Vali Acc: 0.930 Test Loss: 0.413 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 20 cost time: 0.9944005012512207
Epoch: 20, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.383 Vali Acc: 0.932 Test Loss: 0.383 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 21 cost time: 1.0623528957366943
Epoch: 21, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.353 Vali Acc: 0.938 Test Loss: 0.353 Test Acc: 0.938
Validation loss decreased (-0.932429 --> -0.937834).  Saving model ...
Epoch: 22 cost time: 0.8945417404174805
Epoch: 22, Steps: 17 | Train Loss: 0.270 Vali Loss: 0.332 Vali Acc: 0.938 Test Loss: 0.332 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 0.9951419830322266
Epoch: 23, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.308 Vali Acc: 0.941 Test Loss: 0.308 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940537).  Saving model ...
Epoch: 24 cost time: 1.0142722129821777
Epoch: 24, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.296 Vali Acc: 0.943 Test Loss: 0.296 Test Acc: 0.943
Validation loss decreased (-0.940537 --> -0.943240).  Saving model ...
Epoch: 25 cost time: 1.0636522769927979
Epoch: 25, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.281 Vali Acc: 0.946 Test Loss: 0.281 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 26 cost time: 0.9418258666992188
Epoch: 26, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.265 Vali Acc: 0.946 Test Loss: 0.265 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 27 cost time: 1.001824140548706
Epoch: 27, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.245 Vali Acc: 0.949 Test Loss: 0.245 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 28 cost time: 1.0537810325622559
Epoch: 28, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.240 Vali Acc: 0.949 Test Loss: 0.240 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 29 cost time: 0.9575307369232178
Epoch: 29, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.957589864730835
Epoch: 30, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.948646 --> -0.954052).  Saving model ...
Epoch: 31 cost time: 0.9465358257293701
Epoch: 31, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 32 cost time: 0.9013054370880127
Epoch: 32, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9484002590179443
Epoch: 33, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9626405239105225
Epoch: 34, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 0.7765100002288818
Epoch: 35, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.182 Vali Acc: 0.951 Test Loss: 0.182 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0380544662475586
Epoch: 36, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8515756130218506
Epoch: 37, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0825538635253906
Epoch: 38, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 39 cost time: 0.8957922458648682
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 40 cost time: 0.9623730182647705
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 41 cost time: 0.9774415493011475
Epoch: 41, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0136375427246094
Epoch: 42, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 43 cost time: 1.0632429122924805
Epoch: 43, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 44 cost time: 1.0496745109558105
Epoch: 44, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 45 cost time: 1.0618443489074707
Epoch: 45, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.031057596206665
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 47 cost time: 1.0291469097137451
Epoch: 47, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 0.9173843860626221
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 49 cost time: 0.9022719860076904
Epoch: 49, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0526459217071533
Epoch: 50, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8895940780639648
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9813122749328613
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.949596643447876
Epoch: 53, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.005788803100586
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0419018268585205
Epoch: 55, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 56 cost time: 1.0091562271118164
Epoch: 56, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1421537399291992
Epoch: 57, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.0424036979675293
Epoch: 58, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9996416568756104
Epoch: 59, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.1227095127105713
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 61 cost time: 1.0497612953186035
Epoch: 61, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9780399799346924
Epoch: 62, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 63 cost time: 1.055074691772461
Epoch: 63, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.951209545135498
Epoch: 64, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0025968551635742
Epoch: 65, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 66 cost time: 0.9174349308013916
Epoch: 66, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 67 cost time: 1.0000457763671875
Epoch: 67, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8179857730865479
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9962759017944336
Epoch: 69, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.0057885646820068
Epoch: 70, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0682239532470703
Epoch: 71, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0772950649261475
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0181612968444824
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0060596466064453
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.0430312156677246
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.0329673290252686
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 77 cost time: 0.991375207901001
Epoch: 77, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.0928997993469238
Epoch: 78, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 1.0889103412628174
Epoch: 79, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 80 cost time: 1.0993289947509766
Epoch: 80, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 81 cost time: 1.1168081760406494
Epoch: 81, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.9868896007537842
Epoch: 82, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 1.0429542064666748
Epoch: 83, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0486023426055908
Epoch: 84, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 1.027280330657959
Epoch: 85, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.9250497817993164
Epoch: 86, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.9532744884490967
Epoch: 87, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.0839037895202637
Epoch: 88, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 1.0368640422821045
Epoch: 89, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 1.0552005767822266
Epoch: 90, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 91 cost time: 1.0552926063537598
Epoch: 91, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.968 Test Loss: 0.095 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 1.0603406429290771
Epoch: 92, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.0689704418182373
Epoch: 93, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.9863028526306152
Epoch: 94, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 1.1439282894134521
Epoch: 95, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 96 cost time: 0.9965126514434814
Epoch: 96, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 97 cost time: 0.969947099685669
Epoch: 97, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 98 cost time: 0.9489893913269043
Epoch: 98, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 99 cost time: 0.8972358703613281
Epoch: 99, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 100 cost time: 1.0454044342041016
Epoch: 100, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 45545
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.7837703227996826
Epoch: 1, Steps: 17 | Train Loss: 2.222 Vali Loss: 2.154 Vali Acc: 0.127 Test Loss: 2.154 Test Acc: 0.127
Validation loss decreased (inf --> -0.127005).  Saving model ...
Epoch: 2 cost time: 0.9610855579376221
Epoch: 2, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.059 Vali Acc: 0.273 Test Loss: 2.059 Test Acc: 0.273
Validation loss decreased (-0.127005 --> -0.272952).  Saving model ...
Epoch: 3 cost time: 1.082111120223999
Epoch: 3, Steps: 17 | Train Loss: 2.004 Vali Loss: 1.945 Vali Acc: 0.486 Test Loss: 1.945 Test Acc: 0.486
Validation loss decreased (-0.272952 --> -0.486467).  Saving model ...
Epoch: 4 cost time: 1.0735182762145996
Epoch: 4, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.814 Vali Acc: 0.681 Test Loss: 1.814 Test Acc: 0.681
Validation loss decreased (-0.486467 --> -0.681063).  Saving model ...
Epoch: 5 cost time: 1.0049891471862793
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.686 Vali Acc: 0.746 Test Loss: 1.686 Test Acc: 0.746
Validation loss decreased (-0.681063 --> -0.745929).  Saving model ...
Epoch: 6 cost time: 1.1086935997009277
Epoch: 6, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.547 Vali Acc: 0.789 Test Loss: 1.547 Test Acc: 0.789
Validation loss decreased (-0.745929 --> -0.789174).  Saving model ...
Epoch: 7 cost time: 0.9857563972473145
Epoch: 7, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.417 Vali Acc: 0.814 Test Loss: 1.417 Test Acc: 0.814
Validation loss decreased (-0.789174 --> -0.813499).  Saving model ...
Epoch: 8 cost time: 1.0428566932678223
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.281 Vali Acc: 0.830 Test Loss: 1.281 Test Acc: 0.830
Validation loss decreased (-0.813499 --> -0.829717).  Saving model ...
Epoch: 9 cost time: 0.9519603252410889
Epoch: 9, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.162 Vali Acc: 0.851 Test Loss: 1.162 Test Acc: 0.851
Validation loss decreased (-0.829717 --> -0.851340).  Saving model ...
Epoch: 10 cost time: 1.08439302444458
Epoch: 10, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.043 Vali Acc: 0.868 Test Loss: 1.043 Test Acc: 0.868
Validation loss decreased (-0.851340 --> -0.867557).  Saving model ...
Epoch: 11 cost time: 1.0422372817993164
Epoch: 11, Steps: 17 | Train Loss: 0.909 Vali Loss: 0.936 Vali Acc: 0.886 Test Loss: 0.936 Test Acc: 0.886
Validation loss decreased (-0.867557 --> -0.886477).  Saving model ...
Epoch: 12 cost time: 0.9566071033477783
Epoch: 12, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.843 Vali Acc: 0.884 Test Loss: 0.843 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9249575138092041
Epoch: 13, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.761 Vali Acc: 0.892 Test Loss: 0.761 Test Acc: 0.892
Validation loss decreased (-0.886477 --> -0.891884).  Saving model ...
Epoch: 14 cost time: 1.078125
Epoch: 14, Steps: 17 | Train Loss: 0.660 Vali Loss: 0.695 Vali Acc: 0.895 Test Loss: 0.695 Test Acc: 0.895
Validation loss decreased (-0.891884 --> -0.894588).  Saving model ...
Epoch: 15 cost time: 1.1008880138397217
Epoch: 15, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.625 Vali Acc: 0.905 Test Loss: 0.625 Test Acc: 0.905
Validation loss decreased (-0.894588 --> -0.905399).  Saving model ...
Epoch: 16 cost time: 0.9418108463287354
Epoch: 16, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0695390701293945
Epoch: 17, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
Validation loss decreased (-0.905399 --> -0.910806).  Saving model ...
Epoch: 18 cost time: 1.1517055034637451
Epoch: 18, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.480 Vali Acc: 0.914 Test Loss: 0.480 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 19 cost time: 1.1641862392425537
Epoch: 19, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918914).  Saving model ...
Epoch: 20 cost time: 1.133301019668579
Epoch: 20, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.417 Vali Acc: 0.924 Test Loss: 0.417 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 21 cost time: 1.0390758514404297
Epoch: 21, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.924320 --> -0.929726).  Saving model ...
Epoch: 22 cost time: 1.0996594429016113
Epoch: 22, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.357 Vali Acc: 0.932 Test Loss: 0.357 Test Acc: 0.932
Validation loss decreased (-0.929726 --> -0.932429).  Saving model ...
Epoch: 23 cost time: 1.0311717987060547
Epoch: 23, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.331 Vali Acc: 0.949 Test Loss: 0.331 Test Acc: 0.949
Validation loss decreased (-0.932429 --> -0.948645).  Saving model ...
Epoch: 24 cost time: 1.091433048248291
Epoch: 24, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.319 Vali Acc: 0.938 Test Loss: 0.319 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0966980457305908
Epoch: 25, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0241658687591553
Epoch: 26, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.282 Vali Acc: 0.943 Test Loss: 0.282 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9445812702178955
Epoch: 27, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.261 Vali Acc: 0.954 Test Loss: 0.261 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 28 cost time: 1.1007649898529053
Epoch: 28, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.255 Vali Acc: 0.946 Test Loss: 0.255 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1934571266174316
Epoch: 29, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0317118167877197
Epoch: 30, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.161893606185913
Epoch: 31, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956755).  Saving model ...
Epoch: 32 cost time: 1.028550148010254
Epoch: 32, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.105177879333496
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.210 Vali Acc: 0.951 Test Loss: 0.210 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9757544994354248
Epoch: 34, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 35 cost time: 0.9849822521209717
Epoch: 35, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 0.9358406066894531
Epoch: 36, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 1.0530474185943604
Epoch: 37, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9593768119812012
Epoch: 38, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.183 Vali Acc: 0.949 Test Loss: 0.183 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0276427268981934
Epoch: 39, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 40 cost time: 0.883411169052124
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 41 cost time: 1.0723507404327393
Epoch: 41, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9624507427215576
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.091256856918335
Epoch: 43, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 44 cost time: 1.0649776458740234
Epoch: 44, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9426679611206055
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.151 Vali Acc: 0.957 Test Loss: 0.151 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.028515338897705
Epoch: 46, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9681601524353027
Epoch: 47, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 48 cost time: 0.995028018951416
Epoch: 48, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964863).  Saving model ...
Epoch: 49 cost time: 1.0494763851165771
Epoch: 49, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 50 cost time: 0.8537445068359375
Epoch: 50, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9857923984527588
Epoch: 51, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 1.0633890628814697
Epoch: 52, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 53 cost time: 1.144132375717163
Epoch: 53, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 54 cost time: 1.1326639652252197
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9937586784362793
Epoch: 55, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9708774089813232
Epoch: 56, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 57 cost time: 0.9459991455078125
Epoch: 57, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0397717952728271
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9739348888397217
Epoch: 59, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9483599662780762
Epoch: 60, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.0685617923736572
Epoch: 61, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 62 cost time: 1.0715062618255615
Epoch: 62, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 63 cost time: 1.0779767036437988
Epoch: 63, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.068084955215454
Epoch: 64, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1125822067260742
Epoch: 65, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1020159721374512
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.0289757251739502
Epoch: 67, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.136584997177124
Epoch: 68, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.0745668411254883
Epoch: 69, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.0963871479034424
Epoch: 70, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.0017666816711426
Epoch: 71, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.8899531364440918
Epoch: 72, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9702702702702702
model parameter : 45545
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6807377338409424
Epoch: 1, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.078 Vali Acc: 0.241 Test Loss: 2.078 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 0.9513823986053467
Epoch: 2, Steps: 17 | Train Loss: 2.078 Vali Loss: 1.975 Vali Acc: 0.327 Test Loss: 1.975 Test Acc: 0.327
Validation loss decreased (-0.240520 --> -0.327007).  Saving model ...
Epoch: 3 cost time: 0.9989132881164551
Epoch: 3, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.842 Vali Acc: 0.530 Test Loss: 1.842 Test Acc: 0.530
Validation loss decreased (-0.327007 --> -0.529711).  Saving model ...
Epoch: 4 cost time: 0.9864785671234131
Epoch: 4, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.695 Vali Acc: 0.697 Test Loss: 1.695 Test Acc: 0.697
Validation loss decreased (-0.529711 --> -0.697280).  Saving model ...
Epoch: 5 cost time: 1.045985221862793
Epoch: 5, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.546 Vali Acc: 0.784 Test Loss: 1.546 Test Acc: 0.784
Validation loss decreased (-0.697280 --> -0.783768).  Saving model ...
Epoch: 6 cost time: 0.9592399597167969
Epoch: 6, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.384 Vali Acc: 0.797 Test Loss: 1.384 Test Acc: 0.797
Validation loss decreased (-0.783768 --> -0.797283).  Saving model ...
Epoch: 7 cost time: 0.9044890403747559
Epoch: 7, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.235 Vali Acc: 0.838 Test Loss: 1.235 Test Acc: 0.838
Validation loss decreased (-0.797283 --> -0.837825).  Saving model ...
Epoch: 8 cost time: 1.0693411827087402
Epoch: 8, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.091 Vali Acc: 0.854 Test Loss: 1.091 Test Acc: 0.854
Validation loss decreased (-0.837825 --> -0.854043).  Saving model ...
Epoch: 9 cost time: 0.9932069778442383
Epoch: 9, Steps: 17 | Train Loss: 0.973 Vali Loss: 0.974 Vali Acc: 0.859 Test Loss: 0.974 Test Acc: 0.859
Validation loss decreased (-0.854043 --> -0.859450).  Saving model ...
Epoch: 10 cost time: 0.877021074295044
Epoch: 10, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.859 Vali Acc: 0.881 Test Loss: 0.859 Test Acc: 0.881
Validation loss decreased (-0.859450 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 0.9725222587585449
Epoch: 11, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.772 Vali Acc: 0.889 Test Loss: 0.772 Test Acc: 0.889
Validation loss decreased (-0.881072 --> -0.889181).  Saving model ...
Epoch: 12 cost time: 0.9257826805114746
Epoch: 12, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.689 Vali Acc: 0.900 Test Loss: 0.689 Test Acc: 0.900
Validation loss decreased (-0.889181 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.9048562049865723
Epoch: 13, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.623 Vali Acc: 0.905 Test Loss: 0.623 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905399).  Saving model ...
Epoch: 14 cost time: 1.0212554931640625
Epoch: 14, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.561 Vali Acc: 0.922 Test Loss: 0.561 Test Acc: 0.922
Validation loss decreased (-0.905399 --> -0.921616).  Saving model ...
Epoch: 15 cost time: 1.0560493469238281
Epoch: 15, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.516 Vali Acc: 0.924 Test Loss: 0.516 Test Acc: 0.924
Validation loss decreased (-0.921616 --> -0.924319).  Saving model ...
Epoch: 16 cost time: 1.0570967197418213
Epoch: 16, Steps: 17 | Train Loss: 0.426 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.924319 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 1.061375379562378
Epoch: 17, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.429 Vali Acc: 0.924 Test Loss: 0.429 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9402129650115967
Epoch: 18, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.398 Vali Acc: 0.935 Test Loss: 0.398 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 0.9244236946105957
Epoch: 19, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.371 Vali Acc: 0.927 Test Loss: 0.371 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9328198432922363
Epoch: 20, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.348 Vali Acc: 0.935 Test Loss: 0.348 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 21 cost time: 0.985520601272583
Epoch: 21, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 1.0110397338867188
Epoch: 22, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.305 Vali Acc: 0.938 Test Loss: 0.305 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 0.8455727100372314
Epoch: 23, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.282 Vali Acc: 0.943 Test Loss: 0.282 Test Acc: 0.943
Validation loss decreased (-0.937835 --> -0.943240).  Saving model ...
Epoch: 24 cost time: 0.9939441680908203
Epoch: 24, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.264 Vali Acc: 0.946 Test Loss: 0.264 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 25 cost time: 0.9472193717956543
Epoch: 25, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0550897121429443
Epoch: 26, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 27 cost time: 1.0490632057189941
Epoch: 27, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.231 Vali Acc: 0.949 Test Loss: 0.231 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948646).  Saving model ...
Epoch: 28 cost time: 0.9164459705352783
Epoch: 28, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 29 cost time: 1.0258774757385254
Epoch: 29, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.211 Vali Acc: 0.954 Test Loss: 0.211 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 30 cost time: 1.095698356628418
Epoch: 30, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.200 Vali Acc: 0.959 Test Loss: 0.200 Test Acc: 0.959
Validation loss decreased (-0.954052 --> -0.959457).  Saving model ...
Epoch: 31 cost time: 0.9820232391357422
Epoch: 31, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8984248638153076
Epoch: 32, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1574249267578125
Epoch: 33, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.930431604385376
Epoch: 34, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9759862422943115
Epoch: 35, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 36 cost time: 1.0210661888122559
Epoch: 36, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9600014686584473
Epoch: 37, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.968235969543457
Epoch: 38, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0354766845703125
Epoch: 39, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0487229824066162
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.027186632156372
Epoch: 41, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8719253540039062
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.959 Test Loss: 0.139 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7712757587432861
Epoch: 43, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 44 cost time: 0.806535005569458
Epoch: 44, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 45 cost time: 0.7612102031707764
Epoch: 45, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 46 cost time: 0.8059773445129395
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 47 cost time: 1.037205696105957
Epoch: 47, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 48 cost time: 0.9409761428833008
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.959 Test Loss: 0.123 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.077589750289917
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0513908863067627
Epoch: 50, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 51 cost time: 1.0426902770996094
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9051547050476074
Epoch: 52, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.0422296524047852
Epoch: 53, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9995503425598145
Epoch: 54, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 55 cost time: 0.9304101467132568
Epoch: 55, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0222718715667725
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9566664695739746
Epoch: 57, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 58 cost time: 0.9765439033508301
Epoch: 58, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8839061260223389
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 60 cost time: 1.044154405593872
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 61 cost time: 1.0398378372192383
Epoch: 61, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0287301540374756
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9570951461791992
Epoch: 63, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.967567 --> -0.967567).  Saving model ...
Epoch: 64 cost time: 0.956770658493042
Epoch: 64, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8041939735412598
Epoch: 65, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8840148448944092
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.8110470771789551
Epoch: 67, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.8117787837982178
Epoch: 68, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.965 Test Loss: 0.101 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.9225738048553467
Epoch: 69, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.8315451145172119
Epoch: 70, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.967567 --> -0.970269).  Saving model ...
Epoch: 71 cost time: 0.9872853755950928
Epoch: 71, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.9512288570404053
Epoch: 72, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 73 cost time: 0.924680233001709
Epoch: 73, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 74 cost time: 1.065927267074585
Epoch: 74, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 75 cost time: 1.0458288192749023
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 76 cost time: 1.0091946125030518
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9464476108551025
Epoch: 77, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.9787712097167969
Epoch: 78, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.8649370670318604
Epoch: 79, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.9172549247741699
Epoch: 80, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.9322366714477539
Epoch: 81, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.9388303756713867
Epoch: 82, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.8942704200744629
Epoch: 83, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 1.0043799877166748
Epoch: 84, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9454138278961182
Epoch: 85, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 29161
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6369194984436035
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.086 Vali Acc: 0.238 Test Loss: 2.086 Test Acc: 0.238
Validation loss decreased (inf --> -0.237817).  Saving model ...
Epoch: 2 cost time: 0.8628840446472168
Epoch: 2, Steps: 17 | Train Loss: 2.081 Vali Loss: 1.983 Vali Acc: 0.335 Test Loss: 1.983 Test Acc: 0.335
Validation loss decreased (-0.237817 --> -0.335115).  Saving model ...
Epoch: 3 cost time: 0.9388315677642822
Epoch: 3, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.850 Vali Acc: 0.519 Test Loss: 1.850 Test Acc: 0.519
Validation loss decreased (-0.335115 --> -0.518900).  Saving model ...
Epoch: 4 cost time: 0.883014440536499
Epoch: 4, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.704 Vali Acc: 0.708 Test Loss: 1.704 Test Acc: 0.708
Validation loss decreased (-0.518900 --> -0.708091).  Saving model ...
Epoch: 5 cost time: 0.9528303146362305
Epoch: 5, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.557 Vali Acc: 0.773 Test Loss: 1.557 Test Acc: 0.773
Validation loss decreased (-0.708091 --> -0.772957).  Saving model ...
Epoch: 6 cost time: 0.9511744976043701
Epoch: 6, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.396 Vali Acc: 0.803 Test Loss: 1.396 Test Acc: 0.803
Validation loss decreased (-0.772957 --> -0.802689).  Saving model ...
Epoch: 7 cost time: 0.9825129508972168
Epoch: 7, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.248 Vali Acc: 0.832 Test Loss: 1.248 Test Acc: 0.832
Validation loss decreased (-0.802689 --> -0.832420).  Saving model ...
Epoch: 8 cost time: 0.9409308433532715
Epoch: 8, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.104 Vali Acc: 0.843 Test Loss: 1.104 Test Acc: 0.843
Validation loss decreased (-0.832420 --> -0.843232).  Saving model ...
Epoch: 9 cost time: 0.9976532459259033
Epoch: 9, Steps: 17 | Train Loss: 0.990 Vali Loss: 0.986 Vali Acc: 0.868 Test Loss: 0.986 Test Acc: 0.868
Validation loss decreased (-0.843232 --> -0.867558).  Saving model ...
Epoch: 10 cost time: 0.9640452861785889
Epoch: 10, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.872 Vali Acc: 0.881 Test Loss: 0.872 Test Acc: 0.881
Validation loss decreased (-0.867558 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 0.914808988571167
Epoch: 11, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.786 Vali Acc: 0.900 Test Loss: 0.786 Test Acc: 0.900
Validation loss decreased (-0.881072 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 1.040264368057251
Epoch: 12, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 1.0196702480316162
Epoch: 13, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.637 Vali Acc: 0.905 Test Loss: 0.637 Test Acc: 0.905
Validation loss decreased (-0.899993 --> -0.905399).  Saving model ...
Epoch: 14 cost time: 0.9513163566589355
Epoch: 14, Steps: 17 | Train Loss: 0.527 Vali Loss: 0.574 Vali Acc: 0.914 Test Loss: 0.574 Test Acc: 0.914
Validation loss decreased (-0.905399 --> -0.913508).  Saving model ...
Epoch: 15 cost time: 0.9456567764282227
Epoch: 15, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.528 Vali Acc: 0.922 Test Loss: 0.528 Test Acc: 0.922
Validation loss decreased (-0.913508 --> -0.921616).  Saving model ...
Epoch: 16 cost time: 0.9874799251556396
Epoch: 16, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.482 Vali Acc: 0.930 Test Loss: 0.482 Test Acc: 0.930
Validation loss decreased (-0.921616 --> -0.929725).  Saving model ...
Epoch: 17 cost time: 0.9092328548431396
Epoch: 17, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.439 Vali Acc: 0.935 Test Loss: 0.439 Test Acc: 0.935
Validation loss decreased (-0.929725 --> -0.935131).  Saving model ...
Epoch: 18 cost time: 0.9010469913482666
Epoch: 18, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.407 Vali Acc: 0.935 Test Loss: 0.407 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 0.9487345218658447
Epoch: 19, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.380 Vali Acc: 0.932 Test Loss: 0.380 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8791639804840088
Epoch: 20, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.356 Vali Acc: 0.935 Test Loss: 0.356 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935132).  Saving model ...
Epoch: 21 cost time: 0.9678492546081543
Epoch: 21, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.332 Vali Acc: 0.935 Test Loss: 0.332 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 22 cost time: 1.0063753128051758
Epoch: 22, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.935132 --> -0.940537).  Saving model ...
Epoch: 23 cost time: 1.0124521255493164
Epoch: 23, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940538).  Saving model ...
Epoch: 24 cost time: 1.0046260356903076
Epoch: 24, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 25 cost time: 0.9266884326934814
Epoch: 25, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8603274822235107
Epoch: 26, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945943).  Saving model ...
Epoch: 27 cost time: 1.027817726135254
Epoch: 27, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.233 Vali Acc: 0.943 Test Loss: 0.233 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9867417812347412
Epoch: 28, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.224 Vali Acc: 0.946 Test Loss: 0.224 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 29 cost time: 1.012279987335205
Epoch: 29, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.215 Vali Acc: 0.951 Test Loss: 0.215 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 30 cost time: 0.8340580463409424
Epoch: 30, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.205 Vali Acc: 0.951 Test Loss: 0.205 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 31 cost time: 0.8860588073730469
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.196 Vali Acc: 0.954 Test Loss: 0.196 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 32 cost time: 0.8931865692138672
Epoch: 32, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.195 Vali Acc: 0.951 Test Loss: 0.195 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9217607975006104
Epoch: 33, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 0.9638705253601074
Epoch: 34, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.180 Vali Acc: 0.949 Test Loss: 0.180 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.994131326675415
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 36 cost time: 0.9293806552886963
Epoch: 36, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 37 cost time: 0.9414446353912354
Epoch: 37, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9657034873962402
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.160 Vali Acc: 0.954 Test Loss: 0.160 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0057964324951172
Epoch: 39, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.966317892074585
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0047082901000977
Epoch: 41, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.145 Vali Acc: 0.959 Test Loss: 0.145 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 42 cost time: 0.9702472686767578
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0500197410583496
Epoch: 43, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0593080520629883
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0154476165771484
Epoch: 45, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 1.1007797718048096
Epoch: 46, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.959 Test Loss: 0.130 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 47 cost time: 0.9966051578521729
Epoch: 47, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 48 cost time: 0.9594204425811768
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 49 cost time: 1.0485308170318604
Epoch: 49, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 50 cost time: 0.9376072883605957
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.00136137008667
Epoch: 51, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 52 cost time: 1.03531813621521
Epoch: 52, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 53 cost time: 1.1556460857391357
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.1323158740997314
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0946307182312012
Epoch: 55, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.968 Test Loss: 0.114 Test Acc: 0.968
Validation loss decreased (-0.964864 --> -0.967566).  Saving model ...
Epoch: 56 cost time: 1.0622053146362305
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.112 Vali Acc: 0.968 Test Loss: 0.112 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 57 cost time: 0.934032678604126
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.115 Vali Acc: 0.957 Test Loss: 0.115 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8768393993377686
Epoch: 58, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9284403324127197
Epoch: 59, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9864950180053711
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.96372389793396
Epoch: 61, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.962 Test Loss: 0.105 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9021072387695312
Epoch: 62, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0786075592041016
Epoch: 63, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.965 Test Loss: 0.102 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9650347232818604
Epoch: 64, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.0191617012023926
Epoch: 65, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0766477584838867
Epoch: 66, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 29161
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.62781023979187
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.096 Vali Acc: 0.241 Test Loss: 2.096 Test Acc: 0.241
Validation loss decreased (inf --> -0.240520).  Saving model ...
Epoch: 2 cost time: 0.9710574150085449
Epoch: 2, Steps: 17 | Train Loss: 2.079 Vali Loss: 1.996 Vali Acc: 0.357 Test Loss: 1.996 Test Acc: 0.357
Validation loss decreased (-0.240520 --> -0.356737).  Saving model ...
Epoch: 3 cost time: 0.890791654586792
Epoch: 3, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.869 Vali Acc: 0.516 Test Loss: 1.869 Test Acc: 0.516
Validation loss decreased (-0.356737 --> -0.516198).  Saving model ...
Epoch: 4 cost time: 0.9294335842132568
Epoch: 4, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.727 Vali Acc: 0.719 Test Loss: 1.727 Test Acc: 0.719
Validation loss decreased (-0.516198 --> -0.718902).  Saving model ...
Epoch: 5 cost time: 0.9309771060943604
Epoch: 5, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.584 Vali Acc: 0.778 Test Loss: 1.584 Test Acc: 0.778
Validation loss decreased (-0.718902 --> -0.778363).  Saving model ...
Epoch: 6 cost time: 0.9016320705413818
Epoch: 6, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.427 Vali Acc: 0.816 Test Loss: 1.427 Test Acc: 0.816
Validation loss decreased (-0.778363 --> -0.816202).  Saving model ...
Epoch: 7 cost time: 0.9656081199645996
Epoch: 7, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.283 Vali Acc: 0.830 Test Loss: 1.283 Test Acc: 0.830
Validation loss decreased (-0.816202 --> -0.829717).  Saving model ...
Epoch: 8 cost time: 0.9765756130218506
Epoch: 8, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.142 Vali Acc: 0.859 Test Loss: 1.142 Test Acc: 0.859
Validation loss decreased (-0.829717 --> -0.859448).  Saving model ...
Epoch: 9 cost time: 1.0374202728271484
Epoch: 9, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.023 Vali Acc: 0.876 Test Loss: 1.023 Test Acc: 0.876
Validation loss decreased (-0.859448 --> -0.875665).  Saving model ...
Epoch: 10 cost time: 1.0146145820617676
Epoch: 10, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.908 Vali Acc: 0.881 Test Loss: 0.908 Test Acc: 0.881
Validation loss decreased (-0.875665 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 0.9309382438659668
Epoch: 11, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.818 Vali Acc: 0.895 Test Loss: 0.818 Test Acc: 0.895
Validation loss decreased (-0.881072 --> -0.894586).  Saving model ...
Epoch: 12 cost time: 0.8862743377685547
Epoch: 12, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.731 Vali Acc: 0.905 Test Loss: 0.731 Test Acc: 0.905
Validation loss decreased (-0.894586 --> -0.905398).  Saving model ...
Epoch: 13 cost time: 0.8331565856933594
Epoch: 13, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.662 Vali Acc: 0.908 Test Loss: 0.662 Test Acc: 0.908
Validation loss decreased (-0.905398 --> -0.908101).  Saving model ...
Epoch: 14 cost time: 0.8879716396331787
Epoch: 14, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.598 Vali Acc: 0.919 Test Loss: 0.598 Test Acc: 0.919
Validation loss decreased (-0.908101 --> -0.918913).  Saving model ...
Epoch: 15 cost time: 0.7658734321594238
Epoch: 15, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.548 Vali Acc: 0.914 Test Loss: 0.548 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8422443866729736
Epoch: 16, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
Validation loss decreased (-0.918913 --> -0.921617).  Saving model ...
Epoch: 17 cost time: 0.9918127059936523
Epoch: 17, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.456 Vali Acc: 0.922 Test Loss: 0.456 Test Acc: 0.922
Validation loss decreased (-0.921617 --> -0.921617).  Saving model ...
Epoch: 18 cost time: 0.8514115810394287
Epoch: 18, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.420 Vali Acc: 0.932 Test Loss: 0.420 Test Acc: 0.932
Validation loss decreased (-0.921617 --> -0.932428).  Saving model ...
Epoch: 19 cost time: 0.9736676216125488
Epoch: 19, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.392 Vali Acc: 0.930 Test Loss: 0.392 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0204224586486816
Epoch: 20, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.368 Vali Acc: 0.938 Test Loss: 0.368 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 21 cost time: 0.9950771331787109
Epoch: 21, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.342 Vali Acc: 0.946 Test Loss: 0.342 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 0.9253764152526855
Epoch: 22, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9321873188018799
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.295 Vali Acc: 0.943 Test Loss: 0.295 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8640742301940918
Epoch: 24, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.276 Vali Acc: 0.949 Test Loss: 0.276 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 25 cost time: 0.8653945922851562
Epoch: 25, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.266 Vali Acc: 0.949 Test Loss: 0.266 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 0.9142141342163086
Epoch: 26, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.252 Vali Acc: 0.949 Test Loss: 0.252 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 27 cost time: 0.9340922832489014
Epoch: 27, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.851041316986084
Epoch: 28, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948646).  Saving model ...
Epoch: 29 cost time: 0.9058911800384521
Epoch: 29, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.911684513092041
Epoch: 30, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.214 Vali Acc: 0.949 Test Loss: 0.214 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 31 cost time: 0.9506356716156006
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954052).  Saving model ...
Epoch: 32 cost time: 0.9574601650238037
Epoch: 32, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 33 cost time: 0.9628279209136963
Epoch: 33, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 34 cost time: 1.0107550621032715
Epoch: 34, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8812382221221924
Epoch: 35, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9620077610015869
Epoch: 36, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9251198768615723
Epoch: 37, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.171 Vali Acc: 0.954 Test Loss: 0.171 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 0.9281632900238037
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8830552101135254
Epoch: 39, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.162 Vali Acc: 0.949 Test Loss: 0.162 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8805580139160156
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.165 Vali Acc: 0.946 Test Loss: 0.165 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8276510238647461
Epoch: 41, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 42 cost time: 0.969721794128418
Epoch: 42, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 43 cost time: 0.9469244480133057
Epoch: 43, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 44 cost time: 1.0295305252075195
Epoch: 44, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
Validation loss decreased (-0.954053 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 0.9235553741455078
Epoch: 45, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9978406429290771
Epoch: 46, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.956755 --> -0.962161).  Saving model ...
Epoch: 47 cost time: 0.9693794250488281
Epoch: 47, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8565618991851807
Epoch: 48, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9790060520172119
Epoch: 49, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.951 Test Loss: 0.136 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9202210903167725
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8963007926940918
Epoch: 51, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.951 Test Loss: 0.131 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9246735572814941
Epoch: 52, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8468031883239746
Epoch: 53, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.808427095413208
Epoch: 54, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8893117904663086
Epoch: 55, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.954 Test Loss: 0.121 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9642739295959473
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.957 Test Loss: 0.118 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 29161
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5089640617370605
Epoch: 1, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.120 Vali Acc: 0.200 Test Loss: 2.120 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 0.8964521884918213
Epoch: 2, Steps: 17 | Train Loss: 2.085 Vali Loss: 2.032 Vali Acc: 0.341 Test Loss: 2.032 Test Acc: 0.341
Validation loss decreased (-0.199979 --> -0.340520).  Saving model ...
Epoch: 3 cost time: 0.8823208808898926
Epoch: 3, Steps: 17 | Train Loss: 1.996 Vali Loss: 1.920 Vali Acc: 0.546 Test Loss: 1.920 Test Acc: 0.546
Validation loss decreased (-0.340520 --> -0.545927).  Saving model ...
Epoch: 4 cost time: 0.8731546401977539
Epoch: 4, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.792 Vali Acc: 0.751 Test Loss: 1.792 Test Acc: 0.751
Validation loss decreased (-0.545927 --> -0.751333).  Saving model ...
Epoch: 5 cost time: 0.9911949634552002
Epoch: 5, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.662 Vali Acc: 0.792 Test Loss: 1.662 Test Acc: 0.792
Validation loss decreased (-0.751333 --> -0.791875).  Saving model ...
Epoch: 6 cost time: 0.9712629318237305
Epoch: 6, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.521 Vali Acc: 0.835 Test Loss: 1.521 Test Acc: 0.835
Validation loss decreased (-0.791875 --> -0.835120).  Saving model ...
Epoch: 7 cost time: 0.9811446666717529
Epoch: 7, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.388 Vali Acc: 0.843 Test Loss: 1.388 Test Acc: 0.843
Validation loss decreased (-0.835120 --> -0.843229).  Saving model ...
Epoch: 8 cost time: 0.8884754180908203
Epoch: 8, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.250 Vali Acc: 0.865 Test Loss: 1.250 Test Acc: 0.865
Validation loss decreased (-0.843229 --> -0.864852).  Saving model ...
Epoch: 9 cost time: 0.949596643447876
Epoch: 9, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.131 Vali Acc: 0.873 Test Loss: 1.131 Test Acc: 0.873
Validation loss decreased (-0.864852 --> -0.872962).  Saving model ...
Epoch: 10 cost time: 0.8932337760925293
Epoch: 10, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.012 Vali Acc: 0.886 Test Loss: 1.012 Test Acc: 0.886
Validation loss decreased (-0.872962 --> -0.886476).  Saving model ...
Epoch: 11 cost time: 0.9397244453430176
Epoch: 11, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.917 Vali Acc: 0.886 Test Loss: 0.917 Test Acc: 0.886
Validation loss decreased (-0.886476 --> -0.886477).  Saving model ...
Epoch: 12 cost time: 0.9559812545776367
Epoch: 12, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.823 Vali Acc: 0.889 Test Loss: 0.823 Test Acc: 0.889
Validation loss decreased (-0.886477 --> -0.889181).  Saving model ...
Epoch: 13 cost time: 0.9402709007263184
Epoch: 13, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.743 Vali Acc: 0.889 Test Loss: 0.743 Test Acc: 0.889
Validation loss decreased (-0.889181 --> -0.889182).  Saving model ...
Epoch: 14 cost time: 0.9743103981018066
Epoch: 14, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.670 Vali Acc: 0.895 Test Loss: 0.670 Test Acc: 0.895
Validation loss decreased (-0.889182 --> -0.894588).  Saving model ...
Epoch: 15 cost time: 0.8999574184417725
Epoch: 15, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.612 Vali Acc: 0.903 Test Loss: 0.612 Test Acc: 0.903
Validation loss decreased (-0.894588 --> -0.902697).  Saving model ...
Epoch: 16 cost time: 0.9106483459472656
Epoch: 16, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.560 Vali Acc: 0.905 Test Loss: 0.560 Test Acc: 0.905
Validation loss decreased (-0.902697 --> -0.905400).  Saving model ...
Epoch: 17 cost time: 0.9116287231445312
Epoch: 17, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.507 Vali Acc: 0.919 Test Loss: 0.507 Test Acc: 0.919
Validation loss decreased (-0.905400 --> -0.918914).  Saving model ...
Epoch: 18 cost time: 0.940800666809082
Epoch: 18, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.467 Vali Acc: 0.924 Test Loss: 0.467 Test Acc: 0.924
Validation loss decreased (-0.918914 --> -0.924320).  Saving model ...
Epoch: 19 cost time: 0.9344615936279297
Epoch: 19, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.433 Vali Acc: 0.927 Test Loss: 0.433 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 20 cost time: 0.8698158264160156
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.404 Vali Acc: 0.932 Test Loss: 0.404 Test Acc: 0.932
Validation loss decreased (-0.927023 --> -0.932428).  Saving model ...
Epoch: 21 cost time: 0.9171557426452637
Epoch: 21, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.941129207611084
Epoch: 22, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.354 Vali Acc: 0.927 Test Loss: 0.354 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8964419364929199
Epoch: 23, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.329 Vali Acc: 0.935 Test Loss: 0.329 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935132).  Saving model ...
Epoch: 24 cost time: 0.9457409381866455
Epoch: 24, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.309 Vali Acc: 0.935 Test Loss: 0.309 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 25 cost time: 1.0331556797027588
Epoch: 25, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.298 Vali Acc: 0.938 Test Loss: 0.298 Test Acc: 0.938
Validation loss decreased (-0.935132 --> -0.937835).  Saving model ...
Epoch: 26 cost time: 0.8649046421051025
Epoch: 26, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 27 cost time: 1.0085065364837646
Epoch: 27, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 28 cost time: 0.9154112339019775
Epoch: 28, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 29 cost time: 0.9443478584289551
Epoch: 29, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.243 Vali Acc: 0.943 Test Loss: 0.243 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 30 cost time: 0.9511849880218506
Epoch: 30, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.233 Vali Acc: 0.949 Test Loss: 0.233 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948646).  Saving model ...
Epoch: 31 cost time: 0.9359612464904785
Epoch: 31, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.221 Vali Acc: 0.946 Test Loss: 0.221 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.010101079940796
Epoch: 32, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9154949188232422
Epoch: 33, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.209 Vali Acc: 0.946 Test Loss: 0.209 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8698179721832275
Epoch: 34, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 35 cost time: 0.8910212516784668
Epoch: 35, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9386208057403564
Epoch: 36, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.189 Vali Acc: 0.949 Test Loss: 0.189 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8201930522918701
Epoch: 37, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.185 Vali Acc: 0.949 Test Loss: 0.185 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9937832355499268
Epoch: 38, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951350).  Saving model ...
Epoch: 39 cost time: 0.8426024913787842
Epoch: 39, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 40 cost time: 1.0211162567138672
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.181 Vali Acc: 0.946 Test Loss: 0.181 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8846189975738525
Epoch: 41, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.962275505065918
Epoch: 42, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.912489652633667
Epoch: 43, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 44 cost time: 0.8878006935119629
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 45 cost time: 0.9820272922515869
Epoch: 45, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 0.8865883350372314
Epoch: 46, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8713951110839844
Epoch: 47, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 48 cost time: 0.8972620964050293
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 49 cost time: 0.9924871921539307
Epoch: 49, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9134185314178467
Epoch: 50, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0062685012817383
Epoch: 51, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.959 Test Loss: 0.149 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 52 cost time: 0.9428565502166748
Epoch: 52, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 53 cost time: 1.0188090801239014
Epoch: 53, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 54 cost time: 0.9223718643188477
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.951 Test Loss: 0.142 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.819242000579834
Epoch: 55, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8799915313720703
Epoch: 56, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.959 Test Loss: 0.136 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8235070705413818
Epoch: 57, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.957 Test Loss: 0.140 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0442230701446533
Epoch: 58, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.892937183380127
Epoch: 59, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9369895458221436
Epoch: 60, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9465081691741943
Epoch: 61, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.133 Vali Acc: 0.957 Test Loss: 0.133 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9425754547119141
Epoch: 62, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.957 Test Loss: 0.129 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.923539400100708
Epoch: 63, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 29161
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6754369735717773
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.182 Vali Acc: 0.186 Test Loss: 2.182 Test Acc: 0.186
Validation loss decreased (inf --> -0.186465).  Saving model ...
Epoch: 2 cost time: 1.0762686729431152
Epoch: 2, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.060 Vali Acc: 0.254 Test Loss: 2.060 Test Acc: 0.254
Validation loss decreased (-0.186465 --> -0.254033).  Saving model ...
Epoch: 3 cost time: 1.0156583786010742
Epoch: 3, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.910 Vali Acc: 0.441 Test Loss: 1.910 Test Acc: 0.441
Validation loss decreased (-0.254033 --> -0.440521).  Saving model ...
Epoch: 4 cost time: 0.9140193462371826
Epoch: 4, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.745 Vali Acc: 0.635 Test Loss: 1.745 Test Acc: 0.635
Validation loss decreased (-0.440521 --> -0.635118).  Saving model ...
Epoch: 5 cost time: 0.8898029327392578
Epoch: 5, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.570 Vali Acc: 0.732 Test Loss: 1.570 Test Acc: 0.732
Validation loss decreased (-0.635118 --> -0.732417).  Saving model ...
Epoch: 6 cost time: 0.9791355133056641
Epoch: 6, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.405 Vali Acc: 0.784 Test Loss: 1.405 Test Acc: 0.784
Validation loss decreased (-0.732417 --> -0.783770).  Saving model ...
Epoch: 7 cost time: 0.9921748638153076
Epoch: 7, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.249 Vali Acc: 0.808 Test Loss: 1.249 Test Acc: 0.808
Validation loss decreased (-0.783770 --> -0.808096).  Saving model ...
Epoch: 8 cost time: 0.9676260948181152
Epoch: 8, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.103 Vali Acc: 0.827 Test Loss: 1.103 Test Acc: 0.827
Validation loss decreased (-0.808096 --> -0.827016).  Saving model ...
Epoch: 9 cost time: 0.9666430950164795
Epoch: 9, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.977 Vali Acc: 0.859 Test Loss: 0.977 Test Acc: 0.859
Validation loss decreased (-0.827016 --> -0.859450).  Saving model ...
Epoch: 10 cost time: 0.977123498916626
Epoch: 10, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
Validation loss decreased (-0.859450 --> -0.870262).  Saving model ...
Epoch: 11 cost time: 0.9408462047576904
Epoch: 11, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.775 Vali Acc: 0.884 Test Loss: 0.775 Test Acc: 0.884
Validation loss decreased (-0.870262 --> -0.883776).  Saving model ...
Epoch: 12 cost time: 0.9538652896881104
Epoch: 12, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.695 Vali Acc: 0.892 Test Loss: 0.695 Test Acc: 0.892
Validation loss decreased (-0.883776 --> -0.891885).  Saving model ...
Epoch: 13 cost time: 0.9568653106689453
Epoch: 13, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.626 Vali Acc: 0.889 Test Loss: 0.626 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9368481636047363
Epoch: 14, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.565 Vali Acc: 0.897 Test Loss: 0.565 Test Acc: 0.897
Validation loss decreased (-0.891885 --> -0.897292).  Saving model ...
Epoch: 15 cost time: 0.9928572177886963
Epoch: 15, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.514 Vali Acc: 0.905 Test Loss: 0.514 Test Acc: 0.905
Validation loss decreased (-0.897292 --> -0.905400).  Saving model ...
Epoch: 16 cost time: 0.9467148780822754
Epoch: 16, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.473 Vali Acc: 0.914 Test Loss: 0.473 Test Acc: 0.914
Validation loss decreased (-0.905400 --> -0.913509).  Saving model ...
Epoch: 17 cost time: 1.0036497116088867
Epoch: 17, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
Validation loss decreased (-0.913509 --> -0.929725).  Saving model ...
Epoch: 18 cost time: 0.8592946529388428
Epoch: 18, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.401 Vali Acc: 0.930 Test Loss: 0.401 Test Acc: 0.930
Validation loss decreased (-0.929725 --> -0.929726).  Saving model ...
Epoch: 19 cost time: 0.9974021911621094
Epoch: 19, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.374 Vali Acc: 0.935 Test Loss: 0.374 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935131).  Saving model ...
Epoch: 20 cost time: 1.0627248287200928
Epoch: 20, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.346 Vali Acc: 0.943 Test Loss: 0.346 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 0.9964165687561035
Epoch: 21, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.321 Vali Acc: 0.946 Test Loss: 0.321 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 0.9507215023040771
Epoch: 22, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.299 Vali Acc: 0.943 Test Loss: 0.299 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9214253425598145
Epoch: 23, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.285 Vali Acc: 0.949 Test Loss: 0.285 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 24 cost time: 1.0128986835479736
Epoch: 24, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.275 Vali Acc: 0.951 Test Loss: 0.275 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 25 cost time: 0.9367961883544922
Epoch: 25, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.256 Vali Acc: 0.949 Test Loss: 0.256 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9176552295684814
Epoch: 26, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.242 Vali Acc: 0.954 Test Loss: 0.242 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 0.9692468643188477
Epoch: 27, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.224 Vali Acc: 0.951 Test Loss: 0.224 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9947566986083984
Epoch: 28, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 0.8964364528656006
Epoch: 29, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 30 cost time: 0.946807861328125
Epoch: 30, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.199 Vali Acc: 0.962 Test Loss: 0.199 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 31 cost time: 1.0314171314239502
Epoch: 31, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 32 cost time: 1.0077297687530518
Epoch: 32, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 33 cost time: 0.9501206874847412
Epoch: 33, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 34 cost time: 0.9445199966430664
Epoch: 34, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 35 cost time: 0.9737818241119385
Epoch: 35, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 36 cost time: 0.9778091907501221
Epoch: 36, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 37 cost time: 0.9326217174530029
Epoch: 37, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 38 cost time: 0.9543743133544922
Epoch: 38, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 39 cost time: 0.9655258655548096
Epoch: 39, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 40 cost time: 0.9442040920257568
Epoch: 40, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9747970104217529
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 42 cost time: 0.8936777114868164
Epoch: 42, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 43 cost time: 0.9547863006591797
Epoch: 43, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9618301391601562
Epoch: 44, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.004763126373291
Epoch: 45, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 0.9645824432373047
Epoch: 46, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 0.9716792106628418
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9653985500335693
Epoch: 48, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9443726539611816
Epoch: 49, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9482462406158447
Epoch: 50, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9671058654785156
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8985657691955566
Epoch: 52, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.119 Vali Acc: 0.959 Test Loss: 0.119 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8643684387207031
Epoch: 53, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9139800071716309
Epoch: 54, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.962 Test Loss: 0.113 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8955318927764893
Epoch: 55, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8805437088012695
Epoch: 56, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.970269 --> -0.975675).  Saving model ...
Epoch: 57 cost time: 0.9544031620025635
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9566409587860107
Epoch: 58, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9475343227386475
Epoch: 59, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.919187068939209
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.962 Test Loss: 0.110 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8674964904785156
Epoch: 61, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9668333530426025
Epoch: 62, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.104 Vali Acc: 0.962 Test Loss: 0.104 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9287235736846924
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9116454124450684
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.959 Test Loss: 0.110 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.9176859855651855
Epoch: 65, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.9466290473937988
Epoch: 66, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9756756756756757
model parameter : 20969
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6424601078033447
Epoch: 1, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.182 Vali Acc: 0.154 Test Loss: 2.182 Test Acc: 0.154
Validation loss decreased (inf --> -0.154032).  Saving model ...
Epoch: 2 cost time: 0.8741683959960938
Epoch: 2, Steps: 17 | Train Loss: 2.102 Vali Loss: 2.063 Vali Acc: 0.241 Test Loss: 2.063 Test Acc: 0.241
Validation loss decreased (-0.154032 --> -0.240520).  Saving model ...
Epoch: 3 cost time: 0.9291048049926758
Epoch: 3, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.914 Vali Acc: 0.443 Test Loss: 1.914 Test Acc: 0.443
Validation loss decreased (-0.240520 --> -0.443224).  Saving model ...
Epoch: 4 cost time: 0.8805954456329346
Epoch: 4, Steps: 17 | Train Loss: 1.793 Vali Loss: 1.752 Vali Acc: 0.619 Test Loss: 1.752 Test Acc: 0.619
Validation loss decreased (-0.443224 --> -0.618901).  Saving model ...
Epoch: 5 cost time: 0.9251124858856201
Epoch: 5, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.579 Vali Acc: 0.727 Test Loss: 1.579 Test Acc: 0.727
Validation loss decreased (-0.618901 --> -0.727011).  Saving model ...
Epoch: 6 cost time: 0.9115588665008545
Epoch: 6, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.415 Vali Acc: 0.786 Test Loss: 1.415 Test Acc: 0.786
Validation loss decreased (-0.727011 --> -0.786472).  Saving model ...
Epoch: 7 cost time: 0.8642702102661133
Epoch: 7, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.261 Vali Acc: 0.805 Test Loss: 1.261 Test Acc: 0.805
Validation loss decreased (-0.786472 --> -0.805393).  Saving model ...
Epoch: 8 cost time: 0.9649269580841064
Epoch: 8, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.117 Vali Acc: 0.832 Test Loss: 1.117 Test Acc: 0.832
Validation loss decreased (-0.805393 --> -0.832421).  Saving model ...
Epoch: 9 cost time: 0.942319393157959
Epoch: 9, Steps: 17 | Train Loss: 0.980 Vali Loss: 0.990 Vali Acc: 0.851 Test Loss: 0.990 Test Acc: 0.851
Validation loss decreased (-0.832421 --> -0.851341).  Saving model ...
Epoch: 10 cost time: 0.9359705448150635
Epoch: 10, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.886 Vali Acc: 0.870 Test Loss: 0.886 Test Acc: 0.870
Validation loss decreased (-0.851341 --> -0.870261).  Saving model ...
Epoch: 11 cost time: 0.916595458984375
Epoch: 11, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
Validation loss decreased (-0.870261 --> -0.878370).  Saving model ...
Epoch: 12 cost time: 0.9869542121887207
Epoch: 12, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.709 Vali Acc: 0.884 Test Loss: 0.709 Test Acc: 0.884
Validation loss decreased (-0.878370 --> -0.883777).  Saving model ...
Epoch: 13 cost time: 0.8810708522796631
Epoch: 13, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.640 Vali Acc: 0.886 Test Loss: 0.640 Test Acc: 0.886
Validation loss decreased (-0.883777 --> -0.886480).  Saving model ...
Epoch: 14 cost time: 0.8998322486877441
Epoch: 14, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.578 Vali Acc: 0.895 Test Loss: 0.578 Test Acc: 0.895
Validation loss decreased (-0.886480 --> -0.894589).  Saving model ...
Epoch: 15 cost time: 0.8449263572692871
Epoch: 15, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.526 Vali Acc: 0.908 Test Loss: 0.526 Test Acc: 0.908
Validation loss decreased (-0.894589 --> -0.908103).  Saving model ...
Epoch: 16 cost time: 0.8271536827087402
Epoch: 16, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.483 Vali Acc: 0.914 Test Loss: 0.483 Test Acc: 0.914
Validation loss decreased (-0.908103 --> -0.913509).  Saving model ...
Epoch: 17 cost time: 0.8832497596740723
Epoch: 17, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.437 Vali Acc: 0.932 Test Loss: 0.437 Test Acc: 0.932
Validation loss decreased (-0.913509 --> -0.932428).  Saving model ...
Epoch: 18 cost time: 0.8559303283691406
Epoch: 18, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.409 Vali Acc: 0.932 Test Loss: 0.409 Test Acc: 0.932
Validation loss decreased (-0.932428 --> -0.932428).  Saving model ...
Epoch: 19 cost time: 0.8287777900695801
Epoch: 19, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.382 Vali Acc: 0.935 Test Loss: 0.382 Test Acc: 0.935
Validation loss decreased (-0.932428 --> -0.935131).  Saving model ...
Epoch: 20 cost time: 0.8862643241882324
Epoch: 20, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.354 Vali Acc: 0.932 Test Loss: 0.354 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0490717887878418
Epoch: 21, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.327 Vali Acc: 0.938 Test Loss: 0.327 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937835).  Saving model ...
Epoch: 22 cost time: 0.9188094139099121
Epoch: 22, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.304 Vali Acc: 0.938 Test Loss: 0.304 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937835).  Saving model ...
Epoch: 23 cost time: 1.013456106185913
Epoch: 23, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.289 Vali Acc: 0.946 Test Loss: 0.289 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945943).  Saving model ...
Epoch: 24 cost time: 1.0650362968444824
Epoch: 24, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.278 Vali Acc: 0.954 Test Loss: 0.278 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954051).  Saving model ...
Epoch: 25 cost time: 1.063608169555664
Epoch: 25, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.260 Vali Acc: 0.946 Test Loss: 0.260 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0115611553192139
Epoch: 26, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.246 Vali Acc: 0.954 Test Loss: 0.246 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 27 cost time: 0.9486801624298096
Epoch: 27, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.226 Vali Acc: 0.954 Test Loss: 0.226 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 28 cost time: 0.9654011726379395
Epoch: 28, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 29 cost time: 0.9340879917144775
Epoch: 29, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.214 Vali Acc: 0.954 Test Loss: 0.214 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9350061416625977
Epoch: 30, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959457).  Saving model ...
Epoch: 31 cost time: 0.9330523014068604
Epoch: 31, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.190 Vali Acc: 0.959 Test Loss: 0.190 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 32 cost time: 0.9914975166320801
Epoch: 32, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 33 cost time: 0.9411716461181641
Epoch: 33, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964863).  Saving model ...
Epoch: 34 cost time: 0.8778831958770752
Epoch: 34, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9860384464263916
Epoch: 35, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 36 cost time: 1.0499095916748047
Epoch: 36, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 37 cost time: 1.033172607421875
Epoch: 37, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 38 cost time: 0.8954823017120361
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 39 cost time: 0.8926835060119629
Epoch: 39, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 40 cost time: 0.8983376026153564
Epoch: 40, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.782296895980835
Epoch: 41, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9608266353607178
Epoch: 42, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.965 Test Loss: 0.138 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0266823768615723
Epoch: 43, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9653191566467285
Epoch: 44, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 45 cost time: 0.9195685386657715
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 46 cost time: 1.0119714736938477
Epoch: 46, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.123 Vali Acc: 0.968 Test Loss: 0.123 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 47 cost time: 0.9944922924041748
Epoch: 47, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 48 cost time: 0.9343235492706299
Epoch: 48, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0112972259521484
Epoch: 49, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9503293037414551
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.919574499130249
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0401053428649902
Epoch: 52, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9434051513671875
Epoch: 53, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9090361595153809
Epoch: 54, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.9441859722137451
Epoch: 55, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.962 Test Loss: 0.107 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9162538051605225
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967567).  Saving model ...
Epoch: 57 cost time: 0.8859658241271973
Epoch: 57, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9154746532440186
Epoch: 58, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9627299308776855
Epoch: 59, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.040473222732544
Epoch: 60, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9038395881652832
Epoch: 61, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.967567 --> -0.972972).  Saving model ...
Epoch: 62 cost time: 0.8928956985473633
Epoch: 62, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9628486633300781
Epoch: 63, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.959 Test Loss: 0.109 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.8740730285644531
Epoch: 64, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.962 Test Loss: 0.109 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.9765200614929199
Epoch: 65, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.9103314876556396
Epoch: 66, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.954521656036377
Epoch: 67, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.9673011302947998
Epoch: 68, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.8330378532409668
Epoch: 69, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.8803675174713135
Epoch: 70, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.8703165054321289
Epoch: 71, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.962 Test Loss: 0.100 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 20969
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.757913827896118
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.172 Vali Acc: 0.178 Test Loss: 2.172 Test Acc: 0.178
Validation loss decreased (inf --> -0.178357).  Saving model ...
Epoch: 2 cost time: 0.9471287727355957
Epoch: 2, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.060 Vali Acc: 0.257 Test Loss: 2.060 Test Acc: 0.257
Validation loss decreased (-0.178357 --> -0.256736).  Saving model ...
Epoch: 3 cost time: 1.0134944915771484
Epoch: 3, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.922 Vali Acc: 0.430 Test Loss: 1.922 Test Acc: 0.430
Validation loss decreased (-0.256736 --> -0.429711).  Saving model ...
Epoch: 4 cost time: 0.9630129337310791
Epoch: 4, Steps: 17 | Train Loss: 1.800 Vali Loss: 1.768 Vali Acc: 0.600 Test Loss: 1.768 Test Acc: 0.600
Validation loss decreased (-0.429711 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 0.8619158267974854
Epoch: 5, Steps: 17 | Train Loss: 1.640 Vali Loss: 1.602 Vali Acc: 0.735 Test Loss: 1.602 Test Acc: 0.735
Validation loss decreased (-0.599982 --> -0.735119).  Saving model ...
Epoch: 6 cost time: 0.9606025218963623
Epoch: 6, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.442 Vali Acc: 0.778 Test Loss: 1.442 Test Acc: 0.778
Validation loss decreased (-0.735119 --> -0.778364).  Saving model ...
Epoch: 7 cost time: 0.9836938381195068
Epoch: 7, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.291 Vali Acc: 0.819 Test Loss: 1.291 Test Acc: 0.819
Validation loss decreased (-0.778364 --> -0.818906).  Saving model ...
Epoch: 8 cost time: 1.0133154392242432
Epoch: 8, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.149 Vali Acc: 0.835 Test Loss: 1.149 Test Acc: 0.835
Validation loss decreased (-0.818906 --> -0.835124).  Saving model ...
Epoch: 9 cost time: 1.0138895511627197
Epoch: 9, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.021 Vali Acc: 0.865 Test Loss: 1.021 Test Acc: 0.865
Validation loss decreased (-0.835124 --> -0.864855).  Saving model ...
Epoch: 10 cost time: 1.0038063526153564
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.916 Vali Acc: 0.870 Test Loss: 0.916 Test Acc: 0.870
Validation loss decreased (-0.864855 --> -0.870261).  Saving model ...
Epoch: 11 cost time: 0.9894394874572754
Epoch: 11, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.817 Vali Acc: 0.878 Test Loss: 0.817 Test Acc: 0.878
Validation loss decreased (-0.870261 --> -0.878370).  Saving model ...
Epoch: 12 cost time: 0.9970550537109375
Epoch: 12, Steps: 17 | Train Loss: 0.696 Vali Loss: 0.735 Vali Acc: 0.881 Test Loss: 0.735 Test Acc: 0.881
Validation loss decreased (-0.878370 --> -0.881074).  Saving model ...
Epoch: 13 cost time: 0.9874942302703857
Epoch: 13, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.663 Vali Acc: 0.881 Test Loss: 0.663 Test Acc: 0.881
Validation loss decreased (-0.881074 --> -0.881074).  Saving model ...
Epoch: 14 cost time: 1.0034093856811523
Epoch: 14, Steps: 17 | Train Loss: 0.547 Vali Loss: 0.600 Vali Acc: 0.895 Test Loss: 0.600 Test Acc: 0.895
Validation loss decreased (-0.881074 --> -0.894589).  Saving model ...
Epoch: 15 cost time: 0.9496865272521973
Epoch: 15, Steps: 17 | Train Loss: 0.496 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.894589 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 1.011254072189331
Epoch: 16, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.499 Vali Acc: 0.911 Test Loss: 0.499 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.910806).  Saving model ...
Epoch: 17 cost time: 1.084726333618164
Epoch: 17, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.452 Vali Acc: 0.924 Test Loss: 0.452 Test Acc: 0.924
Validation loss decreased (-0.910806 --> -0.924320).  Saving model ...
Epoch: 18 cost time: 0.9998414516448975
Epoch: 18, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.420 Vali Acc: 0.927 Test Loss: 0.420 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 19 cost time: 1.0330381393432617
Epoch: 19, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.393 Vali Acc: 0.930 Test Loss: 0.393 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 20 cost time: 0.877723217010498
Epoch: 20, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.361 Vali Acc: 0.938 Test Loss: 0.361 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937834).  Saving model ...
Epoch: 21 cost time: 0.9356715679168701
Epoch: 21, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.336 Vali Acc: 0.938 Test Loss: 0.336 Test Acc: 0.938
Validation loss decreased (-0.937834 --> -0.937834).  Saving model ...
Epoch: 22 cost time: 1.0087990760803223
Epoch: 22, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.314 Vali Acc: 0.946 Test Loss: 0.314 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 23 cost time: 0.9589946269989014
Epoch: 23, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.298 Vali Acc: 0.943 Test Loss: 0.298 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.906254768371582
Epoch: 24, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.284 Vali Acc: 0.946 Test Loss: 0.284 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 25 cost time: 0.9011480808258057
Epoch: 25, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.265 Vali Acc: 0.949 Test Loss: 0.265 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 26 cost time: 0.9686555862426758
Epoch: 26, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.251 Vali Acc: 0.951 Test Loss: 0.251 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 27 cost time: 0.9441134929656982
Epoch: 27, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.232 Vali Acc: 0.951 Test Loss: 0.232 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 0.9910538196563721
Epoch: 28, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
Validation loss decreased (-0.951349 --> -0.951349).  Saving model ...
Epoch: 29 cost time: 1.043534755706787
Epoch: 29, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.216 Vali Acc: 0.957 Test Loss: 0.216 Test Acc: 0.957
Validation loss decreased (-0.951349 --> -0.956755).  Saving model ...
Epoch: 30 cost time: 0.9644825458526611
Epoch: 30, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.203 Vali Acc: 0.968 Test Loss: 0.203 Test Acc: 0.968
Validation loss decreased (-0.956755 --> -0.967566).  Saving model ...
Epoch: 31 cost time: 0.9653615951538086
Epoch: 31, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9587829113006592
Epoch: 32, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.189 Vali Acc: 0.962 Test Loss: 0.189 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9560620784759521
Epoch: 33, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9918971061706543
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.019146203994751
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9569451808929443
Epoch: 36, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.035977840423584
Epoch: 37, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0131890773773193
Epoch: 38, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9267992973327637
Epoch: 39, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9795279502868652
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 20969
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.694720983505249
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.148 Vali Acc: 0.208 Test Loss: 2.148 Test Acc: 0.208
Validation loss decreased (inf --> -0.208087).  Saving model ...
Epoch: 2 cost time: 0.8814995288848877
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.057 Vali Acc: 0.300 Test Loss: 2.057 Test Acc: 0.300
Validation loss decreased (-0.208087 --> -0.299979).  Saving model ...
Epoch: 3 cost time: 0.9203610420227051
Epoch: 3, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.940 Vali Acc: 0.432 Test Loss: 1.940 Test Acc: 0.432
Validation loss decreased (-0.299979 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 0.8995568752288818
Epoch: 4, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.810 Vali Acc: 0.581 Test Loss: 1.810 Test Acc: 0.581
Validation loss decreased (-0.432413 --> -0.581063).  Saving model ...
Epoch: 5 cost time: 0.8444244861602783
Epoch: 5, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.668 Vali Acc: 0.689 Test Loss: 1.668 Test Acc: 0.689
Validation loss decreased (-0.581063 --> -0.689173).  Saving model ...
Epoch: 6 cost time: 0.9833705425262451
Epoch: 6, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.530 Vali Acc: 0.757 Test Loss: 1.530 Test Acc: 0.757
Validation loss decreased (-0.689173 --> -0.756741).  Saving model ...
Epoch: 7 cost time: 0.8951370716094971
Epoch: 7, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.394 Vali Acc: 0.789 Test Loss: 1.394 Test Acc: 0.789
Validation loss decreased (-0.756741 --> -0.789175).  Saving model ...
Epoch: 8 cost time: 0.8602476119995117
Epoch: 8, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.261 Vali Acc: 0.819 Test Loss: 1.261 Test Acc: 0.819
Validation loss decreased (-0.789175 --> -0.818906).  Saving model ...
Epoch: 9 cost time: 0.8615889549255371
Epoch: 9, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.133 Vali Acc: 0.832 Test Loss: 1.133 Test Acc: 0.832
Validation loss decreased (-0.818906 --> -0.832421).  Saving model ...
Epoch: 10 cost time: 0.8574838638305664
Epoch: 10, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.021 Vali Acc: 0.841 Test Loss: 1.021 Test Acc: 0.841
Validation loss decreased (-0.832421 --> -0.840530).  Saving model ...
Epoch: 11 cost time: 0.8735885620117188
Epoch: 11, Steps: 17 | Train Loss: 0.890 Vali Loss: 0.912 Vali Acc: 0.873 Test Loss: 0.912 Test Acc: 0.873
Validation loss decreased (-0.840530 --> -0.872964).  Saving model ...
Epoch: 12 cost time: 0.912398099899292
Epoch: 12, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.819 Vali Acc: 0.876 Test Loss: 0.819 Test Acc: 0.876
Validation loss decreased (-0.872964 --> -0.875667).  Saving model ...
Epoch: 13 cost time: 0.9581143856048584
Epoch: 13, Steps: 17 | Train Loss: 0.687 Vali Loss: 0.738 Vali Acc: 0.886 Test Loss: 0.738 Test Acc: 0.886
Validation loss decreased (-0.875667 --> -0.886479).  Saving model ...
Epoch: 14 cost time: 1.0031554698944092
Epoch: 14, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.670 Vali Acc: 0.895 Test Loss: 0.670 Test Acc: 0.895
Validation loss decreased (-0.886479 --> -0.894588).  Saving model ...
Epoch: 15 cost time: 0.9556355476379395
Epoch: 15, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.606 Vali Acc: 0.897 Test Loss: 0.606 Test Acc: 0.897
Validation loss decreased (-0.894588 --> -0.897291).  Saving model ...
Epoch: 16 cost time: 0.9627535343170166
Epoch: 16, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.555 Vali Acc: 0.903 Test Loss: 0.555 Test Acc: 0.903
Validation loss decreased (-0.897291 --> -0.902697).  Saving model ...
Epoch: 17 cost time: 0.9252126216888428
Epoch: 17, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.502 Vali Acc: 0.916 Test Loss: 0.502 Test Acc: 0.916
Validation loss decreased (-0.902697 --> -0.916211).  Saving model ...
Epoch: 18 cost time: 0.9312427043914795
Epoch: 18, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.468 Vali Acc: 0.914 Test Loss: 0.468 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9972763061523438
Epoch: 19, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.435 Vali Acc: 0.924 Test Loss: 0.435 Test Acc: 0.924
Validation loss decreased (-0.916211 --> -0.924320).  Saving model ...
Epoch: 20 cost time: 1.082693338394165
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.400 Vali Acc: 0.924 Test Loss: 0.400 Test Acc: 0.924
Validation loss decreased (-0.924320 --> -0.924320).  Saving model ...
Epoch: 21 cost time: 0.983661413192749
Epoch: 21, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.375 Vali Acc: 0.927 Test Loss: 0.375 Test Acc: 0.927
Validation loss decreased (-0.924320 --> -0.927023).  Saving model ...
Epoch: 22 cost time: 0.9920501708984375
Epoch: 22, Steps: 17 | Train Loss: 0.268 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.927023 --> -0.929726).  Saving model ...
Epoch: 23 cost time: 1.0906121730804443
Epoch: 23, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.327 Vali Acc: 0.938 Test Loss: 0.327 Test Acc: 0.938
Validation loss decreased (-0.929726 --> -0.937835).  Saving model ...
Epoch: 24 cost time: 0.9646444320678711
Epoch: 24, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.310 Vali Acc: 0.935 Test Loss: 0.310 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9460136890411377
Epoch: 25, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.290 Vali Acc: 0.935 Test Loss: 0.290 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0257670879364014
Epoch: 26, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.937835 --> -0.940538).  Saving model ...
Epoch: 27 cost time: 0.8963193893432617
Epoch: 27, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.258 Vali Acc: 0.943 Test Loss: 0.258 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 28 cost time: 1.0644798278808594
Epoch: 28, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.248 Vali Acc: 0.943 Test Loss: 0.248 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 29 cost time: 0.9403073787689209
Epoch: 29, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.241 Vali Acc: 0.946 Test Loss: 0.241 Test Acc: 0.946
Validation loss decreased (-0.943241 --> -0.945944).  Saving model ...
Epoch: 30 cost time: 1.0602929592132568
Epoch: 30, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 31 cost time: 0.9876554012298584
Epoch: 31, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.217 Vali Acc: 0.951 Test Loss: 0.217 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951349).  Saving model ...
Epoch: 32 cost time: 0.9357998371124268
Epoch: 32, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.211 Vali Acc: 0.949 Test Loss: 0.211 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0307586193084717
Epoch: 33, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.949 Test Loss: 0.200 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9677011966705322
Epoch: 34, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.013540267944336
Epoch: 35, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 36 cost time: 0.9360716342926025
Epoch: 36, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.187 Vali Acc: 0.951 Test Loss: 0.187 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9661417007446289
Epoch: 37, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 0.9981405735015869
Epoch: 38, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 39 cost time: 0.8806722164154053
Epoch: 39, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
Validation loss decreased (-0.954052 --> -0.956755).  Saving model ...
Epoch: 40 cost time: 0.9354472160339355
Epoch: 40, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9244489669799805
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.169 Vali Acc: 0.954 Test Loss: 0.169 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9367506504058838
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 43 cost time: 1.0056490898132324
Epoch: 43, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9364807605743408
Epoch: 44, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 45 cost time: 0.8597962856292725
Epoch: 45, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 46 cost time: 0.9285273551940918
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9684617519378662
Epoch: 47, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.923607349395752
Epoch: 48, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.959 Test Loss: 0.144 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 49 cost time: 0.902714729309082
Epoch: 49, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 50 cost time: 0.8862931728363037
Epoch: 50, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9572403430938721
Epoch: 51, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9933371543884277
Epoch: 52, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.020721197128296
Epoch: 53, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 54 cost time: 1.0675456523895264
Epoch: 54, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.962161 --> -0.967566).  Saving model ...
Epoch: 55 cost time: 1.0683414936065674
Epoch: 55, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0490880012512207
Epoch: 56, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9587180614471436
Epoch: 57, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.013256311416626
Epoch: 58, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8654744625091553
Epoch: 59, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9555916786193848
Epoch: 60, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9323904514312744
Epoch: 61, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.957 Test Loss: 0.127 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8674306869506836
Epoch: 62, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8662445545196533
Epoch: 63, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.962 Test Loss: 0.125 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.9400215148925781
Epoch: 64, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 20969
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6657934188842773
Epoch: 1, Steps: 17 | Train Loss: 2.273 Vali Loss: 2.253 Vali Acc: 0.119 Test Loss: 2.253 Test Acc: 0.119
Validation loss decreased (inf --> -0.118896).  Saving model ...
Epoch: 2 cost time: 0.9541285037994385
Epoch: 2, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.129 Vali Acc: 0.197 Test Loss: 2.129 Test Acc: 0.197
Validation loss decreased (-0.118896 --> -0.197276).  Saving model ...
Epoch: 3 cost time: 0.9396059513092041
Epoch: 3, Steps: 17 | Train Loss: 2.019 Vali Loss: 1.968 Vali Acc: 0.427 Test Loss: 1.968 Test Acc: 0.427
Validation loss decreased (-0.197276 --> -0.427007).  Saving model ...
Epoch: 4 cost time: 0.8554689884185791
Epoch: 4, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.807 Vali Acc: 0.562 Test Loss: 1.807 Test Acc: 0.562
Validation loss decreased (-0.427007 --> -0.562144).  Saving model ...
Epoch: 5 cost time: 0.9218106269836426
Epoch: 5, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.632 Vali Acc: 0.708 Test Loss: 1.632 Test Acc: 0.708
Validation loss decreased (-0.562144 --> -0.708092).  Saving model ...
Epoch: 6 cost time: 0.8842558860778809
Epoch: 6, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.464 Vali Acc: 0.786 Test Loss: 1.464 Test Acc: 0.786
Validation loss decreased (-0.708092 --> -0.786472).  Saving model ...
Epoch: 7 cost time: 0.8112719058990479
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.302 Vali Acc: 0.803 Test Loss: 1.302 Test Acc: 0.803
Validation loss decreased (-0.786472 --> -0.802690).  Saving model ...
Epoch: 8 cost time: 0.8579962253570557
Epoch: 8, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.143 Vali Acc: 0.841 Test Loss: 1.143 Test Acc: 0.841
Validation loss decreased (-0.802690 --> -0.840529).  Saving model ...
Epoch: 9 cost time: 0.9763965606689453
Epoch: 9, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.010 Vali Acc: 0.876 Test Loss: 1.010 Test Acc: 0.876
Validation loss decreased (-0.840529 --> -0.875666).  Saving model ...
Epoch: 10 cost time: 0.8363606929779053
Epoch: 10, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.900 Vali Acc: 0.873 Test Loss: 0.900 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8677618503570557
Epoch: 11, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.787 Vali Acc: 0.889 Test Loss: 0.787 Test Acc: 0.889
Validation loss decreased (-0.875666 --> -0.889181).  Saving model ...
Epoch: 12 cost time: 0.9681203365325928
Epoch: 12, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.709 Vali Acc: 0.897 Test Loss: 0.709 Test Acc: 0.897
Validation loss decreased (-0.889181 --> -0.897290).  Saving model ...
Epoch: 13 cost time: 0.8757607936859131
Epoch: 13, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.637 Vali Acc: 0.905 Test Loss: 0.637 Test Acc: 0.905
Validation loss decreased (-0.897290 --> -0.905399).  Saving model ...
Epoch: 14 cost time: 0.9375276565551758
Epoch: 14, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.568 Vali Acc: 0.903 Test Loss: 0.568 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9009702205657959
Epoch: 15, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.517 Vali Acc: 0.916 Test Loss: 0.517 Test Acc: 0.916
Validation loss decreased (-0.905399 --> -0.916211).  Saving model ...
Epoch: 16 cost time: 0.9703209400177002
Epoch: 16, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.475 Vali Acc: 0.924 Test Loss: 0.475 Test Acc: 0.924
Validation loss decreased (-0.916211 --> -0.924320).  Saving model ...
Epoch: 17 cost time: 1.087301254272461
Epoch: 17, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.431 Vali Acc: 0.938 Test Loss: 0.431 Test Acc: 0.938
Validation loss decreased (-0.924320 --> -0.937834).  Saving model ...
Epoch: 18 cost time: 1.0189909934997559
Epoch: 18, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940537).  Saving model ...
Epoch: 19 cost time: 1.0825891494750977
Epoch: 19, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.373 Vali Acc: 0.946 Test Loss: 0.373 Test Acc: 0.946
Validation loss decreased (-0.940537 --> -0.945942).  Saving model ...
Epoch: 20 cost time: 1.1027653217315674
Epoch: 20, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.347 Vali Acc: 0.949 Test Loss: 0.347 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 21 cost time: 1.0160579681396484
Epoch: 21, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.320 Vali Acc: 0.951 Test Loss: 0.320 Test Acc: 0.951
Validation loss decreased (-0.948645 --> -0.951348).  Saving model ...
Epoch: 22 cost time: 0.9630980491638184
Epoch: 22, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.299 Vali Acc: 0.954 Test Loss: 0.299 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 23 cost time: 0.9200897216796875
Epoch: 23, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.284 Vali Acc: 0.954 Test Loss: 0.284 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 24 cost time: 1.027970790863037
Epoch: 24, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.271 Vali Acc: 0.949 Test Loss: 0.271 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9544565677642822
Epoch: 25, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.256 Vali Acc: 0.954 Test Loss: 0.256 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 26 cost time: 0.9370908737182617
Epoch: 26, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 27 cost time: 0.9222316741943359
Epoch: 27, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 28 cost time: 1.0387983322143555
Epoch: 28, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.214 Vali Acc: 0.965 Test Loss: 0.214 Test Acc: 0.965
Validation loss decreased (-0.959457 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 1.0235183238983154
Epoch: 29, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0640263557434082
Epoch: 30, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0295255184173584
Epoch: 31, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0712792873382568
Epoch: 32, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8829705715179443
Epoch: 33, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 34 cost time: 0.8885037899017334
Epoch: 34, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.964863 --> -0.972971).  Saving model ...
Epoch: 35 cost time: 1.0000593662261963
Epoch: 35, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8927667140960693
Epoch: 36, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0642304420471191
Epoch: 37, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9131922721862793
Epoch: 38, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9650037288665771
Epoch: 39, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9226603507995605
Epoch: 40, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.972971 --> -0.972972).  Saving model ...
Epoch: 41 cost time: 0.9925751686096191
Epoch: 41, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 42 cost time: 0.9338161945343018
Epoch: 42, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9444999694824219
Epoch: 43, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9432814121246338
Epoch: 44, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 45 cost time: 0.9232332706451416
Epoch: 45, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0422914028167725
Epoch: 46, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 47 cost time: 0.9764750003814697
Epoch: 47, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9783923625946045
Epoch: 48, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9879648685455322
Epoch: 49, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.961723804473877
Epoch: 50, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 51 cost time: 0.993781328201294
Epoch: 51, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9030535221099854
Epoch: 52, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.968 Test Loss: 0.111 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9690742492675781
Epoch: 53, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 1.0270915031433105
Epoch: 54, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 55 cost time: 1.0125994682312012
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9285650253295898
Epoch: 56, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 57 cost time: 1.094149112701416
Epoch: 57, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.026871681213379
Epoch: 58, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9133455753326416
Epoch: 59, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.962 Test Loss: 0.108 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.9708867073059082
Epoch: 60, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9512548446655273
Epoch: 61, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9294443130493164
Epoch: 62, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9353296756744385
Epoch: 63, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9316895008087158
Epoch: 64, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 65 cost time: 0.9461953639984131
Epoch: 65, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 66 cost time: 0.9507949352264404
Epoch: 66, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8940684795379639
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9513330459594727
Epoch: 68, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 69 cost time: 0.9076833724975586
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 70 cost time: 0.9064300060272217
Epoch: 70, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9761531352996826
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.940910816192627
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9738101959228516
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.975675 --> -0.983783).  Saving model ...
Epoch: 74 cost time: 0.9831876754760742
Epoch: 74, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9938914775848389
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9565887451171875
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.8793630599975586
Epoch: 77, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9076619148254395
Epoch: 78, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.9370999336242676
Epoch: 79, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.9848604202270508
Epoch: 80, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.1077032089233398
Epoch: 81, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.050046443939209
Epoch: 82, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.9773626327514648
Epoch: 83, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9837837837837838
model parameter : 16873
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6811952590942383
Epoch: 1, Steps: 17 | Train Loss: 2.263 Vali Loss: 2.255 Vali Acc: 0.127 Test Loss: 2.255 Test Acc: 0.127
Validation loss decreased (inf --> -0.127004).  Saving model ...
Epoch: 2 cost time: 0.9114954471588135
Epoch: 2, Steps: 17 | Train Loss: 2.147 Vali Loss: 2.132 Vali Acc: 0.216 Test Loss: 2.132 Test Acc: 0.216
Validation loss decreased (-0.127004 --> -0.216195).  Saving model ...
Epoch: 3 cost time: 0.938307523727417
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.973 Vali Acc: 0.414 Test Loss: 1.973 Test Acc: 0.414
Validation loss decreased (-0.216195 --> -0.413494).  Saving model ...
Epoch: 4 cost time: 1.0041561126708984
Epoch: 4, Steps: 17 | Train Loss: 1.838 Vali Loss: 1.813 Vali Acc: 0.562 Test Loss: 1.813 Test Acc: 0.562
Validation loss decreased (-0.413494 --> -0.562144).  Saving model ...
Epoch: 5 cost time: 0.9815144538879395
Epoch: 5, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.640 Vali Acc: 0.716 Test Loss: 1.640 Test Acc: 0.716
Validation loss decreased (-0.562144 --> -0.716200).  Saving model ...
Epoch: 6 cost time: 0.9374799728393555
Epoch: 6, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.473 Vali Acc: 0.778 Test Loss: 1.473 Test Acc: 0.778
Validation loss decreased (-0.716200 --> -0.778364).  Saving model ...
Epoch: 7 cost time: 0.9552297592163086
Epoch: 7, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.312 Vali Acc: 0.808 Test Loss: 1.312 Test Acc: 0.808
Validation loss decreased (-0.778364 --> -0.808095).  Saving model ...
Epoch: 8 cost time: 0.9005160331726074
Epoch: 8, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.154 Vali Acc: 0.857 Test Loss: 1.154 Test Acc: 0.857
Validation loss decreased (-0.808095 --> -0.856745).  Saving model ...
Epoch: 9 cost time: 0.9603085517883301
Epoch: 9, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.022 Vali Acc: 0.876 Test Loss: 1.022 Test Acc: 0.876
Validation loss decreased (-0.856745 --> -0.875665).  Saving model ...
Epoch: 10 cost time: 1.0391614437103271
Epoch: 10, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.913 Vali Acc: 0.881 Test Loss: 0.913 Test Acc: 0.881
Validation loss decreased (-0.875665 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 0.997957706451416
Epoch: 11, Steps: 17 | Train Loss: 0.778 Vali Loss: 0.800 Vali Acc: 0.892 Test Loss: 0.800 Test Acc: 0.892
Validation loss decreased (-0.881072 --> -0.891884).  Saving model ...
Epoch: 12 cost time: 0.9722652435302734
Epoch: 12, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.722 Vali Acc: 0.897 Test Loss: 0.722 Test Acc: 0.897
Validation loss decreased (-0.891884 --> -0.897290).  Saving model ...
Epoch: 13 cost time: 1.004141092300415
Epoch: 13, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.649 Vali Acc: 0.908 Test Loss: 0.649 Test Acc: 0.908
Validation loss decreased (-0.897290 --> -0.908102).  Saving model ...
Epoch: 14 cost time: 0.9463391304016113
Epoch: 14, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.580 Vali Acc: 0.908 Test Loss: 0.580 Test Acc: 0.908
Validation loss decreased (-0.908102 --> -0.908102).  Saving model ...
Epoch: 15 cost time: 0.9758591651916504
Epoch: 15, Steps: 17 | Train Loss: 0.480 Vali Loss: 0.528 Vali Acc: 0.919 Test Loss: 0.528 Test Acc: 0.919
Validation loss decreased (-0.908102 --> -0.918914).  Saving model ...
Epoch: 16 cost time: 0.9314560890197754
Epoch: 16, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.484 Vali Acc: 0.927 Test Loss: 0.484 Test Acc: 0.927
Validation loss decreased (-0.918914 --> -0.927022).  Saving model ...
Epoch: 17 cost time: 0.9179282188415527
Epoch: 17, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.439 Vali Acc: 0.941 Test Loss: 0.439 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940536).  Saving model ...
Epoch: 18 cost time: 0.9296526908874512
Epoch: 18, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.407 Vali Acc: 0.946 Test Loss: 0.407 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 19 cost time: 0.9807231426239014
Epoch: 19, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.380 Vali Acc: 0.941 Test Loss: 0.380 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9375450611114502
Epoch: 20, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.352 Vali Acc: 0.949 Test Loss: 0.352 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 21 cost time: 0.9167566299438477
Epoch: 21, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.324 Vali Acc: 0.954 Test Loss: 0.324 Test Acc: 0.954
Validation loss decreased (-0.948645 --> -0.954051).  Saving model ...
Epoch: 22 cost time: 0.9219715595245361
Epoch: 22, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.301 Vali Acc: 0.954 Test Loss: 0.301 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 23 cost time: 0.8640472888946533
Epoch: 23, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.287 Vali Acc: 0.957 Test Loss: 0.287 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 24 cost time: 0.9266376495361328
Epoch: 24, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9733963012695312
Epoch: 25, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.257 Vali Acc: 0.954 Test Loss: 0.257 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0345757007598877
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.239 Vali Acc: 0.962 Test Loss: 0.239 Test Acc: 0.962
Validation loss decreased (-0.956754 --> -0.962160).  Saving model ...
Epoch: 27 cost time: 1.017503023147583
Epoch: 27, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9949250221252441
Epoch: 28, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.215 Vali Acc: 0.965 Test Loss: 0.215 Test Acc: 0.965
Validation loss decreased (-0.962160 --> -0.964863).  Saving model ...
Epoch: 29 cost time: 1.000809669494629
Epoch: 29, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.208 Vali Acc: 0.962 Test Loss: 0.208 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.966172456741333
Epoch: 30, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9871442317962646
Epoch: 31, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.197 Vali Acc: 0.962 Test Loss: 0.197 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9890389442443848
Epoch: 32, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9686980247497559
Epoch: 33, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9074923992156982
Epoch: 34, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.964863 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 0.9349489212036133
Epoch: 35, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0289740562438965
Epoch: 36, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9062731266021729
Epoch: 37, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 38 cost time: 0.954500675201416
Epoch: 38, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9720847606658936
Epoch: 39, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8556196689605713
Epoch: 40, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9092528820037842
Epoch: 41, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8482770919799805
Epoch: 42, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8981213569641113
Epoch: 43, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 44 cost time: 0.9449472427368164
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967566 --> -0.967566).  Saving model ...
Epoch: 45 cost time: 0.9900293350219727
Epoch: 45, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0116541385650635
Epoch: 46, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.967566 --> -0.970269).  Saving model ...
Epoch: 47 cost time: 1.01607346534729
Epoch: 47, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 48 cost time: 0.9689571857452393
Epoch: 48, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.979478120803833
Epoch: 49, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9644849300384521
Epoch: 50, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0005524158477783
Epoch: 51, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.9795382022857666
Epoch: 52, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 53 cost time: 0.9031765460968018
Epoch: 53, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 54 cost time: 0.940636396408081
Epoch: 54, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8929803371429443
Epoch: 55, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.9212489128112793
Epoch: 56, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 57 cost time: 0.9258568286895752
Epoch: 57, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 58 cost time: 0.9597249031066895
Epoch: 58, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9254300594329834
Epoch: 59, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.947058916091919
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9946215152740479
Epoch: 61, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.0213682651519775
Epoch: 62, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9838109016418457
Epoch: 63, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8909022808074951
Epoch: 64, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972972 --> -0.972972).  Saving model ...
Epoch: 65 cost time: 1.0023877620697021
Epoch: 65, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.972972 --> -0.975675).  Saving model ...
Epoch: 66 cost time: 1.0051348209381104
Epoch: 66, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9827480316162109
Epoch: 67, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9981348514556885
Epoch: 68, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9312868118286133
Epoch: 69, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 70 cost time: 1.036109209060669
Epoch: 70, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.031891107559204
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9581620693206787
Epoch: 72, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.975675 --> -0.975675).  Saving model ...
Epoch: 73 cost time: 1.0188233852386475
Epoch: 73, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.975675 --> -0.981080).  Saving model ...
Epoch: 74 cost time: 0.951610803604126
Epoch: 74, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9493727684020996
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9244303703308105
Epoch: 76, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9970600605010986
Epoch: 77, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.9158632755279541
Epoch: 78, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.968 Test Loss: 0.089 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 1.0370256900787354
Epoch: 79, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.9468131065368652
Epoch: 80, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 1.0355281829833984
Epoch: 81, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 1.0548827648162842
Epoch: 82, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 1.0320889949798584
Epoch: 83, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.981081081081081
model parameter : 16873
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6292173862457275
Epoch: 1, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.250 Vali Acc: 0.119 Test Loss: 2.250 Test Acc: 0.119
Validation loss decreased (inf --> -0.118896).  Saving model ...
Epoch: 2 cost time: 0.8756275177001953
Epoch: 2, Steps: 17 | Train Loss: 2.151 Vali Loss: 2.133 Vali Acc: 0.205 Test Loss: 2.133 Test Acc: 0.205
Validation loss decreased (-0.118896 --> -0.205384).  Saving model ...
Epoch: 3 cost time: 1.013672113418579
Epoch: 3, Steps: 17 | Train Loss: 2.027 Vali Loss: 1.980 Vali Acc: 0.430 Test Loss: 1.980 Test Acc: 0.430
Validation loss decreased (-0.205384 --> -0.429710).  Saving model ...
Epoch: 4 cost time: 1.0210390090942383
Epoch: 4, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.824 Vali Acc: 0.573 Test Loss: 1.824 Test Acc: 0.573
Validation loss decreased (-0.429710 --> -0.572955).  Saving model ...
Epoch: 5 cost time: 0.9441518783569336
Epoch: 5, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.657 Vali Acc: 0.711 Test Loss: 1.657 Test Acc: 0.711
Validation loss decreased (-0.572955 --> -0.710794).  Saving model ...
Epoch: 6 cost time: 0.9103045463562012
Epoch: 6, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.494 Vali Acc: 0.757 Test Loss: 1.494 Test Acc: 0.757
Validation loss decreased (-0.710794 --> -0.756742).  Saving model ...
Epoch: 7 cost time: 0.9603383541107178
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.339 Vali Acc: 0.811 Test Loss: 1.339 Test Acc: 0.811
Validation loss decreased (-0.756742 --> -0.810797).  Saving model ...
Epoch: 8 cost time: 1.0580732822418213
Epoch: 8, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.186 Vali Acc: 0.846 Test Loss: 1.186 Test Acc: 0.846
Validation loss decreased (-0.810797 --> -0.845934).  Saving model ...
Epoch: 9 cost time: 1.0576417446136475
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.053 Vali Acc: 0.865 Test Loss: 1.053 Test Acc: 0.865
Validation loss decreased (-0.845934 --> -0.864854).  Saving model ...
Epoch: 10 cost time: 1.0638329982757568
Epoch: 10, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.942 Vali Acc: 0.876 Test Loss: 0.942 Test Acc: 0.876
Validation loss decreased (-0.864854 --> -0.875666).  Saving model ...
Epoch: 11 cost time: 1.0351049900054932
Epoch: 11, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.832 Vali Acc: 0.886 Test Loss: 0.832 Test Acc: 0.886
Validation loss decreased (-0.875666 --> -0.886478).  Saving model ...
Epoch: 12 cost time: 0.9868597984313965
Epoch: 12, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.751 Vali Acc: 0.892 Test Loss: 0.751 Test Acc: 0.892
Validation loss decreased (-0.886478 --> -0.891884).  Saving model ...
Epoch: 13 cost time: 0.9658651351928711
Epoch: 13, Steps: 17 | Train Loss: 0.630 Vali Loss: 0.676 Vali Acc: 0.908 Test Loss: 0.676 Test Acc: 0.908
Validation loss decreased (-0.891884 --> -0.908101).  Saving model ...
Epoch: 14 cost time: 0.9711871147155762
Epoch: 14, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.604 Vali Acc: 0.905 Test Loss: 0.604 Test Acc: 0.905
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9515354633331299
Epoch: 15, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.552 Vali Acc: 0.911 Test Loss: 0.552 Test Acc: 0.911
Validation loss decreased (-0.908101 --> -0.910805).  Saving model ...
Epoch: 16 cost time: 0.9869034290313721
Epoch: 16, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
Validation loss decreased (-0.910805 --> -0.918914).  Saving model ...
Epoch: 17 cost time: 0.9762446880340576
Epoch: 17, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.457 Vali Acc: 0.927 Test Loss: 0.457 Test Acc: 0.927
Validation loss decreased (-0.918914 --> -0.927022).  Saving model ...
Epoch: 18 cost time: 0.9930641651153564
Epoch: 18, Steps: 17 | Train Loss: 0.381 Vali Loss: 0.422 Vali Acc: 0.935 Test Loss: 0.422 Test Acc: 0.935
Validation loss decreased (-0.927022 --> -0.935131).  Saving model ...
Epoch: 19 cost time: 0.9928364753723145
Epoch: 19, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.391 Vali Acc: 0.943 Test Loss: 0.391 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943239).  Saving model ...
Epoch: 20 cost time: 0.9470245838165283
Epoch: 20, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.366 Vali Acc: 0.943 Test Loss: 0.366 Test Acc: 0.943
Validation loss decreased (-0.943239 --> -0.943240).  Saving model ...
Epoch: 21 cost time: 1.0193047523498535
Epoch: 21, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.336 Vali Acc: 0.946 Test Loss: 0.336 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 22 cost time: 1.0263025760650635
Epoch: 22, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.310 Vali Acc: 0.954 Test Loss: 0.310 Test Acc: 0.954
Validation loss decreased (-0.945943 --> -0.954051).  Saving model ...
Epoch: 23 cost time: 0.9142024517059326
Epoch: 23, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.294 Vali Acc: 0.954 Test Loss: 0.294 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954051).  Saving model ...
Epoch: 24 cost time: 0.9924633502960205
Epoch: 24, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.281 Vali Acc: 0.951 Test Loss: 0.281 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.009822130203247
Epoch: 25, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.264 Vali Acc: 0.959 Test Loss: 0.264 Test Acc: 0.959
Validation loss decreased (-0.954051 --> -0.959457).  Saving model ...
Epoch: 26 cost time: 0.9947073459625244
Epoch: 26, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9991204738616943
Epoch: 27, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.241 Vali Acc: 0.957 Test Loss: 0.241 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9258825778961182
Epoch: 28, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 29 cost time: 0.8972809314727783
Epoch: 29, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.217 Vali Acc: 0.959 Test Loss: 0.217 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 30 cost time: 0.9493377208709717
Epoch: 30, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
Validation loss decreased (-0.959457 --> -0.962160).  Saving model ...
Epoch: 31 cost time: 1.0375909805297852
Epoch: 31, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.203 Vali Acc: 0.962 Test Loss: 0.203 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 32 cost time: 1.046609878540039
Epoch: 32, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962160).  Saving model ...
Epoch: 33 cost time: 1.0109593868255615
Epoch: 33, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.182 Vali Acc: 0.959 Test Loss: 0.182 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.02787184715271
Epoch: 34, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.962160 --> -0.967566).  Saving model ...
Epoch: 35 cost time: 0.992203950881958
Epoch: 35, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8839633464813232
Epoch: 36, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0482840538024902
Epoch: 37, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8911504745483398
Epoch: 38, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9247031211853027
Epoch: 39, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9451663494110107
Epoch: 40, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9900805950164795
Epoch: 41, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9539799690246582
Epoch: 42, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0475578308105469
Epoch: 43, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9818425178527832
Epoch: 44, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 16873
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6741039752960205
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.204 Vali Acc: 0.141 Test Loss: 2.204 Test Acc: 0.141
Validation loss decreased (inf --> -0.140518).  Saving model ...
Epoch: 2 cost time: 0.9570953845977783
Epoch: 2, Steps: 17 | Train Loss: 2.140 Vali Loss: 2.106 Vali Acc: 0.238 Test Loss: 2.106 Test Acc: 0.238
Validation loss decreased (-0.140518 --> -0.237817).  Saving model ...
Epoch: 3 cost time: 0.8967239856719971
Epoch: 3, Steps: 17 | Train Loss: 2.025 Vali Loss: 1.976 Vali Acc: 0.432 Test Loss: 1.976 Test Acc: 0.432
Validation loss decreased (-0.237817 --> -0.432413).  Saving model ...
Epoch: 4 cost time: 0.9070382118225098
Epoch: 4, Steps: 17 | Train Loss: 1.876 Vali Loss: 1.842 Vali Acc: 0.619 Test Loss: 1.842 Test Acc: 0.619
Validation loss decreased (-0.432413 --> -0.618900).  Saving model ...
Epoch: 5 cost time: 0.9402492046356201
Epoch: 5, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.698 Vali Acc: 0.741 Test Loss: 1.698 Test Acc: 0.741
Validation loss decreased (-0.618900 --> -0.740524).  Saving model ...
Epoch: 6 cost time: 0.9663300514221191
Epoch: 6, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.555 Vali Acc: 0.786 Test Loss: 1.555 Test Acc: 0.786
Validation loss decreased (-0.740524 --> -0.786471).  Saving model ...
Epoch: 7 cost time: 0.9145708084106445
Epoch: 7, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.418 Vali Acc: 0.827 Test Loss: 1.418 Test Acc: 0.827
Validation loss decreased (-0.786471 --> -0.827013).  Saving model ...
Epoch: 8 cost time: 1.0276336669921875
Epoch: 8, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.280 Vali Acc: 0.846 Test Loss: 1.280 Test Acc: 0.846
Validation loss decreased (-0.827013 --> -0.845933).  Saving model ...
Epoch: 9 cost time: 1.009249210357666
Epoch: 9, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.152 Vali Acc: 0.849 Test Loss: 1.152 Test Acc: 0.849
Validation loss decreased (-0.845933 --> -0.848637).  Saving model ...
Epoch: 10 cost time: 1.0184261798858643
Epoch: 10, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.039 Vali Acc: 0.862 Test Loss: 1.039 Test Acc: 0.862
Validation loss decreased (-0.848637 --> -0.862152).  Saving model ...
Epoch: 11 cost time: 0.9772770404815674
Epoch: 11, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.927 Vali Acc: 0.876 Test Loss: 0.927 Test Acc: 0.876
Validation loss decreased (-0.862152 --> -0.875666).  Saving model ...
Epoch: 12 cost time: 0.9521389007568359
Epoch: 12, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.837 Vali Acc: 0.878 Test Loss: 0.837 Test Acc: 0.878
Validation loss decreased (-0.875666 --> -0.878370).  Saving model ...
Epoch: 13 cost time: 0.9902749061584473
Epoch: 13, Steps: 17 | Train Loss: 0.719 Vali Loss: 0.753 Vali Acc: 0.886 Test Loss: 0.753 Test Acc: 0.886
Validation loss decreased (-0.878370 --> -0.886479).  Saving model ...
Epoch: 14 cost time: 0.9097423553466797
Epoch: 14, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.676 Vali Acc: 0.895 Test Loss: 0.676 Test Acc: 0.895
Validation loss decreased (-0.886479 --> -0.894588).  Saving model ...
Epoch: 15 cost time: 0.913395881652832
Epoch: 15, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.616 Vali Acc: 0.911 Test Loss: 0.616 Test Acc: 0.911
Validation loss decreased (-0.894588 --> -0.910805).  Saving model ...
Epoch: 16 cost time: 0.9323766231536865
Epoch: 16, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.562 Vali Acc: 0.908 Test Loss: 0.562 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9278085231781006
Epoch: 17, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.511 Vali Acc: 0.911 Test Loss: 0.511 Test Acc: 0.911
Validation loss decreased (-0.910805 --> -0.910806).  Saving model ...
Epoch: 18 cost time: 1.0045623779296875
Epoch: 18, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.473 Vali Acc: 0.908 Test Loss: 0.473 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9527254104614258
Epoch: 19, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.439 Vali Acc: 0.914 Test Loss: 0.439 Test Acc: 0.914
Validation loss decreased (-0.910806 --> -0.913509).  Saving model ...
Epoch: 20 cost time: 0.9032869338989258
Epoch: 20, Steps: 17 | Train Loss: 0.341 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
Validation loss decreased (-0.913509 --> -0.918915).  Saving model ...
Epoch: 21 cost time: 0.9323916435241699
Epoch: 21, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.918915 --> -0.929726).  Saving model ...
Epoch: 22 cost time: 0.9133975505828857
Epoch: 22, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.347 Vali Acc: 0.935 Test Loss: 0.347 Test Acc: 0.935
Validation loss decreased (-0.929726 --> -0.935132).  Saving model ...
Epoch: 23 cost time: 0.9953687191009521
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.326 Vali Acc: 0.935 Test Loss: 0.326 Test Acc: 0.935
Validation loss decreased (-0.935132 --> -0.935132).  Saving model ...
Epoch: 24 cost time: 1.0190742015838623
Epoch: 24, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.310 Vali Acc: 0.946 Test Loss: 0.310 Test Acc: 0.946
Validation loss decreased (-0.935132 --> -0.945943).  Saving model ...
Epoch: 25 cost time: 0.998175859451294
Epoch: 25, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.290 Vali Acc: 0.951 Test Loss: 0.290 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951348).  Saving model ...
Epoch: 26 cost time: 0.9342710971832275
Epoch: 26, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.273 Vali Acc: 0.954 Test Loss: 0.273 Test Acc: 0.954
Validation loss decreased (-0.951348 --> -0.954051).  Saving model ...
Epoch: 27 cost time: 0.9009990692138672
Epoch: 27, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.265 Vali Acc: 0.946 Test Loss: 0.265 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9812352657318115
Epoch: 28, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 29 cost time: 0.8905198574066162
Epoch: 29, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9584333896636963
Epoch: 30, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9002630710601807
Epoch: 31, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.221 Vali Acc: 0.951 Test Loss: 0.221 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9507393836975098
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.208 Vali Acc: 0.951 Test Loss: 0.208 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9929120540618896
Epoch: 33, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0420129299163818
Epoch: 34, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 35 cost time: 1.033724069595337
Epoch: 35, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0459940433502197
Epoch: 36, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.951 Test Loss: 0.180 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9190552234649658
Epoch: 37, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.172 Vali Acc: 0.954 Test Loss: 0.172 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954052).  Saving model ...
Epoch: 38 cost time: 0.838050127029419
Epoch: 38, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9104578495025635
Epoch: 39, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.165 Vali Acc: 0.951 Test Loss: 0.165 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9704835414886475
Epoch: 40, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 41 cost time: 0.9707591533660889
Epoch: 41, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 42 cost time: 0.9095382690429688
Epoch: 42, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.153 Vali Acc: 0.954 Test Loss: 0.153 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9462809562683105
Epoch: 43, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9456267356872559
Epoch: 44, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.139 Vali Acc: 0.957 Test Loss: 0.139 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9366874694824219
Epoch: 45, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.138 Vali Acc: 0.957 Test Loss: 0.138 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0259244441986084
Epoch: 46, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.128 Vali Acc: 0.962 Test Loss: 0.128 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 47 cost time: 0.9907872676849365
Epoch: 47, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9872074127197266
Epoch: 48, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.962775707244873
Epoch: 49, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.957 Test Loss: 0.136 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8970482349395752
Epoch: 50, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9194121360778809
Epoch: 51, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9532744884490967
Epoch: 52, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9474570751190186
Epoch: 53, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 54 cost time: 0.9107911586761475
Epoch: 54, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 55 cost time: 0.9395937919616699
Epoch: 55, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8745307922363281
Epoch: 56, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.965 Test Loss: 0.113 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 57 cost time: 0.9930169582366943
Epoch: 57, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 58 cost time: 1.0122840404510498
Epoch: 58, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.964864 --> -0.970269).  Saving model ...
Epoch: 59 cost time: 0.9386627674102783
Epoch: 59, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9803268909454346
Epoch: 60, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.987236499786377
Epoch: 61, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.968 Test Loss: 0.108 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9789731502532959
Epoch: 62, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.0410418510437012
Epoch: 63, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.8612310886383057
Epoch: 64, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.968 Test Loss: 0.106 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.9293365478515625
Epoch: 65, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.970269 --> -0.970269).  Saving model ...
Epoch: 66 cost time: 0.8222250938415527
Epoch: 66, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9403564929962158
Epoch: 67, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9352774620056152
Epoch: 68, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.885899543762207
Epoch: 69, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.970269 --> -0.972972).  Saving model ...
Epoch: 70 cost time: 0.9220261573791504
Epoch: 70, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.906402587890625
Epoch: 71, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0188853740692139
Epoch: 72, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.968 Test Loss: 0.099 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9729418754577637
Epoch: 73, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.0562596321105957
Epoch: 74, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.9492805004119873
Epoch: 75, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.9383423328399658
Epoch: 76, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 1.26092529296875
Epoch: 77, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 1.416222095489502
Epoch: 78, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 1.310884714126587
Epoch: 79, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_ETSformer_UEA_ftM_sl29_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.972972972972973
model parameter : 16873
model size : 0.68MB
