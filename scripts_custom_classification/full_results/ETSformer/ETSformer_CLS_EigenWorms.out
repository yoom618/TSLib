Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         1                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
	iters: 100, epoch: 1 | loss: 0.0000000
	speed: 0.3162s/iter; left time: 4015.6011s
Epoch: 1 cost time: 39.93328380584717
Epoch: 1, Steps: 128 | Train Loss: 289.502 Vali Loss: 523.319 Vali Acc: 0.176 Test Loss: 523.319 Test Acc: 0.176
Validation loss decreased (inf --> -0.170339).  Saving model ...
	iters: 100, epoch: 2 | loss: 1195.0256348
	speed: 0.7384s/iter; left time: 9283.5561s
Epoch: 2 cost time: 39.6641411781311
Epoch: 2, Steps: 128 | Train Loss: 623.887 Vali Loss: 894.461 Vali Acc: 0.489 Test Loss: 894.461 Test Acc: 0.489
Validation loss decreased (-0.170339 --> -0.479605).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.7886s/iter; left time: 9814.3981s
Epoch: 3 cost time: 38.778260946273804
Epoch: 3, Steps: 128 | Train Loss: 459.180 Vali Loss: 1009.099 Vali Acc: 0.176 Test Loss: 1009.099 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.7561s/iter; left time: 9312.9399s
Epoch: 4 cost time: 39.040099143981934
Epoch: 4, Steps: 128 | Train Loss: 201.823 Vali Loss: 413.592 Vali Acc: 0.496 Test Loss: 413.592 Test Acc: 0.496
Validation loss decreased (-0.479605 --> -0.492047).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7941s/iter; left time: 9678.7999s
Epoch: 5 cost time: 39.06425189971924
Epoch: 5, Steps: 128 | Train Loss: 181.436 Vali Loss: 494.699 Vali Acc: 0.534 Test Loss: 494.699 Test Acc: 0.534
Validation loss decreased (-0.492047 --> -0.529404).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7824s/iter; left time: 9436.8957s
Epoch: 6 cost time: 39.32740378379822
Epoch: 6, Steps: 128 | Train Loss: 60.831 Vali Loss: 833.548 Vali Acc: 0.336 Test Loss: 833.548 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7486s/iter; left time: 8933.2939s
Epoch: 7 cost time: 38.723506450653076
Epoch: 7, Steps: 128 | Train Loss: 81.518 Vali Loss: 319.578 Vali Acc: 0.611 Test Loss: 319.578 Test Acc: 0.611
Validation loss decreased (-0.529404 --> -0.607491).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7975s/iter; left time: 9414.4225s
Epoch: 8 cost time: 39.367714643478394
Epoch: 8, Steps: 128 | Train Loss: 86.168 Vali Loss: 1134.652 Vali Acc: 0.321 Test Loss: 1134.652 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7551s/iter; left time: 8816.7585s
Epoch: 9 cost time: 39.37548613548279
Epoch: 9, Steps: 128 | Train Loss: 50.169 Vali Loss: 561.609 Vali Acc: 0.573 Test Loss: 561.609 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7587s/iter; left time: 8762.5521s
Epoch: 10 cost time: 39.61870360374451
Epoch: 10, Steps: 128 | Train Loss: 122.664 Vali Loss: 732.729 Vali Acc: 0.550 Test Loss: 732.729 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7538s/iter; left time: 8609.1531s
Epoch: 11 cost time: 39.22112584114075
Epoch: 11, Steps: 128 | Train Loss: 105.592 Vali Loss: 781.966 Vali Acc: 0.397 Test Loss: 781.966 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7650s/iter; left time: 8639.4561s
Epoch: 12 cost time: 39.04964232444763
Epoch: 12, Steps: 128 | Train Loss: 98.671 Vali Loss: 980.475 Vali Acc: 0.511 Test Loss: 980.475 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7488s/iter; left time: 8359.8519s
Epoch: 13 cost time: 38.899959325790405
Epoch: 13, Steps: 128 | Train Loss: 36.296 Vali Loss: 1524.838 Vali Acc: 0.550 Test Loss: 1524.838 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7643s/iter; left time: 8435.3938s
Epoch: 14 cost time: 39.60431504249573
Epoch: 14, Steps: 128 | Train Loss: 66.736 Vali Loss: 1213.000 Vali Acc: 0.588 Test Loss: 1213.000 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7480s/iter; left time: 8159.8595s
Epoch: 15 cost time: 39.329935789108276
Epoch: 15, Steps: 128 | Train Loss: 0.000 Vali Loss: 1262.073 Vali Acc: 0.550 Test Loss: 1262.073 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7583s/iter; left time: 8175.2602s
Epoch: 16 cost time: 39.20233964920044
Epoch: 16, Steps: 128 | Train Loss: 0.000 Vali Loss: 1262.073 Vali Acc: 0.550 Test Loss: 1262.073 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7473s/iter; left time: 7960.8118s
Epoch: 17 cost time: 38.83107852935791
Epoch: 17, Steps: 128 | Train Loss: 0.000 Vali Loss: 1262.073 Vali Acc: 0.550 Test Loss: 1262.073 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 51313749
model size : 230.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 38.059584617614746
Epoch: 1, Steps: 64 | Train Loss: 124.591 Vali Loss: 249.808 Vali Acc: 0.198 Test Loss: 249.808 Test Acc: 0.198
Validation loss decreased (inf --> -0.195975).  Saving model ...
Epoch: 2 cost time: 37.542744874954224
Epoch: 2, Steps: 64 | Train Loss: 214.482 Vali Loss: 222.015 Vali Acc: 0.481 Test Loss: 222.015 Test Acc: 0.481
Validation loss decreased (-0.195975 --> -0.478696).  Saving model ...
Epoch: 3 cost time: 36.95971059799194
Epoch: 3, Steps: 64 | Train Loss: 87.837 Vali Loss: 328.837 Vali Acc: 0.176 Test Loss: 328.837 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 37.14808177947998
Epoch: 4, Steps: 64 | Train Loss: 145.316 Vali Loss: 356.735 Vali Acc: 0.298 Test Loss: 356.735 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 36.88717985153198
Epoch: 5, Steps: 64 | Train Loss: 128.529 Vali Loss: 332.376 Vali Acc: 0.489 Test Loss: 332.376 Test Acc: 0.489
Validation loss decreased (-0.478696 --> -0.485226).  Saving model ...
Epoch: 6 cost time: 37.66708970069885
Epoch: 6, Steps: 64 | Train Loss: 137.327 Vali Loss: 556.139 Vali Acc: 0.481 Test Loss: 556.139 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 37.54818248748779
Epoch: 7, Steps: 64 | Train Loss: 107.043 Vali Loss: 514.702 Vali Acc: 0.496 Test Loss: 514.702 Test Acc: 0.496
Validation loss decreased (-0.485226 --> -0.491036).  Saving model ...
Epoch: 8 cost time: 37.49035930633545
Epoch: 8, Steps: 64 | Train Loss: 43.769 Vali Loss: 562.897 Vali Acc: 0.443 Test Loss: 562.897 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 37.44318604469299
Epoch: 9, Steps: 64 | Train Loss: 64.055 Vali Loss: 645.514 Vali Acc: 0.405 Test Loss: 645.514 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 37.485886096954346
Epoch: 10, Steps: 64 | Train Loss: 106.656 Vali Loss: 451.732 Vali Acc: 0.458 Test Loss: 451.732 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 37.33618783950806
Epoch: 11, Steps: 64 | Train Loss: 62.072 Vali Loss: 666.330 Vali Acc: 0.473 Test Loss: 666.330 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 37.68119192123413
Epoch: 12, Steps: 64 | Train Loss: 21.849 Vali Loss: 463.851 Vali Acc: 0.458 Test Loss: 463.851 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 37.7013475894928
Epoch: 13, Steps: 64 | Train Loss: 6.426 Vali Loss: 421.278 Vali Acc: 0.534 Test Loss: 421.278 Test Acc: 0.534
Validation loss decreased (-0.491036 --> -0.530138).  Saving model ...
Epoch: 14 cost time: 37.62845468521118
Epoch: 14, Steps: 64 | Train Loss: 37.114 Vali Loss: 452.975 Vali Acc: 0.611 Test Loss: 452.975 Test Acc: 0.611
Validation loss decreased (-0.530138 --> -0.606157).  Saving model ...
Epoch: 15 cost time: 37.96542406082153
Epoch: 15, Steps: 64 | Train Loss: 27.674 Vali Loss: 416.606 Vali Acc: 0.641 Test Loss: 416.606 Test Acc: 0.641
Validation loss decreased (-0.606157 --> -0.637055).  Saving model ...
Epoch: 16 cost time: 37.79212403297424
Epoch: 16, Steps: 64 | Train Loss: 12.354 Vali Loss: 764.328 Vali Acc: 0.336 Test Loss: 764.328 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 38.14549899101257
Epoch: 17, Steps: 64 | Train Loss: 75.058 Vali Loss: 652.021 Vali Acc: 0.534 Test Loss: 652.021 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 37.49857306480408
Epoch: 18, Steps: 64 | Train Loss: 46.402 Vali Loss: 632.994 Vali Acc: 0.519 Test Loss: 632.994 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 37.48161816596985
Epoch: 19, Steps: 64 | Train Loss: 30.828 Vali Loss: 749.017 Vali Acc: 0.481 Test Loss: 749.017 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 37.64516830444336
Epoch: 20, Steps: 64 | Train Loss: 13.134 Vali Loss: 961.125 Vali Acc: 0.351 Test Loss: 961.125 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 37.56460189819336
Epoch: 21, Steps: 64 | Train Loss: 4.147 Vali Loss: 829.208 Vali Acc: 0.550 Test Loss: 829.208 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 37.522465467453
Epoch: 22, Steps: 64 | Train Loss: 11.615 Vali Loss: 702.364 Vali Acc: 0.496 Test Loss: 702.364 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 37.33792304992676
Epoch: 23, Steps: 64 | Train Loss: 6.949 Vali Loss: 972.580 Vali Acc: 0.595 Test Loss: 972.580 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 37.95840287208557
Epoch: 24, Steps: 64 | Train Loss: 22.815 Vali Loss: 1013.048 Vali Acc: 0.573 Test Loss: 1013.048 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 37.43792724609375
Epoch: 25, Steps: 64 | Train Loss: 4.485 Vali Loss: 1028.142 Vali Acc: 0.611 Test Loss: 1028.142 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 51313749
model size : 230.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.000834465026855
Epoch: 1, Steps: 64 | Train Loss: 149.081 Vali Loss: 391.560 Vali Acc: 0.176 Test Loss: 391.560 Test Acc: 0.176
Validation loss decreased (inf --> -0.171657).  Saving model ...
Epoch: 2 cost time: 35.23080134391785
Epoch: 2, Steps: 64 | Train Loss: 232.021 Vali Loss: 116.974 Vali Acc: 0.450 Test Loss: 116.974 Test Acc: 0.450
Validation loss decreased (-0.171657 --> -0.449212).  Saving model ...
Epoch: 3 cost time: 36.0664918422699
Epoch: 3, Steps: 64 | Train Loss: 179.728 Vali Loss: 417.211 Vali Acc: 0.191 Test Loss: 417.211 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.772932291030884
Epoch: 4, Steps: 64 | Train Loss: 179.438 Vali Loss: 424.256 Vali Acc: 0.328 Test Loss: 424.256 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 35.465243101119995
Epoch: 5, Steps: 64 | Train Loss: 149.851 Vali Loss: 404.896 Vali Acc: 0.344 Test Loss: 404.896 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 35.14553236961365
Epoch: 6, Steps: 64 | Train Loss: 84.904 Vali Loss: 336.878 Vali Acc: 0.473 Test Loss: 336.878 Test Acc: 0.473
Validation loss decreased (-0.449212 --> -0.469914).  Saving model ...
Epoch: 7 cost time: 36.98197340965271
Epoch: 7, Steps: 64 | Train Loss: 74.540 Vali Loss: 635.452 Vali Acc: 0.519 Test Loss: 635.452 Test Acc: 0.519
Validation loss decreased (-0.469914 --> -0.512729).  Saving model ...
Epoch: 8 cost time: 36.18838143348694
Epoch: 8, Steps: 64 | Train Loss: 85.170 Vali Loss: 743.137 Vali Acc: 0.336 Test Loss: 743.137 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 36.2626895904541
Epoch: 9, Steps: 64 | Train Loss: 45.628 Vali Loss: 426.085 Vali Acc: 0.496 Test Loss: 426.085 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 36.69220566749573
Epoch: 10, Steps: 64 | Train Loss: 52.265 Vali Loss: 234.922 Vali Acc: 0.603 Test Loss: 234.922 Test Acc: 0.603
Validation loss decreased (-0.512729 --> -0.600704).  Saving model ...
Epoch: 11 cost time: 36.86064887046814
Epoch: 11, Steps: 64 | Train Loss: 70.622 Vali Loss: 300.357 Vali Acc: 0.542 Test Loss: 300.357 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 36.41028571128845
Epoch: 12, Steps: 64 | Train Loss: 39.934 Vali Loss: 510.577 Vali Acc: 0.588 Test Loss: 510.577 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 36.43036675453186
Epoch: 13, Steps: 64 | Train Loss: 19.013 Vali Loss: 977.503 Vali Acc: 0.481 Test Loss: 977.503 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 36.74553656578064
Epoch: 14, Steps: 64 | Train Loss: 25.518 Vali Loss: 746.004 Vali Acc: 0.557 Test Loss: 746.004 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 36.19800901412964
Epoch: 15, Steps: 64 | Train Loss: 1.566 Vali Loss: 734.324 Vali Acc: 0.466 Test Loss: 734.324 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 35.77144169807434
Epoch: 16, Steps: 64 | Train Loss: 12.909 Vali Loss: 793.722 Vali Acc: 0.557 Test Loss: 793.722 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 35.68384671211243
Epoch: 17, Steps: 64 | Train Loss: 33.877 Vali Loss: 917.250 Vali Acc: 0.565 Test Loss: 917.250 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 35.38340640068054
Epoch: 18, Steps: 64 | Train Loss: 103.378 Vali Loss: 411.873 Vali Acc: 0.664 Test Loss: 411.873 Test Acc: 0.664
Validation loss decreased (-0.600704 --> -0.660003).  Saving model ...
Epoch: 19 cost time: 35.446533203125
Epoch: 19, Steps: 64 | Train Loss: 28.773 Vali Loss: 1151.681 Vali Acc: 0.351 Test Loss: 1151.681 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 34.96318292617798
Epoch: 20, Steps: 64 | Train Loss: 38.620 Vali Loss: 404.716 Vali Acc: 0.649 Test Loss: 404.716 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 35.34440612792969
Epoch: 21, Steps: 64 | Train Loss: 0.078 Vali Loss: 508.865 Vali Acc: 0.595 Test Loss: 508.865 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 35.56188750267029
Epoch: 22, Steps: 64 | Train Loss: 44.007 Vali Loss: 802.731 Vali Acc: 0.344 Test Loss: 802.731 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 35.58534073829651
Epoch: 23, Steps: 64 | Train Loss: 138.217 Vali Loss: 677.258 Vali Acc: 0.519 Test Loss: 677.258 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 35.52382683753967
Epoch: 24, Steps: 64 | Train Loss: 9.930 Vali Loss: 1180.590 Vali Acc: 0.618 Test Loss: 1180.590 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 35.579413175582886
Epoch: 25, Steps: 64 | Train Loss: 71.264 Vali Loss: 1796.869 Vali Acc: 0.565 Test Loss: 1796.869 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 35.98513317108154
Epoch: 26, Steps: 64 | Train Loss: 54.388 Vali Loss: 1174.745 Vali Acc: 0.611 Test Loss: 1174.745 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 36.06005120277405
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 1191.399 Vali Acc: 0.603 Test Loss: 1191.399 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 36.274200439453125
Epoch: 28, Steps: 64 | Train Loss: 0.000 Vali Loss: 1191.426 Vali Acc: 0.603 Test Loss: 1191.426 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 51313749
model size : 230.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         1                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
	iters: 100, epoch: 1 | loss: 319.1481323
	speed: 0.2987s/iter; left time: 3793.8941s
Epoch: 1 cost time: 37.783955574035645
Epoch: 1, Steps: 128 | Train Loss: 156.869 Vali Loss: 753.227 Vali Acc: 0.443 Test Loss: 753.227 Test Acc: 0.443
Validation loss decreased (inf --> -0.435216).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.7268s/iter; left time: 9137.5864s
Epoch: 2 cost time: 37.1523871421814
Epoch: 2, Steps: 128 | Train Loss: 481.234 Vali Loss: 543.314 Vali Acc: 0.397 Test Loss: 543.314 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.7259s/iter; left time: 9033.3556s
Epoch: 3 cost time: 36.72399950027466
Epoch: 3, Steps: 128 | Train Loss: 218.909 Vali Loss: 386.353 Vali Acc: 0.298 Test Loss: 386.353 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.6997s/iter; left time: 8618.5654s
Epoch: 4 cost time: 37.367436170578
Epoch: 4, Steps: 128 | Train Loss: 162.420 Vali Loss: 424.203 Vali Acc: 0.359 Test Loss: 424.203 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7150s/iter; left time: 8715.6752s
Epoch: 5 cost time: 37.209904193878174
Epoch: 5, Steps: 128 | Train Loss: 194.737 Vali Loss: 776.696 Vali Acc: 0.595 Test Loss: 776.696 Test Acc: 0.595
Validation loss decreased (-0.435216 --> -0.587653).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.7471s/iter; left time: 9010.4776s
Epoch: 6 cost time: 36.822614431381226
Epoch: 6, Steps: 128 | Train Loss: 99.642 Vali Loss: 917.296 Vali Acc: 0.550 Test Loss: 917.296 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 38.8482056
	speed: 0.7297s/iter; left time: 8707.1752s
Epoch: 7 cost time: 37.071840047836304
Epoch: 7, Steps: 128 | Train Loss: 113.842 Vali Loss: 1233.844 Vali Acc: 0.534 Test Loss: 1233.844 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7003s/iter; left time: 8266.9771s
Epoch: 8 cost time: 37.51807880401611
Epoch: 8, Steps: 128 | Train Loss: 210.731 Vali Loss: 603.161 Vali Acc: 0.588 Test Loss: 603.161 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7157s/iter; left time: 8357.4543s
Epoch: 9 cost time: 37.4043288230896
Epoch: 9, Steps: 128 | Train Loss: 72.910 Vali Loss: 691.768 Vali Acc: 0.542 Test Loss: 691.768 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7184s/iter; left time: 8297.0824s
Epoch: 10 cost time: 37.00539255142212
Epoch: 10, Steps: 128 | Train Loss: 55.826 Vali Loss: 1058.723 Vali Acc: 0.450 Test Loss: 1058.723 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.7225s/iter; left time: 8251.5503s
Epoch: 11 cost time: 38.02063250541687
Epoch: 11, Steps: 128 | Train Loss: 43.677 Vali Loss: 724.370 Vali Acc: 0.580 Test Loss: 724.370 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7030s/iter; left time: 7939.4368s
Epoch: 12 cost time: 36.83674645423889
Epoch: 12, Steps: 128 | Train Loss: 31.079 Vali Loss: 523.939 Vali Acc: 0.626 Test Loss: 523.939 Test Acc: 0.626
Validation loss decreased (-0.587653 --> -0.620715).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7609s/iter; left time: 8495.3866s
Epoch: 13 cost time: 36.932578563690186
Epoch: 13, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620715 --> -0.620737).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.7486s/iter; left time: 8262.2353s
Epoch: 14 cost time: 36.31041717529297
Epoch: 14, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7581s/iter; left time: 8269.6191s
Epoch: 15 cost time: 37.16579794883728
Epoch: 15, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7299s/iter; left time: 7869.3072s
Epoch: 16 cost time: 37.184483766555786
Epoch: 16, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.7365s/iter; left time: 7845.7257s
Epoch: 17 cost time: 36.937206745147705
Epoch: 17, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.7428s/iter; left time: 7817.9861s
Epoch: 18 cost time: 36.30733823776245
Epoch: 18, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000000
	speed: 0.7525s/iter; left time: 7823.3011s
Epoch: 19 cost time: 37.037333488464355
Epoch: 19, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.7382s/iter; left time: 7581.0528s
Epoch: 20 cost time: 36.883723974227905
Epoch: 20, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 21 | loss: 0.0000000
	speed: 0.7483s/iter; left time: 7588.9034s
Epoch: 21 cost time: 37.87135457992554
Epoch: 21, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.7326s/iter; left time: 7335.6436s
Epoch: 22 cost time: 36.99238562583923
Epoch: 22, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.7503s/iter; left time: 7416.7510s
Epoch: 23 cost time: 36.84420585632324
Epoch: 23, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.7445s/iter; left time: 7264.0099s
Epoch: 24 cost time: 36.13261103630066
Epoch: 24, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000000
	speed: 0.7493s/iter; left time: 7214.6423s
Epoch: 25 cost time: 37.22053837776184
Epoch: 25, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.7284s/iter; left time: 6920.4931s
Epoch: 26 cost time: 37.1874794960022
Epoch: 26, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000000
	speed: 0.7437s/iter; left time: 6970.4212s
Epoch: 27 cost time: 37.55595278739929
Epoch: 27, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000000
	speed: 0.7507s/iter; left time: 6940.4745s
Epoch: 28 cost time: 36.73027205467224
Epoch: 28, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 29 | loss: 0.0000000
	speed: 0.7602s/iter; left time: 6930.3649s
Epoch: 29 cost time: 37.00134825706482
Epoch: 29, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 30 | loss: 0.0000000
	speed: 0.7696s/iter; left time: 6917.4925s
Epoch: 30 cost time: 36.591304540634155
Epoch: 30, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.7433s/iter; left time: 6586.3680s
Epoch: 31 cost time: 37.80765390396118
Epoch: 31, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 32 | loss: 0.0000000
	speed: 0.7282s/iter; left time: 6359.0371s
Epoch: 32 cost time: 36.64370250701904
Epoch: 32, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.7443s/iter; left time: 6405.0351s
Epoch: 33 cost time: 36.528655767440796
Epoch: 33, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 34 | loss: 0.0000000
	speed: 0.7464s/iter; left time: 6327.2750s
Epoch: 34 cost time: 36.62419033050537
Epoch: 34, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.7557s/iter; left time: 6309.7239s
Epoch: 35 cost time: 37.82117819786072
Epoch: 35, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.7388s/iter; left time: 6073.9242s
Epoch: 36 cost time: 36.265751361846924
Epoch: 36, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 37 | loss: 0.0000000
	speed: 0.7556s/iter; left time: 6115.4011s
Epoch: 37 cost time: 36.95560693740845
Epoch: 37, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 38 | loss: 0.0000000
	speed: 0.7459s/iter; left time: 5941.0627s
Epoch: 38 cost time: 36.64381265640259
Epoch: 38, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 39 | loss: 0.0000000
	speed: 0.7728s/iter; left time: 6056.2826s
Epoch: 39 cost time: 37.47600603103638
Epoch: 39, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 40 | loss: 0.0000000
	speed: 0.7307s/iter; left time: 5632.6328s
Epoch: 40 cost time: 36.7623336315155
Epoch: 40, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 41 | loss: 0.0000000
	speed: 0.7599s/iter; left time: 5761.0739s
Epoch: 41 cost time: 36.96264171600342
Epoch: 41, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 42 | loss: 0.0000000
	speed: 0.7474s/iter; left time: 5570.5823s
Epoch: 42 cost time: 36.64665985107422
Epoch: 42, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 43 | loss: 0.0000000
	speed: 0.7505s/iter; left time: 5497.4052s
Epoch: 43 cost time: 37.4071044921875
Epoch: 43, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 44 | loss: 0.0000000
	speed: 0.7277s/iter; left time: 5236.9495s
Epoch: 44 cost time: 36.99409627914429
Epoch: 44, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 45 | loss: 0.0000000
	speed: 0.7394s/iter; left time: 5226.8082s
Epoch: 45 cost time: 37.077120542526245
Epoch: 45, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 46 | loss: 0.0000000
	speed: 0.7371s/iter; left time: 5116.2447s
Epoch: 46 cost time: 36.486945390701294
Epoch: 46, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 47 | loss: 0.0000000
	speed: 0.7697s/iter; left time: 5243.6704s
Epoch: 47 cost time: 37.073031187057495
Epoch: 47, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 48 | loss: 0.0000000
	speed: 0.7446s/iter; left time: 4977.3227s
Epoch: 48 cost time: 37.30305552482605
Epoch: 48, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 49 | loss: 0.0000000
	speed: 0.7450s/iter; left time: 4884.7610s
Epoch: 49 cost time: 37.46840524673462
Epoch: 49, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 50 | loss: 0.0000000
	speed: 0.7380s/iter; left time: 4744.9091s
Epoch: 50 cost time: 36.38366413116455
Epoch: 50, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 51 | loss: 0.0000000
	speed: 0.7505s/iter; left time: 4728.8112s
Epoch: 51 cost time: 36.87852764129639
Epoch: 51, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 52 | loss: 0.0000000
	speed: 0.7392s/iter; left time: 4562.9121s
Epoch: 52 cost time: 36.39695477485657
Epoch: 52, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 53 | loss: 0.0000000
	speed: 0.7526s/iter; left time: 4549.7437s
Epoch: 53 cost time: 37.42698955535889
Epoch: 53, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 54 | loss: 0.0000000
	speed: 0.7324s/iter; left time: 4333.8283s
Epoch: 54 cost time: 36.86846685409546
Epoch: 54, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 55 | loss: 0.0000000
	speed: 0.7584s/iter; left time: 4390.5068s
Epoch: 55 cost time: 37.447317600250244
Epoch: 55, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 56 | loss: 0.0000000
	speed: 0.7534s/iter; left time: 4264.8108s
Epoch: 56 cost time: 36.73590350151062
Epoch: 56, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 57 | loss: 0.0000000
	speed: 0.7569s/iter; left time: 4188.0174s
Epoch: 57 cost time: 36.853174448013306
Epoch: 57, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 58 | loss: 0.0000000
	speed: 0.7527s/iter; left time: 4068.3455s
Epoch: 58 cost time: 36.84074926376343
Epoch: 58, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 59 | loss: 0.0000000
	speed: 0.7453s/iter; left time: 3933.1476s
Epoch: 59 cost time: 38.068047761917114
Epoch: 59, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 60 | loss: 0.0000000
	speed: 0.7499s/iter; left time: 3861.0267s
Epoch: 60 cost time: 36.88294577598572
Epoch: 60, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 61 | loss: 0.0000000
	speed: 0.7502s/iter; left time: 3766.6257s
Epoch: 61 cost time: 37.25136852264404
Epoch: 61, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 62 | loss: 0.0000000
	speed: 0.7735s/iter; left time: 3784.7609s
Epoch: 62 cost time: 36.38239026069641
Epoch: 62, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 63 | loss: 0.0000000
	speed: 0.7416s/iter; left time: 3533.6435s
Epoch: 63 cost time: 37.61100792884827
Epoch: 63, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 64 | loss: 0.0000000
	speed: 0.7299s/iter; left time: 3384.4820s
Epoch: 64 cost time: 36.53338003158569
Epoch: 64, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 65 | loss: 0.0000000
	speed: 0.7615s/iter; left time: 3433.3920s
Epoch: 65 cost time: 36.94218397140503
Epoch: 65, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 66 | loss: 0.0000000
	speed: 0.7492s/iter; left time: 3282.1003s
Epoch: 66 cost time: 37.310526847839355
Epoch: 66, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 67 | loss: 0.0000000
	speed: 0.7834s/iter; left time: 3331.8512s
Epoch: 67 cost time: 37.564939737319946
Epoch: 67, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 68 | loss: 0.0000000
	speed: 0.7275s/iter; left time: 3000.7933s
Epoch: 68 cost time: 37.322479248046875
Epoch: 68, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 69 | loss: 0.0000000
	speed: 0.7518s/iter; left time: 3004.9159s
Epoch: 69 cost time: 36.74938702583313
Epoch: 69, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 70 | loss: 0.0000000
	speed: 0.7279s/iter; left time: 2816.1664s
Epoch: 70 cost time: 36.44928169250488
Epoch: 70, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 71 | loss: 0.0000000
	speed: 0.7644s/iter; left time: 2859.7676s
Epoch: 71 cost time: 37.003583908081055
Epoch: 71, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 72 | loss: 0.0000000
	speed: 0.7434s/iter; left time: 2685.7739s
Epoch: 72 cost time: 37.26943850517273
Epoch: 72, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 73 | loss: 0.0000000
	speed: 0.7528s/iter; left time: 2623.4988s
Epoch: 73 cost time: 38.307488203048706
Epoch: 73, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 74 | loss: 0.0000000
	speed: 0.7344s/iter; left time: 2465.5474s
Epoch: 74 cost time: 37.35438346862793
Epoch: 74, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 75 | loss: 0.0000000
	speed: 0.7505s/iter; left time: 2423.3910s
Epoch: 75 cost time: 36.79807996749878
Epoch: 75, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 76 | loss: 0.0000000
	speed: 0.7429s/iter; left time: 2303.8031s
Epoch: 76 cost time: 36.17951679229736
Epoch: 76, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 77 | loss: 0.0000000
	speed: 0.7719s/iter; left time: 2294.8830s
Epoch: 77 cost time: 36.801390171051025
Epoch: 77, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 78 | loss: 0.0000000
	speed: 0.7383s/iter; left time: 2100.3512s
Epoch: 78 cost time: 37.18789577484131
Epoch: 78, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 79 | loss: 0.0000000
	speed: 0.7634s/iter; left time: 2074.2892s
Epoch: 79 cost time: 37.88914346694946
Epoch: 79, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 80 | loss: 0.0000000
	speed: 0.7305s/iter; left time: 1891.3178s
Epoch: 80 cost time: 36.80632019042969
Epoch: 80, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 81 | loss: 0.0000000
	speed: 0.7634s/iter; left time: 1878.7529s
Epoch: 81 cost time: 36.96569609642029
Epoch: 81, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 82 | loss: 0.0000000
	speed: 0.7412s/iter; left time: 1729.2901s
Epoch: 82 cost time: 36.5635986328125
Epoch: 82, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 83 | loss: 0.0000000
	speed: 0.7566s/iter; left time: 1668.3381s
Epoch: 83 cost time: 37.47684192657471
Epoch: 83, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 84 | loss: 0.0000000
	speed: 0.7326s/iter; left time: 1521.5634s
Epoch: 84 cost time: 36.76263356208801
Epoch: 84, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 85 | loss: 0.0000000
	speed: 0.7478s/iter; left time: 1457.4733s
Epoch: 85 cost time: 37.08116316795349
Epoch: 85, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 86 | loss: 0.0000000
	speed: 0.7741s/iter; left time: 1409.5566s
Epoch: 86 cost time: 37.10379385948181
Epoch: 86, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 87 | loss: 0.0000000
	speed: 0.7294s/iter; left time: 1234.7896s
Epoch: 87 cost time: 37.25582981109619
Epoch: 87, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 88 | loss: 0.0000000
	speed: 0.7448s/iter; left time: 1165.5512s
Epoch: 88 cost time: 35.985053062438965
Epoch: 88, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 89 | loss: 0.0000000
	speed: 0.7409s/iter; left time: 1064.6448s
Epoch: 89 cost time: 36.80446791648865
Epoch: 89, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 90 | loss: 0.0000000
	speed: 0.7596s/iter; left time: 994.3336s
Epoch: 90 cost time: 36.959871768951416
Epoch: 90, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 91 | loss: 0.0000000
	speed: 0.7418s/iter; left time: 876.0111s
Epoch: 91 cost time: 37.950313329696655
Epoch: 91, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 92 | loss: 0.0000000
	speed: 0.7581s/iter; left time: 798.2328s
Epoch: 92 cost time: 37.680561542510986
Epoch: 92, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 93 | loss: 0.0000000
	speed: 0.7365s/iter; left time: 681.2796s
Epoch: 93 cost time: 36.5467963218689
Epoch: 93, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 94 | loss: 0.0000000
	speed: 0.7623s/iter; left time: 607.5240s
Epoch: 94 cost time: 37.00822615623474
Epoch: 94, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 95 | loss: 0.0000000
	speed: 0.7442s/iter; left time: 497.8868s
Epoch: 95 cost time: 36.91651630401611
Epoch: 95, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 96 | loss: 0.0000000
	speed: 0.7513s/iter; left time: 406.4664s
Epoch: 96 cost time: 38.007113456726074
Epoch: 96, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 97 | loss: 0.0000000
	speed: 0.7409s/iter; left time: 305.9773s
Epoch: 97 cost time: 37.27206254005432
Epoch: 97, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 98 | loss: 0.0000000
	speed: 0.7430s/iter; left time: 211.7600s
Epoch: 98 cost time: 37.32072901725769
Epoch: 98, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 99 | loss: 0.0000000
	speed: 0.7560s/iter; left time: 118.6970s
Epoch: 99 cost time: 36.40050983428955
Epoch: 99, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
	iters: 100, epoch: 100 | loss: 0.0000000
	speed: 0.7496s/iter; left time: 21.7397s
Epoch: 100 cost time: 37.202314615249634
Epoch: 100, Steps: 128 | Train Loss: 0.000 Vali Loss: 521.706 Vali Acc: 0.626 Test Loss: 521.706 Test Acc: 0.626
Validation loss decreased (-0.620737 --> -0.620737).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 49216597
model size : 222.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.25162649154663
Epoch: 1, Steps: 64 | Train Loss: 146.631 Vali Loss: 191.427 Vali Acc: 0.389 Test Loss: 191.427 Test Acc: 0.389
Validation loss decreased (inf --> -0.387399).  Saving model ...
Epoch: 2 cost time: 32.438801288604736
Epoch: 2, Steps: 64 | Train Loss: 172.247 Vali Loss: 157.165 Vali Acc: 0.519 Test Loss: 157.165 Test Acc: 0.519
Validation loss decreased (-0.387399 --> -0.517512).  Saving model ...
Epoch: 3 cost time: 32.629430532455444
Epoch: 3, Steps: 64 | Train Loss: 307.331 Vali Loss: 277.737 Vali Acc: 0.267 Test Loss: 277.737 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.69043445587158
Epoch: 4, Steps: 64 | Train Loss: 163.886 Vali Loss: 330.305 Vali Acc: 0.198 Test Loss: 330.305 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.700265884399414
Epoch: 5, Steps: 64 | Train Loss: 97.963 Vali Loss: 222.609 Vali Acc: 0.496 Test Loss: 222.609 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 32.17478013038635
Epoch: 6, Steps: 64 | Train Loss: 81.137 Vali Loss: 691.572 Vali Acc: 0.229 Test Loss: 691.572 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 32.983657121658325
Epoch: 7, Steps: 64 | Train Loss: 85.414 Vali Loss: 239.748 Vali Acc: 0.481 Test Loss: 239.748 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 32.50604057312012
Epoch: 8, Steps: 64 | Train Loss: 91.519 Vali Loss: 405.075 Vali Acc: 0.382 Test Loss: 405.075 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 32.74755382537842
Epoch: 9, Steps: 64 | Train Loss: 56.120 Vali Loss: 349.334 Vali Acc: 0.626 Test Loss: 349.334 Test Acc: 0.626
Validation loss decreased (-0.517512 --> -0.622461).  Saving model ...
Epoch: 10 cost time: 32.84980010986328
Epoch: 10, Steps: 64 | Train Loss: 6.565 Vali Loss: 500.939 Vali Acc: 0.290 Test Loss: 500.939 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 32.41208362579346
Epoch: 11, Steps: 64 | Train Loss: 51.147 Vali Loss: 329.483 Vali Acc: 0.557 Test Loss: 329.483 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 32.68909525871277
Epoch: 12, Steps: 64 | Train Loss: 16.753 Vali Loss: 1130.369 Vali Acc: 0.206 Test Loss: 1130.369 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 32.93245840072632
Epoch: 13, Steps: 64 | Train Loss: 40.974 Vali Loss: 335.124 Vali Acc: 0.557 Test Loss: 335.124 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 32.930121421813965
Epoch: 14, Steps: 64 | Train Loss: 91.577 Vali Loss: 964.924 Vali Acc: 0.565 Test Loss: 964.924 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 32.86959457397461
Epoch: 15, Steps: 64 | Train Loss: 48.180 Vali Loss: 957.575 Vali Acc: 0.565 Test Loss: 957.575 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 32.29749393463135
Epoch: 16, Steps: 64 | Train Loss: 9.179 Vali Loss: 1128.815 Vali Acc: 0.611 Test Loss: 1128.815 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 33.26850914955139
Epoch: 17, Steps: 64 | Train Loss: 29.716 Vali Loss: 1077.376 Vali Acc: 0.580 Test Loss: 1077.376 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 32.87246251106262
Epoch: 18, Steps: 64 | Train Loss: 25.519 Vali Loss: 960.128 Vali Acc: 0.626 Test Loss: 960.128 Test Acc: 0.626
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 32.497469425201416
Epoch: 19, Steps: 64 | Train Loss: 4.548 Vali Loss: 956.429 Vali Acc: 0.573 Test Loss: 956.429 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 51313749
model size : 230.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.56376552581787
Epoch: 1, Steps: 64 | Train Loss: 68.835 Vali Loss: 261.656 Vali Acc: 0.252 Test Loss: 261.656 Test Acc: 0.252
Validation loss decreased (inf --> -0.249292).  Saving model ...
Epoch: 2 cost time: 35.17224049568176
Epoch: 2, Steps: 64 | Train Loss: 148.488 Vali Loss: 137.716 Vali Acc: 0.511 Test Loss: 137.716 Test Acc: 0.511
Validation loss decreased (-0.249292 --> -0.510073).  Saving model ...
Epoch: 3 cost time: 35.22417235374451
Epoch: 3, Steps: 64 | Train Loss: 162.003 Vali Loss: 150.817 Vali Acc: 0.359 Test Loss: 150.817 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.036360025405884
Epoch: 4, Steps: 64 | Train Loss: 137.501 Vali Loss: 203.884 Vali Acc: 0.550 Test Loss: 203.884 Test Acc: 0.550
Validation loss decreased (-0.510073 --> -0.547579).  Saving model ...
Epoch: 5 cost time: 35.30805730819702
Epoch: 5, Steps: 64 | Train Loss: 69.897 Vali Loss: 224.789 Vali Acc: 0.550 Test Loss: 224.789 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 35.07717037200928
Epoch: 6, Steps: 64 | Train Loss: 75.039 Vali Loss: 315.225 Vali Acc: 0.313 Test Loss: 315.225 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 35.53526473045349
Epoch: 7, Steps: 64 | Train Loss: 165.561 Vali Loss: 614.784 Vali Acc: 0.374 Test Loss: 614.784 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 34.84165358543396
Epoch: 8, Steps: 64 | Train Loss: 62.611 Vali Loss: 544.051 Vali Acc: 0.504 Test Loss: 544.051 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 35.026126861572266
Epoch: 9, Steps: 64 | Train Loss: 65.712 Vali Loss: 533.751 Vali Acc: 0.618 Test Loss: 533.751 Test Acc: 0.618
Validation loss decreased (-0.547579 --> -0.612983).  Saving model ...
Epoch: 10 cost time: 35.81386852264404
Epoch: 10, Steps: 64 | Train Loss: 32.327 Vali Loss: 781.033 Vali Acc: 0.313 Test Loss: 781.033 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 34.93043756484985
Epoch: 11, Steps: 64 | Train Loss: 3.966 Vali Loss: 602.707 Vali Acc: 0.527 Test Loss: 602.707 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 35.255282402038574
Epoch: 12, Steps: 64 | Train Loss: 23.101 Vali Loss: 913.384 Vali Acc: 0.557 Test Loss: 913.384 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 35.25670671463013
Epoch: 13, Steps: 64 | Train Loss: 96.909 Vali Loss: 943.105 Vali Acc: 0.282 Test Loss: 943.105 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 35.25680446624756
Epoch: 14, Steps: 64 | Train Loss: 34.041 Vali Loss: 947.367 Vali Acc: 0.229 Test Loss: 947.367 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 35.06070923805237
Epoch: 15, Steps: 64 | Train Loss: 22.042 Vali Loss: 679.962 Vali Acc: 0.603 Test Loss: 679.962 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 35.176626205444336
Epoch: 16, Steps: 64 | Train Loss: 28.772 Vali Loss: 708.059 Vali Acc: 0.527 Test Loss: 708.059 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 35.11557364463806
Epoch: 17, Steps: 64 | Train Loss: 39.793 Vali Loss: 681.370 Vali Acc: 0.366 Test Loss: 681.370 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 34.937010765075684
Epoch: 18, Steps: 64 | Train Loss: 25.378 Vali Loss: 465.376 Vali Acc: 0.580 Test Loss: 465.376 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 35.654741048812866
Epoch: 19, Steps: 64 | Train Loss: 45.042 Vali Loss: 931.636 Vali Acc: 0.489 Test Loss: 931.636 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 49216597
model size : 222.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.15572261810303
Epoch: 1, Steps: 64 | Train Loss: 78.087 Vali Loss: 277.016 Vali Acc: 0.473 Test Loss: 277.016 Test Acc: 0.473
Validation loss decreased (inf --> -0.470512).  Saving model ...
Epoch: 2 cost time: 32.97509407997131
Epoch: 2, Steps: 64 | Train Loss: 163.917 Vali Loss: 214.048 Vali Acc: 0.481 Test Loss: 214.048 Test Acc: 0.481
Validation loss decreased (-0.470512 --> -0.478776).  Saving model ...
Epoch: 3 cost time: 32.89639735221863
Epoch: 3, Steps: 64 | Train Loss: 324.768 Vali Loss: 381.831 Vali Acc: 0.313 Test Loss: 381.831 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 32.98682355880737
Epoch: 4, Steps: 64 | Train Loss: 219.720 Vali Loss: 383.216 Vali Acc: 0.450 Test Loss: 383.216 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 32.519217014312744
Epoch: 5, Steps: 64 | Train Loss: 129.456 Vali Loss: 433.412 Vali Acc: 0.511 Test Loss: 433.412 Test Acc: 0.511
Validation loss decreased (-0.478776 --> -0.507116).  Saving model ...
Epoch: 6 cost time: 33.07968044281006
Epoch: 6, Steps: 64 | Train Loss: 68.054 Vali Loss: 308.382 Vali Acc: 0.611 Test Loss: 308.382 Test Acc: 0.611
Validation loss decreased (-0.507116 --> -0.607603).  Saving model ...
Epoch: 7 cost time: 33.021092891693115
Epoch: 7, Steps: 64 | Train Loss: 104.607 Vali Loss: 488.875 Vali Acc: 0.511 Test Loss: 488.875 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 32.32503652572632
Epoch: 8, Steps: 64 | Train Loss: 51.774 Vali Loss: 386.441 Vali Acc: 0.542 Test Loss: 386.441 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 32.884557008743286
Epoch: 9, Steps: 64 | Train Loss: 64.675 Vali Loss: 964.300 Vali Acc: 0.237 Test Loss: 964.300 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 32.454169273376465
Epoch: 10, Steps: 64 | Train Loss: 125.353 Vali Loss: 607.298 Vali Acc: 0.580 Test Loss: 607.298 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 32.67619037628174
Epoch: 11, Steps: 64 | Train Loss: 4.011 Vali Loss: 463.838 Vali Acc: 0.420 Test Loss: 463.838 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 32.384445905685425
Epoch: 12, Steps: 64 | Train Loss: 13.075 Vali Loss: 472.113 Vali Acc: 0.557 Test Loss: 472.113 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 32.712175369262695
Epoch: 13, Steps: 64 | Train Loss: 0.136 Vali Loss: 506.581 Vali Acc: 0.557 Test Loss: 506.581 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 32.499645948410034
Epoch: 14, Steps: 64 | Train Loss: 13.419 Vali Loss: 514.274 Vali Acc: 0.511 Test Loss: 514.274 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 32.504478931427
Epoch: 15, Steps: 64 | Train Loss: 15.726 Vali Loss: 658.182 Vali Acc: 0.534 Test Loss: 658.182 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 32.77702260017395
Epoch: 16, Steps: 64 | Train Loss: 53.607 Vali Loss: 410.770 Vali Acc: 0.550 Test Loss: 410.770 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 49216597
model size : 222.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 30.0288405418396
Epoch: 1, Steps: 32 | Train Loss: 34.881 Vali Loss: 100.000 Vali Acc: 0.473 Test Loss: 100.000 Test Acc: 0.473
Validation loss decreased (inf --> -0.472282).  Saving model ...
Epoch: 2 cost time: 27.948830366134644
Epoch: 2, Steps: 32 | Train Loss: 67.078 Vali Loss: 110.062 Vali Acc: 0.420 Test Loss: 110.062 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 28.40987753868103
Epoch: 3, Steps: 32 | Train Loss: 63.848 Vali Loss: 71.849 Vali Acc: 0.275 Test Loss: 71.849 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 28.112017154693604
Epoch: 4, Steps: 32 | Train Loss: 72.857 Vali Loss: 123.660 Vali Acc: 0.481 Test Loss: 123.660 Test Acc: 0.481
Validation loss decreased (-0.472282 --> -0.479679).  Saving model ...
Epoch: 5 cost time: 28.23539113998413
Epoch: 5, Steps: 32 | Train Loss: 143.264 Vali Loss: 188.183 Vali Acc: 0.565 Test Loss: 188.183 Test Acc: 0.565
Validation loss decreased (-0.479679 --> -0.563004).  Saving model ...
Epoch: 6 cost time: 27.8851957321167
Epoch: 6, Steps: 32 | Train Loss: 65.893 Vali Loss: 175.263 Vali Acc: 0.557 Test Loss: 175.263 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 27.561381101608276
Epoch: 7, Steps: 32 | Train Loss: 111.262 Vali Loss: 286.658 Vali Acc: 0.565 Test Loss: 286.658 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 28.02888774871826
Epoch: 8, Steps: 32 | Train Loss: 61.641 Vali Loss: 217.581 Vali Acc: 0.588 Test Loss: 217.581 Test Acc: 0.588
Validation loss decreased (-0.563004 --> -0.585610).  Saving model ...
Epoch: 9 cost time: 27.910768747329712
Epoch: 9, Steps: 32 | Train Loss: 85.982 Vali Loss: 651.095 Vali Acc: 0.298 Test Loss: 651.095 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.80580449104309
Epoch: 10, Steps: 32 | Train Loss: 13.689 Vali Loss: 255.855 Vali Acc: 0.611 Test Loss: 255.855 Test Acc: 0.611
Validation loss decreased (-0.585610 --> -0.608128).  Saving model ...
Epoch: 11 cost time: 27.68465304374695
Epoch: 11, Steps: 32 | Train Loss: 5.064 Vali Loss: 389.558 Vali Acc: 0.237 Test Loss: 389.558 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 27.924635887145996
Epoch: 12, Steps: 32 | Train Loss: 13.415 Vali Loss: 233.725 Vali Acc: 0.603 Test Loss: 233.725 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 27.938093185424805
Epoch: 13, Steps: 32 | Train Loss: 14.593 Vali Loss: 349.038 Vali Acc: 0.580 Test Loss: 349.038 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 27.831685781478882
Epoch: 14, Steps: 32 | Train Loss: 7.255 Vali Loss: 299.775 Vali Acc: 0.466 Test Loss: 299.775 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 28.169401168823242
Epoch: 15, Steps: 32 | Train Loss: 17.817 Vali Loss: 267.849 Vali Acc: 0.626 Test Loss: 267.849 Test Acc: 0.626
Validation loss decreased (-0.608128 --> -0.623276).  Saving model ...
Epoch: 16 cost time: 28.052098035812378
Epoch: 16, Steps: 32 | Train Loss: 31.773 Vali Loss: 531.533 Vali Acc: 0.305 Test Loss: 531.533 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 27.964622259140015
Epoch: 17, Steps: 32 | Train Loss: 28.526 Vali Loss: 297.439 Vali Acc: 0.496 Test Loss: 297.439 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 28.239240884780884
Epoch: 18, Steps: 32 | Train Loss: 2.101 Vali Loss: 533.127 Vali Acc: 0.382 Test Loss: 533.127 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 28.19113278388977
Epoch: 19, Steps: 32 | Train Loss: 25.037 Vali Loss: 420.699 Vali Acc: 0.427 Test Loss: 420.699 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 27.91474723815918
Epoch: 20, Steps: 32 | Train Loss: 21.206 Vali Loss: 362.637 Vali Acc: 0.611 Test Loss: 362.637 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 27.749160766601562
Epoch: 21, Steps: 32 | Train Loss: 3.957 Vali Loss: 677.024 Vali Acc: 0.458 Test Loss: 677.024 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 28.244098663330078
Epoch: 22, Steps: 32 | Train Loss: 18.912 Vali Loss: 548.464 Vali Acc: 0.557 Test Loss: 548.464 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 28.134337902069092
Epoch: 23, Steps: 32 | Train Loss: 5.831 Vali Loss: 407.506 Vali Acc: 0.611 Test Loss: 407.506 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 27.880539655685425
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 407.522 Vali Acc: 0.595 Test Loss: 407.522 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 28.241736888885498
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 407.565 Vali Acc: 0.595 Test Loss: 407.565 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 49216597
model size : 222.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         1                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
	iters: 100, epoch: 1 | loss: 0.0000000
	speed: 0.2852s/iter; left time: 3621.7045s
Epoch: 1 cost time: 36.081499338150024
Epoch: 1, Steps: 128 | Train Loss: 312.750 Vali Loss: 283.631 Vali Acc: 0.450 Test Loss: 283.631 Test Acc: 0.450
Validation loss decreased (inf --> -0.447545).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000000
	speed: 0.7148s/iter; left time: 8987.6982s
Epoch: 2 cost time: 36.0313880443573
Epoch: 2, Steps: 128 | Train Loss: 160.162 Vali Loss: 299.418 Vali Acc: 0.458 Test Loss: 299.418 Test Acc: 0.458
Validation loss decreased (-0.447545 --> -0.455021).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0000000
	speed: 0.7185s/iter; left time: 8941.5819s
Epoch: 3 cost time: 35.79127311706543
Epoch: 3, Steps: 128 | Train Loss: 484.016 Vali Loss: 1102.815 Vali Acc: 0.443 Test Loss: 1102.815 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 1608.5235596
	speed: 0.6807s/iter; left time: 8384.4074s
Epoch: 4 cost time: 36.40643906593323
Epoch: 4, Steps: 128 | Train Loss: 253.958 Vali Loss: 457.592 Vali Acc: 0.374 Test Loss: 457.592 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.6986s/iter; left time: 8514.6987s
Epoch: 5 cost time: 35.79574918746948
Epoch: 5, Steps: 128 | Train Loss: 82.771 Vali Loss: 617.929 Vali Acc: 0.450 Test Loss: 617.929 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0000000
	speed: 0.6943s/iter; left time: 8374.0366s
Epoch: 6 cost time: 35.987826347351074
Epoch: 6, Steps: 128 | Train Loss: 155.057 Vali Loss: 446.395 Vali Acc: 0.573 Test Loss: 446.395 Test Acc: 0.573
Validation loss decreased (-0.455021 --> -0.568055).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7415s/iter; left time: 8848.4730s
Epoch: 7 cost time: 36.72610807418823
Epoch: 7, Steps: 128 | Train Loss: 107.467 Vali Loss: 486.389 Vali Acc: 0.588 Test Loss: 486.389 Test Acc: 0.588
Validation loss decreased (-0.568055 --> -0.582922).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7212s/iter; left time: 8513.2133s
Epoch: 8 cost time: 36.672170639038086
Epoch: 8, Steps: 128 | Train Loss: 35.529 Vali Loss: 518.511 Vali Acc: 0.603 Test Loss: 518.511 Test Acc: 0.603
Validation loss decreased (-0.582922 --> -0.597868).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0000000
	speed: 0.7355s/iter; left time: 8588.8795s
Epoch: 9 cost time: 36.19814324378967
Epoch: 9, Steps: 128 | Train Loss: 36.765 Vali Loss: 600.270 Vali Acc: 0.595 Test Loss: 600.270 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7262s/iter; left time: 8386.9704s
Epoch: 10 cost time: 36.69154167175293
Epoch: 10, Steps: 128 | Train Loss: 52.960 Vali Loss: 648.193 Vali Acc: 0.588 Test Loss: 648.193 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6961s/iter; left time: 7950.1619s
Epoch: 11 cost time: 36.54185771942139
Epoch: 11, Steps: 128 | Train Loss: 19.652 Vali Loss: 952.622 Vali Acc: 0.466 Test Loss: 952.622 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.6945s/iter; left time: 7843.4154s
Epoch: 12 cost time: 35.615134477615356
Epoch: 12, Steps: 128 | Train Loss: 237.905 Vali Loss: 1821.804 Vali Acc: 0.511 Test Loss: 1821.804 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7157s/iter; left time: 7990.4150s
Epoch: 13 cost time: 36.35057330131531
Epoch: 13, Steps: 128 | Train Loss: 94.152 Vali Loss: 1568.409 Vali Acc: 0.511 Test Loss: 1568.409 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000000
	speed: 0.6849s/iter; left time: 7558.7843s
Epoch: 14 cost time: 35.695629835128784
Epoch: 14, Steps: 128 | Train Loss: 37.707 Vali Loss: 1308.813 Vali Acc: 0.527 Test Loss: 1308.813 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000000
	speed: 0.7227s/iter; left time: 7883.8451s
Epoch: 15 cost time: 35.98078894615173
Epoch: 15, Steps: 128 | Train Loss: 0.000 Vali Loss: 1434.847 Vali Acc: 0.550 Test Loss: 1434.847 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0000000
	speed: 0.7037s/iter; left time: 7586.5720s
Epoch: 16 cost time: 35.8156316280365
Epoch: 16, Steps: 128 | Train Loss: 0.000 Vali Loss: 1434.847 Vali Acc: 0.550 Test Loss: 1434.847 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000000
	speed: 0.6739s/iter; left time: 7178.9106s
Epoch: 17 cost time: 35.86034321784973
Epoch: 17, Steps: 128 | Train Loss: 0.000 Vali Loss: 1434.847 Vali Acc: 0.550 Test Loss: 1434.847 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.6975s/iter; left time: 7341.2991s
Epoch: 18 cost time: 35.49211096763611
Epoch: 18, Steps: 128 | Train Loss: 0.000 Vali Loss: 1434.847 Vali Acc: 0.550 Test Loss: 1434.847 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 48168021
model size : 218.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.969088315963745
Epoch: 1, Steps: 64 | Train Loss: 115.404 Vali Loss: 243.944 Vali Acc: 0.282 Test Loss: 243.944 Test Acc: 0.282
Validation loss decreased (inf --> -0.280003).  Saving model ...
Epoch: 2 cost time: 33.84284567832947
Epoch: 2, Steps: 64 | Train Loss: 192.225 Vali Loss: 222.107 Vali Acc: 0.496 Test Loss: 222.107 Test Acc: 0.496
Validation loss decreased (-0.280003 --> -0.493962).  Saving model ...
Epoch: 3 cost time: 33.61170220375061
Epoch: 3, Steps: 64 | Train Loss: 129.508 Vali Loss: 239.140 Vali Acc: 0.435 Test Loss: 239.140 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.75896692276001
Epoch: 4, Steps: 64 | Train Loss: 77.813 Vali Loss: 409.914 Vali Acc: 0.351 Test Loss: 409.914 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 33.61458873748779
Epoch: 5, Steps: 64 | Train Loss: 164.615 Vali Loss: 432.087 Vali Acc: 0.511 Test Loss: 432.087 Test Acc: 0.511
Validation loss decreased (-0.493962 --> -0.507130).  Saving model ...
Epoch: 6 cost time: 34.356027364730835
Epoch: 6, Steps: 64 | Train Loss: 119.121 Vali Loss: 732.960 Vali Acc: 0.435 Test Loss: 732.960 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 33.83652663230896
Epoch: 7, Steps: 64 | Train Loss: 94.661 Vali Loss: 610.443 Vali Acc: 0.511 Test Loss: 610.443 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 33.50524830818176
Epoch: 8, Steps: 64 | Train Loss: 88.295 Vali Loss: 865.653 Vali Acc: 0.229 Test Loss: 865.653 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 34.11027503013611
Epoch: 9, Steps: 64 | Train Loss: 52.980 Vali Loss: 479.074 Vali Acc: 0.534 Test Loss: 479.074 Test Acc: 0.534
Validation loss decreased (-0.507130 --> -0.529560).  Saving model ...
Epoch: 10 cost time: 33.68352222442627
Epoch: 10, Steps: 64 | Train Loss: 35.529 Vali Loss: 558.857 Vali Acc: 0.542 Test Loss: 558.857 Test Acc: 0.542
Validation loss decreased (-0.529560 --> -0.536396).  Saving model ...
Epoch: 11 cost time: 34.44916105270386
Epoch: 11, Steps: 64 | Train Loss: 48.951 Vali Loss: 354.326 Vali Acc: 0.450 Test Loss: 354.326 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 33.40093183517456
Epoch: 12, Steps: 64 | Train Loss: 63.757 Vali Loss: 579.314 Vali Acc: 0.580 Test Loss: 579.314 Test Acc: 0.580
Validation loss decreased (-0.536396 --> -0.574360).  Saving model ...
Epoch: 13 cost time: 34.37175512313843
Epoch: 13, Steps: 64 | Train Loss: 48.882 Vali Loss: 453.568 Vali Acc: 0.611 Test Loss: 453.568 Test Acc: 0.611
Validation loss decreased (-0.574360 --> -0.606151).  Saving model ...
Epoch: 14 cost time: 33.60734820365906
Epoch: 14, Steps: 64 | Train Loss: 8.761 Vali Loss: 768.069 Vali Acc: 0.511 Test Loss: 768.069 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 33.83017086982727
Epoch: 15, Steps: 64 | Train Loss: 41.380 Vali Loss: 596.797 Vali Acc: 0.405 Test Loss: 596.797 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 33.27905011177063
Epoch: 16, Steps: 64 | Train Loss: 12.433 Vali Loss: 597.692 Vali Acc: 0.573 Test Loss: 597.692 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.808493852615356
Epoch: 17, Steps: 64 | Train Loss: 8.603 Vali Loss: 673.168 Vali Acc: 0.504 Test Loss: 673.168 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 33.97218108177185
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.883 Vali Acc: 0.611 Test Loss: 533.883 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 33.75998401641846
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.931 Vali Acc: 0.611 Test Loss: 533.931 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 33.40534210205078
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.931 Vali Acc: 0.611 Test Loss: 533.931 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 34.12910842895508
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.931 Vali Acc: 0.611 Test Loss: 533.931 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 33.56426692008972
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.931 Vali Acc: 0.611 Test Loss: 533.931 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 34.01461839675903
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 533.931 Vali Acc: 0.611 Test Loss: 533.931 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 48168021
model size : 218.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.68830394744873
Epoch: 1, Steps: 64 | Train Loss: 154.950 Vali Loss: 181.127 Vali Acc: 0.473 Test Loss: 181.127 Test Acc: 0.473
Validation loss decreased (inf --> -0.471471).  Saving model ...
Epoch: 2 cost time: 31.57214093208313
Epoch: 2, Steps: 64 | Train Loss: 120.838 Vali Loss: 250.417 Vali Acc: 0.473 Test Loss: 250.417 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 31.290452480316162
Epoch: 3, Steps: 64 | Train Loss: 154.105 Vali Loss: 722.645 Vali Acc: 0.427 Test Loss: 722.645 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 31.21321439743042
Epoch: 4, Steps: 64 | Train Loss: 290.853 Vali Loss: 218.328 Vali Acc: 0.489 Test Loss: 218.328 Test Acc: 0.489
Validation loss decreased (-0.471471 --> -0.486366).  Saving model ...
Epoch: 5 cost time: 31.861500024795532
Epoch: 5, Steps: 64 | Train Loss: 100.001 Vali Loss: 322.658 Vali Acc: 0.511 Test Loss: 322.658 Test Acc: 0.511
Validation loss decreased (-0.486366 --> -0.508224).  Saving model ...
Epoch: 6 cost time: 31.246607542037964
Epoch: 6, Steps: 64 | Train Loss: 115.010 Vali Loss: 386.639 Vali Acc: 0.313 Test Loss: 386.639 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 31.119592666625977
Epoch: 7, Steps: 64 | Train Loss: 57.310 Vali Loss: 289.957 Vali Acc: 0.542 Test Loss: 289.957 Test Acc: 0.542
Validation loss decreased (-0.508224 --> -0.539085).  Saving model ...
Epoch: 8 cost time: 31.469563722610474
Epoch: 8, Steps: 64 | Train Loss: 47.547 Vali Loss: 386.076 Vali Acc: 0.382 Test Loss: 386.076 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.654423713684082
Epoch: 9, Steps: 64 | Train Loss: 59.662 Vali Loss: 419.482 Vali Acc: 0.389 Test Loss: 419.482 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.74395751953125
Epoch: 10, Steps: 64 | Train Loss: 39.868 Vali Loss: 619.359 Vali Acc: 0.412 Test Loss: 619.359 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 31.478191614151
Epoch: 11, Steps: 64 | Train Loss: 9.986 Vali Loss: 612.311 Vali Acc: 0.336 Test Loss: 612.311 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 31.510658502578735
Epoch: 12, Steps: 64 | Train Loss: 9.887 Vali Loss: 1317.624 Vali Acc: 0.328 Test Loss: 1317.624 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 31.582616806030273
Epoch: 13, Steps: 64 | Train Loss: 1.750 Vali Loss: 986.328 Vali Acc: 0.450 Test Loss: 986.328 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 31.803364992141724
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 988.398 Vali Acc: 0.450 Test Loss: 988.398 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 30.813066244125366
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 988.400 Vali Acc: 0.450 Test Loss: 988.400 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 31.33091688156128
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 988.400 Vali Acc: 0.450 Test Loss: 988.400 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 31.523531913757324
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 988.400 Vali Acc: 0.450 Test Loss: 988.400 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 48168021
model size : 218.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 31.164435386657715
Epoch: 1, Steps: 64 | Train Loss: 153.020 Vali Loss: 195.582 Vali Acc: 0.473 Test Loss: 195.582 Test Acc: 0.473
Validation loss decreased (inf --> -0.471327).  Saving model ...
Epoch: 2 cost time: 29.07913112640381
Epoch: 2, Steps: 64 | Train Loss: 89.802 Vali Loss: 186.238 Vali Acc: 0.557 Test Loss: 186.238 Test Acc: 0.557
Validation loss decreased (-0.471327 --> -0.555390).  Saving model ...
Epoch: 3 cost time: 28.732465267181396
Epoch: 3, Steps: 64 | Train Loss: 206.729 Vali Loss: 360.553 Vali Acc: 0.511 Test Loss: 360.553 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 29.423471212387085
Epoch: 4, Steps: 64 | Train Loss: 189.343 Vali Loss: 316.125 Vali Acc: 0.603 Test Loss: 316.125 Test Acc: 0.603
Validation loss decreased (-0.555390 --> -0.599892).  Saving model ...
Epoch: 5 cost time: 28.5782208442688
Epoch: 5, Steps: 64 | Train Loss: 156.586 Vali Loss: 361.155 Vali Acc: 0.550 Test Loss: 361.155 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 28.760592937469482
Epoch: 6, Steps: 64 | Train Loss: 78.200 Vali Loss: 412.948 Vali Acc: 0.542 Test Loss: 412.948 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 28.799677848815918
Epoch: 7, Steps: 64 | Train Loss: 31.001 Vali Loss: 548.780 Vali Acc: 0.496 Test Loss: 548.780 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 28.550745487213135
Epoch: 8, Steps: 64 | Train Loss: 52.594 Vali Loss: 359.131 Vali Acc: 0.664 Test Loss: 359.131 Test Acc: 0.664
Validation loss decreased (-0.599892 --> -0.660531).  Saving model ...
Epoch: 9 cost time: 29.332241535186768
Epoch: 9, Steps: 64 | Train Loss: 78.780 Vali Loss: 908.901 Vali Acc: 0.504 Test Loss: 908.901 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 29.122278451919556
Epoch: 10, Steps: 64 | Train Loss: 84.408 Vali Loss: 552.007 Vali Acc: 0.534 Test Loss: 552.007 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 28.4904363155365
Epoch: 11, Steps: 64 | Train Loss: 15.587 Vali Loss: 458.447 Vali Acc: 0.450 Test Loss: 458.447 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 29.260220766067505
Epoch: 12, Steps: 64 | Train Loss: 33.720 Vali Loss: 756.698 Vali Acc: 0.519 Test Loss: 756.698 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 29.00725221633911
Epoch: 13, Steps: 64 | Train Loss: 47.030 Vali Loss: 524.680 Vali Acc: 0.496 Test Loss: 524.680 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 28.915011405944824
Epoch: 14, Steps: 64 | Train Loss: 23.270 Vali Loss: 550.003 Vali Acc: 0.481 Test Loss: 550.003 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 28.85202169418335
Epoch: 15, Steps: 64 | Train Loss: 55.053 Vali Loss: 1198.108 Vali Acc: 0.198 Test Loss: 1198.108 Test Acc: 0.198
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 29.07773756980896
Epoch: 16, Steps: 64 | Train Loss: 62.388 Vali Loss: 945.013 Vali Acc: 0.542 Test Loss: 945.013 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 29.027149438858032
Epoch: 17, Steps: 64 | Train Loss: 11.129 Vali Loss: 691.627 Vali Acc: 0.534 Test Loss: 691.627 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 29.09907841682434
Epoch: 18, Steps: 64 | Train Loss: 3.858 Vali Loss: 981.229 Vali Acc: 0.557 Test Loss: 981.229 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 48168021
model size : 218.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         1                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
	iters: 100, epoch: 1 | loss: 759.9647217
	speed: 0.2848s/iter; left time: 3616.8928s
Epoch: 1 cost time: 36.06643271446228
Epoch: 1, Steps: 128 | Train Loss: 311.031 Vali Loss: 225.249 Vali Acc: 0.458 Test Loss: 225.249 Test Acc: 0.458
Validation loss decreased (inf --> -0.455763).  Saving model ...
	iters: 100, epoch: 2 | loss: 32.1580124
	speed: 0.7150s/iter; left time: 8990.0686s
Epoch: 2 cost time: 36.06059241294861
Epoch: 2, Steps: 128 | Train Loss: 374.515 Vali Loss: 649.338 Vali Acc: 0.489 Test Loss: 649.338 Test Acc: 0.489
Validation loss decreased (-0.455763 --> -0.482056).  Saving model ...
	iters: 100, epoch: 3 | loss: 103.3998413
	speed: 0.7175s/iter; left time: 8929.8573s
Epoch: 3 cost time: 36.42278289794922
Epoch: 3, Steps: 128 | Train Loss: 401.538 Vali Loss: 515.098 Vali Acc: 0.573 Test Loss: 515.098 Test Acc: 0.573
Validation loss decreased (-0.482056 --> -0.567368).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0000000
	speed: 0.7382s/iter; left time: 9092.6734s
Epoch: 4 cost time: 36.34546685218811
Epoch: 4, Steps: 128 | Train Loss: 225.272 Vali Loss: 930.237 Vali Acc: 0.321 Test Loss: 930.237 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0000000
	speed: 0.7229s/iter; left time: 8811.5337s
Epoch: 5 cost time: 36.412447929382324
Epoch: 5, Steps: 128 | Train Loss: 217.703 Vali Loss: 475.126 Vali Acc: 0.534 Test Loss: 475.126 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 52.2884827
	speed: 0.7100s/iter; left time: 8563.3335s
Epoch: 6 cost time: 36.108985900878906
Epoch: 6, Steps: 128 | Train Loss: 111.267 Vali Loss: 756.244 Vali Acc: 0.344 Test Loss: 756.244 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0000000
	speed: 0.7051s/iter; left time: 8413.8503s
Epoch: 7 cost time: 36.804959535598755
Epoch: 7, Steps: 128 | Train Loss: 132.415 Vali Loss: 626.860 Vali Acc: 0.366 Test Loss: 626.860 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0000000
	speed: 0.7125s/iter; left time: 8411.0128s
Epoch: 8 cost time: 36.17636585235596
Epoch: 8, Steps: 128 | Train Loss: 60.704 Vali Loss: 885.026 Vali Acc: 0.328 Test Loss: 885.026 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 823.9451904
	speed: 0.7248s/iter; left time: 8463.4037s
Epoch: 9 cost time: 36.457335233688354
Epoch: 9, Steps: 128 | Train Loss: 114.712 Vali Loss: 787.682 Vali Acc: 0.542 Test Loss: 787.682 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000000
	speed: 0.7184s/iter; left time: 8297.3398s
Epoch: 10 cost time: 37.28379225730896
Epoch: 10, Steps: 128 | Train Loss: 22.438 Vali Loss: 879.274 Vali Acc: 0.565 Test Loss: 879.274 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000000
	speed: 0.6934s/iter; left time: 7919.3929s
Epoch: 11 cost time: 36.12761616706848
Epoch: 11, Steps: 128 | Train Loss: 69.767 Vali Loss: 1017.209 Vali Acc: 0.557 Test Loss: 1017.209 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000000
	speed: 0.7245s/iter; left time: 8182.0363s
Epoch: 12 cost time: 36.32107710838318
Epoch: 12, Steps: 128 | Train Loss: 83.668 Vali Loss: 1127.479 Vali Acc: 0.534 Test Loss: 1127.479 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000000
	speed: 0.7373s/iter; left time: 8232.0011s
Epoch: 13 cost time: 36.48158407211304
Epoch: 13, Steps: 128 | Train Loss: 49.027 Vali Loss: 1306.609 Vali Acc: 0.336 Test Loss: 1306.609 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 47643733
model size : 216.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.88949799537659
Epoch: 1, Steps: 64 | Train Loss: 120.997 Vali Loss: 76.172 Vali Acc: 0.473 Test Loss: 76.172 Test Acc: 0.473
Validation loss decreased (inf --> -0.472521).  Saving model ...
Epoch: 2 cost time: 33.48373079299927
Epoch: 2, Steps: 64 | Train Loss: 149.996 Vali Loss: 213.992 Vali Acc: 0.466 Test Loss: 213.992 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.614867210388184
Epoch: 3, Steps: 64 | Train Loss: 319.484 Vali Loss: 524.247 Vali Acc: 0.237 Test Loss: 524.247 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 33.47202467918396
Epoch: 4, Steps: 64 | Train Loss: 159.270 Vali Loss: 484.992 Vali Acc: 0.366 Test Loss: 484.992 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 33.30742406845093
Epoch: 5, Steps: 64 | Train Loss: 113.278 Vali Loss: 489.120 Vali Acc: 0.191 Test Loss: 489.120 Test Acc: 0.191
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 33.40478181838989
Epoch: 6, Steps: 64 | Train Loss: 88.461 Vali Loss: 609.810 Vali Acc: 0.496 Test Loss: 609.810 Test Acc: 0.496
Validation loss decreased (-0.472521 --> -0.490085).  Saving model ...
Epoch: 7 cost time: 33.97362208366394
Epoch: 7, Steps: 64 | Train Loss: 55.800 Vali Loss: 323.231 Vali Acc: 0.458 Test Loss: 323.231 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.416677951812744
Epoch: 8, Steps: 64 | Train Loss: 29.487 Vali Loss: 502.156 Vali Acc: 0.328 Test Loss: 502.156 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 34.08857440948486
Epoch: 9, Steps: 64 | Train Loss: 116.892 Vali Loss: 335.670 Vali Acc: 0.573 Test Loss: 335.670 Test Acc: 0.573
Validation loss decreased (-0.490085 --> -0.569162).  Saving model ...
Epoch: 10 cost time: 33.32203722000122
Epoch: 10, Steps: 64 | Train Loss: 67.978 Vali Loss: 527.269 Vali Acc: 0.580 Test Loss: 527.269 Test Acc: 0.580
Validation loss decreased (-0.569162 --> -0.574880).  Saving model ...
Epoch: 11 cost time: 33.94376802444458
Epoch: 11, Steps: 64 | Train Loss: 52.766 Vali Loss: 520.262 Vali Acc: 0.588 Test Loss: 520.262 Test Acc: 0.588
Validation loss decreased (-0.574880 --> -0.582584).  Saving model ...
Epoch: 12 cost time: 33.60421848297119
Epoch: 12, Steps: 64 | Train Loss: 47.674 Vali Loss: 598.302 Vali Acc: 0.374 Test Loss: 598.302 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 33.46978569030762
Epoch: 13, Steps: 64 | Train Loss: 28.446 Vali Loss: 510.257 Vali Acc: 0.389 Test Loss: 510.257 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 33.80947160720825
Epoch: 14, Steps: 64 | Train Loss: 34.538 Vali Loss: 1253.346 Vali Acc: 0.282 Test Loss: 1253.346 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 33.287795543670654
Epoch: 15, Steps: 64 | Train Loss: 9.820 Vali Loss: 1211.988 Vali Acc: 0.313 Test Loss: 1211.988 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 33.8614604473114
Epoch: 16, Steps: 64 | Train Loss: 75.619 Vali Loss: 1316.174 Vali Acc: 0.466 Test Loss: 1316.174 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 33.566208839416504
Epoch: 17, Steps: 64 | Train Loss: 13.601 Vali Loss: 972.062 Vali Acc: 0.473 Test Loss: 972.062 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 34.039602756500244
Epoch: 18, Steps: 64 | Train Loss: 23.566 Vali Loss: 723.504 Vali Acc: 0.580 Test Loss: 723.504 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 33.726826906204224
Epoch: 19, Steps: 64 | Train Loss: 16.369 Vali Loss: 813.254 Vali Acc: 0.366 Test Loss: 813.254 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 33.827919006347656
Epoch: 20, Steps: 64 | Train Loss: 47.288 Vali Loss: 805.486 Vali Acc: 0.550 Test Loss: 805.486 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 33.41013050079346
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 797.801 Vali Acc: 0.580 Test Loss: 797.801 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 47643733
model size : 216.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.73809885978699
Epoch: 1, Steps: 64 | Train Loss: 128.348 Vali Loss: 85.739 Vali Acc: 0.496 Test Loss: 85.739 Test Acc: 0.496
Validation loss decreased (inf --> -0.495326).  Saving model ...
Epoch: 2 cost time: 30.88218903541565
Epoch: 2, Steps: 64 | Train Loss: 122.192 Vali Loss: 93.378 Vali Acc: 0.534 Test Loss: 93.378 Test Acc: 0.534
Validation loss decreased (-0.495326 --> -0.533417).  Saving model ...
Epoch: 3 cost time: 31.04343342781067
Epoch: 3, Steps: 64 | Train Loss: 155.873 Vali Loss: 201.664 Vali Acc: 0.466 Test Loss: 201.664 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 31.38518524169922
Epoch: 4, Steps: 64 | Train Loss: 154.403 Vali Loss: 522.137 Vali Acc: 0.313 Test Loss: 522.137 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 31.338561058044434
Epoch: 5, Steps: 64 | Train Loss: 154.534 Vali Loss: 600.051 Vali Acc: 0.473 Test Loss: 600.051 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 31.157962322235107
Epoch: 6, Steps: 64 | Train Loss: 218.129 Vali Loss: 907.297 Vali Acc: 0.473 Test Loss: 907.297 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 31.190531253814697
Epoch: 7, Steps: 64 | Train Loss: 168.532 Vali Loss: 475.018 Vali Acc: 0.588 Test Loss: 475.018 Test Acc: 0.588
Validation loss decreased (-0.533417 --> -0.583036).  Saving model ...
Epoch: 8 cost time: 31.01613163948059
Epoch: 8, Steps: 64 | Train Loss: 104.600 Vali Loss: 403.690 Vali Acc: 0.580 Test Loss: 403.690 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 31.446460962295532
Epoch: 9, Steps: 64 | Train Loss: 96.659 Vali Loss: 597.257 Vali Acc: 0.557 Test Loss: 597.257 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 31.163464784622192
Epoch: 10, Steps: 64 | Train Loss: 15.743 Vali Loss: 338.867 Vali Acc: 0.618 Test Loss: 338.867 Test Acc: 0.618
Validation loss decreased (-0.583036 --> -0.614932).  Saving model ...
Epoch: 11 cost time: 30.94330930709839
Epoch: 11, Steps: 64 | Train Loss: 8.272 Vali Loss: 334.905 Vali Acc: 0.634 Test Loss: 334.905 Test Acc: 0.634
Validation loss decreased (-0.614932 --> -0.630239).  Saving model ...
Epoch: 12 cost time: 31.165398836135864
Epoch: 12, Steps: 64 | Train Loss: 6.007 Vali Loss: 399.010 Vali Acc: 0.412 Test Loss: 399.010 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.946280002593994
Epoch: 13, Steps: 64 | Train Loss: 40.196 Vali Loss: 604.107 Vali Acc: 0.573 Test Loss: 604.107 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 31.003235340118408
Epoch: 14, Steps: 64 | Train Loss: 44.708 Vali Loss: 382.310 Vali Acc: 0.634 Test Loss: 382.310 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 31.100210189819336
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.275 Vali Acc: 0.595 Test Loss: 387.275 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 31.15569233894348
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 30.901955604553223
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 30.89449977874756
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 31.249473571777344
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 31.340182542800903
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 31.186929941177368
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 387.346 Vali Acc: 0.595 Test Loss: 387.346 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 47643733
model size : 216.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 28.370185136795044
Epoch: 1, Steps: 32 | Train Loss: 44.115 Vali Loss: 43.430 Vali Acc: 0.344 Test Loss: 43.430 Test Acc: 0.344
Validation loss decreased (inf --> -0.343077).  Saving model ...
Epoch: 2 cost time: 26.51174283027649
Epoch: 2, Steps: 32 | Train Loss: 86.244 Vali Loss: 162.443 Vali Acc: 0.458 Test Loss: 162.443 Test Acc: 0.458
Validation loss decreased (-0.343077 --> -0.456391).  Saving model ...
Epoch: 3 cost time: 26.155099153518677
Epoch: 3, Steps: 32 | Train Loss: 93.647 Vali Loss: 100.087 Vali Acc: 0.496 Test Loss: 100.087 Test Acc: 0.496
Validation loss decreased (-0.456391 --> -0.495182).  Saving model ...
Epoch: 4 cost time: 27.559298753738403
Epoch: 4, Steps: 32 | Train Loss: 84.117 Vali Loss: 236.566 Vali Acc: 0.496 Test Loss: 236.566 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 27.084824562072754
Epoch: 5, Steps: 32 | Train Loss: 166.777 Vali Loss: 186.845 Vali Acc: 0.313 Test Loss: 186.845 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 27.2897047996521
Epoch: 6, Steps: 32 | Train Loss: 86.375 Vali Loss: 162.538 Vali Acc: 0.481 Test Loss: 162.538 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 27.17387819290161
Epoch: 7, Steps: 32 | Train Loss: 43.923 Vali Loss: 251.079 Vali Acc: 0.496 Test Loss: 251.079 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 27.242316007614136
Epoch: 8, Steps: 32 | Train Loss: 82.364 Vali Loss: 101.815 Vali Acc: 0.664 Test Loss: 101.815 Test Acc: 0.664
Validation loss decreased (-0.495182 --> -0.663104).  Saving model ...
Epoch: 9 cost time: 27.268554210662842
Epoch: 9, Steps: 32 | Train Loss: 26.463 Vali Loss: 143.197 Vali Acc: 0.649 Test Loss: 143.197 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 27.31521725654602
Epoch: 10, Steps: 32 | Train Loss: 30.098 Vali Loss: 378.061 Vali Acc: 0.382 Test Loss: 378.061 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 27.471642017364502
Epoch: 11, Steps: 32 | Train Loss: 8.485 Vali Loss: 657.355 Vali Acc: 0.282 Test Loss: 657.355 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 27.132993459701538
Epoch: 12, Steps: 32 | Train Loss: 21.544 Vali Loss: 373.447 Vali Acc: 0.557 Test Loss: 373.447 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 26.869263172149658
Epoch: 13, Steps: 32 | Train Loss: 5.043 Vali Loss: 506.031 Vali Acc: 0.389 Test Loss: 506.031 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 27.041146516799927
Epoch: 14, Steps: 32 | Train Loss: 3.327 Vali Loss: 502.454 Vali Acc: 0.344 Test Loss: 502.454 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 26.931288957595825
Epoch: 15, Steps: 32 | Train Loss: 17.666 Vali Loss: 368.737 Vali Acc: 0.489 Test Loss: 368.737 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 26.92072033882141
Epoch: 16, Steps: 32 | Train Loss: 8.942 Vali Loss: 551.134 Vali Acc: 0.344 Test Loss: 551.134 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 27.346661806106567
Epoch: 17, Steps: 32 | Train Loss: 19.989 Vali Loss: 619.962 Vali Acc: 0.282 Test Loss: 619.962 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 27.180505514144897
Epoch: 18, Steps: 32 | Train Loss: 8.630 Vali Loss: 383.921 Vali Acc: 0.649 Test Loss: 383.921 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 47643733
model size : 216.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 36.752214431762695
Epoch: 1, Steps: 64 | Train Loss: 150.357 Vali Loss: 239.402 Vali Acc: 0.115 Test Loss: 239.402 Test Acc: 0.115
Validation loss decreased (inf --> -0.112110).  Saving model ...
Epoch: 2 cost time: 35.39869570732117
Epoch: 2, Steps: 64 | Train Loss: 176.967 Vali Loss: 226.264 Vali Acc: 0.504 Test Loss: 226.264 Test Acc: 0.504
Validation loss decreased (-0.112110 --> -0.501554).  Saving model ...
Epoch: 3 cost time: 35.63904023170471
Epoch: 3, Steps: 64 | Train Loss: 242.752 Vali Loss: 492.253 Vali Acc: 0.183 Test Loss: 492.253 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 35.06283736228943
Epoch: 4, Steps: 64 | Train Loss: 146.274 Vali Loss: 416.270 Vali Acc: 0.191 Test Loss: 416.270 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 35.04520082473755
Epoch: 5, Steps: 64 | Train Loss: 60.318 Vali Loss: 259.412 Vali Acc: 0.412 Test Loss: 259.412 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 35.55477046966553
Epoch: 6, Steps: 64 | Train Loss: 175.009 Vali Loss: 517.973 Vali Acc: 0.389 Test Loss: 517.973 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 34.736157178878784
Epoch: 7, Steps: 64 | Train Loss: 41.598 Vali Loss: 512.009 Vali Acc: 0.382 Test Loss: 512.009 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 35.452555894851685
Epoch: 8, Steps: 64 | Train Loss: 95.191 Vali Loss: 590.804 Vali Acc: 0.420 Test Loss: 590.804 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 35.076350688934326
Epoch: 9, Steps: 64 | Train Loss: 135.652 Vali Loss: 947.383 Vali Acc: 0.282 Test Loss: 947.383 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 35.40964460372925
Epoch: 10, Steps: 64 | Train Loss: 9.539 Vali Loss: 766.396 Vali Acc: 0.595 Test Loss: 766.396 Test Acc: 0.595
Validation loss decreased (-0.501554 --> -0.587756).  Saving model ...
Epoch: 11 cost time: 35.10182523727417
Epoch: 11, Steps: 64 | Train Loss: 54.130 Vali Loss: 651.543 Vali Acc: 0.588 Test Loss: 651.543 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 35.374515771865845
Epoch: 12, Steps: 64 | Train Loss: 5.693 Vali Loss: 653.112 Vali Acc: 0.580 Test Loss: 653.112 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 35.2261278629303
Epoch: 13, Steps: 64 | Train Loss: 12.772 Vali Loss: 647.004 Vali Acc: 0.679 Test Loss: 647.004 Test Acc: 0.679
Validation loss decreased (-0.587756 --> -0.672919).  Saving model ...
Epoch: 14 cost time: 35.52280855178833
Epoch: 14, Steps: 64 | Train Loss: 14.729 Vali Loss: 913.972 Vali Acc: 0.466 Test Loss: 913.972 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 35.39094042778015
Epoch: 15, Steps: 64 | Train Loss: 24.853 Vali Loss: 1062.622 Vali Acc: 0.573 Test Loss: 1062.622 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 35.333970069885254
Epoch: 16, Steps: 64 | Train Loss: 119.954 Vali Loss: 1633.441 Vali Acc: 0.450 Test Loss: 1633.441 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 35.48234152793884
Epoch: 17, Steps: 64 | Train Loss: 133.812 Vali Loss: 880.625 Vali Acc: 0.366 Test Loss: 880.625 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 35.26407837867737
Epoch: 18, Steps: 64 | Train Loss: 20.800 Vali Loss: 553.222 Vali Acc: 0.588 Test Loss: 553.222 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 35.564422369003296
Epoch: 19, Steps: 64 | Train Loss: 9.304 Vali Loss: 746.371 Vali Acc: 0.573 Test Loss: 746.371 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 35.612329721450806
Epoch: 20, Steps: 64 | Train Loss: 40.064 Vali Loss: 712.284 Vali Acc: 0.565 Test Loss: 712.284 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 35.42604160308838
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 717.796 Vali Acc: 0.565 Test Loss: 717.796 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 35.5014910697937
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 717.802 Vali Acc: 0.565 Test Loss: 717.802 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 35.69661998748779
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 717.802 Vali Acc: 0.565 Test Loss: 717.802 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6793893129770993
model parameter : 47381589
model size : 215.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.444478273391724
Epoch: 1, Steps: 64 | Train Loss: 112.386 Vali Loss: 139.424 Vali Acc: 0.489 Test Loss: 139.424 Test Acc: 0.489
Validation loss decreased (inf --> -0.487155).  Saving model ...
Epoch: 2 cost time: 33.18343687057495
Epoch: 2, Steps: 64 | Train Loss: 110.299 Vali Loss: 389.656 Vali Acc: 0.397 Test Loss: 389.656 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 33.28234624862671
Epoch: 3, Steps: 64 | Train Loss: 250.029 Vali Loss: 222.848 Vali Acc: 0.374 Test Loss: 222.848 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 33.056472301483154
Epoch: 4, Steps: 64 | Train Loss: 155.186 Vali Loss: 472.874 Vali Acc: 0.252 Test Loss: 472.874 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 32.97493839263916
Epoch: 5, Steps: 64 | Train Loss: 134.677 Vali Loss: 372.123 Vali Acc: 0.534 Test Loss: 372.123 Test Acc: 0.534
Validation loss decreased (-0.487155 --> -0.530630).  Saving model ...
Epoch: 6 cost time: 33.170825242996216
Epoch: 6, Steps: 64 | Train Loss: 103.273 Vali Loss: 351.544 Vali Acc: 0.542 Test Loss: 351.544 Test Acc: 0.542
Validation loss decreased (-0.530630 --> -0.538469).  Saving model ...
Epoch: 7 cost time: 33.235838174819946
Epoch: 7, Steps: 64 | Train Loss: 134.197 Vali Loss: 660.802 Vali Acc: 0.412 Test Loss: 660.802 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.10562252998352
Epoch: 8, Steps: 64 | Train Loss: 127.579 Vali Loss: 277.256 Vali Acc: 0.473 Test Loss: 277.256 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 33.125378131866455
Epoch: 9, Steps: 64 | Train Loss: 9.471 Vali Loss: 455.578 Vali Acc: 0.504 Test Loss: 455.578 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 33.13447976112366
Epoch: 10, Steps: 64 | Train Loss: 53.808 Vali Loss: 428.048 Vali Acc: 0.527 Test Loss: 428.048 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 33.40745759010315
Epoch: 11, Steps: 64 | Train Loss: 66.028 Vali Loss: 598.721 Vali Acc: 0.420 Test Loss: 598.721 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 33.224560499191284
Epoch: 12, Steps: 64 | Train Loss: 29.609 Vali Loss: 700.058 Vali Acc: 0.260 Test Loss: 700.058 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 33.483673334121704
Epoch: 13, Steps: 64 | Train Loss: 24.783 Vali Loss: 551.224 Vali Acc: 0.595 Test Loss: 551.224 Test Acc: 0.595
Validation loss decreased (-0.538469 --> -0.589908).  Saving model ...
Epoch: 14 cost time: 33.373809814453125
Epoch: 14, Steps: 64 | Train Loss: 13.849 Vali Loss: 584.668 Vali Acc: 0.550 Test Loss: 584.668 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 33.348583459854126
Epoch: 15, Steps: 64 | Train Loss: 10.969 Vali Loss: 1077.413 Vali Acc: 0.275 Test Loss: 1077.413 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 33.42624616622925
Epoch: 16, Steps: 64 | Train Loss: 53.428 Vali Loss: 1446.225 Vali Acc: 0.489 Test Loss: 1446.225 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 33.55549144744873
Epoch: 17, Steps: 64 | Train Loss: 30.125 Vali Loss: 1511.786 Vali Acc: 0.565 Test Loss: 1511.786 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 33.319324016571045
Epoch: 18, Steps: 64 | Train Loss: 22.234 Vali Loss: 2085.463 Vali Acc: 0.527 Test Loss: 2085.463 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 33.20039701461792
Epoch: 19, Steps: 64 | Train Loss: 88.612 Vali Loss: 1336.312 Vali Acc: 0.389 Test Loss: 1336.312 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 33.438485860824585
Epoch: 20, Steps: 64 | Train Loss: 24.417 Vali Loss: 2271.357 Vali Acc: 0.275 Test Loss: 2271.357 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 33.687625885009766
Epoch: 21, Steps: 64 | Train Loss: 25.513 Vali Loss: 1051.576 Vali Acc: 0.649 Test Loss: 1051.576 Test Acc: 0.649
Validation loss decreased (-0.589908 --> -0.638339).  Saving model ...
Epoch: 22 cost time: 33.30133295059204
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.719 Vali Acc: 0.634 Test Loss: 1056.719 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 32.9804892539978
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 33.63472318649292
Epoch: 24, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 33.28269934654236
Epoch: 25, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 33.14405870437622
Epoch: 26, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 32.7957181930542
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 33.346216440200806
Epoch: 28, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 33.70010852813721
Epoch: 29, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 33.237197399139404
Epoch: 30, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 33.26456618309021
Epoch: 31, Steps: 64 | Train Loss: 0.000 Vali Loss: 1056.728 Vali Acc: 0.634 Test Loss: 1056.728 Test Acc: 0.634
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 47381589
model size : 215.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.185441732406616
Epoch: 1, Steps: 64 | Train Loss: 136.662 Vali Loss: 250.969 Vali Acc: 0.145 Test Loss: 250.969 Test Acc: 0.145
Validation loss decreased (inf --> -0.142528).  Saving model ...
Epoch: 2 cost time: 30.648257970809937
Epoch: 2, Steps: 64 | Train Loss: 218.901 Vali Loss: 295.855 Vali Acc: 0.496 Test Loss: 295.855 Test Acc: 0.496
Validation loss decreased (-0.142528 --> -0.493225).  Saving model ...
Epoch: 3 cost time: 30.709349870681763
Epoch: 3, Steps: 64 | Train Loss: 256.654 Vali Loss: 296.353 Vali Acc: 0.496 Test Loss: 296.353 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.05699849128723
Epoch: 4, Steps: 64 | Train Loss: 222.072 Vali Loss: 282.166 Vali Acc: 0.321 Test Loss: 282.166 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 30.963690996170044
Epoch: 5, Steps: 64 | Train Loss: 108.853 Vali Loss: 393.540 Vali Acc: 0.267 Test Loss: 393.540 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 30.808002710342407
Epoch: 6, Steps: 64 | Train Loss: 44.460 Vali Loss: 280.700 Vali Acc: 0.504 Test Loss: 280.700 Test Acc: 0.504
Validation loss decreased (-0.493225 --> -0.501010).  Saving model ...
Epoch: 7 cost time: 30.378631591796875
Epoch: 7, Steps: 64 | Train Loss: 57.974 Vali Loss: 319.540 Vali Acc: 0.489 Test Loss: 319.540 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 30.89551329612732
Epoch: 8, Steps: 64 | Train Loss: 77.279 Vali Loss: 454.883 Vali Acc: 0.344 Test Loss: 454.883 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 30.25588822364807
Epoch: 9, Steps: 64 | Train Loss: 78.741 Vali Loss: 454.776 Vali Acc: 0.389 Test Loss: 454.776 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 30.606499671936035
Epoch: 10, Steps: 64 | Train Loss: 42.272 Vali Loss: 284.665 Vali Acc: 0.580 Test Loss: 284.665 Test Acc: 0.580
Validation loss decreased (-0.501010 --> -0.577306).  Saving model ...
Epoch: 11 cost time: 31.01986789703369
Epoch: 11, Steps: 64 | Train Loss: 18.013 Vali Loss: 416.892 Vali Acc: 0.603 Test Loss: 416.892 Test Acc: 0.603
Validation loss decreased (-0.577306 --> -0.598885).  Saving model ...
Epoch: 12 cost time: 30.271031141281128
Epoch: 12, Steps: 64 | Train Loss: 16.675 Vali Loss: 341.237 Vali Acc: 0.634 Test Loss: 341.237 Test Acc: 0.634
Validation loss decreased (-0.598885 --> -0.630175).  Saving model ...
Epoch: 13 cost time: 30.823679208755493
Epoch: 13, Steps: 64 | Train Loss: 11.601 Vali Loss: 496.108 Vali Acc: 0.595 Test Loss: 496.108 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 30.820144653320312
Epoch: 14, Steps: 64 | Train Loss: 2.314 Vali Loss: 384.672 Vali Acc: 0.519 Test Loss: 384.672 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 30.802467584609985
Epoch: 15, Steps: 64 | Train Loss: 18.723 Vali Loss: 683.576 Vali Acc: 0.336 Test Loss: 683.576 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 31.082275390625
Epoch: 16, Steps: 64 | Train Loss: 9.007 Vali Loss: 705.064 Vali Acc: 0.573 Test Loss: 705.064 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 30.687111377716064
Epoch: 17, Steps: 64 | Train Loss: 4.375 Vali Loss: 393.910 Vali Acc: 0.519 Test Loss: 393.910 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 30.675607681274414
Epoch: 18, Steps: 64 | Train Loss: 21.738 Vali Loss: 548.209 Vali Acc: 0.374 Test Loss: 548.209 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 30.648154258728027
Epoch: 19, Steps: 64 | Train Loss: 14.402 Vali Loss: 574.466 Vali Acc: 0.481 Test Loss: 574.466 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 30.668588876724243
Epoch: 20, Steps: 64 | Train Loss: 12.911 Vali Loss: 507.892 Vali Acc: 0.588 Test Loss: 507.892 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 30.302628993988037
Epoch: 21, Steps: 64 | Train Loss: 80.604 Vali Loss: 949.758 Vali Acc: 0.397 Test Loss: 949.758 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 30.632498264312744
Epoch: 22, Steps: 64 | Train Loss: 102.125 Vali Loss: 420.130 Vali Acc: 0.573 Test Loss: 420.130 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 47381589
model size : 215.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.641239404678345
Epoch: 1, Steps: 32 | Train Loss: 53.110 Vali Loss: 116.640 Vali Acc: 0.275 Test Loss: 116.640 Test Acc: 0.275
Validation loss decreased (inf --> -0.273643).  Saving model ...
Epoch: 2 cost time: 25.95966911315918
Epoch: 2, Steps: 32 | Train Loss: 99.406 Vali Loss: 92.223 Vali Acc: 0.511 Test Loss: 92.223 Test Acc: 0.511
Validation loss decreased (-0.273643 --> -0.510528).  Saving model ...
Epoch: 3 cost time: 26.130025386810303
Epoch: 3, Steps: 32 | Train Loss: 130.259 Vali Loss: 210.785 Vali Acc: 0.427 Test Loss: 210.785 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 26.22970676422119
Epoch: 4, Steps: 32 | Train Loss: 90.338 Vali Loss: 151.618 Vali Acc: 0.198 Test Loss: 151.618 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 26.05204129219055
Epoch: 5, Steps: 32 | Train Loss: 60.238 Vali Loss: 151.616 Vali Acc: 0.557 Test Loss: 151.616 Test Acc: 0.557
Validation loss decreased (-0.510528 --> -0.555736).  Saving model ...
Epoch: 6 cost time: 25.984070777893066
Epoch: 6, Steps: 32 | Train Loss: 93.987 Vali Loss: 293.203 Vali Acc: 0.290 Test Loss: 293.203 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 26.364448308944702
Epoch: 7, Steps: 32 | Train Loss: 51.680 Vali Loss: 217.002 Vali Acc: 0.389 Test Loss: 217.002 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 26.148088693618774
Epoch: 8, Steps: 32 | Train Loss: 31.907 Vali Loss: 283.676 Vali Acc: 0.573 Test Loss: 283.676 Test Acc: 0.573
Validation loss decreased (-0.555736 --> -0.569682).  Saving model ...
Epoch: 9 cost time: 26.0108060836792
Epoch: 9, Steps: 32 | Train Loss: 22.414 Vali Loss: 697.226 Vali Acc: 0.115 Test Loss: 697.226 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 26.076754331588745
Epoch: 10, Steps: 32 | Train Loss: 54.395 Vali Loss: 331.567 Vali Acc: 0.603 Test Loss: 331.567 Test Acc: 0.603
Validation loss decreased (-0.569682 --> -0.599738).  Saving model ...
Epoch: 11 cost time: 26.066404104232788
Epoch: 11, Steps: 32 | Train Loss: 16.214 Vali Loss: 370.677 Vali Acc: 0.588 Test Loss: 370.677 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 26.189518928527832
Epoch: 12, Steps: 32 | Train Loss: 19.965 Vali Loss: 384.556 Vali Acc: 0.611 Test Loss: 384.556 Test Acc: 0.611
Validation loss decreased (-0.599738 --> -0.606841).  Saving model ...
Epoch: 13 cost time: 25.99424386024475
Epoch: 13, Steps: 32 | Train Loss: 39.143 Vali Loss: 356.672 Vali Acc: 0.641 Test Loss: 356.672 Test Acc: 0.641
Validation loss decreased (-0.606841 --> -0.637655).  Saving model ...
Epoch: 14 cost time: 26.279961585998535
Epoch: 14, Steps: 32 | Train Loss: 11.938 Vali Loss: 532.847 Vali Acc: 0.366 Test Loss: 532.847 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 26.1325261592865
Epoch: 15, Steps: 32 | Train Loss: 27.917 Vali Loss: 513.462 Vali Acc: 0.427 Test Loss: 513.462 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 25.841043949127197
Epoch: 16, Steps: 32 | Train Loss: 12.662 Vali Loss: 818.763 Vali Acc: 0.260 Test Loss: 818.763 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 26.113418340682983
Epoch: 17, Steps: 32 | Train Loss: 3.330 Vali Loss: 676.907 Vali Acc: 0.313 Test Loss: 676.907 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 25.766754150390625
Epoch: 18, Steps: 32 | Train Loss: 26.850 Vali Loss: 441.226 Vali Acc: 0.519 Test Loss: 441.226 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 26.11241340637207
Epoch: 19, Steps: 32 | Train Loss: 5.194 Vali Loss: 439.460 Vali Acc: 0.557 Test Loss: 439.460 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 26.309933185577393
Epoch: 20, Steps: 32 | Train Loss: 31.477 Vali Loss: 672.189 Vali Acc: 0.252 Test Loss: 672.189 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 26.181721687316895
Epoch: 21, Steps: 32 | Train Loss: 7.856 Vali Loss: 369.837 Vali Acc: 0.679 Test Loss: 369.837 Test Acc: 0.679
Validation loss decreased (-0.637655 --> -0.675691).  Saving model ...
Epoch: 22 cost time: 26.096369981765747
Epoch: 22, Steps: 32 | Train Loss: 0.960 Vali Loss: 299.654 Vali Acc: 0.710 Test Loss: 299.654 Test Acc: 0.710
Validation loss decreased (-0.675691 --> -0.706927).  Saving model ...
Epoch: 23 cost time: 26.359293222427368
Epoch: 23, Steps: 32 | Train Loss: 2.379 Vali Loss: 772.892 Vali Acc: 0.344 Test Loss: 772.892 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 26.269999027252197
Epoch: 24, Steps: 32 | Train Loss: 5.745 Vali Loss: 691.516 Vali Acc: 0.550 Test Loss: 691.516 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 25.9436936378479
Epoch: 25, Steps: 32 | Train Loss: 29.062 Vali Loss: 817.891 Vali Acc: 0.336 Test Loss: 817.891 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 26.271897077560425
Epoch: 26, Steps: 32 | Train Loss: 5.999 Vali Loss: 856.978 Vali Acc: 0.298 Test Loss: 856.978 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 26.245766639709473
Epoch: 27, Steps: 32 | Train Loss: 15.848 Vali Loss: 435.010 Vali Acc: 0.565 Test Loss: 435.010 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 26.062596559524536
Epoch: 28, Steps: 32 | Train Loss: 2.773 Vali Loss: 606.938 Vali Acc: 0.664 Test Loss: 606.938 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 26.485613346099854
Epoch: 29, Steps: 32 | Train Loss: 4.194 Vali Loss: 656.255 Vali Acc: 0.580 Test Loss: 656.255 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 26.105209589004517
Epoch: 30, Steps: 32 | Train Loss: 11.387 Vali Loss: 666.191 Vali Acc: 0.344 Test Loss: 666.191 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 26.041446924209595
Epoch: 31, Steps: 32 | Train Loss: 5.050 Vali Loss: 585.865 Vali Acc: 0.603 Test Loss: 585.865 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 26.213882446289062
Epoch: 32, Steps: 32 | Train Loss: 23.866 Vali Loss: 629.742 Vali Acc: 0.611 Test Loss: 629.742 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.7099236641221374
model parameter : 47381589
model size : 215.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 37.060524225234985
Epoch: 1, Steps: 64 | Train Loss: 119.140 Vali Loss: 163.614 Vali Acc: 0.237 Test Loss: 163.614 Test Acc: 0.237
Validation loss decreased (inf --> -0.235005).  Saving model ...
Epoch: 2 cost time: 35.31321740150452
Epoch: 2, Steps: 64 | Train Loss: 146.079 Vali Loss: 230.692 Vali Acc: 0.427 Test Loss: 230.692 Test Acc: 0.427
Validation loss decreased (-0.235005 --> -0.425174).  Saving model ...
Epoch: 3 cost time: 35.598196506500244
Epoch: 3, Steps: 64 | Train Loss: 251.160 Vali Loss: 199.042 Vali Acc: 0.504 Test Loss: 199.042 Test Acc: 0.504
Validation loss decreased (-0.425174 --> -0.501826).  Saving model ...
Epoch: 4 cost time: 35.57064461708069
Epoch: 4, Steps: 64 | Train Loss: 99.163 Vali Loss: 478.854 Vali Acc: 0.282 Test Loss: 478.854 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 35.65496587753296
Epoch: 5, Steps: 64 | Train Loss: 94.182 Vali Loss: 736.479 Vali Acc: 0.496 Test Loss: 736.479 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 35.41523599624634
Epoch: 6, Steps: 64 | Train Loss: 75.673 Vali Loss: 384.725 Vali Acc: 0.580 Test Loss: 384.725 Test Acc: 0.580
Validation loss decreased (-0.501826 --> -0.576305).  Saving model ...
Epoch: 7 cost time: 35.584322690963745
Epoch: 7, Steps: 64 | Train Loss: 130.278 Vali Loss: 284.012 Vali Acc: 0.603 Test Loss: 284.012 Test Acc: 0.603
Validation loss decreased (-0.576305 --> -0.600213).  Saving model ...
Epoch: 8 cost time: 35.504499673843384
Epoch: 8, Steps: 64 | Train Loss: 61.507 Vali Loss: 620.787 Vali Acc: 0.328 Test Loss: 620.787 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 35.493656158447266
Epoch: 9, Steps: 64 | Train Loss: 27.464 Vali Loss: 266.945 Vali Acc: 0.550 Test Loss: 266.945 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 35.62630033493042
Epoch: 10, Steps: 64 | Train Loss: 10.462 Vali Loss: 349.155 Vali Acc: 0.595 Test Loss: 349.155 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 35.395312547683716
Epoch: 11, Steps: 64 | Train Loss: 25.477 Vali Loss: 344.358 Vali Acc: 0.664 Test Loss: 344.358 Test Acc: 0.664
Validation loss decreased (-0.600213 --> -0.660679).  Saving model ...
Epoch: 12 cost time: 35.69266223907471
Epoch: 12, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.537 Vali Acc: 0.687 Test Loss: 328.537 Test Acc: 0.687
Validation loss decreased (-0.660679 --> -0.683738).  Saving model ...
Epoch: 13 cost time: 35.590662479400635
Epoch: 13, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 14 cost time: 35.61722159385681
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 35.43639898300171
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 16 cost time: 35.51895070075989
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 17 cost time: 35.84296178817749
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 18 cost time: 35.36021566390991
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 19 cost time: 35.690301179885864
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 20 cost time: 35.51891541481018
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 21 cost time: 35.80382943153381
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 22 cost time: 35.7434196472168
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 23 cost time: 35.52812743186951
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 24 cost time: 35.657636642456055
Epoch: 24, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 25 cost time: 35.54226899147034
Epoch: 25, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 26 cost time: 35.62297081947327
Epoch: 26, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 27 cost time: 35.41018843650818
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 28 cost time: 35.700218200683594
Epoch: 28, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 29 cost time: 35.97482180595398
Epoch: 29, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 30 cost time: 35.52408003807068
Epoch: 30, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 31 cost time: 35.78920221328735
Epoch: 31, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 32 cost time: 35.52920651435852
Epoch: 32, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 33 cost time: 35.485114336013794
Epoch: 33, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 34 cost time: 35.68293857574463
Epoch: 34, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 35 cost time: 35.47276496887207
Epoch: 35, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 36 cost time: 35.72740125656128
Epoch: 36, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 37 cost time: 35.632473945617676
Epoch: 37, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 38 cost time: 35.503363609313965
Epoch: 38, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 39 cost time: 35.645594358444214
Epoch: 39, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 40 cost time: 35.59264636039734
Epoch: 40, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 41 cost time: 35.680675983428955
Epoch: 41, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 42 cost time: 35.323909282684326
Epoch: 42, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 43 cost time: 35.73751449584961
Epoch: 43, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 44 cost time: 35.7030291557312
Epoch: 44, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 45 cost time: 35.55563259124756
Epoch: 45, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 46 cost time: 35.35210967063904
Epoch: 46, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 47 cost time: 35.59998941421509
Epoch: 47, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 48 cost time: 35.88051438331604
Epoch: 48, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 49 cost time: 35.54143714904785
Epoch: 49, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 50 cost time: 35.54349613189697
Epoch: 50, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 51 cost time: 35.720601320266724
Epoch: 51, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 52 cost time: 35.73728108406067
Epoch: 52, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 53 cost time: 35.61618208885193
Epoch: 53, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 54 cost time: 35.548877239227295
Epoch: 54, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 55 cost time: 35.91928815841675
Epoch: 55, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 56 cost time: 35.633333683013916
Epoch: 56, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 57 cost time: 35.78076243400574
Epoch: 57, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 58 cost time: 35.709983110427856
Epoch: 58, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 59 cost time: 35.572185039520264
Epoch: 59, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 60 cost time: 35.76886820793152
Epoch: 60, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 61 cost time: 35.37513041496277
Epoch: 61, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 62 cost time: 35.31896948814392
Epoch: 62, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 63 cost time: 36.000771284103394
Epoch: 63, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 64 cost time: 35.43684983253479
Epoch: 64, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 65 cost time: 35.48558807373047
Epoch: 65, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 66 cost time: 35.508729696273804
Epoch: 66, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 67 cost time: 35.824217557907104
Epoch: 67, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 68 cost time: 35.67905354499817
Epoch: 68, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 69 cost time: 35.25968074798584
Epoch: 69, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 70 cost time: 35.461939096450806
Epoch: 70, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 71 cost time: 35.571123123168945
Epoch: 71, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 72 cost time: 35.91258263587952
Epoch: 72, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 73 cost time: 35.38790822029114
Epoch: 73, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 74 cost time: 35.65837526321411
Epoch: 74, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 75 cost time: 35.655033349990845
Epoch: 75, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 76 cost time: 35.50479245185852
Epoch: 76, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 77 cost time: 35.855180740356445
Epoch: 77, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 78 cost time: 35.595574140548706
Epoch: 78, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 79 cost time: 35.82569217681885
Epoch: 79, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 80 cost time: 35.912951946258545
Epoch: 80, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 81 cost time: 35.900089263916016
Epoch: 81, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 82 cost time: 35.8004093170166
Epoch: 82, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 83 cost time: 35.77305817604065
Epoch: 83, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 84 cost time: 35.704833030700684
Epoch: 84, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 85 cost time: 35.46777367591858
Epoch: 85, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 86 cost time: 36.23631167411804
Epoch: 86, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 87 cost time: 35.84983515739441
Epoch: 87, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 88 cost time: 35.674023389816284
Epoch: 88, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 89 cost time: 35.93622708320618
Epoch: 89, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 90 cost time: 35.7278470993042
Epoch: 90, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 91 cost time: 35.974483251571655
Epoch: 91, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 92 cost time: 35.81734490394592
Epoch: 92, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 93 cost time: 36.114688873291016
Epoch: 93, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 94 cost time: 35.588709115982056
Epoch: 94, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 95 cost time: 35.66828513145447
Epoch: 95, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 96 cost time: 35.49131941795349
Epoch: 96, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 97 cost time: 35.39697313308716
Epoch: 97, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 98 cost time: 35.95359015464783
Epoch: 98, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 99 cost time: 35.55184578895569
Epoch: 99, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
Epoch: 100 cost time: 35.49540662765503
Epoch: 100, Steps: 64 | Train Loss: 0.000 Vali Loss: 328.521 Vali Acc: 0.687 Test Loss: 328.521 Test Acc: 0.687
Validation loss decreased (-0.683738 --> -0.683738).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6870229007633588
model parameter : 47250517
model size : 215.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 34.354607343673706
Epoch: 1, Steps: 64 | Train Loss: 132.235 Vali Loss: 95.715 Vali Acc: 0.412 Test Loss: 95.715 Test Acc: 0.412
Validation loss decreased (inf --> -0.411257).  Saving model ...
Epoch: 2 cost time: 32.734007835388184
Epoch: 2, Steps: 64 | Train Loss: 106.723 Vali Loss: 179.593 Vali Acc: 0.489 Test Loss: 179.593 Test Acc: 0.489
Validation loss decreased (-0.411257 --> -0.486754).  Saving model ...
Epoch: 3 cost time: 33.71838855743408
Epoch: 3, Steps: 64 | Train Loss: 96.111 Vali Loss: 760.460 Vali Acc: 0.435 Test Loss: 760.460 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 33.6410014629364
Epoch: 4, Steps: 64 | Train Loss: 203.465 Vali Loss: 521.980 Vali Acc: 0.260 Test Loss: 521.980 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 34.0064115524292
Epoch: 5, Steps: 64 | Train Loss: 123.463 Vali Loss: 476.473 Vali Acc: 0.504 Test Loss: 476.473 Test Acc: 0.504
Validation loss decreased (-0.486754 --> -0.499052).  Saving model ...
Epoch: 6 cost time: 32.747169494628906
Epoch: 6, Steps: 64 | Train Loss: 171.598 Vali Loss: 323.253 Vali Acc: 0.527 Test Loss: 323.253 Test Acc: 0.527
Validation loss decreased (-0.499052 --> -0.523485).  Saving model ...
Epoch: 7 cost time: 32.39211368560791
Epoch: 7, Steps: 64 | Train Loss: 67.842 Vali Loss: 860.227 Vali Acc: 0.191 Test Loss: 860.227 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 33.3283748626709
Epoch: 8, Steps: 64 | Train Loss: 104.699 Vali Loss: 253.364 Vali Acc: 0.626 Test Loss: 253.364 Test Acc: 0.626
Validation loss decreased (-0.523485 --> -0.623421).  Saving model ...
Epoch: 9 cost time: 33.72667741775513
Epoch: 9, Steps: 64 | Train Loss: 26.080 Vali Loss: 448.555 Vali Acc: 0.641 Test Loss: 448.555 Test Acc: 0.641
Validation loss decreased (-0.623421 --> -0.636736).  Saving model ...
Epoch: 10 cost time: 33.96290922164917
Epoch: 10, Steps: 64 | Train Loss: 35.707 Vali Loss: 471.707 Vali Acc: 0.443 Test Loss: 471.707 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 33.8823778629303
Epoch: 11, Steps: 64 | Train Loss: 49.630 Vali Loss: 489.244 Vali Acc: 0.641 Test Loss: 489.244 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 33.71802020072937
Epoch: 12, Steps: 64 | Train Loss: 6.508 Vali Loss: 584.749 Vali Acc: 0.603 Test Loss: 584.749 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 33.92840647697449
Epoch: 13, Steps: 64 | Train Loss: 1.606 Vali Loss: 1193.021 Vali Acc: 0.275 Test Loss: 1193.021 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 33.79578971862793
Epoch: 14, Steps: 64 | Train Loss: 55.177 Vali Loss: 606.998 Vali Acc: 0.542 Test Loss: 606.998 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 33.930951833724976
Epoch: 15, Steps: 64 | Train Loss: 20.633 Vali Loss: 782.687 Vali Acc: 0.466 Test Loss: 782.687 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 33.684441328048706
Epoch: 16, Steps: 64 | Train Loss: 15.011 Vali Loss: 522.039 Vali Acc: 0.557 Test Loss: 522.039 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 33.67225790023804
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 724.612 Vali Acc: 0.458 Test Loss: 724.612 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 33.28395128250122
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 724.956 Vali Acc: 0.458 Test Loss: 724.956 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 32.805673360824585
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 724.956 Vali Acc: 0.458 Test Loss: 724.956 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 47250517
model size : 215.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 32.08024311065674
Epoch: 1, Steps: 64 | Train Loss: 152.769 Vali Loss: 197.111 Vali Acc: 0.397 Test Loss: 197.111 Test Acc: 0.397
Validation loss decreased (inf --> -0.394975).  Saving model ...
Epoch: 2 cost time: 30.205738306045532
Epoch: 2, Steps: 64 | Train Loss: 160.237 Vali Loss: 247.726 Vali Acc: 0.481 Test Loss: 247.726 Test Acc: 0.481
Validation loss decreased (-0.394975 --> -0.478439).  Saving model ...
Epoch: 3 cost time: 30.724152088165283
Epoch: 3, Steps: 64 | Train Loss: 228.197 Vali Loss: 386.496 Vali Acc: 0.405 Test Loss: 386.496 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 30.304616928100586
Epoch: 4, Steps: 64 | Train Loss: 144.758 Vali Loss: 449.583 Vali Acc: 0.550 Test Loss: 449.583 Test Acc: 0.550
Validation loss decreased (-0.478439 --> -0.545122).  Saving model ...
Epoch: 5 cost time: 30.49794912338257
Epoch: 5, Steps: 64 | Train Loss: 82.702 Vali Loss: 575.412 Vali Acc: 0.519 Test Loss: 575.412 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 30.989786624908447
Epoch: 6, Steps: 64 | Train Loss: 139.336 Vali Loss: 764.910 Vali Acc: 0.275 Test Loss: 764.910 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 30.573083639144897
Epoch: 7, Steps: 64 | Train Loss: 97.255 Vali Loss: 498.760 Vali Acc: 0.450 Test Loss: 498.760 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 30.672006130218506
Epoch: 8, Steps: 64 | Train Loss: 45.078 Vali Loss: 525.182 Vali Acc: 0.305 Test Loss: 525.182 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 30.358283042907715
Epoch: 9, Steps: 64 | Train Loss: 56.020 Vali Loss: 387.536 Vali Acc: 0.519 Test Loss: 387.536 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 30.38037347793579
Epoch: 10, Steps: 64 | Train Loss: 15.247 Vali Loss: 355.800 Vali Acc: 0.466 Test Loss: 355.800 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 30.350473165512085
Epoch: 11, Steps: 64 | Train Loss: 7.932 Vali Loss: 454.466 Vali Acc: 0.618 Test Loss: 454.466 Test Acc: 0.618
Validation loss decreased (-0.545122 --> -0.613776).  Saving model ...
Epoch: 12 cost time: 30.371623754501343
Epoch: 12, Steps: 64 | Train Loss: 22.608 Vali Loss: 496.176 Vali Acc: 0.557 Test Loss: 496.176 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 30.494306325912476
Epoch: 13, Steps: 64 | Train Loss: 63.423 Vali Loss: 1087.932 Vali Acc: 0.321 Test Loss: 1087.932 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 30.47180199623108
Epoch: 14, Steps: 64 | Train Loss: 103.609 Vali Loss: 1150.357 Vali Acc: 0.481 Test Loss: 1150.357 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 30.772923946380615
Epoch: 15, Steps: 64 | Train Loss: 16.294 Vali Loss: 914.634 Vali Acc: 0.374 Test Loss: 914.634 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 30.52568030357361
Epoch: 16, Steps: 64 | Train Loss: 6.795 Vali Loss: 980.786 Vali Acc: 0.481 Test Loss: 980.786 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 30.70689821243286
Epoch: 17, Steps: 64 | Train Loss: 8.713 Vali Loss: 702.628 Vali Acc: 0.611 Test Loss: 702.628 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 30.40655207633972
Epoch: 18, Steps: 64 | Train Loss: 40.571 Vali Loss: 790.311 Vali Acc: 0.542 Test Loss: 790.311 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 30.599668979644775
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 942.188 Vali Acc: 0.496 Test Loss: 942.188 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 31.2080340385437
Epoch: 20, Steps: 64 | Train Loss: 1.299 Vali Loss: 902.890 Vali Acc: 0.550 Test Loss: 902.890 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 30.702580213546753
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 906.868 Vali Acc: 0.550 Test Loss: 906.868 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 47250517
model size : 215.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 27.477771997451782
Epoch: 1, Steps: 32 | Train Loss: 47.340 Vali Loss: 34.922 Vali Acc: 0.435 Test Loss: 34.922 Test Acc: 0.435
Validation loss decreased (inf --> -0.434765).  Saving model ...
Epoch: 2 cost time: 25.864716053009033
Epoch: 2, Steps: 32 | Train Loss: 61.542 Vali Loss: 79.052 Vali Acc: 0.336 Test Loss: 79.052 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 25.686981439590454
Epoch: 3, Steps: 32 | Train Loss: 106.010 Vali Loss: 150.953 Vali Acc: 0.542 Test Loss: 150.953 Test Acc: 0.542
Validation loss decreased (-0.434765 --> -0.540475).  Saving model ...
Epoch: 4 cost time: 25.532315969467163
Epoch: 4, Steps: 32 | Train Loss: 152.233 Vali Loss: 208.090 Vali Acc: 0.481 Test Loss: 208.090 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 25.945560216903687
Epoch: 5, Steps: 32 | Train Loss: 98.318 Vali Loss: 382.209 Vali Acc: 0.405 Test Loss: 382.209 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 26.039374828338623
Epoch: 6, Steps: 32 | Train Loss: 98.310 Vali Loss: 623.614 Vali Acc: 0.183 Test Loss: 623.614 Test Acc: 0.183
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 25.722300052642822
Epoch: 7, Steps: 32 | Train Loss: 85.619 Vali Loss: 213.796 Vali Acc: 0.557 Test Loss: 213.796 Test Acc: 0.557
Validation loss decreased (-0.540475 --> -0.555114).  Saving model ...
Epoch: 8 cost time: 25.926982164382935
Epoch: 8, Steps: 32 | Train Loss: 11.122 Vali Loss: 248.799 Vali Acc: 0.359 Test Loss: 248.799 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 25.890210390090942
Epoch: 9, Steps: 32 | Train Loss: 22.892 Vali Loss: 473.985 Vali Acc: 0.252 Test Loss: 473.985 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 25.848979234695435
Epoch: 10, Steps: 32 | Train Loss: 28.676 Vali Loss: 276.458 Vali Acc: 0.427 Test Loss: 276.458 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 25.76745319366455
Epoch: 11, Steps: 32 | Train Loss: 12.197 Vali Loss: 270.613 Vali Acc: 0.611 Test Loss: 270.613 Test Acc: 0.611
Validation loss decreased (-0.555114 --> -0.607981).  Saving model ...
Epoch: 12 cost time: 26.088703393936157
Epoch: 12, Steps: 32 | Train Loss: 44.154 Vali Loss: 433.259 Vali Acc: 0.374 Test Loss: 433.259 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 25.475430965423584
Epoch: 13, Steps: 32 | Train Loss: 7.386 Vali Loss: 299.392 Vali Acc: 0.611 Test Loss: 299.392 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 25.590139389038086
Epoch: 14, Steps: 32 | Train Loss: 37.459 Vali Loss: 528.653 Vali Acc: 0.420 Test Loss: 528.653 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 26.061646461486816
Epoch: 15, Steps: 32 | Train Loss: 6.253 Vali Loss: 317.473 Vali Acc: 0.626 Test Loss: 317.473 Test Acc: 0.626
Validation loss decreased (-0.607981 --> -0.622779).  Saving model ...
Epoch: 16 cost time: 25.89371395111084
Epoch: 16, Steps: 32 | Train Loss: 3.921 Vali Loss: 541.049 Vali Acc: 0.527 Test Loss: 541.049 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 26.007451057434082
Epoch: 17, Steps: 32 | Train Loss: 10.446 Vali Loss: 504.105 Vali Acc: 0.664 Test Loss: 504.105 Test Acc: 0.664
Validation loss decreased (-0.622779 --> -0.659081).  Saving model ...
Epoch: 18 cost time: 25.99482226371765
Epoch: 18, Steps: 32 | Train Loss: 16.801 Vali Loss: 790.965 Vali Acc: 0.328 Test Loss: 790.965 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 25.610110998153687
Epoch: 19, Steps: 32 | Train Loss: 10.931 Vali Loss: 555.150 Vali Acc: 0.550 Test Loss: 555.150 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 25.538007497787476
Epoch: 20, Steps: 32 | Train Loss: 7.301 Vali Loss: 610.726 Vali Acc: 0.641 Test Loss: 610.726 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 25.99847722053528
Epoch: 21, Steps: 32 | Train Loss: 2.747 Vali Loss: 773.215 Vali Acc: 0.603 Test Loss: 773.215 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 26.178913116455078
Epoch: 22, Steps: 32 | Train Loss: 10.416 Vali Loss: 627.047 Vali Acc: 0.573 Test Loss: 627.047 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 25.948662281036377
Epoch: 23, Steps: 32 | Train Loss: 31.738 Vali Loss: 720.933 Vali Acc: 0.405 Test Loss: 720.933 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 25.991047859191895
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 695.373 Vali Acc: 0.321 Test Loss: 695.373 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 25.866126537322998
Epoch: 25, Steps: 32 | Train Loss: 1.680 Vali Loss: 725.709 Vali Acc: 0.427 Test Loss: 725.709 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 25.791662454605103
Epoch: 26, Steps: 32 | Train Loss: 39.733 Vali Loss: 585.443 Vali Acc: 0.557 Test Loss: 585.443 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 25.5587956905365
Epoch: 27, Steps: 32 | Train Loss: 24.360 Vali Loss: 633.115 Vali Acc: 0.557 Test Loss: 633.115 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 47250517
model size : 215.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 23.103156089782715
Epoch: 1, Steps: 64 | Train Loss: 43.531 Vali Loss: 70.976 Vali Acc: 0.229 Test Loss: 70.976 Test Acc: 0.229
Validation loss decreased (inf --> -0.228298).  Saving model ...
Epoch: 2 cost time: 22.381090879440308
Epoch: 2, Steps: 64 | Train Loss: 67.514 Vali Loss: 138.904 Vali Acc: 0.229 Test Loss: 138.904 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 22.12998676300049
Epoch: 3, Steps: 64 | Train Loss: 103.501 Vali Loss: 179.570 Vali Acc: 0.481 Test Loss: 179.570 Test Acc: 0.481
Validation loss decreased (-0.228298 --> -0.479120).  Saving model ...
Epoch: 4 cost time: 22.156946897506714
Epoch: 4, Steps: 64 | Train Loss: 52.724 Vali Loss: 348.503 Vali Acc: 0.496 Test Loss: 348.503 Test Acc: 0.496
Validation loss decreased (-0.479120 --> -0.492698).  Saving model ...
Epoch: 5 cost time: 22.136028051376343
Epoch: 5, Steps: 64 | Train Loss: 73.678 Vali Loss: 185.573 Vali Acc: 0.511 Test Loss: 185.573 Test Acc: 0.511
Validation loss decreased (-0.492698 --> -0.509595).  Saving model ...
Epoch: 6 cost time: 22.0791974067688
Epoch: 6, Steps: 64 | Train Loss: 42.350 Vali Loss: 169.531 Vali Acc: 0.420 Test Loss: 169.531 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 22.02273178100586
Epoch: 7, Steps: 64 | Train Loss: 105.288 Vali Loss: 262.798 Vali Acc: 0.359 Test Loss: 262.798 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 22.457098722457886
Epoch: 8, Steps: 64 | Train Loss: 66.000 Vali Loss: 197.906 Vali Acc: 0.527 Test Loss: 197.906 Test Acc: 0.527
Validation loss decreased (-0.509595 --> -0.524739).  Saving model ...
Epoch: 9 cost time: 22.367326736450195
Epoch: 9, Steps: 64 | Train Loss: 13.720 Vali Loss: 288.211 Vali Acc: 0.344 Test Loss: 288.211 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 21.81829023361206
Epoch: 10, Steps: 64 | Train Loss: 34.885 Vali Loss: 469.637 Vali Acc: 0.313 Test Loss: 469.637 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 21.87226438522339
Epoch: 11, Steps: 64 | Train Loss: 26.662 Vali Loss: 396.698 Vali Acc: 0.481 Test Loss: 396.698 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 22.309301376342773
Epoch: 12, Steps: 64 | Train Loss: 20.950 Vali Loss: 337.839 Vali Acc: 0.389 Test Loss: 337.839 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 22.586382627487183
Epoch: 13, Steps: 64 | Train Loss: 13.723 Vali Loss: 483.287 Vali Acc: 0.542 Test Loss: 483.287 Test Acc: 0.542
Validation loss decreased (-0.524739 --> -0.537152).  Saving model ...
Epoch: 14 cost time: 21.85291862487793
Epoch: 14, Steps: 64 | Train Loss: 22.582 Vali Loss: 371.361 Vali Acc: 0.420 Test Loss: 371.361 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 22.45697808265686
Epoch: 15, Steps: 64 | Train Loss: 31.608 Vali Loss: 393.170 Vali Acc: 0.557 Test Loss: 393.170 Test Acc: 0.557
Validation loss decreased (-0.537152 --> -0.553320).  Saving model ...
Epoch: 16 cost time: 22.36545753479004
Epoch: 16, Steps: 64 | Train Loss: 18.059 Vali Loss: 322.024 Vali Acc: 0.557 Test Loss: 322.024 Test Acc: 0.557
Validation loss decreased (-0.553320 --> -0.554032).  Saving model ...
Epoch: 17 cost time: 22.141196727752686
Epoch: 17, Steps: 64 | Train Loss: 3.294 Vali Loss: 309.181 Vali Acc: 0.573 Test Loss: 309.181 Test Acc: 0.573
Validation loss decreased (-0.554032 --> -0.569427).  Saving model ...
Epoch: 18 cost time: 22.003854751586914
Epoch: 18, Steps: 64 | Train Loss: 3.435 Vali Loss: 315.694 Vali Acc: 0.573 Test Loss: 315.694 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 22.33661675453186
Epoch: 19, Steps: 64 | Train Loss: 14.009 Vali Loss: 321.785 Vali Acc: 0.481 Test Loss: 321.785 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 22.123679876327515
Epoch: 20, Steps: 64 | Train Loss: 0.811 Vali Loss: 488.637 Vali Acc: 0.519 Test Loss: 488.637 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 22.20402979850769
Epoch: 21, Steps: 64 | Train Loss: 3.821 Vali Loss: 324.045 Vali Acc: 0.511 Test Loss: 324.045 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 22.379855632781982
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 22.412476778030396
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 21.695467472076416
Epoch: 24, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 21.994670391082764
Epoch: 25, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 22.11204504966736
Epoch: 26, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 21.956880569458008
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 324.234 Vali Acc: 0.511 Test Loss: 324.234 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 25394773
model size : 114.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.042652130126953
Epoch: 1, Steps: 32 | Train Loss: 15.500 Vali Loss: 30.324 Vali Acc: 0.214 Test Loss: 30.324 Test Acc: 0.214
Validation loss decreased (inf --> -0.213437).  Saving model ...
Epoch: 2 cost time: 18.755675315856934
Epoch: 2, Steps: 32 | Train Loss: 36.874 Vali Loss: 49.341 Vali Acc: 0.519 Test Loss: 49.341 Test Acc: 0.519
Validation loss decreased (-0.213437 --> -0.518591).  Saving model ...
Epoch: 3 cost time: 19.25907254219055
Epoch: 3, Steps: 32 | Train Loss: 27.594 Vali Loss: 58.213 Vali Acc: 0.504 Test Loss: 58.213 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.31583523750305
Epoch: 4, Steps: 32 | Train Loss: 56.235 Vali Loss: 209.158 Vali Acc: 0.282 Test Loss: 209.158 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 19.072150468826294
Epoch: 5, Steps: 32 | Train Loss: 41.214 Vali Loss: 188.472 Vali Acc: 0.366 Test Loss: 188.472 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.320890188217163
Epoch: 6, Steps: 32 | Train Loss: 23.443 Vali Loss: 132.525 Vali Acc: 0.374 Test Loss: 132.525 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 19.523876667022705
Epoch: 7, Steps: 32 | Train Loss: 51.530 Vali Loss: 289.923 Vali Acc: 0.496 Test Loss: 289.923 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 19.20469307899475
Epoch: 8, Steps: 32 | Train Loss: 50.547 Vali Loss: 162.687 Vali Acc: 0.214 Test Loss: 162.687 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 19.179208755493164
Epoch: 9, Steps: 32 | Train Loss: 13.693 Vali Loss: 139.378 Vali Acc: 0.328 Test Loss: 139.378 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 19.109533309936523
Epoch: 10, Steps: 32 | Train Loss: 6.990 Vali Loss: 162.784 Vali Acc: 0.321 Test Loss: 162.784 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 19.017151355743408
Epoch: 11, Steps: 32 | Train Loss: 10.592 Vali Loss: 169.736 Vali Acc: 0.534 Test Loss: 169.736 Test Acc: 0.534
Validation loss decreased (-0.518591 --> -0.532654).  Saving model ...
Epoch: 12 cost time: 19.431789875030518
Epoch: 12, Steps: 32 | Train Loss: 10.084 Vali Loss: 180.423 Vali Acc: 0.366 Test Loss: 180.423 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.305296659469604
Epoch: 13, Steps: 32 | Train Loss: 9.509 Vali Loss: 164.366 Vali Acc: 0.382 Test Loss: 164.366 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.02121138572693
Epoch: 14, Steps: 32 | Train Loss: 10.729 Vali Loss: 157.510 Vali Acc: 0.534 Test Loss: 157.510 Test Acc: 0.534
Validation loss decreased (-0.532654 --> -0.532776).  Saving model ...
Epoch: 15 cost time: 19.276743173599243
Epoch: 15, Steps: 32 | Train Loss: 5.741 Vali Loss: 155.225 Vali Acc: 0.466 Test Loss: 155.225 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.81189465522766
Epoch: 16, Steps: 32 | Train Loss: 22.934 Vali Loss: 239.315 Vali Acc: 0.504 Test Loss: 239.315 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.452971696853638
Epoch: 17, Steps: 32 | Train Loss: 25.702 Vali Loss: 335.198 Vali Acc: 0.382 Test Loss: 335.198 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.260372638702393
Epoch: 18, Steps: 32 | Train Loss: 6.337 Vali Loss: 167.236 Vali Acc: 0.611 Test Loss: 167.236 Test Acc: 0.611
Validation loss decreased (-0.532776 --> -0.609015).  Saving model ...
Epoch: 19 cost time: 19.499194860458374
Epoch: 19, Steps: 32 | Train Loss: 2.932 Vali Loss: 220.921 Vali Acc: 0.504 Test Loss: 220.921 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 19.739137411117554
Epoch: 20, Steps: 32 | Train Loss: 5.368 Vali Loss: 452.777 Vali Acc: 0.313 Test Loss: 452.777 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.33569574356079
Epoch: 21, Steps: 32 | Train Loss: 43.428 Vali Loss: 279.117 Vali Acc: 0.550 Test Loss: 279.117 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 19.57754874229431
Epoch: 22, Steps: 32 | Train Loss: 6.831 Vali Loss: 238.261 Vali Acc: 0.496 Test Loss: 238.261 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.419944286346436
Epoch: 23, Steps: 32 | Train Loss: 3.549 Vali Loss: 319.269 Vali Acc: 0.443 Test Loss: 319.269 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 19.21222949028015
Epoch: 24, Steps: 32 | Train Loss: 11.303 Vali Loss: 251.530 Vali Acc: 0.618 Test Loss: 251.530 Test Acc: 0.618
Validation loss decreased (-0.609015 --> -0.615805).  Saving model ...
Epoch: 25 cost time: 19.389528036117554
Epoch: 25, Steps: 32 | Train Loss: 2.217 Vali Loss: 404.920 Vali Acc: 0.405 Test Loss: 404.920 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 19.610106706619263
Epoch: 26, Steps: 32 | Train Loss: 14.228 Vali Loss: 240.045 Vali Acc: 0.611 Test Loss: 240.045 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 19.015386819839478
Epoch: 27, Steps: 32 | Train Loss: 8.021 Vali Loss: 300.677 Vali Acc: 0.519 Test Loss: 300.677 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 19.403169631958008
Epoch: 28, Steps: 32 | Train Loss: 8.368 Vali Loss: 324.632 Vali Acc: 0.611 Test Loss: 324.632 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 19.503294467926025
Epoch: 29, Steps: 32 | Train Loss: 0.014 Vali Loss: 238.477 Vali Acc: 0.519 Test Loss: 238.477 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 19.082860231399536
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 272.914 Vali Acc: 0.473 Test Loss: 272.914 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 19.276370763778687
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 274.852 Vali Acc: 0.473 Test Loss: 274.852 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 19.22211217880249
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 274.888 Vali Acc: 0.473 Test Loss: 274.888 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 19.1453378200531
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 274.890 Vali Acc: 0.473 Test Loss: 274.890 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 19.374765157699585
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 274.890 Vali Acc: 0.473 Test Loss: 274.890 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 25394773
model size : 114.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.598270416259766
Epoch: 1, Steps: 32 | Train Loss: 19.907 Vali Loss: 41.156 Vali Acc: 0.267 Test Loss: 41.156 Test Acc: 0.267
Validation loss decreased (inf --> -0.266764).  Saving model ...
Epoch: 2 cost time: 18.20526385307312
Epoch: 2, Steps: 32 | Train Loss: 31.674 Vali Loss: 92.758 Vali Acc: 0.466 Test Loss: 92.758 Test Acc: 0.466
Validation loss decreased (-0.266764 --> -0.464721).  Saving model ...
Epoch: 3 cost time: 18.32869791984558
Epoch: 3, Steps: 32 | Train Loss: 32.718 Vali Loss: 70.199 Vali Acc: 0.489 Test Loss: 70.199 Test Acc: 0.489
Validation loss decreased (-0.464721 --> -0.487848).  Saving model ...
Epoch: 4 cost time: 18.080788135528564
Epoch: 4, Steps: 32 | Train Loss: 25.796 Vali Loss: 146.056 Vali Acc: 0.481 Test Loss: 146.056 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 18.404553174972534
Epoch: 5, Steps: 32 | Train Loss: 52.081 Vali Loss: 140.148 Vali Acc: 0.359 Test Loss: 140.148 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 18.353688955307007
Epoch: 6, Steps: 32 | Train Loss: 34.387 Vali Loss: 168.907 Vali Acc: 0.389 Test Loss: 168.907 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 17.973057508468628
Epoch: 7, Steps: 32 | Train Loss: 26.827 Vali Loss: 215.428 Vali Acc: 0.275 Test Loss: 215.428 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 18.196378707885742
Epoch: 8, Steps: 32 | Train Loss: 27.031 Vali Loss: 265.569 Vali Acc: 0.229 Test Loss: 265.569 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 17.825671434402466
Epoch: 9, Steps: 32 | Train Loss: 35.144 Vali Loss: 94.591 Vali Acc: 0.565 Test Loss: 94.591 Test Acc: 0.565
Validation loss decreased (-0.487848 --> -0.563940).  Saving model ...
Epoch: 10 cost time: 17.89281153678894
Epoch: 10, Steps: 32 | Train Loss: 4.947 Vali Loss: 148.970 Vali Acc: 0.382 Test Loss: 148.970 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 18.36769700050354
Epoch: 11, Steps: 32 | Train Loss: 7.172 Vali Loss: 180.378 Vali Acc: 0.344 Test Loss: 180.378 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 18.171062707901
Epoch: 12, Steps: 32 | Train Loss: 0.821 Vali Loss: 111.938 Vali Acc: 0.580 Test Loss: 111.938 Test Acc: 0.580
Validation loss decreased (-0.563940 --> -0.579033).  Saving model ...
Epoch: 13 cost time: 17.954943418502808
Epoch: 13, Steps: 32 | Train Loss: 14.381 Vali Loss: 150.861 Vali Acc: 0.557 Test Loss: 150.861 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 18.02127504348755
Epoch: 14, Steps: 32 | Train Loss: 0.222 Vali Loss: 103.517 Vali Acc: 0.534 Test Loss: 103.517 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 18.45173668861389
Epoch: 15, Steps: 32 | Train Loss: 0.378 Vali Loss: 129.332 Vali Acc: 0.603 Test Loss: 129.332 Test Acc: 0.603
Validation loss decreased (-0.579033 --> -0.601760).  Saving model ...
Epoch: 16 cost time: 18.573853254318237
Epoch: 16, Steps: 32 | Train Loss: 6.229 Vali Loss: 107.348 Vali Acc: 0.603 Test Loss: 107.348 Test Acc: 0.603
Validation loss decreased (-0.601760 --> -0.601980).  Saving model ...
Epoch: 17 cost time: 17.916526317596436
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.906 Vali Acc: 0.626 Test Loss: 102.906 Test Acc: 0.626
Validation loss decreased (-0.601980 --> -0.624925).  Saving model ...
Epoch: 18 cost time: 18.21098303794861
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.758 Vali Acc: 0.626 Test Loss: 102.758 Test Acc: 0.626
Validation loss decreased (-0.624925 --> -0.624927).  Saving model ...
Epoch: 19 cost time: 18.108523845672607
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 20 cost time: 18.31501054763794
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 21 cost time: 17.93923807144165
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 22 cost time: 18.09264373779297
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 23 cost time: 18.112525939941406
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 24 cost time: 18.18639898300171
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 25 cost time: 18.23530149459839
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 26 cost time: 18.54760193824768
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 27 cost time: 18.422300815582275
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 28 cost time: 18.250366687774658
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 29 cost time: 18.035252571105957
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 30 cost time: 18.056379795074463
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 31 cost time: 18.125376224517822
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 32 cost time: 18.336661338806152
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 33 cost time: 18.488463878631592
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 34 cost time: 18.95193910598755
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 35 cost time: 18.25089168548584
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 36 cost time: 18.266132831573486
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 37 cost time: 18.178083419799805
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 38 cost time: 18.371909379959106
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 39 cost time: 18.198960065841675
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 40 cost time: 18.450083255767822
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.754 Vali Acc: 0.626 Test Loss: 102.754 Test Acc: 0.626
Validation loss decreased (-0.624927 --> -0.624927).  Saving model ...
Epoch: 41 cost time: 18.072436809539795
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 102.217 Vali Acc: 0.611 Test Loss: 102.217 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 18.251818656921387
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.270 Vali Acc: 0.618 Test Loss: 105.270 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 18.373448133468628
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.416 Vali Acc: 0.618 Test Loss: 105.416 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 18.518465757369995
Epoch: 44, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 18.302197456359863
Epoch: 45, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 18.21850872039795
Epoch: 46, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 18.26394820213318
Epoch: 47, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 17.872129917144775
Epoch: 48, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 18.313794136047363
Epoch: 49, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 18.17976689338684
Epoch: 50, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.421 Vali Acc: 0.618 Test Loss: 105.421 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 25394773
model size : 114.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.2165105342865
Epoch: 1, Steps: 32 | Train Loss: 15.410 Vali Loss: 17.143 Vali Acc: 0.260 Test Loss: 17.143 Test Acc: 0.260
Validation loss decreased (inf --> -0.259371).  Saving model ...
Epoch: 2 cost time: 16.82606816291809
Epoch: 2, Steps: 32 | Train Loss: 34.291 Vali Loss: 75.944 Vali Acc: 0.183 Test Loss: 75.944 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.95763874053955
Epoch: 3, Steps: 32 | Train Loss: 65.147 Vali Loss: 146.607 Vali Acc: 0.168 Test Loss: 146.607 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 16.777934789657593
Epoch: 4, Steps: 32 | Train Loss: 70.759 Vali Loss: 154.302 Vali Acc: 0.191 Test Loss: 154.302 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 16.944918632507324
Epoch: 5, Steps: 32 | Train Loss: 59.749 Vali Loss: 74.664 Vali Acc: 0.511 Test Loss: 74.664 Test Acc: 0.511
Validation loss decreased (-0.259371 --> -0.510704).  Saving model ...
Epoch: 6 cost time: 16.725956439971924
Epoch: 6, Steps: 32 | Train Loss: 48.593 Vali Loss: 51.896 Vali Acc: 0.557 Test Loss: 51.896 Test Acc: 0.557
Validation loss decreased (-0.510704 --> -0.556733).  Saving model ...
Epoch: 7 cost time: 16.562597513198853
Epoch: 7, Steps: 32 | Train Loss: 25.616 Vali Loss: 80.035 Vali Acc: 0.496 Test Loss: 80.035 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 16.856963634490967
Epoch: 8, Steps: 32 | Train Loss: 10.154 Vali Loss: 202.272 Vali Acc: 0.275 Test Loss: 202.272 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 17.103423833847046
Epoch: 9, Steps: 32 | Train Loss: 47.328 Vali Loss: 286.322 Vali Acc: 0.214 Test Loss: 286.322 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 17.07979941368103
Epoch: 10, Steps: 32 | Train Loss: 28.310 Vali Loss: 161.570 Vali Acc: 0.382 Test Loss: 161.570 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.658236265182495
Epoch: 11, Steps: 32 | Train Loss: 33.813 Vali Loss: 455.461 Vali Acc: 0.290 Test Loss: 455.461 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.966473817825317
Epoch: 12, Steps: 32 | Train Loss: 31.292 Vali Loss: 296.172 Vali Acc: 0.374 Test Loss: 296.172 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.63587522506714
Epoch: 13, Steps: 32 | Train Loss: 5.778 Vali Loss: 329.546 Vali Acc: 0.336 Test Loss: 329.546 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 16.939482927322388
Epoch: 14, Steps: 32 | Train Loss: 12.297 Vali Loss: 373.826 Vali Acc: 0.557 Test Loss: 373.826 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.525801420211792
Epoch: 15, Steps: 32 | Train Loss: 10.258 Vali Loss: 574.207 Vali Acc: 0.229 Test Loss: 574.207 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 17.016507148742676
Epoch: 16, Steps: 32 | Train Loss: 12.878 Vali Loss: 377.449 Vali Acc: 0.328 Test Loss: 377.449 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 25394773
model size : 114.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.260472774505615
Epoch: 1, Steps: 64 | Train Loss: 70.748 Vali Loss: 61.111 Vali Acc: 0.290 Test Loss: 61.111 Test Acc: 0.290
Validation loss decreased (inf --> -0.289465).  Saving model ...
Epoch: 2 cost time: 20.21751356124878
Epoch: 2, Steps: 64 | Train Loss: 64.969 Vali Loss: 68.854 Vali Acc: 0.527 Test Loss: 68.854 Test Acc: 0.527
Validation loss decreased (-0.289465 --> -0.526029).  Saving model ...
Epoch: 3 cost time: 20.502749919891357
Epoch: 3, Steps: 64 | Train Loss: 42.942 Vali Loss: 127.836 Vali Acc: 0.351 Test Loss: 127.836 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.205292224884033
Epoch: 4, Steps: 64 | Train Loss: 75.708 Vali Loss: 221.997 Vali Acc: 0.298 Test Loss: 221.997 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.301034688949585
Epoch: 5, Steps: 64 | Train Loss: 76.413 Vali Loss: 227.687 Vali Acc: 0.489 Test Loss: 227.687 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.209163904190063
Epoch: 6, Steps: 64 | Train Loss: 68.487 Vali Loss: 280.776 Vali Acc: 0.305 Test Loss: 280.776 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.04945683479309
Epoch: 7, Steps: 64 | Train Loss: 139.545 Vali Loss: 306.203 Vali Acc: 0.305 Test Loss: 306.203 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.14445734024048
Epoch: 8, Steps: 64 | Train Loss: 107.661 Vali Loss: 267.001 Vali Acc: 0.473 Test Loss: 267.001 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.568246841430664
Epoch: 9, Steps: 64 | Train Loss: 15.696 Vali Loss: 281.126 Vali Acc: 0.527 Test Loss: 281.126 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.367507696151733
Epoch: 10, Steps: 64 | Train Loss: 4.596 Vali Loss: 312.954 Vali Acc: 0.550 Test Loss: 312.954 Test Acc: 0.550
Validation loss decreased (-0.526029 --> -0.546489).  Saving model ...
Epoch: 11 cost time: 20.699953079223633
Epoch: 11, Steps: 64 | Train Loss: 24.132 Vali Loss: 244.119 Vali Acc: 0.557 Test Loss: 244.119 Test Acc: 0.557
Validation loss decreased (-0.546489 --> -0.554811).  Saving model ...
Epoch: 12 cost time: 20.291276216506958
Epoch: 12, Steps: 64 | Train Loss: 23.882 Vali Loss: 379.465 Vali Acc: 0.328 Test Loss: 379.465 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.907772541046143
Epoch: 13, Steps: 64 | Train Loss: 8.902 Vali Loss: 262.623 Vali Acc: 0.557 Test Loss: 262.623 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.236231803894043
Epoch: 14, Steps: 64 | Train Loss: 5.923 Vali Loss: 275.934 Vali Acc: 0.450 Test Loss: 275.934 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 20.256452083587646
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.038 Vali Acc: 0.466 Test Loss: 277.038 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.098944664001465
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.14168381690979
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 20.709577322006226
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 20.261651754379272
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.05616044998169
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.27802014350891
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 277.039 Vali Acc: 0.466 Test Loss: 277.039 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 24346197
model size : 110.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.4142644405365
Epoch: 1, Steps: 32 | Train Loss: 30.685 Vali Loss: 43.713 Vali Acc: 0.214 Test Loss: 43.713 Test Acc: 0.214
Validation loss decreased (inf --> -0.213303).  Saving model ...
Epoch: 2 cost time: 17.719865798950195
Epoch: 2, Steps: 32 | Train Loss: 32.446 Vali Loss: 65.081 Vali Acc: 0.336 Test Loss: 65.081 Test Acc: 0.336
Validation loss decreased (-0.213303 --> -0.335227).  Saving model ...
Epoch: 3 cost time: 17.96927571296692
Epoch: 3, Steps: 32 | Train Loss: 29.417 Vali Loss: 51.043 Vali Acc: 0.443 Test Loss: 51.043 Test Acc: 0.443
Validation loss decreased (-0.335227 --> -0.442238).  Saving model ...
Epoch: 4 cost time: 17.934929370880127
Epoch: 4, Steps: 32 | Train Loss: 37.920 Vali Loss: 76.901 Vali Acc: 0.466 Test Loss: 76.901 Test Acc: 0.466
Validation loss decreased (-0.442238 --> -0.464880).  Saving model ...
Epoch: 5 cost time: 18.003511667251587
Epoch: 5, Steps: 32 | Train Loss: 53.939 Vali Loss: 242.561 Vali Acc: 0.382 Test Loss: 242.561 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.80251669883728
Epoch: 6, Steps: 32 | Train Loss: 42.321 Vali Loss: 205.718 Vali Acc: 0.290 Test Loss: 205.718 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 17.945623636245728
Epoch: 7, Steps: 32 | Train Loss: 38.644 Vali Loss: 298.573 Vali Acc: 0.237 Test Loss: 298.573 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 17.552707195281982
Epoch: 8, Steps: 32 | Train Loss: 53.372 Vali Loss: 149.400 Vali Acc: 0.427 Test Loss: 149.400 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 17.81532883644104
Epoch: 9, Steps: 32 | Train Loss: 23.644 Vali Loss: 144.343 Vali Acc: 0.550 Test Loss: 144.343 Test Acc: 0.550
Validation loss decreased (-0.464880 --> -0.548175).  Saving model ...
Epoch: 10 cost time: 17.92070245742798
Epoch: 10, Steps: 32 | Train Loss: 17.209 Vali Loss: 123.863 Vali Acc: 0.519 Test Loss: 123.863 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.676610946655273
Epoch: 11, Steps: 32 | Train Loss: 13.643 Vali Loss: 266.127 Vali Acc: 0.344 Test Loss: 266.127 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.823495626449585
Epoch: 12, Steps: 32 | Train Loss: 27.997 Vali Loss: 199.392 Vali Acc: 0.420 Test Loss: 199.392 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.865941762924194
Epoch: 13, Steps: 32 | Train Loss: 9.344 Vali Loss: 171.523 Vali Acc: 0.511 Test Loss: 171.523 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 18.00394606590271
Epoch: 14, Steps: 32 | Train Loss: 7.566 Vali Loss: 145.222 Vali Acc: 0.527 Test Loss: 145.222 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 17.791902542114258
Epoch: 15, Steps: 32 | Train Loss: 1.035 Vali Loss: 263.090 Vali Acc: 0.573 Test Loss: 263.090 Test Acc: 0.573
Validation loss decreased (-0.548175 --> -0.569888).  Saving model ...
Epoch: 16 cost time: 18.206640243530273
Epoch: 16, Steps: 32 | Train Loss: 13.889 Vali Loss: 289.051 Vali Acc: 0.427 Test Loss: 289.051 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 18.11700987815857
Epoch: 17, Steps: 32 | Train Loss: 18.216 Vali Loss: 305.075 Vali Acc: 0.290 Test Loss: 305.075 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 17.627848386764526
Epoch: 18, Steps: 32 | Train Loss: 9.079 Vali Loss: 380.315 Vali Acc: 0.344 Test Loss: 380.315 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 17.98690366744995
Epoch: 19, Steps: 32 | Train Loss: 1.681 Vali Loss: 282.660 Vali Acc: 0.389 Test Loss: 282.660 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 17.66895365715027
Epoch: 20, Steps: 32 | Train Loss: 2.921 Vali Loss: 229.995 Vali Acc: 0.450 Test Loss: 229.995 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 17.834022760391235
Epoch: 21, Steps: 32 | Train Loss: 3.953 Vali Loss: 306.983 Vali Acc: 0.550 Test Loss: 306.983 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 17.725386142730713
Epoch: 22, Steps: 32 | Train Loss: 18.217 Vali Loss: 332.709 Vali Acc: 0.557 Test Loss: 332.709 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 17.872122764587402
Epoch: 23, Steps: 32 | Train Loss: 12.273 Vali Loss: 281.084 Vali Acc: 0.481 Test Loss: 281.084 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 18.04457950592041
Epoch: 24, Steps: 32 | Train Loss: 31.066 Vali Loss: 328.639 Vali Acc: 0.351 Test Loss: 328.639 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 18.052250385284424
Epoch: 25, Steps: 32 | Train Loss: 6.630 Vali Loss: 329.467 Vali Acc: 0.504 Test Loss: 329.467 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 24346197
model size : 110.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.006160497665405
Epoch: 1, Steps: 32 | Train Loss: 31.881 Vali Loss: 26.670 Vali Acc: 0.527 Test Loss: 26.670 Test Acc: 0.527
Validation loss decreased (inf --> -0.526451).  Saving model ...
Epoch: 2 cost time: 16.906391620635986
Epoch: 2, Steps: 32 | Train Loss: 28.371 Vali Loss: 72.777 Vali Acc: 0.275 Test Loss: 72.777 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.9979829788208
Epoch: 3, Steps: 32 | Train Loss: 34.393 Vali Loss: 74.496 Vali Acc: 0.397 Test Loss: 74.496 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.505488395690918
Epoch: 4, Steps: 32 | Train Loss: 35.239 Vali Loss: 82.698 Vali Acc: 0.527 Test Loss: 82.698 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.008413553237915
Epoch: 5, Steps: 32 | Train Loss: 22.983 Vali Loss: 199.869 Vali Acc: 0.282 Test Loss: 199.869 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 17.213821172714233
Epoch: 6, Steps: 32 | Train Loss: 68.913 Vali Loss: 179.359 Vali Acc: 0.489 Test Loss: 179.359 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.803098678588867
Epoch: 7, Steps: 32 | Train Loss: 51.049 Vali Loss: 288.423 Vali Acc: 0.290 Test Loss: 288.423 Test Acc: 0.290
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 17.219683170318604
Epoch: 8, Steps: 32 | Train Loss: 31.684 Vali Loss: 204.314 Vali Acc: 0.366 Test Loss: 204.314 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 16.815531969070435
Epoch: 9, Steps: 32 | Train Loss: 16.456 Vali Loss: 94.247 Vali Acc: 0.595 Test Loss: 94.247 Test Acc: 0.595
Validation loss decreased (-0.526451 --> -0.594477).  Saving model ...
Epoch: 10 cost time: 17.75229549407959
Epoch: 10, Steps: 32 | Train Loss: 5.024 Vali Loss: 127.593 Vali Acc: 0.527 Test Loss: 127.593 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.368669509887695
Epoch: 11, Steps: 32 | Train Loss: 10.826 Vali Loss: 128.949 Vali Acc: 0.542 Test Loss: 128.949 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.17241358757019
Epoch: 12, Steps: 32 | Train Loss: 9.003 Vali Loss: 266.941 Vali Acc: 0.321 Test Loss: 266.941 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.2307767868042
Epoch: 13, Steps: 32 | Train Loss: 31.893 Vali Loss: 203.626 Vali Acc: 0.382 Test Loss: 203.626 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.681003093719482
Epoch: 14, Steps: 32 | Train Loss: 4.493 Vali Loss: 134.210 Vali Acc: 0.588 Test Loss: 134.210 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 17.114667892456055
Epoch: 15, Steps: 32 | Train Loss: 11.295 Vali Loss: 300.202 Vali Acc: 0.275 Test Loss: 300.202 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.459424257278442
Epoch: 16, Steps: 32 | Train Loss: 14.559 Vali Loss: 229.668 Vali Acc: 0.336 Test Loss: 229.668 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 17.139996767044067
Epoch: 17, Steps: 32 | Train Loss: 7.550 Vali Loss: 235.152 Vali Acc: 0.588 Test Loss: 235.152 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 17.298593997955322
Epoch: 18, Steps: 32 | Train Loss: 21.002 Vali Loss: 248.464 Vali Acc: 0.542 Test Loss: 248.464 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 17.054731369018555
Epoch: 19, Steps: 32 | Train Loss: 3.091 Vali Loss: 296.791 Vali Acc: 0.443 Test Loss: 296.791 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 24346197
model size : 110.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.19517993927002
Epoch: 1, Steps: 32 | Train Loss: 25.483 Vali Loss: 22.597 Vali Acc: 0.427 Test Loss: 22.597 Test Acc: 0.427
Validation loss decreased (inf --> -0.427255).  Saving model ...
Epoch: 2 cost time: 15.61099648475647
Epoch: 2, Steps: 32 | Train Loss: 29.387 Vali Loss: 56.068 Vali Acc: 0.267 Test Loss: 56.068 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.935571193695068
Epoch: 3, Steps: 32 | Train Loss: 45.487 Vali Loss: 122.974 Vali Acc: 0.221 Test Loss: 122.974 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.325941324234009
Epoch: 4, Steps: 32 | Train Loss: 38.138 Vali Loss: 123.872 Vali Acc: 0.198 Test Loss: 123.872 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.489629745483398
Epoch: 5, Steps: 32 | Train Loss: 50.622 Vali Loss: 200.831 Vali Acc: 0.206 Test Loss: 200.831 Test Acc: 0.206
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.368624925613403
Epoch: 6, Steps: 32 | Train Loss: 38.204 Vali Loss: 184.203 Vali Acc: 0.282 Test Loss: 184.203 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 15.646037101745605
Epoch: 7, Steps: 32 | Train Loss: 39.329 Vali Loss: 96.868 Vali Acc: 0.481 Test Loss: 96.868 Test Acc: 0.481
Validation loss decreased (-0.427255 --> -0.479947).  Saving model ...
Epoch: 8 cost time: 15.479456901550293
Epoch: 8, Steps: 32 | Train Loss: 26.267 Vali Loss: 114.726 Vali Acc: 0.527 Test Loss: 114.726 Test Acc: 0.527
Validation loss decreased (-0.479947 --> -0.525570).  Saving model ...
Epoch: 9 cost time: 15.765371084213257
Epoch: 9, Steps: 32 | Train Loss: 29.165 Vali Loss: 115.952 Vali Acc: 0.588 Test Loss: 115.952 Test Acc: 0.588
Validation loss decreased (-0.525570 --> -0.586627).  Saving model ...
Epoch: 10 cost time: 15.558481454849243
Epoch: 10, Steps: 32 | Train Loss: 22.425 Vali Loss: 262.015 Vali Acc: 0.237 Test Loss: 262.015 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.133798122406006
Epoch: 11, Steps: 32 | Train Loss: 20.489 Vali Loss: 217.475 Vali Acc: 0.313 Test Loss: 217.475 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.422014474868774
Epoch: 12, Steps: 32 | Train Loss: 8.597 Vali Loss: 206.165 Vali Acc: 0.374 Test Loss: 206.165 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.29719352722168
Epoch: 13, Steps: 32 | Train Loss: 10.858 Vali Loss: 202.160 Vali Acc: 0.573 Test Loss: 202.160 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.487162590026855
Epoch: 14, Steps: 32 | Train Loss: 8.681 Vali Loss: 137.987 Vali Acc: 0.405 Test Loss: 137.987 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.705005407333374
Epoch: 15, Steps: 32 | Train Loss: 4.648 Vali Loss: 136.183 Vali Acc: 0.611 Test Loss: 136.183 Test Acc: 0.611
Validation loss decreased (-0.586627 --> -0.609325).  Saving model ...
Epoch: 16 cost time: 15.670743227005005
Epoch: 16, Steps: 32 | Train Loss: 7.995 Vali Loss: 212.481 Vali Acc: 0.611 Test Loss: 212.481 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 15.952677726745605
Epoch: 17, Steps: 32 | Train Loss: 9.639 Vali Loss: 106.279 Vali Acc: 0.489 Test Loss: 106.279 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 15.375175952911377
Epoch: 18, Steps: 32 | Train Loss: 1.316 Vali Loss: 185.146 Vali Acc: 0.397 Test Loss: 185.146 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 15.725862741470337
Epoch: 19, Steps: 32 | Train Loss: 3.114 Vali Loss: 194.809 Vali Acc: 0.511 Test Loss: 194.809 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 15.270263195037842
Epoch: 20, Steps: 32 | Train Loss: 8.822 Vali Loss: 149.650 Vali Acc: 0.550 Test Loss: 149.650 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 15.519031763076782
Epoch: 21, Steps: 32 | Train Loss: 15.922 Vali Loss: 165.557 Vali Acc: 0.534 Test Loss: 165.557 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 15.472725629806519
Epoch: 22, Steps: 32 | Train Loss: 13.646 Vali Loss: 209.704 Vali Acc: 0.420 Test Loss: 209.704 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.079147338867188
Epoch: 23, Steps: 32 | Train Loss: 0.446 Vali Loss: 143.246 Vali Acc: 0.557 Test Loss: 143.246 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 15.297351360321045
Epoch: 24, Steps: 32 | Train Loss: 3.814 Vali Loss: 145.410 Vali Acc: 0.626 Test Loss: 145.410 Test Acc: 0.626
Validation loss decreased (-0.609325 --> -0.624500).  Saving model ...
Epoch: 25 cost time: 15.30333685874939
Epoch: 25, Steps: 32 | Train Loss: 1.055 Vali Loss: 169.611 Vali Acc: 0.649 Test Loss: 169.611 Test Acc: 0.649
Validation loss decreased (-0.624500 --> -0.647159).  Saving model ...
Epoch: 26 cost time: 15.211165189743042
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 175.952 Vali Acc: 0.649 Test Loss: 175.952 Test Acc: 0.649
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 15.533870935440063
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.124 Vali Acc: 0.649 Test Loss: 176.124 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 15.540372610092163
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.131 Vali Acc: 0.649 Test Loss: 176.131 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 15.601649284362793
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 15.747427701950073
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 15.489825010299683
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 15.71121335029602
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 15.473133325576782
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 15.443013191223145
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 15.4964919090271
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 176.132 Vali Acc: 0.649 Test Loss: 176.132 Test Acc: 0.649
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 24346197
model size : 110.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.81286334991455
Epoch: 1, Steps: 32 | Train Loss: 22.730 Vali Loss: 30.207 Vali Acc: 0.344 Test Loss: 30.207 Test Acc: 0.344
Validation loss decreased (inf --> -0.343209).  Saving model ...
Epoch: 2 cost time: 19.581405639648438
Epoch: 2, Steps: 32 | Train Loss: 22.134 Vali Loss: 51.270 Vali Acc: 0.214 Test Loss: 51.270 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.3182315826416
Epoch: 3, Steps: 32 | Train Loss: 50.105 Vali Loss: 137.727 Vali Acc: 0.504 Test Loss: 137.727 Test Acc: 0.504
Validation loss decreased (-0.343209 --> -0.502440).  Saving model ...
Epoch: 4 cost time: 19.45999050140381
Epoch: 4, Steps: 32 | Train Loss: 40.341 Vali Loss: 162.882 Vali Acc: 0.275 Test Loss: 162.882 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 19.308980703353882
Epoch: 5, Steps: 32 | Train Loss: 26.379 Vali Loss: 149.836 Vali Acc: 0.519 Test Loss: 149.836 Test Acc: 0.519
Validation loss decreased (-0.502440 --> -0.517586).  Saving model ...
Epoch: 6 cost time: 19.39993643760681
Epoch: 6, Steps: 32 | Train Loss: 36.329 Vali Loss: 206.378 Vali Acc: 0.511 Test Loss: 206.378 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.221510410308838
Epoch: 7, Steps: 32 | Train Loss: 30.604 Vali Loss: 208.334 Vali Acc: 0.206 Test Loss: 208.334 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.593327283859253
Epoch: 8, Steps: 32 | Train Loss: 28.002 Vali Loss: 85.195 Vali Acc: 0.565 Test Loss: 85.195 Test Acc: 0.565
Validation loss decreased (-0.517586 --> -0.564034).  Saving model ...
Epoch: 9 cost time: 19.28621530532837
Epoch: 9, Steps: 32 | Train Loss: 21.605 Vali Loss: 232.481 Vali Acc: 0.305 Test Loss: 232.481 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.72450828552246
Epoch: 10, Steps: 32 | Train Loss: 21.341 Vali Loss: 145.599 Vali Acc: 0.550 Test Loss: 145.599 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 19.713924169540405
Epoch: 11, Steps: 32 | Train Loss: 23.908 Vali Loss: 199.490 Vali Acc: 0.557 Test Loss: 199.490 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 19.913109064102173
Epoch: 12, Steps: 32 | Train Loss: 52.001 Vali Loss: 372.400 Vali Acc: 0.496 Test Loss: 372.400 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 19.57699465751648
Epoch: 13, Steps: 32 | Train Loss: 13.905 Vali Loss: 198.367 Vali Acc: 0.534 Test Loss: 198.367 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 20.01718044281006
Epoch: 14, Steps: 32 | Train Loss: 11.531 Vali Loss: 356.472 Vali Acc: 0.573 Test Loss: 356.472 Test Acc: 0.573
Validation loss decreased (-0.564034 --> -0.568954).  Saving model ...
Epoch: 15 cost time: 19.68192195892334
Epoch: 15, Steps: 32 | Train Loss: 1.862 Vali Loss: 244.590 Vali Acc: 0.397 Test Loss: 244.590 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.676819562911987
Epoch: 16, Steps: 32 | Train Loss: 2.717 Vali Loss: 284.560 Vali Acc: 0.267 Test Loss: 284.560 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.136921405792236
Epoch: 17, Steps: 32 | Train Loss: 3.632 Vali Loss: 232.930 Vali Acc: 0.366 Test Loss: 232.930 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.600428581237793
Epoch: 18, Steps: 32 | Train Loss: 1.929 Vali Loss: 254.487 Vali Acc: 0.595 Test Loss: 254.487 Test Acc: 0.595
Validation loss decreased (-0.568954 --> -0.592875).  Saving model ...
Epoch: 19 cost time: 19.385495901107788
Epoch: 19, Steps: 32 | Train Loss: 0.706 Vali Loss: 285.175 Vali Acc: 0.321 Test Loss: 285.175 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 19.874842643737793
Epoch: 20, Steps: 32 | Train Loss: 3.167 Vali Loss: 210.200 Vali Acc: 0.550 Test Loss: 210.200 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 19.54662561416626
Epoch: 21, Steps: 32 | Train Loss: 8.354 Vali Loss: 313.175 Vali Acc: 0.458 Test Loss: 313.175 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 19.618683576583862
Epoch: 22, Steps: 32 | Train Loss: 1.245 Vali Loss: 285.773 Vali Acc: 0.496 Test Loss: 285.773 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 19.38129711151123
Epoch: 23, Steps: 32 | Train Loss: 0.436 Vali Loss: 326.188 Vali Acc: 0.504 Test Loss: 326.188 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 19.60027837753296
Epoch: 24, Steps: 32 | Train Loss: 1.321 Vali Loss: 306.540 Vali Acc: 0.511 Test Loss: 306.540 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 19.698400020599365
Epoch: 25, Steps: 32 | Train Loss: 6.396 Vali Loss: 378.566 Vali Acc: 0.511 Test Loss: 378.566 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 19.639337301254272
Epoch: 26, Steps: 32 | Train Loss: 24.577 Vali Loss: 241.479 Vali Acc: 0.412 Test Loss: 241.479 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 19.508300304412842
Epoch: 27, Steps: 32 | Train Loss: 8.067 Vali Loss: 334.758 Vali Acc: 0.595 Test Loss: 334.758 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 19.503154754638672
Epoch: 28, Steps: 32 | Train Loss: 17.822 Vali Loss: 346.917 Vali Acc: 0.374 Test Loss: 346.917 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 23821909
model size : 108.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.34456443786621
Epoch: 1, Steps: 32 | Train Loss: 33.084 Vali Loss: 69.349 Vali Acc: 0.458 Test Loss: 69.349 Test Acc: 0.458
Validation loss decreased (inf --> -0.457322).  Saving model ...
Epoch: 2 cost time: 17.214112520217896
Epoch: 2, Steps: 32 | Train Loss: 53.357 Vali Loss: 73.021 Vali Acc: 0.481 Test Loss: 73.021 Test Acc: 0.481
Validation loss decreased (-0.457322 --> -0.480186).  Saving model ...
Epoch: 3 cost time: 17.311782121658325
Epoch: 3, Steps: 32 | Train Loss: 24.950 Vali Loss: 69.175 Vali Acc: 0.473 Test Loss: 69.175 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.87065625190735
Epoch: 4, Steps: 32 | Train Loss: 17.664 Vali Loss: 67.871 Vali Acc: 0.450 Test Loss: 67.871 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.179093837738037
Epoch: 5, Steps: 32 | Train Loss: 57.079 Vali Loss: 215.217 Vali Acc: 0.275 Test Loss: 215.217 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.990039348602295
Epoch: 6, Steps: 32 | Train Loss: 62.221 Vali Loss: 149.250 Vali Acc: 0.496 Test Loss: 149.250 Test Acc: 0.496
Validation loss decreased (-0.480186 --> -0.494691).  Saving model ...
Epoch: 7 cost time: 17.735193252563477
Epoch: 7, Steps: 32 | Train Loss: 32.510 Vali Loss: 128.653 Vali Acc: 0.534 Test Loss: 128.653 Test Acc: 0.534
Validation loss decreased (-0.494691 --> -0.533065).  Saving model ...
Epoch: 8 cost time: 17.120522260665894
Epoch: 8, Steps: 32 | Train Loss: 33.366 Vali Loss: 111.146 Vali Acc: 0.527 Test Loss: 111.146 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.438026905059814
Epoch: 9, Steps: 32 | Train Loss: 17.739 Vali Loss: 205.251 Vali Acc: 0.267 Test Loss: 205.251 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.17364001274109
Epoch: 10, Steps: 32 | Train Loss: 7.463 Vali Loss: 110.855 Vali Acc: 0.504 Test Loss: 110.855 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 17.868194580078125
Epoch: 11, Steps: 32 | Train Loss: 18.327 Vali Loss: 117.928 Vali Acc: 0.412 Test Loss: 117.928 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 17.057525873184204
Epoch: 12, Steps: 32 | Train Loss: 57.349 Vali Loss: 334.665 Vali Acc: 0.290 Test Loss: 334.665 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 17.374950408935547
Epoch: 13, Steps: 32 | Train Loss: 20.489 Vali Loss: 372.369 Vali Acc: 0.275 Test Loss: 372.369 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 17.129818439483643
Epoch: 14, Steps: 32 | Train Loss: 11.814 Vali Loss: 316.126 Vali Acc: 0.496 Test Loss: 316.126 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 17.282378435134888
Epoch: 15, Steps: 32 | Train Loss: 7.265 Vali Loss: 311.441 Vali Acc: 0.405 Test Loss: 311.441 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 17.553448915481567
Epoch: 16, Steps: 32 | Train Loss: 12.319 Vali Loss: 282.374 Vali Acc: 0.595 Test Loss: 282.374 Test Acc: 0.595
Validation loss decreased (-0.533065 --> -0.592596).  Saving model ...
Epoch: 17 cost time: 17.876452684402466
Epoch: 17, Steps: 32 | Train Loss: 5.723 Vali Loss: 266.067 Vali Acc: 0.298 Test Loss: 266.067 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.174659490585327
Epoch: 18, Steps: 32 | Train Loss: 3.701 Vali Loss: 230.918 Vali Acc: 0.565 Test Loss: 230.918 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.639172792434692
Epoch: 19, Steps: 32 | Train Loss: 1.454 Vali Loss: 254.179 Vali Acc: 0.382 Test Loss: 254.179 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.196209192276
Epoch: 20, Steps: 32 | Train Loss: 15.910 Vali Loss: 206.630 Vali Acc: 0.611 Test Loss: 206.630 Test Acc: 0.611
Validation loss decreased (-0.592596 --> -0.608621).  Saving model ...
Epoch: 21 cost time: 17.548542737960815
Epoch: 21, Steps: 32 | Train Loss: 41.185 Vali Loss: 228.509 Vali Acc: 0.588 Test Loss: 228.509 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 17.670613765716553
Epoch: 22, Steps: 32 | Train Loss: 1.285 Vali Loss: 187.255 Vali Acc: 0.580 Test Loss: 187.255 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 17.297207593917847
Epoch: 23, Steps: 32 | Train Loss: 1.909 Vali Loss: 178.535 Vali Acc: 0.595 Test Loss: 178.535 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 17.44372844696045
Epoch: 24, Steps: 32 | Train Loss: 4.772 Vali Loss: 237.997 Vali Acc: 0.573 Test Loss: 237.997 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 17.449966430664062
Epoch: 25, Steps: 32 | Train Loss: 5.821 Vali Loss: 177.798 Vali Acc: 0.573 Test Loss: 177.798 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 17.788296461105347
Epoch: 26, Steps: 32 | Train Loss: 2.387 Vali Loss: 210.863 Vali Acc: 0.534 Test Loss: 210.863 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 17.54824662208557
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 204.047 Vali Acc: 0.588 Test Loss: 204.047 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 17.496374368667603
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 205.829 Vali Acc: 0.588 Test Loss: 205.829 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 17.058528184890747
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 205.833 Vali Acc: 0.588 Test Loss: 205.833 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 17.302406549453735
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 205.836 Vali Acc: 0.588 Test Loss: 205.836 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 23821909
model size : 108.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.144862174987793
Epoch: 1, Steps: 32 | Train Loss: 22.567 Vali Loss: 72.250 Vali Acc: 0.305 Test Loss: 72.250 Test Acc: 0.305
Validation loss decreased (inf --> -0.304621).  Saving model ...
Epoch: 2 cost time: 16.371309280395508
Epoch: 2, Steps: 32 | Train Loss: 62.233 Vali Loss: 114.349 Vali Acc: 0.420 Test Loss: 114.349 Test Acc: 0.420
Validation loss decreased (-0.304621 --> -0.418704).  Saving model ...
Epoch: 3 cost time: 16.853657960891724
Epoch: 3, Steps: 32 | Train Loss: 62.802 Vali Loss: 136.698 Vali Acc: 0.443 Test Loss: 136.698 Test Acc: 0.443
Validation loss decreased (-0.418704 --> -0.441381).  Saving model ...
Epoch: 4 cost time: 16.485661029815674
Epoch: 4, Steps: 32 | Train Loss: 33.947 Vali Loss: 112.919 Vali Acc: 0.298 Test Loss: 112.919 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 17.167842626571655
Epoch: 5, Steps: 32 | Train Loss: 23.267 Vali Loss: 131.211 Vali Acc: 0.359 Test Loss: 131.211 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 17.009257793426514
Epoch: 6, Steps: 32 | Train Loss: 9.098 Vali Loss: 165.439 Vali Acc: 0.282 Test Loss: 165.439 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 16.7710120677948
Epoch: 7, Steps: 32 | Train Loss: 32.549 Vali Loss: 126.745 Vali Acc: 0.328 Test Loss: 126.745 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 16.54366636276245
Epoch: 8, Steps: 32 | Train Loss: 50.987 Vali Loss: 320.884 Vali Acc: 0.282 Test Loss: 320.884 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 16.559547901153564
Epoch: 9, Steps: 32 | Train Loss: 79.965 Vali Loss: 195.506 Vali Acc: 0.252 Test Loss: 195.506 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 16.708150625228882
Epoch: 10, Steps: 32 | Train Loss: 22.265 Vali Loss: 126.143 Vali Acc: 0.611 Test Loss: 126.143 Test Acc: 0.611
Validation loss decreased (-0.441381 --> -0.609426).  Saving model ...
Epoch: 11 cost time: 16.908786296844482
Epoch: 11, Steps: 32 | Train Loss: 12.416 Vali Loss: 127.918 Vali Acc: 0.511 Test Loss: 127.918 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.995989322662354
Epoch: 12, Steps: 32 | Train Loss: 23.016 Vali Loss: 291.338 Vali Acc: 0.267 Test Loss: 291.338 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.608562231063843
Epoch: 13, Steps: 32 | Train Loss: 12.577 Vali Loss: 136.371 Vali Acc: 0.550 Test Loss: 136.371 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.877076387405396
Epoch: 14, Steps: 32 | Train Loss: 4.432 Vali Loss: 154.722 Vali Acc: 0.420 Test Loss: 154.722 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.77191424369812
Epoch: 15, Steps: 32 | Train Loss: 5.717 Vali Loss: 174.924 Vali Acc: 0.504 Test Loss: 174.924 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.923060655593872
Epoch: 16, Steps: 32 | Train Loss: 14.663 Vali Loss: 192.536 Vali Acc: 0.588 Test Loss: 192.536 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 16.794094800949097
Epoch: 17, Steps: 32 | Train Loss: 2.824 Vali Loss: 250.362 Vali Acc: 0.344 Test Loss: 250.362 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.764768362045288
Epoch: 18, Steps: 32 | Train Loss: 9.790 Vali Loss: 232.371 Vali Acc: 0.504 Test Loss: 232.371 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 16.63458752632141
Epoch: 19, Steps: 32 | Train Loss: 2.672 Vali Loss: 229.655 Vali Acc: 0.496 Test Loss: 229.655 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 16.855366468429565
Epoch: 20, Steps: 32 | Train Loss: 18.591 Vali Loss: 245.513 Vali Acc: 0.634 Test Loss: 245.513 Test Acc: 0.634
Validation loss decreased (-0.609426 --> -0.631133).  Saving model ...
Epoch: 21 cost time: 17.13405728340149
Epoch: 21, Steps: 32 | Train Loss: 5.292 Vali Loss: 467.151 Vali Acc: 0.542 Test Loss: 467.151 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 16.747697114944458
Epoch: 22, Steps: 32 | Train Loss: 7.287 Vali Loss: 550.731 Vali Acc: 0.290 Test Loss: 550.731 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 16.870296955108643
Epoch: 23, Steps: 32 | Train Loss: 41.285 Vali Loss: 471.663 Vali Acc: 0.412 Test Loss: 471.663 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 16.611217737197876
Epoch: 24, Steps: 32 | Train Loss: 27.289 Vali Loss: 498.002 Vali Acc: 0.466 Test Loss: 498.002 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 16.73319721221924
Epoch: 25, Steps: 32 | Train Loss: 24.105 Vali Loss: 507.851 Vali Acc: 0.366 Test Loss: 507.851 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 16.609983444213867
Epoch: 26, Steps: 32 | Train Loss: 23.487 Vali Loss: 469.637 Vali Acc: 0.603 Test Loss: 469.637 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 17.123927116394043
Epoch: 27, Steps: 32 | Train Loss: 1.235 Vali Loss: 382.202 Vali Acc: 0.565 Test Loss: 382.202 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 16.873420238494873
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 384.190 Vali Acc: 0.573 Test Loss: 384.190 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 17.14742374420166
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 384.275 Vali Acc: 0.573 Test Loss: 384.275 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 16.80557107925415
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 384.278 Vali Acc: 0.573 Test Loss: 384.278 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 23821909
model size : 108.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.580512285232544
Epoch: 1, Steps: 32 | Train Loss: 19.883 Vali Loss: 30.196 Vali Acc: 0.374 Test Loss: 30.196 Test Acc: 0.374
Validation loss decreased (inf --> -0.373744).  Saving model ...
Epoch: 2 cost time: 15.244507074356079
Epoch: 2, Steps: 32 | Train Loss: 23.482 Vali Loss: 51.156 Vali Acc: 0.313 Test Loss: 51.156 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.826239585876465
Epoch: 3, Steps: 32 | Train Loss: 47.720 Vali Loss: 106.033 Vali Acc: 0.481 Test Loss: 106.033 Test Acc: 0.481
Validation loss decreased (-0.373744 --> -0.479856).  Saving model ...
Epoch: 4 cost time: 15.121901750564575
Epoch: 4, Steps: 32 | Train Loss: 51.230 Vali Loss: 57.876 Vali Acc: 0.389 Test Loss: 57.876 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 14.71672773361206
Epoch: 5, Steps: 32 | Train Loss: 26.825 Vali Loss: 143.046 Vali Acc: 0.321 Test Loss: 143.046 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 14.966660737991333
Epoch: 6, Steps: 32 | Train Loss: 45.563 Vali Loss: 151.804 Vali Acc: 0.397 Test Loss: 151.804 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.192418098449707
Epoch: 7, Steps: 32 | Train Loss: 68.927 Vali Loss: 222.417 Vali Acc: 0.504 Test Loss: 222.417 Test Acc: 0.504
Validation loss decreased (-0.479856 --> -0.501593).  Saving model ...
Epoch: 8 cost time: 15.366613388061523
Epoch: 8, Steps: 32 | Train Loss: 85.862 Vali Loss: 273.253 Vali Acc: 0.298 Test Loss: 273.253 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.112890005111694
Epoch: 9, Steps: 32 | Train Loss: 21.568 Vali Loss: 178.033 Vali Acc: 0.496 Test Loss: 178.033 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.917886972427368
Epoch: 10, Steps: 32 | Train Loss: 4.677 Vali Loss: 170.257 Vali Acc: 0.588 Test Loss: 170.257 Test Acc: 0.588
Validation loss decreased (-0.501593 --> -0.586084).  Saving model ...
Epoch: 11 cost time: 15.045782089233398
Epoch: 11, Steps: 32 | Train Loss: 1.750 Vali Loss: 148.404 Vali Acc: 0.580 Test Loss: 148.404 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.022912979125977
Epoch: 12, Steps: 32 | Train Loss: 6.692 Vali Loss: 176.099 Vali Acc: 0.473 Test Loss: 176.099 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.329679489135742
Epoch: 13, Steps: 32 | Train Loss: 14.852 Vali Loss: 129.759 Vali Acc: 0.565 Test Loss: 129.759 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.816904067993164
Epoch: 14, Steps: 32 | Train Loss: 11.157 Vali Loss: 221.353 Vali Acc: 0.336 Test Loss: 221.353 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.065678119659424
Epoch: 15, Steps: 32 | Train Loss: 5.259 Vali Loss: 207.830 Vali Acc: 0.298 Test Loss: 207.830 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.839069128036499
Epoch: 16, Steps: 32 | Train Loss: 3.971 Vali Loss: 244.555 Vali Acc: 0.504 Test Loss: 244.555 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.382303476333618
Epoch: 17, Steps: 32 | Train Loss: 2.009 Vali Loss: 238.441 Vali Acc: 0.504 Test Loss: 238.441 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.919283151626587
Epoch: 18, Steps: 32 | Train Loss: 1.129 Vali Loss: 270.466 Vali Acc: 0.550 Test Loss: 270.466 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.368910074234009
Epoch: 19, Steps: 32 | Train Loss: 13.302 Vali Loss: 369.559 Vali Acc: 0.412 Test Loss: 369.559 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.986425638198853
Epoch: 20, Steps: 32 | Train Loss: 4.456 Vali Loss: 167.582 Vali Acc: 0.641 Test Loss: 167.582 Test Acc: 0.641
Validation loss decreased (-0.586084 --> -0.639546).  Saving model ...
Epoch: 21 cost time: 14.988685846328735
Epoch: 21, Steps: 32 | Train Loss: 7.206 Vali Loss: 200.873 Vali Acc: 0.527 Test Loss: 200.873 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 14.947770833969116
Epoch: 22, Steps: 32 | Train Loss: 8.039 Vali Loss: 276.460 Vali Acc: 0.397 Test Loss: 276.460 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 15.109925031661987
Epoch: 23, Steps: 32 | Train Loss: 11.558 Vali Loss: 289.885 Vali Acc: 0.412 Test Loss: 289.885 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 15.25605034828186
Epoch: 24, Steps: 32 | Train Loss: 18.510 Vali Loss: 224.476 Vali Acc: 0.618 Test Loss: 224.476 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 14.664655447006226
Epoch: 25, Steps: 32 | Train Loss: 1.325 Vali Loss: 413.800 Vali Acc: 0.313 Test Loss: 413.800 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 15.101733684539795
Epoch: 26, Steps: 32 | Train Loss: 6.242 Vali Loss: 229.875 Vali Acc: 0.603 Test Loss: 229.875 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 14.805886268615723
Epoch: 27, Steps: 32 | Train Loss: 2.622 Vali Loss: 233.632 Vali Acc: 0.565 Test Loss: 233.632 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 15.370052099227905
Epoch: 28, Steps: 32 | Train Loss: 2.027 Vali Loss: 231.710 Vali Acc: 0.595 Test Loss: 231.710 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 15.377918004989624
Epoch: 29, Steps: 32 | Train Loss: 1.867 Vali Loss: 237.510 Vali Acc: 0.466 Test Loss: 237.510 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 15.152218580245972
Epoch: 30, Steps: 32 | Train Loss: 1.723 Vali Loss: 287.390 Vali Acc: 0.595 Test Loss: 287.390 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 23821909
model size : 108.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.101481199264526
Epoch: 1, Steps: 64 | Train Loss: 66.976 Vali Loss: 118.177 Vali Acc: 0.214 Test Loss: 118.177 Test Acc: 0.214
Validation loss decreased (inf --> -0.212559).  Saving model ...
Epoch: 2 cost time: 20.380171537399292
Epoch: 2, Steps: 64 | Train Loss: 47.836 Vali Loss: 156.140 Vali Acc: 0.191 Test Loss: 156.140 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 20.21911859512329
Epoch: 3, Steps: 64 | Train Loss: 81.917 Vali Loss: 514.403 Vali Acc: 0.305 Test Loss: 514.403 Test Acc: 0.305
Validation loss decreased (-0.212559 --> -0.300199).  Saving model ...
Epoch: 4 cost time: 20.982664108276367
Epoch: 4, Steps: 64 | Train Loss: 110.530 Vali Loss: 321.305 Vali Acc: 0.267 Test Loss: 321.305 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.343482494354248
Epoch: 5, Steps: 64 | Train Loss: 69.025 Vali Loss: 178.942 Vali Acc: 0.374 Test Loss: 178.942 Test Acc: 0.374
Validation loss decreased (-0.300199 --> -0.372256).  Saving model ...
Epoch: 6 cost time: 20.51976704597473
Epoch: 6, Steps: 64 | Train Loss: 15.929 Vali Loss: 149.091 Vali Acc: 0.511 Test Loss: 149.091 Test Acc: 0.511
Validation loss decreased (-0.372256 --> -0.509959).  Saving model ...
Epoch: 7 cost time: 20.810216188430786
Epoch: 7, Steps: 64 | Train Loss: 12.030 Vali Loss: 171.369 Vali Acc: 0.435 Test Loss: 171.369 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.044254064559937
Epoch: 8, Steps: 64 | Train Loss: 59.978 Vali Loss: 312.820 Vali Acc: 0.351 Test Loss: 312.820 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.260356426239014
Epoch: 9, Steps: 64 | Train Loss: 25.682 Vali Loss: 239.544 Vali Acc: 0.481 Test Loss: 239.544 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 20.216373205184937
Epoch: 10, Steps: 64 | Train Loss: 28.472 Vali Loss: 220.683 Vali Acc: 0.519 Test Loss: 220.683 Test Acc: 0.519
Validation loss decreased (-0.509959 --> -0.516877).  Saving model ...
Epoch: 11 cost time: 20.920765161514282
Epoch: 11, Steps: 64 | Train Loss: 8.451 Vali Loss: 238.219 Vali Acc: 0.573 Test Loss: 238.219 Test Acc: 0.573
Validation loss decreased (-0.516877 --> -0.570137).  Saving model ...
Epoch: 12 cost time: 20.720930099487305
Epoch: 12, Steps: 64 | Train Loss: 3.327 Vali Loss: 321.007 Vali Acc: 0.443 Test Loss: 321.007 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 20.467372179031372
Epoch: 13, Steps: 64 | Train Loss: 28.803 Vali Loss: 385.572 Vali Acc: 0.489 Test Loss: 385.572 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 20.75739622116089
Epoch: 14, Steps: 64 | Train Loss: 31.461 Vali Loss: 428.348 Vali Acc: 0.481 Test Loss: 428.348 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 21.617247581481934
Epoch: 15, Steps: 64 | Train Loss: 33.623 Vali Loss: 433.370 Vali Acc: 0.267 Test Loss: 433.370 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 20.96186351776123
Epoch: 16, Steps: 64 | Train Loss: 20.201 Vali Loss: 340.528 Vali Acc: 0.519 Test Loss: 340.528 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 20.797571897506714
Epoch: 17, Steps: 64 | Train Loss: 76.504 Vali Loss: 288.535 Vali Acc: 0.427 Test Loss: 288.535 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 21.687090396881104
Epoch: 18, Steps: 64 | Train Loss: 10.591 Vali Loss: 242.411 Vali Acc: 0.519 Test Loss: 242.411 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 21.479839086532593
Epoch: 19, Steps: 64 | Train Loss: 15.673 Vali Loss: 345.036 Vali Acc: 0.496 Test Loss: 345.036 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 20.780303716659546
Epoch: 20, Steps: 64 | Train Loss: 1.247 Vali Loss: 400.627 Vali Acc: 0.389 Test Loss: 400.627 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 20.859221696853638
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 401.825 Vali Acc: 0.382 Test Loss: 401.825 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 23559765
model size : 107.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.14353919029236
Epoch: 1, Steps: 32 | Train Loss: 20.562 Vali Loss: 67.233 Vali Acc: 0.237 Test Loss: 67.233 Test Acc: 0.237
Validation loss decreased (inf --> -0.235969).  Saving model ...
Epoch: 2 cost time: 17.44752049446106
Epoch: 2, Steps: 32 | Train Loss: 34.661 Vali Loss: 47.505 Vali Acc: 0.473 Test Loss: 47.505 Test Acc: 0.473
Validation loss decreased (-0.235969 --> -0.472807).  Saving model ...
Epoch: 3 cost time: 17.54478907585144
Epoch: 3, Steps: 32 | Train Loss: 25.660 Vali Loss: 49.746 Vali Acc: 0.466 Test Loss: 49.746 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 17.093294620513916
Epoch: 4, Steps: 32 | Train Loss: 27.758 Vali Loss: 114.023 Vali Acc: 0.260 Test Loss: 114.023 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 17.34078335762024
Epoch: 5, Steps: 32 | Train Loss: 47.063 Vali Loss: 154.236 Vali Acc: 0.321 Test Loss: 154.236 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 17.83794355392456
Epoch: 6, Steps: 32 | Train Loss: 25.485 Vali Loss: 233.011 Vali Acc: 0.260 Test Loss: 233.011 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 18.151589393615723
Epoch: 7, Steps: 32 | Train Loss: 29.364 Vali Loss: 114.694 Vali Acc: 0.534 Test Loss: 114.694 Test Acc: 0.534
Validation loss decreased (-0.472807 --> -0.533204).  Saving model ...
Epoch: 8 cost time: 17.56068229675293
Epoch: 8, Steps: 32 | Train Loss: 33.834 Vali Loss: 205.982 Vali Acc: 0.473 Test Loss: 205.982 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.921595096588135
Epoch: 9, Steps: 32 | Train Loss: 34.374 Vali Loss: 260.932 Vali Acc: 0.374 Test Loss: 260.932 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 17.857170343399048
Epoch: 10, Steps: 32 | Train Loss: 21.602 Vali Loss: 257.859 Vali Acc: 0.221 Test Loss: 257.859 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 18.203532457351685
Epoch: 11, Steps: 32 | Train Loss: 21.386 Vali Loss: 186.478 Vali Acc: 0.511 Test Loss: 186.478 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 18.68004083633423
Epoch: 12, Steps: 32 | Train Loss: 17.534 Vali Loss: 375.785 Vali Acc: 0.504 Test Loss: 375.785 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 19.273693799972534
Epoch: 13, Steps: 32 | Train Loss: 48.317 Vali Loss: 246.708 Vali Acc: 0.527 Test Loss: 246.708 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 18.866400957107544
Epoch: 14, Steps: 32 | Train Loss: 16.954 Vali Loss: 165.574 Vali Acc: 0.443 Test Loss: 165.574 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 19.057680368423462
Epoch: 15, Steps: 32 | Train Loss: 12.356 Vali Loss: 196.174 Vali Acc: 0.382 Test Loss: 196.174 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 18.66193652153015
Epoch: 16, Steps: 32 | Train Loss: 8.162 Vali Loss: 188.582 Vali Acc: 0.450 Test Loss: 188.582 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 19.21439480781555
Epoch: 17, Steps: 32 | Train Loss: 3.637 Vali Loss: 240.071 Vali Acc: 0.542 Test Loss: 240.071 Test Acc: 0.542
Validation loss decreased (-0.533204 --> -0.539584).  Saving model ...
Epoch: 18 cost time: 19.408010482788086
Epoch: 18, Steps: 32 | Train Loss: 4.940 Vali Loss: 250.031 Vali Acc: 0.542 Test Loss: 250.031 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 18.400377988815308
Epoch: 19, Steps: 32 | Train Loss: 8.177 Vali Loss: 197.585 Vali Acc: 0.504 Test Loss: 197.585 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 19.378762245178223
Epoch: 20, Steps: 32 | Train Loss: 3.708 Vali Loss: 315.925 Vali Acc: 0.550 Test Loss: 315.925 Test Acc: 0.550
Validation loss decreased (-0.539584 --> -0.546459).  Saving model ...
Epoch: 21 cost time: 18.915315866470337
Epoch: 21, Steps: 32 | Train Loss: 10.830 Vali Loss: 350.771 Vali Acc: 0.496 Test Loss: 350.771 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 18.52407193183899
Epoch: 22, Steps: 32 | Train Loss: 3.917 Vali Loss: 304.501 Vali Acc: 0.527 Test Loss: 304.501 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 19.582722187042236
Epoch: 23, Steps: 32 | Train Loss: 8.579 Vali Loss: 278.618 Vali Acc: 0.626 Test Loss: 278.618 Test Acc: 0.626
Validation loss decreased (-0.546459 --> -0.623168).  Saving model ...
Epoch: 24 cost time: 18.859530448913574
Epoch: 24, Steps: 32 | Train Loss: 22.446 Vali Loss: 335.531 Vali Acc: 0.412 Test Loss: 335.531 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 19.11768889427185
Epoch: 25, Steps: 32 | Train Loss: 9.536 Vali Loss: 254.005 Vali Acc: 0.641 Test Loss: 254.005 Test Acc: 0.641
Validation loss decreased (-0.623168 --> -0.638681).  Saving model ...
Epoch: 26 cost time: 18.819164276123047
Epoch: 26, Steps: 32 | Train Loss: 0.103 Vali Loss: 408.473 Vali Acc: 0.313 Test Loss: 408.473 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 18.09773015975952
Epoch: 27, Steps: 32 | Train Loss: 15.873 Vali Loss: 346.384 Vali Acc: 0.359 Test Loss: 346.384 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 18.676893711090088
Epoch: 28, Steps: 32 | Train Loss: 3.797 Vali Loss: 243.441 Vali Acc: 0.611 Test Loss: 243.441 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 18.079787731170654
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 278.100 Vali Acc: 0.542 Test Loss: 278.100 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 18.723185062408447
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.116 Vali Acc: 0.542 Test Loss: 280.116 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 19.262689352035522
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.179 Vali Acc: 0.542 Test Loss: 280.179 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 19.058587312698364
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.182 Vali Acc: 0.542 Test Loss: 280.182 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 19.142365217208862
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.182 Vali Acc: 0.542 Test Loss: 280.182 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 19.2903048992157
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.182 Vali Acc: 0.542 Test Loss: 280.182 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 18.489977836608887
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 280.182 Vali Acc: 0.542 Test Loss: 280.182 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 23559765
model size : 107.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.46690797805786
Epoch: 1, Steps: 32 | Train Loss: 23.798 Vali Loss: 80.620 Vali Acc: 0.313 Test Loss: 80.620 Test Acc: 0.313
Validation loss decreased (inf --> -0.312171).  Saving model ...
Epoch: 2 cost time: 17.399989128112793
Epoch: 2, Steps: 32 | Train Loss: 69.597 Vali Loss: 130.164 Vali Acc: 0.191 Test Loss: 130.164 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 18.63828444480896
Epoch: 3, Steps: 32 | Train Loss: 28.362 Vali Loss: 94.522 Vali Acc: 0.198 Test Loss: 94.522 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.425597429275513
Epoch: 4, Steps: 32 | Train Loss: 44.201 Vali Loss: 126.492 Vali Acc: 0.290 Test Loss: 126.492 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 17.269084930419922
Epoch: 5, Steps: 32 | Train Loss: 48.861 Vali Loss: 149.139 Vali Acc: 0.351 Test Loss: 149.139 Test Acc: 0.351
Validation loss decreased (-0.312171 --> -0.349654).  Saving model ...
Epoch: 6 cost time: 17.219631910324097
Epoch: 6, Steps: 32 | Train Loss: 46.091 Vali Loss: 189.106 Vali Acc: 0.321 Test Loss: 189.106 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 17.295044422149658
Epoch: 7, Steps: 32 | Train Loss: 48.670 Vali Loss: 168.667 Vali Acc: 0.336 Test Loss: 168.667 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 18.119298219680786
Epoch: 8, Steps: 32 | Train Loss: 17.052 Vali Loss: 144.444 Vali Acc: 0.450 Test Loss: 144.444 Test Acc: 0.450
Validation loss decreased (-0.349654 --> -0.448937).  Saving model ...
Epoch: 9 cost time: 17.523856163024902
Epoch: 9, Steps: 32 | Train Loss: 15.920 Vali Loss: 258.805 Vali Acc: 0.267 Test Loss: 258.805 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 17.82183837890625
Epoch: 10, Steps: 32 | Train Loss: 17.658 Vali Loss: 133.941 Vali Acc: 0.481 Test Loss: 133.941 Test Acc: 0.481
Validation loss decreased (-0.448937 --> -0.479577).  Saving model ...
Epoch: 11 cost time: 18.09062099456787
Epoch: 11, Steps: 32 | Train Loss: 17.051 Vali Loss: 211.897 Vali Acc: 0.290 Test Loss: 211.897 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.359131813049316
Epoch: 12, Steps: 32 | Train Loss: 20.782 Vali Loss: 260.838 Vali Acc: 0.550 Test Loss: 260.838 Test Acc: 0.550
Validation loss decreased (-0.479577 --> -0.547010).  Saving model ...
Epoch: 13 cost time: 17.744498014450073
Epoch: 13, Steps: 32 | Train Loss: 25.421 Vali Loss: 122.468 Vali Acc: 0.672 Test Loss: 122.468 Test Acc: 0.672
Validation loss decreased (-0.547010 --> -0.670531).  Saving model ...
Epoch: 14 cost time: 17.651662826538086
Epoch: 14, Steps: 32 | Train Loss: 14.286 Vali Loss: 265.295 Vali Acc: 0.489 Test Loss: 265.295 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 17.29519510269165
Epoch: 15, Steps: 32 | Train Loss: 11.500 Vali Loss: 209.691 Vali Acc: 0.466 Test Loss: 209.691 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.383059978485107
Epoch: 16, Steps: 32 | Train Loss: 15.675 Vali Loss: 195.602 Vali Acc: 0.565 Test Loss: 195.602 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 17.52493929862976
Epoch: 17, Steps: 32 | Train Loss: 14.385 Vali Loss: 214.725 Vali Acc: 0.534 Test Loss: 214.725 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 17.729340314865112
Epoch: 18, Steps: 32 | Train Loss: 5.170 Vali Loss: 282.949 Vali Acc: 0.466 Test Loss: 282.949 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 17.807597160339355
Epoch: 19, Steps: 32 | Train Loss: 1.942 Vali Loss: 274.156 Vali Acc: 0.595 Test Loss: 274.156 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 17.86295461654663
Epoch: 20, Steps: 32 | Train Loss: 0.112 Vali Loss: 264.013 Vali Acc: 0.397 Test Loss: 264.013 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 17.30659246444702
Epoch: 21, Steps: 32 | Train Loss: 2.306 Vali Loss: 264.418 Vali Acc: 0.618 Test Loss: 264.418 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 17.545847177505493
Epoch: 22, Steps: 32 | Train Loss: 0.041 Vali Loss: 243.814 Vali Acc: 0.565 Test Loss: 243.814 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 17.111579179763794
Epoch: 23, Steps: 32 | Train Loss: 11.517 Vali Loss: 355.717 Vali Acc: 0.450 Test Loss: 355.717 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6717557251908397
model parameter : 23559765
model size : 107.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.308207750320435
Epoch: 1, Steps: 32 | Train Loss: 25.577 Vali Loss: 27.447 Vali Acc: 0.427 Test Loss: 27.447 Test Acc: 0.427
Validation loss decreased (inf --> -0.427206).  Saving model ...
Epoch: 2 cost time: 16.062598943710327
Epoch: 2, Steps: 32 | Train Loss: 36.712 Vali Loss: 55.857 Vali Acc: 0.450 Test Loss: 55.857 Test Acc: 0.450
Validation loss decreased (-0.427206 --> -0.449823).  Saving model ...
Epoch: 3 cost time: 16.755258083343506
Epoch: 3, Steps: 32 | Train Loss: 55.969 Vali Loss: 26.774 Vali Acc: 0.420 Test Loss: 26.774 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.64990496635437
Epoch: 4, Steps: 32 | Train Loss: 50.086 Vali Loss: 83.916 Vali Acc: 0.313 Test Loss: 83.916 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.699222326278687
Epoch: 5, Steps: 32 | Train Loss: 72.110 Vali Loss: 154.219 Vali Acc: 0.282 Test Loss: 154.219 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.3984854221344
Epoch: 6, Steps: 32 | Train Loss: 50.649 Vali Loss: 50.882 Vali Acc: 0.611 Test Loss: 50.882 Test Acc: 0.611
Validation loss decreased (-0.449823 --> -0.610178).  Saving model ...
Epoch: 7 cost time: 16.637162446975708
Epoch: 7, Steps: 32 | Train Loss: 18.209 Vali Loss: 110.226 Vali Acc: 0.305 Test Loss: 110.226 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 17.15576195716858
Epoch: 8, Steps: 32 | Train Loss: 72.859 Vali Loss: 223.553 Vali Acc: 0.374 Test Loss: 223.553 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.88125729560852
Epoch: 9, Steps: 32 | Train Loss: 27.573 Vali Loss: 405.875 Vali Acc: 0.221 Test Loss: 405.875 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 16.64030885696411
Epoch: 10, Steps: 32 | Train Loss: 26.209 Vali Loss: 292.850 Vali Acc: 0.580 Test Loss: 292.850 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 16.81675100326538
Epoch: 11, Steps: 32 | Train Loss: 12.953 Vali Loss: 233.234 Vali Acc: 0.504 Test Loss: 233.234 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 16.474894762039185
Epoch: 12, Steps: 32 | Train Loss: 3.467 Vali Loss: 248.529 Vali Acc: 0.473 Test Loss: 248.529 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 16.363701581954956
Epoch: 13, Steps: 32 | Train Loss: 2.729 Vali Loss: 233.149 Vali Acc: 0.504 Test Loss: 233.149 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 17.649075269699097
Epoch: 14, Steps: 32 | Train Loss: 27.261 Vali Loss: 332.366 Vali Acc: 0.595 Test Loss: 332.366 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 16.220731496810913
Epoch: 15, Steps: 32 | Train Loss: 5.783 Vali Loss: 246.507 Vali Acc: 0.611 Test Loss: 246.507 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 16.128913164138794
Epoch: 16, Steps: 32 | Train Loss: 12.931 Vali Loss: 364.467 Vali Acc: 0.603 Test Loss: 364.467 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 23559765
model size : 107.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.893506288528442
Epoch: 1, Steps: 32 | Train Loss: 20.239 Vali Loss: 21.923 Vali Acc: 0.481 Test Loss: 21.923 Test Acc: 0.481
Validation loss decreased (inf --> -0.480697).  Saving model ...
Epoch: 2 cost time: 20.39479637145996
Epoch: 2, Steps: 32 | Train Loss: 28.959 Vali Loss: 54.013 Vali Acc: 0.489 Test Loss: 54.013 Test Acc: 0.489
Validation loss decreased (-0.480697 --> -0.488009).  Saving model ...
Epoch: 3 cost time: 20.507981538772583
Epoch: 3, Steps: 32 | Train Loss: 37.062 Vali Loss: 144.303 Vali Acc: 0.351 Test Loss: 144.303 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.505032062530518
Epoch: 4, Steps: 32 | Train Loss: 16.019 Vali Loss: 109.301 Vali Acc: 0.511 Test Loss: 109.301 Test Acc: 0.511
Validation loss decreased (-0.488009 --> -0.510357).  Saving model ...
Epoch: 5 cost time: 20.438180685043335
Epoch: 5, Steps: 32 | Train Loss: 22.757 Vali Loss: 150.684 Vali Acc: 0.298 Test Loss: 150.684 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.213077783584595
Epoch: 6, Steps: 32 | Train Loss: 37.831 Vali Loss: 150.820 Vali Acc: 0.252 Test Loss: 150.820 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 20.64457869529724
Epoch: 7, Steps: 32 | Train Loss: 44.579 Vali Loss: 172.082 Vali Acc: 0.221 Test Loss: 172.082 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 20.39310121536255
Epoch: 8, Steps: 32 | Train Loss: 21.319 Vali Loss: 148.630 Vali Acc: 0.481 Test Loss: 148.630 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 19.724103689193726
Epoch: 9, Steps: 32 | Train Loss: 16.249 Vali Loss: 124.197 Vali Acc: 0.527 Test Loss: 124.197 Test Acc: 0.527
Validation loss decreased (-0.510357 --> -0.525476).  Saving model ...
Epoch: 10 cost time: 20.32179355621338
Epoch: 10, Steps: 32 | Train Loss: 13.554 Vali Loss: 241.869 Vali Acc: 0.328 Test Loss: 241.869 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.941133975982666
Epoch: 11, Steps: 32 | Train Loss: 15.557 Vali Loss: 148.269 Vali Acc: 0.420 Test Loss: 148.269 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 20.293158769607544
Epoch: 12, Steps: 32 | Train Loss: 14.979 Vali Loss: 154.932 Vali Acc: 0.405 Test Loss: 154.932 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 19.892730712890625
Epoch: 13, Steps: 32 | Train Loss: 35.022 Vali Loss: 228.772 Vali Acc: 0.511 Test Loss: 228.772 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 20.287739038467407
Epoch: 14, Steps: 32 | Train Loss: 43.907 Vali Loss: 256.967 Vali Acc: 0.344 Test Loss: 256.967 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 20.18222451210022
Epoch: 15, Steps: 32 | Train Loss: 10.213 Vali Loss: 279.439 Vali Acc: 0.397 Test Loss: 279.439 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 20.259604692459106
Epoch: 16, Steps: 32 | Train Loss: 8.874 Vali Loss: 204.868 Vali Acc: 0.504 Test Loss: 204.868 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 20.350639820098877
Epoch: 17, Steps: 32 | Train Loss: 7.176 Vali Loss: 214.331 Vali Acc: 0.519 Test Loss: 214.331 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 20.32881236076355
Epoch: 18, Steps: 32 | Train Loss: 11.917 Vali Loss: 370.779 Vali Acc: 0.344 Test Loss: 370.779 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 19.667293071746826
Epoch: 19, Steps: 32 | Train Loss: 0.415 Vali Loss: 240.053 Vali Acc: 0.366 Test Loss: 240.053 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 23428693
model size : 106.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.068857192993164
Epoch: 1, Steps: 32 | Train Loss: 21.593 Vali Loss: 57.495 Vali Acc: 0.328 Test Loss: 57.495 Test Acc: 0.328
Validation loss decreased (inf --> -0.327669).  Saving model ...
Epoch: 2 cost time: 18.546990394592285
Epoch: 2, Steps: 32 | Train Loss: 26.584 Vali Loss: 57.437 Vali Acc: 0.443 Test Loss: 57.437 Test Acc: 0.443
Validation loss decreased (-0.327669 --> -0.442174).  Saving model ...
Epoch: 3 cost time: 18.94440984725952
Epoch: 3, Steps: 32 | Train Loss: 36.508 Vali Loss: 90.444 Vali Acc: 0.466 Test Loss: 90.444 Test Acc: 0.466
Validation loss decreased (-0.442174 --> -0.464744).  Saving model ...
Epoch: 4 cost time: 18.790650606155396
Epoch: 4, Steps: 32 | Train Loss: 34.564 Vali Loss: 94.079 Vali Acc: 0.519 Test Loss: 94.079 Test Acc: 0.519
Validation loss decreased (-0.464744 --> -0.518143).  Saving model ...
Epoch: 5 cost time: 18.243862628936768
Epoch: 5, Steps: 32 | Train Loss: 63.417 Vali Loss: 135.134 Vali Acc: 0.275 Test Loss: 135.134 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.73703694343567
Epoch: 6, Steps: 32 | Train Loss: 31.104 Vali Loss: 68.036 Vali Acc: 0.450 Test Loss: 68.036 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 18.565940380096436
Epoch: 7, Steps: 32 | Train Loss: 5.483 Vali Loss: 165.585 Vali Acc: 0.237 Test Loss: 165.585 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 19.318247318267822
Epoch: 8, Steps: 32 | Train Loss: 23.947 Vali Loss: 112.930 Vali Acc: 0.427 Test Loss: 112.930 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 18.470736503601074
Epoch: 9, Steps: 32 | Train Loss: 19.743 Vali Loss: 190.868 Vali Acc: 0.321 Test Loss: 190.868 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 18.77858304977417
Epoch: 10, Steps: 32 | Train Loss: 12.313 Vali Loss: 196.125 Vali Acc: 0.305 Test Loss: 196.125 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 19.582828998565674
Epoch: 11, Steps: 32 | Train Loss: 70.555 Vali Loss: 224.198 Vali Acc: 0.275 Test Loss: 224.198 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 18.847620487213135
Epoch: 12, Steps: 32 | Train Loss: 40.795 Vali Loss: 188.005 Vali Acc: 0.359 Test Loss: 188.005 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 18.94047212600708
Epoch: 13, Steps: 32 | Train Loss: 21.351 Vali Loss: 225.905 Vali Acc: 0.420 Test Loss: 225.905 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 18.486670970916748
Epoch: 14, Steps: 32 | Train Loss: 19.145 Vali Loss: 208.389 Vali Acc: 0.496 Test Loss: 208.389 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 23428693
model size : 106.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.085257053375244
Epoch: 1, Steps: 32 | Train Loss: 24.698 Vali Loss: 41.566 Vali Acc: 0.420 Test Loss: 41.566 Test Acc: 0.420
Validation loss decreased (inf --> -0.419432).  Saving model ...
Epoch: 2 cost time: 16.861909866333008
Epoch: 2, Steps: 32 | Train Loss: 58.637 Vali Loss: 63.159 Vali Acc: 0.397 Test Loss: 63.159 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.58107042312622
Epoch: 3, Steps: 32 | Train Loss: 34.058 Vali Loss: 52.888 Vali Acc: 0.366 Test Loss: 52.888 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.52586078643799
Epoch: 4, Steps: 32 | Train Loss: 36.468 Vali Loss: 124.406 Vali Acc: 0.450 Test Loss: 124.406 Test Acc: 0.450
Validation loss decreased (-0.419432 --> -0.449138).  Saving model ...
Epoch: 5 cost time: 16.950989246368408
Epoch: 5, Steps: 32 | Train Loss: 31.410 Vali Loss: 180.607 Vali Acc: 0.229 Test Loss: 180.607 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 17.549891233444214
Epoch: 6, Steps: 32 | Train Loss: 37.879 Vali Loss: 164.489 Vali Acc: 0.328 Test Loss: 164.489 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.381922006607056
Epoch: 7, Steps: 32 | Train Loss: 33.747 Vali Loss: 187.630 Vali Acc: 0.374 Test Loss: 187.630 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.37320899963379
Epoch: 8, Steps: 32 | Train Loss: 35.415 Vali Loss: 168.908 Vali Acc: 0.405 Test Loss: 168.908 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 16.94043779373169
Epoch: 9, Steps: 32 | Train Loss: 33.941 Vali Loss: 128.173 Vali Acc: 0.573 Test Loss: 128.173 Test Acc: 0.573
Validation loss decreased (-0.449138 --> -0.571237).  Saving model ...
Epoch: 10 cost time: 16.87556529045105
Epoch: 10, Steps: 32 | Train Loss: 17.909 Vali Loss: 102.884 Vali Acc: 0.603 Test Loss: 102.884 Test Acc: 0.603
Validation loss decreased (-0.571237 --> -0.602025).  Saving model ...
Epoch: 11 cost time: 16.71297812461853
Epoch: 11, Steps: 32 | Train Loss: 45.171 Vali Loss: 175.798 Vali Acc: 0.603 Test Loss: 175.798 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 17.889387130737305
Epoch: 12, Steps: 32 | Train Loss: 10.562 Vali Loss: 172.691 Vali Acc: 0.611 Test Loss: 172.691 Test Acc: 0.611
Validation loss decreased (-0.602025 --> -0.608960).  Saving model ...
Epoch: 13 cost time: 18.095040321350098
Epoch: 13, Steps: 32 | Train Loss: 44.897 Vali Loss: 229.717 Vali Acc: 0.527 Test Loss: 229.717 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 16.71601963043213
Epoch: 14, Steps: 32 | Train Loss: 10.236 Vali Loss: 263.122 Vali Acc: 0.321 Test Loss: 263.122 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 17.031397819519043
Epoch: 15, Steps: 32 | Train Loss: 11.736 Vali Loss: 351.613 Vali Acc: 0.252 Test Loss: 351.613 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 17.556944370269775
Epoch: 16, Steps: 32 | Train Loss: 19.259 Vali Loss: 207.576 Vali Acc: 0.435 Test Loss: 207.576 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 16.853896379470825
Epoch: 17, Steps: 32 | Train Loss: 3.599 Vali Loss: 205.269 Vali Acc: 0.580 Test Loss: 205.269 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 16.858320951461792
Epoch: 18, Steps: 32 | Train Loss: 18.008 Vali Loss: 509.552 Vali Acc: 0.305 Test Loss: 509.552 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 17.46344017982483
Epoch: 19, Steps: 32 | Train Loss: 9.763 Vali Loss: 205.449 Vali Acc: 0.519 Test Loss: 205.449 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 17.40421223640442
Epoch: 20, Steps: 32 | Train Loss: 32.759 Vali Loss: 230.794 Vali Acc: 0.435 Test Loss: 230.794 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 16.749863386154175
Epoch: 21, Steps: 32 | Train Loss: 3.414 Vali Loss: 253.839 Vali Acc: 0.534 Test Loss: 253.839 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 17.12513828277588
Epoch: 22, Steps: 32 | Train Loss: 3.051 Vali Loss: 315.526 Vali Acc: 0.450 Test Loss: 315.526 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 23428693
model size : 106.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.960161924362183
Epoch: 1, Steps: 32 | Train Loss: 22.681 Vali Loss: 18.557 Vali Acc: 0.550 Test Loss: 18.557 Test Acc: 0.550
Validation loss decreased (inf --> -0.549433).  Saving model ...
Epoch: 2 cost time: 15.670905351638794
Epoch: 2, Steps: 32 | Train Loss: 27.638 Vali Loss: 30.767 Vali Acc: 0.527 Test Loss: 30.767 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 16.25522518157959
Epoch: 3, Steps: 32 | Train Loss: 40.749 Vali Loss: 65.234 Vali Acc: 0.313 Test Loss: 65.234 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.678247928619385
Epoch: 4, Steps: 32 | Train Loss: 60.203 Vali Loss: 123.582 Vali Acc: 0.252 Test Loss: 123.582 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.853809833526611
Epoch: 5, Steps: 32 | Train Loss: 48.184 Vali Loss: 158.416 Vali Acc: 0.244 Test Loss: 158.416 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.555192232131958
Epoch: 6, Steps: 32 | Train Loss: 38.907 Vali Loss: 142.781 Vali Acc: 0.458 Test Loss: 142.781 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.501591682434082
Epoch: 7, Steps: 32 | Train Loss: 39.067 Vali Loss: 120.878 Vali Acc: 0.305 Test Loss: 120.878 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 16.24798893928528
Epoch: 8, Steps: 32 | Train Loss: 24.122 Vali Loss: 151.304 Vali Acc: 0.550 Test Loss: 151.304 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 15.164307832717896
Epoch: 9, Steps: 32 | Train Loss: 51.720 Vali Loss: 149.867 Vali Acc: 0.321 Test Loss: 149.867 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 16.09639573097229
Epoch: 10, Steps: 32 | Train Loss: 24.076 Vali Loss: 361.321 Vali Acc: 0.237 Test Loss: 361.321 Test Acc: 0.237
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 15.76880955696106
Epoch: 11, Steps: 32 | Train Loss: 29.229 Vali Loss: 214.808 Vali Acc: 0.305 Test Loss: 214.808 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 23428693
model size : 106.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.978485345840454
Epoch: 1, Steps: 64 | Train Loss: 97.014 Vali Loss: 148.820 Vali Acc: 0.443 Test Loss: 148.820 Test Acc: 0.443
Validation loss decreased (inf --> -0.441260).  Saving model ...
Epoch: 2 cost time: 19.939922094345093
Epoch: 2, Steps: 64 | Train Loss: 76.580 Vali Loss: 126.295 Vali Acc: 0.511 Test Loss: 126.295 Test Acc: 0.511
Validation loss decreased (-0.441260 --> -0.510187).  Saving model ...
Epoch: 3 cost time: 20.030343055725098
Epoch: 3, Steps: 64 | Train Loss: 55.062 Vali Loss: 145.658 Vali Acc: 0.458 Test Loss: 145.658 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.663790464401245
Epoch: 4, Steps: 64 | Train Loss: 38.741 Vali Loss: 223.048 Vali Acc: 0.489 Test Loss: 223.048 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.376428365707397
Epoch: 5, Steps: 64 | Train Loss: 77.554 Vali Loss: 249.153 Vali Acc: 0.298 Test Loss: 249.153 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 20.196253538131714
Epoch: 6, Steps: 64 | Train Loss: 64.351 Vali Loss: 227.664 Vali Acc: 0.321 Test Loss: 227.664 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 20.37746787071228
Epoch: 7, Steps: 64 | Train Loss: 49.059 Vali Loss: 236.819 Vali Acc: 0.473 Test Loss: 236.819 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 20.638309478759766
Epoch: 8, Steps: 64 | Train Loss: 43.772 Vali Loss: 259.324 Vali Acc: 0.435 Test Loss: 259.324 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 20.408716678619385
Epoch: 9, Steps: 64 | Train Loss: 30.548 Vali Loss: 286.656 Vali Acc: 0.450 Test Loss: 286.656 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 20.190671920776367
Epoch: 10, Steps: 64 | Train Loss: 18.722 Vali Loss: 306.330 Vali Acc: 0.580 Test Loss: 306.330 Test Acc: 0.580
Validation loss decreased (-0.510187 --> -0.577089).  Saving model ...
Epoch: 11 cost time: 20.53478479385376
Epoch: 11, Steps: 64 | Train Loss: 10.296 Vali Loss: 316.093 Vali Acc: 0.527 Test Loss: 316.093 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 21.02196192741394
Epoch: 12, Steps: 64 | Train Loss: 15.060 Vali Loss: 285.671 Vali Acc: 0.412 Test Loss: 285.671 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.125669717788696
Epoch: 13, Steps: 64 | Train Loss: 10.044 Vali Loss: 244.382 Vali Acc: 0.504 Test Loss: 244.382 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.35520577430725
Epoch: 14, Steps: 64 | Train Loss: 5.429 Vali Loss: 320.695 Vali Acc: 0.427 Test Loss: 320.695 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.45914387702942
Epoch: 15, Steps: 64 | Train Loss: 7.719 Vali Loss: 319.386 Vali Acc: 0.573 Test Loss: 319.386 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.578935146331787
Epoch: 16, Steps: 64 | Train Loss: 8.075 Vali Loss: 288.795 Vali Acc: 0.466 Test Loss: 288.795 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.35275912284851
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 293.727 Vali Acc: 0.458 Test Loss: 293.727 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.20063591003418
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 293.733 Vali Acc: 0.458 Test Loss: 293.733 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 20.547106981277466
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 293.733 Vali Acc: 0.458 Test Loss: 293.733 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 21.059101819992065
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 293.733 Vali Acc: 0.458 Test Loss: 293.733 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 23363157
model size : 106.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.899140119552612
Epoch: 1, Steps: 32 | Train Loss: 33.777 Vali Loss: 59.459 Vali Acc: 0.221 Test Loss: 59.459 Test Acc: 0.221
Validation loss decreased (inf --> -0.220779).  Saving model ...
Epoch: 2 cost time: 19.183079957962036
Epoch: 2, Steps: 32 | Train Loss: 31.679 Vali Loss: 57.208 Vali Acc: 0.458 Test Loss: 57.208 Test Acc: 0.458
Validation loss decreased (-0.220779 --> -0.457443).  Saving model ...
Epoch: 3 cost time: 18.94069194793701
Epoch: 3, Steps: 32 | Train Loss: 50.940 Vali Loss: 62.847 Vali Acc: 0.481 Test Loss: 62.847 Test Acc: 0.481
Validation loss decreased (-0.457443 --> -0.480288).  Saving model ...
Epoch: 4 cost time: 19.032153606414795
Epoch: 4, Steps: 32 | Train Loss: 37.052 Vali Loss: 59.775 Vali Acc: 0.496 Test Loss: 59.775 Test Acc: 0.496
Validation loss decreased (-0.480288 --> -0.495585).  Saving model ...
Epoch: 5 cost time: 18.725265741348267
Epoch: 5, Steps: 32 | Train Loss: 23.331 Vali Loss: 145.114 Vali Acc: 0.519 Test Loss: 145.114 Test Acc: 0.519
Validation loss decreased (-0.495585 --> -0.517633).  Saving model ...
Epoch: 6 cost time: 19.36825132369995
Epoch: 6, Steps: 32 | Train Loss: 16.282 Vali Loss: 143.124 Vali Acc: 0.397 Test Loss: 143.124 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 18.716800451278687
Epoch: 7, Steps: 32 | Train Loss: 26.326 Vali Loss: 137.392 Vali Acc: 0.351 Test Loss: 137.392 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.07510471343994
Epoch: 8, Steps: 32 | Train Loss: 19.416 Vali Loss: 165.401 Vali Acc: 0.351 Test Loss: 165.401 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.187974452972412
Epoch: 9, Steps: 32 | Train Loss: 14.042 Vali Loss: 177.070 Vali Acc: 0.466 Test Loss: 177.070 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.138847589492798
Epoch: 10, Steps: 32 | Train Loss: 11.757 Vali Loss: 129.285 Vali Acc: 0.557 Test Loss: 129.285 Test Acc: 0.557
Validation loss decreased (-0.517633 --> -0.555959).  Saving model ...
Epoch: 11 cost time: 19.08355140686035
Epoch: 11, Steps: 32 | Train Loss: 1.538 Vali Loss: 211.009 Vali Acc: 0.435 Test Loss: 211.009 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.3545081615448
Epoch: 12, Steps: 32 | Train Loss: 41.030 Vali Loss: 167.287 Vali Acc: 0.542 Test Loss: 167.287 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 18.68831515312195
Epoch: 13, Steps: 32 | Train Loss: 23.877 Vali Loss: 266.116 Vali Acc: 0.328 Test Loss: 266.116 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 18.937044620513916
Epoch: 14, Steps: 32 | Train Loss: 9.397 Vali Loss: 201.832 Vali Acc: 0.374 Test Loss: 201.832 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 19.185316562652588
Epoch: 15, Steps: 32 | Train Loss: 16.617 Vali Loss: 309.117 Vali Acc: 0.557 Test Loss: 309.117 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 19.791674375534058
Epoch: 16, Steps: 32 | Train Loss: 9.475 Vali Loss: 242.771 Vali Acc: 0.496 Test Loss: 242.771 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.165049076080322
Epoch: 17, Steps: 32 | Train Loss: 11.320 Vali Loss: 243.180 Vali Acc: 0.382 Test Loss: 243.180 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.412632942199707
Epoch: 18, Steps: 32 | Train Loss: 3.138 Vali Loss: 333.100 Vali Acc: 0.267 Test Loss: 333.100 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 19.383963584899902
Epoch: 19, Steps: 32 | Train Loss: 3.416 Vali Loss: 246.017 Vali Acc: 0.397 Test Loss: 246.017 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 19.984422206878662
Epoch: 20, Steps: 32 | Train Loss: 9.194 Vali Loss: 297.450 Vali Acc: 0.496 Test Loss: 297.450 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 23363157
model size : 106.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 19.283143281936646
Epoch: 1, Steps: 32 | Train Loss: 38.595 Vali Loss: 23.038 Vali Acc: 0.473 Test Loss: 23.038 Test Acc: 0.473
Validation loss decreased (inf --> -0.473052).  Saving model ...
Epoch: 2 cost time: 17.25398325920105
Epoch: 2, Steps: 32 | Train Loss: 36.762 Vali Loss: 93.122 Vali Acc: 0.443 Test Loss: 93.122 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.230250597000122
Epoch: 3, Steps: 32 | Train Loss: 82.298 Vali Loss: 78.853 Vali Acc: 0.336 Test Loss: 78.853 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 17.129090070724487
Epoch: 4, Steps: 32 | Train Loss: 35.108 Vali Loss: 89.487 Vali Acc: 0.466 Test Loss: 89.487 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 18.36476755142212
Epoch: 5, Steps: 32 | Train Loss: 52.069 Vali Loss: 158.926 Vali Acc: 0.267 Test Loss: 158.926 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 18.629863023757935
Epoch: 6, Steps: 32 | Train Loss: 30.506 Vali Loss: 205.593 Vali Acc: 0.282 Test Loss: 205.593 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 17.56849241256714
Epoch: 7, Steps: 32 | Train Loss: 24.736 Vali Loss: 128.797 Vali Acc: 0.450 Test Loss: 128.797 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 18.571853637695312
Epoch: 8, Steps: 32 | Train Loss: 18.053 Vali Loss: 129.219 Vali Acc: 0.321 Test Loss: 129.219 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 17.905162572860718
Epoch: 9, Steps: 32 | Train Loss: 10.788 Vali Loss: 212.476 Vali Acc: 0.198 Test Loss: 212.476 Test Acc: 0.198
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 18.929779052734375
Epoch: 10, Steps: 32 | Train Loss: 8.775 Vali Loss: 129.124 Vali Acc: 0.489 Test Loss: 129.124 Test Acc: 0.489
Validation loss decreased (-0.473052 --> -0.487258).  Saving model ...
Epoch: 11 cost time: 18.240275382995605
Epoch: 11, Steps: 32 | Train Loss: 3.339 Vali Loss: 151.297 Vali Acc: 0.397 Test Loss: 151.297 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 18.3286714553833
Epoch: 12, Steps: 32 | Train Loss: 9.326 Vali Loss: 146.519 Vali Acc: 0.382 Test Loss: 146.519 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 17.653366088867188
Epoch: 13, Steps: 32 | Train Loss: 14.507 Vali Loss: 177.298 Vali Acc: 0.511 Test Loss: 177.298 Test Acc: 0.511
Validation loss decreased (-0.487258 --> -0.509677).  Saving model ...
Epoch: 14 cost time: 17.752808094024658
Epoch: 14, Steps: 32 | Train Loss: 4.778 Vali Loss: 232.190 Vali Acc: 0.366 Test Loss: 232.190 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 18.96466302871704
Epoch: 15, Steps: 32 | Train Loss: 12.734 Vali Loss: 189.407 Vali Acc: 0.366 Test Loss: 189.407 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 17.956803560256958
Epoch: 16, Steps: 32 | Train Loss: 22.155 Vali Loss: 182.304 Vali Acc: 0.580 Test Loss: 182.304 Test Acc: 0.580
Validation loss decreased (-0.509677 --> -0.578330).  Saving model ...
Epoch: 17 cost time: 18.51449489593506
Epoch: 17, Steps: 32 | Train Loss: 29.559 Vali Loss: 284.529 Vali Acc: 0.427 Test Loss: 284.529 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 18.449649810791016
Epoch: 18, Steps: 32 | Train Loss: 5.766 Vali Loss: 162.347 Vali Acc: 0.565 Test Loss: 162.347 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.686990976333618
Epoch: 19, Steps: 32 | Train Loss: 4.619 Vali Loss: 136.930 Vali Acc: 0.611 Test Loss: 136.930 Test Acc: 0.611
Validation loss decreased (-0.578330 --> -0.609318).  Saving model ...
Epoch: 20 cost time: 18.820130109786987
Epoch: 20, Steps: 32 | Train Loss: 8.823 Vali Loss: 239.593 Vali Acc: 0.458 Test Loss: 239.593 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 18.241777420043945
Epoch: 21, Steps: 32 | Train Loss: 9.096 Vali Loss: 148.571 Vali Acc: 0.649 Test Loss: 148.571 Test Acc: 0.649
Validation loss decreased (-0.609318 --> -0.647369).  Saving model ...
Epoch: 22 cost time: 18.384231328964233
Epoch: 22, Steps: 32 | Train Loss: 14.067 Vali Loss: 212.438 Vali Acc: 0.580 Test Loss: 212.438 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 18.822895288467407
Epoch: 23, Steps: 32 | Train Loss: 0.576 Vali Loss: 236.694 Vali Acc: 0.618 Test Loss: 236.694 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 18.74308681488037
Epoch: 24, Steps: 32 | Train Loss: 20.952 Vali Loss: 519.425 Vali Acc: 0.420 Test Loss: 519.425 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 18.111841201782227
Epoch: 25, Steps: 32 | Train Loss: 14.271 Vali Loss: 278.805 Vali Acc: 0.595 Test Loss: 278.805 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 18.29193425178528
Epoch: 26, Steps: 32 | Train Loss: 3.745 Vali Loss: 391.943 Vali Acc: 0.588 Test Loss: 391.943 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 18.43091082572937
Epoch: 27, Steps: 32 | Train Loss: 19.753 Vali Loss: 284.231 Vali Acc: 0.595 Test Loss: 284.231 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 18.217895984649658
Epoch: 28, Steps: 32 | Train Loss: 3.662 Vali Loss: 571.406 Vali Acc: 0.298 Test Loss: 571.406 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 18.121975421905518
Epoch: 29, Steps: 32 | Train Loss: 0.304 Vali Loss: 535.448 Vali Acc: 0.473 Test Loss: 535.448 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 18.832468032836914
Epoch: 30, Steps: 32 | Train Loss: 4.355 Vali Loss: 361.802 Vali Acc: 0.542 Test Loss: 361.802 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 17.94649839401245
Epoch: 31, Steps: 32 | Train Loss: 9.110 Vali Loss: 577.885 Vali Acc: 0.298 Test Loss: 577.885 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 23363157
model size : 106.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.38364315032959
Epoch: 1, Steps: 32 | Train Loss: 17.243 Vali Loss: 52.560 Vali Acc: 0.489 Test Loss: 52.560 Test Acc: 0.489
Validation loss decreased (inf --> -0.488024).  Saving model ...
Epoch: 2 cost time: 15.96006727218628
Epoch: 2, Steps: 32 | Train Loss: 40.243 Vali Loss: 92.477 Vali Acc: 0.328 Test Loss: 92.477 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.980179071426392
Epoch: 3, Steps: 32 | Train Loss: 59.430 Vali Loss: 74.911 Vali Acc: 0.511 Test Loss: 74.911 Test Acc: 0.511
Validation loss decreased (-0.488024 --> -0.510701).  Saving model ...
Epoch: 4 cost time: 16.298035383224487
Epoch: 4, Steps: 32 | Train Loss: 71.748 Vali Loss: 113.208 Vali Acc: 0.252 Test Loss: 113.208 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 16.487590551376343
Epoch: 5, Steps: 32 | Train Loss: 37.499 Vali Loss: 101.124 Vali Acc: 0.252 Test Loss: 101.124 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 16.50598931312561
Epoch: 6, Steps: 32 | Train Loss: 47.584 Vali Loss: 131.642 Vali Acc: 0.176 Test Loss: 131.642 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.720323324203491
Epoch: 7, Steps: 32 | Train Loss: 36.594 Vali Loss: 54.425 Vali Acc: 0.550 Test Loss: 54.425 Test Acc: 0.550
Validation loss decreased (-0.510701 --> -0.549074).  Saving model ...
Epoch: 8 cost time: 15.339562177658081
Epoch: 8, Steps: 32 | Train Loss: 19.956 Vali Loss: 114.635 Vali Acc: 0.328 Test Loss: 114.635 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 16.25939416885376
Epoch: 9, Steps: 32 | Train Loss: 25.361 Vali Loss: 168.447 Vali Acc: 0.260 Test Loss: 168.447 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.358971118927002
Epoch: 10, Steps: 32 | Train Loss: 16.069 Vali Loss: 135.581 Vali Acc: 0.580 Test Loss: 135.581 Test Acc: 0.580
Validation loss decreased (-0.549074 --> -0.578797).  Saving model ...
Epoch: 11 cost time: 15.730823993682861
Epoch: 11, Steps: 32 | Train Loss: 3.222 Vali Loss: 121.754 Vali Acc: 0.397 Test Loss: 121.754 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 16.66770625114441
Epoch: 12, Steps: 32 | Train Loss: 5.438 Vali Loss: 114.816 Vali Acc: 0.580 Test Loss: 114.816 Test Acc: 0.580
Validation loss decreased (-0.578797 --> -0.579005).  Saving model ...
Epoch: 13 cost time: 15.629514455795288
Epoch: 13, Steps: 32 | Train Loss: 3.293 Vali Loss: 105.824 Vali Acc: 0.511 Test Loss: 105.824 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.989866018295288
Epoch: 14, Steps: 32 | Train Loss: 3.299 Vali Loss: 204.026 Vali Acc: 0.359 Test Loss: 204.026 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.1833393573761
Epoch: 15, Steps: 32 | Train Loss: 6.336 Vali Loss: 138.539 Vali Acc: 0.618 Test Loss: 138.539 Test Acc: 0.618
Validation loss decreased (-0.579005 --> -0.616935).  Saving model ...
Epoch: 16 cost time: 16.110665559768677
Epoch: 16, Steps: 32 | Train Loss: 7.631 Vali Loss: 178.716 Vali Acc: 0.443 Test Loss: 178.716 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 16.09612226486206
Epoch: 17, Steps: 32 | Train Loss: 8.395 Vali Loss: 131.039 Vali Acc: 0.504 Test Loss: 131.039 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 16.635371923446655
Epoch: 18, Steps: 32 | Train Loss: 6.109 Vali Loss: 262.109 Vali Acc: 0.611 Test Loss: 262.109 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 16.669600248336792
Epoch: 19, Steps: 32 | Train Loss: 20.006 Vali Loss: 236.972 Vali Acc: 0.542 Test Loss: 236.972 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 16.88548517227173
Epoch: 20, Steps: 32 | Train Loss: 9.525 Vali Loss: 156.271 Vali Acc: 0.557 Test Loss: 156.271 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 17.50070881843567
Epoch: 21, Steps: 32 | Train Loss: 4.035 Vali Loss: 188.433 Vali Acc: 0.550 Test Loss: 188.433 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 17.130001306533813
Epoch: 22, Steps: 32 | Train Loss: 1.385 Vali Loss: 278.892 Vali Acc: 0.412 Test Loss: 278.892 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 16.68494153022766
Epoch: 23, Steps: 32 | Train Loss: 1.021 Vali Loss: 144.470 Vali Acc: 0.588 Test Loss: 144.470 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 16.767895460128784
Epoch: 24, Steps: 32 | Train Loss: 2.886 Vali Loss: 350.367 Vali Acc: 0.435 Test Loss: 350.367 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 16.370174169540405
Epoch: 25, Steps: 32 | Train Loss: 3.905 Vali Loss: 102.692 Vali Acc: 0.641 Test Loss: 102.692 Test Acc: 0.641
Validation loss decreased (-0.616935 --> -0.640194).  Saving model ...
Epoch: 26 cost time: 16.77885675430298
Epoch: 26, Steps: 32 | Train Loss: 2.064 Vali Loss: 167.785 Vali Acc: 0.565 Test Loss: 167.785 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 17.6628475189209
Epoch: 27, Steps: 32 | Train Loss: 9.885 Vali Loss: 433.587 Vali Acc: 0.328 Test Loss: 433.587 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 17.39117193222046
Epoch: 28, Steps: 32 | Train Loss: 5.108 Vali Loss: 145.323 Vali Acc: 0.634 Test Loss: 145.323 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 17.435303211212158
Epoch: 29, Steps: 32 | Train Loss: 3.940 Vali Loss: 348.713 Vali Acc: 0.420 Test Loss: 348.713 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 16.98642635345459
Epoch: 30, Steps: 32 | Train Loss: 16.510 Vali Loss: 168.795 Vali Acc: 0.588 Test Loss: 168.795 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 16.364439725875854
Epoch: 31, Steps: 32 | Train Loss: 3.420 Vali Loss: 165.589 Vali Acc: 0.626 Test Loss: 165.589 Test Acc: 0.626
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 16.91504669189453
Epoch: 32, Steps: 32 | Train Loss: 29.881 Vali Loss: 377.211 Vali Acc: 0.420 Test Loss: 377.211 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 16.671499252319336
Epoch: 33, Steps: 32 | Train Loss: 12.055 Vali Loss: 361.806 Vali Acc: 0.519 Test Loss: 361.806 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 17.033564805984497
Epoch: 34, Steps: 32 | Train Loss: 18.616 Vali Loss: 764.742 Vali Acc: 0.397 Test Loss: 764.742 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 17.589804649353027
Epoch: 35, Steps: 32 | Train Loss: 22.434 Vali Loss: 435.210 Vali Acc: 0.496 Test Loss: 435.210 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 23363157
model size : 106.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.507523775100708
Epoch: 1, Steps: 32 | Train Loss: 11.044 Vali Loss: 26.521 Vali Acc: 0.107 Test Loss: 26.521 Test Acc: 0.107
Validation loss decreased (inf --> -0.106605).  Saving model ...
Epoch: 2 cost time: 13.414845705032349
Epoch: 2, Steps: 32 | Train Loss: 10.674 Vali Loss: 31.221 Vali Acc: 0.252 Test Loss: 31.221 Test Acc: 0.252
Validation loss decreased (-0.106605 --> -0.251596).  Saving model ...
Epoch: 3 cost time: 13.606504917144775
Epoch: 3, Steps: 32 | Train Loss: 17.380 Vali Loss: 49.520 Vali Acc: 0.527 Test Loss: 49.520 Test Acc: 0.527
Validation loss decreased (-0.251596 --> -0.526222).  Saving model ...
Epoch: 4 cost time: 13.055106163024902
Epoch: 4, Steps: 32 | Train Loss: 15.497 Vali Loss: 76.269 Vali Acc: 0.198 Test Loss: 76.269 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.247838020324707
Epoch: 5, Steps: 32 | Train Loss: 11.024 Vali Loss: 132.186 Vali Acc: 0.481 Test Loss: 132.186 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 13.593919038772583
Epoch: 6, Steps: 32 | Train Loss: 35.409 Vali Loss: 68.494 Vali Acc: 0.321 Test Loss: 68.494 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 13.44704556465149
Epoch: 7, Steps: 32 | Train Loss: 14.125 Vali Loss: 77.033 Vali Acc: 0.473 Test Loss: 77.033 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 13.29369330406189
Epoch: 8, Steps: 32 | Train Loss: 5.271 Vali Loss: 58.854 Vali Acc: 0.550 Test Loss: 58.854 Test Acc: 0.550
Validation loss decreased (-0.526222 --> -0.549030).  Saving model ...
Epoch: 9 cost time: 13.3928062915802
Epoch: 9, Steps: 32 | Train Loss: 29.903 Vali Loss: 101.667 Vali Acc: 0.328 Test Loss: 101.667 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.092270374298096
Epoch: 10, Steps: 32 | Train Loss: 15.217 Vali Loss: 91.449 Vali Acc: 0.626 Test Loss: 91.449 Test Acc: 0.626
Validation loss decreased (-0.549030 --> -0.625040).  Saving model ...
Epoch: 11 cost time: 14.232479333877563
Epoch: 11, Steps: 32 | Train Loss: 3.370 Vali Loss: 81.064 Vali Acc: 0.611 Test Loss: 81.064 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 13.372799634933472
Epoch: 12, Steps: 32 | Train Loss: 2.242 Vali Loss: 76.299 Vali Acc: 0.580 Test Loss: 76.299 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.911877632141113
Epoch: 13, Steps: 32 | Train Loss: 2.369 Vali Loss: 110.825 Vali Acc: 0.382 Test Loss: 110.825 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.551251888275146
Epoch: 14, Steps: 32 | Train Loss: 8.204 Vali Loss: 119.878 Vali Acc: 0.496 Test Loss: 119.878 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 13.545123815536499
Epoch: 15, Steps: 32 | Train Loss: 13.388 Vali Loss: 142.585 Vali Acc: 0.344 Test Loss: 142.585 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 13.575928926467896
Epoch: 16, Steps: 32 | Train Loss: 25.602 Vali Loss: 126.655 Vali Acc: 0.527 Test Loss: 126.655 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.427526235580444
Epoch: 17, Steps: 32 | Train Loss: 19.298 Vali Loss: 166.120 Vali Acc: 0.542 Test Loss: 166.120 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 13.667802572250366
Epoch: 18, Steps: 32 | Train Loss: 17.670 Vali Loss: 122.627 Vali Acc: 0.412 Test Loss: 122.627 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.205153226852417
Epoch: 19, Steps: 32 | Train Loss: 4.495 Vali Loss: 123.599 Vali Acc: 0.458 Test Loss: 123.599 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.358312845230103
Epoch: 20, Steps: 32 | Train Loss: 0.886 Vali Loss: 157.177 Vali Acc: 0.542 Test Loss: 157.177 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 12631893
model size : 56.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.32474660873413
Epoch: 1, Steps: 32 | Train Loss: 12.086 Vali Loss: 32.865 Vali Acc: 0.176 Test Loss: 32.865 Test Acc: 0.176
Validation loss decreased (inf --> -0.175244).  Saving model ...
Epoch: 2 cost time: 12.720851182937622
Epoch: 2, Steps: 32 | Train Loss: 18.153 Vali Loss: 21.609 Vali Acc: 0.321 Test Loss: 21.609 Test Acc: 0.321
Validation loss decreased (-0.175244 --> -0.320395).  Saving model ...
Epoch: 3 cost time: 13.049438953399658
Epoch: 3, Steps: 32 | Train Loss: 24.665 Vali Loss: 60.935 Vali Acc: 0.458 Test Loss: 60.935 Test Acc: 0.458
Validation loss decreased (-0.320395 --> -0.457406).  Saving model ...
Epoch: 4 cost time: 13.540379762649536
Epoch: 4, Steps: 32 | Train Loss: 29.248 Vali Loss: 93.459 Vali Acc: 0.496 Test Loss: 93.459 Test Acc: 0.496
Validation loss decreased (-0.457406 --> -0.495249).  Saving model ...
Epoch: 5 cost time: 13.026165962219238
Epoch: 5, Steps: 32 | Train Loss: 19.136 Vali Loss: 86.791 Vali Acc: 0.351 Test Loss: 86.791 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.325545310974121
Epoch: 6, Steps: 32 | Train Loss: 20.724 Vali Loss: 99.780 Vali Acc: 0.252 Test Loss: 99.780 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.946607112884521
Epoch: 7, Steps: 32 | Train Loss: 15.533 Vali Loss: 116.260 Vali Acc: 0.359 Test Loss: 116.260 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 13.069113969802856
Epoch: 8, Steps: 32 | Train Loss: 25.574 Vali Loss: 87.650 Vali Acc: 0.496 Test Loss: 87.650 Test Acc: 0.496
Validation loss decreased (-0.495249 --> -0.495307).  Saving model ...
Epoch: 9 cost time: 13.039995670318604
Epoch: 9, Steps: 32 | Train Loss: 22.049 Vali Loss: 73.476 Vali Acc: 0.397 Test Loss: 73.476 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.893165826797485
Epoch: 10, Steps: 32 | Train Loss: 6.417 Vali Loss: 66.450 Vali Acc: 0.519 Test Loss: 66.450 Test Acc: 0.519
Validation loss decreased (-0.495307 --> -0.518419).  Saving model ...
Epoch: 11 cost time: 14.355474948883057
Epoch: 11, Steps: 32 | Train Loss: 2.092 Vali Loss: 69.533 Vali Acc: 0.504 Test Loss: 69.533 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.274093389511108
Epoch: 12, Steps: 32 | Train Loss: 2.902 Vali Loss: 75.392 Vali Acc: 0.481 Test Loss: 75.392 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 13.802937030792236
Epoch: 13, Steps: 32 | Train Loss: 10.811 Vali Loss: 165.793 Vali Acc: 0.359 Test Loss: 165.793 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 13.410073280334473
Epoch: 14, Steps: 32 | Train Loss: 14.613 Vali Loss: 173.282 Vali Acc: 0.511 Test Loss: 173.282 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.042449235916138
Epoch: 15, Steps: 32 | Train Loss: 16.197 Vali Loss: 126.950 Vali Acc: 0.519 Test Loss: 126.950 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 12.823627471923828
Epoch: 16, Steps: 32 | Train Loss: 0.960 Vali Loss: 123.384 Vali Acc: 0.511 Test Loss: 123.384 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 13.337686538696289
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 130.034 Vali Acc: 0.489 Test Loss: 130.034 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.03370976448059
Epoch: 18, Steps: 32 | Train Loss: 0.028 Vali Loss: 133.676 Vali Acc: 0.496 Test Loss: 133.676 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 13.837731122970581
Epoch: 19, Steps: 32 | Train Loss: 1.671 Vali Loss: 214.763 Vali Acc: 0.511 Test Loss: 214.763 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 13.712494373321533
Epoch: 20, Steps: 32 | Train Loss: 13.674 Vali Loss: 123.488 Vali Acc: 0.382 Test Loss: 123.488 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 12631893
model size : 56.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.625963926315308
Epoch: 1, Steps: 32 | Train Loss: 12.119 Vali Loss: 15.852 Vali Acc: 0.473 Test Loss: 15.852 Test Acc: 0.473
Validation loss decreased (inf --> -0.473124).  Saving model ...
Epoch: 2 cost time: 12.367962837219238
Epoch: 2, Steps: 32 | Train Loss: 19.131 Vali Loss: 41.370 Vali Acc: 0.198 Test Loss: 41.370 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.659733533859253
Epoch: 3, Steps: 32 | Train Loss: 15.282 Vali Loss: 12.411 Vali Acc: 0.450 Test Loss: 12.411 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 12.080837488174438
Epoch: 4, Steps: 32 | Train Loss: 15.510 Vali Loss: 67.114 Vali Acc: 0.534 Test Loss: 67.114 Test Acc: 0.534
Validation loss decreased (-0.473124 --> -0.533680).  Saving model ...
Epoch: 5 cost time: 12.732866048812866
Epoch: 5, Steps: 32 | Train Loss: 18.195 Vali Loss: 111.401 Vali Acc: 0.534 Test Loss: 111.401 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 12.535239219665527
Epoch: 6, Steps: 32 | Train Loss: 25.538 Vali Loss: 123.223 Vali Acc: 0.313 Test Loss: 123.223 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 12.53731393814087
Epoch: 7, Steps: 32 | Train Loss: 22.864 Vali Loss: 115.410 Vali Acc: 0.374 Test Loss: 115.410 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 12.138325214385986
Epoch: 8, Steps: 32 | Train Loss: 29.282 Vali Loss: 119.718 Vali Acc: 0.565 Test Loss: 119.718 Test Acc: 0.565
Validation loss decreased (-0.533680 --> -0.563688).  Saving model ...
Epoch: 9 cost time: 12.490629196166992
Epoch: 9, Steps: 32 | Train Loss: 31.018 Vali Loss: 130.463 Vali Acc: 0.290 Test Loss: 130.463 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 12.246886014938354
Epoch: 10, Steps: 32 | Train Loss: 21.852 Vali Loss: 97.681 Vali Acc: 0.496 Test Loss: 97.681 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 12.063584566116333
Epoch: 11, Steps: 32 | Train Loss: 8.093 Vali Loss: 79.994 Vali Acc: 0.588 Test Loss: 79.994 Test Acc: 0.588
Validation loss decreased (-0.563688 --> -0.586986).  Saving model ...
Epoch: 12 cost time: 11.695244550704956
Epoch: 12, Steps: 32 | Train Loss: 1.773 Vali Loss: 183.190 Vali Acc: 0.298 Test Loss: 183.190 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.150534391403198
Epoch: 13, Steps: 32 | Train Loss: 23.608 Vali Loss: 192.127 Vali Acc: 0.481 Test Loss: 192.127 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 12.332619190216064
Epoch: 14, Steps: 32 | Train Loss: 32.441 Vali Loss: 105.019 Vali Acc: 0.542 Test Loss: 105.019 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 11.889070987701416
Epoch: 15, Steps: 32 | Train Loss: 20.780 Vali Loss: 197.979 Vali Acc: 0.527 Test Loss: 197.979 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 12.590349674224854
Epoch: 16, Steps: 32 | Train Loss: 5.866 Vali Loss: 113.340 Vali Acc: 0.603 Test Loss: 113.340 Test Acc: 0.603
Validation loss decreased (-0.586986 --> -0.601920).  Saving model ...
Epoch: 17 cost time: 12.578744411468506
Epoch: 17, Steps: 32 | Train Loss: 9.030 Vali Loss: 149.826 Vali Acc: 0.504 Test Loss: 149.826 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 12.10108208656311
Epoch: 18, Steps: 32 | Train Loss: 2.328 Vali Loss: 160.516 Vali Acc: 0.458 Test Loss: 160.516 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 11.590351104736328
Epoch: 19, Steps: 32 | Train Loss: 1.296 Vali Loss: 135.739 Vali Acc: 0.443 Test Loss: 135.739 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.506330728530884
Epoch: 20, Steps: 32 | Train Loss: 2.222 Vali Loss: 130.657 Vali Acc: 0.534 Test Loss: 130.657 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 12.331159830093384
Epoch: 21, Steps: 32 | Train Loss: 0.662 Vali Loss: 144.047 Vali Acc: 0.565 Test Loss: 144.047 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.420676708221436
Epoch: 22, Steps: 32 | Train Loss: 0.319 Vali Loss: 154.368 Vali Acc: 0.542 Test Loss: 154.368 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.918071746826172
Epoch: 23, Steps: 32 | Train Loss: 1.485 Vali Loss: 145.640 Vali Acc: 0.519 Test Loss: 145.640 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 12.456702709197998
Epoch: 24, Steps: 32 | Train Loss: 2.252 Vali Loss: 187.903 Vali Acc: 0.359 Test Loss: 187.903 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 12.413819551467896
Epoch: 25, Steps: 32 | Train Loss: 3.979 Vali Loss: 93.498 Vali Acc: 0.603 Test Loss: 93.498 Test Acc: 0.603
Validation loss decreased (-0.601920 --> -0.602118).  Saving model ...
Epoch: 26 cost time: 12.210407972335815
Epoch: 26, Steps: 32 | Train Loss: 9.637 Vali Loss: 128.623 Vali Acc: 0.466 Test Loss: 128.623 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 12.03866195678711
Epoch: 27, Steps: 32 | Train Loss: 0.482 Vali Loss: 171.670 Vali Acc: 0.504 Test Loss: 171.670 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 12.051291704177856
Epoch: 28, Steps: 32 | Train Loss: 0.407 Vali Loss: 137.917 Vali Acc: 0.580 Test Loss: 137.917 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 12.751706838607788
Epoch: 29, Steps: 32 | Train Loss: 1.005 Vali Loss: 151.638 Vali Acc: 0.573 Test Loss: 151.638 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 12.488282680511475
Epoch: 30, Steps: 32 | Train Loss: 0.288 Vali Loss: 148.978 Vali Acc: 0.595 Test Loss: 148.978 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 11.864210605621338
Epoch: 31, Steps: 32 | Train Loss: 0.961 Vali Loss: 158.009 Vali Acc: 0.420 Test Loss: 158.009 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 12.48331093788147
Epoch: 32, Steps: 32 | Train Loss: 0.402 Vali Loss: 153.412 Vali Acc: 0.450 Test Loss: 153.412 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 12.46622085571289
Epoch: 33, Steps: 32 | Train Loss: 0.996 Vali Loss: 202.465 Vali Acc: 0.435 Test Loss: 202.465 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 12.425124883651733
Epoch: 34, Steps: 32 | Train Loss: 3.361 Vali Loss: 202.809 Vali Acc: 0.344 Test Loss: 202.809 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 11.397319078445435
Epoch: 35, Steps: 32 | Train Loss: 17.643 Vali Loss: 283.855 Vali Acc: 0.382 Test Loss: 283.855 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 12631893
model size : 56.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.345399856567383
Epoch: 1, Steps: 32 | Train Loss: 10.948 Vali Loss: 16.277 Vali Acc: 0.244 Test Loss: 16.277 Test Acc: 0.244
Validation loss decreased (inf --> -0.244112).  Saving model ...
Epoch: 2 cost time: 11.096846342086792
Epoch: 2, Steps: 32 | Train Loss: 19.755 Vali Loss: 53.615 Vali Acc: 0.198 Test Loss: 53.615 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.578059196472168
Epoch: 3, Steps: 32 | Train Loss: 22.312 Vali Loss: 32.914 Vali Acc: 0.313 Test Loss: 32.914 Test Acc: 0.313
Validation loss decreased (-0.244112 --> -0.312648).  Saving model ...
Epoch: 4 cost time: 12.579918146133423
Epoch: 4, Steps: 32 | Train Loss: 30.056 Vali Loss: 61.723 Vali Acc: 0.496 Test Loss: 61.723 Test Acc: 0.496
Validation loss decreased (-0.312648 --> -0.495566).  Saving model ...
Epoch: 5 cost time: 12.4544837474823
Epoch: 5, Steps: 32 | Train Loss: 32.246 Vali Loss: 85.598 Vali Acc: 0.481 Test Loss: 85.598 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 11.322850704193115
Epoch: 6, Steps: 32 | Train Loss: 22.529 Vali Loss: 97.497 Vali Acc: 0.405 Test Loss: 97.497 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.750086784362793
Epoch: 7, Steps: 32 | Train Loss: 29.897 Vali Loss: 97.891 Vali Acc: 0.359 Test Loss: 97.891 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 11.552503824234009
Epoch: 8, Steps: 32 | Train Loss: 26.975 Vali Loss: 101.275 Vali Acc: 0.481 Test Loss: 101.275 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 11.240352869033813
Epoch: 9, Steps: 32 | Train Loss: 29.918 Vali Loss: 104.801 Vali Acc: 0.519 Test Loss: 104.801 Test Acc: 0.519
Validation loss decreased (-0.495566 --> -0.518036).  Saving model ...
Epoch: 10 cost time: 11.227089643478394
Epoch: 10, Steps: 32 | Train Loss: 7.619 Vali Loss: 114.195 Vali Acc: 0.412 Test Loss: 114.195 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.983821153640747
Epoch: 11, Steps: 32 | Train Loss: 8.434 Vali Loss: 87.441 Vali Acc: 0.519 Test Loss: 87.441 Test Acc: 0.519
Validation loss decreased (-0.518036 --> -0.518210).  Saving model ...
Epoch: 12 cost time: 11.890668153762817
Epoch: 12, Steps: 32 | Train Loss: 3.597 Vali Loss: 100.278 Vali Acc: 0.458 Test Loss: 100.278 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 12.492081880569458
Epoch: 13, Steps: 32 | Train Loss: 3.817 Vali Loss: 91.271 Vali Acc: 0.580 Test Loss: 91.271 Test Acc: 0.580
Validation loss decreased (-0.518210 --> -0.579240).  Saving model ...
Epoch: 14 cost time: 11.782467603683472
Epoch: 14, Steps: 32 | Train Loss: 3.406 Vali Loss: 120.128 Vali Acc: 0.527 Test Loss: 120.128 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 12.06173324584961
Epoch: 15, Steps: 32 | Train Loss: 8.181 Vali Loss: 116.465 Vali Acc: 0.527 Test Loss: 116.465 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.52464771270752
Epoch: 16, Steps: 32 | Train Loss: 6.599 Vali Loss: 84.150 Vali Acc: 0.595 Test Loss: 84.150 Test Acc: 0.595
Validation loss decreased (-0.579240 --> -0.594578).  Saving model ...
Epoch: 17 cost time: 11.214598178863525
Epoch: 17, Steps: 32 | Train Loss: 3.862 Vali Loss: 155.463 Vali Acc: 0.519 Test Loss: 155.463 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 11.758682489395142
Epoch: 18, Steps: 32 | Train Loss: 9.689 Vali Loss: 104.475 Vali Acc: 0.389 Test Loss: 104.475 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 12.027567863464355
Epoch: 19, Steps: 32 | Train Loss: 1.122 Vali Loss: 119.831 Vali Acc: 0.527 Test Loss: 119.831 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 11.054617166519165
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.676 Vali Acc: 0.519 Test Loss: 117.676 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 11.49373984336853
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.589 Vali Acc: 0.519 Test Loss: 117.589 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 12.519551992416382
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.586 Vali Acc: 0.519 Test Loss: 117.586 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 11.86485242843628
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.586 Vali Acc: 0.519 Test Loss: 117.586 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 11.904922485351562
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.586 Vali Acc: 0.519 Test Loss: 117.586 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 11.557665348052979
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.586 Vali Acc: 0.519 Test Loss: 117.586 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 11.861204147338867
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 117.586 Vali Acc: 0.519 Test Loss: 117.586 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 12631893
model size : 56.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.187593698501587
Epoch: 1, Steps: 32 | Train Loss: 14.936 Vali Loss: 19.155 Vali Acc: 0.443 Test Loss: 19.155 Test Acc: 0.443
Validation loss decreased (inf --> -0.442557).  Saving model ...
Epoch: 2 cost time: 13.843276739120483
Epoch: 2, Steps: 32 | Train Loss: 19.300 Vali Loss: 33.092 Vali Acc: 0.321 Test Loss: 33.092 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 13.496292352676392
Epoch: 3, Steps: 32 | Train Loss: 15.984 Vali Loss: 12.905 Vali Acc: 0.504 Test Loss: 12.905 Test Acc: 0.504
Validation loss decreased (-0.442557 --> -0.503688).  Saving model ...
Epoch: 4 cost time: 13.332011222839355
Epoch: 4, Steps: 32 | Train Loss: 12.533 Vali Loss: 53.006 Vali Acc: 0.458 Test Loss: 53.006 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 13.334749221801758
Epoch: 5, Steps: 32 | Train Loss: 17.347 Vali Loss: 89.675 Vali Acc: 0.344 Test Loss: 89.675 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 12.340837240219116
Epoch: 6, Steps: 32 | Train Loss: 12.013 Vali Loss: 102.471 Vali Acc: 0.511 Test Loss: 102.471 Test Acc: 0.511
Validation loss decreased (-0.503688 --> -0.510426).  Saving model ...
Epoch: 7 cost time: 12.432546377182007
Epoch: 7, Steps: 32 | Train Loss: 11.986 Vali Loss: 76.809 Vali Acc: 0.565 Test Loss: 76.809 Test Acc: 0.565
Validation loss decreased (-0.510426 --> -0.564117).  Saving model ...
Epoch: 8 cost time: 13.144248247146606
Epoch: 8, Steps: 32 | Train Loss: 19.978 Vali Loss: 140.806 Vali Acc: 0.496 Test Loss: 140.806 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.987862825393677
Epoch: 9, Steps: 32 | Train Loss: 8.940 Vali Loss: 75.045 Vali Acc: 0.443 Test Loss: 75.045 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 13.055914640426636
Epoch: 10, Steps: 32 | Train Loss: 4.146 Vali Loss: 86.091 Vali Acc: 0.267 Test Loss: 86.091 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 13.411470651626587
Epoch: 11, Steps: 32 | Train Loss: 11.241 Vali Loss: 69.787 Vali Acc: 0.511 Test Loss: 69.787 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 13.143914699554443
Epoch: 12, Steps: 32 | Train Loss: 21.223 Vali Loss: 213.473 Vali Acc: 0.244 Test Loss: 213.473 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 13.096593856811523
Epoch: 13, Steps: 32 | Train Loss: 7.371 Vali Loss: 117.312 Vali Acc: 0.557 Test Loss: 117.312 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 13.038310766220093
Epoch: 14, Steps: 32 | Train Loss: 9.357 Vali Loss: 102.603 Vali Acc: 0.565 Test Loss: 102.603 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 12.663062572479248
Epoch: 15, Steps: 32 | Train Loss: 21.428 Vali Loss: 99.206 Vali Acc: 0.359 Test Loss: 99.206 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 12.707999229431152
Epoch: 16, Steps: 32 | Train Loss: 6.077 Vali Loss: 134.641 Vali Acc: 0.473 Test Loss: 134.641 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 13.193180799484253
Epoch: 17, Steps: 32 | Train Loss: 3.315 Vali Loss: 118.182 Vali Acc: 0.580 Test Loss: 118.182 Test Acc: 0.580
Validation loss decreased (-0.564117 --> -0.578971).  Saving model ...
Epoch: 18 cost time: 13.542418479919434
Epoch: 18, Steps: 32 | Train Loss: 0.527 Vali Loss: 102.711 Vali Acc: 0.534 Test Loss: 102.711 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 12.624712467193604
Epoch: 19, Steps: 32 | Train Loss: 0.527 Vali Loss: 140.015 Vali Acc: 0.489 Test Loss: 140.015 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 13.34043002128601
Epoch: 20, Steps: 32 | Train Loss: 12.691 Vali Loss: 165.233 Vali Acc: 0.519 Test Loss: 165.233 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 13.05459713935852
Epoch: 21, Steps: 32 | Train Loss: 1.461 Vali Loss: 144.451 Vali Acc: 0.473 Test Loss: 144.451 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 12.66873288154602
Epoch: 22, Steps: 32 | Train Loss: 0.831 Vali Loss: 102.400 Vali Acc: 0.504 Test Loss: 102.400 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 12.500183343887329
Epoch: 23, Steps: 32 | Train Loss: 7.466 Vali Loss: 204.393 Vali Acc: 0.565 Test Loss: 204.393 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 12.772876024246216
Epoch: 24, Steps: 32 | Train Loss: 8.558 Vali Loss: 177.203 Vali Acc: 0.542 Test Loss: 177.203 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 12.909022331237793
Epoch: 25, Steps: 32 | Train Loss: 1.070 Vali Loss: 205.781 Vali Acc: 0.466 Test Loss: 205.781 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 13.475594758987427
Epoch: 26, Steps: 32 | Train Loss: 3.509 Vali Loss: 200.110 Vali Acc: 0.542 Test Loss: 200.110 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 12.496557235717773
Epoch: 27, Steps: 32 | Train Loss: 2.372 Vali Loss: 134.027 Vali Acc: 0.511 Test Loss: 134.027 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 12107605
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 14.758955001831055
Epoch: 1, Steps: 32 | Train Loss: 11.274 Vali Loss: 23.696 Vali Acc: 0.466 Test Loss: 23.696 Test Acc: 0.466
Validation loss decreased (inf --> -0.465412).  Saving model ...
Epoch: 2 cost time: 11.673916101455688
Epoch: 2, Steps: 32 | Train Loss: 28.670 Vali Loss: 22.412 Vali Acc: 0.504 Test Loss: 22.412 Test Acc: 0.504
Validation loss decreased (-0.465412 --> -0.503593).  Saving model ...
Epoch: 3 cost time: 11.802393674850464
Epoch: 3, Steps: 32 | Train Loss: 17.960 Vali Loss: 32.061 Vali Acc: 0.321 Test Loss: 32.061 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.067343711853027
Epoch: 4, Steps: 32 | Train Loss: 9.159 Vali Loss: 44.272 Vali Acc: 0.382 Test Loss: 44.272 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.916127443313599
Epoch: 5, Steps: 32 | Train Loss: 19.229 Vali Loss: 98.073 Vali Acc: 0.229 Test Loss: 98.073 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.486604452133179
Epoch: 6, Steps: 32 | Train Loss: 18.630 Vali Loss: 59.542 Vali Acc: 0.504 Test Loss: 59.542 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 12.145650625228882
Epoch: 7, Steps: 32 | Train Loss: 20.675 Vali Loss: 92.434 Vali Acc: 0.336 Test Loss: 92.434 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 12.854392528533936
Epoch: 8, Steps: 32 | Train Loss: 6.353 Vali Loss: 84.083 Vali Acc: 0.405 Test Loss: 84.083 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 12.79491639137268
Epoch: 9, Steps: 32 | Train Loss: 8.039 Vali Loss: 65.090 Vali Acc: 0.481 Test Loss: 65.090 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 12.12053108215332
Epoch: 10, Steps: 32 | Train Loss: 21.987 Vali Loss: 99.474 Vali Acc: 0.351 Test Loss: 99.474 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.984272003173828
Epoch: 11, Steps: 32 | Train Loss: 15.176 Vali Loss: 121.372 Vali Acc: 0.489 Test Loss: 121.372 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 12.361976385116577
Epoch: 12, Steps: 32 | Train Loss: 5.510 Vali Loss: 73.054 Vali Acc: 0.527 Test Loss: 73.054 Test Acc: 0.527
Validation loss decreased (-0.503593 --> -0.525987).  Saving model ...
Epoch: 13 cost time: 11.782022476196289
Epoch: 13, Steps: 32 | Train Loss: 10.196 Vali Loss: 69.659 Vali Acc: 0.427 Test Loss: 69.659 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 11.271387815475464
Epoch: 14, Steps: 32 | Train Loss: 0.929 Vali Loss: 89.431 Vali Acc: 0.542 Test Loss: 89.431 Test Acc: 0.542
Validation loss decreased (-0.525987 --> -0.541090).  Saving model ...
Epoch: 15 cost time: 12.11382246017456
Epoch: 15, Steps: 32 | Train Loss: 12.950 Vali Loss: 81.430 Vali Acc: 0.534 Test Loss: 81.430 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 11.368746995925903
Epoch: 16, Steps: 32 | Train Loss: 5.932 Vali Loss: 69.150 Vali Acc: 0.534 Test Loss: 69.150 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 11.431931972503662
Epoch: 17, Steps: 32 | Train Loss: 7.309 Vali Loss: 131.458 Vali Acc: 0.382 Test Loss: 131.458 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 11.590448379516602
Epoch: 18, Steps: 32 | Train Loss: 9.511 Vali Loss: 119.671 Vali Acc: 0.321 Test Loss: 119.671 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 11.673496723175049
Epoch: 19, Steps: 32 | Train Loss: 8.894 Vali Loss: 121.942 Vali Acc: 0.519 Test Loss: 121.942 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 12.232974767684937
Epoch: 20, Steps: 32 | Train Loss: 3.485 Vali Loss: 141.695 Vali Acc: 0.366 Test Loss: 141.695 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 11.841498613357544
Epoch: 21, Steps: 32 | Train Loss: 6.575 Vali Loss: 231.730 Vali Acc: 0.305 Test Loss: 231.730 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 12.005682229995728
Epoch: 22, Steps: 32 | Train Loss: 3.331 Vali Loss: 296.303 Vali Acc: 0.511 Test Loss: 296.303 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 12.516038417816162
Epoch: 23, Steps: 32 | Train Loss: 4.769 Vali Loss: 353.651 Vali Acc: 0.252 Test Loss: 353.651 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 11.85349178314209
Epoch: 24, Steps: 32 | Train Loss: 2.013 Vali Loss: 276.405 Vali Acc: 0.504 Test Loss: 276.405 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 12107605
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.189971208572388
Epoch: 1, Steps: 32 | Train Loss: 12.487 Vali Loss: 30.337 Vali Acc: 0.435 Test Loss: 30.337 Test Acc: 0.435
Validation loss decreased (inf --> -0.434811).  Saving model ...
Epoch: 2 cost time: 11.173539161682129
Epoch: 2, Steps: 32 | Train Loss: 19.795 Vali Loss: 34.801 Vali Acc: 0.427 Test Loss: 34.801 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.819097757339478
Epoch: 3, Steps: 32 | Train Loss: 17.548 Vali Loss: 39.587 Vali Acc: 0.290 Test Loss: 39.587 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 11.181368350982666
Epoch: 4, Steps: 32 | Train Loss: 18.182 Vali Loss: 47.227 Vali Acc: 0.412 Test Loss: 47.227 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.653708457946777
Epoch: 5, Steps: 32 | Train Loss: 22.164 Vali Loss: 89.391 Vali Acc: 0.214 Test Loss: 89.391 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.338963747024536
Epoch: 6, Steps: 32 | Train Loss: 14.096 Vali Loss: 77.425 Vali Acc: 0.496 Test Loss: 77.425 Test Acc: 0.496
Validation loss decreased (-0.434811 --> -0.495409).  Saving model ...
Epoch: 7 cost time: 10.685506105422974
Epoch: 7, Steps: 32 | Train Loss: 14.744 Vali Loss: 88.952 Vali Acc: 0.496 Test Loss: 88.952 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.390139102935791
Epoch: 8, Steps: 32 | Train Loss: 22.518 Vali Loss: 117.480 Vali Acc: 0.473 Test Loss: 117.480 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.366536140441895
Epoch: 9, Steps: 32 | Train Loss: 16.226 Vali Loss: 82.539 Vali Acc: 0.389 Test Loss: 82.539 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 10.672947883605957
Epoch: 10, Steps: 32 | Train Loss: 8.967 Vali Loss: 82.384 Vali Acc: 0.527 Test Loss: 82.384 Test Acc: 0.527
Validation loss decreased (-0.495409 --> -0.525894).  Saving model ...
Epoch: 11 cost time: 11.14848518371582
Epoch: 11, Steps: 32 | Train Loss: 10.668 Vali Loss: 100.023 Vali Acc: 0.534 Test Loss: 100.023 Test Acc: 0.534
Validation loss decreased (-0.525894 --> -0.533351).  Saving model ...
Epoch: 12 cost time: 11.661957740783691
Epoch: 12, Steps: 32 | Train Loss: 15.394 Vali Loss: 96.490 Vali Acc: 0.351 Test Loss: 96.490 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 11.35361933708191
Epoch: 13, Steps: 32 | Train Loss: 16.912 Vali Loss: 81.464 Vali Acc: 0.565 Test Loss: 81.464 Test Acc: 0.565
Validation loss decreased (-0.533351 --> -0.564071).  Saving model ...
Epoch: 14 cost time: 11.121338367462158
Epoch: 14, Steps: 32 | Train Loss: 3.489 Vali Loss: 80.099 Vali Acc: 0.481 Test Loss: 80.099 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.04313325881958
Epoch: 15, Steps: 32 | Train Loss: 4.669 Vali Loss: 144.125 Vali Acc: 0.374 Test Loss: 144.125 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.72947072982788
Epoch: 16, Steps: 32 | Train Loss: 15.879 Vali Loss: 92.678 Vali Acc: 0.489 Test Loss: 92.678 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.322667837142944
Epoch: 17, Steps: 32 | Train Loss: 15.708 Vali Loss: 121.226 Vali Acc: 0.427 Test Loss: 121.226 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.418851852416992
Epoch: 18, Steps: 32 | Train Loss: 16.984 Vali Loss: 101.584 Vali Acc: 0.573 Test Loss: 101.584 Test Acc: 0.573
Validation loss decreased (-0.564071 --> -0.571503).  Saving model ...
Epoch: 19 cost time: 11.077933073043823
Epoch: 19, Steps: 32 | Train Loss: 5.736 Vali Loss: 144.001 Vali Acc: 0.458 Test Loss: 144.001 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.409047365188599
Epoch: 20, Steps: 32 | Train Loss: 9.392 Vali Loss: 175.869 Vali Acc: 0.389 Test Loss: 175.869 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 11.383116245269775
Epoch: 21, Steps: 32 | Train Loss: 3.561 Vali Loss: 135.829 Vali Acc: 0.458 Test Loss: 135.829 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.770566463470459
Epoch: 22, Steps: 32 | Train Loss: 0.806 Vali Loss: 133.213 Vali Acc: 0.557 Test Loss: 133.213 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 11.830384492874146
Epoch: 23, Steps: 32 | Train Loss: 0.123 Vali Loss: 96.248 Vali Acc: 0.557 Test Loss: 96.248 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 11.341164827346802
Epoch: 24, Steps: 32 | Train Loss: 2.022 Vali Loss: 158.030 Vali Acc: 0.504 Test Loss: 158.030 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.553361892700195
Epoch: 25, Steps: 32 | Train Loss: 0.104 Vali Loss: 124.647 Vali Acc: 0.618 Test Loss: 124.647 Test Acc: 0.618
Validation loss decreased (-0.571503 --> -0.617074).  Saving model ...
Epoch: 26 cost time: 11.130603790283203
Epoch: 26, Steps: 32 | Train Loss: 4.174 Vali Loss: 222.610 Vali Acc: 0.481 Test Loss: 222.610 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 10.570101976394653
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 437.763 Vali Acc: 0.397 Test Loss: 437.763 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 10.809122323989868
Epoch: 28, Steps: 32 | Train Loss: 0.635 Vali Loss: 364.064 Vali Acc: 0.542 Test Loss: 364.064 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 10.842487096786499
Epoch: 29, Steps: 32 | Train Loss: 1.691 Vali Loss: 395.802 Vali Acc: 0.473 Test Loss: 395.802 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 11.34162187576294
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 471.502 Vali Acc: 0.359 Test Loss: 471.502 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 11.80333685874939
Epoch: 31, Steps: 32 | Train Loss: 0.326 Vali Loss: 446.261 Vali Acc: 0.298 Test Loss: 446.261 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 11.269643783569336
Epoch: 32, Steps: 32 | Train Loss: 3.139 Vali Loss: 313.760 Vali Acc: 0.504 Test Loss: 313.760 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 11.211446285247803
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 402.312 Vali Acc: 0.481 Test Loss: 402.312 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 11.424935102462769
Epoch: 34, Steps: 32 | Train Loss: 6.534 Vali Loss: 327.002 Vali Acc: 0.504 Test Loss: 327.002 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 10.669496536254883
Epoch: 35, Steps: 32 | Train Loss: 5.037 Vali Loss: 424.758 Vali Acc: 0.305 Test Loss: 424.758 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 12107605
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.876014947891235
Epoch: 1, Steps: 32 | Train Loss: 11.674 Vali Loss: 13.457 Vali Acc: 0.328 Test Loss: 13.457 Test Acc: 0.328
Validation loss decreased (inf --> -0.328110).  Saving model ...
Epoch: 2 cost time: 10.17928409576416
Epoch: 2, Steps: 32 | Train Loss: 14.905 Vali Loss: 34.278 Vali Acc: 0.229 Test Loss: 34.278 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.350474119186401
Epoch: 3, Steps: 32 | Train Loss: 20.180 Vali Loss: 36.484 Vali Acc: 0.344 Test Loss: 36.484 Test Acc: 0.344
Validation loss decreased (-0.328110 --> -0.343147).  Saving model ...
Epoch: 4 cost time: 10.117371559143066
Epoch: 4, Steps: 32 | Train Loss: 43.805 Vali Loss: 31.902 Vali Acc: 0.382 Test Loss: 31.902 Test Acc: 0.382
Validation loss decreased (-0.343147 --> -0.381360).  Saving model ...
Epoch: 5 cost time: 10.092044115066528
Epoch: 5, Steps: 32 | Train Loss: 23.096 Vali Loss: 39.449 Vali Acc: 0.496 Test Loss: 39.449 Test Acc: 0.496
Validation loss decreased (-0.381360 --> -0.495789).  Saving model ...
Epoch: 6 cost time: 10.234377145767212
Epoch: 6, Steps: 32 | Train Loss: 20.348 Vali Loss: 75.061 Vali Acc: 0.389 Test Loss: 75.061 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.070947408676147
Epoch: 7, Steps: 32 | Train Loss: 50.892 Vali Loss: 111.998 Vali Acc: 0.496 Test Loss: 111.998 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.823512315750122
Epoch: 8, Steps: 32 | Train Loss: 18.787 Vali Loss: 129.859 Vali Acc: 0.344 Test Loss: 129.859 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.338711977005005
Epoch: 9, Steps: 32 | Train Loss: 14.748 Vali Loss: 158.760 Vali Acc: 0.481 Test Loss: 158.760 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.080044746398926
Epoch: 10, Steps: 32 | Train Loss: 12.998 Vali Loss: 122.325 Vali Acc: 0.504 Test Loss: 122.325 Test Acc: 0.504
Validation loss decreased (-0.495789 --> -0.502594).  Saving model ...
Epoch: 11 cost time: 10.224004983901978
Epoch: 11, Steps: 32 | Train Loss: 10.326 Vali Loss: 107.364 Vali Acc: 0.382 Test Loss: 107.364 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.992337703704834
Epoch: 12, Steps: 32 | Train Loss: 6.181 Vali Loss: 233.855 Vali Acc: 0.221 Test Loss: 233.855 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.21118712425232
Epoch: 13, Steps: 32 | Train Loss: 6.892 Vali Loss: 118.184 Vali Acc: 0.557 Test Loss: 118.184 Test Acc: 0.557
Validation loss decreased (-0.502594 --> -0.556070).  Saving model ...
Epoch: 14 cost time: 10.292587995529175
Epoch: 14, Steps: 32 | Train Loss: 3.075 Vali Loss: 134.508 Vali Acc: 0.504 Test Loss: 134.508 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.713750123977661
Epoch: 15, Steps: 32 | Train Loss: 0.798 Vali Loss: 151.292 Vali Acc: 0.511 Test Loss: 151.292 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.888692617416382
Epoch: 16, Steps: 32 | Train Loss: 3.483 Vali Loss: 153.395 Vali Acc: 0.420 Test Loss: 153.395 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.295022964477539
Epoch: 17, Steps: 32 | Train Loss: 1.323 Vali Loss: 245.297 Vali Acc: 0.214 Test Loss: 245.297 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.279821157455444
Epoch: 18, Steps: 32 | Train Loss: 3.402 Vali Loss: 183.827 Vali Acc: 0.344 Test Loss: 183.827 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.990209817886353
Epoch: 19, Steps: 32 | Train Loss: 1.814 Vali Loss: 137.824 Vali Acc: 0.427 Test Loss: 137.824 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 10.175013303756714
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 131.632 Vali Acc: 0.481 Test Loss: 131.632 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.073537588119507
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 132.049 Vali Acc: 0.473 Test Loss: 132.049 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 10.296223640441895
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 132.065 Vali Acc: 0.473 Test Loss: 132.065 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.899567127227783
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 132.066 Vali Acc: 0.473 Test Loss: 132.066 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 12107605
model size : 54.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.629579067230225
Epoch: 1, Steps: 32 | Train Loss: 16.694 Vali Loss: 20.302 Vali Acc: 0.168 Test Loss: 20.302 Test Acc: 0.168
Validation loss decreased (inf --> -0.167736).  Saving model ...
Epoch: 2 cost time: 11.716221570968628
Epoch: 2, Steps: 32 | Train Loss: 21.047 Vali Loss: 16.455 Vali Acc: 0.534 Test Loss: 16.455 Test Acc: 0.534
Validation loss decreased (-0.167736 --> -0.534187).  Saving model ...
Epoch: 3 cost time: 11.610208511352539
Epoch: 3, Steps: 32 | Train Loss: 18.183 Vali Loss: 23.789 Vali Acc: 0.466 Test Loss: 23.789 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 12.448297500610352
Epoch: 4, Steps: 32 | Train Loss: 16.993 Vali Loss: 75.664 Vali Acc: 0.344 Test Loss: 75.664 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.667337894439697
Epoch: 5, Steps: 32 | Train Loss: 15.205 Vali Loss: 102.673 Vali Acc: 0.321 Test Loss: 102.673 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.92204737663269
Epoch: 6, Steps: 32 | Train Loss: 16.869 Vali Loss: 89.321 Vali Acc: 0.542 Test Loss: 89.321 Test Acc: 0.542
Validation loss decreased (-0.534187 --> -0.541092).  Saving model ...
Epoch: 7 cost time: 12.627953290939331
Epoch: 7, Steps: 32 | Train Loss: 14.826 Vali Loss: 75.664 Vali Acc: 0.366 Test Loss: 75.664 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 12.838802337646484
Epoch: 8, Steps: 32 | Train Loss: 10.236 Vali Loss: 69.741 Vali Acc: 0.489 Test Loss: 69.741 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 12.167006015777588
Epoch: 9, Steps: 32 | Train Loss: 11.942 Vali Loss: 90.335 Vali Acc: 0.328 Test Loss: 90.335 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 12.006943702697754
Epoch: 10, Steps: 32 | Train Loss: 5.995 Vali Loss: 106.691 Vali Acc: 0.519 Test Loss: 106.691 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 12.621690034866333
Epoch: 11, Steps: 32 | Train Loss: 26.055 Vali Loss: 132.878 Vali Acc: 0.504 Test Loss: 132.878 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 12.337859392166138
Epoch: 12, Steps: 32 | Train Loss: 23.110 Vali Loss: 112.654 Vali Acc: 0.565 Test Loss: 112.654 Test Acc: 0.565
Validation loss decreased (-0.541092 --> -0.563759).  Saving model ...
Epoch: 13 cost time: 11.36205244064331
Epoch: 13, Steps: 32 | Train Loss: 22.351 Vali Loss: 84.769 Vali Acc: 0.550 Test Loss: 84.769 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 12.554474353790283
Epoch: 14, Steps: 32 | Train Loss: 0.066 Vali Loss: 93.302 Vali Acc: 0.527 Test Loss: 93.302 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 12.344751119613647
Epoch: 15, Steps: 32 | Train Loss: 7.524 Vali Loss: 139.848 Vali Acc: 0.542 Test Loss: 139.848 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 12.39881944656372
Epoch: 16, Steps: 32 | Train Loss: 10.019 Vali Loss: 181.934 Vali Acc: 0.542 Test Loss: 181.934 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 11.943368673324585
Epoch: 17, Steps: 32 | Train Loss: 6.988 Vali Loss: 218.045 Vali Acc: 0.290 Test Loss: 218.045 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 12.138728618621826
Epoch: 18, Steps: 32 | Train Loss: 1.069 Vali Loss: 152.397 Vali Acc: 0.519 Test Loss: 152.397 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 12.283043384552002
Epoch: 19, Steps: 32 | Train Loss: 5.829 Vali Loss: 154.619 Vali Acc: 0.534 Test Loss: 154.619 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 11.378780364990234
Epoch: 20, Steps: 32 | Train Loss: 0.461 Vali Loss: 182.026 Vali Acc: 0.557 Test Loss: 182.026 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 11.335917234420776
Epoch: 21, Steps: 32 | Train Loss: 4.329 Vali Loss: 144.919 Vali Acc: 0.542 Test Loss: 144.919 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 12.56869888305664
Epoch: 22, Steps: 32 | Train Loss: 0.892 Vali Loss: 166.680 Vali Acc: 0.557 Test Loss: 166.680 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 11845461
model size : 53.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.541435241699219
Epoch: 1, Steps: 32 | Train Loss: 16.754 Vali Loss: 17.179 Vali Acc: 0.450 Test Loss: 17.179 Test Acc: 0.450
Validation loss decreased (inf --> -0.450210).  Saving model ...
Epoch: 2 cost time: 11.258930921554565
Epoch: 2, Steps: 32 | Train Loss: 17.659 Vali Loss: 16.414 Vali Acc: 0.359 Test Loss: 16.414 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.41125202178955
Epoch: 3, Steps: 32 | Train Loss: 24.449 Vali Loss: 61.831 Vali Acc: 0.366 Test Loss: 61.831 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.548820495605469
Epoch: 4, Steps: 32 | Train Loss: 14.629 Vali Loss: 66.009 Vali Acc: 0.443 Test Loss: 66.009 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 11.147625923156738
Epoch: 5, Steps: 32 | Train Loss: 18.502 Vali Loss: 97.294 Vali Acc: 0.298 Test Loss: 97.294 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 11.10832405090332
Epoch: 6, Steps: 32 | Train Loss: 12.261 Vali Loss: 67.832 Vali Acc: 0.374 Test Loss: 67.832 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 11.232972383499146
Epoch: 7, Steps: 32 | Train Loss: 12.933 Vali Loss: 90.397 Vali Acc: 0.511 Test Loss: 90.397 Test Acc: 0.511
Validation loss decreased (-0.450210 --> -0.510546).  Saving model ...
Epoch: 8 cost time: 11.631826877593994
Epoch: 8, Steps: 32 | Train Loss: 16.431 Vali Loss: 92.533 Vali Acc: 0.282 Test Loss: 92.533 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 12.374319791793823
Epoch: 9, Steps: 32 | Train Loss: 13.025 Vali Loss: 70.513 Vali Acc: 0.565 Test Loss: 70.513 Test Acc: 0.565
Validation loss decreased (-0.510546 --> -0.564180).  Saving model ...
Epoch: 10 cost time: 11.09670090675354
Epoch: 10, Steps: 32 | Train Loss: 13.271 Vali Loss: 65.032 Vali Acc: 0.473 Test Loss: 65.032 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.699608325958252
Epoch: 11, Steps: 32 | Train Loss: 6.029 Vali Loss: 71.099 Vali Acc: 0.405 Test Loss: 71.099 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.576198101043701
Epoch: 12, Steps: 32 | Train Loss: 3.644 Vali Loss: 51.416 Vali Acc: 0.542 Test Loss: 51.416 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.09013557434082
Epoch: 13, Steps: 32 | Train Loss: 10.436 Vali Loss: 54.945 Vali Acc: 0.573 Test Loss: 54.945 Test Acc: 0.573
Validation loss decreased (-0.564180 --> -0.571970).  Saving model ...
Epoch: 14 cost time: 11.29460334777832
Epoch: 14, Steps: 32 | Train Loss: 5.711 Vali Loss: 125.094 Vali Acc: 0.542 Test Loss: 125.094 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.76384687423706
Epoch: 15, Steps: 32 | Train Loss: 3.528 Vali Loss: 138.308 Vali Acc: 0.473 Test Loss: 138.308 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.295103073120117
Epoch: 16, Steps: 32 | Train Loss: 7.098 Vali Loss: 133.420 Vali Acc: 0.527 Test Loss: 133.420 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.595882177352905
Epoch: 17, Steps: 32 | Train Loss: 1.548 Vali Loss: 114.350 Vali Acc: 0.374 Test Loss: 114.350 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.434293985366821
Epoch: 18, Steps: 32 | Train Loss: 3.826 Vali Loss: 75.325 Vali Acc: 0.534 Test Loss: 75.325 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.672672986984253
Epoch: 19, Steps: 32 | Train Loss: 5.056 Vali Loss: 183.634 Vali Acc: 0.542 Test Loss: 183.634 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.387335300445557
Epoch: 20, Steps: 32 | Train Loss: 6.259 Vali Loss: 119.555 Vali Acc: 0.557 Test Loss: 119.555 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.17741847038269
Epoch: 21, Steps: 32 | Train Loss: 1.337 Vali Loss: 188.156 Vali Acc: 0.305 Test Loss: 188.156 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.112603664398193
Epoch: 22, Steps: 32 | Train Loss: 6.266 Vali Loss: 101.406 Vali Acc: 0.511 Test Loss: 101.406 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.013540267944336
Epoch: 23, Steps: 32 | Train Loss: 5.829 Vali Loss: 149.912 Vali Acc: 0.542 Test Loss: 149.912 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 11845461
model size : 53.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.050096988677979
Epoch: 1, Steps: 32 | Train Loss: 15.628 Vali Loss: 27.745 Vali Acc: 0.244 Test Loss: 27.745 Test Acc: 0.244
Validation loss decreased (inf --> -0.243997).  Saving model ...
Epoch: 2 cost time: 9.791699886322021
Epoch: 2, Steps: 32 | Train Loss: 17.244 Vali Loss: 29.166 Vali Acc: 0.252 Test Loss: 29.166 Test Acc: 0.252
Validation loss decreased (-0.243997 --> -0.251617).  Saving model ...
Epoch: 3 cost time: 10.749832391738892
Epoch: 3, Steps: 32 | Train Loss: 20.120 Vali Loss: 21.765 Vali Acc: 0.427 Test Loss: 21.765 Test Acc: 0.427
Validation loss decreased (-0.251617 --> -0.427263).  Saving model ...
Epoch: 4 cost time: 10.379409551620483
Epoch: 4, Steps: 32 | Train Loss: 29.323 Vali Loss: 118.387 Vali Acc: 0.115 Test Loss: 118.387 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.912601947784424
Epoch: 5, Steps: 32 | Train Loss: 13.855 Vali Loss: 75.656 Vali Acc: 0.542 Test Loss: 75.656 Test Acc: 0.542
Validation loss decreased (-0.427263 --> -0.541228).  Saving model ...
Epoch: 6 cost time: 9.789510011672974
Epoch: 6, Steps: 32 | Train Loss: 17.962 Vali Loss: 134.572 Vali Acc: 0.237 Test Loss: 134.572 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.846345663070679
Epoch: 7, Steps: 32 | Train Loss: 20.185 Vali Loss: 103.405 Vali Acc: 0.237 Test Loss: 103.405 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.569525718688965
Epoch: 8, Steps: 32 | Train Loss: 11.686 Vali Loss: 96.976 Vali Acc: 0.313 Test Loss: 96.976 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.37870192527771
Epoch: 9, Steps: 32 | Train Loss: 7.899 Vali Loss: 70.519 Vali Acc: 0.450 Test Loss: 70.519 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.901120662689209
Epoch: 10, Steps: 32 | Train Loss: 9.642 Vali Loss: 86.864 Vali Acc: 0.397 Test Loss: 86.864 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 11.043905258178711
Epoch: 11, Steps: 32 | Train Loss: 8.904 Vali Loss: 83.830 Vali Acc: 0.405 Test Loss: 83.830 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.35531210899353
Epoch: 12, Steps: 32 | Train Loss: 12.322 Vali Loss: 101.085 Vali Acc: 0.328 Test Loss: 101.085 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 10.033579587936401
Epoch: 13, Steps: 32 | Train Loss: 16.731 Vali Loss: 111.666 Vali Acc: 0.344 Test Loss: 111.666 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.014071702957153
Epoch: 14, Steps: 32 | Train Loss: 8.108 Vali Loss: 88.024 Vali Acc: 0.527 Test Loss: 88.024 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 10.142554521560669
Epoch: 15, Steps: 32 | Train Loss: 13.744 Vali Loss: 141.854 Vali Acc: 0.534 Test Loss: 141.854 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 11845461
model size : 53.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.263208150863647
Epoch: 1, Steps: 32 | Train Loss: 17.067 Vali Loss: 25.470 Vali Acc: 0.496 Test Loss: 25.470 Test Acc: 0.496
Validation loss decreased (inf --> -0.495929).  Saving model ...
Epoch: 2 cost time: 9.199206113815308
Epoch: 2, Steps: 32 | Train Loss: 21.490 Vali Loss: 42.263 Vali Acc: 0.489 Test Loss: 42.263 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.807944297790527
Epoch: 3, Steps: 32 | Train Loss: 39.694 Vali Loss: 47.998 Vali Acc: 0.466 Test Loss: 47.998 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.580776691436768
Epoch: 4, Steps: 32 | Train Loss: 25.896 Vali Loss: 53.226 Vali Acc: 0.290 Test Loss: 53.226 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.455640316009521
Epoch: 5, Steps: 32 | Train Loss: 27.039 Vali Loss: 74.305 Vali Acc: 0.359 Test Loss: 74.305 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 9.680004358291626
Epoch: 6, Steps: 32 | Train Loss: 29.258 Vali Loss: 71.834 Vali Acc: 0.305 Test Loss: 71.834 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 9.770654678344727
Epoch: 7, Steps: 32 | Train Loss: 21.776 Vali Loss: 114.599 Vali Acc: 0.191 Test Loss: 114.599 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 9.937678337097168
Epoch: 8, Steps: 32 | Train Loss: 13.038 Vali Loss: 122.365 Vali Acc: 0.252 Test Loss: 122.365 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 9.59437608718872
Epoch: 9, Steps: 32 | Train Loss: 25.242 Vali Loss: 88.244 Vali Acc: 0.519 Test Loss: 88.244 Test Acc: 0.519
Validation loss decreased (-0.495929 --> -0.518202).  Saving model ...
Epoch: 10 cost time: 10.217877388000488
Epoch: 10, Steps: 32 | Train Loss: 15.014 Vali Loss: 59.167 Vali Acc: 0.481 Test Loss: 59.167 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.087550163269043
Epoch: 11, Steps: 32 | Train Loss: 12.384 Vali Loss: 132.162 Vali Acc: 0.336 Test Loss: 132.162 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.990105152130127
Epoch: 12, Steps: 32 | Train Loss: 19.287 Vali Loss: 87.668 Vali Acc: 0.458 Test Loss: 87.668 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.890970468521118
Epoch: 13, Steps: 32 | Train Loss: 8.278 Vali Loss: 108.603 Vali Acc: 0.328 Test Loss: 108.603 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.071818351745605
Epoch: 14, Steps: 32 | Train Loss: 1.365 Vali Loss: 111.002 Vali Acc: 0.397 Test Loss: 111.002 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.203948497772217
Epoch: 15, Steps: 32 | Train Loss: 0.851 Vali Loss: 183.681 Vali Acc: 0.214 Test Loss: 183.681 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.594441175460815
Epoch: 16, Steps: 32 | Train Loss: 1.784 Vali Loss: 99.511 Vali Acc: 0.412 Test Loss: 99.511 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.319627523422241
Epoch: 17, Steps: 32 | Train Loss: 3.114 Vali Loss: 66.570 Vali Acc: 0.550 Test Loss: 66.570 Test Acc: 0.550
Validation loss decreased (-0.518202 --> -0.548953).  Saving model ...
Epoch: 18 cost time: 9.553708553314209
Epoch: 18, Steps: 32 | Train Loss: 2.455 Vali Loss: 154.283 Vali Acc: 0.565 Test Loss: 154.283 Test Acc: 0.565
Validation loss decreased (-0.548953 --> -0.563343).  Saving model ...
Epoch: 19 cost time: 10.153139114379883
Epoch: 19, Steps: 32 | Train Loss: 0.305 Vali Loss: 99.446 Vali Acc: 0.443 Test Loss: 99.446 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.70314335823059
Epoch: 20, Steps: 32 | Train Loss: 4.212 Vali Loss: 193.835 Vali Acc: 0.237 Test Loss: 193.835 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.587827444076538
Epoch: 21, Steps: 32 | Train Loss: 9.950 Vali Loss: 132.834 Vali Acc: 0.573 Test Loss: 132.834 Test Acc: 0.573
Validation loss decreased (-0.563343 --> -0.571191).  Saving model ...
Epoch: 22 cost time: 10.887861490249634
Epoch: 22, Steps: 32 | Train Loss: 5.308 Vali Loss: 152.652 Vali Acc: 0.580 Test Loss: 152.652 Test Acc: 0.580
Validation loss decreased (-0.571191 --> -0.578626).  Saving model ...
Epoch: 23 cost time: 10.157245874404907
Epoch: 23, Steps: 32 | Train Loss: 3.692 Vali Loss: 142.883 Vali Acc: 0.504 Test Loss: 142.883 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 10.052006959915161
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.872 Vali Acc: 0.481 Test Loss: 135.872 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.800121784210205
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.604 Vali Acc: 0.481 Test Loss: 135.604 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.479615926742554
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.828345775604248
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 10.189192771911621
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.568506479263306
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 11.663676977157593
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 10.27455186843872
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 9.788760662078857
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.595 Vali Acc: 0.481 Test Loss: 135.595 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 11845461
model size : 53.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.81873369216919
Epoch: 1, Steps: 32 | Train Loss: 7.705 Vali Loss: 18.543 Vali Acc: 0.313 Test Loss: 18.543 Test Acc: 0.313
Validation loss decreased (inf --> -0.312792).  Saving model ...
Epoch: 2 cost time: 11.379111051559448
Epoch: 2, Steps: 32 | Train Loss: 18.921 Vali Loss: 48.600 Vali Acc: 0.527 Test Loss: 48.600 Test Acc: 0.527
Validation loss decreased (-0.312792 --> -0.526232).  Saving model ...
Epoch: 3 cost time: 11.417510747909546
Epoch: 3, Steps: 32 | Train Loss: 19.905 Vali Loss: 29.232 Vali Acc: 0.328 Test Loss: 29.232 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.516506433486938
Epoch: 4, Steps: 32 | Train Loss: 9.579 Vali Loss: 38.119 Vali Acc: 0.305 Test Loss: 38.119 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.873700618743896
Epoch: 5, Steps: 32 | Train Loss: 7.456 Vali Loss: 53.915 Vali Acc: 0.466 Test Loss: 53.915 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 12.143583536148071
Epoch: 6, Steps: 32 | Train Loss: 12.232 Vali Loss: 67.268 Vali Acc: 0.397 Test Loss: 67.268 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 11.884226322174072
Epoch: 7, Steps: 32 | Train Loss: 24.711 Vali Loss: 104.659 Vali Acc: 0.351 Test Loss: 104.659 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 11.341944217681885
Epoch: 8, Steps: 32 | Train Loss: 4.706 Vali Loss: 128.934 Vali Acc: 0.489 Test Loss: 128.934 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.716000080108643
Epoch: 9, Steps: 32 | Train Loss: 12.945 Vali Loss: 128.924 Vali Acc: 0.351 Test Loss: 128.924 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.962735652923584
Epoch: 10, Steps: 32 | Train Loss: 5.490 Vali Loss: 168.874 Vali Acc: 0.183 Test Loss: 168.874 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 11.697018384933472
Epoch: 11, Steps: 32 | Train Loss: 5.683 Vali Loss: 126.622 Vali Acc: 0.321 Test Loss: 126.622 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 11.436899185180664
Epoch: 12, Steps: 32 | Train Loss: 3.893 Vali Loss: 114.962 Vali Acc: 0.321 Test Loss: 114.962 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 11714389
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.612347602844238
Epoch: 1, Steps: 32 | Train Loss: 20.378 Vali Loss: 44.894 Vali Acc: 0.168 Test Loss: 44.894 Test Acc: 0.168
Validation loss decreased (inf --> -0.167490).  Saving model ...
Epoch: 2 cost time: 10.628582954406738
Epoch: 2, Steps: 32 | Train Loss: 33.590 Vali Loss: 35.493 Vali Acc: 0.282 Test Loss: 35.493 Test Acc: 0.282
Validation loss decreased (-0.167490 --> -0.282088).  Saving model ...
Epoch: 3 cost time: 11.039642095565796
Epoch: 3, Steps: 32 | Train Loss: 21.521 Vali Loss: 63.652 Vali Acc: 0.412 Test Loss: 63.652 Test Acc: 0.412
Validation loss decreased (-0.282088 --> -0.411577).  Saving model ...
Epoch: 4 cost time: 10.631688356399536
Epoch: 4, Steps: 32 | Train Loss: 20.544 Vali Loss: 32.246 Vali Acc: 0.336 Test Loss: 32.246 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 10.7100510597229
Epoch: 5, Steps: 32 | Train Loss: 16.275 Vali Loss: 50.333 Vali Acc: 0.344 Test Loss: 50.333 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 11.025246381759644
Epoch: 6, Steps: 32 | Train Loss: 10.552 Vali Loss: 69.101 Vali Acc: 0.298 Test Loss: 69.101 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 11.238033771514893
Epoch: 7, Steps: 32 | Train Loss: 29.797 Vali Loss: 82.339 Vali Acc: 0.298 Test Loss: 82.339 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 10.758851051330566
Epoch: 8, Steps: 32 | Train Loss: 19.390 Vali Loss: 128.666 Vali Acc: 0.389 Test Loss: 128.666 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 11.352830410003662
Epoch: 9, Steps: 32 | Train Loss: 8.724 Vali Loss: 144.057 Vali Acc: 0.504 Test Loss: 144.057 Test Acc: 0.504
Validation loss decreased (-0.411577 --> -0.502376).  Saving model ...
Epoch: 10 cost time: 11.282395601272583
Epoch: 10, Steps: 32 | Train Loss: 7.075 Vali Loss: 129.943 Vali Acc: 0.443 Test Loss: 129.943 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.34211254119873
Epoch: 11, Steps: 32 | Train Loss: 2.427 Vali Loss: 136.820 Vali Acc: 0.359 Test Loss: 136.820 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 10.910321950912476
Epoch: 12, Steps: 32 | Train Loss: 5.210 Vali Loss: 147.917 Vali Acc: 0.389 Test Loss: 147.917 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.932729244232178
Epoch: 13, Steps: 32 | Train Loss: 9.861 Vali Loss: 181.551 Vali Acc: 0.267 Test Loss: 181.551 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.203384160995483
Epoch: 14, Steps: 32 | Train Loss: 12.443 Vali Loss: 135.081 Vali Acc: 0.366 Test Loss: 135.081 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 10.51464581489563
Epoch: 15, Steps: 32 | Train Loss: 5.599 Vali Loss: 97.832 Vali Acc: 0.466 Test Loss: 97.832 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.48177194595337
Epoch: 16, Steps: 32 | Train Loss: 2.308 Vali Loss: 101.329 Vali Acc: 0.405 Test Loss: 101.329 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.304429531097412
Epoch: 17, Steps: 32 | Train Loss: 8.772 Vali Loss: 160.673 Vali Acc: 0.550 Test Loss: 160.673 Test Acc: 0.550
Validation loss decreased (-0.502376 --> -0.548012).  Saving model ...
Epoch: 18 cost time: 10.677027225494385
Epoch: 18, Steps: 32 | Train Loss: 14.469 Vali Loss: 126.467 Vali Acc: 0.565 Test Loss: 126.467 Test Acc: 0.565
Validation loss decreased (-0.548012 --> -0.563621).  Saving model ...
Epoch: 19 cost time: 11.196607828140259
Epoch: 19, Steps: 32 | Train Loss: 17.168 Vali Loss: 193.673 Vali Acc: 0.435 Test Loss: 193.673 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 11.369752407073975
Epoch: 20, Steps: 32 | Train Loss: 10.500 Vali Loss: 113.479 Vali Acc: 0.466 Test Loss: 113.479 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 10.286009073257446
Epoch: 21, Steps: 32 | Train Loss: 0.857 Vali Loss: 114.089 Vali Acc: 0.588 Test Loss: 114.089 Test Acc: 0.588
Validation loss decreased (-0.563621 --> -0.586645).  Saving model ...
Epoch: 22 cost time: 11.37883710861206
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.668 Vali Acc: 0.573 Test Loss: 107.668 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 11.258556127548218
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.563 Vali Acc: 0.573 Test Loss: 107.563 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 11.006295204162598
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 11.208597898483276
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 11.154684782028198
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 11.31343960762024
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 10.579991579055786
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 10.730209350585938
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 10.792107820510864
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 10.791483163833618
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 107.558 Vali Acc: 0.573 Test Loss: 107.558 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 11714389
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.718215227127075
Epoch: 1, Steps: 32 | Train Loss: 10.311 Vali Loss: 21.968 Vali Acc: 0.420 Test Loss: 21.968 Test Acc: 0.420
Validation loss decreased (inf --> -0.419628).  Saving model ...
Epoch: 2 cost time: 10.346766710281372
Epoch: 2, Steps: 32 | Train Loss: 20.224 Vali Loss: 47.837 Vali Acc: 0.588 Test Loss: 47.837 Test Acc: 0.588
Validation loss decreased (-0.419628 --> -0.587308).  Saving model ...
Epoch: 3 cost time: 9.638457298278809
Epoch: 3, Steps: 32 | Train Loss: 22.927 Vali Loss: 41.413 Vali Acc: 0.275 Test Loss: 41.413 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.533246755599976
Epoch: 4, Steps: 32 | Train Loss: 12.373 Vali Loss: 32.947 Vali Acc: 0.313 Test Loss: 32.947 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.321895360946655
Epoch: 5, Steps: 32 | Train Loss: 14.866 Vali Loss: 72.103 Vali Acc: 0.282 Test Loss: 72.103 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.305362939834595
Epoch: 6, Steps: 32 | Train Loss: 21.098 Vali Loss: 27.032 Vali Acc: 0.511 Test Loss: 27.032 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.532537460327148
Epoch: 7, Steps: 32 | Train Loss: 12.572 Vali Loss: 151.856 Vali Acc: 0.260 Test Loss: 151.856 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.165427207946777
Epoch: 8, Steps: 32 | Train Loss: 33.649 Vali Loss: 74.886 Vali Acc: 0.550 Test Loss: 74.886 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 11.56268310546875
Epoch: 9, Steps: 32 | Train Loss: 21.636 Vali Loss: 131.933 Vali Acc: 0.542 Test Loss: 131.933 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.760293245315552
Epoch: 10, Steps: 32 | Train Loss: 1.938 Vali Loss: 162.046 Vali Acc: 0.328 Test Loss: 162.046 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.21082329750061
Epoch: 11, Steps: 32 | Train Loss: 26.722 Vali Loss: 186.728 Vali Acc: 0.374 Test Loss: 186.728 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.939976453781128
Epoch: 12, Steps: 32 | Train Loss: 30.968 Vali Loss: 151.405 Vali Acc: 0.450 Test Loss: 151.405 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 11714389
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.014295816421509
Epoch: 1, Steps: 32 | Train Loss: 10.196 Vali Loss: 24.480 Vali Acc: 0.275 Test Loss: 24.480 Test Acc: 0.275
Validation loss decreased (inf --> -0.274564).  Saving model ...
Epoch: 2 cost time: 9.732001781463623
Epoch: 2, Steps: 32 | Train Loss: 25.167 Vali Loss: 71.057 Vali Acc: 0.176 Test Loss: 71.057 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.791622877120972
Epoch: 3, Steps: 32 | Train Loss: 24.960 Vali Loss: 46.487 Vali Acc: 0.145 Test Loss: 46.487 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.92383885383606
Epoch: 4, Steps: 32 | Train Loss: 13.462 Vali Loss: 30.734 Vali Acc: 0.359 Test Loss: 30.734 Test Acc: 0.359
Validation loss decreased (-0.274564 --> -0.358471).  Saving model ...
Epoch: 5 cost time: 9.362853765487671
Epoch: 5, Steps: 32 | Train Loss: 21.478 Vali Loss: 31.994 Vali Acc: 0.565 Test Loss: 31.994 Test Acc: 0.565
Validation loss decreased (-0.358471 --> -0.564566).  Saving model ...
Epoch: 6 cost time: 9.544537782669067
Epoch: 6, Steps: 32 | Train Loss: 35.624 Vali Loss: 57.036 Vali Acc: 0.489 Test Loss: 57.036 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.620554208755493
Epoch: 7, Steps: 32 | Train Loss: 49.778 Vali Loss: 95.742 Vali Acc: 0.206 Test Loss: 95.742 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.605942249298096
Epoch: 8, Steps: 32 | Train Loss: 11.455 Vali Loss: 35.085 Vali Acc: 0.473 Test Loss: 35.085 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.645803213119507
Epoch: 9, Steps: 32 | Train Loss: 10.680 Vali Loss: 48.564 Vali Acc: 0.626 Test Loss: 48.564 Test Acc: 0.626
Validation loss decreased (-0.564566 --> -0.625469).  Saving model ...
Epoch: 10 cost time: 9.530272245407104
Epoch: 10, Steps: 32 | Train Loss: 15.925 Vali Loss: 94.074 Vali Acc: 0.565 Test Loss: 94.074 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.91145920753479
Epoch: 11, Steps: 32 | Train Loss: 18.160 Vali Loss: 50.376 Vali Acc: 0.588 Test Loss: 50.376 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.044569730758667
Epoch: 12, Steps: 32 | Train Loss: 6.854 Vali Loss: 86.497 Vali Acc: 0.382 Test Loss: 86.497 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.857008457183838
Epoch: 13, Steps: 32 | Train Loss: 6.270 Vali Loss: 146.711 Vali Acc: 0.382 Test Loss: 146.711 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.802777528762817
Epoch: 14, Steps: 32 | Train Loss: 0.206 Vali Loss: 215.184 Vali Acc: 0.275 Test Loss: 215.184 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.878345966339111
Epoch: 15, Steps: 32 | Train Loss: 0.330 Vali Loss: 258.139 Vali Acc: 0.237 Test Loss: 258.139 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.842874765396118
Epoch: 16, Steps: 32 | Train Loss: 0.570 Vali Loss: 180.585 Vali Acc: 0.427 Test Loss: 180.585 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.41077184677124
Epoch: 17, Steps: 32 | Train Loss: 0.707 Vali Loss: 240.407 Vali Acc: 0.244 Test Loss: 240.407 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 9.553357362747192
Epoch: 18, Steps: 32 | Train Loss: 0.542 Vali Loss: 159.140 Vali Acc: 0.611 Test Loss: 159.140 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 9.355930805206299
Epoch: 19, Steps: 32 | Train Loss: 1.238 Vali Loss: 175.645 Vali Acc: 0.573 Test Loss: 175.645 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 11714389
model size : 53.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 13.119832754135132
Epoch: 1, Steps: 32 | Train Loss: 12.350 Vali Loss: 20.615 Vali Acc: 0.412 Test Loss: 20.615 Test Acc: 0.412
Validation loss decreased (inf --> -0.412008).  Saving model ...
Epoch: 2 cost time: 11.105716943740845
Epoch: 2, Steps: 32 | Train Loss: 19.078 Vali Loss: 37.661 Vali Acc: 0.260 Test Loss: 37.661 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.633335590362549
Epoch: 3, Steps: 32 | Train Loss: 22.162 Vali Loss: 25.954 Vali Acc: 0.496 Test Loss: 25.954 Test Acc: 0.496
Validation loss decreased (-0.412008 --> -0.495924).  Saving model ...
Epoch: 4 cost time: 11.706981420516968
Epoch: 4, Steps: 32 | Train Loss: 15.821 Vali Loss: 63.827 Vali Acc: 0.420 Test Loss: 63.827 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.778244495391846
Epoch: 5, Steps: 32 | Train Loss: 27.063 Vali Loss: 30.103 Vali Acc: 0.534 Test Loss: 30.103 Test Acc: 0.534
Validation loss decreased (-0.495924 --> -0.534050).  Saving model ...
Epoch: 6 cost time: 12.70859408378601
Epoch: 6, Steps: 32 | Train Loss: 20.860 Vali Loss: 102.706 Vali Acc: 0.305 Test Loss: 102.706 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 11.73603367805481
Epoch: 7, Steps: 32 | Train Loss: 7.750 Vali Loss: 118.429 Vali Acc: 0.260 Test Loss: 118.429 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 11.27633810043335
Epoch: 8, Steps: 32 | Train Loss: 4.540 Vali Loss: 106.634 Vali Acc: 0.557 Test Loss: 106.634 Test Acc: 0.557
Validation loss decreased (-0.534050 --> -0.556186).  Saving model ...
Epoch: 9 cost time: 11.478471517562866
Epoch: 9, Steps: 32 | Train Loss: 4.933 Vali Loss: 97.250 Vali Acc: 0.595 Test Loss: 97.250 Test Acc: 0.595
Validation loss decreased (-0.556186 --> -0.594447).  Saving model ...
Epoch: 10 cost time: 11.577311992645264
Epoch: 10, Steps: 32 | Train Loss: 8.547 Vali Loss: 121.637 Vali Acc: 0.534 Test Loss: 121.637 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.399797439575195
Epoch: 11, Steps: 32 | Train Loss: 18.655 Vali Loss: 105.119 Vali Acc: 0.374 Test Loss: 105.119 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.422163724899292
Epoch: 12, Steps: 32 | Train Loss: 8.853 Vali Loss: 95.321 Vali Acc: 0.489 Test Loss: 95.321 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.73649787902832
Epoch: 13, Steps: 32 | Train Loss: 5.235 Vali Loss: 94.168 Vali Acc: 0.565 Test Loss: 94.168 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 11.412773847579956
Epoch: 14, Steps: 32 | Train Loss: 4.099 Vali Loss: 120.976 Vali Acc: 0.366 Test Loss: 120.976 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 11.938271045684814
Epoch: 15, Steps: 32 | Train Loss: 15.216 Vali Loss: 122.873 Vali Acc: 0.550 Test Loss: 122.873 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 11.60582423210144
Epoch: 16, Steps: 32 | Train Loss: 20.299 Vali Loss: 211.100 Vali Acc: 0.237 Test Loss: 211.100 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 11.033434629440308
Epoch: 17, Steps: 32 | Train Loss: 12.071 Vali Loss: 159.930 Vali Acc: 0.542 Test Loss: 159.930 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 11.979259490966797
Epoch: 18, Steps: 32 | Train Loss: 5.353 Vali Loss: 161.832 Vali Acc: 0.344 Test Loss: 161.832 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 11.819830894470215
Epoch: 19, Steps: 32 | Train Loss: 2.042 Vali Loss: 127.573 Vali Acc: 0.550 Test Loss: 127.573 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 11648853
model size : 53.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.160603761672974
Epoch: 1, Steps: 32 | Train Loss: 13.452 Vali Loss: 22.711 Vali Acc: 0.466 Test Loss: 22.711 Test Acc: 0.466
Validation loss decreased (inf --> -0.465422).  Saving model ...
Epoch: 2 cost time: 10.966171979904175
Epoch: 2, Steps: 32 | Train Loss: 21.297 Vali Loss: 40.563 Vali Acc: 0.198 Test Loss: 40.563 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 11.122485399246216
Epoch: 3, Steps: 32 | Train Loss: 9.603 Vali Loss: 66.755 Vali Acc: 0.145 Test Loss: 66.755 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.718181133270264
Epoch: 4, Steps: 32 | Train Loss: 9.419 Vali Loss: 55.177 Vali Acc: 0.573 Test Loss: 55.177 Test Acc: 0.573
Validation loss decreased (-0.465422 --> -0.571967).  Saving model ...
Epoch: 5 cost time: 11.469237327575684
Epoch: 5, Steps: 32 | Train Loss: 18.663 Vali Loss: 86.292 Vali Acc: 0.458 Test Loss: 86.292 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.742665767669678
Epoch: 6, Steps: 32 | Train Loss: 14.515 Vali Loss: 89.324 Vali Acc: 0.511 Test Loss: 89.324 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 11.120821237564087
Epoch: 7, Steps: 32 | Train Loss: 16.479 Vali Loss: 59.638 Vali Acc: 0.435 Test Loss: 59.638 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 10.770916938781738
Epoch: 8, Steps: 32 | Train Loss: 13.904 Vali Loss: 102.142 Vali Acc: 0.382 Test Loss: 102.142 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 10.851382493972778
Epoch: 9, Steps: 32 | Train Loss: 17.938 Vali Loss: 58.436 Vali Acc: 0.397 Test Loss: 58.436 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 11.205595970153809
Epoch: 10, Steps: 32 | Train Loss: 17.393 Vali Loss: 90.090 Vali Acc: 0.435 Test Loss: 90.090 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 10.473259449005127
Epoch: 11, Steps: 32 | Train Loss: 30.737 Vali Loss: 111.527 Vali Acc: 0.489 Test Loss: 111.527 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 10.666075229644775
Epoch: 12, Steps: 32 | Train Loss: 5.969 Vali Loss: 97.545 Vali Acc: 0.504 Test Loss: 97.545 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 11.095361948013306
Epoch: 13, Steps: 32 | Train Loss: 1.951 Vali Loss: 78.902 Vali Acc: 0.618 Test Loss: 78.902 Test Acc: 0.618
Validation loss decreased (-0.571967 --> -0.617532).  Saving model ...
Epoch: 14 cost time: 10.986675024032593
Epoch: 14, Steps: 32 | Train Loss: 1.828 Vali Loss: 103.715 Vali Acc: 0.443 Test Loss: 103.715 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.890849351882935
Epoch: 15, Steps: 32 | Train Loss: 1.992 Vali Loss: 68.105 Vali Acc: 0.550 Test Loss: 68.105 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.04885220527649
Epoch: 16, Steps: 32 | Train Loss: 5.068 Vali Loss: 184.297 Vali Acc: 0.260 Test Loss: 184.297 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.356019258499146
Epoch: 17, Steps: 32 | Train Loss: 6.248 Vali Loss: 115.138 Vali Acc: 0.298 Test Loss: 115.138 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 10.759877681732178
Epoch: 18, Steps: 32 | Train Loss: 4.149 Vali Loss: 90.710 Vali Acc: 0.496 Test Loss: 90.710 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.29191541671753
Epoch: 19, Steps: 32 | Train Loss: 1.642 Vali Loss: 124.217 Vali Acc: 0.534 Test Loss: 124.217 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.573210954666138
Epoch: 20, Steps: 32 | Train Loss: 0.323 Vali Loss: 86.196 Vali Acc: 0.473 Test Loss: 86.196 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 10.839534759521484
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.919 Vali Acc: 0.473 Test Loss: 86.919 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.473915576934814
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.397 Vali Acc: 0.473 Test Loss: 86.397 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 11.210148334503174
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.377 Vali Acc: 0.473 Test Loss: 86.377 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 11648853
model size : 53.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.323618650436401
Epoch: 1, Steps: 32 | Train Loss: 14.161 Vali Loss: 29.923 Vali Acc: 0.450 Test Loss: 29.923 Test Acc: 0.450
Validation loss decreased (inf --> -0.450082).  Saving model ...
Epoch: 2 cost time: 10.396714925765991
Epoch: 2, Steps: 32 | Train Loss: 23.263 Vali Loss: 33.079 Vali Acc: 0.481 Test Loss: 33.079 Test Acc: 0.481
Validation loss decreased (-0.450082 --> -0.480585).  Saving model ...
Epoch: 3 cost time: 9.988467931747437
Epoch: 3, Steps: 32 | Train Loss: 12.878 Vali Loss: 61.605 Vali Acc: 0.344 Test Loss: 61.605 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.930283308029175
Epoch: 4, Steps: 32 | Train Loss: 22.774 Vali Loss: 36.876 Vali Acc: 0.489 Test Loss: 36.876 Test Acc: 0.489
Validation loss decreased (-0.480585 --> -0.488181).  Saving model ...
Epoch: 5 cost time: 10.232271671295166
Epoch: 5, Steps: 32 | Train Loss: 5.163 Vali Loss: 44.067 Vali Acc: 0.511 Test Loss: 44.067 Test Acc: 0.511
Validation loss decreased (-0.488181 --> -0.511010).  Saving model ...
Epoch: 6 cost time: 10.21291971206665
Epoch: 6, Steps: 32 | Train Loss: 19.402 Vali Loss: 56.936 Vali Acc: 0.374 Test Loss: 56.936 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.669912099838257
Epoch: 7, Steps: 32 | Train Loss: 43.415 Vali Loss: 128.674 Vali Acc: 0.244 Test Loss: 128.674 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.226857900619507
Epoch: 8, Steps: 32 | Train Loss: 49.313 Vali Loss: 95.814 Vali Acc: 0.466 Test Loss: 95.814 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.042739868164062
Epoch: 9, Steps: 32 | Train Loss: 11.430 Vali Loss: 95.656 Vali Acc: 0.565 Test Loss: 95.656 Test Acc: 0.565
Validation loss decreased (-0.511010 --> -0.563929).  Saving model ...
Epoch: 10 cost time: 9.659218788146973
Epoch: 10, Steps: 32 | Train Loss: 15.504 Vali Loss: 107.446 Vali Acc: 0.359 Test Loss: 107.446 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.986830234527588
Epoch: 11, Steps: 32 | Train Loss: 9.288 Vali Loss: 137.952 Vali Acc: 0.275 Test Loss: 137.952 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.716094493865967
Epoch: 12, Steps: 32 | Train Loss: 7.553 Vali Loss: 82.361 Vali Acc: 0.382 Test Loss: 82.361 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.349395275115967
Epoch: 13, Steps: 32 | Train Loss: 7.828 Vali Loss: 151.365 Vali Acc: 0.336 Test Loss: 151.365 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 9.615722894668579
Epoch: 14, Steps: 32 | Train Loss: 17.288 Vali Loss: 128.560 Vali Acc: 0.504 Test Loss: 128.560 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.571322441101074
Epoch: 15, Steps: 32 | Train Loss: 1.338 Vali Loss: 98.986 Vali Acc: 0.611 Test Loss: 98.986 Test Acc: 0.611
Validation loss decreased (-0.563929 --> -0.609697).  Saving model ...
Epoch: 16 cost time: 10.263318300247192
Epoch: 16, Steps: 32 | Train Loss: 4.448 Vali Loss: 83.915 Vali Acc: 0.504 Test Loss: 83.915 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.372168064117432
Epoch: 17, Steps: 32 | Train Loss: 10.284 Vali Loss: 86.893 Vali Acc: 0.481 Test Loss: 86.893 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.069928407669067
Epoch: 18, Steps: 32 | Train Loss: 1.278 Vali Loss: 91.227 Vali Acc: 0.603 Test Loss: 91.227 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.531487226486206
Epoch: 19, Steps: 32 | Train Loss: 4.056 Vali Loss: 97.484 Vali Acc: 0.420 Test Loss: 97.484 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 10.240004301071167
Epoch: 20, Steps: 32 | Train Loss: 0.979 Vali Loss: 132.985 Vali Acc: 0.473 Test Loss: 132.985 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.778425693511963
Epoch: 21, Steps: 32 | Train Loss: 2.253 Vali Loss: 111.441 Vali Acc: 0.435 Test Loss: 111.441 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.910866260528564
Epoch: 22, Steps: 32 | Train Loss: 1.232 Vali Loss: 114.447 Vali Acc: 0.427 Test Loss: 114.447 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 10.132070541381836
Epoch: 23, Steps: 32 | Train Loss: 1.005 Vali Loss: 111.057 Vali Acc: 0.473 Test Loss: 111.057 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.707990646362305
Epoch: 24, Steps: 32 | Train Loss: 1.168 Vali Loss: 102.293 Vali Acc: 0.481 Test Loss: 102.293 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.956762552261353
Epoch: 25, Steps: 32 | Train Loss: 3.969 Vali Loss: 118.584 Vali Acc: 0.450 Test Loss: 118.584 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 11648853
model size : 53.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.22069764137268
Epoch: 1, Steps: 32 | Train Loss: 13.549 Vali Loss: 24.761 Vali Acc: 0.473 Test Loss: 24.761 Test Acc: 0.473
Validation loss decreased (inf --> -0.473035).  Saving model ...
Epoch: 2 cost time: 9.06267499923706
Epoch: 2, Steps: 32 | Train Loss: 30.633 Vali Loss: 30.392 Vali Acc: 0.206 Test Loss: 30.392 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.08935284614563
Epoch: 3, Steps: 32 | Train Loss: 29.142 Vali Loss: 30.494 Vali Acc: 0.344 Test Loss: 30.494 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.062160730361938
Epoch: 4, Steps: 32 | Train Loss: 25.767 Vali Loss: 45.777 Vali Acc: 0.313 Test Loss: 45.777 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.570998668670654
Epoch: 5, Steps: 32 | Train Loss: 31.514 Vali Loss: 43.660 Vali Acc: 0.542 Test Loss: 43.660 Test Acc: 0.542
Validation loss decreased (-0.473035 --> -0.541548).  Saving model ...
Epoch: 6 cost time: 9.565960884094238
Epoch: 6, Steps: 32 | Train Loss: 33.275 Vali Loss: 37.959 Vali Acc: 0.374 Test Loss: 37.959 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.65444016456604
Epoch: 7, Steps: 32 | Train Loss: 21.234 Vali Loss: 81.121 Vali Acc: 0.534 Test Loss: 81.121 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.131479978561401
Epoch: 8, Steps: 32 | Train Loss: 29.379 Vali Loss: 101.519 Vali Acc: 0.466 Test Loss: 101.519 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.02698302268982
Epoch: 9, Steps: 32 | Train Loss: 17.842 Vali Loss: 105.118 Vali Acc: 0.557 Test Loss: 105.118 Test Acc: 0.557
Validation loss decreased (-0.541548 --> -0.556201).  Saving model ...
Epoch: 10 cost time: 9.381491661071777
Epoch: 10, Steps: 32 | Train Loss: 10.970 Vali Loss: 129.286 Vali Acc: 0.466 Test Loss: 129.286 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.994879722595215
Epoch: 11, Steps: 32 | Train Loss: 16.376 Vali Loss: 129.271 Vali Acc: 0.351 Test Loss: 129.271 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.81594705581665
Epoch: 12, Steps: 32 | Train Loss: 9.488 Vali Loss: 133.895 Vali Acc: 0.282 Test Loss: 133.895 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.067741394042969
Epoch: 13, Steps: 32 | Train Loss: 30.701 Vali Loss: 190.285 Vali Acc: 0.588 Test Loss: 190.285 Test Acc: 0.588
Validation loss decreased (-0.556201 --> -0.585883).  Saving model ...
Epoch: 14 cost time: 9.219353437423706
Epoch: 14, Steps: 32 | Train Loss: 17.584 Vali Loss: 200.975 Vali Acc: 0.374 Test Loss: 200.975 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.732796430587769
Epoch: 15, Steps: 32 | Train Loss: 4.286 Vali Loss: 104.445 Vali Acc: 0.618 Test Loss: 104.445 Test Acc: 0.618
Validation loss decreased (-0.585883 --> -0.617276).  Saving model ...
Epoch: 16 cost time: 8.916719913482666
Epoch: 16, Steps: 32 | Train Loss: 0.794 Vali Loss: 179.355 Vali Acc: 0.267 Test Loss: 179.355 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.791694164276123
Epoch: 17, Steps: 32 | Train Loss: 0.881 Vali Loss: 134.552 Vali Acc: 0.435 Test Loss: 134.552 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.568117380142212
Epoch: 18, Steps: 32 | Train Loss: 0.452 Vali Loss: 163.949 Vali Acc: 0.397 Test Loss: 163.949 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.950707197189331
Epoch: 19, Steps: 32 | Train Loss: 1.857 Vali Loss: 127.354 Vali Acc: 0.481 Test Loss: 127.354 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.973641633987427
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 139.199 Vali Acc: 0.534 Test Loss: 139.199 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.077643394470215
Epoch: 21, Steps: 32 | Train Loss: 1.893 Vali Loss: 232.574 Vali Acc: 0.229 Test Loss: 232.574 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.040034294128418
Epoch: 22, Steps: 32 | Train Loss: 5.865 Vali Loss: 120.800 Vali Acc: 0.542 Test Loss: 120.800 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.905757427215576
Epoch: 23, Steps: 32 | Train Loss: 0.654 Vali Loss: 157.693 Vali Acc: 0.580 Test Loss: 157.693 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.578754425048828
Epoch: 24, Steps: 32 | Train Loss: 4.220 Vali Loss: 196.420 Vali Acc: 0.275 Test Loss: 196.420 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.786093711853027
Epoch: 25, Steps: 32 | Train Loss: 2.100 Vali Loss: 170.354 Vali Acc: 0.427 Test Loss: 170.354 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 11648853
model size : 53.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.945188999176025
Epoch: 1, Steps: 32 | Train Loss: 12.752 Vali Loss: 27.725 Vali Acc: 0.176 Test Loss: 27.725 Test Acc: 0.176
Validation loss decreased (inf --> -0.175295).  Saving model ...
Epoch: 2 cost time: 10.705925226211548
Epoch: 2, Steps: 32 | Train Loss: 11.547 Vali Loss: 27.159 Vali Acc: 0.481 Test Loss: 27.159 Test Acc: 0.481
Validation loss decreased (-0.175295 --> -0.480644).  Saving model ...
Epoch: 3 cost time: 11.519877433776855
Epoch: 3, Steps: 32 | Train Loss: 18.425 Vali Loss: 30.186 Vali Acc: 0.519 Test Loss: 30.186 Test Acc: 0.519
Validation loss decreased (-0.480644 --> -0.518782).  Saving model ...
Epoch: 4 cost time: 11.271758317947388
Epoch: 4, Steps: 32 | Train Loss: 12.584 Vali Loss: 65.957 Vali Acc: 0.366 Test Loss: 65.957 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 11.380601644515991
Epoch: 5, Steps: 32 | Train Loss: 26.255 Vali Loss: 75.235 Vali Acc: 0.542 Test Loss: 75.235 Test Acc: 0.542
Validation loss decreased (-0.518782 --> -0.541232).  Saving model ...
Epoch: 6 cost time: 11.812859535217285
Epoch: 6, Steps: 32 | Train Loss: 16.779 Vali Loss: 76.193 Vali Acc: 0.504 Test Loss: 76.193 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 12.010217666625977
Epoch: 7, Steps: 32 | Train Loss: 8.429 Vali Loss: 71.956 Vali Acc: 0.580 Test Loss: 71.956 Test Acc: 0.580
Validation loss decreased (-0.541232 --> -0.579433).  Saving model ...
Epoch: 8 cost time: 11.393932819366455
Epoch: 8, Steps: 32 | Train Loss: 14.792 Vali Loss: 107.713 Vali Acc: 0.328 Test Loss: 107.713 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 11.774301528930664
Epoch: 9, Steps: 32 | Train Loss: 6.824 Vali Loss: 91.752 Vali Acc: 0.397 Test Loss: 91.752 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 11.17525315284729
Epoch: 10, Steps: 32 | Train Loss: 11.869 Vali Loss: 95.088 Vali Acc: 0.397 Test Loss: 95.088 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 11.385674476623535
Epoch: 11, Steps: 32 | Train Loss: 4.759 Vali Loss: 75.054 Vali Acc: 0.466 Test Loss: 75.054 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 11.225186109542847
Epoch: 12, Steps: 32 | Train Loss: 1.442 Vali Loss: 95.126 Vali Acc: 0.527 Test Loss: 95.126 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 11.030537605285645
Epoch: 13, Steps: 32 | Train Loss: 8.738 Vali Loss: 209.765 Vali Acc: 0.313 Test Loss: 209.765 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 11.644176483154297
Epoch: 14, Steps: 32 | Train Loss: 5.701 Vali Loss: 162.553 Vali Acc: 0.466 Test Loss: 162.553 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 11.627583980560303
Epoch: 15, Steps: 32 | Train Loss: 14.048 Vali Loss: 129.696 Vali Acc: 0.550 Test Loss: 129.696 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 11.05437684059143
Epoch: 16, Steps: 32 | Train Loss: 8.426 Vali Loss: 143.696 Vali Acc: 0.519 Test Loss: 143.696 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 11.444560289382935
Epoch: 17, Steps: 32 | Train Loss: 4.135 Vali Loss: 105.700 Vali Acc: 0.504 Test Loss: 105.700 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 11616085
model size : 53.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.78677248954773
Epoch: 1, Steps: 32 | Train Loss: 11.503 Vali Loss: 12.803 Vali Acc: 0.198 Test Loss: 12.803 Test Acc: 0.198
Validation loss decreased (inf --> -0.198345).  Saving model ...
Epoch: 2 cost time: 10.508385181427002
Epoch: 2, Steps: 32 | Train Loss: 11.935 Vali Loss: 17.037 Vali Acc: 0.237 Test Loss: 17.037 Test Acc: 0.237
Validation loss decreased (-0.198345 --> -0.236471).  Saving model ...
Epoch: 3 cost time: 10.268345594406128
Epoch: 3, Steps: 32 | Train Loss: 16.272 Vali Loss: 50.560 Vali Acc: 0.214 Test Loss: 50.560 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.70682168006897
Epoch: 4, Steps: 32 | Train Loss: 43.669 Vali Loss: 150.270 Vali Acc: 0.183 Test Loss: 150.270 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.792833089828491
Epoch: 5, Steps: 32 | Train Loss: 29.630 Vali Loss: 116.125 Vali Acc: 0.244 Test Loss: 116.125 Test Acc: 0.244
Validation loss decreased (-0.236471 --> -0.243114).  Saving model ...
Epoch: 6 cost time: 10.188590049743652
Epoch: 6, Steps: 32 | Train Loss: 19.484 Vali Loss: 76.372 Vali Acc: 0.557 Test Loss: 76.372 Test Acc: 0.557
Validation loss decreased (-0.243114 --> -0.556488).  Saving model ...
Epoch: 7 cost time: 10.796877145767212
Epoch: 7, Steps: 32 | Train Loss: 9.806 Vali Loss: 71.899 Vali Acc: 0.542 Test Loss: 71.899 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 10.988977193832397
Epoch: 8, Steps: 32 | Train Loss: 6.304 Vali Loss: 61.894 Vali Acc: 0.542 Test Loss: 61.894 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 10.422093868255615
Epoch: 9, Steps: 32 | Train Loss: 5.177 Vali Loss: 72.866 Vali Acc: 0.519 Test Loss: 72.866 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 11.132917404174805
Epoch: 10, Steps: 32 | Train Loss: 10.328 Vali Loss: 120.624 Vali Acc: 0.450 Test Loss: 120.624 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 10.674180746078491
Epoch: 11, Steps: 32 | Train Loss: 42.623 Vali Loss: 179.081 Vali Acc: 0.290 Test Loss: 179.081 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 10.78931474685669
Epoch: 12, Steps: 32 | Train Loss: 16.692 Vali Loss: 142.862 Vali Acc: 0.511 Test Loss: 142.862 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 11.079384803771973
Epoch: 13, Steps: 32 | Train Loss: 1.480 Vali Loss: 151.124 Vali Acc: 0.420 Test Loss: 151.124 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 10.45466947555542
Epoch: 14, Steps: 32 | Train Loss: 20.833 Vali Loss: 140.522 Vali Acc: 0.405 Test Loss: 140.522 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 10.84241008758545
Epoch: 15, Steps: 32 | Train Loss: 4.735 Vali Loss: 168.619 Vali Acc: 0.305 Test Loss: 168.619 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 11.049748420715332
Epoch: 16, Steps: 32 | Train Loss: 2.850 Vali Loss: 132.827 Vali Acc: 0.527 Test Loss: 132.827 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 11616085
model size : 53.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.86379623413086
Epoch: 1, Steps: 32 | Train Loss: 11.264 Vali Loss: 17.315 Vali Acc: 0.313 Test Loss: 17.315 Test Acc: 0.313
Validation loss decreased (inf --> -0.312804).  Saving model ...
Epoch: 2 cost time: 9.886451244354248
Epoch: 2, Steps: 32 | Train Loss: 24.482 Vali Loss: 16.876 Vali Acc: 0.496 Test Loss: 16.876 Test Acc: 0.496
Validation loss decreased (-0.312804 --> -0.496014).  Saving model ...
Epoch: 3 cost time: 9.374200105667114
Epoch: 3, Steps: 32 | Train Loss: 15.874 Vali Loss: 72.918 Vali Acc: 0.275 Test Loss: 72.918 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.419420003890991
Epoch: 4, Steps: 32 | Train Loss: 12.663 Vali Loss: 79.885 Vali Acc: 0.275 Test Loss: 79.885 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.290626525878906
Epoch: 5, Steps: 32 | Train Loss: 24.933 Vali Loss: 98.274 Vali Acc: 0.344 Test Loss: 98.274 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.219439506530762
Epoch: 6, Steps: 32 | Train Loss: 24.324 Vali Loss: 69.482 Vali Acc: 0.435 Test Loss: 69.482 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.32655119895935
Epoch: 7, Steps: 32 | Train Loss: 13.416 Vali Loss: 90.311 Vali Acc: 0.435 Test Loss: 90.311 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.126180410385132
Epoch: 8, Steps: 32 | Train Loss: 12.793 Vali Loss: 85.813 Vali Acc: 0.321 Test Loss: 85.813 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.117833375930786
Epoch: 9, Steps: 32 | Train Loss: 13.333 Vali Loss: 72.391 Vali Acc: 0.405 Test Loss: 72.391 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 9.538496494293213
Epoch: 10, Steps: 32 | Train Loss: 27.445 Vali Loss: 92.140 Vali Acc: 0.466 Test Loss: 92.140 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 9.47510838508606
Epoch: 11, Steps: 32 | Train Loss: 9.816 Vali Loss: 159.018 Vali Acc: 0.382 Test Loss: 159.018 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 9.842085123062134
Epoch: 12, Steps: 32 | Train Loss: 3.905 Vali Loss: 82.620 Vali Acc: 0.550 Test Loss: 82.620 Test Acc: 0.550
Validation loss decreased (-0.496014 --> -0.548792).  Saving model ...
Epoch: 13 cost time: 9.24136209487915
Epoch: 13, Steps: 32 | Train Loss: 3.150 Vali Loss: 73.119 Vali Acc: 0.588 Test Loss: 73.119 Test Acc: 0.588
Validation loss decreased (-0.548792 --> -0.587055).  Saving model ...
Epoch: 14 cost time: 9.881238222122192
Epoch: 14, Steps: 32 | Train Loss: 3.541 Vali Loss: 53.997 Vali Acc: 0.634 Test Loss: 53.997 Test Acc: 0.634
Validation loss decreased (-0.587055 --> -0.633048).  Saving model ...
Epoch: 15 cost time: 9.915191173553467
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 70.013 Vali Acc: 0.595 Test Loss: 70.013 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.796969175338745
Epoch: 16, Steps: 32 | Train Loss: 1.795 Vali Loss: 60.423 Vali Acc: 0.611 Test Loss: 60.423 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.896391153335571
Epoch: 17, Steps: 32 | Train Loss: 2.883 Vali Loss: 82.291 Vali Acc: 0.389 Test Loss: 82.291 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 9.663305759429932
Epoch: 18, Steps: 32 | Train Loss: 20.389 Vali Loss: 111.920 Vali Acc: 0.466 Test Loss: 111.920 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.2684326171875
Epoch: 19, Steps: 32 | Train Loss: 16.687 Vali Loss: 128.675 Vali Acc: 0.443 Test Loss: 128.675 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.84707522392273
Epoch: 20, Steps: 32 | Train Loss: 1.742 Vali Loss: 232.142 Vali Acc: 0.595 Test Loss: 232.142 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 9.7544264793396
Epoch: 21, Steps: 32 | Train Loss: 3.657 Vali Loss: 348.138 Vali Acc: 0.282 Test Loss: 348.138 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 8.822940587997437
Epoch: 22, Steps: 32 | Train Loss: 5.365 Vali Loss: 268.043 Vali Acc: 0.534 Test Loss: 268.043 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.60871148109436
Epoch: 23, Steps: 32 | Train Loss: 2.353 Vali Loss: 263.783 Vali Acc: 0.481 Test Loss: 263.783 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.364980459213257
Epoch: 24, Steps: 32 | Train Loss: 2.784 Vali Loss: 232.443 Vali Acc: 0.557 Test Loss: 232.443 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 11616085
model size : 53.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.758008003234863
Epoch: 1, Steps: 32 | Train Loss: 13.848 Vali Loss: 21.895 Vali Acc: 0.176 Test Loss: 21.895 Test Acc: 0.176
Validation loss decreased (inf --> -0.175354).  Saving model ...
Epoch: 2 cost time: 8.864695310592651
Epoch: 2, Steps: 32 | Train Loss: 17.085 Vali Loss: 16.659 Vali Acc: 0.443 Test Loss: 16.659 Test Acc: 0.443
Validation loss decreased (-0.175354 --> -0.442582).  Saving model ...
Epoch: 3 cost time: 8.57027292251587
Epoch: 3, Steps: 32 | Train Loss: 24.485 Vali Loss: 78.694 Vali Acc: 0.198 Test Loss: 78.694 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.919972658157349
Epoch: 4, Steps: 32 | Train Loss: 37.002 Vali Loss: 54.279 Vali Acc: 0.328 Test Loss: 54.279 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.927013874053955
Epoch: 5, Steps: 32 | Train Loss: 26.564 Vali Loss: 56.874 Vali Acc: 0.489 Test Loss: 56.874 Test Acc: 0.489
Validation loss decreased (-0.442582 --> -0.487981).  Saving model ...
Epoch: 6 cost time: 8.044164657592773
Epoch: 6, Steps: 32 | Train Loss: 50.106 Vali Loss: 87.520 Vali Acc: 0.298 Test Loss: 87.520 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.967615842819214
Epoch: 7, Steps: 32 | Train Loss: 53.044 Vali Loss: 44.849 Vali Acc: 0.351 Test Loss: 44.849 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.660828351974487
Epoch: 8, Steps: 32 | Train Loss: 18.806 Vali Loss: 116.508 Vali Acc: 0.237 Test Loss: 116.508 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.591517686843872
Epoch: 9, Steps: 32 | Train Loss: 15.305 Vali Loss: 140.859 Vali Acc: 0.221 Test Loss: 140.859 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.241329908370972
Epoch: 10, Steps: 32 | Train Loss: 4.605 Vali Loss: 61.861 Vali Acc: 0.397 Test Loss: 61.861 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 8.952458620071411
Epoch: 11, Steps: 32 | Train Loss: 14.801 Vali Loss: 141.848 Vali Acc: 0.260 Test Loss: 141.848 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 8.894367933273315
Epoch: 12, Steps: 32 | Train Loss: 21.332 Vali Loss: 178.155 Vali Acc: 0.237 Test Loss: 178.155 Test Acc: 0.237
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.481467485427856
Epoch: 13, Steps: 32 | Train Loss: 8.585 Vali Loss: 161.249 Vali Acc: 0.275 Test Loss: 161.249 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 8.941250562667847
Epoch: 14, Steps: 32 | Train Loss: 10.186 Vali Loss: 86.835 Vali Acc: 0.450 Test Loss: 86.835 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 8.689947128295898
Epoch: 15, Steps: 32 | Train Loss: 3.792 Vali Loss: 69.940 Vali Acc: 0.534 Test Loss: 69.940 Test Acc: 0.534
Validation loss decreased (-0.487981 --> -0.533652).  Saving model ...
Epoch: 16 cost time: 8.350868463516235
Epoch: 16, Steps: 32 | Train Loss: 3.165 Vali Loss: 141.500 Vali Acc: 0.405 Test Loss: 141.500 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.449398040771484
Epoch: 17, Steps: 32 | Train Loss: 3.332 Vali Loss: 116.905 Vali Acc: 0.473 Test Loss: 116.905 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.139896869659424
Epoch: 18, Steps: 32 | Train Loss: 4.106 Vali Loss: 89.423 Vali Acc: 0.595 Test Loss: 89.423 Test Acc: 0.595
Validation loss decreased (-0.533652 --> -0.594526).  Saving model ...
Epoch: 19 cost time: 8.450944662094116
Epoch: 19, Steps: 32 | Train Loss: 9.180 Vali Loss: 101.573 Vali Acc: 0.618 Test Loss: 101.573 Test Acc: 0.618
Validation loss decreased (-0.594526 --> -0.617305).  Saving model ...
Epoch: 20 cost time: 8.60947585105896
Epoch: 20, Steps: 32 | Train Loss: 0.596 Vali Loss: 95.773 Vali Acc: 0.641 Test Loss: 95.773 Test Acc: 0.641
Validation loss decreased (-0.617305 --> -0.640264).  Saving model ...
Epoch: 21 cost time: 9.189387321472168
Epoch: 21, Steps: 32 | Train Loss: 4.666 Vali Loss: 143.920 Vali Acc: 0.527 Test Loss: 143.920 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.135972023010254
Epoch: 22, Steps: 32 | Train Loss: 2.965 Vali Loss: 110.646 Vali Acc: 0.611 Test Loss: 110.646 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.909133672714233
Epoch: 23, Steps: 32 | Train Loss: 1.701 Vali Loss: 130.801 Vali Acc: 0.557 Test Loss: 130.801 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.696185111999512
Epoch: 24, Steps: 32 | Train Loss: 3.993 Vali Loss: 125.568 Vali Acc: 0.588 Test Loss: 125.568 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.250298023223877
Epoch: 25, Steps: 32 | Train Loss: 0.616 Vali Loss: 121.663 Vali Acc: 0.641 Test Loss: 121.663 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.9675612449646
Epoch: 26, Steps: 32 | Train Loss: 1.163 Vali Loss: 122.595 Vali Acc: 0.618 Test Loss: 122.595 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.304575443267822
Epoch: 27, Steps: 32 | Train Loss: 0.545 Vali Loss: 174.691 Vali Acc: 0.336 Test Loss: 174.691 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.181679248809814
Epoch: 28, Steps: 32 | Train Loss: 0.721 Vali Loss: 239.304 Vali Acc: 0.237 Test Loss: 239.304 Test Acc: 0.237
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.76958417892456
Epoch: 29, Steps: 32 | Train Loss: 0.710 Vali Loss: 148.531 Vali Acc: 0.496 Test Loss: 148.531 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.062753200531006
Epoch: 30, Steps: 32 | Train Loss: 3.213 Vali Loss: 279.789 Vali Acc: 0.443 Test Loss: 279.789 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 11616085
model size : 53.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.967679500579834
Epoch: 1, Steps: 32 | Train Loss: 11.478 Vali Loss: 11.332 Vali Acc: 0.267 Test Loss: 11.332 Test Acc: 0.267
Validation loss decreased (inf --> -0.267062).  Saving model ...
Epoch: 2 cost time: 8.768832206726074
Epoch: 2, Steps: 32 | Train Loss: 7.618 Vali Loss: 16.233 Vali Acc: 0.344 Test Loss: 16.233 Test Acc: 0.344
Validation loss decreased (-0.267062 --> -0.343349).  Saving model ...
Epoch: 3 cost time: 8.309560775756836
Epoch: 3, Steps: 32 | Train Loss: 8.852 Vali Loss: 21.475 Vali Acc: 0.534 Test Loss: 21.475 Test Acc: 0.534
Validation loss decreased (-0.343349 --> -0.534136).  Saving model ...
Epoch: 4 cost time: 8.302895307540894
Epoch: 4, Steps: 32 | Train Loss: 7.840 Vali Loss: 11.655 Vali Acc: 0.557 Test Loss: 11.655 Test Acc: 0.557
Validation loss decreased (-0.534136 --> -0.557135).  Saving model ...
Epoch: 5 cost time: 8.694213390350342
Epoch: 5, Steps: 32 | Train Loss: 7.397 Vali Loss: 61.868 Vali Acc: 0.321 Test Loss: 61.868 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.482681274414062
Epoch: 6, Steps: 32 | Train Loss: 8.571 Vali Loss: 80.421 Vali Acc: 0.176 Test Loss: 80.421 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.389665126800537
Epoch: 7, Steps: 32 | Train Loss: 6.601 Vali Loss: 71.603 Vali Acc: 0.481 Test Loss: 71.603 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 8.308435678482056
Epoch: 8, Steps: 32 | Train Loss: 11.026 Vali Loss: 43.867 Vali Acc: 0.458 Test Loss: 43.867 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.234103441238403
Epoch: 9, Steps: 32 | Train Loss: 5.897 Vali Loss: 53.154 Vali Acc: 0.282 Test Loss: 53.154 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.20107626914978
Epoch: 10, Steps: 32 | Train Loss: 4.940 Vali Loss: 38.433 Vali Acc: 0.427 Test Loss: 38.433 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 8.155944347381592
Epoch: 11, Steps: 32 | Train Loss: 1.159 Vali Loss: 54.066 Vali Acc: 0.366 Test Loss: 54.066 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 8.192371129989624
Epoch: 12, Steps: 32 | Train Loss: 5.961 Vali Loss: 39.421 Vali Acc: 0.412 Test Loss: 39.421 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.433123111724854
Epoch: 13, Steps: 32 | Train Loss: 2.455 Vali Loss: 50.171 Vali Acc: 0.397 Test Loss: 50.171 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 8.943808317184448
Epoch: 14, Steps: 32 | Train Loss: 3.690 Vali Loss: 71.962 Vali Acc: 0.519 Test Loss: 71.962 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 6299605
model size : 28.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.570401668548584
Epoch: 1, Steps: 32 | Train Loss: 9.879 Vali Loss: 11.693 Vali Acc: 0.458 Test Loss: 11.693 Test Acc: 0.458
Validation loss decreased (inf --> -0.457898).  Saving model ...
Epoch: 2 cost time: 7.986713171005249
Epoch: 2, Steps: 32 | Train Loss: 8.016 Vali Loss: 33.537 Vali Acc: 0.221 Test Loss: 33.537 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.762284755706787
Epoch: 3, Steps: 32 | Train Loss: 7.374 Vali Loss: 7.709 Vali Acc: 0.458 Test Loss: 7.709 Test Acc: 0.458
Validation loss decreased (-0.457898 --> -0.457938).  Saving model ...
Epoch: 4 cost time: 7.4761435985565186
Epoch: 4, Steps: 32 | Train Loss: 8.821 Vali Loss: 51.440 Vali Acc: 0.198 Test Loss: 51.440 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.975299596786499
Epoch: 5, Steps: 32 | Train Loss: 12.758 Vali Loss: 46.141 Vali Acc: 0.298 Test Loss: 46.141 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.109062194824219
Epoch: 6, Steps: 32 | Train Loss: 11.386 Vali Loss: 61.769 Vali Acc: 0.305 Test Loss: 61.769 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.321108341217041
Epoch: 7, Steps: 32 | Train Loss: 5.143 Vali Loss: 46.675 Vali Acc: 0.435 Test Loss: 46.675 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.902643918991089
Epoch: 8, Steps: 32 | Train Loss: 5.992 Vali Loss: 46.047 Vali Acc: 0.496 Test Loss: 46.047 Test Acc: 0.496
Validation loss decreased (-0.457938 --> -0.495723).  Saving model ...
Epoch: 9 cost time: 8.540613412857056
Epoch: 9, Steps: 32 | Train Loss: 4.682 Vali Loss: 41.461 Vali Acc: 0.450 Test Loss: 41.461 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.140312910079956
Epoch: 10, Steps: 32 | Train Loss: 3.264 Vali Loss: 56.746 Vali Acc: 0.397 Test Loss: 56.746 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.437545299530029
Epoch: 11, Steps: 32 | Train Loss: 7.290 Vali Loss: 65.825 Vali Acc: 0.344 Test Loss: 65.825 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.832632780075073
Epoch: 12, Steps: 32 | Train Loss: 13.779 Vali Loss: 29.514 Vali Acc: 0.527 Test Loss: 29.514 Test Acc: 0.527
Validation loss decreased (-0.495723 --> -0.526422).  Saving model ...
Epoch: 13 cost time: 8.209901809692383
Epoch: 13, Steps: 32 | Train Loss: 9.831 Vali Loss: 55.708 Vali Acc: 0.351 Test Loss: 55.708 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.985668420791626
Epoch: 14, Steps: 32 | Train Loss: 3.028 Vali Loss: 93.235 Vali Acc: 0.313 Test Loss: 93.235 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.5703113079071045
Epoch: 15, Steps: 32 | Train Loss: 7.399 Vali Loss: 47.680 Vali Acc: 0.511 Test Loss: 47.680 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.854178667068481
Epoch: 16, Steps: 32 | Train Loss: 6.754 Vali Loss: 121.880 Vali Acc: 0.511 Test Loss: 121.880 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.46707558631897
Epoch: 17, Steps: 32 | Train Loss: 9.185 Vali Loss: 85.927 Vali Acc: 0.382 Test Loss: 85.927 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.84101676940918
Epoch: 18, Steps: 32 | Train Loss: 3.734 Vali Loss: 81.809 Vali Acc: 0.519 Test Loss: 81.809 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.817815780639648
Epoch: 19, Steps: 32 | Train Loss: 0.913 Vali Loss: 71.169 Vali Acc: 0.573 Test Loss: 71.169 Test Acc: 0.573
Validation loss decreased (-0.526422 --> -0.571807).  Saving model ...
Epoch: 20 cost time: 8.290234565734863
Epoch: 20, Steps: 32 | Train Loss: 0.375 Vali Loss: 74.068 Vali Acc: 0.450 Test Loss: 74.068 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.864489316940308
Epoch: 21, Steps: 32 | Train Loss: 0.688 Vali Loss: 79.282 Vali Acc: 0.580 Test Loss: 79.282 Test Acc: 0.580
Validation loss decreased (-0.571807 --> -0.579360).  Saving model ...
Epoch: 22 cost time: 8.03185224533081
Epoch: 22, Steps: 32 | Train Loss: 2.397 Vali Loss: 119.928 Vali Acc: 0.389 Test Loss: 119.928 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.054914951324463
Epoch: 23, Steps: 32 | Train Loss: 3.568 Vali Loss: 69.133 Vali Acc: 0.542 Test Loss: 69.133 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.47673487663269
Epoch: 24, Steps: 32 | Train Loss: 0.793 Vali Loss: 71.219 Vali Acc: 0.588 Test Loss: 71.219 Test Acc: 0.588
Validation loss decreased (-0.579360 --> -0.587074).  Saving model ...
Epoch: 25 cost time: 7.694395065307617
Epoch: 25, Steps: 32 | Train Loss: 2.330 Vali Loss: 97.502 Vali Acc: 0.336 Test Loss: 97.502 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.437448501586914
Epoch: 26, Steps: 32 | Train Loss: 2.985 Vali Loss: 73.635 Vali Acc: 0.595 Test Loss: 73.635 Test Acc: 0.595
Validation loss decreased (-0.587074 --> -0.594683).  Saving model ...
Epoch: 27 cost time: 8.632066011428833
Epoch: 27, Steps: 32 | Train Loss: 0.311 Vali Loss: 90.442 Vali Acc: 0.496 Test Loss: 90.442 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.634551286697388
Epoch: 28, Steps: 32 | Train Loss: 1.310 Vali Loss: 86.813 Vali Acc: 0.496 Test Loss: 86.813 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 8.043570041656494
Epoch: 29, Steps: 32 | Train Loss: 0.454 Vali Loss: 126.380 Vali Acc: 0.534 Test Loss: 126.380 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 8.026552438735962
Epoch: 30, Steps: 32 | Train Loss: 1.029 Vali Loss: 88.902 Vali Acc: 0.420 Test Loss: 88.902 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 7.975402355194092
Epoch: 31, Steps: 32 | Train Loss: 0.066 Vali Loss: 79.251 Vali Acc: 0.557 Test Loss: 79.251 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 7.559016227722168
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.856 Vali Acc: 0.489 Test Loss: 81.856 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 8.02955174446106
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.948 Vali Acc: 0.489 Test Loss: 81.948 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 8.159318923950195
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.960 Vali Acc: 0.489 Test Loss: 81.960 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.839351654052734
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.960 Vali Acc: 0.489 Test Loss: 81.960 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 8.37455701828003
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.960 Vali Acc: 0.489 Test Loss: 81.960 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 6299605
model size : 28.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.492751121520996
Epoch: 1, Steps: 32 | Train Loss: 8.104 Vali Loss: 4.551 Vali Acc: 0.504 Test Loss: 4.551 Test Acc: 0.504
Validation loss decreased (inf --> -0.503771).  Saving model ...
Epoch: 2 cost time: 7.029376745223999
Epoch: 2, Steps: 32 | Train Loss: 8.353 Vali Loss: 38.059 Vali Acc: 0.206 Test Loss: 38.059 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.696191072463989
Epoch: 3, Steps: 32 | Train Loss: 12.998 Vali Loss: 26.284 Vali Acc: 0.466 Test Loss: 26.284 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.513397216796875
Epoch: 4, Steps: 32 | Train Loss: 9.045 Vali Loss: 14.422 Vali Acc: 0.466 Test Loss: 14.422 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.282398462295532
Epoch: 5, Steps: 32 | Train Loss: 6.846 Vali Loss: 28.050 Vali Acc: 0.366 Test Loss: 28.050 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.0577616691589355
Epoch: 6, Steps: 32 | Train Loss: 14.072 Vali Loss: 74.545 Vali Acc: 0.107 Test Loss: 74.545 Test Acc: 0.107
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 8.016016483306885
Epoch: 7, Steps: 32 | Train Loss: 11.855 Vali Loss: 46.546 Vali Acc: 0.496 Test Loss: 46.546 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 7.741379737854004
Epoch: 8, Steps: 32 | Train Loss: 8.589 Vali Loss: 69.200 Vali Acc: 0.267 Test Loss: 69.200 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 6.991058349609375
Epoch: 9, Steps: 32 | Train Loss: 11.144 Vali Loss: 42.916 Vali Acc: 0.420 Test Loss: 42.916 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 7.441850662231445
Epoch: 10, Steps: 32 | Train Loss: 12.214 Vali Loss: 57.565 Vali Acc: 0.305 Test Loss: 57.565 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 7.344461441040039
Epoch: 11, Steps: 32 | Train Loss: 2.377 Vali Loss: 46.076 Vali Acc: 0.382 Test Loss: 46.076 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 6299605
model size : 28.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.216402769088745
Epoch: 1, Steps: 32 | Train Loss: 7.955 Vali Loss: 6.346 Vali Acc: 0.198 Test Loss: 6.346 Test Acc: 0.198
Validation loss decreased (inf --> -0.198410).  Saving model ...
Epoch: 2 cost time: 7.163318395614624
Epoch: 2, Steps: 32 | Train Loss: 12.041 Vali Loss: 32.234 Vali Acc: 0.214 Test Loss: 32.234 Test Acc: 0.214
Validation loss decreased (-0.198410 --> -0.213418).  Saving model ...
Epoch: 3 cost time: 6.932363510131836
Epoch: 3, Steps: 32 | Train Loss: 10.893 Vali Loss: 16.027 Vali Acc: 0.580 Test Loss: 16.027 Test Acc: 0.580
Validation loss decreased (-0.213418 --> -0.579992).  Saving model ...
Epoch: 4 cost time: 7.0971527099609375
Epoch: 4, Steps: 32 | Train Loss: 23.500 Vali Loss: 22.021 Vali Acc: 0.221 Test Loss: 22.021 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.057947874069214
Epoch: 5, Steps: 32 | Train Loss: 18.072 Vali Loss: 29.921 Vali Acc: 0.305 Test Loss: 29.921 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.712712049484253
Epoch: 6, Steps: 32 | Train Loss: 20.923 Vali Loss: 39.597 Vali Acc: 0.328 Test Loss: 39.597 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.89438271522522
Epoch: 7, Steps: 32 | Train Loss: 12.042 Vali Loss: 20.196 Vali Acc: 0.580 Test Loss: 20.196 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.028093338012695
Epoch: 8, Steps: 32 | Train Loss: 7.935 Vali Loss: 29.481 Vali Acc: 0.374 Test Loss: 29.481 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.877634525299072
Epoch: 9, Steps: 32 | Train Loss: 4.626 Vali Loss: 22.569 Vali Acc: 0.504 Test Loss: 22.569 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.201046943664551
Epoch: 10, Steps: 32 | Train Loss: 7.517 Vali Loss: 51.025 Vali Acc: 0.305 Test Loss: 51.025 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.402728080749512
Epoch: 11, Steps: 32 | Train Loss: 7.809 Vali Loss: 43.782 Vali Acc: 0.282 Test Loss: 43.782 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.506464242935181
Epoch: 12, Steps: 32 | Train Loss: 3.530 Vali Loss: 40.751 Vali Acc: 0.382 Test Loss: 40.751 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.945845603942871
Epoch: 13, Steps: 32 | Train Loss: 1.271 Vali Loss: 33.429 Vali Acc: 0.511 Test Loss: 33.429 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5801526717557252
model parameter : 6299605
model size : 28.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.405828714370728
Epoch: 1, Steps: 32 | Train Loss: 7.993 Vali Loss: 9.169 Vali Acc: 0.412 Test Loss: 9.169 Test Acc: 0.412
Validation loss decreased (inf --> -0.412122).  Saving model ...
Epoch: 2 cost time: 7.523740530014038
Epoch: 2, Steps: 32 | Train Loss: 8.834 Vali Loss: 13.597 Vali Acc: 0.260 Test Loss: 13.597 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.176966905593872
Epoch: 3, Steps: 32 | Train Loss: 4.343 Vali Loss: 25.070 Vali Acc: 0.282 Test Loss: 25.070 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.004875659942627
Epoch: 4, Steps: 32 | Train Loss: 7.814 Vali Loss: 22.715 Vali Acc: 0.244 Test Loss: 22.715 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 7.635258436203003
Epoch: 5, Steps: 32 | Train Loss: 5.056 Vali Loss: 58.237 Vali Acc: 0.359 Test Loss: 58.237 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.759572505950928
Epoch: 6, Steps: 32 | Train Loss: 6.181 Vali Loss: 60.885 Vali Acc: 0.382 Test Loss: 60.885 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 7.911787748336792
Epoch: 7, Steps: 32 | Train Loss: 12.743 Vali Loss: 67.196 Vali Acc: 0.504 Test Loss: 67.196 Test Acc: 0.504
Validation loss decreased (-0.412122 --> -0.503145).  Saving model ...
Epoch: 8 cost time: 7.810529470443726
Epoch: 8, Steps: 32 | Train Loss: 1.160 Vali Loss: 67.621 Vali Acc: 0.344 Test Loss: 67.621 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.568910837173462
Epoch: 9, Steps: 32 | Train Loss: 8.438 Vali Loss: 91.529 Vali Acc: 0.298 Test Loss: 91.529 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.953016757965088
Epoch: 10, Steps: 32 | Train Loss: 11.056 Vali Loss: 75.003 Vali Acc: 0.305 Test Loss: 75.003 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.386556625366211
Epoch: 11, Steps: 32 | Train Loss: 4.880 Vali Loss: 61.016 Vali Acc: 0.366 Test Loss: 61.016 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 8.507307291030884
Epoch: 12, Steps: 32 | Train Loss: 6.298 Vali Loss: 50.109 Vali Acc: 0.481 Test Loss: 50.109 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.512314319610596
Epoch: 13, Steps: 32 | Train Loss: 2.602 Vali Loss: 50.920 Vali Acc: 0.504 Test Loss: 50.920 Test Acc: 0.504
Validation loss decreased (-0.503145 --> -0.503308).  Saving model ...
Epoch: 14 cost time: 7.893754720687866
Epoch: 14, Steps: 32 | Train Loss: 1.860 Vali Loss: 44.903 Vali Acc: 0.420 Test Loss: 44.903 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.5481743812561035
Epoch: 15, Steps: 32 | Train Loss: 3.695 Vali Loss: 53.445 Vali Acc: 0.458 Test Loss: 53.445 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.470010995864868
Epoch: 16, Steps: 32 | Train Loss: 0.518 Vali Loss: 71.222 Vali Acc: 0.351 Test Loss: 71.222 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.430551052093506
Epoch: 17, Steps: 32 | Train Loss: 0.970 Vali Loss: 62.693 Vali Acc: 0.351 Test Loss: 62.693 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.4399802684783936
Epoch: 18, Steps: 32 | Train Loss: 2.770 Vali Loss: 68.500 Vali Acc: 0.351 Test Loss: 68.500 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.721824645996094
Epoch: 19, Steps: 32 | Train Loss: 3.444 Vali Loss: 78.317 Vali Acc: 0.427 Test Loss: 78.317 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.4800732135772705
Epoch: 20, Steps: 32 | Train Loss: 6.307 Vali Loss: 125.143 Vali Acc: 0.252 Test Loss: 125.143 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.709100961685181
Epoch: 21, Steps: 32 | Train Loss: 6.413 Vali Loss: 127.414 Vali Acc: 0.351 Test Loss: 127.414 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.806355953216553
Epoch: 22, Steps: 32 | Train Loss: 6.798 Vali Loss: 116.950 Vali Acc: 0.511 Test Loss: 116.950 Test Acc: 0.511
Validation loss decreased (-0.503308 --> -0.510281).  Saving model ...
Epoch: 23 cost time: 7.416949987411499
Epoch: 23, Steps: 32 | Train Loss: 2.854 Vali Loss: 107.444 Vali Acc: 0.374 Test Loss: 107.444 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.747025012969971
Epoch: 24, Steps: 32 | Train Loss: 0.787 Vali Loss: 106.713 Vali Acc: 0.405 Test Loss: 106.713 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 7.911529779434204
Epoch: 25, Steps: 32 | Train Loss: 1.285 Vali Loss: 111.057 Vali Acc: 0.435 Test Loss: 111.057 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.449789047241211
Epoch: 26, Steps: 32 | Train Loss: 4.283 Vali Loss: 105.396 Vali Acc: 0.382 Test Loss: 105.396 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.928761005401611
Epoch: 27, Steps: 32 | Train Loss: 2.383 Vali Loss: 84.359 Vali Acc: 0.504 Test Loss: 84.359 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 7.4064881801605225
Epoch: 28, Steps: 32 | Train Loss: 0.507 Vali Loss: 99.799 Vali Acc: 0.405 Test Loss: 99.799 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.731954574584961
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 98.611 Vali Acc: 0.496 Test Loss: 98.611 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.306262731552124
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.926 Vali Acc: 0.496 Test Loss: 97.926 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 7.399726390838623
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.918 Vali Acc: 0.496 Test Loss: 97.918 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 7.29135799407959
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.918 Vali Acc: 0.496 Test Loss: 97.918 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 6037461
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.8990089893341064
Epoch: 1, Steps: 32 | Train Loss: 9.128 Vali Loss: 16.641 Vali Acc: 0.244 Test Loss: 16.641 Test Acc: 0.244
Validation loss decreased (inf --> -0.244108).  Saving model ...
Epoch: 2 cost time: 7.210646152496338
Epoch: 2, Steps: 32 | Train Loss: 13.251 Vali Loss: 21.992 Vali Acc: 0.282 Test Loss: 21.992 Test Acc: 0.282
Validation loss decreased (-0.244108 --> -0.282223).  Saving model ...
Epoch: 3 cost time: 6.574710130691528
Epoch: 3, Steps: 32 | Train Loss: 13.233 Vali Loss: 10.199 Vali Acc: 0.443 Test Loss: 10.199 Test Acc: 0.443
Validation loss decreased (-0.282223 --> -0.442646).  Saving model ...
Epoch: 4 cost time: 6.474090099334717
Epoch: 4, Steps: 32 | Train Loss: 10.151 Vali Loss: 50.108 Vali Acc: 0.321 Test Loss: 50.108 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.270450115203857
Epoch: 5, Steps: 32 | Train Loss: 14.520 Vali Loss: 33.184 Vali Acc: 0.351 Test Loss: 33.184 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.256333827972412
Epoch: 6, Steps: 32 | Train Loss: 5.292 Vali Loss: 64.533 Vali Acc: 0.298 Test Loss: 64.533 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.634199619293213
Epoch: 7, Steps: 32 | Train Loss: 7.935 Vali Loss: 47.896 Vali Acc: 0.450 Test Loss: 47.896 Test Acc: 0.450
Validation loss decreased (-0.442646 --> -0.449903).  Saving model ...
Epoch: 8 cost time: 6.818738222122192
Epoch: 8, Steps: 32 | Train Loss: 10.467 Vali Loss: 50.801 Vali Acc: 0.290 Test Loss: 50.801 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.059197187423706
Epoch: 9, Steps: 32 | Train Loss: 8.415 Vali Loss: 52.832 Vali Acc: 0.267 Test Loss: 52.832 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.03589940071106
Epoch: 10, Steps: 32 | Train Loss: 8.214 Vali Loss: 60.961 Vali Acc: 0.298 Test Loss: 60.961 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.903021574020386
Epoch: 11, Steps: 32 | Train Loss: 8.753 Vali Loss: 34.505 Vali Acc: 0.527 Test Loss: 34.505 Test Acc: 0.527
Validation loss decreased (-0.449903 --> -0.526373).  Saving model ...
Epoch: 12 cost time: 7.241737604141235
Epoch: 12, Steps: 32 | Train Loss: 3.692 Vali Loss: 64.108 Vali Acc: 0.305 Test Loss: 64.108 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.003384351730347
Epoch: 13, Steps: 32 | Train Loss: 2.053 Vali Loss: 52.506 Vali Acc: 0.351 Test Loss: 52.506 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.0828704833984375
Epoch: 14, Steps: 32 | Train Loss: 0.612 Vali Loss: 53.557 Vali Acc: 0.565 Test Loss: 53.557 Test Acc: 0.565
Validation loss decreased (-0.526373 --> -0.564350).  Saving model ...
Epoch: 15 cost time: 7.338735103607178
Epoch: 15, Steps: 32 | Train Loss: 3.708 Vali Loss: 72.526 Vali Acc: 0.511 Test Loss: 72.526 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.574537754058838
Epoch: 16, Steps: 32 | Train Loss: 1.918 Vali Loss: 57.259 Vali Acc: 0.397 Test Loss: 57.259 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.30184006690979
Epoch: 17, Steps: 32 | Train Loss: 1.572 Vali Loss: 58.343 Vali Acc: 0.550 Test Loss: 58.343 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.129469633102417
Epoch: 18, Steps: 32 | Train Loss: 3.095 Vali Loss: 46.910 Vali Acc: 0.504 Test Loss: 46.910 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.374396800994873
Epoch: 19, Steps: 32 | Train Loss: 0.365 Vali Loss: 64.967 Vali Acc: 0.321 Test Loss: 64.967 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.874773263931274
Epoch: 20, Steps: 32 | Train Loss: 3.481 Vali Loss: 69.206 Vali Acc: 0.382 Test Loss: 69.206 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.873031854629517
Epoch: 21, Steps: 32 | Train Loss: 1.708 Vali Loss: 58.063 Vali Acc: 0.550 Test Loss: 58.063 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.582411527633667
Epoch: 22, Steps: 32 | Train Loss: 0.164 Vali Loss: 116.182 Vali Acc: 0.229 Test Loss: 116.182 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 7.4772584438323975
Epoch: 23, Steps: 32 | Train Loss: 1.349 Vali Loss: 46.257 Vali Acc: 0.573 Test Loss: 46.257 Test Acc: 0.573
Validation loss decreased (-0.564350 --> -0.572057).  Saving model ...
Epoch: 24 cost time: 7.104710102081299
Epoch: 24, Steps: 32 | Train Loss: 1.078 Vali Loss: 49.185 Vali Acc: 0.588 Test Loss: 49.185 Test Acc: 0.588
Validation loss decreased (-0.572057 --> -0.587294).  Saving model ...
Epoch: 25 cost time: 7.729516983032227
Epoch: 25, Steps: 32 | Train Loss: 0.899 Vali Loss: 86.469 Vali Acc: 0.527 Test Loss: 86.469 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 7.3028483390808105
Epoch: 26, Steps: 32 | Train Loss: 15.263 Vali Loss: 61.268 Vali Acc: 0.595 Test Loss: 61.268 Test Acc: 0.595
Validation loss decreased (-0.587294 --> -0.594807).  Saving model ...
Epoch: 27 cost time: 6.68489933013916
Epoch: 27, Steps: 32 | Train Loss: 2.031 Vali Loss: 82.142 Vali Acc: 0.573 Test Loss: 82.142 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.409190654754639
Epoch: 28, Steps: 32 | Train Loss: 5.223 Vali Loss: 93.746 Vali Acc: 0.511 Test Loss: 93.746 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.929604768753052
Epoch: 29, Steps: 32 | Train Loss: 4.616 Vali Loss: 97.171 Vali Acc: 0.496 Test Loss: 97.171 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 7.121979236602783
Epoch: 30, Steps: 32 | Train Loss: 0.372 Vali Loss: 78.026 Vali Acc: 0.573 Test Loss: 78.026 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.364213705062866
Epoch: 31, Steps: 32 | Train Loss: 8.501 Vali Loss: 94.646 Vali Acc: 0.573 Test Loss: 94.646 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 7.386568069458008
Epoch: 32, Steps: 32 | Train Loss: 1.926 Vali Loss: 202.922 Vali Acc: 0.534 Test Loss: 202.922 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.85599946975708
Epoch: 33, Steps: 32 | Train Loss: 3.552 Vali Loss: 211.293 Vali Acc: 0.550 Test Loss: 211.293 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.834693908691406
Epoch: 34, Steps: 32 | Train Loss: 3.128 Vali Loss: 254.836 Vali Acc: 0.336 Test Loss: 254.836 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 7.217313051223755
Epoch: 35, Steps: 32 | Train Loss: 3.964 Vali Loss: 293.353 Vali Acc: 0.328 Test Loss: 293.353 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 7.249500036239624
Epoch: 36, Steps: 32 | Train Loss: 10.457 Vali Loss: 218.027 Vali Acc: 0.557 Test Loss: 218.027 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 6037461
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.971856355667114
Epoch: 1, Steps: 32 | Train Loss: 6.694 Vali Loss: 7.949 Vali Acc: 0.443 Test Loss: 7.949 Test Acc: 0.443
Validation loss decreased (inf --> -0.442669).  Saving model ...
Epoch: 2 cost time: 6.013744592666626
Epoch: 2, Steps: 32 | Train Loss: 7.066 Vali Loss: 18.405 Vali Acc: 0.504 Test Loss: 18.405 Test Acc: 0.504
Validation loss decreased (-0.442669 --> -0.503633).  Saving model ...
Epoch: 3 cost time: 6.545608758926392
Epoch: 3, Steps: 32 | Train Loss: 4.946 Vali Loss: 20.877 Vali Acc: 0.290 Test Loss: 20.877 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.962751150131226
Epoch: 4, Steps: 32 | Train Loss: 13.443 Vali Loss: 34.094 Vali Acc: 0.267 Test Loss: 34.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.60188889503479
Epoch: 5, Steps: 32 | Train Loss: 8.799 Vali Loss: 20.832 Vali Acc: 0.511 Test Loss: 20.832 Test Acc: 0.511
Validation loss decreased (-0.503633 --> -0.511242).  Saving model ...
Epoch: 6 cost time: 6.121232986450195
Epoch: 6, Steps: 32 | Train Loss: 11.830 Vali Loss: 31.924 Vali Acc: 0.405 Test Loss: 31.924 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.6676435470581055
Epoch: 7, Steps: 32 | Train Loss: 9.465 Vali Loss: 45.133 Vali Acc: 0.328 Test Loss: 45.133 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.695170879364014
Epoch: 8, Steps: 32 | Train Loss: 7.941 Vali Loss: 67.075 Vali Acc: 0.443 Test Loss: 67.075 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.904922008514404
Epoch: 9, Steps: 32 | Train Loss: 9.210 Vali Loss: 57.665 Vali Acc: 0.542 Test Loss: 57.665 Test Acc: 0.542
Validation loss decreased (-0.511242 --> -0.541408).  Saving model ...
Epoch: 10 cost time: 5.848839282989502
Epoch: 10, Steps: 32 | Train Loss: 9.263 Vali Loss: 66.212 Vali Acc: 0.382 Test Loss: 66.212 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.067647933959961
Epoch: 11, Steps: 32 | Train Loss: 5.217 Vali Loss: 44.834 Vali Acc: 0.542 Test Loss: 44.834 Test Acc: 0.542
Validation loss decreased (-0.541408 --> -0.541536).  Saving model ...
Epoch: 12 cost time: 6.245380401611328
Epoch: 12, Steps: 32 | Train Loss: 1.997 Vali Loss: 51.348 Vali Acc: 0.519 Test Loss: 51.348 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.891758918762207
Epoch: 13, Steps: 32 | Train Loss: 2.002 Vali Loss: 55.083 Vali Acc: 0.527 Test Loss: 55.083 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.0475754737854
Epoch: 14, Steps: 32 | Train Loss: 4.399 Vali Loss: 64.925 Vali Acc: 0.511 Test Loss: 64.925 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.5306947231292725
Epoch: 15, Steps: 32 | Train Loss: 3.630 Vali Loss: 73.630 Vali Acc: 0.534 Test Loss: 73.630 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.36012601852417
Epoch: 16, Steps: 32 | Train Loss: 3.059 Vali Loss: 64.665 Vali Acc: 0.405 Test Loss: 64.665 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.0340375900268555
Epoch: 17, Steps: 32 | Train Loss: 6.786 Vali Loss: 69.335 Vali Acc: 0.473 Test Loss: 69.335 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.4996044635772705
Epoch: 18, Steps: 32 | Train Loss: 3.859 Vali Loss: 58.172 Vali Acc: 0.511 Test Loss: 58.172 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.557634592056274
Epoch: 19, Steps: 32 | Train Loss: 5.356 Vali Loss: 61.639 Vali Acc: 0.542 Test Loss: 61.639 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.079155683517456
Epoch: 20, Steps: 32 | Train Loss: 3.768 Vali Loss: 90.024 Vali Acc: 0.321 Test Loss: 90.024 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.127849817276001
Epoch: 21, Steps: 32 | Train Loss: 8.455 Vali Loss: 76.863 Vali Acc: 0.519 Test Loss: 76.863 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 6037461
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.56721305847168
Epoch: 1, Steps: 32 | Train Loss: 7.910 Vali Loss: 13.905 Vali Acc: 0.450 Test Loss: 13.905 Test Acc: 0.450
Validation loss decreased (inf --> -0.450243).  Saving model ...
Epoch: 2 cost time: 5.164900779724121
Epoch: 2, Steps: 32 | Train Loss: 11.152 Vali Loss: 13.259 Vali Acc: 0.435 Test Loss: 13.259 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.673496246337891
Epoch: 3, Steps: 32 | Train Loss: 12.366 Vali Loss: 18.091 Vali Acc: 0.282 Test Loss: 18.091 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.486485719680786
Epoch: 4, Steps: 32 | Train Loss: 11.301 Vali Loss: 24.139 Vali Acc: 0.405 Test Loss: 24.139 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.2205774784088135
Epoch: 5, Steps: 32 | Train Loss: 10.185 Vali Loss: 13.530 Vali Acc: 0.519 Test Loss: 13.530 Test Acc: 0.519
Validation loss decreased (-0.450243 --> -0.518949).  Saving model ...
Epoch: 6 cost time: 5.41338849067688
Epoch: 6, Steps: 32 | Train Loss: 14.783 Vali Loss: 29.276 Vali Acc: 0.504 Test Loss: 29.276 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.55658483505249
Epoch: 7, Steps: 32 | Train Loss: 12.008 Vali Loss: 32.539 Vali Acc: 0.344 Test Loss: 32.539 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.42267918586731
Epoch: 8, Steps: 32 | Train Loss: 11.391 Vali Loss: 63.773 Vali Acc: 0.198 Test Loss: 63.773 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.806267976760864
Epoch: 9, Steps: 32 | Train Loss: 10.173 Vali Loss: 65.046 Vali Acc: 0.489 Test Loss: 65.046 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.303262233734131
Epoch: 10, Steps: 32 | Train Loss: 21.417 Vali Loss: 80.348 Vali Acc: 0.252 Test Loss: 80.348 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.24414587020874
Epoch: 11, Steps: 32 | Train Loss: 12.177 Vali Loss: 63.189 Vali Acc: 0.275 Test Loss: 63.189 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.754566669464111
Epoch: 12, Steps: 32 | Train Loss: 5.208 Vali Loss: 46.386 Vali Acc: 0.504 Test Loss: 46.386 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.751818656921387
Epoch: 13, Steps: 32 | Train Loss: 6.104 Vali Loss: 65.486 Vali Acc: 0.290 Test Loss: 65.486 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.538082599639893
Epoch: 14, Steps: 32 | Train Loss: 4.736 Vali Loss: 72.869 Vali Acc: 0.466 Test Loss: 72.869 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.142273187637329
Epoch: 15, Steps: 32 | Train Loss: 3.329 Vali Loss: 74.140 Vali Acc: 0.550 Test Loss: 74.140 Test Acc: 0.550
Validation loss decreased (-0.518949 --> -0.548877).  Saving model ...
Epoch: 16 cost time: 5.999345541000366
Epoch: 16, Steps: 32 | Train Loss: 3.123 Vali Loss: 58.508 Vali Acc: 0.443 Test Loss: 58.508 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.761943817138672
Epoch: 17, Steps: 32 | Train Loss: 1.696 Vali Loss: 56.141 Vali Acc: 0.580 Test Loss: 56.141 Test Acc: 0.580
Validation loss decreased (-0.548877 --> -0.579591).  Saving model ...
Epoch: 18 cost time: 5.171940565109253
Epoch: 18, Steps: 32 | Train Loss: 4.053 Vali Loss: 57.063 Vali Acc: 0.565 Test Loss: 57.063 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.3128252029418945
Epoch: 19, Steps: 32 | Train Loss: 2.028 Vali Loss: 44.870 Vali Acc: 0.550 Test Loss: 44.870 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.6992058753967285
Epoch: 20, Steps: 32 | Train Loss: 1.462 Vali Loss: 50.377 Vali Acc: 0.618 Test Loss: 50.377 Test Acc: 0.618
Validation loss decreased (-0.579591 --> -0.617817).  Saving model ...
Epoch: 21 cost time: 5.914353370666504
Epoch: 21, Steps: 32 | Train Loss: 2.189 Vali Loss: 71.072 Vali Acc: 0.542 Test Loss: 71.072 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.388970851898193
Epoch: 22, Steps: 32 | Train Loss: 3.789 Vali Loss: 91.140 Vali Acc: 0.580 Test Loss: 91.140 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.060770034790039
Epoch: 23, Steps: 32 | Train Loss: 23.179 Vali Loss: 49.737 Vali Acc: 0.550 Test Loss: 49.737 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.853693246841431
Epoch: 24, Steps: 32 | Train Loss: 3.433 Vali Loss: 84.612 Vali Acc: 0.351 Test Loss: 84.612 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.767444610595703
Epoch: 25, Steps: 32 | Train Loss: 2.022 Vali Loss: 41.788 Vali Acc: 0.634 Test Loss: 41.788 Test Acc: 0.634
Validation loss decreased (-0.617817 --> -0.633170).  Saving model ...
Epoch: 26 cost time: 5.403371810913086
Epoch: 26, Steps: 32 | Train Loss: 2.830 Vali Loss: 74.909 Vali Acc: 0.489 Test Loss: 74.909 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.783627510070801
Epoch: 27, Steps: 32 | Train Loss: 2.246 Vali Loss: 108.223 Vali Acc: 0.313 Test Loss: 108.223 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 6.174922943115234
Epoch: 28, Steps: 32 | Train Loss: 6.683 Vali Loss: 213.585 Vali Acc: 0.244 Test Loss: 213.585 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.2391557693481445
Epoch: 29, Steps: 32 | Train Loss: 8.929 Vali Loss: 95.036 Vali Acc: 0.573 Test Loss: 95.036 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.32115626335144
Epoch: 30, Steps: 32 | Train Loss: 2.370 Vali Loss: 108.103 Vali Acc: 0.511 Test Loss: 108.103 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.546685695648193
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 113.452 Vali Acc: 0.496 Test Loss: 113.452 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.181310415267944
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.945 Vali Acc: 0.351 Test Loss: 105.945 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.715851545333862
Epoch: 33, Steps: 32 | Train Loss: 0.003 Vali Loss: 112.535 Vali Acc: 0.489 Test Loss: 112.535 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.310421943664551
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 115.251 Vali Acc: 0.496 Test Loss: 115.251 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.409663677215576
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 115.347 Vali Acc: 0.496 Test Loss: 115.347 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 6037461
model size : 27.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.626401662826538
Epoch: 1, Steps: 32 | Train Loss: 7.990 Vali Loss: 8.579 Vali Acc: 0.282 Test Loss: 8.579 Test Acc: 0.282
Validation loss decreased (inf --> -0.282357).  Saving model ...
Epoch: 2 cost time: 6.717151403427124
Epoch: 2, Steps: 32 | Train Loss: 10.733 Vali Loss: 26.121 Vali Acc: 0.206 Test Loss: 26.121 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.570288896560669
Epoch: 3, Steps: 32 | Train Loss: 12.640 Vali Loss: 43.747 Vali Acc: 0.252 Test Loss: 43.747 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.528743028640747
Epoch: 4, Steps: 32 | Train Loss: 9.772 Vali Loss: 65.275 Vali Acc: 0.458 Test Loss: 65.275 Test Acc: 0.458
Validation loss decreased (-0.282357 --> -0.457363).  Saving model ...
Epoch: 5 cost time: 6.447348594665527
Epoch: 5, Steps: 32 | Train Loss: 15.516 Vali Loss: 42.427 Vali Acc: 0.534 Test Loss: 42.427 Test Acc: 0.534
Validation loss decreased (-0.457363 --> -0.533927).  Saving model ...
Epoch: 6 cost time: 7.4810261726379395
Epoch: 6, Steps: 32 | Train Loss: 4.708 Vali Loss: 35.223 Vali Acc: 0.481 Test Loss: 35.223 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.431938648223877
Epoch: 7, Steps: 32 | Train Loss: 5.774 Vali Loss: 57.569 Vali Acc: 0.481 Test Loss: 57.569 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.740260601043701
Epoch: 8, Steps: 32 | Train Loss: 5.443 Vali Loss: 45.350 Vali Acc: 0.527 Test Loss: 45.350 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.227128267288208
Epoch: 9, Steps: 32 | Train Loss: 1.720 Vali Loss: 44.912 Vali Acc: 0.603 Test Loss: 44.912 Test Acc: 0.603
Validation loss decreased (-0.533927 --> -0.602604).  Saving model ...
Epoch: 10 cost time: 7.273596525192261
Epoch: 10, Steps: 32 | Train Loss: 5.269 Vali Loss: 82.199 Vali Acc: 0.321 Test Loss: 82.199 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.013412952423096
Epoch: 11, Steps: 32 | Train Loss: 2.829 Vali Loss: 73.784 Vali Acc: 0.496 Test Loss: 73.784 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.321339845657349
Epoch: 12, Steps: 32 | Train Loss: 3.972 Vali Loss: 69.440 Vali Acc: 0.450 Test Loss: 69.440 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.643224239349365
Epoch: 13, Steps: 32 | Train Loss: 0.512 Vali Loss: 74.133 Vali Acc: 0.412 Test Loss: 74.133 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.41271448135376
Epoch: 14, Steps: 32 | Train Loss: 1.609 Vali Loss: 60.126 Vali Acc: 0.489 Test Loss: 60.126 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.359694004058838
Epoch: 15, Steps: 32 | Train Loss: 5.419 Vali Loss: 105.096 Vali Acc: 0.366 Test Loss: 105.096 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.289114952087402
Epoch: 16, Steps: 32 | Train Loss: 6.099 Vali Loss: 101.175 Vali Acc: 0.374 Test Loss: 101.175 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.360039472579956
Epoch: 17, Steps: 32 | Train Loss: 9.811 Vali Loss: 74.922 Vali Acc: 0.580 Test Loss: 74.922 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.91049337387085
Epoch: 18, Steps: 32 | Train Loss: 2.822 Vali Loss: 71.830 Vali Acc: 0.557 Test Loss: 71.830 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.142102479934692
Epoch: 19, Steps: 32 | Train Loss: 0.764 Vali Loss: 87.954 Vali Acc: 0.511 Test Loss: 87.954 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 5906389
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.832098484039307
Epoch: 1, Steps: 32 | Train Loss: 7.841 Vali Loss: 7.564 Vali Acc: 0.305 Test Loss: 7.564 Test Acc: 0.305
Validation loss decreased (inf --> -0.305268).  Saving model ...
Epoch: 2 cost time: 6.724816560745239
Epoch: 2, Steps: 32 | Train Loss: 5.727 Vali Loss: 17.136 Vali Acc: 0.183 Test Loss: 17.136 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.7265331745147705
Epoch: 3, Steps: 32 | Train Loss: 10.768 Vali Loss: 31.128 Vali Acc: 0.458 Test Loss: 31.128 Test Acc: 0.458
Validation loss decreased (-0.305268 --> -0.457704).  Saving model ...
Epoch: 4 cost time: 6.032278776168823
Epoch: 4, Steps: 32 | Train Loss: 12.087 Vali Loss: 40.378 Vali Acc: 0.519 Test Loss: 40.378 Test Acc: 0.519
Validation loss decreased (-0.457704 --> -0.518680).  Saving model ...
Epoch: 5 cost time: 6.509264230728149
Epoch: 5, Steps: 32 | Train Loss: 11.369 Vali Loss: 40.380 Vali Acc: 0.519 Test Loss: 40.380 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.848730802536011
Epoch: 6, Steps: 32 | Train Loss: 6.413 Vali Loss: 29.231 Vali Acc: 0.511 Test Loss: 29.231 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.639389276504517
Epoch: 7, Steps: 32 | Train Loss: 3.962 Vali Loss: 49.821 Vali Acc: 0.504 Test Loss: 49.821 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.6631858348846436
Epoch: 8, Steps: 32 | Train Loss: 5.950 Vali Loss: 34.837 Vali Acc: 0.557 Test Loss: 34.837 Test Acc: 0.557
Validation loss decreased (-0.518680 --> -0.556904).  Saving model ...
Epoch: 9 cost time: 7.092743396759033
Epoch: 9, Steps: 32 | Train Loss: 2.472 Vali Loss: 34.319 Vali Acc: 0.542 Test Loss: 34.319 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.087721586227417
Epoch: 10, Steps: 32 | Train Loss: 3.687 Vali Loss: 46.563 Vali Acc: 0.511 Test Loss: 46.563 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.080392122268677
Epoch: 11, Steps: 32 | Train Loss: 4.758 Vali Loss: 39.954 Vali Acc: 0.504 Test Loss: 39.954 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.19210958480835
Epoch: 12, Steps: 32 | Train Loss: 1.710 Vali Loss: 38.106 Vali Acc: 0.374 Test Loss: 38.106 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.423907518386841
Epoch: 13, Steps: 32 | Train Loss: 1.160 Vali Loss: 36.099 Vali Acc: 0.466 Test Loss: 36.099 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.301337480545044
Epoch: 14, Steps: 32 | Train Loss: 7.590 Vali Loss: 59.419 Vali Acc: 0.344 Test Loss: 59.419 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.919543981552124
Epoch: 15, Steps: 32 | Train Loss: 6.197 Vali Loss: 59.790 Vali Acc: 0.557 Test Loss: 59.790 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.718461751937866
Epoch: 16, Steps: 32 | Train Loss: 3.843 Vali Loss: 69.149 Vali Acc: 0.557 Test Loss: 69.149 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.861321687698364
Epoch: 17, Steps: 32 | Train Loss: 13.673 Vali Loss: 41.485 Vali Acc: 0.443 Test Loss: 41.485 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.879201412200928
Epoch: 18, Steps: 32 | Train Loss: 10.186 Vali Loss: 61.013 Vali Acc: 0.435 Test Loss: 61.013 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 5906389
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.838444709777832
Epoch: 1, Steps: 32 | Train Loss: 8.356 Vali Loss: 10.824 Vali Acc: 0.282 Test Loss: 10.824 Test Acc: 0.282
Validation loss decreased (inf --> -0.282335).  Saving model ...
Epoch: 2 cost time: 6.218073129653931
Epoch: 2, Steps: 32 | Train Loss: 6.654 Vali Loss: 18.499 Vali Acc: 0.527 Test Loss: 18.499 Test Acc: 0.527
Validation loss decreased (-0.282335 --> -0.526533).  Saving model ...
Epoch: 3 cost time: 6.1674277782440186
Epoch: 3, Steps: 32 | Train Loss: 7.988 Vali Loss: 19.346 Vali Acc: 0.260 Test Loss: 19.346 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.51824688911438
Epoch: 4, Steps: 32 | Train Loss: 10.927 Vali Loss: 42.925 Vali Acc: 0.450 Test Loss: 42.925 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.393864154815674
Epoch: 5, Steps: 32 | Train Loss: 4.440 Vali Loss: 44.921 Vali Acc: 0.275 Test Loss: 44.921 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.398746967315674
Epoch: 6, Steps: 32 | Train Loss: 3.888 Vali Loss: 40.533 Vali Acc: 0.573 Test Loss: 40.533 Test Acc: 0.573
Validation loss decreased (-0.526533 --> -0.572114).  Saving model ...
Epoch: 7 cost time: 6.130692958831787
Epoch: 7, Steps: 32 | Train Loss: 12.209 Vali Loss: 41.163 Vali Acc: 0.511 Test Loss: 41.163 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.841005563735962
Epoch: 8, Steps: 32 | Train Loss: 5.548 Vali Loss: 56.560 Vali Acc: 0.458 Test Loss: 56.560 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.46349573135376
Epoch: 9, Steps: 32 | Train Loss: 17.658 Vali Loss: 38.444 Vali Acc: 0.511 Test Loss: 38.444 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.401357889175415
Epoch: 10, Steps: 32 | Train Loss: 8.215 Vali Loss: 75.958 Vali Acc: 0.282 Test Loss: 75.958 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.242814302444458
Epoch: 11, Steps: 32 | Train Loss: 3.507 Vali Loss: 50.568 Vali Acc: 0.351 Test Loss: 50.568 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.062366485595703
Epoch: 12, Steps: 32 | Train Loss: 5.353 Vali Loss: 49.523 Vali Acc: 0.344 Test Loss: 49.523 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.177294731140137
Epoch: 13, Steps: 32 | Train Loss: 8.889 Vali Loss: 69.997 Vali Acc: 0.321 Test Loss: 69.997 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.247028350830078
Epoch: 14, Steps: 32 | Train Loss: 6.534 Vali Loss: 120.922 Vali Acc: 0.229 Test Loss: 120.922 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.6323347091674805
Epoch: 15, Steps: 32 | Train Loss: 7.768 Vali Loss: 51.596 Vali Acc: 0.550 Test Loss: 51.596 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.388163805007935
Epoch: 16, Steps: 32 | Train Loss: 2.060 Vali Loss: 51.486 Vali Acc: 0.527 Test Loss: 51.486 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5906389
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.184195041656494
Epoch: 1, Steps: 32 | Train Loss: 7.454 Vali Loss: 11.409 Vali Acc: 0.198 Test Loss: 11.409 Test Acc: 0.198
Validation loss decreased (inf --> -0.198359).  Saving model ...
Epoch: 2 cost time: 5.056130409240723
Epoch: 2, Steps: 32 | Train Loss: 15.668 Vali Loss: 12.519 Vali Acc: 0.481 Test Loss: 12.519 Test Acc: 0.481
Validation loss decreased (-0.198359 --> -0.480791).  Saving model ...
Epoch: 3 cost time: 5.890808820724487
Epoch: 3, Steps: 32 | Train Loss: 11.666 Vali Loss: 20.468 Vali Acc: 0.237 Test Loss: 20.468 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.118340015411377
Epoch: 4, Steps: 32 | Train Loss: 6.154 Vali Loss: 23.873 Vali Acc: 0.435 Test Loss: 23.873 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.019622325897217
Epoch: 5, Steps: 32 | Train Loss: 14.779 Vali Loss: 28.972 Vali Acc: 0.473 Test Loss: 28.972 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.746955156326294
Epoch: 6, Steps: 32 | Train Loss: 16.733 Vali Loss: 39.943 Vali Acc: 0.473 Test Loss: 39.943 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 5.534176349639893
Epoch: 7, Steps: 32 | Train Loss: 12.387 Vali Loss: 47.396 Vali Acc: 0.405 Test Loss: 47.396 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.861108303070068
Epoch: 8, Steps: 32 | Train Loss: 10.147 Vali Loss: 49.051 Vali Acc: 0.359 Test Loss: 49.051 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.741791248321533
Epoch: 9, Steps: 32 | Train Loss: 5.288 Vali Loss: 51.279 Vali Acc: 0.351 Test Loss: 51.279 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.122973442077637
Epoch: 10, Steps: 32 | Train Loss: 7.783 Vali Loss: 44.501 Vali Acc: 0.313 Test Loss: 44.501 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.870118141174316
Epoch: 11, Steps: 32 | Train Loss: 8.371 Vali Loss: 55.300 Vali Acc: 0.313 Test Loss: 55.300 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 5.812449216842651
Epoch: 12, Steps: 32 | Train Loss: 9.639 Vali Loss: 44.827 Vali Acc: 0.534 Test Loss: 44.827 Test Acc: 0.534
Validation loss decreased (-0.480791 --> -0.533903).  Saving model ...
Epoch: 13 cost time: 5.741666555404663
Epoch: 13, Steps: 32 | Train Loss: 6.215 Vali Loss: 71.198 Vali Acc: 0.275 Test Loss: 71.198 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.7749245166778564
Epoch: 14, Steps: 32 | Train Loss: 3.041 Vali Loss: 73.565 Vali Acc: 0.252 Test Loss: 73.565 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.803019285202026
Epoch: 15, Steps: 32 | Train Loss: 6.982 Vali Loss: 81.072 Vali Acc: 0.244 Test Loss: 81.072 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.328934907913208
Epoch: 16, Steps: 32 | Train Loss: 4.382 Vali Loss: 55.295 Vali Acc: 0.519 Test Loss: 55.295 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.1776063442230225
Epoch: 17, Steps: 32 | Train Loss: 6.225 Vali Loss: 51.597 Vali Acc: 0.550 Test Loss: 51.597 Test Acc: 0.550
Validation loss decreased (-0.533903 --> -0.549102).  Saving model ...
Epoch: 18 cost time: 5.518831968307495
Epoch: 18, Steps: 32 | Train Loss: 3.419 Vali Loss: 66.523 Vali Acc: 0.573 Test Loss: 66.523 Test Acc: 0.573
Validation loss decreased (-0.549102 --> -0.571854).  Saving model ...
Epoch: 19 cost time: 5.970265865325928
Epoch: 19, Steps: 32 | Train Loss: 5.227 Vali Loss: 38.709 Vali Acc: 0.595 Test Loss: 38.709 Test Acc: 0.595
Validation loss decreased (-0.571854 --> -0.595033).  Saving model ...
Epoch: 20 cost time: 5.735536336898804
Epoch: 20, Steps: 32 | Train Loss: 4.874 Vali Loss: 67.373 Vali Acc: 0.397 Test Loss: 67.373 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.911036729812622
Epoch: 21, Steps: 32 | Train Loss: 1.534 Vali Loss: 57.938 Vali Acc: 0.519 Test Loss: 57.938 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.671166658401489
Epoch: 22, Steps: 32 | Train Loss: 1.084 Vali Loss: 71.707 Vali Acc: 0.595 Test Loss: 71.707 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.235515117645264
Epoch: 23, Steps: 32 | Train Loss: 1.112 Vali Loss: 55.921 Vali Acc: 0.618 Test Loss: 55.921 Test Acc: 0.618
Validation loss decreased (-0.595033 --> -0.617761).  Saving model ...
Epoch: 24 cost time: 5.190376043319702
Epoch: 24, Steps: 32 | Train Loss: 3.267 Vali Loss: 68.209 Vali Acc: 0.405 Test Loss: 68.209 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.877241134643555
Epoch: 25, Steps: 32 | Train Loss: 3.043 Vali Loss: 44.682 Vali Acc: 0.626 Test Loss: 44.682 Test Acc: 0.626
Validation loss decreased (-0.617761 --> -0.625507).  Saving model ...
Epoch: 26 cost time: 5.9490509033203125
Epoch: 26, Steps: 32 | Train Loss: 2.022 Vali Loss: 47.828 Vali Acc: 0.588 Test Loss: 47.828 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.897280693054199
Epoch: 27, Steps: 32 | Train Loss: 1.970 Vali Loss: 135.180 Vali Acc: 0.214 Test Loss: 135.180 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.533904790878296
Epoch: 28, Steps: 32 | Train Loss: 0.668 Vali Loss: 90.454 Vali Acc: 0.359 Test Loss: 90.454 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.776843547821045
Epoch: 29, Steps: 32 | Train Loss: 1.490 Vali Loss: 65.910 Vali Acc: 0.588 Test Loss: 65.910 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.635718822479248
Epoch: 30, Steps: 32 | Train Loss: 1.210 Vali Loss: 119.290 Vali Acc: 0.420 Test Loss: 119.290 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.867788791656494
Epoch: 31, Steps: 32 | Train Loss: 1.643 Vali Loss: 54.462 Vali Acc: 0.672 Test Loss: 54.462 Test Acc: 0.672
Validation loss decreased (-0.625507 --> -0.671211).  Saving model ...
Epoch: 32 cost time: 5.0503363609313965
Epoch: 32, Steps: 32 | Train Loss: 2.707 Vali Loss: 197.483 Vali Acc: 0.290 Test Loss: 197.483 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.480809211730957
Epoch: 33, Steps: 32 | Train Loss: 14.853 Vali Loss: 91.874 Vali Acc: 0.588 Test Loss: 91.874 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 6.372562885284424
Epoch: 34, Steps: 32 | Train Loss: 0.056 Vali Loss: 71.752 Vali Acc: 0.634 Test Loss: 71.752 Test Acc: 0.634
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.688960075378418
Epoch: 35, Steps: 32 | Train Loss: 1.965 Vali Loss: 98.606 Vali Acc: 0.588 Test Loss: 98.606 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 5.353271961212158
Epoch: 36, Steps: 32 | Train Loss: 2.339 Vali Loss: 137.049 Vali Acc: 0.603 Test Loss: 137.049 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 6.6776978969573975
Epoch: 37, Steps: 32 | Train Loss: 1.520 Vali Loss: 148.659 Vali Acc: 0.466 Test Loss: 148.659 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 6.261408567428589
Epoch: 38, Steps: 32 | Train Loss: 0.354 Vali Loss: 166.819 Vali Acc: 0.405 Test Loss: 166.819 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.899852275848389
Epoch: 39, Steps: 32 | Train Loss: 0.180 Vali Loss: 136.136 Vali Acc: 0.626 Test Loss: 136.136 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 5.687132120132446
Epoch: 40, Steps: 32 | Train Loss: 0.396 Vali Loss: 170.784 Vali Acc: 0.397 Test Loss: 170.784 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 5.909734725952148
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 150.008 Vali Acc: 0.588 Test Loss: 150.008 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6717557251908397
model parameter : 5906389
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.270267009735107
Epoch: 1, Steps: 32 | Train Loss: 6.450 Vali Loss: 14.984 Vali Acc: 0.290 Test Loss: 14.984 Test Acc: 0.290
Validation loss decreased (inf --> -0.289926).  Saving model ...
Epoch: 2 cost time: 7.165948390960693
Epoch: 2, Steps: 32 | Train Loss: 9.934 Vali Loss: 17.952 Vali Acc: 0.359 Test Loss: 17.952 Test Acc: 0.359
Validation loss decreased (-0.289926 --> -0.358599).  Saving model ...
Epoch: 3 cost time: 7.561921119689941
Epoch: 3, Steps: 32 | Train Loss: 5.479 Vali Loss: 25.376 Vali Acc: 0.290 Test Loss: 25.376 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.489054203033447
Epoch: 4, Steps: 32 | Train Loss: 7.521 Vali Loss: 31.625 Vali Acc: 0.420 Test Loss: 31.625 Test Acc: 0.420
Validation loss decreased (-0.358599 --> -0.419531).  Saving model ...
Epoch: 5 cost time: 7.319480895996094
Epoch: 5, Steps: 32 | Train Loss: 13.604 Vali Loss: 41.411 Vali Acc: 0.336 Test Loss: 41.411 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.275591850280762
Epoch: 6, Steps: 32 | Train Loss: 6.073 Vali Loss: 24.477 Vali Acc: 0.565 Test Loss: 24.477 Test Acc: 0.565
Validation loss decreased (-0.419531 --> -0.564641).  Saving model ...
Epoch: 7 cost time: 6.31759786605835
Epoch: 7, Steps: 32 | Train Loss: 7.175 Vali Loss: 36.332 Vali Acc: 0.267 Test Loss: 36.332 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1755218505859375
Epoch: 8, Steps: 32 | Train Loss: 2.468 Vali Loss: 34.158 Vali Acc: 0.527 Test Loss: 34.158 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 7.060417413711548
Epoch: 9, Steps: 32 | Train Loss: 5.412 Vali Loss: 42.073 Vali Acc: 0.305 Test Loss: 42.073 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.500115156173706
Epoch: 10, Steps: 32 | Train Loss: 1.916 Vali Loss: 40.402 Vali Acc: 0.336 Test Loss: 40.402 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.163450002670288
Epoch: 11, Steps: 32 | Train Loss: 4.573 Vali Loss: 27.862 Vali Acc: 0.534 Test Loss: 27.862 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.603535413742065
Epoch: 12, Steps: 32 | Train Loss: 3.587 Vali Loss: 50.317 Vali Acc: 0.298 Test Loss: 50.317 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.7356438636779785
Epoch: 13, Steps: 32 | Train Loss: 4.195 Vali Loss: 42.860 Vali Acc: 0.573 Test Loss: 42.860 Test Acc: 0.573
Validation loss decreased (-0.564641 --> -0.572090).  Saving model ...
Epoch: 14 cost time: 7.268831014633179
Epoch: 14, Steps: 32 | Train Loss: 1.140 Vali Loss: 61.776 Vali Acc: 0.275 Test Loss: 61.776 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.358251571655273
Epoch: 15, Steps: 32 | Train Loss: 3.644 Vali Loss: 54.070 Vali Acc: 0.527 Test Loss: 54.070 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.419750928878784
Epoch: 16, Steps: 32 | Train Loss: 0.137 Vali Loss: 46.297 Vali Acc: 0.534 Test Loss: 46.297 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.1814446449279785
Epoch: 17, Steps: 32 | Train Loss: 2.829 Vali Loss: 50.382 Vali Acc: 0.351 Test Loss: 50.382 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.288726806640625
Epoch: 18, Steps: 32 | Train Loss: 5.166 Vali Loss: 81.084 Vali Acc: 0.260 Test Loss: 81.084 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.777191162109375
Epoch: 19, Steps: 32 | Train Loss: 10.649 Vali Loss: 201.551 Vali Acc: 0.282 Test Loss: 201.551 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.528751373291016
Epoch: 20, Steps: 32 | Train Loss: 2.734 Vali Loss: 179.830 Vali Acc: 0.504 Test Loss: 179.830 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.333647727966309
Epoch: 21, Steps: 32 | Train Loss: 1.291 Vali Loss: 152.972 Vali Acc: 0.313 Test Loss: 152.972 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.116477966308594
Epoch: 22, Steps: 32 | Train Loss: 6.065 Vali Loss: 137.909 Vali Acc: 0.420 Test Loss: 137.909 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.329453945159912
Epoch: 23, Steps: 32 | Train Loss: 2.242 Vali Loss: 112.256 Vali Acc: 0.366 Test Loss: 112.256 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5840853
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.56847882270813
Epoch: 1, Steps: 32 | Train Loss: 7.085 Vali Loss: 12.017 Vali Acc: 0.282 Test Loss: 12.017 Test Acc: 0.282
Validation loss decreased (inf --> -0.282323).  Saving model ...
Epoch: 2 cost time: 6.185269594192505
Epoch: 2, Steps: 32 | Train Loss: 10.852 Vali Loss: 17.733 Vali Acc: 0.397 Test Loss: 17.733 Test Acc: 0.397
Validation loss decreased (-0.282323 --> -0.396769).  Saving model ...
Epoch: 3 cost time: 6.440269708633423
Epoch: 3, Steps: 32 | Train Loss: 12.595 Vali Loss: 12.752 Vali Acc: 0.321 Test Loss: 12.752 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.187821388244629
Epoch: 4, Steps: 32 | Train Loss: 4.698 Vali Loss: 22.871 Vali Acc: 0.542 Test Loss: 22.871 Test Acc: 0.542
Validation loss decreased (-0.396769 --> -0.541756).  Saving model ...
Epoch: 5 cost time: 6.5301783084869385
Epoch: 5, Steps: 32 | Train Loss: 7.961 Vali Loss: 29.711 Vali Acc: 0.504 Test Loss: 29.711 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.578474044799805
Epoch: 6, Steps: 32 | Train Loss: 8.844 Vali Loss: 31.758 Vali Acc: 0.374 Test Loss: 31.758 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.9171507358551025
Epoch: 7, Steps: 32 | Train Loss: 15.373 Vali Loss: 43.407 Vali Acc: 0.366 Test Loss: 43.407 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.058763027191162
Epoch: 8, Steps: 32 | Train Loss: 5.606 Vali Loss: 35.979 Vali Acc: 0.527 Test Loss: 35.979 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.929680347442627
Epoch: 9, Steps: 32 | Train Loss: 4.374 Vali Loss: 46.565 Vali Acc: 0.336 Test Loss: 46.565 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.659470796585083
Epoch: 10, Steps: 32 | Train Loss: 5.593 Vali Loss: 41.638 Vali Acc: 0.588 Test Loss: 41.638 Test Acc: 0.588
Validation loss decreased (-0.541756 --> -0.587370).  Saving model ...
Epoch: 11 cost time: 6.328614234924316
Epoch: 11, Steps: 32 | Train Loss: 2.766 Vali Loss: 105.178 Vali Acc: 0.374 Test Loss: 105.178 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.669367790222168
Epoch: 12, Steps: 32 | Train Loss: 2.095 Vali Loss: 99.539 Vali Acc: 0.321 Test Loss: 99.539 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.575945615768433
Epoch: 13, Steps: 32 | Train Loss: 12.119 Vali Loss: 106.946 Vali Acc: 0.366 Test Loss: 106.946 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1697516441345215
Epoch: 14, Steps: 32 | Train Loss: 5.953 Vali Loss: 84.906 Vali Acc: 0.550 Test Loss: 84.906 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.873165130615234
Epoch: 15, Steps: 32 | Train Loss: 4.261 Vali Loss: 90.948 Vali Acc: 0.382 Test Loss: 90.948 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.17535400390625
Epoch: 16, Steps: 32 | Train Loss: 1.369 Vali Loss: 92.705 Vali Acc: 0.542 Test Loss: 92.705 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.347464561462402
Epoch: 17, Steps: 32 | Train Loss: 0.955 Vali Loss: 82.383 Vali Acc: 0.542 Test Loss: 82.383 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.350830316543579
Epoch: 18, Steps: 32 | Train Loss: 1.800 Vali Loss: 81.972 Vali Acc: 0.435 Test Loss: 81.972 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.439600706100464
Epoch: 19, Steps: 32 | Train Loss: 1.003 Vali Loss: 91.032 Vali Acc: 0.359 Test Loss: 91.032 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.531057596206665
Epoch: 20, Steps: 32 | Train Loss: 0.844 Vali Loss: 97.194 Vali Acc: 0.565 Test Loss: 97.194 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 5840853
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.695801734924316
Epoch: 1, Steps: 32 | Train Loss: 6.683 Vali Loss: 17.516 Vali Acc: 0.260 Test Loss: 17.516 Test Acc: 0.260
Validation loss decreased (inf --> -0.259367).  Saving model ...
Epoch: 2 cost time: 5.893541574478149
Epoch: 2, Steps: 32 | Train Loss: 14.086 Vali Loss: 23.086 Vali Acc: 0.328 Test Loss: 23.086 Test Acc: 0.328
Validation loss decreased (-0.259367 --> -0.328013).  Saving model ...
Epoch: 3 cost time: 6.033746242523193
Epoch: 3, Steps: 32 | Train Loss: 10.426 Vali Loss: 42.240 Vali Acc: 0.260 Test Loss: 42.240 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.055224180221558
Epoch: 4, Steps: 32 | Train Loss: 15.385 Vali Loss: 33.270 Vali Acc: 0.206 Test Loss: 33.270 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.058891296386719
Epoch: 5, Steps: 32 | Train Loss: 11.218 Vali Loss: 51.131 Vali Acc: 0.527 Test Loss: 51.131 Test Acc: 0.527
Validation loss decreased (-0.328013 --> -0.526206).  Saving model ...
Epoch: 6 cost time: 6.465052843093872
Epoch: 6, Steps: 32 | Train Loss: 13.881 Vali Loss: 44.467 Vali Acc: 0.290 Test Loss: 44.467 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.399784088134766
Epoch: 7, Steps: 32 | Train Loss: 6.561 Vali Loss: 28.436 Vali Acc: 0.595 Test Loss: 28.436 Test Acc: 0.595
Validation loss decreased (-0.526206 --> -0.595135).  Saving model ...
Epoch: 8 cost time: 6.505942106246948
Epoch: 8, Steps: 32 | Train Loss: 5.089 Vali Loss: 34.901 Vali Acc: 0.443 Test Loss: 34.901 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.9530370235443115
Epoch: 9, Steps: 32 | Train Loss: 7.782 Vali Loss: 28.366 Vali Acc: 0.519 Test Loss: 28.366 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.188024520874023
Epoch: 10, Steps: 32 | Train Loss: 5.648 Vali Loss: 26.814 Vali Acc: 0.481 Test Loss: 26.814 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.883155345916748
Epoch: 11, Steps: 32 | Train Loss: 6.202 Vali Loss: 77.148 Vali Acc: 0.389 Test Loss: 77.148 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.928427696228027
Epoch: 12, Steps: 32 | Train Loss: 3.624 Vali Loss: 74.030 Vali Acc: 0.504 Test Loss: 74.030 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.820787668228149
Epoch: 13, Steps: 32 | Train Loss: 5.540 Vali Loss: 111.012 Vali Acc: 0.252 Test Loss: 111.012 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.077741384506226
Epoch: 14, Steps: 32 | Train Loss: 4.185 Vali Loss: 88.672 Vali Acc: 0.321 Test Loss: 88.672 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.498419761657715
Epoch: 15, Steps: 32 | Train Loss: 2.796 Vali Loss: 106.793 Vali Acc: 0.282 Test Loss: 106.793 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.632248401641846
Epoch: 16, Steps: 32 | Train Loss: 1.411 Vali Loss: 80.527 Vali Acc: 0.511 Test Loss: 80.527 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.038339614868164
Epoch: 17, Steps: 32 | Train Loss: 4.111 Vali Loss: 122.083 Vali Acc: 0.504 Test Loss: 122.083 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5840853
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.823337078094482
Epoch: 1, Steps: 32 | Train Loss: 6.367 Vali Loss: 22.828 Vali Acc: 0.130 Test Loss: 22.828 Test Acc: 0.130
Validation loss decreased (inf --> -0.129543).  Saving model ...
Epoch: 2 cost time: 5.557722091674805
Epoch: 2, Steps: 32 | Train Loss: 16.166 Vali Loss: 19.511 Vali Acc: 0.198 Test Loss: 19.511 Test Acc: 0.198
Validation loss decreased (-0.129543 --> -0.198278).  Saving model ...
Epoch: 3 cost time: 5.674910068511963
Epoch: 3, Steps: 32 | Train Loss: 11.867 Vali Loss: 9.062 Vali Acc: 0.466 Test Loss: 9.062 Test Acc: 0.466
Validation loss decreased (-0.198278 --> -0.465558).  Saving model ...
Epoch: 4 cost time: 5.088592767715454
Epoch: 4, Steps: 32 | Train Loss: 12.203 Vali Loss: 47.255 Vali Acc: 0.252 Test Loss: 47.255 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.8694727420806885
Epoch: 5, Steps: 32 | Train Loss: 20.227 Vali Loss: 24.223 Vali Acc: 0.481 Test Loss: 24.223 Test Acc: 0.481
Validation loss decreased (-0.465558 --> -0.480674).  Saving model ...
Epoch: 6 cost time: 5.5551745891571045
Epoch: 6, Steps: 32 | Train Loss: 12.268 Vali Loss: 19.234 Vali Acc: 0.450 Test Loss: 19.234 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.7854437828063965
Epoch: 7, Steps: 32 | Train Loss: 6.040 Vali Loss: 28.519 Vali Acc: 0.405 Test Loss: 28.519 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.1449244022369385
Epoch: 8, Steps: 32 | Train Loss: 14.869 Vali Loss: 17.746 Vali Acc: 0.588 Test Loss: 17.746 Test Acc: 0.588
Validation loss decreased (-0.480674 --> -0.587609).  Saving model ...
Epoch: 9 cost time: 5.388537645339966
Epoch: 9, Steps: 32 | Train Loss: 18.853 Vali Loss: 21.533 Vali Acc: 0.557 Test Loss: 21.533 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.887571811676025
Epoch: 10, Steps: 32 | Train Loss: 11.607 Vali Loss: 31.460 Vali Acc: 0.435 Test Loss: 31.460 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.417912006378174
Epoch: 11, Steps: 32 | Train Loss: 8.113 Vali Loss: 45.709 Vali Acc: 0.290 Test Loss: 45.709 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.072916746139526
Epoch: 12, Steps: 32 | Train Loss: 5.318 Vali Loss: 35.624 Vali Acc: 0.412 Test Loss: 35.624 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.617876052856445
Epoch: 13, Steps: 32 | Train Loss: 11.157 Vali Loss: 34.454 Vali Acc: 0.466 Test Loss: 34.454 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.024922132492065
Epoch: 14, Steps: 32 | Train Loss: 4.399 Vali Loss: 61.176 Vali Acc: 0.511 Test Loss: 61.176 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 5.974775791168213
Epoch: 15, Steps: 32 | Train Loss: 8.145 Vali Loss: 57.529 Vali Acc: 0.580 Test Loss: 57.529 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.757567405700684
Epoch: 16, Steps: 32 | Train Loss: 9.313 Vali Loss: 38.529 Vali Acc: 0.557 Test Loss: 38.529 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.929272174835205
Epoch: 17, Steps: 32 | Train Loss: 1.604 Vali Loss: 59.594 Vali Acc: 0.466 Test Loss: 59.594 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.053563356399536
Epoch: 18, Steps: 32 | Train Loss: 2.356 Vali Loss: 40.116 Vali Acc: 0.588 Test Loss: 40.116 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 5840853
model size : 26.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.185674667358398
Epoch: 1, Steps: 32 | Train Loss: 9.276 Vali Loss: 7.726 Vali Acc: 0.282 Test Loss: 7.726 Test Acc: 0.282
Validation loss decreased (inf --> -0.282365).  Saving model ...
Epoch: 2 cost time: 7.182276248931885
Epoch: 2, Steps: 32 | Train Loss: 6.811 Vali Loss: 24.542 Vali Acc: 0.198 Test Loss: 24.542 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.282848834991455
Epoch: 3, Steps: 32 | Train Loss: 9.473 Vali Loss: 17.577 Vali Acc: 0.405 Test Loss: 17.577 Test Acc: 0.405
Validation loss decreased (-0.282365 --> -0.404404).  Saving model ...
Epoch: 4 cost time: 7.200920343399048
Epoch: 4, Steps: 32 | Train Loss: 10.130 Vali Loss: 28.624 Vali Acc: 0.328 Test Loss: 28.624 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.68308162689209
Epoch: 5, Steps: 32 | Train Loss: 6.738 Vali Loss: 52.659 Vali Acc: 0.504 Test Loss: 52.659 Test Acc: 0.504
Validation loss decreased (-0.404404 --> -0.503290).  Saving model ...
Epoch: 6 cost time: 6.748428821563721
Epoch: 6, Steps: 32 | Train Loss: 14.963 Vali Loss: 47.791 Vali Acc: 0.313 Test Loss: 47.791 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.489464521408081
Epoch: 7, Steps: 32 | Train Loss: 3.383 Vali Loss: 34.112 Vali Acc: 0.481 Test Loss: 34.112 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.357562065124512
Epoch: 8, Steps: 32 | Train Loss: 7.657 Vali Loss: 48.693 Vali Acc: 0.427 Test Loss: 48.693 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.68424129486084
Epoch: 9, Steps: 32 | Train Loss: 8.902 Vali Loss: 45.618 Vali Acc: 0.473 Test Loss: 45.618 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.399754047393799
Epoch: 10, Steps: 32 | Train Loss: 6.256 Vali Loss: 43.510 Vali Acc: 0.374 Test Loss: 43.510 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.4587626457214355
Epoch: 11, Steps: 32 | Train Loss: 3.231 Vali Loss: 51.364 Vali Acc: 0.412 Test Loss: 51.364 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.895208358764648
Epoch: 12, Steps: 32 | Train Loss: 3.011 Vali Loss: 44.302 Vali Acc: 0.443 Test Loss: 44.302 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.64078426361084
Epoch: 13, Steps: 32 | Train Loss: 0.738 Vali Loss: 35.042 Vali Acc: 0.588 Test Loss: 35.042 Test Acc: 0.588
Validation loss decreased (-0.503290 --> -0.587436).  Saving model ...
Epoch: 14 cost time: 7.597817897796631
Epoch: 14, Steps: 32 | Train Loss: 0.607 Vali Loss: 58.910 Vali Acc: 0.397 Test Loss: 58.910 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.6309731006622314
Epoch: 15, Steps: 32 | Train Loss: 5.482 Vali Loss: 60.034 Vali Acc: 0.336 Test Loss: 60.034 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.447727918624878
Epoch: 16, Steps: 32 | Train Loss: 21.789 Vali Loss: 59.539 Vali Acc: 0.466 Test Loss: 59.539 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.488477945327759
Epoch: 17, Steps: 32 | Train Loss: 2.239 Vali Loss: 77.164 Vali Acc: 0.382 Test Loss: 77.164 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.919292449951172
Epoch: 18, Steps: 32 | Train Loss: 17.426 Vali Loss: 88.444 Vali Acc: 0.595 Test Loss: 88.444 Test Acc: 0.595
Validation loss decreased (-0.587436 --> -0.594535).  Saving model ...
Epoch: 19 cost time: 6.788086891174316
Epoch: 19, Steps: 32 | Train Loss: 2.178 Vali Loss: 89.924 Vali Acc: 0.588 Test Loss: 89.924 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.653264760971069
Epoch: 20, Steps: 32 | Train Loss: 0.638 Vali Loss: 61.743 Vali Acc: 0.420 Test Loss: 61.743 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.4899373054504395
Epoch: 21, Steps: 32 | Train Loss: 1.730 Vali Loss: 55.531 Vali Acc: 0.588 Test Loss: 55.531 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.070678234100342
Epoch: 22, Steps: 32 | Train Loss: 0.782 Vali Loss: 72.193 Vali Acc: 0.389 Test Loss: 72.193 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.79067063331604
Epoch: 23, Steps: 32 | Train Loss: 0.842 Vali Loss: 70.778 Vali Acc: 0.519 Test Loss: 70.778 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.458318710327148
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.780 Vali Acc: 0.519 Test Loss: 72.780 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.495035409927368
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.853 Vali Acc: 0.519 Test Loss: 72.853 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.874771595001221
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.856 Vali Acc: 0.519 Test Loss: 72.856 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.38096022605896
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.856 Vali Acc: 0.519 Test Loss: 72.856 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.376638650894165
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.856 Vali Acc: 0.519 Test Loss: 72.856 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5808085
model size : 26.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.121742963790894
Epoch: 1, Steps: 32 | Train Loss: 11.372 Vali Loss: 12.151 Vali Acc: 0.450 Test Loss: 12.151 Test Acc: 0.450
Validation loss decreased (inf --> -0.450260).  Saving model ...
Epoch: 2 cost time: 6.223535537719727
Epoch: 2, Steps: 32 | Train Loss: 6.651 Vali Loss: 24.119 Vali Acc: 0.435 Test Loss: 24.119 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.846426486968994
Epoch: 3, Steps: 32 | Train Loss: 7.903 Vali Loss: 24.217 Vali Acc: 0.481 Test Loss: 24.217 Test Acc: 0.481
Validation loss decreased (-0.450260 --> -0.480674).  Saving model ...
Epoch: 4 cost time: 6.490081071853638
Epoch: 4, Steps: 32 | Train Loss: 9.190 Vali Loss: 39.015 Vali Acc: 0.290 Test Loss: 39.015 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.0851781368255615
Epoch: 5, Steps: 32 | Train Loss: 4.324 Vali Loss: 45.606 Vali Acc: 0.397 Test Loss: 45.606 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.674789905548096
Epoch: 6, Steps: 32 | Train Loss: 7.131 Vali Loss: 40.348 Vali Acc: 0.481 Test Loss: 40.348 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.899136781692505
Epoch: 7, Steps: 32 | Train Loss: 4.695 Vali Loss: 54.087 Vali Acc: 0.519 Test Loss: 54.087 Test Acc: 0.519
Validation loss decreased (-0.480674 --> -0.518543).  Saving model ...
Epoch: 8 cost time: 6.3913092613220215
Epoch: 8, Steps: 32 | Train Loss: 6.409 Vali Loss: 79.542 Vali Acc: 0.298 Test Loss: 79.542 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.263349533081055
Epoch: 9, Steps: 32 | Train Loss: 22.577 Vali Loss: 55.983 Vali Acc: 0.321 Test Loss: 55.983 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.278556823730469
Epoch: 10, Steps: 32 | Train Loss: 8.054 Vali Loss: 72.520 Vali Acc: 0.519 Test Loss: 72.520 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.367854833602905
Epoch: 11, Steps: 32 | Train Loss: 14.306 Vali Loss: 63.297 Vali Acc: 0.542 Test Loss: 63.297 Test Acc: 0.542
Validation loss decreased (-0.518543 --> -0.541352).  Saving model ...
Epoch: 12 cost time: 6.709106922149658
Epoch: 12, Steps: 32 | Train Loss: 8.527 Vali Loss: 65.617 Vali Acc: 0.405 Test Loss: 65.617 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.599149703979492
Epoch: 13, Steps: 32 | Train Loss: 4.441 Vali Loss: 52.184 Vali Acc: 0.542 Test Loss: 52.184 Test Acc: 0.542
Validation loss decreased (-0.541352 --> -0.541463).  Saving model ...
Epoch: 14 cost time: 6.04748797416687
Epoch: 14, Steps: 32 | Train Loss: 3.902 Vali Loss: 58.564 Vali Acc: 0.519 Test Loss: 58.564 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.777579069137573
Epoch: 15, Steps: 32 | Train Loss: 1.828 Vali Loss: 76.834 Vali Acc: 0.527 Test Loss: 76.834 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.1621856689453125
Epoch: 16, Steps: 32 | Train Loss: 1.937 Vali Loss: 61.403 Vali Acc: 0.420 Test Loss: 61.403 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.201201438903809
Epoch: 17, Steps: 32 | Train Loss: 7.797 Vali Loss: 59.301 Vali Acc: 0.550 Test Loss: 59.301 Test Acc: 0.550
Validation loss decreased (-0.541463 --> -0.549025).  Saving model ...
Epoch: 18 cost time: 5.943016767501831
Epoch: 18, Steps: 32 | Train Loss: 0.955 Vali Loss: 66.412 Vali Acc: 0.481 Test Loss: 66.412 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.594991445541382
Epoch: 19, Steps: 32 | Train Loss: 1.493 Vali Loss: 72.994 Vali Acc: 0.466 Test Loss: 72.994 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.248255252838135
Epoch: 20, Steps: 32 | Train Loss: 0.101 Vali Loss: 75.592 Vali Acc: 0.466 Test Loss: 75.592 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.841071367263794
Epoch: 21, Steps: 32 | Train Loss: 0.572 Vali Loss: 81.556 Vali Acc: 0.397 Test Loss: 81.556 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.670260190963745
Epoch: 22, Steps: 32 | Train Loss: 0.620 Vali Loss: 73.688 Vali Acc: 0.450 Test Loss: 73.688 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.396778583526611
Epoch: 23, Steps: 32 | Train Loss: 1.593 Vali Loss: 105.962 Vali Acc: 0.504 Test Loss: 105.962 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.457694053649902
Epoch: 24, Steps: 32 | Train Loss: 0.788 Vali Loss: 74.276 Vali Acc: 0.435 Test Loss: 74.276 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.0365822315216064
Epoch: 25, Steps: 32 | Train Loss: 0.840 Vali Loss: 64.003 Vali Acc: 0.573 Test Loss: 64.003 Test Acc: 0.573
Validation loss decreased (-0.549025 --> -0.571879).  Saving model ...
Epoch: 26 cost time: 6.405333757400513
Epoch: 26, Steps: 32 | Train Loss: 0.505 Vali Loss: 81.403 Vali Acc: 0.588 Test Loss: 81.403 Test Acc: 0.588
Validation loss decreased (-0.571879 --> -0.586972).  Saving model ...
Epoch: 27 cost time: 6.607925653457642
Epoch: 27, Steps: 32 | Train Loss: 0.578 Vali Loss: 105.978 Vali Acc: 0.519 Test Loss: 105.978 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.882969856262207
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 70.363 Vali Acc: 0.496 Test Loss: 70.363 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.640192985534668
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.647 Vali Acc: 0.603 Test Loss: 67.647 Test Acc: 0.603
Validation loss decreased (-0.586972 --> -0.602377).  Saving model ...
Epoch: 30 cost time: 6.524038553237915
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.817 Vali Acc: 0.611 Test Loss: 67.817 Test Acc: 0.611
Validation loss decreased (-0.602377 --> -0.610009).  Saving model ...
Epoch: 31 cost time: 6.395157098770142
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.672043085098267
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.613891124725342
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.899143218994141
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 5.965861082077026
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 6.6156933307647705
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 6.532210111618042
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.823 Vali Acc: 0.603 Test Loss: 67.823 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 5.677254915237427
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.821 Vali Acc: 0.603 Test Loss: 67.821 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.254746675491333
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.819 Vali Acc: 0.603 Test Loss: 67.819 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 6.161684036254883
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.819 Vali Acc: 0.603 Test Loss: 67.819 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 5808085
model size : 26.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.944971323013306
Epoch: 1, Steps: 32 | Train Loss: 8.340 Vali Loss: 11.407 Vali Acc: 0.282 Test Loss: 11.407 Test Acc: 0.282
Validation loss decreased (inf --> -0.282329).  Saving model ...
Epoch: 2 cost time: 6.1209282875061035
Epoch: 2, Steps: 32 | Train Loss: 9.112 Vali Loss: 15.778 Vali Acc: 0.290 Test Loss: 15.778 Test Acc: 0.290
Validation loss decreased (-0.282329 --> -0.289919).  Saving model ...
Epoch: 3 cost time: 6.176408529281616
Epoch: 3, Steps: 32 | Train Loss: 12.452 Vali Loss: 33.280 Vali Acc: 0.481 Test Loss: 33.280 Test Acc: 0.481
Validation loss decreased (-0.289919 --> -0.480583).  Saving model ...
Epoch: 4 cost time: 5.416381597518921
Epoch: 4, Steps: 32 | Train Loss: 15.168 Vali Loss: 15.548 Vali Acc: 0.450 Test Loss: 15.548 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.409157752990723
Epoch: 5, Steps: 32 | Train Loss: 15.546 Vali Loss: 51.445 Vali Acc: 0.443 Test Loss: 51.445 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.296741008758545
Epoch: 6, Steps: 32 | Train Loss: 7.330 Vali Loss: 51.454 Vali Acc: 0.305 Test Loss: 51.454 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.360515832901001
Epoch: 7, Steps: 32 | Train Loss: 8.701 Vali Loss: 57.575 Vali Acc: 0.305 Test Loss: 57.575 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.139198064804077
Epoch: 8, Steps: 32 | Train Loss: 16.654 Vali Loss: 69.877 Vali Acc: 0.481 Test Loss: 69.877 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.199872016906738
Epoch: 9, Steps: 32 | Train Loss: 14.235 Vali Loss: 70.762 Vali Acc: 0.458 Test Loss: 70.762 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.82411527633667
Epoch: 10, Steps: 32 | Train Loss: 6.338 Vali Loss: 59.744 Vali Acc: 0.496 Test Loss: 59.744 Test Acc: 0.496
Validation loss decreased (-0.480583 --> -0.495586).  Saving model ...
Epoch: 11 cost time: 5.853872299194336
Epoch: 11, Steps: 32 | Train Loss: 17.317 Vali Loss: 72.655 Vali Acc: 0.473 Test Loss: 72.655 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.965667009353638
Epoch: 12, Steps: 32 | Train Loss: 4.522 Vali Loss: 66.595 Vali Acc: 0.435 Test Loss: 66.595 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.998894691467285
Epoch: 13, Steps: 32 | Train Loss: 3.778 Vali Loss: 64.732 Vali Acc: 0.550 Test Loss: 64.732 Test Acc: 0.550
Validation loss decreased (-0.495586 --> -0.548971).  Saving model ...
Epoch: 14 cost time: 5.627652168273926
Epoch: 14, Steps: 32 | Train Loss: 2.306 Vali Loss: 75.188 Vali Acc: 0.458 Test Loss: 75.188 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.3062872886657715
Epoch: 15, Steps: 32 | Train Loss: 3.412 Vali Loss: 53.074 Vali Acc: 0.496 Test Loss: 53.074 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.922661542892456
Epoch: 16, Steps: 32 | Train Loss: 5.035 Vali Loss: 62.557 Vali Acc: 0.496 Test Loss: 62.557 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.830226421356201
Epoch: 17, Steps: 32 | Train Loss: 2.092 Vali Loss: 63.331 Vali Acc: 0.557 Test Loss: 63.331 Test Acc: 0.557
Validation loss decreased (-0.548971 --> -0.556619).  Saving model ...
Epoch: 18 cost time: 5.077438592910767
Epoch: 18, Steps: 32 | Train Loss: 6.475 Vali Loss: 70.813 Vali Acc: 0.504 Test Loss: 70.813 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.080299139022827
Epoch: 19, Steps: 32 | Train Loss: 3.807 Vali Loss: 78.755 Vali Acc: 0.382 Test Loss: 78.755 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.12568736076355
Epoch: 20, Steps: 32 | Train Loss: 0.443 Vali Loss: 79.622 Vali Acc: 0.595 Test Loss: 79.622 Test Acc: 0.595
Validation loss decreased (-0.556619 --> -0.594624).  Saving model ...
Epoch: 21 cost time: 6.312138319015503
Epoch: 21, Steps: 32 | Train Loss: 0.787 Vali Loss: 77.469 Vali Acc: 0.534 Test Loss: 77.469 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.372808933258057
Epoch: 22, Steps: 32 | Train Loss: 0.351 Vali Loss: 82.186 Vali Acc: 0.588 Test Loss: 82.186 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.330322504043579
Epoch: 23, Steps: 32 | Train Loss: 0.284 Vali Loss: 67.790 Vali Acc: 0.603 Test Loss: 67.790 Test Acc: 0.603
Validation loss decreased (-0.594624 --> -0.602376).  Saving model ...
Epoch: 24 cost time: 6.239711761474609
Epoch: 24, Steps: 32 | Train Loss: 1.028 Vali Loss: 66.666 Vali Acc: 0.664 Test Loss: 66.666 Test Acc: 0.664
Validation loss decreased (-0.602376 --> -0.663455).  Saving model ...
Epoch: 25 cost time: 6.25909423828125
Epoch: 25, Steps: 32 | Train Loss: 0.321 Vali Loss: 84.563 Vali Acc: 0.588 Test Loss: 84.563 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.377530097961426
Epoch: 26, Steps: 32 | Train Loss: 0.272 Vali Loss: 67.591 Vali Acc: 0.603 Test Loss: 67.591 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.192097902297974
Epoch: 27, Steps: 32 | Train Loss: 0.138 Vali Loss: 86.697 Vali Acc: 0.443 Test Loss: 86.697 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.223836421966553
Epoch: 28, Steps: 32 | Train Loss: 1.310 Vali Loss: 69.765 Vali Acc: 0.603 Test Loss: 69.765 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.838364124298096
Epoch: 29, Steps: 32 | Train Loss: 0.271 Vali Loss: 99.592 Vali Acc: 0.595 Test Loss: 99.592 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.287918567657471
Epoch: 30, Steps: 32 | Train Loss: 1.303 Vali Loss: 91.838 Vali Acc: 0.580 Test Loss: 91.838 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.114922285079956
Epoch: 31, Steps: 32 | Train Loss: 0.286 Vali Loss: 93.669 Vali Acc: 0.435 Test Loss: 93.669 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.413955926895142
Epoch: 32, Steps: 32 | Train Loss: 0.968 Vali Loss: 104.014 Vali Acc: 0.313 Test Loss: 104.014 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.816294431686401
Epoch: 33, Steps: 32 | Train Loss: 5.453 Vali Loss: 84.745 Vali Acc: 0.611 Test Loss: 84.745 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.340535640716553
Epoch: 34, Steps: 32 | Train Loss: 2.239 Vali Loss: 69.528 Vali Acc: 0.565 Test Loss: 69.528 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 5808085
model size : 26.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.563520431518555
Epoch: 1, Steps: 32 | Train Loss: 7.776 Vali Loss: 15.724 Vali Acc: 0.321 Test Loss: 15.724 Test Acc: 0.321
Validation loss decreased (inf --> -0.320453).  Saving model ...
Epoch: 2 cost time: 4.559151887893677
Epoch: 2, Steps: 32 | Train Loss: 12.084 Vali Loss: 16.772 Vali Acc: 0.496 Test Loss: 16.772 Test Acc: 0.496
Validation loss decreased (-0.320453 --> -0.496015).  Saving model ...
Epoch: 3 cost time: 5.98246955871582
Epoch: 3, Steps: 32 | Train Loss: 19.032 Vali Loss: 27.851 Vali Acc: 0.481 Test Loss: 27.851 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.969368934631348
Epoch: 4, Steps: 32 | Train Loss: 16.100 Vali Loss: 40.673 Vali Acc: 0.290 Test Loss: 40.673 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.771353006362915
Epoch: 5, Steps: 32 | Train Loss: 17.095 Vali Loss: 14.037 Vali Acc: 0.473 Test Loss: 14.037 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.004563093185425
Epoch: 6, Steps: 32 | Train Loss: 7.503 Vali Loss: 24.990 Vali Acc: 0.336 Test Loss: 24.990 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.362130165100098
Epoch: 7, Steps: 32 | Train Loss: 14.552 Vali Loss: 44.091 Vali Acc: 0.313 Test Loss: 44.091 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.855720281600952
Epoch: 8, Steps: 32 | Train Loss: 9.781 Vali Loss: 43.729 Vali Acc: 0.427 Test Loss: 43.729 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.2661213874816895
Epoch: 9, Steps: 32 | Train Loss: 7.633 Vali Loss: 60.487 Vali Acc: 0.313 Test Loss: 60.487 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.2936835289001465
Epoch: 10, Steps: 32 | Train Loss: 12.048 Vali Loss: 78.702 Vali Acc: 0.290 Test Loss: 78.702 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 5.981860399246216
Epoch: 11, Steps: 32 | Train Loss: 6.453 Vali Loss: 44.736 Vali Acc: 0.542 Test Loss: 44.736 Test Acc: 0.542
Validation loss decreased (-0.496015 --> -0.541537).  Saving model ...
Epoch: 12 cost time: 5.20237922668457
Epoch: 12, Steps: 32 | Train Loss: 7.624 Vali Loss: 60.236 Vali Acc: 0.359 Test Loss: 60.236 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.463550329208374
Epoch: 13, Steps: 32 | Train Loss: 9.546 Vali Loss: 123.126 Vali Acc: 0.206 Test Loss: 123.126 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.152085065841675
Epoch: 14, Steps: 32 | Train Loss: 16.487 Vali Loss: 87.411 Vali Acc: 0.290 Test Loss: 87.411 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.949830770492554
Epoch: 15, Steps: 32 | Train Loss: 4.161 Vali Loss: 59.237 Vali Acc: 0.397 Test Loss: 59.237 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.496536731719971
Epoch: 16, Steps: 32 | Train Loss: 4.352 Vali Loss: 51.655 Vali Acc: 0.443 Test Loss: 51.655 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.9260382652282715
Epoch: 17, Steps: 32 | Train Loss: 0.681 Vali Loss: 34.383 Vali Acc: 0.595 Test Loss: 34.383 Test Acc: 0.595
Validation loss decreased (-0.541537 --> -0.595076).  Saving model ...
Epoch: 18 cost time: 6.121528387069702
Epoch: 18, Steps: 32 | Train Loss: 0.278 Vali Loss: 42.715 Vali Acc: 0.634 Test Loss: 42.715 Test Acc: 0.634
Validation loss decreased (-0.595076 --> -0.633161).  Saving model ...
Epoch: 19 cost time: 5.027951717376709
Epoch: 19, Steps: 32 | Train Loss: 0.996 Vali Loss: 45.079 Vali Acc: 0.481 Test Loss: 45.079 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.575281858444214
Epoch: 20, Steps: 32 | Train Loss: 1.990 Vali Loss: 53.445 Vali Acc: 0.427 Test Loss: 53.445 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.091418504714966
Epoch: 21, Steps: 32 | Train Loss: 5.497 Vali Loss: 47.546 Vali Acc: 0.450 Test Loss: 47.546 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.5873024463653564
Epoch: 22, Steps: 32 | Train Loss: 2.978 Vali Loss: 87.127 Vali Acc: 0.321 Test Loss: 87.127 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.145281076431274
Epoch: 23, Steps: 32 | Train Loss: 6.241 Vali Loss: 53.823 Vali Acc: 0.519 Test Loss: 53.823 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.076127052307129
Epoch: 24, Steps: 32 | Train Loss: 0.688 Vali Loss: 62.735 Vali Acc: 0.542 Test Loss: 62.735 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.498434066772461
Epoch: 25, Steps: 32 | Train Loss: 0.002 Vali Loss: 71.377 Vali Acc: 0.511 Test Loss: 71.377 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.602077960968018
Epoch: 26, Steps: 32 | Train Loss: 2.143 Vali Loss: 123.955 Vali Acc: 0.252 Test Loss: 123.955 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.926323175430298
Epoch: 27, Steps: 32 | Train Loss: 1.500 Vali Loss: 71.469 Vali Acc: 0.573 Test Loss: 71.469 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.288784980773926
Epoch: 28, Steps: 32 | Train Loss: 1.516 Vali Loss: 117.532 Vali Acc: 0.328 Test Loss: 117.532 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5808085
model size : 26.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.754066467285156
Epoch: 1, Steps: 32 | Train Loss: 5.399 Vali Loss: 11.966 Vali Acc: 0.229 Test Loss: 11.966 Test Acc: 0.229
Validation loss decreased (inf --> -0.228888).  Saving model ...
Epoch: 2 cost time: 7.254799842834473
Epoch: 2, Steps: 32 | Train Loss: 6.360 Vali Loss: 13.814 Vali Acc: 0.511 Test Loss: 13.814 Test Acc: 0.511
Validation loss decreased (-0.228888 --> -0.511312).  Saving model ...
Epoch: 3 cost time: 6.909296274185181
Epoch: 3, Steps: 32 | Train Loss: 8.809 Vali Loss: 19.280 Vali Acc: 0.496 Test Loss: 19.280 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.723545789718628
Epoch: 4, Steps: 32 | Train Loss: 6.988 Vali Loss: 23.838 Vali Acc: 0.359 Test Loss: 23.838 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.279144287109375
Epoch: 5, Steps: 32 | Train Loss: 6.929 Vali Loss: 28.067 Vali Acc: 0.336 Test Loss: 28.067 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.37992000579834
Epoch: 6, Steps: 32 | Train Loss: 4.830 Vali Loss: 27.786 Vali Acc: 0.351 Test Loss: 27.786 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.9875733852386475
Epoch: 7, Steps: 32 | Train Loss: 3.427 Vali Loss: 36.002 Vali Acc: 0.397 Test Loss: 36.002 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 7.006403923034668
Epoch: 8, Steps: 32 | Train Loss: 9.553 Vali Loss: 69.601 Vali Acc: 0.321 Test Loss: 69.601 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 7.225528001785278
Epoch: 9, Steps: 32 | Train Loss: 4.512 Vali Loss: 73.704 Vali Acc: 0.496 Test Loss: 73.704 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 6.56018328666687
Epoch: 10, Steps: 32 | Train Loss: 7.930 Vali Loss: 83.242 Vali Acc: 0.450 Test Loss: 83.242 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 7.2324440479278564
Epoch: 11, Steps: 32 | Train Loss: 11.630 Vali Loss: 120.182 Vali Acc: 0.328 Test Loss: 120.182 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 7.032787322998047
Epoch: 12, Steps: 32 | Train Loss: 11.994 Vali Loss: 94.779 Vali Acc: 0.450 Test Loss: 94.779 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 5791701
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.30581283569336
Epoch: 1, Steps: 32 | Train Loss: 5.915 Vali Loss: 12.574 Vali Acc: 0.321 Test Loss: 12.574 Test Acc: 0.321
Validation loss decreased (inf --> -0.320485).  Saving model ...
Epoch: 2 cost time: 6.974962949752808
Epoch: 2, Steps: 32 | Train Loss: 6.041 Vali Loss: 12.376 Vali Acc: 0.328 Test Loss: 12.376 Test Acc: 0.328
Validation loss decreased (-0.320485 --> -0.328121).  Saving model ...
Epoch: 3 cost time: 6.175745010375977
Epoch: 3, Steps: 32 | Train Loss: 4.173 Vali Loss: 24.776 Vali Acc: 0.473 Test Loss: 24.776 Test Acc: 0.473
Validation loss decreased (-0.328121 --> -0.473035).  Saving model ...
Epoch: 4 cost time: 6.369373083114624
Epoch: 4, Steps: 32 | Train Loss: 12.278 Vali Loss: 33.202 Vali Acc: 0.351 Test Loss: 33.202 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.392824649810791
Epoch: 5, Steps: 32 | Train Loss: 10.981 Vali Loss: 34.005 Vali Acc: 0.336 Test Loss: 34.005 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.748745679855347
Epoch: 6, Steps: 32 | Train Loss: 16.166 Vali Loss: 32.622 Vali Acc: 0.351 Test Loss: 32.622 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.673413276672363
Epoch: 7, Steps: 32 | Train Loss: 13.267 Vali Loss: 25.363 Vali Acc: 0.565 Test Loss: 25.363 Test Acc: 0.565
Validation loss decreased (-0.473035 --> -0.564632).  Saving model ...
Epoch: 8 cost time: 6.269540309906006
Epoch: 8, Steps: 32 | Train Loss: 2.161 Vali Loss: 28.545 Vali Acc: 0.435 Test Loss: 28.545 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.755933523178101
Epoch: 9, Steps: 32 | Train Loss: 2.307 Vali Loss: 50.693 Vali Acc: 0.260 Test Loss: 50.693 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.934458255767822
Epoch: 10, Steps: 32 | Train Loss: 5.734 Vali Loss: 49.398 Vali Acc: 0.435 Test Loss: 49.398 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.675379753112793
Epoch: 11, Steps: 32 | Train Loss: 9.762 Vali Loss: 54.407 Vali Acc: 0.473 Test Loss: 54.407 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.539301872253418
Epoch: 12, Steps: 32 | Train Loss: 10.705 Vali Loss: 60.106 Vali Acc: 0.450 Test Loss: 60.106 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.787073612213135
Epoch: 13, Steps: 32 | Train Loss: 14.173 Vali Loss: 47.794 Vali Acc: 0.473 Test Loss: 47.794 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.123649835586548
Epoch: 14, Steps: 32 | Train Loss: 4.654 Vali Loss: 118.209 Vali Acc: 0.527 Test Loss: 118.209 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.578927040100098
Epoch: 15, Steps: 32 | Train Loss: 14.596 Vali Loss: 97.878 Vali Acc: 0.458 Test Loss: 97.878 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.777865409851074
Epoch: 16, Steps: 32 | Train Loss: 0.817 Vali Loss: 97.442 Vali Acc: 0.534 Test Loss: 97.442 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 6.495837688446045
Epoch: 17, Steps: 32 | Train Loss: 2.993 Vali Loss: 83.200 Vali Acc: 0.580 Test Loss: 83.200 Test Acc: 0.580
Validation loss decreased (-0.564632 --> -0.579321).  Saving model ...
Epoch: 18 cost time: 6.6102330684661865
Epoch: 18, Steps: 32 | Train Loss: 1.145 Vali Loss: 88.478 Vali Acc: 0.397 Test Loss: 88.478 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.4963085651397705
Epoch: 19, Steps: 32 | Train Loss: 0.939 Vali Loss: 80.073 Vali Acc: 0.595 Test Loss: 80.073 Test Acc: 0.595
Validation loss decreased (-0.579321 --> -0.594619).  Saving model ...
Epoch: 20 cost time: 6.535449981689453
Epoch: 20, Steps: 32 | Train Loss: 0.295 Vali Loss: 92.393 Vali Acc: 0.374 Test Loss: 92.393 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.953887939453125
Epoch: 21, Steps: 32 | Train Loss: 0.494 Vali Loss: 84.710 Vali Acc: 0.565 Test Loss: 84.710 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.9901087284088135
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.213 Vali Acc: 0.550 Test Loss: 79.213 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.1093409061431885
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.395 Vali Acc: 0.527 Test Loss: 79.395 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.3662989139556885
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.727 Vali Acc: 0.618 Test Loss: 86.727 Test Acc: 0.618
Validation loss decreased (-0.594619 --> -0.617453).  Saving model ...
Epoch: 25 cost time: 6.6557228565216064
Epoch: 25, Steps: 32 | Train Loss: 1.415 Vali Loss: 98.108 Vali Acc: 0.580 Test Loss: 98.108 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.7523133754730225
Epoch: 26, Steps: 32 | Train Loss: 4.284 Vali Loss: 113.887 Vali Acc: 0.565 Test Loss: 113.887 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.495559215545654
Epoch: 27, Steps: 32 | Train Loss: 13.364 Vali Loss: 108.972 Vali Acc: 0.359 Test Loss: 108.972 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.848739862442017
Epoch: 28, Steps: 32 | Train Loss: 0.163 Vali Loss: 80.531 Vali Acc: 0.565 Test Loss: 80.531 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.834876537322998
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.151 Vali Acc: 0.557 Test Loss: 82.151 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.323312520980835
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.208 Vali Acc: 0.557 Test Loss: 82.208 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.691287994384766
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 80.449 Vali Acc: 0.565 Test Loss: 80.449 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 6.060275077819824
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 80.229 Vali Acc: 0.565 Test Loss: 80.229 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.752495765686035
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 80.220 Vali Acc: 0.565 Test Loss: 80.220 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.44979453086853
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 80.220 Vali Acc: 0.565 Test Loss: 80.220 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 5791701
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.798239707946777
Epoch: 1, Steps: 32 | Train Loss: 8.042 Vali Loss: 10.270 Vali Acc: 0.466 Test Loss: 10.270 Test Acc: 0.466
Validation loss decreased (inf --> -0.465546).  Saving model ...
Epoch: 2 cost time: 5.915549993515015
Epoch: 2, Steps: 32 | Train Loss: 11.245 Vali Loss: 15.112 Vali Acc: 0.496 Test Loss: 15.112 Test Acc: 0.496
Validation loss decreased (-0.465546 --> -0.496032).  Saving model ...
Epoch: 3 cost time: 5.489134311676025
Epoch: 3, Steps: 32 | Train Loss: 10.487 Vali Loss: 28.862 Vali Acc: 0.206 Test Loss: 28.862 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.820127248764038
Epoch: 4, Steps: 32 | Train Loss: 8.881 Vali Loss: 44.458 Vali Acc: 0.275 Test Loss: 44.458 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.368227958679199
Epoch: 5, Steps: 32 | Train Loss: 14.984 Vali Loss: 18.156 Vali Acc: 0.481 Test Loss: 18.156 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.099255323410034
Epoch: 6, Steps: 32 | Train Loss: 11.860 Vali Loss: 75.158 Vali Acc: 0.214 Test Loss: 75.158 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.0983428955078125
Epoch: 7, Steps: 32 | Train Loss: 19.618 Vali Loss: 37.736 Vali Acc: 0.321 Test Loss: 37.736 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 5.755069017410278
Epoch: 8, Steps: 32 | Train Loss: 11.488 Vali Loss: 33.240 Vali Acc: 0.458 Test Loss: 33.240 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.548894166946411
Epoch: 9, Steps: 32 | Train Loss: 8.650 Vali Loss: 37.171 Vali Acc: 0.305 Test Loss: 37.171 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 5.172204494476318
Epoch: 10, Steps: 32 | Train Loss: 11.397 Vali Loss: 77.755 Vali Acc: 0.489 Test Loss: 77.755 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 6.12807297706604
Epoch: 11, Steps: 32 | Train Loss: 7.500 Vali Loss: 72.263 Vali Acc: 0.534 Test Loss: 72.263 Test Acc: 0.534
Validation loss decreased (-0.496032 --> -0.533629).  Saving model ...
Epoch: 12 cost time: 6.204820394515991
Epoch: 12, Steps: 32 | Train Loss: 4.055 Vali Loss: 83.373 Vali Acc: 0.382 Test Loss: 83.373 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.976115703582764
Epoch: 13, Steps: 32 | Train Loss: 4.301 Vali Loss: 83.584 Vali Acc: 0.466 Test Loss: 83.584 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.108607292175293
Epoch: 14, Steps: 32 | Train Loss: 10.348 Vali Loss: 99.859 Vali Acc: 0.511 Test Loss: 99.859 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.151194334030151
Epoch: 15, Steps: 32 | Train Loss: 4.209 Vali Loss: 91.296 Vali Acc: 0.412 Test Loss: 91.296 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.75042200088501
Epoch: 16, Steps: 32 | Train Loss: 3.101 Vali Loss: 69.620 Vali Acc: 0.435 Test Loss: 69.620 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.51526403427124
Epoch: 17, Steps: 32 | Train Loss: 1.315 Vali Loss: 73.254 Vali Acc: 0.496 Test Loss: 73.254 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.378555536270142
Epoch: 18, Steps: 32 | Train Loss: 4.044 Vali Loss: 101.846 Vali Acc: 0.534 Test Loss: 101.846 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.878904104232788
Epoch: 19, Steps: 32 | Train Loss: 0.700 Vali Loss: 104.389 Vali Acc: 0.542 Test Loss: 104.389 Test Acc: 0.542
Validation loss decreased (-0.533629 --> -0.540941).  Saving model ...
Epoch: 20 cost time: 6.118788957595825
Epoch: 20, Steps: 32 | Train Loss: 1.878 Vali Loss: 106.689 Vali Acc: 0.473 Test Loss: 106.689 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.027788400650024
Epoch: 21, Steps: 32 | Train Loss: 6.793 Vali Loss: 137.480 Vali Acc: 0.366 Test Loss: 137.480 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.463495492935181
Epoch: 22, Steps: 32 | Train Loss: 8.695 Vali Loss: 73.618 Vali Acc: 0.634 Test Loss: 73.618 Test Acc: 0.634
Validation loss decreased (-0.540941 --> -0.632852).  Saving model ...
Epoch: 23 cost time: 5.5381083488464355
Epoch: 23, Steps: 32 | Train Loss: 4.279 Vali Loss: 99.287 Vali Acc: 0.351 Test Loss: 99.287 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.435848236083984
Epoch: 24, Steps: 32 | Train Loss: 6.905 Vali Loss: 94.671 Vali Acc: 0.519 Test Loss: 94.671 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.30258584022522
Epoch: 25, Steps: 32 | Train Loss: 1.949 Vali Loss: 84.772 Vali Acc: 0.550 Test Loss: 84.772 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.296321630477905
Epoch: 26, Steps: 32 | Train Loss: 4.328 Vali Loss: 87.179 Vali Acc: 0.557 Test Loss: 87.179 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.201482772827148
Epoch: 27, Steps: 32 | Train Loss: 1.382 Vali Loss: 87.510 Vali Acc: 0.450 Test Loss: 87.510 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.1459455490112305
Epoch: 28, Steps: 32 | Train Loss: 0.208 Vali Loss: 92.274 Vali Acc: 0.450 Test Loss: 92.274 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.107222080230713
Epoch: 29, Steps: 32 | Train Loss: 0.358 Vali Loss: 99.678 Vali Acc: 0.519 Test Loss: 99.678 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.287521123886108
Epoch: 30, Steps: 32 | Train Loss: 1.001 Vali Loss: 78.613 Vali Acc: 0.550 Test Loss: 78.613 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.109956979751587
Epoch: 31, Steps: 32 | Train Loss: 0.754 Vali Loss: 110.185 Vali Acc: 0.382 Test Loss: 110.185 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.411459445953369
Epoch: 32, Steps: 32 | Train Loss: 1.024 Vali Loss: 127.099 Vali Acc: 0.313 Test Loss: 127.099 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5791701
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.091439723968506
Epoch: 1, Steps: 32 | Train Loss: 7.821 Vali Loss: 6.611 Vali Acc: 0.496 Test Loss: 6.611 Test Acc: 0.496
Validation loss decreased (inf --> -0.496117).  Saving model ...
Epoch: 2 cost time: 5.300481557846069
Epoch: 2, Steps: 32 | Train Loss: 14.771 Vali Loss: 19.829 Vali Acc: 0.160 Test Loss: 19.829 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4162256717681885
Epoch: 3, Steps: 32 | Train Loss: 10.719 Vali Loss: 26.789 Vali Acc: 0.344 Test Loss: 26.789 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.00797700881958
Epoch: 4, Steps: 32 | Train Loss: 15.437 Vali Loss: 34.404 Vali Acc: 0.298 Test Loss: 34.404 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.65885329246521
Epoch: 5, Steps: 32 | Train Loss: 13.583 Vali Loss: 34.584 Vali Acc: 0.321 Test Loss: 34.584 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.985643625259399
Epoch: 6, Steps: 32 | Train Loss: 28.678 Vali Loss: 22.561 Vali Acc: 0.504 Test Loss: 22.561 Test Acc: 0.504
Validation loss decreased (-0.496117 --> -0.503591).  Saving model ...
Epoch: 7 cost time: 5.391202449798584
Epoch: 7, Steps: 32 | Train Loss: 16.215 Vali Loss: 21.771 Vali Acc: 0.519 Test Loss: 21.771 Test Acc: 0.519
Validation loss decreased (-0.503591 --> -0.518866).  Saving model ...
Epoch: 8 cost time: 6.2074973583221436
Epoch: 8, Steps: 32 | Train Loss: 13.855 Vali Loss: 41.972 Vali Acc: 0.344 Test Loss: 41.972 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.947327613830566
Epoch: 9, Steps: 32 | Train Loss: 8.565 Vali Loss: 44.488 Vali Acc: 0.351 Test Loss: 44.488 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.786658763885498
Epoch: 10, Steps: 32 | Train Loss: 12.594 Vali Loss: 32.371 Vali Acc: 0.481 Test Loss: 32.371 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.191332101821899
Epoch: 11, Steps: 32 | Train Loss: 5.931 Vali Loss: 48.343 Vali Acc: 0.374 Test Loss: 48.343 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.192473411560059
Epoch: 12, Steps: 32 | Train Loss: 22.237 Vali Loss: 106.499 Vali Acc: 0.275 Test Loss: 106.499 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.266769886016846
Epoch: 13, Steps: 32 | Train Loss: 13.718 Vali Loss: 69.868 Vali Acc: 0.550 Test Loss: 69.868 Test Acc: 0.550
Validation loss decreased (-0.518866 --> -0.548920).  Saving model ...
Epoch: 14 cost time: 5.338205814361572
Epoch: 14, Steps: 32 | Train Loss: 5.454 Vali Loss: 64.947 Vali Acc: 0.557 Test Loss: 64.947 Test Acc: 0.557
Validation loss decreased (-0.548920 --> -0.556602).  Saving model ...
Epoch: 15 cost time: 5.8908679485321045
Epoch: 15, Steps: 32 | Train Loss: 5.270 Vali Loss: 93.531 Vali Acc: 0.344 Test Loss: 93.531 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.732139825820923
Epoch: 16, Steps: 32 | Train Loss: 9.210 Vali Loss: 73.211 Vali Acc: 0.366 Test Loss: 73.211 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.452043533325195
Epoch: 17, Steps: 32 | Train Loss: 3.159 Vali Loss: 58.433 Vali Acc: 0.611 Test Loss: 58.433 Test Acc: 0.611
Validation loss decreased (-0.556602 --> -0.610103).  Saving model ...
Epoch: 18 cost time: 5.191854000091553
Epoch: 18, Steps: 32 | Train Loss: 1.185 Vali Loss: 61.899 Vali Acc: 0.519 Test Loss: 61.899 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.1635026931762695
Epoch: 19, Steps: 32 | Train Loss: 2.508 Vali Loss: 62.183 Vali Acc: 0.557 Test Loss: 62.183 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.413207292556763
Epoch: 20, Steps: 32 | Train Loss: 1.710 Vali Loss: 67.571 Vali Acc: 0.527 Test Loss: 67.571 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.88827657699585
Epoch: 21, Steps: 32 | Train Loss: 3.066 Vali Loss: 61.093 Vali Acc: 0.603 Test Loss: 61.093 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.613769292831421
Epoch: 22, Steps: 32 | Train Loss: 5.403 Vali Loss: 56.691 Vali Acc: 0.588 Test Loss: 56.691 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.7751264572143555
Epoch: 23, Steps: 32 | Train Loss: 1.461 Vali Loss: 80.481 Vali Acc: 0.511 Test Loss: 80.481 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.0602147579193115
Epoch: 24, Steps: 32 | Train Loss: 1.301 Vali Loss: 70.944 Vali Acc: 0.565 Test Loss: 70.944 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.526692152023315
Epoch: 25, Steps: 32 | Train Loss: 5.249 Vali Loss: 98.045 Vali Acc: 0.504 Test Loss: 98.045 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.292849540710449
Epoch: 26, Steps: 32 | Train Loss: 0.271 Vali Loss: 67.299 Vali Acc: 0.656 Test Loss: 67.299 Test Acc: 0.656
Validation loss decreased (-0.610103 --> -0.655816).  Saving model ...
Epoch: 27 cost time: 5.5774993896484375
Epoch: 27, Steps: 32 | Train Loss: 0.705 Vali Loss: 120.166 Vali Acc: 0.450 Test Loss: 120.166 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.193084955215454
Epoch: 28, Steps: 32 | Train Loss: 1.313 Vali Loss: 77.500 Vali Acc: 0.611 Test Loss: 77.500 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.405213832855225
Epoch: 29, Steps: 32 | Train Loss: 1.379 Vali Loss: 111.360 Vali Acc: 0.489 Test Loss: 111.360 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.646390438079834
Epoch: 30, Steps: 32 | Train Loss: 0.445 Vali Loss: 122.383 Vali Acc: 0.435 Test Loss: 122.383 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.370044469833374
Epoch: 31, Steps: 32 | Train Loss: 1.344 Vali Loss: 75.496 Vali Acc: 0.443 Test Loss: 75.496 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.1124184131622314
Epoch: 32, Steps: 32 | Train Loss: 0.034 Vali Loss: 103.002 Vali Acc: 0.397 Test Loss: 103.002 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 5.774141311645508
Epoch: 33, Steps: 32 | Train Loss: 1.666 Vali Loss: 90.019 Vali Acc: 0.618 Test Loss: 90.019 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.4773108959198
Epoch: 34, Steps: 32 | Train Loss: 2.191 Vali Loss: 114.190 Vali Acc: 0.565 Test Loss: 114.190 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.859804391860962
Epoch: 35, Steps: 32 | Train Loss: 3.694 Vali Loss: 99.484 Vali Acc: 0.359 Test Loss: 99.484 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.047739028930664
Epoch: 36, Steps: 32 | Train Loss: 1.145 Vali Loss: 84.552 Vali Acc: 0.611 Test Loss: 84.552 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 5791701
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.437152624130249
Epoch: 1, Steps: 32 | Train Loss: 3.431 Vali Loss: 7.028 Vali Acc: 0.145 Test Loss: 7.028 Test Acc: 0.145
Validation loss decreased (inf --> -0.144968).  Saving model ...
Epoch: 2 cost time: 5.033433198928833
Epoch: 2, Steps: 32 | Train Loss: 3.067 Vali Loss: 8.198 Vali Acc: 0.458 Test Loss: 8.198 Test Acc: 0.458
Validation loss decreased (-0.144968 --> -0.457933).  Saving model ...
Epoch: 3 cost time: 4.911432981491089
Epoch: 3, Steps: 32 | Train Loss: 4.019 Vali Loss: 6.762 Vali Acc: 0.420 Test Loss: 6.762 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.346113920211792
Epoch: 4, Steps: 32 | Train Loss: 3.085 Vali Loss: 6.680 Vali Acc: 0.420 Test Loss: 6.680 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.558698892593384
Epoch: 5, Steps: 32 | Train Loss: 2.507 Vali Loss: 6.645 Vali Acc: 0.473 Test Loss: 6.645 Test Acc: 0.473
Validation loss decreased (-0.457933 --> -0.473216).  Saving model ...
Epoch: 6 cost time: 4.9203081130981445
Epoch: 6, Steps: 32 | Train Loss: 1.147 Vali Loss: 9.673 Vali Acc: 0.473 Test Loss: 9.673 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.516795635223389
Epoch: 7, Steps: 32 | Train Loss: 2.322 Vali Loss: 11.319 Vali Acc: 0.496 Test Loss: 11.319 Test Acc: 0.496
Validation loss decreased (-0.473216 --> -0.496070).  Saving model ...
Epoch: 8 cost time: 5.231027364730835
Epoch: 8, Steps: 32 | Train Loss: 4.649 Vali Loss: 18.828 Vali Acc: 0.290 Test Loss: 18.828 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.320329904556274
Epoch: 9, Steps: 32 | Train Loss: 0.862 Vali Loss: 16.311 Vali Acc: 0.527 Test Loss: 16.311 Test Acc: 0.527
Validation loss decreased (-0.496070 --> -0.526554).  Saving model ...
Epoch: 10 cost time: 5.170028209686279
Epoch: 10, Steps: 32 | Train Loss: 1.046 Vali Loss: 20.297 Vali Acc: 0.282 Test Loss: 20.297 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.161980390548706
Epoch: 11, Steps: 32 | Train Loss: 7.002 Vali Loss: 48.180 Vali Acc: 0.481 Test Loss: 48.180 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.397670269012451
Epoch: 12, Steps: 32 | Train Loss: 7.268 Vali Loss: 25.163 Vali Acc: 0.382 Test Loss: 25.163 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.6612548828125
Epoch: 13, Steps: 32 | Train Loss: 0.502 Vali Loss: 26.618 Vali Acc: 0.542 Test Loss: 26.618 Test Acc: 0.542
Validation loss decreased (-0.526554 --> -0.541719).  Saving model ...
Epoch: 14 cost time: 4.890378713607788
Epoch: 14, Steps: 32 | Train Loss: 4.543 Vali Loss: 34.844 Vali Acc: 0.420 Test Loss: 34.844 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.33657431602478
Epoch: 15, Steps: 32 | Train Loss: 2.780 Vali Loss: 28.536 Vali Acc: 0.412 Test Loss: 28.536 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.882896661758423
Epoch: 16, Steps: 32 | Train Loss: 2.473 Vali Loss: 36.814 Vali Acc: 0.374 Test Loss: 36.814 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.5136330127716064
Epoch: 17, Steps: 32 | Train Loss: 3.340 Vali Loss: 49.940 Vali Acc: 0.321 Test Loss: 49.940 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.102586507797241
Epoch: 18, Steps: 32 | Train Loss: 3.379 Vali Loss: 43.189 Vali Acc: 0.298 Test Loss: 43.189 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.492833375930786
Epoch: 19, Steps: 32 | Train Loss: 0.069 Vali Loss: 39.720 Vali Acc: 0.435 Test Loss: 39.720 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.190560817718506
Epoch: 20, Steps: 32 | Train Loss: 0.193 Vali Loss: 25.795 Vali Acc: 0.557 Test Loss: 25.795 Test Acc: 0.557
Validation loss decreased (-0.541719 --> -0.556994).  Saving model ...
Epoch: 21 cost time: 5.0793890953063965
Epoch: 21, Steps: 32 | Train Loss: 0.173 Vali Loss: 26.278 Vali Acc: 0.511 Test Loss: 26.278 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.275303602218628
Epoch: 22, Steps: 32 | Train Loss: 0.059 Vali Loss: 35.492 Vali Acc: 0.504 Test Loss: 35.492 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.318936824798584
Epoch: 23, Steps: 32 | Train Loss: 0.030 Vali Loss: 39.088 Vali Acc: 0.557 Test Loss: 39.088 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.463829278945923
Epoch: 24, Steps: 32 | Train Loss: 4.097 Vali Loss: 45.586 Vali Acc: 0.527 Test Loss: 45.586 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.739369630813599
Epoch: 25, Steps: 32 | Train Loss: 0.730 Vali Loss: 32.305 Vali Acc: 0.527 Test Loss: 32.305 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.107640027999878
Epoch: 26, Steps: 32 | Train Loss: 0.565 Vali Loss: 51.891 Vali Acc: 0.336 Test Loss: 51.891 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.049145698547363
Epoch: 27, Steps: 32 | Train Loss: 2.123 Vali Loss: 37.921 Vali Acc: 0.542 Test Loss: 37.921 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.2607667446136475
Epoch: 28, Steps: 32 | Train Loss: 4.192 Vali Loss: 45.343 Vali Acc: 0.496 Test Loss: 45.343 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.552998781204224
Epoch: 29, Steps: 32 | Train Loss: 0.321 Vali Loss: 47.681 Vali Acc: 0.427 Test Loss: 47.681 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.939350605010986
Epoch: 30, Steps: 32 | Train Loss: 0.319 Vali Loss: 49.882 Vali Acc: 0.458 Test Loss: 49.882 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3145749
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.499056816101074
Epoch: 1, Steps: 32 | Train Loss: 3.277 Vali Loss: 4.403 Vali Acc: 0.473 Test Loss: 4.403 Test Acc: 0.473
Validation loss decreased (inf --> -0.473238).  Saving model ...
Epoch: 2 cost time: 5.200633525848389
Epoch: 2, Steps: 32 | Train Loss: 2.218 Vali Loss: 8.323 Vali Acc: 0.183 Test Loss: 8.323 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.5229332447052
Epoch: 3, Steps: 32 | Train Loss: 3.208 Vali Loss: 9.357 Vali Acc: 0.397 Test Loss: 9.357 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.2860426902771
Epoch: 4, Steps: 32 | Train Loss: 4.494 Vali Loss: 15.435 Vali Acc: 0.260 Test Loss: 15.435 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.210655689239502
Epoch: 5, Steps: 32 | Train Loss: 3.859 Vali Loss: 9.150 Vali Acc: 0.305 Test Loss: 9.150 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.953516960144043
Epoch: 6, Steps: 32 | Train Loss: 3.240 Vali Loss: 19.473 Vali Acc: 0.359 Test Loss: 19.473 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.297661304473877
Epoch: 7, Steps: 32 | Train Loss: 2.760 Vali Loss: 12.902 Vali Acc: 0.351 Test Loss: 12.902 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.989827871322632
Epoch: 8, Steps: 32 | Train Loss: 2.722 Vali Loss: 19.343 Vali Acc: 0.290 Test Loss: 19.343 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.909859657287598
Epoch: 9, Steps: 32 | Train Loss: 7.366 Vali Loss: 39.140 Vali Acc: 0.244 Test Loss: 39.140 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.721194505691528
Epoch: 10, Steps: 32 | Train Loss: 6.041 Vali Loss: 23.441 Vali Acc: 0.412 Test Loss: 23.441 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.530799150466919
Epoch: 11, Steps: 32 | Train Loss: 8.372 Vali Loss: 38.515 Vali Acc: 0.534 Test Loss: 38.515 Test Acc: 0.534
Validation loss decreased (-0.473238 --> -0.533966).  Saving model ...
Epoch: 12 cost time: 5.586181879043579
Epoch: 12, Steps: 32 | Train Loss: 5.405 Vali Loss: 19.867 Vali Acc: 0.466 Test Loss: 19.867 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.738584518432617
Epoch: 13, Steps: 32 | Train Loss: 1.854 Vali Loss: 27.354 Vali Acc: 0.397 Test Loss: 27.354 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.183286190032959
Epoch: 14, Steps: 32 | Train Loss: 2.692 Vali Loss: 27.788 Vali Acc: 0.450 Test Loss: 27.788 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.625635862350464
Epoch: 15, Steps: 32 | Train Loss: 0.856 Vali Loss: 28.703 Vali Acc: 0.511 Test Loss: 28.703 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.862554311752319
Epoch: 16, Steps: 32 | Train Loss: 0.620 Vali Loss: 33.562 Vali Acc: 0.527 Test Loss: 33.562 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.335675001144409
Epoch: 17, Steps: 32 | Train Loss: 2.574 Vali Loss: 56.471 Vali Acc: 0.534 Test Loss: 56.471 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.976525783538818
Epoch: 18, Steps: 32 | Train Loss: 5.339 Vali Loss: 44.539 Vali Acc: 0.397 Test Loss: 44.539 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.770984649658203
Epoch: 19, Steps: 32 | Train Loss: 0.305 Vali Loss: 36.329 Vali Acc: 0.481 Test Loss: 36.329 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.932431936264038
Epoch: 20, Steps: 32 | Train Loss: 0.560 Vali Loss: 39.927 Vali Acc: 0.389 Test Loss: 39.927 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.133403301239014
Epoch: 21, Steps: 32 | Train Loss: 0.741 Vali Loss: 38.829 Vali Acc: 0.519 Test Loss: 38.829 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3145749
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.615642547607422
Epoch: 1, Steps: 32 | Train Loss: 3.338 Vali Loss: 5.104 Vali Acc: 0.458 Test Loss: 5.104 Test Acc: 0.458
Validation loss decreased (inf --> -0.457964).  Saving model ...
Epoch: 2 cost time: 4.528104066848755
Epoch: 2, Steps: 32 | Train Loss: 3.514 Vali Loss: 9.885 Vali Acc: 0.206 Test Loss: 9.885 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.070345640182495
Epoch: 3, Steps: 32 | Train Loss: 6.229 Vali Loss: 9.946 Vali Acc: 0.298 Test Loss: 9.946 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.921405076980591
Epoch: 4, Steps: 32 | Train Loss: 5.731 Vali Loss: 17.809 Vali Acc: 0.382 Test Loss: 17.809 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.7178637981414795
Epoch: 5, Steps: 32 | Train Loss: 7.854 Vali Loss: 20.946 Vali Acc: 0.305 Test Loss: 20.946 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.418193101882935
Epoch: 6, Steps: 32 | Train Loss: 8.719 Vali Loss: 20.717 Vali Acc: 0.458 Test Loss: 20.717 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.239395380020142
Epoch: 7, Steps: 32 | Train Loss: 5.997 Vali Loss: 18.802 Vali Acc: 0.496 Test Loss: 18.802 Test Acc: 0.496
Validation loss decreased (-0.457964 --> -0.495995).  Saving model ...
Epoch: 8 cost time: 5.357155084609985
Epoch: 8, Steps: 32 | Train Loss: 5.922 Vali Loss: 11.788 Vali Acc: 0.466 Test Loss: 11.788 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.074964761734009
Epoch: 9, Steps: 32 | Train Loss: 2.097 Vali Loss: 27.062 Vali Acc: 0.290 Test Loss: 27.062 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.893069505691528
Epoch: 10, Steps: 32 | Train Loss: 1.661 Vali Loss: 23.171 Vali Acc: 0.489 Test Loss: 23.171 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.895978927612305
Epoch: 11, Steps: 32 | Train Loss: 4.547 Vali Loss: 49.769 Vali Acc: 0.198 Test Loss: 49.769 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.666154146194458
Epoch: 12, Steps: 32 | Train Loss: 7.065 Vali Loss: 23.837 Vali Acc: 0.351 Test Loss: 23.837 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.9626383781433105
Epoch: 13, Steps: 32 | Train Loss: 1.581 Vali Loss: 27.263 Vali Acc: 0.473 Test Loss: 27.263 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.051202297210693
Epoch: 14, Steps: 32 | Train Loss: 0.993 Vali Loss: 20.440 Vali Acc: 0.466 Test Loss: 20.440 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.479632616043091
Epoch: 15, Steps: 32 | Train Loss: 2.968 Vali Loss: 30.595 Vali Acc: 0.519 Test Loss: 30.595 Test Acc: 0.519
Validation loss decreased (-0.495995 --> -0.518778).  Saving model ...
Epoch: 16 cost time: 5.417762517929077
Epoch: 16, Steps: 32 | Train Loss: 5.029 Vali Loss: 30.679 Vali Acc: 0.389 Test Loss: 30.679 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.575233221054077
Epoch: 17, Steps: 32 | Train Loss: 2.282 Vali Loss: 39.872 Vali Acc: 0.321 Test Loss: 39.872 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.950909376144409
Epoch: 18, Steps: 32 | Train Loss: 4.942 Vali Loss: 47.448 Vali Acc: 0.466 Test Loss: 47.448 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.285101890563965
Epoch: 19, Steps: 32 | Train Loss: 5.223 Vali Loss: 46.662 Vali Acc: 0.481 Test Loss: 46.662 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.891058444976807
Epoch: 20, Steps: 32 | Train Loss: 2.799 Vali Loss: 42.200 Vali Acc: 0.321 Test Loss: 42.200 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.804539918899536
Epoch: 21, Steps: 32 | Train Loss: 4.903 Vali Loss: 38.880 Vali Acc: 0.359 Test Loss: 38.880 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.655181407928467
Epoch: 22, Steps: 32 | Train Loss: 1.687 Vali Loss: 72.640 Vali Acc: 0.473 Test Loss: 72.640 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.552022933959961
Epoch: 23, Steps: 32 | Train Loss: 2.096 Vali Loss: 81.171 Vali Acc: 0.290 Test Loss: 81.171 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.396995782852173
Epoch: 24, Steps: 32 | Train Loss: 1.824 Vali Loss: 73.765 Vali Acc: 0.504 Test Loss: 73.765 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.759021520614624
Epoch: 25, Steps: 32 | Train Loss: 0.489 Vali Loss: 65.785 Vali Acc: 0.450 Test Loss: 65.785 Test Acc: 0.450
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 3145749
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.639990568161011
Epoch: 1, Steps: 32 | Train Loss: 2.993 Vali Loss: 5.953 Vali Acc: 0.191 Test Loss: 5.953 Test Acc: 0.191
Validation loss decreased (inf --> -0.190780).  Saving model ...
Epoch: 2 cost time: 4.537857532501221
Epoch: 2, Steps: 32 | Train Loss: 5.662 Vali Loss: 10.080 Vali Acc: 0.229 Test Loss: 10.080 Test Acc: 0.229
Validation loss decreased (-0.190780 --> -0.228907).  Saving model ...
Epoch: 3 cost time: 4.443347215652466
Epoch: 3, Steps: 32 | Train Loss: 5.623 Vali Loss: 11.009 Vali Acc: 0.328 Test Loss: 11.009 Test Acc: 0.328
Validation loss decreased (-0.228907 --> -0.328134).  Saving model ...
Epoch: 4 cost time: 5.452454328536987
Epoch: 4, Steps: 32 | Train Loss: 5.378 Vali Loss: 10.420 Vali Acc: 0.305 Test Loss: 10.420 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.40239691734314
Epoch: 5, Steps: 32 | Train Loss: 4.101 Vali Loss: 18.124 Vali Acc: 0.313 Test Loss: 18.124 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.54266619682312
Epoch: 6, Steps: 32 | Train Loss: 14.148 Vali Loss: 21.832 Vali Acc: 0.374 Test Loss: 21.832 Test Acc: 0.374
Validation loss decreased (-0.328134 --> -0.373827).  Saving model ...
Epoch: 7 cost time: 4.879420518875122
Epoch: 7, Steps: 32 | Train Loss: 4.768 Vali Loss: 24.846 Vali Acc: 0.351 Test Loss: 24.846 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.4566943645477295
Epoch: 8, Steps: 32 | Train Loss: 5.304 Vali Loss: 23.533 Vali Acc: 0.466 Test Loss: 23.533 Test Acc: 0.466
Validation loss decreased (-0.373827 --> -0.465414).  Saving model ...
Epoch: 9 cost time: 5.743111610412598
Epoch: 9, Steps: 32 | Train Loss: 9.689 Vali Loss: 36.398 Vali Acc: 0.260 Test Loss: 36.398 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.633432865142822
Epoch: 10, Steps: 32 | Train Loss: 6.610 Vali Loss: 38.575 Vali Acc: 0.237 Test Loss: 38.575 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.439987897872925
Epoch: 11, Steps: 32 | Train Loss: 6.955 Vali Loss: 41.117 Vali Acc: 0.267 Test Loss: 41.117 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.4122419357299805
Epoch: 12, Steps: 32 | Train Loss: 5.637 Vali Loss: 24.762 Vali Acc: 0.321 Test Loss: 24.762 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.190408706665039
Epoch: 13, Steps: 32 | Train Loss: 4.260 Vali Loss: 22.592 Vali Acc: 0.405 Test Loss: 22.592 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.6272523403167725
Epoch: 14, Steps: 32 | Train Loss: 3.618 Vali Loss: 29.319 Vali Acc: 0.450 Test Loss: 29.319 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.715562105178833
Epoch: 15, Steps: 32 | Train Loss: 6.419 Vali Loss: 43.720 Vali Acc: 0.305 Test Loss: 43.720 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.3255615234375
Epoch: 16, Steps: 32 | Train Loss: 4.200 Vali Loss: 52.682 Vali Acc: 0.252 Test Loss: 52.682 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.470538377761841
Epoch: 17, Steps: 32 | Train Loss: 4.482 Vali Loss: 50.630 Vali Acc: 0.496 Test Loss: 50.630 Test Acc: 0.496
Validation loss decreased (-0.465414 --> -0.495677).  Saving model ...
Epoch: 18 cost time: 5.118628025054932
Epoch: 18, Steps: 32 | Train Loss: 3.138 Vali Loss: 49.912 Vali Acc: 0.389 Test Loss: 49.912 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.463644981384277
Epoch: 19, Steps: 32 | Train Loss: 2.038 Vali Loss: 55.215 Vali Acc: 0.397 Test Loss: 55.215 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.773940086364746
Epoch: 20, Steps: 32 | Train Loss: 1.666 Vali Loss: 52.041 Vali Acc: 0.557 Test Loss: 52.041 Test Acc: 0.557
Validation loss decreased (-0.495677 --> -0.556731).  Saving model ...
Epoch: 21 cost time: 5.034759998321533
Epoch: 21, Steps: 32 | Train Loss: 0.515 Vali Loss: 48.831 Vali Acc: 0.573 Test Loss: 48.831 Test Acc: 0.573
Validation loss decreased (-0.556731 --> -0.572031).  Saving model ...
Epoch: 22 cost time: 4.81783390045166
Epoch: 22, Steps: 32 | Train Loss: 1.107 Vali Loss: 50.080 Vali Acc: 0.550 Test Loss: 50.080 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.534827470779419
Epoch: 23, Steps: 32 | Train Loss: 0.943 Vali Loss: 67.594 Vali Acc: 0.359 Test Loss: 67.594 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.90967321395874
Epoch: 24, Steps: 32 | Train Loss: 2.696 Vali Loss: 55.754 Vali Acc: 0.534 Test Loss: 55.754 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.073432207107544
Epoch: 25, Steps: 32 | Train Loss: 0.603 Vali Loss: 63.344 Vali Acc: 0.405 Test Loss: 63.344 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.915335178375244
Epoch: 26, Steps: 32 | Train Loss: 2.478 Vali Loss: 52.085 Vali Acc: 0.519 Test Loss: 52.085 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.498123407363892
Epoch: 27, Steps: 32 | Train Loss: 0.389 Vali Loss: 47.435 Vali Acc: 0.504 Test Loss: 47.435 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.448392391204834
Epoch: 28, Steps: 32 | Train Loss: 0.439 Vali Loss: 65.390 Vali Acc: 0.359 Test Loss: 65.390 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.325641393661499
Epoch: 29, Steps: 32 | Train Loss: 2.224 Vali Loss: 44.635 Vali Acc: 0.458 Test Loss: 44.635 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.4711549282073975
Epoch: 30, Steps: 32 | Train Loss: 3.411 Vali Loss: 62.638 Vali Acc: 0.435 Test Loss: 62.638 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.92841911315918
Epoch: 31, Steps: 32 | Train Loss: 2.230 Vali Loss: 54.575 Vali Acc: 0.557 Test Loss: 54.575 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 3145749
model size : 14.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.397928714752197
Epoch: 1, Steps: 32 | Train Loss: 4.022 Vali Loss: 7.341 Vali Acc: 0.275 Test Loss: 7.341 Test Acc: 0.275
Validation loss decreased (inf --> -0.274736).  Saving model ...
Epoch: 2 cost time: 4.541740417480469
Epoch: 2, Steps: 32 | Train Loss: 7.499 Vali Loss: 9.489 Vali Acc: 0.328 Test Loss: 9.489 Test Acc: 0.328
Validation loss decreased (-0.274736 --> -0.328149).  Saving model ...
Epoch: 3 cost time: 4.758955717086792
Epoch: 3, Steps: 32 | Train Loss: 3.414 Vali Loss: 9.366 Vali Acc: 0.336 Test Loss: 9.366 Test Acc: 0.336
Validation loss decreased (-0.328149 --> -0.335784).  Saving model ...
Epoch: 4 cost time: 5.0419347286224365
Epoch: 4, Steps: 32 | Train Loss: 4.302 Vali Loss: 8.132 Vali Acc: 0.359 Test Loss: 8.132 Test Acc: 0.359
Validation loss decreased (-0.335784 --> -0.358697).  Saving model ...
Epoch: 5 cost time: 4.536829471588135
Epoch: 5, Steps: 32 | Train Loss: 7.587 Vali Loss: 10.562 Vali Acc: 0.504 Test Loss: 10.562 Test Acc: 0.504
Validation loss decreased (-0.358697 --> -0.503711).  Saving model ...
Epoch: 6 cost time: 5.838544130325317
Epoch: 6, Steps: 32 | Train Loss: 8.598 Vali Loss: 19.003 Vali Acc: 0.527 Test Loss: 19.003 Test Acc: 0.527
Validation loss decreased (-0.503711 --> -0.526528).  Saving model ...
Epoch: 7 cost time: 5.450211524963379
Epoch: 7, Steps: 32 | Train Loss: 2.092 Vali Loss: 14.573 Vali Acc: 0.374 Test Loss: 14.573 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.768634796142578
Epoch: 8, Steps: 32 | Train Loss: 2.100 Vali Loss: 34.757 Vali Acc: 0.221 Test Loss: 34.757 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.096118688583374
Epoch: 9, Steps: 32 | Train Loss: 5.819 Vali Loss: 24.967 Vali Acc: 0.397 Test Loss: 24.967 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.217228889465332
Epoch: 10, Steps: 32 | Train Loss: 7.460 Vali Loss: 33.565 Vali Acc: 0.290 Test Loss: 33.565 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.374962091445923
Epoch: 11, Steps: 32 | Train Loss: 0.533 Vali Loss: 19.196 Vali Acc: 0.496 Test Loss: 19.196 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.360310792922974
Epoch: 12, Steps: 32 | Train Loss: 3.533 Vali Loss: 33.507 Vali Acc: 0.344 Test Loss: 33.507 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.693675756454468
Epoch: 13, Steps: 32 | Train Loss: 2.137 Vali Loss: 24.254 Vali Acc: 0.496 Test Loss: 24.254 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.169551134109497
Epoch: 14, Steps: 32 | Train Loss: 3.304 Vali Loss: 33.471 Vali Acc: 0.504 Test Loss: 33.471 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.8515305519104
Epoch: 15, Steps: 32 | Train Loss: 3.040 Vali Loss: 47.513 Vali Acc: 0.511 Test Loss: 47.513 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.740554332733154
Epoch: 16, Steps: 32 | Train Loss: 0.515 Vali Loss: 36.993 Vali Acc: 0.443 Test Loss: 36.993 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3014677
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.381688833236694
Epoch: 1, Steps: 32 | Train Loss: 3.374 Vali Loss: 2.691 Vali Acc: 0.489 Test Loss: 2.691 Test Acc: 0.489
Validation loss decreased (inf --> -0.488523).  Saving model ...
Epoch: 2 cost time: 5.403486013412476
Epoch: 2, Steps: 32 | Train Loss: 4.024 Vali Loss: 7.102 Vali Acc: 0.252 Test Loss: 7.102 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.895200967788696
Epoch: 3, Steps: 32 | Train Loss: 4.750 Vali Loss: 8.937 Vali Acc: 0.481 Test Loss: 8.937 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.997313022613525
Epoch: 4, Steps: 32 | Train Loss: 8.633 Vali Loss: 14.736 Vali Acc: 0.458 Test Loss: 14.736 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.219981908798218
Epoch: 5, Steps: 32 | Train Loss: 7.662 Vali Loss: 14.524 Vali Acc: 0.435 Test Loss: 14.524 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.6654276847839355
Epoch: 6, Steps: 32 | Train Loss: 5.426 Vali Loss: 12.541 Vali Acc: 0.466 Test Loss: 12.541 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.81920051574707
Epoch: 7, Steps: 32 | Train Loss: 2.035 Vali Loss: 32.540 Vali Acc: 0.336 Test Loss: 32.540 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.802688360214233
Epoch: 8, Steps: 32 | Train Loss: 6.653 Vali Loss: 24.043 Vali Acc: 0.313 Test Loss: 24.043 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.902048349380493
Epoch: 9, Steps: 32 | Train Loss: 3.402 Vali Loss: 16.529 Vali Acc: 0.336 Test Loss: 16.529 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 5.41822075843811
Epoch: 10, Steps: 32 | Train Loss: 3.337 Vali Loss: 16.442 Vali Acc: 0.519 Test Loss: 16.442 Test Acc: 0.519
Validation loss decreased (-0.488523 --> -0.518920).  Saving model ...
Epoch: 11 cost time: 4.682681560516357
Epoch: 11, Steps: 32 | Train Loss: 1.513 Vali Loss: 19.317 Vali Acc: 0.328 Test Loss: 19.317 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.774491548538208
Epoch: 12, Steps: 32 | Train Loss: 2.013 Vali Loss: 19.528 Vali Acc: 0.351 Test Loss: 19.528 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.825051784515381
Epoch: 13, Steps: 32 | Train Loss: 0.773 Vali Loss: 22.826 Vali Acc: 0.366 Test Loss: 22.826 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.116533517837524
Epoch: 14, Steps: 32 | Train Loss: 2.733 Vali Loss: 28.406 Vali Acc: 0.473 Test Loss: 28.406 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.098562717437744
Epoch: 15, Steps: 32 | Train Loss: 0.528 Vali Loss: 22.544 Vali Acc: 0.420 Test Loss: 22.544 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.647861003875732
Epoch: 16, Steps: 32 | Train Loss: 1.327 Vali Loss: 21.176 Vali Acc: 0.450 Test Loss: 21.176 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7882513999938965
Epoch: 17, Steps: 32 | Train Loss: 2.181 Vali Loss: 28.962 Vali Acc: 0.382 Test Loss: 28.962 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.45790433883667
Epoch: 18, Steps: 32 | Train Loss: 2.179 Vali Loss: 23.840 Vali Acc: 0.405 Test Loss: 23.840 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.957852840423584
Epoch: 19, Steps: 32 | Train Loss: 5.224 Vali Loss: 35.593 Vali Acc: 0.374 Test Loss: 35.593 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.717883825302124
Epoch: 20, Steps: 32 | Train Loss: 2.224 Vali Loss: 46.329 Vali Acc: 0.328 Test Loss: 46.329 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 3014677
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.254185676574707
Epoch: 1, Steps: 32 | Train Loss: 3.618 Vali Loss: 3.154 Vali Acc: 0.275 Test Loss: 3.154 Test Acc: 0.275
Validation loss decreased (inf --> -0.274778).  Saving model ...
Epoch: 2 cost time: 4.811933517456055
Epoch: 2, Steps: 32 | Train Loss: 5.751 Vali Loss: 14.457 Vali Acc: 0.176 Test Loss: 14.457 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.0001220703125
Epoch: 3, Steps: 32 | Train Loss: 2.870 Vali Loss: 12.096 Vali Acc: 0.282 Test Loss: 12.096 Test Acc: 0.282
Validation loss decreased (-0.274778 --> -0.282322).  Saving model ...
Epoch: 4 cost time: 4.664574384689331
Epoch: 4, Steps: 32 | Train Loss: 3.884 Vali Loss: 14.314 Vali Acc: 0.260 Test Loss: 14.314 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.527945518493652
Epoch: 5, Steps: 32 | Train Loss: 4.540 Vali Loss: 12.021 Vali Acc: 0.443 Test Loss: 12.021 Test Acc: 0.443
Validation loss decreased (-0.282322 --> -0.442628).  Saving model ...
Epoch: 6 cost time: 5.196413278579712
Epoch: 6, Steps: 32 | Train Loss: 12.668 Vali Loss: 16.045 Vali Acc: 0.527 Test Loss: 16.045 Test Acc: 0.527
Validation loss decreased (-0.442628 --> -0.526557).  Saving model ...
Epoch: 7 cost time: 5.047167062759399
Epoch: 7, Steps: 32 | Train Loss: 5.804 Vali Loss: 27.915 Vali Acc: 0.237 Test Loss: 27.915 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.1863179206848145
Epoch: 8, Steps: 32 | Train Loss: 5.592 Vali Loss: 27.482 Vali Acc: 0.489 Test Loss: 27.482 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.925304889678955
Epoch: 9, Steps: 32 | Train Loss: 6.580 Vali Loss: 31.116 Vali Acc: 0.405 Test Loss: 31.116 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.531805515289307
Epoch: 10, Steps: 32 | Train Loss: 3.041 Vali Loss: 24.800 Vali Acc: 0.473 Test Loss: 24.800 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.060844898223877
Epoch: 11, Steps: 32 | Train Loss: 1.539 Vali Loss: 27.261 Vali Acc: 0.427 Test Loss: 27.261 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.72998309135437
Epoch: 12, Steps: 32 | Train Loss: 6.585 Vali Loss: 21.550 Vali Acc: 0.473 Test Loss: 21.550 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.43198299407959
Epoch: 13, Steps: 32 | Train Loss: 1.890 Vali Loss: 24.798 Vali Acc: 0.389 Test Loss: 24.798 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.899120569229126
Epoch: 14, Steps: 32 | Train Loss: 1.070 Vali Loss: 18.911 Vali Acc: 0.458 Test Loss: 18.911 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.947572946548462
Epoch: 15, Steps: 32 | Train Loss: 2.335 Vali Loss: 27.752 Vali Acc: 0.313 Test Loss: 27.752 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.852139472961426
Epoch: 16, Steps: 32 | Train Loss: 1.456 Vali Loss: 34.566 Vali Acc: 0.313 Test Loss: 34.566 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 3014677
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.586315393447876
Epoch: 1, Steps: 32 | Train Loss: 3.253 Vali Loss: 2.519 Vali Acc: 0.466 Test Loss: 2.519 Test Acc: 0.466
Validation loss decreased (inf --> -0.465624).  Saving model ...
Epoch: 2 cost time: 4.107896089553833
Epoch: 2, Steps: 32 | Train Loss: 7.797 Vali Loss: 13.944 Vali Acc: 0.252 Test Loss: 13.944 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.274059772491455
Epoch: 3, Steps: 32 | Train Loss: 6.198 Vali Loss: 16.433 Vali Acc: 0.221 Test Loss: 16.433 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.777165412902832
Epoch: 4, Steps: 32 | Train Loss: 8.293 Vali Loss: 18.621 Vali Acc: 0.107 Test Loss: 18.621 Test Acc: 0.107
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6852498054504395
Epoch: 5, Steps: 32 | Train Loss: 9.085 Vali Loss: 23.777 Vali Acc: 0.214 Test Loss: 23.777 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.396307468414307
Epoch: 6, Steps: 32 | Train Loss: 8.330 Vali Loss: 17.363 Vali Acc: 0.298 Test Loss: 17.363 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.200479745864868
Epoch: 7, Steps: 32 | Train Loss: 10.809 Vali Loss: 26.645 Vali Acc: 0.496 Test Loss: 26.645 Test Acc: 0.496
Validation loss decreased (-0.465624 --> -0.495917).  Saving model ...
Epoch: 8 cost time: 4.541516542434692
Epoch: 8, Steps: 32 | Train Loss: 6.765 Vali Loss: 18.101 Vali Acc: 0.450 Test Loss: 18.101 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.4371936321258545
Epoch: 9, Steps: 32 | Train Loss: 11.037 Vali Loss: 24.918 Vali Acc: 0.382 Test Loss: 24.918 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.216680526733398
Epoch: 10, Steps: 32 | Train Loss: 4.898 Vali Loss: 33.964 Vali Acc: 0.557 Test Loss: 33.964 Test Acc: 0.557
Validation loss decreased (-0.495917 --> -0.556912).  Saving model ...
Epoch: 11 cost time: 4.248169422149658
Epoch: 11, Steps: 32 | Train Loss: 2.816 Vali Loss: 35.892 Vali Acc: 0.489 Test Loss: 35.892 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.941606760025024
Epoch: 12, Steps: 32 | Train Loss: 8.251 Vali Loss: 37.091 Vali Acc: 0.534 Test Loss: 37.091 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.182179689407349
Epoch: 13, Steps: 32 | Train Loss: 4.142 Vali Loss: 42.644 Vali Acc: 0.389 Test Loss: 42.644 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.217639207839966
Epoch: 14, Steps: 32 | Train Loss: 11.660 Vali Loss: 40.753 Vali Acc: 0.489 Test Loss: 40.753 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.456924915313721
Epoch: 15, Steps: 32 | Train Loss: 9.482 Vali Loss: 57.051 Vali Acc: 0.313 Test Loss: 57.051 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.279647350311279
Epoch: 16, Steps: 32 | Train Loss: 4.560 Vali Loss: 42.197 Vali Acc: 0.458 Test Loss: 42.197 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.96338152885437
Epoch: 17, Steps: 32 | Train Loss: 2.306 Vali Loss: 45.300 Vali Acc: 0.389 Test Loss: 45.300 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.432033538818359
Epoch: 18, Steps: 32 | Train Loss: 2.744 Vali Loss: 53.344 Vali Acc: 0.336 Test Loss: 53.344 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.572317838668823
Epoch: 19, Steps: 32 | Train Loss: 3.413 Vali Loss: 61.556 Vali Acc: 0.260 Test Loss: 61.556 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.565353870391846
Epoch: 20, Steps: 32 | Train Loss: 2.497 Vali Loss: 44.588 Vali Acc: 0.374 Test Loss: 44.588 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 3014677
model size : 13.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.540745735168457
Epoch: 1, Steps: 32 | Train Loss: 4.048 Vali Loss: 5.851 Vali Acc: 0.221 Test Loss: 5.851 Test Acc: 0.221
Validation loss decreased (inf --> -0.221316).  Saving model ...
Epoch: 2 cost time: 5.397585153579712
Epoch: 2, Steps: 32 | Train Loss: 5.850 Vali Loss: 12.364 Vali Acc: 0.473 Test Loss: 12.364 Test Acc: 0.473
Validation loss decreased (-0.221316 --> -0.473159).  Saving model ...
Epoch: 3 cost time: 5.243651628494263
Epoch: 3, Steps: 32 | Train Loss: 5.431 Vali Loss: 7.223 Vali Acc: 0.427 Test Loss: 7.223 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.354982614517212
Epoch: 4, Steps: 32 | Train Loss: 3.317 Vali Loss: 7.670 Vali Acc: 0.511 Test Loss: 7.670 Test Acc: 0.511
Validation loss decreased (-0.473159 --> -0.511374).  Saving model ...
Epoch: 5 cost time: 5.040215730667114
Epoch: 5, Steps: 32 | Train Loss: 2.142 Vali Loss: 11.688 Vali Acc: 0.389 Test Loss: 11.688 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.916181802749634
Epoch: 6, Steps: 32 | Train Loss: 2.823 Vali Loss: 15.500 Vali Acc: 0.374 Test Loss: 15.500 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.630059242248535
Epoch: 7, Steps: 32 | Train Loss: 5.720 Vali Loss: 12.031 Vali Acc: 0.397 Test Loss: 12.031 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.3412580490112305
Epoch: 8, Steps: 32 | Train Loss: 1.922 Vali Loss: 22.014 Vali Acc: 0.527 Test Loss: 22.014 Test Acc: 0.527
Validation loss decreased (-0.511374 --> -0.526497).  Saving model ...
Epoch: 9 cost time: 4.320237874984741
Epoch: 9, Steps: 32 | Train Loss: 2.713 Vali Loss: 13.217 Vali Acc: 0.519 Test Loss: 13.217 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.849078178405762
Epoch: 10, Steps: 32 | Train Loss: 1.559 Vali Loss: 16.077 Vali Acc: 0.489 Test Loss: 16.077 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.05514669418335
Epoch: 11, Steps: 32 | Train Loss: 2.001 Vali Loss: 20.599 Vali Acc: 0.542 Test Loss: 20.599 Test Acc: 0.542
Validation loss decreased (-0.526497 --> -0.541779).  Saving model ...
Epoch: 12 cost time: 5.093838214874268
Epoch: 12, Steps: 32 | Train Loss: 0.864 Vali Loss: 15.242 Vali Acc: 0.550 Test Loss: 15.242 Test Acc: 0.550
Validation loss decreased (-0.541779 --> -0.549466).  Saving model ...
Epoch: 13 cost time: 5.090953826904297
Epoch: 13, Steps: 32 | Train Loss: 0.925 Vali Loss: 23.432 Vali Acc: 0.351 Test Loss: 23.432 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.228640079498291
Epoch: 14, Steps: 32 | Train Loss: 5.765 Vali Loss: 40.946 Vali Acc: 0.504 Test Loss: 40.946 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.425213813781738
Epoch: 15, Steps: 32 | Train Loss: 2.947 Vali Loss: 28.214 Vali Acc: 0.527 Test Loss: 28.214 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.052398681640625
Epoch: 16, Steps: 32 | Train Loss: 1.418 Vali Loss: 32.369 Vali Acc: 0.496 Test Loss: 32.369 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.270395278930664
Epoch: 17, Steps: 32 | Train Loss: 0.278 Vali Loss: 36.643 Vali Acc: 0.481 Test Loss: 36.643 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.109870672225952
Epoch: 18, Steps: 32 | Train Loss: 0.456 Vali Loss: 29.649 Vali Acc: 0.366 Test Loss: 29.649 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.993078231811523
Epoch: 19, Steps: 32 | Train Loss: 0.375 Vali Loss: 46.994 Vali Acc: 0.466 Test Loss: 46.994 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.8580546379089355
Epoch: 20, Steps: 32 | Train Loss: 2.212 Vali Loss: 28.139 Vali Acc: 0.481 Test Loss: 28.139 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.380915880203247
Epoch: 21, Steps: 32 | Train Loss: 0.686 Vali Loss: 31.203 Vali Acc: 0.374 Test Loss: 31.203 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.144516944885254
Epoch: 22, Steps: 32 | Train Loss: 1.504 Vali Loss: 43.505 Vali Acc: 0.237 Test Loss: 43.505 Test Acc: 0.237
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2949141
model size : 13.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.625300407409668
Epoch: 1, Steps: 32 | Train Loss: 3.889 Vali Loss: 6.137 Vali Acc: 0.229 Test Loss: 6.137 Test Acc: 0.229
Validation loss decreased (inf --> -0.228946).  Saving model ...
Epoch: 2 cost time: 4.605960130691528
Epoch: 2, Steps: 32 | Train Loss: 4.755 Vali Loss: 7.190 Vali Acc: 0.481 Test Loss: 7.190 Test Acc: 0.481
Validation loss decreased (-0.228946 --> -0.480844).  Saving model ...
Epoch: 3 cost time: 4.675796031951904
Epoch: 3, Steps: 32 | Train Loss: 3.652 Vali Loss: 5.894 Vali Acc: 0.412 Test Loss: 5.894 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.671194791793823
Epoch: 4, Steps: 32 | Train Loss: 4.735 Vali Loss: 5.845 Vali Acc: 0.527 Test Loss: 5.845 Test Acc: 0.527
Validation loss decreased (-0.480844 --> -0.526659).  Saving model ...
Epoch: 5 cost time: 4.799774646759033
Epoch: 5, Steps: 32 | Train Loss: 4.247 Vali Loss: 8.316 Vali Acc: 0.382 Test Loss: 8.316 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.042880058288574
Epoch: 6, Steps: 32 | Train Loss: 1.927 Vali Loss: 17.324 Vali Acc: 0.282 Test Loss: 17.324 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.220608949661255
Epoch: 7, Steps: 32 | Train Loss: 3.407 Vali Loss: 29.735 Vali Acc: 0.359 Test Loss: 29.735 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.19376015663147
Epoch: 8, Steps: 32 | Train Loss: 3.071 Vali Loss: 22.502 Vali Acc: 0.489 Test Loss: 22.502 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.041736125946045
Epoch: 9, Steps: 32 | Train Loss: 7.143 Vali Loss: 27.301 Vali Acc: 0.252 Test Loss: 27.301 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.2563159465789795
Epoch: 10, Steps: 32 | Train Loss: 2.066 Vali Loss: 17.076 Vali Acc: 0.496 Test Loss: 17.076 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.710568904876709
Epoch: 11, Steps: 32 | Train Loss: 1.983 Vali Loss: 30.293 Vali Acc: 0.458 Test Loss: 30.293 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.673355340957642
Epoch: 12, Steps: 32 | Train Loss: 3.142 Vali Loss: 31.519 Vali Acc: 0.206 Test Loss: 31.519 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.928997993469238
Epoch: 13, Steps: 32 | Train Loss: 3.616 Vali Loss: 17.041 Vali Acc: 0.489 Test Loss: 17.041 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.660005569458008
Epoch: 14, Steps: 32 | Train Loss: 1.829 Vali Loss: 28.127 Vali Acc: 0.397 Test Loss: 28.127 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2949141
model size : 13.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.764096021652222
Epoch: 1, Steps: 32 | Train Loss: 3.683 Vali Loss: 4.445 Vali Acc: 0.405 Test Loss: 4.445 Test Acc: 0.405
Validation loss decreased (inf --> -0.404536).  Saving model ...
Epoch: 2 cost time: 3.7913124561309814
Epoch: 2, Steps: 32 | Train Loss: 4.573 Vali Loss: 4.021 Vali Acc: 0.473 Test Loss: 4.021 Test Acc: 0.473
Validation loss decreased (-0.404536 --> -0.473242).  Saving model ...
Epoch: 3 cost time: 4.62273097038269
Epoch: 3, Steps: 32 | Train Loss: 3.326 Vali Loss: 11.323 Vali Acc: 0.275 Test Loss: 11.323 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.375431537628174
Epoch: 4, Steps: 32 | Train Loss: 4.081 Vali Loss: 9.891 Vali Acc: 0.481 Test Loss: 9.891 Test Acc: 0.481
Validation loss decreased (-0.473242 --> -0.480817).  Saving model ...
Epoch: 5 cost time: 4.46117377281189
Epoch: 5, Steps: 32 | Train Loss: 3.532 Vali Loss: 21.057 Vali Acc: 0.321 Test Loss: 21.057 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.36070704460144
Epoch: 6, Steps: 32 | Train Loss: 5.782 Vali Loss: 14.480 Vali Acc: 0.313 Test Loss: 14.480 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.430598020553589
Epoch: 7, Steps: 32 | Train Loss: 7.463 Vali Loss: 25.562 Vali Acc: 0.260 Test Loss: 25.562 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.474403381347656
Epoch: 8, Steps: 32 | Train Loss: 5.550 Vali Loss: 30.108 Vali Acc: 0.427 Test Loss: 30.108 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.879379749298096
Epoch: 9, Steps: 32 | Train Loss: 1.908 Vali Loss: 21.852 Vali Acc: 0.519 Test Loss: 21.852 Test Acc: 0.519
Validation loss decreased (-0.480817 --> -0.518865).  Saving model ...
Epoch: 10 cost time: 4.5081048011779785
Epoch: 10, Steps: 32 | Train Loss: 1.318 Vali Loss: 31.562 Vali Acc: 0.321 Test Loss: 31.562 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8777008056640625
Epoch: 11, Steps: 32 | Train Loss: 6.580 Vali Loss: 31.950 Vali Acc: 0.511 Test Loss: 31.950 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.926121473312378
Epoch: 12, Steps: 32 | Train Loss: 5.504 Vali Loss: 31.816 Vali Acc: 0.366 Test Loss: 31.816 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.461937665939331
Epoch: 13, Steps: 32 | Train Loss: 3.606 Vali Loss: 35.235 Vali Acc: 0.511 Test Loss: 35.235 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.880439519882202
Epoch: 14, Steps: 32 | Train Loss: 3.424 Vali Loss: 33.502 Vali Acc: 0.328 Test Loss: 33.502 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.570760488510132
Epoch: 15, Steps: 32 | Train Loss: 5.792 Vali Loss: 35.220 Vali Acc: 0.405 Test Loss: 35.220 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.681579113006592
Epoch: 16, Steps: 32 | Train Loss: 2.470 Vali Loss: 48.832 Vali Acc: 0.305 Test Loss: 48.832 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.661132335662842
Epoch: 17, Steps: 32 | Train Loss: 0.595 Vali Loss: 34.358 Vali Acc: 0.511 Test Loss: 34.358 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.539467096328735
Epoch: 18, Steps: 32 | Train Loss: 0.605 Vali Loss: 55.755 Vali Acc: 0.260 Test Loss: 55.755 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.2543768882751465
Epoch: 19, Steps: 32 | Train Loss: 1.684 Vali Loss: 30.714 Vali Acc: 0.397 Test Loss: 30.714 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2949141
model size : 13.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.253882884979248
Epoch: 1, Steps: 32 | Train Loss: 3.737 Vali Loss: 5.908 Vali Acc: 0.489 Test Loss: 5.908 Test Acc: 0.489
Validation loss decreased (inf --> -0.488491).  Saving model ...
Epoch: 2 cost time: 4.385897159576416
Epoch: 2, Steps: 32 | Train Loss: 4.369 Vali Loss: 10.291 Vali Acc: 0.458 Test Loss: 10.291 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.296572208404541
Epoch: 3, Steps: 32 | Train Loss: 6.833 Vali Loss: 7.670 Vali Acc: 0.489 Test Loss: 7.670 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.294658422470093
Epoch: 4, Steps: 32 | Train Loss: 6.392 Vali Loss: 9.704 Vali Acc: 0.473 Test Loss: 9.704 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8634979724884033
Epoch: 5, Steps: 32 | Train Loss: 9.064 Vali Loss: 18.181 Vali Acc: 0.328 Test Loss: 18.181 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.831641435623169
Epoch: 6, Steps: 32 | Train Loss: 5.194 Vali Loss: 13.401 Vali Acc: 0.290 Test Loss: 13.401 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.243242979049683
Epoch: 7, Steps: 32 | Train Loss: 5.831 Vali Loss: 16.750 Vali Acc: 0.565 Test Loss: 16.750 Test Acc: 0.565
Validation loss decreased (-0.488491 --> -0.564718).  Saving model ...
Epoch: 8 cost time: 3.925832748413086
Epoch: 8, Steps: 32 | Train Loss: 9.920 Vali Loss: 17.328 Vali Acc: 0.412 Test Loss: 17.328 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.74963116645813
Epoch: 9, Steps: 32 | Train Loss: 6.552 Vali Loss: 11.793 Vali Acc: 0.473 Test Loss: 11.793 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.548215866088867
Epoch: 10, Steps: 32 | Train Loss: 4.431 Vali Loss: 14.110 Vali Acc: 0.336 Test Loss: 14.110 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.51741623878479
Epoch: 11, Steps: 32 | Train Loss: 4.042 Vali Loss: 20.007 Vali Acc: 0.450 Test Loss: 20.007 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.33081579208374
Epoch: 12, Steps: 32 | Train Loss: 3.797 Vali Loss: 19.023 Vali Acc: 0.458 Test Loss: 19.023 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.343531608581543
Epoch: 13, Steps: 32 | Train Loss: 2.170 Vali Loss: 34.050 Vali Acc: 0.221 Test Loss: 34.050 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.384578466415405
Epoch: 14, Steps: 32 | Train Loss: 7.379 Vali Loss: 47.575 Vali Acc: 0.214 Test Loss: 47.575 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.612666130065918
Epoch: 15, Steps: 32 | Train Loss: 4.629 Vali Loss: 38.360 Vali Acc: 0.351 Test Loss: 38.360 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.9223735332489014
Epoch: 16, Steps: 32 | Train Loss: 4.549 Vali Loss: 31.212 Vali Acc: 0.366 Test Loss: 31.212 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.809337854385376
Epoch: 17, Steps: 32 | Train Loss: 2.110 Vali Loss: 28.585 Vali Acc: 0.473 Test Loss: 28.585 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2949141
model size : 13.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.449934244155884
Epoch: 1, Steps: 32 | Train Loss: 3.169 Vali Loss: 3.325 Vali Acc: 0.374 Test Loss: 3.325 Test Acc: 0.374
Validation loss decreased (inf --> -0.374013).  Saving model ...
Epoch: 2 cost time: 4.308310270309448
Epoch: 2, Steps: 32 | Train Loss: 3.759 Vali Loss: 5.169 Vali Acc: 0.489 Test Loss: 5.169 Test Acc: 0.489
Validation loss decreased (-0.374013 --> -0.488498).  Saving model ...
Epoch: 3 cost time: 4.50307297706604
Epoch: 3, Steps: 32 | Train Loss: 2.302 Vali Loss: 4.831 Vali Acc: 0.504 Test Loss: 4.831 Test Acc: 0.504
Validation loss decreased (-0.488498 --> -0.503768).  Saving model ...
Epoch: 4 cost time: 4.5439441204071045
Epoch: 4, Steps: 32 | Train Loss: 4.244 Vali Loss: 12.405 Vali Acc: 0.206 Test Loss: 12.405 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.972197771072388
Epoch: 5, Steps: 32 | Train Loss: 1.486 Vali Loss: 21.119 Vali Acc: 0.473 Test Loss: 21.119 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.272059440612793
Epoch: 6, Steps: 32 | Train Loss: 4.044 Vali Loss: 12.135 Vali Acc: 0.435 Test Loss: 12.135 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.993210554122925
Epoch: 7, Steps: 32 | Train Loss: 1.328 Vali Loss: 12.398 Vali Acc: 0.336 Test Loss: 12.398 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.752432584762573
Epoch: 8, Steps: 32 | Train Loss: 0.434 Vali Loss: 12.160 Vali Acc: 0.359 Test Loss: 12.160 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.500397682189941
Epoch: 9, Steps: 32 | Train Loss: 5.176 Vali Loss: 48.961 Vali Acc: 0.206 Test Loss: 48.961 Test Acc: 0.206
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.385710716247559
Epoch: 10, Steps: 32 | Train Loss: 9.570 Vali Loss: 21.334 Vali Acc: 0.519 Test Loss: 21.334 Test Acc: 0.519
Validation loss decreased (-0.503768 --> -0.518871).  Saving model ...
Epoch: 11 cost time: 4.2135021686553955
Epoch: 11, Steps: 32 | Train Loss: 2.272 Vali Loss: 41.676 Vali Acc: 0.481 Test Loss: 41.676 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.463146686553955
Epoch: 12, Steps: 32 | Train Loss: 3.565 Vali Loss: 38.623 Vali Acc: 0.389 Test Loss: 38.623 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.185767412185669
Epoch: 13, Steps: 32 | Train Loss: 4.792 Vali Loss: 57.506 Vali Acc: 0.435 Test Loss: 57.506 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.225470304489136
Epoch: 14, Steps: 32 | Train Loss: 2.605 Vali Loss: 50.204 Vali Acc: 0.527 Test Loss: 50.204 Test Acc: 0.527
Validation loss decreased (-0.518871 --> -0.526216).  Saving model ...
Epoch: 15 cost time: 3.8515512943267822
Epoch: 15, Steps: 32 | Train Loss: 0.586 Vali Loss: 48.133 Vali Acc: 0.282 Test Loss: 48.133 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.387003660202026
Epoch: 16, Steps: 32 | Train Loss: 0.860 Vali Loss: 44.085 Vali Acc: 0.435 Test Loss: 44.085 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.8408892154693604
Epoch: 17, Steps: 32 | Train Loss: 1.169 Vali Loss: 30.859 Vali Acc: 0.542 Test Loss: 30.859 Test Acc: 0.542
Validation loss decreased (-0.526216 --> -0.541676).  Saving model ...
Epoch: 18 cost time: 3.853074550628662
Epoch: 18, Steps: 32 | Train Loss: 0.323 Vali Loss: 30.549 Vali Acc: 0.527 Test Loss: 30.549 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.459298133850098
Epoch: 19, Steps: 32 | Train Loss: 0.183 Vali Loss: 26.953 Vali Acc: 0.420 Test Loss: 26.953 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.37645149230957
Epoch: 20, Steps: 32 | Train Loss: 1.204 Vali Loss: 41.864 Vali Acc: 0.328 Test Loss: 41.864 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.6815807819366455
Epoch: 21, Steps: 32 | Train Loss: 1.531 Vali Loss: 29.129 Vali Acc: 0.443 Test Loss: 29.129 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.182904005050659
Epoch: 22, Steps: 32 | Train Loss: 0.168 Vali Loss: 45.049 Vali Acc: 0.313 Test Loss: 45.049 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.36423134803772
Epoch: 23, Steps: 32 | Train Loss: 1.870 Vali Loss: 46.354 Vali Acc: 0.450 Test Loss: 46.354 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.952802419662476
Epoch: 24, Steps: 32 | Train Loss: 2.452 Vali Loss: 38.113 Vali Acc: 0.427 Test Loss: 38.113 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.834803104400635
Epoch: 25, Steps: 32 | Train Loss: 0.155 Vali Loss: 48.487 Vali Acc: 0.427 Test Loss: 48.487 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.86399507522583
Epoch: 26, Steps: 32 | Train Loss: 0.273 Vali Loss: 52.260 Vali Acc: 0.458 Test Loss: 52.260 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.119889497756958
Epoch: 27, Steps: 32 | Train Loss: 0.174 Vali Loss: 47.270 Vali Acc: 0.504 Test Loss: 47.270 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2916373
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.2078821659088135
Epoch: 1, Steps: 32 | Train Loss: 3.080 Vali Loss: 4.323 Vali Acc: 0.260 Test Loss: 4.323 Test Acc: 0.260
Validation loss decreased (inf --> -0.259499).  Saving model ...
Epoch: 2 cost time: 4.315709590911865
Epoch: 2, Steps: 32 | Train Loss: 4.105 Vali Loss: 6.374 Vali Acc: 0.450 Test Loss: 6.374 Test Acc: 0.450
Validation loss decreased (-0.259499 --> -0.450318).  Saving model ...
Epoch: 3 cost time: 4.175273895263672
Epoch: 3, Steps: 32 | Train Loss: 5.363 Vali Loss: 8.718 Vali Acc: 0.420 Test Loss: 8.718 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.094506025314331
Epoch: 4, Steps: 32 | Train Loss: 4.732 Vali Loss: 12.668 Vali Acc: 0.153 Test Loss: 12.668 Test Acc: 0.153
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.356796503067017
Epoch: 5, Steps: 32 | Train Loss: 3.062 Vali Loss: 11.834 Vali Acc: 0.489 Test Loss: 11.834 Test Acc: 0.489
Validation loss decreased (-0.450318 --> -0.488431).  Saving model ...
Epoch: 6 cost time: 4.368649244308472
Epoch: 6, Steps: 32 | Train Loss: 2.461 Vali Loss: 8.425 Vali Acc: 0.511 Test Loss: 8.425 Test Acc: 0.511
Validation loss decreased (-0.488431 --> -0.511366).  Saving model ...
Epoch: 7 cost time: 4.437163829803467
Epoch: 7, Steps: 32 | Train Loss: 1.011 Vali Loss: 9.660 Vali Acc: 0.366 Test Loss: 9.660 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.972777843475342
Epoch: 8, Steps: 32 | Train Loss: 1.203 Vali Loss: 15.473 Vali Acc: 0.481 Test Loss: 15.473 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.0181498527526855
Epoch: 9, Steps: 32 | Train Loss: 3.173 Vali Loss: 17.832 Vali Acc: 0.321 Test Loss: 17.832 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.213657855987549
Epoch: 10, Steps: 32 | Train Loss: 2.750 Vali Loss: 27.036 Vali Acc: 0.450 Test Loss: 27.036 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.403096675872803
Epoch: 11, Steps: 32 | Train Loss: 4.045 Vali Loss: 29.209 Vali Acc: 0.336 Test Loss: 29.209 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.267646074295044
Epoch: 12, Steps: 32 | Train Loss: 2.184 Vali Loss: 18.618 Vali Acc: 0.527 Test Loss: 18.618 Test Acc: 0.527
Validation loss decreased (-0.511366 --> -0.526531).  Saving model ...
Epoch: 13 cost time: 3.5565297603607178
Epoch: 13, Steps: 32 | Train Loss: 1.329 Vali Loss: 21.235 Vali Acc: 0.527 Test Loss: 21.235 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9245941638946533
Epoch: 14, Steps: 32 | Train Loss: 2.736 Vali Loss: 29.035 Vali Acc: 0.504 Test Loss: 29.035 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.5007734298706055
Epoch: 15, Steps: 32 | Train Loss: 2.004 Vali Loss: 21.736 Vali Acc: 0.450 Test Loss: 21.736 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.416172027587891
Epoch: 16, Steps: 32 | Train Loss: 1.735 Vali Loss: 24.281 Vali Acc: 0.473 Test Loss: 24.281 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.884634971618652
Epoch: 17, Steps: 32 | Train Loss: 0.835 Vali Loss: 22.931 Vali Acc: 0.519 Test Loss: 22.931 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.263031244277954
Epoch: 18, Steps: 32 | Train Loss: 0.967 Vali Loss: 22.527 Vali Acc: 0.427 Test Loss: 22.527 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.074871778488159
Epoch: 19, Steps: 32 | Train Loss: 0.006 Vali Loss: 32.904 Vali Acc: 0.427 Test Loss: 32.904 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.623719215393066
Epoch: 20, Steps: 32 | Train Loss: 0.853 Vali Loss: 24.855 Vali Acc: 0.511 Test Loss: 24.855 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.395674705505371
Epoch: 21, Steps: 32 | Train Loss: 1.571 Vali Loss: 63.379 Vali Acc: 0.298 Test Loss: 63.379 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.464317321777344
Epoch: 22, Steps: 32 | Train Loss: 1.963 Vali Loss: 42.979 Vali Acc: 0.321 Test Loss: 42.979 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2916373
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.849376201629639
Epoch: 1, Steps: 32 | Train Loss: 3.041 Vali Loss: 8.880 Vali Acc: 0.176 Test Loss: 8.880 Test Acc: 0.176
Validation loss decreased (inf --> -0.175484).  Saving model ...
Epoch: 2 cost time: 4.383758544921875
Epoch: 2, Steps: 32 | Train Loss: 3.611 Vali Loss: 8.343 Vali Acc: 0.504 Test Loss: 8.343 Test Acc: 0.504
Validation loss decreased (-0.175484 --> -0.503733).  Saving model ...
Epoch: 3 cost time: 3.9728312492370605
Epoch: 3, Steps: 32 | Train Loss: 4.698 Vali Loss: 11.457 Vali Acc: 0.466 Test Loss: 11.457 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.759819269180298
Epoch: 4, Steps: 32 | Train Loss: 6.430 Vali Loss: 10.217 Vali Acc: 0.504 Test Loss: 10.217 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.626115083694458
Epoch: 5, Steps: 32 | Train Loss: 3.117 Vali Loss: 21.817 Vali Acc: 0.466 Test Loss: 21.817 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.543434143066406
Epoch: 6, Steps: 32 | Train Loss: 7.612 Vali Loss: 12.702 Vali Acc: 0.489 Test Loss: 12.702 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.360361099243164
Epoch: 7, Steps: 32 | Train Loss: 9.189 Vali Loss: 11.944 Vali Acc: 0.534 Test Loss: 11.944 Test Acc: 0.534
Validation loss decreased (-0.503733 --> -0.534232).  Saving model ...
Epoch: 8 cost time: 4.26008677482605
Epoch: 8, Steps: 32 | Train Loss: 3.257 Vali Loss: 13.705 Vali Acc: 0.359 Test Loss: 13.705 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.012835264205933
Epoch: 9, Steps: 32 | Train Loss: 6.320 Vali Loss: 29.225 Vali Acc: 0.176 Test Loss: 29.225 Test Acc: 0.176
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.356867551803589
Epoch: 10, Steps: 32 | Train Loss: 7.268 Vali Loss: 23.238 Vali Acc: 0.481 Test Loss: 23.238 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.518963575363159
Epoch: 11, Steps: 32 | Train Loss: 6.077 Vali Loss: 31.652 Vali Acc: 0.336 Test Loss: 31.652 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.2186760902404785
Epoch: 12, Steps: 32 | Train Loss: 4.697 Vali Loss: 24.469 Vali Acc: 0.489 Test Loss: 24.469 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.305397272109985
Epoch: 13, Steps: 32 | Train Loss: 1.746 Vali Loss: 20.743 Vali Acc: 0.504 Test Loss: 20.743 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.780745506286621
Epoch: 14, Steps: 32 | Train Loss: 0.436 Vali Loss: 41.089 Vali Acc: 0.534 Test Loss: 41.089 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7392454147338867
Epoch: 15, Steps: 32 | Train Loss: 3.469 Vali Loss: 59.492 Vali Acc: 0.305 Test Loss: 59.492 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.0573413372039795
Epoch: 16, Steps: 32 | Train Loss: 1.756 Vali Loss: 53.149 Vali Acc: 0.542 Test Loss: 53.149 Test Acc: 0.542
Validation loss decreased (-0.534232 --> -0.541453).  Saving model ...
Epoch: 17 cost time: 4.270874261856079
Epoch: 17, Steps: 32 | Train Loss: 3.221 Vali Loss: 70.409 Vali Acc: 0.321 Test Loss: 70.409 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.965635061264038
Epoch: 18, Steps: 32 | Train Loss: 2.232 Vali Loss: 58.162 Vali Acc: 0.351 Test Loss: 58.162 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.136051416397095
Epoch: 19, Steps: 32 | Train Loss: 0.529 Vali Loss: 56.755 Vali Acc: 0.412 Test Loss: 56.755 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.000071048736572
Epoch: 20, Steps: 32 | Train Loss: 0.823 Vali Loss: 69.972 Vali Acc: 0.305 Test Loss: 69.972 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.478349685668945
Epoch: 21, Steps: 32 | Train Loss: 1.456 Vali Loss: 57.867 Vali Acc: 0.427 Test Loss: 57.867 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.6649839878082275
Epoch: 22, Steps: 32 | Train Loss: 3.323 Vali Loss: 66.105 Vali Acc: 0.511 Test Loss: 66.105 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.289384365081787
Epoch: 23, Steps: 32 | Train Loss: 2.771 Vali Loss: 66.405 Vali Acc: 0.458 Test Loss: 66.405 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.770282506942749
Epoch: 24, Steps: 32 | Train Loss: 0.162 Vali Loss: 72.443 Vali Acc: 0.336 Test Loss: 72.443 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.0395824909210205
Epoch: 25, Steps: 32 | Train Loss: 2.548 Vali Loss: 86.370 Vali Acc: 0.267 Test Loss: 86.370 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.02566123008728
Epoch: 26, Steps: 32 | Train Loss: 3.950 Vali Loss: 54.340 Vali Acc: 0.496 Test Loss: 54.340 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2916373
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.255490064620972
Epoch: 1, Steps: 32 | Train Loss: 3.056 Vali Loss: 6.561 Vali Acc: 0.176 Test Loss: 6.561 Test Acc: 0.176
Validation loss decreased (inf --> -0.175507).  Saving model ...
Epoch: 2 cost time: 3.7497005462646484
Epoch: 2, Steps: 32 | Train Loss: 4.377 Vali Loss: 6.805 Vali Acc: 0.298 Test Loss: 6.805 Test Acc: 0.298
Validation loss decreased (-0.175507 --> -0.297642).  Saving model ...
Epoch: 3 cost time: 4.644524097442627
Epoch: 3, Steps: 32 | Train Loss: 4.721 Vali Loss: 8.077 Vali Acc: 0.252 Test Loss: 8.077 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.225546598434448
Epoch: 4, Steps: 32 | Train Loss: 5.688 Vali Loss: 7.073 Vali Acc: 0.481 Test Loss: 7.073 Test Acc: 0.481
Validation loss decreased (-0.297642 --> -0.480845).  Saving model ...
Epoch: 5 cost time: 4.72676157951355
Epoch: 5, Steps: 32 | Train Loss: 4.103 Vali Loss: 12.668 Vali Acc: 0.489 Test Loss: 12.668 Test Acc: 0.489
Validation loss decreased (-0.480845 --> -0.488423).  Saving model ...
Epoch: 6 cost time: 3.4914748668670654
Epoch: 6, Steps: 32 | Train Loss: 8.123 Vali Loss: 24.619 Vali Acc: 0.405 Test Loss: 24.619 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.290806770324707
Epoch: 7, Steps: 32 | Train Loss: 10.517 Vali Loss: 22.144 Vali Acc: 0.328 Test Loss: 22.144 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5266242027282715
Epoch: 8, Steps: 32 | Train Loss: 7.894 Vali Loss: 25.745 Vali Acc: 0.313 Test Loss: 25.745 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.003260374069214
Epoch: 9, Steps: 32 | Train Loss: 2.942 Vali Loss: 28.813 Vali Acc: 0.328 Test Loss: 28.813 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.331686735153198
Epoch: 10, Steps: 32 | Train Loss: 2.402 Vali Loss: 23.379 Vali Acc: 0.435 Test Loss: 23.379 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.488711357116699
Epoch: 11, Steps: 32 | Train Loss: 3.724 Vali Loss: 27.352 Vali Acc: 0.359 Test Loss: 27.352 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.005141019821167
Epoch: 12, Steps: 32 | Train Loss: 6.248 Vali Loss: 21.616 Vali Acc: 0.504 Test Loss: 21.616 Test Acc: 0.504
Validation loss decreased (-0.488423 --> -0.503601).  Saving model ...
Epoch: 13 cost time: 4.020909786224365
Epoch: 13, Steps: 32 | Train Loss: 2.347 Vali Loss: 19.085 Vali Acc: 0.511 Test Loss: 19.085 Test Acc: 0.511
Validation loss decreased (-0.503601 --> -0.511260).  Saving model ...
Epoch: 14 cost time: 3.751837968826294
Epoch: 14, Steps: 32 | Train Loss: 4.578 Vali Loss: 51.154 Vali Acc: 0.198 Test Loss: 51.154 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.486395835876465
Epoch: 15, Steps: 32 | Train Loss: 7.031 Vali Loss: 33.044 Vali Acc: 0.260 Test Loss: 33.044 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8217761516571045
Epoch: 16, Steps: 32 | Train Loss: 6.113 Vali Loss: 40.322 Vali Acc: 0.328 Test Loss: 40.322 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.25610613822937
Epoch: 17, Steps: 32 | Train Loss: 8.397 Vali Loss: 41.908 Vali Acc: 0.267 Test Loss: 41.908 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.485008716583252
Epoch: 18, Steps: 32 | Train Loss: 0.639 Vali Loss: 39.532 Vali Acc: 0.389 Test Loss: 39.532 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.234861850738525
Epoch: 19, Steps: 32 | Train Loss: 5.108 Vali Loss: 32.844 Vali Acc: 0.427 Test Loss: 32.844 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.488452434539795
Epoch: 20, Steps: 32 | Train Loss: 3.299 Vali Loss: 35.519 Vali Acc: 0.298 Test Loss: 35.519 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.884922981262207
Epoch: 21, Steps: 32 | Train Loss: 1.259 Vali Loss: 51.314 Vali Acc: 0.252 Test Loss: 51.314 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.471487283706665
Epoch: 22, Steps: 32 | Train Loss: 0.686 Vali Loss: 58.504 Vali Acc: 0.260 Test Loss: 58.504 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.398328542709351
Epoch: 23, Steps: 32 | Train Loss: 0.241 Vali Loss: 38.642 Vali Acc: 0.344 Test Loss: 38.642 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2916373
model size : 13.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.583061456680298
Epoch: 1, Steps: 32 | Train Loss: 4.110 Vali Loss: 11.865 Vali Acc: 0.267 Test Loss: 11.865 Test Acc: 0.267
Validation loss decreased (inf --> -0.267057).  Saving model ...
Epoch: 2 cost time: 4.581589221954346
Epoch: 2, Steps: 32 | Train Loss: 4.144 Vali Loss: 7.654 Vali Acc: 0.435 Test Loss: 7.654 Test Acc: 0.435
Validation loss decreased (-0.267057 --> -0.435038).  Saving model ...
Epoch: 3 cost time: 4.505849361419678
Epoch: 3, Steps: 32 | Train Loss: 1.767 Vali Loss: 10.787 Vali Acc: 0.313 Test Loss: 10.787 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.631896495819092
Epoch: 4, Steps: 32 | Train Loss: 3.283 Vali Loss: 8.784 Vali Acc: 0.328 Test Loss: 8.784 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.841114521026611
Epoch: 5, Steps: 32 | Train Loss: 5.117 Vali Loss: 9.619 Vali Acc: 0.405 Test Loss: 9.619 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.070358514785767
Epoch: 6, Steps: 32 | Train Loss: 0.991 Vali Loss: 11.754 Vali Acc: 0.504 Test Loss: 11.754 Test Acc: 0.504
Validation loss decreased (-0.435038 --> -0.503699).  Saving model ...
Epoch: 7 cost time: 4.768198013305664
Epoch: 7, Steps: 32 | Train Loss: 1.025 Vali Loss: 14.584 Vali Acc: 0.489 Test Loss: 14.584 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.7901997566223145
Epoch: 8, Steps: 32 | Train Loss: 2.125 Vali Loss: 10.911 Vali Acc: 0.427 Test Loss: 10.911 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.506504535675049
Epoch: 9, Steps: 32 | Train Loss: 3.043 Vali Loss: 12.784 Vali Acc: 0.473 Test Loss: 12.784 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.022015333175659
Epoch: 10, Steps: 32 | Train Loss: 1.637 Vali Loss: 35.983 Vali Acc: 0.389 Test Loss: 35.983 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.874140501022339
Epoch: 11, Steps: 32 | Train Loss: 6.459 Vali Loss: 42.685 Vali Acc: 0.229 Test Loss: 42.685 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.801188945770264
Epoch: 12, Steps: 32 | Train Loss: 2.365 Vali Loss: 32.347 Vali Acc: 0.397 Test Loss: 32.347 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.234304189682007
Epoch: 13, Steps: 32 | Train Loss: 1.899 Vali Loss: 27.344 Vali Acc: 0.557 Test Loss: 27.344 Test Acc: 0.557
Validation loss decreased (-0.503699 --> -0.556978).  Saving model ...
Epoch: 14 cost time: 4.27273154258728
Epoch: 14, Steps: 32 | Train Loss: 4.696 Vali Loss: 32.886 Vali Acc: 0.313 Test Loss: 32.886 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7867636680603027
Epoch: 15, Steps: 32 | Train Loss: 5.157 Vali Loss: 25.866 Vali Acc: 0.504 Test Loss: 25.866 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.988405704498291
Epoch: 16, Steps: 32 | Train Loss: 1.139 Vali Loss: 23.819 Vali Acc: 0.489 Test Loss: 23.819 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.7760350704193115
Epoch: 17, Steps: 32 | Train Loss: 0.246 Vali Loss: 26.017 Vali Acc: 0.489 Test Loss: 26.017 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.054784774780273
Epoch: 18, Steps: 32 | Train Loss: 0.331 Vali Loss: 27.629 Vali Acc: 0.435 Test Loss: 27.629 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.076531410217285
Epoch: 19, Steps: 32 | Train Loss: 1.410 Vali Loss: 37.523 Vali Acc: 0.473 Test Loss: 37.523 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.9420716762542725
Epoch: 20, Steps: 32 | Train Loss: 0.145 Vali Loss: 28.499 Vali Acc: 0.450 Test Loss: 28.499 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.5952441692352295
Epoch: 21, Steps: 32 | Train Loss: 0.656 Vali Loss: 32.747 Vali Acc: 0.366 Test Loss: 32.747 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.091876745223999
Epoch: 22, Steps: 32 | Train Loss: 0.369 Vali Loss: 32.493 Vali Acc: 0.481 Test Loss: 32.493 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.129162549972534
Epoch: 23, Steps: 32 | Train Loss: 0.242 Vali Loss: 31.603 Vali Acc: 0.489 Test Loss: 31.603 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 2899989
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.164106369018555
Epoch: 1, Steps: 32 | Train Loss: 3.650 Vali Loss: 5.207 Vali Acc: 0.244 Test Loss: 5.207 Test Acc: 0.244
Validation loss decreased (inf --> -0.244223).  Saving model ...
Epoch: 2 cost time: 4.705126047134399
Epoch: 2, Steps: 32 | Train Loss: 7.362 Vali Loss: 13.626 Vali Acc: 0.481 Test Loss: 13.626 Test Acc: 0.481
Validation loss decreased (-0.244223 --> -0.480780).  Saving model ...
Epoch: 3 cost time: 4.4299421310424805
Epoch: 3, Steps: 32 | Train Loss: 6.386 Vali Loss: 14.419 Vali Acc: 0.366 Test Loss: 14.419 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.141814947128296
Epoch: 4, Steps: 32 | Train Loss: 6.785 Vali Loss: 8.924 Vali Acc: 0.366 Test Loss: 8.924 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.757929801940918
Epoch: 5, Steps: 32 | Train Loss: 5.254 Vali Loss: 13.250 Vali Acc: 0.260 Test Loss: 13.250 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.363145112991333
Epoch: 6, Steps: 32 | Train Loss: 2.705 Vali Loss: 14.952 Vali Acc: 0.496 Test Loss: 14.952 Test Acc: 0.496
Validation loss decreased (-0.480780 --> -0.496034).  Saving model ...
Epoch: 7 cost time: 4.639526844024658
Epoch: 7, Steps: 32 | Train Loss: 1.910 Vali Loss: 12.362 Vali Acc: 0.466 Test Loss: 12.362 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6694130897521973
Epoch: 8, Steps: 32 | Train Loss: 3.260 Vali Loss: 22.653 Vali Acc: 0.443 Test Loss: 22.653 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.640428304672241
Epoch: 9, Steps: 32 | Train Loss: 6.431 Vali Loss: 23.129 Vali Acc: 0.336 Test Loss: 23.129 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.025787115097046
Epoch: 10, Steps: 32 | Train Loss: 2.724 Vali Loss: 46.660 Vali Acc: 0.504 Test Loss: 46.660 Test Acc: 0.504
Validation loss decreased (-0.496034 --> -0.503350).  Saving model ...
Epoch: 11 cost time: 4.406178951263428
Epoch: 11, Steps: 32 | Train Loss: 2.987 Vali Loss: 39.223 Vali Acc: 0.336 Test Loss: 39.223 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.287337303161621
Epoch: 12, Steps: 32 | Train Loss: 0.803 Vali Loss: 38.181 Vali Acc: 0.427 Test Loss: 38.181 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.446918249130249
Epoch: 13, Steps: 32 | Train Loss: 3.926 Vali Loss: 27.636 Vali Acc: 0.473 Test Loss: 27.636 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8978607654571533
Epoch: 14, Steps: 32 | Train Loss: 2.505 Vali Loss: 28.507 Vali Acc: 0.443 Test Loss: 28.507 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.716062307357788
Epoch: 15, Steps: 32 | Train Loss: 1.991 Vali Loss: 30.285 Vali Acc: 0.344 Test Loss: 30.285 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.080652713775635
Epoch: 16, Steps: 32 | Train Loss: 2.305 Vali Loss: 37.203 Vali Acc: 0.450 Test Loss: 37.203 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.964656352996826
Epoch: 17, Steps: 32 | Train Loss: 1.965 Vali Loss: 29.272 Vali Acc: 0.511 Test Loss: 29.272 Test Acc: 0.511
Validation loss decreased (-0.503350 --> -0.511158).  Saving model ...
Epoch: 18 cost time: 4.266365051269531
Epoch: 18, Steps: 32 | Train Loss: 3.348 Vali Loss: 34.863 Vali Acc: 0.427 Test Loss: 34.863 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.264019966125488
Epoch: 19, Steps: 32 | Train Loss: 2.453 Vali Loss: 31.286 Vali Acc: 0.344 Test Loss: 31.286 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.964714765548706
Epoch: 20, Steps: 32 | Train Loss: 2.787 Vali Loss: 23.305 Vali Acc: 0.481 Test Loss: 23.305 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.368356227874756
Epoch: 21, Steps: 32 | Train Loss: 1.440 Vali Loss: 32.462 Vali Acc: 0.328 Test Loss: 32.462 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9506335258483887
Epoch: 22, Steps: 32 | Train Loss: 0.633 Vali Loss: 31.591 Vali Acc: 0.427 Test Loss: 31.591 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.120574474334717
Epoch: 23, Steps: 32 | Train Loss: 1.356 Vali Loss: 29.174 Vali Acc: 0.466 Test Loss: 29.174 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.584386587142944
Epoch: 24, Steps: 32 | Train Loss: 0.039 Vali Loss: 30.993 Vali Acc: 0.504 Test Loss: 30.993 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.154027223587036
Epoch: 25, Steps: 32 | Train Loss: 0.721 Vali Loss: 57.913 Vali Acc: 0.336 Test Loss: 57.913 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.250998020172119
Epoch: 26, Steps: 32 | Train Loss: 1.060 Vali Loss: 30.134 Vali Acc: 0.481 Test Loss: 30.134 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.7905423641204834
Epoch: 27, Steps: 32 | Train Loss: 0.611 Vali Loss: 38.287 Vali Acc: 0.458 Test Loss: 38.287 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2899989
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.261934757232666
Epoch: 1, Steps: 32 | Train Loss: 3.759 Vali Loss: 11.593 Vali Acc: 0.221 Test Loss: 11.593 Test Acc: 0.221
Validation loss decreased (inf --> -0.221258).  Saving model ...
Epoch: 2 cost time: 4.313924789428711
Epoch: 2, Steps: 32 | Train Loss: 5.635 Vali Loss: 14.473 Vali Acc: 0.153 Test Loss: 14.473 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.467437028884888
Epoch: 3, Steps: 32 | Train Loss: 5.640 Vali Loss: 13.570 Vali Acc: 0.290 Test Loss: 13.570 Test Acc: 0.290
Validation loss decreased (-0.221258 --> -0.289941).  Saving model ...
Epoch: 4 cost time: 4.643520355224609
Epoch: 4, Steps: 32 | Train Loss: 5.647 Vali Loss: 12.769 Vali Acc: 0.321 Test Loss: 12.769 Test Acc: 0.321
Validation loss decreased (-0.289941 --> -0.320483).  Saving model ...
Epoch: 5 cost time: 4.882909059524536
Epoch: 5, Steps: 32 | Train Loss: 9.144 Vali Loss: 21.304 Vali Acc: 0.481 Test Loss: 21.304 Test Acc: 0.481
Validation loss decreased (-0.320483 --> -0.480703).  Saving model ...
Epoch: 6 cost time: 4.750436544418335
Epoch: 6, Steps: 32 | Train Loss: 2.720 Vali Loss: 18.317 Vali Acc: 0.389 Test Loss: 18.317 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.278376817703247
Epoch: 7, Steps: 32 | Train Loss: 1.630 Vali Loss: 14.428 Vali Acc: 0.420 Test Loss: 14.428 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.279003143310547
Epoch: 8, Steps: 32 | Train Loss: 4.070 Vali Loss: 14.765 Vali Acc: 0.473 Test Loss: 14.765 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.3215296268463135
Epoch: 9, Steps: 32 | Train Loss: 2.419 Vali Loss: 14.725 Vali Acc: 0.527 Test Loss: 14.725 Test Acc: 0.527
Validation loss decreased (-0.480703 --> -0.526570).  Saving model ...
Epoch: 10 cost time: 4.200655460357666
Epoch: 10, Steps: 32 | Train Loss: 1.993 Vali Loss: 22.768 Vali Acc: 0.458 Test Loss: 22.768 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.584521770477295
Epoch: 11, Steps: 32 | Train Loss: 1.928 Vali Loss: 24.711 Vali Acc: 0.366 Test Loss: 24.711 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.8403947353363037
Epoch: 12, Steps: 32 | Train Loss: 2.476 Vali Loss: 33.068 Vali Acc: 0.237 Test Loss: 33.068 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.614267826080322
Epoch: 13, Steps: 32 | Train Loss: 1.460 Vali Loss: 21.636 Vali Acc: 0.450 Test Loss: 21.636 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.550650358200073
Epoch: 14, Steps: 32 | Train Loss: 5.500 Vali Loss: 19.148 Vali Acc: 0.550 Test Loss: 19.148 Test Acc: 0.550
Validation loss decreased (-0.526570 --> -0.549427).  Saving model ...
Epoch: 15 cost time: 4.819974899291992
Epoch: 15, Steps: 32 | Train Loss: 1.721 Vali Loss: 19.353 Vali Acc: 0.550 Test Loss: 19.353 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.376255989074707
Epoch: 16, Steps: 32 | Train Loss: 0.431 Vali Loss: 41.888 Vali Acc: 0.260 Test Loss: 41.888 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.092454671859741
Epoch: 17, Steps: 32 | Train Loss: 3.619 Vali Loss: 25.952 Vali Acc: 0.458 Test Loss: 25.952 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.259755373001099
Epoch: 18, Steps: 32 | Train Loss: 2.261 Vali Loss: 37.013 Vali Acc: 0.366 Test Loss: 37.013 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.178319692611694
Epoch: 19, Steps: 32 | Train Loss: 0.573 Vali Loss: 53.591 Vali Acc: 0.305 Test Loss: 53.591 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.594958305358887
Epoch: 20, Steps: 32 | Train Loss: 2.532 Vali Loss: 38.530 Vali Acc: 0.504 Test Loss: 38.530 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.7226481437683105
Epoch: 21, Steps: 32 | Train Loss: 4.088 Vali Loss: 37.657 Vali Acc: 0.473 Test Loss: 37.657 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.4601733684539795
Epoch: 22, Steps: 32 | Train Loss: 4.450 Vali Loss: 45.449 Vali Acc: 0.397 Test Loss: 45.449 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.520760774612427
Epoch: 23, Steps: 32 | Train Loss: 1.008 Vali Loss: 41.500 Vali Acc: 0.565 Test Loss: 41.500 Test Acc: 0.565
Validation loss decreased (-0.549427 --> -0.564471).  Saving model ...
Epoch: 24 cost time: 4.417715311050415
Epoch: 24, Steps: 32 | Train Loss: 2.895 Vali Loss: 35.055 Vali Acc: 0.565 Test Loss: 35.055 Test Acc: 0.565
Validation loss decreased (-0.564471 --> -0.564535).  Saving model ...
Epoch: 25 cost time: 4.282493352890015
Epoch: 25, Steps: 32 | Train Loss: 1.765 Vali Loss: 75.090 Vali Acc: 0.229 Test Loss: 75.090 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.023544549942017
Epoch: 26, Steps: 32 | Train Loss: 2.173 Vali Loss: 57.991 Vali Acc: 0.351 Test Loss: 57.991 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.45072340965271
Epoch: 27, Steps: 32 | Train Loss: 0.770 Vali Loss: 52.823 Vali Acc: 0.489 Test Loss: 52.823 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.388054847717285
Epoch: 28, Steps: 32 | Train Loss: 0.378 Vali Loss: 41.635 Vali Acc: 0.557 Test Loss: 41.635 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.627388000488281
Epoch: 29, Steps: 32 | Train Loss: 0.502 Vali Loss: 62.312 Vali Acc: 0.489 Test Loss: 62.312 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7473676204681396
Epoch: 30, Steps: 32 | Train Loss: 1.724 Vali Loss: 35.805 Vali Acc: 0.458 Test Loss: 35.805 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.935866117477417
Epoch: 31, Steps: 32 | Train Loss: 0.994 Vali Loss: 37.595 Vali Acc: 0.450 Test Loss: 37.595 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.475676774978638
Epoch: 32, Steps: 32 | Train Loss: 0.245 Vali Loss: 52.539 Vali Acc: 0.420 Test Loss: 52.539 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.039957761764526
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.580 Vali Acc: 0.618 Test Loss: 37.580 Test Acc: 0.618
Validation loss decreased (-0.564535 --> -0.617945).  Saving model ...
Epoch: 34 cost time: 4.023345708847046
Epoch: 34, Steps: 32 | Train Loss: 0.059 Vali Loss: 62.381 Vali Acc: 0.351 Test Loss: 62.381 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.745011329650879
Epoch: 35, Steps: 32 | Train Loss: 0.162 Vali Loss: 36.718 Vali Acc: 0.580 Test Loss: 36.718 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.1115381717681885
Epoch: 36, Steps: 32 | Train Loss: 0.109 Vali Loss: 49.178 Vali Acc: 0.580 Test Loss: 49.178 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.4729907512664795
Epoch: 37, Steps: 32 | Train Loss: 0.241 Vali Loss: 66.705 Vali Acc: 0.305 Test Loss: 66.705 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.76858115196228
Epoch: 38, Steps: 32 | Train Loss: 0.181 Vali Loss: 82.910 Vali Acc: 0.298 Test Loss: 82.910 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.9230129718780518
Epoch: 39, Steps: 32 | Train Loss: 0.871 Vali Loss: 120.514 Vali Acc: 0.504 Test Loss: 120.514 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.24931263923645
Epoch: 40, Steps: 32 | Train Loss: 0.969 Vali Loss: 113.366 Vali Acc: 0.534 Test Loss: 113.366 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.103292942047119
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 116.407 Vali Acc: 0.534 Test Loss: 116.407 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.900400876998901
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 116.550 Vali Acc: 0.534 Test Loss: 116.550 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.948044776916504
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 116.555 Vali Acc: 0.534 Test Loss: 116.555 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 2899989
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.4993979930877686
Epoch: 1, Steps: 32 | Train Loss: 2.926 Vali Loss: 6.748 Vali Acc: 0.420 Test Loss: 6.748 Test Acc: 0.420
Validation loss decreased (inf --> -0.419780).  Saving model ...
Epoch: 2 cost time: 4.041753768920898
Epoch: 2, Steps: 32 | Train Loss: 4.368 Vali Loss: 8.617 Vali Acc: 0.229 Test Loss: 8.617 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.401794910430908
Epoch: 3, Steps: 32 | Train Loss: 7.943 Vali Loss: 7.980 Vali Acc: 0.450 Test Loss: 7.980 Test Acc: 0.450
Validation loss decreased (-0.419780 --> -0.450302).  Saving model ...
Epoch: 4 cost time: 3.6669938564300537
Epoch: 4, Steps: 32 | Train Loss: 9.285 Vali Loss: 10.369 Vali Acc: 0.427 Test Loss: 10.369 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.861741542816162
Epoch: 5, Steps: 32 | Train Loss: 6.217 Vali Loss: 25.879 Vali Acc: 0.252 Test Loss: 25.879 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.316424608230591
Epoch: 6, Steps: 32 | Train Loss: 5.221 Vali Loss: 12.413 Vali Acc: 0.458 Test Loss: 12.413 Test Acc: 0.458
Validation loss decreased (-0.450302 --> -0.457891).  Saving model ...
Epoch: 7 cost time: 3.8644471168518066
Epoch: 7, Steps: 32 | Train Loss: 6.063 Vali Loss: 19.703 Vali Acc: 0.275 Test Loss: 19.703 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.06240439414978
Epoch: 8, Steps: 32 | Train Loss: 6.336 Vali Loss: 13.788 Vali Acc: 0.382 Test Loss: 13.788 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.953951120376587
Epoch: 9, Steps: 32 | Train Loss: 5.362 Vali Loss: 28.212 Vali Acc: 0.237 Test Loss: 28.212 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.39328932762146
Epoch: 10, Steps: 32 | Train Loss: 5.289 Vali Loss: 21.477 Vali Acc: 0.389 Test Loss: 21.477 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6975011825561523
Epoch: 11, Steps: 32 | Train Loss: 3.876 Vali Loss: 19.943 Vali Acc: 0.382 Test Loss: 19.943 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.8322913646698
Epoch: 12, Steps: 32 | Train Loss: 4.464 Vali Loss: 31.597 Vali Acc: 0.260 Test Loss: 31.597 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.3767173290252686
Epoch: 13, Steps: 32 | Train Loss: 5.423 Vali Loss: 34.635 Vali Acc: 0.328 Test Loss: 34.635 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.063594341278076
Epoch: 14, Steps: 32 | Train Loss: 5.444 Vali Loss: 37.875 Vali Acc: 0.298 Test Loss: 37.875 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.23518705368042
Epoch: 15, Steps: 32 | Train Loss: 2.718 Vali Loss: 44.545 Vali Acc: 0.298 Test Loss: 44.545 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.7941198348999023
Epoch: 16, Steps: 32 | Train Loss: 2.920 Vali Loss: 29.279 Vali Acc: 0.359 Test Loss: 29.279 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 2899989
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.279303312301636
Epoch: 1, Steps: 32 | Train Loss: 4.447 Vali Loss: 2.097 Vali Acc: 0.527 Test Loss: 2.097 Test Acc: 0.527
Validation loss decreased (inf --> -0.526697).  Saving model ...
Epoch: 2 cost time: 4.240053176879883
Epoch: 2, Steps: 32 | Train Loss: 3.935 Vali Loss: 6.232 Vali Acc: 0.290 Test Loss: 6.232 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.085864782333374
Epoch: 3, Steps: 32 | Train Loss: 4.105 Vali Loss: 11.254 Vali Acc: 0.328 Test Loss: 11.254 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.900760173797607
Epoch: 4, Steps: 32 | Train Loss: 5.082 Vali Loss: 8.509 Vali Acc: 0.344 Test Loss: 8.509 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.9151771068573
Epoch: 5, Steps: 32 | Train Loss: 4.205 Vali Loss: 18.893 Vali Acc: 0.427 Test Loss: 18.893 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.535017728805542
Epoch: 6, Steps: 32 | Train Loss: 5.350 Vali Loss: 11.988 Vali Acc: 0.489 Test Loss: 11.988 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.108381271362305
Epoch: 7, Steps: 32 | Train Loss: 3.752 Vali Loss: 14.860 Vali Acc: 0.435 Test Loss: 14.860 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.344934940338135
Epoch: 8, Steps: 32 | Train Loss: 1.147 Vali Loss: 25.400 Vali Acc: 0.183 Test Loss: 25.400 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.7463295459747314
Epoch: 9, Steps: 32 | Train Loss: 1.549 Vali Loss: 10.702 Vali Acc: 0.435 Test Loss: 10.702 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.939042329788208
Epoch: 10, Steps: 32 | Train Loss: 0.654 Vali Loss: 16.851 Vali Acc: 0.351 Test Loss: 16.851 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.321248769760132
Epoch: 11, Steps: 32 | Train Loss: 3.997 Vali Loss: 19.968 Vali Acc: 0.344 Test Loss: 19.968 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 2891797
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.158122301101685
Epoch: 1, Steps: 32 | Train Loss: 4.333 Vali Loss: 2.339 Vali Acc: 0.466 Test Loss: 2.339 Test Acc: 0.466
Validation loss decreased (inf --> -0.465625).  Saving model ...
Epoch: 2 cost time: 5.146056175231934
Epoch: 2, Steps: 32 | Train Loss: 3.964 Vali Loss: 3.233 Vali Acc: 0.450 Test Loss: 3.233 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.3385913372039795
Epoch: 3, Steps: 32 | Train Loss: 3.353 Vali Loss: 10.035 Vali Acc: 0.359 Test Loss: 10.035 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.271394968032837
Epoch: 4, Steps: 32 | Train Loss: 6.643 Vali Loss: 22.564 Vali Acc: 0.450 Test Loss: 22.564 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.937931776046753
Epoch: 5, Steps: 32 | Train Loss: 6.798 Vali Loss: 17.721 Vali Acc: 0.176 Test Loss: 17.721 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.743541717529297
Epoch: 6, Steps: 32 | Train Loss: 5.077 Vali Loss: 17.245 Vali Acc: 0.435 Test Loss: 17.245 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.4005372524261475
Epoch: 7, Steps: 32 | Train Loss: 5.392 Vali Loss: 23.157 Vali Acc: 0.481 Test Loss: 23.157 Test Acc: 0.481
Validation loss decreased (-0.465625 --> -0.480684).  Saving model ...
Epoch: 8 cost time: 3.8592371940612793
Epoch: 8, Steps: 32 | Train Loss: 9.062 Vali Loss: 22.690 Vali Acc: 0.282 Test Loss: 22.690 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2222840785980225
Epoch: 9, Steps: 32 | Train Loss: 4.479 Vali Loss: 30.600 Vali Acc: 0.298 Test Loss: 30.600 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.54588508605957
Epoch: 10, Steps: 32 | Train Loss: 0.499 Vali Loss: 28.415 Vali Acc: 0.405 Test Loss: 28.415 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.302838087081909
Epoch: 11, Steps: 32 | Train Loss: 1.737 Vali Loss: 29.753 Vali Acc: 0.511 Test Loss: 29.753 Test Acc: 0.511
Validation loss decreased (-0.480684 --> -0.511153).  Saving model ...
Epoch: 12 cost time: 4.042340040206909
Epoch: 12, Steps: 32 | Train Loss: 0.713 Vali Loss: 49.244 Vali Acc: 0.412 Test Loss: 49.244 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.202021360397339
Epoch: 13, Steps: 32 | Train Loss: 7.550 Vali Loss: 26.449 Vali Acc: 0.496 Test Loss: 26.449 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.854430198669434
Epoch: 14, Steps: 32 | Train Loss: 3.171 Vali Loss: 49.750 Vali Acc: 0.290 Test Loss: 49.750 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.124575853347778
Epoch: 15, Steps: 32 | Train Loss: 1.177 Vali Loss: 26.567 Vali Acc: 0.389 Test Loss: 26.567 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.688467264175415
Epoch: 16, Steps: 32 | Train Loss: 0.538 Vali Loss: 23.873 Vali Acc: 0.405 Test Loss: 23.873 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.394953012466431
Epoch: 17, Steps: 32 | Train Loss: 0.568 Vali Loss: 22.798 Vali Acc: 0.534 Test Loss: 22.798 Test Acc: 0.534
Validation loss decreased (-0.511153 --> -0.534123).  Saving model ...
Epoch: 18 cost time: 5.431612491607666
Epoch: 18, Steps: 32 | Train Loss: 5.679 Vali Loss: 43.231 Vali Acc: 0.504 Test Loss: 43.231 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.8885533809661865
Epoch: 19, Steps: 32 | Train Loss: 3.318 Vali Loss: 37.736 Vali Acc: 0.519 Test Loss: 37.736 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.366459608078003
Epoch: 20, Steps: 32 | Train Loss: 1.744 Vali Loss: 36.196 Vali Acc: 0.489 Test Loss: 36.196 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.081006765365601
Epoch: 21, Steps: 32 | Train Loss: 1.431 Vali Loss: 55.085 Vali Acc: 0.389 Test Loss: 55.085 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.736516714096069
Epoch: 22, Steps: 32 | Train Loss: 1.557 Vali Loss: 30.355 Vali Acc: 0.443 Test Loss: 30.355 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.42040753364563
Epoch: 23, Steps: 32 | Train Loss: 4.843 Vali Loss: 32.516 Vali Acc: 0.481 Test Loss: 32.516 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.870202302932739
Epoch: 24, Steps: 32 | Train Loss: 6.167 Vali Loss: 37.938 Vali Acc: 0.435 Test Loss: 37.938 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.25041651725769
Epoch: 25, Steps: 32 | Train Loss: 0.607 Vali Loss: 42.426 Vali Acc: 0.473 Test Loss: 42.426 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.646529674530029
Epoch: 26, Steps: 32 | Train Loss: 0.848 Vali Loss: 40.992 Vali Acc: 0.534 Test Loss: 40.992 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.896363019943237
Epoch: 27, Steps: 32 | Train Loss: 0.649 Vali Loss: 45.503 Vali Acc: 0.458 Test Loss: 45.503 Test Acc: 0.458
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2891797
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.553283452987671
Epoch: 1, Steps: 32 | Train Loss: 3.919 Vali Loss: 5.945 Vali Acc: 0.282 Test Loss: 5.945 Test Acc: 0.282
Validation loss decreased (inf --> -0.282383).  Saving model ...
Epoch: 2 cost time: 4.801711320877075
Epoch: 2, Steps: 32 | Train Loss: 5.853 Vali Loss: 6.739 Vali Acc: 0.511 Test Loss: 6.739 Test Acc: 0.511
Validation loss decreased (-0.282383 --> -0.511383).  Saving model ...
Epoch: 3 cost time: 4.185394287109375
Epoch: 3, Steps: 32 | Train Loss: 5.648 Vali Loss: 9.060 Vali Acc: 0.374 Test Loss: 9.060 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6285407543182373
Epoch: 4, Steps: 32 | Train Loss: 6.129 Vali Loss: 20.128 Vali Acc: 0.351 Test Loss: 20.128 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7876596450805664
Epoch: 5, Steps: 32 | Train Loss: 5.638 Vali Loss: 20.312 Vali Acc: 0.450 Test Loss: 20.312 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.665163278579712
Epoch: 6, Steps: 32 | Train Loss: 4.750 Vali Loss: 14.982 Vali Acc: 0.275 Test Loss: 14.982 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.257817506790161
Epoch: 7, Steps: 32 | Train Loss: 2.214 Vali Loss: 11.537 Vali Acc: 0.366 Test Loss: 11.537 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.6942696571350098
Epoch: 8, Steps: 32 | Train Loss: 2.557 Vali Loss: 9.538 Vali Acc: 0.481 Test Loss: 9.538 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8356783390045166
Epoch: 9, Steps: 32 | Train Loss: 0.737 Vali Loss: 12.867 Vali Acc: 0.511 Test Loss: 12.867 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.4831016063690186
Epoch: 10, Steps: 32 | Train Loss: 3.291 Vali Loss: 24.576 Vali Acc: 0.328 Test Loss: 24.576 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.263920545578003
Epoch: 11, Steps: 32 | Train Loss: 6.422 Vali Loss: 14.098 Vali Acc: 0.466 Test Loss: 14.098 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 4.639800548553467
Epoch: 12, Steps: 32 | Train Loss: 2.193 Vali Loss: 24.708 Vali Acc: 0.473 Test Loss: 24.708 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2891797
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.587906122207642
Epoch: 1, Steps: 32 | Train Loss: 3.923 Vali Loss: 6.369 Vali Acc: 0.267 Test Loss: 6.369 Test Acc: 0.267
Validation loss decreased (inf --> -0.267112).  Saving model ...
Epoch: 2 cost time: 4.456568002700806
Epoch: 2, Steps: 32 | Train Loss: 5.609 Vali Loss: 9.865 Vali Acc: 0.328 Test Loss: 9.865 Test Acc: 0.328
Validation loss decreased (-0.267112 --> -0.328146).  Saving model ...
Epoch: 3 cost time: 3.470543146133423
Epoch: 3, Steps: 32 | Train Loss: 7.036 Vali Loss: 10.688 Vali Acc: 0.374 Test Loss: 10.688 Test Acc: 0.374
Validation loss decreased (-0.328146 --> -0.373939).  Saving model ...
Epoch: 4 cost time: 3.3716440200805664
Epoch: 4, Steps: 32 | Train Loss: 9.323 Vali Loss: 13.202 Vali Acc: 0.397 Test Loss: 13.202 Test Acc: 0.397
Validation loss decreased (-0.373939 --> -0.396815).  Saving model ...
Epoch: 5 cost time: 4.498798608779907
Epoch: 5, Steps: 32 | Train Loss: 7.378 Vali Loss: 13.066 Vali Acc: 0.534 Test Loss: 13.066 Test Acc: 0.534
Validation loss decreased (-0.396815 --> -0.534220).  Saving model ...
Epoch: 6 cost time: 3.9898035526275635
Epoch: 6, Steps: 32 | Train Loss: 10.204 Vali Loss: 11.134 Vali Acc: 0.534 Test Loss: 11.134 Test Acc: 0.534
Validation loss decreased (-0.534220 --> -0.534240).  Saving model ...
Epoch: 7 cost time: 3.6769580841064453
Epoch: 7, Steps: 32 | Train Loss: 11.575 Vali Loss: 9.449 Vali Acc: 0.382 Test Loss: 9.449 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.126219034194946
Epoch: 8, Steps: 32 | Train Loss: 6.047 Vali Loss: 19.938 Vali Acc: 0.328 Test Loss: 19.938 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.460702896118164
Epoch: 9, Steps: 32 | Train Loss: 3.332 Vali Loss: 15.940 Vali Acc: 0.420 Test Loss: 15.940 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.8707451820373535
Epoch: 10, Steps: 32 | Train Loss: 3.163 Vali Loss: 20.770 Vali Acc: 0.405 Test Loss: 20.770 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.954252243041992
Epoch: 11, Steps: 32 | Train Loss: 4.785 Vali Loss: 26.208 Vali Acc: 0.267 Test Loss: 26.208 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.972752809524536
Epoch: 12, Steps: 32 | Train Loss: 3.134 Vali Loss: 36.529 Vali Acc: 0.336 Test Loss: 36.529 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.496002674102783
Epoch: 13, Steps: 32 | Train Loss: 7.362 Vali Loss: 25.686 Vali Acc: 0.389 Test Loss: 25.686 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.663372278213501
Epoch: 14, Steps: 32 | Train Loss: 5.579 Vali Loss: 26.574 Vali Acc: 0.427 Test Loss: 26.574 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.528648614883423
Epoch: 15, Steps: 32 | Train Loss: 2.107 Vali Loss: 25.442 Vali Acc: 0.389 Test Loss: 25.442 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.8757808208465576
Epoch: 16, Steps: 32 | Train Loss: 1.549 Vali Loss: 27.072 Vali Acc: 0.405 Test Loss: 27.072 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 2891797
model size : 13.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.734940767288208
Epoch: 1, Steps: 64 | Train Loss: 132.616 Vali Loss: 218.947 Vali Acc: 0.450 Test Loss: 218.947 Test Acc: 0.450
Validation loss decreased (inf --> -0.448192).  Saving model ...
Epoch: 2 cost time: 21.56670594215393
Epoch: 2, Steps: 64 | Train Loss: 173.649 Vali Loss: 160.072 Vali Acc: 0.344 Test Loss: 160.072 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 21.533400297164917
Epoch: 3, Steps: 64 | Train Loss: 177.331 Vali Loss: 229.524 Vali Acc: 0.511 Test Loss: 229.524 Test Acc: 0.511
Validation loss decreased (-0.448192 --> -0.509155).  Saving model ...
Epoch: 4 cost time: 21.230150938034058
Epoch: 4, Steps: 64 | Train Loss: 241.689 Vali Loss: 424.507 Vali Acc: 0.481 Test Loss: 424.507 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 21.34663414955139
Epoch: 5, Steps: 64 | Train Loss: 136.342 Vali Loss: 398.547 Vali Acc: 0.328 Test Loss: 398.547 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 21.534926414489746
Epoch: 6, Steps: 64 | Train Loss: 149.547 Vali Loss: 531.255 Vali Acc: 0.580 Test Loss: 531.255 Test Acc: 0.580
Validation loss decreased (-0.509155 --> -0.574840).  Saving model ...
Epoch: 7 cost time: 21.352071285247803
Epoch: 7, Steps: 64 | Train Loss: 121.416 Vali Loss: 321.555 Vali Acc: 0.527 Test Loss: 321.555 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 21.35461139678955
Epoch: 8, Steps: 64 | Train Loss: 105.098 Vali Loss: 376.048 Vali Acc: 0.603 Test Loss: 376.048 Test Acc: 0.603
Validation loss decreased (-0.574840 --> -0.599293).  Saving model ...
Epoch: 9 cost time: 21.776785612106323
Epoch: 9, Steps: 64 | Train Loss: 50.051 Vali Loss: 303.161 Vali Acc: 0.603 Test Loss: 303.161 Test Acc: 0.603
Validation loss decreased (-0.599293 --> -0.600022).  Saving model ...
Epoch: 10 cost time: 21.67536735534668
Epoch: 10, Steps: 64 | Train Loss: 37.097 Vali Loss: 413.928 Vali Acc: 0.603 Test Loss: 413.928 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 21.359561681747437
Epoch: 11, Steps: 64 | Train Loss: 24.457 Vali Loss: 614.053 Vali Acc: 0.420 Test Loss: 614.053 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 21.496880292892456
Epoch: 12, Steps: 64 | Train Loss: 33.591 Vali Loss: 542.492 Vali Acc: 0.580 Test Loss: 542.492 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 21.702887535095215
Epoch: 13, Steps: 64 | Train Loss: 31.420 Vali Loss: 575.534 Vali Acc: 0.458 Test Loss: 575.534 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 21.342087030410767
Epoch: 14, Steps: 64 | Train Loss: 145.992 Vali Loss: 677.066 Vali Acc: 0.573 Test Loss: 677.066 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 21.472646236419678
Epoch: 15, Steps: 64 | Train Loss: 21.102 Vali Loss: 647.923 Vali Acc: 0.557 Test Loss: 647.923 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 21.802072048187256
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 687.751 Vali Acc: 0.580 Test Loss: 687.751 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 21.781774759292603
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 687.812 Vali Acc: 0.580 Test Loss: 687.812 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 21.443761348724365
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 687.812 Vali Acc: 0.580 Test Loss: 687.812 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 21.38374972343445
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 687.812 Vali Acc: 0.580 Test Loss: 687.812 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 48682029
model size : 220.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.82128620147705
Epoch: 1, Steps: 64 | Train Loss: 174.793 Vali Loss: 332.774 Vali Acc: 0.427 Test Loss: 332.774 Test Acc: 0.427
Validation loss decreased (inf --> -0.424153).  Saving model ...
Epoch: 2 cost time: 19.837188243865967
Epoch: 2, Steps: 64 | Train Loss: 183.358 Vali Loss: 68.748 Vali Acc: 0.550 Test Loss: 68.748 Test Acc: 0.550
Validation loss decreased (-0.424153 --> -0.548931).  Saving model ...
Epoch: 3 cost time: 20.091106176376343
Epoch: 3, Steps: 64 | Train Loss: 182.084 Vali Loss: 416.727 Vali Acc: 0.466 Test Loss: 416.727 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.544943809509277
Epoch: 4, Steps: 64 | Train Loss: 316.517 Vali Loss: 586.418 Vali Acc: 0.450 Test Loss: 586.418 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.028833389282227
Epoch: 5, Steps: 64 | Train Loss: 164.270 Vali Loss: 380.253 Vali Acc: 0.573 Test Loss: 380.253 Test Acc: 0.573
Validation loss decreased (-0.548931 --> -0.568717).  Saving model ...
Epoch: 6 cost time: 20.129350423812866
Epoch: 6, Steps: 64 | Train Loss: 79.291 Vali Loss: 464.124 Vali Acc: 0.527 Test Loss: 464.124 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.39383339881897
Epoch: 7, Steps: 64 | Train Loss: 113.032 Vali Loss: 610.658 Vali Acc: 0.550 Test Loss: 610.658 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.376117944717407
Epoch: 8, Steps: 64 | Train Loss: 83.260 Vali Loss: 627.192 Vali Acc: 0.527 Test Loss: 627.192 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.130406379699707
Epoch: 9, Steps: 64 | Train Loss: 92.592 Vali Loss: 580.425 Vali Acc: 0.550 Test Loss: 580.425 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.022547006607056
Epoch: 10, Steps: 64 | Train Loss: 13.976 Vali Loss: 469.264 Vali Acc: 0.595 Test Loss: 469.264 Test Acc: 0.595
Validation loss decreased (-0.568717 --> -0.590727).  Saving model ...
Epoch: 11 cost time: 20.26292085647583
Epoch: 11, Steps: 64 | Train Loss: 37.436 Vali Loss: 426.195 Vali Acc: 0.527 Test Loss: 426.195 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.034892797470093
Epoch: 12, Steps: 64 | Train Loss: 48.203 Vali Loss: 710.491 Vali Acc: 0.534 Test Loss: 710.491 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.026666402816772
Epoch: 13, Steps: 64 | Train Loss: 3.671 Vali Loss: 547.580 Vali Acc: 0.588 Test Loss: 547.580 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.24029564857483
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.152 Vali Acc: 0.588 Test Loss: 551.152 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.498674154281616
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.113222122192383
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.130287885665894
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.42339038848877
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 20.38886308670044
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.446240425109863
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 551.156 Vali Acc: 0.588 Test Loss: 551.156 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 48682029
model size : 220.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 18.765602827072144
Epoch: 1, Steps: 32 | Train Loss: 72.341 Vali Loss: 74.554 Vali Acc: 0.137 Test Loss: 74.554 Test Acc: 0.137
Validation loss decreased (inf --> -0.136659).  Saving model ...
Epoch: 2 cost time: 16.88813829421997
Epoch: 2, Steps: 32 | Train Loss: 114.476 Vali Loss: 98.552 Vali Acc: 0.443 Test Loss: 98.552 Test Acc: 0.443
Validation loss decreased (-0.136659 --> -0.441763).  Saving model ...
Epoch: 3 cost time: 16.628379583358765
Epoch: 3, Steps: 32 | Train Loss: 103.827 Vali Loss: 318.888 Vali Acc: 0.183 Test Loss: 318.888 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.907357692718506
Epoch: 4, Steps: 32 | Train Loss: 174.520 Vali Loss: 162.775 Vali Acc: 0.191 Test Loss: 162.775 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 16.88551664352417
Epoch: 5, Steps: 32 | Train Loss: 115.409 Vali Loss: 180.105 Vali Acc: 0.206 Test Loss: 180.105 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 16.993014574050903
Epoch: 6, Steps: 32 | Train Loss: 66.123 Vali Loss: 142.366 Vali Acc: 0.466 Test Loss: 142.366 Test Acc: 0.466
Validation loss decreased (-0.441763 --> -0.464225).  Saving model ...
Epoch: 7 cost time: 17.042930126190186
Epoch: 7, Steps: 32 | Train Loss: 83.596 Vali Loss: 140.239 Vali Acc: 0.504 Test Loss: 140.239 Test Acc: 0.504
Validation loss decreased (-0.464225 --> -0.502414).  Saving model ...
Epoch: 8 cost time: 17.57739758491516
Epoch: 8, Steps: 32 | Train Loss: 39.856 Vali Loss: 160.984 Vali Acc: 0.504 Test Loss: 160.984 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 17.460342168807983
Epoch: 9, Steps: 32 | Train Loss: 26.706 Vali Loss: 131.543 Vali Acc: 0.634 Test Loss: 131.543 Test Acc: 0.634
Validation loss decreased (-0.502414 --> -0.632272).  Saving model ...
Epoch: 10 cost time: 17.23018193244934
Epoch: 10, Steps: 32 | Train Loss: 9.394 Vali Loss: 131.425 Vali Acc: 0.603 Test Loss: 131.425 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 17.33526349067688
Epoch: 11, Steps: 32 | Train Loss: 9.758 Vali Loss: 158.807 Vali Acc: 0.527 Test Loss: 158.807 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 17.60003137588501
Epoch: 12, Steps: 32 | Train Loss: 13.954 Vali Loss: 189.544 Vali Acc: 0.603 Test Loss: 189.544 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 17.47732448577881
Epoch: 13, Steps: 32 | Train Loss: 10.186 Vali Loss: 375.433 Vali Acc: 0.550 Test Loss: 375.433 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 17.202901124954224
Epoch: 14, Steps: 32 | Train Loss: 32.116 Vali Loss: 252.305 Vali Acc: 0.588 Test Loss: 252.305 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 17.223342180252075
Epoch: 15, Steps: 32 | Train Loss: 58.254 Vali Loss: 290.809 Vali Acc: 0.603 Test Loss: 290.809 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 17.53227472305298
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 562.845 Vali Acc: 0.679 Test Loss: 562.845 Test Acc: 0.679
Validation loss decreased (-0.632272 --> -0.673761).  Saving model ...
Epoch: 17 cost time: 17.320645332336426
Epoch: 17, Steps: 32 | Train Loss: 6.110 Vali Loss: 661.057 Vali Acc: 0.580 Test Loss: 661.057 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 17.37752938270569
Epoch: 18, Steps: 32 | Train Loss: 47.494 Vali Loss: 551.586 Vali Acc: 0.550 Test Loss: 551.586 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 17.296452283859253
Epoch: 19, Steps: 32 | Train Loss: 7.015 Vali Loss: 627.514 Vali Acc: 0.504 Test Loss: 627.514 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 17.36185908317566
Epoch: 20, Steps: 32 | Train Loss: 27.520 Vali Loss: 655.242 Vali Acc: 0.450 Test Loss: 655.242 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 17.394235372543335
Epoch: 21, Steps: 32 | Train Loss: 39.245 Vali Loss: 703.911 Vali Acc: 0.611 Test Loss: 703.911 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 17.370178699493408
Epoch: 22, Steps: 32 | Train Loss: 12.288 Vali Loss: 625.802 Vali Acc: 0.611 Test Loss: 625.802 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 17.346648693084717
Epoch: 23, Steps: 32 | Train Loss: 21.298 Vali Loss: 1014.245 Vali Acc: 0.427 Test Loss: 1014.245 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 17.332772731781006
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 703.276 Vali Acc: 0.626 Test Loss: 703.276 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 17.489284992218018
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 697.527 Vali Acc: 0.641 Test Loss: 697.527 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 17.499934911727905
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 697.323 Vali Acc: 0.641 Test Loss: 697.323 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6793893129770993
model parameter : 48682029
model size : 220.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.426969289779663
Epoch: 1, Steps: 32 | Train Loss: 59.103 Vali Loss: 36.851 Vali Acc: 0.176 Test Loss: 36.851 Test Acc: 0.176
Validation loss decreased (inf --> -0.175204).  Saving model ...
Epoch: 2 cost time: 15.820114374160767
Epoch: 2, Steps: 32 | Train Loss: 100.706 Vali Loss: 78.451 Vali Acc: 0.267 Test Loss: 78.451 Test Acc: 0.267
Validation loss decreased (-0.175204 --> -0.266391).  Saving model ...
Epoch: 3 cost time: 15.89424204826355
Epoch: 3, Steps: 32 | Train Loss: 133.305 Vali Loss: 86.402 Vali Acc: 0.183 Test Loss: 86.402 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.77639389038086
Epoch: 4, Steps: 32 | Train Loss: 136.280 Vali Loss: 48.223 Vali Acc: 0.351 Test Loss: 48.223 Test Acc: 0.351
Validation loss decreased (-0.266391 --> -0.350663).  Saving model ...
Epoch: 5 cost time: 15.757098913192749
Epoch: 5, Steps: 32 | Train Loss: 108.429 Vali Loss: 167.138 Vali Acc: 0.290 Test Loss: 167.138 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.973449945449829
Epoch: 6, Steps: 32 | Train Loss: 196.807 Vali Loss: 189.287 Vali Acc: 0.427 Test Loss: 189.287 Test Acc: 0.427
Validation loss decreased (-0.350663 --> -0.425588).  Saving model ...
Epoch: 7 cost time: 15.95802903175354
Epoch: 7, Steps: 32 | Train Loss: 102.581 Vali Loss: 422.388 Vali Acc: 0.267 Test Loss: 422.388 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.95003342628479
Epoch: 8, Steps: 32 | Train Loss: 45.761 Vali Loss: 410.430 Vali Acc: 0.489 Test Loss: 410.430 Test Acc: 0.489
Validation loss decreased (-0.425588 --> -0.484445).  Saving model ...
Epoch: 9 cost time: 15.732470512390137
Epoch: 9, Steps: 32 | Train Loss: 27.599 Vali Loss: 354.145 Vali Acc: 0.473 Test Loss: 354.145 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.902215003967285
Epoch: 10, Steps: 32 | Train Loss: 21.002 Vali Loss: 281.191 Vali Acc: 0.557 Test Loss: 281.191 Test Acc: 0.557
Validation loss decreased (-0.484445 --> -0.554440).  Saving model ...
Epoch: 11 cost time: 16.140480518341064
Epoch: 11, Steps: 32 | Train Loss: 9.043 Vali Loss: 349.061 Vali Acc: 0.344 Test Loss: 349.061 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.966091632843018
Epoch: 12, Steps: 32 | Train Loss: 6.741 Vali Loss: 246.368 Vali Acc: 0.557 Test Loss: 246.368 Test Acc: 0.557
Validation loss decreased (-0.554440 --> -0.554788).  Saving model ...
Epoch: 13 cost time: 15.759454250335693
Epoch: 13, Steps: 32 | Train Loss: 5.075 Vali Loss: 478.596 Vali Acc: 0.275 Test Loss: 478.596 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.836904048919678
Epoch: 14, Steps: 32 | Train Loss: 22.220 Vali Loss: 674.360 Vali Acc: 0.527 Test Loss: 674.360 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 16.040558099746704
Epoch: 15, Steps: 32 | Train Loss: 57.957 Vali Loss: 569.809 Vali Acc: 0.313 Test Loss: 569.809 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 16.122358560562134
Epoch: 16, Steps: 32 | Train Loss: 49.711 Vali Loss: 783.789 Vali Acc: 0.542 Test Loss: 783.789 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 15.742383480072021
Epoch: 17, Steps: 32 | Train Loss: 1.067 Vali Loss: 504.882 Vali Acc: 0.420 Test Loss: 504.882 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 15.93224573135376
Epoch: 18, Steps: 32 | Train Loss: 5.448 Vali Loss: 501.532 Vali Acc: 0.282 Test Loss: 501.532 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 16.014468669891357
Epoch: 19, Steps: 32 | Train Loss: 9.467 Vali Loss: 499.752 Vali Acc: 0.366 Test Loss: 499.752 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 15.748431205749512
Epoch: 20, Steps: 32 | Train Loss: 1.958 Vali Loss: 728.559 Vali Acc: 0.550 Test Loss: 728.559 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 15.86710238456726
Epoch: 21, Steps: 32 | Train Loss: 8.960 Vali Loss: 972.497 Vali Acc: 0.504 Test Loss: 972.497 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 15.87258529663086
Epoch: 22, Steps: 32 | Train Loss: 7.348 Vali Loss: 939.744 Vali Acc: 0.534 Test Loss: 939.744 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5572519083969466
model parameter : 48682029
model size : 220.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.16824507713318
Epoch: 1, Steps: 64 | Train Loss: 103.092 Vali Loss: 75.973 Vali Acc: 0.282 Test Loss: 75.973 Test Acc: 0.282
Validation loss decreased (inf --> -0.281683).  Saving model ...
Epoch: 2 cost time: 21.039576053619385
Epoch: 2, Steps: 64 | Train Loss: 168.079 Vali Loss: 397.421 Vali Acc: 0.366 Test Loss: 397.421 Test Acc: 0.366
Validation loss decreased (-0.281683 --> -0.362438).  Saving model ...
Epoch: 3 cost time: 20.800154209136963
Epoch: 3, Steps: 64 | Train Loss: 179.347 Vali Loss: 263.771 Vali Acc: 0.519 Test Loss: 263.771 Test Acc: 0.519
Validation loss decreased (-0.362438 --> -0.516446).  Saving model ...
Epoch: 4 cost time: 20.64791440963745
Epoch: 4, Steps: 64 | Train Loss: 178.734 Vali Loss: 502.965 Vali Acc: 0.275 Test Loss: 502.965 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.86005711555481
Epoch: 5, Steps: 64 | Train Loss: 245.102 Vali Loss: 237.591 Vali Acc: 0.580 Test Loss: 237.591 Test Acc: 0.580
Validation loss decreased (-0.516446 --> -0.577777).  Saving model ...
Epoch: 6 cost time: 20.979432344436646
Epoch: 6, Steps: 64 | Train Loss: 200.881 Vali Loss: 562.947 Vali Acc: 0.321 Test Loss: 562.947 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.645748138427734
Epoch: 7, Steps: 64 | Train Loss: 114.053 Vali Loss: 330.577 Vali Acc: 0.374 Test Loss: 330.577 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.753149271011353
Epoch: 8, Steps: 64 | Train Loss: 11.382 Vali Loss: 213.910 Vali Acc: 0.626 Test Loss: 213.910 Test Acc: 0.626
Validation loss decreased (-0.577777 --> -0.623815).  Saving model ...
Epoch: 9 cost time: 20.96595001220703
Epoch: 9, Steps: 64 | Train Loss: 2.768 Vali Loss: 297.425 Vali Acc: 0.603 Test Loss: 297.425 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.631914138793945
Epoch: 10, Steps: 64 | Train Loss: 143.859 Vali Loss: 472.061 Vali Acc: 0.542 Test Loss: 472.061 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.731731176376343
Epoch: 11, Steps: 64 | Train Loss: 43.255 Vali Loss: 666.754 Vali Acc: 0.336 Test Loss: 666.754 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 21.200373888015747
Epoch: 12, Steps: 64 | Train Loss: 86.973 Vali Loss: 641.635 Vali Acc: 0.550 Test Loss: 641.635 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 21.067710161209106
Epoch: 13, Steps: 64 | Train Loss: 6.286 Vali Loss: 586.948 Vali Acc: 0.595 Test Loss: 586.948 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 20.8224036693573
Epoch: 14, Steps: 64 | Train Loss: 22.700 Vali Loss: 766.948 Vali Acc: 0.336 Test Loss: 766.948 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 20.704134941101074
Epoch: 15, Steps: 64 | Train Loss: 21.061 Vali Loss: 583.988 Vali Acc: 0.611 Test Loss: 583.988 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 21.148103713989258
Epoch: 16, Steps: 64 | Train Loss: 55.029 Vali Loss: 609.837 Vali Acc: 0.603 Test Loss: 609.837 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 20.723039865493774
Epoch: 17, Steps: 64 | Train Loss: 37.530 Vali Loss: 515.276 Vali Acc: 0.595 Test Loss: 515.276 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 20.738309383392334
Epoch: 18, Steps: 64 | Train Loss: 19.902 Vali Loss: 842.417 Vali Acc: 0.496 Test Loss: 842.417 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 47633453
model size : 216.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.59140706062317
Epoch: 1, Steps: 64 | Train Loss: 133.579 Vali Loss: 94.503 Vali Acc: 0.466 Test Loss: 94.503 Test Acc: 0.466
Validation loss decreased (inf --> -0.464704).  Saving model ...
Epoch: 2 cost time: 19.404021739959717
Epoch: 2, Steps: 64 | Train Loss: 158.448 Vali Loss: 735.866 Vali Acc: 0.176 Test Loss: 735.866 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.308645725250244
Epoch: 3, Steps: 64 | Train Loss: 366.870 Vali Loss: 288.357 Vali Acc: 0.427 Test Loss: 288.357 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.80852699279785
Epoch: 4, Steps: 64 | Train Loss: 216.791 Vali Loss: 336.074 Vali Acc: 0.443 Test Loss: 336.074 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.77763295173645
Epoch: 5, Steps: 64 | Train Loss: 156.371 Vali Loss: 446.457 Vali Acc: 0.466 Test Loss: 446.457 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 19.521807432174683
Epoch: 6, Steps: 64 | Train Loss: 189.354 Vali Loss: 520.383 Vali Acc: 0.313 Test Loss: 520.383 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 19.415775299072266
Epoch: 7, Steps: 64 | Train Loss: 83.640 Vali Loss: 280.733 Vali Acc: 0.504 Test Loss: 280.733 Test Acc: 0.504
Validation loss decreased (-0.464704 --> -0.501009).  Saving model ...
Epoch: 8 cost time: 19.550101280212402
Epoch: 8, Steps: 64 | Train Loss: 91.906 Vali Loss: 318.642 Vali Acc: 0.580 Test Loss: 318.642 Test Acc: 0.580
Validation loss decreased (-0.501009 --> -0.576966).  Saving model ...
Epoch: 9 cost time: 19.530437707901
Epoch: 9, Steps: 64 | Train Loss: 26.370 Vali Loss: 374.516 Vali Acc: 0.527 Test Loss: 374.516 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 19.455257177352905
Epoch: 10, Steps: 64 | Train Loss: 144.782 Vali Loss: 251.749 Vali Acc: 0.618 Test Loss: 251.749 Test Acc: 0.618
Validation loss decreased (-0.576966 --> -0.615803).  Saving model ...
Epoch: 11 cost time: 19.66452717781067
Epoch: 11, Steps: 64 | Train Loss: 49.269 Vali Loss: 746.246 Vali Acc: 0.435 Test Loss: 746.246 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 19.856120347976685
Epoch: 12, Steps: 64 | Train Loss: 6.928 Vali Loss: 504.723 Vali Acc: 0.595 Test Loss: 504.723 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 19.423937559127808
Epoch: 13, Steps: 64 | Train Loss: 24.800 Vali Loss: 656.190 Vali Acc: 0.481 Test Loss: 656.190 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 19.5872220993042
Epoch: 14, Steps: 64 | Train Loss: 69.188 Vali Loss: 340.085 Vali Acc: 0.626 Test Loss: 340.085 Test Acc: 0.626
Validation loss decreased (-0.615803 --> -0.622553).  Saving model ...
Epoch: 15 cost time: 19.882261514663696
Epoch: 15, Steps: 64 | Train Loss: 30.769 Vali Loss: 655.447 Vali Acc: 0.595 Test Loss: 655.447 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 19.613960027694702
Epoch: 16, Steps: 64 | Train Loss: 178.738 Vali Loss: 595.083 Vali Acc: 0.511 Test Loss: 595.083 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 19.839313745498657
Epoch: 17, Steps: 64 | Train Loss: 7.674 Vali Loss: 878.838 Vali Acc: 0.580 Test Loss: 878.838 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 19.846781969070435
Epoch: 18, Steps: 64 | Train Loss: 14.131 Vali Loss: 620.335 Vali Acc: 0.550 Test Loss: 620.335 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 19.49707293510437
Epoch: 19, Steps: 64 | Train Loss: 1.617 Vali Loss: 725.174 Vali Acc: 0.565 Test Loss: 725.174 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 19.693983793258667
Epoch: 20, Steps: 64 | Train Loss: 42.835 Vali Loss: 852.865 Vali Acc: 0.565 Test Loss: 852.865 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 19.494096279144287
Epoch: 21, Steps: 64 | Train Loss: 60.866 Vali Loss: 742.406 Vali Acc: 0.557 Test Loss: 742.406 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 19.976098775863647
Epoch: 22, Steps: 64 | Train Loss: 7.225 Vali Loss: 877.738 Vali Acc: 0.565 Test Loss: 877.738 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 20.096269607543945
Epoch: 23, Steps: 64 | Train Loss: 1.880 Vali Loss: 923.159 Vali Acc: 0.374 Test Loss: 923.159 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 19.540351629257202
Epoch: 24, Steps: 64 | Train Loss: 5.307 Vali Loss: 877.520 Vali Acc: 0.382 Test Loss: 877.520 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 47633453
model size : 216.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.476151943206787
Epoch: 1, Steps: 32 | Train Loss: 56.401 Vali Loss: 130.932 Vali Acc: 0.214 Test Loss: 130.932 Test Acc: 0.214
Validation loss decreased (inf --> -0.212431).  Saving model ...
Epoch: 2 cost time: 16.357086896896362
Epoch: 2, Steps: 32 | Train Loss: 86.507 Vali Loss: 126.345 Vali Acc: 0.321 Test Loss: 126.345 Test Acc: 0.321
Validation loss decreased (-0.212431 --> -0.319347).  Saving model ...
Epoch: 3 cost time: 16.266090631484985
Epoch: 3, Steps: 32 | Train Loss: 114.969 Vali Loss: 146.501 Vali Acc: 0.290 Test Loss: 146.501 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 16.579985857009888
Epoch: 4, Steps: 32 | Train Loss: 81.407 Vali Loss: 184.775 Vali Acc: 0.481 Test Loss: 184.775 Test Acc: 0.481
Validation loss decreased (-0.319347 --> -0.479068).  Saving model ...
Epoch: 5 cost time: 16.90623903274536
Epoch: 5, Steps: 32 | Train Loss: 66.978 Vali Loss: 160.761 Vali Acc: 0.473 Test Loss: 160.761 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 16.19573473930359
Epoch: 6, Steps: 32 | Train Loss: 147.058 Vali Loss: 254.753 Vali Acc: 0.466 Test Loss: 254.753 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 16.226991415023804
Epoch: 7, Steps: 32 | Train Loss: 183.572 Vali Loss: 223.203 Vali Acc: 0.458 Test Loss: 223.203 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 16.4722261428833
Epoch: 8, Steps: 32 | Train Loss: 72.919 Vali Loss: 178.818 Vali Acc: 0.664 Test Loss: 178.818 Test Acc: 0.664
Validation loss decreased (-0.479068 --> -0.662334).  Saving model ...
Epoch: 9 cost time: 16.490755319595337
Epoch: 9, Steps: 32 | Train Loss: 59.571 Vali Loss: 521.647 Vali Acc: 0.473 Test Loss: 521.647 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 16.388505935668945
Epoch: 10, Steps: 32 | Train Loss: 23.476 Vali Loss: 474.927 Vali Acc: 0.412 Test Loss: 474.927 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 16.376842498779297
Epoch: 11, Steps: 32 | Train Loss: 7.131 Vali Loss: 611.422 Vali Acc: 0.588 Test Loss: 611.422 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 16.406760692596436
Epoch: 12, Steps: 32 | Train Loss: 11.816 Vali Loss: 537.322 Vali Acc: 0.382 Test Loss: 537.322 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 16.443273067474365
Epoch: 13, Steps: 32 | Train Loss: 17.377 Vali Loss: 522.702 Vali Acc: 0.603 Test Loss: 522.702 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 16.30568242073059
Epoch: 14, Steps: 32 | Train Loss: 10.036 Vali Loss: 455.571 Vali Acc: 0.412 Test Loss: 455.571 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 16.267191410064697
Epoch: 15, Steps: 32 | Train Loss: 2.385 Vali Loss: 485.009 Vali Acc: 0.435 Test Loss: 485.009 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 16.726503372192383
Epoch: 16, Steps: 32 | Train Loss: 21.569 Vali Loss: 361.024 Vali Acc: 0.504 Test Loss: 361.024 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 17.024677515029907
Epoch: 17, Steps: 32 | Train Loss: 8.981 Vali Loss: 535.491 Vali Acc: 0.580 Test Loss: 535.491 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 16.83672261238098
Epoch: 18, Steps: 32 | Train Loss: 21.383 Vali Loss: 538.613 Vali Acc: 0.359 Test Loss: 538.613 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 47633453
model size : 216.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.352992057800293
Epoch: 1, Steps: 32 | Train Loss: 46.984 Vali Loss: 87.939 Vali Acc: 0.145 Test Loss: 87.939 Test Acc: 0.145
Validation loss decreased (inf --> -0.144159).  Saving model ...
Epoch: 2 cost time: 15.74362826347351
Epoch: 2, Steps: 32 | Train Loss: 75.930 Vali Loss: 83.205 Vali Acc: 0.252 Test Loss: 83.205 Test Acc: 0.252
Validation loss decreased (-0.144159 --> -0.251076).  Saving model ...
Epoch: 3 cost time: 15.710760593414307
Epoch: 3, Steps: 32 | Train Loss: 136.092 Vali Loss: 158.671 Vali Acc: 0.214 Test Loss: 158.671 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.418543100357056
Epoch: 4, Steps: 32 | Train Loss: 121.011 Vali Loss: 204.330 Vali Acc: 0.229 Test Loss: 204.330 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.330238819122314
Epoch: 5, Steps: 32 | Train Loss: 122.194 Vali Loss: 181.041 Vali Acc: 0.496 Test Loss: 181.041 Test Acc: 0.496
Validation loss decreased (-0.251076 --> -0.494373).  Saving model ...
Epoch: 6 cost time: 15.583290338516235
Epoch: 6, Steps: 32 | Train Loss: 65.690 Vali Loss: 87.865 Vali Acc: 0.557 Test Loss: 87.865 Test Acc: 0.557
Validation loss decreased (-0.494373 --> -0.556373).  Saving model ...
Epoch: 7 cost time: 15.676095962524414
Epoch: 7, Steps: 32 | Train Loss: 50.376 Vali Loss: 185.956 Vali Acc: 0.550 Test Loss: 185.956 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 15.66208815574646
Epoch: 8, Steps: 32 | Train Loss: 52.326 Vali Loss: 240.517 Vali Acc: 0.344 Test Loss: 240.517 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.422224760055542
Epoch: 9, Steps: 32 | Train Loss: 34.139 Vali Loss: 145.443 Vali Acc: 0.595 Test Loss: 145.443 Test Acc: 0.595
Validation loss decreased (-0.556373 --> -0.593965).  Saving model ...
Epoch: 10 cost time: 15.537274837493896
Epoch: 10, Steps: 32 | Train Loss: 37.892 Vali Loss: 254.641 Vali Acc: 0.557 Test Loss: 254.641 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.642489433288574
Epoch: 11, Steps: 32 | Train Loss: 7.786 Vali Loss: 512.824 Vali Acc: 0.298 Test Loss: 512.824 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.56734585762024
Epoch: 12, Steps: 32 | Train Loss: 68.744 Vali Loss: 292.796 Vali Acc: 0.382 Test Loss: 292.796 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 15.371610403060913
Epoch: 13, Steps: 32 | Train Loss: 8.769 Vali Loss: 442.709 Vali Acc: 0.328 Test Loss: 442.709 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 15.46116304397583
Epoch: 14, Steps: 32 | Train Loss: 12.596 Vali Loss: 392.037 Vali Acc: 0.580 Test Loss: 392.037 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 15.674374341964722
Epoch: 15, Steps: 32 | Train Loss: 1.571 Vali Loss: 283.802 Vali Acc: 0.595 Test Loss: 283.802 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 15.64375925064087
Epoch: 16, Steps: 32 | Train Loss: 4.520 Vali Loss: 339.122 Vali Acc: 0.595 Test Loss: 339.122 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 15.416100263595581
Epoch: 17, Steps: 32 | Train Loss: 12.620 Vali Loss: 360.450 Vali Acc: 0.511 Test Loss: 360.450 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 15.282352924346924
Epoch: 18, Steps: 32 | Train Loss: 36.016 Vali Loss: 479.246 Vali Acc: 0.481 Test Loss: 479.246 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 15.74311876296997
Epoch: 19, Steps: 32 | Train Loss: 6.905 Vali Loss: 556.956 Vali Acc: 0.580 Test Loss: 556.956 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 47633453
model size : 216.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 22.44889783859253
Epoch: 1, Steps: 64 | Train Loss: 146.382 Vali Loss: 168.371 Vali Acc: 0.473 Test Loss: 168.371 Test Acc: 0.473
Validation loss decreased (inf --> -0.471599).  Saving model ...
Epoch: 2 cost time: 20.487628698349
Epoch: 2, Steps: 64 | Train Loss: 189.559 Vali Loss: 299.568 Vali Acc: 0.519 Test Loss: 299.568 Test Acc: 0.519
Validation loss decreased (-0.471599 --> -0.516088).  Saving model ...
Epoch: 3 cost time: 20.69212579727173
Epoch: 3, Steps: 64 | Train Loss: 267.069 Vali Loss: 381.526 Vali Acc: 0.260 Test Loss: 381.526 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 20.68973994255066
Epoch: 4, Steps: 64 | Train Loss: 143.371 Vali Loss: 267.827 Vali Acc: 0.420 Test Loss: 267.827 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 20.725311279296875
Epoch: 5, Steps: 64 | Train Loss: 171.953 Vali Loss: 236.436 Vali Acc: 0.527 Test Loss: 236.436 Test Acc: 0.527
Validation loss decreased (-0.516088 --> -0.524353).  Saving model ...
Epoch: 6 cost time: 20.562355279922485
Epoch: 6, Steps: 64 | Train Loss: 69.917 Vali Loss: 408.205 Vali Acc: 0.374 Test Loss: 408.205 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.449548959732056
Epoch: 7, Steps: 64 | Train Loss: 74.676 Vali Loss: 532.637 Vali Acc: 0.511 Test Loss: 532.637 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.902878522872925
Epoch: 8, Steps: 64 | Train Loss: 25.603 Vali Loss: 417.195 Vali Acc: 0.412 Test Loss: 417.195 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 20.61198902130127
Epoch: 9, Steps: 64 | Train Loss: 71.686 Vali Loss: 685.599 Vali Acc: 0.489 Test Loss: 685.599 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 20.45445227622986
Epoch: 10, Steps: 64 | Train Loss: 77.426 Vali Loss: 445.881 Vali Acc: 0.634 Test Loss: 445.881 Test Acc: 0.634
Validation loss decreased (-0.524353 --> -0.629129).  Saving model ...
Epoch: 11 cost time: 21.18954300880432
Epoch: 11, Steps: 64 | Train Loss: 15.040 Vali Loss: 419.310 Vali Acc: 0.534 Test Loss: 419.310 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.589520931243896
Epoch: 12, Steps: 64 | Train Loss: 92.057 Vali Loss: 907.202 Vali Acc: 0.534 Test Loss: 907.202 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.57084846496582
Epoch: 13, Steps: 64 | Train Loss: 154.396 Vali Loss: 775.742 Vali Acc: 0.550 Test Loss: 775.742 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 20.493881940841675
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.814 Vali Acc: 0.588 Test Loss: 730.814 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 20.877270698547363
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 20.69028878211975
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 20.61968445777893
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 20.952879428863525
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 20.751954793930054
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 20.552831888198853
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 730.825 Vali Acc: 0.588 Test Loss: 730.825 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 47109165
model size : 214.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.853060245513916
Epoch: 1, Steps: 64 | Train Loss: 128.175 Vali Loss: 210.574 Vali Acc: 0.435 Test Loss: 210.574 Test Acc: 0.435
Validation loss decreased (inf --> -0.433009).  Saving model ...
Epoch: 2 cost time: 19.33833146095276
Epoch: 2, Steps: 64 | Train Loss: 161.690 Vali Loss: 169.238 Vali Acc: 0.290 Test Loss: 169.238 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.732935428619385
Epoch: 3, Steps: 64 | Train Loss: 174.737 Vali Loss: 313.378 Vali Acc: 0.229 Test Loss: 313.378 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.64292812347412
Epoch: 4, Steps: 64 | Train Loss: 264.585 Vali Loss: 456.302 Vali Acc: 0.450 Test Loss: 456.302 Test Acc: 0.450
Validation loss decreased (-0.433009 --> -0.445819).  Saving model ...
Epoch: 5 cost time: 19.779441118240356
Epoch: 5, Steps: 64 | Train Loss: 222.274 Vali Loss: 427.091 Vali Acc: 0.389 Test Loss: 427.091 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 19.664105892181396
Epoch: 6, Steps: 64 | Train Loss: 243.326 Vali Loss: 583.213 Vali Acc: 0.511 Test Loss: 583.213 Test Acc: 0.511
Validation loss decreased (-0.445819 --> -0.505618).  Saving model ...
Epoch: 7 cost time: 19.89841890335083
Epoch: 7, Steps: 64 | Train Loss: 172.200 Vali Loss: 463.101 Vali Acc: 0.321 Test Loss: 463.101 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 20.10072374343872
Epoch: 8, Steps: 64 | Train Loss: 61.192 Vali Loss: 584.800 Vali Acc: 0.389 Test Loss: 584.800 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.519886255264282
Epoch: 9, Steps: 64 | Train Loss: 26.968 Vali Loss: 567.431 Vali Acc: 0.351 Test Loss: 567.431 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 19.659976482391357
Epoch: 10, Steps: 64 | Train Loss: 10.011 Vali Loss: 432.496 Vali Acc: 0.496 Test Loss: 432.496 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 19.80096697807312
Epoch: 11, Steps: 64 | Train Loss: 15.721 Vali Loss: 466.701 Vali Acc: 0.588 Test Loss: 466.701 Test Acc: 0.588
Validation loss decreased (-0.505618 --> -0.583119).  Saving model ...
Epoch: 12 cost time: 19.626970052719116
Epoch: 12, Steps: 64 | Train Loss: 11.643 Vali Loss: 330.261 Vali Acc: 0.580 Test Loss: 330.261 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.90290904045105
Epoch: 13, Steps: 64 | Train Loss: 91.064 Vali Loss: 610.791 Vali Acc: 0.595 Test Loss: 610.791 Test Acc: 0.595
Validation loss decreased (-0.583119 --> -0.589312).  Saving model ...
Epoch: 14 cost time: 19.871002435684204
Epoch: 14, Steps: 64 | Train Loss: 7.280 Vali Loss: 953.446 Vali Acc: 0.473 Test Loss: 953.446 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 19.646230697631836
Epoch: 15, Steps: 64 | Train Loss: 7.772 Vali Loss: 535.543 Vali Acc: 0.588 Test Loss: 535.543 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 19.853643655776978
Epoch: 16, Steps: 64 | Train Loss: 36.339 Vali Loss: 475.447 Vali Acc: 0.458 Test Loss: 475.447 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 19.707873582839966
Epoch: 17, Steps: 64 | Train Loss: 14.691 Vali Loss: 774.921 Vali Acc: 0.603 Test Loss: 774.921 Test Acc: 0.603
Validation loss decreased (-0.589312 --> -0.595304).  Saving model ...
Epoch: 18 cost time: 20.053736448287964
Epoch: 18, Steps: 64 | Train Loss: 54.836 Vali Loss: 701.926 Vali Acc: 0.626 Test Loss: 701.926 Test Acc: 0.626
Validation loss decreased (-0.595304 --> -0.618935).  Saving model ...
Epoch: 19 cost time: 20.0199613571167
Epoch: 19, Steps: 64 | Train Loss: 19.806 Vali Loss: 606.012 Vali Acc: 0.626 Test Loss: 606.012 Test Acc: 0.626
Validation loss decreased (-0.618935 --> -0.619894).  Saving model ...
Epoch: 20 cost time: 19.678419828414917
Epoch: 20, Steps: 64 | Train Loss: 7.634 Vali Loss: 1040.615 Vali Acc: 0.611 Test Loss: 1040.615 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 19.845062732696533
Epoch: 21, Steps: 64 | Train Loss: 17.203 Vali Loss: 892.955 Vali Acc: 0.618 Test Loss: 892.955 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.83198356628418
Epoch: 22, Steps: 64 | Train Loss: 35.698 Vali Loss: 1153.295 Vali Acc: 0.550 Test Loss: 1153.295 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 19.829030752182007
Epoch: 23, Steps: 64 | Train Loss: 53.938 Vali Loss: 646.776 Vali Acc: 0.527 Test Loss: 646.776 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 19.66726016998291
Epoch: 24, Steps: 64 | Train Loss: 10.687 Vali Loss: 984.219 Vali Acc: 0.557 Test Loss: 984.219 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.768721103668213
Epoch: 25, Steps: 64 | Train Loss: 25.304 Vali Loss: 1951.638 Vali Acc: 0.321 Test Loss: 1951.638 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 19.60394859313965
Epoch: 26, Steps: 64 | Train Loss: 251.923 Vali Loss: 1926.583 Vali Acc: 0.443 Test Loss: 1926.583 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 19.60127592086792
Epoch: 27, Steps: 64 | Train Loss: 2.756 Vali Loss: 2148.568 Vali Acc: 0.359 Test Loss: 2148.568 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 19.423888444900513
Epoch: 28, Steps: 64 | Train Loss: 40.737 Vali Loss: 1286.849 Vali Acc: 0.580 Test Loss: 1286.849 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 19.889355182647705
Epoch: 29, Steps: 64 | Train Loss: 0.000 Vali Loss: 1210.565 Vali Acc: 0.550 Test Loss: 1210.565 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 47109165
model size : 214.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.321206092834473
Epoch: 1, Steps: 32 | Train Loss: 60.798 Vali Loss: 140.043 Vali Acc: 0.481 Test Loss: 140.043 Test Acc: 0.481
Validation loss decreased (inf --> -0.479516).  Saving model ...
Epoch: 2 cost time: 16.180075883865356
Epoch: 2, Steps: 32 | Train Loss: 81.808 Vali Loss: 47.579 Vali Acc: 0.321 Test Loss: 47.579 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.981196165084839
Epoch: 3, Steps: 32 | Train Loss: 80.066 Vali Loss: 181.934 Vali Acc: 0.450 Test Loss: 181.934 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.751606941223145
Epoch: 4, Steps: 32 | Train Loss: 96.667 Vali Loss: 84.680 Vali Acc: 0.305 Test Loss: 84.680 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.709330797195435
Epoch: 5, Steps: 32 | Train Loss: 135.511 Vali Loss: 126.437 Vali Acc: 0.298 Test Loss: 126.437 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 15.95798397064209
Epoch: 6, Steps: 32 | Train Loss: 169.125 Vali Loss: 461.048 Vali Acc: 0.427 Test Loss: 461.048 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 16.023458003997803
Epoch: 7, Steps: 32 | Train Loss: 113.853 Vali Loss: 472.625 Vali Acc: 0.237 Test Loss: 472.625 Test Acc: 0.237
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 15.879207611083984
Epoch: 8, Steps: 32 | Train Loss: 75.776 Vali Loss: 298.620 Vali Acc: 0.573 Test Loss: 298.620 Test Acc: 0.573
Validation loss decreased (-0.479516 --> -0.569533).  Saving model ...
Epoch: 9 cost time: 15.731746196746826
Epoch: 9, Steps: 32 | Train Loss: 49.093 Vali Loss: 285.660 Vali Acc: 0.458 Test Loss: 285.660 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.855124473571777
Epoch: 10, Steps: 32 | Train Loss: 31.644 Vali Loss: 399.491 Vali Acc: 0.611 Test Loss: 399.491 Test Acc: 0.611
Validation loss decreased (-0.569533 --> -0.606692).  Saving model ...
Epoch: 11 cost time: 15.93436884880066
Epoch: 11, Steps: 32 | Train Loss: 33.419 Vali Loss: 639.099 Vali Acc: 0.527 Test Loss: 639.099 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.837535858154297
Epoch: 12, Steps: 32 | Train Loss: 34.520 Vali Loss: 391.996 Vali Acc: 0.595 Test Loss: 391.996 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.955978393554688
Epoch: 13, Steps: 32 | Train Loss: 16.940 Vali Loss: 845.576 Vali Acc: 0.504 Test Loss: 845.576 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.09851312637329
Epoch: 14, Steps: 32 | Train Loss: 109.230 Vali Loss: 542.111 Vali Acc: 0.580 Test Loss: 542.111 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 16.10233497619629
Epoch: 15, Steps: 32 | Train Loss: 24.263 Vali Loss: 660.225 Vali Acc: 0.527 Test Loss: 660.225 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 15.855879068374634
Epoch: 16, Steps: 32 | Train Loss: 12.987 Vali Loss: 489.974 Vali Acc: 0.534 Test Loss: 489.974 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 15.926575422286987
Epoch: 17, Steps: 32 | Train Loss: 23.586 Vali Loss: 408.719 Vali Acc: 0.580 Test Loss: 408.719 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 16.090295553207397
Epoch: 18, Steps: 32 | Train Loss: 6.039 Vali Loss: 555.438 Vali Acc: 0.603 Test Loss: 555.438 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 15.946784019470215
Epoch: 19, Steps: 32 | Train Loss: 2.785 Vali Loss: 471.808 Vali Acc: 0.481 Test Loss: 471.808 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 15.761399030685425
Epoch: 20, Steps: 32 | Train Loss: 11.392 Vali Loss: 544.021 Vali Acc: 0.550 Test Loss: 544.021 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 47109165
model size : 214.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.84977388381958
Epoch: 1, Steps: 32 | Train Loss: 58.721 Vali Loss: 57.933 Vali Acc: 0.313 Test Loss: 57.933 Test Acc: 0.313
Validation loss decreased (inf --> -0.312398).  Saving model ...
Epoch: 2 cost time: 14.780335426330566
Epoch: 2, Steps: 32 | Train Loss: 44.102 Vali Loss: 98.912 Vali Acc: 0.145 Test Loss: 98.912 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.02550745010376
Epoch: 3, Steps: 32 | Train Loss: 47.337 Vali Loss: 62.186 Vali Acc: 0.496 Test Loss: 62.186 Test Acc: 0.496
Validation loss decreased (-0.312398 --> -0.495561).  Saving model ...
Epoch: 4 cost time: 15.113004207611084
Epoch: 4, Steps: 32 | Train Loss: 98.475 Vali Loss: 195.849 Vali Acc: 0.466 Test Loss: 195.849 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.289113521575928
Epoch: 5, Steps: 32 | Train Loss: 148.068 Vali Loss: 210.067 Vali Acc: 0.443 Test Loss: 210.067 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.176359176635742
Epoch: 6, Steps: 32 | Train Loss: 134.969 Vali Loss: 248.897 Vali Acc: 0.198 Test Loss: 248.897 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.247900009155273
Epoch: 7, Steps: 32 | Train Loss: 87.634 Vali Loss: 349.926 Vali Acc: 0.275 Test Loss: 349.926 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.02680230140686
Epoch: 8, Steps: 32 | Train Loss: 34.301 Vali Loss: 332.884 Vali Acc: 0.336 Test Loss: 332.884 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.208245515823364
Epoch: 9, Steps: 32 | Train Loss: 64.125 Vali Loss: 293.268 Vali Acc: 0.504 Test Loss: 293.268 Test Acc: 0.504
Validation loss decreased (-0.495561 --> -0.500884).  Saving model ...
Epoch: 10 cost time: 15.441806077957153
Epoch: 10, Steps: 32 | Train Loss: 15.986 Vali Loss: 410.575 Vali Acc: 0.595 Test Loss: 410.575 Test Acc: 0.595
Validation loss decreased (-0.500884 --> -0.591314).  Saving model ...
Epoch: 11 cost time: 15.104694604873657
Epoch: 11, Steps: 32 | Train Loss: 4.331 Vali Loss: 485.204 Vali Acc: 0.557 Test Loss: 485.204 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.211215496063232
Epoch: 12, Steps: 32 | Train Loss: 5.316 Vali Loss: 410.828 Vali Acc: 0.565 Test Loss: 410.828 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 15.285080432891846
Epoch: 13, Steps: 32 | Train Loss: 22.318 Vali Loss: 331.024 Vali Acc: 0.603 Test Loss: 331.024 Test Acc: 0.603
Validation loss decreased (-0.591314 --> -0.599743).  Saving model ...
Epoch: 14 cost time: 14.968528032302856
Epoch: 14, Steps: 32 | Train Loss: 14.487 Vali Loss: 495.338 Vali Acc: 0.611 Test Loss: 495.338 Test Acc: 0.611
Validation loss decreased (-0.599743 --> -0.605734).  Saving model ...
Epoch: 15 cost time: 15.254029989242554
Epoch: 15, Steps: 32 | Train Loss: 21.014 Vali Loss: 513.359 Vali Acc: 0.366 Test Loss: 513.359 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.140944242477417
Epoch: 16, Steps: 32 | Train Loss: 11.603 Vali Loss: 383.456 Vali Acc: 0.504 Test Loss: 383.456 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.143208265304565
Epoch: 17, Steps: 32 | Train Loss: 4.287 Vali Loss: 538.155 Vali Acc: 0.611 Test Loss: 538.155 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.209303379058838
Epoch: 18, Steps: 32 | Train Loss: 1.050 Vali Loss: 620.582 Vali Acc: 0.557 Test Loss: 620.582 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.055541038513184
Epoch: 19, Steps: 32 | Train Loss: 5.136 Vali Loss: 541.540 Vali Acc: 0.366 Test Loss: 541.540 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.3104887008667
Epoch: 20, Steps: 32 | Train Loss: 5.680 Vali Loss: 634.651 Vali Acc: 0.550 Test Loss: 634.651 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.298492431640625
Epoch: 21, Steps: 32 | Train Loss: 4.710 Vali Loss: 480.292 Vali Acc: 0.557 Test Loss: 480.292 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.113139629364014
Epoch: 22, Steps: 32 | Train Loss: 4.200 Vali Loss: 529.438 Vali Acc: 0.595 Test Loss: 529.438 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 15.258692264556885
Epoch: 23, Steps: 32 | Train Loss: 5.380 Vali Loss: 509.193 Vali Acc: 0.588 Test Loss: 509.193 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.46528935432434
Epoch: 24, Steps: 32 | Train Loss: 26.635 Vali Loss: 853.557 Vali Acc: 0.344 Test Loss: 853.557 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 47109165
model size : 214.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.841344356536865
Epoch: 1, Steps: 64 | Train Loss: 98.760 Vali Loss: 185.956 Vali Acc: 0.153 Test Loss: 185.956 Test Acc: 0.153
Validation loss decreased (inf --> -0.150812).  Saving model ...
Epoch: 2 cost time: 20.50712537765503
Epoch: 2, Steps: 64 | Train Loss: 219.369 Vali Loss: 209.905 Vali Acc: 0.221 Test Loss: 209.905 Test Acc: 0.221
Validation loss decreased (-0.150812 --> -0.219275).  Saving model ...
Epoch: 3 cost time: 20.35605788230896
Epoch: 3, Steps: 64 | Train Loss: 234.400 Vali Loss: 425.215 Vali Acc: 0.511 Test Loss: 425.215 Test Acc: 0.511
Validation loss decreased (-0.219275 --> -0.507198).  Saving model ...
Epoch: 4 cost time: 20.185614824295044
Epoch: 4, Steps: 64 | Train Loss: 313.114 Vali Loss: 523.744 Vali Acc: 0.275 Test Loss: 523.744 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 20.161572694778442
Epoch: 5, Steps: 64 | Train Loss: 219.769 Vali Loss: 477.807 Vali Acc: 0.496 Test Loss: 477.807 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 20.502887725830078
Epoch: 6, Steps: 64 | Train Loss: 61.069 Vali Loss: 456.371 Vali Acc: 0.351 Test Loss: 456.371 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 20.225645303726196
Epoch: 7, Steps: 64 | Train Loss: 44.125 Vali Loss: 594.582 Vali Acc: 0.496 Test Loss: 594.582 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 20.370710611343384
Epoch: 8, Steps: 64 | Train Loss: 55.344 Vali Loss: 270.823 Vali Acc: 0.611 Test Loss: 270.823 Test Acc: 0.611
Validation loss decreased (-0.507198 --> -0.607979).  Saving model ...
Epoch: 9 cost time: 20.514369010925293
Epoch: 9, Steps: 64 | Train Loss: 78.898 Vali Loss: 579.067 Vali Acc: 0.427 Test Loss: 579.067 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.396801710128784
Epoch: 10, Steps: 64 | Train Loss: 58.471 Vali Loss: 411.862 Vali Acc: 0.649 Test Loss: 411.862 Test Acc: 0.649
Validation loss decreased (-0.607979 --> -0.644736).  Saving model ...
Epoch: 11 cost time: 20.21789860725403
Epoch: 11, Steps: 64 | Train Loss: 25.502 Vali Loss: 440.831 Vali Acc: 0.595 Test Loss: 440.831 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 20.49364733695984
Epoch: 12, Steps: 64 | Train Loss: 32.033 Vali Loss: 431.774 Vali Acc: 0.603 Test Loss: 431.774 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 20.686943769454956
Epoch: 13, Steps: 64 | Train Loss: 100.903 Vali Loss: 338.619 Vali Acc: 0.664 Test Loss: 338.619 Test Acc: 0.664
Validation loss decreased (-0.644736 --> -0.660736).  Saving model ...
Epoch: 14 cost time: 20.472307205200195
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.558 Vali Acc: 0.603 Test Loss: 446.558 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 20.252087354660034
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 20.58378314971924
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 20.318678617477417
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 20.20546841621399
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 20.650222301483154
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 20.52732801437378
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 20.263535976409912
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 20.218462705612183
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 20.31456971168518
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 446.739 Vali Acc: 0.603 Test Loss: 446.739 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 46847021
model size : 213.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.708850860595703
Epoch: 1, Steps: 64 | Train Loss: 107.364 Vali Loss: 98.965 Vali Acc: 0.496 Test Loss: 98.965 Test Acc: 0.496
Validation loss decreased (inf --> -0.495194).  Saving model ...
Epoch: 2 cost time: 19.41316056251526
Epoch: 2, Steps: 64 | Train Loss: 260.923 Vali Loss: 235.933 Vali Acc: 0.252 Test Loss: 235.933 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 19.46252942085266
Epoch: 3, Steps: 64 | Train Loss: 173.908 Vali Loss: 239.549 Vali Acc: 0.466 Test Loss: 239.549 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 19.288965225219727
Epoch: 4, Steps: 64 | Train Loss: 262.826 Vali Loss: 723.000 Vali Acc: 0.427 Test Loss: 723.000 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 19.325778007507324
Epoch: 5, Steps: 64 | Train Loss: 231.006 Vali Loss: 548.388 Vali Acc: 0.527 Test Loss: 548.388 Test Acc: 0.527
Validation loss decreased (-0.495194 --> -0.521234).  Saving model ...
Epoch: 6 cost time: 19.472822666168213
Epoch: 6, Steps: 64 | Train Loss: 88.527 Vali Loss: 632.277 Vali Acc: 0.298 Test Loss: 632.277 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.396048545837402
Epoch: 7, Steps: 64 | Train Loss: 95.541 Vali Loss: 398.812 Vali Acc: 0.565 Test Loss: 398.812 Test Acc: 0.565
Validation loss decreased (-0.521234 --> -0.560897).  Saving model ...
Epoch: 8 cost time: 19.265218019485474
Epoch: 8, Steps: 64 | Train Loss: 22.888 Vali Loss: 769.887 Vali Acc: 0.328 Test Loss: 769.887 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 19.408047199249268
Epoch: 9, Steps: 64 | Train Loss: 208.480 Vali Loss: 741.683 Vali Acc: 0.603 Test Loss: 741.683 Test Acc: 0.603
Validation loss decreased (-0.560897 --> -0.595637).  Saving model ...
Epoch: 10 cost time: 19.646142959594727
Epoch: 10, Steps: 64 | Train Loss: 32.350 Vali Loss: 487.804 Vali Acc: 0.580 Test Loss: 487.804 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.247223615646362
Epoch: 11, Steps: 64 | Train Loss: 56.200 Vali Loss: 1133.828 Vali Acc: 0.527 Test Loss: 1133.828 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 19.212713718414307
Epoch: 12, Steps: 64 | Train Loss: 59.153 Vali Loss: 316.481 Vali Acc: 0.618 Test Loss: 316.481 Test Acc: 0.618
Validation loss decreased (-0.595637 --> -0.615156).  Saving model ...
Epoch: 13 cost time: 19.47901225090027
Epoch: 13, Steps: 64 | Train Loss: 48.675 Vali Loss: 596.218 Vali Acc: 0.603 Test Loss: 596.218 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 19.281583547592163
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 602.831 Vali Acc: 0.550 Test Loss: 602.831 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 19.260902881622314
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 602.849 Vali Acc: 0.550 Test Loss: 602.849 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 19.314800024032593
Epoch: 16, Steps: 64 | Train Loss: 0.392 Vali Loss: 1392.136 Vali Acc: 0.565 Test Loss: 1392.136 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 19.362539052963257
Epoch: 17, Steps: 64 | Train Loss: 72.246 Vali Loss: 1204.451 Vali Acc: 0.542 Test Loss: 1204.451 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 19.480512619018555
Epoch: 18, Steps: 64 | Train Loss: 38.827 Vali Loss: 879.122 Vali Acc: 0.412 Test Loss: 879.122 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 19.157086610794067
Epoch: 19, Steps: 64 | Train Loss: 11.085 Vali Loss: 707.422 Vali Acc: 0.649 Test Loss: 707.422 Test Acc: 0.649
Validation loss decreased (-0.615156 --> -0.641781).  Saving model ...
Epoch: 20 cost time: 19.22099804878235
Epoch: 20, Steps: 64 | Train Loss: 14.128 Vali Loss: 885.133 Vali Acc: 0.618 Test Loss: 885.133 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 19.50787854194641
Epoch: 21, Steps: 64 | Train Loss: 21.332 Vali Loss: 617.670 Vali Acc: 0.634 Test Loss: 617.670 Test Acc: 0.634
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 19.1902813911438
Epoch: 22, Steps: 64 | Train Loss: 7.803 Vali Loss: 776.343 Vali Acc: 0.443 Test Loss: 776.343 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 19.21305823326111
Epoch: 23, Steps: 64 | Train Loss: 7.634 Vali Loss: 836.929 Vali Acc: 0.450 Test Loss: 836.929 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 19.496681690216064
Epoch: 24, Steps: 64 | Train Loss: 13.574 Vali Loss: 1059.641 Vali Acc: 0.603 Test Loss: 1059.641 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 19.423906803131104
Epoch: 25, Steps: 64 | Train Loss: 92.281 Vali Loss: 1494.491 Vali Acc: 0.382 Test Loss: 1494.491 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 19.494413137435913
Epoch: 26, Steps: 64 | Train Loss: 129.285 Vali Loss: 1426.666 Vali Acc: 0.664 Test Loss: 1426.666 Test Acc: 0.664
Validation loss decreased (-0.641781 --> -0.649855).  Saving model ...
Epoch: 27 cost time: 19.680850505828857
Epoch: 27, Steps: 64 | Train Loss: 9.559 Vali Loss: 1053.809 Vali Acc: 0.634 Test Loss: 1053.809 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 19.758610725402832
Epoch: 28, Steps: 64 | Train Loss: 34.283 Vali Loss: 1451.436 Vali Acc: 0.565 Test Loss: 1451.436 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 19.47269368171692
Epoch: 29, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.155 Vali Acc: 0.534 Test Loss: 1479.155 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 19.52040147781372
Epoch: 30, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 19.383861303329468
Epoch: 31, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 19.104498147964478
Epoch: 32, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 19.2818546295166
Epoch: 33, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 19.723427057266235
Epoch: 34, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 19.331756830215454
Epoch: 35, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 19.30390167236328
Epoch: 36, Steps: 64 | Train Loss: 0.000 Vali Loss: 1479.189 Vali Acc: 0.534 Test Loss: 1479.189 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6641221374045801
model parameter : 46847021
model size : 213.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.886011362075806
Epoch: 1, Steps: 32 | Train Loss: 42.962 Vali Loss: 67.690 Vali Acc: 0.450 Test Loss: 67.690 Test Acc: 0.450
Validation loss decreased (inf --> -0.449705).  Saving model ...
Epoch: 2 cost time: 15.718003511428833
Epoch: 2, Steps: 32 | Train Loss: 66.066 Vali Loss: 121.204 Vali Acc: 0.206 Test Loss: 121.204 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.976147651672363
Epoch: 3, Steps: 32 | Train Loss: 109.749 Vali Loss: 122.392 Vali Acc: 0.527 Test Loss: 122.392 Test Acc: 0.527
Validation loss decreased (-0.449705 --> -0.525494).  Saving model ...
Epoch: 4 cost time: 15.499221086502075
Epoch: 4, Steps: 32 | Train Loss: 167.000 Vali Loss: 170.773 Vali Acc: 0.359 Test Loss: 170.773 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 15.504750728607178
Epoch: 5, Steps: 32 | Train Loss: 156.079 Vali Loss: 400.068 Vali Acc: 0.260 Test Loss: 400.068 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 15.58788013458252
Epoch: 6, Steps: 32 | Train Loss: 164.635 Vali Loss: 645.674 Vali Acc: 0.214 Test Loss: 645.674 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 15.96904730796814
Epoch: 7, Steps: 32 | Train Loss: 98.535 Vali Loss: 452.360 Vali Acc: 0.450 Test Loss: 452.360 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 15.666559219360352
Epoch: 8, Steps: 32 | Train Loss: 62.608 Vali Loss: 663.466 Vali Acc: 0.099 Test Loss: 663.466 Test Acc: 0.099
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 15.723783731460571
Epoch: 9, Steps: 32 | Train Loss: 155.473 Vali Loss: 415.184 Vali Acc: 0.534 Test Loss: 415.184 Test Acc: 0.534
Validation loss decreased (-0.525494 --> -0.530199).  Saving model ...
Epoch: 10 cost time: 15.815137147903442
Epoch: 10, Steps: 32 | Train Loss: 23.433 Vali Loss: 406.451 Vali Acc: 0.458 Test Loss: 406.451 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 15.518195867538452
Epoch: 11, Steps: 32 | Train Loss: 19.426 Vali Loss: 423.596 Vali Acc: 0.412 Test Loss: 423.596 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.741568565368652
Epoch: 12, Steps: 32 | Train Loss: 8.988 Vali Loss: 334.978 Vali Acc: 0.588 Test Loss: 334.978 Test Acc: 0.588
Validation loss decreased (-0.530199 --> -0.584436).  Saving model ...
Epoch: 13 cost time: 15.762035369873047
Epoch: 13, Steps: 32 | Train Loss: 12.823 Vali Loss: 438.814 Vali Acc: 0.328 Test Loss: 438.814 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.574105978012085
Epoch: 14, Steps: 32 | Train Loss: 6.609 Vali Loss: 279.424 Vali Acc: 0.588 Test Loss: 279.424 Test Acc: 0.588
Validation loss decreased (-0.584436 --> -0.584992).  Saving model ...
Epoch: 15 cost time: 15.72807240486145
Epoch: 15, Steps: 32 | Train Loss: 22.932 Vali Loss: 439.835 Vali Acc: 0.580 Test Loss: 439.835 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.672544956207275
Epoch: 16, Steps: 32 | Train Loss: 12.669 Vali Loss: 690.069 Vali Acc: 0.550 Test Loss: 690.069 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.71524167060852
Epoch: 17, Steps: 32 | Train Loss: 16.965 Vali Loss: 700.181 Vali Acc: 0.557 Test Loss: 700.181 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.854805946350098
Epoch: 18, Steps: 32 | Train Loss: 11.539 Vali Loss: 544.722 Vali Acc: 0.588 Test Loss: 544.722 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.547303676605225
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 519.288 Vali Acc: 0.595 Test Loss: 519.288 Test Acc: 0.595
Validation loss decreased (-0.584992 --> -0.590227).  Saving model ...
Epoch: 20 cost time: 15.729939460754395
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 521.983 Vali Acc: 0.603 Test Loss: 521.983 Test Acc: 0.603
Validation loss decreased (-0.590227 --> -0.597834).  Saving model ...
Epoch: 21 cost time: 16.0358464717865
Epoch: 21, Steps: 32 | Train Loss: 0.099 Vali Loss: 484.586 Vali Acc: 0.618 Test Loss: 484.586 Test Acc: 0.618
Validation loss decreased (-0.597834 --> -0.613475).  Saving model ...
Epoch: 22 cost time: 15.520906686782837
Epoch: 22, Steps: 32 | Train Loss: 13.210 Vali Loss: 989.409 Vali Acc: 0.527 Test Loss: 989.409 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 15.609709978103638
Epoch: 23, Steps: 32 | Train Loss: 25.976 Vali Loss: 701.002 Vali Acc: 0.588 Test Loss: 701.002 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 15.665782690048218
Epoch: 24, Steps: 32 | Train Loss: 15.160 Vali Loss: 517.306 Vali Acc: 0.672 Test Loss: 517.306 Test Acc: 0.672
Validation loss decreased (-0.613475 --> -0.666583).  Saving model ...
Epoch: 25 cost time: 15.720231533050537
Epoch: 25, Steps: 32 | Train Loss: 5.773 Vali Loss: 563.403 Vali Acc: 0.611 Test Loss: 563.403 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 15.852571487426758
Epoch: 26, Steps: 32 | Train Loss: 4.696 Vali Loss: 777.412 Vali Acc: 0.573 Test Loss: 777.412 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 15.699434995651245
Epoch: 27, Steps: 32 | Train Loss: 26.056 Vali Loss: 1094.764 Vali Acc: 0.580 Test Loss: 1094.764 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 15.843521118164062
Epoch: 28, Steps: 32 | Train Loss: 29.467 Vali Loss: 852.338 Vali Acc: 0.573 Test Loss: 852.338 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 15.984380006790161
Epoch: 29, Steps: 32 | Train Loss: 1.238 Vali Loss: 1019.449 Vali Acc: 0.328 Test Loss: 1019.449 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 15.545652627944946
Epoch: 30, Steps: 32 | Train Loss: 4.140 Vali Loss: 614.942 Vali Acc: 0.626 Test Loss: 614.942 Test Acc: 0.626
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 15.499902486801147
Epoch: 31, Steps: 32 | Train Loss: 0.131 Vali Loss: 916.706 Vali Acc: 0.565 Test Loss: 916.706 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 15.776082277297974
Epoch: 32, Steps: 32 | Train Loss: 4.407 Vali Loss: 776.252 Vali Acc: 0.389 Test Loss: 776.252 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 15.77663516998291
Epoch: 33, Steps: 32 | Train Loss: 4.219 Vali Loss: 776.909 Vali Acc: 0.580 Test Loss: 776.909 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 15.767891883850098
Epoch: 34, Steps: 32 | Train Loss: 2.893 Vali Loss: 895.682 Vali Acc: 0.557 Test Loss: 895.682 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6717557251908397
model parameter : 46847021
model size : 213.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.788111925125122
Epoch: 1, Steps: 32 | Train Loss: 48.401 Vali Loss: 58.670 Vali Acc: 0.244 Test Loss: 58.670 Test Acc: 0.244
Validation loss decreased (inf --> -0.243688).  Saving model ...
Epoch: 2 cost time: 14.824287414550781
Epoch: 2, Steps: 32 | Train Loss: 74.704 Vali Loss: 106.152 Vali Acc: 0.191 Test Loss: 106.152 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 14.671387195587158
Epoch: 3, Steps: 32 | Train Loss: 133.335 Vali Loss: 366.777 Vali Acc: 0.107 Test Loss: 366.777 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 15.062852621078491
Epoch: 4, Steps: 32 | Train Loss: 226.874 Vali Loss: 253.194 Vali Acc: 0.237 Test Loss: 253.194 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 15.073475122451782
Epoch: 5, Steps: 32 | Train Loss: 113.758 Vali Loss: 198.763 Vali Acc: 0.160 Test Loss: 198.763 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 14.985892295837402
Epoch: 6, Steps: 32 | Train Loss: 119.009 Vali Loss: 217.373 Vali Acc: 0.489 Test Loss: 217.373 Test Acc: 0.489
Validation loss decreased (-0.243688 --> -0.486376).  Saving model ...
Epoch: 7 cost time: 15.112334489822388
Epoch: 7, Steps: 32 | Train Loss: 160.058 Vali Loss: 214.269 Vali Acc: 0.443 Test Loss: 214.269 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 14.87894320487976
Epoch: 8, Steps: 32 | Train Loss: 115.856 Vali Loss: 242.932 Vali Acc: 0.336 Test Loss: 242.932 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 15.15987753868103
Epoch: 9, Steps: 32 | Train Loss: 39.530 Vali Loss: 337.425 Vali Acc: 0.573 Test Loss: 337.425 Test Acc: 0.573
Validation loss decreased (-0.486376 --> -0.569145).  Saving model ...
Epoch: 10 cost time: 15.138063669204712
Epoch: 10, Steps: 32 | Train Loss: 32.593 Vali Loss: 497.501 Vali Acc: 0.466 Test Loss: 497.501 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 14.922407150268555
Epoch: 11, Steps: 32 | Train Loss: 17.814 Vali Loss: 460.962 Vali Acc: 0.542 Test Loss: 460.962 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 15.10454511642456
Epoch: 12, Steps: 32 | Train Loss: 6.738 Vali Loss: 404.417 Vali Acc: 0.580 Test Loss: 404.417 Test Acc: 0.580
Validation loss decreased (-0.569145 --> -0.576108).  Saving model ...
Epoch: 13 cost time: 15.118594884872437
Epoch: 13, Steps: 32 | Train Loss: 7.188 Vali Loss: 494.995 Vali Acc: 0.344 Test Loss: 494.995 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 15.026850938796997
Epoch: 14, Steps: 32 | Train Loss: 6.982 Vali Loss: 418.616 Vali Acc: 0.611 Test Loss: 418.616 Test Acc: 0.611
Validation loss decreased (-0.576108 --> -0.606501).  Saving model ...
Epoch: 15 cost time: 15.03259801864624
Epoch: 15, Steps: 32 | Train Loss: 10.160 Vali Loss: 454.168 Vali Acc: 0.496 Test Loss: 454.168 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.086838960647583
Epoch: 16, Steps: 32 | Train Loss: 18.957 Vali Loss: 754.156 Vali Acc: 0.282 Test Loss: 754.156 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.192595481872559
Epoch: 17, Steps: 32 | Train Loss: 6.260 Vali Loss: 679.926 Vali Acc: 0.550 Test Loss: 679.926 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.123066902160645
Epoch: 18, Steps: 32 | Train Loss: 3.454 Vali Loss: 586.487 Vali Acc: 0.511 Test Loss: 586.487 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 14.859765529632568
Epoch: 19, Steps: 32 | Train Loss: 0.003 Vali Loss: 837.219 Vali Acc: 0.321 Test Loss: 837.219 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.046669006347656
Epoch: 20, Steps: 32 | Train Loss: 9.878 Vali Loss: 467.051 Vali Acc: 0.588 Test Loss: 467.051 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.089077949523926
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 632.552 Vali Acc: 0.527 Test Loss: 632.552 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.021664142608643
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 641.250 Vali Acc: 0.534 Test Loss: 641.250 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 14.560658693313599
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 641.567 Vali Acc: 0.534 Test Loss: 641.567 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 14.417859077453613
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 641.578 Vali Acc: 0.534 Test Loss: 641.578 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 46847021
model size : 213.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.639654397964478
Epoch: 1, Steps: 64 | Train Loss: 106.117 Vali Loss: 296.501 Vali Acc: 0.107 Test Loss: 296.501 Test Acc: 0.107
Validation loss decreased (inf --> -0.103905).  Saving model ...
Epoch: 2 cost time: 19.981871366500854
Epoch: 2, Steps: 64 | Train Loss: 185.459 Vali Loss: 438.347 Vali Acc: 0.221 Test Loss: 438.347 Test Acc: 0.221
Validation loss decreased (-0.103905 --> -0.216991).  Saving model ...
Epoch: 3 cost time: 20.26821279525757
Epoch: 3, Steps: 64 | Train Loss: 181.614 Vali Loss: 522.985 Vali Acc: 0.427 Test Loss: 522.985 Test Acc: 0.427
Validation loss decreased (-0.216991 --> -0.422251).  Saving model ...
Epoch: 4 cost time: 20.629879474639893
Epoch: 4, Steps: 64 | Train Loss: 285.383 Vali Loss: 137.817 Vali Acc: 0.542 Test Loss: 137.817 Test Acc: 0.542
Validation loss decreased (-0.422251 --> -0.540607).  Saving model ...
Epoch: 5 cost time: 20.33272409439087
Epoch: 5, Steps: 64 | Train Loss: 172.221 Vali Loss: 401.352 Vali Acc: 0.366 Test Loss: 401.352 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 20.642460346221924
Epoch: 6, Steps: 64 | Train Loss: 132.258 Vali Loss: 346.362 Vali Acc: 0.573 Test Loss: 346.362 Test Acc: 0.573
Validation loss decreased (-0.540607 --> -0.569055).  Saving model ...
Epoch: 7 cost time: 20.77431583404541
Epoch: 7, Steps: 64 | Train Loss: 52.905 Vali Loss: 292.441 Vali Acc: 0.611 Test Loss: 292.441 Test Acc: 0.611
Validation loss decreased (-0.569055 --> -0.607763).  Saving model ...
Epoch: 8 cost time: 20.639143228530884
Epoch: 8, Steps: 64 | Train Loss: 47.069 Vali Loss: 407.047 Vali Acc: 0.466 Test Loss: 407.047 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 20.86824083328247
Epoch: 9, Steps: 64 | Train Loss: 37.137 Vali Loss: 316.150 Vali Acc: 0.595 Test Loss: 316.150 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 21.10912013053894
Epoch: 10, Steps: 64 | Train Loss: 20.484 Vali Loss: 356.806 Vali Acc: 0.603 Test Loss: 356.806 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 20.634884119033813
Epoch: 11, Steps: 64 | Train Loss: 42.381 Vali Loss: 473.258 Vali Acc: 0.405 Test Loss: 473.258 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 20.715734004974365
Epoch: 12, Steps: 64 | Train Loss: 146.065 Vali Loss: 444.515 Vali Acc: 0.595 Test Loss: 444.515 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 20.935935020446777
Epoch: 13, Steps: 64 | Train Loss: 43.273 Vali Loss: 493.534 Vali Acc: 0.565 Test Loss: 493.534 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 20.645158529281616
Epoch: 14, Steps: 64 | Train Loss: 73.421 Vali Loss: 1569.895 Vali Acc: 0.344 Test Loss: 1569.895 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 20.791300773620605
Epoch: 15, Steps: 64 | Train Loss: 89.644 Vali Loss: 1129.296 Vali Acc: 0.267 Test Loss: 1129.296 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 21.115161657333374
Epoch: 16, Steps: 64 | Train Loss: 41.091 Vali Loss: 577.422 Vali Acc: 0.618 Test Loss: 577.422 Test Acc: 0.618
Validation loss decreased (-0.607763 --> -0.612546).  Saving model ...
Epoch: 17 cost time: 20.77361512184143
Epoch: 17, Steps: 64 | Train Loss: 5.145 Vali Loss: 564.157 Vali Acc: 0.649 Test Loss: 564.157 Test Acc: 0.649
Validation loss decreased (-0.612546 --> -0.643213).  Saving model ...
Epoch: 18 cost time: 20.546297550201416
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 577.452 Vali Acc: 0.626 Test Loss: 577.452 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 20.926508903503418
Epoch: 19, Steps: 64 | Train Loss: 1.385 Vali Loss: 548.726 Vali Acc: 0.603 Test Loss: 548.726 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 20.870516300201416
Epoch: 20, Steps: 64 | Train Loss: 63.189 Vali Loss: 993.359 Vali Acc: 0.603 Test Loss: 993.359 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 20.641420125961304
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.294 Vali Acc: 0.595 Test Loss: 1129.294 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 20.747416734695435
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 20.8584144115448
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 20.60757327079773
Epoch: 24, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 20.684027194976807
Epoch: 25, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 20.8089017868042
Epoch: 26, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 20.73581600189209
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 1129.461 Vali Acc: 0.595 Test Loss: 1129.461 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 46715949
model size : 213.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.798606872558594
Epoch: 1, Steps: 64 | Train Loss: 107.652 Vali Loss: 230.685 Vali Acc: 0.153 Test Loss: 230.685 Test Acc: 0.153
Validation loss decreased (inf --> -0.150365).  Saving model ...
Epoch: 2 cost time: 19.313704013824463
Epoch: 2, Steps: 64 | Train Loss: 185.712 Vali Loss: 526.607 Vali Acc: 0.260 Test Loss: 526.607 Test Acc: 0.260
Validation loss decreased (-0.150365 --> -0.254276).  Saving model ...
Epoch: 3 cost time: 19.556724548339844
Epoch: 3, Steps: 64 | Train Loss: 212.430 Vali Loss: 532.996 Vali Acc: 0.214 Test Loss: 532.996 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 19.6768639087677
Epoch: 4, Steps: 64 | Train Loss: 274.626 Vali Loss: 212.089 Vali Acc: 0.496 Test Loss: 212.089 Test Acc: 0.496
Validation loss decreased (-0.254276 --> -0.494062).  Saving model ...
Epoch: 5 cost time: 19.916298151016235
Epoch: 5, Steps: 64 | Train Loss: 152.325 Vali Loss: 489.193 Vali Acc: 0.656 Test Loss: 489.193 Test Acc: 0.656
Validation loss decreased (-0.494062 --> -0.651597).  Saving model ...
Epoch: 6 cost time: 19.836451530456543
Epoch: 6, Steps: 64 | Train Loss: 90.257 Vali Loss: 397.537 Vali Acc: 0.611 Test Loss: 397.537 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 19.79637098312378
Epoch: 7, Steps: 64 | Train Loss: 28.808 Vali Loss: 536.849 Vali Acc: 0.573 Test Loss: 536.849 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 19.81105065345764
Epoch: 8, Steps: 64 | Train Loss: 63.276 Vali Loss: 610.260 Vali Acc: 0.511 Test Loss: 610.260 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 19.483251094818115
Epoch: 9, Steps: 64 | Train Loss: 117.677 Vali Loss: 377.144 Vali Acc: 0.466 Test Loss: 377.144 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 19.654304027557373
Epoch: 10, Steps: 64 | Train Loss: 46.253 Vali Loss: 740.523 Vali Acc: 0.496 Test Loss: 740.523 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 19.6346116065979
Epoch: 11, Steps: 64 | Train Loss: 26.158 Vali Loss: 584.873 Vali Acc: 0.427 Test Loss: 584.873 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 19.91316843032837
Epoch: 12, Steps: 64 | Train Loss: 9.890 Vali Loss: 512.075 Vali Acc: 0.595 Test Loss: 512.075 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 19.857544898986816
Epoch: 13, Steps: 64 | Train Loss: 0.000 Vali Loss: 512.066 Vali Acc: 0.580 Test Loss: 512.066 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 19.851844549179077
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 512.066 Vali Acc: 0.580 Test Loss: 512.066 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 19.836985111236572
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 512.066 Vali Acc: 0.580 Test Loss: 512.066 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 46715949
model size : 213.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 17.204457998275757
Epoch: 1, Steps: 32 | Train Loss: 57.746 Vali Loss: 88.450 Vali Acc: 0.443 Test Loss: 88.450 Test Acc: 0.443
Validation loss decreased (inf --> -0.441864).  Saving model ...
Epoch: 2 cost time: 15.651653289794922
Epoch: 2, Steps: 32 | Train Loss: 100.673 Vali Loss: 72.363 Vali Acc: 0.305 Test Loss: 72.363 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 15.600443601608276
Epoch: 3, Steps: 32 | Train Loss: 78.246 Vali Loss: 83.969 Vali Acc: 0.489 Test Loss: 83.969 Test Acc: 0.489
Validation loss decreased (-0.441864 --> -0.487710).  Saving model ...
Epoch: 4 cost time: 15.955482006072998
Epoch: 4, Steps: 32 | Train Loss: 203.186 Vali Loss: 227.277 Vali Acc: 0.496 Test Loss: 227.277 Test Acc: 0.496
Validation loss decreased (-0.487710 --> -0.493910).  Saving model ...
Epoch: 5 cost time: 15.599226474761963
Epoch: 5, Steps: 32 | Train Loss: 142.576 Vali Loss: 330.978 Vali Acc: 0.336 Test Loss: 330.978 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.532735824584961
Epoch: 6, Steps: 32 | Train Loss: 62.358 Vali Loss: 278.891 Vali Acc: 0.427 Test Loss: 278.891 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 15.748099565505981
Epoch: 7, Steps: 32 | Train Loss: 69.506 Vali Loss: 226.137 Vali Acc: 0.550 Test Loss: 226.137 Test Acc: 0.550
Validation loss decreased (-0.493910 --> -0.547357).  Saving model ...
Epoch: 8 cost time: 15.87378215789795
Epoch: 8, Steps: 32 | Train Loss: 68.457 Vali Loss: 248.427 Vali Acc: 0.534 Test Loss: 248.427 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 15.55323314666748
Epoch: 9, Steps: 32 | Train Loss: 25.723 Vali Loss: 213.990 Vali Acc: 0.466 Test Loss: 213.990 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 15.636502504348755
Epoch: 10, Steps: 32 | Train Loss: 32.071 Vali Loss: 709.968 Vali Acc: 0.466 Test Loss: 709.968 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 15.496937036514282
Epoch: 11, Steps: 32 | Train Loss: 36.030 Vali Loss: 201.441 Vali Acc: 0.611 Test Loss: 201.441 Test Acc: 0.611
Validation loss decreased (-0.547357 --> -0.608673).  Saving model ...
Epoch: 12 cost time: 15.852286577224731
Epoch: 12, Steps: 32 | Train Loss: 4.119 Vali Loss: 281.001 Vali Acc: 0.580 Test Loss: 281.001 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.46287202835083
Epoch: 13, Steps: 32 | Train Loss: 29.726 Vali Loss: 191.753 Vali Acc: 0.511 Test Loss: 191.753 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.584654331207275
Epoch: 14, Steps: 32 | Train Loss: 19.256 Vali Loss: 296.463 Vali Acc: 0.656 Test Loss: 296.463 Test Acc: 0.656
Validation loss decreased (-0.608673 --> -0.653524).  Saving model ...
Epoch: 15 cost time: 15.665893793106079
Epoch: 15, Steps: 32 | Train Loss: 27.372 Vali Loss: 413.959 Vali Acc: 0.573 Test Loss: 413.959 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 15.736421585083008
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 494.775 Vali Acc: 0.573 Test Loss: 494.775 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 15.766663312911987
Epoch: 17, Steps: 32 | Train Loss: 4.310 Vali Loss: 474.117 Vali Acc: 0.588 Test Loss: 474.117 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 15.783963918685913
Epoch: 18, Steps: 32 | Train Loss: 2.303 Vali Loss: 692.960 Vali Acc: 0.573 Test Loss: 692.960 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 15.629872560501099
Epoch: 19, Steps: 32 | Train Loss: 10.653 Vali Loss: 415.829 Vali Acc: 0.603 Test Loss: 415.829 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 15.778681755065918
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 411.933 Vali Acc: 0.611 Test Loss: 411.933 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 15.805578470230103
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 411.901 Vali Acc: 0.611 Test Loss: 411.901 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 15.53499722480774
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 411.900 Vali Acc: 0.611 Test Loss: 411.900 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 15.649112701416016
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 411.900 Vali Acc: 0.611 Test Loss: 411.900 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 15.69501280784607
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 411.900 Vali Acc: 0.611 Test Loss: 411.900 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 46715949
model size : 213.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.907191038131714
Epoch: 1, Steps: 32 | Train Loss: 44.623 Vali Loss: 102.322 Vali Acc: 0.099 Test Loss: 102.322 Test Acc: 0.099
Validation loss decreased (inf --> -0.098213).  Saving model ...
Epoch: 2 cost time: 14.301612854003906
Epoch: 2, Steps: 32 | Train Loss: 88.498 Vali Loss: 136.726 Vali Acc: 0.145 Test Loss: 136.726 Test Acc: 0.145
Validation loss decreased (-0.098213 --> -0.143671).  Saving model ...
Epoch: 3 cost time: 14.53500747680664
Epoch: 3, Steps: 32 | Train Loss: 141.032 Vali Loss: 314.259 Vali Acc: 0.427 Test Loss: 314.259 Test Acc: 0.427
Validation loss decreased (-0.143671 --> -0.424338).  Saving model ...
Epoch: 4 cost time: 14.874939918518066
Epoch: 4, Steps: 32 | Train Loss: 122.433 Vali Loss: 98.188 Vali Acc: 0.481 Test Loss: 98.188 Test Acc: 0.481
Validation loss decreased (-0.424338 --> -0.479934).  Saving model ...
Epoch: 5 cost time: 15.129234552383423
Epoch: 5, Steps: 32 | Train Loss: 83.432 Vali Loss: 78.427 Vali Acc: 0.282 Test Loss: 78.427 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 15.004197835922241
Epoch: 6, Steps: 32 | Train Loss: 93.950 Vali Loss: 162.853 Vali Acc: 0.458 Test Loss: 162.853 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 14.738786697387695
Epoch: 7, Steps: 32 | Train Loss: 69.419 Vali Loss: 260.293 Vali Acc: 0.481 Test Loss: 260.293 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 14.91268801689148
Epoch: 8, Steps: 32 | Train Loss: 29.368 Vali Loss: 245.313 Vali Acc: 0.618 Test Loss: 245.313 Test Acc: 0.618
Validation loss decreased (-0.479934 --> -0.615867).  Saving model ...
Epoch: 9 cost time: 15.215644121170044
Epoch: 9, Steps: 32 | Train Loss: 22.729 Vali Loss: 514.440 Vali Acc: 0.481 Test Loss: 514.440 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 14.790036678314209
Epoch: 10, Steps: 32 | Train Loss: 59.360 Vali Loss: 375.627 Vali Acc: 0.511 Test Loss: 375.627 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 15.135867357254028
Epoch: 11, Steps: 32 | Train Loss: 30.750 Vali Loss: 221.989 Vali Acc: 0.618 Test Loss: 221.989 Test Acc: 0.618
Validation loss decreased (-0.615867 --> -0.616101).  Saving model ...
Epoch: 12 cost time: 15.085387706756592
Epoch: 12, Steps: 32 | Train Loss: 15.241 Vali Loss: 447.978 Vali Acc: 0.344 Test Loss: 447.978 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 15.02980661392212
Epoch: 13, Steps: 32 | Train Loss: 10.013 Vali Loss: 597.849 Vali Acc: 0.534 Test Loss: 597.849 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 15.295655250549316
Epoch: 14, Steps: 32 | Train Loss: 4.687 Vali Loss: 340.452 Vali Acc: 0.527 Test Loss: 340.452 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 15.024784564971924
Epoch: 15, Steps: 32 | Train Loss: 1.321 Vali Loss: 547.293 Vali Acc: 0.275 Test Loss: 547.293 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 14.897985696792603
Epoch: 16, Steps: 32 | Train Loss: 1.410 Vali Loss: 682.910 Vali Acc: 0.527 Test Loss: 682.910 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 14.905614137649536
Epoch: 17, Steps: 32 | Train Loss: 11.645 Vali Loss: 545.494 Vali Acc: 0.557 Test Loss: 545.494 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 14.982319355010986
Epoch: 18, Steps: 32 | Train Loss: 3.771 Vali Loss: 786.078 Vali Acc: 0.244 Test Loss: 786.078 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 14.94444227218628
Epoch: 19, Steps: 32 | Train Loss: 38.126 Vali Loss: 629.009 Vali Acc: 0.595 Test Loss: 629.009 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 15.177222728729248
Epoch: 20, Steps: 32 | Train Loss: 19.774 Vali Loss: 939.769 Vali Acc: 0.542 Test Loss: 939.769 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 15.022866010665894
Epoch: 21, Steps: 32 | Train Loss: 13.438 Vali Loss: 565.427 Vali Acc: 0.573 Test Loss: 565.427 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 46715949
model size : 213.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 21.52141523361206
Epoch: 1, Steps: 64 | Train Loss: 183.542 Vali Loss: 164.129 Vali Acc: 0.237 Test Loss: 164.129 Test Acc: 0.237
Validation loss decreased (inf --> -0.235000).  Saving model ...
Epoch: 2 cost time: 20.337304830551147
Epoch: 2, Steps: 64 | Train Loss: 194.804 Vali Loss: 146.546 Vali Acc: 0.305 Test Loss: 146.546 Test Acc: 0.305
Validation loss decreased (-0.235000 --> -0.303878).  Saving model ...
Epoch: 3 cost time: 20.187936782836914
Epoch: 3, Steps: 64 | Train Loss: 348.758 Vali Loss: 209.760 Vali Acc: 0.328 Test Loss: 209.760 Test Acc: 0.328
Validation loss decreased (-0.303878 --> -0.326147).  Saving model ...
Epoch: 4 cost time: 20.103020191192627
Epoch: 4, Steps: 64 | Train Loss: 261.262 Vali Loss: 389.525 Vali Acc: 0.412 Test Loss: 389.525 Test Acc: 0.412
Validation loss decreased (-0.326147 --> -0.408318).  Saving model ...
Epoch: 5 cost time: 20.263039350509644
Epoch: 5, Steps: 64 | Train Loss: 125.990 Vali Loss: 579.376 Vali Acc: 0.550 Test Loss: 579.376 Test Acc: 0.550
Validation loss decreased (-0.408318 --> -0.543825).  Saving model ...
Epoch: 6 cost time: 20.104475736618042
Epoch: 6, Steps: 64 | Train Loss: 115.907 Vali Loss: 446.046 Vali Acc: 0.534 Test Loss: 446.046 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 20.068406105041504
Epoch: 7, Steps: 64 | Train Loss: 53.104 Vali Loss: 452.261 Vali Acc: 0.534 Test Loss: 452.261 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 20.466618537902832
Epoch: 8, Steps: 64 | Train Loss: 49.403 Vali Loss: 409.904 Vali Acc: 0.565 Test Loss: 409.904 Test Acc: 0.565
Validation loss decreased (-0.543825 --> -0.560786).  Saving model ...
Epoch: 9 cost time: 20.159369945526123
Epoch: 9, Steps: 64 | Train Loss: 13.973 Vali Loss: 524.205 Vali Acc: 0.534 Test Loss: 524.205 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 20.108542919158936
Epoch: 10, Steps: 64 | Train Loss: 23.869 Vali Loss: 687.888 Vali Acc: 0.550 Test Loss: 687.888 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 20.239732027053833
Epoch: 11, Steps: 64 | Train Loss: 56.909 Vali Loss: 441.359 Vali Acc: 0.527 Test Loss: 441.359 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 20.19511127471924
Epoch: 12, Steps: 64 | Train Loss: 28.350 Vali Loss: 622.505 Vali Acc: 0.588 Test Loss: 622.505 Test Acc: 0.588
Validation loss decreased (-0.560786 --> -0.581561).  Saving model ...
Epoch: 13 cost time: 20.094088554382324
Epoch: 13, Steps: 64 | Train Loss: 65.551 Vali Loss: 421.856 Vali Acc: 0.534 Test Loss: 421.856 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 20.38161277770996
Epoch: 14, Steps: 64 | Train Loss: 1.133 Vali Loss: 563.319 Vali Acc: 0.580 Test Loss: 563.319 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 20.371257543563843
Epoch: 15, Steps: 64 | Train Loss: 0.996 Vali Loss: 403.811 Vali Acc: 0.603 Test Loss: 403.811 Test Acc: 0.603
Validation loss decreased (-0.581561 --> -0.599015).  Saving model ...
Epoch: 16 cost time: 20.549022674560547
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599015 --> -0.599017).  Saving model ...
Epoch: 17 cost time: 20.107460737228394
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 18 cost time: 20.273728847503662
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 19 cost time: 20.23910164833069
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 20 cost time: 20.08591318130493
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 21 cost time: 20.5540132522583
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 22 cost time: 20.250677585601807
Epoch: 22, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 23 cost time: 20.20246934890747
Epoch: 23, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 24 cost time: 20.269384622573853
Epoch: 24, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 25 cost time: 19.98036026954651
Epoch: 25, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 26 cost time: 20.582829236984253
Epoch: 26, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 27 cost time: 20.511144399642944
Epoch: 27, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 28 cost time: 20.329527378082275
Epoch: 28, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 29 cost time: 20.642571449279785
Epoch: 29, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 30 cost time: 20.107032299041748
Epoch: 30, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 31 cost time: 20.267172813415527
Epoch: 31, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 32 cost time: 20.495371103286743
Epoch: 32, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 33 cost time: 20.23237419128418
Epoch: 33, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 34 cost time: 20.56994867324829
Epoch: 34, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 35 cost time: 20.11263418197632
Epoch: 35, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 36 cost time: 20.23593759536743
Epoch: 36, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 37 cost time: 20.351232290267944
Epoch: 37, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 38 cost time: 20.154163599014282
Epoch: 38, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 39 cost time: 20.676517486572266
Epoch: 39, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 40 cost time: 20.32451319694519
Epoch: 40, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 41 cost time: 20.07807469367981
Epoch: 41, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 42 cost time: 20.663734436035156
Epoch: 42, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 43 cost time: 20.175457239151
Epoch: 43, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 44 cost time: 20.38505244255066
Epoch: 44, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 45 cost time: 20.596812963485718
Epoch: 45, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 46 cost time: 20.31447958946228
Epoch: 46, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 47 cost time: 20.41732144355774
Epoch: 47, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 48 cost time: 20.506374835968018
Epoch: 48, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 49 cost time: 20.24894618988037
Epoch: 49, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 50 cost time: 20.495977640151978
Epoch: 50, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 51 cost time: 20.503662586212158
Epoch: 51, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 52 cost time: 20.405267238616943
Epoch: 52, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 53 cost time: 20.494499921798706
Epoch: 53, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 54 cost time: 20.121109008789062
Epoch: 54, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 55 cost time: 20.150776863098145
Epoch: 55, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 56 cost time: 20.515706062316895
Epoch: 56, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 57 cost time: 20.408015251159668
Epoch: 57, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 58 cost time: 20.675355195999146
Epoch: 58, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 59 cost time: 20.34834885597229
Epoch: 59, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 60 cost time: 20.051784992218018
Epoch: 60, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 61 cost time: 20.427999258041382
Epoch: 61, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 62 cost time: 20.514413595199585
Epoch: 62, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 63 cost time: 20.351582050323486
Epoch: 63, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 64 cost time: 20.584001541137695
Epoch: 64, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 65 cost time: 20.369067668914795
Epoch: 65, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 66 cost time: 20.289782285690308
Epoch: 66, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 67 cost time: 20.292737245559692
Epoch: 67, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 68 cost time: 20.40696382522583
Epoch: 68, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 69 cost time: 20.448904514312744
Epoch: 69, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 70 cost time: 20.49583888053894
Epoch: 70, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 71 cost time: 20.185460805892944
Epoch: 71, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 72 cost time: 20.348910331726074
Epoch: 72, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 73 cost time: 20.397506713867188
Epoch: 73, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 74 cost time: 20.584078550338745
Epoch: 74, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 75 cost time: 20.71169424057007
Epoch: 75, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 76 cost time: 20.211456060409546
Epoch: 76, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 77 cost time: 20.145244121551514
Epoch: 77, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 78 cost time: 20.32638669013977
Epoch: 78, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 79 cost time: 20.474072217941284
Epoch: 79, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 80 cost time: 20.46993374824524
Epoch: 80, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 81 cost time: 20.717567443847656
Epoch: 81, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 82 cost time: 20.31261897087097
Epoch: 82, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 83 cost time: 20.402570486068726
Epoch: 83, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 84 cost time: 20.517075061798096
Epoch: 84, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 85 cost time: 20.462191104888916
Epoch: 85, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 86 cost time: 20.337808847427368
Epoch: 86, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 87 cost time: 20.679502248764038
Epoch: 87, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 88 cost time: 20.426486492156982
Epoch: 88, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 89 cost time: 20.527814388275146
Epoch: 89, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 90 cost time: 20.334442853927612
Epoch: 90, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 91 cost time: 20.24849843978882
Epoch: 91, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 92 cost time: 20.564303159713745
Epoch: 92, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 93 cost time: 20.318319082260132
Epoch: 93, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 94 cost time: 20.239356517791748
Epoch: 94, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 95 cost time: 20.54362416267395
Epoch: 95, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 96 cost time: 20.4470636844635
Epoch: 96, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 97 cost time: 20.497036933898926
Epoch: 97, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 98 cost time: 20.539769649505615
Epoch: 98, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 99 cost time: 20.260268688201904
Epoch: 99, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
Epoch: 100 cost time: 20.553942918777466
Epoch: 100, Steps: 64 | Train Loss: 0.000 Vali Loss: 403.661 Vali Acc: 0.603 Test Loss: 403.661 Test Acc: 0.603
Validation loss decreased (-0.599017 --> -0.599017).  Saving model ...
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 46650413
model size : 213.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         2                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 20.292320489883423
Epoch: 1, Steps: 64 | Train Loss: 138.393 Vali Loss: 105.885 Vali Acc: 0.366 Test Loss: 105.885 Test Acc: 0.366
Validation loss decreased (inf --> -0.365353).  Saving model ...
Epoch: 2 cost time: 18.987448930740356
Epoch: 2, Steps: 64 | Train Loss: 185.847 Vali Loss: 279.862 Vali Acc: 0.466 Test Loss: 279.862 Test Acc: 0.466
Validation loss decreased (-0.365353 --> -0.462850).  Saving model ...
Epoch: 3 cost time: 19.257302284240723
Epoch: 3, Steps: 64 | Train Loss: 259.139 Vali Loss: 403.709 Vali Acc: 0.328 Test Loss: 403.709 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 18.99354648590088
Epoch: 4, Steps: 64 | Train Loss: 303.600 Vali Loss: 687.574 Vali Acc: 0.221 Test Loss: 687.574 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 18.915221214294434
Epoch: 5, Steps: 64 | Train Loss: 287.348 Vali Loss: 832.339 Vali Acc: 0.336 Test Loss: 832.339 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 19.300613403320312
Epoch: 6, Steps: 64 | Train Loss: 166.911 Vali Loss: 602.943 Vali Acc: 0.542 Test Loss: 602.943 Test Acc: 0.542
Validation loss decreased (-0.462850 --> -0.535955).  Saving model ...
Epoch: 7 cost time: 19.020857095718384
Epoch: 7, Steps: 64 | Train Loss: 47.568 Vali Loss: 426.226 Vali Acc: 0.443 Test Loss: 426.226 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.025142669677734
Epoch: 8, Steps: 64 | Train Loss: 94.807 Vali Loss: 429.311 Vali Acc: 0.397 Test Loss: 429.311 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 19.261518239974976
Epoch: 9, Steps: 64 | Train Loss: 164.527 Vali Loss: 284.642 Vali Acc: 0.588 Test Loss: 284.642 Test Acc: 0.588
Validation loss decreased (-0.535955 --> -0.584940).  Saving model ...
Epoch: 10 cost time: 19.088126182556152
Epoch: 10, Steps: 64 | Train Loss: 36.076 Vali Loss: 650.832 Vali Acc: 0.351 Test Loss: 650.832 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 19.162254095077515
Epoch: 11, Steps: 64 | Train Loss: 4.907 Vali Loss: 406.124 Vali Acc: 0.672 Test Loss: 406.124 Test Acc: 0.672
Validation loss decreased (-0.584940 --> -0.667694).  Saving model ...
Epoch: 12 cost time: 19.515461206436157
Epoch: 12, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 19.007689952850342
Epoch: 13, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 19.114508390426636
Epoch: 14, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 19.287172317504883
Epoch: 15, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 19.381468296051025
Epoch: 16, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 19.089518785476685
Epoch: 17, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 19.294239044189453
Epoch: 18, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 19.05007266998291
Epoch: 19, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 19.019890069961548
Epoch: 20, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 19.40699553489685
Epoch: 21, Steps: 64 | Train Loss: 0.000 Vali Loss: 406.347 Vali Acc: 0.672 Test Loss: 406.347 Test Acc: 0.672
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6717557251908397
model parameter : 46650413
model size : 213.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 16.842705488204956
Epoch: 1, Steps: 32 | Train Loss: 71.248 Vali Loss: 54.063 Vali Acc: 0.298 Test Loss: 54.063 Test Acc: 0.298
Validation loss decreased (inf --> -0.297169).  Saving model ...
Epoch: 2 cost time: 15.310488939285278
Epoch: 2, Steps: 32 | Train Loss: 75.433 Vali Loss: 96.568 Vali Acc: 0.450 Test Loss: 96.568 Test Acc: 0.450
Validation loss decreased (-0.297169 --> -0.449416).  Saving model ...
Epoch: 3 cost time: 15.591581583023071
Epoch: 3, Steps: 32 | Train Loss: 130.040 Vali Loss: 317.842 Vali Acc: 0.183 Test Loss: 317.842 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 15.599495887756348
Epoch: 4, Steps: 32 | Train Loss: 103.929 Vali Loss: 234.446 Vali Acc: 0.313 Test Loss: 234.446 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 15.421525239944458
Epoch: 5, Steps: 32 | Train Loss: 138.767 Vali Loss: 311.073 Vali Acc: 0.344 Test Loss: 311.073 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 15.569283246994019
Epoch: 6, Steps: 32 | Train Loss: 117.880 Vali Loss: 320.993 Vali Acc: 0.214 Test Loss: 320.993 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 15.436174631118774
Epoch: 7, Steps: 32 | Train Loss: 125.889 Vali Loss: 385.542 Vali Acc: 0.351 Test Loss: 385.542 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 15.436289072036743
Epoch: 8, Steps: 32 | Train Loss: 136.514 Vali Loss: 392.433 Vali Acc: 0.519 Test Loss: 392.433 Test Acc: 0.519
Validation loss decreased (-0.449416 --> -0.515160).  Saving model ...
Epoch: 9 cost time: 15.522844791412354
Epoch: 9, Steps: 32 | Train Loss: 39.097 Vali Loss: 228.578 Vali Acc: 0.389 Test Loss: 228.578 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 15.312825441360474
Epoch: 10, Steps: 32 | Train Loss: 34.903 Vali Loss: 142.614 Vali Acc: 0.626 Test Loss: 142.614 Test Acc: 0.626
Validation loss decreased (-0.515160 --> -0.624528).  Saving model ...
Epoch: 11 cost time: 15.445468187332153
Epoch: 11, Steps: 32 | Train Loss: 14.500 Vali Loss: 495.499 Vali Acc: 0.573 Test Loss: 495.499 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 15.468684673309326
Epoch: 12, Steps: 32 | Train Loss: 15.883 Vali Loss: 271.434 Vali Acc: 0.603 Test Loss: 271.434 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 16.02224850654602
Epoch: 13, Steps: 32 | Train Loss: 22.999 Vali Loss: 779.256 Vali Acc: 0.489 Test Loss: 779.256 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 16.266924619674683
Epoch: 14, Steps: 32 | Train Loss: 53.590 Vali Loss: 507.833 Vali Acc: 0.321 Test Loss: 507.833 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 15.880940914154053
Epoch: 15, Steps: 32 | Train Loss: 8.132 Vali Loss: 508.329 Vali Acc: 0.382 Test Loss: 508.329 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 16.029898166656494
Epoch: 16, Steps: 32 | Train Loss: 11.998 Vali Loss: 307.182 Vali Acc: 0.634 Test Loss: 307.182 Test Acc: 0.634
Validation loss decreased (-0.624528 --> -0.630516).  Saving model ...
Epoch: 17 cost time: 16.292049407958984
Epoch: 17, Steps: 32 | Train Loss: 7.426 Vali Loss: 447.067 Vali Acc: 0.588 Test Loss: 447.067 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 16.058940649032593
Epoch: 18, Steps: 32 | Train Loss: 7.443 Vali Loss: 573.481 Vali Acc: 0.527 Test Loss: 573.481 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 16.05143666267395
Epoch: 19, Steps: 32 | Train Loss: 16.089 Vali Loss: 247.506 Vali Acc: 0.634 Test Loss: 247.506 Test Acc: 0.634
Validation loss decreased (-0.630516 --> -0.631113).  Saving model ...
Epoch: 20 cost time: 16.13829016685486
Epoch: 20, Steps: 32 | Train Loss: 7.106 Vali Loss: 604.818 Vali Acc: 0.527 Test Loss: 604.818 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 16.205844163894653
Epoch: 21, Steps: 32 | Train Loss: 0.657 Vali Loss: 328.615 Vali Acc: 0.595 Test Loss: 328.615 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 16.015400409698486
Epoch: 22, Steps: 32 | Train Loss: 1.567 Vali Loss: 594.160 Vali Acc: 0.298 Test Loss: 594.160 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 16.06761074066162
Epoch: 23, Steps: 32 | Train Loss: 8.329 Vali Loss: 432.228 Vali Acc: 0.573 Test Loss: 432.228 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 16.182450771331787
Epoch: 24, Steps: 32 | Train Loss: 1.572 Vali Loss: 662.332 Vali Acc: 0.504 Test Loss: 662.332 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 16.112647771835327
Epoch: 25, Steps: 32 | Train Loss: 47.739 Vali Loss: 725.919 Vali Acc: 0.527 Test Loss: 725.919 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 16.313684463500977
Epoch: 26, Steps: 32 | Train Loss: 16.111 Vali Loss: 881.116 Vali Acc: 0.557 Test Loss: 881.116 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 16.064797401428223
Epoch: 27, Steps: 32 | Train Loss: 10.371 Vali Loss: 733.471 Vali Acc: 0.260 Test Loss: 733.471 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 16.127257585525513
Epoch: 28, Steps: 32 | Train Loss: 25.971 Vali Loss: 380.718 Vali Acc: 0.511 Test Loss: 380.718 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 16.040569305419922
Epoch: 29, Steps: 32 | Train Loss: 0.847 Vali Loss: 290.957 Vali Acc: 0.687 Test Loss: 290.957 Test Acc: 0.687
Validation loss decreased (-0.631113 --> -0.684113).  Saving model ...
Epoch: 30 cost time: 16.279890060424805
Epoch: 30, Steps: 32 | Train Loss: 51.866 Vali Loss: 1378.388 Vali Acc: 0.504 Test Loss: 1378.388 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 15.98568844795227
Epoch: 31, Steps: 32 | Train Loss: 52.585 Vali Loss: 1068.399 Vali Acc: 0.542 Test Loss: 1068.399 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 15.84604024887085
Epoch: 32, Steps: 32 | Train Loss: 45.924 Vali Loss: 413.919 Vali Acc: 0.603 Test Loss: 413.919 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 16.137974500656128
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 628.189 Vali Acc: 0.557 Test Loss: 628.189 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 16.077388048171997
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 637.689 Vali Acc: 0.557 Test Loss: 637.689 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 16.05431842803955
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 638.026 Vali Acc: 0.557 Test Loss: 638.026 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 16.204657554626465
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 638.038 Vali Acc: 0.557 Test Loss: 638.038 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 16.192264318466187
Epoch: 37, Steps: 32 | Train Loss: 9.217 Vali Loss: 462.019 Vali Acc: 0.595 Test Loss: 462.019 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 16.024690628051758
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 643.693 Vali Acc: 0.557 Test Loss: 643.693 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 16.335630178451538
Epoch: 39, Steps: 32 | Train Loss: 3.015 Vali Loss: 421.155 Vali Acc: 0.595 Test Loss: 421.155 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6870229007633588
model parameter : 46650413
model size : 213.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 15.486084222793579
Epoch: 1, Steps: 32 | Train Loss: 60.971 Vali Loss: 48.863 Vali Acc: 0.290 Test Loss: 48.863 Test Acc: 0.290
Validation loss decreased (inf --> -0.289588).  Saving model ...
Epoch: 2 cost time: 14.326452493667603
Epoch: 2, Steps: 32 | Train Loss: 94.615 Vali Loss: 118.201 Vali Acc: 0.466 Test Loss: 118.201 Test Acc: 0.466
Validation loss decreased (-0.289588 --> -0.464467).  Saving model ...
Epoch: 3 cost time: 14.396173000335693
Epoch: 3, Steps: 32 | Train Loss: 136.073 Vali Loss: 200.331 Vali Acc: 0.252 Test Loss: 200.331 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 14.386230707168579
Epoch: 4, Steps: 32 | Train Loss: 149.459 Vali Loss: 175.874 Vali Acc: 0.191 Test Loss: 175.874 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 14.383994340896606
Epoch: 5, Steps: 32 | Train Loss: 131.910 Vali Loss: 209.322 Vali Acc: 0.496 Test Loss: 209.322 Test Acc: 0.496
Validation loss decreased (-0.464467 --> -0.494090).  Saving model ...
Epoch: 6 cost time: 14.095372915267944
Epoch: 6, Steps: 32 | Train Loss: 66.485 Vali Loss: 245.902 Vali Acc: 0.237 Test Loss: 245.902 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 14.444162607192993
Epoch: 7, Steps: 32 | Train Loss: 61.910 Vali Loss: 442.745 Vali Acc: 0.534 Test Loss: 442.745 Test Acc: 0.534
Validation loss decreased (-0.494090 --> -0.529924).  Saving model ...
Epoch: 8 cost time: 14.382839918136597
Epoch: 8, Steps: 32 | Train Loss: 114.149 Vali Loss: 437.781 Vali Acc: 0.481 Test Loss: 437.781 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 14.274205446243286
Epoch: 9, Steps: 32 | Train Loss: 12.799 Vali Loss: 247.662 Vali Acc: 0.450 Test Loss: 247.662 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 14.2760488986969
Epoch: 10, Steps: 32 | Train Loss: 27.999 Vali Loss: 261.692 Vali Acc: 0.649 Test Loss: 261.692 Test Acc: 0.649
Validation loss decreased (-0.529924 --> -0.646238).  Saving model ...
Epoch: 11 cost time: 14.383094072341919
Epoch: 11, Steps: 32 | Train Loss: 5.511 Vali Loss: 449.683 Vali Acc: 0.550 Test Loss: 449.683 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 14.141393184661865
Epoch: 12, Steps: 32 | Train Loss: 48.446 Vali Loss: 445.423 Vali Acc: 0.374 Test Loss: 445.423 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 14.460294008255005
Epoch: 13, Steps: 32 | Train Loss: 23.743 Vali Loss: 675.065 Vali Acc: 0.504 Test Loss: 675.065 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 14.28867506980896
Epoch: 14, Steps: 32 | Train Loss: 20.567 Vali Loss: 556.215 Vali Acc: 0.557 Test Loss: 556.215 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 14.212401390075684
Epoch: 15, Steps: 32 | Train Loss: 8.668 Vali Loss: 471.809 Vali Acc: 0.550 Test Loss: 471.809 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 14.209396362304688
Epoch: 16, Steps: 32 | Train Loss: 17.846 Vali Loss: 428.613 Vali Acc: 0.611 Test Loss: 428.613 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 14.242998600006104
Epoch: 17, Steps: 32 | Train Loss: 1.992 Vali Loss: 601.669 Vali Acc: 0.542 Test Loss: 601.669 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 14.493813514709473
Epoch: 18, Steps: 32 | Train Loss: 44.907 Vali Loss: 667.554 Vali Acc: 0.328 Test Loss: 667.554 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 14.223100662231445
Epoch: 19, Steps: 32 | Train Loss: 50.025 Vali Loss: 637.958 Vali Acc: 0.473 Test Loss: 637.958 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 14.091214895248413
Epoch: 20, Steps: 32 | Train Loss: 9.490 Vali Loss: 669.582 Vali Acc: 0.565 Test Loss: 669.582 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 46650413
model size : 213.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 12.257887125015259
Epoch: 1, Steps: 32 | Train Loss: 27.519 Vali Loss: 71.920 Vali Acc: 0.427 Test Loss: 71.920 Test Acc: 0.427
Validation loss decreased (inf --> -0.426762).  Saving model ...
Epoch: 2 cost time: 11.385615348815918
Epoch: 2, Steps: 32 | Train Loss: 60.573 Vali Loss: 66.650 Vali Acc: 0.473 Test Loss: 66.650 Test Acc: 0.473
Validation loss decreased (-0.426762 --> -0.472616).  Saving model ...
Epoch: 3 cost time: 11.052354335784912
Epoch: 3, Steps: 32 | Train Loss: 75.480 Vali Loss: 47.026 Vali Acc: 0.290 Test Loss: 47.026 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 11.367830991744995
Epoch: 4, Steps: 32 | Train Loss: 137.268 Vali Loss: 165.884 Vali Acc: 0.244 Test Loss: 165.884 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 11.241491556167603
Epoch: 5, Steps: 32 | Train Loss: 58.498 Vali Loss: 162.725 Vali Acc: 0.206 Test Loss: 162.725 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 11.363847732543945
Epoch: 6, Steps: 32 | Train Loss: 88.270 Vali Loss: 87.371 Vali Acc: 0.519 Test Loss: 87.371 Test Acc: 0.519
Validation loss decreased (-0.472616 --> -0.518210).  Saving model ...
Epoch: 7 cost time: 11.229500532150269
Epoch: 7, Steps: 32 | Train Loss: 47.403 Vali Loss: 271.853 Vali Acc: 0.282 Test Loss: 271.853 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 11.496218204498291
Epoch: 8, Steps: 32 | Train Loss: 70.875 Vali Loss: 139.064 Vali Acc: 0.351 Test Loss: 139.064 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 11.04253625869751
Epoch: 9, Steps: 32 | Train Loss: 37.490 Vali Loss: 105.360 Vali Acc: 0.557 Test Loss: 105.360 Test Acc: 0.557
Validation loss decreased (-0.518210 --> -0.556198).  Saving model ...
Epoch: 10 cost time: 11.24832558631897
Epoch: 10, Steps: 32 | Train Loss: 8.154 Vali Loss: 188.964 Vali Acc: 0.504 Test Loss: 188.964 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 11.242368698120117
Epoch: 11, Steps: 32 | Train Loss: 35.042 Vali Loss: 112.502 Vali Acc: 0.550 Test Loss: 112.502 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 11.279791593551636
Epoch: 12, Steps: 32 | Train Loss: 11.596 Vali Loss: 198.131 Vali Acc: 0.435 Test Loss: 198.131 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 11.248903512954712
Epoch: 13, Steps: 32 | Train Loss: 17.764 Vali Loss: 173.389 Vali Acc: 0.588 Test Loss: 173.389 Test Acc: 0.588
Validation loss decreased (-0.556198 --> -0.586052).  Saving model ...
Epoch: 14 cost time: 11.20829153060913
Epoch: 14, Steps: 32 | Train Loss: 33.099 Vali Loss: 270.941 Vali Acc: 0.473 Test Loss: 270.941 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 11.394110679626465
Epoch: 15, Steps: 32 | Train Loss: 42.304 Vali Loss: 228.532 Vali Acc: 0.366 Test Loss: 228.532 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 11.462660789489746
Epoch: 16, Steps: 32 | Train Loss: 15.010 Vali Loss: 284.301 Vali Acc: 0.588 Test Loss: 284.301 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 11.399332761764526
Epoch: 17, Steps: 32 | Train Loss: 12.901 Vali Loss: 406.114 Vali Acc: 0.336 Test Loss: 406.114 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 11.386325597763062
Epoch: 18, Steps: 32 | Train Loss: 2.680 Vali Loss: 312.966 Vali Acc: 0.321 Test Loss: 312.966 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 11.71153974533081
Epoch: 19, Steps: 32 | Train Loss: 5.651 Vali Loss: 275.330 Vali Acc: 0.588 Test Loss: 275.330 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 11.091480016708374
Epoch: 20, Steps: 32 | Train Loss: 2.372 Vali Loss: 346.553 Vali Acc: 0.557 Test Loss: 346.553 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 11.415497779846191
Epoch: 21, Steps: 32 | Train Loss: 1.866 Vali Loss: 270.825 Vali Acc: 0.534 Test Loss: 270.825 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 11.293854236602783
Epoch: 22, Steps: 32 | Train Loss: 3.654 Vali Loss: 337.010 Vali Acc: 0.611 Test Loss: 337.010 Test Acc: 0.611
Validation loss decreased (-0.586052 --> -0.607317).  Saving model ...
Epoch: 23 cost time: 11.209526300430298
Epoch: 23, Steps: 32 | Train Loss: 0.434 Vali Loss: 302.798 Vali Acc: 0.611 Test Loss: 302.798 Test Acc: 0.611
Validation loss decreased (-0.607317 --> -0.607659).  Saving model ...
Epoch: 24 cost time: 11.54921817779541
Epoch: 24, Steps: 32 | Train Loss: 3.222 Vali Loss: 329.910 Vali Acc: 0.519 Test Loss: 329.910 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 11.165950059890747
Epoch: 25, Steps: 32 | Train Loss: 1.392 Vali Loss: 397.003 Vali Acc: 0.557 Test Loss: 397.003 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 11.297764778137207
Epoch: 26, Steps: 32 | Train Loss: 7.213 Vali Loss: 276.906 Vali Acc: 0.603 Test Loss: 276.906 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 11.237679719924927
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.231 Vali Acc: 0.580 Test Loss: 290.231 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 11.363115787506104
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.779 Vali Acc: 0.580 Test Loss: 290.779 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 11.197019338607788
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.798 Vali Acc: 0.580 Test Loss: 290.798 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 11.558637142181396
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.799 Vali Acc: 0.580 Test Loss: 290.799 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 11.275219917297363
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.799 Vali Acc: 0.580 Test Loss: 290.799 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 11.361989736557007
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.799 Vali Acc: 0.580 Test Loss: 290.799 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 11.074461936950684
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 290.799 Vali Acc: 0.580 Test Loss: 290.799 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 24209965
model size : 109.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.54345965385437
Epoch: 1, Steps: 32 | Train Loss: 27.118 Vali Loss: 83.486 Vali Acc: 0.435 Test Loss: 83.486 Test Acc: 0.435
Validation loss decreased (inf --> -0.434280).  Saving model ...
Epoch: 2 cost time: 10.097617387771606
Epoch: 2, Steps: 32 | Train Loss: 55.865 Vali Loss: 122.054 Vali Acc: 0.183 Test Loss: 122.054 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.062214612960815
Epoch: 3, Steps: 32 | Train Loss: 74.749 Vali Loss: 62.214 Vali Acc: 0.466 Test Loss: 62.214 Test Acc: 0.466
Validation loss decreased (-0.434280 --> -0.465027).  Saving model ...
Epoch: 4 cost time: 10.188316583633423
Epoch: 4, Steps: 32 | Train Loss: 81.387 Vali Loss: 55.265 Vali Acc: 0.489 Test Loss: 55.265 Test Acc: 0.489
Validation loss decreased (-0.465027 --> -0.487997).  Saving model ...
Epoch: 5 cost time: 9.97465991973877
Epoch: 5, Steps: 32 | Train Loss: 84.522 Vali Loss: 186.395 Vali Acc: 0.321 Test Loss: 186.395 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.233497142791748
Epoch: 6, Steps: 32 | Train Loss: 111.206 Vali Loss: 159.579 Vali Acc: 0.305 Test Loss: 159.579 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.153794527053833
Epoch: 7, Steps: 32 | Train Loss: 50.099 Vali Loss: 110.391 Vali Acc: 0.511 Test Loss: 110.391 Test Acc: 0.511
Validation loss decreased (-0.487997 --> -0.510346).  Saving model ...
Epoch: 8 cost time: 10.3143630027771
Epoch: 8, Steps: 32 | Train Loss: 40.956 Vali Loss: 86.809 Vali Acc: 0.527 Test Loss: 86.809 Test Acc: 0.527
Validation loss decreased (-0.510346 --> -0.525849).  Saving model ...
Epoch: 9 cost time: 10.28291368484497
Epoch: 9, Steps: 32 | Train Loss: 35.911 Vali Loss: 178.423 Vali Acc: 0.527 Test Loss: 178.423 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.260586977005005
Epoch: 10, Steps: 32 | Train Loss: 67.935 Vali Loss: 113.104 Vali Acc: 0.603 Test Loss: 113.104 Test Acc: 0.603
Validation loss decreased (-0.525849 --> -0.601922).  Saving model ...
Epoch: 11 cost time: 10.005430936813354
Epoch: 11, Steps: 32 | Train Loss: 30.154 Vali Loss: 262.259 Vali Acc: 0.420 Test Loss: 262.259 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.264312744140625
Epoch: 12, Steps: 32 | Train Loss: 24.100 Vali Loss: 129.895 Vali Acc: 0.473 Test Loss: 129.895 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.367494821548462
Epoch: 13, Steps: 32 | Train Loss: 38.730 Vali Loss: 177.182 Vali Acc: 0.519 Test Loss: 177.182 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.036502361297607
Epoch: 14, Steps: 32 | Train Loss: 20.526 Vali Loss: 173.391 Vali Acc: 0.557 Test Loss: 173.391 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.245436429977417
Epoch: 15, Steps: 32 | Train Loss: 15.274 Vali Loss: 192.429 Vali Acc: 0.550 Test Loss: 192.429 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.02315616607666
Epoch: 16, Steps: 32 | Train Loss: 1.189 Vali Loss: 229.455 Vali Acc: 0.573 Test Loss: 229.455 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 10.245379209518433
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 243.670 Vali Acc: 0.595 Test Loss: 243.670 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.130968809127808
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 244.454 Vali Acc: 0.595 Test Loss: 244.454 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.367697477340698
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 244.483 Vali Acc: 0.595 Test Loss: 244.483 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 10.448512077331543
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 244.484 Vali Acc: 0.595 Test Loss: 244.484 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 24209965
model size : 109.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.759797811508179
Epoch: 1, Steps: 32 | Train Loss: 27.976 Vali Loss: 63.082 Vali Acc: 0.435 Test Loss: 63.082 Test Acc: 0.435
Validation loss decreased (inf --> -0.434484).  Saving model ...
Epoch: 2 cost time: 9.34072494506836
Epoch: 2, Steps: 32 | Train Loss: 45.434 Vali Loss: 88.070 Vali Acc: 0.450 Test Loss: 88.070 Test Acc: 0.450
Validation loss decreased (-0.434484 --> -0.449501).  Saving model ...
Epoch: 3 cost time: 9.974385976791382
Epoch: 3, Steps: 32 | Train Loss: 62.336 Vali Loss: 63.636 Vali Acc: 0.336 Test Loss: 63.636 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.404419898986816
Epoch: 4, Steps: 32 | Train Loss: 61.328 Vali Loss: 96.643 Vali Acc: 0.214 Test Loss: 96.643 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.994173765182495
Epoch: 5, Steps: 32 | Train Loss: 56.540 Vali Loss: 177.196 Vali Acc: 0.206 Test Loss: 177.196 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.72110104560852
Epoch: 6, Steps: 32 | Train Loss: 104.019 Vali Loss: 122.966 Vali Acc: 0.435 Test Loss: 122.966 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 9.346371412277222
Epoch: 7, Steps: 32 | Train Loss: 60.860 Vali Loss: 93.414 Vali Acc: 0.427 Test Loss: 93.414 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 9.769681692123413
Epoch: 8, Steps: 32 | Train Loss: 42.232 Vali Loss: 123.961 Vali Acc: 0.305 Test Loss: 123.961 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.21472978591919
Epoch: 9, Steps: 32 | Train Loss: 33.309 Vali Loss: 135.860 Vali Acc: 0.504 Test Loss: 135.860 Test Acc: 0.504
Validation loss decreased (-0.449501 --> -0.502458).  Saving model ...
Epoch: 10 cost time: 10.068802118301392
Epoch: 10, Steps: 32 | Train Loss: 26.724 Vali Loss: 96.282 Vali Acc: 0.496 Test Loss: 96.282 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.721297025680542
Epoch: 11, Steps: 32 | Train Loss: 11.277 Vali Loss: 120.646 Vali Acc: 0.412 Test Loss: 120.646 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.568900108337402
Epoch: 12, Steps: 32 | Train Loss: 32.116 Vali Loss: 124.746 Vali Acc: 0.466 Test Loss: 124.746 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 9.833717107772827
Epoch: 13, Steps: 32 | Train Loss: 26.493 Vali Loss: 130.146 Vali Acc: 0.573 Test Loss: 130.146 Test Acc: 0.573
Validation loss decreased (-0.502458 --> -0.571218).  Saving model ...
Epoch: 14 cost time: 9.626653671264648
Epoch: 14, Steps: 32 | Train Loss: 23.830 Vali Loss: 165.985 Vali Acc: 0.580 Test Loss: 165.985 Test Acc: 0.580
Validation loss decreased (-0.571218 --> -0.578493).  Saving model ...
Epoch: 15 cost time: 9.717912435531616
Epoch: 15, Steps: 32 | Train Loss: 12.710 Vali Loss: 144.717 Vali Acc: 0.603 Test Loss: 144.717 Test Acc: 0.603
Validation loss decreased (-0.578493 --> -0.601606).  Saving model ...
Epoch: 16 cost time: 9.823115825653076
Epoch: 16, Steps: 32 | Train Loss: 8.261 Vali Loss: 163.850 Vali Acc: 0.366 Test Loss: 163.850 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.820123434066772
Epoch: 17, Steps: 32 | Train Loss: 4.990 Vali Loss: 179.671 Vali Acc: 0.573 Test Loss: 179.671 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.727020978927612
Epoch: 18, Steps: 32 | Train Loss: 4.019 Vali Loss: 156.597 Vali Acc: 0.565 Test Loss: 156.597 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.764607906341553
Epoch: 19, Steps: 32 | Train Loss: 4.182 Vali Loss: 219.927 Vali Acc: 0.481 Test Loss: 219.927 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.528018712997437
Epoch: 20, Steps: 32 | Train Loss: 4.179 Vali Loss: 231.444 Vali Acc: 0.588 Test Loss: 231.444 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 9.937441110610962
Epoch: 21, Steps: 32 | Train Loss: 3.952 Vali Loss: 281.317 Vali Acc: 0.588 Test Loss: 281.317 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.403766870498657
Epoch: 22, Steps: 32 | Train Loss: 1.134 Vali Loss: 254.190 Vali Acc: 0.603 Test Loss: 254.190 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 9.730615139007568
Epoch: 23, Steps: 32 | Train Loss: 4.004 Vali Loss: 248.793 Vali Acc: 0.595 Test Loss: 248.793 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 9.695435285568237
Epoch: 24, Steps: 32 | Train Loss: 1.399 Vali Loss: 245.361 Vali Acc: 0.626 Test Loss: 245.361 Test Acc: 0.626
Validation loss decreased (-0.601606 --> -0.623501).  Saving model ...
Epoch: 25 cost time: 9.918424129486084
Epoch: 25, Steps: 32 | Train Loss: 1.712 Vali Loss: 299.175 Vali Acc: 0.466 Test Loss: 299.175 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.92505168914795
Epoch: 26, Steps: 32 | Train Loss: 1.292 Vali Loss: 218.115 Vali Acc: 0.573 Test Loss: 218.115 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.395667314529419
Epoch: 27, Steps: 32 | Train Loss: 4.087 Vali Loss: 401.524 Vali Acc: 0.405 Test Loss: 401.524 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.999074697494507
Epoch: 28, Steps: 32 | Train Loss: 7.041 Vali Loss: 215.984 Vali Acc: 0.504 Test Loss: 215.984 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.351385831832886
Epoch: 29, Steps: 32 | Train Loss: 6.065 Vali Loss: 388.598 Vali Acc: 0.305 Test Loss: 388.598 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 10.192042827606201
Epoch: 30, Steps: 32 | Train Loss: 14.868 Vali Loss: 177.366 Vali Acc: 0.595 Test Loss: 177.366 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 9.419215202331543
Epoch: 31, Steps: 32 | Train Loss: 0.799 Vali Loss: 234.113 Vali Acc: 0.450 Test Loss: 234.113 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 9.781697511672974
Epoch: 32, Steps: 32 | Train Loss: 21.711 Vali Loss: 320.138 Vali Acc: 0.618 Test Loss: 320.138 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.57592248916626
Epoch: 33, Steps: 32 | Train Loss: 27.830 Vali Loss: 239.464 Vali Acc: 0.565 Test Loss: 239.464 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 9.289873600006104
Epoch: 34, Steps: 32 | Train Loss: 18.270 Vali Loss: 295.799 Vali Acc: 0.550 Test Loss: 295.799 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 24209965
model size : 109.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.904526233673096
Epoch: 1, Steps: 32 | Train Loss: 28.300 Vali Loss: 55.969 Vali Acc: 0.412 Test Loss: 55.969 Test Acc: 0.412
Validation loss decreased (inf --> -0.411654).  Saving model ...
Epoch: 2 cost time: 9.181122541427612
Epoch: 2, Steps: 32 | Train Loss: 64.950 Vali Loss: 70.737 Vali Acc: 0.420 Test Loss: 70.737 Test Acc: 0.420
Validation loss decreased (-0.411654 --> -0.419140).  Saving model ...
Epoch: 3 cost time: 8.554258108139038
Epoch: 3, Steps: 32 | Train Loss: 86.144 Vali Loss: 108.240 Vali Acc: 0.183 Test Loss: 108.240 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.211291790008545
Epoch: 4, Steps: 32 | Train Loss: 69.734 Vali Loss: 91.191 Vali Acc: 0.206 Test Loss: 91.191 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.737581253051758
Epoch: 5, Steps: 32 | Train Loss: 91.433 Vali Loss: 158.320 Vali Acc: 0.191 Test Loss: 158.320 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.805843114852905
Epoch: 6, Steps: 32 | Train Loss: 45.152 Vali Loss: 63.362 Vali Acc: 0.412 Test Loss: 63.362 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.801316261291504
Epoch: 7, Steps: 32 | Train Loss: 91.859 Vali Loss: 357.879 Vali Acc: 0.137 Test Loss: 357.879 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.691832065582275
Epoch: 8, Steps: 32 | Train Loss: 93.712 Vali Loss: 180.034 Vali Acc: 0.405 Test Loss: 180.034 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 9.112243175506592
Epoch: 9, Steps: 32 | Train Loss: 52.729 Vali Loss: 209.747 Vali Acc: 0.443 Test Loss: 209.747 Test Acc: 0.443
Validation loss decreased (-0.419140 --> -0.440651).  Saving model ...
Epoch: 10 cost time: 9.048204183578491
Epoch: 10, Steps: 32 | Train Loss: 29.139 Vali Loss: 152.787 Vali Acc: 0.534 Test Loss: 152.787 Test Acc: 0.534
Validation loss decreased (-0.440651 --> -0.532823).  Saving model ...
Epoch: 11 cost time: 9.454693078994751
Epoch: 11, Steps: 32 | Train Loss: 13.598 Vali Loss: 248.835 Vali Acc: 0.473 Test Loss: 248.835 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.919881582260132
Epoch: 12, Steps: 32 | Train Loss: 37.009 Vali Loss: 184.705 Vali Acc: 0.588 Test Loss: 184.705 Test Acc: 0.588
Validation loss decreased (-0.532823 --> -0.585939).  Saving model ...
Epoch: 13 cost time: 9.121058940887451
Epoch: 13, Steps: 32 | Train Loss: 4.649 Vali Loss: 212.119 Vali Acc: 0.580 Test Loss: 212.119 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.859256744384766
Epoch: 14, Steps: 32 | Train Loss: 1.807 Vali Loss: 198.279 Vali Acc: 0.534 Test Loss: 198.279 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.998855829238892
Epoch: 15, Steps: 32 | Train Loss: 5.720 Vali Loss: 243.082 Vali Acc: 0.588 Test Loss: 243.082 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.905717611312866
Epoch: 16, Steps: 32 | Train Loss: 3.838 Vali Loss: 315.429 Vali Acc: 0.580 Test Loss: 315.429 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.264179706573486
Epoch: 17, Steps: 32 | Train Loss: 3.918 Vali Loss: 339.433 Vali Acc: 0.313 Test Loss: 339.433 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.023076295852661
Epoch: 18, Steps: 32 | Train Loss: 15.202 Vali Loss: 215.090 Vali Acc: 0.573 Test Loss: 215.090 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.163269519805908
Epoch: 19, Steps: 32 | Train Loss: 6.196 Vali Loss: 245.859 Vali Acc: 0.534 Test Loss: 245.859 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.804330587387085
Epoch: 20, Steps: 32 | Train Loss: 0.834 Vali Loss: 249.568 Vali Acc: 0.634 Test Loss: 249.568 Test Acc: 0.634
Validation loss decreased (-0.585939 --> -0.631092).  Saving model ...
Epoch: 21 cost time: 8.911362409591675
Epoch: 21, Steps: 32 | Train Loss: 7.255 Vali Loss: 314.012 Vali Acc: 0.565 Test Loss: 314.012 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.868077754974365
Epoch: 22, Steps: 32 | Train Loss: 10.619 Vali Loss: 249.014 Vali Acc: 0.580 Test Loss: 249.014 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.972685813903809
Epoch: 23, Steps: 32 | Train Loss: 3.488 Vali Loss: 287.316 Vali Acc: 0.573 Test Loss: 287.316 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.254091739654541
Epoch: 24, Steps: 32 | Train Loss: 8.799 Vali Loss: 297.451 Vali Acc: 0.580 Test Loss: 297.451 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.795007467269897
Epoch: 25, Steps: 32 | Train Loss: 10.825 Vali Loss: 490.722 Vali Acc: 0.389 Test Loss: 490.722 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.026785373687744
Epoch: 26, Steps: 32 | Train Loss: 0.356 Vali Loss: 351.497 Vali Acc: 0.565 Test Loss: 351.497 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.568743705749512
Epoch: 27, Steps: 32 | Train Loss: 0.065 Vali Loss: 493.602 Vali Acc: 0.458 Test Loss: 493.602 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.842923164367676
Epoch: 28, Steps: 32 | Train Loss: 5.117 Vali Loss: 446.583 Vali Acc: 0.405 Test Loss: 446.583 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.633192777633667
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 450.993 Vali Acc: 0.588 Test Loss: 450.993 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.718672037124634
Epoch: 30, Steps: 32 | Train Loss: 0.473 Vali Loss: 440.571 Vali Acc: 0.527 Test Loss: 440.571 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 24209965
model size : 109.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.916090965270996
Epoch: 1, Steps: 32 | Train Loss: 49.077 Vali Loss: 73.192 Vali Acc: 0.153 Test Loss: 73.192 Test Acc: 0.153
Validation loss decreased (inf --> -0.151940).  Saving model ...
Epoch: 2 cost time: 10.25955843925476
Epoch: 2, Steps: 32 | Train Loss: 41.824 Vali Loss: 28.278 Vali Acc: 0.527 Test Loss: 28.278 Test Acc: 0.527
Validation loss decreased (-0.151940 --> -0.526435).  Saving model ...
Epoch: 3 cost time: 10.317364692687988
Epoch: 3, Steps: 32 | Train Loss: 56.572 Vali Loss: 78.492 Vali Acc: 0.466 Test Loss: 78.492 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.397044658660889
Epoch: 4, Steps: 32 | Train Loss: 52.432 Vali Loss: 68.095 Vali Acc: 0.267 Test Loss: 68.095 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.425216436386108
Epoch: 5, Steps: 32 | Train Loss: 34.917 Vali Loss: 86.291 Vali Acc: 0.489 Test Loss: 86.291 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.396291494369507
Epoch: 6, Steps: 32 | Train Loss: 36.902 Vali Loss: 58.559 Vali Acc: 0.420 Test Loss: 58.559 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 10.764950513839722
Epoch: 7, Steps: 32 | Train Loss: 64.605 Vali Loss: 189.703 Vali Acc: 0.405 Test Loss: 189.703 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 10.779784679412842
Epoch: 8, Steps: 32 | Train Loss: 48.804 Vali Loss: 216.143 Vali Acc: 0.496 Test Loss: 216.143 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 10.349146842956543
Epoch: 9, Steps: 32 | Train Loss: 40.753 Vali Loss: 183.517 Vali Acc: 0.458 Test Loss: 183.517 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 10.612572193145752
Epoch: 10, Steps: 32 | Train Loss: 22.575 Vali Loss: 312.655 Vali Acc: 0.496 Test Loss: 312.655 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 10.363785743713379
Epoch: 11, Steps: 32 | Train Loss: 35.169 Vali Loss: 271.288 Vali Acc: 0.496 Test Loss: 271.288 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 10.708003759384155
Epoch: 12, Steps: 32 | Train Loss: 15.560 Vali Loss: 271.384 Vali Acc: 0.382 Test Loss: 271.384 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 23685677
model size : 107.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.501499652862549
Epoch: 1, Steps: 32 | Train Loss: 49.340 Vali Loss: 40.630 Vali Acc: 0.267 Test Loss: 40.630 Test Acc: 0.267
Validation loss decreased (inf --> -0.266769).  Saving model ...
Epoch: 2 cost time: 9.842314958572388
Epoch: 2, Steps: 32 | Train Loss: 43.811 Vali Loss: 65.126 Vali Acc: 0.229 Test Loss: 65.126 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.586609840393066
Epoch: 3, Steps: 32 | Train Loss: 70.976 Vali Loss: 152.603 Vali Acc: 0.191 Test Loss: 152.603 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.755113363265991
Epoch: 4, Steps: 32 | Train Loss: 66.126 Vali Loss: 90.444 Vali Acc: 0.260 Test Loss: 90.444 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.678370952606201
Epoch: 5, Steps: 32 | Train Loss: 55.629 Vali Loss: 214.138 Vali Acc: 0.305 Test Loss: 214.138 Test Acc: 0.305
Validation loss decreased (-0.266769 --> -0.303202).  Saving model ...
Epoch: 6 cost time: 9.904697895050049
Epoch: 6, Steps: 32 | Train Loss: 42.123 Vali Loss: 237.541 Vali Acc: 0.275 Test Loss: 237.541 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.871424913406372
Epoch: 7, Steps: 32 | Train Loss: 45.432 Vali Loss: 121.262 Vali Acc: 0.466 Test Loss: 121.262 Test Acc: 0.466
Validation loss decreased (-0.303202 --> -0.464436).  Saving model ...
Epoch: 8 cost time: 9.80123257637024
Epoch: 8, Steps: 32 | Train Loss: 28.864 Vali Loss: 151.953 Vali Acc: 0.321 Test Loss: 151.953 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.030311822891235
Epoch: 9, Steps: 32 | Train Loss: 95.559 Vali Loss: 168.657 Vali Acc: 0.244 Test Loss: 168.657 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.772417306900024
Epoch: 10, Steps: 32 | Train Loss: 18.709 Vali Loss: 112.138 Vali Acc: 0.595 Test Loss: 112.138 Test Acc: 0.595
Validation loss decreased (-0.464436 --> -0.594298).  Saving model ...
Epoch: 11 cost time: 9.92305850982666
Epoch: 11, Steps: 32 | Train Loss: 6.792 Vali Loss: 125.718 Vali Acc: 0.573 Test Loss: 125.718 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.904834747314453
Epoch: 12, Steps: 32 | Train Loss: 6.216 Vali Loss: 131.966 Vali Acc: 0.641 Test Loss: 131.966 Test Acc: 0.641
Validation loss decreased (-0.594298 --> -0.639902).  Saving model ...
Epoch: 13 cost time: 9.855632305145264
Epoch: 13, Steps: 32 | Train Loss: 23.261 Vali Loss: 217.274 Vali Acc: 0.611 Test Loss: 217.274 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.852644920349121
Epoch: 14, Steps: 32 | Train Loss: 18.490 Vali Loss: 221.721 Vali Acc: 0.328 Test Loss: 221.721 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.795822381973267
Epoch: 15, Steps: 32 | Train Loss: 11.642 Vali Loss: 229.385 Vali Acc: 0.595 Test Loss: 229.385 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.91930341720581
Epoch: 16, Steps: 32 | Train Loss: 8.592 Vali Loss: 171.491 Vali Acc: 0.603 Test Loss: 171.491 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.619383096694946
Epoch: 17, Steps: 32 | Train Loss: 2.651 Vali Loss: 174.164 Vali Acc: 0.611 Test Loss: 174.164 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.575067520141602
Epoch: 18, Steps: 32 | Train Loss: 3.702 Vali Loss: 181.959 Vali Acc: 0.405 Test Loss: 181.959 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.582168579101562
Epoch: 19, Steps: 32 | Train Loss: 2.034 Vali Loss: 204.759 Vali Acc: 0.573 Test Loss: 204.759 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.608086347579956
Epoch: 20, Steps: 32 | Train Loss: 2.299 Vali Loss: 163.788 Vali Acc: 0.626 Test Loss: 163.788 Test Acc: 0.626
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.808323860168457
Epoch: 21, Steps: 32 | Train Loss: 2.028 Vali Loss: 239.023 Vali Acc: 0.427 Test Loss: 239.023 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.671669960021973
Epoch: 22, Steps: 32 | Train Loss: 10.616 Vali Loss: 343.410 Vali Acc: 0.359 Test Loss: 343.410 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 23685677
model size : 107.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.079877138137817
Epoch: 1, Steps: 32 | Train Loss: 45.120 Vali Loss: 60.371 Vali Acc: 0.427 Test Loss: 60.371 Test Acc: 0.427
Validation loss decreased (inf --> -0.426877).  Saving model ...
Epoch: 2 cost time: 8.616462707519531
Epoch: 2, Steps: 32 | Train Loss: 37.569 Vali Loss: 64.929 Vali Acc: 0.252 Test Loss: 64.929 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.484252452850342
Epoch: 3, Steps: 32 | Train Loss: 80.217 Vali Loss: 77.003 Vali Acc: 0.504 Test Loss: 77.003 Test Acc: 0.504
Validation loss decreased (-0.426877 --> -0.503047).  Saving model ...
Epoch: 4 cost time: 8.788805723190308
Epoch: 4, Steps: 32 | Train Loss: 54.918 Vali Loss: 66.287 Vali Acc: 0.298 Test Loss: 66.287 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.685753583908081
Epoch: 5, Steps: 32 | Train Loss: 70.735 Vali Loss: 91.151 Vali Acc: 0.267 Test Loss: 91.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.86705207824707
Epoch: 6, Steps: 32 | Train Loss: 99.890 Vali Loss: 109.870 Vali Acc: 0.244 Test Loss: 109.870 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.498536586761475
Epoch: 7, Steps: 32 | Train Loss: 82.606 Vali Loss: 86.239 Vali Acc: 0.260 Test Loss: 86.239 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.791219472885132
Epoch: 8, Steps: 32 | Train Loss: 21.992 Vali Loss: 142.109 Vali Acc: 0.366 Test Loss: 142.109 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.5297212600708
Epoch: 9, Steps: 32 | Train Loss: 65.622 Vali Loss: 224.829 Vali Acc: 0.244 Test Loss: 224.829 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.707376956939697
Epoch: 10, Steps: 32 | Train Loss: 36.481 Vali Loss: 277.439 Vali Acc: 0.527 Test Loss: 277.439 Test Acc: 0.527
Validation loss decreased (-0.503047 --> -0.523943).  Saving model ...
Epoch: 11 cost time: 8.617770195007324
Epoch: 11, Steps: 32 | Train Loss: 10.203 Vali Loss: 251.425 Vali Acc: 0.580 Test Loss: 251.425 Test Acc: 0.580
Validation loss decreased (-0.523943 --> -0.577638).  Saving model ...
Epoch: 12 cost time: 8.715039014816284
Epoch: 12, Steps: 32 | Train Loss: 16.777 Vali Loss: 233.242 Vali Acc: 0.496 Test Loss: 233.242 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.559056758880615
Epoch: 13, Steps: 32 | Train Loss: 7.042 Vali Loss: 194.057 Vali Acc: 0.634 Test Loss: 194.057 Test Acc: 0.634
Validation loss decreased (-0.577638 --> -0.631647).  Saving model ...
Epoch: 14 cost time: 8.716985702514648
Epoch: 14, Steps: 32 | Train Loss: 9.329 Vali Loss: 195.290 Vali Acc: 0.534 Test Loss: 195.290 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.565540552139282
Epoch: 15, Steps: 32 | Train Loss: 0.218 Vali Loss: 209.007 Vali Acc: 0.603 Test Loss: 209.007 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.81590223312378
Epoch: 16, Steps: 32 | Train Loss: 0.717 Vali Loss: 189.786 Vali Acc: 0.557 Test Loss: 189.786 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.556326150894165
Epoch: 17, Steps: 32 | Train Loss: 2.311 Vali Loss: 246.664 Vali Acc: 0.573 Test Loss: 246.664 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.885215282440186
Epoch: 18, Steps: 32 | Train Loss: 0.361 Vali Loss: 408.876 Vali Acc: 0.282 Test Loss: 408.876 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.541627645492554
Epoch: 19, Steps: 32 | Train Loss: 8.167 Vali Loss: 251.658 Vali Acc: 0.611 Test Loss: 251.658 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.7784423828125
Epoch: 20, Steps: 32 | Train Loss: 5.146 Vali Loss: 229.165 Vali Acc: 0.450 Test Loss: 229.165 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.586463689804077
Epoch: 21, Steps: 32 | Train Loss: 27.304 Vali Loss: 414.210 Vali Acc: 0.542 Test Loss: 414.210 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.68776798248291
Epoch: 22, Steps: 32 | Train Loss: 8.364 Vali Loss: 237.324 Vali Acc: 0.573 Test Loss: 237.324 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.454258680343628
Epoch: 23, Steps: 32 | Train Loss: 6.952 Vali Loss: 328.784 Vali Acc: 0.595 Test Loss: 328.784 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 23685677
model size : 107.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.635582447052002
Epoch: 1, Steps: 32 | Train Loss: 52.703 Vali Loss: 100.006 Vali Acc: 0.168 Test Loss: 100.006 Test Acc: 0.168
Validation loss decreased (inf --> -0.166939).  Saving model ...
Epoch: 2 cost time: 8.257420301437378
Epoch: 2, Steps: 32 | Train Loss: 64.606 Vali Loss: 44.628 Vali Acc: 0.443 Test Loss: 44.628 Test Acc: 0.443
Validation loss decreased (-0.166939 --> -0.442302).  Saving model ...
Epoch: 3 cost time: 8.122377395629883
Epoch: 3, Steps: 32 | Train Loss: 50.912 Vali Loss: 66.248 Vali Acc: 0.435 Test Loss: 66.248 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.08895206451416
Epoch: 4, Steps: 32 | Train Loss: 72.124 Vali Loss: 36.587 Vali Acc: 0.275 Test Loss: 36.587 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.062248468399048
Epoch: 5, Steps: 32 | Train Loss: 52.705 Vali Loss: 69.804 Vali Acc: 0.191 Test Loss: 69.804 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.98221492767334
Epoch: 6, Steps: 32 | Train Loss: 43.536 Vali Loss: 62.067 Vali Acc: 0.313 Test Loss: 62.067 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.251824617385864
Epoch: 7, Steps: 32 | Train Loss: 62.805 Vali Loss: 62.637 Vali Acc: 0.511 Test Loss: 62.637 Test Acc: 0.511
Validation loss decreased (-0.442302 --> -0.510824).  Saving model ...
Epoch: 8 cost time: 8.147909879684448
Epoch: 8, Steps: 32 | Train Loss: 53.442 Vali Loss: 117.666 Vali Acc: 0.527 Test Loss: 117.666 Test Acc: 0.527
Validation loss decreased (-0.510824 --> -0.525541).  Saving model ...
Epoch: 9 cost time: 8.535661458969116
Epoch: 9, Steps: 32 | Train Loss: 47.808 Vali Loss: 153.347 Vali Acc: 0.260 Test Loss: 153.347 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.518361330032349
Epoch: 10, Steps: 32 | Train Loss: 31.173 Vali Loss: 157.842 Vali Acc: 0.267 Test Loss: 157.842 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.570146083831787
Epoch: 11, Steps: 32 | Train Loss: 11.601 Vali Loss: 100.818 Vali Acc: 0.603 Test Loss: 100.818 Test Acc: 0.603
Validation loss decreased (-0.525541 --> -0.602045).  Saving model ...
Epoch: 12 cost time: 8.621842861175537
Epoch: 12, Steps: 32 | Train Loss: 3.589 Vali Loss: 271.431 Vali Acc: 0.145 Test Loss: 271.431 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.484190464019775
Epoch: 13, Steps: 32 | Train Loss: 1.198 Vali Loss: 207.163 Vali Acc: 0.519 Test Loss: 207.163 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.46523404121399
Epoch: 14, Steps: 32 | Train Loss: 4.720 Vali Loss: 100.888 Vali Acc: 0.511 Test Loss: 100.888 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.546836614608765
Epoch: 15, Steps: 32 | Train Loss: 15.507 Vali Loss: 164.963 Vali Acc: 0.550 Test Loss: 164.963 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 8.628157377243042
Epoch: 16, Steps: 32 | Train Loss: 3.537 Vali Loss: 237.172 Vali Acc: 0.321 Test Loss: 237.172 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 8.535354852676392
Epoch: 17, Steps: 32 | Train Loss: 5.988 Vali Loss: 182.373 Vali Acc: 0.542 Test Loss: 182.373 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 8.722309589385986
Epoch: 18, Steps: 32 | Train Loss: 0.652 Vali Loss: 187.004 Vali Acc: 0.481 Test Loss: 187.004 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 8.387954473495483
Epoch: 19, Steps: 32 | Train Loss: 4.070 Vali Loss: 178.002 Vali Acc: 0.550 Test Loss: 178.002 Test Acc: 0.550
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 8.527508020401001
Epoch: 20, Steps: 32 | Train Loss: 11.014 Vali Loss: 225.040 Vali Acc: 0.481 Test Loss: 225.040 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 8.447509050369263
Epoch: 21, Steps: 32 | Train Loss: 7.963 Vali Loss: 232.936 Vali Acc: 0.366 Test Loss: 232.936 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 23685677
model size : 107.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.283748865127563
Epoch: 1, Steps: 32 | Train Loss: 19.834 Vali Loss: 45.964 Vali Acc: 0.336 Test Loss: 45.964 Test Acc: 0.336
Validation loss decreased (inf --> -0.335418).  Saving model ...
Epoch: 2 cost time: 9.806034088134766
Epoch: 2, Steps: 32 | Train Loss: 46.480 Vali Loss: 42.272 Vali Acc: 0.298 Test Loss: 42.272 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.362097978591919
Epoch: 3, Steps: 32 | Train Loss: 25.325 Vali Loss: 68.174 Vali Acc: 0.489 Test Loss: 68.174 Test Acc: 0.489
Validation loss decreased (-0.335418 --> -0.487868).  Saving model ...
Epoch: 4 cost time: 9.531328916549683
Epoch: 4, Steps: 32 | Train Loss: 72.974 Vali Loss: 91.561 Vali Acc: 0.450 Test Loss: 91.561 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.380136013031006
Epoch: 5, Steps: 32 | Train Loss: 95.839 Vali Loss: 110.295 Vali Acc: 0.473 Test Loss: 110.295 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 9.3641676902771
Epoch: 6, Steps: 32 | Train Loss: 46.423 Vali Loss: 114.708 Vali Acc: 0.489 Test Loss: 114.708 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.502551794052124
Epoch: 7, Steps: 32 | Train Loss: 73.381 Vali Loss: 156.452 Vali Acc: 0.351 Test Loss: 156.452 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.665878772735596
Epoch: 8, Steps: 32 | Train Loss: 40.062 Vali Loss: 125.217 Vali Acc: 0.473 Test Loss: 125.217 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.655213832855225
Epoch: 9, Steps: 32 | Train Loss: 31.522 Vali Loss: 211.251 Vali Acc: 0.229 Test Loss: 211.251 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 9.535303831100464
Epoch: 10, Steps: 32 | Train Loss: 16.421 Vali Loss: 144.526 Vali Acc: 0.527 Test Loss: 144.526 Test Acc: 0.527
Validation loss decreased (-0.487868 --> -0.525272).  Saving model ...
Epoch: 11 cost time: 9.652159690856934
Epoch: 11, Steps: 32 | Train Loss: 8.461 Vali Loss: 146.729 Vali Acc: 0.427 Test Loss: 146.729 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.451005458831787
Epoch: 12, Steps: 32 | Train Loss: 9.372 Vali Loss: 106.727 Vali Acc: 0.565 Test Loss: 106.727 Test Acc: 0.565
Validation loss decreased (-0.525272 --> -0.563818).  Saving model ...
Epoch: 13 cost time: 9.791932582855225
Epoch: 13, Steps: 32 | Train Loss: 15.096 Vali Loss: 267.892 Vali Acc: 0.573 Test Loss: 267.892 Test Acc: 0.573
Validation loss decreased (-0.563818 --> -0.569840).  Saving model ...
Epoch: 14 cost time: 9.572447538375854
Epoch: 14, Steps: 32 | Train Loss: 6.520 Vali Loss: 269.015 Vali Acc: 0.565 Test Loss: 269.015 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.928977012634277
Epoch: 15, Steps: 32 | Train Loss: 6.451 Vali Loss: 275.337 Vali Acc: 0.496 Test Loss: 275.337 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.453133821487427
Epoch: 16, Steps: 32 | Train Loss: 7.722 Vali Loss: 237.638 Vali Acc: 0.573 Test Loss: 237.638 Test Acc: 0.573
Validation loss decreased (-0.569840 --> -0.570143).  Saving model ...
Epoch: 17 cost time: 9.707854747772217
Epoch: 17, Steps: 32 | Train Loss: 7.608 Vali Loss: 314.909 Vali Acc: 0.290 Test Loss: 314.909 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.523039817810059
Epoch: 18, Steps: 32 | Train Loss: 35.196 Vali Loss: 479.926 Vali Acc: 0.550 Test Loss: 479.926 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.767351865768433
Epoch: 19, Steps: 32 | Train Loss: 14.549 Vali Loss: 216.350 Vali Acc: 0.595 Test Loss: 216.350 Test Acc: 0.595
Validation loss decreased (-0.570143 --> -0.593256).  Saving model ...
Epoch: 20 cost time: 9.52634882926941
Epoch: 20, Steps: 32 | Train Loss: 2.344 Vali Loss: 299.450 Vali Acc: 0.542 Test Loss: 299.450 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.651936769485474
Epoch: 21, Steps: 32 | Train Loss: 3.470 Vali Loss: 279.163 Vali Acc: 0.603 Test Loss: 279.163 Test Acc: 0.603
Validation loss decreased (-0.593256 --> -0.600262).  Saving model ...
Epoch: 22 cost time: 9.470999002456665
Epoch: 22, Steps: 32 | Train Loss: 10.528 Vali Loss: 218.570 Vali Acc: 0.656 Test Loss: 218.570 Test Acc: 0.656
Validation loss decreased (-0.600262 --> -0.654303).  Saving model ...
Epoch: 23 cost time: 9.503169775009155
Epoch: 23, Steps: 32 | Train Loss: 24.405 Vali Loss: 425.753 Vali Acc: 0.534 Test Loss: 425.753 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 9.497366905212402
Epoch: 24, Steps: 32 | Train Loss: 1.956 Vali Loss: 515.524 Vali Acc: 0.565 Test Loss: 515.524 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 9.709871530532837
Epoch: 25, Steps: 32 | Train Loss: 4.974 Vali Loss: 336.721 Vali Acc: 0.527 Test Loss: 336.721 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 9.70741891860962
Epoch: 26, Steps: 32 | Train Loss: 2.491 Vali Loss: 287.525 Vali Acc: 0.527 Test Loss: 287.525 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 9.787391185760498
Epoch: 27, Steps: 32 | Train Loss: 0.864 Vali Loss: 470.906 Vali Acc: 0.595 Test Loss: 470.906 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 9.516154766082764
Epoch: 28, Steps: 32 | Train Loss: 24.250 Vali Loss: 352.426 Vali Acc: 0.595 Test Loss: 352.426 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 9.668842077255249
Epoch: 29, Steps: 32 | Train Loss: 6.201 Vali Loss: 354.827 Vali Acc: 0.603 Test Loss: 354.827 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 9.511348247528076
Epoch: 30, Steps: 32 | Train Loss: 7.968 Vali Loss: 272.248 Vali Acc: 0.580 Test Loss: 272.248 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 9.70565938949585
Epoch: 31, Steps: 32 | Train Loss: 2.816 Vali Loss: 410.607 Vali Acc: 0.588 Test Loss: 410.607 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 9.725179195404053
Epoch: 32, Steps: 32 | Train Loss: 2.810 Vali Loss: 331.335 Vali Acc: 0.626 Test Loss: 331.335 Test Acc: 0.626
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 23423533
model size : 106.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.913697242736816
Epoch: 1, Steps: 32 | Train Loss: 18.001 Vali Loss: 57.525 Vali Acc: 0.344 Test Loss: 57.525 Test Acc: 0.344
Validation loss decreased (inf --> -0.342936).  Saving model ...
Epoch: 2 cost time: 9.343358278274536
Epoch: 2, Steps: 32 | Train Loss: 55.708 Vali Loss: 70.802 Vali Acc: 0.260 Test Loss: 70.802 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.479393482208252
Epoch: 3, Steps: 32 | Train Loss: 39.353 Vali Loss: 91.552 Vali Acc: 0.305 Test Loss: 91.552 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.350557327270508
Epoch: 4, Steps: 32 | Train Loss: 50.598 Vali Loss: 144.426 Vali Acc: 0.206 Test Loss: 144.426 Test Acc: 0.206
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 9.773875713348389
Epoch: 5, Steps: 32 | Train Loss: 37.109 Vali Loss: 68.259 Vali Acc: 0.527 Test Loss: 68.259 Test Acc: 0.527
Validation loss decreased (-0.342936 --> -0.526035).  Saving model ...
Epoch: 6 cost time: 9.43472409248352
Epoch: 6, Steps: 32 | Train Loss: 46.255 Vali Loss: 69.643 Vali Acc: 0.458 Test Loss: 69.643 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.40854787826538
Epoch: 7, Steps: 32 | Train Loss: 37.166 Vali Loss: 108.166 Vali Acc: 0.458 Test Loss: 108.166 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.287368774414062
Epoch: 8, Steps: 32 | Train Loss: 30.991 Vali Loss: 173.358 Vali Acc: 0.290 Test Loss: 173.358 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.453097820281982
Epoch: 9, Steps: 32 | Train Loss: 83.139 Vali Loss: 198.708 Vali Acc: 0.221 Test Loss: 198.708 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.347366094589233
Epoch: 10, Steps: 32 | Train Loss: 34.126 Vali Loss: 244.826 Vali Acc: 0.466 Test Loss: 244.826 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.545792579650879
Epoch: 11, Steps: 32 | Train Loss: 53.160 Vali Loss: 146.894 Vali Acc: 0.366 Test Loss: 146.894 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.463301181793213
Epoch: 12, Steps: 32 | Train Loss: 15.821 Vali Loss: 103.731 Vali Acc: 0.573 Test Loss: 103.731 Test Acc: 0.573
Validation loss decreased (-0.526035 --> -0.571482).  Saving model ...
Epoch: 13 cost time: 9.650775909423828
Epoch: 13, Steps: 32 | Train Loss: 9.796 Vali Loss: 143.962 Vali Acc: 0.603 Test Loss: 143.962 Test Acc: 0.603
Validation loss decreased (-0.571482 --> -0.601614).  Saving model ...
Epoch: 14 cost time: 9.311952114105225
Epoch: 14, Steps: 32 | Train Loss: 23.790 Vali Loss: 164.865 Vali Acc: 0.374 Test Loss: 164.865 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.444239854812622
Epoch: 15, Steps: 32 | Train Loss: 5.012 Vali Loss: 177.313 Vali Acc: 0.634 Test Loss: 177.313 Test Acc: 0.634
Validation loss decreased (-0.601614 --> -0.631815).  Saving model ...
Epoch: 16 cost time: 9.412206411361694
Epoch: 16, Steps: 32 | Train Loss: 5.288 Vali Loss: 177.879 Vali Acc: 0.565 Test Loss: 177.879 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.575262069702148
Epoch: 17, Steps: 32 | Train Loss: 7.315 Vali Loss: 165.961 Vali Acc: 0.649 Test Loss: 165.961 Test Acc: 0.649
Validation loss decreased (-0.631815 --> -0.647195).  Saving model ...
Epoch: 18 cost time: 9.669388055801392
Epoch: 18, Steps: 32 | Train Loss: 9.939 Vali Loss: 200.291 Vali Acc: 0.626 Test Loss: 200.291 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.353041648864746
Epoch: 19, Steps: 32 | Train Loss: 5.255 Vali Loss: 226.652 Vali Acc: 0.580 Test Loss: 226.652 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.335990905761719
Epoch: 20, Steps: 32 | Train Loss: 16.937 Vali Loss: 140.194 Vali Acc: 0.603 Test Loss: 140.194 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.273662328720093
Epoch: 21, Steps: 32 | Train Loss: 13.710 Vali Loss: 192.029 Vali Acc: 0.588 Test Loss: 192.029 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.495243310928345
Epoch: 22, Steps: 32 | Train Loss: 0.298 Vali Loss: 200.649 Vali Acc: 0.595 Test Loss: 200.649 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.348387002944946
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 222.344 Vali Acc: 0.588 Test Loss: 222.344 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.474338293075562
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 223.175 Vali Acc: 0.588 Test Loss: 223.175 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.38787579536438
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 223.205 Vali Acc: 0.588 Test Loss: 223.205 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 9.613430261611938
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 223.206 Vali Acc: 0.588 Test Loss: 223.206 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.35926342010498
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 223.206 Vali Acc: 0.588 Test Loss: 223.206 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 23423533
model size : 106.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.186282634735107
Epoch: 1, Steps: 32 | Train Loss: 19.353 Vali Loss: 48.328 Vali Acc: 0.115 Test Loss: 48.328 Test Acc: 0.115
Validation loss decreased (inf --> -0.114021).  Saving model ...
Epoch: 2 cost time: 8.672248363494873
Epoch: 2, Steps: 32 | Train Loss: 65.018 Vali Loss: 52.147 Vali Acc: 0.198 Test Loss: 52.147 Test Acc: 0.198
Validation loss decreased (-0.114021 --> -0.197952).  Saving model ...
Epoch: 3 cost time: 8.740301609039307
Epoch: 3, Steps: 32 | Train Loss: 44.614 Vali Loss: 51.235 Vali Acc: 0.275 Test Loss: 51.235 Test Acc: 0.275
Validation loss decreased (-0.197952 --> -0.274297).  Saving model ...
Epoch: 4 cost time: 8.604737997055054
Epoch: 4, Steps: 32 | Train Loss: 41.788 Vali Loss: 99.876 Vali Acc: 0.313 Test Loss: 99.876 Test Acc: 0.313
Validation loss decreased (-0.274297 --> -0.311978).  Saving model ...
Epoch: 5 cost time: 8.597609519958496
Epoch: 5, Steps: 32 | Train Loss: 80.506 Vali Loss: 155.347 Vali Acc: 0.282 Test Loss: 155.347 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.54186749458313
Epoch: 6, Steps: 32 | Train Loss: 41.183 Vali Loss: 84.280 Vali Acc: 0.511 Test Loss: 84.280 Test Acc: 0.511
Validation loss decreased (-0.311978 --> -0.510608).  Saving model ...
Epoch: 7 cost time: 8.864757537841797
Epoch: 7, Steps: 32 | Train Loss: 32.940 Vali Loss: 111.922 Vali Acc: 0.290 Test Loss: 111.922 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.745065212249756
Epoch: 8, Steps: 32 | Train Loss: 46.833 Vali Loss: 139.139 Vali Acc: 0.198 Test Loss: 139.139 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 8.793762445449829
Epoch: 9, Steps: 32 | Train Loss: 22.742 Vali Loss: 67.328 Vali Acc: 0.603 Test Loss: 67.328 Test Acc: 0.603
Validation loss decreased (-0.510608 --> -0.602380).  Saving model ...
Epoch: 10 cost time: 8.684699773788452
Epoch: 10, Steps: 32 | Train Loss: 12.355 Vali Loss: 97.804 Vali Acc: 0.481 Test Loss: 97.804 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.689540147781372
Epoch: 11, Steps: 32 | Train Loss: 14.831 Vali Loss: 103.224 Vali Acc: 0.550 Test Loss: 103.224 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.697328567504883
Epoch: 12, Steps: 32 | Train Loss: 3.551 Vali Loss: 76.888 Vali Acc: 0.595 Test Loss: 76.888 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.639158487319946
Epoch: 13, Steps: 32 | Train Loss: 13.156 Vali Loss: 176.800 Vali Acc: 0.527 Test Loss: 176.800 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 8.5519859790802
Epoch: 14, Steps: 32 | Train Loss: 53.193 Vali Loss: 91.834 Vali Acc: 0.519 Test Loss: 91.834 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.902925252914429
Epoch: 15, Steps: 32 | Train Loss: 25.232 Vali Loss: 305.781 Vali Acc: 0.481 Test Loss: 305.781 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 8.644577503204346
Epoch: 16, Steps: 32 | Train Loss: 14.719 Vali Loss: 109.328 Vali Acc: 0.565 Test Loss: 109.328 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 8.74619197845459
Epoch: 17, Steps: 32 | Train Loss: 6.742 Vali Loss: 196.998 Vali Acc: 0.573 Test Loss: 196.998 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 8.509381771087646
Epoch: 18, Steps: 32 | Train Loss: 2.035 Vali Loss: 161.735 Vali Acc: 0.580 Test Loss: 161.735 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 8.687652587890625
Epoch: 19, Steps: 32 | Train Loss: 4.888 Vali Loss: 354.281 Vali Acc: 0.290 Test Loss: 354.281 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 23423533
model size : 106.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.651870489120483
Epoch: 1, Steps: 32 | Train Loss: 21.228 Vali Loss: 57.186 Vali Acc: 0.443 Test Loss: 57.186 Test Acc: 0.443
Validation loss decreased (inf --> -0.442176).  Saving model ...
Epoch: 2 cost time: 7.956949949264526
Epoch: 2, Steps: 32 | Train Loss: 96.579 Vali Loss: 156.056 Vali Acc: 0.176 Test Loss: 156.056 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.527082204818726
Epoch: 3, Steps: 32 | Train Loss: 96.580 Vali Loss: 141.221 Vali Acc: 0.191 Test Loss: 141.221 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 8.237659931182861
Epoch: 4, Steps: 32 | Train Loss: 61.275 Vali Loss: 92.057 Vali Acc: 0.122 Test Loss: 92.057 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 8.476259469985962
Epoch: 5, Steps: 32 | Train Loss: 68.171 Vali Loss: 116.153 Vali Acc: 0.435 Test Loss: 116.153 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 8.346713304519653
Epoch: 6, Steps: 32 | Train Loss: 101.794 Vali Loss: 113.287 Vali Acc: 0.489 Test Loss: 113.287 Test Acc: 0.489
Validation loss decreased (-0.442176 --> -0.487417).  Saving model ...
Epoch: 7 cost time: 8.522507905960083
Epoch: 7, Steps: 32 | Train Loss: 44.033 Vali Loss: 70.133 Vali Acc: 0.496 Test Loss: 70.133 Test Acc: 0.496
Validation loss decreased (-0.487417 --> -0.495482).  Saving model ...
Epoch: 8 cost time: 8.413857221603394
Epoch: 8, Steps: 32 | Train Loss: 26.989 Vali Loss: 54.454 Vali Acc: 0.557 Test Loss: 54.454 Test Acc: 0.557
Validation loss decreased (-0.495482 --> -0.556707).  Saving model ...
Epoch: 9 cost time: 8.493530988693237
Epoch: 9, Steps: 32 | Train Loss: 29.225 Vali Loss: 153.032 Vali Acc: 0.237 Test Loss: 153.032 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.100092887878418
Epoch: 10, Steps: 32 | Train Loss: 20.670 Vali Loss: 64.198 Vali Acc: 0.580 Test Loss: 64.198 Test Acc: 0.580
Validation loss decreased (-0.556707 --> -0.579511).  Saving model ...
Epoch: 11 cost time: 8.227379083633423
Epoch: 11, Steps: 32 | Train Loss: 20.049 Vali Loss: 140.829 Vali Acc: 0.534 Test Loss: 140.829 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.147656440734863
Epoch: 12, Steps: 32 | Train Loss: 6.452 Vali Loss: 132.635 Vali Acc: 0.389 Test Loss: 132.635 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.395596981048584
Epoch: 13, Steps: 32 | Train Loss: 9.877 Vali Loss: 130.544 Vali Acc: 0.450 Test Loss: 130.544 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 8.228708505630493
Epoch: 14, Steps: 32 | Train Loss: 7.166 Vali Loss: 157.633 Vali Acc: 0.389 Test Loss: 157.633 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.445878028869629
Epoch: 15, Steps: 32 | Train Loss: 1.453 Vali Loss: 116.278 Vali Acc: 0.618 Test Loss: 116.278 Test Acc: 0.618
Validation loss decreased (-0.579511 --> -0.617158).  Saving model ...
Epoch: 16 cost time: 8.300146102905273
Epoch: 16, Steps: 32 | Train Loss: 6.285 Vali Loss: 136.300 Vali Acc: 0.382 Test Loss: 136.300 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.48404335975647
Epoch: 17, Steps: 32 | Train Loss: 5.666 Vali Loss: 207.775 Vali Acc: 0.374 Test Loss: 207.775 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 8.199121236801147
Epoch: 18, Steps: 32 | Train Loss: 0.501 Vali Loss: 71.154 Vali Acc: 0.595 Test Loss: 71.154 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 8.388597249984741
Epoch: 19, Steps: 32 | Train Loss: 6.537 Vali Loss: 170.268 Vali Acc: 0.366 Test Loss: 170.268 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.169528245925903
Epoch: 20, Steps: 32 | Train Loss: 9.143 Vali Loss: 169.617 Vali Acc: 0.550 Test Loss: 169.617 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 8.422213554382324
Epoch: 21, Steps: 32 | Train Loss: 3.732 Vali Loss: 201.149 Vali Acc: 0.458 Test Loss: 201.149 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 8.254691123962402
Epoch: 22, Steps: 32 | Train Loss: 6.041 Vali Loss: 144.820 Vali Acc: 0.573 Test Loss: 144.820 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.62050986289978
Epoch: 23, Steps: 32 | Train Loss: 35.875 Vali Loss: 325.823 Vali Acc: 0.557 Test Loss: 325.823 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 8.135579586029053
Epoch: 24, Steps: 32 | Train Loss: 5.840 Vali Loss: 389.102 Vali Acc: 0.534 Test Loss: 389.102 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 8.464548587799072
Epoch: 25, Steps: 32 | Train Loss: 30.055 Vali Loss: 254.176 Vali Acc: 0.473 Test Loss: 254.176 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 23423533
model size : 106.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.926220655441284
Epoch: 1, Steps: 32 | Train Loss: 27.069 Vali Loss: 59.558 Vali Acc: 0.435 Test Loss: 59.558 Test Acc: 0.435
Validation loss decreased (inf --> -0.434519).  Saving model ...
Epoch: 2 cost time: 9.777715921401978
Epoch: 2, Steps: 32 | Train Loss: 55.527 Vali Loss: 86.411 Vali Acc: 0.427 Test Loss: 86.411 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.560435771942139
Epoch: 3, Steps: 32 | Train Loss: 57.330 Vali Loss: 90.476 Vali Acc: 0.397 Test Loss: 90.476 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.836922883987427
Epoch: 4, Steps: 32 | Train Loss: 58.403 Vali Loss: 149.838 Vali Acc: 0.489 Test Loss: 149.838 Test Acc: 0.489
Validation loss decreased (-0.434519 --> -0.487051).  Saving model ...
Epoch: 5 cost time: 9.571086406707764
Epoch: 5, Steps: 32 | Train Loss: 30.250 Vali Loss: 113.429 Vali Acc: 0.496 Test Loss: 113.429 Test Acc: 0.496
Validation loss decreased (-0.487051 --> -0.495049).  Saving model ...
Epoch: 6 cost time: 10.01421070098877
Epoch: 6, Steps: 32 | Train Loss: 72.212 Vali Loss: 165.800 Vali Acc: 0.321 Test Loss: 165.800 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.074826955795288
Epoch: 7, Steps: 32 | Train Loss: 96.903 Vali Loss: 214.873 Vali Acc: 0.359 Test Loss: 214.873 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.99142861366272
Epoch: 8, Steps: 32 | Train Loss: 109.383 Vali Loss: 202.758 Vali Acc: 0.267 Test Loss: 202.758 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.201225757598877
Epoch: 9, Steps: 32 | Train Loss: 21.742 Vali Loss: 156.961 Vali Acc: 0.489 Test Loss: 156.961 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.104475975036621
Epoch: 10, Steps: 32 | Train Loss: 50.193 Vali Loss: 119.523 Vali Acc: 0.504 Test Loss: 119.523 Test Acc: 0.504
Validation loss decreased (-0.495049 --> -0.502622).  Saving model ...
Epoch: 11 cost time: 9.835426330566406
Epoch: 11, Steps: 32 | Train Loss: 20.906 Vali Loss: 180.367 Vali Acc: 0.511 Test Loss: 180.367 Test Acc: 0.511
Validation loss decreased (-0.502622 --> -0.509647).  Saving model ...
Epoch: 12 cost time: 10.106611728668213
Epoch: 12, Steps: 32 | Train Loss: 21.379 Vali Loss: 273.764 Vali Acc: 0.351 Test Loss: 273.764 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.171029090881348
Epoch: 13, Steps: 32 | Train Loss: 45.034 Vali Loss: 162.089 Vali Acc: 0.542 Test Loss: 162.089 Test Acc: 0.542
Validation loss decreased (-0.509647 --> -0.540364).  Saving model ...
Epoch: 14 cost time: 10.172881126403809
Epoch: 14, Steps: 32 | Train Loss: 32.988 Vali Loss: 252.965 Vali Acc: 0.511 Test Loss: 252.965 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 10.048041343688965
Epoch: 15, Steps: 32 | Train Loss: 10.431 Vali Loss: 285.226 Vali Acc: 0.565 Test Loss: 285.226 Test Acc: 0.565
Validation loss decreased (-0.540364 --> -0.562033).  Saving model ...
Epoch: 16 cost time: 9.963765859603882
Epoch: 16, Steps: 32 | Train Loss: 7.514 Vali Loss: 323.098 Vali Acc: 0.588 Test Loss: 323.098 Test Acc: 0.588
Validation loss decreased (-0.562033 --> -0.584555).  Saving model ...
Epoch: 17 cost time: 9.993383884429932
Epoch: 17, Steps: 32 | Train Loss: 5.736 Vali Loss: 311.211 Vali Acc: 0.573 Test Loss: 311.211 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.790814876556396
Epoch: 18, Steps: 32 | Train Loss: 0.828 Vali Loss: 359.259 Vali Acc: 0.565 Test Loss: 359.259 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 10.010610342025757
Epoch: 19, Steps: 32 | Train Loss: 7.749 Vali Loss: 209.142 Vali Acc: 0.595 Test Loss: 209.142 Test Acc: 0.595
Validation loss decreased (-0.584555 --> -0.593328).  Saving model ...
Epoch: 20 cost time: 9.962680339813232
Epoch: 20, Steps: 32 | Train Loss: 0.411 Vali Loss: 282.741 Vali Acc: 0.534 Test Loss: 282.741 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.841814279556274
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.506 Vali Acc: 0.527 Test Loss: 287.506 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 10.13679838180542
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.680 Vali Acc: 0.527 Test Loss: 287.680 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.797686100006104
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 9.878360986709595
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 10.036841630935669
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 9.849714279174805
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 10.027153015136719
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 9.870070219039917
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 9.794315814971924
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 287.686 Vali Acc: 0.527 Test Loss: 287.686 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 23292461
model size : 106.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.328979015350342
Epoch: 1, Steps: 32 | Train Loss: 30.453 Vali Loss: 61.893 Vali Acc: 0.122 Test Loss: 61.893 Test Acc: 0.122
Validation loss decreased (inf --> -0.121518).  Saving model ...
Epoch: 2 cost time: 9.296093463897705
Epoch: 2, Steps: 32 | Train Loss: 56.623 Vali Loss: 47.865 Vali Acc: 0.481 Test Loss: 47.865 Test Acc: 0.481
Validation loss decreased (-0.121518 --> -0.480437).  Saving model ...
Epoch: 3 cost time: 9.126997947692871
Epoch: 3, Steps: 32 | Train Loss: 52.020 Vali Loss: 106.332 Vali Acc: 0.198 Test Loss: 106.332 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.075165271759033
Epoch: 4, Steps: 32 | Train Loss: 48.958 Vali Loss: 48.567 Vali Acc: 0.527 Test Loss: 48.567 Test Acc: 0.527
Validation loss decreased (-0.480437 --> -0.526232).  Saving model ...
Epoch: 5 cost time: 9.26859736442566
Epoch: 5, Steps: 32 | Train Loss: 46.048 Vali Loss: 133.897 Vali Acc: 0.359 Test Loss: 133.897 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.910926580429077
Epoch: 6, Steps: 32 | Train Loss: 41.559 Vali Loss: 230.115 Vali Acc: 0.267 Test Loss: 230.115 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 9.368772983551025
Epoch: 7, Steps: 32 | Train Loss: 98.344 Vali Loss: 161.807 Vali Acc: 0.221 Test Loss: 161.807 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.164685249328613
Epoch: 8, Steps: 32 | Train Loss: 73.094 Vali Loss: 177.085 Vali Acc: 0.282 Test Loss: 177.085 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 9.122189998626709
Epoch: 9, Steps: 32 | Train Loss: 57.237 Vali Loss: 245.626 Vali Acc: 0.328 Test Loss: 245.626 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.95958685874939
Epoch: 10, Steps: 32 | Train Loss: 51.804 Vali Loss: 134.184 Vali Acc: 0.496 Test Loss: 134.184 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 9.158889770507812
Epoch: 11, Steps: 32 | Train Loss: 19.186 Vali Loss: 258.933 Vali Acc: 0.519 Test Loss: 258.933 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 9.235212802886963
Epoch: 12, Steps: 32 | Train Loss: 3.226 Vali Loss: 254.002 Vali Acc: 0.427 Test Loss: 254.002 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 8.988174438476562
Epoch: 13, Steps: 32 | Train Loss: 14.989 Vali Loss: 325.849 Vali Acc: 0.550 Test Loss: 325.849 Test Acc: 0.550
Validation loss decreased (-0.526232 --> -0.546360).  Saving model ...
Epoch: 14 cost time: 9.379992008209229
Epoch: 14, Steps: 32 | Train Loss: 11.941 Vali Loss: 211.150 Vali Acc: 0.412 Test Loss: 211.150 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.950595378875732
Epoch: 15, Steps: 32 | Train Loss: 17.854 Vali Loss: 226.733 Vali Acc: 0.595 Test Loss: 226.733 Test Acc: 0.595
Validation loss decreased (-0.546360 --> -0.593153).  Saving model ...
Epoch: 16 cost time: 9.186312913894653
Epoch: 16, Steps: 32 | Train Loss: 9.019 Vali Loss: 218.579 Vali Acc: 0.382 Test Loss: 218.579 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.05310344696045
Epoch: 17, Steps: 32 | Train Loss: 11.246 Vali Loss: 286.332 Vali Acc: 0.595 Test Loss: 286.332 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 9.076313018798828
Epoch: 18, Steps: 32 | Train Loss: 17.445 Vali Loss: 197.437 Vali Acc: 0.580 Test Loss: 197.437 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 9.25364875793457
Epoch: 19, Steps: 32 | Train Loss: 2.719 Vali Loss: 214.483 Vali Acc: 0.595 Test Loss: 214.483 Test Acc: 0.595
Validation loss decreased (-0.593153 --> -0.593275).  Saving model ...
Epoch: 20 cost time: 9.07300615310669
Epoch: 20, Steps: 32 | Train Loss: 0.338 Vali Loss: 209.904 Vali Acc: 0.588 Test Loss: 209.904 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.184903144836426
Epoch: 21, Steps: 32 | Train Loss: 2.497 Vali Loss: 152.330 Vali Acc: 0.603 Test Loss: 152.330 Test Acc: 0.603
Validation loss decreased (-0.593275 --> -0.601530).  Saving model ...
Epoch: 22 cost time: 9.044835567474365
Epoch: 22, Steps: 32 | Train Loss: 4.729 Vali Loss: 213.795 Vali Acc: 0.481 Test Loss: 213.795 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 9.149138927459717
Epoch: 23, Steps: 32 | Train Loss: 26.532 Vali Loss: 445.041 Vali Acc: 0.496 Test Loss: 445.041 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 9.118871688842773
Epoch: 24, Steps: 32 | Train Loss: 8.207 Vali Loss: 312.290 Vali Acc: 0.427 Test Loss: 312.290 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.924029350280762
Epoch: 25, Steps: 32 | Train Loss: 5.275 Vali Loss: 193.723 Vali Acc: 0.603 Test Loss: 193.723 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 9.297062635421753
Epoch: 26, Steps: 32 | Train Loss: 26.820 Vali Loss: 383.878 Vali Acc: 0.435 Test Loss: 383.878 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 9.083545446395874
Epoch: 27, Steps: 32 | Train Loss: 0.720 Vali Loss: 319.457 Vali Acc: 0.588 Test Loss: 319.457 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 9.433577060699463
Epoch: 28, Steps: 32 | Train Loss: 5.557 Vali Loss: 414.266 Vali Acc: 0.550 Test Loss: 414.266 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.028675079345703
Epoch: 29, Steps: 32 | Train Loss: 5.126 Vali Loss: 381.471 Vali Acc: 0.565 Test Loss: 381.471 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.200973749160767
Epoch: 30, Steps: 32 | Train Loss: 0.724 Vali Loss: 394.300 Vali Acc: 0.527 Test Loss: 394.300 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.170669078826904
Epoch: 31, Steps: 32 | Train Loss: 29.355 Vali Loss: 318.561 Vali Acc: 0.420 Test Loss: 318.561 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 23292461
model size : 106.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.977017641067505
Epoch: 1, Steps: 32 | Train Loss: 24.277 Vali Loss: 70.174 Vali Acc: 0.137 Test Loss: 70.174 Test Acc: 0.137
Validation loss decreased (inf --> -0.136703).  Saving model ...
Epoch: 2 cost time: 8.112524509429932
Epoch: 2, Steps: 32 | Train Loss: 50.734 Vali Loss: 49.084 Vali Acc: 0.519 Test Loss: 49.084 Test Acc: 0.519
Validation loss decreased (-0.136703 --> -0.518593).  Saving model ...
Epoch: 3 cost time: 8.35028886795044
Epoch: 3, Steps: 32 | Train Loss: 55.611 Vali Loss: 74.106 Vali Acc: 0.519 Test Loss: 74.106 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.185053825378418
Epoch: 4, Steps: 32 | Train Loss: 79.065 Vali Loss: 58.572 Vali Acc: 0.519 Test Loss: 58.572 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 8.484779596328735
Epoch: 5, Steps: 32 | Train Loss: 49.167 Vali Loss: 83.617 Vali Acc: 0.328 Test Loss: 83.617 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.141858577728271
Epoch: 6, Steps: 32 | Train Loss: 73.555 Vali Loss: 110.917 Vali Acc: 0.374 Test Loss: 110.917 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 8.643213033676147
Epoch: 7, Steps: 32 | Train Loss: 74.679 Vali Loss: 97.414 Vali Acc: 0.496 Test Loss: 97.414 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.318407535552979
Epoch: 8, Steps: 32 | Train Loss: 38.702 Vali Loss: 102.023 Vali Acc: 0.397 Test Loss: 102.023 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.405692100524902
Epoch: 9, Steps: 32 | Train Loss: 45.224 Vali Loss: 136.887 Vali Acc: 0.565 Test Loss: 136.887 Test Acc: 0.565
Validation loss decreased (-0.518593 --> -0.563517).  Saving model ...
Epoch: 10 cost time: 8.19987964630127
Epoch: 10, Steps: 32 | Train Loss: 55.545 Vali Loss: 71.086 Vali Acc: 0.580 Test Loss: 71.086 Test Acc: 0.580
Validation loss decreased (-0.563517 --> -0.579442).  Saving model ...
Epoch: 11 cost time: 8.522292137145996
Epoch: 11, Steps: 32 | Train Loss: 14.444 Vali Loss: 120.271 Vali Acc: 0.573 Test Loss: 120.271 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.19672966003418
Epoch: 12, Steps: 32 | Train Loss: 22.438 Vali Loss: 271.486 Vali Acc: 0.260 Test Loss: 271.486 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 8.54081106185913
Epoch: 13, Steps: 32 | Train Loss: 30.202 Vali Loss: 132.158 Vali Acc: 0.618 Test Loss: 132.158 Test Acc: 0.618
Validation loss decreased (-0.579442 --> -0.616999).  Saving model ...
Epoch: 14 cost time: 8.283194780349731
Epoch: 14, Steps: 32 | Train Loss: 8.181 Vali Loss: 196.074 Vali Acc: 0.389 Test Loss: 196.074 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.419356107711792
Epoch: 15, Steps: 32 | Train Loss: 34.309 Vali Loss: 223.101 Vali Acc: 0.603 Test Loss: 223.101 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.266494274139404
Epoch: 16, Steps: 32 | Train Loss: 12.634 Vali Loss: 223.079 Vali Acc: 0.573 Test Loss: 223.079 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.352600812911987
Epoch: 17, Steps: 32 | Train Loss: 10.861 Vali Loss: 220.716 Vali Acc: 0.580 Test Loss: 220.716 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 8.321118593215942
Epoch: 18, Steps: 32 | Train Loss: 0.829 Vali Loss: 164.666 Vali Acc: 0.611 Test Loss: 164.666 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.65124249458313
Epoch: 19, Steps: 32 | Train Loss: 0.369 Vali Loss: 145.582 Vali Acc: 0.603 Test Loss: 145.582 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.42369031906128
Epoch: 20, Steps: 32 | Train Loss: 3.444 Vali Loss: 143.453 Vali Acc: 0.527 Test Loss: 143.453 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.394650936126709
Epoch: 21, Steps: 32 | Train Loss: 0.312 Vali Loss: 333.560 Vali Acc: 0.542 Test Loss: 333.560 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 8.226343393325806
Epoch: 22, Steps: 32 | Train Loss: 12.974 Vali Loss: 170.439 Vali Acc: 0.603 Test Loss: 170.439 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.472388505935669
Epoch: 23, Steps: 32 | Train Loss: 0.590 Vali Loss: 164.370 Vali Acc: 0.588 Test Loss: 164.370 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 23292461
model size : 106.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.532358407974243
Epoch: 1, Steps: 32 | Train Loss: 28.598 Vali Loss: 72.484 Vali Acc: 0.130 Test Loss: 72.484 Test Acc: 0.130
Validation loss decreased (inf --> -0.129046).  Saving model ...
Epoch: 2 cost time: 7.902217149734497
Epoch: 2, Steps: 32 | Train Loss: 55.221 Vali Loss: 64.899 Vali Acc: 0.244 Test Loss: 64.899 Test Acc: 0.244
Validation loss decreased (-0.129046 --> -0.243626).  Saving model ...
Epoch: 3 cost time: 7.698035001754761
Epoch: 3, Steps: 32 | Train Loss: 42.755 Vali Loss: 61.311 Vali Acc: 0.183 Test Loss: 61.311 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.900656461715698
Epoch: 4, Steps: 32 | Train Loss: 82.531 Vali Loss: 78.947 Vali Acc: 0.244 Test Loss: 78.947 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.688530445098877
Epoch: 5, Steps: 32 | Train Loss: 66.624 Vali Loss: 97.555 Vali Acc: 0.366 Test Loss: 97.555 Test Acc: 0.366
Validation loss decreased (-0.243626 --> -0.365437).  Saving model ...
Epoch: 6 cost time: 8.014976501464844
Epoch: 6, Steps: 32 | Train Loss: 73.142 Vali Loss: 82.142 Vali Acc: 0.359 Test Loss: 82.142 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.678877592086792
Epoch: 7, Steps: 32 | Train Loss: 84.761 Vali Loss: 162.237 Vali Acc: 0.458 Test Loss: 162.237 Test Acc: 0.458
Validation loss decreased (-0.365437 --> -0.456393).  Saving model ...
Epoch: 8 cost time: 8.197074174880981
Epoch: 8, Steps: 32 | Train Loss: 45.908 Vali Loss: 83.219 Vali Acc: 0.481 Test Loss: 83.219 Test Acc: 0.481
Validation loss decreased (-0.456393 --> -0.480084).  Saving model ...
Epoch: 9 cost time: 7.858805179595947
Epoch: 9, Steps: 32 | Train Loss: 39.140 Vali Loss: 273.840 Vali Acc: 0.198 Test Loss: 273.840 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.8947062492370605
Epoch: 10, Steps: 32 | Train Loss: 40.319 Vali Loss: 113.903 Vali Acc: 0.328 Test Loss: 113.903 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.84304666519165
Epoch: 11, Steps: 32 | Train Loss: 35.640 Vali Loss: 92.473 Vali Acc: 0.496 Test Loss: 92.473 Test Acc: 0.496
Validation loss decreased (-0.480084 --> -0.495258).  Saving model ...
Epoch: 12 cost time: 7.94326376914978
Epoch: 12, Steps: 32 | Train Loss: 8.866 Vali Loss: 97.360 Vali Acc: 0.573 Test Loss: 97.360 Test Acc: 0.573
Validation loss decreased (-0.495258 --> -0.571545).  Saving model ...
Epoch: 13 cost time: 7.767155170440674
Epoch: 13, Steps: 32 | Train Loss: 2.593 Vali Loss: 94.551 Vali Acc: 0.580 Test Loss: 94.551 Test Acc: 0.580
Validation loss decreased (-0.571545 --> -0.579207).  Saving model ...
Epoch: 14 cost time: 8.185048580169678
Epoch: 14, Steps: 32 | Train Loss: 1.312 Vali Loss: 81.909 Vali Acc: 0.603 Test Loss: 81.909 Test Acc: 0.603
Validation loss decreased (-0.579207 --> -0.602234).  Saving model ...
Epoch: 15 cost time: 7.800269842147827
Epoch: 15, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.515 Vali Acc: 0.595 Test Loss: 88.515 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.908663511276245
Epoch: 16, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.804 Vali Acc: 0.595 Test Loss: 88.804 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.726297616958618
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.814 Vali Acc: 0.595 Test Loss: 88.814 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.973756790161133
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.815 Vali Acc: 0.595 Test Loss: 88.815 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.76369571685791
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.815 Vali Acc: 0.595 Test Loss: 88.815 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.118743419647217
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.815 Vali Acc: 0.595 Test Loss: 88.815 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.882702589035034
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.815 Vali Acc: 0.595 Test Loss: 88.815 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.963818550109863
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.808 Vali Acc: 0.595 Test Loss: 88.808 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.10267186164856
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.807 Vali Acc: 0.595 Test Loss: 88.807 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 7.798410892486572
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 88.802 Vali Acc: 0.595 Test Loss: 88.802 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 23292461
model size : 106.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.32618260383606
Epoch: 1, Steps: 32 | Train Loss: 39.003 Vali Loss: 38.045 Vali Acc: 0.481 Test Loss: 38.045 Test Acc: 0.481
Validation loss decreased (inf --> -0.480536).  Saving model ...
Epoch: 2 cost time: 9.918017387390137
Epoch: 2, Steps: 32 | Train Loss: 77.868 Vali Loss: 130.001 Vali Acc: 0.237 Test Loss: 130.001 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.257094860076904
Epoch: 3, Steps: 32 | Train Loss: 83.262 Vali Loss: 34.368 Vali Acc: 0.450 Test Loss: 34.368 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 10.028434991836548
Epoch: 4, Steps: 32 | Train Loss: 81.676 Vali Loss: 137.574 Vali Acc: 0.450 Test Loss: 137.574 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.083954572677612
Epoch: 5, Steps: 32 | Train Loss: 72.481 Vali Loss: 125.822 Vali Acc: 0.489 Test Loss: 125.822 Test Acc: 0.489
Validation loss decreased (-0.480536 --> -0.487291).  Saving model ...
Epoch: 6 cost time: 10.115610361099243
Epoch: 6, Steps: 32 | Train Loss: 43.464 Vali Loss: 75.893 Vali Acc: 0.443 Test Loss: 75.893 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.905810832977295
Epoch: 7, Steps: 32 | Train Loss: 73.196 Vali Loss: 377.941 Vali Acc: 0.145 Test Loss: 377.941 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 10.249940156936646
Epoch: 8, Steps: 32 | Train Loss: 138.568 Vali Loss: 290.930 Vali Acc: 0.496 Test Loss: 290.930 Test Acc: 0.496
Validation loss decreased (-0.487291 --> -0.493274).  Saving model ...
Epoch: 9 cost time: 9.896289110183716
Epoch: 9, Steps: 32 | Train Loss: 94.090 Vali Loss: 159.499 Vali Acc: 0.344 Test Loss: 159.499 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.20059609413147
Epoch: 10, Steps: 32 | Train Loss: 23.802 Vali Loss: 192.020 Vali Acc: 0.321 Test Loss: 192.020 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 10.102941989898682
Epoch: 11, Steps: 32 | Train Loss: 25.506 Vali Loss: 192.469 Vali Acc: 0.542 Test Loss: 192.469 Test Acc: 0.542
Validation loss decreased (-0.493274 --> -0.540060).  Saving model ...
Epoch: 12 cost time: 10.038934230804443
Epoch: 12, Steps: 32 | Train Loss: 15.254 Vali Loss: 177.623 Vali Acc: 0.588 Test Loss: 177.623 Test Acc: 0.588
Validation loss decreased (-0.540060 --> -0.586010).  Saving model ...
Epoch: 13 cost time: 10.30337905883789
Epoch: 13, Steps: 32 | Train Loss: 9.749 Vali Loss: 172.864 Vali Acc: 0.389 Test Loss: 172.864 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.954943180084229
Epoch: 14, Steps: 32 | Train Loss: 33.922 Vali Loss: 254.690 Vali Acc: 0.344 Test Loss: 254.690 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.177109956741333
Epoch: 15, Steps: 32 | Train Loss: 3.684 Vali Loss: 196.889 Vali Acc: 0.542 Test Loss: 196.889 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.02490234375
Epoch: 16, Steps: 32 | Train Loss: 15.149 Vali Loss: 362.563 Vali Acc: 0.511 Test Loss: 362.563 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.055108070373535
Epoch: 17, Steps: 32 | Train Loss: 35.367 Vali Loss: 277.593 Vali Acc: 0.473 Test Loss: 277.593 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.060383319854736
Epoch: 18, Steps: 32 | Train Loss: 18.446 Vali Loss: 419.687 Vali Acc: 0.534 Test Loss: 419.687 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.887629985809326
Epoch: 19, Steps: 32 | Train Loss: 60.163 Vali Loss: 259.519 Vali Acc: 0.588 Test Loss: 259.519 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.368706226348877
Epoch: 20, Steps: 32 | Train Loss: 11.414 Vali Loss: 215.244 Vali Acc: 0.595 Test Loss: 215.244 Test Acc: 0.595
Validation loss decreased (-0.586010 --> -0.593267).  Saving model ...
Epoch: 21 cost time: 10.0066237449646
Epoch: 21, Steps: 32 | Train Loss: 4.914 Vali Loss: 402.493 Vali Acc: 0.565 Test Loss: 402.493 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.164568185806274
Epoch: 22, Steps: 32 | Train Loss: 0.551 Vali Loss: 313.941 Vali Acc: 0.527 Test Loss: 313.941 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.108895301818848
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.400 Vali Acc: 0.527 Test Loss: 328.400 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.036439895629883
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.932 Vali Acc: 0.527 Test Loss: 328.932 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.248233795166016
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 9.922147512435913
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.193371534347534
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.9960298538208
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 9.98347783088684
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.101125478744507
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 328.952 Vali Acc: 0.527 Test Loss: 328.952 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 23226925
model size : 106.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.065089225769043
Epoch: 1, Steps: 32 | Train Loss: 28.242 Vali Loss: 41.903 Vali Acc: 0.221 Test Loss: 41.903 Test Acc: 0.221
Validation loss decreased (inf --> -0.220955).  Saving model ...
Epoch: 2 cost time: 9.141849040985107
Epoch: 2, Steps: 32 | Train Loss: 63.124 Vali Loss: 47.877 Vali Acc: 0.481 Test Loss: 47.877 Test Acc: 0.481
Validation loss decreased (-0.220955 --> -0.480437).  Saving model ...
Epoch: 3 cost time: 9.411188125610352
Epoch: 3, Steps: 32 | Train Loss: 63.594 Vali Loss: 110.170 Vali Acc: 0.229 Test Loss: 110.170 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.138030767440796
Epoch: 4, Steps: 32 | Train Loss: 88.082 Vali Loss: 74.100 Vali Acc: 0.214 Test Loss: 74.100 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.471772193908691
Epoch: 5, Steps: 32 | Train Loss: 85.791 Vali Loss: 91.286 Vali Acc: 0.435 Test Loss: 91.286 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 9.381202459335327
Epoch: 6, Steps: 32 | Train Loss: 56.244 Vali Loss: 191.384 Vali Acc: 0.519 Test Loss: 191.384 Test Acc: 0.519
Validation loss decreased (-0.480437 --> -0.517170).  Saving model ...
Epoch: 7 cost time: 9.373909950256348
Epoch: 7, Steps: 32 | Train Loss: 96.196 Vali Loss: 280.076 Vali Acc: 0.427 Test Loss: 280.076 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.450530767440796
Epoch: 8, Steps: 32 | Train Loss: 61.634 Vali Loss: 136.417 Vali Acc: 0.542 Test Loss: 136.417 Test Acc: 0.542
Validation loss decreased (-0.517170 --> -0.540621).  Saving model ...
Epoch: 9 cost time: 9.124766111373901
Epoch: 9, Steps: 32 | Train Loss: 28.315 Vali Loss: 241.362 Vali Acc: 0.267 Test Loss: 241.362 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.390650987625122
Epoch: 10, Steps: 32 | Train Loss: 18.446 Vali Loss: 115.935 Vali Acc: 0.626 Test Loss: 115.935 Test Acc: 0.626
Validation loss decreased (-0.540621 --> -0.624795).  Saving model ...
Epoch: 11 cost time: 9.267078876495361
Epoch: 11, Steps: 32 | Train Loss: 13.869 Vali Loss: 128.817 Vali Acc: 0.618 Test Loss: 128.817 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.56065034866333
Epoch: 12, Steps: 32 | Train Loss: 9.042 Vali Loss: 181.134 Vali Acc: 0.565 Test Loss: 181.134 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.334091186523438
Epoch: 13, Steps: 32 | Train Loss: 43.379 Vali Loss: 234.536 Vali Acc: 0.588 Test Loss: 234.536 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.489442825317383
Epoch: 14, Steps: 32 | Train Loss: 42.501 Vali Loss: 187.271 Vali Acc: 0.603 Test Loss: 187.271 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 9.431113243103027
Epoch: 15, Steps: 32 | Train Loss: 14.061 Vali Loss: 161.033 Vali Acc: 0.573 Test Loss: 161.033 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.377826929092407
Epoch: 16, Steps: 32 | Train Loss: 13.442 Vali Loss: 209.339 Vali Acc: 0.618 Test Loss: 209.339 Test Acc: 0.618
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.514981985092163
Epoch: 17, Steps: 32 | Train Loss: 8.690 Vali Loss: 279.227 Vali Acc: 0.534 Test Loss: 279.227 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 9.267839670181274
Epoch: 18, Steps: 32 | Train Loss: 10.547 Vali Loss: 239.847 Vali Acc: 0.595 Test Loss: 239.847 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.464575290679932
Epoch: 19, Steps: 32 | Train Loss: 1.645 Vali Loss: 292.971 Vali Acc: 0.557 Test Loss: 292.971 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 9.684627771377563
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 297.710 Vali Acc: 0.557 Test Loss: 297.710 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 23226925
model size : 106.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.08623456954956
Epoch: 1, Steps: 32 | Train Loss: 31.418 Vali Loss: 47.608 Vali Acc: 0.099 Test Loss: 47.608 Test Acc: 0.099
Validation loss decreased (inf --> -0.098761).  Saving model ...
Epoch: 2 cost time: 8.538239479064941
Epoch: 2, Steps: 32 | Train Loss: 38.065 Vali Loss: 73.846 Vali Acc: 0.198 Test Loss: 73.846 Test Acc: 0.198
Validation loss decreased (-0.098761 --> -0.197735).  Saving model ...
Epoch: 3 cost time: 8.474263668060303
Epoch: 3, Steps: 32 | Train Loss: 46.168 Vali Loss: 46.715 Vali Acc: 0.282 Test Loss: 46.715 Test Acc: 0.282
Validation loss decreased (-0.197735 --> -0.281976).  Saving model ...
Epoch: 4 cost time: 8.788764238357544
Epoch: 4, Steps: 32 | Train Loss: 64.972 Vali Loss: 75.492 Vali Acc: 0.466 Test Loss: 75.492 Test Acc: 0.466
Validation loss decreased (-0.281976 --> -0.464894).  Saving model ...
Epoch: 5 cost time: 8.780705690383911
Epoch: 5, Steps: 32 | Train Loss: 59.335 Vali Loss: 58.307 Vali Acc: 0.305 Test Loss: 58.307 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 8.922972679138184
Epoch: 6, Steps: 32 | Train Loss: 96.825 Vali Loss: 88.072 Vali Acc: 0.221 Test Loss: 88.072 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 8.914103507995605
Epoch: 7, Steps: 32 | Train Loss: 65.028 Vali Loss: 149.279 Vali Acc: 0.313 Test Loss: 149.279 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 9.001796007156372
Epoch: 8, Steps: 32 | Train Loss: 109.733 Vali Loss: 215.479 Vali Acc: 0.435 Test Loss: 215.479 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 8.743550062179565
Epoch: 9, Steps: 32 | Train Loss: 78.711 Vali Loss: 131.545 Vali Acc: 0.321 Test Loss: 131.545 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 8.776848793029785
Epoch: 10, Steps: 32 | Train Loss: 13.112 Vali Loss: 247.153 Vali Acc: 0.550 Test Loss: 247.153 Test Acc: 0.550
Validation loss decreased (-0.464894 --> -0.547147).  Saving model ...
Epoch: 11 cost time: 8.993932962417603
Epoch: 11, Steps: 32 | Train Loss: 41.088 Vali Loss: 214.242 Vali Acc: 0.595 Test Loss: 214.242 Test Acc: 0.595
Validation loss decreased (-0.547147 --> -0.593277).  Saving model ...
Epoch: 12 cost time: 8.868828535079956
Epoch: 12, Steps: 32 | Train Loss: 20.322 Vali Loss: 179.635 Vali Acc: 0.550 Test Loss: 179.635 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.758219718933105
Epoch: 13, Steps: 32 | Train Loss: 13.318 Vali Loss: 177.201 Vali Acc: 0.519 Test Loss: 177.201 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.913134336471558
Epoch: 14, Steps: 32 | Train Loss: 7.069 Vali Loss: 201.221 Vali Acc: 0.595 Test Loss: 201.221 Test Acc: 0.595
Validation loss decreased (-0.593277 --> -0.593408).  Saving model ...
Epoch: 15 cost time: 9.334015369415283
Epoch: 15, Steps: 32 | Train Loss: 4.556 Vali Loss: 152.902 Vali Acc: 0.527 Test Loss: 152.902 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.055282831192017
Epoch: 16, Steps: 32 | Train Loss: 1.841 Vali Loss: 229.402 Vali Acc: 0.580 Test Loss: 229.402 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 8.84228229522705
Epoch: 17, Steps: 32 | Train Loss: 3.638 Vali Loss: 253.726 Vali Acc: 0.634 Test Loss: 253.726 Test Acc: 0.634
Validation loss decreased (-0.593408 --> -0.631051).  Saving model ...
Epoch: 18 cost time: 8.923659801483154
Epoch: 18, Steps: 32 | Train Loss: 8.776 Vali Loss: 279.506 Vali Acc: 0.626 Test Loss: 279.506 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.981584548950195
Epoch: 19, Steps: 32 | Train Loss: 0.706 Vali Loss: 262.763 Vali Acc: 0.557 Test Loss: 262.763 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.738447427749634
Epoch: 20, Steps: 32 | Train Loss: 4.429 Vali Loss: 263.756 Vali Acc: 0.626 Test Loss: 263.756 Test Acc: 0.626
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.85359501838684
Epoch: 21, Steps: 32 | Train Loss: 0.465 Vali Loss: 285.766 Vali Acc: 0.649 Test Loss: 285.766 Test Acc: 0.649
Validation loss decreased (-0.631051 --> -0.645997).  Saving model ...
Epoch: 22 cost time: 8.8442063331604
Epoch: 22, Steps: 32 | Train Loss: 2.855 Vali Loss: 275.182 Vali Acc: 0.641 Test Loss: 275.182 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 8.919434070587158
Epoch: 23, Steps: 32 | Train Loss: 0.401 Vali Loss: 314.161 Vali Acc: 0.573 Test Loss: 314.161 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 8.960023403167725
Epoch: 24, Steps: 32 | Train Loss: 27.699 Vali Loss: 652.760 Vali Acc: 0.351 Test Loss: 652.760 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 8.955671072006226
Epoch: 25, Steps: 32 | Train Loss: 39.789 Vali Loss: 525.753 Vali Acc: 0.466 Test Loss: 525.753 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 8.77439546585083
Epoch: 26, Steps: 32 | Train Loss: 1.032 Vali Loss: 471.747 Vali Acc: 0.580 Test Loss: 471.747 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 8.88062858581543
Epoch: 27, Steps: 32 | Train Loss: 1.580 Vali Loss: 384.615 Vali Acc: 0.595 Test Loss: 384.615 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 8.943164587020874
Epoch: 28, Steps: 32 | Train Loss: 11.021 Vali Loss: 391.025 Vali Acc: 0.618 Test Loss: 391.025 Test Acc: 0.618
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 9.01640009880066
Epoch: 29, Steps: 32 | Train Loss: 0.804 Vali Loss: 327.093 Vali Acc: 0.595 Test Loss: 327.093 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 9.011311054229736
Epoch: 30, Steps: 32 | Train Loss: 1.756 Vali Loss: 366.111 Vali Acc: 0.618 Test Loss: 366.111 Test Acc: 0.618
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 9.051271677017212
Epoch: 31, Steps: 32 | Train Loss: 2.376 Vali Loss: 563.075 Vali Acc: 0.565 Test Loss: 563.075 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 23226925
model size : 106.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.534601926803589
Epoch: 1, Steps: 32 | Train Loss: 36.388 Vali Loss: 44.015 Vali Acc: 0.420 Test Loss: 44.015 Test Acc: 0.420
Validation loss decreased (inf --> -0.419407).  Saving model ...
Epoch: 2 cost time: 8.068140029907227
Epoch: 2, Steps: 32 | Train Loss: 67.148 Vali Loss: 107.773 Vali Acc: 0.450 Test Loss: 107.773 Test Acc: 0.450
Validation loss decreased (-0.419407 --> -0.449304).  Saving model ...
Epoch: 3 cost time: 7.8035430908203125
Epoch: 3, Steps: 32 | Train Loss: 83.248 Vali Loss: 119.112 Vali Acc: 0.191 Test Loss: 119.112 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.01620888710022
Epoch: 4, Steps: 32 | Train Loss: 59.664 Vali Loss: 98.914 Vali Acc: 0.435 Test Loss: 98.914 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.87092924118042
Epoch: 5, Steps: 32 | Train Loss: 54.125 Vali Loss: 28.764 Vali Acc: 0.397 Test Loss: 28.764 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.093644618988037
Epoch: 6, Steps: 32 | Train Loss: 85.518 Vali Loss: 45.375 Vali Acc: 0.351 Test Loss: 45.375 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.989329814910889
Epoch: 7, Steps: 32 | Train Loss: 48.179 Vali Loss: 108.050 Vali Acc: 0.290 Test Loss: 108.050 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 8.219982624053955
Epoch: 8, Steps: 32 | Train Loss: 50.177 Vali Loss: 99.319 Vali Acc: 0.382 Test Loss: 99.319 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 8.088116884231567
Epoch: 9, Steps: 32 | Train Loss: 45.546 Vali Loss: 111.275 Vali Acc: 0.412 Test Loss: 111.275 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 7.859437942504883
Epoch: 10, Steps: 32 | Train Loss: 44.847 Vali Loss: 88.734 Vali Acc: 0.580 Test Loss: 88.734 Test Acc: 0.580
Validation loss decreased (-0.449304 --> -0.579265).  Saving model ...
Epoch: 11 cost time: 8.141169548034668
Epoch: 11, Steps: 32 | Train Loss: 54.756 Vali Loss: 147.968 Vali Acc: 0.229 Test Loss: 147.968 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.964072227478027
Epoch: 12, Steps: 32 | Train Loss: 9.836 Vali Loss: 101.191 Vali Acc: 0.542 Test Loss: 101.191 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.84201455116272
Epoch: 13, Steps: 32 | Train Loss: 4.324 Vali Loss: 149.803 Vali Acc: 0.389 Test Loss: 149.803 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.9261980056762695
Epoch: 14, Steps: 32 | Train Loss: 7.732 Vali Loss: 211.094 Vali Acc: 0.527 Test Loss: 211.094 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.969489812850952
Epoch: 15, Steps: 32 | Train Loss: 3.372 Vali Loss: 165.029 Vali Acc: 0.557 Test Loss: 165.029 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 8.255218744277954
Epoch: 16, Steps: 32 | Train Loss: 2.357 Vali Loss: 200.391 Vali Acc: 0.473 Test Loss: 200.391 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.939477920532227
Epoch: 17, Steps: 32 | Train Loss: 5.721 Vali Loss: 120.060 Vali Acc: 0.588 Test Loss: 120.060 Test Acc: 0.588
Validation loss decreased (-0.579265 --> -0.586586).  Saving model ...
Epoch: 18 cost time: 8.196553468704224
Epoch: 18, Steps: 32 | Train Loss: 15.524 Vali Loss: 249.057 Vali Acc: 0.504 Test Loss: 249.057 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.978605508804321
Epoch: 19, Steps: 32 | Train Loss: 0.334 Vali Loss: 197.754 Vali Acc: 0.504 Test Loss: 197.754 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.098013877868652
Epoch: 20, Steps: 32 | Train Loss: 0.053 Vali Loss: 167.620 Vali Acc: 0.473 Test Loss: 167.620 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.079497575759888
Epoch: 21, Steps: 32 | Train Loss: 1.927 Vali Loss: 161.872 Vali Acc: 0.588 Test Loss: 161.872 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.877108097076416
Epoch: 22, Steps: 32 | Train Loss: 6.295 Vali Loss: 222.163 Vali Acc: 0.389 Test Loss: 222.163 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.888869524002075
Epoch: 23, Steps: 32 | Train Loss: 4.789 Vali Loss: 224.316 Vali Acc: 0.557 Test Loss: 224.316 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.961719512939453
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 198.436 Vali Acc: 0.580 Test Loss: 198.436 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.129841566085815
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 197.673 Vali Acc: 0.573 Test Loss: 197.673 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.881519794464111
Epoch: 26, Steps: 32 | Train Loss: 2.549 Vali Loss: 205.616 Vali Acc: 0.443 Test Loss: 205.616 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 8.079527139663696
Epoch: 27, Steps: 32 | Train Loss: 3.290 Vali Loss: 221.074 Vali Acc: 0.542 Test Loss: 221.074 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 23226925
model size : 106.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 11.587507963180542
Epoch: 1, Steps: 32 | Train Loss: 41.314 Vali Loss: 60.701 Vali Acc: 0.305 Test Loss: 60.701 Test Acc: 0.305
Validation loss decreased (inf --> -0.304737).  Saving model ...
Epoch: 2 cost time: 10.222733974456787
Epoch: 2, Steps: 32 | Train Loss: 43.815 Vali Loss: 110.786 Vali Acc: 0.481 Test Loss: 110.786 Test Acc: 0.481
Validation loss decreased (-0.304737 --> -0.479808).  Saving model ...
Epoch: 3 cost time: 10.363281726837158
Epoch: 3, Steps: 32 | Train Loss: 59.082 Vali Loss: 61.425 Vali Acc: 0.489 Test Loss: 61.425 Test Acc: 0.489
Validation loss decreased (-0.479808 --> -0.487935).  Saving model ...
Epoch: 4 cost time: 10.489824533462524
Epoch: 4, Steps: 32 | Train Loss: 33.892 Vali Loss: 59.354 Vali Acc: 0.489 Test Loss: 59.354 Test Acc: 0.489
Validation loss decreased (-0.487935 --> -0.487956).  Saving model ...
Epoch: 5 cost time: 10.505313396453857
Epoch: 5, Steps: 32 | Train Loss: 42.885 Vali Loss: 192.889 Vali Acc: 0.435 Test Loss: 192.889 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 10.342139720916748
Epoch: 6, Steps: 32 | Train Loss: 38.583 Vali Loss: 157.815 Vali Acc: 0.305 Test Loss: 157.815 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 10.632409572601318
Epoch: 7, Steps: 32 | Train Loss: 42.822 Vali Loss: 138.748 Vali Acc: 0.542 Test Loss: 138.748 Test Acc: 0.542
Validation loss decreased (-0.487956 --> -0.540597).  Saving model ...
Epoch: 8 cost time: 10.726901769638062
Epoch: 8, Steps: 32 | Train Loss: 47.997 Vali Loss: 152.399 Vali Acc: 0.504 Test Loss: 152.399 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.3733389377594
Epoch: 9, Steps: 32 | Train Loss: 32.184 Vali Loss: 180.477 Vali Acc: 0.275 Test Loss: 180.477 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 10.5987868309021
Epoch: 10, Steps: 32 | Train Loss: 16.025 Vali Loss: 139.681 Vali Acc: 0.557 Test Loss: 139.681 Test Acc: 0.557
Validation loss decreased (-0.540597 --> -0.555855).  Saving model ...
Epoch: 11 cost time: 10.544666051864624
Epoch: 11, Steps: 32 | Train Loss: 14.545 Vali Loss: 125.467 Vali Acc: 0.603 Test Loss: 125.467 Test Acc: 0.603
Validation loss decreased (-0.555855 --> -0.601799).  Saving model ...
Epoch: 12 cost time: 10.309328317642212
Epoch: 12, Steps: 32 | Train Loss: 0.080 Vali Loss: 145.902 Vali Acc: 0.565 Test Loss: 145.902 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 10.534162521362305
Epoch: 13, Steps: 32 | Train Loss: 4.036 Vali Loss: 122.268 Vali Acc: 0.466 Test Loss: 122.268 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 10.463469505310059
Epoch: 14, Steps: 32 | Train Loss: 3.640 Vali Loss: 164.078 Vali Acc: 0.542 Test Loss: 164.078 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 10.429174184799194
Epoch: 15, Steps: 32 | Train Loss: 62.080 Vali Loss: 251.915 Vali Acc: 0.305 Test Loss: 251.915 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 10.65707516670227
Epoch: 16, Steps: 32 | Train Loss: 14.120 Vali Loss: 209.675 Vali Acc: 0.565 Test Loss: 209.675 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 10.380849123001099
Epoch: 17, Steps: 32 | Train Loss: 25.563 Vali Loss: 206.049 Vali Acc: 0.473 Test Loss: 206.049 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 10.448307752609253
Epoch: 18, Steps: 32 | Train Loss: 19.686 Vali Loss: 220.962 Vali Acc: 0.580 Test Loss: 220.962 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 10.48793077468872
Epoch: 19, Steps: 32 | Train Loss: 6.379 Vali Loss: 215.339 Vali Acc: 0.588 Test Loss: 215.339 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 10.500563859939575
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 228.414 Vali Acc: 0.611 Test Loss: 228.414 Test Acc: 0.611
Validation loss decreased (-0.601799 --> -0.608403).  Saving model ...
Epoch: 21 cost time: 10.463294982910156
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.020 Vali Acc: 0.611 Test Loss: 229.020 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 10.493598222732544
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.035 Vali Acc: 0.611 Test Loss: 229.035 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 10.768787622451782
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 10.724728345870972
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 10.508368015289307
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 10.433109760284424
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 10.440325736999512
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 10.48600721359253
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 10.64380407333374
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 10.898555994033813
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 229.036 Vali Acc: 0.611 Test Loss: 229.036 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 23194157
model size : 106.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.712193965911865
Epoch: 1, Steps: 32 | Train Loss: 25.814 Vali Loss: 55.779 Vali Acc: 0.405 Test Loss: 55.779 Test Acc: 0.405
Validation loss decreased (inf --> -0.404022).  Saving model ...
Epoch: 2 cost time: 9.00179672241211
Epoch: 2, Steps: 32 | Train Loss: 52.356 Vali Loss: 118.038 Vali Acc: 0.435 Test Loss: 118.038 Test Acc: 0.435
Validation loss decreased (-0.404022 --> -0.433934).  Saving model ...
Epoch: 3 cost time: 8.95255732536316
Epoch: 3, Steps: 32 | Train Loss: 83.266 Vali Loss: 79.009 Vali Acc: 0.298 Test Loss: 79.009 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.782211065292358
Epoch: 4, Steps: 32 | Train Loss: 69.375 Vali Loss: 149.374 Vali Acc: 0.290 Test Loss: 149.374 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.083138704299927
Epoch: 5, Steps: 32 | Train Loss: 71.571 Vali Loss: 146.067 Vali Acc: 0.282 Test Loss: 146.067 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 8.76504135131836
Epoch: 6, Steps: 32 | Train Loss: 137.441 Vali Loss: 155.277 Vali Acc: 0.473 Test Loss: 155.277 Test Acc: 0.473
Validation loss decreased (-0.433934 --> -0.471730).  Saving model ...
Epoch: 7 cost time: 9.162097215652466
Epoch: 7, Steps: 32 | Train Loss: 75.828 Vali Loss: 114.829 Vali Acc: 0.557 Test Loss: 114.829 Test Acc: 0.557
Validation loss decreased (-0.471730 --> -0.556104).  Saving model ...
Epoch: 8 cost time: 9.180986642837524
Epoch: 8, Steps: 32 | Train Loss: 38.172 Vali Loss: 160.622 Vali Acc: 0.496 Test Loss: 160.622 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.928703784942627
Epoch: 9, Steps: 32 | Train Loss: 45.586 Vali Loss: 206.170 Vali Acc: 0.481 Test Loss: 206.170 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.188998460769653
Epoch: 10, Steps: 32 | Train Loss: 43.902 Vali Loss: 140.951 Vali Acc: 0.550 Test Loss: 140.951 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 9.10076642036438
Epoch: 11, Steps: 32 | Train Loss: 22.794 Vali Loss: 121.087 Vali Acc: 0.611 Test Loss: 121.087 Test Acc: 0.611
Validation loss decreased (-0.556104 --> -0.609476).  Saving model ...
Epoch: 12 cost time: 9.226044178009033
Epoch: 12, Steps: 32 | Train Loss: 28.494 Vali Loss: 224.114 Vali Acc: 0.511 Test Loss: 224.114 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.472657442092896
Epoch: 13, Steps: 32 | Train Loss: 22.470 Vali Loss: 149.581 Vali Acc: 0.550 Test Loss: 149.581 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 9.483737707138062
Epoch: 14, Steps: 32 | Train Loss: 25.624 Vali Loss: 129.502 Vali Acc: 0.519 Test Loss: 129.502 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 9.455494165420532
Epoch: 15, Steps: 32 | Train Loss: 4.233 Vali Loss: 146.892 Vali Acc: 0.603 Test Loss: 146.892 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 9.578713178634644
Epoch: 16, Steps: 32 | Train Loss: 1.984 Vali Loss: 361.477 Vali Acc: 0.481 Test Loss: 361.477 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.66353440284729
Epoch: 17, Steps: 32 | Train Loss: 35.340 Vali Loss: 143.484 Vali Acc: 0.656 Test Loss: 143.484 Test Acc: 0.656
Validation loss decreased (-0.609476 --> -0.655054).  Saving model ...
Epoch: 18 cost time: 9.05066967010498
Epoch: 18, Steps: 32 | Train Loss: 7.089 Vali Loss: 142.225 Vali Acc: 0.580 Test Loss: 142.225 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.625769138336182
Epoch: 19, Steps: 32 | Train Loss: 8.435 Vali Loss: 161.326 Vali Acc: 0.580 Test Loss: 161.326 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.537184953689575
Epoch: 20, Steps: 32 | Train Loss: 0.407 Vali Loss: 197.775 Vali Acc: 0.565 Test Loss: 197.775 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.591329336166382
Epoch: 21, Steps: 32 | Train Loss: 1.925 Vali Loss: 196.062 Vali Acc: 0.542 Test Loss: 196.062 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.233096837997437
Epoch: 22, Steps: 32 | Train Loss: 2.845 Vali Loss: 221.515 Vali Acc: 0.542 Test Loss: 221.515 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.917714357376099
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 236.755 Vali Acc: 0.511 Test Loss: 236.755 Test Acc: 0.511
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 9.782541513442993
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 237.331 Vali Acc: 0.511 Test Loss: 237.331 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.95022964477539
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 237.351 Vali Acc: 0.511 Test Loss: 237.351 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.151464939117432
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 237.352 Vali Acc: 0.511 Test Loss: 237.352 Test Acc: 0.511
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 9.88757586479187
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 237.352 Vali Acc: 0.511 Test Loss: 237.352 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 23194157
model size : 106.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.337731838226318
Epoch: 1, Steps: 32 | Train Loss: 28.626 Vali Loss: 34.436 Vali Acc: 0.183 Test Loss: 34.436 Test Acc: 0.183
Validation loss decreased (inf --> -0.182862).  Saving model ...
Epoch: 2 cost time: 8.766070127487183
Epoch: 2, Steps: 32 | Train Loss: 42.990 Vali Loss: 70.916 Vali Acc: 0.275 Test Loss: 70.916 Test Acc: 0.275
Validation loss decreased (-0.182862 --> -0.274100).  Saving model ...
Epoch: 3 cost time: 8.900549411773682
Epoch: 3, Steps: 32 | Train Loss: 68.207 Vali Loss: 49.338 Vali Acc: 0.519 Test Loss: 49.338 Test Acc: 0.519
Validation loss decreased (-0.274100 --> -0.518591).  Saving model ...
Epoch: 4 cost time: 9.091735601425171
Epoch: 4, Steps: 32 | Train Loss: 50.575 Vali Loss: 52.035 Vali Acc: 0.458 Test Loss: 52.035 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.604738235473633
Epoch: 5, Steps: 32 | Train Loss: 68.342 Vali Loss: 71.912 Vali Acc: 0.519 Test Loss: 71.912 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.850654363632202
Epoch: 6, Steps: 32 | Train Loss: 78.738 Vali Loss: 207.282 Vali Acc: 0.481 Test Loss: 207.282 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.929682493209839
Epoch: 7, Steps: 32 | Train Loss: 66.321 Vali Loss: 228.875 Vali Acc: 0.305 Test Loss: 228.875 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 9.030091524124146
Epoch: 8, Steps: 32 | Train Loss: 87.849 Vali Loss: 153.678 Vali Acc: 0.511 Test Loss: 153.678 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 9.231296062469482
Epoch: 9, Steps: 32 | Train Loss: 37.222 Vali Loss: 223.979 Vali Acc: 0.527 Test Loss: 223.979 Test Acc: 0.527
Validation loss decreased (-0.518591 --> -0.524478).  Saving model ...
Epoch: 10 cost time: 9.496518850326538
Epoch: 10, Steps: 32 | Train Loss: 67.641 Vali Loss: 279.952 Vali Acc: 0.550 Test Loss: 279.952 Test Acc: 0.550
Validation loss decreased (-0.524478 --> -0.546819).  Saving model ...
Epoch: 11 cost time: 9.581573247909546
Epoch: 11, Steps: 32 | Train Loss: 36.357 Vali Loss: 185.109 Vali Acc: 0.450 Test Loss: 185.109 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.569381952285767
Epoch: 12, Steps: 32 | Train Loss: 6.997 Vali Loss: 192.974 Vali Acc: 0.542 Test Loss: 192.974 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 9.53099775314331
Epoch: 13, Steps: 32 | Train Loss: 10.920 Vali Loss: 125.921 Vali Acc: 0.626 Test Loss: 125.921 Test Acc: 0.626
Validation loss decreased (-0.546819 --> -0.624695).  Saving model ...
Epoch: 14 cost time: 9.978848457336426
Epoch: 14, Steps: 32 | Train Loss: 33.821 Vali Loss: 205.883 Vali Acc: 0.603 Test Loss: 205.883 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.693074703216553
Epoch: 15, Steps: 32 | Train Loss: 3.280 Vali Loss: 244.550 Vali Acc: 0.366 Test Loss: 244.550 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.511767625808716
Epoch: 16, Steps: 32 | Train Loss: 1.122 Vali Loss: 205.158 Vali Acc: 0.504 Test Loss: 205.158 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.277377605438232
Epoch: 17, Steps: 32 | Train Loss: 26.915 Vali Loss: 325.128 Vali Acc: 0.366 Test Loss: 325.128 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.312470436096191
Epoch: 18, Steps: 32 | Train Loss: 32.682 Vali Loss: 283.513 Vali Acc: 0.588 Test Loss: 283.513 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 9.182967901229858
Epoch: 19, Steps: 32 | Train Loss: 16.544 Vali Loss: 299.654 Vali Acc: 0.603 Test Loss: 299.654 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.510770320892334
Epoch: 20, Steps: 32 | Train Loss: 6.324 Vali Loss: 203.776 Vali Acc: 0.565 Test Loss: 203.776 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.466134309768677
Epoch: 21, Steps: 32 | Train Loss: 4.407 Vali Loss: 193.968 Vali Acc: 0.618 Test Loss: 193.968 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.076900482177734
Epoch: 22, Steps: 32 | Train Loss: 2.480 Vali Loss: 302.766 Vali Acc: 0.405 Test Loss: 302.766 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.477251291275024
Epoch: 23, Steps: 32 | Train Loss: 3.908 Vali Loss: 298.451 Vali Acc: 0.603 Test Loss: 298.451 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 23194157
model size : 106.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 10.769674062728882
Epoch: 1, Steps: 32 | Train Loss: 30.377 Vali Loss: 53.912 Vali Acc: 0.420 Test Loss: 53.912 Test Acc: 0.420
Validation loss decreased (inf --> -0.419308).  Saving model ...
Epoch: 2 cost time: 8.77648663520813
Epoch: 2, Steps: 32 | Train Loss: 46.911 Vali Loss: 58.254 Vali Acc: 0.473 Test Loss: 58.254 Test Acc: 0.473
Validation loss decreased (-0.419308 --> -0.472700).  Saving model ...
Epoch: 3 cost time: 8.649325609207153
Epoch: 3, Steps: 32 | Train Loss: 48.375 Vali Loss: 44.867 Vali Acc: 0.473 Test Loss: 44.867 Test Acc: 0.473
Validation loss decreased (-0.472700 --> -0.472834).  Saving model ...
Epoch: 4 cost time: 8.7162024974823
Epoch: 4, Steps: 32 | Train Loss: 49.689 Vali Loss: 28.671 Vali Acc: 0.359 Test Loss: 28.671 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.560423374176025
Epoch: 5, Steps: 32 | Train Loss: 44.834 Vali Loss: 55.058 Vali Acc: 0.473 Test Loss: 55.058 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.231282234191895
Epoch: 6, Steps: 32 | Train Loss: 70.374 Vali Loss: 125.338 Vali Acc: 0.450 Test Loss: 125.338 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 8.468348264694214
Epoch: 7, Steps: 32 | Train Loss: 86.878 Vali Loss: 92.953 Vali Acc: 0.214 Test Loss: 92.953 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.290517807006836
Epoch: 8, Steps: 32 | Train Loss: 61.034 Vali Loss: 107.784 Vali Acc: 0.366 Test Loss: 107.784 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.53140640258789
Epoch: 9, Steps: 32 | Train Loss: 25.280 Vali Loss: 178.010 Vali Acc: 0.527 Test Loss: 178.010 Test Acc: 0.527
Validation loss decreased (-0.472834 --> -0.524937).  Saving model ...
Epoch: 10 cost time: 8.044739723205566
Epoch: 10, Steps: 32 | Train Loss: 28.596 Vali Loss: 206.615 Vali Acc: 0.504 Test Loss: 206.615 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.47432565689087
Epoch: 11, Steps: 32 | Train Loss: 44.011 Vali Loss: 221.104 Vali Acc: 0.534 Test Loss: 221.104 Test Acc: 0.534
Validation loss decreased (-0.524937 --> -0.532140).  Saving model ...
Epoch: 12 cost time: 8.908077955245972
Epoch: 12, Steps: 32 | Train Loss: 6.199 Vali Loss: 223.788 Vali Acc: 0.496 Test Loss: 223.788 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.630311250686646
Epoch: 13, Steps: 32 | Train Loss: 7.190 Vali Loss: 149.172 Vali Acc: 0.336 Test Loss: 149.172 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.959742069244385
Epoch: 14, Steps: 32 | Train Loss: 1.587 Vali Loss: 211.418 Vali Acc: 0.573 Test Loss: 211.418 Test Acc: 0.573
Validation loss decreased (-0.532140 --> -0.570405).  Saving model ...
Epoch: 15 cost time: 8.730376482009888
Epoch: 15, Steps: 32 | Train Loss: 2.119 Vali Loss: 186.752 Vali Acc: 0.588 Test Loss: 186.752 Test Acc: 0.588
Validation loss decreased (-0.570405 --> -0.585919).  Saving model ...
Epoch: 16 cost time: 8.717657804489136
Epoch: 16, Steps: 32 | Train Loss: 4.050 Vali Loss: 199.727 Vali Acc: 0.595 Test Loss: 199.727 Test Acc: 0.595
Validation loss decreased (-0.585919 --> -0.593423).  Saving model ...
Epoch: 17 cost time: 9.12055516242981
Epoch: 17, Steps: 32 | Train Loss: 41.771 Vali Loss: 290.665 Vali Acc: 0.366 Test Loss: 290.665 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 8.45445466041565
Epoch: 18, Steps: 32 | Train Loss: 35.816 Vali Loss: 374.141 Vali Acc: 0.557 Test Loss: 374.141 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 9.029072284698486
Epoch: 19, Steps: 32 | Train Loss: 5.829 Vali Loss: 363.988 Vali Acc: 0.481 Test Loss: 363.988 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.531658411026001
Epoch: 20, Steps: 32 | Train Loss: 5.424 Vali Loss: 230.355 Vali Acc: 0.611 Test Loss: 230.355 Test Acc: 0.611
Validation loss decreased (-0.593423 --> -0.608383).  Saving model ...
Epoch: 21 cost time: 8.579604148864746
Epoch: 21, Steps: 32 | Train Loss: 0.729 Vali Loss: 325.487 Vali Acc: 0.527 Test Loss: 325.487 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.307579040527344
Epoch: 22, Steps: 32 | Train Loss: 0.299 Vali Loss: 270.178 Vali Acc: 0.481 Test Loss: 270.178 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 8.599974393844604
Epoch: 23, Steps: 32 | Train Loss: 1.302 Vali Loss: 323.770 Vali Acc: 0.573 Test Loss: 323.770 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.409142017364502
Epoch: 24, Steps: 32 | Train Loss: 18.071 Vali Loss: 287.844 Vali Acc: 0.588 Test Loss: 287.844 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.60010552406311
Epoch: 25, Steps: 32 | Train Loss: 1.641 Vali Loss: 261.784 Vali Acc: 0.565 Test Loss: 261.784 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.470866203308105
Epoch: 26, Steps: 32 | Train Loss: 5.454 Vali Loss: 349.392 Vali Acc: 0.473 Test Loss: 349.392 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 8.946632862091064
Epoch: 27, Steps: 32 | Train Loss: 0.188 Vali Loss: 258.160 Vali Acc: 0.588 Test Loss: 258.160 Test Acc: 0.588
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.602102518081665
Epoch: 28, Steps: 32 | Train Loss: 2.850 Vali Loss: 368.082 Vali Acc: 0.565 Test Loss: 368.082 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.90762186050415
Epoch: 29, Steps: 32 | Train Loss: 0.584 Vali Loss: 285.333 Vali Acc: 0.580 Test Loss: 285.333 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.637272834777832
Epoch: 30, Steps: 32 | Train Loss: 15.418 Vali Loss: 255.385 Vali Acc: 0.557 Test Loss: 255.385 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 23194157
model size : 106.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.298104763031006
Epoch: 1, Steps: 32 | Train Loss: 12.923 Vali Loss: 53.040 Vali Acc: 0.115 Test Loss: 53.040 Test Acc: 0.115
Validation loss decreased (inf --> -0.113973).  Saving model ...
Epoch: 2 cost time: 6.712791681289673
Epoch: 2, Steps: 32 | Train Loss: 27.816 Vali Loss: 46.600 Vali Acc: 0.176 Test Loss: 46.600 Test Acc: 0.176
Validation loss decreased (-0.113973 --> -0.175107).  Saving model ...
Epoch: 3 cost time: 6.535019159317017
Epoch: 3, Steps: 32 | Train Loss: 35.588 Vali Loss: 57.395 Vali Acc: 0.275 Test Loss: 57.395 Test Acc: 0.275
Validation loss decreased (-0.175107 --> -0.274235).  Saving model ...
Epoch: 4 cost time: 6.818194389343262
Epoch: 4, Steps: 32 | Train Loss: 21.330 Vali Loss: 63.204 Vali Acc: 0.374 Test Loss: 63.204 Test Acc: 0.374
Validation loss decreased (-0.274235 --> -0.373414).  Saving model ...
Epoch: 5 cost time: 7.195395469665527
Epoch: 5, Steps: 32 | Train Loss: 23.234 Vali Loss: 60.409 Vali Acc: 0.481 Test Loss: 60.409 Test Acc: 0.481
Validation loss decreased (-0.373414 --> -0.480312).  Saving model ...
Epoch: 6 cost time: 7.128573417663574
Epoch: 6, Steps: 32 | Train Loss: 17.665 Vali Loss: 55.684 Vali Acc: 0.473 Test Loss: 55.684 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.322510004043579
Epoch: 7, Steps: 32 | Train Loss: 13.902 Vali Loss: 45.746 Vali Acc: 0.298 Test Loss: 45.746 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.201828956604004
Epoch: 8, Steps: 32 | Train Loss: 15.303 Vali Loss: 60.655 Vali Acc: 0.443 Test Loss: 60.655 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.109341621398926
Epoch: 9, Steps: 32 | Train Loss: 27.417 Vali Loss: 49.307 Vali Acc: 0.573 Test Loss: 49.307 Test Acc: 0.573
Validation loss decreased (-0.480312 --> -0.572026).  Saving model ...
Epoch: 10 cost time: 6.860893964767456
Epoch: 10, Steps: 32 | Train Loss: 8.395 Vali Loss: 45.685 Vali Acc: 0.504 Test Loss: 45.685 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 7.039789438247681
Epoch: 11, Steps: 32 | Train Loss: 6.783 Vali Loss: 92.483 Vali Acc: 0.313 Test Loss: 92.483 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.956043720245361
Epoch: 12, Steps: 32 | Train Loss: 24.176 Vali Loss: 151.841 Vali Acc: 0.351 Test Loss: 151.841 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.468641757965088
Epoch: 13, Steps: 32 | Train Loss: 11.511 Vali Loss: 196.144 Vali Acc: 0.542 Test Loss: 196.144 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.087575197219849
Epoch: 14, Steps: 32 | Train Loss: 13.026 Vali Loss: 144.842 Vali Acc: 0.565 Test Loss: 144.842 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.8263020515441895
Epoch: 15, Steps: 32 | Train Loss: 7.982 Vali Loss: 129.868 Vali Acc: 0.588 Test Loss: 129.868 Test Acc: 0.588
Validation loss decreased (-0.572026 --> -0.586488).  Saving model ...
Epoch: 16 cost time: 6.880687236785889
Epoch: 16, Steps: 32 | Train Loss: 1.005 Vali Loss: 150.972 Vali Acc: 0.405 Test Loss: 150.972 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.093272924423218
Epoch: 17, Steps: 32 | Train Loss: 1.733 Vali Loss: 172.353 Vali Acc: 0.527 Test Loss: 172.353 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.490626335144043
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 145.738 Vali Acc: 0.473 Test Loss: 145.738 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.0190863609313965
Epoch: 19, Steps: 32 | Train Loss: 1.534 Vali Loss: 136.533 Vali Acc: 0.588 Test Loss: 136.533 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.798996686935425
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 135.476 Vali Acc: 0.519 Test Loss: 135.476 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.509403228759766
Epoch: 21, Steps: 32 | Train Loss: 0.538 Vali Loss: 182.839 Vali Acc: 0.565 Test Loss: 182.839 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.952240705490112
Epoch: 22, Steps: 32 | Train Loss: 10.931 Vali Loss: 171.067 Vali Acc: 0.519 Test Loss: 171.067 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.73079514503479
Epoch: 23, Steps: 32 | Train Loss: 9.028 Vali Loss: 155.901 Vali Acc: 0.580 Test Loss: 155.901 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.342085123062134
Epoch: 24, Steps: 32 | Train Loss: 0.990 Vali Loss: 219.010 Vali Acc: 0.412 Test Loss: 219.010 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.2652809619903564
Epoch: 25, Steps: 32 | Train Loss: 34.827 Vali Loss: 181.833 Vali Acc: 0.534 Test Loss: 181.833 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 12072237
model size : 54.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.532859325408936
Epoch: 1, Steps: 32 | Train Loss: 15.272 Vali Loss: 38.236 Vali Acc: 0.168 Test Loss: 38.236 Test Acc: 0.168
Validation loss decreased (inf --> -0.167557).  Saving model ...
Epoch: 2 cost time: 6.247630596160889
Epoch: 2, Steps: 32 | Train Loss: 16.646 Vali Loss: 48.686 Vali Acc: 0.137 Test Loss: 48.686 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.509741306304932
Epoch: 3, Steps: 32 | Train Loss: 34.466 Vali Loss: 21.855 Vali Acc: 0.427 Test Loss: 21.855 Test Acc: 0.427
Validation loss decreased (-0.167557 --> -0.427262).  Saving model ...
Epoch: 4 cost time: 6.1521830558776855
Epoch: 4, Steps: 32 | Train Loss: 21.318 Vali Loss: 60.612 Vali Acc: 0.275 Test Loss: 60.612 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.658757209777832
Epoch: 5, Steps: 32 | Train Loss: 12.823 Vali Loss: 54.706 Vali Acc: 0.496 Test Loss: 54.706 Test Acc: 0.496
Validation loss decreased (-0.427262 --> -0.495636).  Saving model ...
Epoch: 6 cost time: 6.118626832962036
Epoch: 6, Steps: 32 | Train Loss: 15.905 Vali Loss: 76.636 Vali Acc: 0.282 Test Loss: 76.636 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.183012247085571
Epoch: 7, Steps: 32 | Train Loss: 32.779 Vali Loss: 55.794 Vali Acc: 0.206 Test Loss: 55.794 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.402042865753174
Epoch: 8, Steps: 32 | Train Loss: 56.367 Vali Loss: 70.945 Vali Acc: 0.336 Test Loss: 70.945 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.615453481674194
Epoch: 9, Steps: 32 | Train Loss: 8.973 Vali Loss: 72.985 Vali Acc: 0.565 Test Loss: 72.985 Test Acc: 0.565
Validation loss decreased (-0.495636 --> -0.564156).  Saving model ...
Epoch: 10 cost time: 6.490614891052246
Epoch: 10, Steps: 32 | Train Loss: 39.801 Vali Loss: 83.044 Vali Acc: 0.267 Test Loss: 83.044 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.400213956832886
Epoch: 11, Steps: 32 | Train Loss: 12.721 Vali Loss: 75.457 Vali Acc: 0.374 Test Loss: 75.457 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.697275638580322
Epoch: 12, Steps: 32 | Train Loss: 5.874 Vali Loss: 66.112 Vali Acc: 0.359 Test Loss: 66.112 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.6962926387786865
Epoch: 13, Steps: 32 | Train Loss: 8.860 Vali Loss: 106.077 Vali Acc: 0.527 Test Loss: 106.077 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.712502717971802
Epoch: 14, Steps: 32 | Train Loss: 20.931 Vali Loss: 344.149 Vali Acc: 0.481 Test Loss: 344.149 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.280384302139282
Epoch: 15, Steps: 32 | Train Loss: 23.600 Vali Loss: 206.023 Vali Acc: 0.534 Test Loss: 206.023 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.915720701217651
Epoch: 16, Steps: 32 | Train Loss: 3.303 Vali Loss: 142.078 Vali Acc: 0.504 Test Loss: 142.078 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.388845920562744
Epoch: 17, Steps: 32 | Train Loss: 1.555 Vali Loss: 161.054 Vali Acc: 0.580 Test Loss: 161.054 Test Acc: 0.580
Validation loss decreased (-0.564156 --> -0.578542).  Saving model ...
Epoch: 18 cost time: 6.662867307662964
Epoch: 18, Steps: 32 | Train Loss: 1.651 Vali Loss: 153.830 Vali Acc: 0.580 Test Loss: 153.830 Test Acc: 0.580
Validation loss decreased (-0.578542 --> -0.578614).  Saving model ...
Epoch: 19 cost time: 6.395797491073608
Epoch: 19, Steps: 32 | Train Loss: 1.409 Vali Loss: 144.676 Vali Acc: 0.557 Test Loss: 144.676 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.667267322540283
Epoch: 20, Steps: 32 | Train Loss: 0.579 Vali Loss: 143.048 Vali Acc: 0.557 Test Loss: 143.048 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.520836591720581
Epoch: 21, Steps: 32 | Train Loss: 0.067 Vali Loss: 190.777 Vali Acc: 0.534 Test Loss: 190.777 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.481391906738281
Epoch: 22, Steps: 32 | Train Loss: 3.743 Vali Loss: 138.601 Vali Acc: 0.580 Test Loss: 138.601 Test Acc: 0.580
Validation loss decreased (-0.578614 --> -0.578767).  Saving model ...
Epoch: 23 cost time: 6.666078329086304
Epoch: 23, Steps: 32 | Train Loss: 0.164 Vali Loss: 144.178 Vali Acc: 0.595 Test Loss: 144.178 Test Acc: 0.595
Validation loss decreased (-0.578767 --> -0.593978).  Saving model ...
Epoch: 24 cost time: 6.670323371887207
Epoch: 24, Steps: 32 | Train Loss: 5.260 Vali Loss: 202.659 Vali Acc: 0.527 Test Loss: 202.659 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.342167854309082
Epoch: 25, Steps: 32 | Train Loss: 11.848 Vali Loss: 245.743 Vali Acc: 0.534 Test Loss: 245.743 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.822841644287109
Epoch: 26, Steps: 32 | Train Loss: 22.287 Vali Loss: 126.056 Vali Acc: 0.542 Test Loss: 126.056 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.880160093307495
Epoch: 27, Steps: 32 | Train Loss: 0.685 Vali Loss: 214.254 Vali Acc: 0.382 Test Loss: 214.254 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.67310357093811
Epoch: 28, Steps: 32 | Train Loss: 11.258 Vali Loss: 158.631 Vali Acc: 0.557 Test Loss: 158.631 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 7.050634860992432
Epoch: 29, Steps: 32 | Train Loss: 6.603 Vali Loss: 349.856 Vali Acc: 0.351 Test Loss: 349.856 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.8489320278167725
Epoch: 30, Steps: 32 | Train Loss: 5.711 Vali Loss: 453.171 Vali Acc: 0.496 Test Loss: 453.171 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.862416744232178
Epoch: 31, Steps: 32 | Train Loss: 12.343 Vali Loss: 382.054 Vali Acc: 0.458 Test Loss: 382.054 Test Acc: 0.458
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.639692783355713
Epoch: 32, Steps: 32 | Train Loss: 0.092 Vali Loss: 317.916 Vali Acc: 0.458 Test Loss: 317.916 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.695925951004028
Epoch: 33, Steps: 32 | Train Loss: 1.462 Vali Loss: 270.275 Vali Acc: 0.603 Test Loss: 270.275 Test Acc: 0.603
Validation loss decreased (-0.593978 --> -0.600351).  Saving model ...
Epoch: 34 cost time: 6.723931074142456
Epoch: 34, Steps: 32 | Train Loss: 0.256 Vali Loss: 368.431 Vali Acc: 0.519 Test Loss: 368.431 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.627601146697998
Epoch: 35, Steps: 32 | Train Loss: 4.918 Vali Loss: 364.406 Vali Acc: 0.504 Test Loss: 364.406 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 6.766180992126465
Epoch: 36, Steps: 32 | Train Loss: 9.677 Vali Loss: 359.636 Vali Acc: 0.313 Test Loss: 359.636 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.397762060165405
Epoch: 37, Steps: 32 | Train Loss: 2.891 Vali Loss: 429.308 Vali Acc: 0.229 Test Loss: 429.308 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 6.582046031951904
Epoch: 38, Steps: 32 | Train Loss: 1.193 Vali Loss: 298.058 Vali Acc: 0.489 Test Loss: 298.058 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 6.5134735107421875
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 291.353 Vali Acc: 0.473 Test Loss: 291.353 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 6.765411376953125
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 291.179 Vali Acc: 0.473 Test Loss: 291.179 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 6.660760164260864
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 291.173 Vali Acc: 0.473 Test Loss: 291.173 Test Acc: 0.473
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 6.988661527633667
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 291.173 Vali Acc: 0.473 Test Loss: 291.173 Test Acc: 0.473
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 6.595313787460327
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 291.173 Vali Acc: 0.473 Test Loss: 291.173 Test Acc: 0.473
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 12072237
model size : 54.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.7539355754852295
Epoch: 1, Steps: 32 | Train Loss: 14.636 Vali Loss: 27.241 Vali Acc: 0.427 Test Loss: 27.241 Test Acc: 0.427
Validation loss decreased (inf --> -0.427209).  Saving model ...
Epoch: 2 cost time: 6.371879816055298
Epoch: 2, Steps: 32 | Train Loss: 19.599 Vali Loss: 53.514 Vali Acc: 0.267 Test Loss: 53.514 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.072907209396362
Epoch: 3, Steps: 32 | Train Loss: 47.401 Vali Loss: 83.753 Vali Acc: 0.206 Test Loss: 83.753 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.982474088668823
Epoch: 4, Steps: 32 | Train Loss: 20.301 Vali Loss: 70.605 Vali Acc: 0.145 Test Loss: 70.605 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.207148313522339
Epoch: 5, Steps: 32 | Train Loss: 23.411 Vali Loss: 48.696 Vali Acc: 0.466 Test Loss: 48.696 Test Acc: 0.466
Validation loss decreased (-0.427209 --> -0.465162).  Saving model ...
Epoch: 6 cost time: 6.05934739112854
Epoch: 6, Steps: 32 | Train Loss: 21.192 Vali Loss: 92.139 Vali Acc: 0.489 Test Loss: 92.139 Test Acc: 0.489
Validation loss decreased (-0.465162 --> -0.487628).  Saving model ...
Epoch: 7 cost time: 6.47181248664856
Epoch: 7, Steps: 32 | Train Loss: 30.218 Vali Loss: 46.028 Vali Acc: 0.305 Test Loss: 46.028 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.471340656280518
Epoch: 8, Steps: 32 | Train Loss: 18.901 Vali Loss: 77.512 Vali Acc: 0.244 Test Loss: 77.512 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.8803088665008545
Epoch: 9, Steps: 32 | Train Loss: 59.439 Vali Loss: 121.506 Vali Acc: 0.496 Test Loss: 121.506 Test Acc: 0.496
Validation loss decreased (-0.487628 --> -0.494968).  Saving model ...
Epoch: 10 cost time: 6.392976760864258
Epoch: 10, Steps: 32 | Train Loss: 30.436 Vali Loss: 66.618 Vali Acc: 0.290 Test Loss: 66.618 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.6907830238342285
Epoch: 11, Steps: 32 | Train Loss: 24.608 Vali Loss: 214.330 Vali Acc: 0.137 Test Loss: 214.330 Test Acc: 0.137
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.045061111450195
Epoch: 12, Steps: 32 | Train Loss: 16.602 Vali Loss: 155.596 Vali Acc: 0.611 Test Loss: 155.596 Test Acc: 0.611
Validation loss decreased (-0.494968 --> -0.609131).  Saving model ...
Epoch: 13 cost time: 6.618360280990601
Epoch: 13, Steps: 32 | Train Loss: 9.542 Vali Loss: 204.765 Vali Acc: 0.504 Test Loss: 204.765 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.1151580810546875
Epoch: 14, Steps: 32 | Train Loss: 8.690 Vali Loss: 162.039 Vali Acc: 0.580 Test Loss: 162.039 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.127959489822388
Epoch: 15, Steps: 32 | Train Loss: 6.082 Vali Loss: 190.265 Vali Acc: 0.534 Test Loss: 190.265 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.166585445404053
Epoch: 16, Steps: 32 | Train Loss: 5.925 Vali Loss: 229.559 Vali Acc: 0.466 Test Loss: 229.559 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.485490798950195
Epoch: 17, Steps: 32 | Train Loss: 8.424 Vali Loss: 239.769 Vali Acc: 0.366 Test Loss: 239.769 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.320645332336426
Epoch: 18, Steps: 32 | Train Loss: 6.116 Vali Loss: 208.148 Vali Acc: 0.397 Test Loss: 208.148 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.532258987426758
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 226.642 Vali Acc: 0.573 Test Loss: 226.642 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.229215860366821
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 223.357 Vali Acc: 0.565 Test Loss: 223.357 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.526552677154541
Epoch: 21, Steps: 32 | Train Loss: 0.466 Vali Loss: 242.172 Vali Acc: 0.534 Test Loss: 242.172 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.714978218078613
Epoch: 22, Steps: 32 | Train Loss: 1.924 Vali Loss: 244.581 Vali Acc: 0.519 Test Loss: 244.581 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 12072237
model size : 54.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.089203596115112
Epoch: 1, Steps: 32 | Train Loss: 17.264 Vali Loss: 19.992 Vali Acc: 0.489 Test Loss: 19.992 Test Acc: 0.489
Validation loss decreased (inf --> -0.488350).  Saving model ...
Epoch: 2 cost time: 6.333492040634155
Epoch: 2, Steps: 32 | Train Loss: 25.293 Vali Loss: 29.449 Vali Acc: 0.466 Test Loss: 29.449 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.724701642990112
Epoch: 3, Steps: 32 | Train Loss: 25.137 Vali Loss: 29.890 Vali Acc: 0.229 Test Loss: 29.890 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.977375268936157
Epoch: 4, Steps: 32 | Train Loss: 30.638 Vali Loss: 42.881 Vali Acc: 0.412 Test Loss: 42.881 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.916404724121094
Epoch: 5, Steps: 32 | Train Loss: 35.910 Vali Loss: 52.247 Vali Acc: 0.473 Test Loss: 52.247 Test Acc: 0.473
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.596603870391846
Epoch: 6, Steps: 32 | Train Loss: 31.119 Vali Loss: 47.193 Vali Acc: 0.458 Test Loss: 47.193 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.969139814376831
Epoch: 7, Steps: 32 | Train Loss: 33.417 Vali Loss: 40.150 Vali Acc: 0.427 Test Loss: 40.150 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 6.004914045333862
Epoch: 8, Steps: 32 | Train Loss: 28.093 Vali Loss: 87.608 Vali Acc: 0.214 Test Loss: 87.608 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.743283271789551
Epoch: 9, Steps: 32 | Train Loss: 19.374 Vali Loss: 32.447 Vali Acc: 0.534 Test Loss: 32.447 Test Acc: 0.534
Validation loss decreased (-0.488350 --> -0.534027).  Saving model ...
Epoch: 10 cost time: 5.524963140487671
Epoch: 10, Steps: 32 | Train Loss: 17.916 Vali Loss: 159.406 Vali Acc: 0.206 Test Loss: 159.406 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.778957843780518
Epoch: 11, Steps: 32 | Train Loss: 14.154 Vali Loss: 117.168 Vali Acc: 0.366 Test Loss: 117.168 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.171877384185791
Epoch: 12, Steps: 32 | Train Loss: 3.179 Vali Loss: 120.365 Vali Acc: 0.458 Test Loss: 120.365 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.783841371536255
Epoch: 13, Steps: 32 | Train Loss: 6.729 Vali Loss: 214.408 Vali Acc: 0.221 Test Loss: 214.408 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.840168237686157
Epoch: 14, Steps: 32 | Train Loss: 8.065 Vali Loss: 146.539 Vali Acc: 0.450 Test Loss: 146.539 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.817737102508545
Epoch: 15, Steps: 32 | Train Loss: 1.976 Vali Loss: 111.474 Vali Acc: 0.580 Test Loss: 111.474 Test Acc: 0.580
Validation loss decreased (-0.534027 --> -0.579038).  Saving model ...
Epoch: 16 cost time: 6.182074308395386
Epoch: 16, Steps: 32 | Train Loss: 0.051 Vali Loss: 132.736 Vali Acc: 0.580 Test Loss: 132.736 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.7168128490448
Epoch: 17, Steps: 32 | Train Loss: 0.615 Vali Loss: 128.632 Vali Acc: 0.588 Test Loss: 128.632 Test Acc: 0.588
Validation loss decreased (-0.579038 --> -0.586500).  Saving model ...
Epoch: 18 cost time: 6.149147272109985
Epoch: 18, Steps: 32 | Train Loss: 1.434 Vali Loss: 129.341 Vali Acc: 0.573 Test Loss: 129.341 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.279991149902344
Epoch: 19, Steps: 32 | Train Loss: 0.280 Vali Loss: 120.810 Vali Acc: 0.557 Test Loss: 120.810 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.302517652511597
Epoch: 20, Steps: 32 | Train Loss: 5.633 Vali Loss: 240.650 Vali Acc: 0.237 Test Loss: 240.650 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.236023426055908
Epoch: 21, Steps: 32 | Train Loss: 7.261 Vali Loss: 156.349 Vali Acc: 0.573 Test Loss: 156.349 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.162550926208496
Epoch: 22, Steps: 32 | Train Loss: 30.149 Vali Loss: 151.802 Vali Acc: 0.351 Test Loss: 151.802 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.303779602050781
Epoch: 23, Steps: 32 | Train Loss: 5.493 Vali Loss: 280.167 Vali Acc: 0.374 Test Loss: 280.167 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.725777626037598
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 217.361 Vali Acc: 0.366 Test Loss: 217.361 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.872156620025635
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 190.855 Vali Acc: 0.588 Test Loss: 190.855 Test Acc: 0.588
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.8157103061676025
Epoch: 26, Steps: 32 | Train Loss: 7.865 Vali Loss: 253.029 Vali Acc: 0.336 Test Loss: 253.029 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.886599063873291
Epoch: 27, Steps: 32 | Train Loss: 4.137 Vali Loss: 322.895 Vali Acc: 0.511 Test Loss: 322.895 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 12072237
model size : 54.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.402666568756104
Epoch: 1, Steps: 32 | Train Loss: 18.431 Vali Loss: 28.046 Vali Acc: 0.191 Test Loss: 28.046 Test Acc: 0.191
Validation loss decreased (inf --> -0.190559).  Saving model ...
Epoch: 2 cost time: 6.400975704193115
Epoch: 2, Steps: 32 | Train Loss: 24.557 Vali Loss: 25.261 Vali Acc: 0.176 Test Loss: 25.261 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.122048616409302
Epoch: 3, Steps: 32 | Train Loss: 12.529 Vali Loss: 25.939 Vali Acc: 0.496 Test Loss: 25.939 Test Acc: 0.496
Validation loss decreased (-0.190559 --> -0.495924).  Saving model ...
Epoch: 4 cost time: 6.804535388946533
Epoch: 4, Steps: 32 | Train Loss: 21.111 Vali Loss: 56.427 Vali Acc: 0.504 Test Loss: 56.427 Test Acc: 0.504
Validation loss decreased (-0.495924 --> -0.503253).  Saving model ...
Epoch: 5 cost time: 6.500041723251343
Epoch: 5, Steps: 32 | Train Loss: 43.114 Vali Loss: 131.490 Vali Acc: 0.237 Test Loss: 131.490 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.163626670837402
Epoch: 6, Steps: 32 | Train Loss: 21.273 Vali Loss: 87.421 Vali Acc: 0.282 Test Loss: 87.421 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.633394718170166
Epoch: 7, Steps: 32 | Train Loss: 30.509 Vali Loss: 92.550 Vali Acc: 0.443 Test Loss: 92.550 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.1360695362091064
Epoch: 8, Steps: 32 | Train Loss: 16.872 Vali Loss: 97.073 Vali Acc: 0.496 Test Loss: 97.073 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.195302724838257
Epoch: 9, Steps: 32 | Train Loss: 27.327 Vali Loss: 84.389 Vali Acc: 0.542 Test Loss: 84.389 Test Acc: 0.542
Validation loss decreased (-0.503253 --> -0.541141).  Saving model ...
Epoch: 10 cost time: 7.108419179916382
Epoch: 10, Steps: 32 | Train Loss: 4.743 Vali Loss: 84.932 Vali Acc: 0.573 Test Loss: 84.932 Test Acc: 0.573
Validation loss decreased (-0.541141 --> -0.571670).  Saving model ...
Epoch: 11 cost time: 6.917347431182861
Epoch: 11, Steps: 32 | Train Loss: 30.491 Vali Loss: 118.219 Vali Acc: 0.366 Test Loss: 118.219 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.160606384277344
Epoch: 12, Steps: 32 | Train Loss: 26.933 Vali Loss: 150.329 Vali Acc: 0.359 Test Loss: 150.329 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.629331827163696
Epoch: 13, Steps: 32 | Train Loss: 5.233 Vali Loss: 133.835 Vali Acc: 0.420 Test Loss: 133.835 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.692786455154419
Epoch: 14, Steps: 32 | Train Loss: 4.273 Vali Loss: 139.184 Vali Acc: 0.573 Test Loss: 139.184 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.18342924118042
Epoch: 15, Steps: 32 | Train Loss: 1.141 Vali Loss: 159.521 Vali Acc: 0.542 Test Loss: 159.521 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.21219539642334
Epoch: 16, Steps: 32 | Train Loss: 11.837 Vali Loss: 145.927 Vali Acc: 0.557 Test Loss: 145.927 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.176196813583374
Epoch: 17, Steps: 32 | Train Loss: 5.895 Vali Loss: 185.694 Vali Acc: 0.511 Test Loss: 185.694 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 7.77881646156311
Epoch: 18, Steps: 32 | Train Loss: 7.165 Vali Loss: 158.023 Vali Acc: 0.481 Test Loss: 158.023 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.217220067977905
Epoch: 19, Steps: 32 | Train Loss: 7.535 Vali Loss: 176.865 Vali Acc: 0.527 Test Loss: 176.865 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.106202602386475
Epoch: 20, Steps: 32 | Train Loss: 3.120 Vali Loss: 146.947 Vali Acc: 0.252 Test Loss: 146.947 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 11810093
model size : 53.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.417479038238525
Epoch: 1, Steps: 32 | Train Loss: 19.470 Vali Loss: 33.424 Vali Acc: 0.183 Test Loss: 33.424 Test Acc: 0.183
Validation loss decreased (inf --> -0.182872).  Saving model ...
Epoch: 2 cost time: 6.4985504150390625
Epoch: 2, Steps: 32 | Train Loss: 28.187 Vali Loss: 43.431 Vali Acc: 0.237 Test Loss: 43.431 Test Acc: 0.237
Validation loss decreased (-0.182872 --> -0.236207).  Saving model ...
Epoch: 3 cost time: 6.607958555221558
Epoch: 3, Steps: 32 | Train Loss: 34.855 Vali Loss: 39.324 Vali Acc: 0.435 Test Loss: 39.324 Test Acc: 0.435
Validation loss decreased (-0.236207 --> -0.434721).  Saving model ...
Epoch: 4 cost time: 6.197913885116577
Epoch: 4, Steps: 32 | Train Loss: 26.516 Vali Loss: 29.172 Vali Acc: 0.504 Test Loss: 29.172 Test Acc: 0.504
Validation loss decreased (-0.434721 --> -0.503525).  Saving model ...
Epoch: 5 cost time: 6.961191415786743
Epoch: 5, Steps: 32 | Train Loss: 13.126 Vali Loss: 94.053 Vali Acc: 0.336 Test Loss: 94.053 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.893368721008301
Epoch: 6, Steps: 32 | Train Loss: 13.634 Vali Loss: 89.071 Vali Acc: 0.481 Test Loss: 89.071 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.391061067581177
Epoch: 7, Steps: 32 | Train Loss: 17.129 Vali Loss: 102.448 Vali Acc: 0.519 Test Loss: 102.448 Test Acc: 0.519
Validation loss decreased (-0.503525 --> -0.518059).  Saving model ...
Epoch: 8 cost time: 6.109370708465576
Epoch: 8, Steps: 32 | Train Loss: 34.358 Vali Loss: 85.578 Vali Acc: 0.519 Test Loss: 85.578 Test Acc: 0.519
Validation loss decreased (-0.518059 --> -0.518228).  Saving model ...
Epoch: 9 cost time: 6.989436149597168
Epoch: 9, Steps: 32 | Train Loss: 38.215 Vali Loss: 87.209 Vali Acc: 0.527 Test Loss: 87.209 Test Acc: 0.527
Validation loss decreased (-0.518228 --> -0.525845).  Saving model ...
Epoch: 10 cost time: 6.7250378131866455
Epoch: 10, Steps: 32 | Train Loss: 18.574 Vali Loss: 65.742 Vali Acc: 0.534 Test Loss: 65.742 Test Acc: 0.534
Validation loss decreased (-0.525845 --> -0.533694).  Saving model ...
Epoch: 11 cost time: 7.339650630950928
Epoch: 11, Steps: 32 | Train Loss: 24.480 Vali Loss: 80.906 Vali Acc: 0.542 Test Loss: 80.906 Test Acc: 0.542
Validation loss decreased (-0.533694 --> -0.541176).  Saving model ...
Epoch: 12 cost time: 7.529325723648071
Epoch: 12, Steps: 32 | Train Loss: 23.326 Vali Loss: 69.436 Vali Acc: 0.557 Test Loss: 69.436 Test Acc: 0.557
Validation loss decreased (-0.541176 --> -0.556558).  Saving model ...
Epoch: 13 cost time: 6.787925720214844
Epoch: 13, Steps: 32 | Train Loss: 13.510 Vali Loss: 102.418 Vali Acc: 0.550 Test Loss: 102.418 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.784700393676758
Epoch: 14, Steps: 32 | Train Loss: 13.778 Vali Loss: 135.952 Vali Acc: 0.595 Test Loss: 135.952 Test Acc: 0.595
Validation loss decreased (-0.556558 --> -0.594060).  Saving model ...
Epoch: 15 cost time: 7.306299924850464
Epoch: 15, Steps: 32 | Train Loss: 9.087 Vali Loss: 135.322 Vali Acc: 0.397 Test Loss: 135.322 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.9422078132629395
Epoch: 16, Steps: 32 | Train Loss: 3.690 Vali Loss: 149.791 Vali Acc: 0.466 Test Loss: 149.791 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.853846549987793
Epoch: 17, Steps: 32 | Train Loss: 3.610 Vali Loss: 82.047 Vali Acc: 0.603 Test Loss: 82.047 Test Acc: 0.603
Validation loss decreased (-0.594060 --> -0.602233).  Saving model ...
Epoch: 18 cost time: 6.455480575561523
Epoch: 18, Steps: 32 | Train Loss: 5.088 Vali Loss: 130.505 Vali Acc: 0.527 Test Loss: 130.505 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.744579553604126
Epoch: 19, Steps: 32 | Train Loss: 7.189 Vali Loss: 78.245 Vali Acc: 0.595 Test Loss: 78.245 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.0887134075164795
Epoch: 20, Steps: 32 | Train Loss: 1.491 Vali Loss: 69.152 Vali Acc: 0.618 Test Loss: 69.152 Test Acc: 0.618
Validation loss decreased (-0.602233 --> -0.617629).  Saving model ...
Epoch: 21 cost time: 6.663272857666016
Epoch: 21, Steps: 32 | Train Loss: 2.849 Vali Loss: 77.028 Vali Acc: 0.550 Test Loss: 77.028 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.589775562286377
Epoch: 22, Steps: 32 | Train Loss: 0.354 Vali Loss: 90.011 Vali Acc: 0.641 Test Loss: 90.011 Test Acc: 0.641
Validation loss decreased (-0.617629 --> -0.640321).  Saving model ...
Epoch: 23 cost time: 6.58952522277832
Epoch: 23, Steps: 32 | Train Loss: 0.463 Vali Loss: 107.934 Vali Acc: 0.611 Test Loss: 107.934 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 6.481246471405029
Epoch: 24, Steps: 32 | Train Loss: 0.321 Vali Loss: 83.561 Vali Acc: 0.595 Test Loss: 83.561 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.381736516952515
Epoch: 25, Steps: 32 | Train Loss: 2.490 Vali Loss: 124.739 Vali Acc: 0.595 Test Loss: 124.739 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 6.651068449020386
Epoch: 26, Steps: 32 | Train Loss: 2.900 Vali Loss: 156.002 Vali Acc: 0.557 Test Loss: 156.002 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 7.109158039093018
Epoch: 27, Steps: 32 | Train Loss: 0.647 Vali Loss: 134.076 Vali Acc: 0.550 Test Loss: 134.076 Test Acc: 0.550
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.805070877075195
Epoch: 28, Steps: 32 | Train Loss: 2.076 Vali Loss: 160.264 Vali Acc: 0.542 Test Loss: 160.264 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.536064147949219
Epoch: 29, Steps: 32 | Train Loss: 0.546 Vali Loss: 141.552 Vali Acc: 0.550 Test Loss: 141.552 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 6.974262952804565
Epoch: 30, Steps: 32 | Train Loss: 2.350 Vali Loss: 169.372 Vali Acc: 0.511 Test Loss: 169.372 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.972963094711304
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 185.276 Vali Acc: 0.504 Test Loss: 185.276 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.802178621292114
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 125.237 Vali Acc: 0.573 Test Loss: 125.237 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 11810093
model size : 53.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.5557777881622314
Epoch: 1, Steps: 32 | Train Loss: 21.057 Vali Loss: 27.649 Vali Acc: 0.420 Test Loss: 27.649 Test Acc: 0.420
Validation loss decreased (inf --> -0.419571).  Saving model ...
Epoch: 2 cost time: 6.156803131103516
Epoch: 2, Steps: 32 | Train Loss: 21.949 Vali Loss: 25.261 Vali Acc: 0.183 Test Loss: 25.261 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.353412389755249
Epoch: 3, Steps: 32 | Train Loss: 26.615 Vali Loss: 68.943 Vali Acc: 0.427 Test Loss: 68.943 Test Acc: 0.427
Validation loss decreased (-0.419571 --> -0.426791).  Saving model ...
Epoch: 4 cost time: 5.5398054122924805
Epoch: 4, Steps: 32 | Train Loss: 40.802 Vali Loss: 86.181 Vali Acc: 0.221 Test Loss: 86.181 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.725508689880371
Epoch: 5, Steps: 32 | Train Loss: 37.197 Vali Loss: 102.663 Vali Acc: 0.382 Test Loss: 102.663 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.346043825149536
Epoch: 6, Steps: 32 | Train Loss: 22.561 Vali Loss: 100.203 Vali Acc: 0.328 Test Loss: 100.203 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.157285451889038
Epoch: 7, Steps: 32 | Train Loss: 36.396 Vali Loss: 73.384 Vali Acc: 0.450 Test Loss: 73.384 Test Acc: 0.450
Validation loss decreased (-0.426791 --> -0.449648).  Saving model ...
Epoch: 8 cost time: 6.39624285697937
Epoch: 8, Steps: 32 | Train Loss: 17.399 Vali Loss: 100.843 Vali Acc: 0.382 Test Loss: 100.843 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.516024112701416
Epoch: 9, Steps: 32 | Train Loss: 47.137 Vali Loss: 105.455 Vali Acc: 0.305 Test Loss: 105.455 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.932853937149048
Epoch: 10, Steps: 32 | Train Loss: 28.016 Vali Loss: 101.330 Vali Acc: 0.511 Test Loss: 101.330 Test Acc: 0.511
Validation loss decreased (-0.449648 --> -0.510437).  Saving model ...
Epoch: 11 cost time: 6.35038685798645
Epoch: 11, Steps: 32 | Train Loss: 26.525 Vali Loss: 110.917 Vali Acc: 0.260 Test Loss: 110.917 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.32797646522522
Epoch: 12, Steps: 32 | Train Loss: 13.419 Vali Loss: 58.946 Vali Acc: 0.527 Test Loss: 58.946 Test Acc: 0.527
Validation loss decreased (-0.510437 --> -0.526128).  Saving model ...
Epoch: 13 cost time: 6.505493402481079
Epoch: 13, Steps: 32 | Train Loss: 17.500 Vali Loss: 115.097 Vali Acc: 0.573 Test Loss: 115.097 Test Acc: 0.573
Validation loss decreased (-0.526128 --> -0.571368).  Saving model ...
Epoch: 14 cost time: 5.762369155883789
Epoch: 14, Steps: 32 | Train Loss: 43.863 Vali Loss: 222.602 Vali Acc: 0.244 Test Loss: 222.602 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.3080666065216064
Epoch: 15, Steps: 32 | Train Loss: 4.912 Vali Loss: 180.284 Vali Acc: 0.565 Test Loss: 180.284 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.678831577301025
Epoch: 16, Steps: 32 | Train Loss: 6.338 Vali Loss: 164.788 Vali Acc: 0.603 Test Loss: 164.788 Test Acc: 0.603
Validation loss decreased (-0.571368 --> -0.601406).  Saving model ...
Epoch: 17 cost time: 5.855255365371704
Epoch: 17, Steps: 32 | Train Loss: 2.176 Vali Loss: 92.585 Vali Acc: 0.618 Test Loss: 92.585 Test Acc: 0.618
Validation loss decreased (-0.601406 --> -0.617395).  Saving model ...
Epoch: 18 cost time: 5.953116416931152
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 122.502 Vali Acc: 0.595 Test Loss: 122.502 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.426260709762573
Epoch: 19, Steps: 32 | Train Loss: 1.881 Vali Loss: 82.803 Vali Acc: 0.573 Test Loss: 82.803 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.856871128082275
Epoch: 20, Steps: 32 | Train Loss: 3.249 Vali Loss: 97.866 Vali Acc: 0.603 Test Loss: 97.866 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.154223918914795
Epoch: 21, Steps: 32 | Train Loss: 5.374 Vali Loss: 156.782 Vali Acc: 0.565 Test Loss: 156.782 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.167174577713013
Epoch: 22, Steps: 32 | Train Loss: 1.284 Vali Loss: 121.010 Vali Acc: 0.611 Test Loss: 121.010 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.8376784324646
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.620 Vali Acc: 0.611 Test Loss: 126.620 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.08614182472229
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.826 Vali Acc: 0.603 Test Loss: 126.826 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.055900812149048
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.833 Vali Acc: 0.603 Test Loss: 126.833 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.921375036239624
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.833 Vali Acc: 0.603 Test Loss: 126.833 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.157668590545654
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 126.833 Vali Acc: 0.603 Test Loss: 126.833 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 11810093
model size : 53.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.364820241928101
Epoch: 1, Steps: 32 | Train Loss: 20.601 Vali Loss: 18.837 Vali Acc: 0.237 Test Loss: 18.837 Test Acc: 0.237
Validation loss decreased (inf --> -0.236453).  Saving model ...
Epoch: 2 cost time: 5.602770805358887
Epoch: 2, Steps: 32 | Train Loss: 27.969 Vali Loss: 35.321 Vali Acc: 0.206 Test Loss: 35.321 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.174154043197632
Epoch: 3, Steps: 32 | Train Loss: 26.444 Vali Loss: 42.931 Vali Acc: 0.191 Test Loss: 42.931 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.587054967880249
Epoch: 4, Steps: 32 | Train Loss: 29.172 Vali Loss: 34.598 Vali Acc: 0.382 Test Loss: 34.598 Test Acc: 0.382
Validation loss decreased (-0.236453 --> -0.381333).  Saving model ...
Epoch: 5 cost time: 5.526360988616943
Epoch: 5, Steps: 32 | Train Loss: 22.636 Vali Loss: 85.343 Vali Acc: 0.290 Test Loss: 85.343 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.744787693023682
Epoch: 6, Steps: 32 | Train Loss: 33.367 Vali Loss: 85.133 Vali Acc: 0.229 Test Loss: 85.133 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.901447296142578
Epoch: 7, Steps: 32 | Train Loss: 38.459 Vali Loss: 73.918 Vali Acc: 0.504 Test Loss: 73.918 Test Acc: 0.504
Validation loss decreased (-0.381333 --> -0.503078).  Saving model ...
Epoch: 8 cost time: 5.460169315338135
Epoch: 8, Steps: 32 | Train Loss: 25.181 Vali Loss: 90.878 Vali Acc: 0.229 Test Loss: 90.878 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.554478168487549
Epoch: 9, Steps: 32 | Train Loss: 37.642 Vali Loss: 75.827 Vali Acc: 0.473 Test Loss: 75.827 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.7745749950408936
Epoch: 10, Steps: 32 | Train Loss: 22.375 Vali Loss: 57.521 Vali Acc: 0.527 Test Loss: 57.521 Test Acc: 0.527
Validation loss decreased (-0.503078 --> -0.526142).  Saving model ...
Epoch: 11 cost time: 5.904111385345459
Epoch: 11, Steps: 32 | Train Loss: 22.509 Vali Loss: 122.176 Vali Acc: 0.260 Test Loss: 122.176 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.174977779388428
Epoch: 12, Steps: 32 | Train Loss: 2.888 Vali Loss: 67.104 Vali Acc: 0.542 Test Loss: 67.104 Test Acc: 0.542
Validation loss decreased (-0.526142 --> -0.541314).  Saving model ...
Epoch: 13 cost time: 5.70867395401001
Epoch: 13, Steps: 32 | Train Loss: 3.146 Vali Loss: 77.003 Vali Acc: 0.550 Test Loss: 77.003 Test Acc: 0.550
Validation loss decreased (-0.541314 --> -0.548848).  Saving model ...
Epoch: 14 cost time: 5.5541088581085205
Epoch: 14, Steps: 32 | Train Loss: 10.001 Vali Loss: 110.844 Vali Acc: 0.550 Test Loss: 110.844 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.0975096225738525
Epoch: 15, Steps: 32 | Train Loss: 2.584 Vali Loss: 144.776 Vali Acc: 0.305 Test Loss: 144.776 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.022860765457153
Epoch: 16, Steps: 32 | Train Loss: 21.493 Vali Loss: 126.368 Vali Acc: 0.626 Test Loss: 126.368 Test Acc: 0.626
Validation loss decreased (-0.548848 --> -0.624691).  Saving model ...
Epoch: 17 cost time: 5.397967100143433
Epoch: 17, Steps: 32 | Train Loss: 1.735 Vali Loss: 126.973 Vali Acc: 0.542 Test Loss: 126.973 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.715534210205078
Epoch: 18, Steps: 32 | Train Loss: 1.866 Vali Loss: 182.928 Vali Acc: 0.275 Test Loss: 182.928 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.363588333129883
Epoch: 19, Steps: 32 | Train Loss: 1.302 Vali Loss: 124.985 Vali Acc: 0.557 Test Loss: 124.985 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.817264080047607
Epoch: 20, Steps: 32 | Train Loss: 3.075 Vali Loss: 230.078 Vali Acc: 0.176 Test Loss: 230.078 Test Acc: 0.176
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.1543145179748535
Epoch: 21, Steps: 32 | Train Loss: 15.521 Vali Loss: 254.072 Vali Acc: 0.496 Test Loss: 254.072 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.209021091461182
Epoch: 22, Steps: 32 | Train Loss: 7.353 Vali Loss: 284.949 Vali Acc: 0.481 Test Loss: 284.949 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.691656112670898
Epoch: 23, Steps: 32 | Train Loss: 10.640 Vali Loss: 222.371 Vali Acc: 0.565 Test Loss: 222.371 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.41375470161438
Epoch: 24, Steps: 32 | Train Loss: 8.387 Vali Loss: 201.334 Vali Acc: 0.519 Test Loss: 201.334 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.112515687942505
Epoch: 25, Steps: 32 | Train Loss: 0.938 Vali Loss: 160.207 Vali Acc: 0.588 Test Loss: 160.207 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.95556640625
Epoch: 26, Steps: 32 | Train Loss: 5.824 Vali Loss: 269.807 Vali Acc: 0.542 Test Loss: 269.807 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 11810093
model size : 53.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.594306945800781
Epoch: 1, Steps: 32 | Train Loss: 12.269 Vali Loss: 40.313 Vali Acc: 0.107 Test Loss: 40.313 Test Acc: 0.107
Validation loss decreased (inf --> -0.106467).  Saving model ...
Epoch: 2 cost time: 6.790560722351074
Epoch: 2, Steps: 32 | Train Loss: 18.255 Vali Loss: 29.289 Vali Acc: 0.443 Test Loss: 29.289 Test Acc: 0.443
Validation loss decreased (-0.106467 --> -0.442455).  Saving model ...
Epoch: 3 cost time: 7.146501541137695
Epoch: 3, Steps: 32 | Train Loss: 23.682 Vali Loss: 22.615 Vali Acc: 0.489 Test Loss: 22.615 Test Acc: 0.489
Validation loss decreased (-0.442455 --> -0.488323).  Saving model ...
Epoch: 4 cost time: 6.964559555053711
Epoch: 4, Steps: 32 | Train Loss: 32.194 Vali Loss: 106.026 Vali Acc: 0.145 Test Loss: 106.026 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.921647548675537
Epoch: 5, Steps: 32 | Train Loss: 42.363 Vali Loss: 111.345 Vali Acc: 0.443 Test Loss: 111.345 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.015542507171631
Epoch: 6, Steps: 32 | Train Loss: 76.058 Vali Loss: 178.382 Vali Acc: 0.191 Test Loss: 178.382 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.906582832336426
Epoch: 7, Steps: 32 | Train Loss: 53.626 Vali Loss: 78.766 Vali Acc: 0.405 Test Loss: 78.766 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.5447118282318115
Epoch: 8, Steps: 32 | Train Loss: 34.278 Vali Loss: 83.420 Vali Acc: 0.519 Test Loss: 83.420 Test Acc: 0.519
Validation loss decreased (-0.488323 --> -0.518250).  Saving model ...
Epoch: 9 cost time: 7.10925555229187
Epoch: 9, Steps: 32 | Train Loss: 35.540 Vali Loss: 95.969 Vali Acc: 0.313 Test Loss: 95.969 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.127710342407227
Epoch: 10, Steps: 32 | Train Loss: 11.665 Vali Loss: 100.586 Vali Acc: 0.542 Test Loss: 100.586 Test Acc: 0.542
Validation loss decreased (-0.518250 --> -0.540979).  Saving model ...
Epoch: 11 cost time: 7.249974727630615
Epoch: 11, Steps: 32 | Train Loss: 12.955 Vali Loss: 137.878 Vali Acc: 0.527 Test Loss: 137.878 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.525262832641602
Epoch: 12, Steps: 32 | Train Loss: 13.655 Vali Loss: 173.575 Vali Acc: 0.435 Test Loss: 173.575 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.4089977741241455
Epoch: 13, Steps: 32 | Train Loss: 29.181 Vali Loss: 126.450 Vali Acc: 0.534 Test Loss: 126.450 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.152109861373901
Epoch: 14, Steps: 32 | Train Loss: 9.786 Vali Loss: 118.905 Vali Acc: 0.595 Test Loss: 118.905 Test Acc: 0.595
Validation loss decreased (-0.540979 --> -0.594231).  Saving model ...
Epoch: 15 cost time: 6.997114658355713
Epoch: 15, Steps: 32 | Train Loss: 8.416 Vali Loss: 75.843 Vali Acc: 0.618 Test Loss: 75.843 Test Acc: 0.618
Validation loss decreased (-0.594231 --> -0.617562).  Saving model ...
Epoch: 16 cost time: 7.276033878326416
Epoch: 16, Steps: 32 | Train Loss: 4.348 Vali Loss: 87.331 Vali Acc: 0.573 Test Loss: 87.331 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.639880657196045
Epoch: 17, Steps: 32 | Train Loss: 4.704 Vali Loss: 126.964 Vali Acc: 0.595 Test Loss: 126.964 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.949717283248901
Epoch: 18, Steps: 32 | Train Loss: 9.723 Vali Loss: 96.507 Vali Acc: 0.603 Test Loss: 96.507 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.823137521743774
Epoch: 19, Steps: 32 | Train Loss: 3.669 Vali Loss: 74.959 Vali Acc: 0.649 Test Loss: 74.959 Test Acc: 0.649
Validation loss decreased (-0.617562 --> -0.648105).  Saving model ...
Epoch: 20 cost time: 6.926912069320679
Epoch: 20, Steps: 32 | Train Loss: 0.737 Vali Loss: 82.201 Vali Acc: 0.634 Test Loss: 82.201 Test Acc: 0.634
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.035191297531128
Epoch: 21, Steps: 32 | Train Loss: 6.627 Vali Loss: 137.045 Vali Acc: 0.573 Test Loss: 137.045 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.720214366912842
Epoch: 22, Steps: 32 | Train Loss: 4.649 Vali Loss: 123.334 Vali Acc: 0.595 Test Loss: 123.334 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 7.262481689453125
Epoch: 23, Steps: 32 | Train Loss: 0.500 Vali Loss: 187.115 Vali Acc: 0.611 Test Loss: 187.115 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.063117980957031
Epoch: 24, Steps: 32 | Train Loss: 1.124 Vali Loss: 116.401 Vali Acc: 0.534 Test Loss: 116.401 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 7.519404411315918
Epoch: 25, Steps: 32 | Train Loss: 1.258 Vali Loss: 129.714 Vali Acc: 0.603 Test Loss: 129.714 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.436598062515259
Epoch: 26, Steps: 32 | Train Loss: 2.340 Vali Loss: 129.856 Vali Acc: 0.565 Test Loss: 129.856 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.055615186691284
Epoch: 27, Steps: 32 | Train Loss: 0.158 Vali Loss: 138.225 Vali Acc: 0.595 Test Loss: 138.225 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.232428312301636
Epoch: 28, Steps: 32 | Train Loss: 1.297 Vali Loss: 147.279 Vali Acc: 0.573 Test Loss: 147.279 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 7.060930967330933
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 137.785 Vali Acc: 0.595 Test Loss: 137.785 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.648854961832061
model parameter : 11679021
model size : 53.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.910160541534424
Epoch: 1, Steps: 32 | Train Loss: 15.743 Vali Loss: 34.558 Vali Acc: 0.115 Test Loss: 34.558 Test Acc: 0.115
Validation loss decreased (inf --> -0.114158).  Saving model ...
Epoch: 2 cost time: 6.952605247497559
Epoch: 2, Steps: 32 | Train Loss: 18.620 Vali Loss: 24.008 Vali Acc: 0.313 Test Loss: 24.008 Test Acc: 0.313
Validation loss decreased (-0.114158 --> -0.312737).  Saving model ...
Epoch: 3 cost time: 6.458656072616577
Epoch: 3, Steps: 32 | Train Loss: 22.574 Vali Loss: 30.615 Vali Acc: 0.527 Test Loss: 30.615 Test Acc: 0.527
Validation loss decreased (-0.312737 --> -0.526411).  Saving model ...
Epoch: 4 cost time: 6.100203990936279
Epoch: 4, Steps: 32 | Train Loss: 19.756 Vali Loss: 118.685 Vali Acc: 0.145 Test Loss: 118.685 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.530726671218872
Epoch: 5, Steps: 32 | Train Loss: 55.216 Vali Loss: 109.943 Vali Acc: 0.328 Test Loss: 109.943 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.58184289932251
Epoch: 6, Steps: 32 | Train Loss: 47.772 Vali Loss: 122.024 Vali Acc: 0.351 Test Loss: 122.024 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.7559874057769775
Epoch: 7, Steps: 32 | Train Loss: 28.659 Vali Loss: 98.095 Vali Acc: 0.267 Test Loss: 98.095 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.863783121109009
Epoch: 8, Steps: 32 | Train Loss: 26.866 Vali Loss: 113.127 Vali Acc: 0.481 Test Loss: 113.127 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.4212586879730225
Epoch: 9, Steps: 32 | Train Loss: 34.199 Vali Loss: 140.515 Vali Acc: 0.321 Test Loss: 140.515 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 7.018197536468506
Epoch: 10, Steps: 32 | Train Loss: 32.037 Vali Loss: 107.487 Vali Acc: 0.481 Test Loss: 107.487 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.875226974487305
Epoch: 11, Steps: 32 | Train Loss: 25.770 Vali Loss: 91.733 Vali Acc: 0.511 Test Loss: 91.733 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 7.0243048667907715
Epoch: 12, Steps: 32 | Train Loss: 12.071 Vali Loss: 103.490 Vali Acc: 0.328 Test Loss: 103.490 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 7.093282699584961
Epoch: 13, Steps: 32 | Train Loss: 25.620 Vali Loss: 50.685 Vali Acc: 0.618 Test Loss: 50.685 Test Acc: 0.618
Validation loss decreased (-0.526411 --> -0.617814).  Saving model ...
Epoch: 14 cost time: 6.716202735900879
Epoch: 14, Steps: 32 | Train Loss: 10.774 Vali Loss: 94.168 Vali Acc: 0.458 Test Loss: 94.168 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.365823745727539
Epoch: 15, Steps: 32 | Train Loss: 5.142 Vali Loss: 123.091 Vali Acc: 0.519 Test Loss: 123.091 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.4124767780303955
Epoch: 16, Steps: 32 | Train Loss: 9.074 Vali Loss: 152.093 Vali Acc: 0.435 Test Loss: 152.093 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.172635555267334
Epoch: 17, Steps: 32 | Train Loss: 51.721 Vali Loss: 131.221 Vali Acc: 0.534 Test Loss: 131.221 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.242693662643433
Epoch: 18, Steps: 32 | Train Loss: 2.309 Vali Loss: 136.790 Vali Acc: 0.542 Test Loss: 136.790 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.382405519485474
Epoch: 19, Steps: 32 | Train Loss: 1.541 Vali Loss: 101.599 Vali Acc: 0.527 Test Loss: 101.599 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.8713366985321045
Epoch: 20, Steps: 32 | Train Loss: 0.874 Vali Loss: 132.904 Vali Acc: 0.534 Test Loss: 132.904 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.9337170124053955
Epoch: 21, Steps: 32 | Train Loss: 0.672 Vali Loss: 135.776 Vali Acc: 0.466 Test Loss: 135.776 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.293069124221802
Epoch: 22, Steps: 32 | Train Loss: 0.897 Vali Loss: 118.957 Vali Acc: 0.450 Test Loss: 118.957 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.381743431091309
Epoch: 23, Steps: 32 | Train Loss: 0.312 Vali Loss: 156.919 Vali Acc: 0.328 Test Loss: 156.919 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 11679021
model size : 53.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.296630382537842
Epoch: 1, Steps: 32 | Train Loss: 14.478 Vali Loss: 49.228 Vali Acc: 0.099 Test Loss: 49.228 Test Acc: 0.099
Validation loss decreased (inf --> -0.098744).  Saving model ...
Epoch: 2 cost time: 6.333220958709717
Epoch: 2, Steps: 32 | Train Loss: 27.499 Vali Loss: 46.577 Vali Acc: 0.176 Test Loss: 46.577 Test Acc: 0.176
Validation loss decreased (-0.098744 --> -0.175107).  Saving model ...
Epoch: 3 cost time: 6.609341621398926
Epoch: 3, Steps: 32 | Train Loss: 34.218 Vali Loss: 53.923 Vali Acc: 0.359 Test Loss: 53.923 Test Acc: 0.359
Validation loss decreased (-0.175107 --> -0.358239).  Saving model ...
Epoch: 4 cost time: 6.642258644104004
Epoch: 4, Steps: 32 | Train Loss: 27.646 Vali Loss: 69.444 Vali Acc: 0.458 Test Loss: 69.444 Test Acc: 0.458
Validation loss decreased (-0.358239 --> -0.457321).  Saving model ...
Epoch: 5 cost time: 6.275975704193115
Epoch: 5, Steps: 32 | Train Loss: 46.274 Vali Loss: 118.860 Vali Acc: 0.328 Test Loss: 118.860 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.179116487503052
Epoch: 6, Steps: 32 | Train Loss: 55.722 Vali Loss: 121.699 Vali Acc: 0.282 Test Loss: 121.699 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.071777820587158
Epoch: 7, Steps: 32 | Train Loss: 38.815 Vali Loss: 213.346 Vali Acc: 0.145 Test Loss: 213.346 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.3658287525177
Epoch: 8, Steps: 32 | Train Loss: 43.328 Vali Loss: 75.435 Vali Acc: 0.519 Test Loss: 75.435 Test Acc: 0.519
Validation loss decreased (-0.457321 --> -0.518330).  Saving model ...
Epoch: 9 cost time: 5.803828477859497
Epoch: 9, Steps: 32 | Train Loss: 36.527 Vali Loss: 103.141 Vali Acc: 0.344 Test Loss: 103.141 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.6655051708221436
Epoch: 10, Steps: 32 | Train Loss: 26.095 Vali Loss: 101.381 Vali Acc: 0.504 Test Loss: 101.381 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.426939487457275
Epoch: 11, Steps: 32 | Train Loss: 18.235 Vali Loss: 81.002 Vali Acc: 0.534 Test Loss: 81.002 Test Acc: 0.534
Validation loss decreased (-0.518330 --> -0.533541).  Saving model ...
Epoch: 12 cost time: 6.130620241165161
Epoch: 12, Steps: 32 | Train Loss: 13.866 Vali Loss: 120.979 Vali Acc: 0.565 Test Loss: 120.979 Test Acc: 0.565
Validation loss decreased (-0.533541 --> -0.563676).  Saving model ...
Epoch: 13 cost time: 6.053614377975464
Epoch: 13, Steps: 32 | Train Loss: 3.098 Vali Loss: 129.349 Vali Acc: 0.542 Test Loss: 129.349 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.3710432052612305
Epoch: 14, Steps: 32 | Train Loss: 18.902 Vali Loss: 137.651 Vali Acc: 0.427 Test Loss: 137.651 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.441293954849243
Epoch: 15, Steps: 32 | Train Loss: 15.924 Vali Loss: 172.883 Vali Acc: 0.527 Test Loss: 172.883 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.267881870269775
Epoch: 16, Steps: 32 | Train Loss: 6.724 Vali Loss: 110.974 Vali Acc: 0.626 Test Loss: 110.974 Test Acc: 0.626
Validation loss decreased (-0.563676 --> -0.624844).  Saving model ...
Epoch: 17 cost time: 6.698364496231079
Epoch: 17, Steps: 32 | Train Loss: 8.295 Vali Loss: 109.409 Vali Acc: 0.603 Test Loss: 109.409 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.0176050662994385
Epoch: 18, Steps: 32 | Train Loss: 5.732 Vali Loss: 223.458 Vali Acc: 0.298 Test Loss: 223.458 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.390812397003174
Epoch: 19, Steps: 32 | Train Loss: 5.084 Vali Loss: 132.889 Vali Acc: 0.565 Test Loss: 132.889 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.442431211471558
Epoch: 20, Steps: 32 | Train Loss: 6.470 Vali Loss: 197.387 Vali Acc: 0.542 Test Loss: 197.387 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.104533910751343
Epoch: 21, Steps: 32 | Train Loss: 5.063 Vali Loss: 182.877 Vali Acc: 0.588 Test Loss: 182.877 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.3849804401397705
Epoch: 22, Steps: 32 | Train Loss: 0.046 Vali Loss: 142.639 Vali Acc: 0.588 Test Loss: 142.639 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.22960352897644
Epoch: 23, Steps: 32 | Train Loss: 4.541 Vali Loss: 245.045 Vali Acc: 0.344 Test Loss: 245.045 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.425586223602295
Epoch: 24, Steps: 32 | Train Loss: 6.920 Vali Loss: 184.227 Vali Acc: 0.450 Test Loss: 184.227 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.7207441329956055
Epoch: 25, Steps: 32 | Train Loss: 9.468 Vali Loss: 152.618 Vali Acc: 0.573 Test Loss: 152.618 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.298215627670288
Epoch: 26, Steps: 32 | Train Loss: 0.753 Vali Loss: 220.969 Vali Acc: 0.550 Test Loss: 220.969 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 11679021
model size : 53.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.064242839813232
Epoch: 1, Steps: 32 | Train Loss: 13.842 Vali Loss: 27.202 Vali Acc: 0.107 Test Loss: 27.202 Test Acc: 0.107
Validation loss decreased (inf --> -0.106598).  Saving model ...
Epoch: 2 cost time: 5.4604716300964355
Epoch: 2, Steps: 32 | Train Loss: 19.714 Vali Loss: 31.579 Vali Acc: 0.420 Test Loss: 31.579 Test Acc: 0.420
Validation loss decreased (-0.106598 --> -0.419532).  Saving model ...
Epoch: 3 cost time: 6.447973012924194
Epoch: 3, Steps: 32 | Train Loss: 26.844 Vali Loss: 64.101 Vali Acc: 0.420 Test Loss: 64.101 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.365004062652588
Epoch: 4, Steps: 32 | Train Loss: 51.590 Vali Loss: 31.768 Vali Acc: 0.473 Test Loss: 31.768 Test Acc: 0.473
Validation loss decreased (-0.419532 --> -0.472965).  Saving model ...
Epoch: 5 cost time: 5.949207782745361
Epoch: 5, Steps: 32 | Train Loss: 31.712 Vali Loss: 111.058 Vali Acc: 0.137 Test Loss: 111.058 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.217955589294434
Epoch: 6, Steps: 32 | Train Loss: 66.187 Vali Loss: 148.370 Vali Acc: 0.145 Test Loss: 148.370 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.9111738204956055
Epoch: 7, Steps: 32 | Train Loss: 53.325 Vali Loss: 118.762 Vali Acc: 0.176 Test Loss: 118.762 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.602074146270752
Epoch: 8, Steps: 32 | Train Loss: 49.850 Vali Loss: 73.247 Vali Acc: 0.496 Test Loss: 73.247 Test Acc: 0.496
Validation loss decreased (-0.472965 --> -0.495451).  Saving model ...
Epoch: 9 cost time: 6.1731507778167725
Epoch: 9, Steps: 32 | Train Loss: 33.594 Vali Loss: 82.562 Vali Acc: 0.328 Test Loss: 82.562 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.037284851074219
Epoch: 10, Steps: 32 | Train Loss: 33.339 Vali Loss: 71.447 Vali Acc: 0.550 Test Loss: 71.447 Test Acc: 0.550
Validation loss decreased (-0.495451 --> -0.548904).  Saving model ...
Epoch: 11 cost time: 6.0602076053619385
Epoch: 11, Steps: 32 | Train Loss: 14.723 Vali Loss: 105.139 Vali Acc: 0.511 Test Loss: 105.139 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.052448987960815
Epoch: 12, Steps: 32 | Train Loss: 11.148 Vali Loss: 119.306 Vali Acc: 0.557 Test Loss: 119.306 Test Acc: 0.557
Validation loss decreased (-0.548904 --> -0.556059).  Saving model ...
Epoch: 13 cost time: 5.944814682006836
Epoch: 13, Steps: 32 | Train Loss: 11.517 Vali Loss: 157.786 Vali Acc: 0.298 Test Loss: 157.786 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.719846963882446
Epoch: 14, Steps: 32 | Train Loss: 20.378 Vali Loss: 171.378 Vali Acc: 0.504 Test Loss: 171.378 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.697883129119873
Epoch: 15, Steps: 32 | Train Loss: 4.923 Vali Loss: 97.855 Vali Acc: 0.641 Test Loss: 97.855 Test Acc: 0.641
Validation loss decreased (-0.556059 --> -0.640243).  Saving model ...
Epoch: 16 cost time: 6.256029367446899
Epoch: 16, Steps: 32 | Train Loss: 8.425 Vali Loss: 128.847 Vali Acc: 0.550 Test Loss: 128.847 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.155546188354492
Epoch: 17, Steps: 32 | Train Loss: 2.511 Vali Loss: 182.921 Vali Acc: 0.305 Test Loss: 182.921 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.7061848640441895
Epoch: 18, Steps: 32 | Train Loss: 7.298 Vali Loss: 165.226 Vali Acc: 0.244 Test Loss: 165.226 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.296406030654907
Epoch: 19, Steps: 32 | Train Loss: 3.031 Vali Loss: 146.012 Vali Acc: 0.557 Test Loss: 146.012 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.885571002960205
Epoch: 20, Steps: 32 | Train Loss: 1.588 Vali Loss: 133.597 Vali Acc: 0.573 Test Loss: 133.597 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.4924516677856445
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 259.751 Vali Acc: 0.191 Test Loss: 259.751 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.445237636566162
Epoch: 22, Steps: 32 | Train Loss: 3.554 Vali Loss: 176.984 Vali Acc: 0.565 Test Loss: 176.984 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.047065258026123
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 192.752 Vali Acc: 0.573 Test Loss: 192.752 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.607933521270752
Epoch: 24, Steps: 32 | Train Loss: 0.738 Vali Loss: 172.143 Vali Acc: 0.397 Test Loss: 172.143 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.9800004959106445
Epoch: 25, Steps: 32 | Train Loss: 0.209 Vali Loss: 173.884 Vali Acc: 0.580 Test Loss: 173.884 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 11679021
model size : 53.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.07236123085022
Epoch: 1, Steps: 32 | Train Loss: 11.836 Vali Loss: 16.666 Vali Acc: 0.374 Test Loss: 16.666 Test Acc: 0.374
Validation loss decreased (inf --> -0.373879).  Saving model ...
Epoch: 2 cost time: 6.622831344604492
Epoch: 2, Steps: 32 | Train Loss: 23.089 Vali Loss: 42.450 Vali Acc: 0.481 Test Loss: 42.450 Test Acc: 0.481
Validation loss decreased (-0.373879 --> -0.480492).  Saving model ...
Epoch: 3 cost time: 6.8019185066223145
Epoch: 3, Steps: 32 | Train Loss: 23.597 Vali Loss: 58.886 Vali Acc: 0.397 Test Loss: 58.886 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.194431781768799
Epoch: 4, Steps: 32 | Train Loss: 31.064 Vali Loss: 76.855 Vali Acc: 0.160 Test Loss: 76.855 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.583775281906128
Epoch: 5, Steps: 32 | Train Loss: 15.422 Vali Loss: 73.110 Vali Acc: 0.420 Test Loss: 73.110 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.114797353744507
Epoch: 6, Steps: 32 | Train Loss: 19.019 Vali Loss: 67.578 Vali Acc: 0.496 Test Loss: 67.578 Test Acc: 0.496
Validation loss decreased (-0.480492 --> -0.495507).  Saving model ...
Epoch: 7 cost time: 7.500769376754761
Epoch: 7, Steps: 32 | Train Loss: 34.206 Vali Loss: 89.521 Vali Acc: 0.504 Test Loss: 89.521 Test Acc: 0.504
Validation loss decreased (-0.495507 --> -0.502922).  Saving model ...
Epoch: 8 cost time: 7.129399299621582
Epoch: 8, Steps: 32 | Train Loss: 37.514 Vali Loss: 76.346 Vali Acc: 0.344 Test Loss: 76.346 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.114153385162354
Epoch: 9, Steps: 32 | Train Loss: 22.716 Vali Loss: 92.018 Vali Acc: 0.267 Test Loss: 92.018 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.3996593952178955
Epoch: 10, Steps: 32 | Train Loss: 26.986 Vali Loss: 82.859 Vali Acc: 0.321 Test Loss: 82.859 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.5808939933776855
Epoch: 11, Steps: 32 | Train Loss: 12.675 Vali Loss: 81.483 Vali Acc: 0.527 Test Loss: 81.483 Test Acc: 0.527
Validation loss decreased (-0.502922 --> -0.525903).  Saving model ...
Epoch: 12 cost time: 8.30728006362915
Epoch: 12, Steps: 32 | Train Loss: 24.989 Vali Loss: 130.355 Vali Acc: 0.282 Test Loss: 130.355 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.090341567993164
Epoch: 13, Steps: 32 | Train Loss: 12.469 Vali Loss: 77.537 Vali Acc: 0.557 Test Loss: 77.537 Test Acc: 0.557
Validation loss decreased (-0.525903 --> -0.556477).  Saving model ...
Epoch: 14 cost time: 7.364187240600586
Epoch: 14, Steps: 32 | Train Loss: 11.314 Vali Loss: 102.857 Vali Acc: 0.550 Test Loss: 102.857 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.377213001251221
Epoch: 15, Steps: 32 | Train Loss: 5.102 Vali Loss: 85.714 Vali Acc: 0.595 Test Loss: 85.714 Test Acc: 0.595
Validation loss decreased (-0.556477 --> -0.594563).  Saving model ...
Epoch: 16 cost time: 7.255054712295532
Epoch: 16, Steps: 32 | Train Loss: 0.230 Vali Loss: 69.876 Vali Acc: 0.588 Test Loss: 69.876 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.213005542755127
Epoch: 17, Steps: 32 | Train Loss: 0.490 Vali Loss: 115.340 Vali Acc: 0.534 Test Loss: 115.340 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.324770927429199
Epoch: 18, Steps: 32 | Train Loss: 6.192 Vali Loss: 97.169 Vali Acc: 0.573 Test Loss: 97.169 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.908861875534058
Epoch: 19, Steps: 32 | Train Loss: 0.301 Vali Loss: 112.126 Vali Acc: 0.565 Test Loss: 112.126 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.050060033798218
Epoch: 20, Steps: 32 | Train Loss: 1.331 Vali Loss: 96.731 Vali Acc: 0.618 Test Loss: 96.731 Test Acc: 0.618
Validation loss decreased (-0.594563 --> -0.617353).  Saving model ...
Epoch: 21 cost time: 6.891465187072754
Epoch: 21, Steps: 32 | Train Loss: 1.168 Vali Loss: 113.390 Vali Acc: 0.573 Test Loss: 113.390 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.718217134475708
Epoch: 22, Steps: 32 | Train Loss: 4.731 Vali Loss: 115.986 Vali Acc: 0.580 Test Loss: 115.986 Test Acc: 0.580
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.40113091468811
Epoch: 23, Steps: 32 | Train Loss: 0.002 Vali Loss: 122.621 Vali Acc: 0.519 Test Loss: 122.621 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.143036842346191
Epoch: 24, Steps: 32 | Train Loss: 2.854 Vali Loss: 150.284 Vali Acc: 0.534 Test Loss: 150.284 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 7.742594480514526
Epoch: 25, Steps: 32 | Train Loss: 9.327 Vali Loss: 152.132 Vali Acc: 0.504 Test Loss: 152.132 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.087088108062744
Epoch: 26, Steps: 32 | Train Loss: 23.858 Vali Loss: 432.069 Vali Acc: 0.534 Test Loss: 432.069 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.722637414932251
Epoch: 27, Steps: 32 | Train Loss: 1.098 Vali Loss: 427.373 Vali Acc: 0.550 Test Loss: 427.373 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.125396490097046
Epoch: 28, Steps: 32 | Train Loss: 4.037 Vali Loss: 402.982 Vali Acc: 0.534 Test Loss: 402.982 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.800676584243774
Epoch: 29, Steps: 32 | Train Loss: 1.973 Vali Loss: 354.087 Vali Acc: 0.557 Test Loss: 354.087 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 7.17409086227417
Epoch: 30, Steps: 32 | Train Loss: 1.187 Vali Loss: 394.019 Vali Acc: 0.534 Test Loss: 394.019 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 11613485
model size : 53.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.236278057098389
Epoch: 1, Steps: 32 | Train Loss: 13.844 Vali Loss: 18.724 Vali Acc: 0.427 Test Loss: 18.724 Test Acc: 0.427
Validation loss decreased (inf --> -0.427294).  Saving model ...
Epoch: 2 cost time: 6.373838901519775
Epoch: 2, Steps: 32 | Train Loss: 18.551 Vali Loss: 17.083 Vali Acc: 0.374 Test Loss: 17.083 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.733675479888916
Epoch: 3, Steps: 32 | Train Loss: 20.696 Vali Loss: 23.819 Vali Acc: 0.313 Test Loss: 23.819 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.19877028465271
Epoch: 4, Steps: 32 | Train Loss: 29.182 Vali Loss: 83.386 Vali Acc: 0.252 Test Loss: 83.386 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.852821111679077
Epoch: 5, Steps: 32 | Train Loss: 25.726 Vali Loss: 76.760 Vali Acc: 0.267 Test Loss: 76.760 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.847963571548462
Epoch: 6, Steps: 32 | Train Loss: 25.931 Vali Loss: 70.611 Vali Acc: 0.534 Test Loss: 70.611 Test Acc: 0.534
Validation loss decreased (-0.427294 --> -0.533645).  Saving model ...
Epoch: 7 cost time: 6.651101112365723
Epoch: 7, Steps: 32 | Train Loss: 12.491 Vali Loss: 63.003 Vali Acc: 0.328 Test Loss: 63.003 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.6910271644592285
Epoch: 8, Steps: 32 | Train Loss: 15.758 Vali Loss: 58.682 Vali Acc: 0.534 Test Loss: 58.682 Test Acc: 0.534
Validation loss decreased (-0.533645 --> -0.533764).  Saving model ...
Epoch: 9 cost time: 6.361505746841431
Epoch: 9, Steps: 32 | Train Loss: 34.356 Vali Loss: 102.128 Vali Acc: 0.481 Test Loss: 102.128 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.518739461898804
Epoch: 10, Steps: 32 | Train Loss: 36.222 Vali Loss: 42.909 Vali Acc: 0.534 Test Loss: 42.909 Test Acc: 0.534
Validation loss decreased (-0.533764 --> -0.533922).  Saving model ...
Epoch: 11 cost time: 6.626122951507568
Epoch: 11, Steps: 32 | Train Loss: 33.067 Vali Loss: 90.834 Vali Acc: 0.473 Test Loss: 90.834 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.322224855422974
Epoch: 12, Steps: 32 | Train Loss: 20.760 Vali Loss: 108.862 Vali Acc: 0.328 Test Loss: 108.862 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.082566022872925
Epoch: 13, Steps: 32 | Train Loss: 25.588 Vali Loss: 54.077 Vali Acc: 0.595 Test Loss: 54.077 Test Acc: 0.595
Validation loss decreased (-0.533922 --> -0.594879).  Saving model ...
Epoch: 14 cost time: 6.3375163078308105
Epoch: 14, Steps: 32 | Train Loss: 3.858 Vali Loss: 52.259 Vali Acc: 0.595 Test Loss: 52.259 Test Acc: 0.595
Validation loss decreased (-0.594879 --> -0.594897).  Saving model ...
Epoch: 15 cost time: 6.159427881240845
Epoch: 15, Steps: 32 | Train Loss: 0.184 Vali Loss: 53.536 Vali Acc: 0.626 Test Loss: 53.536 Test Acc: 0.626
Validation loss decreased (-0.594897 --> -0.625419).  Saving model ...
Epoch: 16 cost time: 6.205843925476074
Epoch: 16, Steps: 32 | Train Loss: 7.294 Vali Loss: 128.804 Vali Acc: 0.573 Test Loss: 128.804 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.990521430969238
Epoch: 17, Steps: 32 | Train Loss: 33.077 Vali Loss: 120.216 Vali Acc: 0.527 Test Loss: 120.216 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.49621844291687
Epoch: 18, Steps: 32 | Train Loss: 2.152 Vali Loss: 214.146 Vali Acc: 0.519 Test Loss: 214.146 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.24025821685791
Epoch: 19, Steps: 32 | Train Loss: 10.574 Vali Loss: 97.111 Vali Acc: 0.618 Test Loss: 97.111 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.750049591064453
Epoch: 20, Steps: 32 | Train Loss: 3.004 Vali Loss: 110.349 Vali Acc: 0.519 Test Loss: 110.349 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.770599842071533
Epoch: 21, Steps: 32 | Train Loss: 6.337 Vali Loss: 104.160 Vali Acc: 0.542 Test Loss: 104.160 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.628662347793579
Epoch: 22, Steps: 32 | Train Loss: 1.804 Vali Loss: 139.873 Vali Acc: 0.473 Test Loss: 139.873 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.726467609405518
Epoch: 23, Steps: 32 | Train Loss: 4.712 Vali Loss: 111.198 Vali Acc: 0.573 Test Loss: 111.198 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.760124921798706
Epoch: 24, Steps: 32 | Train Loss: 2.887 Vali Loss: 257.032 Vali Acc: 0.534 Test Loss: 257.032 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 7.11058783531189
Epoch: 25, Steps: 32 | Train Loss: 2.641 Vali Loss: 90.009 Vali Acc: 0.611 Test Loss: 90.009 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 11613485
model size : 53.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.027199029922485
Epoch: 1, Steps: 32 | Train Loss: 17.319 Vali Loss: 15.725 Vali Acc: 0.412 Test Loss: 15.725 Test Acc: 0.412
Validation loss decreased (inf --> -0.412056).  Saving model ...
Epoch: 2 cost time: 6.302273750305176
Epoch: 2, Steps: 32 | Train Loss: 23.233 Vali Loss: 26.117 Vali Acc: 0.427 Test Loss: 26.117 Test Acc: 0.427
Validation loss decreased (-0.412056 --> -0.427220).  Saving model ...
Epoch: 3 cost time: 5.884045839309692
Epoch: 3, Steps: 32 | Train Loss: 32.070 Vali Loss: 37.749 Vali Acc: 0.473 Test Loss: 37.749 Test Acc: 0.473
Validation loss decreased (-0.427220 --> -0.472905).  Saving model ...
Epoch: 4 cost time: 5.949267625808716
Epoch: 4, Steps: 32 | Train Loss: 23.881 Vali Loss: 52.386 Vali Acc: 0.282 Test Loss: 52.386 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.238342046737671
Epoch: 5, Steps: 32 | Train Loss: 32.595 Vali Loss: 54.190 Vali Acc: 0.534 Test Loss: 54.190 Test Acc: 0.534
Validation loss decreased (-0.472905 --> -0.533809).  Saving model ...
Epoch: 6 cost time: 6.216825246810913
Epoch: 6, Steps: 32 | Train Loss: 28.088 Vali Loss: 54.876 Vali Acc: 0.534 Test Loss: 54.876 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.401073932647705
Epoch: 7, Steps: 32 | Train Loss: 20.777 Vali Loss: 59.574 Vali Acc: 0.321 Test Loss: 59.574 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.929605722427368
Epoch: 8, Steps: 32 | Train Loss: 34.860 Vali Loss: 67.061 Vali Acc: 0.321 Test Loss: 67.061 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.967635631561279
Epoch: 9, Steps: 32 | Train Loss: 30.795 Vali Loss: 66.521 Vali Acc: 0.481 Test Loss: 66.521 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.894336938858032
Epoch: 10, Steps: 32 | Train Loss: 10.731 Vali Loss: 86.590 Vali Acc: 0.405 Test Loss: 86.590 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.260661602020264
Epoch: 11, Steps: 32 | Train Loss: 14.426 Vali Loss: 78.011 Vali Acc: 0.527 Test Loss: 78.011 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.870590686798096
Epoch: 12, Steps: 32 | Train Loss: 3.466 Vali Loss: 93.549 Vali Acc: 0.496 Test Loss: 93.549 Test Acc: 0.496
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.082308292388916
Epoch: 13, Steps: 32 | Train Loss: 9.885 Vali Loss: 162.126 Vali Acc: 0.313 Test Loss: 162.126 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.4451377391815186
Epoch: 14, Steps: 32 | Train Loss: 10.819 Vali Loss: 69.119 Vali Acc: 0.634 Test Loss: 69.119 Test Acc: 0.634
Validation loss decreased (-0.533809 --> -0.632897).  Saving model ...
Epoch: 15 cost time: 6.294586658477783
Epoch: 15, Steps: 32 | Train Loss: 7.255 Vali Loss: 108.139 Vali Acc: 0.557 Test Loss: 108.139 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.364814043045044
Epoch: 16, Steps: 32 | Train Loss: 1.801 Vali Loss: 144.090 Vali Acc: 0.313 Test Loss: 144.090 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.473855018615723
Epoch: 17, Steps: 32 | Train Loss: 1.993 Vali Loss: 93.036 Vali Acc: 0.481 Test Loss: 93.036 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.183972358703613
Epoch: 18, Steps: 32 | Train Loss: 0.699 Vali Loss: 105.716 Vali Acc: 0.305 Test Loss: 105.716 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.248146057128906
Epoch: 19, Steps: 32 | Train Loss: 9.735 Vali Loss: 256.154 Vali Acc: 0.183 Test Loss: 256.154 Test Acc: 0.183
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.51007604598999
Epoch: 20, Steps: 32 | Train Loss: 21.678 Vali Loss: 148.949 Vali Acc: 0.298 Test Loss: 148.949 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.333355665206909
Epoch: 21, Steps: 32 | Train Loss: 4.774 Vali Loss: 87.555 Vali Acc: 0.458 Test Loss: 87.555 Test Acc: 0.458
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.61322808265686
Epoch: 22, Steps: 32 | Train Loss: 7.453 Vali Loss: 195.009 Vali Acc: 0.366 Test Loss: 195.009 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.7252256870269775
Epoch: 23, Steps: 32 | Train Loss: 3.125 Vali Loss: 136.990 Vali Acc: 0.656 Test Loss: 136.990 Test Acc: 0.656
Validation loss decreased (-0.632897 --> -0.655119).  Saving model ...
Epoch: 24 cost time: 6.455973863601685
Epoch: 24, Steps: 32 | Train Loss: 4.719 Vali Loss: 249.729 Vali Acc: 0.244 Test Loss: 249.729 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.059656620025635
Epoch: 25, Steps: 32 | Train Loss: 0.563 Vali Loss: 236.699 Vali Acc: 0.550 Test Loss: 236.699 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 7.123552322387695
Epoch: 26, Steps: 32 | Train Loss: 1.351 Vali Loss: 172.406 Vali Acc: 0.588 Test Loss: 172.406 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 7.087527275085449
Epoch: 27, Steps: 32 | Train Loss: 0.550 Vali Loss: 188.355 Vali Acc: 0.595 Test Loss: 188.355 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 6.9250383377075195
Epoch: 28, Steps: 32 | Train Loss: 0.704 Vali Loss: 172.601 Vali Acc: 0.588 Test Loss: 172.601 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.824785232543945
Epoch: 29, Steps: 32 | Train Loss: 2.025 Vali Loss: 188.212 Vali Acc: 0.573 Test Loss: 188.212 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.709151029586792
Epoch: 30, Steps: 32 | Train Loss: 2.824 Vali Loss: 369.822 Vali Acc: 0.527 Test Loss: 369.822 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 6.496164083480835
Epoch: 31, Steps: 32 | Train Loss: 12.876 Vali Loss: 300.833 Vali Acc: 0.557 Test Loss: 300.833 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 6.508598804473877
Epoch: 32, Steps: 32 | Train Loss: 0.524 Vali Loss: 176.802 Vali Acc: 0.641 Test Loss: 176.802 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.432145118713379
Epoch: 33, Steps: 32 | Train Loss: 3.415 Vali Loss: 260.753 Vali Acc: 0.595 Test Loss: 260.753 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 11613485
model size : 53.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.881426811218262
Epoch: 1, Steps: 32 | Train Loss: 16.320 Vali Loss: 35.227 Vali Acc: 0.435 Test Loss: 35.227 Test Acc: 0.435
Validation loss decreased (inf --> -0.434762).  Saving model ...
Epoch: 2 cost time: 5.719901084899902
Epoch: 2, Steps: 32 | Train Loss: 29.675 Vali Loss: 30.081 Vali Acc: 0.267 Test Loss: 30.081 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.682769298553467
Epoch: 3, Steps: 32 | Train Loss: 43.379 Vali Loss: 108.118 Vali Acc: 0.206 Test Loss: 108.118 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.610874652862549
Epoch: 4, Steps: 32 | Train Loss: 57.683 Vali Loss: 42.826 Vali Acc: 0.489 Test Loss: 42.826 Test Acc: 0.489
Validation loss decreased (-0.434762 --> -0.488121).  Saving model ...
Epoch: 5 cost time: 5.6014564037323
Epoch: 5, Steps: 32 | Train Loss: 33.216 Vali Loss: 72.587 Vali Acc: 0.160 Test Loss: 72.587 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.092193603515625
Epoch: 6, Steps: 32 | Train Loss: 25.094 Vali Loss: 74.228 Vali Acc: 0.229 Test Loss: 74.228 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0273756980896
Epoch: 7, Steps: 32 | Train Loss: 32.701 Vali Loss: 96.828 Vali Acc: 0.176 Test Loss: 96.828 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.759303569793701
Epoch: 8, Steps: 32 | Train Loss: 39.956 Vali Loss: 123.984 Vali Acc: 0.214 Test Loss: 123.984 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.48470139503479
Epoch: 9, Steps: 32 | Train Loss: 32.428 Vali Loss: 69.074 Vali Acc: 0.504 Test Loss: 69.074 Test Acc: 0.504
Validation loss decreased (-0.488121 --> -0.503126).  Saving model ...
Epoch: 10 cost time: 5.566373109817505
Epoch: 10, Steps: 32 | Train Loss: 26.356 Vali Loss: 106.248 Vali Acc: 0.275 Test Loss: 106.248 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.069320201873779
Epoch: 11, Steps: 32 | Train Loss: 13.401 Vali Loss: 95.448 Vali Acc: 0.458 Test Loss: 95.448 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.823206901550293
Epoch: 12, Steps: 32 | Train Loss: 1.207 Vali Loss: 69.191 Vali Acc: 0.489 Test Loss: 69.191 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.714831113815308
Epoch: 13, Steps: 32 | Train Loss: 8.125 Vali Loss: 109.266 Vali Acc: 0.435 Test Loss: 109.266 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.830601692199707
Epoch: 14, Steps: 32 | Train Loss: 5.077 Vali Loss: 94.168 Vali Acc: 0.443 Test Loss: 94.168 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.82903528213501
Epoch: 15, Steps: 32 | Train Loss: 10.078 Vali Loss: 130.817 Vali Acc: 0.595 Test Loss: 130.817 Test Acc: 0.595
Validation loss decreased (-0.503126 --> -0.594112).  Saving model ...
Epoch: 16 cost time: 6.075742721557617
Epoch: 16, Steps: 32 | Train Loss: 4.269 Vali Loss: 159.406 Vali Acc: 0.466 Test Loss: 159.406 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.341152667999268
Epoch: 17, Steps: 32 | Train Loss: 4.962 Vali Loss: 146.301 Vali Acc: 0.458 Test Loss: 146.301 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.9446187019348145
Epoch: 18, Steps: 32 | Train Loss: 1.089 Vali Loss: 153.489 Vali Acc: 0.534 Test Loss: 153.489 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.987571954727173
Epoch: 19, Steps: 32 | Train Loss: 0.282 Vali Loss: 242.959 Vali Acc: 0.305 Test Loss: 242.959 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.614834785461426
Epoch: 20, Steps: 32 | Train Loss: 1.938 Vali Loss: 206.076 Vali Acc: 0.412 Test Loss: 206.076 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.2926185131073
Epoch: 21, Steps: 32 | Train Loss: 1.376 Vali Loss: 175.575 Vali Acc: 0.489 Test Loss: 175.575 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.9921605587005615
Epoch: 22, Steps: 32 | Train Loss: 7.654 Vali Loss: 199.365 Vali Acc: 0.267 Test Loss: 199.365 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.716992616653442
Epoch: 23, Steps: 32 | Train Loss: 1.233 Vali Loss: 261.875 Vali Acc: 0.290 Test Loss: 261.875 Test Acc: 0.290
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.774555683135986
Epoch: 24, Steps: 32 | Train Loss: 0.674 Vali Loss: 170.636 Vali Acc: 0.496 Test Loss: 170.636 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.923903465270996
Epoch: 25, Steps: 32 | Train Loss: 0.949 Vali Loss: 156.828 Vali Acc: 0.534 Test Loss: 156.828 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 11613485
model size : 53.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.585631608963013
Epoch: 1, Steps: 32 | Train Loss: 15.789 Vali Loss: 47.061 Vali Acc: 0.176 Test Loss: 47.061 Test Acc: 0.176
Validation loss decreased (inf --> -0.175102).  Saving model ...
Epoch: 2 cost time: 6.653231620788574
Epoch: 2, Steps: 32 | Train Loss: 35.360 Vali Loss: 25.091 Vali Acc: 0.412 Test Loss: 25.091 Test Acc: 0.412
Validation loss decreased (-0.175102 --> -0.411963).  Saving model ...
Epoch: 3 cost time: 6.659364461898804
Epoch: 3, Steps: 32 | Train Loss: 36.042 Vali Loss: 53.080 Vali Acc: 0.427 Test Loss: 53.080 Test Acc: 0.427
Validation loss decreased (-0.411963 --> -0.426950).  Saving model ...
Epoch: 4 cost time: 6.602960824966431
Epoch: 4, Steps: 32 | Train Loss: 17.573 Vali Loss: 46.763 Vali Acc: 0.496 Test Loss: 46.763 Test Acc: 0.496
Validation loss decreased (-0.426950 --> -0.495716).  Saving model ...
Epoch: 5 cost time: 7.043812274932861
Epoch: 5, Steps: 32 | Train Loss: 25.206 Vali Loss: 34.105 Vali Acc: 0.511 Test Loss: 34.105 Test Acc: 0.511
Validation loss decreased (-0.495716 --> -0.511109).  Saving model ...
Epoch: 6 cost time: 6.520827054977417
Epoch: 6, Steps: 32 | Train Loss: 38.153 Vali Loss: 106.417 Vali Acc: 0.359 Test Loss: 106.417 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.363551616668701
Epoch: 7, Steps: 32 | Train Loss: 28.578 Vali Loss: 86.113 Vali Acc: 0.191 Test Loss: 86.113 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.836674928665161
Epoch: 8, Steps: 32 | Train Loss: 27.578 Vali Loss: 40.385 Vali Acc: 0.435 Test Loss: 40.385 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.787356853485107
Epoch: 9, Steps: 32 | Train Loss: 10.918 Vali Loss: 57.529 Vali Acc: 0.542 Test Loss: 57.529 Test Acc: 0.542
Validation loss decreased (-0.511109 --> -0.541409).  Saving model ...
Epoch: 10 cost time: 6.419430255889893
Epoch: 10, Steps: 32 | Train Loss: 39.423 Vali Loss: 146.677 Vali Acc: 0.511 Test Loss: 146.677 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.5373780727386475
Epoch: 11, Steps: 32 | Train Loss: 14.690 Vali Loss: 151.111 Vali Acc: 0.458 Test Loss: 151.111 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.876030921936035
Epoch: 12, Steps: 32 | Train Loss: 13.248 Vali Loss: 162.248 Vali Acc: 0.489 Test Loss: 162.248 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.9841954708099365
Epoch: 13, Steps: 32 | Train Loss: 17.909 Vali Loss: 175.619 Vali Acc: 0.344 Test Loss: 175.619 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.037301540374756
Epoch: 14, Steps: 32 | Train Loss: 9.537 Vali Loss: 146.075 Vali Acc: 0.550 Test Loss: 146.075 Test Acc: 0.550
Validation loss decreased (-0.541409 --> -0.548158).  Saving model ...
Epoch: 15 cost time: 7.164113998413086
Epoch: 15, Steps: 32 | Train Loss: 3.726 Vali Loss: 134.126 Vali Acc: 0.573 Test Loss: 134.126 Test Acc: 0.573
Validation loss decreased (-0.548158 --> -0.571178).  Saving model ...
Epoch: 16 cost time: 7.137227773666382
Epoch: 16, Steps: 32 | Train Loss: 8.383 Vali Loss: 139.291 Vali Acc: 0.557 Test Loss: 139.291 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.0737810134887695
Epoch: 17, Steps: 32 | Train Loss: 3.465 Vali Loss: 116.988 Vali Acc: 0.580 Test Loss: 116.988 Test Acc: 0.580
Validation loss decreased (-0.571178 --> -0.578983).  Saving model ...
Epoch: 18 cost time: 6.9991114139556885
Epoch: 18, Steps: 32 | Train Loss: 0.498 Vali Loss: 108.621 Vali Acc: 0.611 Test Loss: 108.621 Test Acc: 0.611
Validation loss decreased (-0.578983 --> -0.609601).  Saving model ...
Epoch: 19 cost time: 6.875921010971069
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 110.886 Vali Acc: 0.603 Test Loss: 110.886 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.739386796951294
Epoch: 20, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.004 Vali Acc: 0.611 Test Loss: 111.004 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.966725587844849
Epoch: 21, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.404515743255615
Epoch: 22, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.897085189819336
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.329552412033081
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 8.110780239105225
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.9562695026397705
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.043154239654541
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 7.715633153915405
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 111.008 Vali Acc: 0.611 Test Loss: 111.008 Test Acc: 0.611
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 11580717
model size : 52.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.829330682754517
Epoch: 1, Steps: 32 | Train Loss: 15.391 Vali Loss: 12.184 Vali Acc: 0.458 Test Loss: 12.184 Test Acc: 0.458
Validation loss decreased (inf --> -0.457893).  Saving model ...
Epoch: 2 cost time: 6.295635938644409
Epoch: 2, Steps: 32 | Train Loss: 18.492 Vali Loss: 15.939 Vali Acc: 0.336 Test Loss: 15.939 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.4013566970825195
Epoch: 3, Steps: 32 | Train Loss: 39.549 Vali Loss: 42.506 Vali Acc: 0.298 Test Loss: 42.506 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.987422704696655
Epoch: 4, Steps: 32 | Train Loss: 21.547 Vali Loss: 30.562 Vali Acc: 0.305 Test Loss: 30.562 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.290851831436157
Epoch: 5, Steps: 32 | Train Loss: 21.719 Vali Loss: 27.302 Vali Acc: 0.550 Test Loss: 27.302 Test Acc: 0.550
Validation loss decreased (-0.457893 --> -0.549345).  Saving model ...
Epoch: 6 cost time: 6.23777174949646
Epoch: 6, Steps: 32 | Train Loss: 32.741 Vali Loss: 44.918 Vali Acc: 0.473 Test Loss: 44.918 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.297306060791016
Epoch: 7, Steps: 32 | Train Loss: 30.157 Vali Loss: 50.674 Vali Acc: 0.450 Test Loss: 50.674 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.480689287185669
Epoch: 8, Steps: 32 | Train Loss: 52.526 Vali Loss: 63.991 Vali Acc: 0.473 Test Loss: 63.991 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.498095750808716
Epoch: 9, Steps: 32 | Train Loss: 18.675 Vali Loss: 52.125 Vali Acc: 0.366 Test Loss: 52.125 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.22367262840271
Epoch: 10, Steps: 32 | Train Loss: 9.227 Vali Loss: 127.090 Vali Acc: 0.519 Test Loss: 127.090 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.497087717056274
Epoch: 11, Steps: 32 | Train Loss: 14.940 Vali Loss: 222.676 Vali Acc: 0.183 Test Loss: 222.676 Test Acc: 0.183
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 7.355621099472046
Epoch: 12, Steps: 32 | Train Loss: 17.745 Vali Loss: 180.563 Vali Acc: 0.489 Test Loss: 180.563 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.862659454345703
Epoch: 13, Steps: 32 | Train Loss: 14.728 Vali Loss: 175.866 Vali Acc: 0.405 Test Loss: 175.866 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 6.884474277496338
Epoch: 14, Steps: 32 | Train Loss: 14.161 Vali Loss: 155.852 Vali Acc: 0.534 Test Loss: 155.852 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.02295708656311
Epoch: 15, Steps: 32 | Train Loss: 4.189 Vali Loss: 204.695 Vali Acc: 0.481 Test Loss: 204.695 Test Acc: 0.481
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 11580717
model size : 52.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.270257711410522
Epoch: 1, Steps: 32 | Train Loss: 16.725 Vali Loss: 34.079 Vali Acc: 0.252 Test Loss: 34.079 Test Acc: 0.252
Validation loss decreased (inf --> -0.251568).  Saving model ...
Epoch: 2 cost time: 6.1036036014556885
Epoch: 2, Steps: 32 | Train Loss: 21.028 Vali Loss: 27.347 Vali Acc: 0.473 Test Loss: 27.347 Test Acc: 0.473
Validation loss decreased (-0.251568 --> -0.473009).  Saving model ...
Epoch: 3 cost time: 5.963571310043335
Epoch: 3, Steps: 32 | Train Loss: 27.836 Vali Loss: 54.230 Vali Acc: 0.450 Test Loss: 54.230 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.926291465759277
Epoch: 4, Steps: 32 | Train Loss: 27.994 Vali Loss: 67.170 Vali Acc: 0.489 Test Loss: 67.170 Test Acc: 0.489
Validation loss decreased (-0.473009 --> -0.487878).  Saving model ...
Epoch: 5 cost time: 6.375009775161743
Epoch: 5, Steps: 32 | Train Loss: 36.665 Vali Loss: 65.691 Vali Acc: 0.466 Test Loss: 65.691 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.817476511001587
Epoch: 6, Steps: 32 | Train Loss: 33.083 Vali Loss: 79.421 Vali Acc: 0.229 Test Loss: 79.421 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.140727519989014
Epoch: 7, Steps: 32 | Train Loss: 49.512 Vali Loss: 37.630 Vali Acc: 0.466 Test Loss: 37.630 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.215651273727417
Epoch: 8, Steps: 32 | Train Loss: 36.129 Vali Loss: 36.768 Vali Acc: 0.336 Test Loss: 36.768 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.145719289779663
Epoch: 9, Steps: 32 | Train Loss: 14.090 Vali Loss: 53.797 Vali Acc: 0.481 Test Loss: 53.797 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.282705783843994
Epoch: 10, Steps: 32 | Train Loss: 18.344 Vali Loss: 144.897 Vali Acc: 0.489 Test Loss: 144.897 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 6.08904767036438
Epoch: 11, Steps: 32 | Train Loss: 7.673 Vali Loss: 141.086 Vali Acc: 0.588 Test Loss: 141.086 Test Acc: 0.588
Validation loss decreased (-0.487878 --> -0.586375).  Saving model ...
Epoch: 12 cost time: 6.247703313827515
Epoch: 12, Steps: 32 | Train Loss: 3.318 Vali Loss: 139.111 Vali Acc: 0.519 Test Loss: 139.111 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.043834686279297
Epoch: 13, Steps: 32 | Train Loss: 8.938 Vali Loss: 131.658 Vali Acc: 0.588 Test Loss: 131.658 Test Acc: 0.588
Validation loss decreased (-0.586375 --> -0.586470).  Saving model ...
Epoch: 14 cost time: 6.708624839782715
Epoch: 14, Steps: 32 | Train Loss: 9.623 Vali Loss: 204.870 Vali Acc: 0.519 Test Loss: 204.870 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.562809228897095
Epoch: 15, Steps: 32 | Train Loss: 15.591 Vali Loss: 130.625 Vali Acc: 0.458 Test Loss: 130.625 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.304885387420654
Epoch: 16, Steps: 32 | Train Loss: 0.818 Vali Loss: 128.467 Vali Acc: 0.565 Test Loss: 128.467 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.791294097900391
Epoch: 17, Steps: 32 | Train Loss: 3.319 Vali Loss: 183.390 Vali Acc: 0.527 Test Loss: 183.390 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.727653980255127
Epoch: 18, Steps: 32 | Train Loss: 3.769 Vali Loss: 162.219 Vali Acc: 0.557 Test Loss: 162.219 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.539161205291748
Epoch: 19, Steps: 32 | Train Loss: 12.182 Vali Loss: 205.446 Vali Acc: 0.504 Test Loss: 205.446 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.077096700668335
Epoch: 20, Steps: 32 | Train Loss: 15.828 Vali Loss: 220.252 Vali Acc: 0.405 Test Loss: 220.252 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 6.190473556518555
Epoch: 21, Steps: 32 | Train Loss: 4.832 Vali Loss: 216.291 Vali Acc: 0.527 Test Loss: 216.291 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.248600244522095
Epoch: 22, Steps: 32 | Train Loss: 6.922 Vali Loss: 319.724 Vali Acc: 0.489 Test Loss: 319.724 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.199740171432495
Epoch: 23, Steps: 32 | Train Loss: 0.001 Vali Loss: 235.901 Vali Acc: 0.504 Test Loss: 235.901 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5877862595419847
model parameter : 11580717
model size : 52.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 8.250818490982056
Epoch: 1, Steps: 32 | Train Loss: 10.057 Vali Loss: 20.131 Vali Acc: 0.458 Test Loss: 20.131 Test Acc: 0.458
Validation loss decreased (inf --> -0.457814).  Saving model ...
Epoch: 2 cost time: 6.869610786437988
Epoch: 2, Steps: 32 | Train Loss: 27.290 Vali Loss: 8.831 Vali Acc: 0.374 Test Loss: 8.831 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.986262083053589
Epoch: 3, Steps: 32 | Train Loss: 17.602 Vali Loss: 22.850 Vali Acc: 0.466 Test Loss: 22.850 Test Acc: 0.466
Validation loss decreased (-0.457814 --> -0.465420).  Saving model ...
Epoch: 4 cost time: 5.662490129470825
Epoch: 4, Steps: 32 | Train Loss: 41.538 Vali Loss: 36.411 Vali Acc: 0.466 Test Loss: 36.411 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.181206464767456
Epoch: 5, Steps: 32 | Train Loss: 29.515 Vali Loss: 55.872 Vali Acc: 0.229 Test Loss: 55.872 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.932644605636597
Epoch: 6, Steps: 32 | Train Loss: 33.586 Vali Loss: 47.144 Vali Acc: 0.267 Test Loss: 47.144 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.26862359046936
Epoch: 7, Steps: 32 | Train Loss: 55.158 Vali Loss: 80.269 Vali Acc: 0.221 Test Loss: 80.269 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.920722723007202
Epoch: 8, Steps: 32 | Train Loss: 27.028 Vali Loss: 56.098 Vali Acc: 0.252 Test Loss: 56.098 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.737168788909912
Epoch: 9, Steps: 32 | Train Loss: 29.029 Vali Loss: 72.736 Vali Acc: 0.260 Test Loss: 72.736 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.42542028427124
Epoch: 10, Steps: 32 | Train Loss: 22.073 Vali Loss: 81.843 Vali Acc: 0.351 Test Loss: 81.843 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 5.422536611557007
Epoch: 11, Steps: 32 | Train Loss: 15.598 Vali Loss: 56.099 Vali Acc: 0.397 Test Loss: 56.099 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.326880216598511
Epoch: 12, Steps: 32 | Train Loss: 5.513 Vali Loss: 115.677 Vali Acc: 0.565 Test Loss: 115.677 Test Acc: 0.565
Validation loss decreased (-0.465420 --> -0.563729).  Saving model ...
Epoch: 13 cost time: 5.776898622512817
Epoch: 13, Steps: 32 | Train Loss: 11.839 Vali Loss: 183.021 Vali Acc: 0.275 Test Loss: 183.021 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.346457481384277
Epoch: 14, Steps: 32 | Train Loss: 4.702 Vali Loss: 166.915 Vali Acc: 0.435 Test Loss: 166.915 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.88590669631958
Epoch: 15, Steps: 32 | Train Loss: 3.494 Vali Loss: 193.792 Vali Acc: 0.466 Test Loss: 193.792 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.406172752380371
Epoch: 16, Steps: 32 | Train Loss: 0.877 Vali Loss: 124.418 Vali Acc: 0.519 Test Loss: 124.418 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.211556911468506
Epoch: 17, Steps: 32 | Train Loss: 1.275 Vali Loss: 164.261 Vali Acc: 0.603 Test Loss: 164.261 Test Acc: 0.603
Validation loss decreased (-0.563729 --> -0.601411).  Saving model ...
Epoch: 18 cost time: 6.161102294921875
Epoch: 18, Steps: 32 | Train Loss: 0.302 Vali Loss: 153.241 Vali Acc: 0.534 Test Loss: 153.241 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.724559783935547
Epoch: 19, Steps: 32 | Train Loss: 2.903 Vali Loss: 100.308 Vali Acc: 0.511 Test Loss: 100.308 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.883050441741943
Epoch: 20, Steps: 32 | Train Loss: 4.573 Vali Loss: 206.290 Vali Acc: 0.573 Test Loss: 206.290 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.473693609237671
Epoch: 21, Steps: 32 | Train Loss: 0.497 Vali Loss: 139.047 Vali Acc: 0.550 Test Loss: 139.047 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.596593379974365
Epoch: 22, Steps: 32 | Train Loss: 3.022 Vali Loss: 136.084 Vali Acc: 0.557 Test Loss: 136.084 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.684024810791016
Epoch: 23, Steps: 32 | Train Loss: 0.166 Vali Loss: 264.412 Vali Acc: 0.298 Test Loss: 264.412 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.4810216426849365
Epoch: 24, Steps: 32 | Train Loss: 3.362 Vali Loss: 171.976 Vali Acc: 0.595 Test Loss: 171.976 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.527940988540649
Epoch: 25, Steps: 32 | Train Loss: 2.459 Vali Loss: 148.654 Vali Acc: 0.573 Test Loss: 148.654 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.784213304519653
Epoch: 26, Steps: 32 | Train Loss: 1.355 Vali Loss: 142.570 Vali Acc: 0.588 Test Loss: 142.570 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.8479766845703125
Epoch: 27, Steps: 32 | Train Loss: 2.071 Vali Loss: 188.322 Vali Acc: 0.580 Test Loss: 188.322 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 11580717
model size : 52.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 9.302415370941162
Epoch: 1, Steps: 32 | Train Loss: 16.628 Vali Loss: 21.908 Vali Acc: 0.267 Test Loss: 21.908 Test Acc: 0.267
Validation loss decreased (inf --> -0.266956).  Saving model ...
Epoch: 2 cost time: 6.702028274536133
Epoch: 2, Steps: 32 | Train Loss: 16.138 Vali Loss: 37.970 Vali Acc: 0.160 Test Loss: 37.970 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.171098470687866
Epoch: 3, Steps: 32 | Train Loss: 20.710 Vali Loss: 18.813 Vali Acc: 0.336 Test Loss: 18.813 Test Acc: 0.336
Validation loss decreased (-0.266956 --> -0.335690).  Saving model ...
Epoch: 4 cost time: 6.973809003829956
Epoch: 4, Steps: 32 | Train Loss: 40.717 Vali Loss: 115.800 Vali Acc: 0.183 Test Loss: 115.800 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.476744890213013
Epoch: 5, Steps: 32 | Train Loss: 34.719 Vali Loss: 65.896 Vali Acc: 0.489 Test Loss: 65.896 Test Acc: 0.489
Validation loss decreased (-0.335690 --> -0.487891).  Saving model ...
Epoch: 6 cost time: 6.534999847412109
Epoch: 6, Steps: 32 | Train Loss: 23.529 Vali Loss: 89.596 Vali Acc: 0.298 Test Loss: 89.596 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.367120027542114
Epoch: 7, Steps: 32 | Train Loss: 26.298 Vali Loss: 76.542 Vali Acc: 0.328 Test Loss: 76.542 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.39295768737793
Epoch: 8, Steps: 32 | Train Loss: 11.729 Vali Loss: 66.079 Vali Acc: 0.534 Test Loss: 66.079 Test Acc: 0.534
Validation loss decreased (-0.487891 --> -0.533690).  Saving model ...
Epoch: 9 cost time: 6.245915174484253
Epoch: 9, Steps: 32 | Train Loss: 32.852 Vali Loss: 102.125 Vali Acc: 0.542 Test Loss: 102.125 Test Acc: 0.542
Validation loss decreased (-0.533690 --> -0.540963).  Saving model ...
Epoch: 10 cost time: 6.447064399719238
Epoch: 10, Steps: 32 | Train Loss: 53.760 Vali Loss: 152.893 Vali Acc: 0.450 Test Loss: 152.893 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.461417198181152
Epoch: 11, Steps: 32 | Train Loss: 21.225 Vali Loss: 96.386 Vali Acc: 0.519 Test Loss: 96.386 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.390497446060181
Epoch: 12, Steps: 32 | Train Loss: 8.769 Vali Loss: 105.646 Vali Acc: 0.420 Test Loss: 105.646 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.486201524734497
Epoch: 13, Steps: 32 | Train Loss: 17.831 Vali Loss: 85.085 Vali Acc: 0.374 Test Loss: 85.085 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.174569606781006
Epoch: 14, Steps: 32 | Train Loss: 9.760 Vali Loss: 68.875 Vali Acc: 0.618 Test Loss: 68.875 Test Acc: 0.618
Validation loss decreased (-0.540963 --> -0.617632).  Saving model ...
Epoch: 15 cost time: 6.097426414489746
Epoch: 15, Steps: 32 | Train Loss: 7.043 Vali Loss: 158.980 Vali Acc: 0.534 Test Loss: 158.980 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.5022571086883545
Epoch: 16, Steps: 32 | Train Loss: 15.448 Vali Loss: 77.042 Vali Acc: 0.626 Test Loss: 77.042 Test Acc: 0.626
Validation loss decreased (-0.617632 --> -0.625184).  Saving model ...
Epoch: 17 cost time: 6.451526165008545
Epoch: 17, Steps: 32 | Train Loss: 3.056 Vali Loss: 107.768 Vali Acc: 0.557 Test Loss: 107.768 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.641822338104248
Epoch: 18, Steps: 32 | Train Loss: 2.563 Vali Loss: 161.929 Vali Acc: 0.542 Test Loss: 161.929 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.850479364395142
Epoch: 19, Steps: 32 | Train Loss: 1.195 Vali Loss: 84.753 Vali Acc: 0.573 Test Loss: 84.753 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.13232421875
Epoch: 20, Steps: 32 | Train Loss: 5.689 Vali Loss: 135.090 Vali Acc: 0.580 Test Loss: 135.090 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.833000183105469
Epoch: 21, Steps: 32 | Train Loss: 1.993 Vali Loss: 94.576 Vali Acc: 0.588 Test Loss: 94.576 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.4922261238098145
Epoch: 22, Steps: 32 | Train Loss: 1.429 Vali Loss: 126.526 Vali Acc: 0.557 Test Loss: 126.526 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.8935651779174805
Epoch: 23, Steps: 32 | Train Loss: 0.552 Vali Loss: 128.997 Vali Acc: 0.580 Test Loss: 128.997 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.0947394371032715
Epoch: 24, Steps: 32 | Train Loss: 1.061 Vali Loss: 84.466 Vali Acc: 0.580 Test Loss: 84.466 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.410029649734497
Epoch: 25, Steps: 32 | Train Loss: 1.355 Vali Loss: 157.689 Vali Acc: 0.550 Test Loss: 157.689 Test Acc: 0.550
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.511271238327026
Epoch: 26, Steps: 32 | Train Loss: 3.770 Vali Loss: 117.242 Vali Acc: 0.557 Test Loss: 117.242 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 11564333
model size : 52.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.522669076919556
Epoch: 1, Steps: 32 | Train Loss: 16.113 Vali Loss: 20.139 Vali Acc: 0.481 Test Loss: 20.139 Test Acc: 0.481
Validation loss decreased (inf --> -0.480715).  Saving model ...
Epoch: 2 cost time: 6.136800050735474
Epoch: 2, Steps: 32 | Train Loss: 28.518 Vali Loss: 48.426 Vali Acc: 0.313 Test Loss: 48.426 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.319032192230225
Epoch: 3, Steps: 32 | Train Loss: 47.106 Vali Loss: 97.742 Vali Acc: 0.466 Test Loss: 97.742 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.254146337509155
Epoch: 4, Steps: 32 | Train Loss: 39.816 Vali Loss: 58.351 Vali Acc: 0.466 Test Loss: 58.351 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.234915733337402
Epoch: 5, Steps: 32 | Train Loss: 22.857 Vali Loss: 84.315 Vali Acc: 0.412 Test Loss: 84.315 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 7.105653524398804
Epoch: 6, Steps: 32 | Train Loss: 36.778 Vali Loss: 67.254 Vali Acc: 0.321 Test Loss: 67.254 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.855747938156128
Epoch: 7, Steps: 32 | Train Loss: 23.435 Vali Loss: 52.106 Vali Acc: 0.534 Test Loss: 52.106 Test Acc: 0.534
Validation loss decreased (-0.480715 --> -0.533830).  Saving model ...
Epoch: 8 cost time: 6.557872533798218
Epoch: 8, Steps: 32 | Train Loss: 16.729 Vali Loss: 52.489 Vali Acc: 0.534 Test Loss: 52.489 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.278851747512817
Epoch: 9, Steps: 32 | Train Loss: 26.686 Vali Loss: 109.098 Vali Acc: 0.183 Test Loss: 109.098 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.338458776473999
Epoch: 10, Steps: 32 | Train Loss: 64.560 Vali Loss: 134.563 Vali Acc: 0.237 Test Loss: 134.563 Test Acc: 0.237
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.127184152603149
Epoch: 11, Steps: 32 | Train Loss: 25.162 Vali Loss: 57.137 Vali Acc: 0.489 Test Loss: 57.137 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.361708164215088
Epoch: 12, Steps: 32 | Train Loss: 9.463 Vali Loss: 109.635 Vali Acc: 0.504 Test Loss: 109.635 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.1366541385650635
Epoch: 13, Steps: 32 | Train Loss: 10.978 Vali Loss: 96.353 Vali Acc: 0.504 Test Loss: 96.353 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.350360870361328
Epoch: 14, Steps: 32 | Train Loss: 5.527 Vali Loss: 76.055 Vali Acc: 0.542 Test Loss: 76.055 Test Acc: 0.542
Validation loss decreased (-0.533830 --> -0.541224).  Saving model ...
Epoch: 15 cost time: 6.763099431991577
Epoch: 15, Steps: 32 | Train Loss: 2.005 Vali Loss: 132.558 Vali Acc: 0.504 Test Loss: 132.558 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.620451211929321
Epoch: 16, Steps: 32 | Train Loss: 1.650 Vali Loss: 103.238 Vali Acc: 0.511 Test Loss: 103.238 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.806100130081177
Epoch: 17, Steps: 32 | Train Loss: 5.188 Vali Loss: 96.011 Vali Acc: 0.542 Test Loss: 96.011 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.49670934677124
Epoch: 18, Steps: 32 | Train Loss: 6.818 Vali Loss: 68.798 Vali Acc: 0.595 Test Loss: 68.798 Test Acc: 0.595
Validation loss decreased (-0.541224 --> -0.594732).  Saving model ...
Epoch: 19 cost time: 6.82581353187561
Epoch: 19, Steps: 32 | Train Loss: 1.787 Vali Loss: 140.713 Vali Acc: 0.511 Test Loss: 140.713 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.414030313491821
Epoch: 20, Steps: 32 | Train Loss: 4.669 Vali Loss: 158.769 Vali Acc: 0.412 Test Loss: 158.769 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.489479303359985
Epoch: 21, Steps: 32 | Train Loss: 7.069 Vali Loss: 134.282 Vali Acc: 0.542 Test Loss: 134.282 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.036337614059448
Epoch: 22, Steps: 32 | Train Loss: 0.148 Vali Loss: 88.054 Vali Acc: 0.573 Test Loss: 88.054 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.0270774364471436
Epoch: 23, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.942 Vali Acc: 0.573 Test Loss: 87.942 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.818222761154175
Epoch: 24, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.938 Vali Acc: 0.573 Test Loss: 87.938 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.165760040283203
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.938 Vali Acc: 0.573 Test Loss: 87.938 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.578057765960693
Epoch: 26, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.938 Vali Acc: 0.573 Test Loss: 87.938 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.830848932266235
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.938 Vali Acc: 0.573 Test Loss: 87.938 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.5071187019348145
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 87.938 Vali Acc: 0.573 Test Loss: 87.938 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 11564333
model size : 52.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.534589052200317
Epoch: 1, Steps: 32 | Train Loss: 15.821 Vali Loss: 32.745 Vali Acc: 0.260 Test Loss: 32.745 Test Acc: 0.260
Validation loss decreased (inf --> -0.259215).  Saving model ...
Epoch: 2 cost time: 5.793764114379883
Epoch: 2, Steps: 32 | Train Loss: 27.855 Vali Loss: 27.241 Vali Acc: 0.275 Test Loss: 27.241 Test Acc: 0.275
Validation loss decreased (-0.259215 --> -0.274537).  Saving model ...
Epoch: 3 cost time: 6.193692445755005
Epoch: 3, Steps: 32 | Train Loss: 31.628 Vali Loss: 64.689 Vali Acc: 0.260 Test Loss: 64.689 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.814801216125488
Epoch: 4, Steps: 32 | Train Loss: 24.272 Vali Loss: 70.340 Vali Acc: 0.206 Test Loss: 70.340 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.0351340770721436
Epoch: 5, Steps: 32 | Train Loss: 42.675 Vali Loss: 156.796 Vali Acc: 0.176 Test Loss: 156.796 Test Acc: 0.176
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.705639362335205
Epoch: 6, Steps: 32 | Train Loss: 68.214 Vali Loss: 68.493 Vali Acc: 0.466 Test Loss: 68.493 Test Acc: 0.466
Validation loss decreased (-0.274537 --> -0.464964).  Saving model ...
Epoch: 7 cost time: 6.289410352706909
Epoch: 7, Steps: 32 | Train Loss: 29.498 Vali Loss: 56.760 Vali Acc: 0.374 Test Loss: 56.760 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.763747215270996
Epoch: 8, Steps: 32 | Train Loss: 20.516 Vali Loss: 71.377 Vali Acc: 0.534 Test Loss: 71.377 Test Acc: 0.534
Validation loss decreased (-0.464964 --> -0.533637).  Saving model ...
Epoch: 9 cost time: 6.4809699058532715
Epoch: 9, Steps: 32 | Train Loss: 25.106 Vali Loss: 44.450 Vali Acc: 0.550 Test Loss: 44.450 Test Acc: 0.550
Validation loss decreased (-0.533637 --> -0.549174).  Saving model ...
Epoch: 10 cost time: 6.217278242111206
Epoch: 10, Steps: 32 | Train Loss: 18.491 Vali Loss: 90.303 Vali Acc: 0.443 Test Loss: 90.303 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.394924640655518
Epoch: 11, Steps: 32 | Train Loss: 26.301 Vali Loss: 39.373 Vali Acc: 0.611 Test Loss: 39.373 Test Acc: 0.611
Validation loss decreased (-0.549174 --> -0.610293).  Saving model ...
Epoch: 12 cost time: 6.758372783660889
Epoch: 12, Steps: 32 | Train Loss: 13.055 Vali Loss: 135.677 Vali Acc: 0.252 Test Loss: 135.677 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.683966636657715
Epoch: 13, Steps: 32 | Train Loss: 9.803 Vali Loss: 125.185 Vali Acc: 0.534 Test Loss: 125.185 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.0641539096832275
Epoch: 14, Steps: 32 | Train Loss: 7.725 Vali Loss: 81.046 Vali Acc: 0.588 Test Loss: 81.046 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.710325002670288
Epoch: 15, Steps: 32 | Train Loss: 0.918 Vali Loss: 81.544 Vali Acc: 0.603 Test Loss: 81.544 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.293727874755859
Epoch: 16, Steps: 32 | Train Loss: 0.989 Vali Loss: 74.287 Vali Acc: 0.573 Test Loss: 74.287 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.008139371871948
Epoch: 17, Steps: 32 | Train Loss: 27.669 Vali Loss: 103.973 Vali Acc: 0.542 Test Loss: 103.973 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.2212769985198975
Epoch: 18, Steps: 32 | Train Loss: 6.908 Vali Loss: 71.846 Vali Acc: 0.397 Test Loss: 71.846 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.173020124435425
Epoch: 19, Steps: 32 | Train Loss: 4.219 Vali Loss: 68.809 Vali Acc: 0.595 Test Loss: 68.809 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.131002426147461
Epoch: 20, Steps: 32 | Train Loss: 2.940 Vali Loss: 189.469 Vali Acc: 0.435 Test Loss: 189.469 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.552693605422974
Epoch: 21, Steps: 32 | Train Loss: 8.447 Vali Loss: 349.824 Vali Acc: 0.290 Test Loss: 349.824 Test Acc: 0.290
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 11564333
model size : 52.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 7.49741792678833
Epoch: 1, Steps: 32 | Train Loss: 15.357 Vali Loss: 29.996 Vali Acc: 0.107 Test Loss: 29.996 Test Acc: 0.107
Validation loss decreased (inf --> -0.106570).  Saving model ...
Epoch: 2 cost time: 5.192098140716553
Epoch: 2, Steps: 32 | Train Loss: 19.754 Vali Loss: 45.057 Vali Acc: 0.168 Test Loss: 45.057 Test Acc: 0.168
Validation loss decreased (-0.106570 --> -0.167488).  Saving model ...
Epoch: 3 cost time: 5.592294216156006
Epoch: 3, Steps: 32 | Train Loss: 36.576 Vali Loss: 32.189 Vali Acc: 0.443 Test Loss: 32.189 Test Acc: 0.443
Validation loss decreased (-0.167488 --> -0.442426).  Saving model ...
Epoch: 4 cost time: 6.049651622772217
Epoch: 4, Steps: 32 | Train Loss: 51.378 Vali Loss: 102.603 Vali Acc: 0.176 Test Loss: 102.603 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.861809730529785
Epoch: 5, Steps: 32 | Train Loss: 37.582 Vali Loss: 125.965 Vali Acc: 0.221 Test Loss: 125.965 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.404188394546509
Epoch: 6, Steps: 32 | Train Loss: 43.266 Vali Loss: 55.276 Vali Acc: 0.298 Test Loss: 55.276 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.067829132080078
Epoch: 7, Steps: 32 | Train Loss: 33.710 Vali Loss: 69.499 Vali Acc: 0.298 Test Loss: 69.499 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.4716105461120605
Epoch: 8, Steps: 32 | Train Loss: 41.009 Vali Loss: 59.397 Vali Acc: 0.496 Test Loss: 59.397 Test Acc: 0.496
Validation loss decreased (-0.442426 --> -0.495589).  Saving model ...
Epoch: 9 cost time: 5.513380765914917
Epoch: 9, Steps: 32 | Train Loss: 45.815 Vali Loss: 107.467 Vali Acc: 0.153 Test Loss: 107.467 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.577235698699951
Epoch: 10, Steps: 32 | Train Loss: 35.488 Vali Loss: 107.203 Vali Acc: 0.519 Test Loss: 107.203 Test Acc: 0.519
Validation loss decreased (-0.495589 --> -0.518012).  Saving model ...
Epoch: 11 cost time: 5.151451349258423
Epoch: 11, Steps: 32 | Train Loss: 23.745 Vali Loss: 159.148 Vali Acc: 0.458 Test Loss: 159.148 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.369342088699341
Epoch: 12, Steps: 32 | Train Loss: 10.134 Vali Loss: 91.636 Vali Acc: 0.542 Test Loss: 91.636 Test Acc: 0.542
Validation loss decreased (-0.518012 --> -0.541068).  Saving model ...
Epoch: 13 cost time: 5.717054605484009
Epoch: 13, Steps: 32 | Train Loss: 5.633 Vali Loss: 88.498 Vali Acc: 0.588 Test Loss: 88.498 Test Acc: 0.588
Validation loss decreased (-0.541068 --> -0.586901).  Saving model ...
Epoch: 14 cost time: 5.348700761795044
Epoch: 14, Steps: 32 | Train Loss: 4.460 Vali Loss: 134.237 Vali Acc: 0.298 Test Loss: 134.237 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.423357248306274
Epoch: 15, Steps: 32 | Train Loss: 3.094 Vali Loss: 105.232 Vali Acc: 0.527 Test Loss: 105.232 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.046065807342529
Epoch: 16, Steps: 32 | Train Loss: 6.384 Vali Loss: 126.513 Vali Acc: 0.466 Test Loss: 126.513 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.219027519226074
Epoch: 17, Steps: 32 | Train Loss: 3.969 Vali Loss: 119.270 Vali Acc: 0.374 Test Loss: 119.270 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.739563703536987
Epoch: 18, Steps: 32 | Train Loss: 5.829 Vali Loss: 130.230 Vali Acc: 0.595 Test Loss: 130.230 Test Acc: 0.595
Validation loss decreased (-0.586901 --> -0.594118).  Saving model ...
Epoch: 19 cost time: 5.972913503646851
Epoch: 19, Steps: 32 | Train Loss: 4.789 Vali Loss: 110.303 Vali Acc: 0.565 Test Loss: 110.303 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.065053701400757
Epoch: 20, Steps: 32 | Train Loss: 3.213 Vali Loss: 148.396 Vali Acc: 0.450 Test Loss: 148.396 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.262761831283569
Epoch: 21, Steps: 32 | Train Loss: 0.841 Vali Loss: 190.040 Vali Acc: 0.527 Test Loss: 190.040 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.588306903839111
Epoch: 22, Steps: 32 | Train Loss: 0.006 Vali Loss: 166.447 Vali Acc: 0.557 Test Loss: 166.447 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.123361825942993
Epoch: 23, Steps: 32 | Train Loss: 0.657 Vali Loss: 161.613 Vali Acc: 0.412 Test Loss: 161.613 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.9303247928619385
Epoch: 24, Steps: 32 | Train Loss: 4.385 Vali Loss: 147.959 Vali Acc: 0.557 Test Loss: 147.959 Test Acc: 0.557
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.997328042984009
Epoch: 25, Steps: 32 | Train Loss: 8.625 Vali Loss: 161.319 Vali Acc: 0.534 Test Loss: 161.319 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.916011571884155
Epoch: 26, Steps: 32 | Train Loss: 28.201 Vali Loss: 382.890 Vali Acc: 0.221 Test Loss: 382.890 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.9297935962677
Epoch: 27, Steps: 32 | Train Loss: 1.749 Vali Loss: 180.435 Vali Acc: 0.573 Test Loss: 180.435 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.438838243484497
Epoch: 28, Steps: 32 | Train Loss: 0.756 Vali Loss: 179.545 Vali Acc: 0.534 Test Loss: 179.545 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 11564333
model size : 52.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.871462345123291
Epoch: 1, Steps: 32 | Train Loss: 8.250 Vali Loss: 5.544 Vali Acc: 0.427 Test Loss: 5.544 Test Acc: 0.427
Validation loss decreased (inf --> -0.427425).  Saving model ...
Epoch: 2 cost time: 5.041917324066162
Epoch: 2, Steps: 32 | Train Loss: 13.134 Vali Loss: 12.687 Vali Acc: 0.359 Test Loss: 12.687 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.984292984008789
Epoch: 3, Steps: 32 | Train Loss: 7.010 Vali Loss: 10.463 Vali Acc: 0.366 Test Loss: 10.463 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.967217206954956
Epoch: 4, Steps: 32 | Train Loss: 9.366 Vali Loss: 24.679 Vali Acc: 0.489 Test Loss: 24.679 Test Acc: 0.489
Validation loss decreased (-0.427425 --> -0.488303).  Saving model ...
Epoch: 5 cost time: 4.83510684967041
Epoch: 5, Steps: 32 | Train Loss: 7.958 Vali Loss: 20.648 Vali Acc: 0.290 Test Loss: 20.648 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.798727512359619
Epoch: 6, Steps: 32 | Train Loss: 23.862 Vali Loss: 39.498 Vali Acc: 0.412 Test Loss: 39.498 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.307408094406128
Epoch: 7, Steps: 32 | Train Loss: 14.232 Vali Loss: 70.989 Vali Acc: 0.405 Test Loss: 70.989 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.0409932136535645
Epoch: 8, Steps: 32 | Train Loss: 13.028 Vali Loss: 70.539 Vali Acc: 0.443 Test Loss: 70.539 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.589466094970703
Epoch: 9, Steps: 32 | Train Loss: 8.902 Vali Loss: 57.938 Vali Acc: 0.481 Test Loss: 57.938 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.96153450012207
Epoch: 10, Steps: 32 | Train Loss: 6.866 Vali Loss: 69.696 Vali Acc: 0.389 Test Loss: 69.696 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.96901535987854
Epoch: 11, Steps: 32 | Train Loss: 2.806 Vali Loss: 76.097 Vali Acc: 0.290 Test Loss: 76.097 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.072770595550537
Epoch: 12, Steps: 32 | Train Loss: 14.115 Vali Loss: 50.620 Vali Acc: 0.405 Test Loss: 50.620 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.436133146286011
Epoch: 13, Steps: 32 | Train Loss: 4.180 Vali Loss: 49.644 Vali Acc: 0.557 Test Loss: 49.644 Test Acc: 0.557
Validation loss decreased (-0.488303 --> -0.556755).  Saving model ...
Epoch: 14 cost time: 4.851499319076538
Epoch: 14, Steps: 32 | Train Loss: 2.415 Vali Loss: 47.867 Vali Acc: 0.557 Test Loss: 47.867 Test Acc: 0.557
Validation loss decreased (-0.556755 --> -0.556773).  Saving model ...
Epoch: 15 cost time: 4.437097787857056
Epoch: 15, Steps: 32 | Train Loss: 3.179 Vali Loss: 41.995 Vali Acc: 0.466 Test Loss: 41.995 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.652323484420776
Epoch: 16, Steps: 32 | Train Loss: 6.854 Vali Loss: 77.164 Vali Acc: 0.313 Test Loss: 77.164 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.881420612335205
Epoch: 17, Steps: 32 | Train Loss: 6.788 Vali Loss: 52.376 Vali Acc: 0.458 Test Loss: 52.376 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.001703500747681
Epoch: 18, Steps: 32 | Train Loss: 4.274 Vali Loss: 63.419 Vali Acc: 0.481 Test Loss: 63.419 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.640919208526611
Epoch: 19, Steps: 32 | Train Loss: 4.696 Vali Loss: 86.080 Vali Acc: 0.336 Test Loss: 86.080 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.934958457946777
Epoch: 20, Steps: 32 | Train Loss: 9.458 Vali Loss: 80.843 Vali Acc: 0.565 Test Loss: 80.843 Test Acc: 0.565
Validation loss decreased (-0.556773 --> -0.564077).  Saving model ...
Epoch: 21 cost time: 5.053525924682617
Epoch: 21, Steps: 32 | Train Loss: 3.165 Vali Loss: 91.765 Vali Acc: 0.573 Test Loss: 91.765 Test Acc: 0.573
Validation loss decreased (-0.564077 --> -0.571601).  Saving model ...
Epoch: 22 cost time: 5.02110743522644
Epoch: 22, Steps: 32 | Train Loss: 11.751 Vali Loss: 113.855 Vali Acc: 0.534 Test Loss: 113.855 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.417057275772095
Epoch: 23, Steps: 32 | Train Loss: 1.784 Vali Loss: 58.932 Vali Acc: 0.595 Test Loss: 58.932 Test Acc: 0.595
Validation loss decreased (-0.571601 --> -0.594831).  Saving model ...
Epoch: 24 cost time: 4.84186863899231
Epoch: 24, Steps: 32 | Train Loss: 0.001 Vali Loss: 76.765 Vali Acc: 0.473 Test Loss: 76.765 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.042193651199341
Epoch: 25, Steps: 32 | Train Loss: 3.853 Vali Loss: 64.837 Vali Acc: 0.611 Test Loss: 64.837 Test Acc: 0.611
Validation loss decreased (-0.594831 --> -0.610039).  Saving model ...
Epoch: 26 cost time: 4.796377658843994
Epoch: 26, Steps: 32 | Train Loss: 0.352 Vali Loss: 65.688 Vali Acc: 0.573 Test Loss: 65.688 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.494710922241211
Epoch: 27, Steps: 32 | Train Loss: 0.160 Vali Loss: 94.179 Vali Acc: 0.573 Test Loss: 94.179 Test Acc: 0.573
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.226083755493164
Epoch: 28, Steps: 32 | Train Loss: 2.644 Vali Loss: 68.545 Vali Acc: 0.580 Test Loss: 68.545 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.899754047393799
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 72.662 Vali Acc: 0.595 Test Loss: 72.662 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.717341423034668
Epoch: 30, Steps: 32 | Train Loss: 0.076 Vali Loss: 68.796 Vali Acc: 0.580 Test Loss: 68.796 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.331358432769775
Epoch: 31, Steps: 32 | Train Loss: 1.145 Vali Loss: 65.757 Vali Acc: 0.634 Test Loss: 65.757 Test Acc: 0.634
Validation loss decreased (-0.610039 --> -0.632930).  Saving model ...
Epoch: 32 cost time: 4.9412009716033936
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.258 Vali Acc: 0.595 Test Loss: 67.258 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 5.400381326675415
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.393 Vali Acc: 0.603 Test Loss: 67.393 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.70223331451416
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.397 Vali Acc: 0.603 Test Loss: 67.397 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 5.210045099258423
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.7662131786346436
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.38882303237915
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.978546857833862
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.6822686195373535
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.447875499725342
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.375249862670898
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.398 Vali Acc: 0.603 Test Loss: 67.398 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 6027949
model size : 27.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.233067274093628
Epoch: 1, Steps: 32 | Train Loss: 8.063 Vali Loss: 4.692 Vali Acc: 0.267 Test Loss: 4.692 Test Acc: 0.267
Validation loss decreased (inf --> -0.267129).  Saving model ...
Epoch: 2 cost time: 4.777714252471924
Epoch: 2, Steps: 32 | Train Loss: 12.062 Vali Loss: 8.408 Vali Acc: 0.473 Test Loss: 8.408 Test Acc: 0.473
Validation loss decreased (-0.267129 --> -0.473198).  Saving model ...
Epoch: 3 cost time: 4.398645877838135
Epoch: 3, Steps: 32 | Train Loss: 12.085 Vali Loss: 13.870 Vali Acc: 0.443 Test Loss: 13.870 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.656956195831299
Epoch: 4, Steps: 32 | Train Loss: 10.002 Vali Loss: 59.415 Vali Acc: 0.443 Test Loss: 59.415 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.87090277671814
Epoch: 5, Steps: 32 | Train Loss: 9.909 Vali Loss: 50.198 Vali Acc: 0.290 Test Loss: 50.198 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.31312108039856
Epoch: 6, Steps: 32 | Train Loss: 21.270 Vali Loss: 55.441 Vali Acc: 0.344 Test Loss: 55.441 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.763757228851318
Epoch: 7, Steps: 32 | Train Loss: 8.613 Vali Loss: 33.336 Vali Acc: 0.351 Test Loss: 33.336 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.744690895080566
Epoch: 8, Steps: 32 | Train Loss: 14.845 Vali Loss: 41.825 Vali Acc: 0.344 Test Loss: 41.825 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.181980609893799
Epoch: 9, Steps: 32 | Train Loss: 6.350 Vali Loss: 27.617 Vali Acc: 0.359 Test Loss: 27.617 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 4.748487234115601
Epoch: 10, Steps: 32 | Train Loss: 6.071 Vali Loss: 27.554 Vali Acc: 0.374 Test Loss: 27.554 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 4.440608978271484
Epoch: 11, Steps: 32 | Train Loss: 3.308 Vali Loss: 38.689 Vali Acc: 0.519 Test Loss: 38.689 Test Acc: 0.519
Validation loss decreased (-0.473198 --> -0.518697).  Saving model ...
Epoch: 12 cost time: 4.944634675979614
Epoch: 12, Steps: 32 | Train Loss: 7.466 Vali Loss: 29.453 Vali Acc: 0.466 Test Loss: 29.453 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.181395530700684
Epoch: 13, Steps: 32 | Train Loss: 6.205 Vali Loss: 54.575 Vali Acc: 0.504 Test Loss: 54.575 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.483192682266235
Epoch: 14, Steps: 32 | Train Loss: 7.251 Vali Loss: 45.427 Vali Acc: 0.511 Test Loss: 45.427 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.115529775619507
Epoch: 15, Steps: 32 | Train Loss: 5.814 Vali Loss: 54.311 Vali Acc: 0.450 Test Loss: 54.311 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.6813836097717285
Epoch: 16, Steps: 32 | Train Loss: 8.069 Vali Loss: 51.835 Vali Acc: 0.496 Test Loss: 51.835 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.836476564407349
Epoch: 17, Steps: 32 | Train Loss: 2.163 Vali Loss: 85.205 Vali Acc: 0.344 Test Loss: 85.205 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.634645938873291
Epoch: 18, Steps: 32 | Train Loss: 4.933 Vali Loss: 75.666 Vali Acc: 0.466 Test Loss: 75.666 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.555422782897949
Epoch: 19, Steps: 32 | Train Loss: 1.560 Vali Loss: 67.592 Vali Acc: 0.534 Test Loss: 67.592 Test Acc: 0.534
Validation loss decreased (-0.518697 --> -0.533675).  Saving model ...
Epoch: 20 cost time: 5.019810438156128
Epoch: 20, Steps: 32 | Train Loss: 2.331 Vali Loss: 61.493 Vali Acc: 0.389 Test Loss: 61.493 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.553546667098999
Epoch: 21, Steps: 32 | Train Loss: 11.469 Vali Loss: 74.347 Vali Acc: 0.550 Test Loss: 74.347 Test Acc: 0.550
Validation loss decreased (-0.533675 --> -0.548875).  Saving model ...
Epoch: 22 cost time: 5.0831193923950195
Epoch: 22, Steps: 32 | Train Loss: 7.971 Vali Loss: 59.579 Vali Acc: 0.557 Test Loss: 59.579 Test Acc: 0.557
Validation loss decreased (-0.548875 --> -0.556656).  Saving model ...
Epoch: 23 cost time: 4.8679258823394775
Epoch: 23, Steps: 32 | Train Loss: 1.895 Vali Loss: 77.149 Vali Acc: 0.542 Test Loss: 77.149 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.796427488327026
Epoch: 24, Steps: 32 | Train Loss: 9.327 Vali Loss: 73.863 Vali Acc: 0.557 Test Loss: 73.863 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.942182779312134
Epoch: 25, Steps: 32 | Train Loss: 2.160 Vali Loss: 73.494 Vali Acc: 0.603 Test Loss: 73.494 Test Acc: 0.603
Validation loss decreased (-0.556656 --> -0.602318).  Saving model ...
Epoch: 26 cost time: 4.750375747680664
Epoch: 26, Steps: 32 | Train Loss: 1.212 Vali Loss: 94.713 Vali Acc: 0.542 Test Loss: 94.713 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.765146017074585
Epoch: 27, Steps: 32 | Train Loss: 0.975 Vali Loss: 88.026 Vali Acc: 0.565 Test Loss: 88.026 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.378991603851318
Epoch: 28, Steps: 32 | Train Loss: 1.167 Vali Loss: 101.777 Vali Acc: 0.527 Test Loss: 101.777 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.414423227310181
Epoch: 29, Steps: 32 | Train Loss: 0.432 Vali Loss: 80.233 Vali Acc: 0.557 Test Loss: 80.233 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.574669122695923
Epoch: 30, Steps: 32 | Train Loss: 0.756 Vali Loss: 65.975 Vali Acc: 0.588 Test Loss: 65.975 Test Acc: 0.588
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.126605033874512
Epoch: 31, Steps: 32 | Train Loss: 0.581 Vali Loss: 76.401 Vali Acc: 0.534 Test Loss: 76.401 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.903651475906372
Epoch: 32, Steps: 32 | Train Loss: 2.627 Vali Loss: 125.491 Vali Acc: 0.481 Test Loss: 125.491 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.594475030899048
Epoch: 33, Steps: 32 | Train Loss: 6.818 Vali Loss: 103.145 Vali Acc: 0.573 Test Loss: 103.145 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.460401773452759
Epoch: 34, Steps: 32 | Train Loss: 0.565 Vali Loss: 93.515 Vali Acc: 0.611 Test Loss: 93.515 Test Acc: 0.611
Validation loss decreased (-0.602318 --> -0.609752).  Saving model ...
Epoch: 35 cost time: 5.000292778015137
Epoch: 35, Steps: 32 | Train Loss: 1.111 Vali Loss: 120.159 Vali Acc: 0.580 Test Loss: 120.159 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.070550203323364
Epoch: 36, Steps: 32 | Train Loss: 3.210 Vali Loss: 113.897 Vali Acc: 0.565 Test Loss: 113.897 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.992762804031372
Epoch: 37, Steps: 32 | Train Loss: 0.353 Vali Loss: 101.128 Vali Acc: 0.580 Test Loss: 101.128 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.689056158065796
Epoch: 38, Steps: 32 | Train Loss: 1.495 Vali Loss: 78.595 Vali Acc: 0.634 Test Loss: 78.595 Test Acc: 0.634
Validation loss decreased (-0.609752 --> -0.632802).  Saving model ...
Epoch: 39 cost time: 4.54471755027771
Epoch: 39, Steps: 32 | Train Loss: 0.530 Vali Loss: 160.678 Vali Acc: 0.351 Test Loss: 160.678 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 5.126827239990234
Epoch: 40, Steps: 32 | Train Loss: 3.208 Vali Loss: 86.111 Vali Acc: 0.618 Test Loss: 86.111 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 4.987064599990845
Epoch: 41, Steps: 32 | Train Loss: 1.887 Vali Loss: 147.047 Vali Acc: 0.534 Test Loss: 147.047 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 5.187389612197876
Epoch: 42, Steps: 32 | Train Loss: 1.696 Vali Loss: 181.246 Vali Acc: 0.336 Test Loss: 181.246 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 4.957928895950317
Epoch: 43, Steps: 32 | Train Loss: 3.510 Vali Loss: 102.707 Vali Acc: 0.634 Test Loss: 102.707 Test Acc: 0.634
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 4.956020832061768
Epoch: 44, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.784 Vali Acc: 0.641 Test Loss: 105.784 Test Acc: 0.641
Validation loss decreased (-0.632802 --> -0.640164).  Saving model ...
Epoch: 45 cost time: 4.885397672653198
Epoch: 45, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.926 Vali Acc: 0.641 Test Loss: 105.926 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 5.087817192077637
Epoch: 46, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 5.423833847045898
Epoch: 47, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 5.067061185836792
Epoch: 48, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 4.794737339019775
Epoch: 49, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 5.1860032081604
Epoch: 50, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 4.7300825119018555
Epoch: 51, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 4.556766986846924
Epoch: 52, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 5.409219026565552
Epoch: 53, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 5.035719871520996
Epoch: 54, Steps: 32 | Train Loss: 0.000 Vali Loss: 105.932 Vali Acc: 0.641 Test Loss: 105.932 Test Acc: 0.641
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6412213740458015
model parameter : 6027949
model size : 27.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.29150128364563
Epoch: 1, Steps: 32 | Train Loss: 7.628 Vali Loss: 13.827 Vali Acc: 0.229 Test Loss: 13.827 Test Acc: 0.229
Validation loss decreased (inf --> -0.228869).  Saving model ...
Epoch: 2 cost time: 4.53336501121521
Epoch: 2, Steps: 32 | Train Loss: 12.683 Vali Loss: 9.540 Vali Acc: 0.282 Test Loss: 9.540 Test Acc: 0.282
Validation loss decreased (-0.228869 --> -0.282347).  Saving model ...
Epoch: 3 cost time: 4.569501161575317
Epoch: 3, Steps: 32 | Train Loss: 9.750 Vali Loss: 21.266 Vali Acc: 0.443 Test Loss: 21.266 Test Acc: 0.443
Validation loss decreased (-0.282347 --> -0.442535).  Saving model ...
Epoch: 4 cost time: 4.469595670700073
Epoch: 4, Steps: 32 | Train Loss: 26.218 Vali Loss: 34.384 Vali Acc: 0.412 Test Loss: 34.384 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.215028524398804
Epoch: 5, Steps: 32 | Train Loss: 13.302 Vali Loss: 20.806 Vali Acc: 0.328 Test Loss: 20.806 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.157422065734863
Epoch: 6, Steps: 32 | Train Loss: 21.701 Vali Loss: 68.203 Vali Acc: 0.435 Test Loss: 68.203 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.644208669662476
Epoch: 7, Steps: 32 | Train Loss: 14.341 Vali Loss: 46.995 Vali Acc: 0.504 Test Loss: 46.995 Test Acc: 0.504
Validation loss decreased (-0.442535 --> -0.503347).  Saving model ...
Epoch: 8 cost time: 5.306931018829346
Epoch: 8, Steps: 32 | Train Loss: 14.186 Vali Loss: 66.877 Vali Acc: 0.473 Test Loss: 66.877 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.4755518436431885
Epoch: 9, Steps: 32 | Train Loss: 22.246 Vali Loss: 42.414 Vali Acc: 0.534 Test Loss: 42.414 Test Acc: 0.534
Validation loss decreased (-0.503347 --> -0.533927).  Saving model ...
Epoch: 10 cost time: 4.2921295166015625
Epoch: 10, Steps: 32 | Train Loss: 7.868 Vali Loss: 68.229 Vali Acc: 0.290 Test Loss: 68.229 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.157968521118164
Epoch: 11, Steps: 32 | Train Loss: 11.274 Vali Loss: 41.305 Vali Acc: 0.550 Test Loss: 41.305 Test Acc: 0.550
Validation loss decreased (-0.533927 --> -0.549205).  Saving model ...
Epoch: 12 cost time: 4.605525732040405
Epoch: 12, Steps: 32 | Train Loss: 10.755 Vali Loss: 53.272 Vali Acc: 0.489 Test Loss: 53.272 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.302259206771851
Epoch: 13, Steps: 32 | Train Loss: 7.971 Vali Loss: 56.729 Vali Acc: 0.405 Test Loss: 56.729 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.21247673034668
Epoch: 14, Steps: 32 | Train Loss: 8.962 Vali Loss: 73.638 Vali Acc: 0.473 Test Loss: 73.638 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.97175669670105
Epoch: 15, Steps: 32 | Train Loss: 10.123 Vali Loss: 31.737 Vali Acc: 0.504 Test Loss: 31.737 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.402343273162842
Epoch: 16, Steps: 32 | Train Loss: 4.492 Vali Loss: 32.344 Vali Acc: 0.603 Test Loss: 32.344 Test Acc: 0.603
Validation loss decreased (-0.549205 --> -0.602730).  Saving model ...
Epoch: 17 cost time: 4.466430902481079
Epoch: 17, Steps: 32 | Train Loss: 7.073 Vali Loss: 54.072 Vali Acc: 0.466 Test Loss: 54.072 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.553002834320068
Epoch: 18, Steps: 32 | Train Loss: 1.124 Vali Loss: 84.889 Vali Acc: 0.542 Test Loss: 84.889 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.247990846633911
Epoch: 19, Steps: 32 | Train Loss: 3.508 Vali Loss: 87.308 Vali Acc: 0.336 Test Loss: 87.308 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.492489814758301
Epoch: 20, Steps: 32 | Train Loss: 2.753 Vali Loss: 113.812 Vali Acc: 0.489 Test Loss: 113.812 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.40524435043335
Epoch: 21, Steps: 32 | Train Loss: 2.740 Vali Loss: 104.441 Vali Acc: 0.313 Test Loss: 104.441 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.984869956970215
Epoch: 22, Steps: 32 | Train Loss: 2.222 Vali Loss: 98.767 Vali Acc: 0.573 Test Loss: 98.767 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.931034564971924
Epoch: 23, Steps: 32 | Train Loss: 3.383 Vali Loss: 43.241 Vali Acc: 0.557 Test Loss: 43.241 Test Acc: 0.557
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.957347393035889
Epoch: 24, Steps: 32 | Train Loss: 2.435 Vali Loss: 60.189 Vali Acc: 0.565 Test Loss: 60.189 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.45081639289856
Epoch: 25, Steps: 32 | Train Loss: 7.999 Vali Loss: 62.082 Vali Acc: 0.466 Test Loss: 62.082 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.42440938949585
Epoch: 26, Steps: 32 | Train Loss: 10.197 Vali Loss: 87.943 Vali Acc: 0.595 Test Loss: 87.943 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 6027949
model size : 27.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.06777024269104
Epoch: 1, Steps: 32 | Train Loss: 7.118 Vali Loss: 10.030 Vali Acc: 0.153 Test Loss: 10.030 Test Acc: 0.153
Validation loss decreased (inf --> -0.152571).  Saving model ...
Epoch: 2 cost time: 4.321455478668213
Epoch: 2, Steps: 32 | Train Loss: 14.369 Vali Loss: 8.380 Vali Acc: 0.275 Test Loss: 8.380 Test Acc: 0.275
Validation loss decreased (-0.152571 --> -0.274725).  Saving model ...
Epoch: 3 cost time: 4.117371082305908
Epoch: 3, Steps: 32 | Train Loss: 14.847 Vali Loss: 33.832 Vali Acc: 0.405 Test Loss: 33.832 Test Acc: 0.405
Validation loss decreased (-0.274725 --> -0.404242).  Saving model ...
Epoch: 4 cost time: 4.126311302185059
Epoch: 4, Steps: 32 | Train Loss: 32.372 Vali Loss: 13.898 Vali Acc: 0.382 Test Loss: 13.898 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.028325796127319
Epoch: 5, Steps: 32 | Train Loss: 12.299 Vali Loss: 16.896 Vali Acc: 0.267 Test Loss: 16.896 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.204242467880249
Epoch: 6, Steps: 32 | Train Loss: 17.498 Vali Loss: 39.330 Vali Acc: 0.427 Test Loss: 39.330 Test Acc: 0.427
Validation loss decreased (-0.404242 --> -0.427088).  Saving model ...
Epoch: 7 cost time: 4.455320119857788
Epoch: 7, Steps: 32 | Train Loss: 16.527 Vali Loss: 58.833 Vali Acc: 0.237 Test Loss: 58.833 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.806356191635132
Epoch: 8, Steps: 32 | Train Loss: 28.043 Vali Loss: 72.986 Vali Acc: 0.145 Test Loss: 72.986 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.699279308319092
Epoch: 9, Steps: 32 | Train Loss: 38.647 Vali Loss: 64.317 Vali Acc: 0.435 Test Loss: 64.317 Test Acc: 0.435
Validation loss decreased (-0.427088 --> -0.434471).  Saving model ...
Epoch: 10 cost time: 4.145075798034668
Epoch: 10, Steps: 32 | Train Loss: 26.191 Vali Loss: 58.382 Vali Acc: 0.260 Test Loss: 58.382 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.298641920089722
Epoch: 11, Steps: 32 | Train Loss: 27.310 Vali Loss: 54.158 Vali Acc: 0.420 Test Loss: 54.158 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.404252290725708
Epoch: 12, Steps: 32 | Train Loss: 20.338 Vali Loss: 51.915 Vali Acc: 0.450 Test Loss: 51.915 Test Acc: 0.450
Validation loss decreased (-0.434471 --> -0.449863).  Saving model ...
Epoch: 13 cost time: 4.238504886627197
Epoch: 13, Steps: 32 | Train Loss: 10.168 Vali Loss: 62.241 Vali Acc: 0.221 Test Loss: 62.241 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.400155067443848
Epoch: 14, Steps: 32 | Train Loss: 15.911 Vali Loss: 58.348 Vali Acc: 0.481 Test Loss: 58.348 Test Acc: 0.481
Validation loss decreased (-0.449863 --> -0.480333).  Saving model ...
Epoch: 15 cost time: 4.291407108306885
Epoch: 15, Steps: 32 | Train Loss: 7.199 Vali Loss: 46.249 Vali Acc: 0.481 Test Loss: 46.249 Test Acc: 0.481
Validation loss decreased (-0.480333 --> -0.480454).  Saving model ...
Epoch: 16 cost time: 4.727741479873657
Epoch: 16, Steps: 32 | Train Loss: 3.516 Vali Loss: 48.602 Vali Acc: 0.412 Test Loss: 48.602 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.276274681091309
Epoch: 17, Steps: 32 | Train Loss: 2.190 Vali Loss: 49.835 Vali Acc: 0.550 Test Loss: 49.835 Test Acc: 0.550
Validation loss decreased (-0.480454 --> -0.549120).  Saving model ...
Epoch: 18 cost time: 4.075698137283325
Epoch: 18, Steps: 32 | Train Loss: 2.407 Vali Loss: 98.562 Vali Acc: 0.267 Test Loss: 98.562 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.084291458129883
Epoch: 19, Steps: 32 | Train Loss: 3.572 Vali Loss: 75.873 Vali Acc: 0.290 Test Loss: 75.873 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.497485876083374
Epoch: 20, Steps: 32 | Train Loss: 2.544 Vali Loss: 69.789 Vali Acc: 0.550 Test Loss: 69.789 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.654277801513672
Epoch: 21, Steps: 32 | Train Loss: 3.616 Vali Loss: 76.401 Vali Acc: 0.489 Test Loss: 76.401 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.123034715652466
Epoch: 22, Steps: 32 | Train Loss: 2.113 Vali Loss: 68.814 Vali Acc: 0.557 Test Loss: 68.814 Test Acc: 0.557
Validation loss decreased (-0.549120 --> -0.556564).  Saving model ...
Epoch: 23 cost time: 4.678990364074707
Epoch: 23, Steps: 32 | Train Loss: 0.656 Vali Loss: 65.891 Vali Acc: 0.527 Test Loss: 65.891 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.999997138977051
Epoch: 24, Steps: 32 | Train Loss: 0.858 Vali Loss: 80.773 Vali Acc: 0.511 Test Loss: 80.773 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.251572370529175
Epoch: 25, Steps: 32 | Train Loss: 3.172 Vali Loss: 119.809 Vali Acc: 0.298 Test Loss: 119.809 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.369858741760254
Epoch: 26, Steps: 32 | Train Loss: 6.139 Vali Loss: 94.923 Vali Acc: 0.511 Test Loss: 94.923 Test Acc: 0.511
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.490561008453369
Epoch: 27, Steps: 32 | Train Loss: 0.383 Vali Loss: 79.632 Vali Acc: 0.542 Test Loss: 79.632 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.5480852127075195
Epoch: 28, Steps: 32 | Train Loss: 0.083 Vali Loss: 63.012 Vali Acc: 0.542 Test Loss: 63.012 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.16843318939209
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 86.072 Vali Acc: 0.511 Test Loss: 86.072 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.0026092529296875
Epoch: 30, Steps: 32 | Train Loss: 0.147 Vali Loss: 86.801 Vali Acc: 0.359 Test Loss: 86.801 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.897616386413574
Epoch: 31, Steps: 32 | Train Loss: 0.405 Vali Loss: 93.128 Vali Acc: 0.527 Test Loss: 93.128 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.611698150634766
Epoch: 32, Steps: 32 | Train Loss: 0.058 Vali Loss: 76.416 Vali Acc: 0.565 Test Loss: 76.416 Test Acc: 0.565
Validation loss decreased (-0.556564 --> -0.564121).  Saving model ...
Epoch: 33 cost time: 4.626060724258423
Epoch: 33, Steps: 32 | Train Loss: 0.261 Vali Loss: 87.517 Vali Acc: 0.542 Test Loss: 87.517 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.439027309417725
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.234 Vali Acc: 0.534 Test Loss: 91.234 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.048352003097534
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.372 Vali Acc: 0.534 Test Loss: 91.372 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.932580947875977
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.377 Vali Acc: 0.534 Test Loss: 91.377 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.042541265487671
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 91.377 Vali Acc: 0.534 Test Loss: 91.377 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.2342822551727295
Epoch: 38, Steps: 32 | Train Loss: 0.085 Vali Loss: 125.203 Vali Acc: 0.542 Test Loss: 125.203 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.654277563095093
Epoch: 39, Steps: 32 | Train Loss: 1.763 Vali Loss: 77.193 Vali Acc: 0.565 Test Loss: 77.193 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.369515419006348
Epoch: 40, Steps: 32 | Train Loss: 0.675 Vali Loss: 129.361 Vali Acc: 0.527 Test Loss: 129.361 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.133991003036499
Epoch: 41, Steps: 32 | Train Loss: 1.273 Vali Loss: 79.147 Vali Acc: 0.542 Test Loss: 79.147 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.7546162605285645
Epoch: 42, Steps: 32 | Train Loss: 0.356 Vali Loss: 134.858 Vali Acc: 0.519 Test Loss: 134.858 Test Acc: 0.519
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 6027949
model size : 27.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.4046406745910645
Epoch: 1, Steps: 32 | Train Loss: 9.126 Vali Loss: 7.945 Vali Acc: 0.275 Test Loss: 7.945 Test Acc: 0.275
Validation loss decreased (inf --> -0.274730).  Saving model ...
Epoch: 2 cost time: 4.2523229122161865
Epoch: 2, Steps: 32 | Train Loss: 10.505 Vali Loss: 13.257 Vali Acc: 0.244 Test Loss: 13.257 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.418486833572388
Epoch: 3, Steps: 32 | Train Loss: 14.362 Vali Loss: 18.514 Vali Acc: 0.321 Test Loss: 18.514 Test Acc: 0.321
Validation loss decreased (-0.274730 --> -0.320426).  Saving model ...
Epoch: 4 cost time: 4.530164480209351
Epoch: 4, Steps: 32 | Train Loss: 13.360 Vali Loss: 33.150 Vali Acc: 0.481 Test Loss: 33.150 Test Acc: 0.481
Validation loss decreased (-0.320426 --> -0.480585).  Saving model ...
Epoch: 5 cost time: 4.756774663925171
Epoch: 5, Steps: 32 | Train Loss: 12.951 Vali Loss: 52.960 Vali Acc: 0.328 Test Loss: 52.960 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.538690090179443
Epoch: 6, Steps: 32 | Train Loss: 15.147 Vali Loss: 32.082 Vali Acc: 0.290 Test Loss: 32.082 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.496418237686157
Epoch: 7, Steps: 32 | Train Loss: 11.922 Vali Loss: 54.038 Vali Acc: 0.351 Test Loss: 54.038 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.5873026847839355
Epoch: 8, Steps: 32 | Train Loss: 12.686 Vali Loss: 34.922 Vali Acc: 0.389 Test Loss: 34.922 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.963578462600708
Epoch: 9, Steps: 32 | Train Loss: 9.332 Vali Loss: 32.498 Vali Acc: 0.511 Test Loss: 32.498 Test Acc: 0.511
Validation loss decreased (-0.480585 --> -0.511125).  Saving model ...
Epoch: 10 cost time: 5.000396966934204
Epoch: 10, Steps: 32 | Train Loss: 6.568 Vali Loss: 38.465 Vali Acc: 0.412 Test Loss: 38.465 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.765430688858032
Epoch: 11, Steps: 32 | Train Loss: 3.451 Vali Loss: 73.813 Vali Acc: 0.374 Test Loss: 73.813 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.552212238311768
Epoch: 12, Steps: 32 | Train Loss: 8.311 Vali Loss: 57.159 Vali Acc: 0.420 Test Loss: 57.159 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.2953221797943115
Epoch: 13, Steps: 32 | Train Loss: 4.582 Vali Loss: 37.894 Vali Acc: 0.534 Test Loss: 37.894 Test Acc: 0.534
Validation loss decreased (-0.511125 --> -0.533972).  Saving model ...
Epoch: 14 cost time: 4.731260776519775
Epoch: 14, Steps: 32 | Train Loss: 4.673 Vali Loss: 49.198 Vali Acc: 0.450 Test Loss: 49.198 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.6775288581848145
Epoch: 15, Steps: 32 | Train Loss: 7.407 Vali Loss: 55.731 Vali Acc: 0.511 Test Loss: 55.731 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.775835752487183
Epoch: 16, Steps: 32 | Train Loss: 3.145 Vali Loss: 75.271 Vali Acc: 0.420 Test Loss: 75.271 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.392636060714722
Epoch: 17, Steps: 32 | Train Loss: 2.882 Vali Loss: 68.062 Vali Acc: 0.366 Test Loss: 68.062 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.371200084686279
Epoch: 18, Steps: 32 | Train Loss: 12.696 Vali Loss: 92.806 Vali Acc: 0.313 Test Loss: 92.806 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.7347118854522705
Epoch: 19, Steps: 32 | Train Loss: 8.937 Vali Loss: 67.347 Vali Acc: 0.565 Test Loss: 67.347 Test Acc: 0.565
Validation loss decreased (-0.533972 --> -0.564212).  Saving model ...
Epoch: 20 cost time: 4.890455722808838
Epoch: 20, Steps: 32 | Train Loss: 2.921 Vali Loss: 64.945 Vali Acc: 0.550 Test Loss: 64.945 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.600191116333008
Epoch: 21, Steps: 32 | Train Loss: 0.382 Vali Loss: 61.750 Vali Acc: 0.527 Test Loss: 61.750 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.285364866256714
Epoch: 22, Steps: 32 | Train Loss: 2.336 Vali Loss: 65.435 Vali Acc: 0.603 Test Loss: 65.435 Test Acc: 0.603
Validation loss decreased (-0.564212 --> -0.602399).  Saving model ...
Epoch: 23 cost time: 4.537552833557129
Epoch: 23, Steps: 32 | Train Loss: 0.768 Vali Loss: 66.429 Vali Acc: 0.595 Test Loss: 66.429 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.709290027618408
Epoch: 24, Steps: 32 | Train Loss: 2.067 Vali Loss: 91.734 Vali Acc: 0.534 Test Loss: 91.734 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.596920967102051
Epoch: 25, Steps: 32 | Train Loss: 5.852 Vali Loss: 58.334 Vali Acc: 0.595 Test Loss: 58.334 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.931127071380615
Epoch: 26, Steps: 32 | Train Loss: 4.029 Vali Loss: 55.859 Vali Acc: 0.580 Test Loss: 55.859 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.636647701263428
Epoch: 27, Steps: 32 | Train Loss: 2.556 Vali Loss: 65.850 Vali Acc: 0.603 Test Loss: 65.850 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.718668699264526
Epoch: 28, Steps: 32 | Train Loss: 0.921 Vali Loss: 55.507 Vali Acc: 0.656 Test Loss: 55.507 Test Acc: 0.656
Validation loss decreased (-0.602399 --> -0.655933).  Saving model ...
Epoch: 29 cost time: 4.902645111083984
Epoch: 29, Steps: 32 | Train Loss: 0.109 Vali Loss: 92.949 Vali Acc: 0.550 Test Loss: 92.949 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.855810642242432
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.903 Vali Acc: 0.542 Test Loss: 94.903 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.591920375823975
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.976 Vali Acc: 0.542 Test Loss: 94.976 Test Acc: 0.542
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.47864556312561
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.978 Vali Acc: 0.542 Test Loss: 94.978 Test Acc: 0.542
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.8047919273376465
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.978 Vali Acc: 0.542 Test Loss: 94.978 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.908065319061279
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.978 Vali Acc: 0.542 Test Loss: 94.978 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.64210319519043
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.974 Vali Acc: 0.542 Test Loss: 94.974 Test Acc: 0.542
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.906560182571411
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.971 Vali Acc: 0.542 Test Loss: 94.971 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.5365378856658936
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.971 Vali Acc: 0.542 Test Loss: 94.971 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.691277265548706
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.971 Vali Acc: 0.542 Test Loss: 94.971 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 5896877
model size : 26.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.624108791351318
Epoch: 1, Steps: 32 | Train Loss: 8.523 Vali Loss: 12.433 Vali Acc: 0.145 Test Loss: 12.433 Test Acc: 0.145
Validation loss decreased (inf --> -0.144914).  Saving model ...
Epoch: 2 cost time: 4.3420915603637695
Epoch: 2, Steps: 32 | Train Loss: 8.745 Vali Loss: 18.611 Vali Acc: 0.420 Test Loss: 18.611 Test Acc: 0.420
Validation loss decreased (-0.144914 --> -0.419661).  Saving model ...
Epoch: 3 cost time: 4.6368749141693115
Epoch: 3, Steps: 32 | Train Loss: 13.343 Vali Loss: 19.774 Vali Acc: 0.176 Test Loss: 19.774 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.992482900619507
Epoch: 4, Steps: 32 | Train Loss: 15.222 Vali Loss: 35.393 Vali Acc: 0.282 Test Loss: 35.393 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.959789752960205
Epoch: 5, Steps: 32 | Train Loss: 11.359 Vali Loss: 45.895 Vali Acc: 0.450 Test Loss: 45.895 Test Acc: 0.450
Validation loss decreased (-0.419661 --> -0.449923).  Saving model ...
Epoch: 6 cost time: 5.171216249465942
Epoch: 6, Steps: 32 | Train Loss: 26.269 Vali Loss: 51.478 Vali Acc: 0.473 Test Loss: 51.478 Test Acc: 0.473
Validation loss decreased (-0.449923 --> -0.472768).  Saving model ...
Epoch: 7 cost time: 4.939231634140015
Epoch: 7, Steps: 32 | Train Loss: 16.652 Vali Loss: 46.933 Vali Acc: 0.489 Test Loss: 46.933 Test Acc: 0.489
Validation loss decreased (-0.472768 --> -0.488080).  Saving model ...
Epoch: 8 cost time: 4.522837162017822
Epoch: 8, Steps: 32 | Train Loss: 7.824 Vali Loss: 59.467 Vali Acc: 0.305 Test Loss: 59.467 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.151283025741577
Epoch: 9, Steps: 32 | Train Loss: 11.458 Vali Loss: 54.970 Vali Acc: 0.198 Test Loss: 54.970 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.051609992980957
Epoch: 10, Steps: 32 | Train Loss: 5.054 Vali Loss: 31.818 Vali Acc: 0.405 Test Loss: 31.818 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.654487371444702
Epoch: 11, Steps: 32 | Train Loss: 7.753 Vali Loss: 49.210 Vali Acc: 0.435 Test Loss: 49.210 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.924895524978638
Epoch: 12, Steps: 32 | Train Loss: 13.464 Vali Loss: 61.676 Vali Acc: 0.435 Test Loss: 61.676 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.685317039489746
Epoch: 13, Steps: 32 | Train Loss: 14.805 Vali Loss: 68.002 Vali Acc: 0.282 Test Loss: 68.002 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.203947067260742
Epoch: 14, Steps: 32 | Train Loss: 9.650 Vali Loss: 61.940 Vali Acc: 0.527 Test Loss: 61.940 Test Acc: 0.527
Validation loss decreased (-0.488080 --> -0.526098).  Saving model ...
Epoch: 15 cost time: 4.734222412109375
Epoch: 15, Steps: 32 | Train Loss: 5.429 Vali Loss: 53.764 Vali Acc: 0.450 Test Loss: 53.764 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.58378529548645
Epoch: 16, Steps: 32 | Train Loss: 1.359 Vali Loss: 76.474 Vali Acc: 0.412 Test Loss: 76.474 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.700715780258179
Epoch: 17, Steps: 32 | Train Loss: 3.490 Vali Loss: 66.814 Vali Acc: 0.565 Test Loss: 66.814 Test Acc: 0.565
Validation loss decreased (-0.526098 --> -0.564217).  Saving model ...
Epoch: 18 cost time: 4.343645811080933
Epoch: 18, Steps: 32 | Train Loss: 0.344 Vali Loss: 58.392 Vali Acc: 0.573 Test Loss: 58.392 Test Acc: 0.573
Validation loss decreased (-0.564217 --> -0.571935).  Saving model ...
Epoch: 19 cost time: 4.400463342666626
Epoch: 19, Steps: 32 | Train Loss: 1.341 Vali Loss: 73.667 Vali Acc: 0.351 Test Loss: 73.667 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.76534628868103
Epoch: 20, Steps: 32 | Train Loss: 4.614 Vali Loss: 82.532 Vali Acc: 0.519 Test Loss: 82.532 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.788696765899658
Epoch: 21, Steps: 32 | Train Loss: 7.305 Vali Loss: 60.965 Vali Acc: 0.557 Test Loss: 60.965 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.499959468841553
Epoch: 22, Steps: 32 | Train Loss: 4.211 Vali Loss: 89.473 Vali Acc: 0.504 Test Loss: 89.473 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.65101170539856
Epoch: 23, Steps: 32 | Train Loss: 7.823 Vali Loss: 71.956 Vali Acc: 0.511 Test Loss: 71.956 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.610581159591675
Epoch: 24, Steps: 32 | Train Loss: 0.880 Vali Loss: 68.321 Vali Acc: 0.611 Test Loss: 68.321 Test Acc: 0.611
Validation loss decreased (-0.571935 --> -0.610004).  Saving model ...
Epoch: 25 cost time: 4.536567687988281
Epoch: 25, Steps: 32 | Train Loss: 1.396 Vali Loss: 55.690 Vali Acc: 0.595 Test Loss: 55.690 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.434295177459717
Epoch: 26, Steps: 32 | Train Loss: 0.647 Vali Loss: 89.003 Vali Acc: 0.534 Test Loss: 89.003 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.529911279678345
Epoch: 27, Steps: 32 | Train Loss: 1.858 Vali Loss: 93.380 Vali Acc: 0.580 Test Loss: 93.380 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.4302122592926025
Epoch: 28, Steps: 32 | Train Loss: 3.008 Vali Loss: 115.829 Vali Acc: 0.397 Test Loss: 115.829 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.546363830566406
Epoch: 29, Steps: 32 | Train Loss: 0.744 Vali Loss: 54.901 Vali Acc: 0.649 Test Loss: 54.901 Test Acc: 0.649
Validation loss decreased (-0.610004 --> -0.648306).  Saving model ...
Epoch: 30 cost time: 4.359149694442749
Epoch: 30, Steps: 32 | Train Loss: 0.001 Vali Loss: 68.178 Vali Acc: 0.588 Test Loss: 68.178 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.542393684387207
Epoch: 31, Steps: 32 | Train Loss: 0.049 Vali Loss: 51.331 Vali Acc: 0.672 Test Loss: 51.331 Test Acc: 0.672
Validation loss decreased (-0.648306 --> -0.671242).  Saving model ...
Epoch: 32 cost time: 4.503295660018921
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.615 Vali Acc: 0.664 Test Loss: 51.615 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.965919256210327
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.606 Vali Acc: 0.664 Test Loss: 51.606 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 5.002269744873047
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.264023542404175
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.452948331832886
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 5.236568212509155
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 5.017225742340088
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.697206020355225
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.944882154464722
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.674905061721802
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 51.604 Vali Acc: 0.664 Test Loss: 51.604 Test Acc: 0.664
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6717557251908397
model parameter : 5896877
model size : 26.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.280304908752441
Epoch: 1, Steps: 32 | Train Loss: 8.612 Vali Loss: 7.237 Vali Acc: 0.389 Test Loss: 7.237 Test Acc: 0.389
Validation loss decreased (inf --> -0.389241).  Saving model ...
Epoch: 2 cost time: 4.189601898193359
Epoch: 2, Steps: 32 | Train Loss: 8.591 Vali Loss: 27.843 Vali Acc: 0.145 Test Loss: 27.843 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.0683722496032715
Epoch: 3, Steps: 32 | Train Loss: 12.040 Vali Loss: 17.536 Vali Acc: 0.420 Test Loss: 17.536 Test Acc: 0.420
Validation loss decreased (-0.389241 --> -0.419672).  Saving model ...
Epoch: 4 cost time: 4.110299348831177
Epoch: 4, Steps: 32 | Train Loss: 27.907 Vali Loss: 53.638 Vali Acc: 0.145 Test Loss: 53.638 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.375534772872925
Epoch: 5, Steps: 32 | Train Loss: 21.636 Vali Loss: 40.793 Vali Acc: 0.481 Test Loss: 40.793 Test Acc: 0.481
Validation loss decreased (-0.419672 --> -0.480508).  Saving model ...
Epoch: 6 cost time: 3.9082143306732178
Epoch: 6, Steps: 32 | Train Loss: 20.880 Vali Loss: 46.852 Vali Acc: 0.336 Test Loss: 46.852 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.189442873001099
Epoch: 7, Steps: 32 | Train Loss: 17.981 Vali Loss: 38.553 Vali Acc: 0.466 Test Loss: 38.553 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.0980329513549805
Epoch: 8, Steps: 32 | Train Loss: 27.761 Vali Loss: 45.113 Vali Acc: 0.397 Test Loss: 45.113 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.076032638549805
Epoch: 9, Steps: 32 | Train Loss: 24.721 Vali Loss: 61.448 Vali Acc: 0.420 Test Loss: 61.448 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.752946376800537
Epoch: 10, Steps: 32 | Train Loss: 19.724 Vali Loss: 51.774 Vali Acc: 0.496 Test Loss: 51.774 Test Acc: 0.496
Validation loss decreased (-0.480508 --> -0.495665).  Saving model ...
Epoch: 11 cost time: 3.9372260570526123
Epoch: 11, Steps: 32 | Train Loss: 10.081 Vali Loss: 71.120 Vali Acc: 0.328 Test Loss: 71.120 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.382949113845825
Epoch: 12, Steps: 32 | Train Loss: 15.673 Vali Loss: 51.380 Vali Acc: 0.351 Test Loss: 51.380 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.120917081832886
Epoch: 13, Steps: 32 | Train Loss: 14.850 Vali Loss: 42.012 Vali Acc: 0.427 Test Loss: 42.012 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7679688930511475
Epoch: 14, Steps: 32 | Train Loss: 7.273 Vali Loss: 34.432 Vali Acc: 0.573 Test Loss: 34.432 Test Acc: 0.573
Validation loss decreased (-0.495665 --> -0.572175).  Saving model ...
Epoch: 15 cost time: 4.0863142013549805
Epoch: 15, Steps: 32 | Train Loss: 8.606 Vali Loss: 61.122 Vali Acc: 0.511 Test Loss: 61.122 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.6313183307647705
Epoch: 16, Steps: 32 | Train Loss: 4.830 Vali Loss: 63.310 Vali Acc: 0.466 Test Loss: 63.310 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.597404956817627
Epoch: 17, Steps: 32 | Train Loss: 8.354 Vali Loss: 58.563 Vali Acc: 0.595 Test Loss: 58.563 Test Acc: 0.595
Validation loss decreased (-0.572175 --> -0.594834).  Saving model ...
Epoch: 18 cost time: 4.833547353744507
Epoch: 18, Steps: 32 | Train Loss: 2.830 Vali Loss: 76.475 Vali Acc: 0.550 Test Loss: 76.475 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.883429050445557
Epoch: 19, Steps: 32 | Train Loss: 2.719 Vali Loss: 70.618 Vali Acc: 0.511 Test Loss: 70.618 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.592720985412598
Epoch: 20, Steps: 32 | Train Loss: 0.522 Vali Loss: 55.267 Vali Acc: 0.580 Test Loss: 55.267 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.491273880004883
Epoch: 21, Steps: 32 | Train Loss: 0.586 Vali Loss: 40.406 Vali Acc: 0.618 Test Loss: 40.406 Test Acc: 0.618
Validation loss decreased (-0.594834 --> -0.617917).  Saving model ...
Epoch: 22 cost time: 4.882403612136841
Epoch: 22, Steps: 32 | Train Loss: 1.089 Vali Loss: 97.140 Vali Acc: 0.519 Test Loss: 97.140 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.0835349559783936
Epoch: 23, Steps: 32 | Train Loss: 2.355 Vali Loss: 53.209 Vali Acc: 0.603 Test Loss: 53.209 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.507983207702637
Epoch: 24, Steps: 32 | Train Loss: 0.574 Vali Loss: 47.874 Vali Acc: 0.611 Test Loss: 47.874 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.130262851715088
Epoch: 25, Steps: 32 | Train Loss: 0.629 Vali Loss: 61.520 Vali Acc: 0.595 Test Loss: 61.520 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.667033433914185
Epoch: 26, Steps: 32 | Train Loss: 0.523 Vali Loss: 54.855 Vali Acc: 0.611 Test Loss: 54.855 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.725573301315308
Epoch: 27, Steps: 32 | Train Loss: 0.241 Vali Loss: 49.272 Vali Acc: 0.519 Test Loss: 49.272 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.743153810501099
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.508 Vali Acc: 0.611 Test Loss: 53.508 Test Acc: 0.611
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.530520915985107
Epoch: 29, Steps: 32 | Train Loss: 1.567 Vali Loss: 67.085 Vali Acc: 0.519 Test Loss: 67.085 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.386946678161621
Epoch: 30, Steps: 32 | Train Loss: 2.016 Vali Loss: 57.590 Vali Acc: 0.527 Test Loss: 57.590 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.288067102432251
Epoch: 31, Steps: 32 | Train Loss: 3.776 Vali Loss: 151.788 Vali Acc: 0.344 Test Loss: 151.788 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 5896877
model size : 26.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.550646543502808
Epoch: 1, Steps: 32 | Train Loss: 7.329 Vali Loss: 9.653 Vali Acc: 0.176 Test Loss: 9.653 Test Acc: 0.176
Validation loss decreased (inf --> -0.175476).  Saving model ...
Epoch: 2 cost time: 4.004957437515259
Epoch: 2, Steps: 32 | Train Loss: 12.272 Vali Loss: 19.661 Vali Acc: 0.183 Test Loss: 19.661 Test Acc: 0.183
Validation loss decreased (-0.175476 --> -0.183009).  Saving model ...
Epoch: 3 cost time: 4.752949237823486
Epoch: 3, Steps: 32 | Train Loss: 10.077 Vali Loss: 16.407 Vali Acc: 0.145 Test Loss: 16.407 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.143303394317627
Epoch: 4, Steps: 32 | Train Loss: 14.910 Vali Loss: 30.284 Vali Acc: 0.435 Test Loss: 30.284 Test Acc: 0.435
Validation loss decreased (-0.183009 --> -0.434812).  Saving model ...
Epoch: 5 cost time: 4.1845762729644775
Epoch: 5, Steps: 32 | Train Loss: 29.876 Vali Loss: 38.301 Vali Acc: 0.191 Test Loss: 38.301 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.548173427581787
Epoch: 6, Steps: 32 | Train Loss: 23.292 Vali Loss: 36.001 Vali Acc: 0.198 Test Loss: 36.001 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.225496053695679
Epoch: 7, Steps: 32 | Train Loss: 13.696 Vali Loss: 24.875 Vali Acc: 0.282 Test Loss: 24.875 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.307595252990723
Epoch: 8, Steps: 32 | Train Loss: 28.336 Vali Loss: 75.953 Vali Acc: 0.214 Test Loss: 75.953 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.122036457061768
Epoch: 9, Steps: 32 | Train Loss: 39.580 Vali Loss: 67.359 Vali Acc: 0.450 Test Loss: 67.359 Test Acc: 0.450
Validation loss decreased (-0.434812 --> -0.449708).  Saving model ...
Epoch: 10 cost time: 4.078652620315552
Epoch: 10, Steps: 32 | Train Loss: 33.638 Vali Loss: 59.525 Vali Acc: 0.237 Test Loss: 59.525 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.195602178573608
Epoch: 11, Steps: 32 | Train Loss: 23.724 Vali Loss: 129.911 Vali Acc: 0.130 Test Loss: 129.911 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.009675979614258
Epoch: 12, Steps: 32 | Train Loss: 35.656 Vali Loss: 49.588 Vali Acc: 0.267 Test Loss: 49.588 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6258604526519775
Epoch: 13, Steps: 32 | Train Loss: 12.958 Vali Loss: 50.694 Vali Acc: 0.473 Test Loss: 50.694 Test Acc: 0.473
Validation loss decreased (-0.449708 --> -0.472776).  Saving model ...
Epoch: 14 cost time: 4.5961363315582275
Epoch: 14, Steps: 32 | Train Loss: 7.039 Vali Loss: 45.543 Vali Acc: 0.275 Test Loss: 45.543 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.373545408248901
Epoch: 15, Steps: 32 | Train Loss: 5.954 Vali Loss: 55.654 Vali Acc: 0.496 Test Loss: 55.654 Test Acc: 0.496
Validation loss decreased (-0.472776 --> -0.495627).  Saving model ...
Epoch: 16 cost time: 4.191741466522217
Epoch: 16, Steps: 32 | Train Loss: 6.617 Vali Loss: 87.442 Vali Acc: 0.511 Test Loss: 87.442 Test Acc: 0.511
Validation loss decreased (-0.495627 --> -0.510576).  Saving model ...
Epoch: 17 cost time: 3.8819892406463623
Epoch: 17, Steps: 32 | Train Loss: 7.585 Vali Loss: 71.166 Vali Acc: 0.260 Test Loss: 71.166 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.179638385772705
Epoch: 18, Steps: 32 | Train Loss: 0.795 Vali Loss: 45.310 Vali Acc: 0.595 Test Loss: 45.310 Test Acc: 0.595
Validation loss decreased (-0.510576 --> -0.594967).  Saving model ...
Epoch: 19 cost time: 4.790646076202393
Epoch: 19, Steps: 32 | Train Loss: 5.498 Vali Loss: 65.016 Vali Acc: 0.427 Test Loss: 65.016 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.2435619831085205
Epoch: 20, Steps: 32 | Train Loss: 3.206 Vali Loss: 67.111 Vali Acc: 0.321 Test Loss: 67.111 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.271007776260376
Epoch: 21, Steps: 32 | Train Loss: 4.321 Vali Loss: 68.214 Vali Acc: 0.565 Test Loss: 68.214 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.107069730758667
Epoch: 22, Steps: 32 | Train Loss: 6.086 Vali Loss: 82.002 Vali Acc: 0.527 Test Loss: 82.002 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.5882368087768555
Epoch: 23, Steps: 32 | Train Loss: 1.532 Vali Loss: 88.783 Vali Acc: 0.504 Test Loss: 88.783 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.2744903564453125
Epoch: 24, Steps: 32 | Train Loss: 4.449 Vali Loss: 95.820 Vali Acc: 0.595 Test Loss: 95.820 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.698041677474976
Epoch: 25, Steps: 32 | Train Loss: 1.008 Vali Loss: 98.004 Vali Acc: 0.511 Test Loss: 98.004 Test Acc: 0.511
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.828953504562378
Epoch: 26, Steps: 32 | Train Loss: 1.047 Vali Loss: 95.642 Vali Acc: 0.511 Test Loss: 95.642 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.176598072052002
Epoch: 27, Steps: 32 | Train Loss: 1.745 Vali Loss: 92.205 Vali Acc: 0.534 Test Loss: 92.205 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.498904466629028
Epoch: 28, Steps: 32 | Train Loss: 0.341 Vali Loss: 81.322 Vali Acc: 0.504 Test Loss: 81.322 Test Acc: 0.504
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5896877
model size : 26.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.519162893295288
Epoch: 1, Steps: 32 | Train Loss: 10.127 Vali Loss: 13.881 Vali Acc: 0.183 Test Loss: 13.881 Test Acc: 0.183
Validation loss decreased (inf --> -0.183067).  Saving model ...
Epoch: 2 cost time: 4.770750045776367
Epoch: 2, Steps: 32 | Train Loss: 10.354 Vali Loss: 21.061 Vali Acc: 0.290 Test Loss: 21.061 Test Acc: 0.290
Validation loss decreased (-0.183067 --> -0.289866).  Saving model ...
Epoch: 3 cost time: 4.650347948074341
Epoch: 3, Steps: 32 | Train Loss: 19.150 Vali Loss: 22.544 Vali Acc: 0.275 Test Loss: 22.544 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.049761533737183
Epoch: 4, Steps: 32 | Train Loss: 10.207 Vali Loss: 58.558 Vali Acc: 0.206 Test Loss: 58.558 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.401861190795898
Epoch: 5, Steps: 32 | Train Loss: 15.132 Vali Loss: 45.714 Vali Acc: 0.282 Test Loss: 45.714 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.866229057312012
Epoch: 6, Steps: 32 | Train Loss: 8.802 Vali Loss: 24.473 Vali Acc: 0.504 Test Loss: 24.473 Test Acc: 0.504
Validation loss decreased (-0.289866 --> -0.503572).  Saving model ...
Epoch: 7 cost time: 5.1481287479400635
Epoch: 7, Steps: 32 | Train Loss: 4.605 Vali Loss: 35.461 Vali Acc: 0.504 Test Loss: 35.461 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.030174732208252
Epoch: 8, Steps: 32 | Train Loss: 6.631 Vali Loss: 31.964 Vali Acc: 0.328 Test Loss: 31.964 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.64368200302124
Epoch: 9, Steps: 32 | Train Loss: 14.579 Vali Loss: 46.434 Vali Acc: 0.313 Test Loss: 46.434 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.870064735412598
Epoch: 10, Steps: 32 | Train Loss: 6.768 Vali Loss: 31.336 Vali Acc: 0.382 Test Loss: 31.336 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.302706956863403
Epoch: 11, Steps: 32 | Train Loss: 7.501 Vali Loss: 35.117 Vali Acc: 0.481 Test Loss: 35.117 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.8635663986206055
Epoch: 12, Steps: 32 | Train Loss: 12.393 Vali Loss: 47.177 Vali Acc: 0.458 Test Loss: 47.177 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.651745319366455
Epoch: 13, Steps: 32 | Train Loss: 11.214 Vali Loss: 68.431 Vali Acc: 0.336 Test Loss: 68.431 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.650569200515747
Epoch: 14, Steps: 32 | Train Loss: 10.005 Vali Loss: 58.593 Vali Acc: 0.420 Test Loss: 58.593 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.435571670532227
Epoch: 15, Steps: 32 | Train Loss: 7.923 Vali Loss: 53.758 Vali Acc: 0.489 Test Loss: 53.758 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.905310869216919
Epoch: 16, Steps: 32 | Train Loss: 8.052 Vali Loss: 63.464 Vali Acc: 0.443 Test Loss: 63.464 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 5831341
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.580083608627319
Epoch: 1, Steps: 32 | Train Loss: 8.958 Vali Loss: 15.737 Vali Acc: 0.145 Test Loss: 15.737 Test Acc: 0.145
Validation loss decreased (inf --> -0.144881).  Saving model ...
Epoch: 2 cost time: 4.177202463150024
Epoch: 2, Steps: 32 | Train Loss: 9.612 Vali Loss: 27.724 Vali Acc: 0.282 Test Loss: 27.724 Test Acc: 0.282
Validation loss decreased (-0.144881 --> -0.282166).  Saving model ...
Epoch: 3 cost time: 4.337619066238403
Epoch: 3, Steps: 32 | Train Loss: 17.685 Vali Loss: 22.493 Vali Acc: 0.397 Test Loss: 22.493 Test Acc: 0.397
Validation loss decreased (-0.282166 --> -0.396722).  Saving model ...
Epoch: 4 cost time: 4.1245551109313965
Epoch: 4, Steps: 32 | Train Loss: 21.877 Vali Loss: 13.777 Vali Acc: 0.359 Test Loss: 13.777 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.34266471862793
Epoch: 5, Steps: 32 | Train Loss: 15.286 Vali Loss: 52.772 Vali Acc: 0.214 Test Loss: 52.772 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.0980823040008545
Epoch: 6, Steps: 32 | Train Loss: 7.963 Vali Loss: 49.562 Vali Acc: 0.229 Test Loss: 49.562 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.667759656906128
Epoch: 7, Steps: 32 | Train Loss: 8.366 Vali Loss: 60.089 Vali Acc: 0.183 Test Loss: 60.089 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.446665048599243
Epoch: 8, Steps: 32 | Train Loss: 9.736 Vali Loss: 31.816 Vali Acc: 0.389 Test Loss: 31.816 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.035495042800903
Epoch: 9, Steps: 32 | Train Loss: 17.266 Vali Loss: 37.692 Vali Acc: 0.450 Test Loss: 37.692 Test Acc: 0.450
Validation loss decreased (-0.396722 --> -0.450005).  Saving model ...
Epoch: 10 cost time: 4.882137060165405
Epoch: 10, Steps: 32 | Train Loss: 2.176 Vali Loss: 40.545 Vali Acc: 0.450 Test Loss: 40.545 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.493816137313843
Epoch: 11, Steps: 32 | Train Loss: 4.545 Vali Loss: 54.409 Vali Acc: 0.321 Test Loss: 54.409 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.486924409866333
Epoch: 12, Steps: 32 | Train Loss: 21.884 Vali Loss: 76.807 Vali Acc: 0.519 Test Loss: 76.807 Test Acc: 0.519
Validation loss decreased (-0.450005 --> -0.518316).  Saving model ...
Epoch: 13 cost time: 4.723867416381836
Epoch: 13, Steps: 32 | Train Loss: 28.539 Vali Loss: 48.499 Vali Acc: 0.374 Test Loss: 48.499 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.803512334823608
Epoch: 14, Steps: 32 | Train Loss: 8.295 Vali Loss: 64.133 Vali Acc: 0.359 Test Loss: 64.133 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.804486989974976
Epoch: 15, Steps: 32 | Train Loss: 16.742 Vali Loss: 64.840 Vali Acc: 0.496 Test Loss: 64.840 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.83138370513916
Epoch: 16, Steps: 32 | Train Loss: 15.672 Vali Loss: 134.118 Vali Acc: 0.237 Test Loss: 134.118 Test Acc: 0.237
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.251418828964233
Epoch: 17, Steps: 32 | Train Loss: 23.696 Vali Loss: 55.678 Vali Acc: 0.534 Test Loss: 55.678 Test Acc: 0.534
Validation loss decreased (-0.518316 --> -0.533794).  Saving model ...
Epoch: 18 cost time: 4.554049730300903
Epoch: 18, Steps: 32 | Train Loss: 5.643 Vali Loss: 63.604 Vali Acc: 0.466 Test Loss: 63.604 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.130310535430908
Epoch: 19, Steps: 32 | Train Loss: 1.013 Vali Loss: 55.142 Vali Acc: 0.550 Test Loss: 55.142 Test Acc: 0.550
Validation loss decreased (-0.533794 --> -0.549067).  Saving model ...
Epoch: 20 cost time: 4.637405872344971
Epoch: 20, Steps: 32 | Train Loss: 2.882 Vali Loss: 53.360 Vali Acc: 0.611 Test Loss: 53.360 Test Acc: 0.611
Validation loss decreased (-0.549067 --> -0.610153).  Saving model ...
Epoch: 21 cost time: 4.5086894035339355
Epoch: 21, Steps: 32 | Train Loss: 2.968 Vali Loss: 86.113 Vali Acc: 0.511 Test Loss: 86.113 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.52434778213501
Epoch: 22, Steps: 32 | Train Loss: 1.777 Vali Loss: 68.704 Vali Acc: 0.519 Test Loss: 68.704 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.382271766662598
Epoch: 23, Steps: 32 | Train Loss: 2.391 Vali Loss: 63.207 Vali Acc: 0.588 Test Loss: 63.207 Test Acc: 0.588
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.95116114616394
Epoch: 24, Steps: 32 | Train Loss: 9.767 Vali Loss: 120.883 Vali Acc: 0.557 Test Loss: 120.883 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.6445152759552
Epoch: 25, Steps: 32 | Train Loss: 5.542 Vali Loss: 77.087 Vali Acc: 0.580 Test Loss: 77.087 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.438139915466309
Epoch: 26, Steps: 32 | Train Loss: 0.465 Vali Loss: 56.599 Vali Acc: 0.634 Test Loss: 56.599 Test Acc: 0.634
Validation loss decreased (-0.610153 --> -0.633022).  Saving model ...
Epoch: 27 cost time: 4.889359474182129
Epoch: 27, Steps: 32 | Train Loss: 0.102 Vali Loss: 67.603 Vali Acc: 0.603 Test Loss: 67.603 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.923377752304077
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 92.573 Vali Acc: 0.565 Test Loss: 92.573 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.092969655990601
Epoch: 29, Steps: 32 | Train Loss: 0.683 Vali Loss: 75.886 Vali Acc: 0.573 Test Loss: 75.886 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.848125219345093
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 81.968 Vali Acc: 0.573 Test Loss: 81.968 Test Acc: 0.573
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.305256366729736
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.199 Vali Acc: 0.573 Test Loss: 82.199 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.645549297332764
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.207 Vali Acc: 0.573 Test Loss: 82.207 Test Acc: 0.573
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.6853110790252686
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.208 Vali Acc: 0.573 Test Loss: 82.208 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.566131591796875
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.208 Vali Acc: 0.573 Test Loss: 82.208 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.8791584968566895
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.208 Vali Acc: 0.573 Test Loss: 82.208 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.528356075286865
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.208 Vali Acc: 0.573 Test Loss: 82.208 Test Acc: 0.573
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5831341
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.923036098480225
Epoch: 1, Steps: 32 | Train Loss: 9.017 Vali Loss: 14.138 Vali Acc: 0.191 Test Loss: 14.138 Test Acc: 0.191
Validation loss decreased (inf --> -0.190698).  Saving model ...
Epoch: 2 cost time: 4.170363187789917
Epoch: 2, Steps: 32 | Train Loss: 10.761 Vali Loss: 21.715 Vali Acc: 0.191 Test Loss: 21.715 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.623214483261108
Epoch: 3, Steps: 32 | Train Loss: 14.365 Vali Loss: 11.907 Vali Acc: 0.313 Test Loss: 11.907 Test Acc: 0.313
Validation loss decreased (-0.190698 --> -0.312858).  Saving model ...
Epoch: 4 cost time: 4.299475908279419
Epoch: 4, Steps: 32 | Train Loss: 17.259 Vali Loss: 52.595 Vali Acc: 0.176 Test Loss: 52.595 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.196015119552612
Epoch: 5, Steps: 32 | Train Loss: 15.311 Vali Loss: 43.319 Vali Acc: 0.321 Test Loss: 43.319 Test Acc: 0.321
Validation loss decreased (-0.312858 --> -0.320177).  Saving model ...
Epoch: 6 cost time: 5.181837320327759
Epoch: 6, Steps: 32 | Train Loss: 15.237 Vali Loss: 36.092 Vali Acc: 0.427 Test Loss: 36.092 Test Acc: 0.427
Validation loss decreased (-0.320177 --> -0.427120).  Saving model ...
Epoch: 7 cost time: 4.578371047973633
Epoch: 7, Steps: 32 | Train Loss: 15.350 Vali Loss: 44.339 Vali Acc: 0.443 Test Loss: 44.339 Test Acc: 0.443
Validation loss decreased (-0.427120 --> -0.442305).  Saving model ...
Epoch: 8 cost time: 4.962287664413452
Epoch: 8, Steps: 32 | Train Loss: 19.894 Vali Loss: 59.814 Vali Acc: 0.252 Test Loss: 59.814 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.634843826293945
Epoch: 9, Steps: 32 | Train Loss: 23.783 Vali Loss: 101.781 Vali Acc: 0.229 Test Loss: 101.781 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.887124300003052
Epoch: 10, Steps: 32 | Train Loss: 18.178 Vali Loss: 40.079 Vali Acc: 0.466 Test Loss: 40.079 Test Acc: 0.466
Validation loss decreased (-0.442305 --> -0.465248).  Saving model ...
Epoch: 11 cost time: 4.22296142578125
Epoch: 11, Steps: 32 | Train Loss: 8.419 Vali Loss: 41.145 Vali Acc: 0.351 Test Loss: 41.145 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.627460241317749
Epoch: 12, Steps: 32 | Train Loss: 11.169 Vali Loss: 42.525 Vali Acc: 0.344 Test Loss: 42.525 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.484034061431885
Epoch: 13, Steps: 32 | Train Loss: 9.758 Vali Loss: 70.961 Vali Acc: 0.366 Test Loss: 70.961 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.715790033340454
Epoch: 14, Steps: 32 | Train Loss: 22.063 Vali Loss: 43.623 Vali Acc: 0.389 Test Loss: 43.623 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.603990316390991
Epoch: 15, Steps: 32 | Train Loss: 25.283 Vali Loss: 66.157 Vali Acc: 0.481 Test Loss: 66.157 Test Acc: 0.481
Validation loss decreased (-0.465248 --> -0.480254).  Saving model ...
Epoch: 16 cost time: 4.772351264953613
Epoch: 16, Steps: 32 | Train Loss: 11.307 Vali Loss: 63.628 Vali Acc: 0.389 Test Loss: 63.628 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.142813682556152
Epoch: 17, Steps: 32 | Train Loss: 6.986 Vali Loss: 68.109 Vali Acc: 0.565 Test Loss: 68.109 Test Acc: 0.565
Validation loss decreased (-0.480254 --> -0.564204).  Saving model ...
Epoch: 18 cost time: 4.792065858840942
Epoch: 18, Steps: 32 | Train Loss: 3.569 Vali Loss: 88.411 Vali Acc: 0.466 Test Loss: 88.411 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.079548597335815
Epoch: 19, Steps: 32 | Train Loss: 11.350 Vali Loss: 84.434 Vali Acc: 0.527 Test Loss: 84.434 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.029006481170654
Epoch: 20, Steps: 32 | Train Loss: 2.469 Vali Loss: 65.596 Vali Acc: 0.481 Test Loss: 65.596 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.820638179779053
Epoch: 21, Steps: 32 | Train Loss: 0.514 Vali Loss: 73.536 Vali Acc: 0.565 Test Loss: 73.536 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.062098026275635
Epoch: 22, Steps: 32 | Train Loss: 4.570 Vali Loss: 55.911 Vali Acc: 0.473 Test Loss: 55.911 Test Acc: 0.473
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.436973810195923
Epoch: 23, Steps: 32 | Train Loss: 9.202 Vali Loss: 60.446 Vali Acc: 0.542 Test Loss: 60.446 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.178555727005005
Epoch: 24, Steps: 32 | Train Loss: 0.949 Vali Loss: 64.428 Vali Acc: 0.588 Test Loss: 64.428 Test Acc: 0.588
Validation loss decreased (-0.564204 --> -0.587142).  Saving model ...
Epoch: 25 cost time: 5.083868741989136
Epoch: 25, Steps: 32 | Train Loss: 0.850 Vali Loss: 74.289 Vali Acc: 0.603 Test Loss: 74.289 Test Acc: 0.603
Validation loss decreased (-0.587142 --> -0.602311).  Saving model ...
Epoch: 26 cost time: 4.932752847671509
Epoch: 26, Steps: 32 | Train Loss: 1.374 Vali Loss: 83.583 Vali Acc: 0.611 Test Loss: 83.583 Test Acc: 0.611
Validation loss decreased (-0.602311 --> -0.609851).  Saving model ...
Epoch: 27 cost time: 5.133123874664307
Epoch: 27, Steps: 32 | Train Loss: 1.836 Vali Loss: 77.702 Vali Acc: 0.603 Test Loss: 77.702 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.70743203163147
Epoch: 28, Steps: 32 | Train Loss: 0.424 Vali Loss: 93.727 Vali Acc: 0.527 Test Loss: 93.727 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.44996452331543
Epoch: 29, Steps: 32 | Train Loss: 7.170 Vali Loss: 193.010 Vali Acc: 0.565 Test Loss: 193.010 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.060045003890991
Epoch: 30, Steps: 32 | Train Loss: 1.641 Vali Loss: 221.184 Vali Acc: 0.305 Test Loss: 221.184 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 5.424638986587524
Epoch: 31, Steps: 32 | Train Loss: 3.398 Vali Loss: 195.004 Vali Acc: 0.573 Test Loss: 195.004 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.7243430614471436
Epoch: 32, Steps: 32 | Train Loss: 0.727 Vali Loss: 191.139 Vali Acc: 0.534 Test Loss: 191.139 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.487684965133667
Epoch: 33, Steps: 32 | Train Loss: 0.916 Vali Loss: 220.704 Vali Acc: 0.519 Test Loss: 220.704 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.063446283340454
Epoch: 34, Steps: 32 | Train Loss: 0.343 Vali Loss: 204.436 Vali Acc: 0.435 Test Loss: 204.436 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.574244737625122
Epoch: 35, Steps: 32 | Train Loss: 1.538 Vali Loss: 216.591 Vali Acc: 0.557 Test Loss: 216.591 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.375349998474121
Epoch: 36, Steps: 32 | Train Loss: 1.023 Vali Loss: 207.810 Vali Acc: 0.511 Test Loss: 207.810 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 5831341
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.768480539321899
Epoch: 1, Steps: 32 | Train Loss: 8.144 Vali Loss: 12.358 Vali Acc: 0.435 Test Loss: 12.358 Test Acc: 0.435
Validation loss decreased (inf --> -0.434991).  Saving model ...
Epoch: 2 cost time: 3.9926743507385254
Epoch: 2, Steps: 32 | Train Loss: 11.907 Vali Loss: 10.512 Vali Acc: 0.275 Test Loss: 10.512 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.171130657196045
Epoch: 3, Steps: 32 | Train Loss: 17.667 Vali Loss: 19.584 Vali Acc: 0.206 Test Loss: 19.584 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9135828018188477
Epoch: 4, Steps: 32 | Train Loss: 25.595 Vali Loss: 30.953 Vali Acc: 0.427 Test Loss: 30.953 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.1852147579193115
Epoch: 5, Steps: 32 | Train Loss: 18.417 Vali Loss: 35.495 Vali Acc: 0.183 Test Loss: 35.495 Test Acc: 0.183
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.969355344772339
Epoch: 6, Steps: 32 | Train Loss: 44.937 Vali Loss: 57.756 Vali Acc: 0.420 Test Loss: 57.756 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.406157493591309
Epoch: 7, Steps: 32 | Train Loss: 31.033 Vali Loss: 39.428 Vali Acc: 0.191 Test Loss: 39.428 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.762523412704468
Epoch: 8, Steps: 32 | Train Loss: 26.114 Vali Loss: 42.349 Vali Acc: 0.458 Test Loss: 42.349 Test Acc: 0.458
Validation loss decreased (-0.434991 --> -0.457592).  Saving model ...
Epoch: 9 cost time: 3.9689390659332275
Epoch: 9, Steps: 32 | Train Loss: 38.517 Vali Loss: 47.359 Vali Acc: 0.191 Test Loss: 47.359 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.59627890586853
Epoch: 10, Steps: 32 | Train Loss: 18.695 Vali Loss: 41.418 Vali Acc: 0.237 Test Loss: 41.418 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.331569194793701
Epoch: 11, Steps: 32 | Train Loss: 21.307 Vali Loss: 42.358 Vali Acc: 0.198 Test Loss: 42.358 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8998544216156006
Epoch: 12, Steps: 32 | Train Loss: 26.654 Vali Loss: 32.460 Vali Acc: 0.405 Test Loss: 32.460 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.06045937538147
Epoch: 13, Steps: 32 | Train Loss: 11.651 Vali Loss: 40.512 Vali Acc: 0.496 Test Loss: 40.512 Test Acc: 0.496
Validation loss decreased (-0.457592 --> -0.495778).  Saving model ...
Epoch: 14 cost time: 4.078544855117798
Epoch: 14, Steps: 32 | Train Loss: 10.926 Vali Loss: 33.156 Vali Acc: 0.519 Test Loss: 33.156 Test Acc: 0.519
Validation loss decreased (-0.495778 --> -0.518752).  Saving model ...
Epoch: 15 cost time: 4.2414398193359375
Epoch: 15, Steps: 32 | Train Loss: 5.367 Vali Loss: 45.441 Vali Acc: 0.252 Test Loss: 45.441 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.272758960723877
Epoch: 16, Steps: 32 | Train Loss: 11.854 Vali Loss: 52.814 Vali Acc: 0.443 Test Loss: 52.814 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.925381898880005
Epoch: 17, Steps: 32 | Train Loss: 8.171 Vali Loss: 40.254 Vali Acc: 0.481 Test Loss: 40.254 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.923238515853882
Epoch: 18, Steps: 32 | Train Loss: 8.486 Vali Loss: 40.651 Vali Acc: 0.466 Test Loss: 40.651 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.9057650566101074
Epoch: 19, Steps: 32 | Train Loss: 1.030 Vali Loss: 51.560 Vali Acc: 0.466 Test Loss: 51.560 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9726366996765137
Epoch: 20, Steps: 32 | Train Loss: 2.073 Vali Loss: 53.196 Vali Acc: 0.603 Test Loss: 53.196 Test Acc: 0.603
Validation loss decreased (-0.518752 --> -0.602521).  Saving model ...
Epoch: 21 cost time: 4.442099571228027
Epoch: 21, Steps: 32 | Train Loss: 2.801 Vali Loss: 51.429 Vali Acc: 0.366 Test Loss: 51.429 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.7693419456481934
Epoch: 22, Steps: 32 | Train Loss: 1.157 Vali Loss: 84.172 Vali Acc: 0.511 Test Loss: 84.172 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.892101287841797
Epoch: 23, Steps: 32 | Train Loss: 3.641 Vali Loss: 45.272 Vali Acc: 0.420 Test Loss: 45.272 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.620028018951416
Epoch: 24, Steps: 32 | Train Loss: 1.377 Vali Loss: 51.646 Vali Acc: 0.504 Test Loss: 51.646 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.688793659210205
Epoch: 25, Steps: 32 | Train Loss: 0.381 Vali Loss: 45.120 Vali Acc: 0.573 Test Loss: 45.120 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.487258195877075
Epoch: 26, Steps: 32 | Train Loss: 0.327 Vali Loss: 47.856 Vali Acc: 0.603 Test Loss: 47.856 Test Acc: 0.603
Validation loss decreased (-0.602521 --> -0.602575).  Saving model ...
Epoch: 27 cost time: 4.274835824966431
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.357 Vali Acc: 0.557 Test Loss: 56.357 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.207006454467773
Epoch: 28, Steps: 32 | Train Loss: 0.369 Vali Loss: 71.024 Vali Acc: 0.435 Test Loss: 71.024 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.858800888061523
Epoch: 29, Steps: 32 | Train Loss: 0.488 Vali Loss: 48.223 Vali Acc: 0.611 Test Loss: 48.223 Test Acc: 0.611
Validation loss decreased (-0.602575 --> -0.610205).  Saving model ...
Epoch: 30 cost time: 4.226201772689819
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 60.229 Vali Acc: 0.511 Test Loss: 60.229 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.03800892829895
Epoch: 31, Steps: 32 | Train Loss: 0.050 Vali Loss: 89.135 Vali Acc: 0.542 Test Loss: 89.135 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.344986915588379
Epoch: 32, Steps: 32 | Train Loss: 1.435 Vali Loss: 46.621 Vali Acc: 0.557 Test Loss: 46.621 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.1283652782440186
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.557 Vali Acc: 0.550 Test Loss: 53.557 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.249698638916016
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.957 Vali Acc: 0.565 Test Loss: 53.957 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.475261926651001
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.971 Vali Acc: 0.565 Test Loss: 53.971 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.789058208465576
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.972 Vali Acc: 0.565 Test Loss: 53.972 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.094423532485962
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.972 Vali Acc: 0.565 Test Loss: 53.972 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.184983015060425
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.972 Vali Acc: 0.565 Test Loss: 53.972 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.112616300582886
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.972 Vali Acc: 0.565 Test Loss: 53.972 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 5831341
model size : 26.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.939930438995361
Epoch: 1, Steps: 32 | Train Loss: 9.961 Vali Loss: 8.125 Vali Acc: 0.267 Test Loss: 8.125 Test Acc: 0.267
Validation loss decreased (inf --> -0.267094).  Saving model ...
Epoch: 2 cost time: 5.123713254928589
Epoch: 2, Steps: 32 | Train Loss: 8.315 Vali Loss: 7.495 Vali Acc: 0.267 Test Loss: 7.495 Test Acc: 0.267
Validation loss decreased (-0.267094 --> -0.267101).  Saving model ...
Epoch: 3 cost time: 5.230340480804443
Epoch: 3, Steps: 32 | Train Loss: 13.036 Vali Loss: 13.294 Vali Acc: 0.351 Test Loss: 13.294 Test Acc: 0.351
Validation loss decreased (-0.267101 --> -0.351012).  Saving model ...
Epoch: 4 cost time: 5.151729345321655
Epoch: 4, Steps: 32 | Train Loss: 11.736 Vali Loss: 23.017 Vali Acc: 0.305 Test Loss: 23.017 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.48751425743103
Epoch: 5, Steps: 32 | Train Loss: 6.365 Vali Loss: 14.780 Vali Acc: 0.473 Test Loss: 14.780 Test Acc: 0.473
Validation loss decreased (-0.351012 --> -0.473135).  Saving model ...
Epoch: 6 cost time: 5.209967374801636
Epoch: 6, Steps: 32 | Train Loss: 7.330 Vali Loss: 37.596 Vali Acc: 0.481 Test Loss: 37.596 Test Acc: 0.481
Validation loss decreased (-0.473135 --> -0.480540).  Saving model ...
Epoch: 7 cost time: 5.178136110305786
Epoch: 7, Steps: 32 | Train Loss: 11.681 Vali Loss: 54.740 Vali Acc: 0.397 Test Loss: 54.740 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.701678037643433
Epoch: 8, Steps: 32 | Train Loss: 12.711 Vali Loss: 55.287 Vali Acc: 0.427 Test Loss: 55.287 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.817551851272583
Epoch: 9, Steps: 32 | Train Loss: 13.047 Vali Loss: 62.644 Vali Acc: 0.443 Test Loss: 62.644 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.415984630584717
Epoch: 10, Steps: 32 | Train Loss: 14.164 Vali Loss: 68.902 Vali Acc: 0.290 Test Loss: 68.902 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.180007457733154
Epoch: 11, Steps: 32 | Train Loss: 11.946 Vali Loss: 63.439 Vali Acc: 0.481 Test Loss: 63.439 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.974847793579102
Epoch: 12, Steps: 32 | Train Loss: 11.545 Vali Loss: 62.679 Vali Acc: 0.473 Test Loss: 62.679 Test Acc: 0.473
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.747483253479004
Epoch: 13, Steps: 32 | Train Loss: 8.012 Vali Loss: 92.637 Vali Acc: 0.382 Test Loss: 92.637 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.614770889282227
Epoch: 14, Steps: 32 | Train Loss: 4.186 Vali Loss: 57.326 Vali Acc: 0.527 Test Loss: 57.326 Test Acc: 0.527
Validation loss decreased (-0.480540 --> -0.526144).  Saving model ...
Epoch: 15 cost time: 4.955246925354004
Epoch: 15, Steps: 32 | Train Loss: 6.915 Vali Loss: 85.518 Vali Acc: 0.511 Test Loss: 85.518 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.449756383895874
Epoch: 16, Steps: 32 | Train Loss: 7.538 Vali Loss: 107.470 Vali Acc: 0.458 Test Loss: 107.470 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.601093769073486
Epoch: 17, Steps: 32 | Train Loss: 47.302 Vali Loss: 84.822 Vali Acc: 0.542 Test Loss: 84.822 Test Acc: 0.542
Validation loss decreased (-0.526144 --> -0.541137).  Saving model ...
Epoch: 18 cost time: 4.725897550582886
Epoch: 18, Steps: 32 | Train Loss: 9.468 Vali Loss: 57.490 Vali Acc: 0.412 Test Loss: 57.490 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.556681156158447
Epoch: 19, Steps: 32 | Train Loss: 1.201 Vali Loss: 82.260 Vali Acc: 0.550 Test Loss: 82.260 Test Acc: 0.550
Validation loss decreased (-0.541137 --> -0.548796).  Saving model ...
Epoch: 20 cost time: 4.746076583862305
Epoch: 20, Steps: 32 | Train Loss: 4.763 Vali Loss: 67.136 Vali Acc: 0.588 Test Loss: 67.136 Test Acc: 0.588
Validation loss decreased (-0.548796 --> -0.587115).  Saving model ...
Epoch: 21 cost time: 4.9406657218933105
Epoch: 21, Steps: 32 | Train Loss: 1.813 Vali Loss: 70.414 Vali Acc: 0.511 Test Loss: 70.414 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.325887441635132
Epoch: 22, Steps: 32 | Train Loss: 1.087 Vali Loss: 67.725 Vali Acc: 0.618 Test Loss: 67.725 Test Acc: 0.618
Validation loss decreased (-0.587115 --> -0.617643).  Saving model ...
Epoch: 23 cost time: 4.940570116043091
Epoch: 23, Steps: 32 | Train Loss: 1.748 Vali Loss: 70.514 Vali Acc: 0.588 Test Loss: 70.514 Test Acc: 0.588
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.004155874252319
Epoch: 24, Steps: 32 | Train Loss: 1.768 Vali Loss: 98.267 Vali Acc: 0.557 Test Loss: 98.267 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.260884046554565
Epoch: 25, Steps: 32 | Train Loss: 11.591 Vali Loss: 137.374 Vali Acc: 0.534 Test Loss: 137.374 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.247528791427612
Epoch: 26, Steps: 32 | Train Loss: 19.694 Vali Loss: 70.175 Vali Acc: 0.611 Test Loss: 70.175 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.844921827316284
Epoch: 27, Steps: 32 | Train Loss: 11.282 Vali Loss: 104.245 Vali Acc: 0.382 Test Loss: 104.245 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.234849214553833
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 82.007 Vali Acc: 0.634 Test Loss: 82.007 Test Acc: 0.634
Validation loss decreased (-0.617643 --> -0.632768).  Saving model ...
Epoch: 29 cost time: 4.5329320430755615
Epoch: 29, Steps: 32 | Train Loss: 0.001 Vali Loss: 75.911 Vali Acc: 0.634 Test Loss: 75.911 Test Acc: 0.634
Validation loss decreased (-0.632768 --> -0.632829).  Saving model ...
Epoch: 30 cost time: 4.510413646697998
Epoch: 30, Steps: 32 | Train Loss: 0.591 Vali Loss: 88.499 Vali Acc: 0.550 Test Loss: 88.499 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.732292175292969
Epoch: 31, Steps: 32 | Train Loss: 0.751 Vali Loss: 90.201 Vali Acc: 0.588 Test Loss: 90.201 Test Acc: 0.588
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.638018846511841
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.152 Vali Acc: 0.550 Test Loss: 97.152 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.9195716381073
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 97.697 Vali Acc: 0.550 Test Loss: 97.697 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.459320783615112
Epoch: 34, Steps: 32 | Train Loss: 0.026 Vali Loss: 105.601 Vali Acc: 0.573 Test Loss: 105.601 Test Acc: 0.573
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.4546215534210205
Epoch: 35, Steps: 32 | Train Loss: 0.683 Vali Loss: 85.522 Vali Acc: 0.565 Test Loss: 85.522 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.973361492156982
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.620 Vali Acc: 0.573 Test Loss: 83.620 Test Acc: 0.573
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.716540336608887
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.570 Vali Acc: 0.565 Test Loss: 83.570 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.7364490032196045
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.569 Vali Acc: 0.565 Test Loss: 83.569 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.9290125370025635
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 83.569 Vali Acc: 0.565 Test Loss: 83.569 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5798573
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.944540977478027
Epoch: 1, Steps: 32 | Train Loss: 10.260 Vali Loss: 8.864 Vali Acc: 0.473 Test Loss: 8.864 Test Acc: 0.473
Validation loss decreased (inf --> -0.473194).  Saving model ...
Epoch: 2 cost time: 4.274798631668091
Epoch: 2, Steps: 32 | Train Loss: 12.072 Vali Loss: 8.049 Vali Acc: 0.489 Test Loss: 8.049 Test Acc: 0.489
Validation loss decreased (-0.473194 --> -0.488469).  Saving model ...
Epoch: 3 cost time: 4.28141450881958
Epoch: 3, Steps: 32 | Train Loss: 12.019 Vali Loss: 19.301 Vali Acc: 0.305 Test Loss: 19.301 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.101884126663208
Epoch: 4, Steps: 32 | Train Loss: 5.585 Vali Loss: 28.348 Vali Acc: 0.237 Test Loss: 28.348 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.108318328857422
Epoch: 5, Steps: 32 | Train Loss: 15.625 Vali Loss: 48.129 Vali Acc: 0.504 Test Loss: 48.129 Test Acc: 0.504
Validation loss decreased (-0.488469 --> -0.503336).  Saving model ...
Epoch: 6 cost time: 4.163492202758789
Epoch: 6, Steps: 32 | Train Loss: 23.305 Vali Loss: 46.629 Vali Acc: 0.527 Test Loss: 46.629 Test Acc: 0.527
Validation loss decreased (-0.503336 --> -0.526251).  Saving model ...
Epoch: 7 cost time: 4.1792168617248535
Epoch: 7, Steps: 32 | Train Loss: 28.717 Vali Loss: 44.926 Vali Acc: 0.366 Test Loss: 44.926 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.384338855743408
Epoch: 8, Steps: 32 | Train Loss: 16.472 Vali Loss: 36.046 Vali Acc: 0.466 Test Loss: 36.046 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.170703172683716
Epoch: 9, Steps: 32 | Train Loss: 10.914 Vali Loss: 32.982 Vali Acc: 0.359 Test Loss: 32.982 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.416424989700317
Epoch: 10, Steps: 32 | Train Loss: 6.992 Vali Loss: 31.431 Vali Acc: 0.405 Test Loss: 31.431 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.3268022537231445
Epoch: 11, Steps: 32 | Train Loss: 12.996 Vali Loss: 40.246 Vali Acc: 0.336 Test Loss: 40.246 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.5273284912109375
Epoch: 12, Steps: 32 | Train Loss: 2.370 Vali Loss: 41.298 Vali Acc: 0.450 Test Loss: 41.298 Test Acc: 0.450
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.671590328216553
Epoch: 13, Steps: 32 | Train Loss: 6.414 Vali Loss: 38.746 Vali Acc: 0.466 Test Loss: 38.746 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.803931951522827
Epoch: 14, Steps: 32 | Train Loss: 9.424 Vali Loss: 38.916 Vali Acc: 0.481 Test Loss: 38.916 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.20286226272583
Epoch: 15, Steps: 32 | Train Loss: 19.483 Vali Loss: 68.819 Vali Acc: 0.489 Test Loss: 68.819 Test Acc: 0.489
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.561838626861572
Epoch: 16, Steps: 32 | Train Loss: 7.389 Vali Loss: 40.753 Vali Acc: 0.496 Test Loss: 40.753 Test Acc: 0.496
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5267175572519084
model parameter : 5798573
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.982825040817261
Epoch: 1, Steps: 32 | Train Loss: 9.268 Vali Loss: 5.163 Vali Acc: 0.237 Test Loss: 5.163 Test Acc: 0.237
Validation loss decreased (inf --> -0.236590).  Saving model ...
Epoch: 2 cost time: 4.0283591747283936
Epoch: 2, Steps: 32 | Train Loss: 9.137 Vali Loss: 17.963 Vali Acc: 0.252 Test Loss: 17.963 Test Acc: 0.252
Validation loss decreased (-0.236590 --> -0.251729).  Saving model ...
Epoch: 3 cost time: 4.198832988739014
Epoch: 3, Steps: 32 | Train Loss: 8.079 Vali Loss: 25.760 Vali Acc: 0.435 Test Loss: 25.760 Test Acc: 0.435
Validation loss decreased (-0.251729 --> -0.434857).  Saving model ...
Epoch: 4 cost time: 4.275752782821655
Epoch: 4, Steps: 32 | Train Loss: 15.951 Vali Loss: 32.898 Vali Acc: 0.260 Test Loss: 32.898 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.923799276351929
Epoch: 5, Steps: 32 | Train Loss: 16.073 Vali Loss: 51.723 Vali Acc: 0.183 Test Loss: 51.723 Test Acc: 0.183
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.937610626220703
Epoch: 6, Steps: 32 | Train Loss: 24.097 Vali Loss: 43.550 Vali Acc: 0.450 Test Loss: 43.550 Test Acc: 0.450
Validation loss decreased (-0.434857 --> -0.449946).  Saving model ...
Epoch: 7 cost time: 4.144780397415161
Epoch: 7, Steps: 32 | Train Loss: 13.610 Vali Loss: 15.253 Vali Acc: 0.481 Test Loss: 15.253 Test Acc: 0.481
Validation loss decreased (-0.449946 --> -0.480764).  Saving model ...
Epoch: 8 cost time: 4.441466331481934
Epoch: 8, Steps: 32 | Train Loss: 10.205 Vali Loss: 47.324 Vali Acc: 0.206 Test Loss: 47.324 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8825156688690186
Epoch: 9, Steps: 32 | Train Loss: 22.669 Vali Loss: 26.627 Vali Acc: 0.443 Test Loss: 26.627 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.090876817703247
Epoch: 10, Steps: 32 | Train Loss: 18.317 Vali Loss: 53.109 Vali Acc: 0.443 Test Loss: 53.109 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.211383581161499
Epoch: 11, Steps: 32 | Train Loss: 20.429 Vali Loss: 48.386 Vali Acc: 0.489 Test Loss: 48.386 Test Acc: 0.489
Validation loss decreased (-0.480764 --> -0.488066).  Saving model ...
Epoch: 12 cost time: 4.043586730957031
Epoch: 12, Steps: 32 | Train Loss: 14.986 Vali Loss: 61.659 Vali Acc: 0.481 Test Loss: 61.659 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.701135635375977
Epoch: 13, Steps: 32 | Train Loss: 18.126 Vali Loss: 72.843 Vali Acc: 0.450 Test Loss: 72.843 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.645770788192749
Epoch: 14, Steps: 32 | Train Loss: 10.149 Vali Loss: 50.010 Vali Acc: 0.458 Test Loss: 50.010 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.461407661437988
Epoch: 15, Steps: 32 | Train Loss: 2.100 Vali Loss: 109.003 Vali Acc: 0.328 Test Loss: 109.003 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.9248170852661133
Epoch: 16, Steps: 32 | Train Loss: 2.488 Vali Loss: 116.141 Vali Acc: 0.374 Test Loss: 116.141 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.380424737930298
Epoch: 17, Steps: 32 | Train Loss: 6.038 Vali Loss: 100.868 Vali Acc: 0.519 Test Loss: 100.868 Test Acc: 0.519
Validation loss decreased (-0.488066 --> -0.518075).  Saving model ...
Epoch: 18 cost time: 4.460341930389404
Epoch: 18, Steps: 32 | Train Loss: 8.316 Vali Loss: 99.009 Vali Acc: 0.504 Test Loss: 99.009 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.378329753875732
Epoch: 19, Steps: 32 | Train Loss: 1.253 Vali Loss: 92.257 Vali Acc: 0.496 Test Loss: 92.257 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.451679944992065
Epoch: 20, Steps: 32 | Train Loss: 2.664 Vali Loss: 99.163 Vali Acc: 0.496 Test Loss: 99.163 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.453104496002197
Epoch: 21, Steps: 32 | Train Loss: 0.994 Vali Loss: 86.642 Vali Acc: 0.588 Test Loss: 86.642 Test Acc: 0.588
Validation loss decreased (-0.518075 --> -0.586920).  Saving model ...
Epoch: 22 cost time: 4.069710731506348
Epoch: 22, Steps: 32 | Train Loss: 2.313 Vali Loss: 94.533 Vali Acc: 0.527 Test Loss: 94.533 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.47792387008667
Epoch: 23, Steps: 32 | Train Loss: 3.345 Vali Loss: 79.602 Vali Acc: 0.542 Test Loss: 79.602 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.112972974777222
Epoch: 24, Steps: 32 | Train Loss: 1.334 Vali Loss: 94.787 Vali Acc: 0.496 Test Loss: 94.787 Test Acc: 0.496
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.412619352340698
Epoch: 25, Steps: 32 | Train Loss: 2.547 Vali Loss: 94.969 Vali Acc: 0.527 Test Loss: 94.969 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.085263252258301
Epoch: 26, Steps: 32 | Train Loss: 3.583 Vali Loss: 85.015 Vali Acc: 0.580 Test Loss: 85.015 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.192482233047485
Epoch: 27, Steps: 32 | Train Loss: 0.576 Vali Loss: 88.407 Vali Acc: 0.550 Test Loss: 88.407 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.550381183624268
Epoch: 28, Steps: 32 | Train Loss: 2.961 Vali Loss: 81.060 Vali Acc: 0.603 Test Loss: 81.060 Test Acc: 0.603
Validation loss decreased (-0.586920 --> -0.602243).  Saving model ...
Epoch: 29 cost time: 4.17706561088562
Epoch: 29, Steps: 32 | Train Loss: 0.241 Vali Loss: 109.266 Vali Acc: 0.435 Test Loss: 109.266 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.668792247772217
Epoch: 30, Steps: 32 | Train Loss: 3.087 Vali Loss: 137.559 Vali Acc: 0.511 Test Loss: 137.559 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.153776407241821
Epoch: 31, Steps: 32 | Train Loss: 1.052 Vali Loss: 121.305 Vali Acc: 0.534 Test Loss: 121.305 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.61401629447937
Epoch: 32, Steps: 32 | Train Loss: 3.579 Vali Loss: 91.313 Vali Acc: 0.534 Test Loss: 91.313 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.99618124961853
Epoch: 33, Steps: 32 | Train Loss: 0.423 Vali Loss: 103.112 Vali Acc: 0.542 Test Loss: 103.112 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.6802966594696045
Epoch: 34, Steps: 32 | Train Loss: 1.036 Vali Loss: 111.921 Vali Acc: 0.534 Test Loss: 111.921 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.586598873138428
Epoch: 35, Steps: 32 | Train Loss: 0.259 Vali Loss: 132.762 Vali Acc: 0.534 Test Loss: 132.762 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.269254446029663
Epoch: 36, Steps: 32 | Train Loss: 1.198 Vali Loss: 130.110 Vali Acc: 0.519 Test Loss: 130.110 Test Acc: 0.519
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.679847955703735
Epoch: 37, Steps: 32 | Train Loss: 1.446 Vali Loss: 202.330 Vali Acc: 0.527 Test Loss: 202.330 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.249575138092041
Epoch: 38, Steps: 32 | Train Loss: 2.904 Vali Loss: 224.035 Vali Acc: 0.511 Test Loss: 224.035 Test Acc: 0.511
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 5798573
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.22904109954834
Epoch: 1, Steps: 32 | Train Loss: 9.125 Vali Loss: 7.222 Vali Acc: 0.229 Test Loss: 7.222 Test Acc: 0.229
Validation loss decreased (inf --> -0.228935).  Saving model ...
Epoch: 2 cost time: 4.076792240142822
Epoch: 2, Steps: 32 | Train Loss: 15.952 Vali Loss: 14.512 Vali Acc: 0.198 Test Loss: 14.512 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.66243052482605
Epoch: 3, Steps: 32 | Train Loss: 10.072 Vali Loss: 20.804 Vali Acc: 0.458 Test Loss: 20.804 Test Acc: 0.458
Validation loss decreased (-0.228935 --> -0.457807).  Saving model ...
Epoch: 4 cost time: 3.8897135257720947
Epoch: 4, Steps: 32 | Train Loss: 19.319 Vali Loss: 13.073 Vali Acc: 0.275 Test Loss: 13.073 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.573077440261841
Epoch: 5, Steps: 32 | Train Loss: 10.376 Vali Loss: 24.787 Vali Acc: 0.191 Test Loss: 24.787 Test Acc: 0.191
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.92112398147583
Epoch: 6, Steps: 32 | Train Loss: 15.800 Vali Loss: 36.261 Vali Acc: 0.458 Test Loss: 36.261 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.7129967212677
Epoch: 7, Steps: 32 | Train Loss: 31.848 Vali Loss: 53.385 Vali Acc: 0.160 Test Loss: 53.385 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5469179153442383
Epoch: 8, Steps: 32 | Train Loss: 34.700 Vali Loss: 49.329 Vali Acc: 0.443 Test Loss: 49.329 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.7930948734283447
Epoch: 9, Steps: 32 | Train Loss: 31.046 Vali Loss: 44.879 Vali Acc: 0.344 Test Loss: 44.879 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.78157114982605
Epoch: 10, Steps: 32 | Train Loss: 25.710 Vali Loss: 48.804 Vali Acc: 0.344 Test Loss: 48.804 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.875488758087158
Epoch: 11, Steps: 32 | Train Loss: 18.387 Vali Loss: 61.788 Vali Acc: 0.244 Test Loss: 61.788 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7176809310913086
Epoch: 12, Steps: 32 | Train Loss: 17.529 Vali Loss: 38.984 Vali Acc: 0.405 Test Loss: 38.984 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.9210455417633057
Epoch: 13, Steps: 32 | Train Loss: 11.087 Vali Loss: 40.135 Vali Acc: 0.489 Test Loss: 40.135 Test Acc: 0.489
Validation loss decreased (-0.457807 --> -0.488148).  Saving model ...
Epoch: 14 cost time: 4.303839445114136
Epoch: 14, Steps: 32 | Train Loss: 5.772 Vali Loss: 32.880 Vali Acc: 0.534 Test Loss: 32.880 Test Acc: 0.534
Validation loss decreased (-0.488148 --> -0.534022).  Saving model ...
Epoch: 15 cost time: 4.1643102169036865
Epoch: 15, Steps: 32 | Train Loss: 6.517 Vali Loss: 37.293 Vali Acc: 0.397 Test Loss: 37.293 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.535867929458618
Epoch: 16, Steps: 32 | Train Loss: 2.108 Vali Loss: 39.531 Vali Acc: 0.473 Test Loss: 39.531 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.121685743331909
Epoch: 17, Steps: 32 | Train Loss: 0.910 Vali Loss: 45.805 Vali Acc: 0.550 Test Loss: 45.805 Test Acc: 0.550
Validation loss decreased (-0.534022 --> -0.549160).  Saving model ...
Epoch: 18 cost time: 4.0119547843933105
Epoch: 18, Steps: 32 | Train Loss: 4.394 Vali Loss: 37.603 Vali Acc: 0.527 Test Loss: 37.603 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.336733818054199
Epoch: 19, Steps: 32 | Train Loss: 4.739 Vali Loss: 48.730 Vali Acc: 0.550 Test Loss: 48.730 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8754661083221436
Epoch: 20, Steps: 32 | Train Loss: 0.163 Vali Loss: 58.410 Vali Acc: 0.405 Test Loss: 58.410 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.971306324005127
Epoch: 21, Steps: 32 | Train Loss: 1.423 Vali Loss: 55.245 Vali Acc: 0.519 Test Loss: 55.245 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.480842113494873
Epoch: 22, Steps: 32 | Train Loss: 2.600 Vali Loss: 55.141 Vali Acc: 0.389 Test Loss: 55.141 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.5795738697052
Epoch: 23, Steps: 32 | Train Loss: 1.860 Vali Loss: 62.473 Vali Acc: 0.550 Test Loss: 62.473 Test Acc: 0.550
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.052875518798828
Epoch: 24, Steps: 32 | Train Loss: 0.060 Vali Loss: 56.681 Vali Acc: 0.466 Test Loss: 56.681 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8507578372955322
Epoch: 25, Steps: 32 | Train Loss: 1.033 Vali Loss: 70.585 Vali Acc: 0.427 Test Loss: 70.585 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.3715908527374268
Epoch: 26, Steps: 32 | Train Loss: 2.567 Vali Loss: 65.256 Vali Acc: 0.435 Test Loss: 65.256 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.091795206069946
Epoch: 27, Steps: 32 | Train Loss: 6.645 Vali Loss: 94.582 Vali Acc: 0.542 Test Loss: 94.582 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 5798573
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.888903856277466
Epoch: 1, Steps: 32 | Train Loss: 6.276 Vali Loss: 4.715 Vali Acc: 0.466 Test Loss: 4.715 Test Acc: 0.466
Validation loss decreased (inf --> -0.465602).  Saving model ...
Epoch: 2 cost time: 4.54003119468689
Epoch: 2, Steps: 32 | Train Loss: 11.068 Vali Loss: 14.805 Vali Acc: 0.176 Test Loss: 14.805 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.056252956390381
Epoch: 3, Steps: 32 | Train Loss: 9.473 Vali Loss: 13.325 Vali Acc: 0.511 Test Loss: 13.325 Test Acc: 0.511
Validation loss decreased (-0.465602 --> -0.511317).  Saving model ...
Epoch: 4 cost time: 5.0462188720703125
Epoch: 4, Steps: 32 | Train Loss: 8.823 Vali Loss: 31.630 Vali Acc: 0.282 Test Loss: 31.630 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.664045810699463
Epoch: 5, Steps: 32 | Train Loss: 15.280 Vali Loss: 46.712 Vali Acc: 0.115 Test Loss: 46.712 Test Acc: 0.115
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.02095365524292
Epoch: 6, Steps: 32 | Train Loss: 12.898 Vali Loss: 50.723 Vali Acc: 0.229 Test Loss: 50.723 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.918060064315796
Epoch: 7, Steps: 32 | Train Loss: 9.020 Vali Loss: 46.654 Vali Acc: 0.450 Test Loss: 46.654 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.956650733947754
Epoch: 8, Steps: 32 | Train Loss: 12.126 Vali Loss: 41.521 Vali Acc: 0.298 Test Loss: 41.521 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.8405539989471436
Epoch: 9, Steps: 32 | Train Loss: 8.318 Vali Loss: 47.942 Vali Acc: 0.458 Test Loss: 47.942 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.915067911148071
Epoch: 10, Steps: 32 | Train Loss: 13.840 Vali Loss: 47.375 Vali Acc: 0.321 Test Loss: 47.375 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.923403024673462
Epoch: 11, Steps: 32 | Train Loss: 8.882 Vali Loss: 46.320 Vali Acc: 0.351 Test Loss: 46.320 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.7102580070495605
Epoch: 12, Steps: 32 | Train Loss: 12.274 Vali Loss: 64.997 Vali Acc: 0.313 Test Loss: 64.997 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.615797281265259
Epoch: 13, Steps: 32 | Train Loss: 11.787 Vali Loss: 65.598 Vali Acc: 0.313 Test Loss: 65.598 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 5782189
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.293275594711304
Epoch: 1, Steps: 32 | Train Loss: 7.600 Vali Loss: 6.933 Vali Acc: 0.282 Test Loss: 6.933 Test Acc: 0.282
Validation loss decreased (inf --> -0.282373).  Saving model ...
Epoch: 2 cost time: 4.08595609664917
Epoch: 2, Steps: 32 | Train Loss: 12.724 Vali Loss: 23.032 Vali Acc: 0.382 Test Loss: 23.032 Test Acc: 0.382
Validation loss decreased (-0.282373 --> -0.381449).  Saving model ...
Epoch: 3 cost time: 4.052642107009888
Epoch: 3, Steps: 32 | Train Loss: 10.760 Vali Loss: 17.332 Vali Acc: 0.405 Test Loss: 17.332 Test Acc: 0.405
Validation loss decreased (-0.381449 --> -0.404407).  Saving model ...
Epoch: 4 cost time: 4.462085247039795
Epoch: 4, Steps: 32 | Train Loss: 13.069 Vali Loss: 15.365 Vali Acc: 0.504 Test Loss: 15.365 Test Acc: 0.504
Validation loss decreased (-0.404407 --> -0.503663).  Saving model ...
Epoch: 5 cost time: 4.6224000453948975
Epoch: 5, Steps: 32 | Train Loss: 17.633 Vali Loss: 49.069 Vali Acc: 0.389 Test Loss: 49.069 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.693212270736694
Epoch: 6, Steps: 32 | Train Loss: 14.617 Vali Loss: 30.639 Vali Acc: 0.504 Test Loss: 30.639 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.512630939483643
Epoch: 7, Steps: 32 | Train Loss: 13.471 Vali Loss: 28.885 Vali Acc: 0.435 Test Loss: 28.885 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.767759323120117
Epoch: 8, Steps: 32 | Train Loss: 23.375 Vali Loss: 56.625 Vali Acc: 0.321 Test Loss: 56.625 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.152867078781128
Epoch: 9, Steps: 32 | Train Loss: 21.281 Vali Loss: 76.288 Vali Acc: 0.298 Test Loss: 76.288 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.6133153438568115
Epoch: 10, Steps: 32 | Train Loss: 23.310 Vali Loss: 39.664 Vali Acc: 0.382 Test Loss: 39.664 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.249815225601196
Epoch: 11, Steps: 32 | Train Loss: 9.509 Vali Loss: 37.748 Vali Acc: 0.397 Test Loss: 37.748 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 4.696521997451782
Epoch: 12, Steps: 32 | Train Loss: 9.240 Vali Loss: 44.176 Vali Acc: 0.336 Test Loss: 44.176 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.141857862472534
Epoch: 13, Steps: 32 | Train Loss: 5.335 Vali Loss: 37.252 Vali Acc: 0.458 Test Loss: 37.252 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 4.4086754322052
Epoch: 14, Steps: 32 | Train Loss: 8.948 Vali Loss: 30.156 Vali Acc: 0.534 Test Loss: 30.156 Test Acc: 0.534
Validation loss decreased (-0.503663 --> -0.534050).  Saving model ...
Epoch: 15 cost time: 4.378106594085693
Epoch: 15, Steps: 32 | Train Loss: 0.749 Vali Loss: 37.947 Vali Acc: 0.542 Test Loss: 37.947 Test Acc: 0.542
Validation loss decreased (-0.534050 --> -0.541605).  Saving model ...
Epoch: 16 cost time: 4.564011573791504
Epoch: 16, Steps: 32 | Train Loss: 2.252 Vali Loss: 52.327 Vali Acc: 0.481 Test Loss: 52.327 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.394812107086182
Epoch: 17, Steps: 32 | Train Loss: 6.843 Vali Loss: 65.260 Vali Acc: 0.511 Test Loss: 65.260 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.517258167266846
Epoch: 18, Steps: 32 | Train Loss: 14.240 Vali Loss: 43.242 Vali Acc: 0.550 Test Loss: 43.242 Test Acc: 0.550
Validation loss decreased (-0.541605 --> -0.549186).  Saving model ...
Epoch: 19 cost time: 5.081124544143677
Epoch: 19, Steps: 32 | Train Loss: 0.847 Vali Loss: 50.312 Vali Acc: 0.473 Test Loss: 50.312 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.488920211791992
Epoch: 20, Steps: 32 | Train Loss: 4.459 Vali Loss: 67.089 Vali Acc: 0.550 Test Loss: 67.089 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.5428526401519775
Epoch: 21, Steps: 32 | Train Loss: 17.690 Vali Loss: 78.917 Vali Acc: 0.527 Test Loss: 78.917 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.116677522659302
Epoch: 22, Steps: 32 | Train Loss: 21.151 Vali Loss: 100.112 Vali Acc: 0.382 Test Loss: 100.112 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.004467725753784
Epoch: 23, Steps: 32 | Train Loss: 2.960 Vali Loss: 90.213 Vali Acc: 0.504 Test Loss: 90.213 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.335836887359619
Epoch: 24, Steps: 32 | Train Loss: 3.678 Vali Loss: 60.137 Vali Acc: 0.557 Test Loss: 60.137 Test Acc: 0.557
Validation loss decreased (-0.549186 --> -0.556651).  Saving model ...
Epoch: 25 cost time: 4.9614098072052
Epoch: 25, Steps: 32 | Train Loss: 0.860 Vali Loss: 66.254 Vali Acc: 0.527 Test Loss: 66.254 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.474645137786865
Epoch: 26, Steps: 32 | Train Loss: 2.735 Vali Loss: 76.055 Vali Acc: 0.542 Test Loss: 76.055 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.30236029624939
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 75.560 Vali Acc: 0.550 Test Loss: 75.560 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.95626974105835
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.326 Vali Acc: 0.573 Test Loss: 79.326 Test Acc: 0.573
Validation loss decreased (-0.556651 --> -0.571726).  Saving model ...
Epoch: 29 cost time: 4.873977899551392
Epoch: 29, Steps: 32 | Train Loss: 0.141 Vali Loss: 71.288 Vali Acc: 0.565 Test Loss: 71.288 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.139892339706421
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 78.810 Vali Acc: 0.565 Test Loss: 78.810 Test Acc: 0.565
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.4778852462768555
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.078 Vali Acc: 0.565 Test Loss: 79.078 Test Acc: 0.565
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.582794189453125
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.422811031341553
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.0553879737854
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.717458486557007
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.495101690292358
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.351194381713867
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.10534143447876
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 79.088 Vali Acc: 0.565 Test Loss: 79.088 Test Acc: 0.565
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 5782189
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.973796844482422
Epoch: 1, Steps: 32 | Train Loss: 7.057 Vali Loss: 10.946 Vali Acc: 0.427 Test Loss: 10.946 Test Acc: 0.427
Validation loss decreased (inf --> -0.427371).  Saving model ...
Epoch: 2 cost time: 4.129358291625977
Epoch: 2, Steps: 32 | Train Loss: 10.522 Vali Loss: 21.800 Vali Acc: 0.489 Test Loss: 21.800 Test Acc: 0.489
Validation loss decreased (-0.427371 --> -0.488332).  Saving model ...
Epoch: 3 cost time: 4.015429258346558
Epoch: 3, Steps: 32 | Train Loss: 11.384 Vali Loss: 21.948 Vali Acc: 0.382 Test Loss: 21.948 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.095907688140869
Epoch: 4, Steps: 32 | Train Loss: 14.381 Vali Loss: 42.919 Vali Acc: 0.214 Test Loss: 42.919 Test Acc: 0.214
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.435096502304077
Epoch: 5, Steps: 32 | Train Loss: 23.982 Vali Loss: 34.988 Vali Acc: 0.466 Test Loss: 34.988 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.419025421142578
Epoch: 6, Steps: 32 | Train Loss: 17.727 Vali Loss: 30.519 Vali Acc: 0.466 Test Loss: 30.519 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.088130950927734
Epoch: 7, Steps: 32 | Train Loss: 8.847 Vali Loss: 20.057 Vali Acc: 0.504 Test Loss: 20.057 Test Acc: 0.504
Validation loss decreased (-0.488332 --> -0.503616).  Saving model ...
Epoch: 8 cost time: 4.598640203475952
Epoch: 8, Steps: 32 | Train Loss: 12.384 Vali Loss: 38.185 Vali Acc: 0.298 Test Loss: 38.185 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.62298583984375
Epoch: 9, Steps: 32 | Train Loss: 12.100 Vali Loss: 29.285 Vali Acc: 0.511 Test Loss: 29.285 Test Acc: 0.511
Validation loss decreased (-0.503616 --> -0.511158).  Saving model ...
Epoch: 10 cost time: 4.437218427658081
Epoch: 10, Steps: 32 | Train Loss: 17.271 Vali Loss: 47.649 Vali Acc: 0.427 Test Loss: 47.649 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.287752628326416
Epoch: 11, Steps: 32 | Train Loss: 19.967 Vali Loss: 44.378 Vali Acc: 0.267 Test Loss: 44.378 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.177664279937744
Epoch: 12, Steps: 32 | Train Loss: 17.074 Vali Loss: 32.359 Vali Acc: 0.489 Test Loss: 32.359 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.306589603424072
Epoch: 13, Steps: 32 | Train Loss: 15.678 Vali Loss: 40.305 Vali Acc: 0.450 Test Loss: 40.305 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.0749499797821045
Epoch: 14, Steps: 32 | Train Loss: 11.894 Vali Loss: 89.194 Vali Acc: 0.489 Test Loss: 89.194 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.978116035461426
Epoch: 15, Steps: 32 | Train Loss: 14.028 Vali Loss: 75.704 Vali Acc: 0.534 Test Loss: 75.704 Test Acc: 0.534
Validation loss decreased (-0.511158 --> -0.533594).  Saving model ...
Epoch: 16 cost time: 4.520029783248901
Epoch: 16, Steps: 32 | Train Loss: 2.793 Vali Loss: 108.640 Vali Acc: 0.550 Test Loss: 108.640 Test Acc: 0.550
Validation loss decreased (-0.533594 --> -0.548532).  Saving model ...
Epoch: 17 cost time: 3.867626428604126
Epoch: 17, Steps: 32 | Train Loss: 10.415 Vali Loss: 125.758 Vali Acc: 0.275 Test Loss: 125.758 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.215112924575806
Epoch: 18, Steps: 32 | Train Loss: 5.983 Vali Loss: 116.479 Vali Acc: 0.489 Test Loss: 116.479 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.104286432266235
Epoch: 19, Steps: 32 | Train Loss: 10.200 Vali Loss: 120.835 Vali Acc: 0.450 Test Loss: 120.835 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.476914167404175
Epoch: 20, Steps: 32 | Train Loss: 7.944 Vali Loss: 135.883 Vali Acc: 0.344 Test Loss: 135.883 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.035372734069824
Epoch: 21, Steps: 32 | Train Loss: 1.685 Vali Loss: 102.913 Vali Acc: 0.565 Test Loss: 102.913 Test Acc: 0.565
Validation loss decreased (-0.548532 --> -0.563856).  Saving model ...
Epoch: 22 cost time: 3.8474037647247314
Epoch: 22, Steps: 32 | Train Loss: 0.049 Vali Loss: 112.143 Vali Acc: 0.534 Test Loss: 112.143 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.978559732437134
Epoch: 23, Steps: 32 | Train Loss: 0.487 Vali Loss: 87.865 Vali Acc: 0.519 Test Loss: 87.865 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.598483324050903
Epoch: 24, Steps: 32 | Train Loss: 0.347 Vali Loss: 86.701 Vali Acc: 0.573 Test Loss: 86.701 Test Acc: 0.573
Validation loss decreased (-0.563856 --> -0.571652).  Saving model ...
Epoch: 25 cost time: 4.106280565261841
Epoch: 25, Steps: 32 | Train Loss: 0.125 Vali Loss: 129.206 Vali Acc: 0.527 Test Loss: 129.206 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.7843055725097656
Epoch: 26, Steps: 32 | Train Loss: 0.043 Vali Loss: 84.468 Vali Acc: 0.534 Test Loss: 84.468 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.189143419265747
Epoch: 27, Steps: 32 | Train Loss: 5.047 Vali Loss: 138.308 Vali Acc: 0.313 Test Loss: 138.308 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.184506893157959
Epoch: 28, Steps: 32 | Train Loss: 5.244 Vali Loss: 110.962 Vali Acc: 0.550 Test Loss: 110.962 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.283503770828247
Epoch: 29, Steps: 32 | Train Loss: 1.860 Vali Loss: 105.188 Vali Acc: 0.511 Test Loss: 105.188 Test Acc: 0.511
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6129660606384277
Epoch: 30, Steps: 32 | Train Loss: 3.000 Vali Loss: 85.305 Vali Acc: 0.527 Test Loss: 85.305 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.579380512237549
Epoch: 31, Steps: 32 | Train Loss: 2.570 Vali Loss: 57.606 Vali Acc: 0.550 Test Loss: 57.606 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.992894172668457
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 67.629 Vali Acc: 0.573 Test Loss: 67.629 Test Acc: 0.573
Validation loss decreased (-0.571652 --> -0.571843).  Saving model ...
Epoch: 33 cost time: 3.9257349967956543
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 68.291 Vali Acc: 0.595 Test Loss: 68.291 Test Acc: 0.595
Validation loss decreased (-0.571843 --> -0.594737).  Saving model ...
Epoch: 34 cost time: 4.422405958175659
Epoch: 34, Steps: 32 | Train Loss: 0.001 Vali Loss: 67.737 Vali Acc: 0.458 Test Loss: 67.737 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.137695789337158
Epoch: 35, Steps: 32 | Train Loss: 0.238 Vali Loss: 128.688 Vali Acc: 0.489 Test Loss: 128.688 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.786168098449707
Epoch: 36, Steps: 32 | Train Loss: 0.645 Vali Loss: 139.554 Vali Acc: 0.481 Test Loss: 139.554 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.500431060791016
Epoch: 37, Steps: 32 | Train Loss: 5.249 Vali Loss: 87.916 Vali Acc: 0.534 Test Loss: 87.916 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.381676435470581
Epoch: 38, Steps: 32 | Train Loss: 2.903 Vali Loss: 145.542 Vali Acc: 0.435 Test Loss: 145.542 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 4.2346031665802
Epoch: 39, Steps: 32 | Train Loss: 4.740 Vali Loss: 117.839 Vali Acc: 0.344 Test Loss: 117.839 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.629115104675293
Epoch: 40, Steps: 32 | Train Loss: 4.345 Vali Loss: 212.812 Vali Acc: 0.489 Test Loss: 212.812 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.113127708435059
Epoch: 41, Steps: 32 | Train Loss: 2.590 Vali Loss: 132.049 Vali Acc: 0.595 Test Loss: 132.049 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.387900352478027
Epoch: 42, Steps: 32 | Train Loss: 7.049 Vali Loss: 195.228 Vali Acc: 0.519 Test Loss: 195.228 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.6302502155303955
Epoch: 43, Steps: 32 | Train Loss: 4.265 Vali Loss: 195.565 Vali Acc: 0.336 Test Loss: 195.565 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5954198473282443
model parameter : 5782189
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.499596118927002
Epoch: 1, Steps: 32 | Train Loss: 7.442 Vali Loss: 10.285 Vali Acc: 0.420 Test Loss: 10.285 Test Acc: 0.420
Validation loss decreased (inf --> -0.419744).  Saving model ...
Epoch: 2 cost time: 3.623589038848877
Epoch: 2, Steps: 32 | Train Loss: 12.003 Vali Loss: 38.276 Vali Acc: 0.130 Test Loss: 38.276 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.165102958679199
Epoch: 3, Steps: 32 | Train Loss: 25.174 Vali Loss: 31.898 Vali Acc: 0.328 Test Loss: 31.898 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.649818181991577
Epoch: 4, Steps: 32 | Train Loss: 19.142 Vali Loss: 19.876 Vali Acc: 0.252 Test Loss: 19.876 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.566685199737549
Epoch: 5, Steps: 32 | Train Loss: 14.654 Vali Loss: 15.933 Vali Acc: 0.229 Test Loss: 15.933 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.7007014751434326
Epoch: 6, Steps: 32 | Train Loss: 27.432 Vali Loss: 55.451 Vali Acc: 0.198 Test Loss: 55.451 Test Acc: 0.198
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.5448832511901855
Epoch: 7, Steps: 32 | Train Loss: 33.286 Vali Loss: 64.410 Vali Acc: 0.267 Test Loss: 64.410 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.583082675933838
Epoch: 8, Steps: 32 | Train Loss: 26.135 Vali Loss: 52.413 Vali Acc: 0.183 Test Loss: 52.413 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.7328453063964844
Epoch: 9, Steps: 32 | Train Loss: 22.299 Vali Loss: 75.664 Vali Acc: 0.214 Test Loss: 75.664 Test Acc: 0.214
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.5737478733062744
Epoch: 10, Steps: 32 | Train Loss: 41.729 Vali Loss: 49.783 Vali Acc: 0.290 Test Loss: 49.783 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.6934258937835693
Epoch: 11, Steps: 32 | Train Loss: 18.332 Vali Loss: 52.591 Vali Acc: 0.344 Test Loss: 52.591 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4198473282442748
model parameter : 5782189
model size : 26.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.175107717514038
Epoch: 1, Steps: 32 | Train Loss: 9.989 Vali Loss: 6.342 Vali Acc: 0.489 Test Loss: 6.342 Test Acc: 0.489
Validation loss decreased (inf --> -0.488486).  Saving model ...
Epoch: 2 cost time: 4.580737829208374
Epoch: 2, Steps: 32 | Train Loss: 8.251 Vali Loss: 8.584 Vali Acc: 0.336 Test Loss: 8.584 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.745686292648315
Epoch: 3, Steps: 32 | Train Loss: 7.747 Vali Loss: 11.746 Vali Acc: 0.427 Test Loss: 11.746 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.679491758346558
Epoch: 4, Steps: 32 | Train Loss: 14.066 Vali Loss: 17.442 Vali Acc: 0.473 Test Loss: 17.442 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.503488779067993
Epoch: 5, Steps: 32 | Train Loss: 18.268 Vali Loss: 35.073 Vali Acc: 0.489 Test Loss: 35.073 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.831361532211304
Epoch: 6, Steps: 32 | Train Loss: 11.257 Vali Loss: 34.473 Vali Acc: 0.496 Test Loss: 34.473 Test Acc: 0.496
Validation loss decreased (-0.488486 --> -0.495838).  Saving model ...
Epoch: 7 cost time: 4.783593416213989
Epoch: 7, Steps: 32 | Train Loss: 16.931 Vali Loss: 35.368 Vali Acc: 0.527 Test Loss: 35.368 Test Acc: 0.527
Validation loss decreased (-0.495838 --> -0.526364).  Saving model ...
Epoch: 8 cost time: 4.14484977722168
Epoch: 8, Steps: 32 | Train Loss: 3.732 Vali Loss: 72.493 Vali Acc: 0.466 Test Loss: 72.493 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8217833042144775
Epoch: 9, Steps: 32 | Train Loss: 13.549 Vali Loss: 70.321 Vali Acc: 0.221 Test Loss: 70.321 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.870026350021362
Epoch: 10, Steps: 32 | Train Loss: 9.136 Vali Loss: 55.517 Vali Acc: 0.435 Test Loss: 55.517 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.468079090118408
Epoch: 11, Steps: 32 | Train Loss: 12.994 Vali Loss: 48.495 Vali Acc: 0.527 Test Loss: 48.495 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.500278949737549
Epoch: 12, Steps: 32 | Train Loss: 8.902 Vali Loss: 47.750 Vali Acc: 0.534 Test Loss: 47.750 Test Acc: 0.534
Validation loss decreased (-0.526364 --> -0.533874).  Saving model ...
Epoch: 13 cost time: 4.8075549602508545
Epoch: 13, Steps: 32 | Train Loss: 2.517 Vali Loss: 36.238 Vali Acc: 0.534 Test Loss: 36.238 Test Acc: 0.534
Validation loss decreased (-0.533874 --> -0.533989).  Saving model ...
Epoch: 14 cost time: 4.678763151168823
Epoch: 14, Steps: 32 | Train Loss: 4.487 Vali Loss: 66.550 Vali Acc: 0.359 Test Loss: 66.550 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.55474591255188
Epoch: 15, Steps: 32 | Train Loss: 9.154 Vali Loss: 59.501 Vali Acc: 0.366 Test Loss: 59.501 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.350614786148071
Epoch: 16, Steps: 32 | Train Loss: 7.686 Vali Loss: 62.266 Vali Acc: 0.511 Test Loss: 62.266 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.845006942749023
Epoch: 17, Steps: 32 | Train Loss: 6.389 Vali Loss: 49.819 Vali Acc: 0.527 Test Loss: 49.819 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.8702569007873535
Epoch: 18, Steps: 32 | Train Loss: 12.352 Vali Loss: 68.814 Vali Acc: 0.458 Test Loss: 68.814 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.229127407073975
Epoch: 19, Steps: 32 | Train Loss: 5.162 Vali Loss: 56.976 Vali Acc: 0.519 Test Loss: 56.976 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.816483974456787
Epoch: 20, Steps: 32 | Train Loss: 1.993 Vali Loss: 86.395 Vali Acc: 0.473 Test Loss: 86.395 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.861255168914795
Epoch: 21, Steps: 32 | Train Loss: 7.200 Vali Loss: 70.390 Vali Acc: 0.489 Test Loss: 70.390 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.369359731674194
Epoch: 22, Steps: 32 | Train Loss: 1.942 Vali Loss: 53.159 Vali Acc: 0.611 Test Loss: 53.159 Test Acc: 0.611
Validation loss decreased (-0.533989 --> -0.610155).  Saving model ...
Epoch: 23 cost time: 4.486415386199951
Epoch: 23, Steps: 32 | Train Loss: 1.994 Vali Loss: 75.772 Vali Acc: 0.557 Test Loss: 75.772 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.475876092910767
Epoch: 24, Steps: 32 | Train Loss: 4.139 Vali Loss: 106.808 Vali Acc: 0.282 Test Loss: 106.808 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.346595764160156
Epoch: 25, Steps: 32 | Train Loss: 7.965 Vali Loss: 85.936 Vali Acc: 0.534 Test Loss: 85.936 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.297131061553955
Epoch: 26, Steps: 32 | Train Loss: 4.005 Vali Loss: 67.295 Vali Acc: 0.634 Test Loss: 67.295 Test Acc: 0.634
Validation loss decreased (-0.610155 --> -0.632915).  Saving model ...
Epoch: 27 cost time: 4.433072805404663
Epoch: 27, Steps: 32 | Train Loss: 0.829 Vali Loss: 68.668 Vali Acc: 0.573 Test Loss: 68.668 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.315934419631958
Epoch: 28, Steps: 32 | Train Loss: 0.316 Vali Loss: 79.150 Vali Acc: 0.618 Test Loss: 79.150 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.799022197723389
Epoch: 29, Steps: 32 | Train Loss: 0.062 Vali Loss: 79.336 Vali Acc: 0.527 Test Loss: 79.336 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.357922554016113
Epoch: 30, Steps: 32 | Train Loss: 2.234 Vali Loss: 90.905 Vali Acc: 0.603 Test Loss: 90.905 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.78167724609375
Epoch: 31, Steps: 32 | Train Loss: 3.385 Vali Loss: 80.729 Vali Acc: 0.656 Test Loss: 80.729 Test Acc: 0.656
Validation loss decreased (-0.632915 --> -0.655681).  Saving model ...
Epoch: 32 cost time: 4.17842698097229
Epoch: 32, Steps: 32 | Train Loss: 1.367 Vali Loss: 109.287 Vali Acc: 0.550 Test Loss: 109.287 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.488513946533203
Epoch: 33, Steps: 32 | Train Loss: 0.760 Vali Loss: 114.600 Vali Acc: 0.519 Test Loss: 114.600 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.504713535308838
Epoch: 34, Steps: 32 | Train Loss: 7.115 Vali Loss: 130.082 Vali Acc: 0.557 Test Loss: 130.082 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.6659626960754395
Epoch: 35, Steps: 32 | Train Loss: 6.452 Vali Loss: 104.186 Vali Acc: 0.588 Test Loss: 104.186 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.449068784713745
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 93.953 Vali Acc: 0.580 Test Loss: 93.953 Test Acc: 0.580
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.14924168586731
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.058 Vali Acc: 0.580 Test Loss: 94.058 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.542038202285767
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.061 Vali Acc: 0.580 Test Loss: 94.061 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 4.563629388809204
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.061 Vali Acc: 0.580 Test Loss: 94.061 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 4.994570016860962
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.061 Vali Acc: 0.580 Test Loss: 94.061 Test Acc: 0.580
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.842066526412964
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 94.061 Vali Acc: 0.580 Test Loss: 94.061 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6564885496183206
model parameter : 5773997
model size : 26.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.640184640884399
Epoch: 1, Steps: 32 | Train Loss: 9.502 Vali Loss: 6.403 Vali Acc: 0.450 Test Loss: 6.403 Test Acc: 0.450
Validation loss decreased (inf --> -0.450318).  Saving model ...
Epoch: 2 cost time: 4.615695238113403
Epoch: 2, Steps: 32 | Train Loss: 6.943 Vali Loss: 14.415 Vali Acc: 0.466 Test Loss: 14.415 Test Acc: 0.466
Validation loss decreased (-0.450318 --> -0.465505).  Saving model ...
Epoch: 3 cost time: 4.484750032424927
Epoch: 3, Steps: 32 | Train Loss: 10.405 Vali Loss: 15.943 Vali Acc: 0.466 Test Loss: 15.943 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.088116884231567
Epoch: 4, Steps: 32 | Train Loss: 9.299 Vali Loss: 46.189 Vali Acc: 0.290 Test Loss: 46.189 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.407327175140381
Epoch: 5, Steps: 32 | Train Loss: 11.560 Vali Loss: 37.029 Vali Acc: 0.458 Test Loss: 37.029 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.424053192138672
Epoch: 6, Steps: 32 | Train Loss: 12.497 Vali Loss: 45.076 Vali Acc: 0.534 Test Loss: 45.076 Test Acc: 0.534
Validation loss decreased (-0.465505 --> -0.533900).  Saving model ...
Epoch: 7 cost time: 4.264595985412598
Epoch: 7, Steps: 32 | Train Loss: 11.426 Vali Loss: 32.456 Vali Acc: 0.328 Test Loss: 32.456 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.100800037384033
Epoch: 8, Steps: 32 | Train Loss: 6.953 Vali Loss: 37.023 Vali Acc: 0.489 Test Loss: 37.023 Test Acc: 0.489
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8885040283203125
Epoch: 9, Steps: 32 | Train Loss: 9.668 Vali Loss: 47.440 Vali Acc: 0.397 Test Loss: 47.440 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.380695104598999
Epoch: 10, Steps: 32 | Train Loss: 6.386 Vali Loss: 31.279 Vali Acc: 0.504 Test Loss: 31.279 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.1046600341796875
Epoch: 11, Steps: 32 | Train Loss: 9.484 Vali Loss: 41.578 Vali Acc: 0.420 Test Loss: 41.578 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.9984359741210938
Epoch: 12, Steps: 32 | Train Loss: 21.987 Vali Loss: 45.396 Vali Acc: 0.504 Test Loss: 45.396 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.032226085662842
Epoch: 13, Steps: 32 | Train Loss: 5.040 Vali Loss: 42.240 Vali Acc: 0.550 Test Loss: 42.240 Test Acc: 0.550
Validation loss decreased (-0.533900 --> -0.549196).  Saving model ...
Epoch: 14 cost time: 3.9544320106506348
Epoch: 14, Steps: 32 | Train Loss: 19.632 Vali Loss: 50.895 Vali Acc: 0.504 Test Loss: 50.895 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.4023590087890625
Epoch: 15, Steps: 32 | Train Loss: 7.387 Vali Loss: 41.260 Vali Acc: 0.511 Test Loss: 41.260 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.046616077423096
Epoch: 16, Steps: 32 | Train Loss: 2.424 Vali Loss: 52.778 Vali Acc: 0.504 Test Loss: 52.778 Test Acc: 0.504
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.63879656791687
Epoch: 17, Steps: 32 | Train Loss: 2.834 Vali Loss: 44.158 Vali Acc: 0.557 Test Loss: 44.158 Test Acc: 0.557
Validation loss decreased (-0.549196 --> -0.556810).  Saving model ...
Epoch: 18 cost time: 4.039556264877319
Epoch: 18, Steps: 32 | Train Loss: 5.348 Vali Loss: 65.649 Vali Acc: 0.534 Test Loss: 65.649 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.558824777603149
Epoch: 19, Steps: 32 | Train Loss: 16.668 Vali Loss: 54.577 Vali Acc: 0.527 Test Loss: 54.577 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.565469264984131
Epoch: 20, Steps: 32 | Train Loss: 4.589 Vali Loss: 60.138 Vali Acc: 0.534 Test Loss: 60.138 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.249074220657349
Epoch: 21, Steps: 32 | Train Loss: 1.806 Vali Loss: 65.468 Vali Acc: 0.466 Test Loss: 65.468 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.096157789230347
Epoch: 22, Steps: 32 | Train Loss: 2.819 Vali Loss: 58.629 Vali Acc: 0.557 Test Loss: 58.629 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.5200207233428955
Epoch: 23, Steps: 32 | Train Loss: 1.002 Vali Loss: 81.723 Vali Acc: 0.443 Test Loss: 81.723 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.2873852252960205
Epoch: 24, Steps: 32 | Train Loss: 1.060 Vali Loss: 68.176 Vali Acc: 0.626 Test Loss: 68.176 Test Acc: 0.626
Validation loss decreased (-0.556810 --> -0.625272).  Saving model ...
Epoch: 25 cost time: 4.269172668457031
Epoch: 25, Steps: 32 | Train Loss: 2.611 Vali Loss: 66.016 Vali Acc: 0.580 Test Loss: 66.016 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.004149913787842
Epoch: 26, Steps: 32 | Train Loss: 1.435 Vali Loss: 48.238 Vali Acc: 0.611 Test Loss: 48.238 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.050877332687378
Epoch: 27, Steps: 32 | Train Loss: 2.874 Vali Loss: 65.375 Vali Acc: 0.557 Test Loss: 65.375 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.56601619720459
Epoch: 28, Steps: 32 | Train Loss: 0.372 Vali Loss: 75.434 Vali Acc: 0.550 Test Loss: 75.434 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.51789116859436
Epoch: 29, Steps: 32 | Train Loss: 1.111 Vali Loss: 109.226 Vali Acc: 0.519 Test Loss: 109.226 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.204665422439575
Epoch: 30, Steps: 32 | Train Loss: 6.299 Vali Loss: 127.447 Vali Acc: 0.534 Test Loss: 127.447 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.871053695678711
Epoch: 31, Steps: 32 | Train Loss: 1.474 Vali Loss: 114.389 Vali Acc: 0.550 Test Loss: 114.389 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.339832067489624
Epoch: 32, Steps: 32 | Train Loss: 4.668 Vali Loss: 80.293 Vali Acc: 0.618 Test Loss: 80.293 Test Acc: 0.618
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.658639669418335
Epoch: 33, Steps: 32 | Train Loss: 0.984 Vali Loss: 81.565 Vali Acc: 0.611 Test Loss: 81.565 Test Acc: 0.611
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.185624122619629
Epoch: 34, Steps: 32 | Train Loss: 1.473 Vali Loss: 66.575 Vali Acc: 0.634 Test Loss: 66.575 Test Acc: 0.634
Validation loss decreased (-0.625272 --> -0.632922).  Saving model ...
Epoch: 35 cost time: 4.724499940872192
Epoch: 35, Steps: 32 | Train Loss: 0.364 Vali Loss: 133.996 Vali Acc: 0.550 Test Loss: 133.996 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.154252052307129
Epoch: 36, Steps: 32 | Train Loss: 0.534 Vali Loss: 86.008 Vali Acc: 0.603 Test Loss: 86.008 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.350602626800537
Epoch: 37, Steps: 32 | Train Loss: 1.555 Vali Loss: 108.669 Vali Acc: 0.366 Test Loss: 108.669 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.869949817657471
Epoch: 38, Steps: 32 | Train Loss: 0.210 Vali Loss: 104.857 Vali Acc: 0.412 Test Loss: 104.857 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.136622667312622
Epoch: 39, Steps: 32 | Train Loss: 1.372 Vali Loss: 108.338 Vali Acc: 0.557 Test Loss: 108.338 Test Acc: 0.557
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.317107439041138
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 113.475 Vali Acc: 0.580 Test Loss: 113.475 Test Acc: 0.580
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.170217752456665
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 114.024 Vali Acc: 0.580 Test Loss: 114.024 Test Acc: 0.580
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.537222146987915
Epoch: 42, Steps: 32 | Train Loss: 0.002 Vali Loss: 100.169 Vali Acc: 0.611 Test Loss: 100.169 Test Acc: 0.611
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.9543302059173584
Epoch: 43, Steps: 32 | Train Loss: 0.412 Vali Loss: 127.674 Vali Acc: 0.534 Test Loss: 127.674 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.049043416976929
Epoch: 44, Steps: 32 | Train Loss: 0.066 Vali Loss: 109.288 Vali Acc: 0.595 Test Loss: 109.288 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5773997
model size : 26.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.943147897720337
Epoch: 1, Steps: 32 | Train Loss: 8.274 Vali Loss: 13.622 Vali Acc: 0.206 Test Loss: 13.622 Test Acc: 0.206
Validation loss decreased (inf --> -0.205971).  Saving model ...
Epoch: 2 cost time: 3.7715373039245605
Epoch: 2, Steps: 32 | Train Loss: 9.150 Vali Loss: 19.870 Vali Acc: 0.191 Test Loss: 19.870 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.398621082305908
Epoch: 3, Steps: 32 | Train Loss: 12.683 Vali Loss: 15.396 Vali Acc: 0.481 Test Loss: 15.396 Test Acc: 0.481
Validation loss decreased (-0.205971 --> -0.480762).  Saving model ...
Epoch: 4 cost time: 3.823183298110962
Epoch: 4, Steps: 32 | Train Loss: 13.581 Vali Loss: 20.844 Vali Acc: 0.473 Test Loss: 20.844 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8764164447784424
Epoch: 5, Steps: 32 | Train Loss: 15.823 Vali Loss: 34.059 Vali Acc: 0.252 Test Loss: 34.059 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9210240840911865
Epoch: 6, Steps: 32 | Train Loss: 23.426 Vali Loss: 42.084 Vali Acc: 0.473 Test Loss: 42.084 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6247987747192383
Epoch: 7, Steps: 32 | Train Loss: 17.724 Vali Loss: 57.128 Vali Acc: 0.328 Test Loss: 57.128 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.570034742355347
Epoch: 8, Steps: 32 | Train Loss: 16.294 Vali Loss: 25.269 Vali Acc: 0.466 Test Loss: 25.269 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.77710223197937
Epoch: 9, Steps: 32 | Train Loss: 3.691 Vali Loss: 50.217 Vali Acc: 0.260 Test Loss: 50.217 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.122829437255859
Epoch: 10, Steps: 32 | Train Loss: 29.890 Vali Loss: 74.385 Vali Acc: 0.481 Test Loss: 74.385 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.607805013656616
Epoch: 11, Steps: 32 | Train Loss: 30.210 Vali Loss: 48.699 Vali Acc: 0.382 Test Loss: 48.699 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.489470958709717
Epoch: 12, Steps: 32 | Train Loss: 18.808 Vali Loss: 37.936 Vali Acc: 0.443 Test Loss: 37.936 Test Acc: 0.443
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.0465099811553955
Epoch: 13, Steps: 32 | Train Loss: 12.971 Vali Loss: 33.857 Vali Acc: 0.511 Test Loss: 33.857 Test Acc: 0.511
Validation loss decreased (-0.480762 --> -0.511112).  Saving model ...
Epoch: 14 cost time: 4.447593688964844
Epoch: 14, Steps: 32 | Train Loss: 2.910 Vali Loss: 50.225 Vali Acc: 0.519 Test Loss: 50.225 Test Acc: 0.519
Validation loss decreased (-0.511112 --> -0.518582).  Saving model ...
Epoch: 15 cost time: 4.336123704910278
Epoch: 15, Steps: 32 | Train Loss: 9.331 Vali Loss: 103.407 Vali Acc: 0.496 Test Loss: 103.407 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.542340278625488
Epoch: 16, Steps: 32 | Train Loss: 6.348 Vali Loss: 118.231 Vali Acc: 0.527 Test Loss: 118.231 Test Acc: 0.527
Validation loss decreased (-0.518582 --> -0.525535).  Saving model ...
Epoch: 17 cost time: 4.212458848953247
Epoch: 17, Steps: 32 | Train Loss: 3.446 Vali Loss: 96.804 Vali Acc: 0.573 Test Loss: 96.804 Test Acc: 0.573
Validation loss decreased (-0.525535 --> -0.571551).  Saving model ...
Epoch: 18 cost time: 4.259020090103149
Epoch: 18, Steps: 32 | Train Loss: 2.899 Vali Loss: 89.606 Vali Acc: 0.595 Test Loss: 89.606 Test Acc: 0.595
Validation loss decreased (-0.571551 --> -0.594524).  Saving model ...
Epoch: 19 cost time: 4.016520977020264
Epoch: 19, Steps: 32 | Train Loss: 1.371 Vali Loss: 102.176 Vali Acc: 0.466 Test Loss: 102.176 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9138998985290527
Epoch: 20, Steps: 32 | Train Loss: 4.309 Vali Loss: 92.408 Vali Acc: 0.550 Test Loss: 92.408 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8922178745269775
Epoch: 21, Steps: 32 | Train Loss: 1.189 Vali Loss: 122.363 Vali Acc: 0.328 Test Loss: 122.363 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.91239070892334
Epoch: 22, Steps: 32 | Train Loss: 4.480 Vali Loss: 90.023 Vali Acc: 0.534 Test Loss: 90.023 Test Acc: 0.534
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.781712770462036
Epoch: 23, Steps: 32 | Train Loss: 3.713 Vali Loss: 66.681 Vali Acc: 0.542 Test Loss: 66.681 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.6904187202453613
Epoch: 24, Steps: 32 | Train Loss: 1.431 Vali Loss: 69.457 Vali Acc: 0.504 Test Loss: 69.457 Test Acc: 0.504
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.0045671463012695
Epoch: 25, Steps: 32 | Train Loss: 2.745 Vali Loss: 69.460 Vali Acc: 0.534 Test Loss: 69.460 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.957205295562744
Epoch: 26, Steps: 32 | Train Loss: 0.406 Vali Loss: 83.123 Vali Acc: 0.565 Test Loss: 83.123 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.8611369132995605
Epoch: 27, Steps: 32 | Train Loss: 0.513 Vali Loss: 102.804 Vali Acc: 0.557 Test Loss: 102.804 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.569455146789551
Epoch: 28, Steps: 32 | Train Loss: 2.872 Vali Loss: 77.777 Vali Acc: 0.634 Test Loss: 77.777 Test Acc: 0.634
Validation loss decreased (-0.594524 --> -0.632810).  Saving model ...
Epoch: 29 cost time: 3.907724618911743
Epoch: 29, Steps: 32 | Train Loss: 0.205 Vali Loss: 89.826 Vali Acc: 0.557 Test Loss: 89.826 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.85041880607605
Epoch: 30, Steps: 32 | Train Loss: 0.434 Vali Loss: 102.635 Vali Acc: 0.542 Test Loss: 102.635 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.5755510330200195
Epoch: 31, Steps: 32 | Train Loss: 6.170 Vali Loss: 94.390 Vali Acc: 0.603 Test Loss: 94.390 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.944735527038574
Epoch: 32, Steps: 32 | Train Loss: 2.451 Vali Loss: 90.944 Vali Acc: 0.504 Test Loss: 90.944 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.2113566398620605
Epoch: 33, Steps: 32 | Train Loss: 2.297 Vali Loss: 72.178 Vali Acc: 0.611 Test Loss: 72.178 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.041981935501099
Epoch: 34, Steps: 32 | Train Loss: 1.182 Vali Loss: 104.316 Vali Acc: 0.466 Test Loss: 104.316 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.472486972808838
Epoch: 35, Steps: 32 | Train Loss: 0.646 Vali Loss: 85.733 Vali Acc: 0.519 Test Loss: 85.733 Test Acc: 0.519
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.329802989959717
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 84.992 Vali Acc: 0.580 Test Loss: 84.992 Test Acc: 0.580
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.68972110748291
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 85.427 Vali Acc: 0.588 Test Loss: 85.427 Test Acc: 0.588
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.9035227298736572
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 85.444 Vali Acc: 0.588 Test Loss: 85.444 Test Acc: 0.588
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5773997
model size : 26.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.437124013900757
Epoch: 1, Steps: 32 | Train Loss: 9.309 Vali Loss: 8.808 Vali Acc: 0.267 Test Loss: 8.808 Test Acc: 0.267
Validation loss decreased (inf --> -0.267087).  Saving model ...
Epoch: 2 cost time: 3.4551312923431396
Epoch: 2, Steps: 32 | Train Loss: 13.068 Vali Loss: 21.060 Vali Acc: 0.427 Test Loss: 21.060 Test Acc: 0.427
Validation loss decreased (-0.267087 --> -0.427270).  Saving model ...
Epoch: 3 cost time: 4.0667688846588135
Epoch: 3, Steps: 32 | Train Loss: 18.506 Vali Loss: 19.517 Vali Acc: 0.252 Test Loss: 19.517 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9792122840881348
Epoch: 4, Steps: 32 | Train Loss: 18.645 Vali Loss: 37.288 Vali Acc: 0.145 Test Loss: 37.288 Test Acc: 0.145
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.7554686069488525
Epoch: 5, Steps: 32 | Train Loss: 26.592 Vali Loss: 32.546 Vali Acc: 0.427 Test Loss: 32.546 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.211447715759277
Epoch: 6, Steps: 32 | Train Loss: 30.439 Vali Loss: 55.422 Vali Acc: 0.214 Test Loss: 55.422 Test Acc: 0.214
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9943201541900635
Epoch: 7, Steps: 32 | Train Loss: 29.418 Vali Loss: 76.193 Vali Acc: 0.374 Test Loss: 76.193 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.7167460918426514
Epoch: 8, Steps: 32 | Train Loss: 19.002 Vali Loss: 41.970 Vali Acc: 0.313 Test Loss: 41.970 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8146064281463623
Epoch: 9, Steps: 32 | Train Loss: 13.149 Vali Loss: 55.921 Vali Acc: 0.359 Test Loss: 55.921 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.4905827045440674
Epoch: 10, Steps: 32 | Train Loss: 21.977 Vali Loss: 57.538 Vali Acc: 0.443 Test Loss: 57.538 Test Acc: 0.443
Validation loss decreased (-0.427270 --> -0.442173).  Saving model ...
Epoch: 11 cost time: 3.4280173778533936
Epoch: 11, Steps: 32 | Train Loss: 17.736 Vali Loss: 56.851 Vali Acc: 0.244 Test Loss: 56.851 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.687002658843994
Epoch: 12, Steps: 32 | Train Loss: 14.024 Vali Loss: 53.779 Vali Acc: 0.496 Test Loss: 53.779 Test Acc: 0.496
Validation loss decreased (-0.442173 --> -0.495645).  Saving model ...
Epoch: 13 cost time: 4.028959035873413
Epoch: 13, Steps: 32 | Train Loss: 23.651 Vali Loss: 77.468 Vali Acc: 0.466 Test Loss: 77.468 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4755570888519287
Epoch: 14, Steps: 32 | Train Loss: 8.638 Vali Loss: 52.083 Vali Acc: 0.443 Test Loss: 52.083 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.950345277786255
Epoch: 15, Steps: 32 | Train Loss: 19.544 Vali Loss: 67.670 Vali Acc: 0.527 Test Loss: 67.670 Test Acc: 0.527
Validation loss decreased (-0.495645 --> -0.526041).  Saving model ...
Epoch: 16 cost time: 4.1382737159729
Epoch: 16, Steps: 32 | Train Loss: 11.128 Vali Loss: 107.503 Vali Acc: 0.359 Test Loss: 107.503 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.218432188034058
Epoch: 17, Steps: 32 | Train Loss: 11.048 Vali Loss: 54.547 Vali Acc: 0.611 Test Loss: 54.547 Test Acc: 0.611
Validation loss decreased (-0.526041 --> -0.610142).  Saving model ...
Epoch: 18 cost time: 4.237522125244141
Epoch: 18, Steps: 32 | Train Loss: 1.427 Vali Loss: 50.934 Vali Acc: 0.573 Test Loss: 50.934 Test Acc: 0.573
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.588200569152832
Epoch: 19, Steps: 32 | Train Loss: 0.777 Vali Loss: 77.615 Vali Acc: 0.374 Test Loss: 77.615 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.664774179458618
Epoch: 20, Steps: 32 | Train Loss: 1.543 Vali Loss: 55.246 Vali Acc: 0.634 Test Loss: 55.246 Test Acc: 0.634
Validation loss decreased (-0.610142 --> -0.633035).  Saving model ...
Epoch: 21 cost time: 4.227588891983032
Epoch: 21, Steps: 32 | Train Loss: 2.680 Vali Loss: 99.089 Vali Acc: 0.511 Test Loss: 99.089 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.907196044921875
Epoch: 22, Steps: 32 | Train Loss: 0.938 Vali Loss: 85.114 Vali Acc: 0.534 Test Loss: 85.114 Test Acc: 0.534
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.590975761413574
Epoch: 23, Steps: 32 | Train Loss: 0.745 Vali Loss: 69.171 Vali Acc: 0.557 Test Loss: 69.171 Test Acc: 0.557
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5987210273742676
Epoch: 24, Steps: 32 | Train Loss: 0.676 Vali Loss: 80.064 Vali Acc: 0.412 Test Loss: 80.064 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.719367742538452
Epoch: 25, Steps: 32 | Train Loss: 0.000 Vali Loss: 109.179 Vali Acc: 0.519 Test Loss: 109.179 Test Acc: 0.519
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.053474187850952
Epoch: 26, Steps: 32 | Train Loss: 1.834 Vali Loss: 113.379 Vali Acc: 0.519 Test Loss: 113.379 Test Acc: 0.519
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8937630653381348
Epoch: 27, Steps: 32 | Train Loss: 4.769 Vali Loss: 87.591 Vali Acc: 0.527 Test Loss: 87.591 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.82717227935791
Epoch: 28, Steps: 32 | Train Loss: 0.478 Vali Loss: 94.307 Vali Acc: 0.511 Test Loss: 94.307 Test Acc: 0.511
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.969050168991089
Epoch: 29, Steps: 32 | Train Loss: 1.932 Vali Loss: 157.116 Vali Acc: 0.298 Test Loss: 157.116 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7941813468933105
Epoch: 30, Steps: 32 | Train Loss: 6.506 Vali Loss: 139.369 Vali Acc: 0.420 Test Loss: 139.369 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6335877862595419
model parameter : 5773997
model size : 26.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.826612949371338
Epoch: 1, Steps: 32 | Train Loss: 3.235 Vali Loss: 6.374 Vali Acc: 0.267 Test Loss: 6.374 Test Acc: 0.267
Validation loss decreased (inf --> -0.267112).  Saving model ...
Epoch: 2 cost time: 3.416289806365967
Epoch: 2, Steps: 32 | Train Loss: 3.923 Vali Loss: 8.155 Vali Acc: 0.466 Test Loss: 8.155 Test Acc: 0.466
Validation loss decreased (-0.267112 --> -0.465567).  Saving model ...
Epoch: 3 cost time: 3.151198387145996
Epoch: 3, Steps: 32 | Train Loss: 5.898 Vali Loss: 8.251 Vali Acc: 0.344 Test Loss: 8.251 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7482998371124268
Epoch: 4, Steps: 32 | Train Loss: 5.323 Vali Loss: 20.480 Vali Acc: 0.244 Test Loss: 20.480 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.563157081604004
Epoch: 5, Steps: 32 | Train Loss: 6.742 Vali Loss: 9.597 Vali Acc: 0.534 Test Loss: 9.597 Test Acc: 0.534
Validation loss decreased (-0.465567 --> -0.534255).  Saving model ...
Epoch: 6 cost time: 3.56836199760437
Epoch: 6, Steps: 32 | Train Loss: 3.915 Vali Loss: 11.960 Vali Acc: 0.489 Test Loss: 11.960 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.464883327484131
Epoch: 7, Steps: 32 | Train Loss: 4.385 Vali Loss: 11.457 Vali Acc: 0.328 Test Loss: 11.457 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3823370933532715
Epoch: 8, Steps: 32 | Train Loss: 4.487 Vali Loss: 20.037 Vali Acc: 0.473 Test Loss: 20.037 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.736597776412964
Epoch: 9, Steps: 32 | Train Loss: 8.641 Vali Loss: 18.904 Vali Acc: 0.290 Test Loss: 18.904 Test Acc: 0.290
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6887574195861816
Epoch: 10, Steps: 32 | Train Loss: 10.002 Vali Loss: 28.014 Vali Acc: 0.412 Test Loss: 28.014 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.7125163078308105
Epoch: 11, Steps: 32 | Train Loss: 4.726 Vali Loss: 19.415 Vali Acc: 0.496 Test Loss: 19.415 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.9707529544830322
Epoch: 12, Steps: 32 | Train Loss: 6.908 Vali Loss: 20.501 Vali Acc: 0.473 Test Loss: 20.501 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.4031198024749756
Epoch: 13, Steps: 32 | Train Loss: 3.089 Vali Loss: 27.192 Vali Acc: 0.527 Test Loss: 27.192 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.917268991470337
Epoch: 14, Steps: 32 | Train Loss: 1.662 Vali Loss: 28.531 Vali Acc: 0.412 Test Loss: 28.531 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.2919650077819824
Epoch: 15, Steps: 32 | Train Loss: 2.454 Vali Loss: 35.501 Vali Acc: 0.489 Test Loss: 35.501 Test Acc: 0.489
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5343511450381679
model parameter : 3011949
model size : 13.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.3176047801971436
Epoch: 1, Steps: 32 | Train Loss: 3.035 Vali Loss: 5.579 Vali Acc: 0.206 Test Loss: 5.579 Test Acc: 0.206
Validation loss decreased (inf --> -0.206051).  Saving model ...
Epoch: 2 cost time: 3.1895272731781006
Epoch: 2, Steps: 32 | Train Loss: 3.502 Vali Loss: 6.543 Vali Acc: 0.290 Test Loss: 6.543 Test Acc: 0.290
Validation loss decreased (-0.206051 --> -0.290011).  Saving model ...
Epoch: 3 cost time: 3.195200204849243
Epoch: 3, Steps: 32 | Train Loss: 3.242 Vali Loss: 7.290 Vali Acc: 0.427 Test Loss: 7.290 Test Acc: 0.427
Validation loss decreased (-0.290011 --> -0.427408).  Saving model ...
Epoch: 4 cost time: 3.2033326625823975
Epoch: 4, Steps: 32 | Train Loss: 7.697 Vali Loss: 8.784 Vali Acc: 0.244 Test Loss: 8.784 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.932569742202759
Epoch: 5, Steps: 32 | Train Loss: 4.931 Vali Loss: 14.504 Vali Acc: 0.458 Test Loss: 14.504 Test Acc: 0.458
Validation loss decreased (-0.427408 --> -0.457870).  Saving model ...
Epoch: 6 cost time: 3.298090934753418
Epoch: 6, Steps: 32 | Train Loss: 8.908 Vali Loss: 20.355 Vali Acc: 0.466 Test Loss: 20.355 Test Acc: 0.466
Validation loss decreased (-0.457870 --> -0.465445).  Saving model ...
Epoch: 7 cost time: 2.9221487045288086
Epoch: 7, Steps: 32 | Train Loss: 9.864 Vali Loss: 18.889 Vali Acc: 0.351 Test Loss: 18.889 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9382874965667725
Epoch: 8, Steps: 32 | Train Loss: 9.137 Vali Loss: 20.325 Vali Acc: 0.489 Test Loss: 20.325 Test Acc: 0.489
Validation loss decreased (-0.465445 --> -0.488346).  Saving model ...
Epoch: 9 cost time: 2.8164620399475098
Epoch: 9, Steps: 32 | Train Loss: 9.499 Vali Loss: 27.870 Vali Acc: 0.466 Test Loss: 27.870 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.832197904586792
Epoch: 10, Steps: 32 | Train Loss: 9.385 Vali Loss: 34.519 Vali Acc: 0.313 Test Loss: 34.519 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.100874662399292
Epoch: 11, Steps: 32 | Train Loss: 12.418 Vali Loss: 28.246 Vali Acc: 0.504 Test Loss: 28.246 Test Acc: 0.504
Validation loss decreased (-0.488346 --> -0.503534).  Saving model ...
Epoch: 12 cost time: 3.238457441329956
Epoch: 12, Steps: 32 | Train Loss: 8.564 Vali Loss: 20.013 Vali Acc: 0.328 Test Loss: 20.013 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.169278144836426
Epoch: 13, Steps: 32 | Train Loss: 4.293 Vali Loss: 29.862 Vali Acc: 0.290 Test Loss: 29.862 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2680788040161133
Epoch: 14, Steps: 32 | Train Loss: 3.117 Vali Loss: 23.142 Vali Acc: 0.412 Test Loss: 23.142 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.190723419189453
Epoch: 15, Steps: 32 | Train Loss: 3.604 Vali Loss: 22.657 Vali Acc: 0.458 Test Loss: 22.657 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9872195720672607
Epoch: 16, Steps: 32 | Train Loss: 7.490 Vali Loss: 35.300 Vali Acc: 0.305 Test Loss: 35.300 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2886362075805664
Epoch: 17, Steps: 32 | Train Loss: 3.478 Vali Loss: 28.346 Vali Acc: 0.466 Test Loss: 28.346 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8441202640533447
Epoch: 18, Steps: 32 | Train Loss: 2.084 Vali Loss: 35.079 Vali Acc: 0.344 Test Loss: 35.079 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.0080618858337402
Epoch: 19, Steps: 32 | Train Loss: 2.461 Vali Loss: 40.671 Vali Acc: 0.366 Test Loss: 40.671 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.26721453666687
Epoch: 20, Steps: 32 | Train Loss: 3.198 Vali Loss: 23.796 Vali Acc: 0.481 Test Loss: 23.796 Test Acc: 0.481
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1583709716796875
Epoch: 21, Steps: 32 | Train Loss: 1.123 Vali Loss: 36.052 Vali Acc: 0.420 Test Loss: 36.052 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 3011949
model size : 13.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.096792697906494
Epoch: 1, Steps: 32 | Train Loss: 3.661 Vali Loss: 6.778 Vali Acc: 0.183 Test Loss: 6.778 Test Acc: 0.183
Validation loss decreased (inf --> -0.183138).  Saving model ...
Epoch: 2 cost time: 3.43829607963562
Epoch: 2, Steps: 32 | Train Loss: 4.390 Vali Loss: 6.195 Vali Acc: 0.412 Test Loss: 6.195 Test Acc: 0.412
Validation loss decreased (-0.183138 --> -0.412152).  Saving model ...
Epoch: 3 cost time: 3.0159101486206055
Epoch: 3, Steps: 32 | Train Loss: 5.524 Vali Loss: 8.988 Vali Acc: 0.466 Test Loss: 8.988 Test Acc: 0.466
Validation loss decreased (-0.412152 --> -0.465559).  Saving model ...
Epoch: 4 cost time: 3.063261032104492
Epoch: 4, Steps: 32 | Train Loss: 5.803 Vali Loss: 12.494 Vali Acc: 0.397 Test Loss: 12.494 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5674469470977783
Epoch: 5, Steps: 32 | Train Loss: 13.868 Vali Loss: 18.331 Vali Acc: 0.260 Test Loss: 18.331 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.016162872314453
Epoch: 6, Steps: 32 | Train Loss: 6.467 Vali Loss: 8.521 Vali Acc: 0.359 Test Loss: 8.521 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.5419344902038574
Epoch: 7, Steps: 32 | Train Loss: 7.284 Vali Loss: 16.856 Vali Acc: 0.420 Test Loss: 16.856 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5899386405944824
Epoch: 8, Steps: 32 | Train Loss: 6.780 Vali Loss: 20.759 Vali Acc: 0.282 Test Loss: 20.759 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.423733711242676
Epoch: 9, Steps: 32 | Train Loss: 12.178 Vali Loss: 22.081 Vali Acc: 0.252 Test Loss: 22.081 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.20320725440979
Epoch: 10, Steps: 32 | Train Loss: 5.384 Vali Loss: 38.545 Vali Acc: 0.443 Test Loss: 38.545 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.6830804347991943
Epoch: 11, Steps: 32 | Train Loss: 5.488 Vali Loss: 41.973 Vali Acc: 0.359 Test Loss: 41.973 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9619617462158203
Epoch: 12, Steps: 32 | Train Loss: 5.418 Vali Loss: 41.607 Vali Acc: 0.298 Test Loss: 41.607 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.1210944652557373
Epoch: 13, Steps: 32 | Train Loss: 8.834 Vali Loss: 51.717 Vali Acc: 0.473 Test Loss: 51.717 Test Acc: 0.473
Validation loss decreased (-0.465559 --> -0.472765).  Saving model ...
Epoch: 14 cost time: 3.490269660949707
Epoch: 14, Steps: 32 | Train Loss: 10.484 Vali Loss: 41.744 Vali Acc: 0.321 Test Loss: 41.744 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.319100856781006
Epoch: 15, Steps: 32 | Train Loss: 4.671 Vali Loss: 34.126 Vali Acc: 0.313 Test Loss: 34.126 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4308531284332275
Epoch: 16, Steps: 32 | Train Loss: 3.792 Vali Loss: 34.969 Vali Acc: 0.496 Test Loss: 34.969 Test Acc: 0.496
Validation loss decreased (-0.472765 --> -0.495834).  Saving model ...
Epoch: 17 cost time: 3.6947481632232666
Epoch: 17, Steps: 32 | Train Loss: 6.069 Vali Loss: 30.408 Vali Acc: 0.420 Test Loss: 30.408 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8310017585754395
Epoch: 18, Steps: 32 | Train Loss: 7.819 Vali Loss: 34.245 Vali Acc: 0.481 Test Loss: 34.245 Test Acc: 0.481
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2661514282226562
Epoch: 19, Steps: 32 | Train Loss: 2.943 Vali Loss: 23.341 Vali Acc: 0.511 Test Loss: 23.341 Test Acc: 0.511
Validation loss decreased (-0.495834 --> -0.511217).  Saving model ...
Epoch: 20 cost time: 3.1873652935028076
Epoch: 20, Steps: 32 | Train Loss: 3.199 Vali Loss: 31.842 Vali Acc: 0.527 Test Loss: 31.842 Test Acc: 0.527
Validation loss decreased (-0.511217 --> -0.526399).  Saving model ...
Epoch: 21 cost time: 2.877599000930786
Epoch: 21, Steps: 32 | Train Loss: 3.844 Vali Loss: 32.899 Vali Acc: 0.534 Test Loss: 32.899 Test Acc: 0.534
Validation loss decreased (-0.526399 --> -0.534022).  Saving model ...
Epoch: 22 cost time: 2.997492790222168
Epoch: 22, Steps: 32 | Train Loss: 5.859 Vali Loss: 38.776 Vali Acc: 0.519 Test Loss: 38.776 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.1103646755218506
Epoch: 23, Steps: 32 | Train Loss: 11.524 Vali Loss: 37.803 Vali Acc: 0.565 Test Loss: 37.803 Test Acc: 0.565
Validation loss decreased (-0.534022 --> -0.564507).  Saving model ...
Epoch: 24 cost time: 2.852863073348999
Epoch: 24, Steps: 32 | Train Loss: 1.640 Vali Loss: 33.639 Vali Acc: 0.534 Test Loss: 33.639 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4256107807159424
Epoch: 25, Steps: 32 | Train Loss: 3.175 Vali Loss: 43.516 Vali Acc: 0.511 Test Loss: 43.516 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.045657157897949
Epoch: 26, Steps: 32 | Train Loss: 0.244 Vali Loss: 38.921 Vali Acc: 0.527 Test Loss: 38.921 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.896498441696167
Epoch: 27, Steps: 32 | Train Loss: 0.242 Vali Loss: 45.339 Vali Acc: 0.527 Test Loss: 45.339 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.03332781791687
Epoch: 28, Steps: 32 | Train Loss: 4.410 Vali Loss: 42.980 Vali Acc: 0.542 Test Loss: 42.980 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0452017784118652
Epoch: 29, Steps: 32 | Train Loss: 1.044 Vali Loss: 63.808 Vali Acc: 0.374 Test Loss: 63.808 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.9458086490631104
Epoch: 30, Steps: 32 | Train Loss: 0.233 Vali Loss: 54.972 Vali Acc: 0.580 Test Loss: 54.972 Test Acc: 0.580
Validation loss decreased (-0.564507 --> -0.579603).  Saving model ...
Epoch: 31 cost time: 2.9300153255462646
Epoch: 31, Steps: 32 | Train Loss: 0.315 Vali Loss: 67.245 Vali Acc: 0.519 Test Loss: 67.245 Test Acc: 0.519
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.142012596130371
Epoch: 32, Steps: 32 | Train Loss: 1.113 Vali Loss: 51.281 Vali Acc: 0.580 Test Loss: 51.281 Test Acc: 0.580
Validation loss decreased (-0.579603 --> -0.579640).  Saving model ...
Epoch: 33 cost time: 2.6441423892974854
Epoch: 33, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.765 Vali Acc: 0.603 Test Loss: 52.765 Test Acc: 0.603
Validation loss decreased (-0.579640 --> -0.602526).  Saving model ...
Epoch: 34 cost time: 2.8153090476989746
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.845 Vali Acc: 0.603 Test Loss: 52.845 Test Acc: 0.603
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.138296604156494
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.822368621826172
Epoch: 36, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1731081008911133
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.52816104888916
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.098501205444336
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.0350656509399414
Epoch: 40, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.2037346363067627
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.963432788848877
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.2163047790527344
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 52.848 Vali Acc: 0.603 Test Loss: 52.848 Test Acc: 0.603
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6030534351145038
model parameter : 3011949
model size : 13.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.344680070877075
Epoch: 1, Steps: 32 | Train Loss: 3.637 Vali Loss: 7.614 Vali Acc: 0.229 Test Loss: 7.614 Test Acc: 0.229
Validation loss decreased (inf --> -0.228931).  Saving model ...
Epoch: 2 cost time: 3.059821367263794
Epoch: 2, Steps: 32 | Train Loss: 5.843 Vali Loss: 13.472 Vali Acc: 0.153 Test Loss: 13.472 Test Acc: 0.153
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.188957691192627
Epoch: 3, Steps: 32 | Train Loss: 9.797 Vali Loss: 8.732 Vali Acc: 0.305 Test Loss: 8.732 Test Acc: 0.305
Validation loss decreased (-0.228931 --> -0.305256).  Saving model ...
Epoch: 4 cost time: 3.325747489929199
Epoch: 4, Steps: 32 | Train Loss: 7.904 Vali Loss: 19.425 Vali Acc: 0.137 Test Loss: 19.425 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1163551807403564
Epoch: 5, Steps: 32 | Train Loss: 10.270 Vali Loss: 14.545 Vali Acc: 0.466 Test Loss: 14.545 Test Acc: 0.466
Validation loss decreased (-0.305256 --> -0.465503).  Saving model ...
Epoch: 6 cost time: 2.9603352546691895
Epoch: 6, Steps: 32 | Train Loss: 12.262 Vali Loss: 22.716 Vali Acc: 0.145 Test Loss: 22.716 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6231424808502197
Epoch: 7, Steps: 32 | Train Loss: 17.313 Vali Loss: 29.043 Vali Acc: 0.168 Test Loss: 29.043 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3419556617736816
Epoch: 8, Steps: 32 | Train Loss: 18.001 Vali Loss: 23.847 Vali Acc: 0.435 Test Loss: 23.847 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.8929831981658936
Epoch: 9, Steps: 32 | Train Loss: 15.688 Vali Loss: 28.658 Vali Acc: 0.427 Test Loss: 28.658 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.311067581176758
Epoch: 10, Steps: 32 | Train Loss: 19.818 Vali Loss: 14.016 Vali Acc: 0.214 Test Loss: 14.016 Test Acc: 0.214
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2266557216644287
Epoch: 11, Steps: 32 | Train Loss: 16.932 Vali Loss: 22.537 Vali Acc: 0.321 Test Loss: 22.537 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0430521965026855
Epoch: 12, Steps: 32 | Train Loss: 9.885 Vali Loss: 18.688 Vali Acc: 0.168 Test Loss: 18.688 Test Acc: 0.168
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.23219633102417
Epoch: 13, Steps: 32 | Train Loss: 15.148 Vali Loss: 23.999 Vali Acc: 0.435 Test Loss: 23.999 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9187750816345215
Epoch: 14, Steps: 32 | Train Loss: 12.377 Vali Loss: 18.622 Vali Acc: 0.427 Test Loss: 18.622 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.885308265686035
Epoch: 15, Steps: 32 | Train Loss: 14.589 Vali Loss: 34.122 Vali Acc: 0.229 Test Loss: 34.122 Test Acc: 0.229
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 3011949
model size : 13.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.160275936126709
Epoch: 1, Steps: 32 | Train Loss: 5.183 Vali Loss: 3.524 Vali Acc: 0.275 Test Loss: 3.524 Test Acc: 0.275
Validation loss decreased (inf --> -0.274774).  Saving model ...
Epoch: 2 cost time: 3.215092420578003
Epoch: 2, Steps: 32 | Train Loss: 6.894 Vali Loss: 8.530 Vali Acc: 0.405 Test Loss: 8.530 Test Acc: 0.405
Validation loss decreased (-0.274774 --> -0.404495).  Saving model ...
Epoch: 3 cost time: 3.0799171924591064
Epoch: 3, Steps: 32 | Train Loss: 9.169 Vali Loss: 12.313 Vali Acc: 0.489 Test Loss: 12.313 Test Acc: 0.489
Validation loss decreased (-0.404495 --> -0.488426).  Saving model ...
Epoch: 4 cost time: 3.434523344039917
Epoch: 4, Steps: 32 | Train Loss: 11.266 Vali Loss: 12.110 Vali Acc: 0.298 Test Loss: 12.110 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2932724952697754
Epoch: 5, Steps: 32 | Train Loss: 6.624 Vali Loss: 15.000 Vali Acc: 0.542 Test Loss: 15.000 Test Acc: 0.542
Validation loss decreased (-0.488426 --> -0.541835).  Saving model ...
Epoch: 6 cost time: 3.2743444442749023
Epoch: 6, Steps: 32 | Train Loss: 5.027 Vali Loss: 21.869 Vali Acc: 0.244 Test Loss: 21.869 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0621702671051025
Epoch: 7, Steps: 32 | Train Loss: 10.274 Vali Loss: 27.860 Vali Acc: 0.229 Test Loss: 27.860 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6725356578826904
Epoch: 8, Steps: 32 | Train Loss: 11.435 Vali Loss: 20.829 Vali Acc: 0.534 Test Loss: 20.829 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.3131613731384277
Epoch: 9, Steps: 32 | Train Loss: 7.856 Vali Loss: 32.529 Vali Acc: 0.489 Test Loss: 32.529 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.530400037765503
Epoch: 10, Steps: 32 | Train Loss: 7.445 Vali Loss: 20.820 Vali Acc: 0.573 Test Loss: 20.820 Test Acc: 0.573
Validation loss decreased (-0.541835 --> -0.572311).  Saving model ...
Epoch: 11 cost time: 3.8359432220458984
Epoch: 11, Steps: 32 | Train Loss: 8.568 Vali Loss: 26.659 Vali Acc: 0.542 Test Loss: 26.659 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.249849319458008
Epoch: 12, Steps: 32 | Train Loss: 5.061 Vali Loss: 33.131 Vali Acc: 0.412 Test Loss: 33.131 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.6482648849487305
Epoch: 13, Steps: 32 | Train Loss: 1.883 Vali Loss: 20.589 Vali Acc: 0.511 Test Loss: 20.589 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.30289363861084
Epoch: 14, Steps: 32 | Train Loss: 5.056 Vali Loss: 27.319 Vali Acc: 0.420 Test Loss: 27.319 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.663506031036377
Epoch: 15, Steps: 32 | Train Loss: 3.668 Vali Loss: 27.380 Vali Acc: 0.504 Test Loss: 27.380 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.518136978149414
Epoch: 16, Steps: 32 | Train Loss: 0.831 Vali Loss: 26.759 Vali Acc: 0.496 Test Loss: 26.759 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.423689603805542
Epoch: 17, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.761 Vali Acc: 0.489 Test Loss: 28.761 Test Acc: 0.489
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.533350944519043
Epoch: 18, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.883 Vali Acc: 0.489 Test Loss: 28.883 Test Acc: 0.489
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.3125345706939697
Epoch: 19, Steps: 32 | Train Loss: 0.000 Vali Loss: 28.904 Vali Acc: 0.458 Test Loss: 28.904 Test Acc: 0.458
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.5225017070770264
Epoch: 20, Steps: 32 | Train Loss: 1.522 Vali Loss: 32.301 Vali Acc: 0.420 Test Loss: 32.301 Test Acc: 0.420
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2946413
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.354568243026733
Epoch: 1, Steps: 32 | Train Loss: 4.981 Vali Loss: 2.565 Vali Acc: 0.511 Test Loss: 2.565 Test Acc: 0.511
Validation loss decreased (inf --> -0.511425).  Saving model ...
Epoch: 2 cost time: 3.469954013824463
Epoch: 2, Steps: 32 | Train Loss: 6.270 Vali Loss: 8.290 Vali Acc: 0.458 Test Loss: 8.290 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.745377540588379
Epoch: 3, Steps: 32 | Train Loss: 10.491 Vali Loss: 11.448 Vali Acc: 0.504 Test Loss: 11.448 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.329296112060547
Epoch: 4, Steps: 32 | Train Loss: 10.065 Vali Loss: 14.660 Vali Acc: 0.420 Test Loss: 14.660 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.4809350967407227
Epoch: 5, Steps: 32 | Train Loss: 7.733 Vali Loss: 26.958 Vali Acc: 0.160 Test Loss: 26.958 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.998230457305908
Epoch: 6, Steps: 32 | Train Loss: 7.554 Vali Loss: 19.057 Vali Acc: 0.466 Test Loss: 19.057 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.2546162605285645
Epoch: 7, Steps: 32 | Train Loss: 14.542 Vali Loss: 43.018 Vali Acc: 0.221 Test Loss: 43.018 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.343921422958374
Epoch: 8, Steps: 32 | Train Loss: 11.314 Vali Loss: 16.834 Vali Acc: 0.466 Test Loss: 16.834 Test Acc: 0.466
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.0278916358947754
Epoch: 9, Steps: 32 | Train Loss: 4.593 Vali Loss: 20.235 Vali Acc: 0.496 Test Loss: 20.235 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.1987645626068115
Epoch: 10, Steps: 32 | Train Loss: 6.705 Vali Loss: 19.279 Vali Acc: 0.504 Test Loss: 19.279 Test Acc: 0.504
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.0827999114990234
Epoch: 11, Steps: 32 | Train Loss: 13.531 Vali Loss: 19.721 Vali Acc: 0.427 Test Loss: 19.721 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2946413
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.078146457672119
Epoch: 1, Steps: 32 | Train Loss: 4.875 Vali Loss: 2.415 Vali Acc: 0.473 Test Loss: 2.415 Test Acc: 0.473
Validation loss decreased (inf --> -0.473258).  Saving model ...
Epoch: 2 cost time: 3.158823013305664
Epoch: 2, Steps: 32 | Train Loss: 5.866 Vali Loss: 7.217 Vali Acc: 0.412 Test Loss: 7.217 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0071918964385986
Epoch: 3, Steps: 32 | Train Loss: 8.671 Vali Loss: 23.332 Vali Acc: 0.458 Test Loss: 23.332 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.087728500366211
Epoch: 4, Steps: 32 | Train Loss: 6.508 Vali Loss: 14.793 Vali Acc: 0.328 Test Loss: 14.793 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2222952842712402
Epoch: 5, Steps: 32 | Train Loss: 5.126 Vali Loss: 16.941 Vali Acc: 0.435 Test Loss: 16.941 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.0034725666046143
Epoch: 6, Steps: 32 | Train Loss: 6.070 Vali Loss: 17.832 Vali Acc: 0.305 Test Loss: 17.832 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6966545581817627
Epoch: 7, Steps: 32 | Train Loss: 7.710 Vali Loss: 16.795 Vali Acc: 0.458 Test Loss: 16.795 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.237835168838501
Epoch: 8, Steps: 32 | Train Loss: 10.830 Vali Loss: 13.588 Vali Acc: 0.290 Test Loss: 13.588 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.7126855850219727
Epoch: 9, Steps: 32 | Train Loss: 6.239 Vali Loss: 17.281 Vali Acc: 0.328 Test Loss: 17.281 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.168656826019287
Epoch: 10, Steps: 32 | Train Loss: 5.015 Vali Loss: 18.800 Vali Acc: 0.290 Test Loss: 18.800 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.4505884647369385
Epoch: 11, Steps: 32 | Train Loss: 8.757 Vali Loss: 35.666 Vali Acc: 0.305 Test Loss: 35.666 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 2946413
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.730574131011963
Epoch: 1, Steps: 32 | Train Loss: 4.318 Vali Loss: 5.448 Vali Acc: 0.176 Test Loss: 5.448 Test Acc: 0.176
Validation loss decreased (inf --> -0.175518).  Saving model ...
Epoch: 2 cost time: 3.091392993927002
Epoch: 2, Steps: 32 | Train Loss: 5.340 Vali Loss: 6.831 Vali Acc: 0.198 Test Loss: 6.831 Test Acc: 0.198
Validation loss decreased (-0.175518 --> -0.198405).  Saving model ...
Epoch: 3 cost time: 2.758873462677002
Epoch: 3, Steps: 32 | Train Loss: 11.132 Vali Loss: 17.518 Vali Acc: 0.427 Test Loss: 17.518 Test Acc: 0.427
Validation loss decreased (-0.198405 --> -0.427306).  Saving model ...
Epoch: 4 cost time: 2.7874755859375
Epoch: 4, Steps: 32 | Train Loss: 11.519 Vali Loss: 14.831 Vali Acc: 0.260 Test Loss: 14.831 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.286252498626709
Epoch: 5, Steps: 32 | Train Loss: 8.122 Vali Loss: 21.357 Vali Acc: 0.237 Test Loss: 21.357 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0479280948638916
Epoch: 6, Steps: 32 | Train Loss: 9.951 Vali Loss: 19.074 Vali Acc: 0.321 Test Loss: 19.074 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.639253616333008
Epoch: 7, Steps: 32 | Train Loss: 10.269 Vali Loss: 24.708 Vali Acc: 0.229 Test Loss: 24.708 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.666261911392212
Epoch: 8, Steps: 32 | Train Loss: 16.088 Vali Loss: 21.327 Vali Acc: 0.450 Test Loss: 21.327 Test Acc: 0.450
Validation loss decreased (-0.427306 --> -0.450168).  Saving model ...
Epoch: 9 cost time: 3.2269198894500732
Epoch: 9, Steps: 32 | Train Loss: 13.056 Vali Loss: 28.240 Vali Acc: 0.427 Test Loss: 28.240 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.473628044128418
Epoch: 10, Steps: 32 | Train Loss: 20.514 Vali Loss: 22.677 Vali Acc: 0.412 Test Loss: 22.677 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.968545436859131
Epoch: 11, Steps: 32 | Train Loss: 13.630 Vali Loss: 31.911 Vali Acc: 0.191 Test Loss: 31.911 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.149244785308838
Epoch: 12, Steps: 32 | Train Loss: 10.213 Vali Loss: 13.894 Vali Acc: 0.305 Test Loss: 13.894 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.080019950866699
Epoch: 13, Steps: 32 | Train Loss: 8.389 Vali Loss: 20.170 Vali Acc: 0.435 Test Loss: 20.170 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.100717544555664
Epoch: 14, Steps: 32 | Train Loss: 9.865 Vali Loss: 26.808 Vali Acc: 0.244 Test Loss: 26.808 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.6307871341705322
Epoch: 15, Steps: 32 | Train Loss: 9.616 Vali Loss: 20.264 Vali Acc: 0.214 Test Loss: 20.264 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.151123046875
Epoch: 16, Steps: 32 | Train Loss: 4.619 Vali Loss: 13.856 Vali Acc: 0.420 Test Loss: 13.856 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.8642735481262207
Epoch: 17, Steps: 32 | Train Loss: 4.155 Vali Loss: 26.504 Vali Acc: 0.229 Test Loss: 26.504 Test Acc: 0.229
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3276216983795166
Epoch: 18, Steps: 32 | Train Loss: 3.384 Vali Loss: 21.550 Vali Acc: 0.511 Test Loss: 21.550 Test Acc: 0.511
Validation loss decreased (-0.450168 --> -0.511235).  Saving model ...
Epoch: 19 cost time: 2.8816120624542236
Epoch: 19, Steps: 32 | Train Loss: 3.813 Vali Loss: 12.371 Vali Acc: 0.603 Test Loss: 12.371 Test Acc: 0.603
Validation loss decreased (-0.511235 --> -0.602930).  Saving model ...
Epoch: 20 cost time: 2.9576523303985596
Epoch: 20, Steps: 32 | Train Loss: 1.251 Vali Loss: 35.339 Vali Acc: 0.504 Test Loss: 35.339 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8182787895202637
Epoch: 21, Steps: 32 | Train Loss: 4.212 Vali Loss: 35.479 Vali Acc: 0.252 Test Loss: 35.479 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.754591226577759
Epoch: 22, Steps: 32 | Train Loss: 0.463 Vali Loss: 37.088 Vali Acc: 0.519 Test Loss: 37.088 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7639448642730713
Epoch: 23, Steps: 32 | Train Loss: 0.552 Vali Loss: 20.971 Vali Acc: 0.588 Test Loss: 20.971 Test Acc: 0.588
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.8224904537200928
Epoch: 24, Steps: 32 | Train Loss: 0.325 Vali Loss: 48.285 Vali Acc: 0.489 Test Loss: 48.285 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9886326789855957
Epoch: 25, Steps: 32 | Train Loss: 0.571 Vali Loss: 42.813 Vali Acc: 0.611 Test Loss: 42.813 Test Acc: 0.611
Validation loss decreased (-0.602930 --> -0.610259).  Saving model ...
Epoch: 26 cost time: 3.021682024002075
Epoch: 26, Steps: 32 | Train Loss: 0.224 Vali Loss: 41.595 Vali Acc: 0.542 Test Loss: 41.595 Test Acc: 0.542
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0984995365142822
Epoch: 27, Steps: 32 | Train Loss: 0.168 Vali Loss: 53.671 Vali Acc: 0.542 Test Loss: 53.671 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.6530747413635254
Epoch: 28, Steps: 32 | Train Loss: 0.565 Vali Loss: 36.646 Vali Acc: 0.580 Test Loss: 36.646 Test Acc: 0.580
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6349382400512695
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.577 Vali Acc: 0.496 Test Loss: 37.577 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.955094337463379
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.643 Vali Acc: 0.489 Test Loss: 37.643 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.751892328262329
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.646 Vali Acc: 0.489 Test Loss: 37.646 Test Acc: 0.489
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.790123701095581
Epoch: 32, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.205 Vali Acc: 0.550 Test Loss: 38.205 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.008842945098877
Epoch: 33, Steps: 32 | Train Loss: 1.881 Vali Loss: 35.802 Vali Acc: 0.565 Test Loss: 35.802 Test Acc: 0.565
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.7710695266723633
Epoch: 34, Steps: 32 | Train Loss: 0.000 Vali Loss: 37.913 Vali Acc: 0.573 Test Loss: 37.913 Test Acc: 0.573
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.799208164215088
Epoch: 35, Steps: 32 | Train Loss: 0.000 Vali Loss: 38.073 Vali Acc: 0.580 Test Loss: 38.073 Test Acc: 0.580
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 2946413
model size : 13.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.216914653778076
Epoch: 1, Steps: 32 | Train Loss: 5.087 Vali Loss: 2.531 Vali Acc: 0.282 Test Loss: 2.531 Test Acc: 0.282
Validation loss decreased (inf --> -0.282417).  Saving model ...
Epoch: 2 cost time: 2.7591159343719482
Epoch: 2, Steps: 32 | Train Loss: 4.998 Vali Loss: 7.328 Vali Acc: 0.420 Test Loss: 7.328 Test Acc: 0.420
Validation loss decreased (-0.282417 --> -0.419774).  Saving model ...
Epoch: 3 cost time: 3.2149248123168945
Epoch: 3, Steps: 32 | Train Loss: 4.620 Vali Loss: 13.413 Vali Acc: 0.267 Test Loss: 13.413 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8275601863861084
Epoch: 4, Steps: 32 | Train Loss: 4.878 Vali Loss: 11.166 Vali Acc: 0.511 Test Loss: 11.166 Test Acc: 0.511
Validation loss decreased (-0.419774 --> -0.511339).  Saving model ...
Epoch: 5 cost time: 3.4122321605682373
Epoch: 5, Steps: 32 | Train Loss: 5.003 Vali Loss: 17.764 Vali Acc: 0.313 Test Loss: 17.764 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.229186773300171
Epoch: 6, Steps: 32 | Train Loss: 4.522 Vali Loss: 21.512 Vali Acc: 0.427 Test Loss: 21.512 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.645517349243164
Epoch: 7, Steps: 32 | Train Loss: 8.678 Vali Loss: 21.281 Vali Acc: 0.321 Test Loss: 21.281 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.412984609603882
Epoch: 8, Steps: 32 | Train Loss: 7.383 Vali Loss: 19.843 Vali Acc: 0.305 Test Loss: 19.843 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.696868658065796
Epoch: 9, Steps: 32 | Train Loss: 5.251 Vali Loss: 22.127 Vali Acc: 0.427 Test Loss: 22.127 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9784727096557617
Epoch: 10, Steps: 32 | Train Loss: 4.473 Vali Loss: 30.719 Vali Acc: 0.542 Test Loss: 30.719 Test Acc: 0.542
Validation loss decreased (-0.511339 --> -0.541678).  Saving model ...
Epoch: 11 cost time: 3.481973886489868
Epoch: 11, Steps: 32 | Train Loss: 6.702 Vali Loss: 23.398 Vali Acc: 0.405 Test Loss: 23.398 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.414907455444336
Epoch: 12, Steps: 32 | Train Loss: 2.447 Vali Loss: 16.795 Vali Acc: 0.466 Test Loss: 16.795 Test Acc: 0.466
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.059040069580078
Epoch: 13, Steps: 32 | Train Loss: 4.273 Vali Loss: 23.177 Vali Acc: 0.382 Test Loss: 23.177 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.576852321624756
Epoch: 14, Steps: 32 | Train Loss: 4.114 Vali Loss: 39.898 Vali Acc: 0.405 Test Loss: 39.898 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.890540838241577
Epoch: 15, Steps: 32 | Train Loss: 5.271 Vali Loss: 31.263 Vali Acc: 0.458 Test Loss: 31.263 Test Acc: 0.458
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3626699447631836
Epoch: 16, Steps: 32 | Train Loss: 3.020 Vali Loss: 32.829 Vali Acc: 0.336 Test Loss: 32.829 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.71992826461792
Epoch: 17, Steps: 32 | Train Loss: 3.613 Vali Loss: 32.098 Vali Acc: 0.290 Test Loss: 32.098 Test Acc: 0.290
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1854233741760254
Epoch: 18, Steps: 32 | Train Loss: 4.327 Vali Loss: 33.685 Vali Acc: 0.313 Test Loss: 33.685 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.6364283561706543
Epoch: 19, Steps: 32 | Train Loss: 6.944 Vali Loss: 34.348 Vali Acc: 0.542 Test Loss: 34.348 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2436976432800293
Epoch: 20, Steps: 32 | Train Loss: 0.527 Vali Loss: 37.825 Vali Acc: 0.466 Test Loss: 37.825 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 2913645
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.730214357376099
Epoch: 1, Steps: 32 | Train Loss: 5.054 Vali Loss: 2.386 Vali Acc: 0.275 Test Loss: 2.386 Test Acc: 0.275
Validation loss decreased (inf --> -0.274785).  Saving model ...
Epoch: 2 cost time: 2.7910594940185547
Epoch: 2, Steps: 32 | Train Loss: 4.166 Vali Loss: 5.011 Vali Acc: 0.313 Test Loss: 5.011 Test Acc: 0.313
Validation loss decreased (-0.274785 --> -0.312927).  Saving model ...
Epoch: 3 cost time: 3.393683433532715
Epoch: 3, Steps: 32 | Train Loss: 3.824 Vali Loss: 13.447 Vali Acc: 0.237 Test Loss: 13.447 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.793151378631592
Epoch: 4, Steps: 32 | Train Loss: 5.797 Vali Loss: 17.613 Vali Acc: 0.282 Test Loss: 17.613 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0895001888275146
Epoch: 5, Steps: 32 | Train Loss: 2.937 Vali Loss: 18.009 Vali Acc: 0.145 Test Loss: 18.009 Test Acc: 0.145
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.940606117248535
Epoch: 6, Steps: 32 | Train Loss: 4.982 Vali Loss: 16.393 Vali Acc: 0.359 Test Loss: 16.393 Test Acc: 0.359
Validation loss decreased (-0.312927 --> -0.358615).  Saving model ...
Epoch: 7 cost time: 3.3551557064056396
Epoch: 7, Steps: 32 | Train Loss: 5.891 Vali Loss: 25.976 Vali Acc: 0.282 Test Loss: 25.976 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0436201095581055
Epoch: 8, Steps: 32 | Train Loss: 8.785 Vali Loss: 22.777 Vali Acc: 0.313 Test Loss: 22.777 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.27449107170105
Epoch: 9, Steps: 32 | Train Loss: 8.516 Vali Loss: 14.265 Vali Acc: 0.374 Test Loss: 14.265 Test Acc: 0.374
Validation loss decreased (-0.358615 --> -0.373903).  Saving model ...
Epoch: 10 cost time: 2.945012092590332
Epoch: 10, Steps: 32 | Train Loss: 6.807 Vali Loss: 17.947 Vali Acc: 0.504 Test Loss: 17.947 Test Acc: 0.504
Validation loss decreased (-0.373903 --> -0.503637).  Saving model ...
Epoch: 11 cost time: 3.2283577919006348
Epoch: 11, Steps: 32 | Train Loss: 6.309 Vali Loss: 18.328 Vali Acc: 0.458 Test Loss: 18.328 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.050205945968628
Epoch: 12, Steps: 32 | Train Loss: 8.583 Vali Loss: 30.116 Vali Acc: 0.313 Test Loss: 30.116 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4039034843444824
Epoch: 13, Steps: 32 | Train Loss: 10.964 Vali Loss: 42.519 Vali Acc: 0.321 Test Loss: 42.519 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9528512954711914
Epoch: 14, Steps: 32 | Train Loss: 4.424 Vali Loss: 23.738 Vali Acc: 0.534 Test Loss: 23.738 Test Acc: 0.534
Validation loss decreased (-0.503637 --> -0.534114).  Saving model ...
Epoch: 15 cost time: 3.1250839233398438
Epoch: 15, Steps: 32 | Train Loss: 3.246 Vali Loss: 17.664 Vali Acc: 0.427 Test Loss: 17.664 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.041210651397705
Epoch: 16, Steps: 32 | Train Loss: 0.845 Vali Loss: 25.349 Vali Acc: 0.427 Test Loss: 25.349 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.762535333633423
Epoch: 17, Steps: 32 | Train Loss: 4.646 Vali Loss: 24.234 Vali Acc: 0.527 Test Loss: 24.234 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1133368015289307
Epoch: 18, Steps: 32 | Train Loss: 9.167 Vali Loss: 24.887 Vali Acc: 0.504 Test Loss: 24.887 Test Acc: 0.504
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.28098726272583
Epoch: 19, Steps: 32 | Train Loss: 2.401 Vali Loss: 38.683 Vali Acc: 0.450 Test Loss: 38.683 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.2753329277038574
Epoch: 20, Steps: 32 | Train Loss: 1.637 Vali Loss: 27.292 Vali Acc: 0.534 Test Loss: 27.292 Test Acc: 0.534
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.107001781463623
Epoch: 21, Steps: 32 | Train Loss: 1.328 Vali Loss: 40.412 Vali Acc: 0.481 Test Loss: 40.412 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.108617544174194
Epoch: 22, Steps: 32 | Train Loss: 3.143 Vali Loss: 66.013 Vali Acc: 0.374 Test Loss: 66.013 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.009645700454712
Epoch: 23, Steps: 32 | Train Loss: 2.099 Vali Loss: 64.726 Vali Acc: 0.550 Test Loss: 64.726 Test Acc: 0.550
Validation loss decreased (-0.534114 --> -0.548971).  Saving model ...
Epoch: 24 cost time: 2.984140157699585
Epoch: 24, Steps: 32 | Train Loss: 1.201 Vali Loss: 43.019 Vali Acc: 0.534 Test Loss: 43.019 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.7623140811920166
Epoch: 25, Steps: 32 | Train Loss: 2.675 Vali Loss: 43.960 Vali Acc: 0.519 Test Loss: 43.960 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.539273262023926
Epoch: 26, Steps: 32 | Train Loss: 0.346 Vali Loss: 63.632 Vali Acc: 0.489 Test Loss: 63.632 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.335585594177246
Epoch: 27, Steps: 32 | Train Loss: 0.605 Vali Loss: 54.274 Vali Acc: 0.450 Test Loss: 54.274 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4071972370147705
Epoch: 28, Steps: 32 | Train Loss: 1.310 Vali Loss: 70.531 Vali Acc: 0.420 Test Loss: 70.531 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.4243462085723877
Epoch: 29, Steps: 32 | Train Loss: 1.027 Vali Loss: 64.720 Vali Acc: 0.527 Test Loss: 64.720 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.405241012573242
Epoch: 30, Steps: 32 | Train Loss: 0.919 Vali Loss: 66.793 Vali Acc: 0.504 Test Loss: 66.793 Test Acc: 0.504
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.9089365005493164
Epoch: 31, Steps: 32 | Train Loss: 0.000 Vali Loss: 71.871 Vali Acc: 0.534 Test Loss: 71.871 Test Acc: 0.534
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.172416925430298
Epoch: 32, Steps: 32 | Train Loss: 0.089 Vali Loss: 63.476 Vali Acc: 0.435 Test Loss: 63.476 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.953544855117798
Epoch: 33, Steps: 32 | Train Loss: 0.499 Vali Loss: 56.413 Vali Acc: 0.412 Test Loss: 56.413 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.549618320610687
model parameter : 2913645
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.431598424911499
Epoch: 1, Steps: 32 | Train Loss: 4.848 Vali Loss: 2.927 Vali Acc: 0.435 Test Loss: 2.927 Test Acc: 0.435
Validation loss decreased (inf --> -0.435085).  Saving model ...
Epoch: 2 cost time: 3.621870994567871
Epoch: 2, Steps: 32 | Train Loss: 5.045 Vali Loss: 12.013 Vali Acc: 0.450 Test Loss: 12.013 Test Acc: 0.450
Validation loss decreased (-0.435085 --> -0.450262).  Saving model ...
Epoch: 3 cost time: 2.946911334991455
Epoch: 3, Steps: 32 | Train Loss: 9.334 Vali Loss: 13.223 Vali Acc: 0.450 Test Loss: 13.223 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2810120582580566
Epoch: 4, Steps: 32 | Train Loss: 5.304 Vali Loss: 10.880 Vali Acc: 0.313 Test Loss: 10.880 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6392879486083984
Epoch: 5, Steps: 32 | Train Loss: 5.291 Vali Loss: 15.120 Vali Acc: 0.298 Test Loss: 15.120 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1038293838500977
Epoch: 6, Steps: 32 | Train Loss: 6.437 Vali Loss: 25.669 Vali Acc: 0.244 Test Loss: 25.669 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0219483375549316
Epoch: 7, Steps: 32 | Train Loss: 12.520 Vali Loss: 18.304 Vali Acc: 0.290 Test Loss: 18.304 Test Acc: 0.290
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0183353424072266
Epoch: 8, Steps: 32 | Train Loss: 15.071 Vali Loss: 23.172 Vali Acc: 0.191 Test Loss: 23.172 Test Acc: 0.191
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.175147771835327
Epoch: 9, Steps: 32 | Train Loss: 6.837 Vali Loss: 11.490 Vali Acc: 0.489 Test Loss: 11.490 Test Acc: 0.489
Validation loss decreased (-0.450262 --> -0.488435).  Saving model ...
Epoch: 10 cost time: 3.0664079189300537
Epoch: 10, Steps: 32 | Train Loss: 11.540 Vali Loss: 27.899 Vali Acc: 0.427 Test Loss: 27.899 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.16577410697937
Epoch: 11, Steps: 32 | Train Loss: 8.440 Vali Loss: 29.519 Vali Acc: 0.198 Test Loss: 29.519 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.415008068084717
Epoch: 12, Steps: 32 | Train Loss: 5.181 Vali Loss: 29.132 Vali Acc: 0.366 Test Loss: 29.132 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.907874345779419
Epoch: 13, Steps: 32 | Train Loss: 7.357 Vali Loss: 21.005 Vali Acc: 0.489 Test Loss: 21.005 Test Acc: 0.489
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7163820266723633
Epoch: 14, Steps: 32 | Train Loss: 5.404 Vali Loss: 16.337 Vali Acc: 0.496 Test Loss: 16.337 Test Acc: 0.496
Validation loss decreased (-0.488435 --> -0.496020).  Saving model ...
Epoch: 15 cost time: 3.442589044570923
Epoch: 15, Steps: 32 | Train Loss: 4.008 Vali Loss: 16.908 Vali Acc: 0.420 Test Loss: 16.908 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9178903102874756
Epoch: 16, Steps: 32 | Train Loss: 7.219 Vali Loss: 18.557 Vali Acc: 0.450 Test Loss: 18.557 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6132254600524902
Epoch: 17, Steps: 32 | Train Loss: 4.960 Vali Loss: 31.429 Vali Acc: 0.298 Test Loss: 31.429 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1968772411346436
Epoch: 18, Steps: 32 | Train Loss: 6.971 Vali Loss: 40.044 Vali Acc: 0.481 Test Loss: 40.044 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.80482816696167
Epoch: 19, Steps: 32 | Train Loss: 7.517 Vali Loss: 60.693 Vali Acc: 0.481 Test Loss: 60.693 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.390820264816284
Epoch: 20, Steps: 32 | Train Loss: 2.310 Vali Loss: 77.832 Vali Acc: 0.351 Test Loss: 77.832 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8635733127593994
Epoch: 21, Steps: 32 | Train Loss: 5.494 Vali Loss: 61.597 Vali Acc: 0.504 Test Loss: 61.597 Test Acc: 0.504
Validation loss decreased (-0.496020 --> -0.503201).  Saving model ...
Epoch: 22 cost time: 3.582514524459839
Epoch: 22, Steps: 32 | Train Loss: 0.258 Vali Loss: 57.235 Vali Acc: 0.443 Test Loss: 57.235 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.9231715202331543
Epoch: 23, Steps: 32 | Train Loss: 0.726 Vali Loss: 63.486 Vali Acc: 0.321 Test Loss: 63.486 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.1172165870666504
Epoch: 24, Steps: 32 | Train Loss: 0.574 Vali Loss: 51.995 Vali Acc: 0.527 Test Loss: 51.995 Test Acc: 0.527
Validation loss decreased (-0.503201 --> -0.526198).  Saving model ...
Epoch: 25 cost time: 2.7019245624542236
Epoch: 25, Steps: 32 | Train Loss: 0.730 Vali Loss: 56.998 Vali Acc: 0.504 Test Loss: 56.998 Test Acc: 0.504
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9171345233917236
Epoch: 26, Steps: 32 | Train Loss: 0.015 Vali Loss: 52.681 Vali Acc: 0.542 Test Loss: 52.681 Test Acc: 0.542
Validation loss decreased (-0.526198 --> -0.541458).  Saving model ...
Epoch: 27 cost time: 3.195681571960449
Epoch: 27, Steps: 32 | Train Loss: 0.000 Vali Loss: 54.624 Vali Acc: 0.534 Test Loss: 54.624 Test Acc: 0.534
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.123927116394043
Epoch: 28, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.360 Vali Acc: 0.565 Test Loss: 53.360 Test Acc: 0.565
Validation loss decreased (-0.541458 --> -0.564352).  Saving model ...
Epoch: 29 cost time: 3.272902011871338
Epoch: 29, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.186 Vali Acc: 0.565 Test Loss: 53.186 Test Acc: 0.565
Validation loss decreased (-0.564352 --> -0.564354).  Saving model ...
Epoch: 30 cost time: 4.343003273010254
Epoch: 30, Steps: 32 | Train Loss: 0.000 Vali Loss: 53.180 Vali Acc: 0.565 Test Loss: 53.180 Test Acc: 0.565
Validation loss decreased (-0.564354 --> -0.564354).  Saving model ...
Epoch: 31 cost time: 4.034290790557861
Epoch: 31, Steps: 32 | Train Loss: 0.001 Vali Loss: 62.772 Vali Acc: 0.427 Test Loss: 62.772 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.993246078491211
Epoch: 32, Steps: 32 | Train Loss: 0.334 Vali Loss: 56.688 Vali Acc: 0.557 Test Loss: 56.688 Test Acc: 0.557
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.389082908630371
Epoch: 33, Steps: 32 | Train Loss: 1.572 Vali Loss: 57.159 Vali Acc: 0.527 Test Loss: 57.159 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.0989913940429688
Epoch: 34, Steps: 32 | Train Loss: 0.769 Vali Loss: 67.618 Vali Acc: 0.496 Test Loss: 67.618 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.9637656211853027
Epoch: 35, Steps: 32 | Train Loss: 1.825 Vali Loss: 72.908 Vali Acc: 0.504 Test Loss: 72.908 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.557882785797119
Epoch: 36, Steps: 32 | Train Loss: 1.698 Vali Loss: 71.994 Vali Acc: 0.481 Test Loss: 71.994 Test Acc: 0.481
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.2247531414031982
Epoch: 37, Steps: 32 | Train Loss: 2.516 Vali Loss: 76.049 Vali Acc: 0.534 Test Loss: 76.049 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.4257938861846924
Epoch: 38, Steps: 32 | Train Loss: 1.526 Vali Loss: 77.549 Vali Acc: 0.542 Test Loss: 77.549 Test Acc: 0.542
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.7507450580596924
Epoch: 39, Steps: 32 | Train Loss: 0.637 Vali Loss: 81.909 Vali Acc: 0.519 Test Loss: 81.909 Test Acc: 0.519
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.2008907794952393
Epoch: 40, Steps: 32 | Train Loss: 0.830 Vali Loss: 89.376 Vali Acc: 0.534 Test Loss: 89.376 Test Acc: 0.534
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2913645
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.2051496505737305
Epoch: 1, Steps: 32 | Train Loss: 5.215 Vali Loss: 5.791 Vali Acc: 0.420 Test Loss: 5.791 Test Acc: 0.420
Validation loss decreased (inf --> -0.419789).  Saving model ...
Epoch: 2 cost time: 2.4562888145446777
Epoch: 2, Steps: 32 | Train Loss: 4.290 Vali Loss: 8.228 Vali Acc: 0.214 Test Loss: 8.228 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9784061908721924
Epoch: 3, Steps: 32 | Train Loss: 8.180 Vali Loss: 11.884 Vali Acc: 0.420 Test Loss: 11.884 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7964069843292236
Epoch: 4, Steps: 32 | Train Loss: 9.696 Vali Loss: 13.450 Vali Acc: 0.427 Test Loss: 13.450 Test Acc: 0.427
Validation loss decreased (-0.419789 --> -0.427346).  Saving model ...
Epoch: 5 cost time: 2.8490347862243652
Epoch: 5, Steps: 32 | Train Loss: 7.474 Vali Loss: 26.672 Vali Acc: 0.191 Test Loss: 26.672 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.387132406234741
Epoch: 6, Steps: 32 | Train Loss: 11.918 Vali Loss: 25.944 Vali Acc: 0.168 Test Loss: 25.944 Test Acc: 0.168
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6489157676696777
Epoch: 7, Steps: 32 | Train Loss: 12.474 Vali Loss: 26.507 Vali Acc: 0.290 Test Loss: 26.507 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6175830364227295
Epoch: 8, Steps: 32 | Train Loss: 22.458 Vali Loss: 20.550 Vali Acc: 0.260 Test Loss: 20.550 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.0074729919433594
Epoch: 9, Steps: 32 | Train Loss: 12.783 Vali Loss: 21.018 Vali Acc: 0.168 Test Loss: 21.018 Test Acc: 0.168
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5308682918548584
Epoch: 10, Steps: 32 | Train Loss: 12.756 Vali Loss: 21.464 Vali Acc: 0.244 Test Loss: 21.464 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6945815086364746
Epoch: 11, Steps: 32 | Train Loss: 17.587 Vali Loss: 17.989 Vali Acc: 0.305 Test Loss: 17.989 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.977191925048828
Epoch: 12, Steps: 32 | Train Loss: 19.800 Vali Loss: 21.785 Vali Acc: 0.183 Test Loss: 21.785 Test Acc: 0.183
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.834338665008545
Epoch: 13, Steps: 32 | Train Loss: 9.173 Vali Loss: 10.685 Vali Acc: 0.298 Test Loss: 10.685 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.7260072231292725
Epoch: 14, Steps: 32 | Train Loss: 13.796 Vali Loss: 44.044 Vali Acc: 0.435 Test Loss: 44.044 Test Acc: 0.435
Validation loss decreased (-0.427346 --> -0.434674).  Saving model ...
Epoch: 15 cost time: 3.2240147590637207
Epoch: 15, Steps: 32 | Train Loss: 16.820 Vali Loss: 34.408 Vali Acc: 0.282 Test Loss: 34.408 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2279820442199707
Epoch: 16, Steps: 32 | Train Loss: 7.265 Vali Loss: 28.125 Vali Acc: 0.618 Test Loss: 28.125 Test Acc: 0.618
Validation loss decreased (-0.434674 --> -0.618039).  Saving model ...
Epoch: 17 cost time: 2.8827407360076904
Epoch: 17, Steps: 32 | Train Loss: 4.804 Vali Loss: 57.501 Vali Acc: 0.206 Test Loss: 57.501 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.702930212020874
Epoch: 18, Steps: 32 | Train Loss: 5.016 Vali Loss: 32.499 Vali Acc: 0.435 Test Loss: 32.499 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.9769623279571533
Epoch: 19, Steps: 32 | Train Loss: 2.785 Vali Loss: 40.575 Vali Acc: 0.366 Test Loss: 40.575 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8543975353240967
Epoch: 20, Steps: 32 | Train Loss: 0.501 Vali Loss: 31.535 Vali Acc: 0.435 Test Loss: 31.535 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1210310459136963
Epoch: 21, Steps: 32 | Train Loss: 0.647 Vali Loss: 36.618 Vali Acc: 0.565 Test Loss: 36.618 Test Acc: 0.565
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.7882001399993896
Epoch: 22, Steps: 32 | Train Loss: 1.025 Vali Loss: 35.517 Vali Acc: 0.282 Test Loss: 35.517 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8660361766815186
Epoch: 23, Steps: 32 | Train Loss: 0.272 Vali Loss: 47.159 Vali Acc: 0.550 Test Loss: 47.159 Test Acc: 0.550
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.140011787414551
Epoch: 24, Steps: 32 | Train Loss: 0.303 Vali Loss: 37.096 Vali Acc: 0.466 Test Loss: 37.096 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.246224880218506
Epoch: 25, Steps: 32 | Train Loss: 0.458 Vali Loss: 49.944 Vali Acc: 0.527 Test Loss: 49.944 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.781712770462036
Epoch: 26, Steps: 32 | Train Loss: 0.184 Vali Loss: 32.334 Vali Acc: 0.557 Test Loss: 32.334 Test Acc: 0.557
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6183206106870229
model parameter : 2913645
model size : 13.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.651326894760132
Epoch: 1, Steps: 32 | Train Loss: 4.415 Vali Loss: 4.035 Vali Acc: 0.473 Test Loss: 4.035 Test Acc: 0.473
Validation loss decreased (inf --> -0.473242).  Saving model ...
Epoch: 2 cost time: 3.4558024406433105
Epoch: 2, Steps: 32 | Train Loss: 3.321 Vali Loss: 9.309 Vali Acc: 0.198 Test Loss: 9.309 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0894546508789062
Epoch: 3, Steps: 32 | Train Loss: 10.281 Vali Loss: 7.974 Vali Acc: 0.565 Test Loss: 7.974 Test Acc: 0.565
Validation loss decreased (-0.473242 --> -0.564806).  Saving model ...
Epoch: 4 cost time: 3.09035062789917
Epoch: 4, Steps: 32 | Train Loss: 5.000 Vali Loss: 14.954 Vali Acc: 0.214 Test Loss: 14.954 Test Acc: 0.214
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.187537670135498
Epoch: 5, Steps: 32 | Train Loss: 7.433 Vali Loss: 10.790 Vali Acc: 0.282 Test Loss: 10.790 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4363505840301514
Epoch: 6, Steps: 32 | Train Loss: 3.397 Vali Loss: 11.567 Vali Acc: 0.481 Test Loss: 11.567 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.149806261062622
Epoch: 7, Steps: 32 | Train Loss: 5.182 Vali Loss: 13.357 Vali Acc: 0.382 Test Loss: 13.357 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.00926399230957
Epoch: 8, Steps: 32 | Train Loss: 5.186 Vali Loss: 25.969 Vali Acc: 0.481 Test Loss: 25.969 Test Acc: 0.481
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.196398973464966
Epoch: 9, Steps: 32 | Train Loss: 5.403 Vali Loss: 27.905 Vali Acc: 0.351 Test Loss: 27.905 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1043848991394043
Epoch: 10, Steps: 32 | Train Loss: 2.282 Vali Loss: 24.691 Vali Acc: 0.534 Test Loss: 24.691 Test Acc: 0.534
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1812188625335693
Epoch: 11, Steps: 32 | Train Loss: 11.860 Vali Loss: 27.544 Vali Acc: 0.405 Test Loss: 27.544 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3091251850128174
Epoch: 12, Steps: 32 | Train Loss: 6.967 Vali Loss: 36.382 Vali Acc: 0.290 Test Loss: 36.382 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.3154349327087402
Epoch: 13, Steps: 32 | Train Loss: 2.739 Vali Loss: 28.939 Vali Acc: 0.405 Test Loss: 28.939 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5648854961832062
model parameter : 2897261
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.73048210144043
Epoch: 1, Steps: 32 | Train Loss: 5.066 Vali Loss: 4.084 Vali Acc: 0.298 Test Loss: 4.084 Test Acc: 0.298
Validation loss decreased (inf --> -0.297669).  Saving model ...
Epoch: 2 cost time: 2.641242504119873
Epoch: 2, Steps: 32 | Train Loss: 3.388 Vali Loss: 8.610 Vali Acc: 0.115 Test Loss: 8.610 Test Acc: 0.115
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9825260639190674
Epoch: 3, Steps: 32 | Train Loss: 7.913 Vali Loss: 14.462 Vali Acc: 0.450 Test Loss: 14.462 Test Acc: 0.450
Validation loss decreased (-0.297669 --> -0.450237).  Saving model ...
Epoch: 4 cost time: 3.0690221786499023
Epoch: 4, Steps: 32 | Train Loss: 9.568 Vali Loss: 20.597 Vali Acc: 0.511 Test Loss: 20.597 Test Acc: 0.511
Validation loss decreased (-0.450237 --> -0.511244).  Saving model ...
Epoch: 5 cost time: 2.9579412937164307
Epoch: 5, Steps: 32 | Train Loss: 12.854 Vali Loss: 8.856 Vali Acc: 0.374 Test Loss: 8.856 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8531653881073
Epoch: 6, Steps: 32 | Train Loss: 5.460 Vali Loss: 6.632 Vali Acc: 0.450 Test Loss: 6.632 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.287470579147339
Epoch: 7, Steps: 32 | Train Loss: 5.373 Vali Loss: 16.599 Vali Acc: 0.489 Test Loss: 16.599 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8266377449035645
Epoch: 8, Steps: 32 | Train Loss: 4.652 Vali Loss: 26.716 Vali Acc: 0.481 Test Loss: 26.716 Test Acc: 0.481
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.912565231323242
Epoch: 9, Steps: 32 | Train Loss: 11.838 Vali Loss: 23.983 Vali Acc: 0.298 Test Loss: 23.983 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2934300899505615
Epoch: 10, Steps: 32 | Train Loss: 6.853 Vali Loss: 25.577 Vali Acc: 0.275 Test Loss: 25.577 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.245539665222168
Epoch: 11, Steps: 32 | Train Loss: 9.129 Vali Loss: 19.248 Vali Acc: 0.443 Test Loss: 19.248 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.373760938644409
Epoch: 12, Steps: 32 | Train Loss: 7.065 Vali Loss: 18.816 Vali Acc: 0.496 Test Loss: 18.816 Test Acc: 0.496
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.238621473312378
Epoch: 13, Steps: 32 | Train Loss: 7.244 Vali Loss: 36.370 Vali Acc: 0.305 Test Loss: 36.370 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.1976969242095947
Epoch: 14, Steps: 32 | Train Loss: 2.080 Vali Loss: 38.859 Vali Acc: 0.305 Test Loss: 38.859 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2897261
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.742263078689575
Epoch: 1, Steps: 32 | Train Loss: 4.659 Vali Loss: 3.286 Vali Acc: 0.427 Test Loss: 3.286 Test Acc: 0.427
Validation loss decreased (inf --> -0.427448).  Saving model ...
Epoch: 2 cost time: 3.326111316680908
Epoch: 2, Steps: 32 | Train Loss: 3.448 Vali Loss: 8.773 Vali Acc: 0.107 Test Loss: 8.773 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.040379047393799
Epoch: 3, Steps: 32 | Train Loss: 4.900 Vali Loss: 11.642 Vali Acc: 0.443 Test Loss: 11.642 Test Acc: 0.443
Validation loss decreased (-0.427448 --> -0.442632).  Saving model ...
Epoch: 4 cost time: 3.073084831237793
Epoch: 4, Steps: 32 | Train Loss: 2.967 Vali Loss: 18.567 Vali Acc: 0.191 Test Loss: 18.567 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.00223970413208
Epoch: 5, Steps: 32 | Train Loss: 5.492 Vali Loss: 12.983 Vali Acc: 0.336 Test Loss: 12.983 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8134076595306396
Epoch: 6, Steps: 32 | Train Loss: 4.612 Vali Loss: 20.129 Vali Acc: 0.427 Test Loss: 20.129 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0891947746276855
Epoch: 7, Steps: 32 | Train Loss: 14.631 Vali Loss: 23.432 Vali Acc: 0.435 Test Loss: 23.432 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1111860275268555
Epoch: 8, Steps: 32 | Train Loss: 6.106 Vali Loss: 20.171 Vali Acc: 0.366 Test Loss: 20.171 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2097392082214355
Epoch: 9, Steps: 32 | Train Loss: 4.787 Vali Loss: 20.560 Vali Acc: 0.511 Test Loss: 20.560 Test Acc: 0.511
Validation loss decreased (-0.442632 --> -0.511245).  Saving model ...
Epoch: 10 cost time: 2.910832166671753
Epoch: 10, Steps: 32 | Train Loss: 7.215 Vali Loss: 30.266 Vali Acc: 0.275 Test Loss: 30.266 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2616753578186035
Epoch: 11, Steps: 32 | Train Loss: 7.335 Vali Loss: 25.458 Vali Acc: 0.305 Test Loss: 25.458 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7595434188842773
Epoch: 12, Steps: 32 | Train Loss: 12.177 Vali Loss: 22.074 Vali Acc: 0.481 Test Loss: 22.074 Test Acc: 0.481
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.485600233078003
Epoch: 13, Steps: 32 | Train Loss: 8.539 Vali Loss: 16.982 Vali Acc: 0.412 Test Loss: 16.982 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.129312038421631
Epoch: 14, Steps: 32 | Train Loss: 9.280 Vali Loss: 30.705 Vali Acc: 0.229 Test Loss: 30.705 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8907523155212402
Epoch: 15, Steps: 32 | Train Loss: 13.008 Vali Loss: 18.704 Vali Acc: 0.534 Test Loss: 18.704 Test Acc: 0.534
Validation loss decreased (-0.511245 --> -0.534164).  Saving model ...
Epoch: 16 cost time: 3.0219948291778564
Epoch: 16, Steps: 32 | Train Loss: 3.148 Vali Loss: 16.489 Vali Acc: 0.496 Test Loss: 16.489 Test Acc: 0.496
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6391046047210693
Epoch: 17, Steps: 32 | Train Loss: 4.528 Vali Loss: 19.729 Vali Acc: 0.519 Test Loss: 19.729 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.7801873683929443
Epoch: 18, Steps: 32 | Train Loss: 2.268 Vali Loss: 25.579 Vali Acc: 0.450 Test Loss: 25.579 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.165191888809204
Epoch: 19, Steps: 32 | Train Loss: 1.481 Vali Loss: 21.746 Vali Acc: 0.496 Test Loss: 21.746 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3394393920898438
Epoch: 20, Steps: 32 | Train Loss: 2.836 Vali Loss: 21.911 Vali Acc: 0.534 Test Loss: 21.911 Test Acc: 0.534
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.228872776031494
Epoch: 21, Steps: 32 | Train Loss: 0.636 Vali Loss: 28.352 Vali Acc: 0.496 Test Loss: 28.352 Test Acc: 0.496
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.548043966293335
Epoch: 22, Steps: 32 | Train Loss: 2.599 Vali Loss: 58.861 Vali Acc: 0.557 Test Loss: 58.861 Test Acc: 0.557
Validation loss decreased (-0.534164 --> -0.556663).  Saving model ...
Epoch: 23 cost time: 3.073669195175171
Epoch: 23, Steps: 32 | Train Loss: 1.275 Vali Loss: 61.464 Vali Acc: 0.550 Test Loss: 61.464 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.957594871520996
Epoch: 24, Steps: 32 | Train Loss: 3.871 Vali Loss: 83.886 Vali Acc: 0.229 Test Loss: 83.886 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4185028076171875
Epoch: 25, Steps: 32 | Train Loss: 10.396 Vali Loss: 102.056 Vali Acc: 0.298 Test Loss: 102.056 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9087047576904297
Epoch: 26, Steps: 32 | Train Loss: 6.067 Vali Loss: 65.970 Vali Acc: 0.496 Test Loss: 65.970 Test Acc: 0.496
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.364223003387451
Epoch: 27, Steps: 32 | Train Loss: 1.294 Vali Loss: 63.338 Vali Acc: 0.580 Test Loss: 63.338 Test Acc: 0.580
Validation loss decreased (-0.556663 --> -0.579519).  Saving model ...
Epoch: 28 cost time: 3.7091047763824463
Epoch: 28, Steps: 32 | Train Loss: 0.362 Vali Loss: 72.643 Vali Acc: 0.580 Test Loss: 72.643 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9492452144622803
Epoch: 29, Steps: 32 | Train Loss: 0.044 Vali Loss: 71.185 Vali Acc: 0.527 Test Loss: 71.185 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.651843786239624
Epoch: 30, Steps: 32 | Train Loss: 0.835 Vali Loss: 76.751 Vali Acc: 0.550 Test Loss: 76.751 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.078138589859009
Epoch: 31, Steps: 32 | Train Loss: 2.691 Vali Loss: 87.024 Vali Acc: 0.580 Test Loss: 87.024 Test Acc: 0.580
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.084871292114258
Epoch: 32, Steps: 32 | Train Loss: 2.481 Vali Loss: 88.286 Vali Acc: 0.504 Test Loss: 88.286 Test Acc: 0.504
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.265737533569336
Epoch: 33, Steps: 32 | Train Loss: 3.695 Vali Loss: 80.386 Vali Acc: 0.542 Test Loss: 80.386 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.304755926132202
Epoch: 34, Steps: 32 | Train Loss: 1.037 Vali Loss: 44.101 Vali Acc: 0.611 Test Loss: 44.101 Test Acc: 0.611
Validation loss decreased (-0.579519 --> -0.610246).  Saving model ...
Epoch: 35 cost time: 3.4061102867126465
Epoch: 35, Steps: 32 | Train Loss: 0.839 Vali Loss: 49.962 Vali Acc: 0.580 Test Loss: 49.962 Test Acc: 0.580
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.130124568939209
Epoch: 36, Steps: 32 | Train Loss: 0.154 Vali Loss: 54.819 Vali Acc: 0.542 Test Loss: 54.819 Test Acc: 0.542
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.158459424972534
Epoch: 37, Steps: 32 | Train Loss: 0.000 Vali Loss: 59.504 Vali Acc: 0.519 Test Loss: 59.504 Test Acc: 0.519
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.097677230834961
Epoch: 38, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.653 Vali Acc: 0.527 Test Loss: 58.653 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.895132541656494
Epoch: 39, Steps: 32 | Train Loss: 0.000 Vali Loss: 58.466 Vali Acc: 0.527 Test Loss: 58.466 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.9766054153442383
Epoch: 40, Steps: 32 | Train Loss: 0.236 Vali Loss: 48.888 Vali Acc: 0.588 Test Loss: 48.888 Test Acc: 0.588
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.0296080112457275
Epoch: 41, Steps: 32 | Train Loss: 0.000 Vali Loss: 56.566 Vali Acc: 0.565 Test Loss: 56.566 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.9709699153900146
Epoch: 42, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.115 Vali Acc: 0.557 Test Loss: 57.115 Test Acc: 0.557
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.5365710258483887
Epoch: 43, Steps: 32 | Train Loss: 0.000 Vali Loss: 57.135 Vali Acc: 0.557 Test Loss: 57.135 Test Acc: 0.557
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.016002893447876
Epoch: 44, Steps: 32 | Train Loss: 0.362 Vali Loss: 48.539 Vali Acc: 0.595 Test Loss: 48.539 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6106870229007634
model parameter : 2897261
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.421057462692261
Epoch: 1, Steps: 32 | Train Loss: 4.124 Vali Loss: 4.759 Vali Acc: 0.450 Test Loss: 4.759 Test Acc: 0.450
Validation loss decreased (inf --> -0.450334).  Saving model ...
Epoch: 2 cost time: 3.549379825592041
Epoch: 2, Steps: 32 | Train Loss: 4.960 Vali Loss: 10.761 Vali Acc: 0.420 Test Loss: 10.761 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9823317527770996
Epoch: 3, Steps: 32 | Train Loss: 9.974 Vali Loss: 8.210 Vali Acc: 0.489 Test Loss: 8.210 Test Acc: 0.489
Validation loss decreased (-0.450334 --> -0.488468).  Saving model ...
Epoch: 4 cost time: 3.2211132049560547
Epoch: 4, Steps: 32 | Train Loss: 10.640 Vali Loss: 17.283 Vali Acc: 0.359 Test Loss: 17.283 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.129611015319824
Epoch: 5, Steps: 32 | Train Loss: 11.173 Vali Loss: 11.965 Vali Acc: 0.458 Test Loss: 11.965 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.875554084777832
Epoch: 6, Steps: 32 | Train Loss: 16.049 Vali Loss: 9.976 Vali Acc: 0.336 Test Loss: 9.976 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.3990962505340576
Epoch: 7, Steps: 32 | Train Loss: 10.789 Vali Loss: 23.348 Vali Acc: 0.168 Test Loss: 23.348 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8922598361968994
Epoch: 8, Steps: 32 | Train Loss: 17.459 Vali Loss: 35.610 Vali Acc: 0.405 Test Loss: 35.610 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.96250581741333
Epoch: 9, Steps: 32 | Train Loss: 14.458 Vali Loss: 38.532 Vali Acc: 0.229 Test Loss: 38.532 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.5494930744171143
Epoch: 10, Steps: 32 | Train Loss: 13.538 Vali Loss: 38.992 Vali Acc: 0.122 Test Loss: 38.992 Test Acc: 0.122
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.283358335494995
Epoch: 11, Steps: 32 | Train Loss: 12.756 Vali Loss: 40.974 Vali Acc: 0.206 Test Loss: 40.974 Test Acc: 0.206
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.627589225769043
Epoch: 12, Steps: 32 | Train Loss: 15.024 Vali Loss: 36.263 Vali Acc: 0.183 Test Loss: 36.263 Test Acc: 0.183
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.2602694034576416
Epoch: 13, Steps: 32 | Train Loss: 13.324 Vali Loss: 32.603 Vali Acc: 0.412 Test Loss: 32.603 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 2897261
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.6652748584747314
Epoch: 1, Steps: 32 | Train Loss: 4.383 Vali Loss: 6.487 Vali Acc: 0.450 Test Loss: 6.487 Test Acc: 0.450
Validation loss decreased (inf --> -0.450317).  Saving model ...
Epoch: 2 cost time: 3.53940749168396
Epoch: 2, Steps: 32 | Train Loss: 6.789 Vali Loss: 9.193 Vali Acc: 0.489 Test Loss: 9.193 Test Acc: 0.489
Validation loss decreased (-0.450317 --> -0.488458).  Saving model ...
Epoch: 3 cost time: 3.2410850524902344
Epoch: 3, Steps: 32 | Train Loss: 4.065 Vali Loss: 7.916 Vali Acc: 0.313 Test Loss: 7.916 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.7011380195617676
Epoch: 4, Steps: 32 | Train Loss: 2.693 Vali Loss: 7.902 Vali Acc: 0.374 Test Loss: 7.902 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.446775436401367
Epoch: 5, Steps: 32 | Train Loss: 10.037 Vali Loss: 18.609 Vali Acc: 0.405 Test Loss: 18.609 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.6122982501983643
Epoch: 6, Steps: 32 | Train Loss: 5.927 Vali Loss: 17.122 Vali Acc: 0.466 Test Loss: 17.122 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.639758586883545
Epoch: 7, Steps: 32 | Train Loss: 4.921 Vali Loss: 14.152 Vali Acc: 0.305 Test Loss: 14.152 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.143477201461792
Epoch: 8, Steps: 32 | Train Loss: 2.964 Vali Loss: 16.642 Vali Acc: 0.466 Test Loss: 16.642 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.2527291774749756
Epoch: 9, Steps: 32 | Train Loss: 5.707 Vali Loss: 24.993 Vali Acc: 0.275 Test Loss: 24.993 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.475008964538574
Epoch: 10, Steps: 32 | Train Loss: 2.035 Vali Loss: 24.902 Vali Acc: 0.435 Test Loss: 24.902 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.183699131011963
Epoch: 11, Steps: 32 | Train Loss: 15.333 Vali Loss: 38.764 Vali Acc: 0.359 Test Loss: 38.764 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.4675941467285156
Epoch: 12, Steps: 32 | Train Loss: 12.787 Vali Loss: 39.704 Vali Acc: 0.275 Test Loss: 39.704 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 2889069
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.024242639541626
Epoch: 1, Steps: 32 | Train Loss: 4.333 Vali Loss: 6.304 Vali Acc: 0.412 Test Loss: 6.304 Test Acc: 0.412
Validation loss decreased (inf --> -0.412151).  Saving model ...
Epoch: 2 cost time: 2.9811744689941406
Epoch: 2, Steps: 32 | Train Loss: 5.789 Vali Loss: 18.168 Vali Acc: 0.191 Test Loss: 18.168 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.440366506576538
Epoch: 3, Steps: 32 | Train Loss: 6.024 Vali Loss: 5.113 Vali Acc: 0.405 Test Loss: 5.113 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0421833992004395
Epoch: 4, Steps: 32 | Train Loss: 3.956 Vali Loss: 11.680 Vali Acc: 0.328 Test Loss: 11.680 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2324790954589844
Epoch: 5, Steps: 32 | Train Loss: 8.959 Vali Loss: 9.278 Vali Acc: 0.275 Test Loss: 9.278 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5565338134765625
Epoch: 6, Steps: 32 | Train Loss: 5.104 Vali Loss: 13.044 Vali Acc: 0.519 Test Loss: 13.044 Test Acc: 0.519
Validation loss decreased (-0.412151 --> -0.518954).  Saving model ...
Epoch: 7 cost time: 3.5828354358673096
Epoch: 7, Steps: 32 | Train Loss: 5.104 Vali Loss: 28.742 Vali Acc: 0.359 Test Loss: 28.742 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9958274364471436
Epoch: 8, Steps: 32 | Train Loss: 3.981 Vali Loss: 22.705 Vali Acc: 0.504 Test Loss: 22.705 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1222915649414062
Epoch: 9, Steps: 32 | Train Loss: 12.379 Vali Loss: 29.739 Vali Acc: 0.252 Test Loss: 29.739 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0665488243103027
Epoch: 10, Steps: 32 | Train Loss: 9.329 Vali Loss: 34.230 Vali Acc: 0.168 Test Loss: 34.230 Test Acc: 0.168
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3622639179229736
Epoch: 11, Steps: 32 | Train Loss: 9.579 Vali Loss: 32.544 Vali Acc: 0.282 Test Loss: 32.544 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1449778079986572
Epoch: 12, Steps: 32 | Train Loss: 9.755 Vali Loss: 29.912 Vali Acc: 0.267 Test Loss: 29.912 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.833251714706421
Epoch: 13, Steps: 32 | Train Loss: 7.378 Vali Loss: 28.971 Vali Acc: 0.405 Test Loss: 28.971 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.021955728530884
Epoch: 14, Steps: 32 | Train Loss: 1.400 Vali Loss: 22.695 Vali Acc: 0.366 Test Loss: 22.695 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.132490634918213
Epoch: 15, Steps: 32 | Train Loss: 2.490 Vali Loss: 36.901 Vali Acc: 0.328 Test Loss: 36.901 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.271029472351074
Epoch: 16, Steps: 32 | Train Loss: 13.186 Vali Loss: 43.516 Vali Acc: 0.275 Test Loss: 43.516 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 2889069
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.784570693969727
Epoch: 1, Steps: 32 | Train Loss: 4.254 Vali Loss: 4.598 Vali Acc: 0.435 Test Loss: 4.598 Test Acc: 0.435
Validation loss decreased (inf --> -0.435069).  Saving model ...
Epoch: 2 cost time: 2.745394229888916
Epoch: 2, Steps: 32 | Train Loss: 4.865 Vali Loss: 7.545 Vali Acc: 0.412 Test Loss: 7.545 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.870760440826416
Epoch: 3, Steps: 32 | Train Loss: 4.437 Vali Loss: 8.696 Vali Acc: 0.237 Test Loss: 8.696 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.411848545074463
Epoch: 4, Steps: 32 | Train Loss: 6.066 Vali Loss: 4.995 Vali Acc: 0.321 Test Loss: 4.995 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1909193992614746
Epoch: 5, Steps: 32 | Train Loss: 8.044 Vali Loss: 8.944 Vali Acc: 0.420 Test Loss: 8.944 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.5311439037323
Epoch: 6, Steps: 32 | Train Loss: 4.233 Vali Loss: 36.160 Vali Acc: 0.374 Test Loss: 36.160 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.29111647605896
Epoch: 7, Steps: 32 | Train Loss: 8.258 Vali Loss: 40.936 Vali Acc: 0.198 Test Loss: 40.936 Test Acc: 0.198
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.7659430503845215
Epoch: 8, Steps: 32 | Train Loss: 9.830 Vali Loss: 40.593 Vali Acc: 0.275 Test Loss: 40.593 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.6748759746551514
Epoch: 9, Steps: 32 | Train Loss: 17.214 Vali Loss: 51.186 Vali Acc: 0.160 Test Loss: 51.186 Test Acc: 0.160
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.492750883102417
Epoch: 10, Steps: 32 | Train Loss: 8.031 Vali Loss: 39.202 Vali Acc: 0.168 Test Loss: 39.202 Test Acc: 0.168
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8885905742645264
Epoch: 11, Steps: 32 | Train Loss: 10.317 Vali Loss: 54.676 Vali Acc: 0.237 Test Loss: 54.676 Test Acc: 0.237
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 2889069
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.117490291595459
Epoch: 1, Steps: 32 | Train Loss: 4.544 Vali Loss: 6.589 Vali Acc: 0.435 Test Loss: 6.589 Test Acc: 0.435
Validation loss decreased (inf --> -0.435049).  Saving model ...
Epoch: 2 cost time: 3.3291826248168945
Epoch: 2, Steps: 32 | Train Loss: 5.221 Vali Loss: 12.532 Vali Acc: 0.450 Test Loss: 12.532 Test Acc: 0.450
Validation loss decreased (-0.435049 --> -0.450256).  Saving model ...
Epoch: 3 cost time: 3.454657793045044
Epoch: 3, Steps: 32 | Train Loss: 12.508 Vali Loss: 11.107 Vali Acc: 0.183 Test Loss: 11.107 Test Acc: 0.183
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9909698963165283
Epoch: 4, Steps: 32 | Train Loss: 13.366 Vali Loss: 11.873 Vali Acc: 0.290 Test Loss: 11.873 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.261676073074341
Epoch: 5, Steps: 32 | Train Loss: 8.142 Vali Loss: 14.577 Vali Acc: 0.450 Test Loss: 14.577 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0875747203826904
Epoch: 6, Steps: 32 | Train Loss: 13.302 Vali Loss: 18.513 Vali Acc: 0.336 Test Loss: 18.513 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.741478681564331
Epoch: 7, Steps: 32 | Train Loss: 16.160 Vali Loss: 12.566 Vali Acc: 0.221 Test Loss: 12.566 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.953514337539673
Epoch: 8, Steps: 32 | Train Loss: 14.899 Vali Loss: 21.556 Vali Acc: 0.145 Test Loss: 21.556 Test Acc: 0.145
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.8877127170562744
Epoch: 9, Steps: 32 | Train Loss: 19.330 Vali Loss: 42.595 Vali Acc: 0.183 Test Loss: 42.595 Test Acc: 0.183
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.6472108364105225
Epoch: 10, Steps: 32 | Train Loss: 15.805 Vali Loss: 45.215 Vali Acc: 0.168 Test Loss: 45.215 Test Acc: 0.168
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.6286702156066895
Epoch: 11, Steps: 32 | Train Loss: 31.060 Vali Loss: 38.904 Vali Acc: 0.206 Test Loss: 38.904 Test Acc: 0.206
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.1824686527252197
Epoch: 12, Steps: 32 | Train Loss: 17.346 Vali Loss: 43.671 Vali Acc: 0.221 Test Loss: 43.671 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 2889069
model size : 13.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.036508321762085
Epoch: 1, Steps: 32 | Train Loss: 4.350 Vali Loss: 2.447 Vali Acc: 0.443 Test Loss: 2.447 Test Acc: 0.443
Validation loss decreased (inf --> -0.442724).  Saving model ...
Epoch: 2 cost time: 3.4449260234832764
Epoch: 2, Steps: 32 | Train Loss: 4.272 Vali Loss: 7.272 Vali Acc: 0.275 Test Loss: 7.272 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7893874645233154
Epoch: 3, Steps: 32 | Train Loss: 6.686 Vali Loss: 10.192 Vali Acc: 0.435 Test Loss: 10.192 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.286388874053955
Epoch: 4, Steps: 32 | Train Loss: 7.934 Vali Loss: 20.667 Vali Acc: 0.252 Test Loss: 20.667 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2946462631225586
Epoch: 5, Steps: 32 | Train Loss: 8.121 Vali Loss: 10.922 Vali Acc: 0.267 Test Loss: 10.922 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3886234760284424
Epoch: 6, Steps: 32 | Train Loss: 7.049 Vali Loss: 19.777 Vali Acc: 0.427 Test Loss: 19.777 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4618916511535645
Epoch: 7, Steps: 32 | Train Loss: 7.013 Vali Loss: 14.373 Vali Acc: 0.328 Test Loss: 14.373 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.8379695415496826
Epoch: 8, Steps: 32 | Train Loss: 3.781 Vali Loss: 21.893 Vali Acc: 0.427 Test Loss: 21.893 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.702802896499634
Epoch: 9, Steps: 32 | Train Loss: 3.729 Vali Loss: 23.368 Vali Acc: 0.443 Test Loss: 23.368 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.867096185684204
Epoch: 10, Steps: 32 | Train Loss: 6.647 Vali Loss: 22.272 Vali Acc: 0.344 Test Loss: 22.272 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.8121178150177
Epoch: 11, Steps: 32 | Train Loss: 5.600 Vali Loss: 18.558 Vali Acc: 0.504 Test Loss: 18.558 Test Acc: 0.504
Validation loss decreased (-0.442724 --> -0.503631).  Saving model ...
Epoch: 12 cost time: 3.128035306930542
Epoch: 12, Steps: 32 | Train Loss: 5.766 Vali Loss: 22.870 Vali Acc: 0.366 Test Loss: 22.870 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.516239643096924
Epoch: 13, Steps: 32 | Train Loss: 1.683 Vali Loss: 23.611 Vali Acc: 0.382 Test Loss: 23.611 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.289426803588867
Epoch: 14, Steps: 32 | Train Loss: 2.165 Vali Loss: 31.333 Vali Acc: 0.305 Test Loss: 31.333 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2725796699523926
Epoch: 15, Steps: 32 | Train Loss: 4.818 Vali Loss: 31.378 Vali Acc: 0.313 Test Loss: 31.378 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.562321186065674
Epoch: 16, Steps: 32 | Train Loss: 10.892 Vali Loss: 48.204 Vali Acc: 0.260 Test Loss: 48.204 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3183794021606445
Epoch: 17, Steps: 32 | Train Loss: 2.534 Vali Loss: 38.744 Vali Acc: 0.336 Test Loss: 38.744 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.8074448108673096
Epoch: 18, Steps: 32 | Train Loss: 9.019 Vali Loss: 30.974 Vali Acc: 0.359 Test Loss: 30.974 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.817734956741333
Epoch: 19, Steps: 32 | Train Loss: 1.538 Vali Loss: 45.921 Vali Acc: 0.298 Test Loss: 45.921 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3806140422821045
Epoch: 20, Steps: 32 | Train Loss: 2.618 Vali Loss: 41.551 Vali Acc: 0.496 Test Loss: 41.551 Test Acc: 0.496
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.367759943008423
Epoch: 21, Steps: 32 | Train Loss: 4.101 Vali Loss: 38.288 Vali Acc: 0.519 Test Loss: 38.288 Test Acc: 0.519
Validation loss decreased (-0.503631 --> -0.518701).  Saving model ...
Epoch: 22 cost time: 3.329331874847412
Epoch: 22, Steps: 32 | Train Loss: 0.184 Vali Loss: 33.952 Vali Acc: 0.382 Test Loss: 33.952 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5327465534210205
Epoch: 23, Steps: 32 | Train Loss: 0.577 Vali Loss: 40.957 Vali Acc: 0.519 Test Loss: 40.957 Test Acc: 0.519
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.3130500316619873
Epoch: 24, Steps: 32 | Train Loss: 1.170 Vali Loss: 38.473 Vali Acc: 0.359 Test Loss: 38.473 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1963765621185303
Epoch: 25, Steps: 32 | Train Loss: 0.516 Vali Loss: 58.188 Vali Acc: 0.534 Test Loss: 58.188 Test Acc: 0.534
Validation loss decreased (-0.518701 --> -0.533769).  Saving model ...
Epoch: 26 cost time: 3.444323778152466
Epoch: 26, Steps: 32 | Train Loss: 5.045 Vali Loss: 44.087 Vali Acc: 0.542 Test Loss: 44.087 Test Acc: 0.542
Validation loss decreased (-0.533769 --> -0.541544).  Saving model ...
Epoch: 27 cost time: 3.409230947494507
Epoch: 27, Steps: 32 | Train Loss: 4.503 Vali Loss: 41.084 Vali Acc: 0.481 Test Loss: 41.084 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.430806875228882
Epoch: 28, Steps: 32 | Train Loss: 0.731 Vali Loss: 48.461 Vali Acc: 0.550 Test Loss: 48.461 Test Acc: 0.550
Validation loss decreased (-0.541544 --> -0.549134).  Saving model ...
Epoch: 29 cost time: 3.36971116065979
Epoch: 29, Steps: 32 | Train Loss: 0.639 Vali Loss: 43.783 Vali Acc: 0.527 Test Loss: 43.783 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.278602361679077
Epoch: 30, Steps: 32 | Train Loss: 0.762 Vali Loss: 46.307 Vali Acc: 0.504 Test Loss: 46.307 Test Acc: 0.504
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.443946599960327
Epoch: 31, Steps: 32 | Train Loss: 3.846 Vali Loss: 57.776 Vali Acc: 0.565 Test Loss: 57.776 Test Acc: 0.565
Validation loss decreased (-0.549134 --> -0.564308).  Saving model ...
Epoch: 32 cost time: 3.714376926422119
Epoch: 32, Steps: 32 | Train Loss: 1.176 Vali Loss: 50.380 Vali Acc: 0.626 Test Loss: 50.380 Test Acc: 0.626
Validation loss decreased (-0.564308 --> -0.625450).  Saving model ...
Epoch: 33 cost time: 3.790464162826538
Epoch: 33, Steps: 32 | Train Loss: 1.633 Vali Loss: 64.789 Vali Acc: 0.557 Test Loss: 64.789 Test Acc: 0.557
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.123237371444702
Epoch: 34, Steps: 32 | Train Loss: 0.650 Vali Loss: 74.652 Vali Acc: 0.527 Test Loss: 74.652 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.7070064544677734
Epoch: 35, Steps: 32 | Train Loss: 0.435 Vali Loss: 73.280 Vali Acc: 0.534 Test Loss: 73.280 Test Acc: 0.534
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.0386128425598145
Epoch: 36, Steps: 32 | Train Loss: 0.769 Vali Loss: 72.306 Vali Acc: 0.557 Test Loss: 72.306 Test Acc: 0.557
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.9691989421844482
Epoch: 37, Steps: 32 | Train Loss: 1.594 Vali Loss: 80.129 Vali Acc: 0.542 Test Loss: 80.129 Test Acc: 0.542
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.597616672515869
Epoch: 38, Steps: 32 | Train Loss: 0.033 Vali Loss: 83.326 Vali Acc: 0.542 Test Loss: 83.326 Test Acc: 0.542
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.949795961380005
Epoch: 39, Steps: 32 | Train Loss: 0.513 Vali Loss: 65.944 Vali Acc: 0.565 Test Loss: 65.944 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.536897897720337
Epoch: 40, Steps: 32 | Train Loss: 2.503 Vali Loss: 117.791 Vali Acc: 0.481 Test Loss: 117.791 Test Acc: 0.481
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.325190544128418
Epoch: 41, Steps: 32 | Train Loss: 0.617 Vali Loss: 122.089 Vali Acc: 0.542 Test Loss: 122.089 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.098390817642212
Epoch: 42, Steps: 32 | Train Loss: 0.220 Vali Loss: 107.653 Vali Acc: 0.550 Test Loss: 107.653 Test Acc: 0.550
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.6259541984732825
model parameter : 2884973
model size : 13.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.160832405090332
Epoch: 1, Steps: 32 | Train Loss: 3.991 Vali Loss: 2.881 Vali Acc: 0.290 Test Loss: 2.881 Test Acc: 0.290
Validation loss decreased (inf --> -0.290048).  Saving model ...
Epoch: 2 cost time: 2.9836299419403076
Epoch: 2, Steps: 32 | Train Loss: 5.884 Vali Loss: 8.487 Vali Acc: 0.443 Test Loss: 8.487 Test Acc: 0.443
Validation loss decreased (-0.290048 --> -0.442663).  Saving model ...
Epoch: 3 cost time: 3.146486759185791
Epoch: 3, Steps: 32 | Train Loss: 5.649 Vali Loss: 5.937 Vali Acc: 0.427 Test Loss: 5.937 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6146795749664307
Epoch: 4, Steps: 32 | Train Loss: 6.496 Vali Loss: 13.442 Vali Acc: 0.405 Test Loss: 13.442 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.328542709350586
Epoch: 5, Steps: 32 | Train Loss: 8.170 Vali Loss: 9.395 Vali Acc: 0.511 Test Loss: 9.395 Test Acc: 0.511
Validation loss decreased (-0.442663 --> -0.511356).  Saving model ...
Epoch: 6 cost time: 3.663242816925049
Epoch: 6, Steps: 32 | Train Loss: 3.082 Vali Loss: 20.585 Vali Acc: 0.176 Test Loss: 20.585 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.168400287628174
Epoch: 7, Steps: 32 | Train Loss: 4.350 Vali Loss: 23.518 Vali Acc: 0.328 Test Loss: 23.518 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7535223960876465
Epoch: 8, Steps: 32 | Train Loss: 11.692 Vali Loss: 29.528 Vali Acc: 0.473 Test Loss: 29.528 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.94077467918396
Epoch: 9, Steps: 32 | Train Loss: 9.743 Vali Loss: 18.553 Vali Acc: 0.412 Test Loss: 18.553 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3575172424316406
Epoch: 10, Steps: 32 | Train Loss: 8.406 Vali Loss: 22.420 Vali Acc: 0.382 Test Loss: 22.420 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.79685115814209
Epoch: 11, Steps: 32 | Train Loss: 4.787 Vali Loss: 28.009 Vali Acc: 0.214 Test Loss: 28.009 Test Acc: 0.214
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.713740587234497
Epoch: 12, Steps: 32 | Train Loss: 5.630 Vali Loss: 25.295 Vali Acc: 0.481 Test Loss: 25.295 Test Acc: 0.481
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.916982889175415
Epoch: 13, Steps: 32 | Train Loss: 2.709 Vali Loss: 28.249 Vali Acc: 0.313 Test Loss: 28.249 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.25203275680542
Epoch: 14, Steps: 32 | Train Loss: 7.179 Vali Loss: 21.911 Vali Acc: 0.450 Test Loss: 21.911 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.116208791732788
Epoch: 15, Steps: 32 | Train Loss: 7.523 Vali Loss: 30.980 Vali Acc: 0.427 Test Loss: 30.980 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 2884973
model size : 13.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.669695854187012
Epoch: 1, Steps: 32 | Train Loss: 4.025 Vali Loss: 3.675 Vali Acc: 0.420 Test Loss: 3.675 Test Acc: 0.420
Validation loss decreased (inf --> -0.419811).  Saving model ...
Epoch: 2 cost time: 3.246708393096924
Epoch: 2, Steps: 32 | Train Loss: 7.167 Vali Loss: 16.588 Vali Acc: 0.176 Test Loss: 16.588 Test Acc: 0.176
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.158816337585449
Epoch: 3, Steps: 32 | Train Loss: 11.211 Vali Loss: 8.596 Vali Acc: 0.344 Test Loss: 8.596 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.2706916332244873
Epoch: 4, Steps: 32 | Train Loss: 8.481 Vali Loss: 17.692 Vali Acc: 0.267 Test Loss: 17.692 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.976259708404541
Epoch: 5, Steps: 32 | Train Loss: 8.527 Vali Loss: 22.100 Vali Acc: 0.282 Test Loss: 22.100 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.6002345085144043
Epoch: 6, Steps: 32 | Train Loss: 5.314 Vali Loss: 15.500 Vali Acc: 0.344 Test Loss: 15.500 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.4469590187072754
Epoch: 7, Steps: 32 | Train Loss: 7.906 Vali Loss: 26.608 Vali Acc: 0.321 Test Loss: 26.608 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2081193923950195
Epoch: 8, Steps: 32 | Train Loss: 6.456 Vali Loss: 15.757 Vali Acc: 0.504 Test Loss: 15.757 Test Acc: 0.504
Validation loss decreased (-0.419811 --> -0.503659).  Saving model ...
Epoch: 9 cost time: 3.9761431217193604
Epoch: 9, Steps: 32 | Train Loss: 4.770 Vali Loss: 17.024 Vali Acc: 0.435 Test Loss: 17.024 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2891411781311035
Epoch: 10, Steps: 32 | Train Loss: 10.498 Vali Loss: 36.766 Vali Acc: 0.275 Test Loss: 36.766 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3239173889160156
Epoch: 11, Steps: 32 | Train Loss: 14.549 Vali Loss: 35.657 Vali Acc: 0.435 Test Loss: 35.657 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.853250026702881
Epoch: 12, Steps: 32 | Train Loss: 6.801 Vali Loss: 31.553 Vali Acc: 0.397 Test Loss: 31.553 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7542262077331543
Epoch: 13, Steps: 32 | Train Loss: 6.646 Vali Loss: 28.726 Vali Acc: 0.466 Test Loss: 28.726 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.6618876457214355
Epoch: 14, Steps: 32 | Train Loss: 9.003 Vali Loss: 43.075 Vali Acc: 0.313 Test Loss: 43.075 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.034973382949829
Epoch: 15, Steps: 32 | Train Loss: 19.000 Vali Loss: 50.294 Vali Acc: 0.260 Test Loss: 50.294 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.606419801712036
Epoch: 16, Steps: 32 | Train Loss: 9.765 Vali Loss: 36.931 Vali Acc: 0.321 Test Loss: 36.931 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.304128646850586
Epoch: 17, Steps: 32 | Train Loss: 3.072 Vali Loss: 22.491 Vali Acc: 0.511 Test Loss: 22.491 Test Acc: 0.511
Validation loss decreased (-0.503659 --> -0.511225).  Saving model ...
Epoch: 18 cost time: 3.670038938522339
Epoch: 18, Steps: 32 | Train Loss: 6.970 Vali Loss: 25.605 Vali Acc: 0.427 Test Loss: 25.605 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2847297191619873
Epoch: 19, Steps: 32 | Train Loss: 8.920 Vali Loss: 28.173 Vali Acc: 0.496 Test Loss: 28.173 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.418534994125366
Epoch: 20, Steps: 32 | Train Loss: 4.087 Vali Loss: 32.225 Vali Acc: 0.511 Test Loss: 32.225 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.813098430633545
Epoch: 21, Steps: 32 | Train Loss: 3.992 Vali Loss: 22.771 Vali Acc: 0.565 Test Loss: 22.771 Test Acc: 0.565
Validation loss decreased (-0.511225 --> -0.564658).  Saving model ...
Epoch: 22 cost time: 3.51452898979187
Epoch: 22, Steps: 32 | Train Loss: 4.399 Vali Loss: 49.168 Vali Acc: 0.260 Test Loss: 49.168 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.286386013031006
Epoch: 23, Steps: 32 | Train Loss: 3.033 Vali Loss: 53.568 Vali Acc: 0.550 Test Loss: 53.568 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.794346332550049
Epoch: 24, Steps: 32 | Train Loss: 2.873 Vali Loss: 37.967 Vali Acc: 0.573 Test Loss: 37.967 Test Acc: 0.573
Validation loss decreased (-0.564658 --> -0.572139).  Saving model ...
Epoch: 25 cost time: 3.7103137969970703
Epoch: 25, Steps: 32 | Train Loss: 0.231 Vali Loss: 36.604 Vali Acc: 0.565 Test Loss: 36.604 Test Acc: 0.565
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.5778582096099854
Epoch: 26, Steps: 32 | Train Loss: 0.522 Vali Loss: 61.235 Vali Acc: 0.511 Test Loss: 61.235 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.9550492763519287
Epoch: 27, Steps: 32 | Train Loss: 1.078 Vali Loss: 38.484 Vali Acc: 0.573 Test Loss: 38.484 Test Acc: 0.573
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.3792014122009277
Epoch: 28, Steps: 32 | Train Loss: 0.054 Vali Loss: 36.571 Vali Acc: 0.550 Test Loss: 36.571 Test Acc: 0.550
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.6937897205352783
Epoch: 29, Steps: 32 | Train Loss: 0.041 Vali Loss: 42.239 Vali Acc: 0.489 Test Loss: 42.239 Test Acc: 0.489
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.1075804233551025
Epoch: 30, Steps: 32 | Train Loss: 0.449 Vali Loss: 47.006 Vali Acc: 0.374 Test Loss: 47.006 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.0562565326690674
Epoch: 31, Steps: 32 | Train Loss: 0.140 Vali Loss: 43.061 Vali Acc: 0.565 Test Loss: 43.061 Test Acc: 0.565
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.367144584655762
Epoch: 32, Steps: 32 | Train Loss: 0.113 Vali Loss: 48.470 Vali Acc: 0.573 Test Loss: 48.470 Test Acc: 0.573
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.6112935543060303
Epoch: 33, Steps: 32 | Train Loss: 0.440 Vali Loss: 45.155 Vali Acc: 0.542 Test Loss: 45.155 Test Acc: 0.542
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.660052537918091
Epoch: 34, Steps: 32 | Train Loss: 0.145 Vali Loss: 49.020 Vali Acc: 0.542 Test Loss: 49.020 Test Acc: 0.542
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2884973
model size : 13.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         4                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.642574071884155
Epoch: 1, Steps: 32 | Train Loss: 3.575 Vali Loss: 3.349 Vali Acc: 0.290 Test Loss: 3.349 Test Acc: 0.290
Validation loss decreased (inf --> -0.290043).  Saving model ...
Epoch: 2 cost time: 3.4296483993530273
Epoch: 2, Steps: 32 | Train Loss: 3.865 Vali Loss: 6.332 Vali Acc: 0.305 Test Loss: 6.332 Test Acc: 0.305
Validation loss decreased (-0.290043 --> -0.305280).  Saving model ...
Epoch: 3 cost time: 2.8558743000030518
Epoch: 3, Steps: 32 | Train Loss: 4.917 Vali Loss: 8.225 Vali Acc: 0.252 Test Loss: 8.225 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.333996057510376
Epoch: 4, Steps: 32 | Train Loss: 9.723 Vali Loss: 24.697 Vali Acc: 0.427 Test Loss: 24.697 Test Acc: 0.427
Validation loss decreased (-0.305280 --> -0.427234).  Saving model ...
Epoch: 5 cost time: 2.9453554153442383
Epoch: 5, Steps: 32 | Train Loss: 13.545 Vali Loss: 25.548 Vali Acc: 0.206 Test Loss: 25.548 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7783608436584473
Epoch: 6, Steps: 32 | Train Loss: 10.796 Vali Loss: 14.172 Vali Acc: 0.443 Test Loss: 14.172 Test Acc: 0.443
Validation loss decreased (-0.427234 --> -0.442606).  Saving model ...
Epoch: 7 cost time: 3.292322874069214
Epoch: 7, Steps: 32 | Train Loss: 11.110 Vali Loss: 17.137 Vali Acc: 0.282 Test Loss: 17.137 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.711646318435669
Epoch: 8, Steps: 32 | Train Loss: 14.104 Vali Loss: 26.518 Vali Acc: 0.420 Test Loss: 26.518 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.309562921524048
Epoch: 9, Steps: 32 | Train Loss: 18.592 Vali Loss: 32.659 Vali Acc: 0.191 Test Loss: 32.659 Test Acc: 0.191
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1279985904693604
Epoch: 10, Steps: 32 | Train Loss: 14.701 Vali Loss: 14.180 Vali Acc: 0.344 Test Loss: 14.180 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.921398162841797
Epoch: 11, Steps: 32 | Train Loss: 12.968 Vali Loss: 17.590 Vali Acc: 0.275 Test Loss: 17.590 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.786404609680176
Epoch: 12, Steps: 32 | Train Loss: 14.170 Vali Loss: 30.561 Vali Acc: 0.458 Test Loss: 30.561 Test Acc: 0.458
Validation loss decreased (-0.442606 --> -0.457710).  Saving model ...
Epoch: 13 cost time: 2.6351754665374756
Epoch: 13, Steps: 32 | Train Loss: 16.083 Vali Loss: 18.444 Vali Acc: 0.275 Test Loss: 18.444 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.668388843536377
Epoch: 14, Steps: 32 | Train Loss: 16.390 Vali Loss: 28.547 Vali Acc: 0.267 Test Loss: 28.547 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6669793128967285
Epoch: 15, Steps: 32 | Train Loss: 13.817 Vali Loss: 19.176 Vali Acc: 0.511 Test Loss: 19.176 Test Acc: 0.511
Validation loss decreased (-0.457710 --> -0.511259).  Saving model ...
Epoch: 16 cost time: 3.1839118003845215
Epoch: 16, Steps: 32 | Train Loss: 6.678 Vali Loss: 25.715 Vali Acc: 0.275 Test Loss: 25.715 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.947918176651001
Epoch: 17, Steps: 32 | Train Loss: 7.032 Vali Loss: 26.426 Vali Acc: 0.519 Test Loss: 26.426 Test Acc: 0.519
Validation loss decreased (-0.511259 --> -0.518820).  Saving model ...
Epoch: 18 cost time: 2.9553017616271973
Epoch: 18, Steps: 32 | Train Loss: 1.023 Vali Loss: 40.482 Vali Acc: 0.282 Test Loss: 40.482 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3343088626861572
Epoch: 19, Steps: 32 | Train Loss: 2.160 Vali Loss: 35.411 Vali Acc: 0.511 Test Loss: 35.411 Test Acc: 0.511
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9474635124206543
Epoch: 20, Steps: 32 | Train Loss: 1.878 Vali Loss: 29.499 Vali Acc: 0.405 Test Loss: 29.499 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.046539068222046
Epoch: 21, Steps: 32 | Train Loss: 2.252 Vali Loss: 37.829 Vali Acc: 0.573 Test Loss: 37.829 Test Acc: 0.573
Validation loss decreased (-0.518820 --> -0.572141).  Saving model ...
Epoch: 22 cost time: 2.974321126937866
Epoch: 22, Steps: 32 | Train Loss: 5.335 Vali Loss: 50.446 Vali Acc: 0.527 Test Loss: 50.446 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.938117265701294
Epoch: 23, Steps: 32 | Train Loss: 4.490 Vali Loss: 54.016 Vali Acc: 0.336 Test Loss: 54.016 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.632512331008911
Epoch: 24, Steps: 32 | Train Loss: 0.225 Vali Loss: 34.871 Vali Acc: 0.489 Test Loss: 34.871 Test Acc: 0.489
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5696072578430176
Epoch: 25, Steps: 32 | Train Loss: 0.039 Vali Loss: 35.944 Vali Acc: 0.519 Test Loss: 35.944 Test Acc: 0.519
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.787343978881836
Epoch: 26, Steps: 32 | Train Loss: 0.148 Vali Loss: 47.221 Vali Acc: 0.466 Test Loss: 47.221 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.6408653259277344
Epoch: 27, Steps: 32 | Train Loss: 0.714 Vali Loss: 40.436 Vali Acc: 0.527 Test Loss: 40.436 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.563706398010254
Epoch: 28, Steps: 32 | Train Loss: 2.831 Vali Loss: 46.878 Vali Acc: 0.450 Test Loss: 46.878 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.5583693981170654
Epoch: 29, Steps: 32 | Train Loss: 0.502 Vali Loss: 25.337 Vali Acc: 0.504 Test Loss: 25.337 Test Acc: 0.504
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.472080707550049
Epoch: 30, Steps: 32 | Train Loss: 0.600 Vali Loss: 26.571 Vali Acc: 0.534 Test Loss: 26.571 Test Acc: 0.534
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.4745280742645264
Epoch: 31, Steps: 32 | Train Loss: 0.102 Vali Loss: 50.730 Vali Acc: 0.412 Test Loss: 50.730 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_ETSformer_UEA_ftM_sl17984_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5725190839694656
model parameter : 2884973
model size : 13.21MB
